     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*XBIA*  OVRDBF OTPAYL0 OTPAY                                         *
/*XBIB*  OVRDBF INPAYL0 INPAY                                         *
     F*****************************************************************
     F*                                                               *
     F*  Midas - Funds Transfer Module                                *
     F*                                                               *
     F*  FT0300 - FT Auto Generation                                  *
     F*                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
      *                                                               *
      *  Last Amend No. CFT162             Date 13Sep17               *
      *  Prev Amend No. LUC110             Date 16Aug16               *
      *                 LUC105             Date 18May15               *
      *                 MD31937            Date 13Jan15               *
      *                 AR856737           Date 24Nov11               *
      *                 HVB014             Date 07Nov11               *
      *                 HVB005             Date 14Oct11               *
      *                 HVB004             Date 10Oct11               *
      *                 HVB002             Date 29Sep11               *
      *                 HVB001             Date 29Sep11               *
      *                 AR856737           Date 14Sep11               *
      *                 BUG15042A          Date 23Oct07               *
      *                 BUG220908          Date 22Sep08               *
      *                 248105             Date 21Sep07               *
      *                 MMFIX              Date 18Sep07               *
      *                 244728             Date 04Jan07               *
      *                 MAR015             Date 22Apr06               *
      *                 MAR002             Date 10Apr06               *
      *                 PNL012             Date 16Sep05               *
      *                 MKEMR1             Date 28Aug2005             *
      *                 EMRMK1             Date 26Aug2005             *
      *                 MKCAR1             Date 04Aug2005             *
      *                 STP997             Date 06Jul05               *
      *                 STP500             Date 04May05               *
      *                 MK0560             Date 10Mar2005             *
      *                 MK0546             Date 01Mar2005             *
      *                 MK0527             Date 17Feb2005             *
      *                 MK0526             Date 17Feb2005             *
      *                 MK0524             Date 17Feb2005             *
      *                 MK0520             Date 14Feb2005             *
#     *                 MK0519             Date 14Feb2005             *
      *                 MK0513             Date 09Feb2005             *
      *                 MK0512             Date 08Feb2005             *
      *                 MK0508             Date 04Feb2005             *
      *                 MK0507             Date 04Feb2005             *
      *                 MK0550             Date 18Apr2005             *
      *                 STP033             Date 31Dec2004             *
      *                 STP017             Date 20Nov2004             *
      *                 STP014             Date 26Nov04               *
      *                 STP011             Date 23Nov04               *
      *                 STP010             Date 23Nov04               *
      *                 STP008             Date 22Nov04               *
      *                 STP007             Date 22Nov04               *
      *                 DJBF01             Date 09Sep2004             *
      *                 EEE065             Date 26Aug03               *
      *                 MK0292             Date 19Dec02               *
      *                 EEE019             Date 30Jun99               *
      *                 ESL038             Date 23Dec2004             *
      *                 RK0001             Date 30Jun2004             *
      *                 E30002             Date 25Feb2004             *
     F*                 ERN054             Date 18Jun2003             *
     F*                 DB0012             Date 21May2003             *
     F*                 DJB002 (EEE058)    Date 12May2003             *
     F*                 EEE058             Date 05Feb2003             *
     F*                 PL0001             Date 02Oct2001             *
      *                 BUG26108           Date 22Sep09               *
      *****************************************************
      *  Last Amend No. CFT151             Date 21Mar14               *
      *  Prev Amend No. CSW213             Date 03Jun13               *
      *                 AR1089518A         Date 11Mar13               *
      *                 AR1089518          Date 08Mar13               *
      *                 CFT135             Date 20Feb13               *
      *                 AR1084524          Date 13Feb13               *
      *                 CFT120             Date 28Sep12               *
      *                 CLE134             Date 01Aug12               *
      *                 AR787620           Date 10Jun11               *
      *                 CRE075             Date 06Dec10               *
      *                 BUG26775           Date 23Nov09               *
      *                 CER059             Date 19Jul10               *
      *                 CER047             Date 19May08               *
      *                 CER030             Date 09Jul08               *
      *                 CER043             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 CAP205             Date 03Mar10               *
      *                 CAP204             Date 09Feb10               *
      *                 BUG26108           Date 22Sep09               *
      *                 BUG26044           Date 16Sep09               *
      *                 BUG26009           Date 15Sep09               *
      *                 BUG25944A          Date 14Sep09               *
      *                 BUG25944           Date 09Sep09               *
      *                 BUG25829           Date 02Sep09               *
      *                 BUG24998           Date 17Jul09               *
      *                 BUG25401           Date 13Aug09               *
      *                 BUG24864           Date 13Jul09               *
      *                 BUG24724           Date 13Jul09               *
      *                 CSW209             Date 01Apr09               *
      *                 BUG24502           Date 01Apr09               *
      *                 BUG24221           Date 01Apr09               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 255350             Date 22Jul08               *
      *                 BUG15042           Date 17Oct07               *
      *                 250600             Date 07Oct07               *
      *                 CRE026             Date 24May06               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 200949             Date 05Oct06               *
      *                 CFT032             Date 11Sep06               *
      *                 CSD031             Date 10Apr06               *
      *                 208219             Date 27Apr06               *
      *                 BUG433             Date 05Dec05               *
      *                 CDL049             Date 07Jul06               *
      *                 226917             Date 06Jun06               *
      *                 225169             Date 06Jun06               *
      *                 CSD027             Date 09Dec05               *
      *                 CPK024             Date 13Feb06               *
      *                 CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 BUG4556            Date 19Oct04               *
      *                 BUG3644            Date 12Jul04               *
      *                 CTI004             Date 27May04               *
      *                 CLE025             Date 20Oct03               *
      *                 212229             Date 02Apr04               *
      *                 221761             Date 02Apr04               *
      *                 CSC022             Date 24Feb04               *
      *                 CGL029             Date 01Sep03               *
      *                 221934             Date 23Sep03               *
      *                 216308             Date 01Apr03               *
      *                 CRE008             Date 11Apr02               *
      *                 CSD015             Date 14Oct02               *
      * Midas Release 4.01.03 ----------------------------------------*
      *                 210509             Date 08Jan03               *
      * Midas Release 4.01 -------------------------------------------*
      *                 CFT017             Date 08Nov01               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 CPK014             Date 04Oct01               *
      *                 194061             Date 04Jun01               *
      *                 195504             Date 06Jul01               *
      *                 CSW201             Date 02May01               *
      * Midas DBA 3.05 -----------------------------------------------*
      *                 192595             Date 26Apr01               *
      *                 CFT009             Date 01Sep00               *
      *                 189441             Date 31Jan01               *
      * Midas DBA 3.04 -----------------------------------------------*
      *                 185107             Date 17Oct00               *
      *                 145752             Date 15Aug00               *
      *                 CFT014             Date 30JUN00               *
      * Midas DBA 3.03 -----------------------------------------------*
      *                 CFT012             Date 28FEB00               *
      *                 175479             Date 14FEB00               *
     F*                 175477             Date 01FEB00               *
     F*                 175475             Date 24JAN00               *
     F*                 175474             Date 21JAN00               *
     F*                 175469             Date 19JAN00               *
     F*                 178186             Date 28APR00               *
     F*                 177674             Date 20APR00               *
     F*                 177995             Date 19APR00               *
     F*                 176443             Date 18APR00               *
     F*                 177335             Date 19APR00               *
     F*                 177119             Date 14APR00               *
     F*                 CFT006             Date 19DEC99               *
      * Midas DBA 3.02 -----------------------------------------------*
     F*                 CPB001             Date 25FEB00               *
     F*                 CAP035             Date 25FEB00               *
     F*                 170801             Date 11NOV99               *
     F*                 CFT005             Date 18AUG99               *
     F*                 CFT004             Date 27JUL99               *
      * Midas DBA 3.01 -----------------------------------------------*
     F*                 CGL009             Date 08JUL99               *
     F*                 163446             Date 07JUL99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
     F*                 CFT002             Date 30MAR99               *
     F*                 CFT003             Date 25JAN99               *
     F*                 CFT002             Date 24NOV98               *
     F*                 146322             Date 29Oct98               *
     F*                 124673             Date 04Jun98               *
     F*                 CEU006             Date 30Apr98               *
     F*                 CFT003             Date 01JUL98               *
     F*                 CFT002             Date 01JUL98               *
     F*                 130869             Date 20Feb98               *
     F*                 122060             Date 18Aug97               *
     F*                 CRT002             Date 01Dec95               *
     F*                 S01408             Date 14Nov96               *
     F*                 CAC002             Date 15NOV96               *
     F*                 S01408             Date 02SEP96               *
     F*                 S01435             Date 09Oct93               *
     F*                                                               *
      *---------------------------------------------------------------*
      *                                                               *
      *  CFT162 - MT900 and MT910 Message Generation                  *
      *           (includes AR918985)                                 *
      *  LUC110 - STP changes for in-house eBanking payment           *
      *         - UCI - CALL in-house program to apply charges to     *
      *           EBanking payment                                    *
      *  LUC105 - Amendment to FT Account Balance Check               *
      *           Used copysource: FT0300C085, FT0300C086             *
      *  MD31937  - Upgrade STP enhancements to BF Midas 2.1          *
      *             Program failes to compile due to fields introduced*
      *             by CFT157 in OTPAYDD. The changes were part of    *
      *             SP6 for BF Midas 2.1. The data structure built    *
      *             over OTPAYDD was not considered.                  *
      *                                                               *
      *  AR856737 - Upgrade STP Enhancements to Midas Plus level.     *
      *           - DB error when call to FT0805 when Acc type = 'P'  *
      *           - Call program FT000984 if CFT009 is ON             *
      *  HVB014 -   Sort Code entered in first line of 57A is lost    *
      *             when the message us STPed                         *
      *         -   Added changes to /COPY FT0300DCPG so that         *
      *             if first line of S5ACB starts with '//' then      *
      *             replace second line of S5ACB with routing info.   *
      *  HVB005 -   For Outgoing Payment the Projected Account is     *
      *             not updated for Nostro Account.                   *
      *         -   The shadow posting not done as the account detail *
      *             is not correctly passed to AOSPOSU0               *
      *  HVB004 - Do not perform insufficiant check if message is     *
      *           for Zero Balance, i.e. 23E = 'OTH/HB POOLING'       *
      *           and msg type = IN3.  UCI specific changes           *
      *         - Used /COPY FT0300I002
      *  HVB002 - For Incoming Payment generated from IN3 message     *
      *           the Receivers Correspondent is defaulted with       *
      *           Ordering Customer details. SR/SRMAP affected.       *
      *         - Added /COPY FT0300DB09                              *
      *  HVB001 -  Do not translate Ordering Bank for IN3 messages    *
      *         -  Added /COPY FT0300MM05                             *
      *  BUG15042A- Codes are partially incorrect.                    *
      *  BUG220908-  No Shadow postings for retail/iban Ordering      *
      *              Customer                                         *
      *  248105 - Field 59 instead field 57D in MT103                 *
      *  MMFIX  - Ordering Cust set to blanks incorrectly for MTCASH  *
      *  244728 - Move write to FTCRCKP0 to after other updates to    *
      *           prevent record lock with interactive authorisations.*
      *           Amend FT0300CCP4/DB01 and create FT0300CP15/C026.   *
      *  MAR002 - Do not call old insufficient funds check (FT0805)   *
      *           when PNL012 switched on.                            *
      *  PNL012 - Account Payments Authorisation Processing           *
      *  MKCAR1 - Handle clearing settlement methods.                 *
      *  STP500 - Validation changes.                                 *
      *           Also changes in: /FT0300CCP4, FT0300C098,           *
      *           FT0300OPS1.                                         *
      *  MK0560 - Add processing for fixed commission for incoming    *
      *           payments.                                           *
      *  MK0546 - Move content of field 71G into misc charges 05.     *
      *  MK0527 - Fix Add/Deduct charges indicator for external       *
      *           networks.                                           *
      *  MK0526 - Hanle beneficiary type better for outgoing payment. *
      *  MK0524 - Call FT000984 to retrieve Receiver's charges        *
      *           remitted.                                           *
      *  MK0520 - Add call to FTP1100 to handle received book code    *
      *           and transaction subtype.                            *
      *  MK0519 - Do not leave DAF fields (PYAMD, SMAMD, RATED) blank.*
      *  MK0513 - Add processing for field 82.                        *
      *  MK0512 - Add special processing for external networks.       *
      *           Changes in /FT0300DCPG.                             *
      *  MK0508 - Correct fill of date offset code for Incoming       *
      *           Payments.                                           *
      *  MK0507 - Improve processing for pay value date for           *
      *           Incoming Payments.                                  *
      *  MK0550 - Related Payment Reference in Incoming Payments.     *
      *  STP033 - Calculate Receiver's charges remitted for           *
      *           outgoing payments.                                  *
      *  STP017 - STP flags: 'Y' = STP, 'N' = Manual.                 *
      *  STP014 - Execute exchange rates processing only for Fontis.  *
      *  STP010 - Clear W32* and W36* temporary variables, so that    *
      *           they are not remembered from a previous call.       *
      *  STP008 - Add procces for field tag 80 and 73                 *
      *           Change to FT0300C017 FT0300C019 & FT0300DCPG        *
      *  STP007 - Changes for Instructed Code on incoming payments.   *
      *           Add /copy FT0300MK08, FT0300MK09, FT0300MK10.       *
      *           Use /copy FT0300MK04.                               *
      *  STP005 - Fill in Sender's Correspondent field for MTCASH     *
      *           payments.                                           *
      *           Add /copy FT0300MK06, FT0300MK07.                   *
      *  DJBF01 - Debit account incorrectly mapped if not retail or   *
      *           Nostro                                              *
      *           Credit account incorrectly mapped if not retail or  *
      *           Nostro                                              *
      *           Correct fill of date offset code                    *
      *  EEE065 - Polish Features Upgrade R4                          *
      *           Review coding with impact of CGL009 and CFT014      *
      *           list of /COPY :                                     *
      *           SFT0345S6                                           *
      *           FT0300C014, C015, C016, C017, C018, C019, DCPG, INIT*
      *  MK0292 - Correct the length of Details of Payment (field 3   *
      *           and field 4). Fix related to CFT014.                *
      *           Changes in SFT0345S6 - recompile only.              *
     F*  EEE019 - Amendment to MT100 Interface with MultiCash:        *
     F*           Ensure amounts and dates are mapped to pay side not *
     F*           settle. Map decoded account currency to settle side *
     F*           and leave settle date blank to default the date.    *
     F*           Hooks FT0300C014                                    *
     F*                 FT0300C015                                    *
     F*                 FT0300DCPG used.                              *
     F*  EEE019 - MT100 Interface with MultiCash.                     *
     F*           Hooks FT0300C016                                    *
     F*                 FT0300C017                                    *
     F*                 FT0300C018                                    *
     F*                 FT0300C019 used.                              *
      *  ESL038 - ING STP Development                                .*
      *  RK0001 - Auto-authorisation does not set up authorising user.*
      *  E30002 - Correct duma1 fill for 71g processing               *
      *           Reset level 1 indicator for CFT009                  *
     F*  DB0012 - Zero 71g sette BCEQ of Rcvr's Chrgs in Settle Ccy   *
     F*           if 71g specified                                    *
     F*  DJB002 - Correct calculation of Base equivalent for OPs      *
     F*  EEE058 - Change EEE058 to map to settle amount for outgoing  *
     F*           Correct commission update                           *
     F*           Authorise incomings if from network EUROGW          *
     F*           Add copy hook FT0300DB02                            *
     F*           Add copy hook FT0300DB03                            *
     F*           Add copy hook FT0300DB04                            *
     F*           Add copy hook FT0300OSWT                            *
     F*           Add copy hook FT0300OCLR                            *
     F*           Use copy hook FT0300C029                            *
     F*           Use copy hook FT0300C067                            *
     F*           Use copy hook FT0300CLR                             *
     F*           Use copy hook FT0300CCP5                            *
     F*           Add copy hook FT0300DB05                            *
     F*           Add copy hook FT0300DB06                            *
     F*           Add copy hook FT0300DB07                            *
     F*           Add copy hook FT0300DB08                            *
     F*  PL0001 - Correct parameter call to FTC0334                   *
     F*           Reverse fix 177119 as thsi fills Sender's Corres    *
     F*           for outgoing incorrectly, only reverse S4SNCO fill  *
     F*           Added copy hook FT0300D001                          *
      *  CFT151 - FT IN/OP Alphanumeric sequence                      *
      *  CSW213 - SWIFT Changes 2013 (Recompile)                      *
      *  AR1089518A - STP - On-line A/C Mvmts not generated.          *
      *               Additional fix. (Child: AR1089520A)             *
      *  AR1089518 - STP - On-line A/C Mvmts not generated.           *
      *              Incorrect definition of parameter being passed   *
      *              to AOSPOSU0.  (Child: AR1089520)                 *
      *  CFT135 - MT100 MultiCash Interface                           *
      *           Added hooks:                                        *
      *           OFCPYSRCZ,CFT135_007                                *
      *           OFCPYSRCZ,CFT135_008                                *
      *           OFCPYSRCZ,CFT135_009                                *
      *           OFCPYSRCZ,CFT135_010                                *
      *           OFCPYSRCZ,CFT135_011                                *
      *           OFCPYSRCZ,CFT135_012                                *
      *           OFCPYSRCZ,CFT135_013                                *
      *           OFCPYSRCZ,CFT135_014                                *
      *  AR1084524 - Performance issue on IPAY & OPAY listview        *
      *              (Recompile)                                      *
      *  CFT120 - FT IN/OP - Charges to DR of Account Currency        *
      *           (Recompile)                                         *
      *  CLE134 - Past Due Call Loan Processing                       *
      *  AR787620 - Hooks Incorporation                               *
      *             WNCPYSRC,FTH00080                                 *
      *             WNCPYSRC,FTH00081                                 *
      *             WNCPYSRC,FTH00082                                 *
      *             WNCPYSRC,FTH00083                                 *
      *             WNCPYSRC,FTH00084                                 *
      *             WNCPYSRC,FTH00085                                 *
      *             WNCPYSRC,FTH00086                                 *
      *  CRE075 - Effective Date for Retail Accounts                  *
      *  BUG26775 - Validation error in Outgoing Validation Flag      *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER047 - German Features LF037-00 Reporting §24c KWG         *
      *  CER030 - Multicash German Feature                            *
      *  CER043 - German Features LF041-00 New Fields and Defaulting  *
      *           (Recompile)                                         *
      *  CAP205 - Teller Related APIs - Account Balance Check         *
      *  CAP204 - Teller Related APIs - Account Transfer              *
      *  BUG26108 - Invalid generation of payment during STP process  *
      *             and authorisation problem                         *
      *  BUG26044 - Dump when FT0805 pgm was called                   *
      *  BUG26009 - Generate timestamp                                *
      *  BUG25944A - Outgoing payment reference is missing            *
      *  BUG25944 - Could not find record IPPREF and OTPREF           *
      *  BUG25829 - Dump in ME_FT_IMM                                 *
      *  BUG24998 - Bank operation code is missing (Recompile)        *
      *  BUG25401 - Include HDRFTF in FTM1012CT parameter             *
      *  BUG24864 - Incorrect parameter                               *
      *  BUG24724 - Senders and receivers charge error, check if will *
      *             generate MT103                                    *
      *  CSW209 - SWIFT 2009 Changes                                  *
      *  BUG24502 - STP error in level 1 validation flag              *
      *  BUG24221 - Ordering customer line 5 is missing               *
      *  255350 - For routed MT202 message, pick-up Related Payment   *
      *           from Field Tag :20: instead of Field Tag :21:.      *
      *           Applied 247833 and 220800                           *
      *  BUG15042 -  Settlement (ordering customer) shadow postings   *
      *           incorrectly written.                                *
      *  250600 - Fix CFT032 and CSW207                               *
      *  CRE026 - Consumer Banking (Recompile)                        *
      *  200949 - Suppress FTM3244 if OP will not generate a MT103.   *
      *           Applied core fix 197943.                            *
      *           Same fix as 208219.                                 *
      *  CFT032 - Account Line in Field 50X in MT103                  *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  208219 - Suppress FTM3244 if OP will not generate a MT103.   *
      *  BUG433 - Recompiled due to change in FTPCHGPD                *
      *  CDL049 - Addition of a Reference Rate field (recompile)      *
      *  226917 - 225169 should not perform database error processing *
      *           if a currency is not found.                         *
      *  225169 - When routed payment contains SWIFT currency code,   *
      *           translate it to Midas currency code.                *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CPK024 - Packaging for MPLUS 1.2.1. Renamed AUTH from DS     *
      *           P@ACCN to A5TIAB.                                   *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  BUG4556- CWLCHECK job fails due to incorrect XML end tag     *
      *           for <A/C with Bank> tag.  Changed tag from          *
      *           </A/C with Bank > to </A/C with Bank>.              *
      *  BUG3644 - Serious Error in Collateralised Lending (Recompile)*
      *  CTI004 - MidasPlus TI Integration Enhancements               *
      *  CLE025 - Credit Lines                                        *
      *  212229 - Parameters were added to A101PS and A102PS, program *
      *           was amended to accomodate the additional parameters.*
      *  221761 - Incorrect routing of multiple MT101s.  Populate new *
      *           field RSEQNO with 1 if RFT is autogenerated.        *
      *  221538 - Expansion of field details.                         *
      *  CSC022 - Commitment Control Changes for MidasPlus            *
      *           (Recompile)                                         *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  221934 - Cmp Watch Alpha site fixes.                         *
      *           No STP hits registered.                             *
      *  216308 - Log all messages from the program message queue     *
      *  CRE008 - Cash Management                                     *
      *  CSD015 - Midas Compliance Watch - Watch List Checking        *
      *  210509 - Error caused by inconsistent coding for CFT014      *
      *  CFT017 - Multilateral Inter-bank Exchange Fee.               *
      *  CPK014 - Release 4 packaging.  Rename of timestamp field.    *
      *  194061 - Draft Issuance from Cashier never gets through in   *
      *           Midas.                                              *
      *  195504 - Parameter MGMSGR missing on call to FTM1021CT.      *
      *  CSW201 - SWIFT 2001 Standards Update                         *
     F*  192595 - Incoming Payment field Receiver's Correspondent     *
     F*           is incorrectly updated.                             *
     F*  CFT009 - FT Fees and Charge Development                      *
     F*  189441 - Incorrect parameters on call to FT0359              *
      *  185107 - Mapping of details from swift message               *
     F*  145752 - Move value of CCY to new variable ACCY just before  *
     F*           SR/RTABAL is executed.                              *
     F*  CFT014 - Addition of MT103 messages                          *
     F*  CFT012 - Cross currency transferts                           *
     F*  175479 - FONTIS : Map code work /REF/ into FT Dealer's Ref   *
     F*  175477 - FONTIS : Map beneficiary bank detail                *
     F*  175475 - FONTIS : Settlement ccy defaulted by /ORIG/         *
     F*  175474 - FONTIS : Invalid A/C in :53a:                       *
     F*  175469 - FONTIS : Euro nostro equivalent                     *
     F*  178186 - Eliminate duplicated COMMIT in update process       *
     F*  177674 - Report update processing of screen input MT101 MT102*
     F*  177995 - Relax checking of unicity between Sender/File Ref   *
     F*           in MT102                                            *
     F*  176443 - Avoid MCH3601 to be sent.                           *
     F*           Pass correct parameter to AOCUSTR0.                 *
     F*  177335 - Database error in FT0805 caused by @ACNT field not  *
     F*           being cleared and hence retaining info from previous*
     F*           use.                                                *
     F*  177119 - Incorrect populating of senders correspondent field *
     F*           when generating STP through payments.               *
     F*  CFT006 - MT101/2 message addtion for out/inc RFT CCT         *
     F*  CPB001 - Rename new field in ACCNTAB and ACCNT:              *
     F*           (REPI)                                              *
     F*  CAP035 - Rename new fields in ACCNTAB and ACCNT:             *
     F*           (FRNT, AFRT and REPA)                               *
     F*  170801 - Midas-Fontis IAT/TPP interface fix.                 *
     F*           When redirecting in ccy payments to Euro, default   *
     F*           pay delivery currency/amount to the original        *
     F*           payment currency                                    *
     F*  CFT005 - STP Phase 2 - Auto-authorisation of STP payments    *
     F*         - (based on FT0803).  Outgoing payment generation     *
     F*         - part of FT0803 was not duplicated because this      *
     F*         - feature is not currently available                  *
     F*  CFT004 - International Bank Account Number                   *
     F*           Check if Beneficiary is a IBAN                      *
     F*  CGL009 - Midas TPP/IAT FONTIS interface                      *
     F*           a) Change W0ACT to W2ACT to not disturb the         *
     F*           routing of msg and the printing of FT0300/10P1      *
     F*  163446 - Message routing without STP (CASHIER ...)           *
     F*           a) Routing program and repair process are           *
     F*           conditionned by presence of CFT002. This has been   *
     F*           done in order to make this program running without  *
     F*           STP (objects ME1501, ME1503, MEURPRL0 are no longer *
     F*           mandatory)                                          *
     F*  CFT003 - FT Batch Authorisation and Settlement Method '14'   *
     F*  CFT002 - Straight Through Processing Phase 1                 *
     F*  146322 - Partial incorrect incorporation of 122060 and       *
     F*           130869.                                             *
     F*  124673 - Standardise 20th Century cut off date to below 72.  *
     F*  CEU006 - EMU FT Payments and Settlement.                     *
     F*  130869 - CRT002 missing from core - reapply changes.         *
     F*  122060 - Drafts Issuance.                                    *
     F*  CRT002 - Retail Branch Access.                               *
     F*  S01408 - Addition of core hook FT0300CP16                    *
     F*         - Addition of core hook FT0300CP15                    *
     F*         - Addition of core hook FT0300CP14                    *
     F*         - Addition of core hook FT0300CP13                    *
     F*         - Addition of core hook FT0300CP12                    *
     F*         - Addition of core hook FT0300CP11                    *
     F*         - Addition of core hook FT0300CP10                    *
     F*         - Addition of core hook FT0300CCP9                    *
     F*         - Addition of core hook FT0300CCP8                    *
     F*         - Addition of core hook FT0300CCP7                    *
     F*         - Addition of core hook FT0300CCP6                    *
     F*  CAC002 - Profit Centre Accounting Development - Phase 2      *
     F*           If Analytical Accounting is available, a margin     *
     F*           amount must be calculated for any Draft Issue gene- *
     F*           rated by retail teller where pay and settle curren- *
     F*           cies are different.                                 *
     F*  S01408 - Addition of core hook FT0300CCP5                    *
     F*         - Addition of core hook FT0300CCP4                    *
     F*         - Addition of core hook FT0300CCP3                    *
     F*         - Addition of core hook FT0300CCP2                    *
     F*         - Addition of core hook FT0300CCP1                    *
     F*  S01435 - Incoming Message Management                         *
     F*                                                               *
     F*****************************************************************
     F*                                                               *
     F*  Indicator usage                                              *
     F*  ~~~~~~~~~~~~~~~                                              *
     F*                                                               *
     F*  42    Error on calling FT0805                                *   CFT005
     F*  50    First cycle                                            *
     F*  81    Used for scanning P72 for /OCMT/                       *   CEU006
     F*  82    Used for check on valid amount chars in Swift string   *   CEU006
     F*  90    General work indicator                                 *
     F*  91    General work indicator                                 *
     F*                                                               *
     F*  U7/U8 Error Ocurred                                          *
     F*  LR    End program                                            *
     F*                                                               *
     F*****************************************************************
     FFTCRCKP0O   E           K        DISK                                                   MAR012
     FOTPAYL0 UF  E           K        DISK                      A    UC
     F                                              KCOMIT
     F***********                                   KINFSR SRFILE         130869
     F                                              KINFSR SRFILA         130869
     F            OTPAYDDF                          KRENAME@OTPAYL0
      * PHY : FT Outgoing Payments      Physical File
      *
     FOTPAYZZ UF  E                    DISK                           UC
     F                                              KCOMIT
     F***********                                   KINFSR SRFILE         130869
     F                                              KINFSR SRFILA         130869
      * UPD : FT Outgoing Payments      Update index
      *
     FINPAYL0 UF  E           K        DISK                      A    UC
     F                                              KCOMIT
     F***********                                   KINFSR SRFILE         130869
     F                                              KINFSR SRFILA         130869
     F            INPAYDDF                          KRENAME@INPAYL0
      * PHY : FT Incoming Payments      Physical File
      *
     FINPAYZZ UF  E                    DISK                           UC
     F                                              KCOMIT
     F***********                                   KINFSR SRFILE         130869
     F                                              KINFSR SRFILA         130869
      * UPD : FT Incoming Payments      Update index
      *
     FINPAYDQDO   E                    DISK         KCOMIT                                  BUG25944
      *                                                                                     BUG25944
     FOTPAYDQDO   E                    DISK         KCOMIT                                  BUG25944
      *                                                                                     BUG25944
     FREIAC   IF  E           K        DISK                           UC  130869
     F                                              KINFSR SRFILA         130869
      ** Retail interest and charges                                      130869
      *                                                                   130869
     FACNUM   IF  E           K        DISK                           UC  130869
     F                                              KINFSR SRFILA         130869
     F            ACCNTABF                          KRENAMEACNUMABF       130869
      ** Account Numbers Cross Reference File                             130869
      *                                                                   130869
     F/COPY WNCPYSRC,FT0300F001
     FACCNT   IF  E           K        DISK                               130869
     F                                              KINFSR SRFILA         130869
     F            ACCNTAAF                          KIGNORE               CFT002
     F            ACCNTACF                          KIGNORE               CFT002
      ** Account master                                                   130869
      *                                                                   130869
     FSDM901L0IF  E           K        DISK                                                   CFT162
     FREPDRIL1IF  E           K        DISK                               122060
     F                                              KINFSR SRFILA         122060
      ** Drafts Issuaance Incoming Msg Keyed on Draft No                  122060
      *                                                                   122060
     F*****MEURPRL0IF  E           K        DISK                    CFT002163446
     F*****MEURPRL0IF  E      K        DISK                     UC  163446CFT006
     F**************************************KINFSR SRFILA           CFT002CFT006
      ***Midas*ME*User*Repair**************                         CFT002CFT006
      *************************************                         CFT002CFT006
     FMEFNODL1IF  E           K        DISK                           UC  CGL009
     F                                              KINFSR SRFILA         CGL009
      ** Midas FONTIS TPP nostro defaults                                 CGL009
      *                                                                   CGL009
     FSDNOSTL3IF  E           K        DISK                               CGL009
     F                                              KINFSR SRFILA         CGL009
      ** Midas Nostro details                                             CGL009
      *                                                                   CGL009
     FMEISOCL1IF  E           K        DISK         KINFSR *PSSR                              CFT017
      ** Midas ME SWIFT ISO Country Codes retrieval index                                     CFT017
      *                                                                                       CFT017
     FMEINMVV0IF  E           K        DISK         KCOMIT                                    MK0512
      * Midas ME Message Routing Extensionen                                                  MK0512
      *                                                                                       MK0512
     F/COPY ZSRSRC,RTCCYSF1                                               122060
      *                                                                   122060
     F/COPY WNCPYSRC,FT0300DFPG
      *
      *  /Copy point for File Definition
      *
     FINPAYXL0UF  E           K        DISK                      A    UC  CFT003
     F                                              KCOMIT                CFT003
      *                                                                   CFT003
      * Incoming payment extension file                                   CFT003
      *                                                                   CFT003
     FOTPAYXL0UF  E           K        DISK                      A    UC  CFT003
     F                                              KCOMIT                CFT003
      *                                                                   CFT003
      * Outgoing payment extension file                                   CFT003
      *                                                                   CFT003
     FFTPCHGL0IF  E           K        DISK                               CFT009
      *                                                                   CFT009
     FSDCURRLDIF  E           K        DISK                                                   225169
      *                                                                                       CER030
      ** SD Network Transaction Identifier File                                               CER030
      *                                                                                       CER030
     FSDNTTIL1IF  E           K        DISK                                                   CER030
     F                                              KINFSR *PSSR                              CER030
     F/EJECT
     E                    CPY@    1   1 80
     E**********          OPARR   1  20 35               2nd parameter string for out  CSD015 CSW209
     E**********          IPARR   1  24 35               2nd parameter string for inp  CSD015 CSW209
     E                    OPARR   1  32 35                                                    CSW209
     E                    IPARR   1  36 35                                                    CSW209
      *                                                                                       CFT017
      ** Array containing dummy timestamp                                                     CFT017
      *                                                                                       CFT017
     E                    STAMP   1   1 26                                                    CFT017
      *                                                                   130869
      ** Sender CASHV8 Narrative                                          130869
      *                                                                   130869
     E                    PSNAR   1   1 35                                130869
      *                                                                   CAC002
      *                                                                   CAC002
     E                    AP      1  10 10 0                              CAC002
      ** Array - Powers of Ten.                                           CAC002
      *
      *  Error codes
      *
     E                    ERCD       38  4
      *
      *  Amount change array
      *
     E                    YA1        15  1
      *                                                                   CEU006
      ** Work array for P72 /OCMT/ extraction in SR SRMSGD                CEU006
      *                                                                   CEU006
     E                    @A         15  1                                CEU006
      *                                                                   CGL009
      ** Work array for P72 /RATE/ extraction                             CGL009
      *                                                                   CGL009
     E                    @R1        13  1                                CGL009
      *                                                                   CGL009
      ** Work array to determine null amount                              CGL009
      *                                                                   CGL009
     E                    @NL        15  1                                CGL009
      *                                                                   CGL009
      ** Work array to strip off character '/' from field (35 char)       CGL009
      *                                                                   CGL009
     E                    @I35       35  1               Input table      CGL009
     E                    @O35       35  1               Output table     CGL009
      *                                                                   175479
      ** Work array used in SR CWVAL to store content of tag              175479
      *                                                                   175479
     E                    @CW       256  1                                175479
      *                                                                   175479
      ** Work array used in SR CWVAL to store value extracted             175479
      *                                                                   175479
     E                    @VL       256  1                                175479
      *                                                                   CFT006
      ** Work array for API validation                                    CFT006
      *                                                                   CFT006
     E                    @FN        75 10               Fields name      CFT006
     E                    @MI        75  7               Msg Id           CFT006
     E                    @MD        75 45               Msg Dta          CFT006
     E                    @FN1       75 10               Fields name 1    CFT006
     E                    @MI1       75  7               Msg Id 1         CFT006
     E                    @MD1       75 45               Msg Dta 1        CFT006
     E                    @FN2       75 10               Fields name 2    CFT006
     E                    @MI2       75  7               Msg Id 2         CFT006
     E                    @MD2       75 45               Msg Dta 2        CFT006
     E                    @FN3       75 10               Fields name 3    CFT006
     E                    @MI3       75  7               Msg Id 3         CFT006
     E                    @MD3       75 45               Msg Dta 3        CFT006
     E                    @WFN       75 10               W Flds name      CFT006
     E                    @WMI       75  7               W Msg Id         CFT006
     E                    @WMD       75 45               W Msg Dta        CFT006
     E                    @WFN1      75 10               W Flds name 1    CFT006
     E                    @WMI1      75  7               W Msg Id 1       CFT006
     E                    @WMD1      75 45               W Msg Dta 1      CFT006
     E                    @WFN2      75 10               W Flds name 2    CFT006
     E                    @WMI2      75  7               W Msg Id 2       CFT006
     E                    @WMD2      75 45               W Msg Dta 2      CFT006
     E                    @WFN3      75 10               W Flds name 3    CFT006
     E                    @WMI3      75  7               W Msg Id 3       CFT006
     E                    @WMD3      75 45               W Msg Dta 3      CFT006
     E                    @WKF       75 10               Fld n for FILLOG CFT006
     E                    @WKI       75  7               Msg I for FILLOG CFT006
     E                    @WKD       75 45               Msg D for FILLOG CFT006
      *                                                                   CFT014
      ** Work array Multiple Lines of First Line of Pxx fields            CFT014
      *                                                                   CFT014
     E                    LFLT        5 59                                CFT014
      *                                                                   CFT014
      ** Work array Multiple Lines of Charges Amounts                     CFT014
      *                                                                   CFT014
     E                    CGA         5 12                                CFT014
      *                                                                   CFT014
      ** Work array Multiple Lines of Charges Currencies                  CFT014
      *                                                                   CFT014
     E                    CGC         5  3                                CFT014
      *
      *  Copyright table
      *
     E/COPY ZSRSRC,RTCCYSE1                                               122060
      *                                                                   122060
      *  /Copy point for Arrays                                           122060
      *                                                                   122060
     E/COPY WNCPYSRC,FT0300DEPG
      *
      *  /Copy point for Arrays
      *
     E/COPY FTCPYSRC,SRERRE
      *
      *  end of Copysource for error processing
      *
     E/COPY ZSRSRC,RBCXRTE1                                               122060
      ** Array for SR.CMPXRT                                              122060
      *                                                                   122060
     E/COPY ZSRSRC,ZALIGNZ1                                               130869
      ** Array for both SR.ZALIGN, SR.ZEDIT                               130869
      *                                                                   130869
      ** Arrays defined for Error handling                                                    CER030
      *                                                                                       CER030
     E                    FNMARR     40 10                                                    CER030
     E                    MIDARR     40  7                                                    CER030
     E                    MDTARR     40 45                                                    CER030
     E                    WFLDAR     40 10                                                    CER030
     E                    WMIDAR     40  7                                                    CER030
     E                    WMDTAR     40 45                                                    CER030
      *                                                                                       CER030
     E/EJECT                                                              130869
     E/COPY WNCPYSRC,FT0300E001
      *                                                                   130869
     IACNUMABF                                                            130869
      ** Renamed fields in LF/ACNUM                                       130869
     I              BRCA                            ABRCA                 130869
      *                                                                   130869
     IACCNTABF                                                            130869
      ** Renamed fields in LF/ACCNT                                       130869
     I              BRCA                            ABRCA                 130869
     I              FRNT                            AFRNA                 CAP035
     I              AFRT                            AAFRT                 CAP035
     I              REPA                            AREPA                 CAP035
     I              REPI                            AREPI                 CPB001
      *                                                                   130869
     IREIACAF                                                             130869
      ** Renamed fields in LF/REIAC                                       130869
     I              BRCA                            RBRCA1                130869
      *                                                                   130869
     IREIACDF                                                             130869
      ** Renamed fields in LF/REIAC                                       130869
     I              BRCA                            RBRCA2                130869
      *                                                                   130869
     IREIACZF                                                             130869
      ** Renamed fields in LF/REIAC                                       130869
     I              BRCA                            RBRCA3                130869
     I/COPY WNCPYSRC,FT0300I001
      *                                                                   130869
     I            DS                                                      130869
      *                                                                   130869
      ** Data Structure to hold account number                            130869
      *                                                                   130869
     I**********                              1  18 @ACCN                              130869 CGL029
     I                                        1  24 @ACCN                                     CGL029
     I**********                              1   60@CNUM                              130869 CSD027
     I                                        1   6 @CNUM                                     CSD027
     I                                        7   9 @CCY                  130869
     I**********                             10  130@ACOD                              130869 CGL029
     I**********                             14  150@ACSQ                              130869 CGL029
     I**********                             16  18 @BRCA                              130869 CGL029
     I                                       10  190@ACOD                                     CGL029
     I                                       20  210@ACSQ                                     CGL029
     I                                       22  24 @BRCA                                     CGL029
      *                                                                   CGL009
      ** Data Structure to hold NOSTRO number                             CGL009
      *                                                                   CGL009
     IDSNOST      DS                                                      CGL009
     I                                        1   3 WNOCCY                CGL009
     I                                        4   5 WNONUM                CGL009
      *                                                                   CGL009
      ** Data Structure to hold partial account number                    CGL009
      *                                                                   CGL009
     IDSPTAC      DS                                                      CGL009
     I                                        1   6 WPTCST                CGL009
     I**********                              7  10 WPTACD                             CGL009 CGL029
     I**********                             11  12 WPTSQN                             CGL009 CGL029
     I**********                             13  15 WPTBCH                             CGL009 CGL029
     I                                        7  16 WPTACD                                    CGL029
     I                                       17  18 WPTSQN                                    CGL029
     I                                       19  21 WPTBCH                                    CGL029
      *                                                                   CGL009
      ** Data Structure to hold G/L account number                        CGL009
      *                                                                   CGL009
     IDSGLDG      DS                                                      CGL009
     I                                        1   6 WGLCST                CGL009
     I                                        7   9 WGLCCY                CGL009
     I**********                             10  13 WGLACD                             CGL009 CGL029
     I**********                             14  15 WGLSQN                             CGL009 CGL029
     I**********                             16  18 WGLBCH                             CGL009 CGL029
     I                                       10  19 WGLACD                                    CGL029
     I                                       20  21 WGLSQN                                    CGL029
     I                                       22  24 WGLBCH                                    CGL029
      *                                                                   130869
     I***CSHDTA*     DS                            512                                 130869 CGL029
     ICSHDTA      DS                            522                                           CGL029
      ** Define CASH data area                                            130869
      *                                                                   130869
     I                                        9  10 DABOKC                130869
     I                                       11  12 DADICT                130869
     I                                       13  14 DADIAT                130869
     I                                       15  16 DADRPT                130869
     I                                       17  18 DADCNT                130869
     I                                       19  19 DAPSUC                130869
     I                                       20  20 DAPFAI                130869
     I**********                             21  240DACACD                             130869 CGL029
     I                                      513 5220DACACD                                    CGL029
      *                                                                   130869
     IP@QDS       DS                           1714                       130869
      ** Data queue message to be sent                                    130869
      *                                                                   130869
     IREPDRO    E DSREPDROPD                                              130869
      ** Draft Issuance Outgoing Response Message                         130869
      *                                                                   130869
     I              ZZ001                           ZZ001A                130869
      *                                                                                       MK0520
     I#1PARM      DS                            256                                           MK0520
      ** Define FTP1100 data area                                                             MK0520
      *                                                                                       MK0520
     I                                        1   80#1MSGR                                    MK0520
     I                                        9  110#1KPRT                                    MK0520
     I                                       12  140#1LHCY                                    MK0520
     I#2PARM      DS                           1400                                           MK0520
      ** Define FTP1100 data area                                                             MK0520
      *                                                                                       MK0520
     I#3PARM      DS                             30                                           MK0520
      ** Define FTP1100 data area                                                             MK0520
      *                                                                                       MK0520
     I                                        1   8 #3CNBK                                    MK0520
     I                                        9  10 #3BOKC                                    MK0520
     I                                       11  12 #3SUBT                                    MK0520
      *                                                                   122060
     IDSMEMS    E DSMEMOS                                                 122060
      ** External data structure for MEMOS Details                        122060
      ** Renamed fields in PF/MEMOS                                       122060
      *                                                                   122060
     I              CNUM                            MECNUM                122060
     I              CCY                             MECCY                 122060
     I              ACOD                            MEACOD                122060
     I              ACSQ                            MEACSQ                122060
      *                                                                                       CER030
     IIEXN        DS                            390                                           CER030
     I                                        1  65 IEXN1                                     CER030
     I                                       66 130 IEXN2                                     CER030
     I                                      131 195 IEXN3                                     CER030
     I                                      196 260 IEXN4                                     CER030
     I                                      261 325 IEXN5                                     CER030
     I                                      326 390 IEXN6                                     CER030
      *                                                                                       CER030
     IOPEXN       DS                            390                                           CER030
     I                                        1  65 OPEXN1                                    CER030
     I                                       66 130 OPEXN2                                    CER030
     I                                      131 195 OPEXN3                                    CER030
     I                                      196 260 OPEXN4                                    CER030
     I                                      261 325 OPEXN5                                    CER030
     I                                      326 390 OPEXN6                                    CER030
      *                                                                                       CER030
     E/EJECT
     I/COPY WNCPYSRC,FT0300DIPG
      *  /Copy point for Input specifications
      *
      *  Break down MIDAS equivalent                                      CFT002
     ITRCDE2      DS                                                      CFT002
     I                                        1   6 TRCNUM                CFT002
     I                                        7   9 TRCYCD                CFT002
     I**********                             10  13 TRACOD                             CFT002 CGL029
     I**********                             14  15 TRACSQ                             CFT002 CGL029
     I**********                             16  18 TRBRCD                             CFT002 CGL029
     I**********                             10  15 TRCDSQ                             CFT002 CGL029
     I**********                             10  18 TRCSB                              CFT002 CGL029
     I                                       10  19 TRACOD                                    CGL029
     I                                       20  21 TRACSQ                                    CGL029
     I                                       22  24 TRBRCD                                    CGL029
     I                                       10  21 TRCDSQ                                    CGL029
     I                                       10  24 TRCSB                                     CGL029
      *                                                                   CFT002
     IACCINF    E DSACCNTAB                                               CGL009
     I              RECI                            IFRECI                CGL009
     I              CNUM                            IFCNUM                CGL009
     I              CCY                             IFCCY                 CGL009
     I              ACODQQ                          IFACD#                                    CGL029
     I              ACOD                            IFACOD                CGL009
     I              ACSQ                            IFACSQ                CGL009
     I              ZZ006                           IFZZ06                CGL009
     I              BRCA                            IFBRCA                CGL009
     I              ATYP                            IFATYP                CGL009
     I              STYP                            IFSTYP                CGL009
     I              MFFQ                            IFMFFQ                CGL009
     I              ACST                            IFACST                CGL009
     I              DACO                            IFDACO                CGL009
     I              DACC                            IFDACC                CGL009
     I              ANAM                            IFANAM                CGL009
     I              LDBL                            IFLDBL                CGL009
     I              CLBL                            IFCLBL                CGL009
     I              STFQ                            IFSTFQ                CGL009
     I              STDY                            IFSTDY                CGL009
     I              LSTD                            IFLSTD                CGL009
     I              NSTD                            IFNSTD                CGL009
     I              LSTP                            IFLSTP                CGL009
     I              CFSB                            IFCFSB                CGL009
     I              LMVD                            IFLMVD                CGL009
     I              EPLB                            IFEPLB                CGL009
     I              EPCB                            IFEPCB                CGL009
     I              YTDB                            IFYTDB                CGL009
     I              GLBT                            IFGLBT                CGL009
     I              ADREF1                          IFARF1                CGL009
     I              PRFC                            IFPRFC                CGL009
     I              ZZ004                           IFZZ04                CGL009
     I              ORED                            IFORED                CGL009
     I              DLIM                            IFDLIM                CGL009
     I              LRCR                            IFLRCR                CGL009
     I              RTCB                            IFRTCB                CGL009
     I              RTLB                            IFRTLB                CGL009
     I              DITM                            IFDITM                CGL009
     I              CITM                            IFCITM                CGL009
     I              ADREF2                          IFREF2                CGL009
     I              ZZ002                           IFZZ02                CGL009
     I              CDIR                            IFCDIR                CGL009
     I              CCIR                            IFCCIR                CGL009
     I              ACNO                            IFACNO                CGL009
     I              RETB                            IFRETB                CGL009
     I              ODSC                            IFODSC                CGL009
     I              ODLN                            IFODLN                CGL009
     I              ODED                            IFODED                CGL009
     I              DIOD                            IFDIOD                CGL009
     I              FACT                            IFFACT                CGL009
     I              FCNO                            IFFCNO                CGL009
     I              EFAC                            IFEFAC                CGL009
     I              HELD                            IFHELD                CGL009
     I              MINB                            IFMINB                CGL009
     I              LACD                            IFLACD                CGL009
     I              LISP                            IFLISP                CGL009
     I              RRNM                            IFRRNM                CGL009
     I              DRIB                            IFDRIB                CGL009
     I              DRIS                            IFDRIS                CGL009
     I              DRCD                            IFDRCD                CGL009
     I              DRIC                            IFDRIC                CGL009
     I              DRIF                            IFDRIF                CGL009
     I              DRDY                            IFDRDY                CGL009
     I              NDID                            IFNDID                CGL009
     I              LDID                            IFLDID                CGL009
     I              LDIA                            IFLDIA                CGL009
     I              SDAP                            IFSDAP                CGL009
     I              LPAR                            IFLPAR                CGL009
     I              DIIE                            IFDIIE                CGL009
     I              DAIC                            IFDAIC                CGL009
     I              MADI                            IFMADI                CGL009
     I              GADI                            IFGADI                CGL009
     I              DDIS                            IFDDIS                CGL009
     I              DDIA                            IFDDIA                CGL009
     I              OLDR                            IFOLDR                CGL009
     I              OLDB                            IFOLDB                CGL009
     I              OLDS                            IFOLDS                CGL009
     I              CRIB                            IFCRIB                CGL009
     I              CRIS                            IFCRIS                CGL009
     I              CRCD                            IFCRCD                CGL009
     I              CRIC                            IFCRIC                CGL009
     I              CRIF                            IFCRIF                CGL009
     I              CRDY                            IFCRDY                CGL009
     I              NCID                            IFNCID                CGL009
     I              LCID                            IFLCID                CGL009
     I              LCIA                            IFLCIA                CGL009
     I              SCAP                            IFSCAP                CGL009
     I              LPAP                            IFLPAP                CGL009
     I              CIIE                            IFCIIE                CGL009
     I              CAIC                            IFCAIC                CGL009
     I              MACI                            IFMACI                CGL009
     I              GACI                            IFGACI                CGL009
     I              CDIS                            IFCDIS                CGL009
     I              DCIA                            IFDCIA                CGL009
     I              OLCR                            IFOLCR                CGL009
     I              OLCB                            IFOLCB                CGL009
     I              OLCS                            IFOLCS                CGL009
     I              LCD                             IFLCD                 CGL009
     I              CHTP                            IFCHTP                CGL009
     I              TNLU                            IFTNLU                CGL009
     I              BRTCA                           IFBRTA                CGL009
     I              NACSG                           IFNACG                CGL009
     I              R4ACNT                          IFR4AC                CGL009
     I              ENOC                            IFENOC                CGL009
     I              EPNO                            IFEPNO                CGL009
     I              ECFB                            IFECFB                CGL009
     I              LTAB                            IFLTAB                CGL009
     I              LTAC                            IFLTAC                CGL009
     I              LTAS                            IFLTAS                CGL009
     I              HCFB                            IFHCFB                CGL009
     I              PTFR                            IFPTFR                CGL009
     I              HLEX                            IFHLEX                CGL009
     I              A5TIAC                          IFA5TA                CGL009
     I              A5TIAN                          IFA5TN                CGL009
     I              A5TIAS                          IFA5TS                CGL009
     I              EUSB                            IFEUSB                CGL009
     I              IBAN                            IFIBAN                CFT004
     I              IBSEQN                          IFIBSQ                CFT004
     I              FRNT                            IFRNA                 CAP035
     I              AFRT                            IAFRT                 CAP035
     I              REPA                            IREPA                 CAP035
     I              REPI                            IREPI                 CPB001
     I              TMST                            XXTMST                                    CPK014
     I              FCCU                            IFFCCU                                    CLE025
     I              COLF                            IFCOLF                                    CLE025
     I              BCOA                            IFBCOA                                    CLE025
     I              COLA                            IFCOLA                                    CLE025
     I              PFCU                            IFPFCU                                    CLE025
     I              PFTP                            IFPFTP                                    CLE025
     I              PFSQ                            IFPFSQ                                    CLE025
     I              K24C                            IFK24C                                    CER047
     I              ACEFDT                          IFEFDT                                    CRE075
      *                                                                   CGL009
      *  Account info                                                     CGL009
      *                                                                   CGL009
     ISDNOST    E DSSDNOSTPD                                              CFT002
      *                                                                   CFT002
      *  Calling parameter data structure for AONOSTR0                    CFT002
      *                                                                   CFT002
     IMEBICD    E DSMEBICDPD                                              CGL009
      *                                                                   CGL009
      *  Calling parameter data structure for ME1400                      CGL009
      *                                                                   CGL009
     ISDCNST    E DSSDCNSTPD                                              CGL009
      *                                                                   CGL009
      *  Calling parameter data structure for ME1400                      CGL009
      *                                                                   CGL009
     I**********PCRIT     E DSMEGNCRPD                    256       CFT002CFT009
     IPCRIT     E DSMEGNCRPD                                              CFT009
      *                                                                   CFT002
      *  Calling parameter data structure for ME1501                      CFT002
      *                                                                   CFT002
     IP@ACCN    E DSACCNTAB                                               CFT004
     I              RECI                            IBRECI                CFT004
     I              CNUM                            IBCNUM                CFT004
     I              BRCA                            IBBRCA                CFT004
     I              ACODQQ                          IBACD#                                    CGL029
     I              ACOD                            IBACOD                CFT004
     I              ACSQ                            IBACSQ                CFT004
     I              LCD                             IBLCD                 CFT004
     I              LTACQQ                          IBLTC#                                    CGL029
     I              ACNO                            IBACNO                CFT004
     I              ZZ006                           IBZZ06                CFT004
     I              A5ACKY                          IBACKY                                    CTI004
     I              A5INTL                          IBINTL                                    CTI004
     I              A5TIAB                          IBTIAB                                    CTI004
     I              AUTH                            IBAUTH                                    CPK024
     I              DCSP                            IDCSP                                     CLE134
     I              DCSG                            IDCSG                                     CLE134
     I              DRMT                            IDRMT                                     CLE134
     I              DRFD                            IDRFD                                     CLE134
     I              CCSP                            ICCSP                                     CLE134
     I              CCSG                            ICCSG                                     CLE134
     I              CRMT                            ICRMT                                     CLE134
     I              CRFD                            ICRFD                                     CLE134
     I/COPY WNCPYSRC,FT0300I002
      *                                                                   CFT009
      ** Define full account for IBAN.                                    CFT009
      *                                                                   CFT009
     I***WIACNT*     DS                             18                                 CFT009 CGL029
     IWIACNT      DS                             24                                           CGL029
     I**********                              1   60WICNUM                             CFT009 CSD027
     I                                        1   6 WICNUM                                    CSD027
     I                                        7   9 WICCY                 CFT009
     I**********                             10  130WIACOD                             CFT009 CGL029
     I**********                             14  150WIACSQ                             CFT009 CGL029
     I**********                             16  18 WIBRCA                             CFT009 CGL029
     I                                       10  190WIACOD                                    CGL029
     I                                       20  210WIACSQ                                    CGL029
     I                                       22  24 WIBRCA                                    CGL029
     I*                                                                   CFT004
      *                                                                   CFT002
      *  Defined Constants                                                CFT002
      *                                                                   CFT002
     I              'PRIME NOSTRO       ' C         #PRIME                CFT002
     I              '0123456789.'         C         @CHK                  CGL009
     I              '123456789'           C         @NUL                  CGL009
     I              'FTM1011CT'           C         H101CV                CFT006
     I              'FTM1012CT'           C         C101CV                CFT006
     I              'FTM101UPD'           C         H101UP                CFT006
     I              'FTM1011VL'           C         H101VL                CFT006
     I              'FTM1012VL'           C         C101VL                CFT006
     I              'FTM101UPP'           C         A101PS                177674
      *
     I              'FTM1021CT'           C         H102CV                CFT006
     I              'FTM1022CT'           C         C102CV                CFT006
     I              'FTM102UPD'           C         H102UP                CFT006
     I              'FTM1021VL'           C         H102VL                CFT006
     I              'FTM1022VL'           C         C102VL                CFT006
     I              'FTM102UPP'           C         A102PS                177674
     I              'FTVHDAM01'           C         U102SM                177674
      *
     I              75                    C         ARRMAX                CFT006
     I              '03'                  C         NBS101                CFT006
     I              '02'                  C         NBS102                CFT006
      *
     ISDWLCC    E DSSDWLCCPD                                                                  CSD015
      ** Watch list checking details                                                          CSD015
      *                                                                                       CSD015
     ISDCWCD    E DSSDCWCDPD                                                                  CSD015
      ** DS For Watch List Configuration Data File                                            CSD015
      *                                                                                       CSD015
     ISDSTAT    E DSSDSTAT                                                                    CSD015
      ** SD data area                                                                         CSD015
     ISC24X7    E DSSC24X7                                                                    CSD015
      **  24X7 status data area                                                               CSD015
     IPDS1      E DSSDWLTOPD                                                                  CSD015
      ** Compliance watch engine program 1st data parameter                                   CSD015
      *                                                                                       CSD015
     IPSTRNG      DS                           9999                                           CSD015
      ** Compliance watch engine program 2nd parameter                                        CSD015
      *                                                                                       CSD015
     ICPYR@#      DS
      *
      *  Data structure for compilation  - Copyright insertion
      *
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
      *
     I/COPY FTCPYSRC,SRERRI
      *
      *  End of Program Error Processing copysource member
      *
     I/COPY MECPYSRC,SME1100P
     E/COPY FTCPYSRC,SFTVALDI
     I/COPY FTCPYSRC,SFT0340S
     I/COPY FTCPYSRC,SFT0340F
     I/COPY FTCPYSRC,SFT0340I
     I/COPY FTCPYSRC,SFT0345S5
     I/COPY FTCPYSRC,SFT0345F5
     I/COPY FTCPYSRC,SFT0345I5
     I/COPY FTCPYSRC,SFT0345S6
     I/COPY FTCPYSRC,SFT0345F6
     I/COPY FTCPYSRC,SFT0345I6
     I/COPY FTCPYSRC,SFT0345S7                                            CFT014
     I/COPY FTCPYSRC,SFT0345F7                                            CFT014
     I/COPY FTCPYSRC,SFT0345I7                                            CFT014
     I/COPY FTCPYSRC,SFT0350S
     I/COPY FTCPYSRC,SFT0350F
     I/COPY FTCPYSRC,SFT0350I
     I/COPY FTCPYSRC,SFT0355S2
     I/COPY FTCPYSRC,SFT0355F2
     I/COPY FTCPYSRC,SFT0355I2
     I/COPY FTCPYSRC,SFT0355S3
     I/COPY FTCPYSRC,SFT0355F3
     I/COPY FTCPYSRC,SFT0355I3
     I/COPY FTCPYSRC,SFT0355S0                                            CFT014
     I/COPY FTCPYSRC,SFT0355F0                                            CFT014
     I/COPY FTCPYSRC,SFT0355I0                                            CFT014
     I/COPY FTCPYSRC,FT0010I001                                           CGL009
     I/COPY FTCPYSRC,FT0300I001                                           CFT006
     I/COPY FTCPYSRC,SFT0345FC                                                                CSW209
     I/COPY FTCPYSRC,SFT0345FD                                                                CSW209
     I/COPY FTCPYSRC,SFT0345IC                                                                CSW209
     I/COPY FTCPYSRC,SFT0345ID                                                                CSW209
     I/COPY FTCPYSRC,SFT0345SC                                                                CSW209
     I/COPY FTCPYSRC,SFT0345SD                                                                CSW209
     I/COPY FTCPYSRC,SFT0355FA                                                                CSW209
     I/COPY FTCPYSRC,SFT0355FB                                                                CSW209
     I/COPY FTCPYSRC,SFT0355IA                                                                CSW209
     I/COPY FTCPYSRC,SFT0355IB                                                                CSW209
     I/COPY FTCPYSRC,SFT0355SA                                                                CSW209
     I/COPY FTCPYSRC,SFT0355SB                                                                CSW209
      *                                                                   CGL009
     II35         DS                                                      CGL009
     I                                        1  35 @I35                  CGL009
     IO35         DS                                                      CGL009
     I                                        1  35 @O35                  CGL009
     IR1          DS                                                      CGL009
     I                                        1  13 @R1                   CGL009
      *                                                                   CGL009
     ISWDT2       DS                              6
      *
      *  Data structure for date change
      *
     I                                        1   2 DD
     I                                        3   4 MM
     I                                        5   6 YY
      *
     IRUNDTA    E DSRUNDAT
      *
      *  Define rundat data area
      *
     IMEDTA     E DSMEDTA
      *
      *  Message Management Data Area
      *
     IMEFTPP    E DSMEFTPPDA                                              CGL009
      *                                                                   CGL009
      *  FONTIS TPP Data Area                                             CGL009
      *                                                                   CGL009
     IZMUSER    E DSZMUSER
      *
      **  Data structure to retrieve default branch
      *
     I***OTPAYD    E DSOTPAYDA                                                                CFT151
     IOTPAYD      DS                                                                          CFT151
     I                                        1   40WOTSQ                                     CFT151
      *
      **  Data structure to Outgoing sequence
      *
     IRGPAYD    E DSRGPAYDA
      *
      **  Data structure to Regular Payment sequence
      *
     IINPAYD      DS                              4
     I                                        1   40ISQNM
      *
      **  Data structure to Incoming Payment sequence
      *
     ISCSARD    E DSSCSARDPD                                              122060
      *                                                                   122060
      * Switchable Features Descriptions *                                122060
      *                                                                   122060
     ISDMMOD    E DSSDMMODPD
      *
      * Modules Data Structure *
      *
     ISDBRCH    E DSSDBRCHPD
      *
      * Branch Data Structure *
      *
     ISDCURR    E DSSDCURRPD
      *
      * Currency details      *
      *
     ISDBANK    E DSSDBANKPD
      *
      * Bank details Structure *
      *
     ISDGELR    E DSSDGELRPD
     I              QQACCD                          QQACD1                                    CGL029
      *
      * General Ledger Details *
      *
     ISDFTFR    E DSSDFTFRPD
      *
      * Funds Transfer Details *
      *
     ISDRETL    E DSSDRETLPD                                              S01194
     I              QQACCD                          QQACD2                                    CGL029
      *
      * Retail Details *
      *
     ISDTRAD    E DSSDTRADPD                                              S01194
     I              QQACCD                          QQACD3                                    CGL029
      *
      * Trading Data details
      *
     ISDDLST    E DSSDDLSTPD
      *
      * Deal Sub-types        *
      *
     ISDBOOK    E DSSDBOOKPD
      *
      * Book codes            *
      *
     ISDPRFC    E DSSDPRFCPD
      *
      * Profit Centres        *
      *
     ISDCUST    E DSSDCUSTPD                                              130869
     I              QQDFAC                          DFACQQ                                    CGL029
      *                                                                   130869
      ** Customer Details                                                 130869
      *                                                                   130869
     ISDFONT    E DSSDFONTPD                                              CGL009
      *                                                                   CGL009
      ** FONTIS Installation Control Data                                 CGL009
      *                                                                   CGL009
     ISDLOCN    E DSSDLOCNPD                                                                  CFT017
      ** Location code details                                                                CFT017
      *                                                                                       CFT017
     ISDCTRY    E DSSDCTRYPD                                                                  CFT017
      ** Country code details                                                                 CFT017
      *                                                                                       CFT017
     IINFT      E DSMEINFTPD
      *
      * Define parameters to be passed for FT IMM update
      *
     IINLF      E DSMEINLFPD
      *
      * Define parameters to be passed for FT IMM update
      *
     IT#CNTL      DS                            256
      *
      *  Input parameters data structure from FT0005
      *
     I                                        1   1 T#PDTI
     I                                        2   3 T#CCYI
     I                                        4   4 T#GLUI
     I                                        5   5 T#TPCI
      *
     IQ#DTA       DS                            256
      *
      *  Calling parameter data structure for AOSPOSU0
      *
     I                                        1   1 Q#ATYP
     I**********                              2  19 Q#ACCT                                    CGL029
     I**********                              2   70Q#CNU1                                 AR1089518
     I                                        2   7 Q#CNU1                                 AR1089518
     I                                        8  10 Q#CCY1
     I**********                             11  140Q#ACO1                                    CGL029
     I                                       15  160Q#ACS1
     I                                       17  19 Q#BRC1
     I                                        2   30Q#NOSN
     I                                        2   6 Q#NOS
     I                                        2  110Q#ACNO
     I**********                              2   70Q#CNUM                                 AR1089518
     I                                        2   7 Q#CNUM                                 AR1089518
     I**********                              8  110Q#ACOD                                    CGL029
     I                                       12  130Q#ACSQ
     I                                       14  16 Q#BRCA
     I                                       24  24 Q#IO
     I                                       25  27 Q#CCY
     I                                       28  29 Q#TRYP
     I                                       30  59 Q#NARR
     I                                       60  670Q#CHQN
     I                                       68  82 Q#PREF
     I                                       83  88 Q#TRN
     I                                    P  89  960Q#AMT
     I                                       97  97 Q#PRON
     I                                       98  98 Q#OLPS
     I                                       99  99 Q#MEMS
     I                                      100 100 Q#RSAC
     I                                      101 102 Q#MOD
     I                                      103 104 Q#OLRC
     I                                      105 105 Q#FTOV
     I                                    P 106 1080Q#VDAT
     I                                    P 109 1110Q#PSTD
     I                                      112 112 Q#PSTO
     I                                      113 113 Q#RPST                CFT014
     I                                      114 1160Q#RPNB                CFT014
     I                                      117 117 Q#RTYP                CFT014
     I                                      118 120 Q#BBRN                                    CGL029
     I                                      121 1300Q#ACO1                                    CGL029
     I                                      131 1400Q#ACOD                                    CGL029
     I                                      141 160 Q#OTR1                                    CAP204
     I                                      161 161 Q#MTYP                                    CAP205
      *                                                                                       CLE134
      ** Exception Reference Id/Number                                                        CLE134
      *                                                                                       CLE134
     I                                      162 164 Q#XRFI                                    CLE134
     I                                      165 1740Q#XRFN                                    CLE134
      *
      *
      ** Full General Ledger - CNUM/CCC/ACOD/ACSQ/BRCA                                        HVB005
     I            DS                                                                          HVB005
     I*****                                   1  24 Q#ACCT                           HVB005  MD31937
     I                                        1  24 W#ACCT                                   MD31937
     I*****                                   1  100W#ACNO                           HVB005  MD31937
     I                                        1  100W#ACNN                                   MD31937
     I                                        1   5 W#NOS                                     HVB005
     I                                        1   20W#NOSN                                    HVB005
     I*****                                   1   60W#CNU1                           HVB005  MD31937
     I                                        1   6 W#CNU1                                   MD31937
     I                                        7   9 W#CCY1                                    HVB005
     I                                        7  160W#ACOD                                    HVB005
     I                                       17  180W#ACSQ                                    HVB005
     I                                       10  190W#ACO1                                    HVB005
     I                                       20  210W#ACS1                                    HVB005
     I                                       22  24 W#BRC1                                    HVB005
      *                                                                                       HVB005
      ** Partial Account - CNUM/ACOD/ACSQ/BRCA                                                HVB005
     I*****                                   1   60P#CNUM                           HVB005  MD31937
     I                                        1   6 P#CNUM                                   MD31937
     I                                        7  160P#ACOD                                    HVB005
     I                                       17  180P#ACSQ                                    HVB005
     I                                       19  21 P#BRCA                                    HVB005
      *                                                                                       HVB005
     II#DTA       DS                            256
      *
      *  Report parameters data structure for ME1140
      *
      *           Spool file name (if blank, name unchanged).
      *                 N.B. To change name I#SPLR must be Y
      *
     I                                        1  10 I#SPLN
      *
      *           Repeat open and close of spool file
      *                 If Y create new spool file
      *
     I                                       11  11 I#SPLR
      *
      *           Report Reference if Access checking is off
      *
     I                                       12  21 I#REFN
      *
      *           Report Override Flag / Page No.
      *
     I                                       22  22 I#ROVR
     I                                       23  250I#PAGE
      *
      *           Report Title/Underline (uses msg ID on MEMSG)
      *
     I                                       26  32 I#TITL
     I                                       33  39 I#TUL
      *
      *           Report Formats to print
      *           Each character denotes a format option.
      *
     I                                       40  49 I#RFMT
      *
      *           Branch
      *
     I                                       50  52 I#BRCA
      *
      *           Incoming Message Ref./Part No.
      *
     I                                       53  600I#MSGR
     I                                       61  630I#PART
     I            DS
      *  Currency, amounts and rates
     I                                        1  48 R#RCHK
     I                                        1   3 R#SMCY
     I                                        4   6 R#PCCY
     I                                        7  190R#SMAM
     I                                       20  320R#PYAM
     I                                       33  458R#RATE
     I                                       46  46 R#OVRD
     I                                       47  48 R#STMT
      *
      * Data Structures used by Access Programs
      *
     IIPREF       DS                             15
      *
      *  Data structure create Payment reference
      *
     I                                        1   1 W#P
     I                                        2   70W#MRDT
     I*****************                       8  110W#PRNM                                  CFT151
     I                                        8  11 W#PRNM                                  CFT151
     I                                       12  13 W#PYTP
     I                                       14  15 W#STMT
     I/COPY WNCPYSRC,FTH00080
      *
      *
      *  Calling parameter data structure for AOCCYCV0
      *
     ID#DTA       DS                            256
      *                                       From Currency & amount
     I                                        1   3 D#FCCY
     I                                    P   4  110D#FAMT
      *                                       To Currency & amount
     I                                       12  14 D#TCCY
     I                                    P  15  220D#TAMT
      *                                       Rate and multi/div ind.
     I                                       23  23 I#MDIN
     I                                    P  24  368I#RATE
      *                            Output     Rate and multi/div ind.
      *                                       If no in rate
     I                                       37  37 O#MDIN
     I                                    P  38  508O#RATE
     IDSFDY     E DSDSFDY
      *
      * Data Structures used by Access Programs
      *
     IDSSDY     E DSDSSDY
      *
      * Data Structures used by Access Programs
      *
     IDSMTR       DS
      *
      *  Define fields for message transalation
      *
     I                                        1 132 #MSDTA
     I                                       15  30 #MPREF
     I                                    P   1   20#MPART
     I                                      133 264 #MSTX1
     I#MSTX2      DS
     I                                        1 256 #MSTXA
     I                                      257 512 #MSTXB
      *
      *  Repair Tag Description
      *                                                                   CFT002
     IPRFDDT      DS                                                      CFT002
     I                                        1 256 WRFDDT                CFT002
     I                                        6 256 WRTGVL                CFT002
      *                                                                   CFT014
      *  Lines of first line of tag                                       CFT014
      *                                                                   CFT014
     ILFLTDS      DS                                                      CFT014
     I                                        1 295 LFLT                  CFT014
     I                                        1  24 BG1                   CFT014
     I                                       25  59 TV1                   CFT014
     I                                       60  83 BG2                   CFT014
     I                                       84 118 TV2                   CFT014
     I                                      119 142 BG3                   CFT014
     I                                      143 177 TV3                   CFT014
     I                                      178 201 BG4                   CFT014
     I                                      202 236 TV4                   CFT014
     I                                      237 260 BG5                   CFT014
     I                                      261 295 TV5                   CFT014
      *                                                                   CFT009
      *  Incoming Payments Details data structure                         CFT009
      *                                                                   CFT009
     IINPYDS    E DSINPAYDD                                               CFT009
     I              RECI                            IPRECI                CFT009
     I              LCD                             IPLCD                 CFT009
     I              CHTP                            IPCHTP                CFT009
     I              BRCA                            IPBRCA                CFT009
     I              PRFC                            IPPRFC                CFT009
     I              TRCM                            INTRCM                CFT009
     I              TXCH                            INTXCH                CFT009
     I              CQCH                            INCQCH                CFT009
     I              ADCH                            INADCH                CFT009
     I              TLCH                            INTLCH                CFT009
     I              MSCH                            INMSCH                CFT009
     I              INCHCM                          IPCHCM                CFT009
     I              INVATT                          IPVATT                CFT009
     I              INDUM8                          IPDUM8                CFT009
     I              INVAT1                          IPVAT1                CFT009
     I              INVAT2                          IPVAT2                CFT009
     I              INVAT3                          IPVAT3                CFT009
     I              INVAT4                          IPVAT4                CFT009
     I              INVAT5                          IPVAT5                CFT009
     I              INVAT6                          IPVAT6                CFT009
     I              INVAT7                          IPVAT7                CFT009
     I              INVATR                          IPVATR                CFT009
     I              DUMA1                           IDUMA1                CFT009
     I              DUMA2                           IDUMA2                CFT009
     I              DUMA3                           IDUMA3                CFT009
     I              DUMA4                           IDUMA4                CFT009
     I              DUMA5                           IDUMA5                CFT009
     I              DUMA6                           IDUMA6                CFT009
     I              INDUM7                          IPDUM7                CFT009
     I              INMSGR                          IPMSGR                CFT009
     I              INKPRT                          IPKPRT                CFT009
     I              FRNT                            IPFRNT                CFT009
     I              REPA                            IPREPA                CFT009
     I              TMST                            IPTMST                                    CPK014
      *                                                                   CFT009
      *  Incoming Payments Details Extension data structure               CFT009
      *                                                                   CFT009
     IINPXDS    E DSINPAYXPD                                              CFT009
     I              FXSPSC                          IFXSPS                CFT009
     I              INPDOF                          IPPDOF                CFT009
     I              TLCODE                          ITLCOD                CFT009
     I              CHCHCD                          ICHCHC                CFT009
     I              ADCHCD                          IADCHC                CFT009
     I              TLCHCD                          ITLCHC                CFT009
     I              MISCH                           IMISCH                CFT009
     I              MSCH1                           IMSCH1                CFT009
     I              MSCH2                           IMSCH2                CFT009
     I              MSCH3                           IMSCH3                CFT009
     I              MSCH4                           IMSCH4                CFT009
     I              MSCH5                           IMSCH5                CFT009
     I              TFCCCO                          ITFCCC                CFT009
     I              FXCHEC                          IFXCHE                CFT009
     I              VTMIC1                          IVTMI1                CFT009
     I              VTMIC2                          IVTMI2                CFT009
     I              VTMIC3                          IVTMI3                CFT009
     I              VTMIC4                          IVTMI4                CFT009
     I              VTMIC5                          IVTMI5                CFT009
     I              CMSC01                          IMSC01                CFT009
     I              CMSC02                          IMSC02                CFT009
     I              CMSC03                          IMSC03                CFT009
     I              CMSC04                          IMSC04                CFT009
     I              CMSC05                          IMSC05                CFT009
     I              MSC01                           ILMSC1                CFT009
     I              MSC02                           ILMSC2                CFT009
     I              MSC03                           ILMSC3                CFT009
     I              MSC04                           ILMSC4                CFT009
     I              MSC05                           ILMSC5                CFT009
     I              DATNOE                          IDATNO                CFT009
     I              DATNAH                          IDATNA                CFT009
     I              CUNFLG                          ICUNFL                CFT009
     I              INCHRT                          IPCHRT                CFT009
     I              INCHGC                          IPCHGC                CFT009
      *                                                                   CFT009
      *  Outgoing Payments Details data structure                         CFT009
      *                                                                   CFT009
     IOTPYDS    E DSOTPAYDD                                               CFT009
     I              RECI                            OTRECI                CFT009
     I              PREF                            OTPREF                CFT009
     I              PYTP                            OTPYTP                CFT009
     I              PYST                            OTPYST                CFT009
     I              SNCT                            OTSNCT                CFT009
     I              ORBT                            OTORBT                CFT009
     I              ORCT                            OTORCT                CFT009
     I              ORC1                            OTORC1                CFT009
     I              ORC2                            OTORC2                CFT009
     I              ORC3                            OTORC3                CFT009
     I              ORC4                            OTORC4                CFT009
     I              SMAM                            OTSMAM                CFT009
     I              SMAMD                           OTSMMD                CFT009
     I              SMCY                            OTSMCY                CFT009
     I              MDIN                            OTMDIN                CFT009
     I              RATE                            OTRATE                CFT009
     I              RATED                           OTRATD                CFT009
     I              OVRD                            OTOVRD                CFT009
     I              PYAM                            OTPYAM                CFT009
     I              PYAMD                           OTPYMD                CFT009
     I              PCCY                            OTPCCY                CFT009
     I              SLDT                            OTSLDT                CFT009
     I              SLDTD1                          OTSLD1                CFT009
     I              SLDTD2                          OTSLD2                CFT009
     I              SLDTD3                          OTSLD3                CFT009
     I              PVDT                            OTPVDT                CFT009
     I              PVDTD1                          OTPVD1                CFT009
     I              PVDTD2                          OTPVD2                CFT009
     I              PVDTD3                          OTPVD3                CFT009
     I              ADDC                            OTADDC                CFT009
     I              SWPC                            OTSWPC                CFT009
     I              RCRT                            OTRCRT                CFT009
     I              ACBT                            OTACBT                CFT009
     I              BNCT                            OTBNCT                CFT009
     I              BNC1                            OTBNC1                CFT009
     I              BNC2                            OTBNC2                CFT009
     I              BNC3                            OTBNC3                CFT009
     I              BNC4                            OTBNC4                CFT009
     I              BNC5                            OTBNC5                CFT009
     I              DTP1                            OTDTP1                CFT009
     I              DTP2                            OTDTP2                CFT009
     I              DTP3                            OTDTP3                CFT009
     I              DTP4                            OTDTP4                CFT009
     I              BBI1                            OTBBI1                CFT009
     I              BBI2                            OTBBI2                CFT009
     I              BBI3                            OTBBI3                CFT009
     I              BBI4                            OTBBI4                CFT009
     I              BBI5                            OTBBI5                CFT009
     I              BBI6                            OTBBI6                CFT009
     I              DNBC                            OTDNBC                CFT009
     I              TRCT                            OTTRCT                CFT009
     I              TRCM                            OTTRCM                CFT009
     I              TRCMD                           OTTRCZ                CFT009
     I              TXCH                            OTTXCH                CFT009
     I              TXCHD                           OTTXCD                CFT009
     I              CQCH                            OTCQCH                CFT009
     I              CQCHD                           OTCQCD                CFT009
     I              CSTA                            OTCSTA                CFT009
     I              CSTAD                           OCSTAD                CFT009
     I              SPCH                            OTSPCH                CFT009
     I              SPCHD                           OSPCHD                CFT009
     I              MSCH                            OTMSCH                CFT009
     I              MSCHD                           OTMSCD                CFT009
     I              OPCHCM                          OTCHCM                CFT009
     I              CDRT                            OTCDRT                CFT009
     I              CDROQQ                          OTCDR#                                    CGL029
     I              CDRO                            OTCDRO                CFT009
     I              LCHT                            OTLCHT                CFT009
     I              LCD                             OTLCD                 CFT009
     I              CHTP                            OTCHTP                CFT009
     I              AUP1                            OTAUP1                CFT009
     I              AUP2                            OTAUP2                CFT009
     I              AUIN                            OTAUIN                CFT009
     I              IACG                            OTIACG                CFT009
     I              SACG                            OTSACG                CFT009
     I              PACG                            OTPACG                CFT009
     I              SMSG                            OTSMSG                CFT009
     I              PMSG                            OTPMSG                CFT009
     I              OEDT                            OTOEDT                CFT009
     I              OEDTD1                          OTOED1                CFT009
     I              OEDTD2                          OTOED2                CFT009
     I              OEDTD3                          OTOED3                CFT009
     I              ADIN                            OTADIN                CFT009
     I              RLPR                            OTRLPR                CFT009
     I              INBT                            OTINBT                CFT009
     I              INB1                            OTINB1                CFT009
     I              INB2                            OTINB2                CFT009
     I              INB3                            OTINB3                CFT009
     I              INB4                            OTINB4                CFT009
     I              INB5                            OTINB5                CFT009
     I              LVL1                            OTLVL1                EEE058
     I              SBCQ                            OTSBCQ                CFT009
     I              PBCQ                            OTPBCQ                CFT009
     I              OPIN                            OTOPIN                CFT009
     I              INUSR1                          OTINU1                CFT009
     I              INUSR2                          OTINU2                CFT009
     I              DUMA1                           ODUMA1                CFT009
     I              DUMA2                           ODUMA2                CFT009
     I              DUMA3                           ODUMA3                CFT009
     I              DUMA4                           ODUMA4                CFT009
     I              DUMA5                           ODUMA5                CFT009
     I              DUMA6                           ODUMA6                CFT009
     I              OPDUM7                          OTDUM7                CFT009
     I              BRCA                            OTBRCA                CFT009
     I              ORBR                            OTORBR                CFT009
     I              CDBR                            OTCDBR                CFT009
     I              BOKC                            OTBOKC                CFT009
     I              PRFC                            OTPRFC                CFT009
     I              FXMP                            OTFXMP                CFT009
     I              FXMD                            OTFXMD                CFT009
     I              MBSI                            OTMBSI                CFT009
     I              MSIG                            OTMSIG                CFT009
     I              MAMT                            OTMAMT                CFT009
     I              NDCY                            OTNDCY                CFT009
     I              NDAM                            OTNDAM                CFT009
     I              FRNT                            OTFRNT                CFT009
     I              REPA                            OTREPA                CFT009
     I              DTCH                            OTDTCH                CFT009
     I              OPVAT1                          OTVAT1                CFT009
     I              OPVAT2                          OTVAT2                CFT009
     I              OPVAT3                          OTVAT3                CFT009
     I              OPVAT4                          OTVAT4                CFT009
     I              OPVAT5                          OTVAT5                CFT009
     I              OPVAT6                          OTVAT6                CFT009
     I              OPVAT7                          OTVAT7                CFT009
     I              OPVATR                          OTVATR                CFT009
     I              OPVATT                          OTVATT                CFT009
     I              OPDUM8                          OTDUM8                CFT009
     I              OPMSGR                          OTMSGR                CFT009
     I              OPKPRT                          OTKPRT                CFT009
     I              FDLR                            OTFDLR                CFT009
     I              TMST                            OTTMST                                    CPK014
     I              ORC5                            OTORC5                                    CFT032
     I              ODMTT                           OTODTT                                    CFT032
     **                                                                                      MD31937
     ****  Changes CFT157 introduced by SP6 for BF Midas 2.1 added extra fields but          MD31937
     **    these fields are not included in this program.                                    MD31937
     I              DATE                            OTDATE                                   MD31937
     I              SUSR                            OTSUSR                                   MD31937
     I              SAUS                            OTSAUS                                   MD31937
      *                                                                   CFT009
      *  Outgoing Payments Details Extension data structure               CFT009
      *                                                                   CFT009
     IOTPXDS    E DSOTPAYXPD                                              CFT009
     I              OTPDOF                          OPPDOF                CFT009
     I              FXSRSC                          OFXSRS                CFT009
     I              TLXCDE                          OTLXCD                CFT009
     I              CHQCHC                          OCHQCH                CFT009
     I              CACHCD                          OCACHC                CFT009
     I              SSTCCD                          OSSTCC                CFT009
     I              SPRCCD                          OSPRCC                CFT009
     I              MSCHC                           OMSCHC                CFT009
     I              MSCHC1                          OMSCH1                CFT009
     I              MSCHC2                          OMSCH2                CFT009
     I              MSCHC3                          OMSCH3                CFT009
     I              MSCHC4                          OMSCH4                CFT009
     I              MSCHC5                          OMSCH5                CFT009
     I              TFCCCD                          OTFCCD                CFT009
     I              FXCACC                          OFXCAC                CFT009
     I              VTSWSC                          OVTSWS                CFT009
     I              VMIC1                           OVMIC1                CFT009
     I              VMIC2                           OVMIC2                CFT009
     I              VMIC3                           OVMIC3                CFT009
     I              VMIC4                           OVMIC4                CFT009
     I              VMIC5                           OVMIC5                CFT009
     I              MISC01                          OMISC1                CFT009
     I              MISC02                          OMISC2                CFT009
     I              MISC03                          OMISC3                CFT009
     I              MISC04                          OMISC4                CFT009
     I              MISC05                          OMISC5                CFT009
     I              MISCC1                          OPMIC1                CFT009
     I              MISCC2                          OPMIC2                CFT009
     I              MISCC3                          OPMIC3                CFT009
     I              MISCC4                          OPMIC4                CFT009
     I              MISCC5                          OPMIC5                CFT009
     I              SWSCHG                          OSWSCH                CFT009
     I              SWSCCC                          OSWSCC                CFT009
     I              DATNED                          ODATNE                CFT009
     I              DATNAO                          ODATNA                CFT009
     I              CUNFLA                          OCUNFL                CFT009
     I              OPCHRT                          OTCHRT                CFT009
     I              OPCHGC                          OTCHGC                CFT009
      *                                                                   CFT009
      *  Parameter string for FTVNCWD                                     CFT009
      *                                                                   CFT009
     ISTRIN       DS                            420                       CFT009
      *                                                                   CFT009
      *  Transaction details file parameter for FT000980                  CFT009
      *                                                                   CFT009
     ITRNDET      DS                           3000                       CFT009
      *                                                                   CFT009
      *  Transaction details extension file parameter for FT000980        CFT009
      *                                                                   CFT009
     ITRNEXT      DS                           3000                       CFT009
     I                                       18  18 O#AUTO                MK0524
      *                                                                   CFT009
     IVATDS       DS                                                      CFT009
      ** Calling parameter to AOVATR0                                     CFT009
     I                                        1   3 I#BRCX                CFT009
     I                                        4   9 I#CUST                CFT009
     I                                    P  10  124O#VATR                CFT009
     I*                                                                   CFT009
     I            DS                                                                          CSD015
     I                                        1  12 ORDBK                                     CSD015
     I                                        1   2 NORBK                                     CSD015
     I                                        1  10 RORBK                                     CSD015
      *                                                                   S01408
     I/COPY WNCPYSRC,FT0300IIP1                                           S01408
      *                                                                   S01408
     IHDRRD1    E DSFT101HPD                                                                  212229
     I              RFTID                           H1FTID                                    212229
     I              STID                            H1STID                                    212229
     I              SNDREF                          H1SNDR                                    212229
     I              PYTP                            H1PYTP                                    212229
     I              PYST                            H1PYST                                    212229
     I              BRCA                            H1BRCA                                    212229
     I              ORBR                            H1ORBR                                    212229
     I              BOKC                            H1BOKC                                    212229
     I              PRFC                            H1PRFC                                    212229
     I              RFTDST                          THDEST                                    212229
     I              CUSTRF                          H1CUSR                                    212229
     I              HINPTY                          H1INPY                                    212229
     I              HOCUS1                          H1OCU1                                    212229
     I              HOCUS2                          H1OCU2                                    212229
     I              HOCUS3                          H1OCU3                                    212229
     I              HOCUS4                          H1OCU4                                    212229
     I              HOCUS5                          H1OCU5                                    212229
     I              CUSTTP                          H1OCUT                                    212229
     I              ASITTP                          H1ASIT                                    212229
     I              HACSV1                          H1ASI1                                    212229
     I              HACSV2                          H1ASI2                                    212229
     I              SINST                           H1INST                                    212229
     I              EXDATE                          H1EXDT                                    212229
     I              DBTVDT                          H1TVDT                                    212229
     I              AUTHTX                          H1AUTX                                    212229
     I              HANDCG                          H1HDCG                                    212229
     I              HANDCY                          H1HDCY                                    212229
     I              HANDAC                          H1HDAC                                    212229
     I              SWPRIO                          H1SWPR                                    212229
     I              INUSER                          H1INUS                                    212229
     I              INDATE                          H1INDT                                    212229
     I              INTIME                          H1INTM                                    212229
     I              UPDUSR                          H1UUSR                                    212229
     I              UPDDTE                          H1UDTE                                    212229
     I              UPDTIM                          H1UTIM                                    212229
     I              AUP1                            H1AUP1                                    212229
     I              AUP2                            H1AUP2                                    212229
     I              RDUAL                           H1DVAL                                    212229
     I              AUIN                            H1AUIN                                    212229
     I              BAUTH                           H1BAUT                                    212229
     I              BATUSR                          H1BUSR                                    212229
     I              ADVCRT                          H1ADCR                                    212229
     I              TOTDBT                          H1TODB                                    212229
     I              GEN101                          H1GNMS                                    212229
     I              AKEYHC                          H1KEYC                                    212229
     I              AKEYAL                          H1KYAL                                    212229
     I              CSEQNO                          H1SQNO                                    212229
     I              RHMSGR                          H1MSGR                                    212229
     I              FXSRST                          H1FXSS                                    212229
     I              SWSTCC                          H1SSCC                                    212229
     I              SWPRCC                          H1SPCC                                    212229
     I              SWSTDC                          H1SSDC                                    212229
     I              SWPRIC                          H1SPRC                                    212229
     I              OMICC1                          H1OCC1                                    212229
     I              OMICC2                          H1OCC2                                    212229
     I              OMICC3                          H1OCC3                                    212229
     I              OMICC4                          HIOCC4                                    212229
     I              OMICC5                          H1OCC5                                    212229
     I              OMIC1                           H1OMC1                                    212229
     I              OMIC2                           H1OMC2                                    212229
     I              OMIC3                           H1OMC3                                    212229
     I              OMIC4                           H1OMC4                                    212229
     I              OMIC5                           H1OMC5                                    212229
     I              VOMIC1                          H1VMC1                                    212229
     I              VOMIC2                          H1VMC2                                    212229
     I              VOMIC3                          H1VMC3                                    212229
     I              VOMIC4                          H1VMC4                                    212229
     I              VOMIC5                          H1VMC5                                    212229
     I              VSSCH                           H1VSSC                                    212229
     I              VSPCH                           H1VSPC                                    212229
     I              VATRAT                          H1VRAT                                    212229
     I              VATAMO                          H1VAMT                                    212229
     I              RSEQNO                          H1RSEQ                                    221761
     I              QQNDAC                          H1NDAC                                    212229
     IDTLRD1    E DSFT101DPD                                                                  212229
     I              RFTID                           D1TID                                     212229
     I              TRNSID                          D1TRNI                                    212229
     I              FXDREF                          D1FXRF                                    212229
     I              INSCA4                          D1INAS                                    212229
     I              INSCB4                          D1INBS                                    212229
     I              INSCC4                          D1INCS                                    212229
     I              INSCD4                          D1INDS                                    212229
     I              INSCE4                          D1INES                                    212229
     I              INSA31                          D1INAL                                    212229
     I              INSB31                          D1INBL                                    212229
     I              TRNCCY                          D1TFCY                                    212229
     I              TRNAMT                          D1TFAM                                    212229
     I              PAYCCY                          D1PYCY                                    212229
     I              PAYAMT                          D1PYAM                                    212229
     I              PYBCQS                          D1PYBQ                                    212229
     I              TFBCQS                          D1TFBC                                    212229
     I              XRATE                           D1XRAT                                    212229
     I              XRATEO                          D1XRTO                                    212229
     I              CRDVDT                          D1CRDV                                    212229
     I              TINPTY                          D1INPY                                    212229
     I              TOCUS1                          D1OCU1                                    212229
     I              TOCUS2                          D1OCU2                                    212229
     I              TOCUS3                          D1OCU3                                    212229
     I              TOCUS4                          D1OCU4                                    212229
     I              TOCUS5                          D1OCU5                                    212229
     I              DCUSTP                          D1OCUT                                    212229
     I              TASI35                          D1ASIL                                    212229
     I              TACC11                          D1AC11                                    212229
     I              TINST1                          D1INP1                                    212229
     I              TINST2                          D1INP2                                    212229
     I              TINST3                          D1INP3                                    212229
     I              TINST4                          D1INP4                                    212229
     I              TINST5                          D1INP5                                    212229
     I              TINSTA                          D1INPA                                    212229
     I              TACA35                          D1ACAL                                    212229
     I              TACB35                          D1ACBL                                    212229
     I              TACC35                          D1ACCL                                    212229
     I              TACD35                          D1ACDL                                    212229
     I              TACE35                          D1ACEL                                    212229
     I              TACA11                          D1TACS                                    212229
     I              TBNA35                          D1BNAL                                    212229
     I              TBNB35                          D1BNBL                                    212229
     I              TBNC35                          D1BNCL                                    212229
     I              TBND35                          D1BNDL                                    212229
     I              TBNE35                          D1BNEL                                    212229
     I              TRMA35                          D1RMAL                                    212229
     I              TRMB35                          D1RMBL                                    212229
     I              TRMC35                          D1RMCL                                    212229
     I              TRMD35                          D1RMDL                                    212229
     I              TRGA35                          D1RGAL                                    212229
     I              TRGB35                          D1RGBL                                    212229
     I              TRGC35                          D1RGCL                                    212229
     I              TOCCY                           D1TOCY                                    212229
     I              TOOAMT                          D1TAMT                                    212229
     I              TDCHGS                          D1CHGS                                    212229
     I              RCHCCY                          D1CHCY                                    212229
     I              RCVCHG                          D1RCCG                                    212229
     I              RCPCCY                          D1RCCY                                    212229
     I              RCPCHG                          D1PCHG                                    212229
     I              RCTCCY                          D1TCCY                                    212229
     I              RCTCHG                          D1TCHG                                    212229
     I              CHGACC                          D1CGAC                                    212229
     I              GOPFLG                          D1GEN                                     212229
     I              TFTRNT                          D1TRNT                                    212229
     I              TFTREF                          D1TREF                                    212229
     I              CQIN                            D1CQIN                                    212229
     I              CHQNUM                          D1CQNU                                    212229
     I              BENTTP                          D1BNTP                                    212229
     I              AWITTP                          D1AWIT                                    212229
     I              INTTTP                          D1INTT                                    212229
     I              INUSER                          D1IUSR                                    212229
     I              INDATE                          D1IDAT                                    212229
     I              INTIME                          D1ITIM                                    212229
     I              UPDUSR                          D1UUSR                                    212229
     I              UPDDTE                          D1UDAT                                    212229
     I              UPDTIM                          D1UTIM                                    212229
     I              AKEYID                          D1KYID                                    212229
     I              AKEYDD                          D1KYDD                                    212229
     I              AKEYCD                          D1KYCD                                    212229
     I              RFTMSQ                          D1TMSQ                                    212229
     I              RFTMSG                          D1TMRF                                    212229
     I              TSEQNO                          D1SQNO                                    212229
     I              TFCOCC                          D1TFCC                                    212229
     I              FXCCCD                          D1FXCC                                    212229
     I              IMICC1                          D1ICC1                                    212229
     I              IMICC2                          D1ICC2                                    212229
     I              IMICC3                          D1ICC3                                    212229
     I              IMICC4                          D1ICC4                                    212229
     I              IMICC5                          D1ICC5                                    212229
     I              FXCHGC                          D1FCCC                                    212229
     I              TRCHCC                          D1TCCC                                    212229
     I              IMICH1                          D1IMC1                                    212229
     I              IMICH2                          D1IMC2                                    212229
     I              IMICH3                          D1IMC3                                    212229
     I              IMICH4                          D1IMC4                                    212229
     I              IMICH5                          D1IMC5                                    212229
     I              VTFCCC                          D1VFXC                                    212229
     I              VTCOCH                          D1VTCO                                    212229
     I              VIMIC1                          D1VIM1                                    212229
     I              VIMIC2                          D1VIM2                                    212229
     I              VIMIC3                          D1VIM3                                    212229
     I              VIMIC4                          D1VIM4                                    212229
     I              VIMIC5                          D1VIM5                                    212229
     I              VATAMT                          D1VAMT                                    212229
     I              DTNOEN                          D1NOEN                                    212229
     I              DTNOAU                          D1NOAU                                    212229
     I              CUNOFL                          D1CUNF                                    212229
     I              M1CHRT                          D1CHRT                                    212229
     I              M1CHGC                          D1CHGC                                    212229
     I              FTZONE                          D1ZONE                                    212229
     IHDRRD2    E DSFT102HPD                                                                  212229
     I              CCTID                           H2DCCT                                    212229
     I              STID                            H2DSTI                                    212229
     I              FILREF                          H2DFRF                                    212229
     I              CCTTYP                          H2DTYP                                    212229
     I              CCTTST                          H2DTST                                    212229
     I              BRCA                            H2DBRC                                    212229
     I              ORBR                            H2DOBR                                    212229
     I              BOKC                            H2DBOK                                    212229
     I              PRFC                            H2DPRF                                    212229
     I              CCTBOC                          H2DBOC                                    212229
     I              SINST                           H2DSIN                                    212229
     I              SINSTT                          H2DSIT                                    212229
     I              CCTDST                          H2DDST                                    212229
     I              DSTTYP                          H2DDTP                                    212229
     I              TOCUS1                          H2DCU1                                    212229
     I              TOCUS2                          H2DCU2                                    212229
     I              TOCUS3                          H2DCU3                                    212229
     I              TOCUS4                          H2DCU4                                    212229
     I              CUSTTH                          H2DCUT                                    212229
     I              OINST3                          H2DOI3                                    212229
     I              OINST1                          H2DOI1                                    212229
     I              ORDITP                          H2DOIT                                    212229
     I              TRNSTP                          H2DSTP                                    212229
     I              REGRP1                          H2DRG1                                    212229
     I              REGRP2                          H2DRG2                                    212229
     I              REGRP3                          H2DRG3                                    212229
     I              CCTCHG                          H2DCHG                                    212229
     I              CCTRTE                          H2DRTE                                    212229
     I              BASTFR                          H2DTFR                                    212229
     I              CCTAMT                          H2DAMT                                    212229
     I              CCTCCY                          H2DCCY                                    212229
     I              TTVDTE                          H2DVDE                                    212229
     I              DBTVDT                          H2DDDE                                    212229
     I              SUMCCT                          H2DSCT                                    212229
     I              SUMSCG                          H2DSCG                                    212229
     I              SUMRCH                          H2DRCG                                    212229
     I              SNDCOR                          H2DSCO                                    212229
     I              SNDTYP                          H2DTY1                                    212229
     I              RCVCOR                          H2DRCO                                    212229
     I              RCVTYP                          H2DRCT                                    212229
     I              ADNLI1                          H2DAL1                                    212229
     I              ADNLI2                          H2DAL2                                    212229
     I              ADNLI3                          H2DAL3                                    212229
     I              ADNLI4                          H2DAL4                                    212229
     I              ADNLI5                          H2DAL5                                    212229
     I              ADNLI6                          H2DAL6                                    212229
     I              SWPRIO                          H2DSPR                                    212229
     I              INUSER                          H2DINU                                    212229
     I              INDATE                          H2DIND                                    212229
     I              INTIME                          H2DINT                                    212229
     I              UPDUSR                          H2DUPU                                    212229
     I              UPDDTE                          H2DUPD                                    212229
     I              UPDTIM                          H2DUPT                                    212229
     I              AUP1                            H2DAU1                                    212229
     I              AUP2                            H2DAU2                                    212229
     I              CDUAL                           H2DDUL                                    212229
     I              AUIN                            H2DAUI                                    212229
     I              BAUTH                           H2DBAT                                    212229
     I              BATUSR                          H2DBUS                                    212229
     I              AKDRIP                          H2DRIP                                    212229
     I              AKDRDR                          H2DRDR                                    212229
     I              ADVCRT                          H2DCRT                                    212229
     I              CCTTDB                          H2DTDB                                    212229
     I              GEN102                          H2D102                                    212229
     I              AKEY1C                          H2DKY1                                    212229
     I              AKEY1L                          H2DKY2                                    212229
     I              AKEYID                          H2DKY3                                    212229
     I              AKEYDD                          H2DKY4                                    212229
     I              AKEYCH                          H2DKY5                                    212229
     I              CSEQNO                          H2SQNO                                    212229
     I              CHMSGR                          H2MSGR                                    212229
     I              FXSSCD                          H2FXSC                                    212229
     I              SSTCHC                          H2SSCC                                    212229
     I              SPRCHC                          H2SPCC                                    212229
     I              SWSTAC                          H2STAC                                    212229
     I              SWPRIR                          H2PRIR                                    212229
     I              VSSTCH                          H2VSSC                                    212229
     I              VSPRCH                          H2VSPC                                    212229
     I              CCNWRK                          H2NWRK                                    CSW209
     I              CCMTPY                          H2MTPY                                    CSW209
     I              CCVALF                          H2VALF                                    CSW209
     I              CCOMVF                          H2OMVF                                    CSW209
     I              CCOCVF                          H2OCVF                                    CSW209
     IDTLRD2    E DSFT102DPD                                                                  212229
     I              CCTID                           D2DCCT                                    212229
     I              TRNSID                          D2DSTI                                    212229
     I              CCTAMT                          D2TAMT                                    212229
     I              CCTCCY                          D2TCCY                                    212229
     I              CRDVDT                          D2DVDT                                    212229
     I              ORDCU1                          D2ORC1                                    212229
     I              ORDCU2                          D2ORC2                                    212229
     I              ORDCU3                          D2ORC3                                    212229
     I              ORDCU4                          D2ORC4                                    212229
     I              CUSTTD                          D2ORCT                                    212229
     I              ORDI35                          D2ORIL                                    212229
     I              ORDI11                          D2ORIS                                    212229
     I              ORDITP                          D2ORIT                                    212229
     I              ACCI35                          D2ACBL                                    212229
     I              ACCI11                          D2ACBS                                    212229
     I              AWITP                           D2ACBT                                    212229
     I              BENF1                           D2BEN1                                    212229
     I              BENF2                           D2BEN2                                    212229
     I              BENF3                           D2BEN3                                    212229
     I              BENF4                           D2BEN4                                    212229
     I              BENF5                           D2BEN5                                    212229
     I              BENTTD                          D2BENT                                    212229
     I              REMI1                           D2REM1                                    212229
     I              REMI2                           D2REM2                                    212229
     I              REMI3                           D2REM3                                    212229
     I              REMI4                           D2REM4                                    212229
     I              CCTTYC                          D2TTYC                                    212229
     I              REGRP1                          D2RGR1                                    212229
     I              REGRP2                          D2RGR2                                    212229
     I              REGRP3                          D2RGR3                                    212229
     I              ORIGCY                          D2ORCY                                    212229
     I              ORIGAM                          D2ORAM                                    212229
     I              PAYCCY                          D2PYCY                                    212229
     I              PAYAMT                          D2PYAM                                    212229
     I              PYBCQS                          D2PYBQ                                    212229
     I              TFBCQS                          D2TFBQ                                    212229
     I              CCYCHG                          D2CYCH                                    212229
     I              SNDCHG                          D2SNCH                                    212229
     I              SNDCCY                          D2SNCY                                    212229
     I              SNDOCG                          D2SNOC                                    212229
     I              SNDCTF                          D2SNCF                                    212229
     I              RCVCHG                          D2RCCH                                    212229
     I              RCVCCY                          D2RCCY                                    212229
     I              RCVOCG                          D2RCOC                                    212229
     I              RCVCTF                          D2RCCF                                    212229
     I              CHGACC                          D2CGAC                                    212229
     I              XRATE                           D2XRAT                                    212229
     I              GOPFLG                          D2GNOP                                    212229
     I              XRATEO                          D2XRTO                                    212229
     I              TFTRNT                          D2TFTR                                    212229
     I              TFTREF                          D2TFRF                                    212229
     I              CQIN                            D2CQIN                                    212229
     I              CHQNUM                          D2CQNU                                    212229
     I              INUSER                          D2INUS                                    212229
     I              INDATE                          D2INDT                                    212229
     I              INTIME                          D2INTM                                    212229
     I              UPDUSR                          D2UPUS                                    212229
     I              UPDDTE                          D2UPDT                                    212229
     I              UPDTIM                          D2UPTM                                    212229
     I              CCTMSQ                          D2UPMQ                                    212229
     I              AKEYCD                          D2AKYC                                    212229
     I              CCTMSG                          D2UPMR                                    212229
     I              TSEQNO                          D2SQNO                                    212229
     I              MICCD1                          D2MCC1                                    212229
     I              MICCD2                          D2MCC2                                    212229
     I              MICCD3                          D2MCC3                                    212229
     I              MICCD4                          D2MCC4                                    212229
     I              MICCD5                          D2MCC5                                    212229
     I              TRCOCC                          D2TCOC                                    212229
     I              FXCCC                           D2FXCC                                    212229
     I              MICH1                           D2MIC1                                    212229
     I              MICH2                           D2MIC2                                    212229
     I              MICH3                           D2MIC3                                    212229
     I              MICH4                           D2MIC4                                    212229
     I              MICH5                           D2MIC5                                    212229
     I              FXCHAC                          D2FXCH                                    212229
     I              TRCOCH                          D2TCCH                                    212229
     I              VMICH1                          D2VMI1                                    212229
     I              VMICH2                          D2VMI2                                    212229
     I              VMICH3                          D2VMI3                                    212229
     I              VMICH4                          D2VMI4                                    212229
     I              VMICH5                          D2VMI5                                    212229
     I              VAFCCC                          D2VFCC                                    212229
     I              VTRCC                           D2VTRC                                    212229
     I              VATAMU                          D2VAMT                                    212229
     I              VARATE                          D2VRAT                                    212229
     I              DATNNT                          D2TNNT                                    212229
     I              DATNAT                          D2TNAT                                    212229
     I              CUSTNF                          D2CUNF                                    212229
     I              M2CHRT                          D2CHRT                                    212229
     I              M2CHGC                          D2CHGC                                    212229
     I              SDCHG2                          D2SCH2                                    212229
     I              SDCCY2                          D2SCY2                                    212229
     I              SDOCG2                          D2SCP2                                    212229
     I              SDCTF2                          D2SCT2                                    212229
     I              SDCHG3                          D2SCH3                                    212229
     I              SDCCY3                          D2SCY3                                    212229
     I              SDOCG3                          D2SCP3                                    212229
     I              SDCTF3                          D2SCT3                                    212229
     I              SDCHG4                          D2SCH4                                    212229
     I              SDCCY4                          D2SCY4                                    212229
     I              SDOCG4                          D2SCP4                                    212229
     I              SDCTF4                          D2SCT4                                    212229
     I              SDCHG5                          D2SCH5                                    212229
     I              SDCCY5                          D2SCY5                                    212229
     I              SDOCG5                          D2SCP5                                    212229
     I              SDCTF5                          D2SCT5                                    212229
     I              FTZONE                          D2ZONE                                    212229
     IP@ACCT      DS                                                                          CFT032
     I                                        2   7 P@CNUM                                    CFT032
     I                                        8  10 P@CCY                                     CFT032
     I**********                            554 563 P@ACOD                           CFT032 BUG15042
     I**********                             15  16 P@ACSQ                           CFT032 BUG15042
     I**********                             23  25 P@BRCA                           CFT032 BUG15042
     I*******                                11  20 P@ACOD                        BUG15042 BUG15042A
     I*******                                21  22 P@ACSQ                        BUG15042 BUG15042A
     I*******                                29  31 P@BRCA                        BUG15042 BUG15042A
     I                                      554 563 P@ACOD                                 BUG15042A
     I                                       15  16 P@ACSQ                                 BUG15042A
     I                                       23  25 P@BRCA                                 BUG15042A
      *                                                                                       CER030
     IACCDS       DS                                                                          CER030
     I                                        1  100PACCD                                     CER030
     I                                       11  120PACSQ                                     CER030
      *                                                                                       CER030
      *                                                                                       LUC110
      *                                                                                       LUC110
     I              'OTHR/UCBANKING     ' C         EBANKC                                    LUC110
     I/EJECT
      *****************************************************************
      *                 M A I N L I N E
      *****************************************************************
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q
     C                     MOVEL'MAIN'    @STK,Q
      *
      *  Define entry parameters
      *
     C           *ENTRY    PLIST
     C                     PARM *BLANKS   @RTN    7
     C                     PARM           P@MSGR  8
     C                     PARM           P@KPRT  3
      *
      *  Set up primary reference
      *
     C           P@MSGR    CAT  P@KPRT    W0PREF
      *
      * Initialise program
      *
     C           *IN50     IFEQ '0'
     C                     EXSR SRINIT
     C                     END
      *
      *  Clear working fields
      *
     C                     EXSR SRCLR
      *
      *  Get Message data
      *
     C                     EXSR SRMSGD
      *
      *  Decode Message
      *
     C                     EXSR SRDECD
      *
      *  Analyse Message
      *
     C                     EXSR SRANMG
      *
     C/COPY WNCPYSRC,FT0300C093
      *  Execute Interactive comms process
      *
     C                     EXSR SRCOMM
      *
      *                                                                   S01408
     C/COPY WNCPYSRC,FT0300CCP6                                           S01408
      *                                                                   S01408
      *  Process Message
      *
     C           '*INC FT 'CASEQW0ACT     SRINFT
     C           '*OUT FT 'CASEQW0ACT     SROTFT
     C           '*RFT IN 'CASEQW0ACT     SRINRF                          CFT006
     C           '*CCT IN 'CASEQW0ACT     SRINCT                          CFT006
     C           '*CM 101 'CASEQW0ACT     SRC101                          CRE008
     C           '*CM 103R'CASEQW0ACT     SRR103                          CRE008
     C           '*CM 103S'CASEQW0ACT     SRS103                          CRE008
     C           '*IGNORE 'CASEQW0ACT     SRIGNR
     C                     CAS            SRNPRC
     C                     ENDCS
     C*                                                                   CRE008
     C* Report Cash Management routing check if CRE008 is on              CRE008
     C* and 101 or 103                                                    CRE008
     C           CRE008    IFEQ 'Y'                                       CRE008
     C           PMTPY     IFEQ '101'                                     CRE008
     C           PMTPY     OREQ '103'                                     CRE008
     C           W0ACT     IFEQ *BLANK                                    CRE008
     C                     MOVEL'*REPT'   W0ACT                           CRE008
     C                     ENDIF                                          CRE008
     C                     ENDIF                                          CRE008
     C                     ENDIF                                          CRE008
      *
      *  Report on actions taken
      *
     C                     EXSR SRREPT
      *
      **  For CASHV8 network, send return message to the CASHIER          130869
      *                                                                   130869
     C           PNWRK     IFEQ 'CASHV8'                                  130869
     C                     EXSR SRREPL                                    130869
     C                     END                                            130869
      *                                                                   S01408
     C/COPY WNCPYSRC,FT0300CCP7                                           S01408
      *                                                                   S01408
      *  Unwind subroutine stack name
      *
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
      *  Return to calling program
      *
     C                     RETRN
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRCLR    : Clear work fields                                 *
      *                                                               *
      *  CALLED BY: Main processing                                   *
      *                                                               *
      *****************************************************************
     CSR         SRCLR     BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SRCLR '  @STK,Q
      *
      *  /Copy point for Clear of work fields
      *
     C/COPY WNCPYSRC,FT0300CLR
      *
      *  Clear action
      *
      *  W0ACT is used to determine the type of payment to be             CGL009
      *  generated (by STP or by the system)                              CGL009
      *  It also used to check if reports FT0300P1 and FT0310P1           CGL009
      *  must be printed                                                  CGL009
     C                     MOVEL*BLANKS   W0ACT   8
      *  Use W2ACT instead of W0ACT when passing an action code           CGL009
      *  as parameter                                                     CGL009
     C                     MOVEL*BLANKS   W2ACT   8                       CGL009
      *
      *  Clear file formats
      *
     C                     CLEAR@OTPAYL0
     C                     CLEAR@INPAYL0
      *                                                                   S01408
     C/COPY WNCPYSRC,FT0300CP10                                           S01408
      *                                                                   S01408
      *
      *  Clear parameter structures
      *
     C                     CLEARE#DATA                                            T
     C                     CLEARC#DATA
     C                     CLEARS0DATA                                    CFT014
     C                     CLEARS1DATA
     C                     CLEARS2DATA
     C                     CLEARS3DATA
     C                     CLEARS4DATA
     C                     CLEARS5DATA
     C                     CLEARS6DATA
     C                     CLEARS7DATA                                    CFT014
     C                     CLEARI0DATA                                    CFT014
     C                     CLEARI1DATA
     C                     CLEARI2DATA
     C                     CLEARI3DATA
     C                     CLEARI4DATA
     C                     CLEARI5DATA
     C                     CLEARI6DATA
     C                     CLEARI7DATA                                    CFT014
     C                     CLEARF0DATA                                    CFT014
     C                     CLEARF1DATA
     C                     CLEARF2DATA
     C                     CLEARF3DATA
     C                     CLEARF4DATA
     C                     CLEARF5DATA
     C                     CLEARF6DATA
     C                     CLEARF7DATA                                    CFT014
     C                     CLEARSADATA                                                        CSW209
     C                     CLEARSBDATA                                                        CSW209
     C                     CLEARSCDATA                                                        CSW209
     C                     CLEARSDDATA                                                        CSW209
     C                     CLEARFADATA                                                        CSW209
     C                     CLEARFBDATA                                                        CSW209
     C                     CLEARFCDATA                                                        CSW209
     C                     CLEARFDDATA                                                        CSW209
      *
      *  Clear flags
      *
     C                     MOVEL*BLANKS   ##INS1  1
     C                     MOVEL*BLANKS   ##INS2  1
     C                     MOVEL*BLANKS   ##INS3  1
     C                     MOVEL*BLANKS   ##INS4  1                       CFT014
     C                     MOVEL*BLANKS   OVINS1  1
     C                     MOVEL*BLANKS   OVINS2  1
     C                     MOVEL*BLANKS   OVINS3  1
     C                     MOVEL*BLANKS   OVINS4  1                       CFT014
     C                     MOVEL*BLANKS   ##OPS4  1
     C                     MOVEL*BLANKS   ##OPS5  1
     C                     MOVEL*BLANKS   ##OPS6  1
     C                     MOVEL*BLANKS   ##OPS7  1                       CFT014
     C                     MOVEL*BLANKS   OVOPS4  1
     C                     MOVEL*BLANKS   OVOPS5  1
     C                     MOVEL*BLANKS   OVOPS6  1
     C                     MOVEL*BLANKS   OVOPS7  1                       CFT014
      *
      *  Clear V# transaction dependent fields
      *
     C                     MOVEL*BLANKS   V#RCHK
     C                     MOVEL*BLANKS   V#FRGL
     C                     MOVEL*BLANKS   V#TOGL
     C                     MOVEL*BLANKS   V#MTPY
     C                     MOVEL*BLANKS   V#NWRK
     C                     MOVEL*BLANKS   V#RCO1
     C                     MOVEL*BLANKS   V#ACB1
     C                     MOVEL*BLANKS   V#BNC1
     C                     MOVEL*BLANKS   V#ADDC
     C                     Z-ADD0         V#SLDT
     C                     Z-ADD0         V#PVDT
     C                     MOVEL*BLANKS   V#PCCY
     C                     MOVEL*BLANKS   V#SMCY
     C                     MOVEL*BLANKS   V#STMT
     C                     MOVEL*BLANKS   V#CCCY
     C                     MOVEL*BLANKS   V#RCCY
     C                     MOVEL*BLANKS   V#CDRT
     C                     MOVEL*BLANKS   V#ACBT
     C                     MOVEL*BLANKS   V#SMAM
     C                     MOVEL*BLANKS   V#PYAM
     C                     MOVEL*BLANKS   V#INB1
     C                     MOVEL*BLANKS   V#ORC1
     C                     MOVEL*BLANKS   V#ORB1
     C                     MOVEL*BLANKS   V#SNC1
     C                     MOVEL*BLANKS   V#TRCT
     C                     MOVEL*BLANKS   V#SNCT
     C                     MOVEL*BLANKS   V#SNMT
     C                     MOVEL*BLANKS   V#DETC                          CFT014
     C/COPY WNCPYSRC,FT0300C037
      *  Notified Delivery Currency                                       CEU006
     C                     CLEARV#NDCY                                    CEU006
      *  Notified Delivery Amount                                         CEU006
     C                     CLEARV#NDAM                                    CEU006
      *  Pay Delivery Currency                                            CEU006
     C                     CLEARV#PDCY                                    CEU006
      *  Pay Delivery Amount                                              CEU006
     C                     CLEARV#PDAM                                    CEU006
      ***FONTIS*:*currency*of*:53:*account*to*be*debited****        175474175475
     C*********************MOVEL*BLANK    W53CCY                    175474175475
      *
      *  Set up ##OK as Payment Generation rejected
      *
     C                     MOVEL'N'       ##OK    1
      *
      *** Authorise indicator                                             CFT005
      *                                                                   CFT005
     C                     MOVEL*BLANKS   WAUIN   1                       CFT005
     C                     MOVEL*BLANKS   WAUP1  10                       RK0001
      *                                                                   CFT014
      *** Currencies decimal positions                                    CFT014
      *                                                                   CFT014
     C                     MOVEL*LOVAL    SCNBDP                          CFT014
     C                     MOVEL*LOVAL    PCNBDP                          CFT014
     C                     MOVEL*LOVAL    DCNBDP                          CFT014
     C                     MOVEL*LOVAL    NCNBDP                          CFT014
      *                                                                   CFT014
      *** To memorize currencies values before screen 1 validation        CFT014
      *                                                                   CFT014
     C                     MOVEL*BLANK    WMSMCY  3                       CFT014
     C                     MOVEL*BLANK    WMPCCY  3                       CFT014
     C                     MOVEL*BLANK    WMPDCY  3                       CFT014
     C                     MOVEL*BLANK    WMNDCY  3                       CFT014
      *                                                                   CFT014
      *** Total charges                                                   CFT014
      *                                                                   CFT014
     C                     Z-ADD0         ##CHGS                          CFT014
      *                                                                   CFT014
      *** Array to handle multiple charges                                CFT014
      *                                                                   CFT014
     C                     MOVEL*BLANK    CGA                             CFT014
     C                     MOVEL*BLANK    CGC                             CFT014
     C                     MOVEL*BLANK    LFLT                            CFT014
      *                                                                   CFT009
      *** Customer Notification flag                                      CFT009
      *                                                                   CFT009
     C                     MOVEL*BLANKS   WNTFY   1                       CFT009
      *                                                                                       CFT017
      ** Charges deducted flag                                                                CFT017
      *                                                                                       CFT017
     C                     MOVEL*BLANK    WCHGD   1                                           CFT017
      *                                                                   STP010
     C                     MOVE *BLANKS   W32AM                           STP010
     C                     MOVE *BLANKS   W32CY                           STP010
     C                     MOVE *BLANKS   W32DT                           STP010
     C                     Z-ADD0         W32DYN                          STP010
     C                     Z-ADD0         W36DP                           STP010
     C                     Z-ADD0         W36DPT                          STP010
     C                     MOVE *BLANKS   W36RT                           STP010
      *                                                                   S01408
     C/COPY WNCPYSRC,FT0300CP11                                           S01408
      *                                                                   S01408
      *  Clear positions update
      *
     C                     EXSR SRCLRP
      *                                                                   S01408
     C/COPY WNCPYSRC,FT0300CP12                                           S01408
      *                                                                   S01408
      *
      *  Clear program queue messages
      *
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      *
      *  Unwind subroutine stack name
      *
     C           EXCLR     TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRMSGD   : Get Message Details                               *
      *                                                               *
      *  CALLED BY: Main processing                                   *
      *                                                               *
      *****************************************************************
     CSR         SRMSGD    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SRMSGD'  @STK,Q
      *
      *  /Copy point for Message translation
      *
     C/COPY WNCPYSRC,FT0300MSGD
      *
      * Set up parameters for call
      *
     C                     CLEARPHEAD                      General Details
     C                     MOVELP@MSGR    PHMSGR           Msg ref.
     C                     MOVELP@KPRT    PHPART           Msg part
      *
      * Call ME1100 to translate the data of the messages for FT fields
      *
     C                     CALL 'ME1100'               9090
     C                     PARM '*TRANS  '#ACT    8        Action
     C                     PARM           PHEAD            General Details
     C                     PARM *BLANKS   PDATA            Message Details
     C                     PARM *BLANKS   PDAT2                                               CSW209
     C                     PARM *BLANKS   P@RTCD           Return Code
     C/COPY WNCPYSRC,FT0300C034
      *
      *  If return with an error (LR seton in called program) then
      *  process for database error.
      *
     C           *IN90     IFEQ '1'
     C           P@RTCD    OREQ '*ERROR*'
     C                     MOVEL'ME1100  'W0FILE
     C                     MOVEL'*CALL'   W0KEY            ***************
     C                     Z-ADD1         W0ERNB           * DB ERROR 01 *
     C                     MOVEL'MEM5003' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C***********          EXSR SRERR                                     130869
     C                     EXSR SRERRA                                    130869
     C                     END
     C/COPY WNCPYSRC,FT0300C001
      ** The following code has been commented out because we have        CGL009
      ** moved the mapping of PDATA -> IN/OP fields after the repair      CGL009
      ** process (S/R SRREPR).                                            CGL009
      ** We did that in order to avoid duplicating the lines in           CGL009
      ** connection  with a new NETWORK. (Otherwise we'll have to         CGL009
      ** copy the further code into the 'repair mapping' in S/R SRMAPR)   CGL009
      *                                                                   CGL009
      **Set*up*the*detail*screen*fields*from*the*message.                 CGL009
      *                                                                   CGL009
      **Sender                                                            CGL009
     C*********************MOVELPSNDR     SND1                            CGL009
      *                                                                   CGL009
     C***********PSN       IFNE *BLANKS                                   CGL009
     C*********************MOVELPSN       DSTRAN                          CGL009
     C***********PSNDR     IFEQ 'CASHIER'                           CFT003CGL009
     C*********************MOVELPSNAR,1   TMLIN2                    CFT003CGL009
     C*********************END                                      CFT003CGL009
     C*********************MOVELTMLIN     S1SND                           CGL009
     C*********************END                                            CGL009
      *                                                                   CGL009
      **Message*type*and*network                                          CGL009
      *                                                                   CGL009
     C*********************MOVE PMTPY     INMTPY                          CGL009
     C*********************MOVE PMTPY     V#MTPY                          CGL009
     C*********************MOVE PNWRK     V#NWRK                          CGL009
      *                                                                   CGL009
      **Msg*Unique*Reference                                              CGL009
     C*********************Z-ADDPHMSGR    INMSGR                          CGL009
     C*********************Z-ADDPHMSGR    OPMSGR                          CGL009
      *                                                                   CGL009
      **Swift*Reference                                                   CGL009
     C*********************MOVELPHMIR     MIR                             CGL009
      *                                                                   CGL009
      **Part*Number                                                       CGL009
     C*********************MOVE PHPART    ISEQ                            CGL009
     C*********************Z-ADDPHPART    INKPRT                          CGL009
     C*********************Z-ADDPHPART    OPKPRT                          CGL009
      *                                                                   CGL009
      **Swift*Priority*Code                                               CGL009
     C*********************MOVE PMPRY     S1SWPC                          CGL009
     C*********************MOVE PMPRY     S4SWPC                          CGL009
      *                                                                   CGL009
      **Branch*Code                                                       CGL009
     C***********PBRCA     IFNE *BLANKS                                   CGL009
     C*********************MOVELPBRCA     S1BRCA                          CGL009
     C*********************MOVELPBRCA     S4BRCA                          CGL009
     C*********************END                                            CGL009
      *                                                                   CGL009
      **Transaction*Reference*no.                                         CGL009
      *                                                                   CGL009
     C***********P20       IFNE *BLANKS                                   CGL009
     C*********************MOVELP20       DSTRAN                          CGL009
      *                                                             122060CGL009
     C***********PNWRK     IFEQ 'CASHV8'                            122060CGL009
      *                                                             122060CGL009
     C*********************MOVELTTREF     KDRNO                     122060CGL009
     C*********************MOVEL*BLANKS   KODRN                     122060CGL009
     C*********************MOVELPMTPY     KACDE                     122060CGL009
     C***********KLPDRI    CHAINREPDRIL1             11             122060CGL009
      *                                                             122060CGL009
     C************IN11     IFEQ '1'                                 122060CGL009
     C*********************Z-ADD45        W0ERNB                    122060CGL009
     C*********************MOVEL'REPDRIL1'W0FILE                    122060CGL009
     C*********************MOVELKDRNO     W0KEY                     122060CGL009
     C*********************MOVEL'MEM5002' W0MSGD                    122060CGL009
     C*********************MOVEL'MIDAS  ' W0MSGF                    122060CGL009
     C*********************EXSR SRERRA                              122060CGL009
     C*********************ELSE                                     122060CGL009
     C*********************MOVELTTREF     INTRNO                    122060CGL009
     C*********************ENDIF                                    122060CGL009
      *                                                             122060CGL009
     C*********************ELSE                                     122060CGL009
     C*********************MOVELTTREF     INTRNO                          CGL009
     C*********************ENDIF                                    122060CGL009
      *                                                             122060CGL009
     C*********************ELSE                                           CGL009
     C*********************MOVEL*BLANKS   INTRNO                          CGL009
     C*********************END                                            CGL009
      *                                                                   CGL009
      **Related*Reference                                                 CGL009
      *                                                                   CGL009
     C***********P21       IFNE *BLANKS                                   CGL009
     C*********************MOVELP21       DSTRAN                          CGL009
     C*********************MOVELTTREF     S3RLRF                          CGL009
     C*********************ELSE                                           CGL009
     C*********************MOVEL*BLANKS   S3RLRF                          CGL009
     C*********************END                                            CGL009
      *                                                                   CGL009
      **Value*Date/Ccy/Amount                                             CGL009
      *                                                                   CGL009
     C***********PDCA      IFNE *BLANKS                                   CGL009
     C*********************MOVELPDCA      DSTRAN                          CGL009
      *                                                                   CGL009
      **MMDDYY*format*display                                             CGL009
      *                                                                   CGL009
     C***********WUDFF     IFEQ 'M'                                       CGL009
     C*********************MOVELTVVDAT    SWDT1   6                       CGL009
     C***********2         SUBSTSWDT1:5   MM                              CGL009
     C***********2         SUBSTSWDT1:3   DD                              CGL009
     C***********2         SUBSTSWDT1:1   YY                              CGL009
     C*********************MOVELSWDT2     S1SLDT                          CGL009
     C*********************MOVELSWDT2     S4SLDT                          CGL009
     C*********************ELSE                                           CGL009
      *                                                                   CGL009
      **DDMMYY*format*display                                             CGL009
      *                                                                   CGL009
     C*********************MOVELTVVDAT    SWDT1   6                       CGL009
     C***********2         SUBSTSWDT1:5   DD                              CGL009
     C***********2         SUBSTSWDT1:3   MM                              CGL009
     C***********2         SUBSTSWDT1:1   YY                              CGL009
     C*********************MOVELSWDT2     S1SLDT                          CGL009
     C*********************MOVELSWDT2     S4SLDT                          CGL009
     C*********************END                                            CGL009
      *                                                                   CGL009
      **Currency                                                          CGL009
      *                                                                   CGL009
     C*********************MOVELTVCCY     S1SMCY                          CGL009
     C*********************MOVELTVCCY     S4SMCY                          CGL009
      **Amount                                                            CGL009
      *                                                                   CGL009
      **Format*amount*field*(change*','*decimal*point*to*'.').            CGL009
      *                                                                   CGL009
     C*********************MOVEATVAMT     YA1                             CGL009
     C*********************Z-ADD1         C       30                      CGL009
      *                                                                   CGL009
     C***********C         DOUGT15                                        CGL009
      *                                                                   CGL009
     C***********YA1,C     IFEQ ','                                       CGL009
     C*********************MOVE '.'       YA1,C                           CGL009
     C*********************Z-ADD16        C                               CGL009
     C*********************ELSE                                           CGL009
     C*********************ADD  1         C                               CGL009
     C*********************END                                            CGL009
      *                                                                   CGL009
     C*********************END                                            CGL009
      *                                                                   CGL009
     C*********************MOVEAYA1       AMT    15                       CGL009
     C*********************MOVELAMT       S1SMAM                          CGL009
     C*********************MOVELAMT       S4SMAM                          CGL009
     C*********************END                                            CGL009
      *                                                                   CGL009
      **Ordering*Customer                                                 CGL009
      *                                                                   CGL009
     C***********P50       IFNE *BLANKS                                   CGL009
     C*********************MOVELP50       DSTRAN                          CGL009
     C*********************MOVELTMLIN     S2ORC                           CGL009
     C*********************MOVELTMLIN     S4ORC                           CGL009
     C*********************ELSE                                           CGL009
     C*********************MOVEL*BLANKS   ORCT                            CGL009
     C*********************MOVEL*BLANKS   S2ORC                           CGL009
     C*********************MOVEL*BLANKS   S4ORC                           CGL009
     C*********************END                                            CGL009
      *                                                                   CGL009
      **Ordering*Institution                                              CGL009
      *                                                                   CGL009
     C***********P52       IFNE *BLANKS                                   CGL009
     C*********************MOVELP52       DSTRAN                          CGL009
     C*********************MOVELTMLIN     S2ORBK                          CGL009
     C*********************ELSE                                           CGL009
     C*********************MOVEL*BLANKS   ORBT                            CGL009
     C*********************MOVEL*BLANKS   S2ORBK                          CGL009
     C*********************END                                            CGL009
      *                                                                   CGL009
      **Senders*Correspondent                                             CGL009
      *                                                                   CGL009
     C***********P53       IFNE *BLANKS                                   CGL009
     C*********************MOVELP53       DSTRAN                          CGL009
     C*********************MOVELTMLIN     S2SNC                           CGL009
     C*********************ELSE                                           CGL009
     C*********************MOVEL*BLANKS   SNCT                            CGL009
     C*********************MOVEL*BLANKS   S2SNC                           CGL009
     C*********************END                                            CGL009
      *                                                                   CGL009
      **Receivers*Correspondent                                           CGL009
      *                                                                   CGL009
     C***********P54       IFNE *BLANKS                                   CGL009
     C*********************MOVELP54       DSTRAN                          CGL009
     C*********************MOVELTMLIN1    INRCO1                          CGL009
     C*********************MOVELTMLIN2    INRCO2                          CGL009
     C*********************MOVELTMLIN3    INRCO3                          CGL009
     C*********************MOVELTMLIN4    INRCO4                          CGL009
     C*********************MOVELTMLIN5    INRCO5                          CGL009
      *                                                                   CGL009
      **If*network*is*swift,*find*field*type                              CGL009
      **otherwise*default*it*to*'U'.                                      CGL009
      *                                                                   CGL009
     C***********PNWRK*****IFEQ 'SWIFT '                                  CGL009
      *                                                                   CGL009
      * Set up field type, if A->S, B->T, D->U                            CGL009
      *                                                                   CGL009
     C***********1         SUBSTTRTAG:4   #WK1    1                       CGL009
     C***********#WK1      IFEQ 'A'                                       CGL009
     C*********************MOVEL'S'       INRCRT                          CGL009
     C*********************ELSE                                           CGL009
      *                                                                   CGL009
     C***********#WK1      IFEQ 'B'                                       CGL009
     C*********************MOVEL'T'       INRCRT                          CGL009
     C*********************ELSE                                           CGL009
     C*********************MOVEL'U'       INRCRT                          CGL009
     C*********************END                                            CGL009
     C*********************END                                            CGL009
      *                                                                   CGL009
     C*********************ELSE                                           CGL009
      *                                                                   CGL009
      **network*is*not*swift                                              CGL009
     C*********************MOVEL'U'       INRCRT                          CGL009
     C*********************END                                            CGL009
      *                                                                   CGL009
     C*********************ELSE                                           CGL009
     C*********************MOVEL*BLANKS   INRCRT                          CGL009
     C*********************MOVEL*BLANKS   INRCO1                          CGL009
     C*********************MOVEL*BLANKS   INRCO2                          CGL009
     C*********************MOVEL*BLANKS   INRCO3                          CGL009
     C*********************MOVEL*BLANKS   INRCO4                          CGL009
     C*********************MOVEL*BLANKS   INRCO5                          CGL009
     C*********************END                                            CGL009
      *                                                                   CGL009
      **Intermediary                                                      CGL009
      *                                                                   CGL009
     C***********P56       IFNE *BLANKS                                   CGL009
     C*********************MOVELP56       DSTRAN                          CGL009
     C*********************MOVELTMLIN     S3IBK                           CGL009
     C*********************ELSE                                           CGL009
     C*********************MOVEL*BLANKS   INBT                            CGL009
     C*********************MOVEL*BLANKS   S3IBK                           CGL009
     C*********************END                                            CGL009
      *                                                                   CGL009
      **Account*with*Institution                                          CGL009
      *                                                                   CGL009
     C***********P57       IFNE *BLANKS                                   CGL009
     C*********************MOVELP57       DSTRAN                          CGL009
     C*********************MOVELTMLIN1    INACB1                          CGL009
     C*********************MOVELTMLIN2    INACB2                          CGL009
     C*********************MOVELTMLIN3    INACB3                          CGL009
     C*********************MOVELTMLIN4    INACB4                          CGL009
     C*********************MOVELTMLIN5    INACB5                          CGL009
      *                                                                   CGL009
      **If*network*is*swift,*find*field*type                              CGL009
      **otherwise*default*it*to*'U'.                                      CGL009
      *                                                                   CGL009
     C***********PNWRK     IFEQ 'SWIFT '                                  CGL009
      *                                                                   CGL009
      **Set*up*field*type,*if*A->S,*B->T,*D->U                            CGL009
      *                                                                   CGL009
     C***********1         SUBSTTRTAG:4   #WK1                            CGL009
     C***********#WK1      IFEQ 'A'                                       CGL009
     C*********************MOVEL'S'       INACBT                          CGL009
     C*********************ELSE                                           CGL009
      *                                                                   CGL009
     C***********#WK1      IFEQ 'B'                                       CGL009
     C*********************MOVEL'T'       INACBT                          CGL009
     C*********************ELSE                                           CGL009
     C*********************MOVEL'U'       INACBT                          CGL009
     C*********************END                                            CGL009
     C*********************END                                            CGL009
      *                                                                   CGL009
     C*********************ELSE                                           CGL009
      *                                                                   CGL009
      **network*is*not*swift                                              CGL009
     C*********************MOVEL'U'       INACBT                          CGL009
     C*********************END                                            CGL009
      *                                                                   CGL009
     C*********************ELSE                                           CGL009
     C*********************MOVEL*BLANKS   INACBT                          CGL009
     C*********************MOVEL*BLANKS   INACB1                          CGL009
     C*********************MOVEL*BLANKS   INACB2                          CGL009
     C*********************MOVEL*BLANKS   INACB3                          CGL009
     C*********************MOVEL*BLANKS   INACB4                          CGL009
     C*********************MOVEL*BLANKS   INACB5                          CGL009
     C*********************END                                            CGL009
      *                                                                   CGL009
      **Beneficiary*Institution/*Beneficiary*Customer                     CGL009
      *                                                                   CGL009
     C***********P58       IFNE *BLANKS                                   CGL009
     C*********************MOVELP58       DSTRAN                          CGL009
     C*********************MOVELTMLIN     S1BNC                           CGL009
     C*********************MOVELTMLIN     S5BNC                           CGL009
     C*********************END                                            CGL009
      *                                                                   CGL009
     C***********P59       IFNE *BLANKS                                   CGL009
     C*********************MOVELP59       DSTRAN                          CGL009
     C*********************MOVELTMLIN     S1BNC                           CGL009
     C*********************MOVELTMLIN     S5BNC                           CGL009
     C*********************END                                            CGL009
      *                                                                   CGL009
      **Details*of*Payment                                                CGL009
      *                                                                   CGL009
     C***********P70       IFNE *BLANKS                                   CGL009
     C*********************MOVELP70       DSTRAN                          CGL009
     C*********************MOVELTMLIN     S3PAY                           CGL009
     C*********************ELSE                                           CGL009
     C*********************MOVEL*BLANKS   S3PAY                           CGL009
     C*********************END                                            CGL009
      *                                                                   CGL009
      **Details*of*Charges                                                CGL009
      *                                                                   CGL009
     C***********P71       IFNE *BLANKS                                   CGL009
     C*********************MOVELP71       DSTRAN                          CGL009
     C*********************MOVELTTREF     S3DETC                          CGL009
     C*********************MOVELTTREF     S6DETC                          CGL009
      *                                                             122060CGL009
     C***********PNWRK     IFEQ 'CASHV8'                            122060CGL009
     C*********************MOVEL*BLANKS   WCHCY   3                 122060CGL009
     C*********************MOVELTTREF     WCHCY                     122060CGL009
     C*********************MOVEL'OUR'     S3DETC                    122060CGL009
     C*********************MOVEL'OUR'     S6DETC                    122060CGL009
      *                                                             122060CGL009
      ****Format*amount*field*(change ','*decimal*point*to*'.').    122060CGL009
      *                                                             122060CGL009
     C*********************MOVEL*BLANKS   WRK13  13                 122060CGL009
     C*********************MOVE TTREF     WRK13                     122060CGL009
     C*********************MOVEA*BLANKS   YA1                       122060CGL009
     C*********************MOVEAWRK13     YA1                       122060CGL009
     C*********************Z-ADD1         C       30                122060CGL009
      *                                                             122060CGL009
     C***********C         DOUGT15                                  122060CGL009
     C***********YA1,C     IFEQ ','                                 122060CGL009
     C*********************MOVE '.'       YA1,C                     122260CGL009
     C******************** Z-ADD16        C                         122060CGL009
     C*********************ELSE                                     122060CGL009
     C*********************ADD  1         C                         122060CGL009
     C*********************ENDIF                                    122060CGL009
     C*********************ENDDO                                    122060CGL009
      *                                                             122060CGL009
     C*********************MOVEAYA1       AMT    15                 122060CGL009
     C*********************MOVELAMT       S3MSCD                    122060CGL009
     C*********************MOVELAMT       S6MSCD                    122060CGL009
     C*********************ENDIF                                    122060CGL009
      *                                                             122060CGL009
     C*********************ELSE                                           CGL009
     C*********************MOVEL*BLANKS   S3DETC                          CGL009
     C*********************MOVEL*BLANKS   S6DETC                          CGL009
     C*********************END                                            CGL009
      *                                                                   CGL009
      **Bank*to*Bank*Information                                          CGL009
      *                                                                   CGL009
     C***********P72       IFNE *BLANKS                                   CGL009
     C*********************MOVELP72       DSTRAN                          CGL009
     C*********************MOVELTMLIN     S2BTB                           CGL009
      *                                                             CEU006CGL009
     C***********CEU006    IFEQ 'Y'                                 CEU006CGL009
      *                                                             CEU006CGL009
      ****Retrieve*notified*delivery*currency*and*amount            CEU006CGL009
      *                                                             CEU006CGL009
     C*********************MOVEL'012345'  @CHK   11                 CEU006CGL009
     C*********************MOVE '6789.'   @CHK                      CEU006CGL009
      *                                                             CEU006CGL009
     C***********'/OCMT/'  SCAN TMLIN:1   @F      30     81         CEU006CGL009
      *                                                             CEU006CGL009
     C************IN81     IFEQ *ON                                 CEU006CGL009
      *                                                             CEU006CGL009
      **Map*currency*code*->*S1NDCY*and*S4NDCY                      CEU006CGL009
     C*********************ADD  6         @F                        CEU006CGL009
     C***********3         SUBSTTMLIN:@F  S1NDCY                    CEU006CGL009
     C*********************MOVE S1NDCY    S4NDCY                    CEU006CGL009
      **Map*amount*->*S1NDAM*and*S4NDAM                             CEU006CGL009
      **Move*possible*15*chars*to*work*array*and*work*string        CEU006CGL009
     C*********************ADD  3         @F                        CEU006CGL009
     C***********15        SUBSTTMLIN:@F  @S     15                 CEU006CGL009
     C*********************MOVEA@S        @A                        CEU006CGL009
     C*********************CLEAR@S                                  CEU006CGL009
      *                                                             CEU006CGL009
      **If*','*in*amount*string*@S*change*to*'.'                    CEU006CGL009
      **Only*need*to*check*valid*chars*till*one*','*found           CEU006CGL009
     C*********************Z-ADD1         @C      30                CEU006CGL009
     C*********************MOVE *BLANKS   @T      1                 CEU006CGL009
      *                                                             CEU006CGL009
     C***********1         DO   15        @C                        CEU006CGL009
     C*********************MOVE @A,@C     @T                        CEU006CGL009
     C***********@T        IFEQ ','                                 CEU006CGL009
     C*********************MOVE '.'       @A,@C                     CEU006CGL009
     C*********************LEAVE                                    CEU006CGL009
     C*********************ENDIF                                    CEU006CGL009
     C*********************ENDDO                                    CEU006CGL009
      *                                                             CEU006CGL009
     C*********************Z-ADD1         @C                        CEU006CGL009
     C*********************MOVE *BLANKS   @T      1                 CEU006CGL009
     C*********************MOVEA@A        @S                        CEU006CGL009
      **Get*amount*-*upto*15*chars*possible                         CEU006CGL009
     C***********@C        DOUGT15                                  CEU006CGL009
     C*********************MOVE @A,@C     @T                        CEU006CGL009
     C***********@CHK      CHECK@T        @F             82         CEU006CGL009
      *                                                             CEU006CGL009
      **Char*not*valid*must*be*end*of*amount                        CEU006CGL009
     C************IN82     IFEQ *ON                                 CEU006CGL009
     C***********@C        IFNE 1                                   CEU006CGL009
     C***********@C        SUB  1         @F                        CEU006CGL009
     C***********@F        SUBST@S:1      S1NDAM                    CEU006CGL009
     C*********************MOVE S1NDAM    S4NDAM                    CEU006CGL009
     C*********************ENDIF                                    CEU006CGL009
     C*********************LEAVE                                    CEU006CGL009
     C*********************ENDIF                                    CEU006CGL009
      **All*chars*in*string*ok                                      CEU006CGL009
     C***********@C        IFEQ 15                                  CEU006CGL009
     C*********************MOVEL@S        S1NDAM                    CEU006CGL009
     C*********************MOVE S1NDAM    S4NDAM                    CEU006CGL009
     C*********************ENDIF                                    CEU006CGL009
      *                                                             CEU006CGL009
     C*********************ADD  1         @C                        CEU006CGL009
      *                                                             CEU006CGL009
     C*********************ENDDO                                    CEU006CGL009
      *                                                             CEU006CGL009
     C*********************ENDIF                                    CEU006CGL009
     C*********************ENDIF                                    CEU006CGL009
      *                                                             CEU006CGL009
     C*********************ELSE                                           CGL009
     C*********************MOVEL*BLANKS   S2BTB                           CGL009
     C*********************END                                            CGL009
      *                                                                   CGL009
      *                                                             S01408CGL009
     C*/C*PY*WNCPYSRC,FT0300CP13*********************************   S01408CGL009
      *                                                             S01408CGL009
      **Mapping*for*OUTGOING*PAYMENTS                                     CGL009
      *                                                                   CGL009
      *                                                                   CGL009
      **Set*up*the*detail*screen*fields*from*the*message.                 CGL009
      *                                                                   CGL009
      **Destination                                                       CGL009
      *                                                                   CGL009
      **If*Intermediary*Bank*is*blank,*use*'A/c*with*Institution'         CGL009
      **details,*otherwise*use*Intermediary*Bank*details                  CGL009
      *                                                                   CGL009
     C***********P56       IFEQ *BLANKS                                   CGL009
      *                                                                   CGL009
     C***********P57       IFNE *BLANKS                                   CGL009
     C*********************MOVELP57       DSTRAN                          CGL009
     C*********************MOVELTMLIN     S4DST                           CGL009
     C*********************END                                            CGL009
      *                                                                   CGL009
     C*********************ELSE                                           CGL009
      *                                                                   CGL009
      **Intermediary*Bank*entered                                         CGL009
      *                                                                   CGL009
     C*********************MOVELP56       DSTRAN                          CGL009
     C*********************MOVELTMLIN     S4DST                           CGL009
      *                                                                   CGL009
      **Account*with*Bank*(only*filled*if*Intermediary*Bank*exist)        CGL009
      *                                                                   CGL009
     C***********P57       IFNE *BLANKS                                   CGL009
     C*********************MOVELP57       DSTRAN                          CGL009
     C*********************MOVELTMLIN     S5ACB                           CGL009
     C*********************END                                            CGL009
      *                                                                   CGL009
     C*********************END                                            CGL009
      *                                                                   CGL009
      **Ordering*Bank*file*fields                                         CGL009
      *                                                                   CGL009
      **If*Ordering*Institution*not*blank,*use*it                         CGL009
      **otherwise*use*Sender*details                                      CGL009
      *                                                                   CGL009
     C***********P52       IFNE *BLANKS                                   CGL009
     C*********************MOVELP52       DSTRAN                          CGL009
     C*********************MOVELTMLIN1    OPORB1                          CGL009
     C*********************MOVELTMLIN2    OPORB2                          CGL009
     C*********************MOVELTMLIN3    OPORB3                          CGL009
     C*********************MOVELTMLIN4    OPORB4                          CGL009
     C*********************MOVELTMLIN5    OPORB5                          CGL009
      *                                                                   CGL009
      **If*network*is*swift,*find*field*type                              CGL009
      **otherwise*default*it*to*'A'.                                      CGL009
      *                                                                   CGL009
     C***********PNWRK     IFEQ 'SWIFT '                                  CGL009
      *                                                                   CGL009
      **Set*up*field*type,*if A->S,*B->A,*D->A                            CGL009
      *                                                                   CGL009
     C***********1         SUBSTTRTAG:4   #WK1    1                       CGL009
     C***********#WK1      IFEQ 'A'                                       CGL009
     C*********************MOVEL'S'       OPORBT                          CGL009
     C*********************ELSE                                           CGL009
      *                                                                   CGL009
     C***********#WK1      IFEQ 'B'                                       CGL009
     C*********************MOVEL'A'       OPORBT                          CGL009
     C*********************ELSE                                           CGL009
     C*********************MOVEL'A'       OPORBT                          CGL009
     C*********************END                                            CGL009
     C*********************END                                            CGL009
      *                                                                   CGL009
     C*********************ELSE                                           CGL009
      *                                                                   CGL009
      **network*is*not*swift                                              CGL009
      *                                                                   CGL009
     C*********************MOVEL'A'       OPORBT                          CGL009
     C*********************END                                            CGL009
      *                                                                   CGL009
     C*********************ELSE                                           CGL009
      *                                                                   CGL009
      **Sender*details                                                    CGL009
      *                                                                   CGL009
     C*********************MOVELPSNDR     OPORB1                          CGL009
      *                                                                   CGL009
      **If*network*is*swift,*set*up*field*type*to*'S'                     CGL009
      **otherwise*default*it*to*'U'.                                      CGL009
      *                                                                   CGL009
     C***********PNWRK     IFEQ 'SWIFT '                                  CGL009
     C*********************MOVEL'S'       OPORBT                          CGL009
     C*********************ELSE                                           CGL009
     C*********************MOVEL'A'       OPORBT                          CGL009
     C*********************END                                            CGL009
      *                                                                   CGL009
     C*********************END                                            CGL009
      *                                                                   CGL009
      **Ordering*Bank                                                     CGL009
      *                                                                   CGL009
      **If*Receivers*Correspondent*is*not*blank,*use*it                   CGL009
      **otherwise*use*Senders*Correspondent.*If*both*are*blank            CGL009
      **use*Sender*details.                                               CGL009
      *                                                                   CGL009
     C***********P54       IFNE *BLANKS                                   CGL009
      *                                                                   CGL009
     C*********************MOVELP54       DSTRAN                          CGL009
      *                                                                   CGL009
     C*********************ELSE                                           CGL009
      *                                                                   CGL009
     C***********P53       IFNE *BLANKS                                   CGL009
     C*********************MOVELP53       DSTRAN                          CGL009
      *                                                                   CGL009
     C*********************ELSE                                           CGL009
      *                                                                   CGL009
      *                                                                   CGL009
     C*********************END                                            CGL009
     C*********************END                                            CGL009
      *                                                                   CGL009
      **Beneficiary*already*done*in*INCOMING*MAPPING                      CGL009
      *                                                                   CGL009
      *                                                                   CGL009
      **Msg*Unique*Reference                                              CGL009
      *                                                                   CGL009
     C*********************Z-ADDPHMSGR    OPMSGR                          CGL009
      *                                                                   CGL009
      **Part*Number                                                       CGL009
      *                                                                   CGL009
     C*********************Z-ADDPHPART    OPKPRT                          CGL009
      *                                                                   CGL009
      **Related*Reference                                                 CGL009
      *                                                                   CGL009
      **If*MT100*type*of*message*use*Transaction*Reference*no.            CGL009
      **otherwise*use*related*referance.                                  CGL009
      *                                                                   CGL009
     C***********PMTPY     IFEQ '100'                                     CGL009
      *                                                                   CGL009
     C***********P20       IFNE *BLANKS                                   CGL009
     C*********************MOVELP20       DSTRAN                          CGL009
     C*********************MOVELTTREF     S6RLRF                          CGL009
     C*********************END                                            CGL009
      *                                                                   CGL009
     C*********************ELSE                                           CGL009
      *                                                                   CGL009
     C***********P21       IFNE *BLANKS                                   CGL009
     C*********************MOVELP21       DSTRAN                          CGL009
     C*********************MOVELTTREF     S6RLRF                          CGL009
     C*********************END                                            CGL009
      *                                                                   CGL009
     C*********************END                                            CGL009
      *                                                             130869CGL009
      ****Additional*Mapping*for*CASHIER                            130869CGL009
      *                                                             130869CGL009
      ****Draft*Currency,*Draft*Amount                              130869CGL009
      *                                                             130869CGL009
     C***********SDCA      IFNE *BLANKS                             130869CGL009
     C*********************Z-ADD0         TVVDAT                    130869CGL009
     C*********************MOVELSDCA      DSTRAN                    130869CGL009
      *                                                             130869CGL009
     C***********TVVDAT    IFNE 0                                   130869CGL009
      *                                                             130869CGL009
      ***MMDDYY*format*display                                      130869CGL009
      *                                                             130869CGL009
     C***********WUDFF     IFEQ 'M'                                 130869CGL009
     C*********************MOVELTVVDAT    SWDT1   6                 130869CGL009
     C***********2         SUBSTSWDT1:5   MM                        130869CGL009
     C***********2         SUBSTSWDT1:3   DD                        130869CGL009
     C***********2         SUBSTSWDT1:1   YY                        130869CGL009
     C*********************MOVELSWDT2     S1PVDT                    130869CGL009
     C*********************MOVELSWDT2     S4PVDT                    130869CGL009
     C*********************ELSE                                     130869CGL009
      *                                                             130869CGL009
      ***DDMMYY*format*display                                      130869CGL009
      *                                                             130869CGL009
     C*********************MOVELTVVDAT    SWDT1   6                 130869CGL009
     C***********2         SUBSTSWDT1:5   DD                        130869CGL009
     C***********2         SUBSTSWDT1:3   MM                        130869CGL009
     C***********2         SUBSTSWDT1:1   YY                        130869CGL009
     C*********************MOVELSWDT2     S1PVDT                    130869CGL009
     C*********************MOVELSWDT2     S4PVDT                    130869CGL009
     C*********************END                                      130869CGL009
     C*********************END                                      130869CGL009
      *                                                             130869CGL009
      ***Currency                                                   130869CGL009
      *                                                             130869CGL009
     C*********************MOVELTVCCY     S1PCCY                    130869CGL009
     C*********************MOVELTVCCY     S4PCCY                    130869CGL009
      *                                                             130869CGL009
      ***Format*amount*field*(change*','*decimal*point*to*'.').     130869CGL009
      *                                                             130869CGL009
     C*********************MOVEA*BLANKS   YA1                       130869CGL009
     C*********************MOVEATVAMT     YA1                       130869CGL009
     C*********************Z-ADD1         C       30                130869CGL009
      *                                                             130869CGL009
     C***********C         DOUGT15                                  130869CGL009
     C***********YA1,C     IFEQ ','                                 130869CGL009
     C*********************MOVE '.'       YA1,C                     130869CGL009
     C*********************Z-ADD16        C                         130869CGL009
     C*********************ELSE                                     130869CGL009
     C*********************ADD  1         C                         130869CGL009
     C*********************END                                      130869CGL009
     C*********************END                                      130869CGL009
      *                                                             130869CGL009
     C*********************MOVEAYA1       AMT    15                 130869CGL009
     C*********************MOVELAMT       S1PYAM                    130869CGL009
     C*********************MOVELAMT       S4PYAM                    130869CGL009
     C*********************END                                      130869CGL009
      *                                                             130869CGL009
      ****Funding*Currency,*Funding*Amount                          130869CGL009
      *                                                             130869CGL009
     C***********PDC2      IFNE *BLANKS                             130869CGL009
     C*********************Z-ADD0         TVVDAT                    130869CGL009
     C*********************MOVELPDC2      DSTRAN                    130869CGL009
      *                                                             130869CGL009
     C***********TVVDAT    IFNE 0                                   130869CGL009
      *                                                             130869CGL009
      ***MMDDYY*format*display                                      130869CGL009
      *                                                             130869CGL009
     C***********WUDFF     IFEQ 'M'                                 130869CGL009
     C*********************MOVELTVVDAT    SWDT1   6                 130869CGL009
     C***********2         SUBSTSWDT1:5   MM                        130869CGL009
     C***********2         SUBSTSWDT1:3   DD                        130869CGL009
     C***********2         SUBSTSWDT1:1   YY                        130869CGL009
     C*********************MOVELSWDT2     S1SLDT                    130869CGL009
     C*********************MOVELSWDT2     S4SLDT                    130869CGL009
     C*********************ELSE                                     130869CGL009
      *                                                             130869CGL009
      ** DDMMYY format display                                      130869CGL009
      *                                                             130869CGL009
     C*********************MOVELTVVDAT    SWDT1   6                 130869CGL009
     C***********2         SUBSTSWDT1:5   DD                        130869CGL009
     C***********2         SUBSTSWDT1:3   MM                        130869CGL009
     C***********2         SUBSTSWDT1:1   YY                        130869CGL009
     C*********************MOVELSWDT2     S1SLDT                    130869CGL009
     C*********************MOVELSWDT2     S4SLDT                    130869CGL009
     C*********************END                                      130869CGL009
     C*********************END                                      130869CGL009
      *                                                             130869CGL009
      ***Currency                                                   130869CGL009
      *                                                             130869CGL009
     C*********************MOVELTVCCY     S1SMCY                    130869CGL009
     C*********************MOVELTVCCY     S4SMCY                    130869CGL009
      *                                                             130869CGL009
      ***Format*amount*field*(change*','*decimal*point*to*'.').     130869CGL009
      *                                                             130869CGL009
     C*********************MOVEA*BLANKS   YA1                       130869CGL009
     C*********************MOVEATVAMT     YA1                       130869CGL009
     C*********************Z-ADD1         C       30                130869CGL009
      *                                                             130869CGL009
     C***********C         DOUGT15                                  130869CGL009
     C***********YA1,C     IFEQ ','                                 130869CGL009
     C*********************MOVE '.'       YA1,C                     130869CGL009
     C*********************Z-ADD16        C                         130869CGL009
     C*********************ELSE                                     130869CGL009
     C*********************ADD  1         C                         130869CGL009
     C*********************END                                      130869CGL009
     C*********************END                                      130869CGL009
      *                                                             130869CGL009
     C*********************MOVEAYA1       AMT    15                 130869CGL009
     C*********************MOVELAMT       S1SMAM                    130869CGL009
     C*********************MOVELAMT       S4SMAM                    130869CGL009
     C*********************END                                      130869CGL009
      *                                                             130869CGL009
      ****Rate                                                      130869CGL009
      *                                                             130869CGL009
     C***********S1PYAM    IFNE *BLANKS                             130869CGL009
     C***********S1SMAM    ANDNE*BLANKS                             130869CGL009
     C*                                                             130869CGL009
     C***Get*the*numeric*value*of*S1PYAM                            130869CGL009
     C*                                                             130869CGL009
     C*********************CALL 'AOCURRR0'                          130869CGL009
     C*********************PARM *BLANKS   @RTCD   7                 130869CGL009
     C*********************PARM '*KEY   ' @OPTN   7                 130869CGL009
     C*********************PARM S1PCCY    @CURR   3                 130869CGL009
     C***********SDCURR    PARM SDCURR    DSSDY                     130869CGL009
      *                                                             130869CGL009
     C***********@RTCD     IFNE *BLANKS                             130869CGL009
     C*********************MOVEL'AOCURRR0'W0FILE                    130869CGL009
     C*********************MOVEL'*CALL'   W0KEY      ***************130869CGL009
     C*********************Z-ADD36        W0ERNB     * DB ERROR 36 *130869CGL009
     C*********************MOVEL'MEM5003' W0MSGD     ***************130869CGL009
     C*********************MOVEL'MIDAS  ' W0MSGF                    130869CGL009
     C*********************EXSR SRERRA                              130869CGL009
     C*********************END                                      130869CGL009
     C*********************Z-ADDA6NBDP    WPNDP   10                130869CGL009
     C*********************MOVELA6MDIN    WPMDI   1                 130869CGL009
      *                                                             130869CGL009
      ****Align*amount                                              130869CGL009
     C*********************Z-ADDWPNDP     ZADEC                     130869CGL009
     C***********11        SUB  WPNDP     ZADIG                     130869CGL009
     C*********************MOVEL*BLANK    ZFIELD                    130869CGL009
     C*********************MOVE S1PYAM    ZFIELD                    130869CGL009
     C*********************EXSR ZALIGN                              130869CGL009
     C*********************MOVE ZFIELD    WPYAM1 110                130869CGL009
     C*                                                             130869CGL009
     C***Get*the*numeric*value*of*S1SMAM                            130869CGL009
     C*                                                             130869CGL009
     C*********************CALL 'AOCURRR0'                          130869CGL009
     C*********************PARM *BLANKS   @RTCD   7                 130869CGL009
     C*********************PARM '*KEY   ' @OPTN   7                 130869CGL009
     C*********************PARM S1SMCY    @CURR   3                 130869CGL009
     C***********SDCURR    PARM SDCURR    DSSDY                     130869CGL009
      *                                                             130869CGL009
     C***********@RTCD     IFNE *BLANKS                             130869CGL009
     C*********************MOVEL'AOCURRR0'W0FILE                    130869CGL009
     C*********************MOVEL'*CALL'   W0KEY      ***************130869CGL009
     C*********************Z-ADD37        W0ERNB     * DB ERROR 37 *130869CGL009
     C*********************MOVEL'MEM5003' W0MSGD     ***************130869CGL009
     C*********************MOVEL'MIDAS  ' W0MSGF                    130869CGL009
     C*********************EXSR SRERRA                              130869CGL009
     C*********************END                                      130869CGL009
     C*********************Z-ADDA6NBDP    WSNDP   10                130869CGL009
     C*********************MOVELA6MDIN    WSMDI   1                 130869CGL009
      *                                                             130869CGL009
      **  Align amount                                              130869CGL009
     C*********************Z-ADDWSNDP     ZADEC                     130869CGL009
     C***********11        SUB  WSNDP     ZADIG                     130869CGL009
     C*********************MOVEL*BLANK    ZFIELD                    130869CGL009
     C*********************MOVE S1SMAM    ZFIELD                    130869CGL009
     C*********************EXSR ZALIGN                              130869CGL009
     C*********************MOVE ZFIELD    WSMAM1 110                130869CGL009
      *                                                             130869CGL009
     C***********WPYAM1    IFNE 0                                   130869CGL009
     C***********WSMAM1    ANDNE0                                   130869CGL009
      *                                                             130869CGL009
      ***Calculate*the*rate                                         130869CGL009
      *                                                             130869CGL009
     C***********S1SMCY    IFNE S1PCCY                              122060CGL009
      *                                                             122060CGL009
     C*********************Z-ADD1         @Z      10                122060CGL009
     C*********************Z-ADD0         @EXRT  138                122060CGL009
     C*********************MOVELWPMDI     ZMDI1   1                 122060CGL009
     C*********************MOVELS1PCCY    @CCY                      122060CGL009
     C*********************EXSR RTCCYS                              122060CGL009
      *                                                             122060CGL009
     C***********S1PCCY    LOKUPTCY,@Z                   48         122060CGL009
      *                                                             122060CGL009
     C************IN48     IFEQ '1'                                 122060CGL009
     C*********************EXSR LDXRAR                              122060CGL009
      *                                                             122060CGL009
     C***********PMTPY     IFEQ 'DIC'                               122060CGL009
     C*********************Z-ADDBCR,@Z    ZRATE1 138                122060CGL009
     C*********************ELSE                                     122060CGL009
     C*********************Z-ADDBTR,@Z    ZRATE1                    122060CGL009
     C*********************ENDIF                                    122060CGL009
      *                                                             122060CGL009
     C*********************ELSE                                     122060CGL009
     C*********************Z-ADDTRT,@I    ZRATE1                    122060CGL009
     C*********************ENDIF                                    122060CGL009
      *                                                             122060CGL009
     C*********************Z-ADD1         @Z      10                122060CGL009
     C*********************MOVELWSMDI     ZMDI2   1                 122060CGL009
     C*********************MOVELS1SMCY    @CCY                      122060CGL009
     C*********************EXSR RTCCYS                              122060CGL009
      *                                                             122060CGL009
     C***********S1SMCY    LOKUPTCY,@Z                   48         122060CGL009
      *                                                             122060CGL009
     C************IN48     IFEQ '1'                                 122060CGL009
     C*********************EXSR LDXRAR                              122060CGL009
      *                                                             122060CGL009
     C***********PMTPY     IFEQ 'DIC'                               122060CGL009
     C*********************Z-ADDSCR,@Z    ZRATE2 138                122060CGL009
     C*********************ELSE                                     122060CGL009
     C*********************Z-ADDSTR,@Z    ZRATE2                    122060CGL009
     C*********************ENDIF                                    122060CGL009
      *                                                             122060CGL009
     C*********************ELSE                                     122060CGL009
     C*********************Z-ADDTRT,@I    ZRATE2                    122060CGL009
     C*********************ENDIF                                    122060CGL009
      *                                                             122060CGL009
     C*********************EXSR ZXRATE                              122060CGL009
      *                                                             122060CGL009
     C*********************Z-ADDZRATEX    @EXRT                     122060CGL009
      *                                                             122060CGL009
     C*********************ELSE                                     122060CGL009
     C*********************Z-ADD1         @EXRT                     122060CGL009
     C*********************ENDIF                                    122060CGL009
      *                                                             130869CGL009
      ***Format*rate*field                                          130869CGL009
      *                                                             130869CGL009
     C*********************Z-ADD@EXRT     WRATE1 117                130869CGL009
     C*********************MOVE WRATE1    ZFIELD                    130869CGL009
     C*********************Z-ADD7         ZADEC                     130869CGL009
     C*********************EXSR ZEDIT                               130869CGL009
     C*********************MOVE ZFIELD    S1RATE                    130869CGL009
     C*********************MOVE ZFIELD    S4RATE                    130869CGL009
     C*********************END                                      130869CGL009
      *                                                             130869CGL009
     C*********************END                                      130869CGL009
      *                                                                                       MK0512
     C           KINMVV    KLIST                                                              MK0512
     C                     KFLD           MVNWRK                                              MK0512
     C                     KFLD           MVMTPY                                              MK0512
     C                     KFLD           MVSNDK                                              MK0512
      *                                                                                       MK0512
     C                     MOVELPNWRK     MVNWRK                                              MK0512
     C                     MOVELPMTPY     MVMTPY                                              MK0512
     C                     MOVELPSNDR     MVSNDK                                              MK0512
      *                                                                                       MK0512
     C                     MOVE 'N'       #EXTRN  1                                           MK0512
     C           KINMVV    CHAIN@INMVV0              90                                       MK0512
     C           *IN90     IFEQ *ON                                                           MK0512
     C                     MOVEL*BLANKS   MVSNDK                                              MK0512
     C           KINMVV    CHAIN@INMVV0              90                                       MK0512
     C                     ENDIF                                                              MK0512
     C           *IN90     IFEQ *OFF                                                          MK0512
     C           MVMCMG    ANDEQ'Y'                                                           MK0512
     C                     MOVE 'Y'       #EXTRN                                              MK0512
     C                     ENDIF                                                              MK0512
      *
      *  Unwind subroutine stack name
      *
     C           EXMSGD    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRDECD   : Decode Message                                    *
      *                                                               *
      *  CALLED BY: Main processing                                   *
      *                                                               *
      *****************************************************************
     CSR         SRDECD    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SRDECD'  @STK,Q
      *                                                                   130869
     C           PNWRK     IFEQ 'CASHV8'                                  130869
      *                                                                   130869
      ** Receiver Correspondent and Ordering Bank                         130869
      *                                                                   130869
     C           P54       IFNE *BLANKS                                   130869
     C                     MOVELP54       DSTRAN                          130869
     C                     MOVEL*BLANKS   S1RCCO                          130869
     C                     MOVELTMLIN     S1RCCO                          130869
     C                     MOVEL*BLANKS   S4ORBK                          130869
     C                     MOVELTMLIN     S4ORBK                          130869
      *                                                                   130869
     C                     ELSE                                           130869
      *                                                                   130869
      ** Use the default account code from CASH dataarea and build the    130869
      ** account number                                                   130869
      *                                                                                       194061
     C                     MOVELPBRCA     S1BRCA                                              194061
     C           PDC2      IFNE *BLANKS                                                       194061
     C                     MOVELPDC2      DSTRAN                                              194061
     C                     ELSE                                                               194061
     C                     MOVELPDCA      DSTRAN                                              194061
     C                     ENDIF                                                              194061
     C                     MOVELTVCCY     S1SMCY                                              194061
      *                                                                   130869
      ** Get branch internal customer                                     130869
      *                                                                   130869
     C**********           CALL 'AOBRCHR0'                                             130869 CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM *BLANKS   @RTCD                           130869
     C                     PARM '*KEY   ' @OPTN                           130869
     C                     PARM S1BRCA    #BRCA   3                       130869
     C********** SDBRCH    PARM SDBRCH    DSFDY                                        130869 CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
      *                                                                   130869
      ** If record not found                                              130869
     C           @RTCD     IFNE *BLANK                                    130869
     C                     Z-ADD42        W0ERNB           ************** 130869
     C                     MOVEL'SDBRCHPD'W0FILE           *DB ERROR 42 * 130869
     C                     MOVELS1BRCA    W0KEY            ************** 130869
     C                     MOVEL'MEM5002' W0MSGD                          130869
     C                     MOVEL'MIDAS  ' W0MSGF                          130869
     C                     EXSR SRERRA                                    130869
     C                     END                                            130869
      *                                                                   130869
      ** Retrieve retail account number                                   130869
      *                                                                   130869
     C                     MOVE A8BICN    @CNUM                           130869
     C                     MOVELS1SMCY    @CCY                            130869
     C                     MOVE DACACD    @ACOD                           130869
     C                     Z-ADD1         @ACSQ                           130869
     C                     MOVELS1BRCA    @BRCA                           130869
     C*                                                                   130869
     C           KLACNT    CHAINACCNT                90                   130869
     C*                                                                   130869
     C** If record not found                                              130869
     C           *IN90     IFEQ '1'                                       130869
     C                     Z-ADD43        W0ERNB           ************** 130869
     C                     MOVEL'ACCNT'   W0FILE           *DB ERROR 43 * 130869
     C                     MOVEL@ACCN     W0KEY            ************** 130869
     C                     MOVEL'MEM5002' W0MSGD                          130869
     C                     MOVEL'MIDAS  ' W0MSGF                          130869
     C                     EXSR SRERRA                                    130869
     C                     END                                            130869
      *                                                                   130869
      ** Move retail account number to receiver's correspondent           130869
      *                                                                   130869
     C                     MOVEL*BLANKS   S1RCCO                          130869
     C*********************MOVE ACNO      S1RCCO                    130869CFT014
     C                     MOVELACNO      S1RCO1                          CFT014
      *                                                                   130869
     C                     END                                            130869
      *                                                                   130869
      ** Account with Institution and Destination                         130869
      *                                                                   130869
     C           P57       IFNE *BLANKS                                   130869
     C                     MOVELP57       DSTRAN                          130869
     C                     MOVEL*BLANKS   WREAC  10                       130869
     C                     MOVELTMLIN     WREAC                           130869
     C                     MOVEL*BLANKS   S1ACBK                          130869
     C                     MOVELWREAC     S1ACBK                          130869
     C                     MOVEL*BLANKS   S4DST                           130869
     C                     MOVELWREAC     S4DST                           130869
     C                     END                                            130869
      *                                                                   130869
     C                     MOVEL'N'       S3OPIN                          130869
      *                                                                   130869
     C                     END                                            130869
      *
      *  /COPY
      *
     C/COPY WNCPYSRC,FT0300DECD
      *                                                                   CFT002
      ***Check*if*S01489*is*installed********                             CFT002
      *                                                                   CFT002
     C***********S01489    IFEQ 'S01489'                                  CFT002
     C***********CFT002    ANDEQ'Y'                                       CFT002
      *                                                                   CFT002
      ***Check if CFT002 is installed********                             CFT002
      *                                                                   CFT002
     C           CFT002    IFEQ 'Y'                                       CFT002
     C/COPY WNCPYSRC,FT0300C020
      *                                                                   CFT002
      * Call ME1580 to translate the data of the messages for FT fields   CFT002
      *                                                                   CFT002
     C                     CALL 'ME1580'               9090               CFT002
     C                     PARM '*TRANS  '#ACT    8        Action         CFT002
     C                     PARM           PHEAD            General DatailsCFT002
     C                     PARM           PDATA            Message DatailsCFT002
     C                     PARM           PDAT2            Extension for PDATA                CSW209
     C/COPY WNCPYSRC,FT0300C035
     C                     PARM *BLANKS   RTN     7        Return Code    CFT002
     C/COPY WNCPYSRC,FT0300C057
      *                                                                   CFT002
      *  If call to program resulted in an error then end program.        CFT002
      *                                                                   CFT002
     C           RTN       IFEQ '*ERROR*'                                 CFT002
     C                     MOVEL'*CALL   'W0FILE                          CFT002
     C                     MOVEL*BLANKS   W0KEY                           CFT002
     C                     MOVEL'ME1580'  W0KEY                           CFT002
     C                     Z-ADD51        W0ERNB                          CFT002
     C                     MOVEL'MEM5003' W0MSGD                          CFT002
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT002
     C                     EXSR SRERR                                     CFT002
     C                     END                                            CFT002
      *                                                                   CFT002
     C                     END                                            CFT002
     C/COPY WNCPYSRC,FT0300C021
      *
      *  Unwind subroutine stack name
      *
     C           EXDECD    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRANMG   : Analyse Message                                   *
      *                                                               *
      *  CALLED BY: Main processing                                   *
      *                                                               *
      *****************************************************************
     CSR         SRANMG    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SRANMG'  @STK,Q
      *                                                                   130869
     C***********PNWRK     IFEQ 'CASHV8'                            130869163446
     C*********************MOVEL*BLANKS   W0ACT                     130869163446
     C*********************MOVEL'*INC FT' W0ACT                     130869163446
      *                                                             130869163446
      ***Book*code**                                                130869163446
      *                                                             130869163446
     C*********************MOVELDABOKC    S1BOKC                    130869163446
     C*********************MOVELDABOKC    S4BOKC                    130869163446
      *                                                             130869163446
      ***Payment*Subtype**                                          130869163446
      *                                                             130869163446
     C*********************SELEC                                    130869163446
     C***********PMTPY     WHEQ 'DIC'                               130869163446
     C*********************MOVELDADICT    S1PYST                    130869163446
     C*********************MOVELDADICT    S4PYST                    130869163446
     C***********PMTPY     WHEQ 'DIA'                               130869163446
     C*********************MOVELDADIAT    S1PYST                    130869163446
     C*********************MOVELDADIAT    S4PYST                    130869163446
     C***********PMTPY     WHEQ 'DRP'                               130869163446
     C*********************MOVELDADRPT    S1PYST                    130869163446
     C*********************MOVELDADRPT    S4PYST                    130869163446
     C***********PMTPY     WHEQ 'DCN'                               130869163446
     C*********************MOVELDADCNT    S1PYST                    130869163446
     C*********************MOVELDADCNT    S4PYST                    130869163446
     C*********************ENDSL                                    130869163446
      *                                                             130869163446
     C*********************END                                      130869163446
      *
      *  /COPY
      *
     C/COPY WNCPYSRC,FT0300ANMG
      *                                                                   CFT002
      * Call ME1501 to analysis the data of the messages for FT fields    CFT002
      *                                                                   CFT002
     C           CFT002    IFEQ 'Y'                                       163446
      *                                                                   163446
     C                     CALL 'ME1501'                                  CFT002
     C                     PARM *BLANKS   W0ACT            Action Code    CFT002
     C                     PARM           PHEAD            General DetailsCFT002
     C                     PARM           PDATA            Message DetailsCFT002
     C                     PARM           PDAT2                                               CSW209
     C                     PARM *BLANKS   PCRIT            CriteriaDetailsCFT002
     C                     PARM *BLANKS   PRTN    7        Return Code    CFT002
     C                     PARM ##PGM     W0CPGM 10        Messages ?     CFT002
     C           P@RETV    PARM *BLANK    P@RETV256        Return field   CRE008
     C/COPY WNCPYSRC,FT0300C029
      *                                                                   CFT002
      *  Clear ISO fields                                                 CFT002
      *                                                                   CFT002
     C                     EXSR SRCTAG                                    CFT002
      *                                                                   CFT002
      *  Apply repair functions                                           CFT002
      *                                                                   CFT002
     C                     EXSR SRREPR                                    CFT002
     C/COPY WNCPYSRC,FT0300C022
      *                                                                   163446
     C                     ENDIF                                          163446
      *                                                                                       MK0520
     C                     MOVEL*BLANKS   #3PARM                                              MK0520
     C                     MOVEL*BLANKS   #1LHCY                                              MK0520
     C                     MOVE P@MSGR    #1MSGR                                              MK0520
     C                     MOVE P@KPRT    #1KPRT                                              MK0520
      *                                                                                       MK0520
     C                     CALL 'FTP1100'              9090                                   MK0520
     C                     PARM *BLANKS   P@RTCD                                              MK0520
     C                     PARM           #1PARM                                              MK0520
     C                     PARM           #2PARM                                              MK0520
     C                     PARM           #3PARM                                              MK0520
      *                                                                                       MK0520
      *  If error on call                                                                     MK0520
      *                                                                                       MK0520
     C           *IN90     IFEQ '1'                                                           MK0520
     C           P@RTCD    ORNE *BLANKS                                                       MK0520
     C                     MOVEL'FTP1100 'W0FILE           ***************                    MK0520
     C                     MOVEL'*CALL'   W0KEY            * DB ERROR 64 *                    MK0520
     C                     Z-ADD64        W0ERNB           ***************                    MK0520
     C                     MOVEL'MEM5003' W0MSGD                                              MK0520
     C                     MOVEL'MIDAS  ' W0MSGF                                              MK0520
     C                     EXSR SRERRA                                                        MK0520
     C                     ENDIF                                                              MK0520
      *                                                                   163446
      *  Apply default routing (if necessary)                             163446
      *                                                                   163446
     C                     EXSR SRDFLT                                    163446
      *                                                                   CGL009
      *  Mapping to incoming and outgoing payment field                   CGL009
      *                                                                   CGL009
     C                     EXSR SRMAP                                     CGL009
      *                                                                   CFT002
      *  Format translated data                                           CFT002
      **********-*Incoming*payment                                  CFT002CGL009
      *                                                                   CGL009
      * ------------------------------------                              CGL009
      * +                                  +                              CGL009
      * +       - Incoming payment         +                              CGL009
      * +                                  +                              CGL009
      * ------------------------------------                              CGL009
     C           W0ACT     IFEQ '*INC FT'                                 CFT002
      *                                                                   CFT002
      ***If*branch*specified*then*use*as*booking*branch             CFT002CGL009
     C***********GNBRCA    IFNE *BLANKS                             CFT002CGL009
     C*********************MOVELGNBRCA    S1BRCA                    CFT002CGL009
     C*********************END                                      CFT002CGL009
      *                                                                   CFT002
      ***Originating*branch,*pay*currency*&*value*date              CFT002CGL009
     C***********S1ORBR    IFEQ *BLANKS                             CFT002CGL009
     C*********************MOVE S1BRCA    S1ORBR                    CFT002CGL009
     C*********************END                                      CFT002CGL009
      *                                                                   CGL009
     C                     SELEC                                          163446
      *                                                                   CGL009
      *  Payment CCY can be different in a FONTIS message                 CGL009
     C           PNWRK     WHEQ 'FONTIS'                                  CGL009
      *  Other Networks the payment currency is defaulted                 163446
     C                     OTHER                                          163446
     C           CFT012    IFNE 'Y'                                       CFT012
     C                     MOVE S1SMCY    S1PCCY                          CFT002
     C                     MOVE S1SLDT    S1PVDT                          CFT002
     C                     ENDIF                                          CFT012
      *                                                                   CGL009
     C                     ENDSL                                          163446
      *                                                                   CGL009
      *                                                                   CFT002
      *  NO CRITERIA FOUND => DEFAULTED BY THE SYSTEM                     163446
      *  --------------------------------------------                     163446
     C           PRTN      IFNE 'MIN0096'                                 163446
     C                     SELEC                                          163446
      *                                                                   163446
     C           PNWRK     WHEQ 'CASHV8'                                  163446
      *  Payment subtype, Book code                                       163446
     C                     MOVELDABOKC    S1BOKC                          163446
     C                     SELEC                                          163446
     C           PMTPY     WHEQ 'DIC'                                     163446
     C                     MOVELDADICT    S1PYST                          163446
     C           PMTPY     WHEQ 'DIA'                                     163446
     C                     MOVELDADIAT    S1PYST                          163446
     C           PMTPY     WHEQ 'DRP'                                     163446
     C                     MOVELDADRPT    S1PYST                          163446
     C           PMTPY     WHEQ 'DCN'                                     163446
     C                     MOVELDADCNT    S1PYST                          163446
     C                     ENDSL                                          163446
      *  Originating branch                                               163446
     C           S1ORBR    IFEQ *BLANKS                                   163446
     C                     MOVE S1BRCA    S1ORBR                          163446
     C                     END                                            163446
      *                                                                   CGL009
     C           PNWRK     WHEQ 'FONTIS'                                  CGL009
      *  Payment subtype, Book code & Profit centre                       CGL009
     C                     MOVE F8IPST    S1PYST                          CGL009
     C                     MOVE F8TBKC    S1BOKC                          CGL009
      *  Originating branch                                               CGL009
     C           S1ORBR    IFEQ *BLANKS                                   CGL009
     C                     MOVE S1BRCA    S1ORBR                          CGL009
     C                     END                                            CGL009
      *  Profit center                                                    CGL009
     C                     MOVEL'IN'      WPYTP                           CGL009
     C                     MOVELF8IPST    WPYST                           CGL009
     C                     MOVELF8TBKC    WBOKC                           CGL009
     C                     MOVELS1BRCA    WBRCA                           CGL009
     C                     EXSR SRPRFC                                    CGL009
     C           WPRFC     IFNE *BLANK                                    CGL009
     C                     MOVE WPRFC     S1PRFC                          CGL009
     C                     ELSE                                           CGL009
     C                     MOVE F8TPFC    S1PRFC                          CGL009
     C                     ENDIF                                          CGL009
      *                                                                   163446
      *  <--- put here system values available for other networks         163446
     C                     OTHER                                          163446
      *                                                                   163446
     C                     ENDSL                                          163446
      *  CRITERIA FOUND => VALUED BY STP CRITERIA                         163446
      *  ----------------------------------------                         163446
     C                     ELSE                                           163446
      *                                                                   CFT002
      *  If branch specified then use as booking branch                   CFT002
     C           GNBRCA    IFNE *BLANKS                                   CGL009
     C                     MOVELGNBRCA    S1BRCA                          CGL009
     C                     END                                            CGL009
      *  Originating branch                                               CGL009
     C           S1ORBR    IFEQ *BLANKS                                   CGL009
     C                     MOVE S1BRCA    S1ORBR                          CGL009
     C                     END                                            CGL009
      *  Payment subtype, Book code & Profit centre                       CFT002
     C           #3SUBT    IFEQ *BLANKS                                                       MK0520
     C                     MOVE GNPYST    S1PYST                          CFT002
     C                     ELSE                                                               MK0520
     C                     MOVE #3SUBT    S1PYST                                              MK0520
     C                     ENDIF                                                              MK0520
     C           #3BOKC    IFEQ *BLANKS                                                       MK0520
     C                     MOVE GNBOKC    S1BOKC                          CFT002
     C                     ELSE                                                               MK0520
     C                     MOVE #3BOKC    S1BOKC                                              MK0520
     C                     ENDIF                                                              MK0520
     C                     MOVE *BLANKS   S1PRFC                          CFT002
      *                                                                   163446
      * End of test : PRTN IFNE 'MIN0096'                                 163446
     C                     END                                            163446
      *                                                                   163446
     C                     EXSR SRIMSG                                    CFT002
     C/COPY WNCPYSRC,FT0300C070
     C                     END                                            CFT002
      *                                                                   CFT002
      **********-*Outgoing*payment                                  CFT002CGL009
      *                                                                   CFT002
      * ------------------------------------                              CGL009
      * +                                  +                              CGL009
      * +       - Outgoing payment         +                              CGL009
      * +                                  +                              CGL009
      * ------------------------------------                              CGL009
     C           W0ACT     IFEQ '*OUT FT'                                 CFT002
     C                     SELEC                                          163446
      *                                                                   163446
      *  Payment CCY can be different in a FONTIS message                 CGL009
     C           PNWRK     WHEQ 'FONTIS'                                  CGL009
     C                     MOVEL*BLANK    S4NDCY                          CGL009
     C                     MOVEL*BLANK    S4NDAM                          CGL009
      *  Other Networks the payment currency is defaulted                 163446
     C                     OTHER                                          163446
     C           CFT012    IFNE 'Y'                                       CFT012
     C                     MOVE S4SMCY    S4PCCY                          CGL009
     C                     MOVE S4SLDT    S4PVDT                          CGL009
     C                     ENDIF                                          CFT012
     C                     ENDSL                                          163446
      *                                                                   CGL009
      *                                                                   CGL009
      *                                                                   CFT002
      *  NO CRITERIA FOUND => DEFAULTED BY THE SYSTEM                     163446
      *  --------------------------------------------                     163446
     C           PRTN      IFNE 'MIN0096'                                 163446
      *                                                                   163446
     C                     SELEC                                          163446
      *                                                                   163446
     C           PNWRK     WHEQ 'CASHV8'                                  163446
      *  Payment subtype, Book code                                       163446
     C                     MOVELDABOKC    S4BOKC                          163446
     C                     SELEC                                          163446
     C           PMTPY     WHEQ 'DIC'                                     163446
     C                     MOVELDADICT    S4PYST                          163446
     C           PMTPY     WHEQ 'DIA'                                     163446
     C                     MOVELDADIAT    S4PYST                          163446
     C           PMTPY     WHEQ 'DRP'                                     163446
     C                     MOVELDADRPT    S4PYST                          163446
     C           PMTPY     WHEQ 'DCN'                                     163446
     C                     MOVELDADCNT    S4PYST                          163446
     C                     ENDSL                                          163446
      *  Originating branch                                               163446
     C           S4ORBR    IFEQ *BLANKS                                   163446
     C                     MOVE S4BRCA    S4ORBR                          163446
     C                     END                                            163446
      *  Settlement method                                                163446
     C                     MOVE '01'      S4STMT                          163446
      *                                                                   CGL009
     C           PNWRK     WHEQ 'FONTIS'                                  CGL009
      *  Payment subtype, Book code & Profit centre                       CGL009
     C                     MOVE F8OPST    S4PYST                          CGL009
     C                     MOVE F8TBKC    S4BOKC                          CGL009
      *  Originating branch                                               CGL009
     C           S4ORBR    IFEQ *BLANKS                                   CGL009
     C                     MOVE S4BRCA    S4ORBR                          CGL009
     C                     END                                            CGL009
      *  Profit center                                                    CGL009
     C                     MOVEL'OP'      WPYTP                           CGL009
     C                     MOVELF8OPST    WPYST                           CGL009
     C                     MOVELF8TBKC    WBOKC                           CGL009
     C                     MOVELS4BRCA    WBRCA                           CGL009
     C                     EXSR SRPRFC                                    CGL009
     C           WPRFC     IFNE *BLANK                                    CGL009
     C                     MOVE WPRFC     S4PRFC                          CGL009
     C                     ELSE                                           CGL009
     C                     MOVE F8TPFC    S4PRFC                          CGL009
     C                     ENDIF                                          CGL009
      *  Settlement method                                                CGL009
     C                     MOVE F8STMT    S4STMT                          CGL009
      *                                                                   CGL009
      *  <--- put here system values available for other networks         163446
     C                     OTHER                                          163446
      *                                                                   163446
     C                     ENDSL                                          163446
      *  CRITERIA FOUND => VALUED BY STP CRITERIA                         163446
      *  ----------------------------------------                         163446
     C                     ELSE                                           163446
      *                                                                   CFT002
      *  If branch specified then use as booking branch                   CFT002
     C           GNBRCA    IFNE *BLANKS                                   CFT002
     C                     MOVELGNBRCA    S4BRCA                          CFT002
     C                     END                                            CFT002
      *                                                                   CFT002
      *  Originating branch, pay currency & value date                    CFT002
     C***********S1ORBR    IFEQ *BLANKS                             CFT002CFT003
     C           S4ORBR    IFEQ *BLANKS                                   CFT003
     C                     MOVE S4BRCA    S4ORBR                          CFT002
     C                     END                                            CFT002
     C*********************MOVE S4SMCY    S4PCCY                    CFT002CGL009
     C*********************MOVE S4SLDT    S4PVDT                    CFT002CGL009
      *                                                                   CFT002
      *  Payment subtype, Book code & Profit centre                       CFT002
     C           #3SUBT    IFEQ *BLANKS                                                       MK0520
     C                     MOVE GNPYST    S4PYST                          CFT002
     C                     ELSE                                                               MK0520
     C                     MOVE #3SUBT    S4PYST                                              MK0520
     C                     ENDIF                                                              MK0520
     C           #3BOKC    IFEQ *BLANKS                                                       MK0520
     C                     MOVE GNBOKC    S4BOKC                          CFT002
     C                     ELSE                                                               MK0520
     C                     MOVE #3BOKC    S4BOKC                                              MK0520
     C                     ENDIF                                                              MK0520
     C                     MOVE *BLANKS   S4PRFC                          CFT002
      *                                                                   CFT002
      *  Default the settlement method from the analysis result           CFT002
     C                     MOVELGNSETT    S4STMT                          CFT002
      *                                                                   CFT002
      *  If no settlement method found, try to use the default from       CFT002
      *  the default outgoing settlment type in MEFTATPP file             CFT002
     C           S4STMT    IFEQ *BLANK                                    CFT002
     C                     MOVE '01'      S4STMT                          CFT002
     C                     END                                            CFT002
      * End of test : PRTN IFNE 'MIN0096'                                 163446
     C                     END                                            163446
      *                                                                   CFT002
      *                                                                   CFT002
      * The corresponding subroutine is called to perform the mapping of  CFT002
      * screen field from the incoming messages                           CFT002
      *                                                                   CFT002
      *   If it is to generate YENKSI (settle method 50), call SROCLR     CFT002
      *                                                                   CFT002
     C           CFT002    IFEQ 'Y'                                       163446
     C           GNCLRT    IFEQ 'C'                                       CFT002
     C           PRTN      ANDEQ'MIN0096'                                 163446
     C/COPY WNCPYSRC,FT0300C014
     C/COPY OFCPYSRCZ,CFT135_007                                                              CFT135
     C                     EXSR SROCLR                                    CFT002
     C/COPY WNCPYSRC,FT0300C015
     C/COPY OFCPYSRCZ,CFT135_008                                                              CFT135
     C                     ELSE                                           CFT002
      *   Else it assume to settle thru SWIFT, call SROSWT                CFT002
      *   (Translation can be applied on outgoing payments even if the    163446
      *   message has not been selected by STP)                           163446
     C                     EXSR SROSWT                                    CFT002
     C                     END                                            CFT002
     C                     ENDIF                                          163446
     C/COPY WNCPYSRC,FT0300C098
     C                     END                                            CFT002
      *                                                                   163446
      * Overrides occur only if message selected by STP                   163446
     C           PRTN      IFEQ 'MIN0096'                                 163446
      *                                                                   CFT002
      * If override accounts specified call account routines              CFT002
      *                                                                   CFT002
      * Crebit account override                                           CFT002
      *                                                                   CFT002
     C           GNCSET    IFNE *BLANKS                                   CFT002
     C                     EXSR SRCRAC                                    CFT002
     C                     ENDIF                                          CFT002
      *                                                                   CFT002
      * Debit account override                                            CFT002
      *                                                                   CFT002
     C           GNDSET    IFNE *BLANKS                                   CFT002
     C                     EXSR SRDRAC                                    CFT002
     C                     ENDIF                                          CFT002
      *
     C                     ENDIF                                          163446
      *                                                                   CFT012
      ** Determine the settlement or payment currency                     CFT012
      ** for networks different from FONTIS                               CFT012
     C           CFT012    IFEQ 'Y'                                       CFT012
     C           PNWRK     IFNE 'FONTIS'                                  CFT012
     C                     SELEC                                          CFT012
     C           W0ACT     WHEQ '*INC FT'                                 CFT012
     C           S1PCCY    ANDEQ*BLANK                                    CFT012
     C                     EXSR SRDPCC                                    CFT012
      *                                                                   CFT012
     C           W0ACT     WHEQ '*OUT FT'                                 CFT012
     C           S4SMCY    ANDEQ*BLANK                                    CFT012
      *                                                                   CFT012
     C                     EXSR SRDSCY                                    CFT012
     C                     ENDSL                                          CFT012
     C                     ENDIF                                          CFT012
     C                     ENDIF                                          CFT012
     C/COPY WNCPYSRC,FT0300C067
      *                                                                   163446
      *  Unwind subroutine stack name
      *
     C           EXANMG    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRCOMM   : Execute Interactive Comms                         *
      *                                                               *
      *  CALLED BY: Main processing                                   *
      *                                                               *
      *****************************************************************
     CSR         SRCOMM    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SRCOMM'  @STK,Q
      *
      *  /Copy point for Interactive Comms
      *
     C/COPY WNCPYSRC,FT0300COMM
      *
      *  Call FTC0334 to send data to interactive job
      *
     C                     CALL 'FTC0334'              9090
     C                     PARM *BLANKS   P@RTCD
     C*********************PARM           W0ACT   8                       CGL009
     C*********************PARM           W2ACT   8                 CGL009PL0001
     C                     PARM           W0ACT   8                       PL0001
     C                     PARM P@MSGR    X#MSGR  8
     C                     PARM P@KPRT    X#KPRT  3
     C                     PARM           S1DATA
     C                     PARM           S4DATA
      *
      *  If error on call
      *
     C           *IN90     IFEQ '1'
     C                     MOVEL'FTC0334 'W0FILE           ***************
     C                     MOVEL'*CALL'   W0KEY            * DB ERROR 02 *
     C                     Z-ADD2         W0ERNB           ***************
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C***********          EXSR SRERR                                     130869
     C                     EXSR SRERRA                                    130869
     C                     END
      *
      *  Unwind subroutine stack name
      *
     C           EXCOMM    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
     C/EJECT
      *****************************************************************   CFT006
      *                                                               *   CFT006
      *  SRINRF   : Create Incoming RFT                               *   CFT006
      *                                                               *   CFT006
      *  CALLED BY: Main processing                                   *   CFT006
      *                                                               *   CFT006
      *****************************************************************   CFT006
     CSR         SRINRF    BEGSR                                          CFT006
      *                                                                   CFT006
      *  Set up subroutine stack name                                     CFT006
      *                                                                   CFT006
     C                     ADD  1         Q       50                      CFT006
     C                     MOVEL'SRINRF'  @STK,Q                          CFT006
      *                                                                   CFT006
      *  Report messages send before                                      CFT006
      *                                                                   CFT006
     C                     EXSR SRRERR                                    CFT006
      *                                                                   CFT006
     C                     CALL H101VL                 90                 CFT006
     C                     PARM *BLANK    P@RETN                          CFT006
     C                     PARM           P@RMOD                          CFT006
     C                     PARM 'I'       P@ACTN                          CFT006
     C                     PARM           HDRFTS                          CFT006
     C                     PARM           OKHDR                           CFT006
     C                     PARM *BLANK    @FN                             CFT006
     C                     PARM *BLANK    @MI                             CFT006
     C                     PARM *BLANK    @MD                             CFT006
     C                     PARM 0         P@IX    30                      CFT006
     C                     PARM *BLANK    @WFN                            CFT006
     C                     PARM *BLANK    @WMI                            CFT006
     C                     PARM *BLANK    @WMD                            CFT006
     C                     PARM 0         P@WIX   30                      CFT006
      *                                                                   CFT006
     C           *IN90     IFEQ '1'                                       CFT006
     C           P@RETN    ORNE *BLANK                                    CFT006
     C                     MOVEL'H101VL  'W0FILE                          CFT006
     C                     MOVEL'*CALL'   W0KEY            ***************CFT006
     C                     Z-ADD87        W0ERNB           * DB ERROR 87 *CFT006
     C                     MOVEL'MEM5003' W0MSGD           ***************CFT006
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT006
     C                     EXSR SRERRA                                    CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      * Special case if error on field  SENDER REFERENCE :                CFT006
      * If it is due to a duplicate key, then  we  bypass this control    CFT006
      * because we call the FTM101UPD with both header present flag       CFT006
      * detail present flag set to Y. Therefore the update API module     CFT006
      * will check the duplicate key, before inserting the header         CFT006
      * record.                                                           CFT006
     C                     MOVEL'SNDREF'  WREFLD                          CFT006
     C                     MOVEL'RFV0003' WREMSG                          CFT006
     C                     Z-ADDP@IX      WRENBR                          CFT006
     C                     MOVEA@FN       @WKF                            CFT006
     C                     MOVEA@MI       @WKI                            CFT006
     C                     MOVEA@MD       @WKD                            CFT006
     C                     EXSR RMEMSG                                    CFT006
     C           P@IX      IFNE WRENBR                                    CFT006
     C                     MOVEA@WKF      @FN                             CFT006
     C                     MOVEA@WKI      @MI                             CFT006
     C                     MOVEA@WKD      @MD                             CFT006
     C                     Z-ADDWRENBR    P@IX                            CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      * Errors / Warnings generated by validation of header screen 1      CFT006
     C           P@IX      IFNE 0                                         CFT006
     C           P@WIX     ORNE 0                                         CFT006
     C                     MOVEL'RFD0002' W0LMSG                          CFT006
     C                     MOVEL'FTUSRMSG'W0MSGF                          CFT006
     C                     MOVEL'01'      W0MSDT                          CFT006
     C                     EXSR SRLOG                                     CFT006
      *                                                                   CFT006
      * If errors found write them on the log                             CFT006
     C           P@IX      IFNE 0                                         CFT006
     C                     MOVEA@FN       @WKF                            CFT006
     C                     MOVEA@MI       @WKI                            CFT006
     C                     MOVEA@MD       @WKD                            CFT006
     C                     EXSR FILLOG                                    CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      * If warnings found write them on the log                           CFT006
     C           P@WIX     IFNE 0                                         CFT006
     C                     MOVEA@WFN      @WKF                            CFT006
     C                     MOVEA@WMI      @WKI                            CFT006
     C                     MOVEA@WMD      @WKD                            CFT006
     C                     EXSR FILLOG                                    CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      * No errors on the header side                                      CFT006
     C           P@IX      IFEQ 0                                         CFT006
      *                                                                   CFT006
     C                     CALL C101VL                                    CFT006
     C                     PARM *BLANK    P@RETN 10                       CFT006
     C                     PARM           P@RMOD  1                       CFT006
     C                     PARM NBS101    P@CURS  2                       CFT006
     C                     PARM 'I'       P@ACTN  1                       CFT006
     C                     PARM 'Y'       P@INIT  1                       CFT006
     C                     PARM           HDRFTS                          CFT006
     C                     PARM           DTRFTS                          CFT006
     C                     PARM *BLANK    WRNDSP  1                       CFT006
     C                     PARM           OKCRE1                          CFT006
     C                     PARM           OKCRE2                          CFT006
     C                     PARM           OKCRE3                          CFT006
     C                     PARM 0         P@IX1   30                      CFT006
     C                     PARM 0         P@IX2   30                      CFT006
     C                     PARM 0         P@IX3   30                      CFT006
     C                     PARM *BLANK    @FN1                            CFT006
     C                     PARM *BLANK    @MI1                            CFT006
     C                     PARM *BLANK    @MD1                            CFT006
     C                     PARM *BLANK    @FN2                            CFT006
     C                     PARM *BLANK    @MI2                            CFT006
     C                     PARM *BLANK    @MD2                            CFT006
     C                     PARM *BLANK    @FN3                            CFT006
     C                     PARM *BLANK    @MI3                            CFT006
     C                     PARM *BLANK    @MD3                            CFT006
     C                     PARM 0         P@WIX1  30                      CFT006
     C                     PARM 0         P@WIX2  30                      CFT006
     C                     PARM 0         P@WIX3  30                      CFT006
     C                     PARM *BLANK    @WFN1                           CFT006
     C                     PARM *BLANK    @WMI1                           CFT006
     C                     PARM *BLANK    @WMD1                           CFT006
     C                     PARM *BLANK    @WFN2                           CFT006
     C                     PARM *BLANK    @WMI2                           CFT006
     C                     PARM *BLANK    @WMD2                           CFT006
     C                     PARM *BLANK    @WFN3                           CFT006
     C                     PARM *BLANK    @WMI3                           CFT006
     C                     PARM *BLANK    @WMD3                           CFT006
      *                                                                   CFT006
     C           *IN90     IFEQ '1'                                       CFT006
     C           P@RETN    ORNE *BLANK                                    CFT006
     C                     MOVEL'C101VL  'W0FILE                          CFT006
     C                     MOVEL'*CALL'   W0KEY            ***************CFT006
     C                     Z-ADD88        W0ERNB           * DB ERROR 88 *CFT006
     C                     MOVEL'MEM5003' W0MSGD           ***************CFT006
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT006
     C                     EXSR SRERRA                                    CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      * Errors / Warnings generated by validation of screen 1             CFT006
     C           P@IX1     IFNE 0                                         CFT006
     C           P@WIX1    ORNE 0                                         CFT006
     C                     MOVEL'RFD0001' W0LMSG                          CFT006
     C                     MOVEL'FTUSRMSG'W0MSGF                          CFT006
     C                     MOVEL'01'      W0MSDT                          CFT006
     C                     EXSR SRLOG                                     CFT006
      *                                                                   CFT006
      * If errors found on screen 1 write them on the log                 CFT006
     C           P@IX1     IFNE 0                                         CFT006
     C                     MOVEA@FN1      @WKF                            CFT006
     C                     MOVEA@MI1      @WKI                            CFT006
     C                     MOVEA@MD1      @WKD                            CFT006
     C                     EXSR FILLOG                                    CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      * If warnings found on screen 1 write them on the log               CFT006
     C           P@WIX1    IFNE 0                                         CFT006
     C                     MOVEA@WFN1     @WKF                            CFT006
     C                     MOVEA@WMI1     @WKI                            CFT006
     C                     MOVEA@WMD1     @WKD                            CFT006
     C                     EXSR FILLOG                                    CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      * Errors / Warnings generated by validation of screen 2             CFT006
     C           P@IX2     IFNE 0                                         CFT006
     C           P@WIX2    ORNE 0                                         CFT006
     C                     MOVEL'RFD0001' W0LMSG                          CFT006
     C                     MOVEL'FTUSRMSG'W0MSGF                          CFT006
     C                     MOVEL'02'      W0MSDT                          CFT006
     C                     EXSR SRLOG                                     CFT006
      *                                                                   CFT006
      * If errors found on screen 2 write them on the log                 CFT006
     C           P@IX2     IFNE 0                                         CFT006
     C                     MOVEA@FN2      @WKF                            CFT006
     C                     MOVEA@MI2      @WKI                            CFT006
     C                     MOVEA@MD2      @WKD                            CFT006
     C                     EXSR FILLOG                                    CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      * If warnings found on screen 2 write them on the log               CFT006
     C           P@WIX2    IFNE 0                                         CFT006
     C                     MOVEA@WFN2     @WKF                            CFT006
     C                     MOVEA@WMI2     @WKI                            CFT006
     C                     MOVEA@WMD2     @WKD                            CFT006
     C                     EXSR FILLOG                                    CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      * Errors / Warnings generated by validation of screen 3             CFT006
     C           P@IX3     IFNE 0                                         CFT006
     C           P@WIX3    ORNE 0                                         CFT006
     C                     MOVEL'RFD0001' W0LMSG                          CFT006
     C                     MOVEL'FTUSRMSG'W0MSGF                          CFT006
     C                     MOVEL'03'      W0MSDT                          CFT006
     C                     EXSR SRLOG                                     CFT006
      *                                                                   CFT006
      * If errors found on screen 3 write them on the log                 CFT006
     C           P@IX3     IFNE 0                                         CFT006
     C                     MOVEA@FN3      @WKF                            CFT006
     C                     MOVEA@MI3      @WKI                            CFT006
     C                     MOVEA@MD3      @WKD                            CFT006
     C                     EXSR FILLOG                                    CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      * If warnings found on screen 3 write them on the log               CFT006
     C           P@WIX3    IFNE 0                                         CFT006
     C                     MOVEA@WFN3     @WKF                            CFT006
     C                     MOVEA@WMI3     @WKI                            CFT006
     C                     MOVEA@WMD3     @WKD                            CFT006
     C                     EXSR FILLOG                                    CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      * No errors on the detail side                                      CFT006
      * Retrieve the transaction number of header record                  178186
      * with the same fields as the tags present in part A.               178186
      * (SENDER / :20:)                                                   178186
      * This is done in order to be able to remove the                    178186
      * current position of the payment (shadow posting)                  178186
      * And also to check header (DR) part of message matches             178186
      * with the one created previously.                                  178186
     C           P@IX1     IFEQ 0                                         178186
     C           P@IX2     ANDEQ0                                         178186
     C           P@IX3     ANDEQ0                                         178186
     C                     MOVELSRHTID    WRTKY1                          178186
     C                     MOVELSRHSRF    WRTKY2                          178186
     C                     MOVELPMTPY     WRTMTY                          178186
     C                     MOVELSRHTYP    WRTPYT                          178186
     C                     MOVELSRHPST    WRTPST                          178186
     C                     MOVELSRHBKC    WRTBKC                          178186
     C                     MOVELSRHBRC    WRTBCH                          178186
     C                     MOVELSRHORB    WRTORB                          178186
     C                     MOVELSRHPFC    WRTPRF                          178186
     C                     EXSR RTMGTN                                    178186
      *                                                                   178186
      * If errors found write them on the log                             178186
     C           P@IX      IFNE 0                                         178186
     C                     MOVEA@FN       @WKF                            178186
     C                     MOVEA@MI       @WKI                            178186
     C                     MOVEA@MD       @WKD                            178186
     C                     EXSR FILLOG                                    178186
     C                     ENDIF                                          178186
     C                     ENDIF                                          178186
      *                                                                   CFT006
      * No errors on the detail side                                      CFT006
      * First DR/CR transaction to be created                             178186
      * CR transaction to be created of which DR info matches             178186
      * existing one                                                      178186
     C           P@IX1     IFEQ 0                                         CFT006
     C           P@IX2     ANDEQ0                                         CFT006
     C           P@IX3     ANDEQ0                                         CFT006
     C           P@IX      ANDEQ0                                         178186
      *                                                                   CFT006
      ** Map 101 tags header into file fields                             CFT006
     C                     CLEARHDRFTF                                    CFT006
     C                     CALL H101CV                 90                 CFT006
     C                     PARM *BLANK    P@RETN 10                       CFT006
     C                     PARM           P@ACTN                                              221538
     C                     PARM 'FH'      CVTCDE  2                       CFT006
     C                     PARM           HDRFTF                          CFT006
     C                     PARM *BLANK    PDATA                           CFT006
     C                     PARM *BLANK    PDAT2                                               CSW209
     C                     PARM 0         MGMSGR                          185107
     C                     PARM           HDRFTS                          CFT006
      *                                                                   CFT006
     C           *IN90     IFEQ '1'                                       CFT006
     C           P@RETN    ORNE *BLANK                                    CFT006
     C                     MOVEL'H101CV  'W0FILE                          CFT006
     C                     MOVEL'*CALL'   W0KEY            ***************CFT006
     C                     Z-ADD89        W0ERNB           * DB ERROR 89 *CFT006
     C                     MOVEL'MEM5003' W0MSGD           ***************CFT006
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT006
     C                     EXSR SRERRA                                    CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      ** Map 101 tags detail into file fields                             CFT006
     C                     CLEARDTRFTF                                    CFT006
     C                     CALL C101CV                 90                 CFT006
     C                     PARM *BLANK    P@RETN                          CFT006
     C                     PARM           P@ACTN                                              221538
     C                     PARM 'FC'      CVTCDE                          CFT006
     C                     PARM           DTRFTF                          CFT006
     C                     PARM           PHEAD                           CFT006
     C                     PARM *BLANK    PDATA                           CFT006
     C                     PARM *BLANK    PDAT2                                               CSW209
     C                     PARM           DTRFTS                          CFT006
      *                                                                   CFT006
     C           *IN90     IFEQ '1'                                       CFT006
     C           P@RETN    ORNE *BLANK                                    CFT006
     C                     MOVEL'C101CV  'W0FILE                          CFT006
     C                     MOVEL'*CALL'   W0KEY            ***************CFT006
     C                     Z-ADD90        W0ERNB           * DB ERROR 90 *CFT006
     C                     MOVEL'MEM5003' W0MSGD           ***************CFT006
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT006
     C                     EXSR SRERRA                                    CFT006
     C                     ENDIF                                          CFT006
      *                                                                   177674
      * Remove existing positions                                         177674
      * Its done only if we found some DR/CR transaction from             177674
      * previous part of the current message (FT0372)                     177674
     C                     CLEARHDRRD1                                                        212229
     C                     CLEARDTLRD1                                                        212229
     C                     EXSR ZEROFD                                                        212229
     C           WRTRTN    IFEQ *BLANK                                    177674
     C                     CALL A101PS                 90                 177674
     C                     PARM *BLANK    P@RETN 10                       177674
     C                     PARM           P@ACTN  1                       177674
     C                     PARM 'R'       P@ADRM  1                       177674
     C                     PARM WRTTRN    P@RFTI                          177674
     C                     PARM           HDRFTF                                              212229
     C                     PARM           DTRFTF                                              212229
     C                     PARM           HDRRD1                                              212229
     C                     PARM           DTLRD1                                              212229
     C                     PARM 'Y'       P@HDIN                                              212229
     C                     PARM 'Y'       P@DTIN                                              212229
     C                     PARM 'Y'       FTSTP   1                                           212229
      *                                                                   177674
     C           *IN90     IFEQ '1'                                       177674
     C           P@RETN    ORNE *BLANK                                    177674
     C                     MOVEL'A101PS  'W0FILE                          177674
     C                     MOVEL'*CALL'   W0KEY            ***************177674
     C                     Z-ADD107       W0ERNB           * DB ERROR 107*177674
     C                     MOVEL'MEM5003' W0MSGD           ***************177674
     C                     MOVEL'MIDAS  ' W0MSGF                          177674
     C                     EXSR SRERRA                                    177674
     C                     ENDIF                                          177674
      *                                                                   CFT006
     C                     ENDIF                                          177674
      *                                                                   CFT006
      * Insert the record                                                 CFT006
     C                     Z-ADD1         RHSEQN                                              221761
     C                     CALL H101UP                 90                 CFT006
     C                     PARM *BLANK    P@RETN 10                       CFT006
     C                     PARM 'I'       P@ACTN  1                       CFT006
     C                     PARM           HDRFTF                          CFT006
     C                     PARM           DTRFTF                          CFT006
     C                     PARM 'Y'       P@HDIN  1                       CFT006
     C                     PARM 'Y'       P@DTIN  1                       CFT006
     C                     PARM *BLANK    P@ORFI 15                       CFT006
     C                     PARM *BLANK    P@OTRI 16                       CFT006
     C                     PARM ##PGM     P@CPGM 10                       CFT006
     C                     PARM PNWRK     P@NWRK  6                       CFT006
     C                     PARM 0         P@IX    30                      CFT006
     C                     PARM *BLANK    @FN                             CFT006
     C                     PARM *BLANK    @MI                             CFT006
     C                     PARM *BLANK    @MD                             CFT006
      *                                                                   CFT006
     C           *IN90     IFEQ '1'                                       CFT006
     C           P@RETN    ORNE *BLANK                                    CFT006
     C           P@IX      ORNE 0                                         178186
     C                     MOVEL'H101UP  'W0FILE                          CFT006
     C                     MOVEL'*CALL'   W0KEY            ***************CFT006
     C                     Z-ADD91        W0ERNB           * DB ERROR 91 *CFT006
     C                     MOVEL'MEM5003' W0MSGD           ***************CFT006
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT006
     C                     EXSR SRERRA                                    CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      **If*errors*found*write*them*on*the*log                       CFT006178186
     C***********P@IX      IFNE 0                                   CFT006178186
     C*********************MOVEA@FN       @WKF                      CFT006178186
     C*********************MOVEA@MI       @WKI                      CFT006178186
     C*********************MOVEA@MD       @WKD                      CFT006178186
     C*********************EXSR FILLOG                              CFT006178186
     C*********************ENDIF                                    CFT006178186
      *                                                                   CFT006
      * No errors during the update                                       CFT006
     C           P@IX      IFEQ 0                                         CFT006
      *                                                                   177674
      * Create shadow postings                                            177674
     C           *LIKE     DEFN RHFTID    P@RFTI                          177674
     C                     CALL A101PS                 90                 177674
     C                     PARM *BLANK    P@RETN 10                       177674
     C                     PARM           P@ACTN  1                       177674
     C                     PARM 'A'       P@ADRM  1                       177674
     C                     PARM RHFTID    P@RFTI                          177674
     C                     PARM           HDRFTF                                              212229
     C                     PARM           DTRFTF                                              212229
     C                     PARM           HDRRD1                                              212229
     C                     PARM           DTLRD1                                              212229
     C                     PARM 'Y'       P@HDIN                                              212229
     C                     PARM 'Y'       P@DTIN                                              212229
     C                     PARM 'Y'       FTSTP                                               212229
      *                                                                   177674
     C           *IN90     IFEQ '1'                                       177674
     C           P@RETN    ORNE *BLANK                                    177674
     C                     MOVEL'A101PS  'W0FILE                          177674
     C                     MOVEL'*CALL'   W0KEY            ***************177674
     C                     Z-ADD101       W0ERNB           * DB ERROR 101*177674
     C                     MOVEL'MEM5003' W0MSGD           ***************177674
     C                     MOVEL'MIDAS  ' W0MSGF                          177674
     C                     EXSR SRERRA                                    177674
     C                     ENDIF                                          177674
      *                                                                   CFT006
      ***Set*up*##OK*as*Payment*Generation*successful               CFT006CFT006
      **************                                                CFT006CFT006
     C*********************MOVEL'Y'       ##OK                      CFT006CFT006
      *                                                                   CFT006
      * Authorisation flag set to Y in the criteria                       CFT006
     C           GNAUTO    IFEQ 'Y'                                       CFT006
     C                     CALL H101UP                 90                 CFT006
     C                     PARM *BLANK    P@RETN 10                       CFT006
     C                     PARM 'X'       P@ACTN  1                       CFT006
     C                     PARM           HDRFTF                          CFT006
     C                     PARM           DTRFTF                          CFT006
     C                     PARM *BLANK    P@HDIN  1                       CFT006
     C                     PARM *BLANK    P@DTIN  1                       CFT006
     C                     PARM *BLANK    P@ORFI 15                       CFT006
     C                     PARM *BLANK    P@OTRI 16                       CFT006
     C                     PARM ##PGM     P@CPGM 10                       CFT006
     C                     PARM PNWRK     P@NWRK  6                       CFT006
     C                     PARM 0         P@IX    30                      CFT006
     C                     PARM *BLANK    @FN                             CFT006
     C                     PARM *BLANK    @MI                             CFT006
     C                     PARM *BLANK    @MD                             CFT006
      *                                                                   CFT006
     C           *IN90     IFEQ '1'                                       CFT006
     C           P@RETN    ORNE *BLANK                                    CFT006
     C           P@IX      ORNE 0                                         178186
     C                     MOVEL'H101UP  'W0FILE                          CFT006
     C                     MOVEL'*CALL'   W0KEY            ***************CFT006
     C                     Z-ADD92        W0ERNB           * DB ERROR 92 *CFT006
     C                     MOVEL'MEM5003' W0MSGD           ***************CFT006
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT006
     C                     EXSR SRERRA                                    CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ENDIF                                          CFT006
      *                                                                   178186
      *  This instruction should always be at the end of the update       178186
      *  process.                                                         178186
      *  Set up ##OK as Payment Generation successful                     178186
      *                                                                   178186
     C                     MOVEL'Y'       ##OK                            178186
      *                                                                   CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      * Update the status of the message                                  CFT006
      * If OK flag not set to Y then some errors have been                CFT006
      * encountered therefore update the status of the message            CFT006
     C           ##OK      IFNE 'Y'                                       CFT006
     C                     EXSR SRAGCP                                    CFT006
     C                     ELSE                                           CFT006
      ** Done in API update module                                        CFT006
     C                     COMIT                                          178186
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      *  Unwind subroutine stack name                                     CFT006
      *                                                                   CFT006
     C           EXINRF    TAG                                            CFT006
     C                     MOVEA*BLANKS   @STK,Q                          CFT006
     C                     SUB  1         Q                               CFT006
      *                                                                   CFT006
     CSR                   ENDSR                                          CFT006
     C/EJECT
      *****************************************************************   CFT006
      *                                                               *   CFT006
      *  SRINCT   : Create Incoming CCT                               *   CFT006
      *                                                               *   CFT006
      *  CALLED BY: Main processing                                   *   CFT006
      *                                                               *   CFT006
      *****************************************************************   CFT006
     CSR         SRINCT    BEGSR                                          CFT006
      *                                                                   CFT006
      *  Set up subroutine stack name                                     CFT006
      *                                                                   CFT006
     C                     ADD  1         Q       50                      CFT006
     C                     MOVEL'SRINCT'  @STK,Q                          CFT006
      *                                                                   CFT006
      *  Report messages send before                                      CFT006
      *                                                                   CFT006
     C                     EXSR SRRERR                                    CFT006
      *                                                                   CFT006
     C                     CALL H102VL                 90                 CFT006
     C                     PARM *BLANK    P@RETN                          CFT006
     C                     PARM           P@RMOD                          CFT006
     C                     PARM NBS102    P@CURS                          CFT006
     C                     PARM 'I'       P@ACTN                          CFT006
     C                     PARM 'Y'       P@INIT                          CFT006
     C                     PARM           HDCCTS                          CFT006
     C                     PARM *BLANK    WRNDSP  1                       CFT006
     C                     PARM           CKHD1                           CFT006
     C                     PARM           CKHD2                           CFT006
     C                     PARM 0         P@IX1   30                      CFT006
     C                     PARM 0         P@IX2   30                      CFT006
     C                     PARM *BLANK    @FN1                            CFT006
     C                     PARM *BLANK    @MI1                            CFT006
     C                     PARM *BLANK    @MD1                            CFT006
     C                     PARM *BLANK    @FN2                            CFT006
     C                     PARM *BLANK    @MI2                            CFT006
     C                     PARM *BLANK    @MD2                            CFT006
     C                     PARM 0         P@WIX1  30                      CFT006
     C                     PARM 0         P@WIX2  30                      CFT006
     C                     PARM *BLANK    @WFN1                           CFT006
     C                     PARM *BLANK    @WMI1                           CFT006
     C                     PARM *BLANK    @WMD1                           CFT006
     C                     PARM *BLANK    @WFN2                           CFT006
     C                     PARM *BLANK    @WMI2                           CFT006
     C                     PARM *BLANK    @WMD2                           CFT006
      *                                                                   CFT006
     C           *IN90     IFEQ '1'                                       CFT006
     C           P@RETN    ORNE *BLANK                                    CFT006
     C                     MOVEL'H102VL  'W0FILE                          CFT006
     C                     MOVEL'*CALL'   W0KEY            ***************CFT006
     C                     Z-ADD99        W0ERNB           * DB ERROR 99 *CFT006
     C                     MOVEL'MEM5003' W0MSGD           ***************CFT006
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT006
     C                     EXSR SRERRA                                    CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      * Special case if error on field  FILE REFERENCE :                  CFT006
      * If it is due to a duplicate key, then  we  bypass this control    CFT006
      * because we call the FTM102UPD with both header present flag       CFT006
      * detail present flag set to Y. Therefore the update API module     CFT006
      * will check the duplicate key, before inserting the header         CFT006
      * record.                                                           CFT006
     C                     MOVEL'FILREF'  WREFLD                          CFT006
     C*********************MOVEL'RFV0190' WREMSG                    CFT006CFT006
     C                     MOVEL'RFV0338' WREMSG                          177995
     C                     Z-ADDP@IX1     WRENBR                          CFT006
     C                     MOVEA@FN1      @WKF                            CFT006
     C                     MOVEA@MI1      @WKI                            CFT006
     C                     MOVEA@MD1      @WKD                            CFT006
     C                     EXSR RMEMSG                                    CFT006
     C           P@IX1     IFNE WRENBR                                    CFT006
     C                     MOVEA@WKF      @FN1                            CFT006
     C                     MOVEA@WKI      @MI1                            CFT006
     C                     MOVEA@WKD      @MD1                            CFT006
     C                     Z-ADDWRENBR    P@IX1                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      * Special case if error on field  SUM OF AMOUNT                     CFT006
     C                     MOVEL'CCTAMT'  WREFLD                          CFT006
     C                     MOVEL'RFV0334' WREMSG                          CFT006
     C                     Z-ADDP@IX1     WRENBR                          CFT006
     C                     MOVEA@FN1      @WKF                            CFT006
     C                     MOVEA@MI1      @WKI                            CFT006
     C                     MOVEA@MD1      @WKD                            CFT006
     C                     EXSR RMEMSG                                    CFT006
     C           P@IX1     IFNE WRENBR                                    CFT006
     C                     MOVEA@WKF      @FN1                            CFT006
     C                     MOVEA@WKI      @MI1                            CFT006
     C                     MOVEA@WKD      @MD1                            CFT006
     C                     Z-ADDWRENBR    P@IX1                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      * Errors / Warnings generated by validation of header screen 1      CFT006
     C           P@IX1     IFNE 0                                         CFT006
     C           P@WIX1    ORNE 0                                         CFT006
     C                     MOVEL'RFD0002' W0LMSG                          CFT006
     C                     MOVEL'FTUSRMSG'W0MSGF                          CFT006
     C                     MOVEL'01'      W0MSDT                          CFT006
     C                     EXSR SRLOG                                     CFT006
      *                                                                   CFT006
      * If errors found on screen 1 write them on the log                 CFT006
     C           P@IX1     IFNE 0                                         CFT006
     C                     MOVEA@FN1      @WKF                            CFT006
     C                     MOVEA@MI1      @WKI                            CFT006
     C                     MOVEA@MD1      @WKD                            CFT006
     C                     EXSR FILLOG                                    CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      * If warnings found write them on the log                           CFT006
     C           P@WIX1    IFNE 0                                         CFT006
     C                     MOVEA@WFN1     @WKF                            CFT006
     C                     MOVEA@WMI1     @WKI                            CFT006
     C                     MOVEA@WMD1     @WKD                            CFT006
     C                     EXSR FILLOG                                    CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      * Errors / Warnings generated by validation of screen 2             CFT006
     C           P@IX2     IFNE 0                                         CFT006
     C           P@WIX2    ORNE 0                                         CFT006
     C                     MOVEL'RFD0002' W0LMSG                          CFT006
     C                     MOVEL'FTUSRMSG'W0MSGF                          CFT006
     C                     MOVEL'02'      W0MSDT                          CFT006
     C                     EXSR SRLOG                                     CFT006
      *                                                                   CFT006
      * If errors found on screen 2 write them on the log                 CFT006
     C           P@IX2     IFNE 0                                         CFT006
     C                     MOVEA@FN2      @WKF                            CFT006
     C                     MOVEA@MI2      @WKI                            CFT006
     C                     MOVEA@MD2      @WKD                            CFT006
     C                     EXSR FILLOG                                    CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      * If warnings found on screen 2 write them on the log               CFT006
     C           P@WIX2    IFNE 0                                         CFT006
     C                     MOVEA@WFN2     @WKF                            CFT006
     C                     MOVEA@WMI2     @WKI                            CFT006
     C                     MOVEA@WMD2     @WKD                            CFT006
     C                     EXSR FILLOG                                    CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      * No errors on the header side                                      CFT006
     C           P@IX1     IFEQ 0                                         CFT006
     C           P@IX2     ANDEQ0                                         CFT006
      *                                                                   CFT006
     C                     CALL C102VL                                    CFT006
     C                     PARM *BLANK    P@RETN 10                       CFT006
     C                     PARM           P@RMOD  1                       CFT006
     C                     PARM NBS102    P@CURS  2                       CFT006
     C                     PARM 'I'       P@ACTN  1                       CFT006
     C                     PARM 'Y'       P@INIT  1                       CFT006
     C                     PARM           HDCCTS                          CFT006
     C                     PARM           DTCCTS                          CFT006
     C                     PARM *BLANK    WRNDSP  1                       CFT006
     C                     PARM           CKCRE1                          CFT006
     C                     PARM           CKCRE2                          CFT006
     C                     PARM           CKHD1                           CFT006
     C                     PARM           CKHD2                           CFT006
     C                     PARM 0         P@IX1   30                      CFT006
     C                     PARM 0         P@IX2   30                      CFT006
     C                     PARM *BLANK    @FN1                            CFT006
     C                     PARM *BLANK    @MI1                            CFT006
     C                     PARM *BLANK    @MD1                            CFT006
     C                     PARM *BLANK    @FN2                            CFT006
     C                     PARM *BLANK    @MI2                            CFT006
     C                     PARM *BLANK    @MD2                            CFT006
     C                     PARM 0         P@WIX1  30                      CFT006
     C                     PARM 0         P@WIX2  30                      CFT006
     C                     PARM *BLANK    @WFN1                           CFT006
     C                     PARM *BLANK    @WMI1                           CFT006
     C                     PARM *BLANK    @WMD1                           CFT006
     C                     PARM *BLANK    @WFN2                           CFT006
     C                     PARM *BLANK    @WMI2                           CFT006
     C                     PARM *BLANK    @WMD2                           CFT006
      *                                                                   CFT006
     C           *IN90     IFEQ '1'                                       CFT006
     C           P@RETN    ORNE *BLANK                                    CFT006
     C                     MOVEL'C102VL  'W0FILE                          CFT006
     C                     MOVEL'*CALL'   W0KEY            ***************CFT006
     C                     Z-ADD94        W0ERNB           * DB ERROR 94 *CFT006
     C                     MOVEL'MEM5003' W0MSGD           ***************CFT006
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT006
     C                     EXSR SRERRA                                    CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      * Errors / Warnings generated by validation of screen 1             CFT006
     C           P@IX1     IFNE 0                                         CFT006
     C           P@WIX1    ORNE 0                                         CFT006
     C                     MOVEL'RFD0001' W0LMSG                          CFT006
     C                     MOVEL'FTUSRMSG'W0MSGF                          CFT006
     C                     MOVEL'01'      W0MSDT                          CFT006
     C                     EXSR SRLOG                                     CFT006
      *                                                                   CFT006
      * If errors found on screen 1 write them on the log                 CFT006
     C           P@IX1     IFNE 0                                         CFT006
     C                     MOVEA@FN1      @WKF                            CFT006
     C                     MOVEA@MI1      @WKI                            CFT006
     C                     MOVEA@MD1      @WKD                            CFT006
     C                     EXSR FILLOG                                    CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      * If warnings found on screen 1 write them on the log               CFT006
     C           P@WIX1    IFNE 0                                         CFT006
     C                     MOVEA@WFN1     @WKF                            CFT006
     C                     MOVEA@WMI1     @WKI                            CFT006
     C                     MOVEA@WMD1     @WKD                            CFT006
     C                     EXSR FILLOG                                    CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      * Errors / Warnings generated by validation of screen 2             CFT006
     C           P@IX2     IFNE 0                                         CFT006
     C           P@WIX2    ORNE 0                                         CFT006
     C                     MOVEL'RFD0001' W0LMSG                          CFT006
     C                     MOVEL'FTUSRMSG'W0MSGF                          CFT006
     C                     MOVEL'02'      W0MSDT                          CFT006
     C                     EXSR SRLOG                                     CFT006
      *                                                                   CFT006
      * If errors found on screen 2 write them on the log                 CFT006
     C           P@IX2     IFNE 0                                         CFT006
     C                     MOVEA@FN2      @WKF                            CFT006
     C                     MOVEA@MI2      @WKI                            CFT006
     C                     MOVEA@MD2      @WKD                            CFT006
     C                     EXSR FILLOG                                    CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      * If warnings found on screen 2 write them on the log               CFT006
     C           P@WIX2    IFNE 0                                         CFT006
     C                     MOVEA@WFN2     @WKF                            CFT006
     C                     MOVEA@WMI2     @WKI                            CFT006
     C                     MOVEA@WMD2     @WKD                            CFT006
     C                     EXSR FILLOG                                    CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      * No errors on the detail side                                      CFT006
      * Retrieve the transaction number of header record                  177674
      * with the same fields as the tags present in part A.               177674
      * (SENDER / :20:)                                                   177674
      * This is done in order to be able to remove the                    177674
      * current position of the payment (shadow posting)                  177674
      * And also to check header (DR) part of message matches             178186
      * with the one created previously.                                  178186
     C           P@IX1     IFEQ 0                                         CFT006
     C           P@IX2     ANDEQ0                                         CFT006
     C                     MOVELSCHCFI    WRTKY1                          178186
     C                     MOVELSCHREF    WRTKY2                          178186
     C                     MOVELPMTPY     WRTMTY                          178186
     C                     MOVELSCHTYP    WRTPYT                          178186
     C                     MOVELSCHPST    WRTPST                          178186
     C                     MOVELSCHBKC    WRTBKC                          178186
     C                     MOVELSCHBRC    WRTBCH                          178186
     C                     MOVELSCHORB    WRTORB                          178186
     C                     MOVELSCHPFC    WRTPRF                          178186
     C                     EXSR RTMGTN                                    178186
      * If errors found write them on the log                             178186
     C           P@IX      IFNE 0                                         178186
     C                     MOVEA@FN       @WKF                            178186
     C                     MOVEA@MI       @WKI                            178186
     C                     MOVEA@MD       @WKD                            178186
     C                     EXSR FILLOG                                    178186
     C                     ENDIF                                          178186
     C                     ENDIF                                          178186
      *                                                                   CFT006
      * No errors on the detail side                                      CFT006
      * First DR/CR transaction to be created                             178186
      * CR transaction to be created of which DR info matches             178186
      * existing one                                                      178186
     C           P@IX1     IFEQ 0                                         CFT006
     C           P@IX2     ANDEQ0                                         CFT006
     C           P@IX      ANDEQ0                                         178186
      *                                                                   CFT006
     C           *LIKE     DEFN PHMSGR    MGMSGR                          185107
      *
      ** Map 102 tags header into file fields                             CFT006
     C                     CLEARHDCCTF                                    CFT006
     C                     CALL H102CV                 90                 CFT006
     C                     PARM *BLANK    P@RETN 10                       CFT006
     C                     PARM           P@ACTN                                              221538
     C                     PARM *BLANK    PDATA                           CFT006
     C                     PARM *BLANK    PDAT2                                               CSW209
     C                     PARM 0         MGMSGR                          185107
     C                     PARM 'FH'      CVTCDE  2                       CFT006
     C                     PARM           HDCCTF                          CFT006
     C                     PARM           HDCCTS                          CFT006
      *                                                                   CFT006
     C           *IN90     IFEQ '1'                                       CFT006
     C           P@RETN    ORNE *BLANK                                    CFT006
     C                     MOVEL'H102CV  'W0FILE                          CFT006
     C                     MOVEL'*CALL'   W0KEY            ***************CFT006
     C                     Z-ADD95        W0ERNB           * DB ERROR 95 *CFT006
     C                     MOVEL'MEM5003' W0MSGD           ***************CFT006
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT006
     C                     EXSR SRERRA                                    CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      ** Map 102 tags detail into file fields                             CFT006
     C                     CLEARDTCCTF                                    CFT006
     C                     CALL C102CV                 90                 CFT006
     C                     PARM *BLANK    P@RETN                          CFT006
     C                     PARM           P@ACTN                                              221538
     C                     PARM           PHEAD                           CFT006
     C                     PARM *BLANK    PDATA                           CFT006
     C                     PARM *BLANK    PDAT2                                               CSW209
     C                     PARM 'FC'      CVTCDE                          CFT006
     C                     PARM           SCHTYP                          CFT006
     C                     PARM           SCHREF                          CFT006
     C                     PARM           DTCCTF                          CFT006
     C                     PARM           DTCCTS                          CFT006
      *                                                                   CFT006
     C           *IN90     IFEQ '1'                                       CFT006
     C           P@RETN    ORNE *BLANK                                    CFT006
     C                     MOVEL'C102CV  'W0FILE                          CFT006
     C                     MOVEL'*CALL'   W0KEY            ***************CFT006
     C                     Z-ADD96        W0ERNB           * DB ERROR 96 *CFT006
     C                     MOVEL'MEM5003' W0MSGD           ***************CFT006
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT006
     C                     EXSR SRERRA                                    CFT006
     C                     ENDIF                                          CFT006
      *                                                                   177674
      * Remove existing positions                                         177674
      * Its done only if we found some DR/CR transaction from             177674
      * previous part of the current message (FT0372)                     177674
     C                     CLEARHDRRD2                                                        212229
     C                     CLEARDTLRD2                                                        212229
     C                     EXSR ZEROFD                                                        212229
     C           WRTRTN    IFEQ *BLANK                                    177674
     C                     CALL A102PS                 90                 177674
     C                     PARM *BLANK    P@RETN 10                       177674
     C                     PARM           P@ACTN  1                       177674
     C                     PARM 'R'       P@ADRM  1                       177674
     C                     PARM WRTTRN    P@CCTI                          177674
     C                     PARM           HDCCTF                                              212229
     C                     PARM           DTCCTF                                              212229
     C                     PARM           HDRRD2                                              212229
     C                     PARM           DTLRD2                                              212229
     C                     PARM 'N'       HDRDLT  1                                           212229
      *                                                                   177674
     C           *IN90     IFEQ '1'                                       177674
     C           P@RETN    ORNE *BLANK                                    177674
     C                     MOVEL'A102PS  'W0FILE                          177674
     C                     MOVEL'*CALL'   W0KEY            ***************177674
     C                     Z-ADD109       W0ERNB           * DB ERROR 109*177674
     C                     MOVEL'MEM5003' W0MSGD           ***************177674
     C                     MOVEL'MIDAS  ' W0MSGF                          177674
     C                     EXSR SRERRA                                    177674
     C                     ENDIF                                          177674
      *                                                                   CFT006
     C                     ENDIF                                          177674
      *                                                                   CFT006
      * Insert the record                                                 CFT006
     C                     CALL H102UP                 90                 CFT006
     C                     PARM *BLANK    P@RETN 10                       CFT006
     C                     PARM 'I'       P@ACTN  1                       CFT006
     C                     PARM           HDCCTF                          CFT006
     C                     PARM           DTCCTF                          CFT006
     C                     PARM 'Y'       P@HDIN  1                       CFT006
     C                     PARM 'Y'       P@DTIN  1                       CFT006
     C                     PARM *BLANK    P@ORFI 15                       CFT006
     C                     PARM *BLANK    P@OTRI 16                       CFT006
     C                     PARM ##PGM     P@CPGM 10                       CFT006
     C                     PARM PNWRK     P@NWRK  6                       CFT006
     C                     PARM 0         P@IX    30                      CFT006
     C                     PARM *BLANK    @FN                             CFT006
     C                     PARM *BLANK    @MI                             CFT006
     C                     PARM *BLANK    @MD                             CFT006
      *                                                                   CFT006
     C           *IN90     IFEQ '1'                                       CFT006
     C           P@RETN    ORNE *BLANK                                    CFT006
     C           P@IX      ORNE 0                                         178186
     C                     MOVEL'H102UP  'W0FILE                          CFT006
     C                     MOVEL'*CALL'   W0KEY            ***************CFT006
     C                     Z-ADD97        W0ERNB           * DB ERROR 97 *CFT006
     C                     MOVEL'MEM5003' W0MSGD           ***************CFT006
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT006
     C                     EXSR SRERRA                                    CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      **If*errors*found*write*them*on*the*log                       CFT006CFT006
     C***********P@IX      IFNE 0                                   CFT006CFT006
     C*********************MOVEA@FN       @WKF                      CFT006CFT006
     C*********************MOVEA@MI       @WKI                      CFT006CFT006
     C*********************MOVEA@MD       @WKD                      CFT006CFT006
     C*********************EXSR FILLOG                              CFT006CFT006
     C*********************ENDIF                                    CFT006CFT006
      *                                                                   CFT006
      * No errors during the update                                       CFT006
     C           P@IX      IFEQ 0                                         CFT006
      *                                                                   177674
      * Update total amount of header                                     177674
     C                     MOVELCHDCCT    SCHCCT                          177674
     C                     CALL U102SM                 90                 177674
     C                     PARM *BLANK    P@RETN 10                       177674
     C                     PARM           HDCCTS                          177674
      *                                                                   177674
     C           *IN90     IFEQ '1'                                       177674
     C           P@RETN    ORNE *BLANK                                    177674
     C                     MOVEL'U102SM  'W0FILE                          177674
     C                     MOVEL'*CALL'   W0KEY            ***************177674
     C                     Z-ADD104       W0ERNB           * DB ERROR 104*177674
     C                     MOVEL'MEM5003' W0MSGD           ***************177674
     C                     MOVEL'MIDAS  ' W0MSGF                          177674
     C                     EXSR SRERRA                                    177674
     C                     ENDIF                                          177674
      *                                                                   177674
      * Create shadow postings                                            177674
     C           *LIKE     DEFN CHDCCT    P@CCTI                          177674
     C                     CALL A102PS                 90                 177674
     C                     PARM *BLANK    P@RETN 10                       177674
     C                     PARM           P@ACTN  1                       177674
     C                     PARM 'A'       P@ADRM  1                       177674
     C                     PARM CHDCCT    P@CCTI                          177674
     C                     PARM           HDCCTF                                              212229
     C                     PARM           DTCCTF                                              212229
     C                     PARM           HDRRD2                                              212229
     C                     PARM           DTLRD2                                              212229
     C                     PARM 'N'       HDRDLT                                              212229
      *                                                                   177674
     C           *IN90     IFEQ '1'                                       177674
     C           P@RETN    ORNE *BLANK                                    177674
     C                     MOVEL'A102PS  'W0FILE                          177674
     C                     MOVEL'*CALL'   W0KEY            ***************177674
     C                     Z-ADD103       W0ERNB           * DB ERROR 103*177674
     C                     MOVEL'MEM5003' W0MSGD           ***************177674
     C                     MOVEL'MIDAS  ' W0MSGF                          177674
     C                     EXSR SRERRA                                    177674
     C                     ENDIF                                          177674
      *********************                                         CFT006177674
      ***Set*up*##OK*as*Payment*Generation*successful               CFT006177674
      *********************                                         CFT006177674
     C*********************MOVEL'Y'       ##OK                      CFT006177674
      *                                                                   CFT006
      * Authorisation flag set to Y in the criteria                       CFT006
     C           GNAUTO    IFEQ 'Y'                                       CFT006
     C                     CALL H102UP                 90                 CFT006
     C                     PARM *BLANK    P@RETN 10                       CFT006
     C                     PARM 'X'       P@ACTN  1                       CFT006
     C                     PARM           HDCCTF                          CFT006
     C                     PARM           DTCCTF                          CFT006
     C                     PARM *BLANK    P@HDIN  1                       CFT006
     C                     PARM *BLANK    P@DTIN  1                       CFT006
     C                     PARM *BLANK    P@ORFI 15                       CFT006
     C                     PARM *BLANK    P@OTRI 16                       CFT006
     C                     PARM ##PGM     P@CPGM 10                       CFT006
     C                     PARM PNWRK     P@NWRK  6                       CFT006
     C                     PARM 0         P@IX    30                      CFT006
     C                     PARM *BLANK    @FN                             CFT006
     C                     PARM *BLANK    @MI                             CFT006
     C                     PARM *BLANK    @MD                             CFT006
      *                                                                   CFT006
     C           *IN90     IFEQ '1'                                       CFT006
     C           P@RETN    ORNE *BLANK                                    CFT006
     C           P@IX      ORNE 0                                         178186
     C                     MOVEL'H102UP  'W0FILE                          CFT006
     C                     MOVEL'*CALL'   W0KEY            ***************CFT006
     C                     Z-ADD98        W0ERNB           * DB ERROR 98 *CFT006
     C                     MOVEL'MEM5003' W0MSGD           ***************CFT006
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT006
     C                     EXSR SRERRA                                    CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ENDIF                                          CFT006
      *                                                                   178186
      *  This instruction should always be at the end of the update       178186
      *  process.                                                         178186
      *  Set up ##OK as Payment Generation successful                     178186
      *                                                                   178186
     C                     MOVEL'Y'       ##OK                            178186
      *                                                                   CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      * Update the status of the message                                  CFT006
      * If OK flag not set to Y then some errors have been                CFT006
      * encountered therefore update the status of the message            CFT006
     C           ##OK      IFNE 'Y'                                       CFT006
     C                     EXSR SRAGCP                                    CFT006
     C                     ELSE                                           CFT006
      ** Done in API update module                                        CFT006
     C                     COMIT                                          178186
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      *  Unwind subroutine stack name                                     CFT006
      *                                                                   CFT006
     C           EXINCT    TAG                                            CFT006
     C                     MOVEA*BLANKS   @STK,Q                          CFT006
     C                     SUB  1         Q                               CFT006
      *                                                                   CFT006
     CSR                   ENDSR                                          CFT006
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRINFT   : Create Incoming Payment Transaction               *
      *                                                               *
      *  CALLED BY: Main processing                                   *
      *                                                               *
      *****************************************************************
     CSR         SRINFT    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SRINFT'  @STK,Q
      *
      *  /Copy point for Create Incoming Payment
      *
     C/COPY WNCPYSRC,FT0300INFT
      *
      *  Validate Level 1 Screen 1
      *
     C                     EXSR SRINS1
      *
      *  Validate Level 2 Screen 1 - if valid
      *
     C           E#NOUP    IFEQ *BLANKS
     C                     EXSR SRINS2
      *
      *  Validate Level 2 Screen 2 - if valid
      *
     C           E#NOUP    IFEQ *BLANKS
     C                     EXSR SRINS3
      *                                                                   CFT014
      *  Validate Level 2 Screen 3 - if valid                             CFT014
      *                                                                   CFT014
     C           E#NOUP    IFEQ *BLANKS                                   CFT014
     C                     EXSR SRINS4                                    CFT014
     C/COPY WNCPYSRC,FT0300C075
     C                     ENDIF                                          CFT014
      *                                                                                       CER030
      ** Validate Extended Narrative                                                          CER030
      *                                                                                       CER030
     C           E#NOUP    IFEQ *BLANKS                                                       CER030
     C           CER031    ANDEQ'Y'                                                           CER030
      *                                                                                       CER030
     C                     MOVELIEXN1     PNAR1                                               CER030
     C                     MOVELIEXN2     PNAR2                                               CER030
     C                     MOVELIEXN3     PNAR3                                               CER030
     C                     MOVELIEXN4     PNAR4                                               CER030
     C                     MOVELIEXN5     PNAR5                                               CER030
     C                     MOVELIEXN6     PNAR6                                               CER030
      *                                                                                       CER030
     C                     EXSR SREXVL                                                        CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      *  Validate Transaction Type                                                            CER030
      *                                                                                       CER030
     C           E#NOUP    IFEQ *BLANKS                                                       CER030
      *                                                                                       CER030
     C           CER030    IFEQ 'Y'                                                           CER030
     C           CGL013    OREQ 'Y'                                                           CER030
     C                     MOVELWIRTTY    WRTTY   5                                           CER030
     C                     MOVELS3TTCD    WTTCD   3                                           CER030
     C                     EXSR SRTRTY                                                        CER030
     C                     MOVELWRTTY     WIRTTY                                              CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      *                                                                                       CSW209
     C           CSW209    IFEQ 'Y'                                                           CSW209
      *                                                                                       CSW209
     C           E#NOUP    IFEQ *BLANKS                                                       CSW209
     C                     EXSR SRINS5                                                        CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C           E#NOUP    IFEQ *BLANKS                                                       CSW209
     C                     EXSR SRINS6                                                        CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     END
     C                     END
     C/COPY WNCPYSRC,FT0300C064
      *
      *  Control Update of database
      *
     C           ##INS1    IFEQ 'Y'
     C           OVINS1    ANDEQ'Y'
     C           ##INS2    OREQ 'Y'
     C           OVINS2    ANDEQ'Y'
     C           ##INS3    OREQ 'Y'
     C           OVINS3    ANDEQ'Y'
     C           ##INS4    OREQ 'Y'                                       CFT014
     C           OVINS4    ANDEQ'Y'                                       CFT014
     C           E#NOUP    OREQ *BLANKS
     C/COPY WNCPYSRC,FT0300C065
      *                                                                   CFT009
      * Determine whether customer need to be notified                    CFT009
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
     C                     CLEARSTRIN                                     CFT009
     C                     MOVELS2BTB     STRIN                           CFT009
      *                                                                   CFT009
     C                     CALL 'FTVNCWD'                                 CFT009
     C                     PARM *BLANKS   RETCDE 10                       CFT009
     C                     PARM           STRIN                           CFT009
     C                     PARM           WNTFY                           CFT009
     C                     PARM           CODEW  10                       CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      * If customer does not need to be notified, payment can be auto     CFT009
      * authorised                                                        CFT009
      *                                                                   CFT009
     C           WNTFY     IFNE 'N'                                       CFT009
      *                                                                   CFT005
      *   Auto authorise                                                  CFT005
      *                                                                   CFT005
     C           CFT005    IFEQ 'Y'                                       CFT005
     C           GNAUTO    ANDEQ'Y'                                       CFT005
     C                     EXSR SRINAU                                    CFT005
     C                     ENDIF                                          CFT005
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT005
     C                     EXSR SRINUP
     C                     ELSE
     C                     EXSR SRAGCP
     C                     END
      *                                                                   S01408
     C/COPY WNCPYSRC,FT0300CP14                                           S01408
      *                                                                   S01408
      *
      *  Unwind subroutine stack name
      *
     C           EXINFT    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SROTFT   : Create Outgoing Payment Transaction               *
      *                                                               *
      *  CALLED BY: Main processing                                   *
      *                                                               *
      *****************************************************************
     CSR         SROTFT    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SROTFT'  @STK,Q
      *
      *  /Copy point for Create Outgoing Payment
      *
     C/COPY WNCPYSRC,FT0300OTFT
      *
      *  Validate Level 1 Screen 1
      *
     C                     EXSR SROPS1
      *                                                                                     BUG24724
      ** Find out if this OP will potentially create a MT103.                               BUG24724
      *                                                                                     BUG24724
     C           CFT014    IFEQ 'Y'                                                         BUG24724
     C                     EXSR SRB103                                                      BUG24724
     C                     ENDIF                                                            BUG24724
      *
      *  Validate Level 2 Screen 1 - if valid
      *
     C           E#NOUP    IFEQ *BLANKS
      *                                                                   S01408
     C/COPY WNCPYSRC,FT0300CCP1                                           S01408
      *                                                                   S01408
     C                     EXSR SROPS2
      *
      *  Validate Level 2 Screen 2 - if valid
      *
     C           E#NOUP    IFEQ *BLANKS
      *                                                                                       208219
      ** Find out if this OP will potentially create a MT103                                  208219
      *                                                                                       208219
     C           CFT014    IFEQ 'Y'                                                           208219
     C                     EXSR SRB103                                                        208219
     C                     ENDIF                                                              208219
      *                                                                                       208219
      *                                                                   S01408
     C/COPY WNCPYSRC,FT0300CCP2                                           S01408
      *                                                                   S01408
     C                     EXSR SROPS3
      *                                                                   CFT014
      *  Validate Level 2 Screen 3 - if valid                             CFT014
      *                                                                   CFT014
     C           E#NOUP    IFEQ *BLANKS                                   CFT014
     C                     EXSR SROPS4                                    CFT014
     C/COPY WNCPYSRC,FT0300C076
     C                     ENDIF                                          CFT014
      *                                                                                       CER030
      ** Validate Extended Narrative                                                          CER030
      *                                                                                       CER030
     C           E#NOUP    IFEQ *BLANKS                                                       CER030
     C           CER031    ANDEQ'Y'                                                           CER030
      *                                                                                       CER030
     C                     MOVELOPEXN1    PNAR1                                               CER030
     C                     MOVELOPEXN2    PNAR2                                               CER030
     C                     MOVELOPEXN3    PNAR3                                               CER030
     C                     MOVELOPEXN4    PNAR4                                               CER030
     C                     MOVELOPEXN5    PNAR5                                               CER030
     C                     MOVELOPEXN6    PNAR6                                               CER030
      *                                                                                       CER030
     C                     EXSR SREXVL                                                        CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      ** Validate Transaction Type                                                            CER030
      *                                                                                       CER030
     C           E#NOUP    IFEQ *BLANKS                                                       CER030
      *                                                                                       CER030
     C           CER030    IFEQ 'Y'                                                           CER030
     C           CGL013    OREQ 'Y'                                                           CER030
     C                     MOVELWORTTY    WRTTY                                               CER030
     C                     MOVELS5TTCD    WTTCD                                               CER030
     C                     EXSR SRTRTY                                                        CER030
     C                     MOVELWRTTY     WORTTY                                              CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      *                                                                                       CSW209
     C           CSW209    IFEQ 'Y'                                                           CSW209
      *                                                                                       CSW209
     C           E#NOUP    IFEQ *BLANKS                                                       CSW209
     C                     EXSR SROPS5                                                        CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C           E#NOUP    IFEQ *BLANKS                                                       CSW209
     C                     EXSR SROPS6                                                        CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     END
     C                     END
      *
      *  Control Update of database
      *
     C           ##OPS4    IFEQ 'Y'
     C           OVOPS4    ANDEQ'Y'
     C           ##OPS5    OREQ 'Y'
     C           OVOPS5    ANDEQ'Y'
     C           ##OPS6    OREQ 'Y'
     C           OVOPS6    ANDEQ'Y'
     C           ##OPS7    OREQ 'Y'                                       CFT014
     C           OVOPS7    ANDEQ'Y'                                       CFT014
     C           E#NOUP    OREQ *BLANKS
      *                                                                   CFT005
      *** Auto authorise                                                  CFT005
      *                                                                   CFT005
     C           CFT005    IFEQ 'Y'                                       CFT005
     C           GNAUTO    ANDEQ'Y'                                       CFT005
     C                     EXSR SROTAU                                    CFT005
     C                     ENDIF                                          CFT005
      *                                                                   S01408
     C/COPY WNCPYSRC,FT0300CCP3                                           S01408
      *                                                                   S01408
     C                     EXSR SROPUP
     C                     ELSE
     C                     EXSR SRAGCP
     C                     END
      *
      *  Unwind subroutine stack name
      *
     C           EXOTFT    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
      *****************************************************************   CRE008
     C/EJECT                                                              CRE008
      *****************************************************************   CRE008
      *                                                               *   CRE008
      *  SRC101   : Process Cash Management MT101                     *   CRE008
      *             External Topping request                          *   CRE008
      *                                                               *   CRE008
      *  CALLED BY: Main processing                                   *   CRE008
      *                                                               *   CRE008
      *****************************************************************   CRE008
     CSR         SRC101    BEGSR                                          CRE008
     C*                                                                   CRE008
     C*  Call RE102002 to create postings,                                CRE008
     C*       write a record to REICSDPD,                                 CRE008
     C*       and submit the job to create reply MT103                    CRE008
     C                     CALL 'RE102002'             9090               CRE008
     C                     PARM           P@RTCD  7                       CRE008
     C                     PARM           PHEAD                           CRE008
     C                     PARM           PDATA                           CRE008
     C                     PARM P@RETV    P@RETF256                       CRE008
     C*                                                                   CRE008
     C           *IN90     IFEQ '1'                                       CRE008
     C           P@RTCD    OREQ '*ERROR '                                 CRE008
     C                     MOVEL'RE102002'W0FILE                          CRE008
     C                     MOVEL'*CALL'   W0KEY            ***************CRE008
     C                     Z-ADD158       W0ERNB           * DB ERROR 158*CRE008
     C                     MOVEL'MEM5003' W0MSGD           ***************CRE008
     C                     MOVEL'MIDAS  ' W0MSGF                          CRE008
     C                     EXSR SRERRA                                    CRE008
     C                     ELSE                                           CRE008
      *  Set up ##OK as Generation successful                             CRE008
     C                     MOVEL'Y'       ##OK                            CRE008
     C                     END                                            CRE008
     C*  Log messages                                                     CRE008
     C                     EXSR SRRERR                                    CRE008
     C*                                                                   CRE008
     C           ##OK      IFEQ 'Y'                                       CRE008
     C*                                                                   CRE008
     C*  Update MEINFTPD (to prevent from being processed again)          CRE008
     C                     CLEARINFT                                      CRE008
     C                     Z-ADDPHMSGR    FTMSGR           Unique Ref.    CRE008
     C                     Z-ADDPHPART    FTKPRT           Part No.       CRE008
     C                     MOVEL'MIN0508' FTINFG           Incoming Flag  CRE008
      *  Set up data to be passed using the rcd format data structure     CRE008
     C                     CALL 'ME1050'               90                 CRE008
     C                     PARM '*FT INC 'W2ACT   8                       CRE008
     C                     PARM ##PGM     W2CPGM 10                       CRE008
     C                     PARM *BLANKS   W2NWRK  6                       CRE008
     C                     PARM 'MIN0508' W2LMSG  7                       CRE008
     C                     PARM           INFT                            CRE008
     C                     PARM *BLANKS   W2RTN   7                       CRE008
      *                                                                   CRE008
      *  If return with an error (LR seton in called program) then        CRE008
      *  process for database error.                                      CRE008
      *                                                                   CRE008
     C           *IN90     IFEQ '1'                                       CRE008
     C           W2RTN     OREQ '*ERROR*'                                 CRE008
     C                     MOVEL'*CALL  ' W0FILE                          CRE008
     C                     MOVEL'ME1050 ' W0KEY                           CRE008
     C                     Z-ADD3         W0ERNB                          CRE008
     C                     MOVEL'MEM5003' W0MSGD                          CRE008
     C                     MOVEL'MIDAS  ' W0MSGF                          CRE008
     C                     EXSR SRERRA                                    CRE008
     C                     ENDIF                                          CRE008
     C*                                                                   CRE008
     C                     ENDIF                                          CRE008
     C*                                                                   CRE008
     CSR                   ENDSR                                          CRE008
      *****************************************************************   CRE008
     C/EJECT                                                              CRE008
      *****************************************************************   CRE008
      *                                                               *   CRE008
      *  SRR103   : Process Cash Management Reply MT103               *   CRE008
      *                                                               *   CRE008
      *  CALLED BY: Main processing                                   *   CRE008
      *                                                               *   CRE008
      *****************************************************************   CRE008
     CSR         SRR103    BEGSR                                          CRE008
     C*                                                                   CRE008
     C*  Call RE102003 to update REICSDPD flag MT101 as matched,          CRE008
     C*       Update posting records on GLPSTTPD & GLPSTZSPD              CRE008
     C*       and create postings for charges                             CRE008
     C                     CALL 'RE102003'                                CRE008
     C                     PARM           P@RTCD  7                       CRE008
     C                     PARM           PHEAD                           CRE008
     C                     PARM           PDATA                           CRE008
     C                     PARM P@RETV    P@RETF256                       CRE008
     C*                                                                   CRE008
     C           *IN90     IFEQ '1'                                       CRE008
     C           P@RTCD    OREQ '*ERROR '                                 CRE008
     C                     MOVEL'RE102003'W0FILE                          CRE008
     C                     MOVEL'*CALL'   W0KEY            ***************CRE008
     C                     Z-ADD159       W0ERNB           * DB ERROR 159*CRE008
     C                     MOVEL'MEM5003' W0MSGD           ***************CRE008
     C                     MOVEL'MIDAS  ' W0MSGF                          CRE008
     C                     EXSR SRERRA                                    CRE008
     C                     ELSE                                           CRE008
      *  Set up ##OK as Generation successful                             CRE008
     C                     MOVEL'Y'       ##OK                            CRE008
     C                     END                                            CRE008
     C*                                                                   CRE008
     C*  Log messages                                                     CRE008
     C                     EXSR SRRERR                                    CRE008
     C*                                                                   CRE008
     C           ##OK      IFEQ 'Y'                                       CRE008
     C*  Update MEINFTPD (to prevent from being processed again)          CRE008
     C                     CLEARINFT                                      CRE008
     C                     Z-ADDPHMSGR    FTMSGR           Unique Ref.    CRE008
     C                     Z-ADDPHPART    FTKPRT           Part No.       CRE008
     C                     MOVEL'MIN0509' FTINFG           Incoming Flag  CRE008
      *  Set up data to be passed using the rcd format data structure     CRE008
     C                     CALL 'ME1050'               90                 CRE008
     C                     PARM '*FT INC 'W2ACT   8                       CRE008
     C                     PARM ##PGM     W2CPGM 10                       CRE008
     C                     PARM *BLANKS   W2NWRK  6                       CRE008
     C                     PARM 'MIN0509' W2LMSG  7                       CRE008
     C                     PARM           INFT                            CRE008
     C                     PARM *BLANKS   W2RTN   7                       CRE008
      *                                                                   CRE008
      *  If return with an error (LR seton in called program) then        CRE008
      *  process for database error.                                      CRE008
      *                                                                   CRE008
     C           *IN90     IFEQ '1'                                       CRE008
     C           W2RTN     OREQ '*ERROR*'                                 CRE008
     C                     MOVEL'*CALL  ' W0FILE                          CRE008
     C                     MOVEL'ME1050 ' W0KEY                           CRE008
     C                     Z-ADD3         W0ERNB                          CRE008
     C                     MOVEL'MEM5003' W0MSGD                          CRE008
     C                     MOVEL'MIDAS  ' W0MSGF                          CRE008
     C                     EXSR SRERRA                                    CRE008
     C                     ENDIF                                          CRE008
     C                     ENDIF                                          CRE008
     C*                                                                   CRE008
     CSR                   ENDSR                                          CRE008
      *****************************************************************   CRE008
     C/EJECT                                                              CRE008
      *****************************************************************   CRE008
      *                                                               *   CRE008
      *  SRS103   : Process Cash Management Direct Sweep MT103        *   CRE008
      *                                                               *   CRE008
      *  CALLED BY: Main processing                                   *   CRE008
      *                                                               *   CRE008
      *****************************************************************   CRE008
     CSR         SRS103    BEGSR                                          CRE008
     C*                                                                   CRE008
     C*  Call RE102004 to create sweeping postings,                       CRE008
     C*       create charges postings                                     CRE008
     C                     CALL 'RE102004'                                CRE008
     C                     PARM           P@RTCD  7                       CRE008
     C                     PARM           PHEAD                           CRE008
     C                     PARM           PDATA                           CRE008
     C                     PARM P@RETV    P@RETF256                       CRE008
     C*                                                                   CRE008
     C           *IN90     IFEQ '1'                                       CRE008
     C           P@RTCD    OREQ '*ERROR '                                 CRE008
     C                     MOVEL'RE102004'W0FILE                          CRE008
     C                     MOVEL'*CALL'   W0KEY            ***************CRE008
     C                     Z-ADD160       W0ERNB           * DB ERROR 160*CRE008
     C                     MOVEL'MEM5003' W0MSGD           ***************CRE008
     C                     MOVEL'MIDAS  ' W0MSGF                          CRE008
     C                     EXSR SRERRA                                    CRE008
     C                     ELSE                                           CRE008
      *  Set up ##OK as Generation successful                             CRE008
     C                     MOVEL'Y'       ##OK                            CRE008
     C                     END                                            CRE008
     C*                                                                   CRE008
     C*  Log messages                                                     CRE008
     C                     EXSR SRRERR                                    CRE008
     C*                                                                   CRE008
     C           ##OK      IFEQ 'Y'                                       CRE008
     C*  Update MEINFTPD (to prevent from being processed again)          CRE008
     C                     CLEARINFT                                      CRE008
     C                     Z-ADDPHMSGR    FTMSGR           Unique Ref.    CRE008
     C                     Z-ADDPHPART    FTKPRT           Part No.       CRE008
     C                     MOVEL'MIN0510' FTINFG           Incoming Flag  CRE008
      *  Set up data to be passed using the rcd format data structure     CRE008
     C                     CALL 'ME1050'               90                 CRE008
     C                     PARM '*FT INC 'W2ACT   8                       CRE008
     C                     PARM ##PGM     W2CPGM 10                       CRE008
     C                     PARM *BLANKS   W2NWRK  6                       CRE008
     C                     PARM 'MIN0510' W2LMSG  7                       CRE008
     C                     PARM           INFT                            CRE008
     C                     PARM *BLANKS   W2RTN   7                       CRE008
      *                                                                   CRE008
      *  If return with an error (LR seton in called program) then        CRE008
      *  process for database error.                                      CRE008
      *                                                                   CRE008
     C           *IN90     IFEQ '1'                                       CRE008
     C           W2RTN     OREQ '*ERROR*'                                 CRE008
     C                     MOVEL'*CALL  ' W0FILE                          CRE008
     C                     MOVEL'ME1050 ' W0KEY                           CRE008
     C                     Z-ADD3         W0ERNB                          CRE008
     C                     MOVEL'MEM5003' W0MSGD                          CRE008
     C                     MOVEL'MIDAS  ' W0MSGF                          CRE008
     C                     EXSR SRERRA                                    CRE008
     C                     ENDIF                                          CRE008
     C                     ENDIF                                          CRE008
     C*                                                                   CRE008
     CSR                   ENDSR                                          CRE008
      *****************************************************************   CRE008
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRIGNR   : Ignore Message in Funds Transfer                  *
      *                                                               *
      *  CALLED BY: Main processing                                   *
      *                                                               *
      *****************************************************************
     CSR         SRIGNR    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SRIGNR'  @STK,Q
      *
      *  /Copy point for Ignore payment
      *
     C/COPY WNCPYSRC,FT0300IGNR
      *
      *  Fill record format data structure with available data
      *
     C                     CLEARINFT
      *
     C                     Z-ADDINMSGR    FTMSGR           Unique Ref.
     C                     Z-ADDINKPRT    FTKPRT           Part No.
     C                     MOVEL'MIN0182' FTINFG           Incoming Flag
      *
      *  N.B. Audit Stamp details are determined in called program
      *
      *
      *  Set up data to be passed using the rcd format data structure
      *
     C                     CALL 'ME1050'               90
     C                     PARM '*FT INC 'W2ACT   8
     C                     PARM ##PGM     W2CPGM 10
     C                     PARM *BLANKS   W2NWRK  6
     C                     PARM 'MIN0182' W2LMSG  7
     C                     PARM           INFT
     C                     PARM *BLANKS   W2RTN   7
      *
      *  If return with an error (LR seton in called program) then
      *  process for database error.
      *
     C           *IN90     IFEQ '1'
     C           W2RTN     OREQ '*ERROR*'
     C                     MOVEL'*CALL  ' W0FILE
     C                     MOVEL'ME1050 ' W0KEY
     C                     Z-ADD3         W0ERNB
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C***********          EXSR SRERR                                     130869
     C                     EXSR SRERRA                                    130869
     C                     END
     C/COPY WNCPYSRC,FT0300C023
      *
      *  Commit changes
      *
     C                     COMIT
      *
      *  Unwind subroutine stack name
      *
     C           EXIGNR    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRNPRC   : Report Decode/Analysis errors                     *
      *                                                               *
      *  CALLED BY: Main processing                                   *
      *                                                               *
      *****************************************************************
     CSR         SRNPRC    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SRNPRC'  @STK,Q
      *
      *  /Copy point for No action Report
      *
     C/COPY WNCPYSRC,FT0300NPRC
      *
      *  Report errors
      *
     C                     EXSR SRRERR
      *
      *  Set Auto Generation complete
      *
     C                     EXSR SRAGCP
      *
      *  Unwind subroutine stack name
      *
     C           EXNPRC    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRREPT   : Print report of actions                           *
      *                                                               *
      *  CALLED BY: Main processing                                   *
      *                                                               *
      *****************************************************************
     CSR         SRREPT    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SRREPT'  @STK,Q
      *
      *  /Copy point for Report Actions
      *
     C/COPY WNCPYSRC,FT0300REPT
      *                                                               *   CFT002
      *****************************************************************   CFT002
      *                                                               *   CFT002
      *  Exit if generation O.K.                                      *   CFT002
      *                                                               *   CFT002
      *****************************************************************   CFT002
      *                                                               *   CFT002
     C***********##OK      IFEQ 'Y'                                 CFT002CFT003
     C***********W0ACT     OREQ *BLANKS                             CFT002CFT003
     C*********************GOTO EXREPT                              CFT002CFT003
     C*********************ENDIF                                    CFT002CFT003
     C           W0ACT     IFEQ *BLANKS                                   CFT003
     C                     GOTO EXREPT                                    CFT003
     C                     ENDIF                                          CFT003
      *                                                                   130869
      ** Check if to print successful or failed transactions              130869
      *                                                                   130869
     C           PNWRK     IFEQ 'CASHV8'                                  130869
     C           ##OK      ANDEQ'Y'                                       130869
     C           DAPSUC    ANDEQ'N'                                       130869
     C           PNWRK     OREQ 'CASHV8'                                  130869
     C           ##OK      ANDNE'Y'                                       130869
     C           DAPFAI    ANDEQ'N'                                       130869
     C                     GOTO EXREPT                                    130869
     C                     ENDIF                                          130869
      *                                                                   CGL009
      * If its still running during the I/C termination then              CGL009
      * we flag to Y the indicator 'TPP tranfered to ICT' in order        CGL009
      * to warn the user that message has not been processed into         CGL009
      * Funds Transfert database                                          CGL009
     C           PNWRK     IFEQ 'FONTIS'                                  CGL009
     C           ##OK      IFNE 'Y'                                       CGL009
     C           FGPHAS    IFEQ 'B'                                       CGL009
     C           FGICTT    IFNE 'Y'                                       CGL009
     C           *NAMVAR   DEFN MEFTPPDA  MEFTPP                          CGL009
     C           *LOCK     IN   MEFTPP                                    CGL009
     C                     MOVEL'Y'       FGICTT                          CGL009
     C                     OUT  MEFTPP                                    CGL009
     C                     ENDIF                                          CGL009
     C                     ENDIF                                          CGL009
     C                     ENDIF                                          CGL009
     C                     ENDIF                                          CGL009
      *
      *  Clear data structure and set report printed
      *
     C                     CLEARI#DTA
      *
      *  If Auto gen was successful then use FT0300 else FT0310
      *
     C           ##OK      IFEQ 'Y'
     C                     MOVEL'FT0300P1'I#SPLN
     C                     MOVEL'FT0300P1'I#REFN
     C                     MOVEL'MIN0231' I#TITL
     C                     MOVEL'MIN0232' I#TUL
     C                     ELSE
     C                     MOVEL'FT0310P1'I#SPLN
     C                     MOVEL'FT0310P1'I#REFN
     C                     MOVEL'MIN0242' I#TITL
     C                     MOVEL'MIN0243' I#TUL
     C                     END
      *
      *  Open spool file in ME1140
      *
     C                     MOVEL'Y'       I#SPLR
      *
     C                     MOVEL*BLANKS   I#BRCA
     C                     Z-ADDINMSGR    I#MSGR
     C                     Z-ADDINKPRT    I#PART
     C                     MOVEL'HPFDL'   I#RFMT
      *
     C                     CALL 'ME1140'               9090
     C                     PARM *BLANKS   W0RTN   7
     C*********************PARM '*PRINT  'W0ACT   8                       CGL009
     C                     PARM '*PRINT  'W2ACT   8                       CGL009
     C                     PARM           I#DTA            Input Data Str.
     C                     PARM *BLANKS   I#RSQN  5
      *
     C           *IN90     IFEQ '1'
     C           W0RTN     ORNE *BLANKS
     C                     MOVEL'*CALL'   W0FILE
     C                     MOVEL'ME1140'  W0KEY
     C                     Z-ADD4         W0ERNB
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C***********          EXSR SRERR                                     130869
     C                     EXSR SRERRA                                    130869
     C                     END
      *
      *  Clear data structure and *CLOSESP
      *
     C                     CLEARI#DTA
      *
     C                     CALL 'ME1140'               9090
     C                     PARM *BLANKS   W0RTN   7
     C*********************PARM '*CLOSESP'W0ACT   8                       CGL009
     C                     PARM '*CLOSESP'W2ACT   8                       CGL009
     C                     PARM           I#DTA            Input Data Str.
     C                     PARM *BLANKS   I#RSQN  5
      *
     C           W0RTN     IFNE *BLANKS
     C                     MOVEL'*CALL'   W0FILE
     C                     MOVEL'ME1140'  W0KEY
     C                     Z-ADD5         W0ERNB
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C***********          EXSR SRERR                                     130869
     C                     EXSR SRERRA                                    130869
     C                     END
      *
      *  Unwind subroutine stack name
      *
     C           EXREPT    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRINS1   : Validate Incoming Level 1 details                 *
      *                                                               *
      *  CALLED BY: SRINFT - Create Incoming Payment Transaction      *
      *                                                               *
      *****************************************************************
     CSR         SRINS1    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SRINS1'  @STK,Q
      *================================================================
      *
      *  /Copy point for Incoming Payments Level 1
      *
     C                     MOVEL*BLANK    @REC1   1                                           MAR015
     C                     MOVEL*BLANK    @REC2   1                                           MAR015
     C/COPY WNCPYSRC,FT0300INS1
      *                                                                   CFT014
      *** Memorize currencies values before screen validation             CFT014
      *                                                                   CFT014
     C                     MOVELS1SMCY    WMSMCY                          CFT014
     C                     MOVELS1PCCY    WMPCCY                          CFT014
     C                     MOVELS1NDCY    WMNDCY                          CFT014
      *                                                                   CFT014
     C                     MOVEL'I'       S1ACTD
     C                     MOVEL*BLANKS   S1PREF
      *  Booking Branch
     C                     MOVELS1BRCA    S1BRCA
      *  Orginating Branch
     C                     MOVELS1ORBR    S1ORBR
      *  Payment Type
     C                     MOVEL'IN'      S1PYTP
      *  Payment Subtype
     C                     MOVELS1PYST    S1PYST
      *  S.W.I.F.T. Priority
     C           S1SWPC    IFEQ *BLANKS
     C                     MOVEL'N'       S1SWPC
     C                     ELSE
     C                     MOVELS1SWPC    S1SWPC
     C                     END
      *  Sender
     C                     MOVELS1SND     S1SND
      *  Beneficiary
     C                     MOVELS1BNC     S1BNC
      *  Account with Institution
     C                     MOVELS1ACBK    S1ACBK
      *  Account with Institution Branch
     C                     MOVELS1ACBB    S1ACBB
      *  Receiver's Correspondent
     C                     MOVELS1RCCO    S1RCCO
      *  Settlement Amount
     C                     MOVELS1SMAM    S1SMAM
      *  Settlement Currency
     C                     MOVELS1SMCY    S1SMCY
      *  Settle value date
     C                     MOVELS1SLDT    S1SLDT
      *  Pay Amount
     C                     MOVELS1PYAM    S1PYAM
      *  Pay Currency
     C                     MOVELS1PCCY    S1PCCY
      *  Pay value date
     C                     MOVELS1PVDT    S1PVDT
      *  Rate
     C                     MOVELS1RATE    S1RATE
      *  Rate override
     C                     MOVELS1OVRD    S1OVRD
      *  Add/Deduct Indicator
     C           S1ADDC    IFEQ *BLANKS
     C                     MOVEL'A'       S1ADDC
     C/COPY WNCPYSRC,FT0300C077
     C                     ELSE
     C                     MOVELS1ADDC    S1ADDC
     C                     END
      *  Book code
     C                     MOVELS1BOKC    S1BOKC
      *  Profit Code
     C                     MOVELS1PRFC    S1PRFC
      *
      *
      *  Data Structure to pass data between programs
      *
      *  Fields needed for error processing
      *
      * No update indicator
     C                     MOVEL*BLANKS   E#NOUP
      * Re-send screen indicator
     C                     MOVEL*BLANKS   E#RSND
      * Warning message sent
     C                     MOVEL*BLANKS   E#WARN
      * Warning message array
     C                     MOVEL*BLANKS   E#WARA
      * Message sent via FTSNMS
     C                     MOVEL*BLANKS   E#MSGS
      * Program to send messages to
     C                     MOVEL##PGM     E#CPGM
      *
      *
      *  Data Structure to pass data between programs
      *
      *  Error codes to be displayed
      *
     C                     MOVEL*BLANKS   C#ERCD
     C                     MOVEL*BLANKS   I1DATA
      *
      *
      *  Define entry parameters
      *
     C                     CALL 'FT0352'               9090
     C                     PARM *BLANKS   P@RTCD
     C*********************PARM '*VALID'  W0ACT   8                       CGL009
     C                     PARM '*VALID  'W2ACT   8                       CGL009
     C                     PARM           S1DATA
     C                     PARM           V#DATA
     C                     PARM           F1DATA
     C                     PARM           E#DATA
     C                     PARM           C#DATA
     C                     PARM           I1DATA
      *
      *  If error on call
      *
     C           *IN90     IFEQ '1'
     C           P@RTCD    ORNE *BLANKS
     C                     MOVEL'FT0352  'W0FILE           ***************
     C                     MOVEL'*CALL'   W0KEY            * DB ERROR 06 *
     C                     Z-ADD6         W0ERNB           ***************
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C***********          EXSR SRERR                                     130869
     C                     EXSR SRERRA                                    130869
     C                     END
      *
      *  Data Structure to pass data between programs
      *
      *
      *  Move back validated data
      *
      *  NO MOVES NEEDED AT PRESENT
      *
      *  Report errors
      *
     C                     EXSR SRRERR
      *
      *  If E#NOUP not blanks set flag
      *
     C           E#NOUP    IFEQ *BLANKS
     C                     MOVEL'Y'       INLVL1
     C                     MOVEL'FTM2010' W0LMSG           Action - Msg ID
     C                     MOVEL'FTUSRMSG'W0MSGF           Msg file
     C                     EXSR SRLOG
      *                                                                   CFT009
      * If CFT009 is on, default charges                                  CFT009
      *                                                                   CFT009
     C/COPY WNCPYSRC,FT0300DB05                                           EEE058            AR856737
     C           CFT009    IFEQ 'Y'                                       CFT009
     C                     EXSR DFICHG                                    CFT009
     C                     MOVEL'Y'       INLVL1                                            BUG24502
     C                     ENDIF                                          CFT009
     C/COPY WNCPYSRC,FT0300DB06                                           EEE058            AR856737
      *                                                                   CFT009
     C                     ELSE
     C                     MOVEL'Y'       ##INS1
     C                     MOVEL'FTM2011' W0LMSG           Action - Msg ID
     C                     MOVEL'FTUSRMSG'W0MSGF           Msg file
     C                     EXSR SRLOG
     C                     GOTO EXINS1                                    CFT014
     C                     END
      *                                                                                       MK0512
     C           #EXTRN    IFEQ 'Y'                                                           MK0512
     C                     MOVEL'Y'       S1OVRD                                              MK0512
     C                     ENDIF                                                              MK0512
      *                                                                   CFT014
      *  At this stage Pay Currency, Settlement Currency,                 CFT014
      *  Notified Delivery currency are not supposed to change.           CFT014
      *  Retrieve details of the currencies                               CFT014
      *  - If validation has changed the currency                         CFT014
      *  - If currency details have not been retrieved yet                CFT014
     C           S1SMCY    IFNE *BLANK                                    CFT014
     C           S1SMCY    IFNE WMSMCY                                    CFT014
     C           SCNBDP    OREQ *LOVAL                                    CFT014
     C                     MOVELS1SMCY    WCYCCY                          CFT014
     C                     MOVEL'N'       WCYDMP                          CFT014
     C                     EXSR RTCCYD                                    CFT014
     C           WCYRTN    IFEQ *BLANK                                    CFT014
     C                     Z-ADDWCYNDP    SCNBDP                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           S1PCCY    IFNE *BLANK                                    CFT014
     C           S1PCCY    IFNE WMPCCY                                    CFT014
     C           PCNBDP    OREQ *LOVAL                                    CFT014
     C                     MOVELS1PCCY    WCYCCY                          CFT014
     C                     MOVEL'N'       WCYDMP                          CFT014
     C                     EXSR RTCCYD                                    CFT014
     C           WCYRTN    IFEQ *BLANK                                    CFT014
     C                     Z-ADDWCYNDP    PCNBDP                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           S1NDCY    IFNE *BLANK                                    CFT014
     C           S1NDCY    IFNE WMNDCY                                    CFT014
     C           NCNBDP    OREQ *LOVAL                                    CFT014
     C                     MOVELS1NDCY    WCYCCY                          CFT014
     C                     MOVEL'N'       WCYDMP                          CFT014
     C                     EXSR RTCCYD                                    CFT014
     C           WCYRTN    IFEQ *BLANK                                    CFT014
     C                     Z-ADDWCYNDP    NCNBDP                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      *
      *  Unwind subroutine stack name
      *
     C           EXINS1    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRINS2   : Validate Incoming Level 2 Screen 1                *
      *                                                               *
      *  CALLED BY: SRINFT - Create Incoming Payment Transaction      *
      *                                                               *
      *****************************************************************
     CSR         SRINS2    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SRINS2'  @STK,Q
      *================================================================
      *
      *  /Copy point for Incoming Payments Level 2 Screen 1
      *
     C/COPY WNCPYSRC,FT0300INS2
      *
     C                     MOVELS1ADDC    V#ADDC
     C                     Z-ADDF1SLDT    V#SLDT
     C                     Z-ADDF1PVDT    V#PVDT
     C                     MOVELS1PCCY    V#PCCY
     C                     MOVELS1SMCY    V#SMCY
     C                     Z-ADDF1SMAM    V#SMAM
     C                     Z-ADDF1PYAM    V#PYAM
     C                     MOVELS1BNC1    V#BNC1
     C                     MOVELF1ACBT    V#ACBT
      *
     C                     MOVEL'I'       S2ACTD
     C                     MOVEL*BLANKS   S2PREF
      ***Transfer*Comission*tariff************                            CFT014
     C*********************MOVELV#TRCT    S2TRCT                          CFT014
      ***Charges*to*the*debit*of*************                             CFT014
     C*********************MOVELS2CDRO    S2CDRO                          CFT014
      ***Charges*to*the*debit*of*branch******                             CFT014
     C*********************MOVELS2CDBR    S2CDBR                          CFT014
      *  Ordering Bank
     C                     MOVELS2ORBK    S2ORBK
      *  Sender's Correspondent
     C                     MOVELS2SNC     S2SNC
      *  Ordering Customer
     C                     MOVELS2ORC     S2ORC
      *  Sender to Receiver information
     C                     MOVELS2BTB     S2BTB
      *
      *
      *  Data Structure to pass data between programs
      *
      *  Fields needed for error processing
      *
      * No update indicator
     C                     MOVEL*BLANKS   E#NOUP
      * Re-send screen indicator
     C                     MOVEL*BLANKS   E#RSND
      * Warning message sent
     C                     MOVEL*BLANKS   E#WARN
      * Warning message array
     C                     MOVEL*BLANKS   E#WARA
      * Message sent via FTSNMS
     C                     MOVEL*BLANKS   E#MSGS
      * Program to send messages to
     C                     MOVEL##PGM     E#CPGM
      *
      *
      *  Data Structure to pass data between programs
      *
      *  Error codes to be displayed
      *
     C                     MOVEL*BLANKS   C#ERCD
     C                     MOVEL*BLANKS   I2DATA
      *
      *
      *  Define entry parameters
      *
     C                     CALL 'FT0357'               9090
     C                     PARM *BLANKS   P@RTCD
     C*********************PARM '*VALID'  W0ACT   8                       CGL009
     C                     PARM '*VALID  'W2ACT   8                       CGL009
     C                     PARM           S2DATA
     C                     PARM           V#DATA
     C                     PARM           F2DATA
     C                     PARM           E#DATA
     C                     PARM           C#DATA
     C                     PARM           I2DATA
      *
      *  If error on call
      *
     C           *IN90     IFEQ '1'
     C           P@RTCD    ORNE *BLANKS
     C                     MOVEL'FT0357  'W0FILE           ***************
     C                     MOVEL'*CALL'   W0KEY            * DB ERROR 07 *
     C                     Z-ADD7         W0ERNB           ***************
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C***********          EXSR SRERR                                     130869
     C                     EXSR SRERRA                                    130869
     C                     END
      *
      *  Data Structure to pass data between programs
      *
      *
      *  Move back validated data
      *
      *  NO MOVES NEEDED AT PRESENT
      *
      *  Report errors
      *
     C                     EXSR SRRERR
      *
      *  If E#NOUP not blanks set flag
      *
     C           E#NOUP    IFNE *BLANKS
     C                     MOVEL'Y'       ##INS2
     C                     MOVEL'FTM2012' W0LMSG           Action - Msg ID
     C                     MOVEL'FTUSRMSG'W0MSGF           Msg file
     C                     EXSR SRLOG
     C                     END
      *
      *  Unwind subroutine stack name
      *
     C           EXINS2    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRINS3   : Validate Incoming Level 1 Screen 2                *
      *                                                               *
      *  CALLED BY: SRINFT - Create Incoming Payment Transaction      *
      *                                                               *
      *****************************************************************
     CSR         SRINS3    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SRINS3'  @STK,Q
      *================================================================
      *
      *  /Copy point for Incoming Payments Level 2 Screen 2
      *
     C/COPY WNCPYSRC,FT0300INS3
      *
     C* Due to movement of charges fields validation to FT0359            CFT014
     C* the following codes are now moved to SRINS4                       CFT014
     C*********************SELEC                                          CFT014
      **************************                                          CFT014
      **Set*up*default*charge*currencies*-*input*currency*                CFT014
      *************************                                           CFT014
     C***********BTCHCY    WHEQ 'B'                                       CFT014
     C***********S2CDRO    ORNE *BLANKS                                   CFT014
     C*********************MOVELV#BCCY    V#CCCY                          CFT014
      **********************                                              CFT014
     C***********BTCHCY    WHEQ 'L'                                       CFT014
     C*********************MOVELV#LCCY    V#CCCY                          CFT014
      *********************                                               CFT014
     C***********BTCHCY    WHEQ 'C'                                       CFT014
     C***********V#ADDC    ANDEQ'A'                                       CFT014
     C*********************MOVELS1SMCY    V#CCCY                          CFT014
      *****************                                                   CFT014
     C*********************OTHER                                          CFT014
     C*********************MOVELS1PCCY    V#CCCY                          CFT014
     C*********************ENDSL                                          CFT014
      ******************************                                      CFT014
      ***Currency*of*charge***********                                    CFT014
      *****************************                                       CFT014
     C*********************SELEC                                          CFT014
      ************************                                            CFT014
     C***********S2CDRO    WHNE *BLANKS                                   CFT014
     C*********************MOVELV#BCCY    V#RCCY                          CFT014
      *********************                                               CFT014
     C***********V#ADDC    WHEQ 'A'                                       CFT014
     C*********************MOVELS1SMCY    V#RCCY                          CFT014
      *********************                                         122060CFT014
     C***********PNWRK     IFEQ 'CASHV8'                            122060CFT014
     C***********S1PCCY    ANDEQV#BCCY                              122060CFT014
     C*********************MOVELS1PCCY    V#RCCY                    122060CFT014
     C*********************ENDIF                                    122060CFT014
      *********************                                               CFT014
     C*********************OTHER                                          CFT014
     C*********************MOVELS1PCCY    V#RCCY                          CFT014
     C*********************ENDSL                                          CFT014
      ************************                                            CFT014
     C*********************MOVELF2CDRT    V#CDRT                          CFT014
     C                     MOVELS2ORB1    V#ORB1
     C                     MOVELS2SNC1    #CHKT   1
     C           #CHKT     IFEQ '/'
     C                     MOVELS2SNC1    V#SNC1
     C                     ELSE
     C                     MOVELS2SNC2    V#SNC1
     C                     END
      *
     C                     MOVEL'I'       S3ACTD
     C                     MOVEL*BLANKS   S3PREF
      * Intermediary Bank
     C                     MOVELS3IBK     S3IBK
      *  Details of Payment
     C                     MOVELS3PAY     S3PAY
      * Central Bank Reference
     C           #3CNBK    IFEQ *BLANKS                                                       MK0520
     C                     MOVELS3CBKR    S3CBKR
     C                     ELSE                                                               MK0520
     C                     MOVE #3CNBK    S3CBKR                                              MK0520
     C                     ENDIF                                                              MK0520
      * Related Reference
     C                     MOVELS3RLRF    S3RLRF
      *                                                                   CFT014
     C* Due to movement of charges fields validation to FT0359,           CFT014
     C* the following codes are now moved to SRINS4                       CFT014
      **Details*of*Charge********                                         CFT014
     C*********************MOVELS3DETC    S3DETC                          CFT014
      * Outgoing indicator
     C                     MOVELS3OPIN    S3OPIN
      *
      * Charges
      *                                                                   CFT014
     C* Due to movement of charges fields validation to FT0359,           CFT014
     C* the following codes are now moved to SRINS4                       CFT014
      *******************************                                     CFT014
      **Transfer*and*Commission******                                     CFT014
     C*********************MOVELS3TRCD    S3TRCD                          CFT014
      **Telex*************************                                    CFT014
     C*********************MOVELS3TXCD    S3TXCD                          CFT014
      **Cheque************************                                    CFT014
     C*********************MOVELS3CQCD    S3CQCD                          CFT014
      **Advice*Charge*****************                                    CFT014
     C*********************MOVELS3ADCD    S3ADCD                          CFT014
      **Telephone*charge***                                               CFT014
     C*********************MOVELS3TLCD    S3TLCD                          CFT014
      **Miscellaneous*****                                                CFT014
     C*********************MOVELS3MSCD    S3MSCD                          CFT014
      *                                                                   CFT014
      *  Transfer Comission tariff                                        CFT014
     C                     MOVELV#TRCT    S3TRCT                          CFT014
      *                                                                   CFT014
      *
      *
      *  Data Structure to pass data between programs
      *
      *  Fields needed for error processing
      *
      * No update indicator
     C                     MOVEL*BLANKS   E#NOUP
      * Re-send screen indicator
     C                     MOVEL*BLANKS   E#RSND
      * Warning message sent
     C                     MOVEL*BLANKS   E#WARN
      * Warning message array
     C                     MOVEL*BLANKS   E#WARA
      * Message sent via FTSNMS
     C                     MOVEL*BLANKS   E#MSGS
      * Program to send messages to
     C                     MOVEL##PGM     E#CPGM
      *
      *
      *  Data Structure to pass data between programs
      *
      *  Error codes to be displayed
      *
     C                     MOVEL*BLANKS   C#ERCD
     C                     MOVEL*BLANKS   I3DATA
      *
      *
      *  Define entry parameters
      *
     C                     CALL 'FT0358'               9090
     C                     PARM *BLANKS   P@RTCD
     C*********************PARM '*VALID'  W0ACT   8                       CGL009
     C                     PARM '*VALID  'W2ACT   8                       CGL009
     C                     PARM           S3DATA
     C                     PARM           V#DATA
     C                     PARM           F3DATA
     C                     PARM           E#DATA
     C                     PARM           C#DATA
     C                     PARM           I3DATA
     C/COPY WNCPYSRC,FT0300C058
      *
      *  If error on call
      *
     C           *IN90     IFEQ '1'
     C           P@RTCD    ORNE *BLANKS
     C                     MOVEL'FT0358  'W0FILE           ***************
     C                     MOVEL'*CALL'   W0KEY            * DB ERROR 08 *
     C                     Z-ADD8         W0ERNB           ***************
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C***********          EXSR SRERR                                     130869
     C                     EXSR SRERRA                                    130869
     C                     END
      *
      *  Data Structure to pass data between programs
      *
      *
      *  Move back validated data
      *
      *  NO MOVES NEEDED AT PRESENT
      *
      *  Report errors
      *
     C                     EXSR SRRERR
      *
      *  If E#NOUP not blanks set flag
      *
     C           E#NOUP    IFEQ *BLANKS
     C*********************MOVEL'Y'       INLVL2                          CFT014
     C*********************MOVEL'FTM2014' W0LMSG           Action - Msg IDCFT014
     C*********************MOVEL'FTUSRMSG'W0MSGF           Msg file       CFT014
     C*********************EXSR SRLOG                                     CFT014
     C                     ELSE
     C                     MOVEL'Y'       ##INS3
     C                     MOVEL'FTM2015' W0LMSG           Action - Msg ID
     C                     MOVEL'FTUSRMSG'W0MSGF           Msg file
     C                     EXSR SRLOG
     C                     END
      *
      *  Unwind subroutine stack name
      *
     C           EXINS3    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
     C/EJECT
      *****************************************************************   CFT014
      *                                                               *   CFT014
      *  SRINS4   : Validate Incoming Level 2 Screen 3                *   CFT014
      *                                                               *   CFT014
      *  CALLED BY: SRINFT - Create Incoming Payment Transaction      *   CFT014
      *                                                               *   CFT014
      *****************************************************************   CFT014
     CSR         SRINS4    BEGSR                                          CFT014
      *                                                                   CFT014
      *  Set up subroutine stack name                                     CFT014
      *                                                                   CFT014
     C                     ADD  1         Q       50                      CFT014
     C                     MOVEL'SRINS4'  @STK,Q                          CFT014
      *                                                                   CFT014
      ** Set up charges for incoming payment                              CFT014
     C*****      S0DETC    IFEQ 'OUR'                               CFT014MK0560
     C                     EXSR CHGIN                                     CFT014
     C*****                ENDIF                                    CFT014MK0560
      *                                                                   CFT014
     C                     CALL 'FT0359'               90                 CFT014
     C                     PARM *BLANKS   P@RTCD                          CFT014
     C                     PARM '*VALID  'W2ACT   8                       CFT014
     C                     PARM           P0RSET  1                       189441
     C                     PARM           V#DATA                          CFT014
     C                     PARM           S0DATA                          CFT014
     C                     PARM           F0DATA                          CFT014
     C                     PARM           I0DATA                          CFT014
     C                     PARM           E#DATA                          CFT014
     C*****                PARM 'S'       STP                       CFT009STP017
     C                     PARM 'Y'       STP                             STP017
      *                                                                   CFT014
      *  If error on call                                                 CFT014
      *                                                                   CFT014
     C           *IN90     IFEQ '1'                                       CFT014
     C           P@RTCD    ORNE *BLANKS                                   CFT014
     C           P@RTCD    ANDNE'*RECAL '                                 CFT009
     C                     MOVEL'FT0359  'W0FILE           ***************CFT014
     C                     MOVEL'*CALL'   W0KEY            * DB ERROR 121*CFT014
     C                     Z-ADD121       W0ERNB           ***************CFT014
     C                     MOVEL'MEM5003' W0MSGD                          CFT014
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT014
     C                     EXSR SRERRA                                    CFT014
     C                     ENDIF                                          CFT014
      *  Report errors                                                    CFT014
      *                                                                   CFT014
     C                     EXSR SRRERR                                    CFT014
      *                                                                   CFT014
      *  If E#NOUP not blanks set flag                                    CFT014
      *                                                                   CFT014
     C           E#NOUP    IFEQ *BLANKS                                   CFT014
     C           CSW209    IFEQ 'N'                                                           CSW209
     C                     MOVEL'Y'       INLVL2                          CFT014
     C                     MOVEL'FTM2014' W0LMSG                          CFT014
     C                     MOVEL'FTUSRMSG'W0MSGF                          CFT014
     C                     EXSR SRLOG                                     CFT014
     C                     ENDIF                                                              CSW209
     C                     ELSE                                           CFT014
     C                     MOVEL'Y'       ##INS4                          CFT014
     C                     MOVEL'FTM4001' W0LMSG                          CFT014
     C                     MOVEL'FTUSRMSG'W0MSGF                          CFT014
     C                     EXSR SRLOG                                     CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      *  Unwind subroutine stack name                                     CFT014
      *                                                                   CFT014
     C           EXINS4    TAG                                            CFT014
     C                     MOVEA*BLANKS   @STK,Q                          CFT014
     C                     SUB  1         Q                               CFT014
      *                                                                   CFT014
     CSR                   ENDSR                                          CFT014
     C/EJECT                                                              CFT014
      *****************************************************************                       CSW209
      *                                                               *                       CSW209
      *  SRINS5   : Validate Incoming Level 2 Screen 4                *                       CSW209
      *                                                               *                       CSW209
      *  CALLED BY: SRINFT - Create Incoming Payment Transaction      *                       CSW209
      *                                                               *                       CSW209
      *****************************************************************                       CSW209
     CSR         SRINS5    BEGSR                                                              CSW209
      *                                                                                       CSW209
      ** Set up subroutine stack name                                                         CSW209
      *                                                                                       CSW209
     C                     ADD  1         Q       50                                          CSW209
     C                     MOVEL'SRINS5'  @STK,Q                                              CSW209
      *                                                                                       CSW209
      ** Data Structure to pass data between programs                                         CSW209
      ** Fields needed for error processing                                                   CSW209
      *                                                                                       CSW209
      ** No update indicator                                                                  CSW209
     C                     MOVEL*BLANKS   E#NOUP                                              CSW209
      ** Re-send screen indicator                                                             CSW209
     C                     MOVEL*BLANKS   E#RSND                                              CSW209
      ** Warning message sent                                                                 CSW209
     C                     MOVEL*BLANKS   E#WARN                                              CSW209
      ** Warning message array                                                                CSW209
     C                     MOVEL*BLANKS   E#WARA                                              CSW209
      ** Message sent via FTSNMS                                                              CSW209
     C                     MOVEL*BLANKS   E#MSGS                                              CSW209
      ** Program to send messages to                                                          CSW209
     C                     MOVEL##PGM     E#CPGM                                              CSW209
      *                                                                                       CSW209
      ** Data Structure to pass data between programs                                         CSW209
      *                                                                                       CSW209
      ** Error codes to be displayed                                                          CSW209
     C                     MOVEL*BLANKS   C#ERCD                                              CSW209
     C                     MOVEL*BLANKS   FADATA                                              CSW209
     C                     CLEARIADATA                                                        CSW209
      *                                                                                       CSW209
     C                     CALL 'FT0353'               90                                     CSW209
     C                     PARM *BLANKS   P@RTCD                                              CSW209
     C                     PARM '*VALID  'W2ACT                                               CSW209
     C                     PARM           SADATA                                              CSW209
     C                     PARM           V#DATA                                              CSW209
     C                     PARM           FADATA                                              CSW209
     C                     PARM           E#DATA                                              CSW209
     C                     PARM           C#DATA                                              CSW209
     C                     PARM           IADATA                                              CSW209
     C                     PARM           S2DATA                                              CSW209
     C                     PARM           S3DATA                                              CSW209
      *                                                                                       CSW209
      ** If error on call                                                                     CSW209
      *                                                                                       CSW209
     C           *IN90     IFEQ '1'                                                           CSW209
     C           P@RTCD    ORNE *BLANKS                                                       CSW209
     C           P@RTCD    ANDNE'*RECAL '                                                     CSW209
     C                     MOVEL'FT0353  'W0FILE           ***************                    CSW209
     C                     MOVEL'*CALL'   W0KEY            * DB ERROR 121*                    CSW209
     C                     Z-ADD121       W0ERNB           ***************                    CSW209
     C                     MOVEL'MEM5003' W0MSGD                                              CSW209
     C                     MOVEL'MIDAS  ' W0MSGF                                              CSW209
     C                     EXSR SRERRA                                                        CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
      ** Report errors                                                                        CSW209
      *                                                                                       CSW209
     C                     EXSR SRRERR                                                        CSW209
      *                                                                                       CSW209
      ** If E#NOUP not blanks set flag                                                        CSW209
      *                                                                                       CSW209
     C           E#NOUP    IFNE *BLANKS                                                       CSW209
     C                     MOVEL'Y'       ##INS4                                              CSW209
     C                     MOVEL'FTM4008' W0LMSG                                              CSW209
     C                     MOVEL'FTUSRMSG'W0MSGF                                              CSW209
     C                     EXSR SRLOG                                                         CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
      ** Unwind subroutine stack name                                                         CSW209
      *                                                                                       CSW209
     C           EXINS5    TAG                                                                CSW209
     C                     MOVEA*BLANKS   @STK,Q                                              CSW209
     C                     SUB  1         Q                                                   CSW209
      *                                                                                       CSW209
     CSR                   ENDSR                                                              CSW209
     C/EJECT                                                                                  CSW209
      *****************************************************************                       CSW209
      *                                                               *                       CSW209
      *  SRINS6   : Validate Incoming Level 2 Screen 5                *                       CSW209
      *                                                               *                       CSW209
      *  CALLED BY: SRINFT - Create Incoming Payment Transaction      *                       CSW209
      *                                                               *                       CSW209
      *****************************************************************                       CSW209
     CSR         SRINS6    BEGSR                                                              CSW209
      *                                                                                       CSW209
      ** Set up subroutine stack name                                                         CSW209
      *                                                                                       CSW209
     C                     ADD  1         Q       50                                          CSW209
     C                     MOVEL'SRINS6'  @STK,Q                                              CSW209
      *                                                                                       CSW209
      ** Data Structure to pass data between programs                                         CSW209
      ** Fields needed for error processing                                                   CSW209
      *                                                                                       CSW209
      ** No update indicator                                                                  CSW209
     C                     MOVEL*BLANKS   E#NOUP                                              CSW209
      ** Re-send screen indicator                                                             CSW209
     C                     MOVEL*BLANKS   E#RSND                                              CSW209
      ** Warning message sent                                                                 CSW209
     C                     MOVEL*BLANKS   E#WARN                                              CSW209
      ** Warning message array                                                                CSW209
     C                     MOVEL*BLANKS   E#WARA                                              CSW209
      ** Message sent via FTSNMS                                                              CSW209
     C                     MOVEL*BLANKS   E#MSGS                                              CSW209
      ** Program to send messages to                                                          CSW209
     C                     MOVEL##PGM     E#CPGM                                              CSW209
      *                                                                                       CSW209
      ** Data Structure to pass data between programs                                         CSW209
      *                                                                                       CSW209
      ** Error codes to be displayed                                                          CSW209
     C                     MOVEL*BLANKS   C#ERCD                                              CSW209
     C                     MOVEL*BLANKS   FBDATA                                              CSW209
     C                     CLEARIBDATA                                                        CSW209
      *                                                                                       CSW209
     C                     CALL 'FT0354'               90                                     CSW209
     C                     PARM *BLANKS   P@RTCD                                              CSW209
     C                     PARM '*VALID  'W2ACT                                               CSW209
     C                     PARM           SBDATA                                              CSW209
     C                     PARM           V#DATA                                              CSW209
     C                     PARM           FBDATA                                              CSW209
     C                     PARM           E#DATA                                              CSW209
     C                     PARM           C#DATA                                              CSW209
     C                     PARM           IBDATA                                              CSW209
     C                     PARM           SADATA                                              CSW209
      *                                                                                       CSW209
      ** If error on call                                                                     CSW209
      *                                                                                       CSW209
     C           *IN90     IFEQ '1'                                                           CSW209
     C           P@RTCD    ORNE *BLANKS                                                       CSW209
     C           P@RTCD    ANDNE'*RECAL '                                                     CSW209
     C                     MOVEL'FT0354  'W0FILE           ***************                    CSW209
     C                     MOVEL'*CALL'   W0KEY            * DB ERROR 121*                    CSW209
     C                     Z-ADD121       W0ERNB           ***************                    CSW209
     C                     MOVEL'MEM5003' W0MSGD                                              CSW209
     C                     MOVEL'MIDAS  ' W0MSGF                                              CSW209
     C                     EXSR SRERRA                                                        CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
      ** Report errors                                                                        CSW209
      *                                                                                       CSW209
     C                     EXSR SRRERR                                                        CSW209
      *                                                                                       CSW209
      ** If E#NOUP not blanks set flag                                                        CSW209
      *                                                                                       CSW209
     C           E#NOUP    IFEQ *BLANKS                                                       CSW209
     C                     MOVEL'Y'       INLVL2                                              CSW209
     C                     MOVEL'FTM2014' W0LMSG                                              CSW209
     C                     MOVEL'FTUSRMSG'W0MSGF                                              CSW209
     C                     EXSR SRLOG                                                         CSW209
     C                     ELSE                                                               CSW209
     C                     MOVEL'Y'       ##INS4                                              CSW209
     C                     MOVEL'FTM4009' W0LMSG                                              CSW209
     C                     MOVEL'FTUSRMSG'W0MSGF                                              CSW209
     C                     EXSR SRLOG                                                         CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
      ** Unwind subroutine stack name                                                         CSW209
      *                                                                                       CSW209
     C           EXINS6    TAG                                                                CSW209
     C                     MOVEA*BLANKS   @STK,Q                                              CSW209
     C                     SUB  1         Q                                                   CSW209
      *                                                                                       CSW209
     CSR                   ENDSR                                                              CSW209
     C/EJECT                                                                                  CSW209
      *****************************************************************
      *                                                               *
      *  SRINUP   : Validate Incoming Payements Update                *
      *                                                               *
      *  CALLED BY: SRINFT - Create Incoming Payment Transaction      *
      *                                                               *
      *****************************************************************
     CSR         SRINUP    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SRINUP'  @STK,Q
      *
      *  /Copy point for Incoming Payments Update
      *
     C/COPY WNCPYSRC,FT0300INUP
      *
      * Get next payment reference
      *
     C                     EXSR SRIPRF
     C/COPY WNCPYSRC,FT0300C024
      *
      * Move all fields to @INPAYL0
      *
     C                     EXSR SRMVIN
      *                                                                   CAC002
      **  If Analytical Accounting is installed, calculate margin         CAC002
      **  details for Draft Issued payments ('DI') where the settlement   CAC002
      **  currency not same as the pay currency.                          CAC002
      *                                                                   CAC002
     C           BGN0ST    IFEQ 'Y'                                       CAC002
     C           PYST      ANDEQ'DI'                                      CAC002
     C           SMCY      ANDNEPCCY                                      CAC002
      *                                                                   CAC002
      **  Get settlement currency details                                 CAC002
      *                                                                   CAC002
     C                     CALL 'AOCURRR0'                                CAC002
     C                     PARM *BLANKS   P@RTCD                          CAC002
     C                     PARM '*KEY    'P@OPTN                          CAC002
     C                     PARM SMCY      WCURR   3                       CAC002
     C           SDCURR    PARM SDCURR    DSSDY                           CAC002
      *                                                                   CAC002
     C           P@RTCD    IFNE *BLANKS                                   CAC002
     C                     MOVEL'AOCURRR0'W0FILE                          CAC002
     C                     MOVEL'*CALL'   W0KEY            ************   CAC002
     C                     Z-ADD36        W0ERNB           * DBERR 36 *   CAC002
     C                     MOVEL'MEM5003' W0MSGD           ************   CAC002
     C                     MOVEL'MIDAS  ' W0MSGF                          CAC002
     C***********          EXSR SRERR                               CAC002130869
     C                     EXSR SRERRA                                    130869
     C                     ELSE                                           CAC002
     C                     Z-ADDA6NBDP    ZNBDP1  10                      CAC002
     C                     Z-ADDA6NQDP    ZNQDP1  10                      CAC002
     C                     Z-ADDA6SPRT    ZRATE1 138                      CAC002
     C                     MOVE A6MDIN    ZMDI1   1                       CAC002
     C                     ENDIF                                          CAC002
      *                                                                   CAC002
      **  Get pay currency details                                        CAC002
      *                                                                   CAC002
     C                     CALL 'AOCURRR0'                                CAC002
     C                     PARM *BLANKS   P@RTCD                          CAC002
     C                     PARM '*KEY    'P@OPTN                          CAC002
     C                     PARM PCCY      WCURR                           CAC002
     C           SDCURR    PARM SDCURR    DSSDY                           CAC002
      *                                                                   CAC002
     C           P@RTCD    IFNE *BLANKS                                   CAC002
     C                     MOVEL'AOCURRR0'W0FILE                          CAC002
     C                     MOVEL'*CALL'   W0KEY            ************   CAC002
     C                     Z-ADD37        W0ERNB           * DBERR 37 *   CAC002
     C                     MOVEL'MEM5003' W0MSGD           ************   CAC002
     C                     MOVEL'MIDAS  ' W0MSGF                          CAC002
     C***********          EXSR SRERR                               CAC002130869
     C                     EXSR SRERRA                                    130869
     C                     ELSE                                           CAC002
     C                     Z-ADDA6NBDP    ZNBDP2  10                      CAC002
     C                     Z-ADDA6NQDP    ZNQDP2  10                      CAC002
     C                     Z-ADDA6SPRT    ZRATE2 138                      CAC002
     C                     MOVE A6MDIN    ZMDI2   1                       CAC002
     C                     ENDIF                                          CAC002
      *                                                                   CAC002
      **  Calculate default Margin Buy/Sell Indicator                     CAC002
      *                                                                   CAC002
     C           ZNBDP1    ADD  1         ZB      20                      CAC002
     C           SMAM      DIV  AP,ZB     WSMAM  163                      CAC002
     C           ZNBDP2    ADD  1         ZB                              CAC002
     C           PYAM      DIV  AP,ZB     WPYAM  163                      CAC002
      *                                                                   CAC002
     C           WSMAM     IFGE WPYAM                                     CAC002
     C                     MOVE 'B'       MBSI                            CAC002
     C                     ELSE                                           CAC002
     C                     MOVE 'S'       MBSI                            CAC002
     C                     ENDIF                                          CAC002
      *                                                                   CAC002
      **  Calculate Cross Rate between settlement and pay currencies      CAC002
      *                                                                   CAC002
     C                     EXSR ZXRATE                                    CAC002
      *                                                                   CAC002
     C           RATE      IFGT 1                                         CAC002
     C           ZRATEX    ANDLT1                                         CAC002
     C           RATE      ORLT 1                                         CAC002
     C           ZRATEX    ANDGT1                                         CAC002
     C           1         DIV  ZRATEX    ZRATEX    H                     CAC002
     C                     ENDIF                                          CAC002
      *                                                                   CAC002
      **  Calculate Margin Rate                                           CAC002
      *                                                                   CAC002
     C           ZRATEX    IFGE RATE                                      CAC002
     C           ZRATEX    SUB  RATE      WFXMR  138                      CAC002
     C                     ELSE                                           CAC002
     C           RATE      SUB  ZRATEX    WFXMR                           CAC002
     C                     ENDIF                                          CAC002
      *                                                                   CAC002
      **  Get normally-quoted decimal places                              CAC002
      *                                                                   CAC002
     C                     EXSR SRNQDP                                    CAC002
      *                                                                   CAC002
      **  Convert Margin Rate to scaled Margin Points                     CAC002
      *                                                                   CAC002
     C           ZNQDPX    ADD  1         ZA      10                      CAC002
     C           WFXMR     MULT AP,ZA     FXMP      H                     CAC002
      *                                                                   CAC002
      **  Assign FX Multiply/Divide Indicator                             CAC002
      *                                                                   CAC002
     C                     MOVE MDIN      FXMD                            CAC002
      *                                                                   CAC002
      **  Calculate Margin Sign                                           CAC002
      *                                                                   CAC002
     C           ZRATEX    IFGE RATE                                      CAC002
     C           ZRATEX    ANDGT1                                         CAC002
     C           WPYAM     ANDGEWSMAM                                     CAC002
     C           ZRATEX    ORGE RATE                                      CAC002
     C           ZRATEX    ANDLT1                                         CAC002
     C           WPYAM     ANDLEWSMAM                                     CAC002
     C           ZRATEX    ORLE RATE                                      CAC002
     C           ZRATEX    ANDGT1                                         CAC002
     C           WPYAM     ANDLEWSMAM                                     CAC002
     C           ZRATEX    ORLE RATE                                      CAC002
     C           ZRATEX    ANDLT1                                         CAC002
     C           WPYAM     ANDGEWSMAM                                     CAC002
     C                     MOVE '+'       MSIG                            CAC002
     C                     ELSE                                           CAC002
     C                     MOVE '-'       MSIG                            CAC002
     C                     ENDIF                                          CAC002
      *                                                                   CAC002
      **  Calculate Margin Amount                                         CAC002
      *                                                                   CAC002
     C                     EXSR SRMAMT                                    CAC002
     C                     ENDIF                                          CAC002
     C/COPY WNCPYSRC,FT0300C007
      *
      * Define key list
      *
     C           KPREF     KLIST
     C                     KFLD           PREF
      *
      * Check for duplicate primary key
      *
     C           KPREF     SETLL@INPAYL0                 90*
     C           *IN90     IFEQ '1'
     C                     Z-ADD9         W0ERNB           **************
     C                     MOVEL'INPAYL0 'W0FILE           *DB ERROR 09 *
     C                     MOVELPREF      W0KEY            **************
     C                     MOVEL'MEM5002' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C***********          EXSR SRERR                                     130869
     C                     EXSR SRERRA                                    130869
     C                     END
     C/COPY WNCPYSRC,FT0300C087
      *                                                                                       CSD015
     C           WLIPIN    IFEQ 'Y'                                                           CSD015
     C           CSC011    IFEQ 'N'                                                           CSD015
     C           S1MAIN    OREQ LIBR                                                          CSD015
     C                     EXSR SRIPWT                                                        CSD015
     C                     ENDIF                                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                     BUG26009
     C                     CALL 'ZAGENTS'                                                   BUG26009
     C                     PARM           TMST                                              BUG26009
      *
      *                                                                   MK0519
     C                     Z-ADDRATE      RATED                           MK0519
      *                                                                   MK0519
     C                     CALL 'AOCURRR0'                                MK0519
     C                     PARM *BLANKS   P@RTCD                          MK0519
     C                     PARM '*KEY    'P@OPTN                          MK0519
     C                     PARM SMCY      WCURR   3                       MK0519
     C           SDCURR    PARM SDCURR    DSSDY                           MK0519
      *                                                                   MK0519
     C           P@RTCD    IFNE *BLANKS                                   MK0519
     C                     MOVEL'AOCURRR0'W0FILE                          MK0519
     C                     MOVEL'*CALL'   W0KEY            ************   MK0519
     C                     Z-ADD60        W0ERNB           * DBERR 60 *   MK0519
     C                     MOVEL'MEM5003' W0MSGD           ************   MK0519
     C                     MOVEL'MIDAS  ' W0MSGF                          MK0519
     C                     EXSR SRERRA                                    MK0519
     C                     ELSE                                           MK0519
     C           A6NBDP    ADD  1         N       10                      MK0519
     C           SMAM      DIV  AP,N      SMAMD                           MK0519
     C                     ENDIF                                          MK0519
      *                                                                   MK0519
     C                     CALL 'AOCURRR0'                                MK0519
     C                     PARM *BLANKS   P@RTCD                          MK0519
     C                     PARM '*KEY    'P@OPTN                          MK0519
     C                     PARM PCCY      WCURR   3                       MK0519
     C           SDCURR    PARM SDCURR    DSSDY                           MK0519
      *                                                                   MK0519
     C           P@RTCD    IFNE *BLANKS                                   MK0519
     C                     MOVEL'AOCURRR0'W0FILE                          MK0519
     C                     MOVEL'*CALL'   W0KEY            ************   MK0519
     C                     Z-ADD61        W0ERNB           * DBERR 61 *   MK0519
     C                     MOVEL'MEM5003' W0MSGD           ************   MK0519
     C                     MOVEL'MIDAS  ' W0MSGF                          MK0519
     C                     EXSR SRERRA                                    MK0519
     C                     ELSE                                           MK0519
     C           A6NBDP    ADD  1         N       10                      MK0519
     C           PYAM      DIV  AP,N      PYAMD                           MK0519
     C                     ENDIF                                          MK0519
      *
      *  Write record to database
      *
     C                     WRITE@INPAYL0
     C/COPY WNCPYSRC,FT0300DB01                                                            AR856737
      *                                                                                     BUG25944
     C           CAP185    IFEQ 'Y'                                                         BUG25944
     C                     MOVE *BLANKS   IPPREF                                            BUG25944
     C                     MOVE *BLANKS   IPFRID                                            BUG25944
     C                     MOVELINPREF    IPPREF                                            BUG25944
     C                     MOVELIPFRNT    IPFRID                                            BUG25944
     C                     WRITEINPAYQD0                                                    BUG25944
     C                     ENDIF                                                            BUG25944
      *
      *  Update FT Refs network information
      *
     C           *NAMVAR   DEFN           MEDTA
     C           *LOCK     IN   MEDTA
     C           PNWRK     IFEQ 'SWIFT '                   Network
     C                     Z-ADDINMSGR    DAMSI1
     C                     Z-ADDINKPRT    DAMPI1
     C                     END
      *
      *  /Copy point to allow other network updates
      *
     C/COPY WNCPYSRC,FT0300IFTR
      *
     C                     OUT  MEDTA
      *
      * DBF write successful
      *
      *
      *  Process shadow post if new addition
      *
     C           PNWRK     IFEQ 'CASHV8'                                  122060
     C                     EXSR SRRVBB                                    122060
     C                     ENDIF                                          122060
      *                                                                   122060
     C           INLVL1    IFEQ 'Y'
     C                     Z-ADDSMAM      ##SMAM
     C                     Z-ADDPYAM      ##PYAM
     C                     EXSR SRADDI
     C                     END
      *                                                                   CFT009
      ** Shadow postings for charges                                      CFT009
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
     C           INLVL2    ANDEQ'Y'                                       CFT009
     C                     EXSR SPCGIN                                    CFT009
     C                     ENDIF                                          CFT009
      *
      *  Update database with changes
      *
     C                     EXSR SRUPD
      *
      * Update Trailer
      *
     C           1         CHAININPAYZZF             90
     C           *IN90     IFEQ '1'
     C                     Z-ADD10        W0ERNB           **************
     C                     MOVEL'INPAYZZ 'W0FILE           *DB ERROR 10 *
     C                     MOVEL'*ONLY'   W0KEY            **************
     C                     MOVEL'MEM5002' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C***********          EXSR SRERR                                     130869
     C                     EXSR SRERRA                                    130869
     C                     END
      *
     C           HRWN      MULT 1000      W#TRLR 180
     C                     ADD  HRDC      W#TRLR
     C                     ADD  SMAM      W#TRLR
     C                     ADD  1         NORE1
     C           W#TRLR    DIV  1000      HRWN
     C                     Z-ADDW#TRLR    HRDC
      *
     C                     UPDATINPAYZZF
      *
      * Update Incoming Message FT Transaction Status File record
      *
     C           INMSGR    IFNE 0
      *
     C           CFT005    IFEQ 'Y'                                       CFT005
     C           WAUIN     ANDEQ'Y'                                       CFT005
     C                     MOVEL'MIN0032' W0FLAG  7                       CFT005
     C                     ELSE                                           CFT005
     C                     MOVEL'MIN0030' W0FLAG  7
     C                     ENDIF                                          CFT005
      *                                                                   CFT005
     C                     MOVEL'MIN0027' W0LMSG  7
      *
     C/COPY WNCPYSRC,FT0300C089
     C                     EXSR SRFTST
      *
     C                     END
      *                                                                   S01408
     C/COPY WNCPYSRC,FT0300CP15                                           S01408
      *                                                                   S01408
      *
      *  Commit updates
      *
     C                     COMIT
      *
      *  Set up ##OK as Payment Generation successful
      *
     C                     MOVEL'Y'       ##OK
     C/COPY WNCPYSRC,FT0300MK14
      *
      *  Unwind subroutine stack name
      *
     C           EXINUP    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SROPS1   : Validate Outgoing Level 1 details                 *
      *                                                               *
      *  CALLED BY: SROPFT - Create Outgoing Payment Transaction      *
      *                                                               *
      *****************************************************************
     CSR         SROPS1    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SROPS1'  @STK,Q
      *================================================================
      *
      *  /Copy point for Outgoing Payments Level 1
      *
     C                     MOVEL*BLANK    @REC1   1                                           MAR015
     C                     MOVEL*BLANK    @REC2   1                                           MAR015
     C/COPY WNCPYSRC,FT0300OPS1
      *                                                                   CFT014
      *** Memorize currencies values before screen validation             CFT014
      *                                                                   CFT014
     C                     MOVELS4SMCY    WMSMCY                          CFT014
     C                     MOVELS4PCCY    WMPCCY                          CFT014
     C                     MOVELS4PDCY    WMPDCY                          CFT014
      *                                                                   CFT014
     C                     MOVEL'I'       S4ACTD
     C                     MOVEL*BLANKS   S4PREF
      *  Booking Branch
     C                     MOVELS4BRCA    S4BRCA
      *  Orginating Branch
     C                     MOVELS4ORBR    S4ORBR
      *  Payment Type
     C           S4PYTP    IFEQ *BLANKS
     C                     MOVEL'OP'      S4PYTP
     C                     END
      *  Payment Subtype
     C                     MOVELS4PYST    S4PYST
      *  Settlement Type
     C                     MOVELS4STMT    S4STMT
      *  S.W.I.F.T. Priority
     C           S4SWPC    IFEQ *BLANKS
     C                     MOVEL'N'       S4SWPC
     C                     ELSE
     C                     MOVELS4SWPC    S4SWPC
     C                     END
      *  Destination
     C                     MOVELS4DST     S4DST
      *  Ordering Customer for MT100
     C                     MOVELS4ODMT    S4ODMT
      *  Ordering Customer
     C                     MOVELS4ORC     S4ORC
      *  Ordering Bank
     C                     MOVELS4ORBK    S4ORBK
      *  Ordering Bank Branch
     C                     MOVELS4ORBB    S4ORBB
      *  Sender's Correspondent
     C                     MOVELS4SNCO    S4SNCO
      *  Cover Payment Required
     C                     MOVELS4SNMT    S4SNMT
      *  Settlement Amount
     C                     MOVELS4SMAM    S4SMAM
      *  Settlement Currency
     C                     MOVELS4SMCY    S4SMCY
      *  Settle value date
     C                     MOVELS4SLDT    S4SLDT
      *  Pay Amount
     C                     MOVELS4PYAM    S4PYAM
      *  Pay Currency
     C                     MOVELS4PCCY    S4PCCY
      *  Pay value date
     C                     MOVELS4PVDT    S4PVDT
      *  Rate
     C                     MOVELS4RATE    S4RATE
      *  Rate override
     C                     MOVELS4OVRD    S4OVRD
      *  Add/Deduct Indicator
     C           S4ADDC    IFEQ *BLANKS
     C                     MOVEL'D'       S4ADDC
     C                     ELSE
     C                     MOVELS4ADDC    S4ADDC
     C                     END
      *  Book code
     C                     MOVELS4BOKC    S4BOKC
      *  Profit Code
     C                     MOVELS4PRFC    S4PRFC
      *
      *  Regular Payment Data
      *
      *  Regular Payment Flag
     C           S4RPAY    IFEQ *BLANKS
     C                     MOVEL'N'       S4RPAY
     C                     ELSE
     C                     MOVELS4RPAY    S4RPAY
     C                     END
      *  Regular Payment Frequency
     C                     MOVELS4PAYF    S4PAYF
      *  Day in Month
     C                     MOVELS4DYIM    S4DYIM
      *  Next Date
     C                     MOVELS4NDAT    S4NDAT
      *  Final Date
     C                     MOVELS4FIND    S4FIND
     C/COPY WNCPYSRC,FT0300C038
      *
      *
      *  Data Structure to pass data between programs
      *
      *  Fields needed for error processing
      *
      * No update indicator
     C                     MOVEL*BLANKS   E#NOUP
      * Re-send screen indicator
     C                     MOVEL*BLANKS   E#RSND
      * Warning message sent
     C                     MOVEL*BLANKS   E#WARN
      * Warning message array
     C                     MOVEL*BLANKS   E#WARA
      * Message sent via FTSNMS
     C                     MOVEL*BLANKS   E#MSGS
      * Program to send messages to
     C                     MOVEL##PGM     E#CPGM
      *
      *  Data Structure to pass data between programs
      *
      *  Error codes to be displayed
      *
     C                     MOVEL*BLANKS   C#ERCD
      *
      *  Define entry parameters
      *
     C                     CALL 'FT0342'               9090
     C                     PARM *BLANKS   P@RTCD
     C*********************PARM '*VALID'  W0ACT   8                       CGL009
     C                     PARM '*VALID  'W2ACT   8                       CGL009
     C                     PARM           S4DATA
     C                     PARM           V#DATA
     C                     PARM           F4DATA
     C                     PARM           E#DATA
     C                     PARM           C#DATA
     C                     PARM           I4DATA
     C                     PARM           @@CLID                                              STP500
      *
      *  If error on call
      *
     C           *IN90     IFEQ '1'
     C           P@RTCD    ORNE *BLANKS
     C                     MOVEL'FT0342  'W0FILE           ***************
     C                     MOVEL'*CALL'   W0KEY            * DB ERROR 11 *
     C                     Z-ADD11        W0ERNB           ***************
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C***********          EXSR SRERR                                     130869
     C                     EXSR SRERRA                                    130869
     C                     END
      *
      *  Data Structure to pass data between programs
     C/COPY WNCPYSRC,FT0300C012
      *
      *
      *  Move back validated data
      *
      *  NONE AT PRESENT
      *
      *
      *  Report errors
      *
     C                     EXSR SRRERR
      *
      *  If E#NOUP not blanks set flag
      *
     C           E#NOUP    IFEQ *BLANKS
     C                     MOVEL'Y'       LVL1
     C                     MOVEL'FTM2016' W0LMSG           Action - Msg ID
     C                     MOVEL'FTUSRMSG'W0MSGF           Msg file
     C                     EXSR SRLOG
     C/COPY WNCPYSRC,FT0300DB07                                           EEE058            AR856737
      *                                                                   CFT009
      * If CFT009 is on, default charges                                  CFT009
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
     C                     EXSR DFOCHG                                    CFT009
     C                     MOVEL'Y'       LVL1                                              BUG24502
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C/COPY WNCPYSRC,FT0300DB08                                           EEE058            AR856737
     C                     ELSE
     C                     MOVEL'Y'       ##OPS4
     C                     MOVEL'FTM2017' W0LMSG           Action - Msg ID
     C                     MOVEL'FTUSRMSG'W0MSGF           Msg file
     C                     EXSR SRLOG
     C                     GOTO EXOPS1                                    CFT014
     C                     END
      *                                                                                       MK0512
     C           #EXTRN    IFEQ 'Y'                                                           MK0512
     C                     MOVEL'Y'       S4OVRD                                              MK0512
     C                     ENDIF                                                              MK0512
      *                                                                   CFT014
      *  At this stage Pay Currency, Settlement Currency,                 CFT014
      *  Pay Delivery currency are not supposed to change.                CFT014
      *  Retrieve details of the currencies                               CFT014
      *  - If validation has changed the currency                         CFT014
      *  - If currency details have not been retrieved yet                CFT014
     C           S4SMCY    IFNE *BLANK                                    CFT014
     C           S4SMCY    IFNE WMSMCY                                    CFT014
     C           SCNBDP    OREQ *LOVAL                                    CFT014
     C                     MOVELS4SMCY    WCYCCY                          CFT014
     C                     MOVEL'N'       WCYDMP                          CFT014
     C                     EXSR RTCCYD                                    CFT014
     C           WCYRTN    IFEQ *BLANK                                    CFT014
     C                     Z-ADDWCYNDP    SCNBDP                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           S4PCCY    IFNE *BLANK                                    CFT014
     C           S4PCCY    IFNE WMPCCY                                    CFT014
     C           PCNBDP    OREQ *LOVAL                                    CFT014
     C                     MOVELS4PCCY    WCYCCY                          CFT014
     C                     MOVEL'N'       WCYDMP                          CFT014
     C                     EXSR RTCCYD                                    CFT014
     C           WCYRTN    IFEQ *BLANK                                    CFT014
     C                     Z-ADDWCYNDP    PCNBDP                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           S4PDCY    IFNE *BLANK                                    CFT014
     C           S4PDCY    IFNE WMPDCY                                    CFT014
     C           DCNBDP    OREQ *LOVAL                                    CFT014
     C                     MOVELS4PDCY    WCYCCY                          CFT014
     C                     MOVEL'N'       WCYDMP                          CFT014
     C                     EXSR RTCCYD                                    CFT014
     C           WCYRTN    IFEQ *BLANK                                    CFT014
     C                     Z-ADDWCYNDP    DCNBDP                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      *
      *  Unwind subroutine stack name
      *
     C           EXOPS1    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SROPS2   : Validate Outgoing Level 2 Screen 1                *
      *                                                               *
      *  CALLED BY: SROPFT - Create Outgoing Payment Transaction      *
      *                                                               *
      *****************************************************************
     CSR         SROPS2    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SROPS2'  @STK,Q
      *
      *  /Copy point for Outgoing Payments Level 2 Screen 1
      *
     C/COPY WNCPYSRC,FT0300OPS2
      *
     C                     MOVELS4ORC1    V#ORC1
     C                     MOVELS4ADDC    V#ADDC
     C                     MOVELS4STMT    V#STMT
     C                     Z-ADDF4SLDT    V#SLDT
     C                     Z-ADDF4PVDT    V#PVDT
     C                     MOVELS4PCCY    V#PCCY
     C                     MOVELS4SMCY    V#SMCY
     C                     Z-ADDF4SMAM    V#SMAM
     C                     Z-ADDF4PYAM    V#PYAM
     C                     MOVELF4SNCT    V#SNCT
     C                     MOVELS4SNMT    V#SNMT
     C/COPY WNCPYSRC,FT0300C039
      *
      *  Data Structure to pass data between programs
      *
      *  Screen Input Fields
      *
     C                     MOVEL'I'       S5ACTD
     C                     MOVEL*BLANKS   S5PREF
      * Receiver's Correspondent
     C                     MOVELS5RCO     S5RCO
      * Account with Institution
     C                     MOVELS5ACB     S5ACB
      * Beneficiary
     C                     MOVELS5BNC     S5BNC
      * These codes are moved elsewhere due to movement of these          CFT014
      * fields to other screens on the maintenance function.              CFT014
      **Details*of*Payment*********                                       CFT014
     C*********************MOVELS5PAY     S5PAY                           CFT014
      **Bank*to*Bank*Information*****                                     CFT014
     C*********************MOVELS5BTB     S5BTB                           CFT014
      **Transfer*Commission**********                                     CFT014
     C*********************MOVELV#TRCT    S5TRCT                          CFT014
      **Charge's*to*the*Debit*of********                                  CFT014
     C*********************MOVELS5CDRO    S5CDRO                          CFT014
     C*********************MOVELS5CDBR    S5CDBR                          CFT014
      *
      *  Data Structure to pass data between programs
      *
      *  Fields needed for error processing
      *
      * No update indicator
     C                     MOVEL*BLANKS   E#NOUP
      * Re-send screen indicator
     C                     MOVEL*BLANKS   E#RSND
      * Warning message sent
     C                     MOVEL*BLANKS   E#WARN
      * Warning message array
     C                     MOVEL*BLANKS   E#WARA
      * Message sent via FTSNMS
     C                     MOVEL*BLANKS   E#MSGS
      * Program to send messages to
     C                     MOVEL##PGM     E#CPGM
      *
      *
      *  Data Structure to pass data between programs
      *
      *  Error codes to be displayed
      *
     C                     MOVEL*BLANKS   C#ERCD
      *
      *
      *  Define entry parameters
      *
     C                     CALL 'FT0347'               9090
     C                     PARM *BLANKS   P@RTCD
     C*********************PARM '*VALID'  W0ACT   8                       CGL009
     C                     PARM '*VALID  'W2ACT   8                       CGL009
     C                     PARM           S5DATA
     C                     PARM           V#DATA
     C                     PARM           F5DATA
     C                     PARM           E#DATA
     C                     PARM           C#DATA
     C                     PARM           I5DATA
     C                     PARM           @@CLID                                              STP500
     C/COPY WNCPYSRC,FT0300C078
      *
      *  If error on call
      *
     C           *IN90     IFEQ '1'
     C           P@RTCD    ORNE *BLANKS
     C                     MOVEL'FT0347  'W0FILE           ***************
     C                     MOVEL'*CALL'   W0KEY            * DB ERROR 12 *
     C                     Z-ADD12        W0ERNB           ***************
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C***********          EXSR SRERR                                     130869
     C                     EXSR SRERRA                                    130869
     C                     END
      *                                                                                       MK0524
      *                                                                                       MK0524
      *  Define entry parameters                                                              MK0524
      *                                                                                       MK0524
     C           *LIKE     DEFN ACNO      ##RCRM                                              MK0524
     C                     Z-ADD0         ##RCRM                                              MK0524
      *                                                                                       MK0524
     C           S7DETC    IFEQ 'OUR'                                                         MK0524
     C           CFT009    ANDEQ'Y'                                                         AR856737
      *                                                                                       MK0524
      * At this stage it is necessary to pass fields types to FT000984.                       MK0524
      * They have been just set in FT0347.                                                    MK0524
      *                                                                                       MK0524
     C                     MOVELF5BNCT    OTBNCT                                              MK0524
     C                     MOVELF5INBT    OTINBT                                              MK0524
     C                     MOVELF5ACBT    OTACBT                                              MK0524
     C                     MOVELF5TRIT    OPTRIT                                              MK0524
     C                     MOVELF5RCOT    OTRCRT                                              MK0524
      *                                                                                       MK0524
     C                     MOVELOTPYDS    TRNDET                                              MK0524
     C                     MOVELOTPXDS    TRNEXT                                              MK0524
      *                                                                                       MK0524
     C                     MOVEL'Y'       O#AUTO                                              MK0524
     C                     CALL 'FT000984'                                                    MK0524
     C                     PARM *BLANKS   P@RTCD                                              MK0524
     C                     PARM           TRNDET                                              MK0524
     C                     PARM           TRNEXT                                              MK0524
     C                     PARM 'OP'      TRNTYP                                              MK0524
     C                     PARM           ##RCRM                                              MK0524
     C                     MOVEL' '       O#AUTO                                              MK0524
      *                                                                                       MK0524
     C                     Z-ADD##RCRM    F7RCRM                                              MK0524
      *                                                                                       MK0524
      *  If error on call                                                                     MK0524
      *                                                                                       MK0524
     C           *IN90     IFEQ '1'                                                           MK0524
     C           P@RTCD    ORNE *BLANKS                                                       MK0524
     C                     MOVEL'FT0347  'W0FILE           ***************                    MK0524
     C                     MOVEL'*CALL'   W0KEY            * DB ERROR 68 *                    MK0524
     C                     Z-ADD68        W0ERNB           ***************                    MK0524
     C                     MOVEL'MEM5003' W0MSGD                                              MK0524
     C                     MOVEL'MIDAS  ' W0MSGF                                              MK0524
     C                     EXSR SRERRA                                                        MK0524
     C                     END                                                                MK0524
     C                     ENDIF                                                              MK0524
      *
      *  Data Structure to pass data between programs
      *
      *
      *  Move back validated data
      *
      *  NONE AT PRESENT
      *
      *
      *  Report errors
      *
     C                     EXSR SRRERR
      *
      *  If E#NOUP not blanks set flag
      *
     C           E#NOUP    IFNE *BLANKS
     C                     MOVEL'Y'       ##OPS5
     C                     MOVEL'FTM2018' W0LMSG           Action - Msg ID
     C                     MOVEL'FTUSRMSG'W0MSGF           Msg file
     C                     EXSR SRLOG
     C                     END
      *
      *  Unwind subroutine stack name
      *
     C           EXOPS2    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SROPS3   : Validate Outgoing Level 1 Screen 2                *
      *                                                               *
      *  CALLED BY: SROPFT - Create Outgoing Payment Transaction      *
      *                                                               *
      *****************************************************************
     CSR         SROPS3    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SROPS3'  @STK,Q
      *
      *  /Copy point for Outgoing Payments Level 2 Screen 2
      *
     C/COPY WNCPYSRC,FT0300OPS3
      * These codes are moved to CHGOP due to the movement of charges     CFT014
      * validation to FT0349.                                             CFT014
      *********************************                                   CFT014
      ***Set*up*input*charge*currency*****                                CFT014
      *************************                                           CFT014
     C*********************SELEC                                          CFT014
      *********************************                                   CFT014
     C***********BTCHCY    WHEQ 'B'                                       CFT014
     C***********S5CDRO    ORNE *BLANKS                                   CFT014
     C*********************MOVELV#BCCY    V#CCCY                          CFT014
      ********************                                                CFT014
     C***********BTCHCY    WHEQ 'L'                                       CFT014
     C*********************MOVELV#LCCY    V#CCCY                          CFT014
      *******************                                                 CFT014
     C***********BTCHCY    WHEQ 'C'                                       CFT014
     C***********V#ADDC    ANDEQ'A'                                       CFT014
     C*********************MOVELS4SMCY    V#CCCY                          CFT014
      ***********************                                             CFT014
     C*********************OTHER                                          CFT014
     C*********************MOVELS4PCCY    V#CCCY                          CFT014
     C*********************ENDSL                                          CF0T14
      ******************************                                      CFT014
      ***Set*up*Charge*currency************                               CFT014
      *****************************                                       CFT014
     C*********************SELEC                                          CFT014
      ************************                                            CFT014
     C***********S5CDRO    WHNE *BLANKS                                   CFT014
     C*********************MOVELV#BCCY    V#RCCY                          CFT014
      **********************************                                  CFT014
     C***********V#ADDC    WHEQ 'A'                                       CFT014
     C*********************MOVELS4SMCY    V#RCCY                          CFT014
      ********************                                                CFT014
     C*********************OTHER                                          CFT014
     C*********************MOVELS4PCCY    V#RCCY                          CFT014
     C*********************ENDSL                                          CFT014
      *                                                                   CFT014
      *  Data Structure to pass data between programs
      *
     C                     MOVEL'I'       S6ACTD
     C                     MOVEL*BLANKS   S6PREF
      * Set Settlement type, account with institution
     C                     MOVELS4STMT    V#STMT
     C                     MOVELF5ACBT    V#ACBT
     C                     MOVELS5ACB1    #CHKT
     C           #CHKT     IFEQ '/'
     C                     MOVELS5ACB1    V#ACB1
     C                     ELSE
     C                     MOVELS5ACB2    V#ACB1
     C                     END
     C                     MOVELS5RCO1    #CHKT
     C           #CHKT     IFEQ '/'
     C                     MOVELS5RCO1    V#RCO1
     C                     ELSE
     C                     MOVELS5RCO2    V#RCO1
     C                     END
     C                     MOVELS5BNC1    #CHKT
     C           #CHKT     IFEQ '/'
     C                     MOVELS5BNC1    V#BNC1
     C                     ELSE
     C                     MOVELS5BNC2    V#BNC1
     C                     END
      **Intermediary*Bank***********                                      CFT014
     C*********************MOVELS6IBK     S6IBK                           CFT014
      * Central Bank Reference
     C           #3CNBK    IFEQ *BLANKS                                                       MK0520
     C                     MOVELS6CBKR    S6CBKR
     C                     ELSE                                                               MK0520
     C                     MOVE #3CNBK    S6CBKR                                              MK0520
     C                     ENDIF                                                              MK0520
      **Details*of Charge***********                                      CFT014
     C*********************MOVELS6DETC    S6DETC                          CFT014
      * Transfer Commission                                               CFT014
     C                     MOVELV#TRCT    S6TRCT                          CFT014
      *
      * Charges
      *
      * These codes are moved to CHGOP due to the movement of charges     CFT014
      * validation to FT0349.                                             CFT014
      **Transfer*and*Commission********************                       CFT014
     C*********************MOVELS6TRCD    S6TRCD                          CFT014
      **Telex**************************************                       CFT014
     C*********************MOVELS6TXCD    S6TXCD                          CFT014
      **Cheque*********************                                       CFT014
     C*********************MOVELS6CQCD    S6CQCD                          CFT014
      **Costs*Abroad********************                                  CFT014
     C*********************MOVELS6CSTD    S6CSTD                          CFT014
      **SWIFT*Priority******************                                  CFT014
     C*********************MOVELS6SPCD    S6SPCD                          CFT014
      **Miscellaneous*******************                                  CFT014
     C*********************MOVELS6MSCD    S6MSCD                          CFT014
      * Related Reference
     C                     MOVELS6RLRF    S6RLRF
      * CHAPS Code
     C                     MOVELS6CHAP    S6CHAP
     C/COPY WNCPYSRC,FT0300C040
      *
      *  Data Structure to pass data between programs
      *
      *  Fields needed for error processing
      *
      * No update indicator
     C                     MOVEL*BLANKS   E#NOUP
      * Re-send screen indicator
     C                     MOVEL*BLANKS   E#RSND
      * Warning message sent
     C                     MOVEL*BLANKS   E#WARN
      * Warning message array
     C                     MOVEL*BLANKS   E#WARA
      * Message sent via FTSNMS
     C                     MOVEL*BLANKS   E#MSGS
      * Program to send messages to
     C                     MOVEL##PGM     E#CPGM
      *
      *
      *  Data Structure to pass data between programs
      *
      *  Error codes to be displayed
      *
     C                     MOVEL*BLANKS   C#ERCD
      *
      *
      *  Define entry parameters
      *
     C           CSW201    IFEQ 'Y'                                                           CSW201
     C                     MOVE S5IBK1    I6INB1                                              CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C                     CALL 'FT0348'               9090
     C                     PARM *BLANKS   P@RTCD
     C*********************PARM '*VALID'  W0ACT   8                       CGL009
     C                     PARM '*VALID  'W2ACT   8                       CGL009
     C                     PARM           S6DATA
     C                     PARM           V#DATA
     C                     PARM           F6DATA
     C                     PARM           E#DATA
     C                     PARM           C#DATA
     C                     PARM           I6DATA
     C                     PARM           S4DATA                                            BUG26775
     C                     PARM           F4DATA                                            BUG26775
     C                     PARM           S5DATA                                            BUG26775
     C                     PARM           F5DATA                                            BUG26775
     C/COPY WNCPYSRC,FT0300C059
      *
      *  If error on call
      *
     C           *IN90     IFEQ '1'
     C           P@RTCD    ORNE *BLANKS
     C*********************MOVEL'FT0347  'W0FILE           ***************                    CFT003
     C                     MOVEL'FT0348  'W0FILE           ***************                    CFT003
     C                     MOVEL'*CALL'   W0KEY            * DB ERROR 13 *
     C                     Z-ADD13        W0ERNB           ***************
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C***********          EXSR SRERR                                     130869
     C                     EXSR SRERRA                                    130869
     C                     END
      *
      *  Data Structure to pass data between programs
      *
      *
      *  Move back validated data
      *
      *  NONE AT PRESENT
      *
      *
      *  Report errors
      *
     C                     EXSR SRRERR
      *
      *  If E#NOUP not blanks set flag
      *
     C           E#NOUP    IFEQ *BLANKS
     C*********************MOVEL'Y'       LVL2                            CFT014
     C*********************MOVEL'FTM2019' W0LMSG           Action - Msg IDCFT014
     C*********************MOVEL'FTUSRMSG'W0MSGF           Msg file       CFT014
     C*********************EXSR SRLOG                                     CFT014
     C                     ELSE
     C                     MOVEL'Y'       ##OPS6
     C                     MOVEL'FTM2020' W0LMSG           Action - Msg ID
     C                     MOVEL'FTUSRMSG'W0MSGF           Msg file
     C                     EXSR SRLOG
     C                     END
      *
      *  Unwind subroutine stack name
      *
     C           EXOPS3    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
     C/EJECT
      *****************************************************************   CFT014
      *                                                               *   CFT014
      *  SROPS4   : Validate Outgoing Level 2 Screen 3                *   CFT014
      *                                                               *   CFT014
      *  CALLED BY: SROPFT - Create Outgoing Payment Transaction      *   CFT014
      *                                                               *   CFT014
      *****************************************************************   CFT014
     CSR         SROPS4    BEGSR                                          CFT014
      *                                                                   CFT014
      *  Set up subroutine stack name                                     CFT014
      *                                                                   CFT014
     C                     ADD  1         Q       50                      CFT014
     C                     MOVEL'SROPS4'  @STK,Q                          CFT014
      ** Determine if MIF is applicable for this transaction                                  CFT017
      *                                                                                       CFT017
     C           CFT017    IFEQ 'Y'                                                           CFT017
     C                     EXSR SRMIF                                                         CFT017
     C                     ENDIF                                                              CFT017
      *                                                                                       CFT017
      *                                                                   CFT014
      ** Set up charges for outgoing payment                              CFT014
     C                     EXSR CHGOP                                     CFT014
      *                                                                   CFT014
     C                     CALL 'FT0349'               90                 CFT014
     C                     PARM *BLANKS   P@RTCD                          CFT014
     C                     PARM '*VALID  'W2ACT   8                       CFT014
     C                     PARM           S7DATA                          CFT014
     C                     PARM           V#DATA                          CFT014
     C                     PARM           F7DATA                          CFT014
     C                     PARM           E#DATA                          CFT014
     C                     PARM           C#DATA                          CFT014
     C                     PARM           I7DATA                          CFT014
     C*****                PARM 'S'       STP     1                 CFT009STP017
     C                     PARM 'Y'       STP     1                       STP017
      *                                                                   CFT014
      *  If error on call                                                 CFT014
      *                                                                   CFT014
     C           *IN90     IFEQ '1'                                       CFT014
     C           P@RTCD    ORNE *BLANKS                                   CFT014
     C                     MOVEL'FT0349  'W0FILE           ***************CFT014
     C                     MOVEL'*CALL'   W0KEY            * DB ERROR 120*CFT014
     C                     Z-ADD120       W0ERNB           ***************CFT014
     C                     MOVEL'MEM5003' W0MSGD                          CFT014
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT014
     C                     EXSR SRERRA                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      *  Report errors                                                    CFT014
      *                                                                   CFT014
     C                     EXSR SRRERR                                    CFT014
      *                                                                   CFT014
      *  If E#NOUP not blanks set flag                                    CFT014
      *                                                                   CFT014
     C           E#NOUP    IFEQ *BLANKS                                   CFT014
     C           CSW209    IFEQ 'N'                                                           CSW209
     C                     MOVEL'Y'       LVL2                            CFT014
     C                     MOVEL'FTM2019' W0LMSG                          CFT014
     C                     MOVEL'FTUSRMSG'W0MSGF                          CFT014
     C                     EXSR SRLOG                                     CFT014
     C                     ENDIF                                                              CSW209
     C                     ELSE                                           CFT014
     C                     MOVEL'Y'       ##OPS7                          CFT014
     C                     MOVEL'FTM4002' W0LMSG                          CFT014
     C                     MOVEL'FTUSRMSG'W0MSGF                          CFT014
     C                     EXSR SRLOG                                     CFT014
     C                     ENDIF                                          CFT014
      *                                                                                       STP033
      * Calculate total charges.                                                              STP033
      *                                                                                       STP033
     C                     Z-ADD0         TOTCHG                                              STP033
     C                     MOVEL*BLANKS   S7SCC1                                              STP033
      *                                                                                       STP033
     C           S4PYTP    IFEQ 'OP'                                                          STP033
     C           S4ADDC    ANDEQ'D'                                                           STP033
     C           CFT009    ANDEQ'Y'                                                           STP033
     C           WCHGD     ANDEQ*BLANKS                                                       STP033
     C           OTDTCH    ANDEQ'BEN'                                                         STP033
      *         Add all the OP charges                                                        STP033
     C           OTCHCM    ADD  OTTRCM    TOTCHG 120                                          STP033
     C                     ADD  OTTXCH    TOTCHG                                              STP033
     C                     ADD  OTCQCH    TOTCHG                                              STP033
     C                     ADD  OSWSCH    TOTCHG                                              STP033
     C                     ADD  OTSPCH    TOTCHG                                              STP033
     C                     ADD  OTMSCH    TOTCHG                                              STP033
     C                     ADD  MISC01    TOTCHG                                              STP033
     C                     ADD  MISCC2    TOTCHG                                              STP033
     C                     ADD  MISCC3    TOTCHG                                              STP033
     C                     ADD  MISCC4    TOTCHG                                              STP033
     C                     ADD  MISCC5    TOTCHG                                              STP033
     C                     ADD  OTCSTA    TOTCHG                                              STP033
     C                     ADD  OTCHCM    TOTCHG                                              STP033
     C           CFT010    IFEQ 'Y'                                                           STP033
     C                     ADD  OTVATT    TOTCHG                                              STP033
     C                     ENDIF                                                              STP033
     C                     MOVELOTPCCY    S7SCC1                                              STP033
     C                     Z-ADDTOTCHG    F7SCH1                                              STP033
     C                     ENDIF                                                              STP033
      *                                                                                       STP033
      *                                                                   CFT014
     C           EXOPS4    TAG                                            CFT014
     C                     MOVEA*BLANKS   @STK,Q                          CFT014
     C                     SUB  1         Q                               CFT014
      *                                                                   CFT014
     CSR                   ENDSR                                          CFT014
      *****************************************************************                       CFT017
     C/EJECT                                                                                  CFT017
      *****************************************************************                       CSW209
      *                                                               *                       CSW209
      *  SROPS5   : Validate Outgoing Payment Level 2 Screen 4        *                       CSW209
      *                                                               *                       CSW209
      *  CALLED BY: SROPFT - Create Outgoing Payment Transaction      *                       CSW209
      *                                                               *                       CSW209
      *****************************************************************                       CSW209
     CSR         SROPS5    BEGSR                                                              CSW209
      *                                                                                       CSW209
      ** Set up subroutine stack name                                                         CSW209
      *                                                                                       CSW209
     C                     ADD  1         Q       50                                          CSW209
     C                     MOVEL'SROPS5'  @STK,Q                                              CSW209
      *                                                                                       CSW209
      ** Data Structure to pass data between programs                                         CSW209
      ** Fields needed for error processing                                                   CSW209
      *                                                                                       CSW209
      ** No update indicator                                                                  CSW209
     C                     MOVEL*BLANKS   E#NOUP                                              CSW209
      ** Re-send screen indicator                                                             CSW209
     C                     MOVEL*BLANKS   E#RSND                                              CSW209
      ** Warning message sent                                                                 CSW209
     C                     MOVEL*BLANKS   E#WARN                                              CSW209
      ** Warning message array                                                                CSW209
     C                     MOVEL*BLANKS   E#WARA                                              CSW209
      ** Message sent via FTSNMS                                                              CSW209
     C                     MOVEL*BLANKS   E#MSGS                                              CSW209
      ** Program to send messages to                                                          CSW209
     C                     MOVEL##PGM     E#CPGM                                              CSW209
      *                                                                                       CSW209
      ** Data Structure to pass data between programs                                         CSW209
      *                                                                                       CSW209
      ** Error codes to be displayed                                                          CSW209
     C                     MOVEL*BLANKS   C#ERCD                                              CSW209
     C                     MOVEL*BLANKS   FCDATA                                              CSW209
     C                     CLEARICDATA                                                        CSW209
      *                                                                                       CSW209
     C                     CALL 'FT0343'               90                                     CSW209
     C                     PARM *BLANKS   P@RTCD                                              CSW209
     C                     PARM '*VALID  'W2ACT                                               CSW209
     C                     PARM           SCDATA                                              CSW209
     C                     PARM           V#DATA                                              CSW209
     C                     PARM           FCDATA                                              CSW209
     C                     PARM           E#DATA                                              CSW209
     C                     PARM           C#DATA                                              CSW209
     C                     PARM           ICDATA                                              CSW209
     C                     PARM           S4DATA                                              CSW209
     C                     PARM           S6DATA                                              CSW209
      *                                                                                       CSW209
      ** If error on call                                                                     CSW209
      *                                                                                       CSW209
     C           *IN90     IFEQ '1'                                                           CSW209
     C           P@RTCD    ORNE *BLANKS                                                       CSW209
     C           P@RTCD    ANDNE'*RECAL '                                                     CSW209
     C                     MOVEL'FT0343  'W0FILE           ***************                    CSW209
     C                     MOVEL'*CALL'   W0KEY            * DB ERROR 121*                    CSW209
     C                     Z-ADD121       W0ERNB           ***************                    CSW209
     C                     MOVEL'MEM5003' W0MSGD                                              CSW209
     C                     MOVEL'MIDAS  ' W0MSGF                                              CSW209
     C                     EXSR SRERRA                                                        CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
      ** Report errors                                                                        CSW209
      *                                                                                       CSW209
     C                     EXSR SRRERR                                                        CSW209
      *                                                                                       CSW209
      ** If E#NOUP not blanks set flag                                                        CSW209
      *                                                                                       CSW209
     C           E#NOUP    IFNE *BLANKS                                                       CSW209
     C                     MOVEL'Y'       ##INS4                                              CSW209
     C                     MOVEL'FTM4006' W0LMSG                                              CSW209
     C                     MOVEL'FTUSRMSG'W0MSGF                                              CSW209
     C                     EXSR SRLOG                                                         CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
      ** Unwind subroutine stack name                                                         CSW209
      *                                                                                       CSW209
     C           EXOPS5    TAG                                                                CSW209
     C                     MOVEA*BLANKS   @STK,Q                                              CSW209
     C                     SUB  1         Q                                                   CSW209
      *                                                                                       CSW209
     CSR                   ENDSR                                                              CSW209
     C/EJECT                                                                                  CSW209
      *****************************************************************                       CSW209
      *                                                               *                       CSW209
      *  SROPS6   : Validate Outgoing Payment Level 2 Screen 5        *                       CSW209
      *                                                               *                       CSW209
      *  CALLED BY: SROPFT - Create Outgoing Payment Transaction      *                       CSW209
      *                                                               *                       CSW209
      *****************************************************************                       CSW209
     CSR         SROPS6    BEGSR                                                              CSW209
      *                                                                                       CSW209
      ** Set up subroutine stack name                                                         CSW209
      *                                                                                       CSW209
     C                     ADD  1         Q       50                                          CSW209
     C                     MOVEL'SROPS6'  @STK,Q                                              CSW209
      *                                                                                       CSW209
      ** Data Structure to pass data between programs                                         CSW209
      ** Fields needed for error processing                                                   CSW209
      *                                                                                       CSW209
      ** No update indicator                                                                  CSW209
     C                     MOVEL*BLANKS   E#NOUP                                              CSW209
      ** Re-send screen indicator                                                             CSW209
     C                     MOVEL*BLANKS   E#RSND                                              CSW209
      ** Warning message sent                                                                 CSW209
     C                     MOVEL*BLANKS   E#WARN                                              CSW209
      ** Warning message array                                                                CSW209
     C                     MOVEL*BLANKS   E#WARA                                              CSW209
      ** Message sent via FTSNMS                                                              CSW209
     C                     MOVEL*BLANKS   E#MSGS                                              CSW209
      ** Program to send messages to                                                          CSW209
     C                     MOVEL##PGM     E#CPGM                                              CSW209
      *                                                                                       CSW209
      ** Data Structure to pass data between programs                                         CSW209
      *                                                                                       CSW209
      ** Error codes to be displayed                                                          CSW209
     C                     MOVEL*BLANKS   C#ERCD                                              CSW209
     C                     MOVEL*BLANKS   FDDATA                                              CSW209
     C                     CLEARIDDATA                                                        CSW209
      *                                                                                       CSW209
     C                     CALL 'FT0344'               90                                     CSW209
     C                     PARM *BLANKS   P@RTCD                                              CSW209
     C                     PARM '*VALID  'W2ACT                                               CSW209
     C                     PARM           SDDATA                                              CSW209
     C                     PARM           V#DATA                                              CSW209
     C                     PARM           FDDATA                                              CSW209
     C                     PARM           E#DATA                                              CSW209
     C                     PARM           C#DATA                                              CSW209
     C                     PARM           IDDATA                                              CSW209
     C                     PARM           SCDATA                                              CSW209
      *                                                                                       CSW209
      ** If error on call                                                                     CSW209
      *                                                                                       CSW209
     C           *IN90     IFEQ '1'                                                           CSW209
     C           P@RTCD    ORNE *BLANKS                                                       CSW209
     C           P@RTCD    ANDNE'*RECAL '                                                     CSW209
     C                     MOVEL'FT0344  'W0FILE           ***************                    CSW209
     C                     MOVEL'*CALL'   W0KEY            * DB ERROR 121*                    CSW209
     C                     Z-ADD121       W0ERNB           ***************                    CSW209
     C                     MOVEL'MEM5003' W0MSGD                                              CSW209
     C                     MOVEL'MIDAS  ' W0MSGF                                              CSW209
     C                     EXSR SRERRA                                                        CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
      ** Report errors                                                                        CSW209
      *                                                                                       CSW209
     C                     EXSR SRRERR                                                        CSW209
      *                                                                                       CSW209
      ** If E#NOUP not blanks set flag                                                        CSW209
      *                                                                                       CSW209
     C           E#NOUP    IFEQ *BLANKS                                                       CSW209
     C                     MOVEL'Y'       LVL2                                                CSW209
     C                     MOVEL'FTM2019' W0LMSG                                              CSW209
     C                     MOVEL'FTUSRMSG'W0MSGF                                              CSW209
     C                     EXSR SRLOG                                                         CSW209
     C                     ELSE                                                               CSW209
     C                     MOVEL'Y'       ##INS4                                              CSW209
     C                     MOVEL'FTM4007' W0LMSG                                              CSW209
     C                     MOVEL'FTUSRMSG'W0MSGF                                              CSW209
     C                     EXSR SRLOG                                                         CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
      ** Unwind subroutine stack name                                                         CSW209
      *                                                                                       CSW209
     C           EXOPS6    TAG                                                                CSW209
     C                     MOVEA*BLANKS   @STK,Q                                              CSW209
     C                     SUB  1         Q                                                   CSW209
      *                                                                                       CSW209
     CSR                   ENDSR                                                              CSW209
     C/EJECT                                                                                  CSW209
      *****************************************************************                       CFT017
      *                                                               *                       CFT017
      *  SRMIF - Determine if MIF is applicable                       *                       CFT017
      *                                                               *                       CFT017
      *  Called By: Main processing                                   *                       CFT017
      *                                                               *                       CFT017
      *****************************************************************                       CFT017
     C           SRMIF     BEGSR                                                              CFT017
      *                                                                                       CFT017
     C                     MOVEL*BLANK    V#MIFF                                              CFT017
      *                                                                                       CFT017
      ** Check if Sender and Intermediary Bank/Account with Bank are                          CFT017
      ** located in two different EEA member countries by getting                             CFT017
      ** their ISO country codes.                                                             CFT017
      *                                                                                       CFT017
     C                     EXSR SRSISO                                                        CFT017
     C           WCNCD     IFEQ *BLANKS                                                       CFT017
     C           WSCNCD    OREQ *BLANKS                                                       CFT017
     C           WCNCD     OREQ WSCNCD                                                        CFT017
     C                     GOTO ENDMIF                                                        CFT017
     C                     ENDIF                                                              CFT017
      *                                                                                       CFT017
      ** Go to end of subroutine if the following condistions                                 CFT017
      ** are not met.                                                                         CFT017
      ** 1. payment currency is in Euro                                                       CFT017
      ** 2. payment amount is less than or equal to the MIF                                   CFT017
      ** threshold defined in ICD                                                             CFT017
      ** 3. details of charges is 'OUR' and Add/Deduct ind i 'A'                              CFT017
      *                                                                                       CFT017
     C           S4PCCY    IFNE BKEURO                                                        CFT017
     C           F4PYAM    ORGT BTMIFT                                                        CFT017
     C           S7DETC    ORNE 'OUR'                                                         CFT017
     C           S4ADDC    ORNE 'A'                                                           CFT017
     C                     GOTO ENDMIF                                                        CFT017
     C                     ENDIF                                                              CFT017
      *                                                                                       CFT017
      ** Beneficiary must be an IBAN account                                                  CFT017
      *                                                                                       CFT017
     C                     MOVELS5BNC1    WSLSH                                               CFT017
     C           WSLSH     IFEQ '/'                                                           CFT017
     C           34        SUBSTS5BNC1:2  PIBN                                                CFT017
     C                     ELSE                                                               CFT017
     C                     MOVELS5BNC1    PIBN                                                CFT017
     C                     ENDIF                                                              CFT017
      *                                                                                       CFT017
     C                     MOVEL'I'       WACCS   1                                           CFT017
     C                     EXSR SRACCS                                                        CFT017
     C           PRTCD     IFNE *BLANKS                                                       CFT017
     C           PRTCD     ANDNE'      6'                                                     CFT017
     C                     GOTO ENDMIF                                                        CFT017
     C                     ENDIF                                                              CFT017
      *                                                                                       CFT017
      ** Source of Payment must be an MT103.                                                  CFT017
      *                                                                                       CFT017
     C                     EXSR SRM103                                                        CFT017
     C           WM103     IFNE 'Y'                                                           CFT017
     C                     GOTO ENDMIF                                                        CFT017
     C                     ENDIF                                                              CFT017
      *                                                                                       CFT017
      ** If all conditions were satisfied, set MIF flag to 'Y'                                CFT017
      *                                                                                       CFT017
     C                     MOVEL'Y'       V#MIFF                                              CFT017
      *                                                                                       CFT017
     C           ENDMIF    ENDSR                                                              CFT017
      *****************************************************************                       CFT017
     C/EJECT                                                                                  CFT017
      *****************************************************************                       CFT017
      *                                                               *                       CFT017
      *  SRSISO - Determine ISO country code                          *                       CFT017
      *                                                               *                       CFT017
      *  Called By: SRMIF                                             *                       CFT017
      *                                                               *                       CFT017
      *****************************************************************                       CFT017
     C           SRSISO    BEGSR                                                              CFT017
      *                                                                                       CFT017
     C                     MOVEL'Y'       WSISO   1                                           CFT017
     C                     MOVEL*BLANKS   WSCNCD  2                                           CFT017
     C                     MOVEL*BLANKS   WSNDTP  1                                           CFT017
     C                     MOVEL*BLANKS   WSNDID 35                                           CFT017
     C                     MOVEL*BLANKS   WSNDI2 35                                           CFT017
      *                                                                                       CFT017
      ** Check if booking branch has an ISO country code                                      CFT017
     C                     MOVELS4BRCA    WMBRCA                                              CFT017
     C                     EXSR SRBISO                                                        CFT017
      *                                                                                       CFT017
      ** Do not proceed if error in country code or                                           CFT017
      ** country is not an EEA member                                                         CFT017
     C           WCNCD     IFEQ *BLANKS                                                       CFT017
     C                     GOTO ENSISO                                                        CFT017
     C                     ENDIF                                                              CFT017
     C                     MOVELWCNCD     WSCNCD                                              CFT017
     C                     MOVEL*BLANKS   WCNCD                                               CFT017
      *                                                                                       CFT017
      ** Get the other field's country code                                                   CFT017
      ** Get country code of Intermediary if present                                          CFT017
      *                                                                                       CFT017
     C           S5IBK1    IFNE *BLANKS                                                       CFT017
     C                     MOVELF5INBT    WSNDTP                                              CFT017
     C                     MOVELS5IBK1    WSNDID                                              CFT017
     C                     MOVELS5IBK2    WSNDI2                                              CFT017
     C                     EXSR SRCSID                                                        CFT017
     C                     ELSE                                                               CFT017
      *                                                                                       CFT017
      ** Else get country code of Account with Bank if present                                CFT017
      *                                                                                       CFT017
     C           S5ACB1    IFNE *BLANKS                                                       CFT017
     C           F5ACBT    IFEQ 'N'                                                           CFT017
     C                     MOVELS4PCCY    PCYCD                                               CFT017
     C                     ENDIF                                                              CFT017
     C                     MOVELF5ACBT    WSNDTP                                              CFT017
     C                     MOVELS5ACB1    WSNDID                                              CFT017
     C                     MOVELS5ACB2    WSNDI2                                              CFT017
     C                     EXSR SRCSID                                                        CFT017
     C                     ENDIF                                                              CFT017
      *                                                                                       CFT017
     C                     ENDIF                                                              CFT017
      *                                                                                       CFT017
     C                     MOVEL'N'       WSISO                                               CFT017
      *                                                                                       CFT017
     C           ENSISO    ENDSR                                                              CFT017
      *****************************************************************                       CFT017
     C/EJECT                                                                                  CFT017
      *****************************************************************                       CFT017
      *                                                               *                       CFT017
      *  SRBISO - Determine Branch ISO country code                   *                       CFT017
      *                                                               *                       CFT017
      *  Called By: SRSISO                                            *                       CFT017
      *                                                               *                       CFT017
      *****************************************************************                       CFT017
     C           SRBISO    BEGSR                                                              CFT017
      *                                                                                       CFT017
     C                     MOVEL*BLANKS   WCNCD                                               CFT017
     C                     MOVEL*BLANKS   WWCUS                                               CFT017
      *                                                                                       CFT017
      ** If multi-branching environment access branch file thru                               CFT017
      ** booking branch, otherwise thru single branch code                                    CFT017
      *                                                                                       CFT017
     C           WUMBIN    IFNE 'Y'                                                           CFT017
     C                     MOVELBJSBRC    WMBRCA  3                                           CFT017
     C                     ENDIF                                                              CFT017
      *                                                                                       CFT017
      ** Get SWIFT Id via access object AOBRCHR0                                              CFT017
      *                                                                                       CFT017
     C                     MOVE 'B'       WACCS                                               CFT017
     C                     EXSR SRACCS                                                        CFT017
     C           PRTCD     IFNE *BLANKS                                                       CFT017
     C                     GOTO ENBISO                                                        CFT017
     C                     ENDIF                                                              CFT017
      *                                                                                       CFT017
     C                     SELEC                                                              CFT017
      *                                                                                       CFT017
      ** Get ISO Country code via SWIFT Id.                                                   CFT017
      *                                                                                       CFT017
     C           A8BTID    WHNE *BLANKS                                                       CFT017
     C           2         SUBSTA8BTID:5  WCNCD                                               CFT017
      *                                                                                       CFT017
      ** No SWIFT Id., get ISO Country code via location code.                                CFT017
      *                                                                                       CFT017
     C           A8LCCD    WHNE *BLANK                                                        CFT017
     C                     MOVELA8LCCD    WLCCD   3                                           CFT017
     C                     MOVE 'L'       WACCS                                               CFT017
     C                     EXSR SRACCS                                                        CFT017
     C           PRTCD     IFNE *BLANKS                                                       CFT017
     C                     GOTO ENBISO                                                        CFT017
     C                     ENDIF                                                              CFT017
     C                     MOVELDVCNCD    WCNCD                                               CFT017
     C                     MOVE 'O'       WACCS                                               CFT017
     C                     EXSR SRACCS                                                        CFT017
     C           PRTCD     IFNE *BLANKS                                                       CFT017
     C                     MOVEL*BLANKS   WCNCD                                               CFT017
     C                     GOTO ENBISO                                                        CFT017
     C                     ENDIF                                                              CFT017
      *                                                                                       CFT017
      ** Otherwise, use customer number to derive the ISO Country Code.                       CFT017
      *                                                                                       CFT017
     C                     OTHER                                                              CFT017
     C                     MOVELA8BICN    WWCUS                                               CFT017
     C                     MOVE 'C'       WACCS                                               CFT017
     C                     EXSR SRACCS                                                        CFT017
     C           PRTCD     IFNE *BLANKS                                                       CFT017
     C                     GOTO ENBISO                                                        CFT017
     C                     ENDIF                                                              CFT017
      *                                                                                       CFT017
     C           BBCSID    IFNE *BLANK                                                        CFT017
     C           2         SUBSTBBCSID:5  WCNCD                                               CFT017
     C                     ELSE                                                               CFT017
      *                                                                                       CFT017
      ** No SWIFT id, get country code                                                        CFT017
      ** Get ISO Country Code via access object AOCTRYR0                                      CFT017
     C                     MOVELBBCOLC    WCNCD                                               CFT017
     C                     MOVE 'O'       WACCS                                               CFT017
     C                     EXSR SRACCS                                                        CFT017
     C           PRTCD     IFNE *BLANKS                                                       CFT017
     C                     MOVEL*BLANKS   WCNCD                                               CFT017
     C                     GOTO ENBISO                                                        CFT017
     C                     ENDIF                                                              CFT017
     C                     ENDIF                                                              CFT017
      *                                                                                       CFT017
     C                     ENDSL                                                              CFT017
      *                                                                                       CFT017
     C           WCNCD     IFNE *BLANKS                                                       CFT017
     C                     EXSR SRCNCD                                                        CFT017
     C                     ENDIF                                                              CFT017
      *                                                                                       CFT017
     C           ENBISO    ENDSR                                                              CFT017
      *****************************************************************                       CFT017
     C/EJECT                                                                                  CFT017
      *****************************************************************                       CFT017
      *                                                               *                       CFT017
      *  SRCSID - Determine SWIFT id                                  *                       CFT017
      *                                                               *                       CFT017
      *  Called By: SRMIF                                             *                       CFT017
      *             SRSISO                                            *                       CFT017
      *                                                               *                       CFT017
      *****************************************************************                       CFT017
     C           SRCSID    BEGSR                                                              CFT017
      *                                                                                       CFT017
     C                     MOVEL*BLANKS   WWCUS  10                                           CFT017
     C                     MOVEL*BLANKS   WCSID  11                                           CFT017
     C                     MOVELWSNDID    WSLSH   1                                           CFT017
     C                     MOVELWSNDID    WSNDIB 35                                           CFT017
      *                                                                                       CFT017
     C           WSLSH     IFEQ '/'                                                           CFT017
     C           WSNDI2    ANDNE*BLANKS                                                       CFT017
     C                     MOVELWSNDI2    WSNDID                                              CFT017
     C                     ENDIF                                                              CFT017
      *                                                                                       CFT017
     C                     SELEC                                                              CFT017
      *                                                                                       CFT017
      ** Nostro                                                                               CFT017
     C           WSNDTP    WHEQ 'F'                                                           CFT017
     C           WSNDTP    OREQ 'N'                                                           CFT017
      *                                                                                       CFT017
     C           WSNDTP    IFEQ 'F'                                                           CFT017
     C                     MOVELWSNDID    PCYCD                                               CFT017
     C           2         SUBSTWSNDID:4  PNONB                                               CFT017
     C                     ELSE                                                               CFT017
     C                     MOVELWSNDID    PNONB                                               CFT017
     C                     ENDIF                                                              CFT017
     C                     MOVEL'N'       WACCS                                               CFT017
     C                     EXSR SRACCS                                                        CFT017
     C           PRTCD     IFEQ *BLANKS                                                       CFT017
     C                     MOVELA7CUST    WWCUS                                               CFT017
     C                     ENDIF                                                              CFT017
      *                                                                                       CFT017
      ** Retail                                                                               CFT017
     C           WSNDTP    WHEQ 'R'                                                           CFT017
     C                     MOVE *BLANKS   PPSTR  35                                           CFT017
     C                     MOVELWSNDID    PPSTR                                               CFT017
     C                     MOVEL'A'       WACCS                                               CFT017
     C                     EXSR SRACCS                                                        CFT017
     C           PRTCD     IFEQ *BLANKS                                                       CFT017
     C                     MOVELIFCNUM    WWCUS                                               CFT017
     C                     ENDIF                                                              CFT017
      *                                                                                       CFT017
      ** Customer                                                                             CFT017
     C           WSNDTP    WHEQ 'C'                                                           CFT017
     C                     MOVELWSNDID    WWCUS                                               CFT017
      *                                                                                       CFT017
      ** Full account/partial account                                                         CFT017
     C           WSNDTP    WHEQ 'G'                                                           CFT017
     C           WSNDTP    OREQ 'P'                                                           CFT017
     C           6         SUBSTWSNDID:1  WWCUS                                               CFT017
      *                                                                                       CFT017
      ** SWIFT id                                                                             CFT017
     C           WSNDTP    WHEQ 'S'                                                           CFT017
     C                     MOVELWSNDID    WCSID                                               CFT017
     C           2         SUBSTWCSID:5   WCNCD   2                                           CFT017
      *                                                                                       CFT017
      ** IBAN or Address                                                                      CFT017
     C           WSNDTP    WHEQ 'I'                                                           CFT017
     C           WSNDTP    OREQ 'A'                                                           CFT017
     C           WSLSH     IFEQ '/'                                                           CFT017
     C           34        SUBSTWSNDIB:2  PIBN                                                CFT017
     C                     ELSE                                                               CFT017
     C                     MOVELWSNDIB    PIBN                                                CFT017
     C                     ENDIF                                                              CFT017
     C                     MOVEL'I'       WACCS                                               CFT017
     C                     EXSR SRACCS                                                        CFT017
     C           PRTCD     IFEQ *BLANKS                                                       CFT017
     C                     MOVELIFCNUM    WWCUS                                               CFT017
     C                     ENDIF                                                              CFT017
      *                                                                                       CFT017
     C                     ENDSL                                                              CFT017
      *                                                                                       CFT017
     C                     MOVEL*BLANKS   WSNDID                                              CFT017
     C                     MOVEL*BLANKS   WSNDI2                                              CFT017
      *                                                                                       CFT017
      ** If customer is entered, check if there is SWIFT Id                                   CFT017
      ** attached to it.                                                                      CFT017
      *                                                                                       CFT017
     C           WWCUS     IFNE *BLANKS                                                       CFT017
     C                     MOVEL'C'       WACCS                                               CFT017
     C                     EXSR SRACCS                                                        CFT017
     C           PRTCD     IFNE *BLANKS                                                       CFT017
     C                     GOTO ENCSID                                                        CFT017
     C                     ENDIF                                                              CFT017
      *                                                                                       CFT017
     C           BBCSID    IFNE *BLANKS                                                       CFT017
     C                     MOVELBBCSID    WCSID                                               CFT017
     C           2         SUBSTWCSID:5   WCNCD                                               CFT017
     C                     ELSE                                                               CFT017
      *                                                                                       CFT017
      ** No SWIFT id, get country code                                                        CFT017
      ** Get ISO Country Code via access object AOCTRYR0                                      CFT017
     C           WSISO     IFEQ 'Y'                                                           CFT017
     C                     MOVELBBCOLC    WCNCD                                               CFT017
     C                     MOVE 'O'       WACCS                                               CFT017
     C                     EXSR SRACCS                                                        CFT017
     C           PRTCD     IFNE *BLANKS                                                       CFT017
     C                     MOVEL*BLANKS   WCNCD                                               CFT017
     C                     ENDIF                                                              CFT017
     C                     ENDIF                                                              CFT017
      *                                                                                       CFT017
     C                     ENDIF                                                              CFT017
     C                     ENDIF                                                              CFT017
      *                                                                                       CFT017
      ** Get ISO country code                                                                 CFT017
      *                                                                                       CFT017
     C           WCNCD     IFNE *BLANKS                                                       CFT017
     C           WSISO     ANDEQ'Y'                                                           CFT017
     C                     EXSR SRCNCD                                                        CFT017
     C                     ENDIF                                                              CFT017
      *                                                                                       CFT017
     C           ENCSID    ENDSR                                                              CFT017
      *                                                                                       CFT017
      *****************************************************************                       CFT017
     C/EJECT                                                                                  CFT017
      *****************************************************************                       CFT017
      *                                                               *                       CFT017
      *  SRACCS - Process using access object                         *                       CFT017
      *                                                               *                       CFT017
      *  Called By: SRMIF                                             *                       CFT017
      *             SRSISO                                            *                       CFT017
      *             SRBISO                                            *                       CFT017
      *             SRCSID                                            *                       CFT017
      *                                                               *                       CFT017
      *****************************************************************                       CFT017
     C           SRACCS    BEGSR                                                              CFT017
      *                                                                                       CFT017
      ** Access detail file according to access indicator                                     CFT017
      *                                                                                       CFT017
     C                     SELEC                                                              CFT017
      *                                                                                       CFT017
      ** Customer                                                                             CFT017
     C           WACCS     WHEQ 'C'                                                           CFT017
     C                     CALL 'AOCUSTR0'                                                    CFT017
     C                     PARM *BLANKS   PRTCD                                               CFT017
     C                     PARM '*KEY   ' POPTN                                               CFT017
     C                     PARM WWCUS     PKEY1  10                                           CFT017
     C                     PARM *BLANKS   PKYST   7                                           CFT017
     C           SDCUST    PARM SDCUST    DSSDY                                               CFT017
      *                                                                                       CFT017
      ** Nostro                                                                               CFT017
     C           WACCS     WHEQ 'N'                                                           CFT017
     C                     CALL 'AONOSTR0'                                                    CFT017
     C                     PARM *BLANKS   PRTCD   7                                           CFT017
     C                     PARM '*KEY   ' POPTN   7                                           CFT017
     C                     PARM *BLANKS   PCNOM   6                                           CFT017
     C                     PARM           PCYCD   3                                           CFT017
     C**********           PARM *BLANKS   PACCN   4                                    CFT017 CGL029
     C                     PARM *BLANKS   PACCN  10                                           CGL029
     C                     PARM *BLANKS   PACSN   2                                           CFT017
     C                     PARM           PNONB   2                                           CFT017
     C                     PARM *BLANKS   PBRCD   3                                           CFT017
     C                     PARM *BLANKS   PCSSN  10                                           CFT017
     C                     PARM *BLANKS   PPNOI   1                                           CFT017
     C           SDNOST    PARM SDNOST    DSFDY                                               CFT017
      *                                                                                       CFT017
      ** Location                                                                             CFT017
     C           WACCS     WHEQ 'L'                                                           CFT017
     C                     CALL 'AOLOCNR0'                                                    CFT017
     C                     PARM *BLANKS   PRTCD                                               CFT017
     C                     PARM '*KEY   ' POPTN                                               CFT017
     C                     PARM WLCCD     PLOCN   3                                           CFT017
     C           SDLOCN    PARM SDLOCN    DSFDY                                               CFT017
      *                                                                                       CFT017
      ** Country Code                                                                         CFT017
     C           WACCS     WHEQ 'O'                                                           CFT017
     C                     CALL 'AOCTRYR0'                                                    CFT017
     C                     PARM *BLANKS   PRTCD                                               CFT017
     C                     PARM '*KEY   ' POPTN                                               CFT017
     C                     PARM WCNCD     PCTCD   2                                           CFT017
     C           SDCTRY    PARM SDCTRY    DSFDY                                               CFT017
      *                                                                                       CFT017
      ** Branch                                                                               CFT017
     C           WACCS     WHEQ 'B'                                                           CFT017
     C**********           CALL 'AOBRCHR0'                                             CFT017 CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM *BLANKS   PRTCD                                               CFT017
     C                     PARM '*KEY   ' POPTN                                               CFT017
     C                     PARM WMBRCA    PBRCD   3                                           CFT017
     C********** SDBRCH    PARM SDBRCH    DSFDY                                        CFT017 CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
      *                                                                                       CFT017
      ** Branch                                                                               CFT017
     C           WACCS     WHEQ 'A'                                                           CFT017
     C                     CALL 'AOACCTV1'                                                    CFT017
     C                     PARM *BLANKS   PRTCD                                               CFT017
     C                     PARM *BLANKS   POPTN                                               CFT017
     C                     PARM           PPSTR                                               CFT017
     C           ACCINF    PARM *BLANKS   DSSDY                                               CFT017
      *                                                                                       CFT017
      ** IBAN                                                                                 CFT017
     C           WACCS     WHEQ 'I'                                                           CFT017
     C                     CALL 'AOIBANR2'                                                    CFT017
     C                     PARM *BLANKS   PRTCD                                               CFT017
     C                     PARM           PIBN   34                                           CFT017
     C           ACCINF    PARM *BLANKS   DSSDY                                               CFT017
      *                                                                                       CFT017
     C                     ENDSL                                                              CFT017
      *                                                                                       CFT017
     C                     ENDSR                                                              CFT017
      *                                                                                       CFT017
      *****************************************************************                       CFT017
     C/EJECT                                                                                  CFT017
      *****************************************************************                       CFT017
      *                                                               *                       CFT017
      *  SRCNCD - Get country code                                    *                       CFT017
      *                                                               *                       CFT017
      *  Called By: SRCSID                                            *                       CFT017
      *             SRBISO                                            *                       CFT017
      *                                                               *                       CFT017
      *****************************************************************                       CFT017
     C           SRCNCD    BEGSR                                                              CFT017
      *                                                                                       CFT017
      ** Get ISO country code. Country must be an EEA member.                                 CFT017
      *                                                                                       CFT017
     C           WCNCD     CHAINMEISOCL1             01                                       CFT017
      *                                                                                       CFT017
     C           *IN01     IFEQ *ON                                                           CFT017
     C           M3EEAM    ORNE 'Y'                                                           CFT017
     C                     MOVEL*BLANKS   WCNCD                                               CFT017
     C                     ENDIF                                                              CFT017
      *                                                                                       CFT017
     C                     ENDSR                                                              CFT017
      *****************************************************************                       CFT017
     C/EJECT                                                                                  CFT017
      *****************************************************************                       CFT017
      *                                                               *                       CFT017
      *  SRM103 - Determine if source of payment is MT103             *                       CFT017
      *                                                               *                       CFT017
      *  Called By: SRMIF                                             *                       CFT017
      *                                                               *                       CFT017
      *****************************************************************                       CFT017
     C           SRM103    BEGSR                                                              CFT017
      *                                                                                       CFT017
     C                     MOVE *BLANK    WM103   1                                           CFT017
     C                     MOVE *BLANK    WBTBK                                               CFT017
     C                     MOVE *BLANKS   WCSID                                               CFT017
     C                     MOVE *BLANKS   WWCUS                                               CFT017
      *                                                                                       CFT017
      ** Check if beneficiary is a non-bank. At this stage,                                   CFT017
      ** beneficiary could only be an IBAN account.                                           CFT017
      *                                                                                       CFT017
     C           PRTCD     IFEQ *BLANKS                                                       CFT017
     C                     MOVELIFCNUM    WWCUS                                               CFT017
     C                     MOVEL'C'       WACCS                                               CFT017
     C                     EXSR SRACCS                                                        CFT017
     C                     ENDIF                                                              CFT017
      *                                                                                       CFT017
     C           PRTCD     IFNE *BLANKS                                                       CFT017
     C           BBBNBI    OREQ 'Y'                                                           CFT017
      *                                                                                       CFT017
     C                     MOVEL*BLANKS   WWCUS                                               CFT017
     C                     SELEC                                                              CFT017
     C           F4ORCT    WHEQ 'C'                                                           CFT017
     C                     MOVELS4ORC1    W#C1    1                                           CFT032
     C           W#C1      IFEQ '/'                                                           CFT032
     C                     MOVELS4ORC2    WWCUS                                               CFT032
     C                     ELSE                                                               CFT032
     C                     MOVELS4ORC1    WWCUS                                               CFT017
     C                     ENDIF                                                              CFT032
     C           F4ORCT    WHEQ 'S'                                                           CFT017
     C                     MOVELS4ORC1    W#C1                                                CFT032
     C           W#C1      IFEQ '/'                                                           CFT032
     C                     MOVELS4ORC2    WCSID                                               CFT032
     C                     ELSE                                                               CFT032
     C                     MOVELS4ORC1    WCSID                                               CFT017
     C                     ENDIF                                                              CFT032
     C                     OTHER                                                              CFT017
     C                     GOTO ENM103                                                        CFT017
     C                     ENDSL                                                              CFT017
      *                                                                                       CFT017
      ** Ordering cust entered is a SWIFT id. Get customer                                    CFT017
      ** attached to it.                                                                      CFT017
      *                                                                                       CFT017
     C           WCSID     IFNE *BLANKS                                                       CFT017
     C                     EXSR SR1400                                                        CFT017
     C           PCNUM     IFEQ 'Y'                                                           CFT017
     C           BBBNBI    IFEQ 'Y'                                                           CFT017
     C                     GOTO ENM103                                                        CFT017
     C                     ENDIF                                                              CFT017
     C                     ELSE                                                               CFT017
     C           PCNST     IFEQ 'Y'                                                           CFT017
     C                     MOVELAWCSN1    WWCUS                                               CFT017
     C                     MOVE AWCSN2    WWCUS                                               CFT017
     C                     ELSE                                                               CFT017
     C                     GOTO ENM103                                                        CFT017
     C                     ENDIF                                                              CFT017
     C                     ENDIF                                                              CFT017
     C                     ENDIF                                                              CFT017
      *                                                                                       CFT017
     C           WWCUS     IFNE *BLANKS                                                       CFT017
     C                     MOVEL'C'       WACCS                                               CFT017
     C                     EXSR SRACCS                                                        CFT017
     C           PRTCD     IFNE *BLANKS                                                       CFT017
     C           BBBNBI    OREQ 'Y'                                                           CFT017
     C                     GOTO ENM103                                                        CFT017
     C                     ENDIF                                                              CFT017
     C                     ENDIF                                                              CFT017
      *                                                                                       CFT017
     C                     ENDIF                                                              CFT017
      *                                                                                       CFT017
      ** Check if any of these fields are entered as a SWIFT BIC or                           CFT017
      ** input can be linked to a SWIFT BIC.                                                  CFT017
      ** 1. Ordering bank                                                                     CFT017
      ** 2. Sender's Correspondent                                                            CFT017
      ** 3. Receiver's Correspondent                                                          CFT017
      ** 4. Intermediary                                                                      CFT017
      ** 5. Account with Bank                                                                 CFT017
      *                                                                                       CFT017
     C                     EXSR SRSBIC                                                        CFT017
      *                                                                                       CFT017
      ** If SWIFT id is present, check if it exists in BIC directory                          CFT017
      *                                                                                       CFT017
     C           WCSID     IFEQ *BLANKS                                                       CFT017
     C                     GOTO ENM103                                                        CFT017
     C                     ENDIF                                                              CFT017
      *                                                                                       CFT017
      ** Intruction code fields may only contain SDVA, INTC and CORT                          CFT017
      *                                                                                       CFT017
     C           P23E      IFNE *BLANKS                                                       CFT017
      *                                                                                       CFT017
     C           S6INC1    IFNE *BLANKS                                                       CFT017
     C           S6INC1    ANDNE'SDVA'                                                        CFT017
     C           S6INC1    ANDNE'CORT'                                                        CFT017
     C           S6INC1    ANDNE'INTC'                                                        CFT017
     C                     GOTO ENM103                                                        CFT017
     C                     ENDIF                                                              CFT017
      *                                                                                       CFT017
     C           S6INC2    IFNE *BLANKS                                                       CFT017
     C           S6INC2    ANDNE'SDVA'                                                        CFT017
     C           S6INC2    ANDNE'CORT'                                                        CFT017
     C           S6INC2    ANDNE'INTC'                                                        CFT017
     C                     GOTO ENM103                                                        CFT017
     C                     ENDIF                                                              CFT017
      *                                                                                       CFT017
     C           S6INC3    IFNE *BLANKS                                                       CFT017
     C           S6INC3    ANDNE'SDVA'                                                        CFT017
     C           S6INC3    ANDNE'CORT'                                                        CFT017
     C           S6INC3    ANDNE'INTC'                                                        CFT017
     C                     GOTO ENM103                                                        CFT017
     C                     ENDIF                                                              CFT017
      *                                                                                       CFT017
     C           S6INC4    IFNE *BLANKS                                                       CFT017
     C           S6INC4    ANDNE'SDVA'                                                        CFT017
     C           S6INC4    ANDNE'CORT'                                                        CFT017
     C           S6INC4    ANDNE'INTC'                                                        CFT017
     C                     GOTO ENM103                                                        CFT017
     C                     ENDIF                                                              CFT017
      *                                                                                       CFT017
     C           S6INC5    IFNE *BLANKS                                                       CFT017
     C           S6INC5    ANDNE'SDVA'                                                        CFT017
     C           S6INC5    ANDNE'CORT'                                                        CFT017
     C           S6INC5    ANDNE'INTC'                                                        CFT017
     C                     GOTO ENM103                                                        CFT017
     C                     ENDIF                                                              CFT017
      *                                                                                       CFT017
     C                     ENDIF                                                              CFT017
      *                                                                                       CFT017
      ** Bank to Bank info                                                                    CFT017
      *                                                                                       CFT017
     C                     MOVELS6BTB1    WWBTBK 35                                           CFT017
     C                     EXSR SRBTBK                                                        CFT017
     C           WBTBK     IFNE 'Y'                                                           CFT017
     C                     GOTO ENM103                                                        CFT017
     C                     ENDIF                                                              CFT017
      *                                                                                       CFT017
     C                     MOVELS6BTB2    WWBTBK                                              CFT017
     C                     EXSR SRBTBK                                                        CFT017
     C           WBTBK     IFNE 'Y'                                                           CFT017
     C                     GOTO ENM103                                                        CFT017
     C                     ENDIF                                                              CFT017
      *                                                                                       CFT017
     C                     MOVELS6BTB3    WWBTBK                                              CFT017
     C                     EXSR SRBTBK                                                        CFT017
     C           WBTBK     IFNE 'Y'                                                           CFT017
     C                     GOTO ENM103                                                        CFT017
     C                     ENDIF                                                              CFT017
      *                                                                                       CFT017
     C                     MOVELS6BTB4    WWBTBK                                              CFT017
     C                     EXSR SRBTBK                                                        CFT017
     C           WBTBK     IFNE 'Y'                                                           CFT017
     C                     GOTO ENM103                                                        CFT017
     C                     ENDIF                                                              CFT017
      *                                                                                       CFT017
     C                     MOVELS6BTB5    WWBTBK                                              CFT017
     C                     EXSR SRBTBK                                                        CFT017
     C           WBTBK     IFNE 'Y'                                                           CFT017
     C                     GOTO ENM103                                                        CFT017
     C                     ENDIF                                                              CFT017
      *                                                                                       CFT017
     C                     MOVELS6BTB6    WWBTBK                                              CFT017
     C                     EXSR SRBTBK                                                        CFT017
     C           WBTBK     IFNE 'Y'                                                           CFT017
     C                     GOTO ENM103                                                        CFT017
     C                     ENDIF                                                              CFT017
      *                                                                                       CFT017
      ** If all conditions were satisfied, set ind to 'Y'                                     CFT017
      *                                                                                       CFT017
     C                     MOVEL'Y'       WM103                                               CFT017
      *                                                                                       CFT017
     C           ENM103    ENDSR                                                              CFT017
      *****************************************************************                       CFT017
     C/EJECT                                                                                  CFT017
      *****************************************************************                       CFT017
      *                                                               *                       CFT017
      *  SRSBIC - Check if field is attached to SWIFT BIC             *                       CFT017
      *                                                               *                       CFT017
      *  Called By: SRM103                                            *                       CFT017
      *                                                               *                       CFT017
      *****************************************************************                       CFT017
     C           SRSBIC    BEGSR                                                              CFT017
      *                                                                                       CFT017
      ** Ordering bank is SWIFT id                                                            CFT017
     C                     MOVELF4ORBT    WSNDTP                                              CFT017
     C           F4ORBT    IFEQ 'R'                                                           CFT017
     C                     MOVELS4ORBK    WSND10 10                                           CFT017
     C                     MOVELWSND10    WSNDID                                              CFT017
     C                     ELSE                                                               CFT017
     C                     MOVELS4ORBK    WSNDID                                              CFT017
     C                     ENDIF                                                              CFT017
     C           F4ORBT    IFEQ 'N'                                                           CFT017
     C                     MOVELS4SMCY    PCYCD                                               CFT017
     C                     ENDIF                                                              CFT017
     C                     EXSR SRCSID                                                        CFT017
     C                     EXSR SR1400                                                        CFT017
     C           WCSID     IFNE *BLANKS                                                       CFT017
     C                     GOTO ENSBIC                                                        CFT017
     C                     ENDIF                                                              CFT017
      *                                                                                       CFT017
      ** Sender's Correspondent is SWIFT id                                                   CFT017
     C                     MOVELF4SNCT    WSNDTP                                              CFT017
     C                     MOVELS4SNCO    WSNDID                                              CFT017
     C                     EXSR SRCSID                                                        CFT017
     C                     EXSR SR1400                                                        CFT017
     C           WCSID     IFNE *BLANKS                                                       CFT017
     C                     GOTO ENSBIC                                                        CFT017
     C                     ENDIF                                                              CFT017
      *                                                                                       CFT017
      ** Receiver's correspondent                                                             CFT017
     C                     MOVELF5RCOT    WSNDTP                                              CFT017
     C                     MOVELS5RCO1    WSNDID                                              CFT017
     C                     MOVELS5RCO2    WSNDI2                                              CFT017
     C           F5RCOT    IFEQ 'N'                                                           CFT017
     C                     MOVELS4SMCY    PCYCD                                               CFT017
     C                     ENDIF                                                              CFT017
     C                     EXSR SRCSID                                                        CFT017
     C                     EXSR SR1400                                                        CFT017
     C           WCSID     IFNE *BLANKS                                                       CFT017
     C                     GOTO ENSBIC                                                        CFT017
     C                     ENDIF                                                              CFT017
      *                                                                                       CFT017
      ** Third Reimbursement Institution                                                      CFT017
     C                     MOVELF5TRIT    WSNDTP                                              CFT017
     C                     MOVELS5TRI1    WSNDID                                              CFT017
     C                     MOVELS5TRI2    WSNDI2                                              CFT017
     C                     EXSR SRCSID                                                        CFT017
     C                     EXSR SR1400                                                        CFT017
     C           WCSID     IFNE *BLANKS                                                       CFT017
     C                     GOTO ENSBIC                                                        CFT017
     C                     ENDIF                                                              CFT017
      *                                                                                       CFT017
      ** Intermediary                                                                         CFT017
     C                     MOVELF5INBT    WSNDTP                                              CFT017
     C                     MOVELS5IBK1    WSNDID                                              CFT017
     C                     MOVELS5IBK2    WSNDI2                                              CFT017
     C                     EXSR SRCSID                                                        CFT017
     C                     EXSR SR1400                                                        CFT017
     C           WCSID     IFNE *BLANKS                                                       CFT017
     C                     GOTO ENSBIC                                                        CFT017
     C                     ENDIF                                                              CFT017
      *                                                                                       CFT017
      ** Account with Bank                                                                    CFT017
     C                     MOVELF5ACBT    WSNDTP                                              CFT017
     C                     MOVELS5ACB1    WSNDID                                              CFT017
     C                     MOVELS5ACB2    WSNDI2                                              CFT017
     C           F5ACBT    IFEQ 'N'                                                           CFT017
     C                     MOVELS4PCCY    PCYCD                                               CFT017
     C                     ENDIF                                                              CFT017
     C                     EXSR SRCSID                                                        CFT017
     C                     EXSR SR1400                                                        CFT017
      *                                                                                       CFT017
     C           ENSBIC    ENDSR                                                              CFT017
      *                                                                                       CFT017
      *****************************************************************                       CFT017
     C/EJECT                                                                                  CFT017
      *****************************************************************                       CFT017
      *                                                               *                       CFT017
      *  SR1400 - Call ME1400 to check valid SWIFT address            *                       CFT017
      *                                                               *                       CFT017
      *  Called By: SRSBIC                                            *                       CFT017
      *             SRBTBK                                            *                       CFT017
      *                                                               *                       CFT017
      *****************************************************************                       CFT017
     C           SR1400    BEGSR                                                              CFT017
      *                                                                                       CFT017
     C           WCSID     IFNE *BLANKS                                                       CFT017
      *                                                                                       CFT017
     C                     MOVELWCSID     PBICC   8                                           CFT017
     C                     MOVE WCSID     PBICB   3                                           CFT017
      *                                                                                       CFT017
     C                     CALL 'ME1400'                                                      CFT017
     C                     PARM *BLANKS   PRTCD                                               CFT017
     C                     PARM           PBICC                                               CFT017
     C                     PARM           PBICB                                               CFT017
     C                     PARM           SDCUST                                              CFT017
     C                     PARM           SDCNST                                              CFT017
     C                     PARM           MEBICD                                              CFT017
     C                     PARM *BLANKS   PCNUM   1                                           CFT017
     C                     PARM *BLANKS   PCNST   1                                           CFT017
     C                     PARM *BLANKS   PBICD   1                                           CFT017
      *                                                                                       CFT017
     C           PCNUM     IFNE 'Y'                                                           CFT017
     C           PCNST     ANDNE'Y'                                                           CFT017
     C           PBICD     ANDNE'Y'                                                           CFT017
     C           BDSUBT    OREQ 'BEID'                                                        CFT017
     C           WBTBK     ANDEQ*BLANK                                                        CFT017
     C           BDSUBT    OREQ 'TRCO'                                                        CFT017
     C           WBTBK     ANDEQ*BLANK                                                        CFT017
     C                     MOVE *BLANKS   WCSID                                               CFT017
     C                     ENDIF                                                              CFT017
      *                                                                                       CFT017
     C                     ENDIF                                                              CFT017
      *                                                                                       CFT017
     C                     ENDSR                                                              CFT017
      *                                                                                       CFT017
      *****************************************************************                       CFT017
     C/EJECT                                                                                  CFT017
      *****************************************************************                       CFT017
      *                                                               *                       CFT017
      *  SRBTBK - Check Bank to Bank field                            *                       CFT017
      *                                                               *                       CFT017
      *  Called By: SRM103                                            *                       CFT017
      *                                                               *                       CFT017
      *****************************************************************                       CFT017
     C           SRBTBK    BEGSR                                                              CFT017
      *                                                                                       CFT017
     C                     MOVE 'N'       WBTBK   1                                           CFT017
      *                                                                                       CFT017
      ** It must not contain the codeword /REJT/, /RETN/, nor the ERI                         CFT017
      ** codeword /OCMT/.                                                                     CFT017
      *                                                                                       CFT017
     C           WWBTBK    IFNE *BLANKS                                                       CFT017
     C           '/REJT/'  SCAN WWBTBK                   01                                   CFT017
     C           *IN01     IFEQ *ON                                                           CFT017
     C                     GOTO ENBTBK                                                        CFT017
     C                     ENDIF                                                              CFT017
     C           '/RETN/'  SCAN WWBTBK                   01                                   CFT017
     C           *IN01     IFEQ *ON                                                           CFT017
     C                     GOTO ENBTBK                                                        CFT017
     C                     ENDIF                                                              CFT017
     C           '/OCMT/'  SCAN WWBTBK                   01                                   CFT017
     C           *IN01     IFEQ *ON                                                           CFT017
     C                     GOTO ENBTBK                                                        CFT017
     C                     ENDIF                                                              CFT017
     C                     ENDIF                                                              CFT017
      *                                                                                       CFT017
      ** If field contains /INS/, it should be followed by a SWIFT                            CFT017
      ** address.  The SWIFT address will be validated via call to                            CFT017
      ** ME1400.  It is a SWIFT address if it is found in Customers                           CFT017
      ** file, Counterparty Nostros file, or in BIC Directory.                                CFT017
      *                                                                                       CFT017
     C           WWBTBK    IFNE *BLANKS                                                       CFT017
     C           '/INS/'   SCAN WWBTBK                   01                                   CFT017
     C           *IN01     IFEQ *ON                                                           CFT017
     C           11        SUBSTWWBTBK:6  WCSID                                               CFT017
     C                     EXSR SR1400                                                        CFT017
     C           WCSID     IFEQ *BLANKS                                                       CFT017
     C                     GOTO ENBTBK                                                        CFT017
     C                     ENDIF                                                              CFT017
     C                     ENDIF                                                              CFT017
     C                     ENDIF                                                              CFT017
      *                                                                                       CFT017
     C                     MOVE 'Y'       WBTBK                                               CFT017
      *                                                                                       CFT017
     C           ENBTBK    ENDSR                                                              CFT017
      *****************************************************************                       CFT017
     C/EJECT                                                              CFT014
      *****************************************************************
      *                                                               *
      *  SROPUP   : Outgoing Payements Update                         *
      *                                                               *
      *  CALLED BY: SROTFT - Create Outgoing Payment Transaction      *
      *                                                               *
      *****************************************************************
     CSR         SROPUP    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SROPUP'  @STK,Q
      *
      *  /Copy point for Outgoing Payments Update
      *
     C/COPY WNCPYSRC,FT0300OPUP
      *
      * Get next payment reference
      *
      *
      ***  For Ebanking payment reference will be generated by in-house program             LUC110
     C           LUC110    IFEQ 'Y'                                                         LUC110
     C                     MOVE *BLANKS   W#PIDT           Payment Identif                  LUC110
     C                     Z-ADDAGRDNB    W#RUND           Run day number                   LUC110
     C                     MOVE *BLANKS   W#PREF           Payment Reference                LUC110
      *                                                                                     LUC110
     C           EBANKC    SCAN WP23E                    73                                 LUC110
      *                                                                                     LUC110
     C           *IN73     IFEQ '1'                                                         LUC110
     C                     MOVE 'E'       W#PIDT                                            LUC110
     C                     Z-ADDAGRDNB    W#RUND                                            LUC110
      *** Call UCI In-house payment reference generator                                     LUC110
     C                     CALL 'CM1210'                                                    LUC110
     C                     PARM *BLANKS   W#RTN                                             LUC110
     C                     PARM           W#PIDT  1        Payment Identif                  LUC110
     C                     PARM           W#RUND  50       Run day number                   LUC110
     C                     PARM           W#PREF 15        Payment Reference                LUC110
     C                     ENDIF                                                            LUC110
      *                                                                                     LUC110
      *                                                                                     LUC110
      **  Ebanking Payment starts with different letter than 'P'                            LUC110
     C           *IN73     IFEQ '1'                                                         LUC110
     C           W#PREF    ANDNE*BLANKS                                                     LUC110
     C                     MOVELW#PREF    PREF                                              LUC110
     C                     ELSE                                                             LUC110
      **  Ebanking but payment reference not generated - Get normally referenc              LUC110
     C                     EXSR SROPRF                                                      LUC110
     C                     ENDIF                                                            LUC110
      *                                                                                     LUC110
     C                     ELSE                                                             LUC110
      *
     C                     EXSR SROPRF
      *
     C                     ENDIF                                                            LUC110
      *                                                                                     LUC110
      * Move all fields to @OTPAYL0
      *
     C                     EXSR SRMVOT
      *
      * Check for duplicate primary key
      *
     C/COPY WNCPYSRC,FT0300C025
     C           KPREF     SETLL@OTPAYL0                 90*
     C           *IN90     IFEQ '1'
     C                     Z-ADD14        W0ERNB           **************
     C                     MOVEL'OTPAYL1 'W0FILE           *DB ERROR 14 *
     C                     MOVELPREF      W0KEY            **************
     C                     MOVEL'MEM5002' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C***********          EXSR SRERR                                     130869
     C                     EXSR SRERRA                                    130869
     C                     END
     C/COPY WNCPYSRC,FT0300C002
      *                                                                                       CSD015
     C           WLOPIN    IFEQ 'Y'                                                           CSD015
     C           CSC011    IFEQ 'N'                                                           CSD015
     C           S1MAIN    OREQ LIBR                                                          CSD015
     C                     EXSR SROPWT                                                        CSD015
     C                     ENDIF                                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                     BUG26009
     C                     CALL 'ZAGENTS'                                                   BUG26009
     C                     PARM           TMST                                              BUG26009
      *                                                                   MK0519
     C                     Z-ADDRATE      RATED                           MK0519
      *                                                                   MK0519
     C                     CALL 'AOCURRR0'                                MK0519
     C                     PARM *BLANKS   P@RTCD                          MK0519
     C                     PARM '*KEY    'P@OPTN                          MK0519
     C                     PARM SMCY      WCURR   3                       MK0519
     C           SDCURR    PARM SDCURR    DSSDY                           MK0519
      *                                                                   MK0519
     C           P@RTCD    IFNE *BLANKS                                   MK0519
     C                     MOVEL'AOCURRR0'W0FILE                          MK0519
     C                     MOVEL'*CALL'   W0KEY            ************   MK0519
     C                     Z-ADD62        W0ERNB           * DBERR 62 *   MK0519
     C                     MOVEL'MEM5003' W0MSGD           ************   MK0519
     C                     MOVEL'MIDAS  ' W0MSGF                          MK0519
     C                     EXSR SRERRA                                    MK0519
     C                     ELSE                                           MK0519
     C           A6NBDP    ADD  1         N       10                      MK0519
     C           SMAM      DIV  AP,N      SMAMD                           MK0519
     C                     ENDIF                                          MK0519
      *                                                                   MK0519
     C                     CALL 'AOCURRR0'                                MK0519
     C                     PARM *BLANKS   P@RTCD                          MK0519
     C                     PARM '*KEY    'P@OPTN                          MK0519
     C                     PARM PCCY      WCURR   3                       MK0519
     C           SDCURR    PARM SDCURR    DSSDY                           MK0519
      *                                                                   MK0519
     C           P@RTCD    IFNE *BLANKS                                   MK0519
     C                     MOVEL'AOCURRR0'W0FILE                          MK0519
     C                     MOVEL'*CALL'   W0KEY            ************   MK0519
     C                     Z-ADD63        W0ERNB           * DBERR 63 *   MK0519
     C                     MOVEL'MEM5003' W0MSGD           ************   MK0519
     C                     MOVEL'MIDAS  ' W0MSGF                          MK0519
     C                     EXSR SRERRA                                    MK0519
     C                     ELSE                                           MK0519
     C           A6NBDP    ADD  1         N       10                      MK0519
     C           PYAM      DIV  AP,N      PYAMD                           MK0519
     C                     ENDIF                                          MK0519
      *                                                                   MK0519
      *
      ****  EBanking changes                                                                LUC110
     C           LUC110    IFEQ 'Y'                                                         LUC110
      *                                                                                     LUC110
     C                     MOVE *BLANKS   W#RTN            Return                           LUC110
     C                     MOVE *BLANKS   W#ORC1           Ordering Cust                    LUC110
     C                     MOVE *BLANKS   W#SMCY           Settlement Ccy                   LUC110
     C                     Z-ADD*ZEROS    W#SMAM           Settlement Amnt                  LUC110
     C                     MOVE *BLANKS   W#PCCY           Pay Ccy                          LUC110
     C                     Z-ADD*ZEROS    W#PYAM           Pay Amount                       LUC110
     C                     MOVE *BLANKS   W#PIDT           Payment Identif                  LUC110
     C                     MOVE *BLANKS   W#BASC           Base currcency                   LUC110
     C                     MOVE *BLANKS   W#LCCY           Local Currency                   LUC110
     C                     MOVE *BLANKS   W#BNC1           Beneficiary                      LUC110
     C                     MOVE *BLANKS   W#ADDC           Add Deduct In                    LUC110
     C                     MOVE *BLANKS   W#DTCH           Detail of charge                 LUC110
     C                     MOVE *BLANKS   W#TRCT           Trans Comm Tarf                  LUC110
     C                     Z-ADD*ZEROS    W#TRCM           Transfer Comms                   LUC110
     C                     Z-ADD*ZEROS    W#DUMA           Entry Charge                     LUC110
      *                                                                                     LUC110
      *                                                                                     LUC110
      ****  If EBanking payment then apply charges based on UCI's logics                    LUC110
     C           EBANKC    SCAN WP23E                    73                                 LUC110
     C           *IN73     IFEQ '1'                                                         LUC110
     C                     MOVE 'E'       W#PIDT  1                                         LUC110
     C                     ENDIF
      **** Call in-house program to get charges                                             LUC110
     C                     MOVE ORC1      W#ORC1                                            LUC110
     C                     MOVE SMCY      W#SMCY                                            LUC110
     C                     Z-ADDSMAM      W#SMAM                                            LUC110
     C                     MOVE PCCY      W#PCCY                                            LUC110
     C                     Z-ADDPYAM      W#PYAM                                            LUC110
     C                     MOVE BJCYCD    W#BASC                                            LUC110
     C                     MOVE BJLCCY    W#LCCY                                            LUC110
     C                     MOVE BNC1      W#BNC1                                            LUC110
      ** Charges fields processed by in-house program                                       LUC110
     C                     MOVE ADDC      W#ADDC                                            LUC110
     C                     MOVE DTCH      W#DTCH                                            LUC110
     C                     MOVE TRCT      W#TRCT                                            LUC110
     C                     Z-ADDTRCM      W#TRCM                                            LUC110
     C                     Z-ADDDUMA1     W#DUMA                                            LUC110
      *                                                                                     LUC110
     C                     CALL 'CM1200'               90                                   LUC110
     C                     PARM *BLANKS   W#RTN   7        Return                           LUC110
     C                     PARM           W#ORC1 35        Ordering Cust                    LUC110
     C                     PARM           W#SMCY  3        Settlement Ccy                   LUC110
     C                     PARM           W#SMAM 130       Settlement Amnt                  LUC110
     C                     PARM           W#PCCY  3        Pay Ccy                          LUC110
     C                     PARM           W#PYAM 130       Pay Amount                       LUC110
     C                     PARM           W#BASC  3        Base currcency                   LUC110
     C                     PARM           W#LCCY  3        Local Currency                   LUC110
     C                     PARM           W#PIDT  1        Payment Identif                  LUC110
     C                     PARM           W#BNC1 35        Beneficiary                      LUC110
     C                     PARM           W#ADDC  1        Add Deduct In                    LUC110
     C                     PARM           W#DTCH  3        Detail of charge                 LUC110
     C                     PARM           W#TRCT  1        Trans Comm Tarf                  LUC110
     C                     PARM           W#TRCM 110       Transfer Comms                   LUC110
     C                     PARM           W#DUMA 110       Charge in LCCY                   LUC110
      *                                                                                     LUC110
      ** Error on call                                                                      LUC110
     C           *IN90     IFEQ '1'                                                         LUC110
     C           W#RTN     ORNE *BLANKS                                                     LUC110
     C                     MOVEL'CM1200 ' W0FILE           ***************                  LUC110
     C                     MOVEL'*CALL'   W0KEY            * DB ERROR 200*                  LUC110
     C                     Z-ADD200       W0ERNB           ***************                  LUC110
     C                     MOVEL'MEM5003' W0MSGD                                            LUC110
     C                     MOVEL'MIDAS  ' W0MSGF                                            LUC110
     C                     EXSR SRERRA                                                      LUC110
     C                     ENDIF                                                            LUC110
      *                                                                                     LUC110
     C           *IN90     IFNE '1'                                                         LUC110
     C                     Z-ADDW#TRCM    TRCM                                              LUC110
     C                     Z-ADDW#DUMA    DUMA1                                             LUC110
     C                     MOVE W#TRCT    TRCT                                              LUC110
     C                     MOVE W#ADDC    ADDC                                              LUC110
     C                     MOVE W#DTCH    DTCH                                              LUC110
     C                     ENDIF                                                            LUC110
      *                                                                                     LUC110
     C                     ENDIF                                                            LUC110
      *  Write record to database
      *
     C                     WRITE@OTPAYL0
      *                                                                                     BUG25944
     C           CAP185    IFEQ 'Y'                                                         BUG25944
     C                     MOVE *BLANKS   OTFRID                                            BUG25944
     C                     MOVE *BLANKS   OTPREF                                           BUG25944A
     C                     MOVELOPPREF    OTPREF                                           BUG25944A
     C                     MOVELOTFRNT    OTFRID                                            BUG25944
     C                     WRITEOTPAYQD0                                                    BUG25944
     C                     ENDIF                                                            BUG25944
      *                                                                   S01408
     C/COPY WNCPYSRC,FT0300CCP4                                           S01408
      *                                                                   S01408
      *
      *  Update FT Refs network information
      *
     C           *LOCK     IN   MEDTA
     C           PNWRK     IFEQ 'SWIFT '                   Network
     C                     Z-ADDOPMSGR    DAMSO1
     C                     Z-ADDOPKPRT    DAMPO1
     C                     END
      *
      *  /Copy point to allow other network updates
      *
     C/COPY WNCPYSRC,FT0300OFTR
      *
     C                     OUT  MEDTA
      *
      * DBF write successful
      *
      *
      *  Process shadow post if new addition and not regular payment
      *  Or level incomplete i.e. insert of generated payment
      *
     C           PYTP      IFNE 'RP'
     C           LVL1      ANDEQ'Y'
     C                     Z-ADDSMAM      ##SMAM
     C                     Z-ADDPYAM      ##PYAM
     C                     EXSR SRADDO
     C                     END
      *                                                                   CFT014
      ** Shadow postings for charges                                      CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
     C           CFT009    OREQ 'Y'                                       CFT009
     C           PYTP      IFNE 'RP'                                      CFT014
     C           LVL2      ANDEQ'Y'                                       CFT014
     C                     EXSR SPCGOP                                    CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *
      *  Update database with changes
      *
     C                     EXSR SRUPD
      *
      *** EBanking payments - generate shadow posting for the charges.                      LUC110
      *   Call UCI in-house program                                                         LUC110
      *                                                                                     LUC110
     C           LUC110    IFEQ 'Y'                                                         LUC110
      *                                                                                     LUC110
     C           W#PIDT    IFEQ 'E'                                                         LUC110
      **** Call in-house program to generate shadow posting for the charges.                LUC110
     C                     MOVE ORCT      W#ORCT  1                                         LUC110
     C                     Z-ADDSLDT      W#SLDT  50                                        LUC110
     C                     Z-ADDPVDT      W#PVDT  50                                        LUC110
      *                                                                                     LUC110
     C                     CALL 'CM1230'               90                                   LUC110
     C                     PARM *BLANKS   W#RTN                                             LUC110
     C                     PARM           W#PREF                                            LUC110
     C                     PARM           W#ADDC           Add Deduct In                    LUC110
     C                     PARM           W#DTCH           Detail of charge                 LUC110
     C                     PARM           W#ORCT           Ord Cust Type                    LUC110
     C                     PARM           W#ORC1           Ordering Cust                    LUC110
     C                     PARM           W#SMCY           Sett Ccy                         LUC110
     C                     PARM           W#PCCY           Pay Ccy                          LUC110
     C                     PARM           W#TRCM           Transfer Comms                   LUC110
     C                     PARM           W#SLDT           Settl date                       LUC110
     C                     PARM           W#PVDT           Pay Value date                   LUC110
     C                     ENDIF                                                            LUC110
      *                                                                                     LUC110
      ** Error on call                                                                      LUC110
     C           *IN90     IFEQ '1'                                                         LUC110
     C           W#RTN     ORNE *BLANKS                                                     LUC110
     C                     MOVEL'CM1230 ' W0FILE           ***************                  LUC110
     C                     MOVEL'*CALL'   W0KEY            * DB ERROR 200*                  LUC110
     C                     Z-ADD201       W0ERNB           ***************                  LUC110
     C                     MOVEL'MEM5003' W0MSGD                                            LUC110
     C                     MOVEL'MIDAS  ' W0MSGF                                            LUC110
     C                     EXSR SRERRA                                                      LUC110
     C                     ENDIF                                                            LUC110
      *                                                                                     LUC110
     C                     ENDIF                                                            LUC110
      *                                                                                     LUC110
      * Update Trailer
      *
     C           1         CHAINOTPAYZZF             90
     C           *IN90     IFEQ '1'
     C                     Z-ADD15        W0ERNB           **************
     C                     MOVEL'OTPAYZZ 'W0FILE           *DB ERROR 15 *
     C                     MOVEL'*ONLY'   W0KEY            **************
     C                     MOVEL'MEM5002' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C***********          EXSR SRERR                                     130869
     C                     EXSR SRERRA                                    130869
     C                     END
      *
     C           HRWN      MULT 1000      W#TRLR 180
     C                     ADD  HRDC      W#TRLR
     C                     ADD  SMAM      W#TRLR
     C                     ADD  1         NORE1
     C           W#TRLR    DIV  1000      HRWN
     C                     Z-ADDW#TRLR    HRDC
      *
     C                     UPDATOTPAYZZF
      *
      * Update Incoming Message FT Transaction Status File record
      *
     C           OPMSGR    IFNE 0
      *
     C           CFT005    IFEQ 'Y'                                       CFT005
     C           WAUIN     ANDEQ'Y'                                       CFT005
     C                     MOVEL'MIN0032' W0FLAG  7                       CFT005
     C                     ELSE                                           CFT005
     C                     MOVEL'MIN0030' W0FLAG  7
     C                     ENDIF                                          CFT005
      *                                                                   CFT005
     C                     MOVEL'MIN0190' W0LMSG  7
      *
     C                     EXSR SRFTST
      *
     C                     END
     C/COPY WNCPYSRC,FT0300C026
      *
      *  Commit updates
      *
     C                     COMIT
      *
      *
      *
      *  Set up ##OK as Payment Generation successful
      *
     C                     MOVEL'Y'       ##OK
     C/COPY WNCPYSRC,FT0300C071
      *
      *  Unwind subroutine stack name
      *
     C           EXOPUP    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRIPRF   : Get next transaction number                       *
      *                                                               *
      *  CALLED BY: SRINUP - Incoming Payments Update                 *
      *                                                               *
      *****************************************************************
     CSR         SRIPRF    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SRIPRF'  @STK,Q
      *
      *  /Copy point for Incoming Payment Reference
      *
     C/COPY WNCPYSRC,FT0300IPRF
      *
      *  Set fields
      *
     C                     MOVEL'P'       W#P
     C                     MOVELW#YMD     W#MRDT
     C                     MOVELS1PYTP    W#PYTP
     C                     MOVEL'00'      W#STMT
     C/COPY WNCPYSRC,FT0300C062
      *
     C           CFT151    IFEQ 'N'                                                           CFT151
     C           *LOCK     IN   INPAYD
     C**********           Z-ADDISQNM     W#PRNM                                              CFT151
     C                     MOVELISQNM     W#PRNM                                              CFT151
     C                     ADD  1         ISQNM
     C                     OUT  INPAYD
     C                     ELSE                                                               CFT151
     C                     CALL 'FT000328'                                                    CFT151
     C                     PARM           PRTCD                                               CFT151
     C                     PARM 'IN'      W@OTIN  2                                           CFT151
     C                     PARM 'A'       WCALC   1                                           CFT151
     C                     PARM 'Y'       WUPD    1                                           CFT151
     C                     PARM           W#PRNM                                              CFT151
     C                     PARM           WNEWSQ  4                                           CFT151
     C                     ENDIF                                                              CFT151
     C/COPY WNCPYSRC,FT0300C063
      *
     C                     MOVELIPREF     PREF
     C/COPY WNCPYSRC,FTH00081
      *
      *  Unwind subroutine stack name
      *
     C           EXIPRF    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRMVIN   : Move data into Incoming Payments Record           *
      *                                                               *
      *  CALLED BY: SRINUP - Incoming Payments Update                 *
      *                                                               *
      *****************************************************************
     CSR         SRMVIN    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SRMVIN'  @STK,Q
      *
      *  /Copy point for Extension file fields etc
      *
     C/COPY WNCPYSRC,FT0300MVIN
      *
      *  Call standard subroutine
      *                                                                   CFT003
      *  If Batch Authorsation update/add record                          CFT003
      *                                                                   CFT003
     C           CFT003    IFEQ 'CFT003'                                  CFT003
     C           CFT014    OREQ 'Y'                                       CFT003
     C           CFT162    OREQ 'Y'                                                           CFT162
     C/COPY WNCPYSRC,FT0300C027
      *                                                                                       CFT162
     C           CFT162    IFEQ 'Y'                                                           CFT162
      *                                                                                       CFT162
      ** Check From Account Receivers Correspondent or Sender                                 CFT162
      *                                                                                       CFT162
     C                     MOVELV#FRGL    @ACCN                                               CFT162
     C           KYM901    CHAINSDM901L0             60                                       CFT162
     C           *IN60     IFEQ *OFF                                                          CFT162
     C                     MOVELM9R900    WINR90  1                                           CFT162
     C                     ELSE                                                               CFT162
      *                                                                                       CFT162
      ** record not found, check if there is a record for the customer                        CFT162
      *                                                                                       CFT162
     C                     MOVE *BLANKS   @BRCA                                               CFT162
     C                     MOVE *BLANKS   @CCY                                                CFT162
     C                     MOVE *BLANKS   @ACOD                                               CFT162
     C                     MOVE *BLANKS   @ACSQ                                               CFT162
     C           KYM901    CHAINSDM901L0             60                                       CFT162
     C                     ENDIF                                                              CFT162
      *                                                                                       CFT162
     C           *IN60     IFEQ *OFF                                                          CFT162
     C                     MOVELM9R900    WINR90                                              CFT162
     C                     ELSE                                                               CFT162
     C                     MOVEL'N'       WINR90                                              CFT162
     C                     ENDIF                                                              CFT162
      *                                                                                       CFT162
      ** Check to Account (A/C with Bank or Benefeciary)                                      CFT162
      *                                                                                       CFT162
     C                     MOVELV#TOGL    @ACCN                                               CFT162
     C           KYM901    CHAINSDM901L0             60                                       CFT162
     C           *IN60     IFEQ *OFF                                                          CFT162
     C                     MOVELM9R910    WINR91  1                                           CFT162
     C                     ELSE                                                               CFT162
      *                                                                                       CFT162
      ** record not found, check if there is a record for the customer                        CFT162
      *                                                                                       CFT162
     C                     MOVE *BLANKS   @BRCA                                               CFT162
     C                     MOVE *BLANKS   @CCY                                                CFT162
     C                     MOVE *BLANKS   @ACOD                                               CFT162
     C                     MOVE *BLANKS   @ACSQ                                               CFT162
     C           KYM901    CHAINSDM901L0             60                                       CFT162
     C                     ENDIF                                                              CFT162
      *                                                                                       CFT162
     C           *IN60     IFEQ *OFF                                                          CFT162
     C                     MOVELM9R910    WINR91                                              CFT162
     C                     ELSE                                                               CFT162
     C                     MOVEL'N'       WINR91                                              CFT162
     C                     ENDIF                                                              CFT162
      *                                                                                       CFT162
     C                     ENDIF                                                              CFT162
      *                                                                   CFT003
      ** Update extension record to include the Auto-generated            CFT003
      ** indicator                                                        CFT003
      *                                                                   CFT003
     C           PREF      CHAININPAYXL0             90                   CFT003
      *                                                                   CFT003
      * If no existing extension record, insert new one                   CFT003
      *                                                                   CFT003
     C           *IN90     IFEQ '1'                                       CFT003
     C                     MOVEL'D'       INRECI                          CFT003
     C                     MOVELPREF      INPREF                          CFT003
     C                     MOVEL'Y'       INAUTO                          CFT003
     C                     MOVEASTAMP,1   INTMST                                              CFT017
      *                                                                   CFT005
     C           CFT005    IFEQ 'Y'                                       CFT005
     C           WAUIN     ANDEQ'Y'                                       CFT005
     C                     MOVELWUMRDT    INRDAT                          CFT005
     C                     ENDIF                                          CFT005
      *                                                                   CFT003
      ** Fill field related to MT103                                      CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
     C                     EXSR FL103I                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT009
      ** Default charges                                                  CFT009
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
     C                     EXSR MVICHG                                    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT003
     C           CSW209    IFEQ 'Y'                                                           CSW209
     C                     EXSR SRCVIN                                                        CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     CALL 'ZAGENTS'                                                   BUG26009
     C                     PARM           INTMST                                            BUG26009
      *                                                                                     BUG26009
     C           CFT162    IFEQ 'Y'                                                           CFT162
     C                     MOVELWINR90    INR900                                              CFT162
     C                     MOVELWINR91    INR910                                              CFT162
     C                     MOVEL'N'       ING900                                              CFT162
     C                     MOVEL'N'       ING910                                              CFT162
     C                     ENDIF                                                              CFT162
      *                                                                                       CFT162
     C                     WRITEINPAYXDF                                  CFT003
      *                                                                   CFT003
      * If existing extension record, update                              CFT003
      *                                                                   CFT003
     C                     ELSE                                           CFT003
      *                                                                   CFT005
     C           CFT005    IFEQ 'Y'                                       CFT005
     C           WAUIN     ANDEQ'Y'                                       CFT005
     C                     MOVELWUMRDT    INRDAT                          CFT005
     C                     ENDIF                                          CFT005
      *                                                                   CFT003
      ** Fill field related to MT103                                      CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
     C                     EXSR FL103I                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT009
      ** Default charges                                                  CFT009
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
     C                     EXSR MVICHG                                    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT003
     C                     MOVEL'Y'       INAUTO                          CFT003
      *                                                                                       CSW209
     C           CSW209    IFEQ 'Y'                                                           CSW209
     C                     EXSR SRCVIN                                                        CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     CALL 'ZAGENTS'                                                   BUG26009
     C                     PARM           INTMST                                            BUG26009
      *                                                                                     BUG26009
     C           CFT162    IFEQ 'Y'                                                           CFT162
     C           INR900    IFEQ *BLANKS                                                       CFT162
     C                     MOVELWINR90    INR900                                              CFT162
     C                     ENDIF                                                              CFT162
      *                                                                                       CFT162
     C           INR910    IFEQ *BLANKS                                                       CFT162
     C                     MOVELWINR91    INR910                                              CFT162
     C                     ENDIF                                                              CFT162
      *                                                                                       CFT162
     C                     MOVEL'N'       ING900                                              CFT162
     C                     MOVEL'N'       ING910                                              CFT162
     C                     ENDIF                                                              CFT162
      *                                                                                       CFT162
     C                     UPDATINPAYXDF                                  CFT003
      *                                                                   CFT003
     C                     ENDIF                                          CFT003
      *                                                                   CFT003
     C                     ENDIF                                          CFT003
     C/COPY WNCPYSRC,FT0300C013
      *
     C                     MOVEL'D'       RECI
      *
      *  Transaction reference, type and sub-type
      *
     C                     MOVELPREF      PREF
     C                     MOVEL'IN'      PYTP
     C                     MOVELS1PYST    PYST
      *
      *  Sender
      *
     C                     MOVELF1SNTP    SNTP
     C                     MOVELS1SND1    SND1
     C                     MOVELS1SND2    SND2
     C                     MOVELS1SND3    SND3
     C                     MOVELS1SND4    SND4
      *
      *  Receiver's Correspondent account
      *
     C***********          MOVELF1RCRT    RCRT                            192595
     C*********************MOVELS1RCCO    RCCO                            CFT014
      ***Not*filled*when*CFT014*on*because*RCCO*is*numeric*******  CFT014 192595
      ***and*when*CFT014*is*on*receiver*correspondant*can*be*a***  CFT014 192595
      ***SWIFT*adress,*an*adress*....****************************  CFT014 192595
     C***********CFT014    IFEQ 'N'                                CFT014 192595
     C***********          MOVELS1RCO1    WAL10  10                CFT014 192595
     C***********          MOVE WAL10     RCCO                     CFT014 192595
     C***********          ENDIF                                   CFT014 192595
     C*                                                                   192595
     C*  Clear out redundant Receiver's Correspondent fields              192595
     C                     MOVEL*BLANKS   RCRT                            192595
     C***************      Z-ADD0         RCCO                                         192595 CSD027
     C                     MOVE *BLANKS   RCCO                                                CSD027
      *
      *  Account with Institution account
      *
     C                     MOVELF1ACBT    ACBT
     C                     MOVELS1ACBK    ACBK
     C                     MOVELS1ACBB    ACBB
      *
      *  Beneficiary
      *
     C                     MOVELF1BNCT    BNCT
     C                     MOVELS1BNC1    BNC1
     C/COPY WNCPYSRC,FT0300C003
     C                     MOVELS1BNC2    BNC2
     C                     MOVELS1BNC3    BNC3
     C                     MOVELS1BNC4    BNC4
     C                     MOVELS1BNC5    BNC5
      *
      *  Settle amount, value date and currency
      *
     C                     Z-ADDF1SMAM    SMAM
     C                     MOVELS1SMCY    SMCY
     C                     Z-ADDF1SLDT    SLDT
      *
      *  Define date formats
      *
     C                     Z-ADDF1SLDT    W#MDTE
     C                     Z-ADD0         W#DAF1
     C                     Z-ADD0         W#DAF2
     C                     Z-ADD0         W#DAF3
     C                     EXSR SRDAFD
     C                     Z-ADDW#DAF1    SLDTD1
     C                     Z-ADDW#DAF2    SLDTD2
     C                     Z-ADDW#DAF3    SLDTD3
      *                                                                   175479
      *  Deal reference                                                   175479
      *                                                                   175479
     C                     MOVELS1FDLR    FDLR                            175479
      *
      *  Rate and Multiply/divide indicator and override
      *
     C                     MOVELF1RATE    RATE
     C           F1MDIN    IFEQ 'M'
     C                     Z-ADD1         MDIN
     C                     ELSE
     C                     Z-ADD0         MDIN
     C                     END
     C                     MOVELS1OVRD    OVRD
      *
      *  Payment amount, value date and currency
      *
     C                     Z-ADDF1PYAM    PYAM
     C                     MOVELS1PCCY    PCCY
     C                     Z-ADDF1PVDT    PVDT
      *
      *  Define date formats
      *
     C                     Z-ADDF1PVDT    W#MDTE
     C                     Z-ADD0         W#DAF1
     C                     Z-ADD0         W#DAF2
     C                     Z-ADD0         W#DAF3
     C                     EXSR SRDAFD
     C                     Z-ADDW#DAF1    PVDTD1
     C                     Z-ADDW#DAF2    PVDTD2
     C                     Z-ADDW#DAF3    PVDTD3
      *
      *  Add/deduct charges, priority code, related ref.
      *
     C                     MOVELS1ADDC    ADDC
     C*****      S1SWPC    IFEQ 'U'                                                           EMRMK1
     C*****                Z-ADD1         SWPC                                                EMRMK1
     C*****                ELSE                                                               EMRMK1
     C                     Z-ADD2         SWPC
     C*****                END                                                                EMRMK1
     C                     MOVELS3RLRF    RLPR
      *
      *  Ordering Bank
      *
     C                     MOVELF2ORBT    ORBT
     C                     MOVELS2ORB1    ORB1
     C                     MOVELS2ORB2    ORB2
     C                     MOVELS2ORB3    ORB3
     C                     MOVELS2ORB4    ORB4
     C                     MOVELS2ORB5    ORB5
      *
      *  Sender's Correspondent
      *
     C                     MOVELF2SNCT    SNCT
     C                     MOVELS2SNC1    SNC1
     C                     MOVELS2SNC2    SNC2
     C                     MOVELS2SNC3    SNC3
     C                     MOVELS2SNC4    SNC4
     C                     MOVELS2SNC5    SNC5
      *
      *  Ordering Customer
      *
     C                     MOVELF2ORCT    ORCT
     C                     MOVELS2ORC1    ORC1
     C                     MOVELS2ORC2    ORC2
     C                     MOVELS2ORC3    ORC3
     C                     MOVELS2ORC4    ORC4
     C                     MOVELS2ORC5    ORC5                                                CFT032
      *
      *  Details of Payment
      *
     C                     MOVELS3PAY1    DTP1
     C                     MOVELS3PAY2    DTP2
     C                     MOVELS3PAY3    DTP3
     C                     MOVELS3PAY4    DTP4
      *                                                                                       CER030
     C           CER031    IFEQ 'Y'                                                           CER030
     C                     MOVELIEXN1     IEXT1                                               CER030
     C                     MOVELIEXN2     IEXT2                                               CER030
     C                     MOVELIEXN3     IEXT3                                               CER030
     C                     MOVELIEXN4     IEXT4                                               CER030
     C                     MOVELIEXN5     IEXT5                                               CER030
     C                     MOVELIEXN6     IEXT6                                               CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           CER030    IFEQ 'Y'                                                           CER030
     C           CGL013    OREQ 'Y'                                                           CER030
      *                                                                                       CER030
     C                     MOVELWIRTTY    IRTTY                                               CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      *
      *  Charge detail
      *
     C*********************MOVELS3DETC    DTCH                     CFT014
     C                     MOVELS0DETC    DTCH                     CFT014
      *
      *  Sender to Receiver Information
      *
     C                     MOVELS2BTB1    BBI1
     C                     MOVELS2BTB2    BBI2
     C                     MOVELS2BTB3    BBI3
     C                     MOVELS2BTB4    BBI4
     C                     MOVELS2BTB5    BBI5
     C                     MOVELS2BTB6    BBI6
      *
      *  Central Bank Reference
      *
     C                     MOVELS3CBKR    DNBC
      *
      *  Intermediary Bank
      *
     C                     MOVELF3INBT    INBT
     C                     MOVELS3IBK1    INB1
     C                     MOVELS3IBK2    INB2
     C                     MOVELS3IBK3    INB3
     C                     MOVELS3IBK4    INB4
     C                     MOVELS3IBK5    INB5
      *
      *  Tariff and Commission type
      *
     C           CFT009    IFEQ 'N'                                       CFT009
     C*********************MOVELS2TRCT    TRCT                            CFT014
     C                     MOVELS3TRCT    TRCT                            CFT014
      *
      *  Charges, Commission¦Telex¦Cheque¦Advice¦Telephone¦Misc.
      *
     C*********************Z-ADDF3TRCM    TRCM                            CFT014
     C*********************Z-ADDF3TXCH    TXCH                            CFT014
     C*********************Z-ADDF3CQCH    CQCH                            CFT014
     C*********************Z-ADDF3ADCH    ADCH                            CFT014
     C*********************Z-ADDF3TLCH    TLCH                            CFT014
     C*********************Z-ADDF3MSCH    MSCH                            CFT014
     C*********************Z-ADDF3TRCD    DUMA1                           CFT014
     C*********************Z-ADDF3TXCD    DUMA2                           CFT014
     C*********************Z-ADDF3CQCD    DUMA3                           CFT014
     C*********************Z-ADDF3ADCD    DUMA4                           CFT014
     C*********************Z-ADDF3TLCD    DUMA5                           CFT014
     C*********************Z-ADDF3MSCD    DUMA6                           CFT014
     C                     Z-ADDF0TRCM    TRCM                            CFT014
     C                     Z-ADDF0TXCH    TXCH                            CFT014
     C                     Z-ADDF0CQCH    CQCH                            CFT014
     C                     Z-ADDF0ADCH    ADCH                            CFT014
     C                     Z-ADDF0TLCH    TLCH                            CFT014
     C                     Z-ADDF0MSCH    MSCH                            CFT014
     C                     Z-ADDF0TRCD    DUMA1                           CFT014
     C                     Z-ADDF0TXCD    DUMA2                           CFT014
     C                     Z-ADDF0CQCD    DUMA3                           CFT014
     C                     Z-ADDF0ADCD    DUMA4                           CFT014
     C                     Z-ADDF0TLCD    DUMA5                           CFT014
     C                     Z-ADDF0MSCD    DUMA6                           CFT014
     C                     ENDIF                                          CFT009
      *
      *  Charges to the debit of
      *
     C*********************MOVELF2CDRT    CDRT                            CFT014
     C*********************MOVELS2CDRO    CDRO                            CFT014
     C*********************MOVELS2CDBR    CDBR                            CFT014
     C                     MOVELF0CDRT    CDRT                            CFT014
     C                     MOVELS0CDRO    CDRO                            CFT014
     C                     MOVELS0CDBR    CDBR                            CFT014
      *
      *  General Flags
      *
     C                     MOVEL*BLANKS   IACG
     C                     MOVEL*BLANKS   SACG
     C                     MOVEL*BLANKS   PACG
     C                     MOVEL*BLANKS   SMSG
     C                     MOVEL*BLANKS   PMSG
     C                     MOVEL*BLANKS   AUP1
     C                     MOVEL*BLANKS   AUP2
     C***********          MOVEL*BLANKS   AUIN                            CFT005
     C                     MOVELWAUIN     AUIN                            CFT005
     C                     MOVELWAUP1     AUP1                            RK0001
     C                     MOVEL*BLANKS   ADIN
     C                     MOVEL*BLANKS   SRNM
      *
      *  Audit Information
      *
     C                     MOVEL##USR     INUSR1
     C                     MOVEL*BLANKS   INUSR2
     C                     TIME           LCHT
     C                     Z-ADDWURDNB    OEDT
     C                     MOVEL'I'       CHTP
     C                     Z-ADDWURDNB    LCD
     C                     MOVEL##USR     INUSR1
     C                     MOVEASTAMP,1   TMST                                                CFT017
      *
      *  Incoming to Outgoing Indicator
      *
     C                     MOVELS3OPIN    OPIN
      *
      *  Booking and originating branches
      *
     C                     MOVELS1BRCA    BRCA
     C                     MOVELS1ORBR    ORBR
      *
      *  Message references
      *
     C                     MOVELMIR       MIR
     C                     MOVELISEQ      ISEQ
     C                     MOVELINTRNO    INTRNO
     C                     MOVELINMTPY    INMTPY
     C                     Z-ADDINMSGR    INMSGR
     C                     Z-ADDINKPRT    INKPRT
     C                     Z-ADDINMSGR    IPMSGR                          MMFIX1
     C                     Z-ADDINKPRT    IPKPRT                          MMFIX1
      *
      *  Book code and profit centre
      *
     C                     MOVELS1BOKC    BOKC
     C                     MOVELS1PRFC    PRFC
      *
      *  Actual Receiver's Correspondent
      *
     C                     MOVELF1RCRT    INRCRT                          192595
     C***********          MOVELINRCRT    INRCRT                          192595
     C*********************MOVELINRCO1    INRCO1                          CFT014
     C*********************MOVELINRCO2    INRCO2                          CFT014
     C*********************MOVELINRCO3    INRCO3                          CFT014
     C*********************MOVELINRCO4    INRCO4                          CFT014
     C*********************MOVELINRCO5    INRCO5                          CFT014
     C                     MOVELS1RCO1    INRCO1                          CFT014
     C                     MOVELS1RCO2    INRCO2                          CFT014
     C                     MOVELS1RCO3    INRCO3                          CFT014
     C                     MOVELS1RCO4    INRCO4                          CFT014
     C                     MOVELS1RCO5    INRCO5                          CFT014
      *
      *  Actual Account with Institution
      *
     C                     MOVELINACBT    INACBT
     C                     MOVELINACB1    INACB1
     C                     MOVELINACB2    INACB2
     C                     MOVELINACB3    INACB3
     C                     MOVELINACB4    INACB4
     C                     MOVELINACB5    INACB5
      *
      *  Settle base currency equivalent
      *
     C           I1SMCY    IFEQ *BLANKS
     C                     CLEARD#DTA
     C                     Z-ADDSMAM      D#FAMT
     C                     MOVELS1SMCY    D#FCCY
     C                     MOVELV#BCCY    D#TCCY
      *
     C                     CALL 'AOCCYCV0'             9090
     C                     PARM *BLANKS   O#RTN   7
     C*********************PARM '*F*T*SPT'W0ACT   8                       CGL009
     C                     PARM '*F*T*SPT'W2ACT   8                       CGL009
     C           D#DTA     PARM D#DTA     O#DTA 256
      *
     C           *IN90     IFEQ '1'
     C           O#RTN     ORNE *BLANKS
     C                     MOVEL'AOCCYCV0'W0FILE           ***************
     C                     MOVEL'*CALL'   W0KEY            * DB ERROR 16 *
     C                     Z-ADD16        W0ERNB           ***************
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C***********          EXSR SRERR                                     130869
     C                     EXSR SRERRA                                    130869
     C                     END
      *
     C                     Z-ADDD#TAMT    SBCQ
     C                     END
      *
      *  Pay base currency equivalent
      *
     C           I1PCCY    IFEQ *BLANKS
     C                     CLEARD#DTA
     C                     Z-ADDPYAM      D#FAMT
     C                     MOVELS1PCCY    D#FCCY
     C                     MOVELV#BCCY    D#TCCY
      *
     C                     CALL 'AOCCYCV0'             9090
     C                     PARM *BLANKS   O#RTN   7
     C*********************PARM '*F*T*SPT'W0ACT   8                       CGL009
     C                     PARM '*F*T*SPT'W2ACT   8                       CGL009
     C           D#DTA     PARM D#DTA     O#DTA 256
      *
     C           *IN90     IFEQ '1'
     C           O#RTN     ORNE *BLANKS
     C                     MOVEL'AOCCYCV0'W0FILE           ***************
     C                     MOVEL'*CALL'   W0KEY            * DB ERROR 17 *
     C                     Z-ADD17        W0ERNB           ***************
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C***********          EXSR SRERR                                     130869
     C                     EXSR SRERRA                                    130869
     C                     END
      *
     C                     Z-ADDD#TAMT    PBCQ
     C                     END
      *
      *  If Pay Currency is Base then set SBCQ to PBCQ
      *  else set PBCQ to SBCQ
      *
     C           PCCY      IFEQ V#BCCY
     C                     Z-ADDPBCQ      SBCQ
     C                     ELSE
     C                     Z-ADDSBCQ      PBCQ
     C                     END
      *
      *  Sell and Buy rates
      *
     C                     Z-ADDSRTE      SRTE
     C                     Z-ADDPRTE      PRTE
      *
      *  Level complete indicators
      *
     C                     MOVELINLVL1    INLVL1
     C                     MOVELINLVL2    INLVL2
      *                                                                   CEU006
      ** Notified delivery currency and amount                            CEU006
      *                                                                   CEU006
     C                     MOVE S1NDCY    NDCY                            CEU006
     C                     Z-ADDV#NDAM    NDAM                            CEU006
      *                                                                   CEU006
      *                                                                   CEU006
      *
      *                                                                   S01408
     C/COPY WNCPYSRC,FT0300CP16                                           S01408
      *                                                                   S01408
      *  Unwind subroutine stack name
      *
     C           EXMVIN    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SROPRF   : Get next transaction number                       *
      *                                                               *
      *  CALLED BY: SRINUP - Outgoing Payments Update                 *
      *                                                               *
      *****************************************************************
     CSR         SROPRF    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SROPRF'  @STK,Q
      *
      *  /Copy point for Outgoing Payment Reference
      *
     C/COPY WNCPYSRC,FT0300OPRF
      *
      *  Set fields
      *
     C                     MOVEL'P'       W#P
     C                     MOVELW#YMD     W#MRDT
     C                     MOVELS4PYTP    W#PYTP
     C                     MOVELS4STMT    W#STMT
      *
      *  If Regular payment use RGPAYD else OTPAYD for number
      *
     C           PYTP      IFEQ 'RP'
     C           *LOCK     IN   RGPAYD
     C**************       Z-ADDRSQNM     W#PRNM                                              CFT151
     C                     MOVELRSQNM     W#PRNM                                              CFT151
     C                     ADD  1         RSQNM
     C                     OUT  RGPAYD
     C                     ELSE
      *
     C/COPY WNCPYSRC,FTH00082
     C           CFT151    IFEQ 'N'                                                           CFT151
     C           *LOCK     IN   OTPAYD
     C*****                Z-ADDOSQNM     W#PRNM                                              CFT151
     C*****                ADD  1         OSQNM                                               CFT151
     C                     MOVELWOTSQ     W#PRNM                                              CFT151
     C                     ADD  1         WOTSQ                                               CFT151
     C                     OUT  OTPAYD
     C                     ELSE                                                               CFT151
     C                     CALL 'FT000328'                                                    CFT151
     C                     PARM           PRTCD                                               CFT151
     C                     PARM 'OT'      W@OTIN  2                                           CFT151
     C                     PARM 'A'       WCALC   1                                           CFT151
     C                     PARM 'Y'       WUPD    1                                           CFT151
     C                     PARM           W#PRNM                                              CFT151
     C                     PARM           WNEWSQ                                              CFT151
     C                     ENDIF                                                              CFT151
     C/COPY WNCPYSRC,FTH00083
     C                     END
      *
     C/COPY WNCPYSRC,FTH00084
     C                     MOVELIPREF     PREF
     C/COPY WNCPYSRC,FTH00085
      *
      *  Unwind subroutine stack name
      *
     C           EXOPRF    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRMVOT   : Move data into Outgoing Payments Record           *
      *                                                               *
      *  CALLED BY: SROPUP - Outgoing Payments Update                 *
      *                                                               *
      *****************************************************************
     CSR         SRMVOT    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SRMVOT'  @STK,Q
      *
      *  /Copy point for Extension file fields
      *
     C/COPY WNCPYSRC,FT0300MVOT
      *                                                                   CFT003
      *  If Batch Authorsation update/add record                          CFT003
      *                                                                   CFT003
     C           CFT003    IFEQ 'CFT003'                                  CFT003
     C           CFT014    OREQ 'Y'                                                           210509
     C           CFT162    OREQ 'Y'                                                           CFT162
      *                                                                                       CFT162
     C           CFT162    IFEQ 'Y'                                                           CFT162
      *                                                                                       CFT162
      ** Check From Account (Ordering Bank or Ordering Customer)                              CFT162
      *                                                                                       CFT162
     C                     MOVELV#FRGL    @ACCN                                               CFT162
     C           KYM901    CHAINSDM901L0             60                                       CFT162
     C           *IN60     IFEQ *OFF                                                          CFT162
     C                     MOVELM9R900    WOPR90  1                                           CFT162
     C                     ELSE                                                               CFT162
      *                                                                                       CFT162
      ** record not found, check if there is a record for the customer                        CFT162
      *                                                                                       CFT162
     C                     MOVE *BLANKS   @BRCA                                               CFT162
     C                     MOVE *BLANKS   @CCY                                                CFT162
     C                     MOVE *BLANKS   @ACOD                                               CFT162
     C                     MOVE *BLANKS   @ACSQ                                               CFT162
     C           KYM901    CHAINSDM901L0             60                                       CFT162
     C                     ENDIF                                                              CFT162
      *                                                                                       CFT162
     C           *IN60     IFEQ *OFF                                                          CFT162
     C                     MOVELM9R900    WOPR90                                              CFT162
     C                     ELSE                                                               CFT162
     C                     MOVEL'N'       WOPR90                                              CFT162
     C                     ENDIF                                                              CFT162
      *                                                                                       CFT162
      ** Check to Account (Senders Correspondent Or Destination)                              CFT162
      *                                                                                       CFT162
     C                     MOVELV#TOGL    @ACCN                                               CFT162
     C           KYM901    CHAINSDM901L0             60                                       CFT162
     C           *IN60     IFEQ *OFF                                                          CFT162
     C                     MOVELM9R910    WOPR91  1                                           CFT162
     C                     ELSE                                                               CFT162
      *                                                                                       CFT162
      ** record not found, check if there is a record for the customer                        CFT162
      *                                                                                       CFT162
     C                     MOVE *BLANKS   @BRCA                                               CFT162
     C                     MOVE *BLANKS   @CCY                                                CFT162
     C                     MOVE *BLANKS   @ACOD                                               CFT162
     C                     MOVE *BLANKS   @ACSQ                                               CFT162
     C           KYM901    CHAINSDM901L0             60                                       CFT162
     C                     ENDIF                                                              CFT162
      *                                                                                       CFT162
     C           *IN60     IFEQ *OFF                                                          CFT162
     C                     MOVELM9R910    WOPR91                                              CFT162
     C                     ELSE                                                               CFT162
     C                     MOVEL'N'       WOPR91                                              CFT162
     C                     ENDIF                                                              CFT162
      *                                                                                       CFT162
     C                     ENDIF                                                              CFT162
      *                                                                   CFT003
      ** Update extension record to include the Auto-generated            CFT003
      ** indicator                                                        CFT003
      *                                                                   CFT003
     C           PREF      CHAINOTPAYXL0             90                   CFT003
      *                                                                   CFT003
      * If no existing extension record, insert new one                   CFT003
      *                                                                   CFT003
     C           *IN90     IFEQ '1'                                       CFT003
     C                     MOVEL'D'       OPRECI                          CFT003
     C                     MOVELPREF      OPPREF                          CFT003
     C                     MOVEL*BLANK    OPBJPR                          CFT003
     C                     MOVEL'Y'       OPAUTO                          CFT003
     C                     MOVELS4STMT    OPSETM                          CFT003
     C                     MOVEASTAMP,1   OPTMST                                              CFT017
      *                                                                   CFT005
     C           CFT005    IFEQ 'Y'                                       CFT005
     C           WAUIN     ANDEQ'Y'                                       CFT005
     C                     MOVELWUMRDT    OPRDAT                          CFT005
     C                     ENDIF                                          CFT005
      *                                                                   CFT003
      ** Fill field related to MT103                                      CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
     C                     EXSR FL103O                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT009
      ** Default charges                                                  CFT009
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
     C                     EXSR MVOCHG                                    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT003
     C           CSW209    IFEQ 'Y'                                                           CSW209
     C                     EXSR SRCVOT                                                        CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     CALL 'ZAGENTS'                                                   BUG26009
     C                     PARM           OPTMST                                            BUG26009
      *                                                                                     BUG26009
     C           CFT162    IFEQ 'Y'                                                           CFT162
     C                     MOVELWOPR90    OPR900                                              CFT162
     C                     MOVELWOPR91    OPR910                                              CFT162
     C                     MOVEL'N'       OPG900                                              CFT162
     C                     MOVEL'N'       OPG910                                              CFT162
     C                     ENDIF                                                              CFT162
      *                                                                                       CFT162
     C                     WRITEOTPAYXDF                                  CFT003
      *                                                                   CFT003
      * If existing extension record, update                              CFT003
      *                                                                   CFT003
     C                     ELSE                                           CFT003
      *                                                                   CFT005
     C           CFT005    IFEQ 'Y'                                       CFT005
     C           WAUIN     ANDEQ'Y'                                       CFT005
     C                     MOVELWUMRDT    OPRDAT                          CFT005
     C                     ENDIF                                          CFT005
      *                                                                   CFT014
      ** Fill fields related to MT103                                     CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
     C                     EXSR FL103O                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT009
      ** Default charges                                                  CFT009
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
     C                     EXSR MVOCHG                                    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT003
     C                     MOVEL'Y'       OPAUTO                          CFT003
      *                                                                                       CSW209
     C           CSW209    IFEQ 'Y'                                                           CSW209
     C                     EXSR SRCVOT                                                        CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     CALL 'ZAGENTS'                                                   BUG26009
     C                     PARM           OPTMST                                            BUG26009
      *                                                                                     BUG26009
     C           CFT162    IFEQ 'Y'                                                           CFT162
     C           OPR900    IFEQ *BLANKS                                                       CFT162
     C                     MOVELWOPR90    OPR900                                              CFT162
     C                     ENDIF                                                              CFT162
      *                                                                                       CFT162
     C           OPR910    IFEQ *BLANKS                                                       CFT162
     C                     MOVELWOPR91    OPR910                                              CFT162
     C                     ENDIF                                                              CFT162
      *                                                                                       CFT162
     C                     MOVEL'N'       OPG900                                              CFT162
     C                     MOVEL'N'       OPG910                                              CFT162
     C                     ENDIF                                                              CFT162
      *                                                                                       CFT162
     C                     UPDATOTPAYXDF                                  CFT003
     C                     ENDIF                                          CFT003
      *                                                                   CFT003
     C                     ENDIF                                          CFT003
     C/COPY WNCPYSRC,FT0300C060
      *                                                                   CFT003
      *
      *  Record identifier must be D
      *
     C                     MOVEL'D'       RECI
      *
      *  Payment Reference, type and sub-type
      *
     C                     MOVELPREF      PREF
     C                     MOVELS4PYTP    PYTP
     C                     MOVELS4PYST    PYST
      *
      *  Destination
      *
     C                     MOVELF4DSTT    DSTT
     C                     MOVELS4DST1    DST1
     C                     MOVELS4DST2    DST2
     C                     MOVELS4DST3    DST3
     C                     MOVELS4DST4    DST4
      *
      *  Senedr's Correspondent account
      *
     C                     MOVELF4SNCT    SNCT
     C                     MOVELS4SNCO    SNCO
      *
      *  Ordering Bank
      *
     C                     MOVELF4ORBT    ORBT
     C/COPY WNCPYSRC,FT0300C041
     C                     MOVELS4ORBK    ORBK
     C/COPY WNCPYSRC,FT0300C042
     C                     MOVELS4ORBB    ORBB
      *                                                                                       CFT032
      ** MT103 Account Type                                                                   CFT032
      *                                                                                       CFT032
     C                     MOVELF4ODTT    ODMTT                                               CFT032
      *
      *  Ordering Customer
      *
     C                     MOVELS4ODMT    ODMT
     C                     MOVELF4ORCT    ORCT
     C                     MOVELS4ORC1    ORC1
     C                     MOVELS4ORC2    ORC2
     C                     MOVELS4ORC3    ORC3
     C                     MOVELS4ORC4    ORC4
     C                     MOVELS4ORC5    ORC5                                                CFT032
      *
      *  Settle amount, value date and currency
      *
     C                     Z-ADDF4SMAM    SMAM
     C                     MOVELS4SMCY    SMCY
     C                     Z-ADDF4SLDT    SLDT
      *
      *  Define date formats
      *
     C                     Z-ADDF4SLDT    W#MDTE
     C                     Z-ADD0         W#DAF1
     C                     Z-ADD0         W#DAF2
     C                     Z-ADD0         W#DAF3
     C                     EXSR SRDAFD
     C                     Z-ADDW#DAF1    SLDTD1
     C                     Z-ADDW#DAF2    SLDTD2
     C                     Z-ADDW#DAF3    SLDTD3
      *
      *  Rate and Multiply/divide indicator and override
      *
     C                     MOVELF4RATE    RATE
     C           F4MDIN    IFEQ 'M'
     C                     Z-ADD1         MDIN
     C                     ELSE
     C                     Z-ADD0         MDIN
     C                     END
     C                     MOVELS4OVRD    OVRD
      *
      *  Payment amount, value date and currency
      *
     C                     Z-ADDF4PYAM    PYAM
     C                     MOVELS4PCCY    PCCY
     C                     Z-ADDF4PVDT    PVDT
      *
     C/COPY WNCPYSRC,FT0300C008
      *  Define date formats
      *
     C                     Z-ADDF4PVDT    W#MDTE
     C                     Z-ADD0         W#DAF1
     C                     Z-ADD0         W#DAF2
     C                     Z-ADD0         W#DAF3
     C                     EXSR SRDAFD
     C                     Z-ADDW#DAF1    PVDTD1
     C                     Z-ADDW#DAF2    PVDTD2
     C                     Z-ADDW#DAF3    PVDTD3
      *
      *  Add/deduct charges, priority code, related ref.
      *
     C                     MOVELS4ADDC    ADDC
     C/COPY WNCPYSRC,FT0300C028
     C*****      S4SWPC    IFEQ 'U'                                                           MKEMR1
     C*****                Z-ADD1         SWPC                                                MKEMR1
     C*****                ELSE                                                               MKEMR1
     C                     Z-ADD2         SWPC
     C*****                END                                                                MKEMR1
     C                     MOVELS6RLRF    RLPR
     C                     MOVELS4STMT    STMT
     C                     MOVELS4SNMT    SNMT
      *                                                                   175479
      *  Deal reference                                                   175479
      *                                                                   175479
     C                     MOVELS4FDLR    FDLR                            175479
      *
      *  Receiver's Correspondent
      *
     C                     MOVELF5RCOT    RCRT
     C                     MOVELS5RCO1    RCO1
     C                     MOVELS5RCO2    RCO2
     C                     MOVELS5RCO3    RCO3
     C                     MOVELS5RCO4    RCO4
     C                     MOVELS5RCO5    RCO5
      *
      *  Account with Institution
      *
     C                     MOVELF5ACBT    ACBT
     C                     MOVELS5ACB1    ACB1
     C                     MOVELS5ACB2    ACB2
     C                     MOVELS5ACB3    ACB3
     C                     MOVELS5ACB4    ACB4
     C                     MOVELS5ACB5    ACB5
      *
      *  Beneficiary
      *
     C                     MOVELF5BNCT    BNCT
     C                     MOVELS5BNC1    BNC1
     C/COPY WNCPYSRC,FT0300C004
     C                     MOVELS5BNC2    BNC2
     C                     MOVELS5BNC3    BNC3
     C                     MOVELS5BNC4    BNC4
     C                     MOVELS5BNC5    BNC5
      *
      *  Details of Payment
      *
     C*********************MOVELS5PAY1    DTP1                            CFT014
     C*********************MOVELS5PAY2    DTP2                            CFT014
     C*********************MOVELS5PAY3    DTP3                            CFT014
     C*********************MOVELS5PAY4    DTP4                            CFT014
     C                     MOVELS6PAY1    DTP1                            CFT014
     C                     MOVELS6PAY2    DTP2                            CFT014
     C                     MOVELS6PAY3    DTP3                            CFT014
     C                     MOVELS6PAY4    DTP4                            CFT014
      *
     C           CER031    IFEQ 'Y'                                                           CER030
      *                                                                                       CER030
      ** For Debit                                                                            CER030
      *                                                                                       CER030
     C                     MOVELOPEXN1    OPEXT1                                              CER030
     C                     MOVELOPEXN2    OPEXT2                                              CER030
     C                     MOVELOPEXN3    OPEXT3                                              CER030
     C                     MOVELOPEXN4    OPEXT4                                              CER030
     C                     MOVELOPEXN5    OPEXT5                                              CER030
     C                     MOVELOPEXN6    OPEXT6                                              CER030
      *                                                                                       CER030
      ** For Credit                                                                           CER030
      *                                                                                       CER030
     C           CFT003    IFEQ 'CFT003'                                                      CER030
     C           S4STMT    ANDEQ'14'                                                          CER030
     C                     MOVELOPEXN1    OPEXC1                                              CER030
     C                     MOVELOPEXN2    OPEXC2                                              CER030
     C                     MOVELOPEXN3    OPEXC3                                              CER030
     C                     MOVELOPEXN4    OPEXC4                                              CER030
     C                     MOVELOPEXN5    OPEXC5                                              CER030
     C                     MOVELOPEXN6    OPEXC6                                              CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           CER030    IFEQ 'Y'                                                           CER030
     C           CGL013    OREQ 'Y'                                                           CER030
      *                                                                                       CER030
     C                     MOVELWORTTY    OPRTTY                                              CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      *  Charge detail
      *
     C*********************MOVELS6DETC    DTCH                            CFT014
     C                     MOVELS7DETC    DTCH                            CFT014
      *
      *  Sender to Receiver Information
     C/COPY WNCPYSRC,FT0300C005
      *
     C*********************MOVELS5BTB1    BBI1                            CFT014
     C*********************MOVELS5BTB2    BBI2                            CFT014
     C*********************MOVELS5BTB3    BBI3                            CFT014
     C                     MOVELS6BTB1    BBI1                            CFT014
     C                     MOVELS6BTB2    BBI2                            CFT014
     C                     MOVELS6BTB3    BBI3                            CFT014
     C/COPY WNCPYSRC,FT0300C006
     C*********************MOVELS5BTB4    BBI4                            CFT014
     C*********************MOVELS5BTB5    BBI5                            CFT014
     C*********************MOVELS5BTB6    BBI6                            CFT014
     C                     MOVELS6BTB4    BBI4                            CFT014
     C                     MOVELS6BTB5    BBI5                            CFT014
     C                     MOVELS6BTB6    BBI6                            CFT014
      *
      *  Central Bank Reference
      *
     C                     MOVELS6CBKR    DNBC
      *
      *  Tariff and Commission type
      *
     C           CFT009    IFEQ 'N'                                       CFT009
     C*********************MOVELS5TRCT    TRCT                            CFT014
     C                     MOVELS6TRCT    TRCT                            CFT014
      *
      *  Charges, Commission¦Telex¦Cheque¦Cost A¦Swift¦Misc.
      *
     C*********************Z-ADDF6TRCM    TRCM                            CFT014
     C*********************Z-ADDF6TXCH    TXCH                            CFT014
     C*********************Z-ADDF6CQCH    CQCH                            CFT014
     C*********************Z-ADDF6CSTA    CSTA                            CFT014
     C*********************Z-ADDF6SPCH    SPCH                            CFT014
     C*********************Z-ADDF6MSCH    MSCH                            CFT014
     C*********************Z-ADDF6TRCD    DUMA1                           CFT014
     C*********************Z-ADDF6TXCD    DUMA2                           CFT014
     C*********************Z-ADDF6CQCD    DUMA3                           CFT014
     C*********************Z-ADDF6CSTD    DUMA4                           CFT014
     C*********************Z-ADDF6SPCD    DUMA5                           CFT014
     C*********************Z-ADDF6MSCD    DUMA6                           CFT014
     C                     Z-ADDF7TRCM    TRCM                            CFT014
     C                     Z-ADDF7TXCH    TXCH                            CFT014
     C                     Z-ADDF7CQCH    CQCH                            CFT014
     C                     Z-ADDF7CSTA    CSTA                            CFT014
     C                     Z-ADDF7SPCH    SPCH                            CFT014
     C                     Z-ADDF7MSCH    MSCH                            CFT014
     C                     Z-ADDF7TRCD    DUMA1                           CFT014
     C                     Z-ADDF7TXCD    DUMA2                           CFT014
     C                     Z-ADDF7CQCD    DUMA3                           CFT014
     C                     Z-ADDF7CSTD    DUMA4                           CFT014
     C                     Z-ADDF7SPCD    DUMA5                           CFT014
     C                     Z-ADDF7MSCD    DUMA6                           CFT014
     C                     ENDIF                                          CFT009
      *
      *  Charges to the debit of
      *
     C*********************MOVELF5CDRT    CDRT                            CFT014
     C*********************MOVELS5CDRO    CDRO                            CFT014
     C*********************MOVELS5CDBR    CDBR                            CFT014
     C                     MOVELF7CDRT    CDRT                            CFT014
     C                     MOVELS7CDRO    CDRO                            CFT014
     C                     MOVELS7CDBR    CDBR                            CFT014
      *
      *  Audit Information
      *
     C                     MOVEL##USR     INUSR1
     C                     MOVEL*BLANKS   INUSR2
     C                     TIME           LCHT
     C                     Z-ADDWURDNB    OEDT
     C                     MOVEL'I'       CHTP
     C                     Z-ADDWURDNB    LCD
     C                     MOVEASTAMP,1   TMST                                                CFT017
      *
      *  General Flags
      *
     C                     MOVEL*BLANKS   IACG
     C                     MOVEL*BLANKS   SACG
     C                     MOVEL*BLANKS   PACG
     C                     MOVEL*BLANKS   SMSG
     C                     MOVEL*BLANKS   PMSG
     C                     MOVEL*BLANKS   AUP1
     C                     MOVEL*BLANKS   AUP2
     C**********           MOVEL*BLANKS   AUIN                            CFT005
     C                     MOVELWAUIN     AUIN                            CFT005
     C                     MOVELWAUP1     AUP1                            RK0001
     C                     MOVEL*BLANKS   ADIN
     C                     MOVEL*BLANKS   CQIN
     C                     MOVEL*BLANKS   PRIN
     C                     MOVEL*BLANKS   MT100
     C                     MOVEL*BLANKS   MT202
     C                     MOVEL*BLANKS   TXIN
     C                     MOVEL*BLANKS   BAIN
     C                     MOVEL*BLANKS   ISIN
     C                     MOVEL*BLANKS   MPYI
     C                     MOVEL*BLANKS   MT202C
      *
      *  Regular Payment information
      *
     C                     MOVELS4RPAY    RPAY
     C                     MOVELS4PAYF    PAYF
     C           S4DYIM    IFEQ *BLANKS
     C                     Z-ADD0         DYIM
     C                     ELSE
     C                     MOVELS4DYIM    DYIM
     C                     END
     C                     Z-ADDF4NDAT    NPDT
     C                     Z-ADDF4FIND    FDAT
     C                     Z-ADDF4PRBD    PRBD
     C                     MOVELF4FAIN    FAIN
      *
      *  Intermediary Bank
      *
     C*********************MOVELF6INBT    INBT                            CFT014
     C*********************MOVELS6IBK1    INB1                            CFT014
     C*********************MOVELS6IBK2    INB2                            CFT014
     C*********************MOVELS6IBK3    INB3                            CFT014
     C*********************MOVELS6IBK4    INB4                            CFT014
     C*********************MOVELS6IBK5    INB5                            CFT014
     C                     MOVELF5INBT    INBT                            CFT014
     C                     MOVELS5IBK1    INB1                            CFT014
     C                     MOVELS5IBK2    INB2                            CFT014
     C                     MOVELS5IBK3    INB3                            CFT014
     C                     MOVELS5IBK4    INB4                            CFT014
     C                     MOVELS5IBK5    INB5                            CFT014
     C                     MOVELS6CHAP    CHAP
     C*
     C                     MOVELS4SMAM    AMTS
     C                     MOVELS4SLDT    SVDT
     C                     MOVEL*BLANKS   NSTR
     C                     MOVEL*BLANKS   TSKS
     C/COPY WNCPYSRC,FT0300C010
     C                     MOVEL*BLANKS   OXPREF
     C/COPY WNCPYSRC,FT0300C011
     C                     MOVEL*BLANKS   OPIN
      *
      *  Level complete indicators
      *
     C                     MOVELLVL1      LVL1
     C                     MOVELLVL2      LVL2
      *
      *  Settle base currency equivalent
      *
     C           I4SMCY    IFEQ *BLANKS
     C                     CLEARD#DTA
     C                     Z-ADDSMAM      D#FAMT
     C                     MOVELS4SMCY    D#FCCY
     C                     MOVELV#BCCY    D#TCCY
      *
     C                     CALL 'AOCCYCV0'             9090
     C                     PARM *BLANKS   O#RTN   7
     C*********************PARM '*F*T*SPT'W0ACT   8                       CGL009
     C                     PARM '*F*T*SPT'W2ACT   8                       CGL009
     C           D#DTA     PARM D#DTA     O#DTA 256
      *
     C           *IN90     IFEQ '1'
     C           O#RTN     ORNE *BLANKS
     C                     MOVEL'AOCCYCV0'W0FILE           ***************
     C                     MOVEL'*CALL'   W0KEY            * DB ERROR 18 *
     C                     Z-ADD18        W0ERNB           ***************
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C***********          EXSR SRERR                                     130869
     C                     EXSR SRERRA                                    130869
     C                     END
      *
     C                     Z-ADDD#TAMT    SBCQ
     C                     END
      *
      *  Pay base currency equivalent
      *
     C           I4PCCY    IFEQ *BLANKS
     C                     CLEARD#DTA
     C                     Z-ADDPYAM      D#FAMT
     C                     MOVELS4PCCY    D#FCCY
     C                     MOVELV#BCCY    D#TCCY
      *
     C                     CALL 'AOCCYCV0'             9090
     C                     PARM *BLANKS   O#RTN   7
     C*********************PARM '*F*T*SPT'W0ACT   8                       CGL009
     C                     PARM '*F*T*SPT'W2ACT   8                       CGL009
     C           D#DTA     PARM D#DTA     O#DTA 256
      *
     C           *IN90     IFEQ '1'
     C           O#RTN     ORNE *BLANKS
     C                     MOVEL'AOCCYCV0'W0FILE           ***************
     C                     MOVEL'*CALL'   W0KEY            * DB ERROR 19 *
     C                     Z-ADD19        W0ERNB           ***************
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C***********          EXSR SRERR                                     130869
     C                     EXSR SRERRA                                    130869
     C                     END
      *
     C                     Z-ADDD#TAMT    PBCQ
     C                     END
      *                                                                                       DJB002
      *  If Pay Currency is Base then set SBCQ to PBCQ                                        DJB002
      *  else set PBCQ to SBCQ                                                                DJB002
      *                                                                                       DJB002
     C           PCCY      IFEQ V#BCCY                                                        DJB002
     C                     Z-ADDPBCQ      SBCQ                                                DJB002
     C                     ELSE                                                               DJB002
     C                     Z-ADDSBCQ      PBCQ                                                DJB002
     C                     END                                                                DJB002
      *
      *  Booking and originating branches
      *
     C                     MOVELS4BRCA    BRCA
     C                     MOVELS4ORBR    ORBR
      *
      *  Book code and profit centre
      *
     C                     MOVELS4BOKC    BOKC
     C                     MOVELS4PRFC    PRFC
      *
      *  Actual Ordering Bank
      *
     C           S4ORC1    IFEQ ORCFLD
     C           S4ORC2    ANDNE*BLANKS
     C           S4ORC3    ANDNE*BLANKS
     C           S4ORC4    ANDNE*BLANKS
     C           S4ORC5    ANDNE*BLANKS                                                       CFT032
     C           S4ORC2    ANDNEOPORB1
     C           S4ORC3    ANDNEOPORB2
     C           S4ORC4    ANDNEOPORB3
     C           S4ORC5    ANDNEOPORB4                                                        CFT032
     C                     MOVEL'A'       OPORBT
     C                     MOVELS4ORC2    OPORB1
     C                     MOVELS4ORC3    OPORB2
     C                     MOVELS4ORC4    OPORB3
     C**********           MOVEL*BLANKS   OPORB4                                              CFT032
     C                     MOVELS4ORC5    OPORB4                                              CFT032
     C                     MOVEL*BLANKS   OPORB5
     C                     ELSE
     C                     MOVELOPORBT    OPORBT
     C                     MOVELOPORB1    OPORB1
     C                     MOVELOPORB2    OPORB2
     C                     MOVELOPORB3    OPORB3
     C                     MOVELOPORB4    OPORB4
     C                     MOVELOPORB5    OPORB5
     C                     END
      *
      *  Message references
      *
     C                     Z-ADDOPMSGR    OPMSGR
     C                     Z-ADDOPKPRT    OPKPRT
      *                                                                   CEU006
      ** Notified delivery currency and amount                            CEU006
      *                                                                   CEU006
     C                     MOVE S4NDCY    NDCY                            CEU006
     C                     Z-ADDV#NDAM    NDAM                            CEU006
      *                                                                   CEU006
     C/COPY WNCPYSRC,FT0300C009
      *                                                                   CEU006
      ** Pay delivery currency and amount                                 CEU006
      *                                                                   CEU006
     C                     SELEC                                          CGL009
     C           PNWRK     WHEQ 'FONTIS'                                  CGL009
     C/COPY WNCPYSRC,FT0300C054
     C                     MOVE S4PDCY    PDCY                            CGL009
     C                     Z-ADDV#PDAM    PDAM                            CGL009
     C                     OTHER                                          CGL009
     C           CFT014    IFEQ 'Y'                                       CFT014
     C                     MOVE S4PDCY    PDCY                            CFT014
     C                     Z-ADDV#PDAM    PDAM                            CFT014
     C                     ELSE                                           CFT014
     C                     CLEARPDCY                                      CEU006
     C                     CLEARPDAM                                      CEU006
     C                     ENDIF                                          CFT014
     C                     ENDSL                                          CGL009
      *                                                                   CEU006
      *                                                                   S01408
     C/COPY WNCPYSRC,FT0300CCP5                                           S01408
      *                                                                   S01408
      *
      *  Unwind subroutine stack name
      *
     C           EXMVOT    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRAGCP   : Auto generation complete but no update            *
      *                                                               *
      *  CALLED BY: SRINFT - Validate Incoming                        *
      *             SROPFT - Validate Outgoing                        *
      *                                                               *
      *****************************************************************
     CSR         SRAGCP    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SRAGCP'  @STK,Q
      *
      *  /Copy point for Auto Generation Ignored
      *
     C/COPY WNCPYSRC,FT0300AGCP
      *
      *  Fill record format data structure with available data
      *
     C                     CLEARINFT
      *
     C                     Z-ADDINMSGR    FTMSGR           Unique Ref.
     C                     Z-ADDINKPRT    FTKPRT           Part No.
     C                     MOVEL'MIN0083' FTINFG           Incoming Flag
      *
      *  N.B. Audit Stamp details are determined in called program
      *
      *
      *  Set up data to be passed using the rcd format data structure
      *
     C                     CALL 'ME1050'               90
     C                     PARM '*FT INC 'W2ACT   8
     C                     PARM ##PGM     W2CPGM 10
     C                     PARM *BLANKS   W2NWRK  6
     C                     PARM FTINFG    W2LMSG  7
     C                     PARM           INFT
     C                     PARM *BLANKS   W2RTN   7
      *
      *  If return with an error (LR seton in called program) then
      *  process for database error.
      *
     C           *IN90     IFEQ '1'
     C           W2RTN     OREQ '*ERROR*'
     C                     MOVEL'*CALL  ' W0FILE
     C                     MOVEL'ME1050 ' W0KEY
     C                     Z-ADD20        W0ERNB
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C***********          EXSR SRERR                                     130869
     C                     EXSR SRERRA                                    130869
     C                     END
      *
      *  Commit changes
      *
     C                     COMIT
      *
      *  Unwind subroutine stack name
      *
     C           EXAGCP    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRRERR   : Report errors to log                              *
      *                                                               *
      *  CALLED BY: Main processing                                   *
      *                                                               *
      *****************************************************************
     CSR         SRRERR    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SRRERR'  @STK,Q
      *
      *  If errors as codes then place on log
      *
     C           C#ERCD    IFNE *BLANKS
     C                     MOVEL'MIN0233' W0LMSG           Action - Msg ID
     C                     MOVELC#ERCD    W0MSDT           Action Data
     C                     EXSR SRLOG
     C                     END
      *
      ***Read*message*file for messages  UP TO 5 messages                 CRE008
      ***Allow up to 15                                            CRE008 216308
      *  Exhaust all program message logged in this program               216308
      *
     C***********1         DO   5                                         CRE008
     C***********1         DO  25                                  CRE008 216308
     C           #MSGID    DOUEQ*BLANKS                                   216308
      *
     C                     CALL 'MEC1340'              9090
     C                     PARM ##PGM     #PGMQ  10
     C                     PARM *BLANKS   #MSGID
     C                     PARM           #MSGF
     C                     PARM           #MSDTA
     C                     PARM *BLANKS   #MSTX1
     C                     PARM *BLANKS   #MSTX2
      *
      *  If Message found add to log
      *
     C           #MSGID    IFNE *BLANKS
     C                     MOVEL#MSGID    W0LMSG           Action - Msg ID
     C                     MOVEL#MSDTA    W0MSDT           Action Data
     C                     MOVEL#MSGF     W0MSGF           Msg file
     C                     EXSR SRLOG
      *                                                                   130869
      ** For CASHV8 network, read only 1 error message                    130869
      *                                                                   130869
     C           PNWRK     IFEQ 'CASHV8'                                  130869
     C           WFIRST    ANDEQ'Y'                                       130869
     C                     MOVE 'N'       WFIRST  1                       130869
     C                     MOVEL*BLANKS   W1MSGD  7                       130869
     C                     MOVEL*BLANKS   W1MSGT132                       130869
     C                     MOVEL#MSGID    W1MSGD                          130869
     C                     MOVEL#MSTX1    W1MSGT                          130869
     C                     END                                            130869
      *                                                                   130869
     C                     ELSE
     C                     LEAVE
     C                     END
      *
     C                     ENDDO
      *
      *  Unwind subroutine stack name
      *
     C           EXRERR    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRLOG    : Log actions taken                                 *
      *                                                               *
      *  CALLED BY: SRERR Report errors to log                        *
      *                                                               *
      *****************************************************************
     CSR         SRLOG     BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SRLOG '  @STK,Q
      *
      *  Fill record format data structure with available data
      *
     C           *LIKE     DEFN LFMSID    W0MSID           Action - Msg ID
     C           *LIKE     DEFN LFMSDT    W0MSDT           Action Data
     C                     CLEARINLF
      *
     C                     Z-ADDOPMSGR    LFMSGR           Unique Ref.
     C                     Z-ADDOPKPRT    LFKPRT           Part No.
     C                     MOVELW0LMSG    LFMSID           Action - Msg ID
     C                     MOVELW0MSDT    LFMSDT           Action Data
     C                     MOVELW0MSGF    LFMSGF           Message File
     C                     MOVEL*BLANKS   LFARSM           Action Result
     C                     MOVEL*BLANKS   LFARSD           Act Result Data
     C                     MOVEL##PGM     LFCPGM           Calling Process
     C                     MOVEL##PGM     LFRPGM           Called Process
      *
      *  N.B. Audit Stamp details are determined in called program
      *
      *
      *  Set up data to be passed using the rcd format data structure
      *
     C                     CALL 'ME1040'               90
     C                     PARM '*ADD    'W2ACT   8
     C                     PARM           INLF
     C                     PARM *BLANKS   W2RTN   7
      *
      *  If return with an error (LR seton in called program) then
      *  process for database error.
      *
     C           *IN90     IFEQ '1'
     C           W2RTN     ORNE *BLANKS
     C                     MOVEL'ME1040  'W0FILE           ***************
     C                     MOVEL'*CALL   'W0KEY            * DB ERROR 21 *
     C                     Z-ADD21        W0ERNB           ***************
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C***********          EXSR SRERR                                     130869
     C                     EXSR SRERRA                                    130869
     C                     END
      *
     C                     MOVEL*BLANKS   W0MSGF           Message File
      *
      *  Unwind subroutine stack name
      *
     C           EXLOG     TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRCLRP   : Clear all positions in store                      *
      *                                                               *
      *  CALLED BY: UPDATE - Update database                          *
      *                                                               *
      *  CALLS    : SRERR - Report errors                             *
      *                                                               *
      *****************************************************************
     CSR         SRCLRP    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q
     C                     MOVEL'SRCLRP'  @STK,Q
      *
      *  Clear arrays in AOSPOSU0
      *
     C                     CLEARQ#DTA
     C                     CALL 'AOSPOSU0'             9090
     C           R#RTN     PARM *BLANKS   O#RTN   7
     C*********************PARM '*CLEAR  'W0ACT   8                       CGL009
     C                     PARM '*CLEAR  'W2ACT   8                       CGL009
     C                     PARM Q#DTA     O#DTA 256
      *
     C           *LIKE     DEFN O#RTN     R#RTN
     C           *IN90     IFEQ '1'
     C           R#RTN     ORNE *BLANKS
     C                     MOVEL'AOSPOSU0'W0FILE           ***************
     C                     MOVEL'*CALL   'W0KEY            * DB ERROR 22 *
     C                     Z-ADD22        W0ERNB           ***************
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C***********          EXSR SRERR                                     130869
     C                     EXSR SRERRA                                    130869
     C                     END
     C/COPY WNCPYSRC,FT0300C079
      *
      *  Unwind subroutine stack name
      *
     C           EXCLRP    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q       50
      *
     CSR                   ENDSR
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRADDI   : Add shadow positions to store                     *
      *                                                               *
      *  CALLED BY: SRINUP - Update database                          *
      *                                                               *
      *  CALLS    : SRERR - Report errors                             *
      *                                                               *
      *****************************************************************
     CSR         SRADDI    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q
     C                     MOVEL'SRADDI'  @STK,Q
      *
      *  Define settle and pay amounts
      *
     C           *LIKE     DEFN SMAM      ##SMAM
     C           *LIKE     DEFN PYAM      ##PYAM
     C           *LIKE     DEFN CCY       ACCY                                                CFT009
      *
      *  Move fields to C#DTA structure and call AOSPOSU0
      *
      *         S E T T L E    I N S T R U C T I O N S
      *
      *  Only execute if Outgoing Payment not generated
      *
     C                     CLEARQ#DTA
     C           INTRIT    IFEQ 'F'                                       CFT014
     C           INTRIT    OREQ 'R'                                       CFT014
     C           INTRIT    OREQ 'G'                                       CFT014
     C           INTRIT    OREQ 'I'                                       CFT014
     C                     MOVELINTRIT    Q#ATYP                          CFT014
      * If not IBAN                                                       CFT014
     C           CFT004    IFNE 'Y'                                       CFT014
     C           CFT004    OREQ 'Y'                                       CFT014
     C           INTRIT    ANDNE'I'                                       CFT014
     C**********           MOVELINTRIB    Q#ACCT                                       CFT014 CGL029
     C                     MOVELINTRIB    Q#ACCT 24                                           CGL029
     C                     EXSR SRFLGL                                                      HVB005
     C*****      6         SUBSTQ#ACCT:1  W#CNU1  6                                  CGL029 HVB005
     C*****      3         SUBSTQ#ACCT:7  Q#CCY1                                     CGL029 HVB005
     C*****      10        SUBSTQ#ACCT:10 W#ACO1 10                                  CGL029 HVB005
     C*****      2         SUBSTQ#ACCT:20 W#ACS1  2                                  CGL029 HVB005
     C*****      3         SUBSTQ#ACCT:22 Q#BRC1                                     CGL029 HVB005
     C*****                MOVE W#CNU1    Q#CNU1                                     CGL029 HVB005
     C*****                MOVE W#ACO1    Q#ACO1                                     CGL029 HVB005
     C*****                MOVE W#ACS1    Q#ACS1                                     CGL029 HVB005
     C           Q#ATYP    IFEQ 'R'                                                       AR1089518A
     C           10        SUBSTQ#ACCT:1  W#ACNO 10                                       AR1089518A
     C                     MOVE W#ACNO    Q#ACNO                                          AR1089518A
     C                     ENDIF                                                          AR1089518A
     C                     ELSE                                           CFT014
     C                     MOVE *BLANKS   DSSDY                           CFT014
     C                     MOVEL*BLANK    P@IBN2                          CFT014
     C                     MOVELINTRIB    W#C1                                              HVB005
     C           W#C1      IFEQ '/'                                                         HVB005
     C           33        SUBSTINTRIB:2  P@IBN2                                            HVB005
     C                     ELSE                                                             HVB005
     C                     MOVELINTRIB    P@IBN2                          CFT014
     C                     ENDIF                                                            HVB005
     C                     CALL 'AOIBANR4'                                CFT014
     C                     PARM           P@RTCD                          CFT014
     C                     PARM '*KEY   ' P@OPTN                          CFT014
     C                     PARM           P@IBN2                          CFT014
     C           P@ACCN    PARM           DSSDY                           CFT014
     C**********           Z-ADDIBCNUM    Q#CNU1                                       CFT014 CSD027
     C                     MOVE IBCNUM    Q#CNU1                                              CSD027
     C                     MOVE CCY       Q#CCY1                          CFT014
     C                     Z-ADDIBACOD    Q#ACO1                          CFT014
     C                     Z-ADDIBACSQ    Q#ACS1                          CFT014
     C                     MOVE IBBRCA    Q#BRC1                          CFT014
     C                     ENDIF                                          CFT014
     C                     ELSE                                           CFT014
     C***********RCRT      IFNE *BLANK                                    CFT014
     C***********RCRT      IFEQ 'F'                                       192595
     C***********RCRT      OREQ 'N'                                       192595
     C***********RCRT      OREQ 'I'                                       192595
     C***********RCRT      OREQ 'R'                                       192595
     C***********          MOVELRCRT      Q#ATYP                          192595
     C*********************MOVELRCCO      Q#ACCT                          CFT014
     C           INRCRT    IFEQ 'F'                                       192595
     C           INRCRT    OREQ 'N'                                       192595
     C           INRCRT    OREQ 'I'                                       192595
     C           INRCRT    OREQ 'R'                                       192595
     C                     MOVELINRCRT    Q#ATYP                          192595
     C***********RCRT      IFNE 'I'                                CFT014 192595
     C           INRCRT    IFNE 'I'                                       192595
     C                     MOVELINRCO1    Q#ACCT                          CFT014
     C                     EXSR SRFLGL                                                      HVB005
     C*****      6         SUBSTQ#ACCT:1  W#CNU1                                     CGL029 HVB005
     C*****      3         SUBSTQ#ACCT:7  Q#CCY1                                     CGL029 HVB005
     C*****      10        SUBSTQ#ACCT:10 W#ACO1                                     CGL029 HVB005
     C*****      2         SUBSTQ#ACCT:20 W#ACS1                                     CGL029 HVB005
     C*****      3         SUBSTQ#ACCT:22 Q#BRC1                                     CGL029 HVB005
     C*****                MOVE W#CNU1    Q#CNU1                                     CGL029 HVB005
     C*****                MOVE W#ACO1    Q#ACO1                                     CGL029 HVB005
     C*****                MOVE W#ACS1    Q#ACS1                                     CGL029 HVB005
     C                     ELSE                                           CFT014
     C                     MOVEL*BLANK    P@IBN2                          CFT014
     C                     MOVEAINRCO1    @I35                            CFT014
     C                     EXSR SLSH35                                    CFT014
     C                     MOVEA@O35      P@IBN2                          CFT014
     C                     MOVE *BLANKS   DSSDY                           CFT014
     C                     CALL 'AOIBANR4'                                CFT014
     C                     PARM           P@RTCD                          CFT014
     C                     PARM '*KEY   ' P@OPTN                          CFT014
     C                     PARM           P@IBN2                          CFT014
     C           P@ACCN    PARM           DSSDY                           CFT014
     C**********           Z-ADDIBCNUM    Q#CNU1                                       CFT014 CSD027
     C                     MOVE IBCNUM    Q#CNU1                                              CSD027
     C                     MOVE CCY       Q#CCY1                          CFT014
     C                     Z-ADDIBACOD    Q#ACO1                          CFT014
     C                     Z-ADDIBACSQ    Q#ACS1                          CFT014
     C                     MOVE IBBRCA    Q#BRC1                          CFT014
     C                     ENDIF                                          CFT014
     C                     ELSE
     C                     MOVELSNTP      Q#ATYP
     C                     MOVELSND1      Q#ACCT
     C                     EXSR SRFLGL                                                      HVB005
     C*****      6         SUBSTQ#ACCT:1  W#CNU1                                     CGL029 HVB005
     C*****      3         SUBSTQ#ACCT:7  Q#CCY1                                     CGL029 HVB005
     C*****      10        SUBSTQ#ACCT:10 W#ACO1                                     CGL029 HVB005
     C*****      2         SUBSTQ#ACCT:20 W#ACS1                                     CGL029 HVB005
     C*****      3         SUBSTQ#ACCT:22 Q#BRC1                                     CGL029 HVB005
     C*****                MOVE W#CNU1    Q#CNU1                                     CGL029 HVB005
     C*****                MOVE W#ACO1    Q#ACO1                                     CGL029 HVB005
     C*****                MOVE W#ACS1    Q#ACS1                                     CGL029 HVB005
     C                     END
     C                     ENDIF                                          CFT014
     C/COPY WNCPYSRC,FT0300C043
     C                     Z-ADDSLDT      Q#VDAT
      *
      * Set posting date according to FT Control Data
      *
     C           T#PDTI    IFEQ 'I'
     C                     Z-ADDBJRDNB    Q#PSTD
     C                     ELSE
     C           T#PDTI    IFEQ 'E'
     C                     Z-ADDSLDT      Q#PSTD
     C                     ELSE
     C           SLDT      IFLT PVDT
     C                     Z-ADDSLDT      Q#PSTD
     C                     ELSE
     C                     Z-ADDPVDT      Q#PSTD
     C                     END
     C                     END
      *
     C                     MOVEL'I'       Q#IO
     C                     MOVELSMCY      Q#CCY
     C                     MOVELPYTP      Q#TRYP
     C                     MOVELPREF      Q#PREF
     C                     Z-ADD##SMAM    Q#AMT
     C                     MOVEL'FT'      Q#MOD
     C                     MOVEL'01'      Q#OLRC
     C                     MOVEL##FTOV    Q#FTOV
     C           CAP205    IFEQ 'Y'                                                           CAP205
     C                     MOVEL'F'       Q#MTYP                                              CAP205
     C                     ENDIF                                                              CAP205
      *
      *  Call AOSPOSU0
      *
     C                     CALL 'AOSPOSU0'             9090
     C           R#RTN     PARM *BLANKS   O#RTN   7
     C*********************PARM '*ADD    'W0ACT   8                       CGL009
     C                     PARM '*ADD    'W2ACT   8                       CGL009
     C                     PARM Q#DTA     O#DTA 256
      *
     C           *IN90     IFEQ '1'
     C           R#RTN     ORNE *BLANKS
     C                     MOVEL'AOSPOSU0'W0FILE           **************
     C                     MOVEL'*CALL   'W0KEY            * DB ERROR 23*
     C                     Z-ADD23        W0ERNB           **************
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C***********          EXSR SRERR                                     130869
     C                     EXSR SRERRA                                    130869
     C                     END
     C                     END
     C/COPY WNCPYSRC,FT0300C080
      *
      *         P A Y          I N S T R U C T I O N S
      *
     C                     CLEARQ#DTA
     C           ACBT      IFNE *BLANKS
     C                     MOVELACBT      Q#ATYP
     C                     MOVELACBK      Q#ACCT
     C                     EXSR SRFLGL                                                      HVB005
     C*****      6         SUBSTQ#ACCT:1  W#CNU1                                     CGL029 HVB005
     C*****      3         SUBSTQ#ACCT:7  Q#CCY1                                     CGL029 HVB005
     C*****      10        SUBSTQ#ACCT:10 W#ACO1                                     CGL029 HVB005
     C*****      2         SUBSTQ#ACCT:20 W#ACS1                                     CGL029 HVB005
     C*****      3         SUBSTQ#ACCT:22 Q#BRC1                                     CGL029 HVB005
     C*****                MOVE W#CNU1    Q#CNU1                                     CGL029 HVB005
     C*****                MOVE W#ACO1    Q#ACO1                                     CGL029 HVB005
     C*****                MOVE W#ACS1    Q#ACS1                                     CGL029 HVB005
     C                     MOVELACBB      Q#BRCA
     C           Q#ATYP    IFEQ 'R'                                                       AR1089518A
     C           10        SUBSTQ#ACCT:1  W#ACNO                                          AR1089518A
     C                     MOVE W#ACNO    Q#ACNO                                          AR1089518A
     C                     ENDIF                                                          AR1089518A
     C                     ELSE
     C                     MOVELBNCT      Q#ATYP
      * If not IBAN                                                       CFT004
     C           CFT004    IFNE 'Y'                                       CFT004
     C           CFT004    OREQ 'Y'                                       CFT004
     C           BNCT      ANDNE'I'                                       CFT004
     C                     MOVELBNC1      Q#ACCT
     C                     EXSR SRFLGL                                                      HVB005
     C*****      6         SUBSTQ#ACCT:1  W#CNU1                                     CGL029 HVB005
     C*****      3         SUBSTQ#ACCT:7  Q#CCY1                                     CGL029 HVB005
     C*****      10        SUBSTQ#ACCT:10 W#ACO1                                     CGL029 HVB005
     C*****      2         SUBSTQ#ACCT:20 W#ACS1                                     CGL029 HVB005
     C*****      3         SUBSTQ#ACCT:22 Q#BRC1                                     CGL029 HVB005
     C*****                MOVE W#CNU1    Q#CNU1                                     CGL029 HVB005
     C*****                MOVE W#ACO1    Q#ACO1                                     CGL029 HVB005
     C*****                MOVE W#ACS1    Q#ACS1                                     CGL029 HVB005
     C                     ELSE                                           CFT004
     C                     MOVE *BLANKS   DSSDY                           CFT004
     C                     CALL 'AOIBANR4'                                CFT004
     C                     PARM           P@RTCD                          CFT004
     C                     PARM '*KEY   ' P@OPTN                          CFT004
     C                     PARM           P@IBN  34                       CFT004
     C           P@ACCN    PARM           DSSDY                           CFT004
     C**********           Z-ADDIBCNUM    Q#CNU1                                       CFT004 CSD027
     C                     MOVE IBCNUM    Q#CNU1                                              CSD027
     C                     MOVE CCY       Q#CCY1                          CFT004
     C                     Z-ADDIBACOD    Q#ACO1                          CFT004
     C                     Z-ADDIBACSQ    Q#ACS1                          CFT004
     C                     MOVE IBBRCA    Q#BRC1                          CFT004
     C                     ENDIF                                          CFT004
     C                     END
     C                     Z-ADDPVDT      Q#VDAT
      *
      * Set posting date according to FT Control Data
      *
     C           T#PDTI    IFEQ 'I'
     C                     Z-ADDBJRDNB    Q#PSTD
     C                     ELSE
     C           T#PDTI    IFEQ 'E'
     C                     Z-ADDPVDT      Q#PSTD
     C                     ELSE
     C           SLDT      IFLT PVDT
     C                     Z-ADDSLDT      Q#PSTD
     C                     ELSE
     C                     Z-ADDPVDT      Q#PSTD
     C                     END
     C                     END
     C                     END
      *
     C                     MOVEL'O'       Q#IO
     C                     MOVELPCCY      Q#CCY
     C                     MOVELPYTP      Q#TRYP
     C                     MOVELPREF      Q#PREF
     C                     Z-SUB##PYAM    Q#AMT
     C                     MOVEL'FT'      Q#MOD
     C                     MOVEL'01'      Q#OLRC
     C                     MOVEL##FTOV    Q#FTOV
     C           CAP205    IFEQ 'Y'                                                           CAP205
     C                     MOVEL'F'       Q#MTYP                                              CAP205
     C                     ENDIF                                                              CAP205
     C/COPY WNCPYSRC,FTH00498
      *
      *  Call AOSPOSU0
      *
     C                     CALL 'AOSPOSU0'             9090
     C           R#RTN     PARM *BLANKS   O#RTN   7
     C*********************PARM '*ADD    'W0ACT   8                       CGL009
     C                     PARM '*ADD    'W2ACT   8                       CGL009
     C                     PARM Q#DTA     O#DTA 256
      *
     C           *IN90     IFEQ '1'
     C           R#RTN     ORNE *BLANKS
     C                     MOVEL'AOSPOSU0'W0FILE           **************
     C                     MOVEL'*CALL   'W0KEY            * DB ERROR 24*
     C                     Z-ADD24        W0ERNB           **************
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C***********          EXSR SRERR                                     130869
     C                     EXSR SRERRA                                    130869
     C                     END
     C/COPY WNCPYSRC,FT0300C081
      *
      *  Unwind subroutine stack name
      *
     C           EXADDI    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q       50
      *
     CSR                   ENDSR
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRADDO   : Add shadow positions to store                     *
      *                                                               *
      *  CALLED BY: SROPUP - Update database                          *
      *                                                               *
      *  CALLS    : SRERR - Report errors                             *
      *                                                               *
      *****************************************************************
     CSR         SRADDO    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q
     C                     MOVEL'SRADDO'  @STK,Q
      *                                                                                       CFT032
     C                     MOVE *BLANKS   PIBAN  34                                           CFT032
     C                     CLEARQ#DTA                                                      BUG220908
     C           ORBT      IFEQ *BLANKS                                                       CFT032
     C                     MOVELORC1      W#C1    1                                           CFT032
      *                                                                                       CFT032
     C           W#C1      IFEQ '/'                                                           CFT032
     C           34        SUBSTORC1:2    PIBAN                                               CFT032
     C           34        SUBSTORC1:2    Q#ACCT    P                                      BUG220908
     C                     ELSE                                                               CFT032
     C                     MOVELORC1      PIBAN                                               CFT032
     C                     MOVELORC1      Q#ACCT    P                                      BUG220908
     C                     ENDIF                                                              CFT032
      *                                                                                       CFT032
     C           ORCT      IFEQ 'I'                                                           CFT032
     C                     CALL 'AOIBANR4'                                                    CFT032
     C                     PARM           @RTCD                                               CFT032
     C                     PARM '*KEY   ' @OPTN                                               CFT032
     C                     PARM           PIBAN                                               CFT032
     C           P@ACCT    PARM *BLANKS   DSSDY                                               CFT032
     C**********           ENDIF                                                       CFT032 250600
      *                                                                                       CFT032
     C********** @RTCD     IFNE *BLANKS                                              CFT032 BUG15042
     C********** P@CNUM    CAT  P@ACOD    PIBAN     P                                CFT032 BUG15042
     C           @RTCD     IFEQ *BLANKS                                                     BUG15042
     C           P@CNUM    CAT  P@CCY     PIBAN     P                                       BUG15042
     C                     CAT  P@ACOD:0  PIBAN                                             BUG15042
     C                     CAT  P@ACSQ:0  PIBAN                                               CFT032
     C                     CAT  P@BRCA:0  PIBAN                                               CFT032
     C                     MOVELPIBAN     Q#ACCT    P                                      BUG220908
     C                     ENDIF                                                              CFT032
     C                     ENDIF                                                              250600
      *                                                                                       CFT032
     C                     ENDIF                                                              CFT032
      *                                                                   CFT014
      * Charging option is OUR we need to add the charges of the receiver CFT014
      * of the message. (OUR => add/deduct is A)                          CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
     C           F7RCRM    IFNE 0                                         CFT014
     C           V#ADDC    IFEQ 'A'                                       CFT014
     C                     ADD  OPRCRM    ##PYAM                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *
      *  Move fields to C#DTA structure and call AOSPOSU0
      *
      *         S E T T L E    I N S T R U C T I O N S
      *
      *  Only execute if Outgoing Payment not generated
      *
     C*****                CLEARQ#DTA                                                      BUG220908
     C           ORBT      IFNE *BLANKS
     C                     MOVELORBT      Q#ATYP
     C                     MOVELORBK      Q#ACCT
     C                     EXSR SRFLGL                                                      HVB005
     C*****      6         SUBSTQ#ACCT:1  W#CNU1                                     CGL029 HVB005
     C*****      3         SUBSTQ#ACCT:7  Q#CCY1                                     CGL029 HVB005
     C*****      10        SUBSTQ#ACCT:10 W#ACO1                                     CGL029 HVB005
     C*****      2         SUBSTQ#ACCT:20 W#ACS1                                     CGL029 HVB005
     C*****      3         SUBSTQ#ACCT:22 Q#BRC1                                     CGL029 HVB005
     C*****                MOVE W#CNU1    Q#CNU1                                     CGL029 HVB005
     C*****                MOVE W#ACO1    Q#ACO1                                     CGL029 HVB005
     C*****                MOVE W#ACS1    Q#ACS1                                     CGL029 HVB005
     C                     MOVELORBB      Q#BRCA
     C           Q#ATYP    IFEQ 'R'                                                       AR1089518A
     C           10        SUBSTQ#ACCT:1  W#ACNO                                          AR1089518A
     C                     MOVE W#ACNO    Q#ACNO                                          AR1089518A
     C                     ENDIF                                                          AR1089518A
     C                     ELSE
     C                     MOVELORCT      Q#ATYP
     C**********           MOVELORC1      Q#ACCT                                              CFT032
     C*********            MOVELPIBAN     Q#ACCT                                     BUG220908CFT032
     C                     EXSR SRFLGL                                                      HVB005
     C*****      6         SUBSTQ#ACCT:1  W#CNU1                                     CGL029 HVB005
     C*****      3         SUBSTQ#ACCT:7  Q#CCY1                                     CGL029 HVB005
     C*****      10        SUBSTQ#ACCT:10 W#ACO1                                     CGL029 HVB005
     C*****      2         SUBSTQ#ACCT:20 W#ACS1                                     CGL029 HVB005
     C*****      3         SUBSTQ#ACCT:22 Q#BRC1                                     CGL029 HVB005
     C*****                MOVE W#CNU1    Q#CNU1                                     CGL029 HVB005
     C*****                MOVE W#ACO1    Q#ACO1                                     CGL029 HVB005
     C*****                MOVE W#ACS1    Q#ACS1                                     CGL029 HVB005
     C                     END
     C/COPY WNCPYSRC,FT0300C044
     C                     Z-ADDSLDT      Q#VDAT
      *
      * Set posting date according to FT Control Data
      *
     C           T#PDTI    IFEQ 'I'
     C                     Z-ADDBJRDNB    Q#PSTD
     C                     ELSE
     C           T#PDTI    IFEQ 'E'
     C                     Z-ADDSLDT      Q#PSTD
     C                     ELSE
     C           SLDT      IFLT PVDT
     C                     Z-ADDSLDT      Q#PSTD
     C                     ELSE
     C                     Z-ADDPVDT      Q#PSTD
     C                     END
     C                     END
     C                     END
      *
     C                     MOVEL'I'       Q#IO
     C                     MOVELSMCY      Q#CCY
     C                     MOVELPYTP      Q#TRYP
     C                     MOVELPREF      Q#PREF
     C                     Z-ADD##SMAM    Q#AMT
     C                     MOVEL'FT'      Q#MOD
     C                     MOVEL'01'      Q#OLRC
     C                     MOVEL##FTOV    Q#FTOV
     C           CAP205    IFEQ 'Y'                                                           CAP205
     C                     MOVEL'F'       Q#MTYP                                              CAP205
     C                     ENDIF                                                              CAP205
      *
      *  Call AOSPOSU0
      *
     C                     CALL 'AOSPOSU0'             9090
     C           R#RTN     PARM *BLANKS   O#RTN   7
     C*********************PARM '*ADD    'W0ACT   8                       CGL009
     C                     PARM '*ADD    'W2ACT   8                       CGL009
     C                     PARM Q#DTA     O#DTA 256
      *
     C           *IN90     IFEQ '1'
     C           R#RTN     ORNE *BLANKS
     C                     MOVEL'AOSPOSU0'W0FILE           **************
     C                     MOVEL'*CALL   'W0KEY            * DB ERROR 25*
     C                     Z-ADD25        W0ERNB           **************
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C***********          EXSR SRERR                                     130869
     C                     EXSR SRERRA                                    130869
     C                     END
     C/COPY WNCPYSRC,FT0300C082
      *
      *         P A Y          I N S T R U C T I O N S
      *
     C                     CLEARQ#DTA
     C           SNCT      IFNE *BLANKS
     C                     MOVELSNCT      Q#ATYP
     C                     MOVELSNCO      Q#ACCT
     C                     EXSR SRFLGL                                                      HVB005
     C*****      6         SUBSTQ#ACCT:1  W#CNU1                                     CGL029 HVB005
     C*****      3         SUBSTQ#ACCT:7  Q#CCY1                                     CGL029 HVB005
     C*****      10        SUBSTQ#ACCT:10 W#ACO1                                     CGL029 HVB005
     C*****      2         SUBSTQ#ACCT:20 W#ACS1                                     CGL029 HVB005
     C*****      3         SUBSTQ#ACCT:22 Q#BRC1                                     CGL029 HVB005
     C*****                MOVE W#CNU1    Q#CNU1                                     CGL029 HVB005
     C*****                MOVE W#ACO1    Q#ACO1                                     CGL029 HVB005
     C*****                MOVE W#ACS1    Q#ACS1                                     CGL029 HVB005
     C                     ELSE
     C                     MOVELDSTT      Q#ATYP
     C                     MOVELDST1      Q#ACCT
     C                     EXSR SRFLGL                                                      HVB005
     C*****      6         SUBSTQ#ACCT:1  W#CNU1                                     CGL029 HVB005
     C*****      3         SUBSTQ#ACCT:7  Q#CCY1                                     CGL029 HVB005
     C*****      10        SUBSTQ#ACCT:10 W#ACO1                                     CGL029 HVB005
     C*****      2         SUBSTQ#ACCT:20 W#ACS1                                     CGL029 HVB005
     C*****      3         SUBSTQ#ACCT:22 Q#BRC1                                     CGL029 HVB005
     C*****                MOVE W#CNU1    Q#CNU1                                     CGL029 HVB005
     C*****                MOVE W#ACO1    Q#ACO1                                     CGL029 HVB005
     C*****                MOVE W#ACS1    Q#ACS1                                     CGL029 HVB005
     C                     END
     C/COPY WNCPYSRC,FT0300C045
     C                     Z-ADDPVDT      Q#VDAT
      *
      * Set posting date according to FT Control Data
      *
     C           T#PDTI    IFEQ 'I'
     C                     Z-ADDBJRDNB    Q#PSTD
     C                     ELSE
     C           T#PDTI    IFEQ 'E'
     C                     Z-ADDPVDT      Q#PSTD
     C                     ELSE
     C           SLDT      IFLT PVDT
     C                     Z-ADDSLDT      Q#PSTD
     C                     ELSE
     C                     Z-ADDPVDT      Q#PSTD
     C                     END
     C                     END
     C                     END
      *
     C                     MOVEL'O'       Q#IO
     C                     MOVELPCCY      Q#CCY
     C                     MOVELPYTP      Q#TRYP
     C                     MOVELPREF      Q#PREF
     C                     Z-SUB##PYAM    Q#AMT
     C                     MOVEL'FT'      Q#MOD
     C                     MOVEL'01'      Q#OLRC
     C                     MOVEL##FTOV    Q#FTOV
     C           CAP205    IFEQ 'Y'                                                           CAP205
     C                     MOVEL'F'       Q#MTYP                                              CAP205
     C                     ENDIF                                                              CAP205
     C/COPY WNCPYSRC,FTH00499
      *
      *  Call AOSPOSU0
      *
     C                     CALL 'AOSPOSU0'             9090
     C           R#RTN     PARM *BLANKS   O#RTN   7
     C*********************PARM '*ADD    'W0ACT   8                       CGL009
     C                     PARM '*ADD    'W2ACT   8                       CGL009
     C                     PARM Q#DTA     O#DTA 256
      *
     C           *IN90     IFEQ '1'
     C           R#RTN     ORNE *BLANKS
     C                     MOVEL'AOSPOSU0'W0FILE           **************
     C                     MOVEL'*CALL   'W0KEY            * DB ERROR 26*
     C                     Z-ADD26        W0ERNB           **************
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C***********          EXSR SRERR                                     130869
     C                     EXSR SRERRA                                    130869
     C                     END
     C/COPY WNCPYSRC,FT0300C083
      *
      *  Unwind subroutine stack name
      *
     C           EXADDO    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q       50
      *
     CSR                   ENDSR
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRUPD    : Update database with shadow positions             *
      *                                                               *
      *  CALLED BY: UPDATE - Update database                          *
      *                                                               *
      *  CALLS    : SRERR - Report errors                             *
      *                                                               *
      *****************************************************************
     CSR         SRUPD     BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q
     C                     MOVEL'SRUPD'   @STK,Q
      *
      *  Call AOSPOSU0 to update database
      *
     C                     CALL 'AOSPOSU0'             9090
     C           R#RTN     PARM *BLANKS   O#RTN   7
     C*********************PARM '*UPDATE 'W0ACT   8                       CGL009
     C                     PARM '*UPDATE 'W2ACT   8                       CGL009
     C                     PARM Q#DTA     O#DTA 256
      *
     C           *IN90     IFEQ '1'
     C           R#RTN     ORNE *BLANKS
     C                     MOVEL'AOSPOSU0'W0FILE           **************
     C                     MOVEL'*CALL   'W0KEY            * DB ERROR 27*
     C                     Z-ADD27        W0ERNB           **************
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C***********          EXSR SRERR                                     130869
     C                     EXSR SRERRA                                    130869
     C                     END
     C/COPY WNCPYSRC,FT0300C084
      *
      *  Unwind subroutine stack name
      *
     C           EXUPD     TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRDAFD   : Format DAF dates for file                         *
      *                                                               *
      *  CALLED BY: UPDATE - Update database                          *
      *                                                               *
      *  CALLS    : SRERR - Report errors                             *
      *                                                               *
      *****************************************************************
     CSR         SRDAFD    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q
     C                     MOVEL'SRDAFD'  @STK,Q
      *
      *  Define date formats
      *
     C           *LIKE     DEFN SLDT      W#MDTE
     C           *LIKE     DEFN SLDTD1    W#DAF1
     C           *LIKE     DEFN SLDTD2    W#DAF2
     C           *LIKE     DEFN SLDTD3    W#DAF3
      *
      *  Format Daf format 1
      *
     C                     CALL 'ZDATE2'               9090Entry parameter
     C                     PARM W#MDTE    ZDAYNO  50       Value date
     C                     PARM WUDFF     ZDATFM  1        Date format ind
     C                     PARM           ZDATE   60       Value date
     C                     PARM           ZADATE  7        Run-date in DDM
      *
     C                     MOVE ZDATE     W#DAF1
      *
      * Format Daf format 3
      *
     C                     MOVEL*BLANKS   W#DAF3
     C           WUDFF     IFEQ 'M'
     C                     MOVELZDATE     SWDT1
     C           2         SUBSTSWDT1:1   MM
     C           2         SUBSTSWDT1:3   YY
     C           2         SUBSTSWDT1:5   DD
     C                     MOVELSWDT2     W#DAF3
     C                     ELSE
      *
      * DDMMYY format display
      *
     C                     MOVELZDATE     SWDT1
     C           2         SUBSTSWDT1:1   YY
     C           2         SUBSTSWDT1:3   MM
     C           2         SUBSTSWDT1:5   DD
     C                     MOVELSWDT2     W#DAF3
     C                     END
      *
      * Format Daf format 2
      *
     C***********DD        IFLT '71'                                      124673
     C           DD        IFLT '72'                                      124673
     C                     Z-ADD20        W#DAF2
     C                     ELSE
     C                     Z-ADD19        W#DAF2
     C                     END
      *
      *  Unwind subroutine stack name
      *
     C           EXDAFD    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRFTST   : Update Incoming Message FT Transaction Status     *
      *             File record                                       *
      *  CALLS    : SRERR   - report error and close down program     *
      *                                                               *
      *                                                               *
      *  CALLED BY: SRINUP  - Update database                         *
      *             SROTUP  - Update Database                         *
      *                                                               *
      *****************************************************************
     CSR         SRFTST    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q
     C                     MOVEL'SRFTST'  @STK,Q
      *
      *  Fill record format data structure with available data
      *
     C                     CLEARINFT
      *
     C**********           MOVELV#FRGL    FTFRWR 18                                           CGL029
     C**********           MOVELV#TOGL    FTTOWR 18                                           CGL029
     C                     MOVELV#FRGL    FTFRWR 24                                           CGL029
     C                     MOVELV#TOGL    FTTOWR 24                                           CGL029
      *
     C                     Z-ADDOPMSGR    FTMSGR           Unique Ref.
     C                     Z-ADDOPKPRT    FTKPRT           Part No.
     C                     MOVELBRCA      FTBRCA           Branch Code
     C           PYTP      IFEQ 'IN'
     C                     MOVEL'*FT INC 'W2ACT
     C                     MOVELW0FLAG    FTINFG           Incoming Flag
     C                     MOVELPREF      FTIPRF           Incg. Pay. Ref
     C                     ELSE
     C                     MOVEL'*FT OUT 'W2ACT
     C                     MOVELW0FLAG    FTOTFG           Outgoing Flag
     C                     MOVELPREF      FTOPRF           Outg. Pay. Ref
     C                     END
     C                     MOVELFTFRWR    FTFRGL           Funds From
     C                     MOVELFTTOWR    FTTOGL           Funds To
     C/COPY WNCPYSRC,FT0300C072
      *
     C                     MOVELW0LMSG    W2LMSG           Log file Msg ID
     C                     MOVELPNWRK     W2NWRK           Network
      *
      *  N.B. Audit Stamp details are determined in called program
      *
      *
      *  Set up data to be passed using the rcd format data structure
      *
     C                     CALL 'ME1050'               90
     C                     PARM           W2ACT   8
     C                     PARM ##PGM     W2CPGM 10
     C                     PARM           W2NWRK  6
     C                     PARM           W2LMSG  7
     C                     PARM           INFT
     C                     PARM *BLANKS   W2RTN   7
      *
      *  If return with an error (LR seton in called program) then
      *  process for database error.
      *
     C           *IN90     IFEQ '1'
     C           W2RTN     OREQ '*ERROR*'
     C                     MOVEL'ME1050  'W0FILE           ***************
     C                     MOVEL'*CALL'   W0KEY            * DB ERROR 28 *
     C                     Z-ADD28        W0ERNB           ***************
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C***********          EXSR SRERR                                     130869
     C                     EXSR SRERRA                                    130869
     C                     END
      *
      *  Unwind subroutine stack name
      *
     C           EXFTST    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
     E/COPY FTCPYSRC,SFTSNMSC
      *****************************************************************   122060
     C/EJECT                                                              122060
      *****************************************************************   122060
      *                                                               *   122060
      *  SRRVBB   : Retrieve Before Balance                           *   122060
      *                                                               *   122060
      *  CALLED BY: SRINUP - Validate Incoming Payments Update        *   122060
      *                                                               *   122060
      *****************************************************************   122060
     C           SRRVBB    BEGSR                                          122060
      *                                                                   122060
      ** Set up subroutine stack name                                     122060
      *                                                                   122060
     C                     ADD  1         Q       50                      122060
     C                     MOVEL'SRRVBB'  @STK,Q                          122060
      *                                                                   122060
      ** Define Keylist(s)                                                122060
      *                                                                   122060
      ** ACNUM Key                                                        122060
      *                                                                   122060
      ** REPDRIL1 Key                                                     122060
      *                                                                   122060
     C           KLPDRI    KLIST                                          122060
     C                     KFLD           KDRNO  16                       122060
     C                     KFLD           KODRN  16                       122060
     C                     KFLD           KACDE   3                       122060
      *                                                                   122060
     C           PMTPY     IFEQ 'DIA'                                     122060
     C                     MOVELP54       DSTRAN                          122060
     C                     MOVELTMLIN     KACNO                           122060
      *                                                                   122060
      **  Retrieve Account Details.                                       122060
      *                                                                   122060
     C                     OPEN ACNUM                                     122060
     C           KLACNO    CHAINACNUM                90                   122060
     C                     CLOSEACNUM                                     122060
     C           *IN90     IFEQ '1'                                       122060
     C                     Z-ADD38        W0ERNB           ************** 122060
     C                     MOVEL'ACNUM'   W0FILE           *DB ERROR 38 * 122060
     C                     MOVELKACNO     W0KEY            ************** 122060
     C                     MOVEL'MEM5002' W0MSGD                          122060
     C                     MOVEL'MIDAS  ' W0MSGF                          122060
     C                     EXSR SRERRA                                    122060
     C                     ENDIF                                          122060
      *                                                                   122060
     C                     MOVELANAM      ROFAFN                          122060
      *                                                                   122060
      ** Set up account details                                           122060
      *                                                                   122060
     C**********           Z-ADDCNUM      @CNUM                                        122060 CSD027
     C                     MOVE CNUM      @CNUM                                               CSD027
     C                     MOVELCCY       @CCY                            122060
     C                     Z-ADDACOD      @ACOD                           122060
     C                     Z-ADDACSQ      @ACSQ                           122060
     C                     MOVELABRCA     @BRCA                           122060
      *                                                                   122060
      **  Retrieve Passbook Indicator.                                    122060
      *                                                                   122060
     C                     OPEN REIAC                                     122060
     C           KLACNT    CHAINREIAC                90                   122060
     C                     CLOSEREIAC                                     122060
      *                                                                   122060
     C           *IN90     IFEQ '0'                                       122060
     C           RECI      ANDEQ'D'                                       122060
      *                                                                   122060
     C           PBKU      IFEQ 'Y'                                       122060
     C                     MOVEL'Y'       ROPBFL                          122060
     C                     ELSE                                           122060
     C                     MOVEL'N'       ROPBFL                          122060
     C                     ENDIF                                          122060
      *                                                                   122060
     C                     ELSE                                           122060
     C                     Z-ADD39        W0ERNB           ************** 122060
     C                     MOVEL'REIAC'   W0FILE           *DB ERROR 39 * 122060
     C                     MOVEL@ACCN     W0KEY            ************** 122060
     C                     MOVEL'MEM5002' W0MSGD                          122060
     C                     MOVEL'MIDAS  ' W0MSGF                          122060
     C                     EXSR SRERRA                                    122060
     C                     ENDIF                                          122060
      *                                                                   122060
      **  Retrieve Customer Shortname.                                    122060
      *                                                                   122060
     C                     MOVELCNUM      @@CNUM  6                       122060
     C                     CALL 'AOCUSTR0'                                122060
     C                     PARM *BLANKS   @RTCD   7                       122060
     C                     PARM '*KEY   ' @OPTN   7                       122060
     C                     PARM @@CNUM    @KEY1  10                       122060
     C                     PARM *BLANKS   @KYST   7                       122060
     C***********SDCUST    PARM SDCUST    DSFDY                     122060176443
     C           SDCUST    PARM SDCUST    DSSDY                           176443
      *                                                                   122060
     C           @RTCD     IFEQ *BLANKS                                   122060
     C                     MOVELBBCSSN    ROFASN                          122060
      *                                                                   122060
     C                     ELSE                                           122060
     C                     Z-ADD40        W0ERNB           ************** 122060
     C                     MOVEL'SDCUSTPD'W0FILE           *DB ERROR 40 * 122060
     C                     MOVEL@@CNUM    W0KEY            ************** 122060
     C                     MOVEL'MEM5002' W0MSGD                          122060
     C                     MOVEL'MIDAS  ' W0MSGF                          122060
     C                     EXSR SRERRA                                    122060
     C                     ENDIF                                          122060
      *                                                                   122060
      **  Get currency details                                            122060
      *                                                                   122060
     C                     CALL 'AOCURRR0'                                122060
     C                     PARM *BLANKS   @RTCD   7                       122060
     C                     PARM '*KEY   ' @OPTN   7                       122060
     C                     PARM CCY       @CURR   3                       122060
     C           SDCURR    PARM SDCURR    DSSDY                           122060
      *                                                                   122060
      ** If record found                                                  122060
      *                                                                   122060
     C           @RTCD     IFEQ *BLANK                                    122060
     C                     MOVELA6NBDP    @CYDP                           122060
     C                     ELSE                                           122060
     C                     Z-ADD41        W0ERNB           ************** 122060
     C                     MOVEL'SDCURRPD'W0FILE           *DB ERROR 41 * 122060
     C                     MOVELCCY       W0KEY            ************** 122060
     C                     MOVEL'MEM5002' W0MSGD                          122060
     C                     MOVEL'MIDAS  ' W0MSGF                          122060
     C                     EXSR SRERRA                                    122060
     C                     ENDIF                                          122060
      *                                                                   122060
     C                     MOVELCCY       @CCY                            122060
     C                     Z-ADDRRNM      @RRNM                           122060
     C                     Z-ADDODLN      @ODLN                           122060
     C                     Z-ADDODED      @ODED                           122060
     C                     Z-ADDHELD      @HELD                           122060
     C**********           MOVE CCY       ACCY    3                                     145752CFT009
     C                     MOVE CCY       ACCY                                                CFT009
     C                     EXSR RTBALC                                    122060
      *                                                                   122060
     C           *IN80     IFEQ '0'                                       122060
      *                                                                   122060
     C                     MOVEL'+'       ROAVBS                          122060
      *                                                                   122060
     C           @AVBL     IFLT 0                                         122060
     C                     Z-SUB@AVBL     @AVBL                           122060
     C                     MOVEL'-'       ROAVBS                          122060
     C                     ENDIF                                          122060
      *                                                                   122060
     C                     MOVE @AVBL     ZFIELD                          122060
     C                     Z-ADDA6NBDP    ZADEC                           122060
     C                     EXSR ZEDIT                                     122060
     C                     MOVE ZFIELD    ROAVBL                          122060
      *                                                                   122060
     C                     ENDIF                                          122060
      *                                                                   122060
     C                     ENDIF                                          122060
      *                                                                   122060
      ** Unwind subroutine stack name                                     122060
      *                                                                   122060
     C           EXRVBB    TAG                                            122060
     C                     MOVEA*BLANKS   @STK,Q                          122060
     C                     SUB  1         Q                               122060
      *                                                                   122060
     C                     ENDSR                                          122060
      *****************************************************************   130869
     C/EJECT                                                              130869
      *****************************************************************   130869
      *                                                               *   130869
      *  SRREPL   : Send Return Message to CASHIER                    *   130869
      *                                                               *   130869
      *  CALLED BY: Main processing                                   *   130869
      *                                                               *   130869
      *****************************************************************   130869
     CSR         SRREPL    BEGSR                                          130869
      *                                                                   130869
      ** Set up subroutine stack name                                     130869
      *                                                                   130869
     C                     ADD  1         Q       50                      130869
     C                     MOVEL'SRREPL'  @STK,Q                          130869
      *                                                                   130869
      ** Define Keylist(s)                                                130869
      *                                                                   130869
      ** ACNUM Key                                                        130869
     C           KLACNO    KLIST                                          130869
     C                     KFLD           KACNO  100                      130869
      *                                                                   130869
      ** REIAC Key                                                        130869
     C           KLACNT    KLIST                                          130869
     C                     KFLD           @CNUM                           130869
     C                     KFLD           @CCY                            130869
     C                     KFLD           @ACOD                           130869
     C                     KFLD           @ACSQ                           130869
     C                     KFLD           @BRCA                           130869
      *                                                                   130869
     C                     MOVEL'DIRQ'    ROMSTY                          130869
      *                                                                   130869
      ** Workstation ID                                                   130869
      *                                                                   130869
     C                     MOVELCASH      DSTRAN                          130869
     C                     MOVELTWKID     ROWKID                          130869
      *                                                                   130869
      ** Successful Transaction                                           130869
      *                                                                   130869
     C           ##OK      IFEQ 'Y'                                       130869
     C                     MOVEL'C'       ROHMSS                          122060
      *                                                                   130869
      ** Host Reference                                                   130869
      *                                                                   130869
     C                     MOVELPREF      ROHRF1                          130869
     C                     MOVELPREF      ROHRF2                          130869
     C                     MOVELPREF      ROHRF3                          130869
     C                     MOVELPREF      ROHRF4                          130869
      *                                                                   130869
      ** For Account Transfer Transaction                                 130869
      *                                                                   130869
     C           PMTPY     IFEQ 'DIA'                                     130869
      *                                                                   130869
     C                     MOVELCCY       @CCY                            130869
     C                     Z-ADDRRNM      @RRNM                           130869
     C                     Z-ADDODLN      @ODLN                           130869
     C                     Z-ADDODED      @ODED                           130869
     C                     Z-ADDHELD      @HELD                           130869
     C**********           MOVE CCY       ACCY    3                                     145752CFT009
     C                     MOVE CCY       ACCY                                                CFT009
     C                     EXSR RTBALC                                    130869
      *                                                                   130869
     C           *IN80     IFEQ '0'                                       130869
      *                                                                   130869
     C                     MOVEL'+'       ROAVBS                          130869
      *                                                                   130869
     C           @AVBL     IFLT 0                                         130869
     C                     Z-SUB@AVBL     @AVBL                           130869
     C                     MOVEL'-'       ROAVBS                          130869
     C                     END                                            130869
      *                                                                   130869
     C                     MOVE @AVBL     ZFIELD                          130869
     C                     Z-ADDA6NBDP    ZADEC                           130869
     C                     EXSR ZEDIT                                     130869
     C                     MOVE ZFIELD    ROAVBL                          130869
      *                                                                   130869
     C                     ENDIF                                          130869
      *                                                                   130869
     C                     ENDIF                                          130869
      *                                                                   130869
      ** Failed Transaction                                               130869
     C                     ELSE                                           130869
     C                     MOVE 'E'       ROHMSS                          130869
     C                     MOVE W1MSGD    ROHMSI                          130869
     C                     MOVELW1MSGT    ROHSMS                          130869
     C                     ENDIF                                          130869
      *                                                                   130869
      ** Send all relevant data to data queue                             130869
      *                                                                   130869
     C                     MOVELINTRNO    KDRNO                           122060
     C           KLPDRI    CHAINREPDRIL1             11                   122060
      *                                                                   122060
     C           *IN11     IFEQ '0'                                       122060
     C                     MOVELRNCJDQ    P@QSN                           122060
     C                     ELSE                                           122060
     C                     Z-ADD44        W0ERNB                          122060
     C                     MOVEL'REPDRIL1'W0FILE                          122060
     C                     MOVELKDRNO     W0KEY                           122060
     C                     MOVEL'MEM5002' W0MSGD                          122060
     C                     MOVEL'MIDAS  ' W0MSGF                          122060
     C                     EXSR SRERRA                                    122060
     C                     ENDIF                                          122060
      *                                                                   122060
     C                     MOVELREPDRO    P@QDS                           130869
     C                     EXSR SDQMS                                     130869
     C                     MOVEL*BLANKS   REPDRO                          130869
      *                                                                   130869
      ** Unwind subroutine stack name                                     130869
      *                                                                   130869
     C           EXREPL    TAG                                            130869
     C                     MOVEA*BLANKS   @STK,Q                          130869
     C                     SUB  1         Q                               130869
      *                                                                   130869
     CSR                   ENDSR                                          130869
      *****************************************************************   130869
     C/EJECT                                                              130869
      *****************************************************************   CFT005
      *                                                               *   CFT005
      *  SRINAU   : Auto authorise for incoming payment               *   CFT005
      *                                                               *   CFT005
      *  CALLED BY: SRINFT - Create incoming payment transaction      *   CFT005
      *                                                               *   CFT005
      *****************************************************************   CFT005
     C           SRINAU    BEGSR                                          CFT005
      *                                                                   CFT006
      ** Set up subroutine stack name                                     CFT006
      *                                                                   CFT006
     C                     ADD  1         Q       50                      CFT006
     C                     MOVEL'SRINAU'  @STK,Q                          CFT006
      *                                                                   CFT005
     C                     MOVE *BLANKS   ERAUTH  1                       CFT005
     C                     MOVE *BLANKS   @ACNT                           177335
      *                                                                   CFT005
      *** Check if payment has sufficient fund                            CFT005
      *                                                                   CFT005
     C           F1TRIT    IFEQ 'I'                                       CFT014
     C           CFT004    ANDEQ'Y'                                       CFT014
     C           F1TRIT    OREQ 'R'                                       CFT014
     C           F1TRIT    OREQ 'G'                                       CFT014
     C           F1TRIT    OREQ 'F'                                       CFT014
      *                                                                   CFT014
     C                     SELEC                                          CFT014
     C           F1TRIT    WHEQ 'F'                                       CFT014
     C           F1TRIT    OREQ 'R'                                       CFT014
     C                     MOVELS1TRIB    @ACNT                           CFT014
     C           F1TRIT    WHEQ 'G'                                       CFT014
     C**********           MOVELS1TRIB    @WRK18 18                                    CFT014 CGL029
     C                     MOVELS1TRIB    @WRK18 24                                           CGL029
     C********** 15        SUBST@WRK18    @ACNT                                        CFT014 CGL029
     C           21        SUBST@WRK18    @ACNT                                               CGL029
     C                     MOVE @WRK18    @WBRCA                          CFT014
     C           F1TRIT    WHEQ 'I'                                       CFT014
     C           CFT004    ANDEQ'Y'                                       CFT014
     C                     MOVE *BLANKS   DSSDY                           CFT014
     C                     MOVEL*BLANK    P@IBN2 34                       CFT014
     C                     MOVELS1TRIB    P@IBN2                          CFT014
     C                     CALL 'AOIBANR4'                                CFT014
     C                     PARM           P@RTCD                          CFT014
     C                     PARM '*KEY   ' P@OPTN                          CFT014
     C                     PARM           P@IBN2                          CFT014
     C           P@ACCN    PARM           DSSDY                           CFT014
     C                     MOVE IBCNUM    WGLCST                          CFT014
     C                     MOVELCCY       WGLCCY                          CFT014
     C                     MOVE IBACOD    WGLACD                          CFT014
     C                     MOVE IBACSQ    WGLSQN                          CFT014
     C                     MOVELIBBRCA    WGLBCH                          CFT014
     C                     MOVELDSGLDG    @WRK18                          CFT014
     C********** 15        SUBST@WRK18    @ACNT                                        CFT014 CGL029
     C           21        SUBST@WRK18    @ACNT                                               CGL029
     C                     MOVE @WRK18    @WBRCA                          CFT014
     C                     ENDSL                                          CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
     C***********S1RCCO    IFNE *BLANKS                             CFT005CFT014
     C           F1RCRT    IFEQ 'N'                                       CFT014
     C           F1RCRT    OREQ 'F'                                       CFT014
     C           F1RCRT    OREQ 'R'                                       CFT014
     C           F1RCRT    OREQ 'I'                                       CFT014
     C           F1RCRT    OREQ 'G'                                       CFT014
      *                                                                   CFT005
     C***********F1RCRT    IFEQ 'N'                                 CFT005CFT014
     C                     SELEC                                          CFT014
     C           F1RCRT    WHEQ 'I'                                       CFT014
     C           CFT004    ANDEQ'Y'                                       CFT014
     C                     MOVE *BLANKS   DSSDY                           CFT014
     C                     MOVEL*BLANK    P@IBN2 34                       CFT014
     C                     MOVEAS1RCO1    @I35                            CFT014
     C                     EXSR SLSH35                                    CFT014
     C                     MOVEA@O35      P@IBN2                          CFT014
     C                     CALL 'AOIBANR4'                                CFT014
     C                     PARM           P@RTCD                          CFT014
     C                     PARM '*KEY   ' P@OPTN                          CFT014
     C                     PARM           P@IBN2                          CFT014
     C           P@ACCN    PARM           DSSDY                           CFT014
     C                     MOVE IBCNUM    WGLCST                          CFT014
     C                     MOVELCCY       WGLCCY                          CFT014
     C                     MOVE IBACOD    WGLACD                          CFT014
     C                     MOVE IBACSQ    WGLSQN                          CFT014
     C                     MOVELIBBRCA    WGLBCH                          CFT014
     C                     MOVELDSGLDG    @WRK18                          CFT014
     C********** 15        SUBST@WRK18    @ACNT                                        CFT014 CGL029
     C           21        SUBST@WRK18    @ACNT                                               CGL029
     C                     MOVE @WRK18    @WBRCA                          CFT014
     C           F1RCRT    WHEQ 'N'                                       CFT014
     C                     MOVELS1RCCO    W0FLD2  2                       CFT005
     C                     MOVELW0FLD2    @ACNT                           CFT005
     C           F1RCRT    WHEQ 'G'                                       CFT014
     C**********           MOVELS1RCCO    @WRK18 18                                    CFT014 CGL029
     C                     MOVELS1RCCO    @WRK18                                              CGL029
     C********** 15        SUBST@WRK18    @ACNT                                        CFT014 CGL029
     C           21        SUBST@WRK18    @ACNT                                               CGL029
     C                     MOVE @WRK18    @WBRCA                          CFT014
     C*********************ELSE                                     CFT005CFT014
     C                     OTHER                                          CFT014
     C                     MOVELS1RCCO    @ACNT                           CFT005
     C*********************ENDIF                                    CFT005CFT014
     C                     ENDSL                                          CFT014
      *                                                                   CFT005
     C                     ELSE                                           CFT005
      *                                                                   CFT005
      *** If snd type is addr/cust rcv corr to acnt                       CFT005
      *** Sender Type can be F, R, G, C, or A.                            CFT005
      *                                                                   CFT005
     C           F1SNTP    IFNE 'C'                                       CFT005
     C           F1SNTP    ANDNE'A'                                       CFT005
     C                     MOVELS1SND1    @ACNT                           CFT005
      *                                                                   CFT005
      *** If account type is 'G', where the entry is 18 long account      CFT005
      *** of which the last 3 characters is the branch, extract it for    CFT005
      *** insufficient fund checking.                                     CFT005
      *                                                                   CFT005
     C           F1SNTP    IFEQ 'G'                                       CFT005
     C**********           MOVELS1SND1    @WRK18 18                                    CFT005 CGL029
     C********** 15        SUBST@WRK18    @ACNT                                        CFT014 CGL029
     C                     MOVELS1SND1    @WRK18                                              CGL029
     C           21        SUBST@WRK18    @ACNT                                               CGL029
     C                     MOVE @WRK18    @WBRCA                          CFT005
     C                     ENDIF                                          CFT005
      *                                                                   CFT005
     C                     ENDIF                                          CFT005
      *                                                                   CFT005
     C                     ENDIF                                          CFT005
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   MAR002
     C/COPY WNCPYSRC,FT0300MM06                                                               HVB004
     C           PNL012    IFNE 'Y'                                       MAR002
      *                                                                   CFT005
      ** Call FT0805 to check for sufficient fund using the set-up parm   CFT005
      *                                                                   CFT005
     C                     CALL 'FT0805'               42                 CFT005
     C**********           PARM           @ACNT  15                                    CFT005 CGL029
     C                     PARM           @ACNT  21                                           CGL029
     C                     PARM S1SMCY    @WCCY   3                       CFT005
     C                     PARM           @WBRCA  3                       CFT005
     C                     PARM F1SMAM    @SMAM  130                      CFT005
     C                     PARM F1SLDT    @SLDT   50                      CFT005
     C                     PARM *BLANKS   @RCD    1                       CFT005
     C                     PARM *BLANKS   @ORETB  5                                         BUG26044
     C/COPY WNCPYSRC,FT0300C085
      *                                                                   CFT005
     C                     MOVEL'FT0803'  DBPGM                           CFT005
      *                                                                   CFT005
      *** If error on call                                                CFT005
      *                                                                   CFT005
     C           @RCD      IFEQ 'E'                                       CFT005
     C           *IN42     OREQ *ON                                       CFT005
     C                     Z-ADD50        DBASE            ***************CFT005
     C                     MOVEL'FT0805'  DBFILE           * DBERR 050   *CFT005
     C                     MOVEL*BLANKS   DBKEY            ***************CFT005
     C                     OUT  LDA                                       CFT005
     C                     EXSR *PSSR                                     CFT005
     C                     ENDIF                                          CFT005
      *                                                                   CFT005
     C                     ENDIF                                          MAR002
      *                                                                   MAR002
     C/COPY WNCPYSRC,FT0300RK01                                           ERN054
      *** Insufficient funds                                              CFT005
      *                                                                   CFT005
     C           @RCD      IFEQ 'Y'                                       CFT005
     C/COPY WNCPYSRC,FT0300RK03                                           PNL012
     C                     MOVE 'Y'       ERAUTH                          CFT005
     C                     MOVEL'FTM2412' W0LMSG           Action - Msg IDCFT005
     C                     MOVEL'FTUSRMSG'W0MSGF           Msg file       CFT005
     C                     EXSR SRLOG                                     CFT005
     C                     ENDIF                                          CFT005
      *                                                                   CFT005
     C/COPY WNCPYSRC,FT0300C088
      *** Check if payment is back valued                                 CFT005
      *                                                                   CFT005
     C           F1PVDT    IFLT BJRDNB                                    CFT005
     C/COPY WNCPYSRC,FT0300DB02                                           EEE058
     C                     MOVE 'Y'       ERAUTH                          CFT005
     C                     MOVEL'FTM2413' W0LMSG           Action - Msg IDCFT005
     C                     MOVEL'FTUSRMSG'W0MSGF           Msg file       CFT005
     C                     EXSR SRLOG                                     CFT005
     C                     ENDIF                                          CFT005
     C/COPY WNCPYSRC,FT0300C032
      *                                                                   CFT005
      *** Check if settlement amount exceed threshold limit               CFT005
      *                                                                   CFT005
     C                     CALL 'AOCURRR0'                                CFT005
     C                     PARM *BLANKS   @RTCD                           CFT005
     C                     PARM '*KEY   ' @OPTN                           CFT005
     C                     PARM S1SMCY    @WCCY   3                       CFT005
     C           SDCURR    PARM SDCURR    DSSDY                           CFT005
      *                                                                   CFT005
     C           @RTCD     IFNE *BLANKS                                   CFT005
     C                     Z-ADD51        DBASE            ***************CFT005
     C                     MOVEL'SDCURRPD'DBFILE           * DBERR 051   *CFT005
     C                     MOVELS1SMCY    DBKEY            ***************CFT005
     C                     OUT  LDA                                       CFT005
     C                     EXSR *PSSR                                     CFT005
     C                     ENDIF                                          CFT005
      *                                                                   CFT005
      *** Convert threshold value to settlement equivalent                CFT005
      *                                                                   CFT005
     C           A6MDIN    IFEQ 'M'                                       CFT005
     C           BTAUDT    DIV  A6SPRT    @@AUDT 140                      CFT005
     C                     ELSE                                           CFT005
     C           BTAUDT    MULT A6SPRT    @@AUDT                          CFT005
     C                     ENDIF                                          CFT005
      *                                                                   CFT005
     C           F1SMAM    IFGT @@AUDT                                    CFT005
     C                     MOVE 'Y'       ERAUTH                          CFT005
     C                     MOVEL'FTM2414' W0LMSG           Action - Msg IDCFT005
     C                     MOVEL'FTUSRMSG'W0MSGF           Msg file       CFT005
     C                     EXSR SRLOG                                     CFT005
     C                     ENDIF                                          CFT005
      *                                                                   CFT005
     C/COPY WNCPYSRC,FT0300MM07                                                               HVB004
      *** Payment authorised                                              CFT005
      *                                                                   CFT005
     C           ERAUTH    IFEQ *BLANKS                                   CFT005
     C                     MOVE 'Y'       WAUIN                           CFT005
     C/COPY WNCPYSRC,FT0300RK04                                           PNL012
     C                     MOVELUSRID     WAUP1                           RK0001
     C                     MOVEL'FTM2415' W0LMSG           Action - Msg IDCFT005
     C                     MOVEL'FTUSRMSG'W0MSGF           Msg file       CFT005
     C                     EXSR SRLOG                                     CFT005
     C                     ENDIF                                          CFT005
      *                                                                   CFT006
      ** Unwind subroutine stack name                                     CFT006
      *                                                                   CFT006
     C           EXINAU    TAG                                            CFT006
     C                     MOVEA*BLANKS   @STK,Q                          CFT006
     C                     SUB  1         Q                               CFT006
      *                                                                   CFT005
     C                     ENDSR                                          CFT005
     C/EJECT                                                              CFT005
      *****************************************************************   CFT005
      *                                                               *   CFT005
      *  SROTAU   : Auto authorise for outgoing payment               *   CFT005
      *                                                               *   CFT005
      *  CALLED BY: SROTFT - Create outgoing payment transaction      *   CFT005
      *                                                               *   CFT005
      *****************************************************************   CFT005
     C           SROTAU    BEGSR                                          CFT005
      *                                                                   CFT006
      ** Set up subroutine stack name                                     CFT006
      *                                                                   CFT006
     C                     ADD  1         Q       50                      CFT006
     C                     MOVEL'SROTAU'  @STK,Q                          CFT006
      *                                                                   CFT005
     C                     MOVE *BLANKS   ERAUTH  1                       CFT005
     C                     MOVE *BLANKS   @ACNT                           177335
      *                                                                   CFT005
      *** Check if payment has sufficient fund                            CFT005
      *                                                                   CFT005
     C           S4ORBK    IFNE *BLANKS                                   CFT005
      *                                                                   CFT005
     C           F4ORBT    IFEQ 'N'                                       CFT005
     C                     MOVELS4ORBK    W0FLD2  2                       CFT005
     C                     MOVELW0FLD2    @ACNT                           CFT005
     C                     ENDIF                                          CFT005
      *                                                                   CFT005
     C           F4ORBT    IFEQ 'R'                                       CFT005
     C                     MOVELS4ORBK    W0FL10 10                       CFT005
     C                     MOVELW0FL10    @ACNT                           CFT005
     C                     ENDIF                                          CFT005
      *                                                                   CFT005
     C           F4ORBT    IFEQ 'P'                                       CFT005
     C                     MOVELS4ORBK    @ACNT                           CFT005
      *                                                                   CFT005
     C           WUMBIN    IFEQ 'Y'                                       CFT005
     C                     MOVE S4ORBB    @WBRCA                          CFT005
     C                     ELSE                                           CFT005
     C                     MOVE BJSBRC    @WBRCA                          CFT005
     C                     ENDIF                                          CFT005
      *                                                                   CFT005
     C                     ENDIF                                          CFT005
      *                                                                   CFT005
     C                     ELSE                                           CFT005
      *                                                                   CFT005
      *** If ord cust is addr move ord bank to acnt                       CFT005
      *                                                                   CFT005
     C           F4ORCT    IFNE 'A'                                       CFT005
     C           F4ORCT    ANDNE'C'                                       CFT005
     C           F4ORCT    IFEQ 'I'                                                           CFT032
     C                     MOVELV#FRGL    W#CNUM  6                                           CFT032
     C                     MOVE V#FRGL    @ACNT                                               CFT032
     C                     MOVELW#CNUM    @ACNT                                               CFT032
     C                     ELSE                                                               CFT032
      *                                                                                     AR856737
     C                     MOVELS4ORC1    W#SLSH  1                                         AR856737
     C           W#SLSH    IFEQ '/'                                                         AR856737
     C                     SUBSTS4ORC1:2  @ACNT                                             AR856737
     C                     ELSE                                                             AR856737
     C                     MOVELS4ORC1    @ACNT                           CFT005
     C                     ENDIF                                                            AR856737
      *                                                                                     AR856737
     C                     ENDIF                                                              CFT032
     C                     ENDIF                                          CFT005
      *                                                                   CFT005
     C                     ENDIF                                          CFT005
      *                                                                   MAR002
     C           PNL012    IFNE 'Y'                                       MAR002
      *                                                                   CFT005
      ** Call FT0805 to check for sufficient fund using the set-up parm   CFT005
      *                                                                   CFT005
     C                     CALL 'FT0805'               42                 CFT005
     C**********           PARM           @ACNT  15                                    CFT005 CGL029
     C                     PARM           @ACNT                                               CGL029
     C                     PARM S4SMCY    @WCCY   3                       CFT005
     C                     PARM           @WBRCA  3                       CFT005
     C                     PARM F4SMAM    @SMAM  130                      CFT005
     C                     PARM F4SLDT    @SLDT   50                      CFT005
     C                     PARM *BLANKS   @RCD    1                       CFT005
     C                     PARM *BLANKS   @ORETB                                            BUG26044
     C/COPY WNCPYSRC,FT0300C086
      *                                                                   CFT005
     C                     MOVEL'FT0803'  DBPGM                           CFT005
      *                                                                   CFT005
      *** If error on call                                                CFT005
      *                                                                   CFT005
     C           @RCD      IFEQ 'E'                                       CFT005
     C           *IN42     OREQ *ON                                       CFT005
     C                     Z-ADD52        DBASE            ***************CFT005
     C                     MOVEL'FT0805'  DBFILE           * DBERR 052   *CFT005
     C                     MOVEL*BLANKS   DBKEY            ***************CFT005
     C                     OUT  LDA                                       CFT005
     C                     EXSR *PSSR                                     CFT005
     C                     ENDIF                                          CFT005
      *                                                                   MAR002
     C                     ENDIF                                          MAR002
      *                                                                   CFT005
     C/COPY WNCPYSRC,FT0300RK02                                           ERN054
      *** Insufficient funds                                              CFT005
      *                                                                   CFT005
     C           @RCD      IFEQ 'Y'                                       CFT005
     C/COPY WNCPYSRC,FT0300RK05                                           PNL012
     C                     MOVE 'Y'       ERAUTH                          CFT005
     C                     MOVEL'FTM2412' W0LMSG           Action - Msg IDCFT005
     C                     MOVEL'FTUSRMSG'W0MSGF           Msg file       CFT005
     C                     EXSR SRLOG                                     CFT005
     C                     ENDIF                                          CFT005
      *                                                                   CFT005
      *** Check if payment is back valued                                 CFT005
      *                                                                   CFT005
     C           F4PVDT    IFLT BJRDNB                                    CFT005
     C/COPY WNCPYSRC,FT0300DB03                                           EEE058
     C                     MOVE 'Y'       ERAUTH                          CFT005
     C                     MOVEL'FTM2413' W0LMSG           Action - Msg IDCFT005
     C                     MOVEL'FTUSRMSG'W0MSGF           Msg file       CFT005
     C                     EXSR SRLOG                                     CFT005
     C                     ENDIF                                          CFT005
     C/COPY WNCPYSRC,FT0300C033
      *                                                                   CFT005
      *** Check if settlement amount exceed threshold limit               CFT005
      *                                                                   CFT005
     C                     CALL 'AOCURRR0'                                CFT005
     C                     PARM *BLANKS   @RTCD                           CFT005
     C                     PARM '*KEY   ' @OPTN                           CFT005
     C                     PARM S4SMCY    @WCCY   3                       CFT005
     C           SDCURR    PARM SDCURR    DSSDY                           CFT005
      *                                                                   CFT005
     C           @RTCD     IFNE *BLANKS                                   CFT005
     C                     Z-ADD53        DBASE            ***************CFT005
     C                     MOVEL'SDCURRPD'DBFILE           * DBERR 053   *CFT005
     C                     MOVELS4SMCY    DBKEY            ***************CFT005
     C                     OUT  LDA                                       CFT005
     C                     EXSR *PSSR                                     CFT005
     C                     ENDIF                                          CFT005
      *                                                                   CFT005
      *** Convert threshold value to settlement equivalent                CFT005
      *                                                                   CFT005
     C           A6MDIN    IFEQ 'M'                                       CFT005
     C           BTAUDT    DIV  A6SPRT    @@AUDT 140                      CFT005
     C                     ELSE                                           CFT005
     C           BTAUDT    MULT A6SPRT    @@AUDT                          CFT005
     C                     ENDIF                                          CFT005
      *                                                                   CFT005
     C           F4SMAM    IFGT @@AUDT                                    CFT005
     C                     MOVE 'Y'       ERAUTH                          CFT005
     C                     MOVEL'FTM2414' W0LMSG           Action - Msg IDCFT005
     C                     MOVEL'FTUSRMSG'W0MSGF           Msg file       CFT005
     C                     EXSR SRLOG                                     CFT005
     C                     ENDIF                                          CFT005
      *                                                                   CFT005
      *** Payment authorised                                              CFT005
      *                                                                   CFT005
     C           ERAUTH    IFEQ *BLANKS                                   CFT005
     C                     MOVE 'Y'       WAUIN                           CFT005
     C/COPY WNCPYSRC,FT0300RK06                                           PNL012
     C                     MOVELUSRID     WAUP1                           RK0001
     C                     MOVEL'FTM2415' W0LMSG           Action - Msg IDCFT005
     C                     MOVEL'FTUSRMSG'W0MSGF           Msg file       CFT005
     C                     EXSR SRLOG                                     CFT005
     C                     ENDIF                                          CFT005
      *                                                                   CFT006
      ** Unwind subroutine stack name                                     CFT006
      *                                                                   CFT006
     C           EXOTAU    TAG                                            CFT006
     C                     MOVEA*BLANKS   @STK,Q                          CFT006
     C                     SUB  1         Q                               CFT006
      *                                                                   CFT005
     C                     ENDSR                                          CFT005
     C/EJECT                                                              CFT005
      *****************************************************************   130869
      *                                                               *   130869
      *  SRFILA   : *PSSR Routine for All Files                       *   130869
      *                                                               *   130869
      *  CALLED BY: IBM Controlled - Invalid Access to File           *   130869
      *                                                               *   130869
      *****************************************************************   130869
     CSR         SRFILA    BEGSR                                          130869
      *                                                                   130869
     C           PNWRK     IFEQ 'CASHV8'                                  130869
      *                                                                   130869
      ** Dump program                                                     130869
      *                                                                   130869
     C                     DUMP                                           130869
     C                     ROLBK                       90                 130869
      *                                                                   130869
      ** If called again seton LR and return                              130869
      *                                                                   130869
     C           @@FILE    IFNE *BLANKS                                   130869
     C                     MOVEL'1'       *INLR                           130869
     C                     RETRN                                          130869
     C                     END                                            130869
      *                                                                   130869
     C                     MOVEL'Y'       @@FILE  1                       130869
      *                                                                   130869
      ** Send message to MOPERQ                                           130869
      *                                                                   130869
     C                     MOVEL*BLANKS   ERDTA                           130869
     C                     MOVEL##PGM     ERPGM                           130869
      *                                                                   130869
     C           Q         IFGT 1                                         130869
     C           Q         ANDLT21                                        130869
     C                     MOVEL@STK,Q    ERSTK                           130869
     C                     ELSE                                           130869
     C                     MOVEL'*Nostkin'ERSTK                           130869
     C                     END                                            130869
      *                                                                   130869
     C                     MOVEL##ERST    ERKEY                           130869
     C                     Z-ADD999       ERERNB                          130869
     C                     MOVEL##ERFL    ERFILE                          130869
     C                     MOVELW0PREF    ERPREF                          130869
      *                                                                   130869
      ** Get message for sending and place in msg field                   130869
      *                                                                   130869
     C                     CALL 'SDRTVTXT'             9090               130869
     C                     PARM 'MEM5002' #MSGID                          130869
     C                     PARM 'MIDAS   '#MSGF                           130869
     C                     PARM *BLANKS   #MSGTX                          130869
      *                                                                   130869
     C                     MOVEL#MSGTX    ERNARR                          130869
      *                                                                   130869
      ** Send message                                                     130869
      *                                                                   130869
     C                     CALL 'AOCREPT'              9090               130869
     C                     PARM 'MEM5000' #MSGID  7                       130869
     C                     PARM 'MIDAS  ' #MSGF  10                       130869
     C                     PARM *BLANKS   #MSGFL 10                       130869
     C                     PARM ERDTA     #MSGDT256                       130869
     C                     PARM '*PRV'    #MSGR   5                       130869
     C                     PARM '*'       #PRGM  10                       130869
     C                     PARM 'MOPERQ ' #MSGQ  10                       130869
     C                     PARM '*INFO  ' #MSGT   7                       130869
      *                                                                   130869
      *  Fill LDA with error data                                         130869
      *                                                                   130869
     C           *LOCK     IN   LDA                                       130869
     C                     MOVELW0KEY     DBKEY                           130869
     C                     Z-ADDW0ERNB    DBASE                           130869
     C                     MOVELW0FILE    DBFILE                          130869
     C                     MOVEL##PGM     DBPGM                           130869
     C                     OUT  LDA                                       130869
      *                                                                   130869
     C                     EXSR SRDBAS                                    130869
      *                                                                   130869
      *  Close down program                                               130869
      *                                                                   130869
     C                     SETON                     U7U8LR               130869
     C                     MOVEL'*ERROR*' W0RTN   7                       130869
     C                     RETRN                                          130869
      *                                                                   130869
     C                     ELSE                                           130869
     C                     EXSR SRFILE                                    130869
     C                     END                                            130869
      *                                                                   130869
     CSR                   ENDSR                                          130869
      *****************************************************************   130869
     C/EJECT                                                              130869
      *****************************************************************   130869
      *                                                               *   130869
      *  SRERRA   : Report Database Error and Close Down Program      *   130869
      *                                                               *   130869
      *  CALLED BY: All Subroutine                                    *   130869
      *                                                               *   130869
      *****************************************************************   130869
     CSR         SRERRA    BEGSR                                          130869
      *                                                                   130869
     C           PNWRK     IFEQ 'CASHV8'                                  130869
      *                                                                   130869
     C                     Z-ADDQ         Q       50                      130869
      *                                                                   130869
      *  Dump program                                                     130869
      *                                                                   130869
     C                     DUMP                                           130869
     C                     ROLBK                       90                 130869
      *                                                                   130869
      *  Set up the details of the message to be sent to MOPERQ           130869
      *                                                                   130869
     C                     MOVEL*BLANKS   ERDTA                           130869
     C                     MOVEL##PGM     ERPGM                           130869
      *                                                                   130869
     C           Q         IFGT 1                                         130869
     C           Q         ANDLT21                                        130869
     C                     MOVEL@STK,Q    ERSTK                           130869
     C                     ELSE                                           130869
     C                     MOVEL'*Nostkin'ERSTK                           130869
     C                     END                                            130869
      *                                                                   130869
     C                     MOVELW0KEY     ERKEY                           130869
     C                     Z-ADDW0ERNB    ERERNB                          130869
     C                     MOVELW0FILE    ERFILE                          130869
     C                     MOVELW0PREF    ERPREF                          130869
      *                                                                   130869
      * Get message for message code. If the msg code or the msg file     130869
      * have not been set up then use the defaults.                       130869
      *                                                                   130869
     C           W0MSGD    IFEQ *BLANKS                                   130869
     C                     MOVEL'MEM5001' C#FMSG  7                       130869
     C                     ELSE                                           130869
     C                     MOVELW0MSGD    C#FMSG                          130869
     C                     END                                            130869
      *                                                                   130869
     C           W0MSGF    IFEQ *BLANKS                                   130869
     C                     MOVEL'MIDAS   'C#FMSF 10                       130869
     C                     ELSE                                           130869
     C                     MOVELW0MSGF    C#FMSF                          130869
     C                     END                                            130869
      *                                                                   130869
     C                     CALL 'SDRTVTXT'             9090               130869
     C                     PARM C#FMSG    #MSGID                          130869
     C                     PARM C#FMSF    #MSGF                           130869
     C                     PARM *BLANKS   #MSGTX                          130869
      *                                                                   130869
     C                     MOVEL#MSGTX    ERNARR                          130869
      *                                                                   130869
      * Send message                                                      130869
      *                                                                   130869
     C                     CALL 'AOCREPT'              9090               130869
     C                     PARM 'MEM5000' #MSGID  7                       130869
     C                     PARM 'MIDAS  ' #MSGF  10                       130869
     C                     PARM *BLANKS   #MSGFL 10                       130869
     C                     PARM ERDTA     #MSGDT256                       130869
     C                     PARM '*PRV '   #MSGR   5                       130869
     C                     PARM '*'       #PRGM  10                       130869
     C                     PARM 'MOPERQ ' #MSGQ  10                       130869
     C                     PARM '*INFO  ' #MSGT   7                       130869
      *                                                                   130869
      *  Fill LDA with error data                                         130869
      *                                                                   130869
     C           *LOCK     IN   LDA                                       130869
     C                     MOVELW0KEY     DBKEY                           130869
     C                     Z-ADDW0ERNB    DBASE                           130869
     C                     MOVELW0FILE    DBFILE                          130869
     C                     MOVEL##PGM     DBPGM                           130869
     C                     OUT  LDA                                       130869
      *                                                                   130869
     C                     EXSR SRDBAS                                    130869
      *                                                                   130869
      *  Close down program                                               130869
      *                                                                   130869
     C                     SETON                     U7U8LR               130869
     C                     MOVEL'*ERROR*' W0RTN   7                       130869
     C                     RETRN                                          130869
      *                                                                   130869
     C                     ELSE                                           130869
     C                     EXSR SRERR                                     130869
     C                     END                                            130869
      *                                                                   130869
     CSR                   ENDSR                                          130869
      *****************************************************************   130869
     C/EJECT                                                              130869
      *****************************************************************   130869
      *                                                               *   130869
      *  SRDBAS   : Send Database Error to the Cashier                *   130869
      *                                                               *   130869
      *  CALLED BY: SRFILA - *PSSR Routine for all Files              *   130869
      *                                                               *   130869
      *****************************************************************   130869
     CSR         SRDBAS    BEGSR                                          130869
      *                                                                   130869
     C                     MOVEL'DIRQ'    ROMSTY                          130869
      *                                                                   130869
      ** Workstation ID                                                   130869
     C                     MOVELCASH      DSTRAN                          130869
     C                     MOVELTWKID     ROWKID                          130869
      *                                                                   130869
     C                     MOVELERDTA     ROHSMS                          130869
     C                     MOVEL'DBER'    ROHMSI                          130869
     C                     MOVEL'E'       ROHMSS                          130869
      *                                                                   130869
     C                     MOVELREPDRO    P@QDS                           130869
     C                     EXSR SDQMS                                     130869
     C                     MOVEL*BLANKS   REPDRO                          130869
      *                                                                   130869
     CSR                   ENDSR                                          130869
      *****************************************************************   130869
     C/EJECT                                                              122060
      *****************************************************************   122060
      *                                                               *   122060
      *  *PSSR  Subroutine to handle abnormal error conditions        *   122060
      *                                                               *   122060
      *  Called by:  FIRST                                            *   122060
      *                                                               *   122060
      *  Calls    :  -                                                *   122060
      *                                                               *   122060
      *****************************************************************   122060
     C           *PSSR     BEGSR                           ** *PSSR **    122060
      *                                                                   122060
     C           @RUN      IFEQ *BLANKS                                   122060
     C                     MOVE 'Y'       @RUN    1                       122060
     C                     DUMP                                           122060
     C                     END                                            122060
      *                                                                   122060
     C                     MOVE '1'       *INU7                           122060
     C                     MOVE '1'       *INU8                           122060
     C                     MOVE '1'       *INLR                           122060
      *                                                                   122060
     C                     RETRN                                          122060
      *                                                                   122060
     C                     ENDSR                           ** *PSSR **    122060
      *****************************************************************   122060
      /EJECT                                                              122060
      *****************************************************************   122060
      *                                                               *   122060
      *            DBERR  - Database Error Handling                   *   122060
      *                                                               *   122060
      * CALLS      *PSSR  - Program  error                            *   122060
      *                                                               *   122060
      * CALLED BY         -                                           *   122060
      *                                                               *   122060
      * FLDS USED         -                                           *   122060
      *                                                               *   122060
      *****************************************************************   122060
     C           DBERR     BEGSR                           ** DBERR  **   122060
      *                                                                   122060
     C                     MOVEL'FT0300'  DBPGM                           122060
     C                     OUT  LDA                                       122060
      *                                                                   122060
     C                     EXSR *PSSR                                     122060
      *                                                                   122060
     C                     ENDSR                                          122060
      *****************************************************************   122060
      /EJECT                                                              122060
      *****************************************************************   122060
      *                                                               *   122060
      *            LDXRAR - Load exchange rates arrays.               *   122060
      *                                                               *   122060
      * CALLS             -                                           *   122060
      *                                                               *   122060
      * CALLED BY  VALDET - Validate details                          *   122060
      *                                                               *   122060
      * FLDS USED         -                                           *   122060
      *                                                               *   122060
      *****************************************************************   122060
     C           LDXRAR    BEGSR                           ** LDXRAR **   122060
      *                                                                   122060
     C                     OPEN REBDCCPD                                  122060
     C                     OPEN REBDCRPD                                  122060
      *                                                                   122060
     C                     SELEC                                          122060
      *                                                                   122060
     C           PFNCD     WHEQ '0JR'                                     122060
     C                     MOVEL'0JK'     WKEY                            122060
      *                                                                   122060
     C           PFNCD     WHEQ '0JW'                                     122060
     C                     MOVEL'0JL'     WKEY                            122060
      *                                                                   122060
     C           PFNCD     WHEQ '0JS'                                     122060
     C           PFNCD     OREQ '0JX'                                     122060
     C                     MOVEL'0JI'     WKEY                            122060
      *                                                                   122060
     C                     OTHER                                          122060
      *                                                                   122060
     C                     MOVELPFNCD     WKEY    3                       122060
      *                                                                   122060
     C                     ENDSL                                          122060
      *                                                                   122060
      ** Find function code in Exchange Rate Control Table                122060
      *                                                                   122060
     C           WKEY      CHAINREBDCCD0             70                   122060
      *                                                                   122060
      ** If record not found?                                             122060
      *                                                                   122060
     C           *IN70     IFEQ *ON                                       122060
     C           *LOCK     IN   LDA                                       122060
     C                     Z-ADD45        DBASE                           122060
     C                     MOVEL'REBDCCPD'DBFILE                          122060
     C                     MOVELPFNCD     DBKEY                           122060
     C                     EXSR DBERR                                     122060
     C                     END                                            122060
      *                                                                   122060
     C           @CCY      CHAINREBDCRD0             70                   122060
      *                                                                   122060
      ** Move exchange rate in accordance with function and currency code 122060
      *                                                                   122060
     C                     Z-ADD0         @RT    138                      122060
     C           FEDNRT    DIV  FEAMNT    @RT       H                     122060
     C                     Z-ADD@RT       BTR,@Z                          122060
     C           FEDPRT    DIV  FEAMNT    @RT       H                     122060
     C                     Z-ADD@RT       STR,@Z                          122060
     C           FEVNRT    DIV  FEAMNT    @RT       H                     122060
     C                     Z-ADD@RT       BCR,@Z                          122060
     C           FEVPRT    DIV  FEAMNT    @RT       H                     122060
     C                     Z-ADD@RT       SCR,@Z                          122060
      *                                                                   122060
     C                     CLOSEREBDCCPD                                  122060
     C                     CLOSEREBDCRPD                                  122060
      *                                                                   122060
     C                     ENDSR                                          122060
      *****************************************************************   122060
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRINIT   : Initialise and define fields                      *
      *                                                               *
      *  CALLED BY: Main processing                                   *
      *                                                               *
      *****************************************************************
     CSR         SRINIT    BEGSR
      *
      *  Set up copyright statement
      *
     C                     MOVEACPY@      BIS@   80
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SRINIT'  @STK,Q
      *
      *  /Copy point for Initialisation
      *
     C/COPY WNCPYSRC,FT0300INIT
     C/COPY OFCPYSRCZ,CFT135_014                                                              CFT135
      *
      *  Indicate that set up is complete
      *
      *  Access SAR details file to see if CFT003 is installed.           CFT003
      *                                                                   CFT003
     C                     CALL 'AOSARDR0'                                CFT003
     C                     PARM *BLANKS   P@RTCD  7                       CFT003
     C                     PARM '*VERIFY' P@OPTN  7                       CFT003
     C                     PARM 'CFT003'  @SARD   6                       CFT003
     C           SCSARD    PARM *BLANKS   DSFDY                           CFT003
      *                                                                   CFT003
      *  Allow Batch Authorisation processing                             CFT003
      *                                                                   CFT003
     C           P@RTCD    IFEQ *BLANKS                                   CFT003
     C           CFT003    ANDEQ*BLANKS                                   CFT003
     C                     MOVEL'CFT003'  CFT003  6                       CFT003
     C                     OPEN INPAYXL0                                  CFT003
     C                     OPEN OTPAYXL0                                  CFT003
     C                     ENDIF                                          CFT003
      *                                                                   CFT003
     C                     SETON                     50
      *                                                                                       CFT162
      ** Check if 'CFT162' is switched 'ON'                                                   CFT162
      *                                                                                       CFT162
     C                     MOVE 'N'       CFT162  1                                           CFT162
     C                     CALL 'AOSARDR0'                                                    CFT162
     C                     PARM *BLANKS   PRTCD                                               CFT162
     C                     PARM '*VERIFY' POPTN                                               CFT162
     C                     PARM 'CFT162'  PSARD                                               CFT162
     C           SCSARD    PARM SCSARD    DSFDY                                               CFT162
     C           PRTCD     IFEQ *BLANKS                                                       CFT162
     C                     MOVE 'Y'       CFT162                                              CFT162
     C           KYM901    KLIST                                                              CFT162
     C                     KFLD           @CNUM                                               CFT162
     C                     KFLD           @CCY                                                CFT162
     C                     KFLD           @ACOD                                               CFT162
     C                     KFLD           @ACSQ                                               CFT162
     C                     KFLD           @BRCA                                               CFT162
     C                     ENDIF                                                              CFT162
      *
      *  Get Rundate information
      *
     C           *NAMVAR   DEFN RUNDAT    RUNDTA
     C                     IN   RUNDTA
     C                     MOVE AGMRDT    WUMRDT  7        Midas Run date
     C                     MOVE AGRDNB    WURDNB  50       Run day number
     C                     MOVE AGSUC     WUSUC   1        Set up complete
     C                     MOVE AGDFF     WUDFF   1        Date Format
     C                     MOVE AGMBIN    WUMBIN  1        Multi Branched
      *                                                                   130869
      ** Get CASH information                                             130869
      *                                                                   130869
     C           *NAMVAR   DEFN CASH      CSHDTA                          130869
     C                     IN   CSHDTA                                    130869
      *
      *                                                                   S01408
     C/COPY WNCPYSRC,FT0300CCP8                                           S01408
      *                                                                   S01408
      *  Open files
      *
     C                     OPEN OTPAYL0
     C                     OPEN OTPAYZZ
     C                     OPEN INPAYL0
     C                     OPEN INPAYZZ
      *                                                                   S01408
     C/COPY WNCPYSRC,FT0300CCP9                                           S01408
      *                                                                   S01408
      *
      * Get modules information
      *
     C                     CALL 'AOMMODR0'             9090
     C                     PARM *BLANKS   P@RTCD  7        B:Return code
     C                     PARM '*FIRST ' P@OPTN  7        I:Option
     C           SDMMOD    PARM *BLANKS   DSFDY            O:Module Flg
      *
      *  If return with an error (LR seton in called program) then
      *  process for database error.
      *
     C           *IN90     IFEQ '1'
     C           P@RTCD    OREQ '*ERROR*'
     C                     MOVEL'AOMMODR0'W0FILE
     C                     MOVEL'*CALL'   W0KEY            ***************
     C                     Z-ADD29        W0ERNB           * DB ERROR 29 *
     C                     MOVEL'MEM5003' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C***********          EXSR SRERR                                     130869
     C                     EXSR SRERRA                                    130869
     C                     END
      *
      * Define data areas
      *
     C           *NAMVAR   DEFN OTPAYDA   OTPAYD
     C           *NAMVAR   DEFN RGPAYDA   RGPAYD
     C           *NAMVAR   DEFN INPAYDA   INPAYD
      *
      * Get default branch
      *
     C           *NAMVAR   DEFN           ZMUSER
     C                     IN   ZMUSER
      *
      *  Extract bank details
      *
     C                     CALL 'AOBANKR0'             9090
     C                     PARM *BLANKS   P@RTCD  7        B:Return code
     C                     PARM '*FIRST ' P@OPTN  7        I:Option
     C           SDBANK    PARM SDBANK    DSFDY
      *
      *  If return with an error (LR seton in called program) then
      *  process for database error.
      *
     C           *IN90     IFEQ '1'
     C           P@RTCD    OREQ '*ERROR*'
     C                     MOVEL'AOBANKR0'W0FILE
     C                     MOVEL'*CALL'   W0KEY            ***************
     C                     Z-ADD30        W0ERNB           * DB ERROR 30 *
     C                     MOVEL'MEM5003' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C***********          EXSR SRERR                                     130869
     C                     EXSR SRERRA                                    130869
     C                     END
      *                                                                   130869
      ** Set up the base currency details                                 130869
     C                     MOVE BJCYCD    @BSCY   3                       130869
     C*
     C** Extract general ledger details from SDGELRPD
     C*
     C**********           CALL 'AOGELRR0'             9090                                   CGL029
     C                     CALL 'AOGELRR1'             9090                                   CGL029
     C                     PARM *BLANKS   P@RTCD  7        B:Return code
     C                     PARM '*FIRST ' P@OPTN  7        I:Option
     C********** SDGELR    PARM SDGELR    DSFDY                                               CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
      *
      *  If return with an error (LR seton in called program) then
      *  process for database error.
      *
     C           *IN90     IFEQ '1'
     C           P@RTCD    OREQ '*ERROR*'
     C                     MOVEL'AOGELRR0'W0FILE
     C                     MOVEL'*CALL'   W0KEY            ***************
     C                     Z-ADD31        W0ERNB           * DB ERROR 31 *
     C                     MOVEL'MEM5003' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C***********          EXSR SRERR                                     130869
     C                     EXSR SRERRA                                    130869
     C                     END
      *                                                                   CFT014
      ** Memorize EURO currency code in order to pass it to the           CFT014
      ** validation programs                                              CFT014
      *                                                                   CFT014
     C                     MOVELBKEURO    V#EURO                          CFT014
      *
      ** Read SDFTFRPD
      *
     C                     CALL 'AOFTFRR0'             90
     C                     PARM *BLANKS   P@RTCD  7        B:Return code
     C                     PARM '*FIRST ' P@OPTN  7        I:Option
     C           SDFTFR    PARM SDFTFR    DSFDY
      *
      *  If return with an error (LR seton in called program) then
      *  process for database error.
      *
     C           *IN90     IFEQ '1'
     C           P@RTCD    OREQ '*ERROR*'
     C                     MOVEL'AOFTFRR0'W0FILE
     C                     MOVEL'*CALL'   W0KEY            ***************
     C                     Z-ADD32        W0ERNB           * DB ERROR 32 *
     C                     MOVEL'MEM5003' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C***********          EXSR SRERR                                     130869
     C                     EXSR SRERRA                                    130869
     C                     END
      *
      * Get data -branch indicator
      *
     C           BGRTBN    IFEQ 'Y'                        Full Retail
     C           BGIOAC    OREQ 'Y'                        Full Retail
      *                                                                   CFT014
     C                     MOVEL'Y'       V#RETL                          CFT014
      *
      ** Read SDRETLPD for retail account nos. indicator
      *
     C                     CALL 'AORETLR0'             90
     C                     PARM *BLANKS   P@RTCD
     C                     PARM '*FIRST'  P@OPTN
     C           SDRETL    PARM SDRETL    DSFDY
      *
      *  If return with an error (LR seton in called program) then
      *  process for database error.
      *
     C           *IN90     IFEQ '1'
     C           P@RTCD    OREQ '*ERROR*'
     C                     MOVEL'AORETLR0'W0FILE
     C                     MOVEL'*CALL'   W0KEY            ***************
     C                     Z-ADD33        W0ERNB           * DB ERROR 33 *
     C                     MOVEL'MEM5003' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C***********          EXSR SRERR                                     130869
     C                     EXSR SRERRA                                    130869
     C                     END
      *
     C                     END
      *
      ** Read SDTRADPD for sterling currency code
      *
     C                     CALL 'AOTRADR0'             90
     C                     PARM *BLANKS   P@RTCD  7        B:Return code
     C                     PARM '*FIRST ' P@OPTN  7        I:Option
     C           SDTRAD    PARM SDTRAD    DSFDY
      *
      *  If return with an error (LR seton in called program) then
      *  process for database error.
      *
     C           *IN90     IFEQ '1'
     C           P@RTCD    OREQ '*ERROR*'
     C                     MOVEL'AOTRADR0'W0FILE
     C                     MOVEL'*CALL'   W0KEY            ***************
     C                     Z-ADD34        W0ERNB           * DB ERROR 34 *
     C                     MOVEL'MEM5003' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C***********          EXSR SRERR                                     130869
     C                     EXSR SRERRA                                    130869
     C                     END
      *
      * Access FT Control data
      *
     C                     CALL 'FT0005'               9090
     C                     PARM *BLANKS   P@RTCD
     C           T#CNTL    PARM           DSFDY
      *
      *  If return with an error (LR seton in called program) then
      *  process for database error.
      *
     C           *IN90     IFEQ '1'
     C           P@RTCD    OREQ '*ERROR*'
     C                     MOVEL'FT0005  'W0FILE
     C                     MOVEL'*CALL'   W0KEY            ***************
     C                     Z-ADD35        W0ERNB           * DB ERROR 35 *
     C                     MOVEL'MEM5003' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C***********          EXSR SRERR                                     130869
     C                     EXSR SRERRA                                    130869
     C                     END
      *
      * Set up FT override for General Ledger Balances
      *
     C           T#GLUI    IFEQ 'I'
     C                     MOVEL'Y'       ##FTOV  1
     C                     ELSE
     C                     MOVEL*BLANKS   ##FTOV
     C                     END
      *
      * Calculate Back Value Date and set other V# values
      *
     C           BJRDNB    SUB  BJBVPD    V#BVLD
     C                     MOVELBKOBUV    V#OBUV
     C                     MOVELBJSBRC    V#SBRC
     C                     MOVELBJSLCD    V#SLCD
     C                     MOVELBMRANR    V#RANR
     C                     MOVELBJCYCD    V#BCCY
     C                     MOVELBJLCCY    V#LCCY
     C                     MOVELBKPRCU    V#PRCU
     C                     MOVELBKPCDU    V#PCDU
     C                     MOVELBLCYCD    V#GBP
     C                     MOVELBTPCRD    V#PCRD
      *
      * Obtain Midas run date in user format
      *
     C                     CALL 'ZDATE2'               9090Entry parameter
     C                     PARM WURDNB    ZDAYNO  50       Value date
     C                     PARM WUDFF     ZDATFM  1        Date format ind
     C                     PARM           ZDATE   60       Value date
     C                     PARM           ZADATE  7        Run-date in DDM
      *
     C                     MOVELZDATE     V#MRDT
      *
      * Set up payment reference r
      *
     C                     MOVEL*BLANKS   W#YMD   6
     C           WUDFF     IFEQ 'M'
     C                     MOVELZDATE     SWDT1
     C           2         SUBSTSWDT1:1   MM
     C           2         SUBSTSWDT1:3   YY
     C           2         SUBSTSWDT1:5   DD
     C                     MOVELSWDT2     W#YMD
     C                     ELSE
      *
      * DDMMYY format display
      *
     C                     MOVELZDATE     SWDT1
     C           2         SUBSTSWDT1:1   YY
     C           2         SUBSTSWDT1:3   MM
     C           2         SUBSTSWDT1:5   DD
     C                     MOVELSWDT2     W#YMD
     C                     END
      *
      *  Set up MT202 compare variable
      *
     C           *LIKE     DEFN S4ORC1    ORCFLD
     C                     MOVEL*BLANKS   ORCFLD
     C                     MOVEL'MT202'   ORCFLD
      *
     C                     MOVEL'*LIBL   'P@QLS                           122060
     C                     Z-ADD553       P@QNS                           122060
     C                     MOVEL*BLANKS   P@QRS  10                       122060
     C                     MOVEL*BLANKS   P@QKY  20                       122060
     C                     MOVEL*BLANKS   P@QSN                           122060
      *                                                                   122060
     C                     MOVEL'0JI'     PFNCD   3                       122060
      *                                                                   122060
      * Reset global error indicator and clear error codes
      *
     C                     MOVEA*BLANKS   ERCD
     C                     Z-ADD0         X       50
      *                                                                   CFT002
      ***Access*SAR*details*file*to*see*if*S01489*is*installed.           CFT002
      *                                                                   CFT002
     C*********************CALL 'AOSARDR0'             90                 CFT002
     C*********************PARM *BLANKS   P@RTCD  7                       CFT002
     C*********************PARM '*VERIFY' P@OPTN  7                       CFT002
     C*********************PARM 'S01489'  @SARD   6                       CFT002
     C***********SCSARD    PARM *BLANKS   DSFDY                           CFT002
      *                                                                   CFT002
      ***If*return*with*an*error*(LR seton in called program)*then        CFT002
      ***process*for*database*error.                                      CFT002
      *                                                                   CFT002
     C************IN90     IFEQ '1'                                       CFT002
     C***********P@RTCD    OREQ '*ERROR*'                                 CFT002
     C*********************MOVEL'AOSARDR0'W0FILE                          CFT002
     C*********************MOVEL'*CALL'   W0KEY            ***************CFT002
     C*********************Z-ADD36        W0ERNB           * DB ERROR 36 *CFT002
     C*********************MOVEL'MEM5003' W0MSGD           ***************CFT002
     C*********************MOVEL'MIDAS  ' W0MSGF                          CFT002
     C*********************EXSR SRERR                                     CFT002
     C*********************END                                            CFT002
      *                                                                   CFT002
      ***Allow*decode*processing                                          CFT002
      *                                                                   CFT002
     C***********P@RTCD    IFEQ *BLANKS                                   CFT002
     C*********************MOVEL'S01489'  S01489  6                       CFT002
     C*********************END                                            CFT002
      *                                                                   CFT002
      *-------------------------------------------------------------------CFT002
      *  Access SAR details file to see if CFT002 is installed.           CFT002
      *                                                                   CFT002
     C                     CALL 'AOSARDR0'                 Rtv SAR DetailsCFT002
     C                     PARM *BLANKS   P@RTCD  7        -B:Return Code CFT002
     C                     PARM '*VERIFY' P@OPTN  7        -I:Option      CFT002
     C                     PARM 'CFT002'  P@SARD  6        -I:SAR Id      CFT002
     C           SCSARD    PARM *BLANKS   DSFDY            -O:Format      CFT002
      *                                                                   CFT002
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -CFT002
      *  Allow decode processing                                          CFT002
      *  Allow repair function processing                                 163446
      *                                                                   CFT002
     C           P@RTCD    IFEQ *BLANKS                     If Feature On CFT002
     C                     MOVE 'Y'       CFT002  1          Set Flag     CFT002
     C*********************OPEN MEURPRL0                            163446CFT006
     C                     ELSE                             Else          CFT002
     C                     MOVE 'N'       CFT002             Set Flag     CFT002
     C                     END                              End If        CFT002
      *                                                                   130869
      *                                                                   CFT004
      ** Access SAR details file to see if CFT004 is installed.           CFT004
      *                                                                   CFT004
     C                     CALL 'AOSARDR0'                                CFT004
     C                     PARM *BLANKS   P@RTCD  7                       CFT004
     C                     PARM '*VERIFY' P@OPTN  7                       CFT004
     C                     PARM 'CFT004'  P@SARD  6                       CFT004
     C           SCSARD    PARM *BLANKS   DSFDY                           CFT004
      *                                                                   CFT004
      ** Allow IBAN processing                                            CFT004
      *                                                                   CFT004
     C           P@RTCD    IFEQ *BLANKS                                   CFT004
     C                     MOVE 'Y'       CFT004  1                       CFT004
     C                     ELSE                                           CFT004
     C                     MOVE 'N'       CFT004                          CFT004
     C                     END                                            CFT004
      *                                                                                       CSW201
      ** Check if SWIFT 2001 (CSW201) is installed                                            CSW201
      *                                                                                       CSW201
     C                     CALL 'SWIF2001'                                                    CSW201
     C                     PARM *BLANKS   P@RTCD                                              CSW201
a     *                                                                                       CSW201
     C           P@RTCD    IFEQ 'CSW2001'                                                     CSW201
     C                     MOVE 'Y'       CSW201  1                                           CSW201
     C                     ELSE                                                               CSW201
     C                     MOVE 'N'       CSW201                                              CSW201
     C                     ENDIF                                                              CSW201
      ** Access SAR details file to see if CFT005 is installed.           CFT005
      *                                                                   CFT005
     C                     CALL 'AOSARDR0'                                CFT005
     C                     PARM *BLANKS   P@RTCD                          CFT005
     C                     PARM '*VERIFY' P@OPTN                          CFT005
     C                     PARM 'CFT005'  P@SARD                          CFT005
     C           SCSARD    PARM *BLANKS   DSFDY                           CFT005
     C*                                                                   CFT005
     C** Allow Auto-authorising                                           CFT005
     C*                                                                   CFT005
     C           P@RTCD    IFEQ *BLANKS                                   CFT005
     C                     MOVE 'Y'       CFT005  1                       CFT005
     C                     ELSE                                           CFT005
     C                     MOVE 'N'       CFT005                          CFT005
     C                     END                                            CFT005
     C***********          MOVEL'RE4401'  P@QSN                    130869 146322
     C***********          MOVEL'*LIBL   'P@QLS                    130869 146322
     C***********          Z-ADD1714      P@QNS                    130869 146322
      *                                                                   CGL009
      ** Access SAR details file to see if CFT150 is ON                                       CFT151
      *                                                                                       CFT151
     C                     CALL 'AOSARDR0'                                                    CFT151
     C                     PARM *BLANKS   P@RTCD                                              CFT151
     C                     PARM '*VERIFY' P@OPTN                                              CFT151
     C                     PARM 'CFT151'  P@SARD                                              CFT151
     C           SCSARD    PARM *BLANKS   DSFDY                                               CFT151
     C*                                                                                       CFT151
     C** Allow Auto-authorising                                                               CFT151
     C*                                                                                       CFT151
     C           P@RTCD    IFEQ *BLANKS                                                       CFT151
     C                     MOVE 'Y'       CFT151  1                                           CFT151
     C                     ELSE                                                               CFT151
     C                     MOVE 'N'       CFT151                                              CFT151
     C                     END                                                                CFT151
      *-------------------------------------------------------------------CGL009
      *  Access SAR details file to see if CGL009 is allowed.             CGL009
      *                                                                   CGL009
     C                     CALL 'AOSARDR0'                 Rtv SAR DetailsCGL009
     C                     PARM *BLANKS   P@RTCD  7        -B:Return Code CGL009
     C                     PARM '*VERIFY' P@OPTN  7        -I:Option      CGL009
     C                     PARM 'CGL009'  P@SARD  6        -I:SAR Id      CGL009
     C           SCSARD    PARM *BLANKS   DSFDY            -O:Format      CGL009
      *                                                                   CGL009
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -CGL009
      *  Allow FONTIS processing                                          CGL009
      *                                                                   CGL009
     C           P@RTCD    IFEQ *BLANKS                     If Feature On CGL009
     C                     OPEN MEFNODL1                                  CGL009
     C                     MOVE 'Y'       CGL009  1          Set Flag     CGL009
      *                                                                   CGL009
      *  Get Fontis TPP process information                               CGL009
      *                                                                   CGL009
     C                     CALL 'AOFONTR0'                                CGL009
     C                     PARM           @RTCD   7                       CGL009
     C                     PARM '*FIRST'  @OPTN   7                       CGL009
     C           SDFONT    PARM SDFONT    DSFDY                           CGL009
     C           @RTCD     IFNE *BLANKS                                   CGL009
     C                     MOVEL'AOFONTR0'W0FILE                          CGL009
     C                     MOVEL'*CALL'   W0KEY            ***************CGL009
     C                     Z-ADD70        W0ERNB           * DB ERROR 70 *CGL009
     C                     MOVEL'MEM5003' W0MSGD           ***************CGL009
     C                     MOVEL'MIDAS  ' W0MSGF                          CGL009
     C                     EXSR SRERRA                                    CGL009
     C                     END                                            CGL009
      *  CGL009 not found                                                 CGL009
     C                     ELSE                             Else          CGL009
     C                     MOVE 'N'       CGL009             Set Flag     CGL009
     C                     END                              End If        CGL009
      *                                                                   CFT012
      ** Access SAR details file to see if CFT012 is installed.           CFT012
      *                                                                   CFT012
     C                     CALL 'AOSARDR0'                                CFT012
     C                     PARM *BLANKS   P@RTCD                          CFT012
     C                     PARM '*VERIFY' P@OPTN                          CFT012
     C                     PARM 'CFT012'  P@SARD                          CFT012
     C           SCSARD    PARM *BLANKS   DSFDY                           CFT012
      *                                                                   CFT012
      ** Allow Cross Currency Payment                                     CFT012
      *                                                                   CFT012
     C           P@RTCD    IFEQ *BLANKS                                   CFT012
     C                     MOVE 'Y'       CFT012  1                       CFT012
     C                     ELSE                                           CFT012
     C                     MOVE 'N'       CFT012                          CFT012
     C                     ENDIF                                          CFT012
      *                                                                   CFT014
      ** Access SAR details file to see if CFT014 is installed.           CFT014
      *                                                                   CFT014
     C                     CALL 'AOSARDR0'                                CFT014
     C                     PARM *BLANKS   P@RTCD                          CFT014
     C                     PARM '*VERIFY' P@OPTN                          CFT014
     C                     PARM 'CFT014'  P@SARD                          CFT014
     C           SCSARD    PARM *BLANKS   DSFDY                           CFT014
      *                                                                   CFT014
      ** Allow MT103 SWIFT messages                                       CFT014
      *                                                                   CFT014
     C           P@RTCD    IFEQ *BLANKS                                   CFT014
     C                     MOVE 'Y'       CFT014  1                       CFT014
     C           CFT003    IFNE 'CFT003'                                  189441
     C                     OPEN INPAYXL0                                  189441
     C                     OPEN OTPAYXL0                                  189441
     C                     ENDIF                                          189441
     C                     ELSE                                           CFT014
     C                     MOVE 'N'       CFT014                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT009
      ** Access SAR details file to determine if CFT009 is switched ON    CFT009
      *                                                                   CFT009
     C                     CALL 'AOSARDR0'                                CFT009
     C                     PARM *BLANKS   @RTRN   7                       CFT009
     C                     PARM '*VERIFY' @OPTN   7                       CFT009
     C                     PARM 'CFT009'  @SARD   6                       CFT009
     C           SCSARD    PARM SCSARD    DSFDY                           CFT009
      *                                                                   CFT009
      ** If core feature is switched ON, set a variable field to          CFT009
      ** condition the rest of the processing                             CFT009
      *                                                                   CFT009
     C           @RTRN     IFEQ *BLANKS                                   CFT009
     C                     MOVE 'Y'       CFT009  1                       CFT009
     C                     ELSE                                           CFT009
      *                                                                   CFT009
      ** else, database error (return code other than *NRF)               CFT009
      *                                                                   CFT009
     C           @RTRN     IFNE '*NRF   '                                 CFT009
     C                     MOVEL'SCSARDPD'W0FILE           ************   CFT009
     C                     MOVEL'*VERIFY' W0KEY            * DBERR 140*   CFT009
     C                     Z-ADD140       W0ERNB           ************   CFT009
     C                     EXSR SRERRA                     *ABORT PGM*    CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       CFT009                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Access SAR details file to determine if CFT010 is switched ON    CFT009
      *                                                                   CFT009
     C                     CALL 'AOSARDR0'                                CFT009
     C                     PARM *BLANKS   @RTRN   7                       CFT009
     C                     PARM '*VERIFY' @OPTN   7                       CFT009
     C                     PARM 'CFT010'  @SARD   6                       CFT009
     C           SCSARD    PARM SCSARD    DSFDY                           CFT009
      *                                                                   CFT009
      ** If core feature is switched ON, set a variable field to          CFT009
      ** condition the rest of the processing                             CFT009
      *                                                                   CFT009
     C           @RTRN     IFEQ *BLANKS                                   CFT009
     C                     MOVE 'Y'       CFT010  1                       CFT009
     C                     ELSE                                           CFT009
      *                                                                   CFT009
      ** else, database error (return code other than *NRF)               CFT009
      *                                                                   CFT009
     C           @RTRN     IFNE '*NRF   '                                 CFT009
     C                     MOVEL'SCSARDPD'W0FILE           ************   CFT009
     C                     MOVEL'*VERIFY' W0KEY            * DBERR 141*   CFT009
     C                     Z-ADD141       W0ERNB           ************   CFT009
     C                     EXSR SRERRA                     *ABORT PGM*    CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       CFT010                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Access file for V.A.T rate                                       CFT009
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
     C                     CALL 'AOVATR0'              9090               CFT009
     C                     PARM '*MSG   ' P@RTCD  7        B:Return code  CFT009
     C                     PARM '*FIRST ' P@OPTN  7        I:Option       CFT009
     C                     PARM           VATDS                           CFT009
     C*                                                                   CFT009
     C** If return with an error (LR seton in called program) then        CFT009
     C** process for database error.                                      CFT009
     C*                                                                   CFT009
     C           *IN90     IFEQ *ON                                       CFT009
     C           P@RTCD    OREQ '*ERROR*'                                 CFT009
     C                     MOVEL'AOVATR0' W0FILE           ************   CFT009
     C                     MOVEL'*VERIFY' W0KEY            * DBERR 142*   CFT009
     C                     Z-ADD142       W0ERNB           ************   CFT009
     C                     EXSR SRERRA                     *ABORT PGM*    CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADDO#VATR    WVATR   54                      CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Access SAR details file to determine if S01494 is switched ON    CFT009
      *                                                                   CFT009
     C                     CALL 'AOSARDR0'                                CFT009
     C                     PARM *BLANKS   @RTRN   7                       CFT009
     C                     PARM '*VERIFY' @OPTN   7                       CFT009
     C                     PARM 'S01494'  @SARD   6                       CFT009
     C           SCSARD    PARM SCSARD    DSFDY                           CFT009
      *                                                                   CFT009
      ** If core feature is switched ON, set a variable field to          CFT009
      ** condition the rest of the processing                             CFT009
      *                                                                   CFT009
     C           @RTRN     IFEQ *BLANKS                                   CFT009
     C                     MOVE 'Y'       S01494  1                       CFT009
     C                     ELSE                                           CFT009
      *                                                                   CFT009
      ** else, database error (return code other than *NRF)               CFT009
      *                                                                   CFT009
     C           @RTRN     IFNE '*NRF   '                                 CFT009
     C                     MOVEL'SCSARDPD'W0FILE           ************   CFT009
     C                     MOVEL'*VERIFY' W0KEY            * DBERR143 *   CFT009
     C                     Z-ADD143       W0ERNB           ************   CFT009
     C                     EXSR SRERRA                     *ABORT PGM*    CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       S01494                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *****************************                                       CFT012
      ***Unwind*subroutine*stack*name******************                   CFT012
      ***********************                                             CFT012
     C***********EXINIT    TAG                                            CFT012
     C*********************MOVEA*BLANKS   @STK,Q                          CFT012
     C*********************SUB  1         Q                               CFT012
      *                                                                   CEU006
      ** Access SAR details file to determine if CEU006 is switched ON    CEU006
      *                                                                   CEU006
     C                     CALL 'AOSARDR0'                                CEU006
     C                     PARM *BLANKS   @RTRN   7                       CEU006
     C                     PARM '*VERIFY' @OPTN   7                       CEU006
     C                     PARM 'CEU006'  @SARD   6                       CEU006
     C           SCSARD    PARM SCSARD    DSFDY                           CEU006
      *                                                                   CEU006
      ** If core feature is switched ON, set a variable field to          CEU006
      ** condition the rest of the processing                             CEU006
      *                                                                   CEU006
     C           @RTRN     IFEQ *BLANKS                                   CEU006
     C                     MOVE 'Y'       CEU006  1                       CEU006
     C                     ELSE                                           CEU006
      *                                                                   CEU006
      ** else, database error (return code other than *NRF)               CEU006
      *                                                                   CEU006
     C           @RTRN     IFNE '*NRF   '                                 CEU006
     C                     MOVEL'SCSARDPD'W0FILE           ************   CEU006
     C                     MOVEL'*VERIFY' W0KEY            * DBERR 46 *   CEU006
     C                     Z-ADD46        W0ERNB           ************   CEU006
     C                     EXSR SRERRA                     *ABORT PGM*    CEU006
     C                     ELSE                                           CEU006
     C                     MOVE 'N'       CEU006                          CEU006
     C                     ENDIF                                          CEU006
     C                     ENDIF                                          CEU006
      *                                                                                       CFT017
      ** Access SAR details file to determine if CFT017 is switched on.                       CFT017
      *                                                                                       CFT017
     C                     CALL 'AOSARDR0'                                                    CFT017
     C                     PARM *BLANKS   @RTRN                                               CFT017
     C                     PARM '*VERIFY' @OPTN                                               CFT017
     C                     PARM 'CFT017'  @SARD                                               CFT017
     C           SCSARD    PARM SCSARD    DSFDY                                               CFT017
      *                                                                                       CFT017
     C           @RTRN     IFEQ *BLANKS                                                       CFT017
     C                     MOVE 'Y'       CFT017  1                                           CFT017
     C                     ELSE                                                               CFT017
     C                     MOVE 'N'       CFT017                                              CFT017
     C                     ENDIF                                                              CFT017
      *                                                                                       CSW209
      ** Check if SWIFT Changes 2009 (CSW209) is installed                                    CSW209
      *                                                                                       CSW209
     C                     CALL 'SWIF2009'                                                    CSW209
     C                     PARM *BLANKS   @RTRN                                               CSW209
      *                                                                                       CSW209
     C           @RTRN     IFEQ 'CSW2009'                                                     CSW209
     C                     MOVE 'Y'       CSW209  1                                           CSW209
     C                     ELSE                                                               CSW209
     C                     MOVE 'N'       CSW209                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                   CRE008
     C                     CALL 'AOSARDR0'                                CRE008
     C                     PARM *BLANKS   @RTRN                           CRE008
     C                     PARM '*VERIFY' @OPTN                           CRE008
     C                     PARM 'CRE008'  @SARD                           CRE008
     C           SCSARD    PARM SCSARD    DSFDY                           CRE008
      *                                                                   CRE008
     C           @RTRN     IFEQ *BLANKS                                   CRE008
     C                     MOVE 'Y'       CRE008  1                       CRE008
     C                     ELSE                                           CRE008
     C                     MOVE 'N'       CRE008                          CRE008
     C                     ENDIF                                          CRE008
      *                                                                   CFT012
     C/COPY WNCPYSRC,FTH00086
      *  Unwind subroutine stack name                                     CFT012
      *                                                                   CFT012
     C           EXINIT    TAG                                            CFT012
     C                     MOVEA*BLANKS   @STK,Q                          CFT012
     C                     SUB  1         Q                               CFT012
      *
      *                                                                                       CSD015
      ** Check 24 x 7 enhancement is installed.                                               CSD015
      *                                                                                       CSD015
     C           *NAMVAR   DEFN           SDSTAT                                              CSD015
     C                     IN   SDSTAT                                                        CSD015
      *                                                                                       CSD015
     C                     CALL 'AOSARDR0'                                                    CSD015
     C**********           PARM '       ' @RTRN                                         CSD015221934
     C                     PARM '       ' @RTCD                                               221934
     C                     PARM '*VERIFY' @OPTN                                               CSD015
     C                     PARM 'CSC011'  @SARD                                               CSD015
     C           SCSARD    PARM SCSARD    DSFDY                                               CSD015
      *                                                                                       CSD015
     C                     MOVEL'N'       CSC011  1                                           CSD015
     C           @RTCD     IFEQ *BLANKS                                                       CSD015
     C           *NAMVAR   DEFN           SC24X7                                              CSD015
     C                     IN   SC24X7                                                        CSD015
     C                     MOVEL'Y'       CSC011                                              CSD015
     C                     ELSE                                                               CSD015
     C           @RTCD     IFNE '*NRF   '                                                     CSD015
     C                     MOVEL'CSC011'  W0KEY                                               CSD015
     C                     MOVEL'SCSARDPD'W0FILE                                              CSD015
     C                     Z-ADD41        W0ERNB                                              CSD015
     C                     EXSR SRERRA                                                        CSD015
     C                     ENDIF                                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Check if compliance watch enhancement is switched on.                                CSD015
      *                                                                                       CSD015
     C                     CALL 'AOSARDR0'                                                    CSD015
     C**********           PARM '       ' @RTRN                                         CSD015221934
     C                     PARM '       ' @RTCD                                               221934
     C                     PARM '*VERIFY' @OPTN                                               CSD015
     C                     PARM 'CSD015'  @SARD                                               CSD015
     C           SCSARD    PARM SCSARD    DSFDY                                               CSD015
      *                                                                                       CSD015
     C                     MOVEL'N'       CSD015  1                                           CSD015
     C           @RTCD     IFEQ *BLANKS                                                       CSD015
     C                     MOVEL'Y'       CSD015  1                                           CSD015
     C                     ELSE                                                               CSD015
     C           @RTCD     IFNE '*NRF   '                                                     CSD015
     C                     MOVEL'CSD015'  W0KEY                                               CSD015
     C                     MOVEL'SCSARDPD'W0FILE                                              CSD015
     C                     Z-ADD42        W0ERNB                                              CSD015
     C                     EXSR SRERRA                                                        CSD015
     C                     ENDIF                                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Check if function code is being monitored by compliance watch.                       CSD015
      *                                                                                       CSD015
     C           CSD015    IFEQ 'Y'                                                           CSD015
      *                                                                                       CSD015
     C                     CALL 'AOWLCCR0'                                                    CSD015
     C**********           PARM *BLANKS   @RTRN                                         CSD015221934
     C                     PARM '       ' @RTCD                                               221934
     C                     PARM '*KEY   ' @OPTN                                               CSD015
     C                     PARM 'FTOPAY  'PFUNC   8                                           CSD015
     C           SDWLCC    PARM SDWLCC    DSFDY                                               CSD015
      *                                                                                       CSD015
      ** If return code not blank, then issue database error.                                 CSD015
      *                                                                                       CSD015
     C                     MOVE 'N'       WLOPIN  1                                           CSD015
     C           @RTCD     IFNE *BLANKS                                                       CSD015
     C           @RTCD     ANDNE'*NRF   '                                                     CSD015
     C                     MOVE 'FTOPAY  'W0KEY                                               CSD015
     C                     MOVE 'SDWLCCPD'W0FILE                                ************  CSD015
     C                     MOVE 29        W0ERNB                                *DBERR 29  *  CSD015
     C                     EXSR SRERRA                                          ************  CSD015
     C                     ELSE                                                               CSD015
      *                                                                                       CSD015
     C           W1EWLC    IFEQ 'Y'                                                           CSD015
     C                     MOVE 'Y'       WLOPIN  1                                           CSD015
     C                     ENDIF                                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     MOVE *BLANKS   W1EWLC                                              CSD015
     C                     CALL 'AOWLCCR0'                                                    CSD015
     C**********           PARM *BLANKS   @RTRN                                         CSD015221934
     C                     PARM '       ' @RTCD                                               221934
     C                     PARM '*KEY   ' @OPTN                                               CSD015
     C                     PARM 'FTIPAY  'PFUNC   8                                           CSD015
     C           SDWLCC    PARM SDWLCC    DSFDY                                               CSD015
      *                                                                                       CSD015
      ** If return code not blank, then issue database error.                                 CSD015
      *                                                                                       CSD015
     C                     MOVE 'N'       WLIPIN  1                                           CSD015
     C           @RTCD     IFNE *BLANKS                                                       CSD015
     C           @RTCD     ANDNE'*NRF   '                                                     CSD015
     C                     MOVE 'FTIPAY  'W0KEY                                               CSD015
     C                     MOVE 'SDWLCCPD'W0FILE                                ************  CSD015
     C                     MOVE 29        W0ERNB                                *DBERR 29  *  CSD015
     C                     EXSR SRERRA                                          ************  CSD015
     C                     ELSE                                                               CSD015
      *                                                                                       CSD015
     C           W1EWLC    IFEQ 'Y'                                                           CSD015
     C                     MOVE 'Y'       WLIPIN  1                                           CSD015
     C                     ENDIF                                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Call access program AOCWCDR0 for Private Customer                                    CSD015
      ** Industry Code?                                                                       CSD015
      *                                                                                       CSD015
     C                     CALL 'AOCWCDR0'                                                    CSD015
     C**********           PARM *BLANKS   @RTRN                                         CSD015221934
     C                     PARM '       ' @RTCD                                               221934
     C                     PARM '*FIRST ' @OPTN                                               CSD015
     C           SDCWCD    PARM SDCWCD    DSSDY                                               CSD015
      *                                                                                       CSD015
      ** If no record is found on SDCWCDPD                                                    CSD015
      *                                                                                       CSD015
     C           @RTCD     IFNE *BLANKS                                                       CSD015
     C           @RTCD     ANDNE'*NRF   '                                                     CSD015
     C                     MOVEL'*FIRST'  W0KEY                                               CSD015
     C                     MOVEL'SDCWCDPD'W0FILE                                              CSD015
     C                     Z-ADD45        W0ERNB                                              CSD015
     C                     EXSR SRERRA                                                        CSD015
     C                     ENDIF                                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Check Concord Interface Development is installed.                                    CSD015
      *                                                                                       CSD015
     C                     CALL 'AOSARDR0'                                                    CSD015
     C**********           PARM '       ' @RTRN                                         CSD015221934
     C                     PARM '       ' @RTCD                                               221934
     C                     PARM '*VERIFY' @OPTN                                               CSD015
     C                     PARM 'CCF001'  @SARD   6                                           CSD015
     C           SCSARD    PARM SCSARD    DSFDY                                               CSD015
      *                                                                                       CSD015
     C                     MOVEL'N'       CCF001  1                                           CSD015
     C           @RTCD     IFEQ *BLANKS                                                       CSD015
     C                     MOVEL'Y'       CCF001                                              CSD015
     C                     ELSE                                                               CSD015
     C           @RTCD     IFNE '*NRF   '                                                     CSD015
     C                     MOVEL'CCF001'  W0KEY                                               CSD015
     C                     MOVEL'SCSARDPD'W0FILE                                              CSD015
     C                     Z-ADD44        W0ERNB                                              CSD015
     C                     EXSR SRERRA                                                        CSD015
     C                     ENDIF                                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Check if 'CER031' is switched 'ON'                                                   CER030
      *                                                                                       CER030
     C                     CALL 'AOSARDR0'                                                    CER030
     C                     PARM *BLANKS   PRTCD                                               CER030
     C                     PARM '*VERIFY' POPTN                                               CER030
     C                     PARM 'CER031'  PSARD   6                                           CER030
     C           SCSARD    PARM SCSARD    DSFDY                                               CER030
      *                                                                                       CER030
     C           PRTCD     IFEQ *BLANKS                                                       CER030
     C                     MOVE 'Y'       CER031  1                                           CER030
     C                     ELSE                                                               CER030
      *                                                                                       CER030
     C           PRTCD     IFNE '*NRF   '                                                     CER030
     C                     MOVEL'CER031'  W0KEY                                               CER030
     C                     MOVEL'SCSARDPD'W0FILE                                              CER030
     C                     Z-ADD48        W0ERNB                                              CER030
     C                     EXSR SRERRA                                                        CER030
     C                     ELSE                                                               CER030
     C                     MOVE 'N'       CER031                                              CER030
     C                     ENDIF                                                              CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      ** Check if 'CER030' is switched 'ON'                                                   CER030
      *                                                                                       CER030
     C                     CALL 'AOSARDR0'                                                    CER030
     C                     PARM *BLANKS   PRTCD                                               CER030
     C                     PARM '*VERIFY' POPTN                                               CER030
     C                     PARM 'CER030'  PSARD                                               CER030
     C           SCSARD    PARM SCSARD    DSFDY                                               CER030
      *                                                                                       CER030
     C           PRTCD     IFEQ *BLANKS                                                       CER030
     C                     MOVE 'Y'       CER030  1                                           CER030
     C                     ELSE                                                               CER030
      *                                                                                       CER030
     C           PRTCD     IFNE '*NRF   '                                                     CER030
     C                     MOVEL'CER030'  W0KEY                                               CER030
     C                     MOVEL'SCSARDPD'W0FILE                                              CER030
     C                     Z-ADD49        W0ERNB                                              CER030
     C                     EXSR SRERRA                                                        CER030
     C                     ELSE                                                               CER030
     C                     MOVE 'N'       CER030                                              CER030
     C                     ENDIF                                                              CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      ** Check if 'CGL013' is switched 'ON'                                                   CER030
      *                                                                                       CER030
     C                     CALL 'AOSARDR0'                                                    CER030
     C                     PARM *BLANKS   PRTCD                                               CER030
     C                     PARM '*VERIFY' POPTN                                               CER030
     C                     PARM 'CGL013'  PSARD                                               CER030
     C           SCSARD    PARM SCSARD    DSFDY                                               CER030
      *                                                                                       CER030
     C           PRTCD     IFEQ *BLANKS                                                       CER030
     C                     MOVE 'Y'       CGL013  1                                           CER030
     C                     ELSE                                                               CER030
      *                                                                                       CER030
     C           PRTCD     IFNE '*NRF   '                                                     CER030
     C                     MOVEL'CGL013'  W0KEY                                               CER030
     C                     MOVEL'SCSARDPD'W0FILE                                              CER030
     C                     Z-ADD50        W0ERNB                                              CER030
     C                     EXSR SRERRA                                                        CER030
     C                     ELSE                                                               CER030
     C                     MOVE 'N'       CGL013                                              CER030
     C                     ENDIF                                                              CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     CALL 'AOSARDR0'                                                  BUG25944
     C                     PARM '       ' @RTCD                                             BUG25944
     C                     PARM '*VERIFY' @OPTN                                             BUG25944
     C                     PARM 'CAP185'  @SARD                                             BUG25944
     C           SCSARD    PARM SCSARD    DSFDY                                             BUG25944
      *                                                                                     BUG25944
     C                     MOVEL'N'       CAP185  1                                         BUG25944
     C           @RTCD     IFEQ *BLANKS                                                     BUG25944
     C                     MOVEL'Y'       CAP185                                            BUG25944
     C                     ENDIF                                                            BUG25944
      *                                                                                     BUG25944
      ** Determine if SAR CAP205 is installed                                                 CAP205
      *                                                                                       CAP205
     C                     MOVEL'N'       CAP205  1                                           CAP205
     C                     CALL 'AOSARDR0'                                                    CAP205
     C                     PARM '       ' @RTCD                                               CAP205
     C                     PARM '*VERIFY' @OPTN                                               CAP205
     C                     PARM 'CAP205'  @SARD                                               CAP205
     C           SCSARD    PARM SCSARD    DSFDY                                               CAP205
      *                                                                                       CAP205
     C           @RTCD     IFNE *BLANKS                                                       CAP205
     C           @RTCD     ANDNE'*NRF   '                                                     CAP205
     C                     MOVEL'CAP205'  W0KEY                                               CAP205
     C                     MOVEL'SCSARDPD'W0FILE                                              CAP205
     C                     Z-ADD60        W0ERNB                                              CAP205
     C                     EXSR SRERRA                                                        CAP205
     C                     ENDIF                                                              CAP205
      *                                                                                       CAP205
     C           @RTCD     IFEQ *BLANKS                                                       CAP205
     C                     MOVEL'Y'       CAP205                                              CAP205
     C                     ENDIF                                                              CAP205
      *
      ** Determine if SAR LUC110 is installed                                                 LUC110
      *                                                                                       LUC110
     C                     MOVEL'N'       LUC110  1                                           LUC110
     C                     CALL 'AOSARDR0'                                                    LUC110
     C                     PARM '       ' @RTCD                                               LUC110
     C                     PARM '*VERIFY' @OPTN                                               LUC110
     C                     PARM 'LUC110'  @SARD                                               LUC110
     C           SCSARD    PARM SCSARD    DSFDY                                               LUC110
      *                                                                                       LUC110
     C           @RTCD     IFNE *BLANKS                                                       LUC110
     C           @RTCD     ANDNE'*NRF   '                                                     LUC110
     C                     MOVEL'LUC110'  W0KEY                                               LUC110
     C                     MOVEL'SCSARDPD'W0FILE                                              LUC110
     C                     Z-ADD67        W0ERNB                                              LUC110
     C                     EXSR SRERRA                                                        LUC110
     C                     ENDIF                                                              LUC110
      *                                                                                       LUC110
     C           @RTCD     IFEQ *BLANKS                                                       LUC110
     C                     MOVEL'Y'       LUC110                                              LUC110
     C                     ENDIF                                                              LUC110
      *                                                                                       LUC110
      *                                                                                       LUC110
     CSR                   ENDSR
      *****************************************************************   CAC002
      /EJECT                                                              CAC002
      *****************************************************************   CAC002
      *                                                               *   CAC002
      *  Subroutine  :  SRNQDP                                        *   CAC002
      *  Function    :  Get Normally-Quoted Decimal Places            *   CAC002
      *                                                               *   CAC002
      *  Called by   :  SRINUP - Validate Incoming Payments Update    *   CAC002
      *  Calls       :  -                                             *   CAC002
      *                                                               *   CAC002
      *****************************************************************   CAC002
      *                                                                   CAC002
     C           SRNQDP    BEGSR                           ** SRNQDP **   CAC002
      *                                                                   CAC002
      ** --------------------------------------------------------------   CAC002
      **  If either the settlement or pay currency is the base currency   CAC002
      **  obtain the number of normally-quoted decimal places for the     CAC002
      **  other currency. Otherwise:                                      CAC002
      **      A)  If ZNQDP1 =  ZNQDP2 =  5       :   ZNQDPX = 5           CAC002
      **      B)  If ZNQDP1 =  ZNQDP2 <> 5  or                            CAC002
      **             ZNQDP1 <> ZNQDP2                                     CAC002
      **             1)  If Rate >= 100          :   ZNQDPX = 2           CAC002
      **             2)  If 100 > Rate >= 20     :   ZNQDPX = 3           CAC002
      **             3)  If 20  > Rate >= 1      :   ZNQDPX = 4           CAC002
      **             4)  If 1   > Rate           :   ZNQDPX = 5           CAC002
      **---------------------------------------------------------------   CAC002
      *                                                                   CAC002
     C                     SELEC                                          CAC002
      *                                                                   CAC002
     C           SMCY      WHEQ BJCYCD                                    CAC002
     C                     Z-ADDZNQDP2    ZNQDPX  10                      CAC002
      *                                                                   CAC002
     C           PCCY      WHEQ BJCYCD                                    CAC002
     C                     Z-ADDZNQDP1    ZNQDPX                          CAC002
      *                                                                   CAC002
     C           ZNQDP1    WHEQ ZNQDP2                                    CAC002
     C           ZNQDP1    ANDEQ5                                         CAC002
     C                     Z-ADD5         ZNQDPX                          CAC002
      *                                                                   CAC002
     C           RATE      WHEQ 100                                       CAC002
     C                     Z-ADD2         ZNQDPX                          CAC002
      *                                                                   CAC002
     C           RATE      WHLT 100                                       CAC002
     C           RATE      ANDGE20                                        CAC002
     C                     Z-ADD3         ZNQDPX                          CAC002
      *                                                                   CAC002
     C           RATE      WHLT 20                                        CAC002
     C           RATE      ANDGE1                                         CAC002
     C                     Z-ADD4         ZNQDPX                          CAC002
      *                                                                   CAC002
     C           RATE      WHLT 1                                         CAC002
     C                     Z-ADD5         ZNQDPX                          CAC002
      *                                                                   CAC002
     C                     ENDSL                                          CAC002
      *                                                                   CAC002
     C           SRNQD9    ENDSR                           ** SRNQD9 **   CAC002
      *                                                                   CAC002
      *****************************************************************   CAC002
      /EJECT                                                              CAC002
      *****************************************************************   CAC002
      *                                                               *   CAC002
      *  Subroutine  :  SRMAMT                                        *   CAC002
      *  Function    :  Calculate Margin Amount                       *   CAC002
      *                                                               *   CAC002
      *  Called by   :  SRINUP - Validate Incoming Payments Update    *   CAC002
      *  Calls       :  -                                             *   CAC002
      *                                                               *   CAC002
      *****************************************************************   CAC002
      *                                                                   CAC002
     C           SRMAMT    BEGSR                           ** SRMAMT **   CAC002
      *                                                                   CAC002
      ** Set up factoring to adjust for decimal places.                   CAC002
      *                                                                   CAC002
     C           MBSI      IFEQ 'S'                                       CAC002
     C           ZNBDP1    SUB  ZNBDP2    ZNBDPX  10                      CAC002
     C                     ELSE                                           CAC002
     C           ZNBDP2    SUB  ZNBDP1    ZNBDPX                          CAC002
     C                     ENDIF                                          CAC002
      *                                                                   CAC002
     C           ZNBDPX    IFGE 0                                         CAC002
     C           ZNBDPX    ADD  1         ZB                              CAC002
     C           1         MULT AP,ZB     ZFACTR  73                      CAC002
     C                     ELSE                                           CAC002
     C                     Z-SUBZNBDPX    ZNBDPX                          CAC002
     C           ZNBDPX    ADD  1         ZB                              CAC002
     C           1         DIV  AP,ZB     ZFACTR                          CAC002
     C                     ENDIF                                          CAC002
      *                                                                   CAC002
      *                                                                   CAC002
      ** If the Margin P/S Indicator is 'P'...                            CAC002
      **    If the Purchase amount is greater than the sale amount and    CAC002
      **            the exchage rate is greater than 1  OR                CAC002
      **    If the Purchase amount is less than the sale amount and       CAC002
      **            the exchage rate is less than 1  THEN                 CAC002
      **    the Margin amount is calculated as:                           CAC002
      **                                                                  CAC002
      **       IMAR (Margin Amt) = SAMT (Sale amt) x MRAT (Margin rate)   CAC002
      **                                                                  CAC002
      **    ELSE the Margin amount is calculated as:                      CAC002
      **    If a profit (margin sign is '+') :                            CAC002
      **                            SAMT (Sale Amt)                       CAC002
      **       IMAR (Margin Amt) = ----------------- - PAMT (Purch Amt)   CAC002
      **                              XRAT - MRAT                         CAC002
      **    If a loss (margin sign is '-') :                              CAC002
      **                                               SAMT (Sale Amt)    CAC002
      **       IMAR (Margin Amt) = PAMT (Purch Amt) - -----------------   CAC002
      **                                                 XRAT + MRAT      CAC002
      *                                                                   CAC002
     C           MBSI      IFEQ 'S'                                       CAC002
      *                                                                   CAC002
     C           WPYAM     IFGT WSMAM                                     CAC002
     C           RATE      ANDGT1                                         CAC002
     C           WPYAM     ORLT WSMAM                                     CAC002
     C           RATE      ANDLT1                                         CAC002
      *                                                                   CAC002
     C           SMAM      MULT WFXMR     WMAMT  163H                     CAC002
     C           WMAMT     DIV  ZFACTR    MAMT      H                     CAC002
      *                                                                   CAC002
     C                     ELSE                                           CAC002
      *                                                                   CAC002
     C           MSIG      IFEQ '+'                                       CAC002
     C           RATE      SUB  WFXMR     WRATE  138                      CAC002
     C                     ELSE                                           CAC002
     C           RATE      ADD  WFXMR     WRATE                           CAC002
     C                     ENDIF                                          CAC002
      *                                                                   CAC002
     C           SMAM      DIV  WRATE     WCPYAM 163H                     CAC002
     C                     DIV  ZFACTR    WCPYAM    H                     CAC002
      *                                                                   CAC002
     C           MSIG      IFEQ '+'                                       CAC002
     C           WCPYAM    SUB  PYAM      MAMT                            CAC002
     C                     ELSE                                           CAC002
     C           PYAM      SUB  WCPYAM    MAMT                            CAC002
     C                     ENDIF                                          CAC002
      *                                                                   CAC002
     C                     ENDIF                                          CAC002
      *                                                                   CAC002
     C                     ENDIF                                          CAC002
      *                                                                   CAC002
      ** If the Margin P/S Indicator is 'S'...                            CAC002
      **    If the Sale amount is greater than the purchase amount and    CAC002
      **            the exchage rate is greater than 1  OR                CAC002
      **    If the Sale amount is less than the purchase amount and       CAC002
      **            the exchage rate is less than 1  THEN                 CAC002
      **    the Margin amount is calculated as:                           CAC002
      **                                                                  CAC002
      **       IMAR (Margin Amt) = PAMT (Purc amt) x MRAT (Margin rate)   CAC002
      **                                                                  CAC002
      **    ELSE the Margin amount is calculated as:                      CAC002
      **    If a profit (margin sign is '+') :                            CAC002
      **                                              PAMT (Purch Amt)    CAC002
      **       IMAR (Margin Amt) = SAMT (Sale Amt) - ------------------   CAC002
      **                                                XRAT + MRAT       CAC002
      **    If a loss (margin sign is '-') :                              CAC002
      **                            PAMT (Purch Amt)                      CAC002
      **       IMAR (Margin Amt) = ------------------ - SAMT (Sale Amt)   CAC002
      **                               XRAT - MRAT                        CAC002
      *                                                                   CAC002
     C           MBSI      IFEQ 'B'                                       CAC002
      *                                                                   CAC002
     C           WSMAM     IFGT WPYAM                                     CAC002
     C           RATE      ANDGT1                                         CAC002
     C           WSMAM     ORLT WPYAM                                     CAC002
     C           RATE      ANDLT1                                         CAC002
      *                                                                   CAC002
     C           PYAM      MULT WFXMR     WMAMT     H                     CAC002
     C           WMAMT     DIV  ZFACTR    MAMT      H                     CAC002
      *                                                                   CAC002
     C                     ELSE                                           CAC002
      *                                                                   CAC002
     C           MSIG      IFEQ '+'                                       CAC002
     C           RATE      ADD  WFXMR     WRATE                           CAC002
     C                     ELSE                                           CAC002
     C           RATE      SUB  WFXMR     WRATE                           CAC002
     C                     ENDIF                                          CAC002
      *                                                                   CAC002
     C           PYAM      DIV  WRATE     WCSMAM 163H                     CAC002
     C                     DIV  ZFACTR    WCSMAM    H                     CAC002
      *                                                                   CAC002
     C           MSIG      IFEQ '+'                                       CAC002
     C           SMAM      SUB  WCSMAM    MAMT                            CAC002
     C                     ELSE                                           CAC002
     C           WCSMAM    SUB  SMAM      MAMT                            CAC002
     C                     ENDIF                                          CAC002
      *                                                                   CAC002
     C                     ENDIF                                          CAC002
      *                                                                   CAC002
     C                     ENDIF                                          CAC002
      *                                                                   CAC002
     C           SRMAM9    ENDSR                           ** SRMAM9 **   CAC002
      *                                                                   CAC002
      *****************************************************************   CAC002
      /EJECT                                                              CAC002
      *================================================================   CFT002
      *  Map translated data for Incoming messages                        CFT002
      *================================================================   CFT002
      *                                                                   CFT002
     C           SRIMSG    BEGSR                                          CFT002
      *                                                                   CFT002
      *  Set up subroutine stack name                                     CFT002
      *                                                                   CFT002
     C                     ADD  1         Q                               CFT002
     C                     MOVEL'SRIMSG'  @STK,Q                          CFT002
      *                                                                   CFT002
      *  /Copy Point for Incoming Message Mapping                         CFT002
     C*COPY WNCPYSRC,FT0300IMSG                                           CFT002
      *                                                                   CFT002
      *  Set up the detail screen fields from the message.                CFT002
      *                                                                   CFT002
      *  Sender                                                           CFT002
      *  In FONTIS this field can be translated only by                   CGL009
      *  the sender correspondant (P53)                                   CGL009
     C           PNWRK     IFNE 'FONTIS'                                  CGL009
      *                                                                   CFT002
     C           PSN       IFNE *BLANKS                                   CFT002
     C                     MOVELPSN       DSTRAN                          CFT002
     C           TRCODE    IFNE *BLANKS                                   CFT002
      *                                                                   CFT002
      * Translate to nostro and retail account numbers                    CFT002
      *                                                                   CFT002
     C                     EXSR SRTRAN                                    CFT002
     C                     SELEC                                          CFT002
      *                                                                   CFT002
      * If local and account currency local then use retail number        CFT002
      *                                                                   CFT002
     C           BJLCCY    WHEQ S1SMCY                                    CFT002
     C           TRCYCD    ANDEQS1SMCY                                    CFT002
     C           ##ACNO    ANDNE0                                         CFT002
     C                     MOVEL*BLANKS   S1SND                           CFT002
     C                     MOVEL##ACNO    S1SND1                          CFT002
      *                                                                   CFT002
      * If currency the same as settle and nostro, use nostro             CFT002
      *                                                                   CFT002
     C           ##NCCY    WHEQ S1SMCY                                    CFT002
     C           ##NONB    ANDNE*BLANKS                                   CFT002
     C                     MOVEL*BLANKS   S1SND                           CFT002
     C           ##NCCY    CAT  ##NONB    S1SND1    P                     CFT002
      *                                                                   CFT002
      * If currency the same use GL Account                               CFT002
      *                                                                   CFT002
     C           TRCYCD    WHEQ S1SMCY                                    CFT002
     C                     MOVEL*BLANKS   S1SND                           CFT002
     C           BGMBIN    IFNE 'Y'                                       CFT002
     C                     MOVE '   '     TRCODE                          CFT002
     C                     END                                            CFT002
     C                     MOVELTRCODE    S1SND1                          CFT002
      *                                                                   CFT002
      * Use customer number                                               CFT002
      *                                                                   CFT002
     C                     OTHER                                          CFT002
     C                     MOVEL*BLANKS   S1SND                           CFT002
     C                     MOVELTRCNUM    S1SND1                          CFT002
     C                     ENDSL                                          CFT002
     C                     ENDIF                                          CFT002
     C                     ENDIF                                          CFT002
     C                     ENDIF                                          CGL009
      *                                                                   CFT002
      *  Check Ordering Institution is greater than 11 characters         CFT002
      *  if not add / to second line                                      CFT002
      *                                                                   CFT002
     C           S2ORB1    IFNE *BLANKS                                   CFT002
     C           S2ORB2    ANDEQ*BLANKS                                   CFT002
     C                     MOVELS2ORB1    ##0024 24                       CFT002
     C           ##0024    IFEQ *BLANKS                                   CFT002
     C                     MOVEL'/'       S2ORB2                          CFT002
     C                     ENDIF                                          CFT002
     C                     ENDIF                                          CFT002
      *                                                                   CFT002
      *  Senders Correspondent                                            CFT002
      *  By default will translate the sender field in FONTIS             CGL009
      *                                                                   CFT002
     C           P54       IFEQ *BLANKS                                   CFT002
     C           P55       ANDEQ*BLANKS                                   CFT014
     C           P53       ANDNE*BLANKS                                   CFT002
     C                     MOVELP53       DSTRAN                          CFT002
     C           TRCODE    IFNE *BLANKS                                   CFT002
      *                                                                   CFT002
      * Translate to nostro and retail account numbers                    CFT002
      *                                                                   CFT002
     C                     EXSR SRTRAN                                    CFT002
     C                     SELEC                                          CFT002
      *                                                                   CFT002
      * If local and account currency local then use retail number        CFT002
      *                                                                   CFT002
      *****      BJLCCY    WHEQ S1SMCY                             CFT002 MMFIX1
      *****      TRCYCD    ANDEQS1SMCY                             CFT002 MMFIX1
     C           TRCYCD    WHEQ S1SMCY                                    CFT002
     C           ##ACNO    ANDNE0                                         CFT002
      ***                  MOVEL*BLANKS   S1SND                           MMFIX1
      ***                  MOVEL##ACNO    S1SND1                          MMFIX1
     C                     MOVEL*BLANKS   S1RCCO                          MMFIX1
     C                     MOVEL##ACNO    S1RCCO                          MMFIX1
      *                                                                   CFT002
      * If currency the same as settle and nostro, use nostro             CFT002
      *                                                                   CFT002
     C           ##NCCY    WHEQ S1SMCY                                    CFT002
     C           ##NONB    ANDNE*BLANKS                                   CFT002
      ***                  MOVEL*BLANKS   S1SND                           MMFIX1
     C                     MOVEL*BLANKS   S1RCCO                          MMFIX1
      ****       ##NCCY    CAT  ##NONB    S1SND1    P                     MMFIX1
     C           ##NCCY    CAT  ##NONB    S1RCCO    P                     CFT002
      *                                                                   CFT002
      * If currency the same use GL Account                               CFT002
      *                                                                   CFT002
     C           TRCYCD    WHEQ S1SMCY                                    CFT002
      ****                 MOVEL*BLANKS   S1SND                           MMFIX1
     C                     MOVEL*BLANKS   S1RCCO                          MMFIX1
     C           BGMBIN    IFNE 'Y'                                       CFT002
     C                     MOVE '   '     TRCODE                          CFT002
     C                     END                                            CFT002
      ****                 MOVELTRCODE    S1SND1                          MMFIX1
     C                     MOVELTRCODE    S1RCCO                          MMFIX1
      *                                                                   CFT002
      * Use customer number                                               CFT002
      *                                                                   CFT002
     C                     OTHER                                          CFT002
      ***                  MOVEL*BLANKS   S1SND                           MMFIX1
     C                     MOVEL*BLANKS   S1RCCO                          MMFIX1
      ****                 MOVELTRCNUM    S1SND1                          MMFIX1
     C                     MOVELTRCNUM    S1RCCO                          MMFIX1
     C                     ENDSL                                          CFT002
     C                     ENDIF                                          CFT002
     C                     ENDIF                                          CFT002
      *                                                                   CFT002
      *  Receivers Correspondent                                          CFT002
      *                                                                   CFT002
     C                     SELEC                                          CFT002
     C           PNWRK     WHEQ 'YENKSI'                                  CFT002
      *                                                                   CFT002
      *  /Copy for BoJ Net inclusion                                      CFT002
      *                                                                   CFT002
     C*COPY WNCPYSRC,FT0300IYEN                                           CFT002
     C           P54       WHNE *BLANKS                                   CFT002
     C                     MOVELP54       DSTRAN                          CFT002
     C           TRCODE    IFNE *BLANKS                                   CFT002
     C                     MOVEL*BLANKS   S1RCCO                          CFT002
     C                     ENDIF                                          CFT002
     C           TRCODE    IFNE *BLANKS                                   CFT002
      *                                                                   CFT002
      * Translate to nostro and retail account numbers                    CFT002
      *                                                                   CFT002
     C                     EXSR SRTRAN                                    CFT002
     C                     SELEC                                          CFT002
      *                                                                   CFT002
      * If local and account currency local then use retail number        CFT002
      *                                                                   CFT002
     C           BJLCCY    WHEQ S1SMCY                                    CFT002
     C           TRCYCD    ANDEQS1SMCY                                    CFT002
     C           ##ACNO    ANDNE0                                         CFT002
     C                     MOVEL*BLANKS   S1RCCO                          CFT002
     C                     MOVEL##ACNO    S1RCCO                          CFT002
      *                                                                   CFT002
      * If currency the same as settle and nostro, use nostro             CFT002
      *                                                                   CFT002
     C           ##NCCY    WHEQ S1SMCY                                    CFT002
     C           ##NONB    ANDNE*BLANKS                                   CFT002
     C                     MOVEL*BLANKS   S1RCCO                          CFT002
     C                     MOVEL##NONB    S1RCCO                          CFT002
      *                                                                   CFT002
      * Use customer number                                               CFT002
      *                                                                   CFT002
     C                     OTHER                                          CFT002
     C                     MOVEL*BLANKS   S1RCCO                          CFT002
     C                     MOVELTRCNUM    S1RCCO                          CFT002
     C                     ENDSL                                          CFT002
     C                     ENDIF                                          CFT002
     C                     ENDSL                                          CFT002
     C/COPY WNCPYSRC,FT0300C046
      *                                                                   CFT014
      *  Third Reimbursement Institution                                  CFT014
      *                                                                   CFT014
     C           P55       IFNE *BLANKS                                   CFT014
     C                     MOVELP55       DSTRAN                          CFT014
     C           TRCODE    IFNE *BLANKS                                   CFT014
     C                     MOVEL*BLANKS   S1TRIB                          CFT014
     C                     ENDIF                                          CFT014
     C           TRCODE    IFNE *BLANKS                                   CFT014
      *                                                                   CFT014
      * Translate to nostro and retail account numbers                    CFT014
      *                                                                   CFT014
     C                     EXSR SRTRAN                                    CFT014
     C                     SELEC                                          CFT014
      *                                                                   CFT014
      * If local and account currency local then use retail number        CFT014
      *                                                                   CFT014
     C           BJLCCY    WHEQ S1SMCY                                    CFT014
     C           TRCYCD    ANDEQS1SMCY                                    CFT014
     C           ##ACNO    ANDNE0                                         CFT014
     C                     MOVEL*BLANKS   S1TRIB                          CFT014
     C                     MOVEL##ACNO    S1TRIB                          CFT014
      *                                                                   CFT014
      * If currency the same as settle and nostro, use nostro             CFT014
      *                                                                   CFT014
     C           ##NCCY    WHEQ S1SMCY                                    CFT014
     C           ##NONB    ANDNE*BLANKS                                   CFT014
     C                     MOVEL*BLANKS   S1TRIB                          CFT014
     C                     MOVEL##NONB    S1TRIB                          CFT014
      *                                                                   CFT014
      * If currency the same use GL Account                               CFT014
     C           TRCYCD    WHEQ S1SMCY                                    CFT014
     C                     MOVEL*BLANKS   S1TRIB                          CFT014
     C           BGMBIN    IFNE 'Y'                                       CFT014
     C                     MOVE '   '     TRCODE                          CFT014
     C                     ENDIF                                          CFT014
     C                     MOVELTRCODE    S1TRIB                          CFT014
      *                                                                   CFT014
      * Use customer number                                               CFT014
      *                                                                   CFT014
     C                     OTHER                                          CFT014
     C                     MOVEL*BLANKS   S1TRIB                          CFT014
     C                     MOVELTRCNUM    S1TRIB                          CFT014
     C                     ENDSL                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT002
      *  Account with Institution                                         CFT002
      *  Can't be translated if FONTIS message                            CGL009
     C           PNWRK     IFNE 'FONTIS'                                  CGL009
     C/COPY WNCPYSRC,FT0300C066
     C           P57       IFNE *BLANKS                                   CFT002
     C                     MOVELP57       DSTRAN                          CFT002
     C           TRCODE    IFNE *BLANKS                                   CFT002
     C                     MOVEL*BLANKS   S1ACBB                          CFT002
      *                                                                   CFT002
      * Translate to nostro and retail account numbers                    CFT002
      *                                                                   CFT002
     C                     EXSR SRTRAN                                    CFT002
     C                     SELEC                                          CFT002
      *                                                                   CFT002
      * If local and account currency local then use retail number        CFT002
      * Save if CFT012 is on                                              CFT012
      *                                                                   CFT002
     C           BJLCCY    WHEQ S1SMCY                                    CFT002
     C           TRCYCD    ANDEQS1SMCY                                    CFT002
     C           ##ACNO    ANDNE0                                         CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C                     MOVEL*BLANKS   S1ACBK                          CFT002
     C                     MOVEL##ACNO    S1ACBK                          CFT002
      *                                                                   CFT012
     C           ##ACNO    WHNE 0                                         CFT012
     C           CFT012    ANDEQ'Y'                                       CFT012
     C                     MOVEL*BLANKS   S1ACBK                          CFT012
     C                     MOVEL##ACNO    S1ACBK                          CFT012
     C                     MOVELTRCYCD    S1PCCY                          CFT012
      *                                                                   CFT002
      * If currency the same as settle and nostro, use nostro             CFT002
      * Save if CFT012 is on                                              CFT012
      *                                                                   CFT002
     C           ##NCCY    WHEQ S1SMCY                                    CFT002
     C           ##NONB    ANDNE*BLANKS                                   CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C                     MOVEL*BLANKS   S1ACBK                          CFT002
     C                     MOVEL##NONB    S1ACBK                          CFT002
      *                                                                   CFT012
     C           ##NONB    WHNE *BLANKS                                   CFT012
     C           CFT012    ANDEQ'Y'                                       CFT012
     C                     MOVEL*BLANKS   S1ACBK                          CFT012
     C                     MOVEL##NONB    S1ACBK                          CFT012
     C                     MOVEL##NCCY    S1PCCY                          CFT012
      *                                                                   CFT002
      * If currency the same use GL Account                               CFT002
      * Save if CFT012 is on                                              CFT012
      *                                                                   CFT002
     C           TRCYCD    WHEQ S1SMCY                                    CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C                     MOVEL*BLANKS   S1ACBK                          CFT002
     C           TRCNUM    CAT  TRCDSQ    S1ACBK                          CFT002
     C           BGMBIN    IFEQ 'Y'                                       CFT002
     C                     MOVE TRBRCD    S1ACBB                          CFT002
     C                     END                                            CFT002
      *                                                                   CFT012
     C           CFT012    WHEQ 'Y'                                       CFT012
     C           TRCYCD    ANDNE*BLANK                                    CFT012
     C           TRCDSQ    ANDNE*BLANK                                    CFT012
     C                     MOVEL*BLANKS   S1ACBK                          CFT012
     C           TRCNUM    CAT  TRCDSQ    S1ACBK                          CFT012
     C           BGMBIN    IFEQ 'Y'                                       CFT012
     C                     MOVE TRBRCD    S1ACBB                          CFT012
     C                     END                                            CFT012
     C                     MOVELTRCYCD    S1PCCY                          CFT012
      *                                                                   CFT002
      * Use customer number                                               CFT002
      *                                                                   CFT002
     C                     OTHER                                          CFT002
     C                     MOVEL*BLANKS   S1ACBK                          CFT002
     C                     MOVELTRCNUM    S1ACBK                          CFT002
     C                     ENDSL                                          CFT002
     C                     ENDIF                                          CFT002
     C                     ENDIF                                          CFT002
     C                     ENDIF                                          CGL009
      *                                                                   CFT002
      *  Beneficiary Institution                                          CFT002
      *                                                                   CFT002
     C           P58       IFNE *BLANKS                                   CFT002
     C                     MOVELP58       DSTRAN                          CFT002
     C           TRCODE    IFNE *BLANKS                                   CFT002
      *                                                                   CFT002
      * Translate to nostro and retail account numbers                    CFT002
      *                                                                   CFT002
     C                     EXSR SRTRAN                                    CFT002
     C                     SELEC                                          CFT002
      *                                                                   CFT002
      * If local and account currency local then use retail number        CFT002
      * Save if CFT012 is on                                              CFT012
      *                                                                   CFT002
     C           BJLCCY    WHEQ S1SMCY                                    CFT002
     C           TRCYCD    ANDEQS1SMCY                                    CFT002
     C           ##ACNO    ANDNE0                                         CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C                     MOVEL*BLANKS   S1BNC                           CFT002
     C                     MOVEL##ACNO    S1BNC1                          CFT002
      *                                                                   CFT012
     C           ##ACNO    WHNE 0                                         CFT012
     C           CFT012    ANDEQ'Y'                                       CFT012
     C                     MOVEL*BLANKS   S1BNC                           CFT012
     C                     MOVEL##ACNO    S1BNC1                          CFT002
     C                     MOVELTRCYCD    S1PCCY                          CFT012
      *                                                                   CFT002
      * If currency the same use GL Account                               CFT002
      * Save if CFT012 is on                                              CFT012
      *                                                                   CFT002
     C           TRCYCD    WHEQ S1SMCY                                    CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C                     MOVEL*BLANKS   S1BNC                           CFT002
     C           BGMBIN    IFNE 'Y'                                       CFT002
     C                     MOVEL*BLANKS   TRBRCD                          CFT002
     C                     END                                            CFT002
     C           TRCNUM    CAT  TRCSB     S1BNC1                          CFT002
      *                                                                   CFT012
     C           CFT012    WHEQ 'Y'                                       CFT012
     C           TRCYCD    ANDNE*BLANK                                    CFT012
     C           TRCSB     ANDNE*BLANK                                    CFT012
     C                     MOVEL*BLANKS   S1BNC                           CFT012
     C           BGMBIN    IFNE 'Y'                                       CFT012
     C                     MOVEL*BLANKS   TRBRCD                          CFT012
     C                     END                                            CFT012
     C           TRCNUM    CAT  TRCSB     S1BNC1                          CFT012
     C                     MOVELTRCYCD    S1PCCY                          CFT012
      *                                                                   CFT002
      * Use customer number                                               CFT002
      *                                                                   CFT002
     C                     OTHER                                          CFT002
     C                     MOVELTMLIN1    BNCTAG  1                       CFT002
      *                                                                   CFT002
      * If account line format as / with customer number in line 2        CFT002
      *                                                                   CFT002
     C           BNCTAG    IFEQ '/'                                       CFT002
     C                     MOVELTMLIN1    S1BNC1                          CFT002
     C                     MOVELTRCNUM    S1BNC2                          CFT002
     C                     MOVEL*BLANKS   S1BNC3                          CFT002
     C                     MOVEL*BLANKS   S1BNC4                          CFT002
     C                     ELSE                                           CFT002
     C                     MOVEL*BLANKS   S1BNC                           CFT002
     C                     MOVELTRCNUM    S1BNC1                          CFT002
     C                     ENDIF                                          CFT002
     C                     ENDSL                                          CFT002
     C                     ENDIF                                          CFT002
     C                     ENDIF                                          CFT002
      *                                                                   CFT002
      *  Beneficiary Customer                                             CFT002
      *                                                                   CFT002
     C           P59       IFNE *BLANKS                                   CFT002
     C                     MOVELP59       DSTRAN                          CFT002
     C           TRCODE    IFNE *BLANKS                                   CFT002
      *                                                                   CFT002
      * Translate to nostro and retail account numbers                    CFT002
      *                                                                   CFT002
     C                     EXSR SRTRAN                                    CFT002
     C                     SELEC                                          CFT002
      *                                                                   CFT002
      * If local and account currency local then use retail number        CFT002
      * Save if CFT012 is on                                              CFT012
      *                                                                   CFT002
     C           BJLCCY    WHEQ S1SMCY                                    CFT002
     C           TRCYCD    ANDEQS1SMCY                                    CFT002
     C           ##ACNO    ANDNE0                                         CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C                     MOVEL*BLANKS   S1BNC                           CFT002
     C                     MOVEL##ACNO    S1BNC1                          CFT002
      *                                                                   CFT012
     C           ##ACNO    WHNE 0                                         CFT012
     C           CFT012    ANDEQ'Y'                                       CFT012
     C                     MOVEL*BLANKS   S1BNC                           CFT012
     C                     MOVEL##ACNO    S1BNC1                          CFT012
     C                     MOVELTRCYCD    S1PCCY                          CFT012
      *                                                                   CFT002
      * If currency the same use GL Account                               CFT002
      * Save if CFT012 is on                                              CFT012
      *                                                                   CFT002
     C           TRCYCD    WHEQ S1SMCY                                    CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C                     MOVEL*BLANKS   S1BNC                           CFT002
     C           BGMBIN    IFNE 'Y'                                       CFT002
     C                     MOVEL*BLANKS   TRBRCD                          CFT002
     C                     ENDIF                                          CFT002
     C           TRCNUM    CAT  TRCSB     S1BNC1                          CFT002
      *                                                                   CFT012
     C           CFT012    WHEQ 'Y'                                       CFT012
     C           TRCYCD    ANDNE*BLANK                                    CFT012
     C           TRCSB     ANDNE*BLANK                                    CFT012
     C                     MOVEL*BLANKS   S1BNC                           CFT012
     C           BGMBIN    IFNE 'Y'                                       CFT012
     C                     MOVEL*BLANKS   TRBRCD                          CFT012
     C                     ENDIF                                          CFT012
     C           TRCNUM    CAT  TRCSB     S1BNC1                          CFT012
     C                     MOVELTRCYCD    S1PCCY                          CFT012
      *                                                                   CFT002
      * Use customer number                                               CFT002
      *                                                                   CFT002
     C                     OTHER                                          CFT002
     C                     MOVELTMLIN1    BNCTAG                          CFT002
      *                                                                   CFT002
      * If account line format as / with customer number in line 2        CFT002
      *                                                                   CFT002
     C           BNCTAG    IFEQ '/'                                       CFT002
     C                     MOVELTMLIN1    S1BNC1                          CFT002
     C                     MOVEL*BLANKS   S1BNC2                          CFT003
     C                     MOVELTRCNUM    S1BNC2                          CFT002
     C                     MOVEL*BLANKS   S1BNC3                          CFT002
     C                     MOVEL*BLANKS   S1BNC4                          CFT002
     C                     ELSE                                           CFT002
     C                     MOVEL*BLANKS   S1BNC                           CFT002
     C                     MOVELTRCNUM    S1BNC1                          CFT002
     C                     ENDIF                                          CFT002
     C                     ENDSL                                          CFT002
     C                     ENDIF                                          CFT002
     C                     ENDIF                                          CFT002
      *                                                                   CFT002
      *  /COPY for BOJ Central Bank ref.                                  CFT002
      *                                                                   CFT002
     C*COPY WNCPYSRC,FT0300BYEN                                           CFT002
      *                                                                   CFT002
      *  Unwind subroutine stack name                                     CFT002
      *                                                                   CFT002
     C           EXIMSG    TAG                                            CFT002
     C                     MOVEA*BLANKS   @STK,Q                          CFT002
     C                     SUB  1         Q                               CFT002
      *                                                                   CFT002
     C                     ENDSR                                          CFT002
      *================================================================   CFT002
      *                                                                   CFT002
      /EJECT                                                              CFT002
      *================================================================   CFT002
      *  Map translated data for Outgoing BOJ messages                    CFT002
      *================================================================   CFT002
      *                                                                   CFT002
     C           SROCLR    BEGSR                                          CFT002
      *                                                                   CFT002
      *  Set up subroutine stack name                                     CFT002
      *                                                                   CFT002
     C                     ADD  1         Q                               CFT002
     C                     MOVEL'SROCLR'  @STK,Q                          CFT002
      *                                                                                       CFT032
     C           PMTPY     IFGE '200'                                                         CFT032
     C           PMTPY     ANDLE'209'                                                         CFT032
     C                     MOVELS4ORC4    S4ORC5                                              CFT032
     C                     ENDIF                                                              CFT032
      *                                                                   CFT012
      ** In cross currency transfer the settlement currency is            CFT012
      ** defaulted therefore, unknown.                                    CFT012
      ** So all the tags candidate for the CR part of the translation     CFT012
      ** need to be tested against the PAYMENT currency.                  CFT012
      ** In all the tags candidate for the DR part of the translation     CFT012
      ** we removed tests against the SETTLEMENT currency                 CFT012
     C           *LIKE     DEFN S4SMCY    WMGCCY                          CFT012
     C           CFT012    IFEQ 'Y'                                       CFT012
     C                     MOVELS4PCCY    WMGCCY                          CFT012
     C                     ELSE                                           CFT012
     C                     MOVELS4SMCY    WMGCCY                          CFT012
     C                     ENDIF                                          CFT012
      *                                                                   CFT002
      *  /Copy point for Outgoing Message Mapping thru Clearer            CFT002
      *                                                                   CFT002
     C*COPY WNCPYSRC,FT0300OCLR                                           CFT002
     C/COPY WNCPYSRC,FT0300OCLR                                           EEE058
      *                                                                   CFT002
      * Set up the detail screen fields from the message.                 CFT002
      *                                                                   CFT002
      * Destination                                                       CFT002
      *                                                                   CFT002
      *  /COPY to Pick up Gaitame Yen Kessai nostro                       CFT002
      *                                                                   CFT002
      *COPY WNCPYSRC,FT0300KYEN                                           CFT002
      *                                                                   CFT002
      * If no Intermediary Bank then copy over P57 to Account with        CFT002
      * bank                                                              CFT002
      *                                                                   CFT002
     C           P56       IFEQ *BLANKS                                   CFT002
     C           P57       ANDNE*BLANKS                                   CFT002
     C                     MOVELP57       DSTRAN                          CFT002
     C                     MOVELTMLIN     S5ACB                           CFT002
     C                     ENDIF                                          CFT002
      *                                                                   CFT002
      * If Intermediary Bank then copy over P56 to Intermediary           CFT002
      * bank                                                              CFT002
      *                                                                   CFT002
     C           P56       IFNE *BLANKS                                   CFT002
     C                     MOVELP56       DSTRAN                          CFT002
     C*********************MOVELTMLIN     S6IBK                     CFT002CFT014
     C                     MOVELTMLIN     S5IBK                           CFT014
     C                     ENDIF                                          CFT002
      *                                                                   CFT002
      * Intermediary Bank                                                 CFT002
      *                                                                   CFT002
     C           P56       IFNE *BLANKS                                   CFT002
     C                     MOVELP56       DSTRAN                          CFT002
     C           TRCODE    IFNE *BLANKS                                   CFT002
     C                     MOVE TRCODE    TRCDE2                          CFT002
     C                     MOVELTMLIN1    INBCH1  1                       CFT002
     C           INBCH1    IFEQ '/'                                       CFT002
     C*********************MOVE *BLANKS   S6IBK1                    CFT002CFT014
     C*********************MOVELTMLIN1    S6IBK1                    CFT002CFT014
     C*********************MOVE *BLANKS   S6IBK2                    CFT002CFT014
     C*********************MOVELTRCNUM    S6IBK2                    CFT002CFT014
     C                     MOVE *BLANKS   S5IBK1                          CFT014
     C                     MOVELTMLIN1    S5IBK1                          CFT014
     C                     MOVE *BLANKS   S5IBK2                          CFT014
     C                     MOVELTRCNUM    S5IBK2                          CFT014
     C                     ELSE                                           CFT002
     C*********************MOVE *BLANKS   S6IBK1                    CFT002CFT014
     C*********************MOVELTRCNUM    S6IBK1                    CFT002CFT014
     C*********************MOVE *BLANKS   S6IBK2                    CFT002CFT014
     C                     MOVE *BLANKS   S5IBK1                          CFT014
     C                     MOVELTRCNUM    S5IBK1                          CFT014
     C                     MOVE *BLANKS   S5IBK2                          CFT014
     C                     END                                            CFT002
     C*********************MOVE *BLANKS   S6IBK3                    CFT002CFT014
     C*********************MOVE *BLANKS   S6IBK4                    CFT002CFT014
     C                     MOVE *BLANKS   S5IBK3                          CFT014
     C                     MOVE *BLANKS   S5IBK4                          CFT014
     C                     END                                            CFT002
     C                     END                                            CFT002
      *                                                                   CFT002
      * Account with Bank - use A/C with bank if entered else use         CFT002
      * Intermediary bank if entered else use Beneficiary                 CFT002
      *                                                                   CFT002
     C                     MOVE *BLANKS   DSTRAN                          CFT002
     C                     SELEC                                          CFT002
     C           P57       WHNE *BLANKS                                   CFT002
     C                     MOVELP57       DSTRAN                          CFT002
     C           P56       WHNE *BLANKS                                   CFT002
     C                     MOVELP56       DSTRAN                          CFT002
     C           P58       WHNE *BLANKS                                   CFT002
     C                     MOVELP58       DSTRAN                          CFT002
     C                     ENDSL                                          CFT002
      *                                                                   CFT002
     C           DSTRAN    IFNE *BLANKS                                   CFT002
     C           TRCODE    ANDNE*BLANKS                                   CFT002
     C                     MOVE TRCODE    TRCDE2                          CFT002
     C                     MOVELTMLIN1    ACBCH1  1                       CFT002
     C           ACBCH1    IFEQ '/'                                       CFT002
     C                     MOVE *BLANKS   S5ACB1                          CFT002
     C                     MOVELTMLIN1    S5ACB1                          CFT002
     C                     MOVE *BLANKS   S5ACB2                          CFT002
     C                     MOVELTRCNUM    S5ACB2                          CFT002
     C                     ELSE                                           CFT002
     C                     MOVE *BLANKS   S5ACB1                          CFT002
     C                     MOVELTRCNUM    S5ACB1                          CFT002
     C                     MOVE *BLANKS   S5ACB2                          CFT002
     C                     ENDIF                                          CFT002
     C                     MOVE *BLANK    S5ACB3                          CFT002
     C                     MOVE *BLANK    S5ACB4                          CFT002
     C                     MOVE *BLANK    S5ACB5                          CFT002
     C                     ENDIF                                          CFT002
      *                                                                   CFT002
      * Ordering Customer                                                 CFT002
      *                                                                   CFT002
     C                     SELEC                                          CGL009
      *                                                                   CGL009
     C           PNWRK     WHEQ 'FONTIS'                                  CGL009
      ** Translation is not working for ordering customer                 CGL009
      ** Use part translated of P53 to map S4ORC                          CGL009
     C                     OTHER                                          CGL009
     C           P50       IFNE *BLANKS                                   CFT002
     C                     MOVELP50       DSTRAN                          CFT002
     C                     MOVELTMLIN     S4ORC                           CFT002
     C                     MOVELTMLIN5    S4ORC5                                              CFT032
     C                     ELSE                                           CFT002
     C           P52       IFNE *BLANKS                                   CFT002
     C                     MOVELP52       DSTRAN                          CFT002
     C                     MOVELTMLIN     S4ORC                           CFT002
     C                     MOVELTMLIN5    S4ORC5                                              CFT032
     C                     ENDIF                                          CFT002
     C                     ENDIF                                          CFT002
      *                                                                   CFT002
      * If Interbank Payment use MT202 keyword                            CFT002
      *                                                                   CFT002
     C           PMTPY     IFEQ '200'                                     CFT002
     C           PMTPY     OREQ '201'                                     CFT002
     C           PMTPY     OREQ '202'                                     CFT002
     C           PMTPY     OREQ '203'                                     CFT002
     C           PMTPY     OREQ '204'                                     CFT002
     C           PMTPY     OREQ '205'                                     CFT002
     C           PMTPY     OREQ 'B22'                                     CFT002
      *                                                                   CFT002
      * /COPY for additional Payment messages                             CFT002
      *                                                                   CFT002
     C/COPY WNCPYSRC,FT0300APAY                                           CFT002
     C                     MOVELS4ORC3    S4ORC4                          CFT002
     C                     MOVELS4ORC2    S4ORC3                          CFT002
     C                     MOVELS4ORC1    S4ORC2                          CFT002
     C                     MOVE *BLANKS   S4ORC1                          CFT002
     C                     MOVEL'MT202'   S4ORC1                          CFT002
     C/COPY WNCPYSRC,FT0300MM01                                           CFT002
     C                     ENDIF                                          CFT002
      *                                                                   CFT002
     C                     ENDSL                                          CGL009
      *                                                                   CGL009
      * Ordering Bank                                                     CFT002
     C                     SELEC                                          CGL009
      ** Special case for FONTIS                                          CGL009
     C           PNWRK     WHEQ 'FONTIS'                                  CGL009
     C/COPY WNCPYSRC,FT0300MM02                                           CFT002
     C/COPY WNCPYSRC,FT0300MM05                                           HVB001
      ** Ordering bank is never filled  in FONTIS                         CGL009
      *                                                                   CGL009
      ** Other Networks                                                   CGL009
     C                     OTHER                                          CGL009
      *                                                                   CFT002
      * If Third Reimbursement Institution is not blank, use it           CFT014
      * otherwise                                                         CFT014
      * If Receivers Correspondent is not blank, use it                   CFT002
      * otherwise use Senders Correspondent. If both are blank            CFT002
      * use Sender details.                                               CFT002
      *                                                                   CFT002
     C                     SELEC                                          CFT002
      *                                                                   CFT014
      * Use Third Reimb Institution details                               CFT014
      *                                                                   CFT014
     C           P55       WHNE *BLANKS                                   CFT014
      *                                                                   CFT014
     C                     MOVELP55       DSTRAN                          CFT014
     C                     MOVEL*BLANKS   S4ORBB                          CFT014
     C           TRCODE    IFNE *BLANKS                                   CFT014
     C                     MOVE TRCODE    TRCDE2                          CFT014
     C           TRCYCD    IFEQ *BLANKS                                   CFT014
     C                     MOVE *BLANKS   S4ORBK                          CFT014
     C                     MOVELTRCNUM    S4ORBK                          CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
      * Translate to nostro and retail account numbers                    CFT014
      *                                                                   CFT014
     C                     EXSR SRTRAN                                    CFT014
     C                     SELEC                                          CFT014
      *                                                                   CFT014
      * If local and account currency local then use retail number        CFT014
      * Save if CFT012 is on                                              CFT014
      *                                                                   CFT014
     C           BJLCCY    WHEQ S4SMCY                                    CFT014
     C           TRCYCD    ANDEQS4SMCY                                    CFT014
     C           ##ACNO    ANDNE0                                         CFT014
     C           CFT012    ANDEQ'N'                                       CFT014
     C                     MOVEL*BLANKS   S4ORBK                          CFT014
     C                     MOVEL##ACNO    S4ORBK                          CFT014
      *                                                                   CFT014
     C           ##ACNO    WHNE 0                                         CFT014
     C           CFT012    ANDEQ'Y'                                       CFT014
     C                     MOVEL*BLANKS   S4ORBK                          CFT014
     C                     MOVEL##ACNO    S4ORBK                          CFT014
     C                     MOVELTRCYCD    S4SMCY                          CFT014
      *                                                                   CFT014
      * If currency the same as settle and nostro, use nostro             CFT014
      * Save if CFT012 is on                                              CFT014
      *                                                                   CFT014
     C           ##NCCY    WHEQ S4SMCY                                    CFT014
     C           ##NONB    ANDNE*BLANKS                                   CFT014
     C           CFT012    ANDEQ'N'                                       CFT014
     C                     MOVEL*BLANKS   S4ORBK                          CFT014
     C                     MOVEL##NONB    S4ORBK                          CFT014
      *                                                                   CFT014
     C           ##NONB    WHNE *BLANKS                                   CFT014
     C           CFT012    ANDEQ'Y'                                       CFT014
     C                     MOVEL*BLANKS   S4ORBK                          CFT014
     C                     MOVEL##NONB    S4ORBK                          CFT014
     C                     MOVEL##NCCY    S4SMCY                          CFT014
      *                                                                   CFT014
      * If currency the same use GL Account                               CFT014
      * Save if CFT012 is on                                              CFT014
      *                                                                   CFT014
     C           TRCYCD    WHEQ S4SMCY                                    CFT014
     C           CFT012    ANDEQ'N'                                       CFT014
     C           TRCNUM    CAT  TRCDSQ    S4ORBK                          CFT014
     C           WUMBIN    IFEQ 'Y'                                       CFT014
     C                     MOVE TRBRCD    S4ORBB                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           CFT012    WHEQ 'Y'                                       CFT014
     C           TRCYCD    ANDNE*BLANK                                    CFT014
     C           TRCDSQ    ANDNE*BLANK                                    CFT014
     C           TRCNUM    CAT  TRCDSQ    S4ORBK                          CFT014
     C           WUMBIN    IFEQ 'Y'                                       CFT014
     C                     MOVE TRBRCD    S4ORBB                          CFT014
     C                     ENDIF                                          CFT014
     C                     MOVELTRCYCD    S4SMCY                          CFT014
      *                                                                   CFT014
      * Use customer number                                               CFT014
      *                                                                   CFT014
     C                     OTHER                                          CFT014
     C                     MOVEL*BLANKS   S4ORBK                          CFT014
     C                     MOVELTRCODE    TRCDE2                          CFT014
     C                     MOVELTRCNUM    S4ORBK                          CFT014
     C                     ENDSL                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      * Use Receiver's Correspondant details                              CFT014
      *                                                                   CFT014
     C           P54       WHNE *BLANKS                                   CFT002
      *                                                                   CFT002
     C                     MOVELP54       DSTRAN                          CFT002
     C                     MOVEL*BLANKS   S4ORBB                          CFT002
     C           TRCODE    IFNE *BLANKS                                   CFT002
     C                     MOVE TRCODE    TRCDE2                          CFT002
     C           TRCYCD    IFEQ *BLANKS                                   CFT002
     C                     MOVE *BLANKS   S4ORBK                          CFT002
     C                     MOVELTRCNUM    S4ORBK                          CFT002
     C                     ELSE                                           CFT002
      *                                                                   CFT002
      * Translate to nostro and retail account numbers                    CFT002
      *                                                                   CFT002
     C                     EXSR SRTRAN                                    CFT002
     C                     SELEC                                          CFT002
      *                                                                   CFT002
      * If local and account currency local then use retail number        CFT002
      * Save if CFT012 is on                                              CFT012
      *                                                                   CFT002
     C           BJLCCY    WHEQ S4SMCY                                    CFT002
     C           TRCYCD    ANDEQS4SMCY                                    CFT002
     C           ##ACNO    ANDNE0                                         CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C                     MOVEL*BLANKS   S4ORBK                          CFT002
     C                     MOVEL##ACNO    S4ORBK                          CFT002
      *                                                                   CFT012
     C           ##ACNO    WHNE 0                                         CFT012
     C           CFT012    ANDEQ'Y'                                       CFT012
     C                     MOVEL*BLANKS   S4ORBK                          CFT012
     C                     MOVEL##ACNO    S4ORBK                          CFT012
     C                     MOVELTRCYCD    S4SMCY                          CFT012
      *                                                                   CFT002
      * If currency the same as settle and nostro, use nostro             CFT002
      * Save if CFT012 is on                                              CFT012
      *                                                                   CFT002
     C           ##NCCY    WHEQ S4SMCY                                    CFT002
     C           ##NONB    ANDNE*BLANKS                                   CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C                     MOVEL*BLANKS   S4ORBK                          CFT002
     C                     MOVEL##NONB    S4ORBK                          CFT002
      *                                                                   CFT012
     C           ##NONB    WHNE *BLANKS                                   CFT012
     C           CFT012    ANDEQ'Y'                                       CFT012
     C                     MOVEL*BLANKS   S4ORBK                          CFT012
     C                     MOVEL##NONB    S4ORBK                          CFT012
     C                     MOVEL##NCCY    S4SMCY                          CFT012
      *                                                                   CFT002
      * If currency the same use GL Account                               CFT002
      * Save if CFT012 is on                                              CFT012
      *                                                                   CFT002
     C           TRCYCD    WHEQ S4SMCY                                    CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C           TRCNUM    CAT  TRCDSQ    S4ORBK                          CFT002
     C           WUMBIN    IFEQ 'Y'                                       CFT002
     C                     MOVE TRBRCD    S4ORBB                          CFT002
     C                     ENDIF                                          CFT002
      *                                                                   CFT012
     C           CFT012    WHEQ 'Y'                                       CFT012
     C           TRCYCD    ANDNE*BLANK                                    CFT012
     C           TRCDSQ    ANDNE*BLANK                                    CFT012
     C           TRCNUM    CAT  TRCDSQ    S4ORBK                          CFT012
     C           WUMBIN    IFEQ 'Y'                                       CFT012
     C                     MOVE TRBRCD    S4ORBB                          CFT012
     C                     ENDIF                                          CFT012
     C                     MOVELTRCYCD    S4SMCY                          CFT012
      *                                                                   CFT002
      * Use customer number                                               CFT002
      *                                                                   CFT002
     C                     OTHER                                          CFT002
     C                     MOVEL*BLANKS   S4ORBK                          CFT002
     C                     MOVELTRCODE    TRCDE2                          CFT002
     C                     MOVELTRCNUM    S4ORBK                          CFT002
     C                     ENDSL                                          CFT002
     C                     ENDIF                                          CFT002
     C                     ENDIF                                          CFT002
      *                                                                   CFT002
      * Senders Correspondent                                             CFT002
      *                                                                   CFT002
     C           P53       WHNE *BLANKS                                   CFT002
     C                     MOVELP53       DSTRAN                          CFT002
     C                     MOVEL*BLANKS   S4ORBB                          CFT002
     C           TRCODE    IFNE *BLANKS                                   CFT002
     C                     MOVE TRCODE    TRCDE2                          CFT002
     C           TRCYCD    IFEQ *BLANKS                                   CFT002
     C                     MOVEL*BLANKS   S4ORBK                          CFT002
     C                     MOVELTRCNUM    S4ORBK                          CFT002
     C                     ELSE                                           CFT002
      *                                                                   CFT002
      * Translate to nostro and retail account numbers                    CFT002
      *                                                                   CFT002
     C                     EXSR SRTRAN                                    CFT002
     C                     SELEC                                          CFT002
      *                                                                   CFT002
      * If local and account currency local then use retail number        CFT002
      * Save if CFT012 is on                                              CFT012
      *                                                                   CFT002
     C           BJLCCY    WHEQ S4SMCY                                    CFT002
     C           TRCYCD    ANDEQS4SMCY                                    CFT002
     C           ##ACNO    ANDNE0                                         CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C                     MOVEL*BLANKS   S4ORBK                          CFT002
     C                     MOVEL##ACNO    S4ORBK                          CFT002
      *                                                                   CFT012
     C           ##ACNO    WHNE 0                                         CFT012
     C           CFT012    ANDEQ'Y'                                       CFT012
     C                     MOVEL*BLANKS   S4ORBK                          CFT012
     C                     MOVEL##ACNO    S4ORBK                          CFT012
     C                     MOVELTRCYCD    S4SMCY                          CFT012
      *                                                                   CFT002
      * If currency the same as settle and nostro, use nostro             CFT002
      * Save if CFT012 is on                                              CFT012
      *                                                                   CFT002
     C           ##NCCY    WHEQ S4SMCY                                    CFT002
     C           ##NONB    ANDNE*BLANKS                                   CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C                     MOVEL*BLANKS   S4ORBK                          CFT002
     C                     MOVEL##NONB    S4ORBK                          CFT002
      *                                                                   CFT012
     C           ##NONB    WHNE *BLANKS                                   CFT012
     C           CFT012    ANDEQ'Y'                                       CFT012
     C                     MOVEL*BLANKS   S4ORBK                          CFT012
     C                     MOVEL##NONB    S4ORBK                          CFT012
     C                     MOVEL##NCCY    S4SMCY                          CFT012
      *                                                                   CFT002
      * If currency the same use GL Account                               CFT002
      * Save if CFT012 is on                                              CFT012
      *                                                                   CFT002
     C           TRCYCD    WHEQ S4SMCY                                    CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C           TRCNUM    CAT  TRCDSQ    S4ORBK                          CFT002
     C           WUMBIN    IFEQ 'Y'                                       CFT002
     C                     MOVELTRBRCD    S4ORBB                          CFT002
     C                     ENDIF                                          CFT002
      *                                                                   CFT012
     C           CFT012    WHEQ 'Y'                                       CFT012
     C           TRCYCD    ANDNE*BLANK                                    CFT012
     C           TRCDSQ    ANDNE*BLANK                                    CFT012
     C           TRCNUM    CAT  TRCDSQ    S4ORBK                          CFT012
     C           WUMBIN    IFEQ 'Y'                                       CFT012
     C                     MOVELTRBRCD    S4ORBB                          CFT012
     C                     ENDIF                                          CFT012
     C                     MOVELTRCYCD    S4SMCY                          CFT012
      *                                                                   CFT002
      * Use customer number                                               CFT002
      *                                                                   CFT002
     C                     OTHER                                          CFT002
     C                     MOVEL*BLANKS   S4ORBK                          CFT002
     C                     MOVELTRCODE    TRCDE2                          CFT002
     C                     MOVELTRCNUM    S4ORBK                          CFT002
     C                     ENDSL                                          CFT002
     C                     ENDIF                                          CFT002
     C                     ENDIF                                          CFT002
      *                                                                   CFT002
      * If TRTAG is :53B: and no account map account from sender          CFT002
      *                                                                   CFT002
     C           TRTAG     IFEQ ':53B:'                                   CFT002
     C           S4ORBK    ANDEQ*BLANKS                                   CFT002
     C           PSN       IFNE *BLANKS                                   CFT002
     C                     MOVELPSN       DSTRAN                          CFT002
     C                     MOVEL*BLANKS   S4ORBB                          CFT002
     C           TRCODE    IFNE *BLANKS                                   CFT002
     C                     MOVE TRCODE    TRCDE2                          CFT002
     C           TRCYCD    IFEQ *BLANKS                                   CFT002
     C                     MOVEL*BLANKS   S4ORBK                          CFT002
     C                     MOVELTRCNUM    S4ORBK                          CFT002
     C                     ELSE                                           CFT002
      *                                                                   CFT002
      * Translate to nostro and retail account numbers                    CFT002
      *                                                                   CFT002
     C                     EXSR SRTRAN                                    CFT002
     C                     SELEC                                          CFT002
      *                                                                   CFT002
      * If local and account currency local then use retail number        CFT002
      * Save if CFT012 is on                                              CFT012
      *                                                                   CFT002
     C           BJLCCY    WHEQ S4SMCY                                    CFT002
     C           TRCYCD    ANDEQS4SMCY                                    CFT002
     C           ##ACNO    ANDNE0                                         CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C                     MOVEL*BLANKS   S4ORBK                          CFT002
     C                     MOVEL##ACNO    S4ORBK                          CFT002
      *                                                                   CFT012
     C           ##ACNO    WHNE 0                                         CFT012
     C           CFT012    ANDEQ'Y'                                       CFT012
     C                     MOVEL*BLANKS   S4ORBK                          CFT012
     C                     MOVEL##ACNO    S4ORBK                          CFT012
     C                     MOVELTRCYCD    S4SMCY                          CFT012
      *                                                                   CFT002
      * If currency the same as settle and nostro, use nostro             CFT002
      * Save if CFT012 is on                                              CFT012
      *                                                                   CFT002
     C           ##NCCY    WHEQ S4SMCY                                    CFT002
     C           ##NONB    ANDNE*BLANKS                                   CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C                     MOVEL*BLANKS   S4ORBK                          CFT002
     C                     MOVEL##NONB    S4ORBK                          CFT002
      *                                                                   CFT012
     C           ##NONB    WHNE *BLANKS                                   CFT012
     C           CFT012    ANDEQ'Y'                                       CFT012
     C                     MOVEL*BLANKS   S4ORBK                          CFT012
     C                     MOVEL##NONB    S4ORBK                          CFT012
     C                     MOVEL##NCCY    S4SMCY                          CFT012
      *                                                                   CFT002
      * If currency the same use GL Account                               CFT002
      * Save if CFT012 is on                                              CFT012
      *                                                                   CFT002
     C           TRCYCD    WHEQ S4SMCY                                    CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C           TRCNUM    CAT  TRCDSQ    S4ORBK                          CFT002
     C           WUMBIN    IFEQ 'Y'                                       CFT002
     C                     MOVELTRBRCD    S4ORBB                          CFT002
     C                     ENDIF                                          CFT002
      *                                                                   CFT012
     C           CFT012    WHEQ 'Y'                                       CFT012
     C           TRCYCD    ANDNE*BLANK                                    CFT012
     C           TRCDSQ    ANDNE*BLANK                                    CFT012
     C           TRCNUM    CAT  TRCDSQ    S4ORBK                          CFT012
     C           WUMBIN    IFEQ 'Y'                                       CFT012
     C                     MOVELTRBRCD    S4ORBB                          CFT012
     C                     ENDIF                                          CFT012
     C                     MOVELTRCYCD    S4SMCY                          CFT012
      *                                                                   CFT002
      * Use customer number                                               CFT002
      *                                                                   CFT002
     C                     OTHER                                          CFT002
     C                     MOVEL*BLANKS   S4ORBK                          CFT002
     C                     MOVELTRCODE    TRCDE2                          CFT002
     C                     MOVELTRCNUM    S4ORBK                          CFT002
     C                     ENDSL                                          CFT002
     C                     ENDIF                                          CFT002
     C                     ENDIF                                          CFT002
     C                     ELSE                                           CFT002
     C                     MOVE *BLANKS   S4ORBK                          CFT002
     C                     MOVELPSNDR     S4ORBK                          CFT002
     C                     ENDIF                                          CFT002
     C                     ENDIF                                          CFT002
      *                                                                   CFT002
      * Use Sender details                                                CFT002
      *                                                                   CFT002
     C           PSN       WHNE *BLANKS                                   CFT002
     C                     MOVELPSN       DSTRAN                          CFT002
     C                     MOVEL*BLANKS   S4ORBB                          CFT002
     C           TRCODE    IFNE *BLANKS                                   CFT002
     C                     MOVE TRCODE    TRCDE2                          CFT002
     C           TRCYCD    IFEQ *BLANKS                                   CFT002
     C                     MOVEL*BLANKS   S4ORBK                          CFT002
     C                     MOVELTRCNUM    S4ORBK                          CFT002
     C                     ELSE                                           CFT002
      *                                                                   CFT002
      * Translate to nostro and retail account numbers                    CFT002
      *                                                                   CFT002
     C                     EXSR SRTRAN                                    CFT002
     C                     SELEC                                          CFT002
      *                                                                   CFT002
      * If local and account currency local then use retail number        CFT002
      * Save if CFT012 is on                                              CFT012
      *                                                                   CFT002
     C           BJLCCY    WHEQ S4SMCY                                    CFT002
     C           TRCYCD    ANDEQS4SMCY                                    CFT002
     C           ##ACNO    ANDNE0                                         CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C                     MOVEL*BLANKS   S4ORBK                          CFT002
     C                     MOVEL##ACNO    S4ORBK                          CFT002
      *                                                                   CFT012
     C           ##ACNO    WHNE 0                                         CFT012
     C           CFT012    ANDEQ'Y'                                       CFT012
     C                     MOVEL*BLANKS   S4ORBK                          CFT012
     C                     MOVEL##ACNO    S4ORBK                          CFT012
     C                     MOVELTRCYCD    S4SMCY                          CFT012
      *                                                                   CFT002
      * If currency the same as settle and nostro, use nostro             CFT002
      * Save if CFT012 is on                                              CFT012
      *                                                                   CFT002
     C           ##NCCY    WHEQ S4SMCY                                    CFT002
     C           ##NONB    ANDNE*BLANKS                                   CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C                     MOVEL*BLANKS   S4ORBK                          CFT002
     C                     MOVEL##NONB    S4ORBK                          CFT002
      *                                                                   CFT012
     C           ##NONB    WHNE *BLANKS                                   CFT012
     C           CFT012    ANDEQ'Y'                                       CFT012
     C                     MOVEL*BLANKS   S4ORBK                          CFT012
     C                     MOVEL##NONB    S4ORBK                          CFT012
     C                     MOVEL##NCCY    S4SMCY                          CFT012
      *                                                                   CFT002
      * If currency the same use GL Account                               CFT002
      * Save if CFT012 is on                                              CFT012
      *                                                                   CFT002
     C           TRCYCD    WHEQ S4SMCY                                    CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C           TRCNUM    CAT  TRCDSQ    S4ORBK                          CFT002
     C           WUMBIN    IFEQ 'Y'                                       CFT002
     C                     MOVELTRBRCD    S4ORBB                          CFT002
     C                     ENDIF                                          CFT002
      *                                                                   CFT002
     C           CFT012    WHEQ 'Y'                                       CFT012
     C           TRCYCD    ANDNE*BLANK                                    CFT012
     C           TRCDSQ    ANDNE*BLANK                                    CFT012
     C           TRCNUM    CAT  TRCDSQ    S4ORBK                          CFT012
     C           WUMBIN    IFEQ 'Y'                                       CFT012
     C                     MOVELTRBRCD    S4ORBB                          CFT012
     C                     ENDIF                                          CFT012
     C                     MOVELTRCYCD    S4SMCY                          CFT012
      *                                                                   CFT002
      * Use customer number                                               CFT002
      *                                                                   CFT002
     C                     OTHER                                          CFT002
     C                     MOVEL*BLANKS   S4ORBK                          CFT002
     C                     MOVELTRCODE    TRCDE2                          CFT002
     C                     MOVELTRCNUM    S4ORBK                          CFT002
     C                     ENDSL                                          CFT002
     C                     ENDIF                                          CFT002
     C                     ELSE                                           CFT002
     C                     MOVE *BLANKS   S4ORBK                          CFT002
     C                     MOVELPSNDR     S4ORBK                          CFT002
     C                     ENDIF                                          CFT002
     C                     ENDSL                                          CFT002
      *                                                                   CGL009
     C                     ENDSL                                          CGL009
      *                                                                   CFT002
      *  /Copy point for Central Bank ref.                                CFT002
      *                                                                   CFT002
     C*COPY WNCPYSRC,FT0300CBK1                                           CFT002
      *                                                                   CFT002
      * Bank to Bank Information                                          CFT002
      *                                                                   CFT002
      * If through payment, the bank to bank information has to be        CFT002
      * carried forward to next outgoing message.                         CFT002
      * (For Swift network only)                                          CFT002
      * (For Fontis network only)                                         CGL009
      *                                                                   CFT002
     C                     MOVE *BLANK    W0BTOB  1                       CFT002
     C           PNWRK     IFEQ 'SWIFT'                                   CFT002
     C           PNWRK     OREQ 'FONTIS'                                  CGL009
     C/COPY WNCPYSRC,FT0300C016
     C/COPY OFCPYSRCZ,CFT135_009                                                              CFT135
     C                     MOVE 'Y'       W0BTOB                          CFT002
     C                     END                                            CFT002
      *                                                                   CFT002
     C           W0BTOB    IFEQ 'Y'                                       CFT002
     C           P72       IFNE *BLANKS                                   CFT002
      *                                                                   CFT002
     C                     SELEC                                          CGL009
      ** Special rule for FONTIS                                          CGL009
     C           PNWRK     WHEQ 'FONTIS'                                  CGL009
     C*                                                                   CGL009
     C                     EXSR ICCHK                                     CGL009
     C*                                                                   CGL009
     C                     MOVELP72       DSFONT                          CGL009
     C*                                                                   CGL009
     C           FOUND     IFEQ 'Y'                                       CGL009
     C*********************MOVEL*BLANK    S5BTB6                    CGL009CFT014
     C*********************MOVELFN72L2    S5BTB1                    CGL009CFT014
     C*********************MOVELFN72L3    S5BTB2                    CGL009CFT014
     C*********************MOVELFN72L4    S5BTB3                    CGL009CFT014
     C*********************MOVELFN72L5    S5BTB4                    CGL009CFT014
     C*********************MOVELFN72L6    S5BTB5                    CGL009CFT014
     C                     MOVEL*BLANK    S6BTB6                          CFT014
     C                     MOVELFN72L2    S6BTB1                          CFT014
     C                     MOVELFN72L3    S6BTB2                          CFT014
     C                     MOVELFN72L4    S6BTB3                          CFT014
     C                     MOVELFN72L5    S6BTB4                          CFT014
     C                     MOVELFN72L6    S6BTB5                          CFT014
     C                     ELSE                                           CGL009
     C*********************MOVELFN72L1    S5BTB1                    CGL009CFT014
     C*********************MOVELFN72L2    S5BTB2                    CGL009CFT014
     C*********************MOVELFN72L3    S5BTB3                    CGL009CFT014
     C*********************MOVELFN72L4    S5BTB4                    CGL009CFT014
     C*********************MOVELFN72L5    S5BTB5                    CGL009CFT014
     C*********************MOVELFN72L6    S5BTB6                    CGL009CFT014
     C                     MOVELFN72L1    S6BTB1                          CFT014
     C                     MOVELFN72L2    S6BTB2                          CFT014
     C                     MOVELFN72L3    S6BTB3                          CFT014
     C                     MOVELFN72L4    S6BTB4                          CFT014
     C                     MOVELFN72L5    S6BTB5                          CFT014
     C                     MOVELFN72L6    S6BTB6                          CFT014
     C                     ENDIF                                          CGL009
      ** Other Networks                                                   CGL009
     C                     OTHER                                          CGL009
     C                     MOVELP72       DSTRAN                          CFT002
     C*********************MOVELTMLIN1    S5BTB1                    CFT002CFT014
     C*********************MOVELTMLIN2    S5BTB2                    CFT002CFT014
     C*********************MOVELTMLIN3    S5BTB3                    CFT002CFT014
     C*********************MOVELTMLIN4    S5BTB4                    CFT002CFT014
     C*********************MOVELTMLIN5    S5BTB5                    CFT002CFT014
     C*********************MOVELTMLIN6    S5BTB6                    CFT002CFT014
     C                     MOVELTMLIN1    S6BTB1                          CFT014
     C                     MOVELTMLIN2    S6BTB2                          CFT014
     C                     MOVELTMLIN3    S6BTB3                          CFT014
     C                     MOVELTMLIN4    S6BTB4                          CFT014
     C                     MOVELTMLIN5    S6BTB5                          CFT014
     C                     MOVELTMLIN6    S6BTB6                          CFT014
      *                                                                   CGL009
     C                     ENDSL                                          CGL009
      *                                                                   CFT002
     C                     END                                            CFT002
     C                     END                                            CFT002
     C/COPY WNCPYSRC,FT0300C017
     C/COPY OFCPYSRCZ,CFT135_010                                                              CFT135
      *                                                                   CFT002
      *                                                                   CFT002
      *  Unwind subroutine stack name                                     CFT002
      *                                                                   CFT002
     C           EXOCLR    TAG                                            CFT002
     C                     MOVEA*BLANKS   @STK,Q                          CFT002
     C                     SUB  1         Q                               CFT002
      *                                                                   CFT002
     C                     ENDSR                                          CFT002
      *================================================================   CFT002
      *                                                                   CFT002
      /EJECT                                                              CFT002
      *================================================================   CFT002
      *  Map translated data for Outgoing SWIFT messages                  CFT002
      *================================================================   CFT002
      *                                                                   CFT002
     C           SROSWT    BEGSR                                          CFT002
      *                                                                   CFT002
      *  Set up subroutine stack name                                     CFT002
      *                                                                   CFT002
     C                     ADD  1         Q                               CFT002
     C                     MOVEL'SROSWT'  @STK,Q                          CFT002
      *                                                                   CFT012
      ** In cross currency transfer the settlement currency is            CFT012
      ** defaulted therefore, unknown.                                    CFT012
      ** So all the tags candidate for the CR part of the translation     CFT012
      ** need to be tested against the PAYMENT currency.                  CFT012
      ** In all the tags candidate for the DR part of the translation     CFT012
      ** we removed tests against the SETTLEMENT currency                 CFT012
     C           CFT012    IFEQ 'Y'                                       CFT012
     C                     MOVELS4PCCY    WMGCCY                          CFT012
     C                     ELSE                                           CFT012
     C                     MOVELS4SMCY    WMGCCY                          CFT012
     C                     ENDIF                                          CFT012
      *                                                                   CFT002
      *  /Copy point for Outgoing SWIFT Message Mapping                   CFT002
      *                                                                   CFT002
     C*COPY WNCPYSRC,FT0300OSWT                                           CFT002
     C/COPY WNCPYSRC,FT0300OSWT                                           EEE058
      *                                                                   CFT002
      * Set up the detail screen fields from the message.                 CFT002
      *                                                                   CFT002
      * Destination                                                       CFT002
      *                                                                   CFT002
      * If Intermediary Bank is blank, use 'A/c with Institution'         CFT002
      * details if not blank, otherwise use Beneficiary  details          CFT002
      * if not blank, otherwise use Intermediary Bank details             CFT002
      *                                                                   CFT002
     C                     SELEC                                          CFT002
      *                                                                   CFT002
     C           P56       WHNE *BLANKS                                   CFT002
     C                     MOVELP56       DSTRAN                          CFT002
     C           P57       WHNE *BLANKS                                   CFT002
     C                     MOVELP57       DSTRAN                          CFT002
     C           P58       WHNE *BLANKS                                   CFT002
     C           PNWRK     ANDNE'FONTIS'                                  CGL009
     C                     MOVELP58       DSTRAN                          CFT002
     C                     ENDSL                                          CFT002
      *                                                                   CFT002
     C           TRCODE    IFNE *BLANKS                                   CFT002
      *                                                                   CFT002
      * Translate to nostro and retail account numbers                    CFT002
      *                                                                   CFT002
     C                     EXSR SRTRAN                                    CFT002
     C                     SELEC                                          CFT002
      *                                                                   CFT002
      * If local and account currency local then use retail number        CFT002
      *                                                                   CFT002
     C           BJLCCY    WHEQ S4SMCY                                    CFT002
     C           TRCYCD    ANDEQS4SMCY                                    CFT002
     C           ##ACNO    ANDNE0                                         CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C                     MOVEL*BLANKS   S4DST                           CFT002
     C                     MOVEL##ACNO    S4DST1                          CFT002
      *                                                                   CFT012
     C           BJLCCY    WHEQ WMGCCY                                    CFT012
     C           TRCYCD    ANDEQWMGCCY                                    CFT012
     C           ##ACNO    ANDNE0                                         CFT012
     C           CFT012    ANDEQ'Y'                                       CFT012
     C                     MOVEL*BLANKS   S4DST                           CFT012
     C                     MOVEL##ACNO    S4DST1                          CFT012
      *                                                                   CFT002
      * If currency the same as settle and nostro, use nostro             CFT002
      *                                                                   CFT002
     C           ##NCCY    WHEQ S4SMCY                                    CFT002
     C           ##NONB    ANDNE*BLANKS                                   CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C                     MOVEL*BLANKS   S4DST                           CFT002
     C           ##NCCY    CAT  ##NONB    S4DST1    P                     CFT002
      *                                                                   CFT012
      * If currency the same as msg and nostro, use nostro                CFT012
      *                                                                   CFT012
     C           ##NCCY    WHEQ WMGCCY                                    CFT012
     C           ##NONB    ANDNE*BLANKS                                   CFT012
     C           CFT012    ANDEQ'Y'                                       CFT012
     C                     MOVEL*BLANKS   S4DST                           CFT012
     C           ##NCCY    CAT  ##NONB    S4DST1    P                     CFT012
      *                                                                   CFT002
      * If currency the same use GL Account                               CFT002
      *                                                                   CFT002
     C           TRCYCD    WHEQ S4SMCY                                    CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C                     MOVEL*BLANKS   S4DST                           CFT002
     C           BGMBIN    IFNE 'Y'                                       CFT002
     C                     MOVE '   '     TRCODE                          CFT002
     C                     END                                            CFT002
     C                     MOVELTRCODE    S4DST1                          CFT002
      *                                                                   CFT012
     C           TRCYCD    WHEQ WMGCCY                                    CFT012
     C           CFT012    ANDEQ'Y'                                       CFT012
     C                     MOVEL*BLANKS   S4DST                           CFT012
     C           BGMBIN    IFNE 'Y'                                       CFT012
     C                     MOVE '   '     TRCODE                          CFT012
     C                     END                                            CFT012
     C                     MOVELTRCODE    S4DST1                          CFT012
      *                                                                   CFT002
      * Use customer number                                               CFT002
      *                                                                   CFT002
     C                     OTHER                                          CFT002
     C                     MOVEL*BLANKS   S4DST                           CFT002
     C                     MOVELTRCNUM    S4DST1                          CFT002
     C                     ENDSL                                          CFT002
     C                     ENDIF                                          CFT002
      *                                                                   CFT002
      * Ordering Customer                                                 CFT002
      *                                                                   CFT002
      *                                                                   CFT002
     C                     SELEC                                          CGL009
     C           PNWRK     WHEQ 'FONTIS'                                  CGL009
      ** Translation is not working for ordering customer                 CGL009
      ** Use part translated of P53 to map S4ORC                          CGL009
     C                     OTHER                                          CGL009
     C                     SELEC                                          CFT002
      *                                                                   CFT002
     C           P50       WHNE *BLANKS                                   CFT002
     C                     MOVELP50       DSTRAN                          CFT002
     C                     MOVELTMLIN1    S4ORC1                          CFT002
     C                     MOVELTMLIN2    S4ORC2                          CFT002
     C                     MOVELTMLIN3    S4ORC3                          CFT002
     C                     MOVELTMLIN4    S4ORC4                          CFT002
     C                     MOVELTMLIN5    S4ORC5                                            BUG24221
     C           P52       WHNE *BLANKS                                   CFT002
     C                     MOVELP52       DSTRAN                          CFT002
     C                     MOVELTMLIN1    S4ORC1                          CFT002
     C                     MOVELTMLIN2    S4ORC2                          CFT002
     C                     MOVELTMLIN3    S4ORC3                          CFT002
     C                     MOVELTMLIN4    S4ORC4                          CFT002
     C                     ENDSL                                          CFT002
      *                                                                   CFT002
     C           PMTPY     IFEQ '200'                                     CFT002
     C           PMTPY     OREQ '201'                                     CFT002
     C           PMTPY     OREQ '202'                                     CFT002
     C           PMTPY     OREQ '203'                                     CFT002
     C           PMTPY     OREQ '205'                                     CFT002
      *                                                                   CFT002
      * /COPY for additional Payment messages                             CFT002
      *                                                                   CFT002
     C/COPY WNCPYSRC,FT0300APAY                                           CFT002
      *                                                                   CFT002
     C                     MOVELS4ORC3    S4ORC4                          CFT002
     C                     MOVELS4ORC2    S4ORC3                          CFT002
     C                     MOVELS4ORC1    S4ORC2                          CFT002
     C                     MOVE *BLANKS   S4ORC1                          CFT002
     C                     MOVEL'MT202'   S4ORC1                          CFT002
     C/COPY WNCPYSRC,FT0300MM01                                           CFT002
     C                     ENDIF                                          CFT002
      *                                                                   CGL009
     C                     ENDSL                                          CGL009
      *                                                                   CFT002
      * Ordering Bank                                                     CFT002
     C                     SELEC                                          CGL009
      ** Special case for FONTIS                                          CGL009
     C           PNWRK     WHEQ 'FONTIS'                                  CGL009
     C/COPY WNCPYSRC,FT0300MM02                                           CFT002
     C/COPY WNCPYSRC,FT0300MM05                                           HVB001
      ** Ordering bank is never filled  in FONTIS                         CGL009
      *                                                                   CGL009
      ** Other Networks                                                   CGL009
     C                     OTHER                                          CGL009
      *                                                                   CFT002
      * If Third Reimbursement Institution is not blank, use it           CFT014
      * otherwise                                                         CFT014
      * If Receivers Correspondent is not blank, use it                   CFT002
      * otherwise use Senders Correspondent. If both are blank            CFT002
      * use Sender details.                                               CFT002
      *                                                                   CFT002
     C                     SELEC                                          CFT002
      *                                                                   CFT014
      * Use Third Reimb Institution details                               CFT014
      *                                                                   CFT014
     C           P55       WHNE *BLANKS                                   CFT014
      *                                                                   CFT014
     C                     MOVELP55       DSTRAN                          CFT014
     C                     MOVEL*BLANKS   S4ORBB                          CFT014
     C           TRCODE    IFNE *BLANKS                                   CFT014
     C                     MOVE TRCODE    TRCDE2                          CFT014
     C           TRCYCD    IFEQ *BLANKS                                   CFT014
     C                     MOVE *BLANKS   S4ORBK                          CFT014
     C                     MOVELTRCNUM    S4ORBK                          CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
      * Translate to nostro and retail account numbers                    CFT014
      *                                                                   CFT014
     C                     EXSR SRTRAN                                    CFT014
     C                     SELEC                                          CFT014
      *                                                                   CFT014
      * If local and account currency local then use retail number        CFT014
      * Save if CFT012 is on                                              CFT014
      *                                                                   CFT014
     C           BJLCCY    WHEQ S4SMCY                                    CFT014
     C           TRCYCD    ANDEQS4SMCY                                    CFT014
     C           ##ACNO    ANDNE0                                         CFT014
     C           CFT012    ANDEQ'N'                                       CFT014
     C                     MOVEL*BLANKS   S4ORBK                          CFT014
     C                     MOVEL##ACNO    S4ORBK                          CFT014
      *                                                                   CFT014
     C           ##ACNO    WHNE 0                                         CFT014
     C           CFT012    ANDEQ'Y'                                       CFT014
     C                     MOVEL*BLANKS   S4ORBK                          CFT014
     C                     MOVEL##ACNO    S4ORBK                          CFT014
     C                     MOVELTRCYCD    S4SMCY                          CFT014
      *                                                                   CFT014
      * If currency the same as settle and nostro, use nostro             CFT014
      * Save if CFT012 on                                                 CFT014
      *                                                                   CFT014
     C           ##NCCY    WHEQ S4SMCY                                    CFT014
     C           ##NONB    ANDNE*BLANKS                                   CFT014
     C           CFT012    ANDEQ'N'                                       CFT014
     C                     MOVEL*BLANKS   S4ORBK                          CFT014
     C                     MOVEL##NONB    S4ORBK                          CFT014
      *                                                                   CFT014
     C           ##NONB    WHNE *BLANKS                                   CFT014
     C           CFT012    ANDEQ'Y'                                       CFT014
     C                     MOVEL*BLANKS   S4ORBK                          CFT014
     C                     MOVEL##NONB    S4ORBK                          CFT014
     C                     MOVEL##NCCY    S4SMCY                          CFT014
      *                                                                   CFT014
      * If currency the same use GL Account                               CFT014
      * Save if CFT012 on                                                 CFT014
      *                                                                   CFT014
     C           TRCYCD    WHEQ S4SMCY                                    CFT014
     C           CFT012    ANDEQ'N'                                       CFT014
     C           TRCNUM    CAT  TRCDSQ    S4ORBK                          CFT014
     C           WUMBIN    IFEQ 'Y'                                       CFT014
     C                     MOVE TRBRCD    S4ORBB                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           CFT012    WHEQ 'Y'                                       CFT014
     C           TRCYCD    ANDNE*BLANK                                    CFT014
     C           TRCDSQ    ANDNE*BLANK                                    CFT014
     C           TRCNUM    CAT  TRCDSQ    S4ORBK                          CFT014
     C           WUMBIN    IFEQ 'Y'                                       CFT014
     C                     MOVE TRBRCD    S4ORBB                          CFT014
     C                     ENDIF                                          CFT014
     C                     MOVELTRCYCD    S4SMCY                          CFT014
      *                                                                   CFT014
      * Use customer number                                               CFT014
      *                                                                   CFT014
     C                     OTHER                                          CFT014
     C                     MOVEL*BLANKS   S4ORBK                          CFT014
     C                     MOVELTRCODE    TRCDE2                          CFT014
     C                     MOVELTRCNUM    S4ORBK                          CFT014
     C                     ENDSL                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      * Use Receiver's Correspondant details                              CFT014
      *                                                                   CFT014
     C           P54       WHNE *BLANKS                                   CFT002
      *                                                                   CFT002
     C                     MOVELP54       DSTRAN                          CFT002
     C                     MOVEL*BLANKS   S4ORBB                          CFT002
     C           TRCODE    IFNE *BLANKS                                   CFT002
     C                     MOVE TRCODE    TRCDE2                          CFT002
     C           TRCYCD    IFEQ *BLANKS                                   CFT002
     C                     MOVE *BLANKS   S4ORBK                          CFT002
     C                     MOVELTRCNUM    S4ORBK                          CFT002
     C                     ELSE                                           CFT002
      *                                                                   CFT002
      * Translate to nostro and retail account numbers                    CFT002
      *                                                                   CFT002
     C                     EXSR SRTRAN                                    CFT002
     C                     SELEC                                          CFT002
      *                                                                   CFT002
      * If local and account currency local then use retail number        CFT002
      * Save if CFT012 is on                                              CFT012
      *                                                                   CFT002
     C           BJLCCY    WHEQ S4SMCY                                    CFT002
     C           TRCYCD    ANDEQS4SMCY                                    CFT002
     C           ##ACNO    ANDNE0                                         CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C                     MOVEL*BLANKS   S4ORBK                          CFT002
     C                     MOVEL##ACNO    S4ORBK                          CFT002
      *                                                                   CFT002
     C           ##ACNO    WHNE 0                                         CFT012
     C           CFT012    ANDEQ'Y'                                       CFT012
     C                     MOVEL*BLANKS   S4ORBK                          CFT012
     C                     MOVEL##ACNO    S4ORBK                          CFT012
     C                     MOVELTRCYCD    S4SMCY                          CFT012
      *                                                                   CFT002
      * If currency the same as settle and nostro, use nostro             CFT002
      * Save if CFT012 on                                                 CFT012
      *                                                                   CFT002
     C           ##NCCY    WHEQ S4SMCY                                    CFT002
     C           ##NONB    ANDNE*BLANKS                                   CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C                     MOVEL*BLANKS   S4ORBK                          CFT002
     C                     MOVEL##NONB    S4ORBK                          CFT002
      *                                                                   CFT012
     C           ##NONB    WHNE *BLANKS                                   CFT012
     C           CFT012    ANDEQ'Y'                                       CFT012
     C                     MOVEL*BLANKS   S4ORBK                          CFT012
     C                     MOVEL##NONB    S4ORBK                          CFT012
     C                     MOVEL##NCCY    S4SMCY                          CFT012
      *                                                                   CFT002
      * If currency the same use GL Account                               CFT002
      * Save if CFT012 on                                                 CFT012
      *                                                                   CFT002
     C           TRCYCD    WHEQ S4SMCY                                    CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C           TRCNUM    CAT  TRCDSQ    S4ORBK                          CFT002
     C           WUMBIN    IFEQ 'Y'                                       CFT002
     C                     MOVE TRBRCD    S4ORBB                          CFT002
     C                     ENDIF                                          CFT002
      *                                                                   CFT012
     C           CFT012    WHEQ 'Y'                                       CFT012
     C           TRCYCD    ANDNE*BLANK                                    CFT012
     C           TRCDSQ    ANDNE*BLANK                                    CFT012
     C           TRCNUM    CAT  TRCDSQ    S4ORBK                          CFT012
     C           WUMBIN    IFEQ 'Y'                                       CFT012
     C                     MOVE TRBRCD    S4ORBB                          CFT012
     C                     ENDIF                                          CFT012
     C                     MOVELTRCYCD    S4SMCY                          CFT012
      *                                                                   CFT002
      * Use customer number                                               CFT002
      *                                                                   CFT002
     C                     OTHER                                          CFT002
     C                     MOVEL*BLANKS   S4ORBK                          CFT002
     C                     MOVELTRCODE    TRCDE2                          CFT002
     C                     MOVELTRCNUM    S4ORBK                          CFT002
     C                     ENDSL                                          CFT002
     C                     ENDIF                                          CFT002
     C                     ENDIF                                          CFT002
      *                                                                   CFT002
      * Senders Correspondent                                             CFT002
      *                                                                   CFT002
     C           P53       WHNE *BLANKS                                   CFT002
     C                     MOVELP53       DSTRAN                          CFT002
     C                     MOVEL*BLANKS   S4ORBB                          CFT002
     C           TRCODE    IFNE *BLANKS                                   CFT002
     C                     MOVE TRCODE    TRCDE2                          CFT002
     C           TRCYCD    IFEQ *BLANKS                                   CFT002
     C                     MOVEL*BLANKS   S4ORBK                          CFT002
     C                     MOVELTRCNUM    S4ORBK                          CFT002
     C                     ELSE                                           CFT002
      *                                                                   CFT002
      * Translate to nostro and retail account numbers                    CFT002
      *                                                                   CFT002
     C                     EXSR SRTRAN                                    CFT002
     C                     SELEC                                          CFT002
      *                                                                   CFT002
      * If local and account currency local then use retail number        CFT002
      * Save if CFT012 is on                                              CFT012
      *                                                                   CFT002
     C           BJLCCY    WHEQ S4SMCY                                    CFT002
     C           TRCYCD    ANDEQS4SMCY                                    CFT002
     C           ##ACNO    ANDNE0                                         CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C                     MOVEL*BLANKS   S4ORBK                          CFT002
     C                     MOVEL##ACNO    S4ORBK                          CFT002
      *                                                                   CFT012
     C           ##ACNO    WHNE 0                                         CFT012
     C           CFT012    ANDEQ'Y'                                       CFT012
     C                     MOVEL*BLANKS   S4ORBK                          CFT012
     C                     MOVEL##ACNO    S4ORBK                          CFT012
     C                     MOVELTRCYCD    S4SMCY                          CFT012
      *                                                                   CFT002
      * If currency the same as settle and nostro, use nostro             CFT002
      * Save if CFT012 is on                                              CFT012
      *                                                                   CFT002
     C           ##NCCY    WHEQ S4SMCY                                    CFT002
     C           ##NONB    ANDNE*BLANKS                                   CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C                     MOVEL*BLANKS   S4ORBK                          CFT002
     C                     MOVEL##NONB    S4ORBK                          CFT002
      *                                                                   CFT012
     C           ##NONB    WHNE *BLANKS                                   CFT012
     C           CFT012    ANDEQ'Y'                                       CFT012
     C                     MOVEL*BLANKS   S4ORBK                          CFT012
     C                     MOVEL##NONB    S4ORBK                          CFT012
     C                     MOVEL##NCCY    S4SMCY                          CFT012
      *                                                                   CFT002
      * If currency the same use GL Account                               CFT002
      * Save if CFT012 is on                                              CFT012
      *                                                                   CFT002
     C           TRCYCD    WHEQ S4SMCY                                    CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C           TRCNUM    CAT  TRCDSQ    S4ORBK                          CFT002
     C           WUMBIN    IFEQ 'Y'                                       CFT002
     C                     MOVELTRBRCD    S4ORBB                          CFT002
     C                     ENDIF                                          CFT002
      *                                                                   CFT012
     C           CFT012    WHEQ 'Y'                                       CFT012
     C           TRCYCD    ANDNE*BLANK                                    CFT012
     C           TRCDSQ    ANDNE*BLANK                                    CFT012
     C           TRCNUM    CAT  TRCDSQ    S4ORBK                          CFT012
     C           WUMBIN    IFEQ 'Y'                                       CFT012
     C                     MOVELTRBRCD    S4ORBB                          CFT012
     C                     ENDIF                                          CFT012
     C                     MOVELTRCYCD    S4SMCY                          CFT012
      *                                                                   CFT002
      * Use customer number                                               CFT002
      *                                                                   CFT002
     C                     OTHER                                          CFT002
     C                     MOVEL*BLANKS   S4ORBK                          CFT002
     C                     MOVELTRCODE    TRCDE2                          CFT002
     C                     MOVELTRCNUM    S4ORBK                          CFT002
     C                     ENDSL                                          CFT002
     C                     ENDIF                                          CFT002
     C                     ENDIF                                          CFT002
      *                                                                   CFT002
      * If TRTAG is :53B: and no account map account from sender          CFT002
      *                                                                   CFT002
     C           TRTAG     IFEQ ':53B:'                                   CFT002
     C           S4ORBK    ANDEQ*BLANKS                                   CFT002
     C           PSN       IFNE *BLANKS                                   CFT002
     C                     MOVELPSN       DSTRAN                          CFT002
     C                     MOVEL*BLANKS   S4ORBB                          CFT002
     C           TRCODE    IFNE *BLANKS                                   CFT002
     C                     MOVE TRCODE    TRCDE2                          CFT002
     C           TRCYCD    IFEQ *BLANKS                                   CFT002
     C                     MOVEL*BLANKS   S4ORBK                          CFT002
     C                     MOVELTRCNUM    S4ORBK                          CFT002
     C                     ELSE                                           CFT002
      *                                                                   CFT002
      * Translate to nostro and retail account numbers                    CFT002
      *                                                                   CFT002
     C                     EXSR SRTRAN                                    CFT002
     C                     SELEC                                          CFT002
      *                                                                   CFT002
      * If local and account currency local then use retail number        CFT002
      * Save if CFT012 is on                                              CFT012
      *                                                                   CFT002
     C           BJLCCY    WHEQ S4SMCY                                    CFT002
     C           TRCYCD    ANDEQS4SMCY                                    CFT002
     C           ##ACNO    ANDNE0                                         CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C                     MOVEL*BLANKS   S4ORBK                          CFT002
     C                     MOVEL##ACNO    S4ORBK                          CFT002
      *                                                                   CFT012
     C           ##ACNO    WHNE 0                                         CFT012
     C           CFT012    ANDEQ'Y'                                       CFT012
     C                     MOVEL*BLANKS   S4ORBK                          CFT012
     C                     MOVEL##ACNO    S4ORBK                          CFT012
     C                     MOVELTRCYCD    S4SMCY                          CFT012
      *                                                                   CFT002
      * If currency the same as settle and nostro, use nostro             CFT002
      * Save if CFT012 is on                                              CFT012
      *                                                                   CFT002
     C           ##NCCY    WHEQ S4SMCY                                    CFT002
     C           ##NONB    ANDNE*BLANKS                                   CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C                     MOVEL*BLANKS   S4ORBK                          CFT002
     C                     MOVEL##NONB    S4ORBK                          CFT002
      *                                                                   CFT012
     C           ##NONB    WHNE *BLANKS                                   CFT012
     C           CFT012    ANDEQ'Y'                                       CFT012
     C                     MOVEL*BLANKS   S4ORBK                          CFT012
     C                     MOVEL##NONB    S4ORBK                          CFT012
     C                     MOVEL##NCCY    S4SMCY                          CFT012
      *                                                                   CFT002
      * If currency the same use GL Account                               CFT002
      * Save if CFT012 is on                                              CFT012
      *                                                                   CFT002
     C           TRCYCD    WHEQ S4SMCY                                    CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C           TRCNUM    CAT  TRCDSQ    S4ORBK                          CFT002
     C           WUMBIN    IFEQ 'Y'                                       CFT002
     C                     MOVELTRBRCD    S4ORBB                          CFT002
     C                     ENDIF                                          CFT002
      *                                                                   CFT012
     C           CFT012    WHEQ 'Y'                                       CFT012
     C           TRCYCD    ANDNE*BLANK                                    CFT012
     C           TRCDSQ    ANDNE*BLANK                                    CFT012
     C           TRCNUM    CAT  TRCDSQ    S4ORBK                          CFT012
     C           WUMBIN    IFEQ 'Y'                                       CFT012
     C                     MOVELTRBRCD    S4ORBB                          CFT012
     C                     ENDIF                                          CFT012
     C           PNWRK     IFEQ 'SWIFT'                                   ESL038
     C                     MOVELTRCYCD    S4SMCY                          CFT012
     C                     ENDIF                                          ESL038
      *                                                                   CFT002
      * Use customer number                                               CFT002
      *                                                                   CFT002
     C                     OTHER                                          CFT002
     C                     MOVEL*BLANKS   S4ORBK                          CFT002
     C                     MOVELTRCODE    TRCDE2                          CFT002
     C                     MOVELTRCNUM    S4ORBK                          CFT002
     C                     ENDSL                                          CFT002
     C                     ENDIF                                          CFT002
     C                     ELSE                                           CFT002
     C                     MOVE *BLANKS   S4ORBK                          CFT002
     C                     MOVELPSNDR     S4ORBK                          CFT002
     C                     ENDIF                                          CFT002
     C                     ENDIF                                          CFT002
     C                     ENDIF                                          CFT002
      *                                                                   CFT002
      * Use Sender details                                                CFT002
      *                                                                   CFT002
     C           PSN       WHNE *BLANKS                                   CFT002
     C           PNWRK     ANDNE'YENKSI'                                  CFT002
     C                     MOVELPSN       DSTRAN                          CFT002
     C                     MOVEL*BLANKS   S4ORBB                          CFT002
     C           TRCODE    IFNE *BLANKS                                   CFT002
     C                     MOVE TRCODE    TRCDE2                          CFT002
     C           TRCYCD    IFEQ *BLANKS                                   CFT002
     C                     MOVEL*BLANKS   S4ORBK                          CFT002
     C                     MOVELTRCNUM    S4ORBK                          CFT002
     C                     ELSE                                           CFT002
      *                                                                   CFT002
      * Translate to nostro and retail account numbers                    CFT002
      *                                                                   CFT002
     C                     EXSR SRTRAN                                    CFT002
     C                     SELEC                                          CFT002
      *                                                                   CFT002
      * If local and account currency local then use retail number        CFT002
      * Save if CFT012 is on                                              CFT012
      *                                                                   CFT002
     C           BJLCCY    WHEQ S4SMCY                                    CFT002
     C           TRCYCD    ANDEQS4SMCY                                    CFT002
     C           ##ACNO    ANDNE0                                         CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C                     MOVEL*BLANKS   S4ORBK                          CFT002
     C                     MOVEL##ACNO    S4ORBK                          CFT002
      *                                                                   CFT012
     C           ##ACNO    WHNE 0                                         CFT012
     C           CFT012    ANDEQ'Y'                                       CFT012
     C                     MOVEL*BLANKS   S4ORBK                          CFT012
     C                     MOVEL##ACNO    S4ORBK                          CFT012
     C                     MOVELTRCYCD    S4SMCY                          CFT012
      *                                                                   CFT002
      * If currency the same as settle and nostro, use nostro             CFT002
      * Save if CFT012 is on                                              CFT012
      *                                                                   CFT002
     C           ##NCCY    WHEQ S4SMCY                                    CFT002
     C           ##NONB    ANDNE*BLANKS                                   CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C                     MOVEL*BLANKS   S4ORBK                          CFT002
     C                     MOVEL##NONB    S4ORBK                          CFT002
      *                                                                   CFT012
     C           ##NONB    WHNE *BLANKS                                   CFT012
     C           CFT012    ANDEQ'Y'                                       CFT012
     C                     MOVEL*BLANKS   S4ORBK                          CFT012
     C                     MOVEL##NONB    S4ORBK                          CFT012
     C                     MOVEL##NCCY    S4SMCY                          CFT012
      *                                                                   CFT002
      * If currency the same use GL Account                               CFT002
      * Save if CFT012 is on                                              CFT012
      *                                                                   CFT002
     C           TRCYCD    WHEQ S4SMCY                                    CFT002
     C           CFT012    ANDEQ'N'                                       CFT012
     C           TRCNUM    CAT  TRCDSQ    S4ORBK                          CFT002
     C           WUMBIN    IFEQ 'Y'                                       CFT002
     C                     MOVELTRBRCD    S4ORBB                          CFT002
     C                     ENDIF                                          CFT002
      *                                                                   CFT012
     C           CFT012    WHEQ 'Y'                                       CFT012
     C           TRCYCD    ANDNE*BLANK                                    CFT012
     C           TRCDSQ    ANDNE*BLANK                                    CFT012
     C           TRCNUM    CAT  TRCDSQ    S4ORBK                          CFT012
     C           WUMBIN    IFEQ 'Y'                                       CFT012
     C                     MOVELTRBRCD    S4ORBB                          CFT012
     C                     ENDIF                                          CFT012
     C                     MOVELTRCYCD    S4SMCY                          CFT012
      *                                                                   CFT002
     C           PNWRK     WHEQ 'YENKSI'                                  CFT002
      *                                                                   CFT002
      *  /COPY to Pick up Gaitame Yen Kessai nostro                       CFT002
      *                                                                   CFT002
      *COPY WNCPYSRC,FT0300KYEO                                           CFT002
      *                                                                   CFT002
      * Use customer number                                               CFT002
      *                                                                   CFT002
     C                     OTHER                                          CFT002
     C                     MOVEL*BLANKS   S4ORBK                          CFT002
     C                     MOVELTRCODE    TRCDE2                          CFT002
     C                     MOVELTRCNUM    S4ORBK                          CFT002
     C                     ENDSL                                          CFT002
     C                     ENDIF                                          CFT002
     C                     ELSE                                           CFT002
     C                     MOVE *BLANKS   S4ORBK                          CFT002
     C/COPY WNCPYSRC,FT0300MK01
     C                     MOVELPSNDR     S4ORBK                          CFT002
     C/COPY WNCPYSRC,FT0300MK02
     C                     ENDIF                                          CFT002
     C                     ENDSL                                          CFT002
      *                                                                   CGL009
     C                     ENDSL                                          CGL009
      *                                                                   CFT002
      *  /Copy point for Central Bank ref.                                CFT002
      *                                                                   CFT002
     C*COPY WNCPYSRC,FT0300CBK2                                           CFT002
      *                                                                   CFT002
      * Bank to Bank Information                                          CFT002
      *                                                                   CFT002
      * If through payment, the bank to bank information has to be        CFT002
      * carried forward to next outgoing message.                         CFT002
      * (For Swift network only)                                          CFT002
      * (For Fontis network only)                                         CGL009
      *                                                                   CFT002
     C                     MOVE *BLANK    W0BTOB  1                       CFT002
     C           PNWRK     IFEQ 'SWIFT'                                   CFT002
     C           PNWRK     OREQ 'FONTIS'                                  CGL009
     C/COPY WNCPYSRC,FT0300C018
     C/COPY OFCPYSRCZ,CFT135_011                                                              CFT135
     C                     MOVE 'Y'       W0BTOB                          CFT002
     C                     END                                            CFT002
      *                                                                   CFT002
     C           W0BTOB    IFEQ 'Y'                                       CFT002
     C           P72       IFNE *BLANKS                                   CFT002
      *                                                                   CFT002
     C                     SELEC                                          CGL009
      ** Special rule for FONTIS                                          CGL009
     C           PNWRK     WHEQ 'FONTIS'                                  CGL009
     C*                                                                   CGL009
     C                     EXSR ICCHK                                     CGL009
     C*                                                                   CGL009
     C                     MOVELP72       DSFONT                          CGL009
     C*                                                                   CGL009
     C           FOUND     IFEQ 'Y'                                       CGL009
     C*********************MOVEL*BLANK    S5BTB6                    CGL009CFT014
     C*********************MOVELFN72L2    S5BTB1                    CGL009CFT014
     C*********************MOVELFN72L3    S5BTB2                    CGL009CFT014
     C*********************MOVELFN72L4    S5BTB3                    CGL009CFT014
     C*********************MOVELFN72L5    S5BTB4                    CGL009CFT014
     C*********************MOVELFN72L6    S5BTB5                    CGL009CFT014
     C                     MOVEL*BLANK    S6BTB6                          CFT014
     C                     MOVELFN72L2    S6BTB1                          CFT014
     C                     MOVELFN72L3    S6BTB2                          CFT014
     C                     MOVELFN72L4    S6BTB3                          CFT014
     C                     MOVELFN72L5    S6BTB4                          CFT014
     C                     MOVELFN72L6    S6BTB5                          CFT014
     C                     ELSE                                           CGL009
     C*********************MOVELFN72L1    S5BTB1                    CGL009CFT014
     C*********************MOVELFN72L2    S5BTB2                    CGL009CFT014
     C*********************MOVELFN72L3    S5BTB3                    CGL009CFT014
     C*********************MOVELFN72L4    S5BTB4                    CGL009CFT014
     C*********************MOVELFN72L5    S5BTB5                    CGL009CFT014
     C*********************MOVELFN72L6    S5BTB6                    CGL009CFT014
     C                     MOVELFN72L1    S6BTB1                          CFT014
     C                     MOVELFN72L2    S6BTB2                          CFT014
     C                     MOVELFN72L3    S6BTB3                          CFT014
     C                     MOVELFN72L4    S6BTB4                          CFT014
     C                     MOVELFN72L5    S6BTB5                          CFT014
     C                     MOVELFN72L6    S6BTB6                          CFT014
     C                     ENDIF                                          CGL009
      ** Other Networks                                                   CGL009
     C                     OTHER                                          CGL009
     C                     MOVELP72       DSTRAN                          CFT002
     C*********************MOVELTMLIN1    S5BTB1                    CFT002CFT014
     C*********************MOVELTMLIN2    S5BTB2                    CFT002CFT014
     C*********************MOVELTMLIN3    S5BTB3                    CFT002CFT014
     C*********************MOVELTMLIN4    S5BTB4                    CFT002CFT014
     C*********************MOVELTMLIN5    S5BTB5                    CFT002CFT014
     C*********************MOVELTMLIN6    S5BTB6                    CFT002CFT014
     C                     MOVELTMLIN1    S6BTB1                          CFT014
     C                     MOVELTMLIN2    S6BTB2                          CFT014
     C                     MOVELTMLIN3    S6BTB3                          CFT014
     C                     MOVELTMLIN4    S6BTB4                          CFT014
     C                     MOVELTMLIN5    S6BTB5                          CFT014
     C                     MOVELTMLIN6    S6BTB6                          CFT014
      *                                                                   CGL009
     C                     ENDSL                                          CGL009
      *                                                                   CFT002
     C                     END                                            CFT002
     C                     END                                            CFT002
     C/COPY WNCPYSRC,FT0300C019
     C/COPY OFCPYSRCZ,CFT135_012                                                              CFT135
      *                                                                   CFT002
      *  Unwind subroutine stack name                                     CFT002
      *                                                                   CFT002
     C           EXOSWT    TAG                                            CFT002
     C                     MOVEA*BLANKS   @STK,Q                          CFT002
     C                     SUB  1         Q                               CFT002
      *                                                                   CFT002
     C                     ENDSR                                          CFT002
      *                                                                   CFT002
      *================================================================   CFT002
      *  Map Debit Accounts to screen fields                              CFT002
      *================================================================   CFT002
      *                                                                   CFT002
     C           SRDRAC    BEGSR                                          CFT002
      *                                                                   CFT002
      *  Set up subroutine stack name                                     CFT002
      *                                                                   CFT002
     C                     ADD  1         Q                               CFT002
     C                     MOVEL'SRDRAC'  @STK,Q                          CFT002
      *                                                                   CFT002
      *  /Copy point for Debit Account format                             CFT002
      *                                                                   CFT002
     C*COPY WNCPYSRC,FT0300DRAC                                           CFT002
      *                                                                   CFT002
      * Move account to account data structure                            CFT002
      *                                                                   CFT002
     C                     MOVELGNDSET    TRCDE2                          CFT002
     C                     MOVEL*BLANKS   ##ACTP                          CFT002
     C           GNDSET    IFEQ #PRIME                                    CFT002
     C                     EXSR SRPRME                                    CFT002
      *                                                                   CFT002
      * Reset Account if found                                            CFT002
      *                                                                   CFT002
     C           @RTCD     IFEQ *BLANKS                                   CFT002
     C                     MOVELTRCDE2    GNDSET                          CFT002
     C                     ENDIF                                          CFT002
     C                     ENDIF                                          CFT002
      *                                                                   CFT002
      *  Use Nostro no. if found                                          CFT002
      *                                                                   CFT002
     C                     CALL 'AONOSTR0'                                CFT002
     C                     PARM *BLANKS   @RTCD                           CFT002
     C                     PARM '*KEY'    @OPTN                           CFT002
     C                     PARM TRCNUM    @CUST                           CFT002
     C                     PARM TRCYCD    @CYCD                           CFT002
     C                     PARM TRACOD    @ACCD                           CFT002
     C                     PARM TRACSQ    @ACSN                           CFT002
     C                     PARM *BLANKS   @NONB                           CFT002
     C                     PARM TRBRCD    @BRCD                           CFT002
     C                     PARM *BLANKS   @CSSN                           CFT002
     C                     PARM *BLANKS   @PNOI                           CFT002
     C           SDNOST    PARM           DSFDY                           CFT002
      *                                                                   CFT002
      * Nostro found                                                      CFT002
      *                                                                   CFT002
     C           @RTCD     IFEQ *BLANKS                                   CFT002
     C                     MOVEL'Nostro'  ##ACTP  8 P                     CFT002
     C                     ENDIF                                          CFT002
      *                                                                   CFT002
      *  Pick up retail a/c no. if applicable                             CFT002
      *                                                                   CFT002
     C                     MOVE TRCNUM    TRCNM2                          CFT002
     C                     MOVE TRACOD    TRACD2                          CFT002
     C                     MOVE TRACSQ    TRASQ2                          CFT002
      *                                                                   CFT002
     C           *LIKE     DEFN CNUM      TRCNM2                          CFT002
     C           *LIKE     DEFN ACOD      TRACD2                          CFT002
     C           *LIKE     DEFN ACSQ      TRASQ2                          CFT002
      *                                                                   CFT002
     C           KYRTAC    KLIST                                          CFT002
     C                     KFLD           TRCNM2                          CFT002
     C                     KFLD           TRCYCD                          CFT002
     C                     KFLD           TRACD2                          CFT002
     C                     KFLD           TRASQ2                          CFT002
     C                     KFLD           TRBRCD                          CFT002
      *                                                                   CFT002
     C           KYRTAC    CHAINACCNT                89                   CFT002
     C           *IN89     IFEQ '0'                                       CFT002
     C           ATYP      ANDEQ'R'                                       CFT002
     C           ACNO      ANDNE0                                         CFT002
     C           ##ACTP    IFEQ *BLANKS                                   CFT002
     C           ##ACTP    ORNE *BLANKS                                   CFT002
     C           BJLCCY    ANDEQTRCYCD                                    CFT002
     C                     MOVEL'Retail'  ##ACTP    P                     CFT002
     C                     ENDIF                                          CFT002
     C                     ENDIF                                          CFT002
     C/COPY WNCPYSRC,FT0300C068
      *                                                                   CFT002
      *  If Incoming Payment then place in Receiver's Correspondnet       CFT002
      *                                                                   CFT002
     C                     SELEC                                          CFT002
     C           W0ACT     WHEQ '*INC FT'                                 CFT002
     C                     MOVEL*BLANKS   S1RCCO                          CFT002
     C                     SELEC                                          CFT002
     C           ##ACTP    WHEQ 'Retail'                                  CFT002
     C                     MOVELACNO      S1RCCO                          CFT002
     C           ##ACTP    WHEQ 'Nostro'                                  CFT002
     C/COPY WNCPYSRC,FT0300C047
     C                     MOVELA7NONB    S1RCCO                          CFT002
     C/COPY WNCPYSRC,FT0300C048
     C                     OTHER                                          DJBF01
     C                     MOVELGNDSET    S1SND     P                     DJBF01
     C                     ENDSL                                          CFT002
      *                                                                   CFT002
      *  If Outgoing Payment then place in Ordering Bank                  CFT002
      *                                                                   CFT002
     C           W0ACT     WHEQ '*OUT FT'                                 CFT002
     C                     MOVEL*BLANKS   S4ORBK                          CFT002
     C                     MOVEL*BLANKS   S4ORBB                          CFT002
     C                     SELEC                                          CFT002
     C           ##ACTP    WHEQ 'Retail'                                  CFT002
     C                     MOVELACNO      S4ORBK                          CFT002
     C           ##ACTP    WHEQ 'Nostro'                                  CFT002
     C/COPY WNCPYSRC,FT0300C049
     C                     MOVELA7NONB    S4ORBK                          CFT002
     C/COPY WNCPYSRC,FT0300C050
     C                     OTHER                                          CFT002
     C**********           MOVELGNDSET    S4ORBK                    CFT002DJBF01
     C           6         SUBSTGNDSET:1  S4ORBK    P                     DJBF01
     C           6         SUBSTGNDSET:10 ##006A  6                       DJBF01
     C           S4ORBK    CAT  ##006A:0  S4ORBK                          DJBF01
     C                     MOVE GNDSET    S4ORBB                          CFT002
     C                     ENDSL                                          CFT002
     C                     ENDSL                                          CFT002
      *                                                                   CFT002
      *                                                                   CFT002
      *  Unwind subroutine stack name                                     CFT002
      *                                                                   CFT002
     C           EXDRAC    TAG                                            CFT002
     C                     MOVEA*BLANKS   @STK,Q                          CFT002
     C                     SUB  1         Q                               CFT002
      *                                                                   CFT002
     C                     ENDSR                                          CFT002
      *                                                                   CFT002
      *================================================================   CFT002
      *  Map Credit Accounts to screen fields                             CFT002
      *================================================================   CFT002
      *                                                                   CFT002
     C           SRCRAC    BEGSR                                          CFT002
      *                                                                   CFT002
      *  Set up subroutine stack name                                     CFT002
      *                                                                   CFT002
     C                     ADD  1         Q                               CFT002
     C                     MOVEL'SRCRAC'  @STK,Q                          CFT002
      *                                                                   CFT002
      *  /Copy point for Credit Account Format                            CFT002
      *                                                                   CFT002
     C*COPY WNCPYSRC,FT0300CRAC                                           CFT002
      *                                                                   CFT002
      * Move account to account data structure                            CFT002
      *                                                                   CFT002
     C                     MOVELGNCSET    TRCDE2                          CFT002
     C                     MOVEL*BLANKS   ##ACTP                          CFT002
     C           GNCSET    IFEQ #PRIME                                    CFT002
     C                     EXSR SRPRME                                    CFT002
      *                                                                   CFT002
      * Reset Account if found                                            CFT002
      *                                                                   CFT002
     C           @RTCD     IFEQ *BLANKS                                   CFT002
     C                     MOVELTRCDE2    GNCSET                          CFT002
     C                     ENDIF                                          CFT002
     C                     ENDIF                                          CFT002
      *                                                                   CFT002
      *  Use Nostro no. if found                                          CFT002
      *                                                                   CFT002
     C                     CALL 'AONOSTR0'                                CFT002
     C                     PARM *BLANKS   @RTCD                           CFT002
     C                     PARM '*KEY'    @OPTN                           CFT002
     C                     PARM TRCNUM    @CUST                           CFT002
     C                     PARM TRCYCD    @CYCD                           CFT002
     C                     PARM TRACOD    @ACCD                           CFT002
     C                     PARM TRACSQ    @ACSN                           CFT002
     C                     PARM *BLANKS   @NONB                           CFT002
     C                     PARM TRBRCD    @BRCD                           CFT002
     C                     PARM *BLANKS   @CSSN                           CFT002
     C                     PARM *BLANKS   @PNOI                           CFT002
     C           SDNOST    PARM           DSFDY                           CFT002
      *                                                                   CFT002
      * Nostro found                                                      CFT002
      *                                                                   CFT002
     C           @RTCD     IFEQ *BLANKS                                   CFT002
     C                     MOVEL'Nostro'  ##ACTP  8 P                     CFT002
     C                     ENDIF                                          CFT002
      *                                                                   CFT002
      *  Pick up retail a/c no. if applicable                             CFT002
      *                                                                   CFT002
     C                     MOVE TRCNUM    TRCNM2                          CFT002
     C                     MOVE TRACOD    TRACD2                          CFT002
     C                     MOVE TRACSQ    TRASQ2                          CFT002
      *                                                                   CFT002
     C           KYRTAC    CHAINACCNT                89                   CFT002
     C           *IN89     IFEQ '0'                                       CFT002
     C           ATYP      ANDEQ'R'                                       CFT002
     C           ACNO      ANDNE0                                         CFT002
     C           ##ACTP    IFEQ *BLANKS                                   CFT002
     C           ##ACTP    ORNE *BLANKS                                   CFT002
     C           BJLCCY    ANDEQTRCYCD                                    CFT002
     C                     MOVEL'Retail'  ##ACTP    P                     CFT002
     C                     ENDIF                                          CFT002
     C                     ENDIF                                          CFT002
     C/COPY WNCPYSRC,FT0300C074
      *                                                                   CFT002
      *  If Incoming Payment then place in Account with Institution       CFT002
      *                                                                   CFT002
     C                     SELEC                                          CFT002
     C           W0ACT     WHEQ '*INC FT'                                 CFT002
     C                     MOVEL*BLANKS   S1ACBK                          CFT002
     C                     MOVEL*BLANKS   S1ACBB                          CFT002
     C                     SELEC                                          CFT002
     C           ##ACTP    WHEQ 'Retail'                                  CFT002
     C                     MOVELACNO      S1ACBK                          CFT002
     C           ##ACTP    WHEQ 'Nostro'                                  CFT002
     C                     MOVELA7NONB    S1ACBK                          CFT002
     C                     OTHER                                          CFT002
     C**********           MOVELGNCSET    S1ACBK                    CFT002DJBF01
     C           6         SUBSTGNCSET:1  S1ACBK    P                     DJBF01
     C           6         SUBSTGNCSET:10 ##006A  6                       DJBF01
     C           S1ACBK    CAT  ##006A:0  S1ACBK                          DJBF01
     C                     MOVE GNCSET    S1ACBB                          CFT002
     C                     ENDSL                                          CFT002
      *                                                                   CFT002
      * Set Generate Outgoing Payment to "N"o                             CFT002
      *                                                                   CFT002
     C                     MOVEL'N'       S3OPIN                          CFT002
     C/COPY WNCPYSRC,FT0300C069
      *                                                                   CFT002
      *  If Outgoing Payment then place in Destination                    CFT002
      *                                                                   CFT002
     C           W0ACT     WHEQ '*OUT FT'                                 CFT002
     C/COPY WNCPYSRC,FT0300MK06
     C                     MOVEL*BLANKS   S4DST                           CFT002
     C                     SELEC                                          CFT002
     C           ##ACTP    WHEQ 'Retail'                                  CFT002
     C                     MOVELACNO      S4DST1                          CFT002
     C           ##ACTP    WHEQ 'Nostro'                                  CFT002
     C/COPY WNCPYSRC,FT0300C051
     C           TRCYCD    CAT  A7NONB    S4DST1                          CFT002
     C/COPY WNCPYSRC,FT0300C052
     C                     OTHER                                          CFT002
     C                     MOVELGNCSET    S4DST1                          CFT002
     C                     ENDSL                                          CFT002
     C/COPY WNCPYSRC,FT0300MK07
     C                     ENDSL                                          CFT002
      *                                                                   CFT002
      *                                                                   CFT002
      *  Unwind subroutine stack name                                     CFT002
      *                                                                   CFT002
     C           EXCRAC    TAG                                            CFT002
     C                     MOVEA*BLANKS   @STK,Q                          CFT002
     C                     SUB  1         Q                               CFT002
      *                                                                   CFT002
     C                     ENDSR                                          CFT002
      /EJECT                                                              CFT002
      *================================================================   CFT002
      *  Translate to retail and nostro code                              CFT002
      *================================================================   CFT002
      *                                                                   CFT002
     C           SRTRAN    BEGSR                                          CFT002
      *                                                                   CFT002
      *  Set up subroutine stack name                                     CFT002
      *                                                                   CFT002
     C                     ADD  1         Q                               CFT002
     C                     MOVEL'SRTRAN'  @STK,Q                          CFT002
      *                                                                   CFT002
      *  /Copy point for Midas Account Translation                        CFT002
      *                                                                   CFT002
     C*COPY WNCPYSRC,FT0300TRAN                                           CFT002
      *                                                                   CFT002
      * Clear Retail number and nostro code                               CFT002
      *                                                                   CFT002
     C           *LIKE     DEFN ACNO      ##ACNO                          CFT002
     C                     Z-ADD0         ##ACNO                          CFT002
     C           *LIKE     DEFN A7CYCD    ##NCCY                          CFT002
     C                     MOVEL*BLANKS   ##NCCY                          CFT002
     C           *LIKE     DEFN A7NONB    ##NONB                          CFT002
     C                     MOVEL*BLANKS   ##NONB                          CFT002
      *                                                                   CFT002
      * If TRCODE has no currency exit                                    CFT002
      *                                                                   CFT002
     C                     MOVE TRCODE    TRCDE2                          CFT002
     C           TRCYCD    CABEQ*BLANKS   EXTRAN                          CFT002
      *                                                                   CFT002
      * Find Account details                                              CFT002
      *                                                                   CFT002
     C                     MOVE TRCNUM    TRCNM2                          CFT002
     C                     MOVE TRACOD    TRACD2                          CFT002
     C                     MOVE TRACSQ    TRASQ2                          CFT002
      *                                                                   CFT002
     C           KYRTAC    CHAINACCNT                89                   CFT002
     C           *IN89     IFEQ '0'                                       CFT002
     C           RECI      ANDEQ'D'                                       CFT002
     C           ATYP      ANDEQ'R'                                       CFT002
     C                     Z-ADDACNO      ##ACNO                          CFT002
     C                     END                                            CFT002
      *                                                                   CFT002
      * Find Nostro details                                               CFT002
      *                                                                   CFT002
     C                     CALL 'AONOSTR0'                                CFT002
     C                     PARM *BLANKS   @RTCD   7                       CFT002
     C                     PARM '*KEY   ' @OPTN   7                       CFT002
     C                     PARM TRCNUM    @CUST   6                       CFT002
     C                     PARM TRCYCD    @CYCD   3                       CFT002
     C**********           PARM TRACOD    @ACCD   4                                    CFT002 CGL029
     C                     PARM TRACOD    @ACCD  10                                           CGL029
     C                     PARM TRACSQ    @ACSN   2                       CFT002
     C                     PARM *BLANKS   @NONB   2                       CFT002
     C                     PARM TRBRCD    @BRCD   3                       CFT002
     C                     PARM *BLANKS   @CSSN  10                       CFT002
     C                     PARM *BLANKS   @PNOI   1                       CFT002
     C           SDNOST    PARM *BLANKS   DSFDY                           CFT002
      *                                                                   CFT002
     C           @RTCD     IFEQ *BLANKS                                   CFT002
     C                     MOVELA7CYCD    ##NCCY                          CFT002
     C                     MOVELA7NONB    ##NONB                          CFT002
     C                     END                                            CFT002
      *                                                                   CFT002
      *  Unwind subroutine stack name                                     CFT002
      *                                                                   CFT002
     C           EXTRAN    TAG                                            CFT002
     C                     MOVEA*BLANKS   @STK,Q                          CFT002
     C                     SUB  1         Q                               CFT002
      *                                                                   CFT002
     C                     ENDSR                                          CFT002
      *                                                                   CFT002
      *================================================================   CFT002
      /EJECT                                                              CFT002
      *================================================================   CFT002
      *  Get Prime Account for currency                                   CFT002
      *================================================================   CFT002
      *                                                                   CFT002
     C           SRPRME    BEGSR                                          CFT002
      *                                                                   CFT002
      *  Set up subroutine stack name                                     CFT002
      *                                                                   CFT002
     C                     ADD  1         Q                               CFT002
     C                     MOVEL'SRPRME'  @STK,Q                          CFT002
      *                                                                   CFT002
      *  /Copy point for Prime Nostro Processing                          CFT002
      *                                                                   CFT002
     C*COPY WNCPYSRC,FT0300PRME                                           CFT002
      *                                                                   CFT002
      *  Get Currency details                                             CFT002
      *                                                                   CFT002
     C                     CALL 'AOCURRR0'                                CFT002
     C                     PARM           @RTCD                           CFT002
     C                     PARM '*KEY   ' @OPTN                           CFT002
     C                     PARM S1SMCY    @CCY    3                       CFT002
     C           SDCURR    PARM *BLANKS   DSSDY                           CFT002
      *                                                                   CFT002
      * Find Nostro details if currency found                             CFT002
      *                                                                   CFT002
     C           @RTCD     IFEQ *BLANKS                                   CFT002
     C                     CALL 'AONOSTR0'                                CFT002
     C                     PARM *BLANKS   @RTCD                           CFT002
     C                     PARM '*KEY   ' @OPTN                           CFT002
     C                     PARM *BLANKS   @CUST                           CFT002
     C                     PARM S1SMCY    @CYCD                           CFT002
     C                     PARM *BLANKS   @ACCD                           CFT002
     C                     PARM *BLANKS   @ACSN                           CFT002
     C                     PARM *BLANKS   @NONB                           CFT002
     C                     PARM *BLANKS   @BRCD                           CFT002
     C                     PARM A6NOSN    @CSSN                           CFT002
     C                     PARM 'P'       @PNOI                           CFT002
     C           SDNOST    PARM *BLANKS   DSFDY                           CFT002
      *                                                                   CFT002
     C           @RTCD     IFEQ *BLANKS                                   CFT002
     C                     MOVELA7CUST    TRCNUM                          CFT002
     C                     MOVELA7CYCD    TRCYCD                          CFT002
     C                     MOVELA7ACCD    TRACOD                          CFT002
     C                     MOVELA7ACSN    TRACSQ                          CFT002
     C                     MOVELA7BRCD    TRBRCD                          CFT002
     C                     ENDIF                                          CFT002
     C                     ENDIF                                          CFT002
      *                                                                   CFT002
      *  Unwind subroutine stack name                                     CFT002
      *                                                                   CFT002
     C           EXPRME    TAG                                            CFT002
     C                     MOVEA*BLANKS   @STK,Q                          CFT002
     C                     SUB  1         Q                               CFT002
      *                                                                   CFT002
     C                     ENDSR                                          CFT002
      *                                                                   CFT002
      *================================================================   CFT002
      /EJECT                                                              CFT002
      *================================================================   CFT002
      *  Clear ISO format tags                                            CFT002
      *================================================================   CFT002
      *                                                                   CFT002
     C           SRCTAG    BEGSR                                          CFT002
      *                                                                   CFT002
      *  Set up subroutine stack name                                     CFT002
      *                                                                   CFT002
     C                     ADD  1         Q                               CFT002
     C                     MOVEL'SRCTAG'  @STK,Q                          CFT002
      *                                                                   163446
      ** Are involved only messages routed by STP                         163446
     C           PRTN      IFNE 'MIN0096'                                 163446
     C                     GOTO EXCTAG                                    163446
     C                     ENDIF                                          163446
     C           W0ACT     IFNE '*INC FT'                                 163446
     C           W0ACT     ANDNE'*OUT FT'                                 163446
     C           W0ACT     ANDNE'*RFT IN '                                CFT006
     C           W0ACT     ANDNE'*CCT IN '                                CFT006
     C                     GOTO EXCTAG                                    163446
     C                     ENDIF                                          163446
      *                                                                   CFT002
      *  /Copy point for Clear ISO format Tags                            CFT002
      *                                                                   CFT002
     C*COPY WNCPYSRC,FT0300CTAG                                           CFT002
     C/COPY WNCPYSRC,FT0300C055
      *                                                                   CFT002
      * Clear fields depending on flags                                   CFT002
      *                                                                   CFT002
      * Sender                                                            CFT002
     C           GNCSND    IFEQ 'Y'                                       CFT002
     C                     MOVEL*BLANKS   S1SND                           CFT002
     C                     MOVEL*BLANKS   PSN                             CFT002
     C                     ENDIF                                          CFT002
      * Ordering Customer                                                 CFT002
     C           GNC50     IFEQ 'Y'                                       CFT002
     C                     MOVEL*BLANKS   S2ORC                           CFT002
     C                     MOVEL*BLANKS   S4ORC                           CFT002
     C                     MOVEL*BLANKS   P50                             CFT002
     C                     ENDIF                                          CFT002
      * Ordering Institution                                              CFT002
     C           GNC52     IFEQ 'Y'                                       CFT002
     C                     MOVEL*BLANKS   S2ORBK                          CFT002
     C                     MOVEL*BLANKS   S4ORBK                          CFT002
     C                     MOVEL*BLANKS   S4ORBB                          CFT002
     C                     MOVEL*BLANKS   P52                             CFT002
     C                     ENDIF                                          CFT002
      * Sender's Correspondent                                            CFT002
     C           GNC53     IFEQ 'Y'                                       CFT002
     C                     MOVEL*BLANKS   S2SNC                           CFT002
     C                     MOVEL*BLANKS   S4SNCO                          CFT002
     C                     MOVEL*BLANKS   P53                             CFT002
     C                     ENDIF                                          CFT002
      * Receiver's Correspondent                                          CFT002
     C           GNC54     IFEQ 'Y'                                       CFT002
     C                     MOVEL*BLANKS   S1RCCO                          CFT002
     C                     MOVEL*BLANKS   S5RCO                           CFT002
     C                     MOVEL*BLANKS   P54                             CFT002
     C                     ENDIF                                          CFT002
      * Intermediary Institution                                          CFT002
     C           GNC56     IFEQ 'Y'                                       CFT002
     C                     MOVEL*BLANKS   S3IBK                           CFT002
     C*********************MOVEL*BLANKS   S6IBK                     CFT002CFT014
     C                     MOVEL*BLANKS   S5IBK                           CFT014
     C                     MOVEL*BLANKS   P56                             CFT002
     C                     ENDIF                                          CFT002
      * Account with Institution                                          CFT002
     C           GNC57     IFEQ 'Y'                                       CFT002
     C                     MOVEL*BLANKS   S1ACBK                          CFT002
     C                     MOVEL*BLANKS   S1ACBB                          CFT002
     C                     MOVEL*BLANKS   S5ACB                           CFT002
     C                     MOVEL*BLANKS   P57                             CFT002
     C                     ENDIF                                          CFT002
      * Beneficiary Institution                                           CFT002
     C           GNC58     IFEQ 'Y'                                       CFT002
     C                     MOVEL*BLANKS   S1BNC                           CFT002
     C                     MOVEL*BLANKS   S5BNC                           CFT002
     C                     MOVEL*BLANKS   P58                             CFT002
     C                     MOVEL*BLANKS   P59                             CFT002
     C                     ENDIF                                          CFT002
      * Details of Payment                                                CFT002
     C           GNC70     IFEQ 'Y'                                       CFT002
     C                     MOVEL*BLANKS   S3PAY                           CFT002
     C*********************MOVEL*BLANKS   S5PAY                     CFT002CFT014
     C                     MOVEL*BLANKS   S6PAY                           CFT014
     C                     MOVEL*BLANKS   P70                             CFT002
     C                     ENDIF                                          CFT002
      * Sender to Receiver Information                                    CFT002
     C           GNC72     IFEQ 'Y'                                       CFT002
     C                     MOVEL*BLANKS   S2BTB                           CFT002
     C*********************MOVEL*BLANKS   S5BTB                     CFT002CFT014
     C                     MOVEL*BLANKS   S6BTB                           CFT014
     C                     MOVEL*BLANKS   P72                             CFT002
     C                     ENDIF                                          CFT002
      *                                                                   CFT002
      *  Unwind subroutine stack name                                     CFT002
      *                                                                   CFT002
     C           EXCTAG    TAG                                            CFT002
     C                     MOVEA*BLANKS   @STK,Q                          CFT002
     C                     SUB  1         Q                               CFT002
      *                                                                   CFT002
     C                     ENDSR                                          CFT002
      /EJECT                                                              CFT002
      *================================================================   CFT002
      *  Repair functions                                                 CFT002
      *================================================================   CFT002
      *                                                                   CFT002
     C           SRREPR    BEGSR                                          CFT002
      *                                                                   CFT002
      *  Set up subroutine stack name                                     CFT002
      *                                                                   CFT002
     C                     ADD  1         Q                               CFT002
     C                     MOVEL'SRREPR'  @STK,Q                          CFT002
      *                                                                   CFT002
      ** Are involved only messages routed towards incoming and           CFT002
      ** outgoing payments                                                CFT002
      ** by STP                                                           163446
     C           PRTN      IFNE 'MIN0096'                                 163446
     C                     GOTO EXREPR                                    163446
     C                     ENDIF                                          163446
     C           W0ACT     IFNE '*INC FT'                                 CFT002
     C           W0ACT     ANDNE'*OUT FT'                                 CFT002
     C           W0ACT     ANDNE'*RFT IN '                                CFT006
     C           W0ACT     ANDNE'*CCT IN '                                CFT006
     C                     GOTO EXREPR                                    CFT002
     C                     ENDIF                                          CFT002
      *                                                                   CFT002
     C***********KYRPL0    KLIST                                    CFT002CFT006
     C*********************KFLD           GNMTPY                    CFT002CFT006
     C*********************KFLD           GNMSET                    CFT002CFT006
      ***************8                                              CFT002CFT006
     C***********KYRPL0    SETLLMEURPRL0                 90         CFT002CFT006
     C************IN90     IFNE '1'                                 CFT002CFT006
     C*********************GOTO EXREPR                              CFT002CFT006
     C*********************ENDIF                                    CFT002CFT006
     C***********KYRPL0    READEMEURPRL0                 90         CFT002CFT006
     C************IN90     DOWEQ'0'                                 CFT002CFT006
     C/COPY WNCPYSRC,FT0300C073
     C                     CALL 'ME1503'                                  CFT002
     C                     PARM           GNMTPY           Message type   CFT006
     C                     PARM GNMSET    P@MSET  30       Message sequencCFT006
     C                     PARM           PHEAD            General DetailsCFT002
     C                     PARM           PDATA            Message DetailsCFT002
     C                     PARM           PDAT2                                               CSW209
     C*********************PARM           RPRTAG           Repair TaCFT002CFT006
     C*********************PARM           RPITAG           Input  TaCFT002CFT006
     C*********************PARM           RPKVAL           Repair fuCFT002CFT006
     C*********************PARM           PTAGPR  5        ParameterCFT002CFT006
     C*********************PARM           PRFDDT           Repair T CFT002CFT006
     C                     PARM           W0RTN   7        Return Code    CFT002
     C/COPY WNCPYSRC,FT0300C036
      *                                                                   CFT002
     C***********W0RTN     IFEQ '*MAP'                              CFT002CFT006
     C*********************EXSR SRMAPR                              CFT002CFT006
     C*********************ENDIF                                    CFT002CFT006
      ***************                                               CFT002CFT006
     C***********KYRPL0    READEMEURPRL0                 90         CFT002CFT006
     C*********************ENDDO                                    CFT002CFT006
      *                                                                   CFT002
      *  Unwind subroutine stack name                                     CFT002
      *                                                                   CFT002
     C           EXREPR    TAG                                            CFT002
     C                     MOVEA*BLANKS   @STK,Q                          CFT002
     C                     SUB  1         Q                               CFT002
      *                                                                   CFT002
     C                     ENDSR                                          CFT002
      /EJECT                                                              CFT002
      **************================================================CFT002CFT006
      ***Map*the*Repair*Tag*********************************        CFT002CFT006
      **************================================================CFT002CFT006
      ****                                                          CFT002CFT006
     C***********SRMAPR    BEGSR                                    CFT002CFT006
      ***                                                           CFT002CFT006
      ***Set*up*subroutine*stack name                               CFT002CFT006
      *************                                                 CFT002CFT006
     C*********************ADD  1         Q                         CFT002CFT006
     C*********************MOVEL'SRMAPR'  @STK,Q                    CFT002CFT006
      *                                                                   CGL009
      ***Part*of*the*code*has*been*commented*out*because*since*we** CGL009CFT006
      ***have*moved*the*mapping*from*SRMSGD*to*SRMAP*(SRMAP*will*be CGL009CFT006
      ***called*after)*we*no*longer*need*to*perform*an*other*Mappin CGL009CFT006
      ***similar*to*SRMAP.*We*just*need*to*override*the*existing*fi CGL009CFT006
      ***of*PDATA*(which*are*going*to*be*used*later*in*SRMAP).      CGL009CFT006
      **                                                            CFT002CFT006
      **Sender*                                                     CFT002CFT006
      **                                                            CFT002CFT006
     C***********PTAGPR    IFEQ 'PSN'                               CFT002CFT006
     C*********************MOVELPRFDDT    PSN                       CFT002CFT006
     C*********************GOTO EXMAPR                              CGL009CFT006
     C*********************ENDIF                                    CGL009CFT006
     C*********************MOVELPSN       DSTRAN                    CFT002CGL009
     C***********PSNDR     IFEQ 'CASHIER'                           CFT002CGL009
     C*********************MOVELPSNAR,1   TMLIN2                    CFT002CGL009
     C*********************END                                      CFT002CGL009
     C*********************MOVELTMLIN     S1SND                     CFT002CGL009
     C*********************END                                      CFT002CGL009
      ************                                                  CFT002CFT006
      **Transaction*Reference*no.                                   CFT002CFT006
      *************                                                 CFT002CFT006
     C***********PTAGPR    IFEQ 'P20'                               CFT002CFT006
     C*********************MOVELPRFDDT    P20                       CFT002CFT006
     C*********************GOTO EXMAPR                              CGL009CFT006
     C*********************ENDIF                                    CGL009CFT006
     C***********WRTGVL    IFNE *BLANK                              CFT002CGL009
     C*********************MOVELP20       DSTRAN                    CFT002CGL009
      *                                                             CFT002CGL009
     C***********PNWRK     IFEQ 'CASHV8'                            CFT002CGL009
      *                                                             CFT002CGL009
     C*********************MOVELTTREF     KDRNO                     CFT002CGL009
     C*********************MOVEL*BLANKS   KODRN                     CFT002CGL009
     C*********************MOVELPMTPY     KACDE                     CFT002CGL009
     C***********KLPDRI    CHAINREPDRIL1             11             CFT002CGL009
      *                                                             CFT002CGL009
     C************IN11     IFEQ '1'                                 CFT002CGL009
     C*********************Z-ADD45        W0ERNB                    CFT002CGL009
     C*********************MOVEL'REPDRIL1'W0FILE                    CFT002CGL009
     C*********************MOVELKDRNO     W0KEY                     CFT002CGL009
     C*********************MOVEL'MEM5002' W0MSGD                    CFT002CGL009
     C*********************MOVEL'MIDAS  ' W0MSGF                    CFT002CGL009
     C*********************EXSR SRERRA                              CFT002CGL009
     C*********************ELSE                                     CFT002CGL009
     C*********************MOVELTTREF     INTRNO                    CFT002CGL009
     C*********************ENDIF                                    CFT002CGL009
      *                                                             CFT002CGL009
     C*********************ELSE                                     CFT002CGL009
     C*********************MOVELTTREF     INTRNO                    CFT002CGL009
     C*********************ENDIF                                    CFT002CGL009
      *                                                             CFT002CGL009
     C*********************ELSE                                     CFT002CGL009
     C*********************MOVEL*BLANKS   INTRNO                    CFT002CGL009
     C*********************END                                      CFT002CGL009
     C*********************END                                      CFT002CGL009
      **********                                                    CFT002CFT006
      **Related*Reference                                           CFT002CFT006
      ***********                                                   CFT002CFT006
     C***********PTAGPR    IFEQ 'P21'                               CFT002CFT006
     C*********************MOVELPRFDDT    P21                       CFT002CFT006
     C*********************GOTO EXMAPR                              CGL009CFT006
     C*********************ENDIF                                    CGL009CFT006
     C***********WRTGVL    IFNE *BLANK                              CFT002CGL009
     C*********************MOVELP21       DSTRAN                    CFT002CGL009
     C*********************MOVELTTREF     S3RLRF                    CFT002CGL009
     C*********************ELSE                                     CFT002CGL009
     C*********************MOVEL*BLANKS   S3RLRF                    CFT002CGL009
     C*********************END                                      CFT002CGL009
     C*********************END                                      CFT002CGL009
      *******                                                       CFT002CFT006
      **Value Date/Ccy/Amount                                       CFT002CFT006
      *******                                                       CFT002CFT006
     C***********PTAGPR    IFEQ 'PDCA'                              CFT002CFT006
     C*********************MOVELPRFDDT    PDCA                      CFT002CFT006
     C*********************GOTO EXMAPR                              CGL009CFT006
     C*********************ENDIF                                    CGL009CFT006
     C*********************MOVELPDCA      DSTRAN                    CFT002CGL009
      *                                                             CFT002CGL009
      **MMDDYY*format*display                                       CFT002CGL009
      *                                                             CFT002CGL009
     C***********WUDFF     IFEQ 'M'                                 CFT002CGL009
     C*********************MOVELTVVDAT    SWDT1   6                 CFT002CGL009
     C***********2         SUBSTSWDT1:5   MM                        CFT002CGL009
     C***********2         SUBSTSWDT1:3   DD                        CFT002CGL009
     C***********2         SUBSTSWDT1:1   YY                        CFT002CGL009
     C*********************MOVELSWDT2     S1SLDT                    CFT002CGL009
     C*********************MOVELSWDT2     S4SLDT                    CFT002CGL009
     C*********************ELSE                                     CFT002CGL009
      *                                                             CFT002CGL009
      **DDMMYY*format*display                                       CFT002CGL009
      *                                                             CFT002CGL009
     C*********************MOVELTVVDAT    SWDT1   6                 CFT002CGL009
     C***********2         SUBSTSWDT1:5   DD                        CFT002CGL009
     C***********2         SUBSTSWDT1:3   MM                        CFT002CGL009
     C***********2         SUBSTSWDT1:1   YY                        CFT002CGL009
     C*********************MOVELSWDT2     S1SLDT                    CFT002CGL009
     C*********************MOVELSWDT2     S4SLDT                    CFT002CGL009
     C*********************END                                      CFT002CGL009
      *                                                             CFT002CGL009
      **Currency****                                                CFT002CGL009
      *                                                             CFT002CGL009
     C*********************MOVELTVCCY     S1SMCY                    CFT002CGL009
     C*********************MOVELTVCCY     S4SMCY                    CFT002CGL009
      **Amount******                                                CFT002CGL009
      *                                                             CFT002CGL009
      **Format*amount*field*(change ',' decimal point to '.').      CFT002CGL009
      *                                                             CFT002CGL009
     C*********************MOVEATVAMT     YA1                       CFT002CGL009
     C*********************Z-ADD1         C       30                CFT002CGL009
      *                                                             CFT002CGL009
     C***********C         DOUGT15                                  CFT002CGL009
      *                                                             CFT002CGL009
     C***********YA1,C     IFEQ ','                                 CFT002CGL009
     C*********************MOVE '.'       YA1,C                     CFT002CGL009
     C*********************Z-ADD16        C                         CFT002CGL009
     C*********************ELSE                                     CFT002CGL009
     C*********************ADD  1         C                         CFT002CGL009
     C*********************END                                      CFT002CGL009
      *                                                             CFT002CGL009
     C*********************END                                      CFT002CGL009
      *                                                             CFT002CGL009
     C*********************MOVEAYA1       AMT    15                 CFT002CGL009
     C*********************MOVELAMT       S1SMAM                    CFT002CGL009
     C*********************MOVELAMT       S4SMAM                    CFT002CGL009
      *                                                             130869CGL009
      ****Rate                                                      130869CGL009
      *                                                             130869CGL009
     C***********S1PYAM    IFNE *BLANKS                             130869CGL009
     C***********S1SMAM    ANDNE*BLANKS                             130869CGL009
      *                                                             130869CGL009
      ***Get*the*numeric*value*of*S1PYAM                            130869CGL009
      *                                                             CFT002CGL009
     C*********************CALL 'AOCURRR0'                          CFT002CGL009
     C*********************PARM *BLANKS   @RTCD   7                 CFT002CGL009
     C*********************PARM '*KEY   ' @OPTN   7                 CFT002CGL009
     C*********************PARM S1PCCY    @CURR   3                 CFT002CGL009
     C***********SDCURR    PARM SDCURR    DSSDY                     CFT002CGL009
      *                                                             CFT002CGL009
     C***********@RTCD     IFNE *BLANKS                             CFT002CGL009
     C*********************MOVEL'AOCURRR0'W0FILE                    CFT002CGL009
     C*********************MOVEL'*CALL'   W0KEY      ***************CFT002CGL009
     C*********************Z-ADD36        W0ERNB     * DB ERROR 36 *CFT002CGL009
     C*********************MOVEL'MEM5003' W0MSGD     ***************CFT002CGL009
     C*********************MOVEL'MIDAS  ' W0MSGF                    CFT002CGL009
     C*********************EXSR SRERRA                              CFT002CGL009
     C*********************END                                      CFT002CGL009
     C*********************Z-ADDA6NBDP    WPNDP   10                CFT002CGL009
     C*********************MOVELA6MDIN    WPMDI   1                 CFT002CGL009
      *                                                             CFT002CGL009
      ****Align*amount                                              CFT002CGL009
     C*********************Z-ADDWPNDP     ZADEC                     CFT002CGL009
     C***********11        SUB  WPNDP     ZADIG                     CFT002CGL009
     C*********************MOVEL*BLANK    ZFIELD                    CFT002CGL009
     C*********************MOVE S1PYAM    ZFIELD                    CFT002CGL009
     C*********************EXSR ZALIGN                              CFT002CGL009
     C*********************MOVE ZFIELD    WPYAM1 110                CFT002CGL009
      *                                                             CFT002CGL009
      ***Get*the*numeric*value*of*S1SMAM                            CFT002CGL009
      *                                                             CFT002CGL009
     C*********************CALL 'AOCURRR0'                          CFT002CGL009
     C*********************PARM *BLANKS   @RTCD   7                 CFT002CGL009
     C*********************PARM '*KEY   ' @OPTN   7                 CFT002CGL009
     C*********************PARM S1SMCY    @CURR   3                 CFT002CGL009
     C***********SDCURR    PARM SDCURR    DSSDY                     CFT002CGL009
      *                                                             CFT002CGL009
     C***********@RTCD     IFNE *BLANKS                             CFT002CGL009
     C*********************MOVEL'AOCURRR0'W0FILE                    CFT002CGL009
     C*********************MOVEL'*CALL'   W0KEY      ***************CFT002CGL009
     C*********************Z-ADD37        W0ERNB     * DB ERROR 37 *CFT002CGL009
     C*********************MOVEL'MEM5003' W0MSGD     ***************CFT002CGL009
     C*********************MOVEL'MIDAS  ' W0MSGF                    CFT002CGL009
     C*********************EXSR SRERRA                              CFT002CGL009
     C*********************END                                      CFT002CGL009
     C*********************Z-ADDA6NBDP    WSNDP   10                CFT002CGL009
     C*********************MOVELA6MDIN    WSMDI   1                 CFT002CGL009
      *                                                             CFT002CGL009
      ****Align*amount*****                                         CFT002CGL009
     C*********************Z-ADDWSNDP     ZADEC                     CFT002CGL009
     C***********11        SUB  WSNDP     ZADIG                     CFT002CGL009
     C*********************MOVEL*BLANK    ZFIELD                    CFT002CGL009
     C*********************MOVE S1SMAM    ZFIELD                    CFT002CGL009
     C*********************EXSR ZALIGN                              CFT002CGL009
     C*********************MOVE ZFIELD    WSMAM1 110                CFT002CGL009
      *                                                             CFT002CGL009
     C***********WPYAM1    IFNE 0                                   CFT002CGL009
     C***********WSMAM1    ANDNE0                                   CFT002CGL009
      *                                                             CFT002CGL009
      ***Calculate*the*rate                                         CFT002CGL009
      *                                                             CFT002CGL009
     C***********S1SMCY     FNE S1PCCY                              CFT002CGL009
      *                                                             CFT002CGL009
     C*********************Z-ADD1         @Z      10                CFT002CGL009
     C*********************Z-ADD0         @EXRT  138                CFT002CGL009
     C*********************MOVELWPMDI     ZMDI1   1                 CFT002CGL009
     C*********************MOVELS1PCCY    @CCY                      CFT002CGL009
     C*********************EXSR RTCCYS                              CFT002CGL009
      *                                                             CFT002CGL009
     C***********S1PCCY    LOKUPTCY,@Z                   48         CFT002CGL009
      *                                                             CFT002CGL009
     C************IN48     IFEQ '1'                                 CFT002CGL009
     C*********************EXSR LDXRAR                              CFT002CGL009
      *                                                             CFT002CGL009
     C***********PMTPY     IFEQ 'DIC'                               CFT002CGL009
     C*********************Z-ADDBCR,@Z    ZRATE1 138                CFT002CGL009
     C*********************ELSE                                     CFT002CGL009
     C*********************Z-ADDBTR,@Z    ZRATE1                    CFT002CGL009
     C*********************ENDIF                                    CFT002CGL009
      *                                                             CFT002CGL009
     C*********************ELSE                                     CFT002CGL009
     C*********************Z-ADDTRT,@I    ZRATE1                    CFT002CGL009
     C*********************ENDIF                                    CFT002CGL009
      *                                                             CFT002CGL009
     C*********************Z-ADD1         @Z      10                CFT002CGL009
     C*********************MOVELWSMDI     ZMDI2   1                 CFT002CGL009
     C*********************MOVELS1SMCY    @CCY                      CFT002CGL009
     C*********************EXSR RTCCYS                              CFT002CGL009
      *                                                             CFT002CGL009
     C***********S1SMCY    LOKUPTCY,@Z                   48         CFT002CGL009
      *                                                             CFT002CGL009
     C************IN48     IFEQ '1'                                 CFT002CGL009
     C*********************EXSR LDXRAR                              CFT002CGL009
      *                                                             CFT002CGL009
     C***********PMTPY     IFEQ 'DIC'                               CFT002CGL009
     C*********************Z-ADDSCR,@Z    ZRATE2 138                CFT002CGL009
     C*********************ELSE                                     CFT002CGL009
     C*********************Z-ADDSTR,@Z    ZRATE2                    CFT002CGL009
     C*********************ENDIF                                    CFT002CGL009
      *                                                             CFT002CGL009
     C*********************ELSE                                     CFT002CGL009
     C*********************Z-ADDTRT,@I    ZRATE2                    CFT002CGL009
     C*********************ENDIF                                    CFT002CGL009
      *                                                             CFT002CGL009
     C*********************EXSR ZXRATE                              CFT002CGL009
      *                                                             CFT002CGL009
     C*********************Z-ADDZRATEX    @EXRT                     CFT002CGL009
      *                                                             CFT002CGL009
     C*********************ELSE                                     CFT002CGL009
     C*********************Z-ADD1         @EXRT                     CFT002CGL009
     C*********************ENDIF                                    CFT002CGL009
      *                                                             CFT002CGL009
      ***Format*rate*field                                          CFT002CGL009
      *                                                             CFT002CGL009
     C*********************Z-ADD@EXRT     WRATE1 117                CFT002CGL009
     C*********************MOVE WRATE1    ZFIELD                    CFT002CGL009
     C*********************Z-ADD7         ZADEC                     CFT002CGL009
     C*********************EXSR ZEDIT                               CFT002CGL009
     C*********************MOVE ZFIELD    S1RATE                    CFT002CGL009
     C*********************MOVE ZFIELD    S4RATE                    CFT002CGL009
     C*********************END                                      CFT002CGL009
      *                                                             CFT002CGL009
     C*********************END                                      CFT002CGL009
      *                                                             CFT002CGL009
     C*********************END                                      CFT002CGL009
      ****                                                          CFT002CFT006
      **Ordering*Customer                                           CFT002CFT006
      ******                                                        CFT002CFT006
     C***********PTAGPR    IFEQ 'P50'                               CFT002CFT006
     C*********************MOVELPRFDDT    P50                       CFT002CFT006
     C*********************GOTO EXMAPR                              CGL009CFT006
     C*********************ENDIF                                    CGL009CFT006
     C***********WRTGVL    IFNE *BLANK                              CFT002CGL009
     C*********************MOVELP50       DSTRAN                    CFT002CGL009
     C*********************MOVELTMLIN     S2ORC                     CFT002CGL009
     C*********************MOVELTMLIN     S4ORC                     CFT002CGL009
     C*********************ELSE                                     CFT002CGL009
     C*********************MOVEL*BLANKS   ORCT                      CFT002CGL009
     C*********************MOVEL*BLANKS   S2ORC                     CFT002CGL009
     C*********************MOVEL*BLANKS   S4ORC                     CFT002CGL009
     C*********************END                                      CFT002CGL009
     C*********************END                                      CFT002CGL009
      *                                                             CFT002CFT006
      **Ordering*Institution*************************************** CFT002CFT006
      ************************************************************* CFT002CFT006
     C***********PTAGPR    IFEQ 'P52'                               CFT002CFT006
     C*********************MOVELPRFDDT    P52                       CFT002CFT006
     C*********************GOTO EXMAPR                              CGL009CFT006
     C*********************ENDIF                                    CGL009CFT006
     C***********WRTGVL    IFNE *BLANK                              CFT002CGL009
     C*********************MOVELP52       DSTRAN                    CFT002CGL009
     C*********************MOVELTMLIN     S2ORBK                    CFT002CGL009
     C*********************ELSE                                     CFT002CGL009
     C*********************MOVEL*BLANKS   ORBT                      CFT002CGL009
     C*********************MOVEL*BLANKS   S2ORBK                    CFT002CGL009
     C*********************END                                      CFT002CGL009
     C*********************END                                      CFT002CGL009
      ************************************************************* CFT002CFT006
      **Senders*Correspondent************************************** CFT002CFT006
      ************************************************************* CFT002CFT006
     C***********PTAGPR    IFEQ 'P53'                               CFT002CFT006
     C*********************MOVELPRFDDT    P53                       CFT002CFT006
     C*********************GOTO EXMAPR                              CGL009CFT006
     C*********************ENDIF                                    CGL009CFT006
     C***********WRTGVL    IFNE *BLANK                              CFT002CGL009
     C*********************MOVELP53       DSTRAN                    CFT002CGL009
     C*********************MOVELTMLIN     S2SNC                     CFT002CGL009
     C*********************ELSE                                     CFT002CGL009
     C*********************MOVEL*BLANKS   SNCT                      CFT002CGL009
     C*********************MOVEL*BLANKS   S2SNC                     CFT002CGL009
     C*********************END                                      CFT002CGL009
     C*********************END                                      CFT002CGL009
      ***********                                                   CFT002CFT006
      **Receivers*Correspondent                                     CFT002CFT006
      ***********                                                   CFT002CFT006
     C***********PTAGPR    IFEQ 'P54'                               CFT002CFT006
     C*********************MOVELPRFDDT    P54                       CFT002CFT006
     C*********************GOTO EXMAPR                              CGL009CFT006
     C*********************ENDIF                                    CGL009CFT006
     C***********WRTGVL    IFNE *BLANK                              CFT002CGL009
     C*********************MOVELP54       DSTRAN                    CFT002CGL009
     C*********************MOVELTMLIN1    INRCO1                    CFT002CGL009
     C*********************MOVELTMLIN2    INRCO2                    CFT002CGL009
     C*********************MOVELTMLIN3    INRCO3                    CFT002CGL009
     C*********************MOVELTMLIN4    INRCO4                    CFT002CGL009
     C*********************MOVELTMLIN5    INRCO5                    CFT002CGL009
      *                                                             CFT002CGL009
      **If*network*is swift,*find*field*type*                       CFT002CGL009
      **otherwise*default it*to*'U'.*********                       CFT002CGL009
      *                                                             CFT002CGL009
     C***********PNWRK     IFEQ 'SWIFT '                            CFT002CGL009
      *                                                             CFT002CGL009
      **Set*up*field*type,*if*A->S,*B->T,*D->U***                   CFT002CGL009
      *                                                             CFT002CGL009
     C***********1         SUBSTTRTAG:4   #WK1    1                 CFT002CGL009
     C***********#WK1      IFEQ 'A'                                 CFT002CGL009
     C*********************MOVEL'S'       INRCRT                    CFT002CGL009
     C*********************ELSE                                     CFT002CGL009
      *                                                             CFT002CGL009
     C***********#WK1      IFEQ 'B'                                 CFT002CGL009
     C*********************MOVEL'T'       INRCRT                    CFT002CGL009
     C*********************ELSE                                     CFT002CGL009
     C*********************MOVEL'U'       INRCRT                    CFT002CGL009
     C*********************END                                      CFT002CGL009
     C*********************END                                      CFT002CGL009
      *                                                             CFT002CGL009
     C*********************ELSE                                     CFT002CGL009
      *                                                             CFT002CGL009
      **network*is*not*swift**                                      CFT002CGL009
     C*********************MOVEL'U'       INRCRT                    CFT002CGL009
     C*********************END                                      CFT002CGL009
      *                                                             CFT002CGL009
     C*********************ELSE                                     CFT002CGL009
     C*********************MOVEL*BLANKS   INRCRT                    CFT002CGL009
     C*********************MOVEL*BLANKS   INRCO1                    CFT002CGL009
     C*********************MOVEL*BLANKS   INRCO2                    CFT002CGL009
     C*********************MOVEL*BLANKS   INRCO3                    CFT002CGL009
     C*********************MOVEL*BLANKS   INRCO4                    CFT002CGL009
     C*********************MOVEL*BLANKS   INRCO5                    CFT002CGL009
     C*********************END                                      CFT002CGL009
     C*********************END                                      CFT002CGL009
      **********                                                    CFT002CFT006
      **Intermediary                                                CFT002CFT006
      *********                                                     CFT002CFT006
     C***********PTAGPR    IFEQ 'P56'                               CFT002CFT006
     C*********************MOVELPRFDDT    P56                       CFT002CFT006
     C*********************GOTO EXMAPR                              CGL009CFT006
     C*********************ENDIF                                    CGL009CFT006
     C***********WRTGVL    IFNE *BLANK                              CFT002CGL009
     C*********************MOVELP56       DSTRAN                    CFT002CGL009
     C*********************MOVELTMLIN     S3IBK                     CFT002CGL009
     C*********************ELSE                                     CFT002CGL009
     C*********************MOVEL*BLANKS   INBT                      CFT002CGL009
     C*********************MOVEL*BLANKS   S3IBK                     CFT002CGL009
     C*********************END                                      CFT002CGL009
     C*********************END                                      CFT002CGL009
      **********                                                    CFT002CFT006
      **Account*with*Institution                                    CFT002CFT006
      ***********                                                   CFT002CFT006
     C***********PTAGPR    IFEQ 'P57'                               CFT002CFT006
     C*********************MOVELPRFDDT    P57                       CFT002CFT006
     C*********************GOTO EXMAPR                              CGL009CFT006
     C*********************ENDIF                                    CGL009CFT006
     C***********WRTGVL    IFNE *BLANK                              CFT002CGL009
     C*********************MOVELP57       DSTRAN                    CFT002CGL009
     C*********************MOVELTMLIN1    INACB1                    CFT002CGL009
     C*********************MOVELTMLIN2    INACB2                    CFT002CGL009
     C*********************MOVELTMLIN3    INACB3                    CFT002CGL009
     C*********************MOVELTMLIN4    INACB4                    CFT002CGL009
     C*********************MOVELTMLIN5    INACB5                    CFT002CGL009
      *                                                             CFT002CGL009
      **If*network*is*swift,*find*field*type**                      CFT002CGL009
      **otherwise*default*it*to*'U'.**********                      CFT002CGL009
      *                                                             CFT002CGL009
     C***********PNWRK     IFEQ 'SWIFT '                            CFT002CGL009
      *                                                             CFT002CGL009
      **Set*up*field*type,*if A->S,*B->T,*D->U*                     CFT002CGL009
      *                                                             CFT002CGL009
     C***********1         SUBSTTRTAG:4   #WK1                      CFT002CGL009
     C***********#WK1      IFEQ 'A'                                 CFT002CGL009
     C*********************MOVEL'S'       INACBT                    CFT002CGL009
     C*********************ELSE                                     CFT002CGL009
      *                                                             CFT002CGL009
     C***********#WK1      IFEQ 'B'                                 CFT002CGL009
     C*********************MOVEL'T'       INACBT                    CFT002CGL009
     C*********************ELSE                                     CFT002CGL009
     C*********************MOVEL'U'       INACBT                    CFT002CGL009
     C*********************END                                      CFT002CGL009
     C*********************END                                      CFT002CGL009
      *                                                             CFT002CGL009
     C*********************ELSE                                     CFT002CGL009
      *                                                             CFT002CGL009
      **network*is*not*swift**                                      CFT002CGL009
     C*********************MOVEL'U'       INACBT                    CFT002CGL009
     C*********************END                                      CFT002CGL009
      *                                                             CFT002CGL009
     C*********************ELSE                                     CFT002CGL009
     C*********************MOVEL*BLANKS   INACBT                    CFT002CGL009
     C*********************MOVEL*BLANKS   INACB1                    CFT002CGL009
     C*********************MOVEL*BLANKS   INACB2                    CFT002CGL009
     C*********************MOVEL*BLANKS   INACB3                    CFT002CGL009
     C*********************MOVEL*BLANKS   INACB4                    CFT002CGL009
     C*********************MOVEL*BLANKS   INACB5                    CFT002CGL009
     C*********************END                                      CFT002CGL009
     C*********************END                                      CFT002CGL009
      *******                                                       CFT002CFT006
      **Beneficiary*Institution/*Beneficiary*Customer**             CFT002CFT006
      *******                                                       CFT002CFT006
     C***********PTAGPR    IFEQ 'P58'                               CFT002CFT006
     C*********************MOVELPRFDDT    P58                       CFT002CFT006
     C*********************GOTO EXMAPR                              CGL009CFT006
     C*********************ENDIF                                    CGL009CFT006
     C*********************MOVELP58       DSTRAN                    CFT002CGL009
     C*********************MOVELTMLIN     S1BNC                     CFT002CGL009
     C*********************MOVELTMLIN     S5BNC                     CFT002CGL009
     C*********************END                                      CFT002CGL009
      *                                                             CFT002CGL009
     C***********PTAGPR    IFEQ 'P59'                               CFT002CFT006
     C*********************MOVELPRFDDT    P59                       CFT002CFT006
     C*********************GOTO EXMAPR                              CGL009CFT006
     C*********************ENDIF                                    CGL009CFT006
     C*********************MOVELP59       DSTRAN                    CFT002CGL009
     C*********************MOVELTMLIN     S1BNC                     CFT002CGL009
     C*********************MOVELTMLIN     S5BNC                     CFT002CGL009
     C*********************END                                      CFT002CGL009
      ***********                                                   CFT002CFT006
      **Details*of*Payment                                          CFT002CFT006
      ***********                                                   CFT002CFT006
     C***********PTAGPR    IFEQ 'P70'                               CFT002CFT006
     C*********************MOVELPRFDDT    P70                       CFT002CFT006
     C*********************GOTO EXMAPR                              CGL009CFT006
     C*********************ENDIF                                    CGL009CFT006
     C***********WRTGVL    IFNE *BLANK                              CFT002CGL009
     C*********************MOVELP70       DSTRAN                    CFT002CGL009
     C*********************MOVELTMLIN     S3PAY                     CFT002CGL009
     C*********************ELSE                                     CFT002CGL009
     C*********************MOVEL*BLANKS   S3PAY                     CFT002CGL009
     C*********************END                                      CFT002CGL009
     C*********************END                                      CFT002CGL009
      *                                                                   CFT002
      **Details*of*Charges                                          CFT002CFT006
      *                                                                   CFT002
     C***********PTAGPR    IFEQ 'P71'                               CFT002CFT006
     C*********************MOVELPRFDDT    P71                       CFT002CFT006
     C*********************GOTO EXMAPR                              CGL009CFT006
     C*********************ENDIF                                    CGL009CFT006
     C***********WRTGVL    IFNE *BLANK                              CFT002CGL009
     C*********************MOVELP71       DSTRAN                    CFT002CGL009
     C*********************MOVELTTREF     S3DETC                    CFT002CGL009
     C*********************MOVELTTREF     S6DETC                    CFT002CGL009
      *                                                             CFT002CGL009
     C***********PNWRK     IFEQ 'CASHV8'                            CFT002CGL009
     C*********************MOVEL*BLANKS   WCHCY   3                 CFT002CGL009
     C*********************MOVELTTREF     WCHCY                     CFT002CGL009
     C*********************MOVEL'OUR'     S3DETC                    CFT002CGL009
     C*********************MOVEL'OUR'     S6DETC                    CFT002CGL009
      *                                                             CFT002CGL009
      **  Format amount field (change ',' decimal point to '.').    CFT002CGL009
      *                                                             CFT002CGL009
     C*********************MOVEL*BLANKS   WRK13  13                 CFT002CGL009
     C*********************MOVE TTREF     WRK13                     CFT002CGL009
     C*********************MOVEA*BLANKS   YA1                       CFT002CGL009
     C*********************MOVEAWRK13     YA1                       CFT002CGL009
     C*********************Z-ADD1         C       30                CFT002CGL009
      *                                                             CFT002CGL009
     C***********C         DOUGT15                                  CFT002CGL009
     C***********YA1,C     IFEQ ','                                 CFT002CGL009
     C*********************MOVE '.'       YA1,C                     CFT002CGL009
     C*********************Z-ADD16        C                         CFT002CGL009
     C*********************ELSE                                     CFT002CGL009
     C*********************ADD  1         C                         CFT002CGL009
     C*********************ENDIF                                    CFT002CGL009
     C*********************ENDDO                                    CFT002CGL009
      *                                                             CFT002CGL009
     C*********************MOVEAYA1       AMT    15                 CFT002CGL009
     C*********************MOVELAMT       S3MSCD                    CFT002CGL009
     C*********************MOVELAMT       S6MSCD                    CFT002CGL009
     C*********************ENDIF                                    CFT002CGL009
      *                                                             CFT002CGL009
     C*********************ELSE                                     CFT002CGL009
     C*********************MOVEL*BLANKS   S3MSCD                    CFT002CGL009
     C*********************MOVEL*BLANKS   S6MSCD                    CFT002CGL009
     C*********************MOVEL*BLANKS   S3DETC                    CFT002CGL009
     C*********************MOVEL*BLANKS   S6DETC                    CFT002CGL009
     C*********************END                                      CFT002CGL009
     C*********************END                                      CFT002CGL009
      ********                                                      CFT002CFT006
      **Bank*to*Bank*Information                                    CFT002CFT006
      *********                                                     CFT002CFT006
     C***********PTAGPR    IFEQ 'P72'                               CFT002CFT006
     C*********************MOVELPRFDDT    P72                       CFT002CFT006
     C*********************GOTO EXMAPR                              CGL009CFT006
     C*********************ENDIF                                    CGL009CFT006
     C/COPY WNCPYSRC,FT0300C053
     C***********WRTGVL    IFNE *BLANK                              CFT002CGL009
      ***->**BLANK*to*S1NDAM*because*the*lenght*of*the*amount*can   CFT002CGL009
      ***change*and*there*is*no*padding.                            CFT002CGL009
     C*********************MOVEL*BLANKS   S1NDAM                    CFT002CGL009
     C*********************MOVELP72       DSTRAN                    CFT002CGL009
     C*********************MOVELTMLIN     S2BTB                     CFT002CGL009
      *                                                             CFT002CGL009
     C***********CEU006    IFEQ 'Y'                                 CFT002CGL009
      *                                                             CFT002CGL009
      ****Retrieve*notified*delivery*currency*and*amount            CFT002CGL009
      *                                                             CFT002CGL009
     C*********************MOVEL'012345'  @CHK   11                 CFT002CGL009
     C*********************MOVE '6789.'   @CHK                      CFT002CGL009
      *                                                             CFT002CGL009
     C***********'/OCMT/'  SCAN TMLIN:1   @F      30     81         CFT002CGL009
      *                                                             CFT002CGL009
     C************IN81     IFEQ *ON                                 CFT002CGL009
      *                                                             CFT002CGL009
      **Map*currency*code*->*S1NDCY*and*S4NDCY                      CFT002CGL009
     C*********************ADD  6         @F                        CFT002CGL009
     C***********3         SUBSTTMLIN:@F  S1NDCY                    CFT002CGL009
     C*********************MOVE S1NDCY    S4NDCY                    CFT002CGL009
      **Map*amount*->*S1NDAM*and*S4NDAM                             CFT002CGL009
      **Move*possible*15*chars*to*work*array*and*work*string        CFT002CGL009
     C*********************ADD  3         @F                        CFT002CGL009
     C***********15        SUBSTTMLIN:@F  @S     15                 CFT002CGL009
     C******************** MOVEA@S        @A                        CFT002CGL009
     C*********************CLEAR@S                                  CFT002CGL009
      *                                                             CFT002CGL009
      **If*','*in*amount*string*@S*change*to*'.'**                  CFT002CGL009
      **Only*need*to*check*valid*chars*till*one*','*found**         CFT002CGL009
     C*********************Z-ADD1         @C      30                CFT002CGL009
     C*********************MOVE *BLANKS   @T      1                 CFT002CGL009
      *                                                             CFT002CGL009
     C***********1         DO   15        @C                        CFT002CGL009
     C*********************MOVE @A,@C     @T                        CFT002CGL009
     C***********@T        IFEQ ','                                 CFT002CGL009
     C*********************MOVE '.'       @A,@C                     CFT002CGL009
     C*********************LEAVE                                    CFT002CGL009
     C*********************ENDIF                                    CFT002CGL009
     C*********************ENDDO                                    CFT002CGL009
      *                                                             CFT002CGL009
     C*********************Z-ADD1         @C                        CFT002CGL009
     C*********************MOVE *BLANKS   @T      1                 CFT002CGL009
     C*********************MOVEA@A        @S                        CFT002CGL009
      **Get*amount*-*upto*15*chars*possible                         CFT002CGL009
     C***********@C        DOUGT15                                  CFT002CGL009
     C*********************MOVE @A,@C     @T                        CFT002CGL009
     C***********@CHK      CHECK@T        @F             82         CFT002CGL009
      *                                                             CFT002CGL009
      **Char*not*valid*must*be*end*of*amount                        CFT002CGL009
     C************IN82     IFEQ *ON                                 CFT002CGL009
     C***********@C        IFNE 1                                   CFT002CGL009
     C***********@C        SUB  1         @F                        CFT002CGL009
     C***********@F        SUBST@S:1      S1NDAM                    CFT002CGL009
     C*********************MOVE S1NDAM    S4NDAM                    CFT002CGL009
     C*********************ENDIF                                    CFT002CGL009
     C*********************LEAVE                                    CFT002CGL009
     C*********************ENDIF                                    CFT002CGL009
      **All*chars*in*string*ok                                      CFT002CGL009
     C***********@C        IFEQ 15                                  CFT002CGL009
      ***->**BLANK*to*S1NDAM*because*the*lenght*of*the*amount*can   CFT002CGL009
      ***change*and*there*is*no*padding.                            CFT002CGL009
     C*********************MOVEL*BLANKS   S1NDAM                    CFT002CGL009
     C*********************MOVEL@S        S1NDAM                    CFT002CGL009
     C*********************MOVE S1NDAM    S4NDAM                    CFT002CGL009
     C*********************ENDIF                                    CFT002CGL009
      *                                                             CFT002CGL009
     C*********************ADD  1         @C                        CFT002CGL009
      *                                                             CFT002CGL009
     C*********************ENDDO                                    CFT002CGL009
      *                                                             CFT002CGL009
     C*********************ENDIF                                    CFT002CGL009
     C*********************ENDIF                                    CFT002CGL009
      *                                                             CFT002CGL009
     C*********************ELSE                                     CFT002CGL009
     C*********************MOVEL*BLANKS   S2BTB                     CFT002CGL009
     C*********************MOVEL*BLANKS   S1NDAM                    CFT002CGL009
     C*********************MOVEL*BLANKS   S4NDAM                    CFT002CGL009
     C*********************MOVEL*BLANKS   S1NDCY                    CFT002CGL009
     C*********************MOVEL*BLANKS   S4NDCY                    CFT002CGL009
     C*********************END                                      CFT002CGL009
     C*********************END                                      CFT002CGL009
      *                                                             CFT002CGL009
      **Mapping*for*OUTGOING*PAYMENTS                               CFT002CGL009
      *                                                             CFT002CGL009
      *                                                             CFT002CGL009
      **Set*up*the*detail*screen*fields*from*the*message.           CFT002CGL009
      *                                                             CFT002CGL009
      **Destination                                                 CFT002CGL009
      *                                                             CFT002CGL009
      **If*Intermediary*Bank*is*blank,*use*'A/c*with*Institution'   CFT002CGL009
      **details,*otherwise*use*Intermediary*Bank*details            CFT002CGL009
      *                                                             CFT002CGL009
     C***********PTAGPR    IFEQ 'P56'                               CFT002CGL009
     C***********PTAGPR    OREQ 'P57'                               CFT002CGL009
      *                                                             CFT002CGL009
     C***********PTAGPR    IFEQ 'P56'                               CFT002CGL009
     C*********************MOVELPRFDDT    P56                       CFT002CGL009
     C*********************END                                      CFT002CGL009
      *                                                             CFT002CGL009
     C***********PTAGPR    IFEQ 'P57'                               CFT002CGL009
     C*********************MOVELPRFDDT    P57                       CFT002CGL009
     C*********************END                                      CFT002CGL009
      *                                                             CFT002CGL009
     C***********P56       IFEQ *BLANKS                             CFT002CGL009
      *                                                             CFT002CGL009
     C***********P57       IFNE *BLANK                              CFT002CGL009
     C*********************MOVELPRFDDT    P57                       CFT002CGL009
     C*********************MOVELP57       DSTRAN                    CFT002CGL009
     C*********************MOVELTMLIN     S4DST                     CFT002CGL009
     C*********************END                                      CFT002CGL009
      *                                                             CFT002CGL009
     C*********************ELSE                                     CFT002CGL009
      *                                                             CFT002CGL009
      **Intermediary*Bank*entered                                   CFT002CGL009
      *                                                             CFT002CGL009
     C*********************MOVELP56       DSTRAN                    CFT002CGL009
     C*********************MOVELTMLIN     S4DST                     CFT002CGL009
      *                                                             CFT002CGL009
      **Account*with*Bank*(only*filled*if*Intermediary*Bank*exist)  CFT002CGL009
      *                                                             CFT002CGL009
     C***********P57       IFNE *BLANKS                             CFT002CGL009
     C*********************MOVELP57       DSTRAN                    CFT002CGL009
     C*********************MOVELTMLIN     S5ACB                     CFT002CGL009
     C*********************END                                      CFT002CGL009
      *                                                             CFT002CGL009
     C*********************END                                      CFT002CGL009
      *                                                             CFT002CGL009
      **Ordering*Bank*file*fields                                   CFT002CGL009
      *                                                             CFT002CGL009
      **If*Ordering*Institution*not*blank,*use*it                   CFT002CGL009
      **otherwise*use*Sender*details                                CFT002CGL009
      *                                                             CFT002CGL009
     C***********PTAGPR    IFEQ 'P52'                               CFT002CGL009
     C*********************MOVELPRFDDT    P52                       CFT002CGL009
     C*********************MOVELP52       DSTRAN                    CFT002CGL009
     C*********************MOVELTMLIN1    OPORB1                    CFT002CGL009
     C*********************MOVELTMLIN2    OPORB2                    CFT002CGL009
     C*********************MOVELTMLIN3    OPORB3                    CFT002CGL009
     C*********************MOVELTMLIN4    OPORB4                    CFT002CGL009
     C*********************MOVELTMLIN5    OPORB5                    CFT002CGL009
      *                                                             CFT002CGL009
      **If*network*is*swift,*find*field*type                        CFT002CGL009
      **otherwise*default*it*to*'A'.                                CFT002CGL009
      *                                                             CFT002CGL009
     C***********PNWRK     IFEQ 'SWIFT '                            CFT002CGL009
      *                                                             CFT002CGL009
      **Set*up*field*type,*if*A->S,*B->A,*D->A                      CFT002CGL009
      *                                                             CFT002CGL009
     C***********1         SUBSTTRTAG:4   #WK1    1                 CFT002CGL009
     C***********#WK1      IFEQ 'A'                                 CFT002CGL009
     C*********************MOVEL'S'       OPORBT                    CFT002CGL009
     C*********************ELSE                                     CFT002CGL009
      *                                                             CFT002CGL009
     C***********#WK1      IFEQ 'B'                                 CFT002CGL009
     C*********************MOVEL'A'       OPORBT                    CFT002CGL009
     C*********************ELSE                                     CFT002CGL009
     C*********************MOVEL'A'       OPORBT                    CFT002CGL009
     C*********************END                                      CFT002CGL009
     C*********************END                                      CFT002CGL009
      *                                                             CFT002CGL009
     C*********************ELSE                                     CFT002CGL009
      *                                                             CFT002CGL009
      **network*is*not*swift                                        CFT002CGL009
      *                                                             CFT002CGL009
     C*********************MOVEL'A'       OPORBT                    CFT002CGL009
     C*********************END                                      CFT002CGL009
      *                                                             CFT002CGL009
     C*********************ELSE                                     CFT002CGL009
      *                                                             CFT002CGL009
      **Sender*details                                              CFT002CGL009
      *                                                             CFT002CGL009
     C*********************MOVELPSNDR     OPORB1                    CFT002CGL009
      *                                                             CFT002CGL009
      **If*network*is*swift,*set*up*field*type*to*'S'**             CFT002CGL009
      **otherwise*default*it*to*'U'.                                CFT002CGL009
      *                                                             CFT002CGL009
     C***********PNWRK     IFEQ 'SWIFT '                            CFT002CGL009
     C*********************MOVEL'S'       OPORBT                    CFT002CGL009
     C*********************ELSE                                     CFT002CGL009
     C*********************MOVEL'A'       OPORBT                    CFT002CGL009
     C*********************END                                      CFT002CGL009
      *                                                             CFT002CGL009
     C*********************END                                      CFT002CGL009
      *                                                             CFT002CGL009
     C*********************END                                      CFT002CGL009
      *                                                             CFT002CGL009
      **Ordering*Bank                                               CFT002CGL009
      *                                                             CFT002CGL009
      **If*Receivers*Correspondent*is*not*blank,*use*it             CFT002CGL009
      **otherwise*use*Senders*Correspondent.*If*both*are*blank      CFT002CGL009
      **use*Sender*details.                                         CFT002CGL009
      *                                                             CFT002CGL009
     C***********PTAGPR    IFEQ 'P54'                               CFT002CGL009
     C*********************MOVELPRFDDT    P54                       CFT002CGL009
      *                                                             CFT002CGL009
     C*********************MOVELP54       DSTRAN                    CFT002CGL009
      *                                                             CFT002CGL009
     C*********************ELSE                                     CFT002CGL009
      *                                                             CFT002CGL009
     C***********PTAGPR    IFEQ 'P53'                               CFT002CGL009
     C*********************MOVELPRFDDT    P53                       CFT002CGL009
     C*********************MOVELP53       DSTRAN                    CFT002CGL009
      *                                                             CFT002CGL009
     C*********************ELSE                                     CFT002CGL009
      *                                                             CFT002CGL009
      *                                                             CFT002CGL009
     C*********************END                                      CFT002CGL009
     C*********************END                                      CFT002CGL009
      *                                                             CFT002CGL009
      **Related*Reference                                           CFT002CGL009
      *                                                             CFT002CGL009
      **If*MT100*type*of*message*use*Transaction*Reference*no.      CFT002CGL009
      **otherwise*use*related*referance.                            CFT002CGL009
      *                                                             CFT002CGL009
     C***********PMTPY     IFEQ '100'                               CFT002CGL009
      *                                                             CFT002CGL009
     C***********PTAGPR    IFEQ 'P20'                               CFT002CGL009
     C*********************MOVELPRFDDT    P20                       CFT002CGL009
     C*********************MOVELP20       DSTRAN                    CFT002CGL009
     C*********************MOVELTTREF     S6RLRF                    CFT002CGL009
     C*********************END                                      CFT002CGL009
      *                                                             CFT002CGL009
     C*********************ELSE                                     CFT002CGL009
      *                                                             CFT002CGL009
     C***********PTAGPR    IFEQ 'P21'                               CFT002CGL009
     C*********************MOVELPRFDDT    P21                       CFT002CGL009
     C*********************MOVELP21       DSTRAN                    CFT002CGL009
     C*********************MOVELTTREF     S6RLRF                    CFT002CGL009
     C*********************END                                      CFT002CGL009
      *                                                             CFT002CGL009
     C*********************END                                      CFT002CGL009
      *                                                             CFT002CGL009
     C***********PNWRK     IFEQ 'CASHV8'                            CFT002CGL009
      *                                                             CFT002CGL009
      ***Receiver*Correspondent*and*Ordering*Bank                   CFT002CGL009
      *                                                             CFT002CGL009
     C***********PTAGPR    IFEQ 'P54'                               CFT002CGL009
     C*********************MOVEL*BLANK    P54                       CFT002CGL009
     C*********************MOVELPRFDDT    P54                       CFT002CGL009
      *                                                             CFT002CGL009
     C***********WRTGVL    IFNE *BLANK                              CFT002CGL009
     C*********************MOVELP54       DSTRAN                    CFT002CGL009
     C*********************MOVEL*BLANKS   S1RCCO                    CFT002CGL009
     C*********************MOVELTMLIN     S1RCCO                    CFT002CGL009
     C*********************MOVEL*BLANKS   S4ORBK                    CFT002CGL009
     C*********************MOVELTMLIN     S4ORBK                    CFT002CGL009
      *                                                             CFT002CGL009
     C*********************ELSE                                     CFT002CGL009
      *                                                             CFT002CGL009
      ***Use*the*default*account*code*from*CASH*dataarea*and*build* CFT002CGL009
      ***account*number                                             CFT002CGL009
      *                                                             CFT002CGL009
      ***Get*branch*internal*customer                               CFT002CGL009
      *                                                             CFT002CGL009
     C*********************CALL 'AOBRCHR0'                          CFT002CGL009
     C*********************PARM *BLANKS   @RTCD                     CFT002CGL009
     C*********************PARM '*KEY   ' @OPTN                     CFT002CGL009
     C*********************PARM S1BRCA    #BRCA   3                 CFT002CGL009
     C***********SDBRCH    PARM SDBRCH    DSFDY                     CFT002CGL009
      *                                                             CFT002CGL009
      ***If*record*not*found                                        CFT002CGL009
     C***********@RTCD     IFNE *BLANK                              CFT002CGL009
     C*********************Z-ADD42        W0ERNB     ************** CFT002CGL009
     C*********************MOVEL'SDBRCHPD'W0FILE     *DB ERROR 42 * CFT002CGL009
     C*********************MOVELS1BRCA    W0KEY      ************** CFT002CGL009
     C*********************MOVEL'MEM5002' W0MSGD                    CFT002CGL009
     C*********************MOVEL'MIDAS  ' W0MSGF                    CFT002CGL009
     C*********************EXSR SRERRA                              CFT002CGL009
     C*********************END                                      CFT002CGL009
      *                                                             CFT002CGL009
      ***Retrieve*retail*account*number                             CFT002CGL009
      *                                                             CFT002CGL009
     C*********************MOVE A8BICN    @CNUM                     CFT002CGL009
     C*********************MOVELS1SMCY    @CCY                      CFT002CGL009
     C*********************MOVE DACACD    @ACOD                     CFT002CGL009
     C*********************Z-ADD1         @ACSQ                     CFT002CGL009
     C*********************MOVELS1BRCA    @BRCA                     CFT002CGL009
      *                                                             CFT002CGL009
     C***********KLACNT    CHAINACCNT                90             CFT002CGL009
      *                                                             CFT002CGL009
      ***If*record*not*found                                        CFT002CGL009
     C************IN90     IFEQ '1'                                 CFT002CGL009
     C*********************Z-ADD43        W0ERNB     ************** CFT002CGL009
     C*********************MOVEL'ACCNT'   W0FILE     *DB ERROR 43 * CFT002CGL009
     C*********************MOVEL@ACCN     W0KEY      ************** CFT002CGL009
     C*********************MOVEL'MEM5002' W0MSGD                    CFT002CGL009
     C*********************MOVEL'MIDAS  ' W0MSGF                    CFT002CGL009
     C*********************EXSR SRERRA                              CFT002CGL009
     C*********************END                                      CFT002CGL009
      *                                                             CFT002CGL009
      ***Move*retail*account*number*to*receiver's*correspondent     CFT002CGL009
      *                                                             CFT002CGL009
     C*********************MOVEL*BLANKS   S1RCCO                    CFT002CGL009
     C*********************MOVE ACNO      S1RCCO                    CFT002CGL009
      *                                                             CFT002CGL009
     C*********************END                                      CFT002CGL009
      *                                                             CFT002CGL009
     C*********************END                                      CFT002CGL009
      *                                                             CFT002CGL009
      ***Account*with*Institution*and*Destination                   CFT002CGL009
      *                                                             CFT002CGL009
     C***********PTAGPR    IFEQ 'P57'                               CFT002CGL009
     C*********************MOVELPRFDDT    P57                       CFT002CGL009
     C*********************MOVELP57       DSTRAN                    CFT002CGL009
     C*********************MOVEL*BLANKS   WREAC  10                 CFT002CGL009
     C*********************MOVELTMLIN     WREAC                     CFT002CGL009
     C*********************MOVEL*BLANKS   S1ACBK                    CFT002CGL009
     C*********************MOVELWREAC     S1ACBK                    CFT002CGL009
     C*********************MOVEL*BLANKS   S4DST                     CFT002CGL009
     C*********************MOVELWREAC     S4DST                     CFT002CGL009
     C*********************END                                      CFT002CGL009
      *                                                             CFT002CGL009
     C*********************MOVEL'N'       S3OPIN                    CFT002CGL009
      *                                                             CFT002CGL009
     C*********************END                                      CFT002CGL009
      *********                                                     CFT002CFT006
      ***Unwind*subroutine*stack*name                               CFT002CFT006
      *******                                                       CFT002CFT006
     C***********EXMAPR    TAG                                      CFT002CFT006
     C*********************MOVEA*BLANKS   @STK,Q                    CFT002CFT006
     C*********************SUB  1         Q                         CFT002CFT006
      ******                                                        CFT002CFT006
     C*********************ENDSR                                    CFT002CFT006
      /EJECT                                                              CFT002
      *================================================================   CGL009
      *  MAPPING in Incoming and Outgoing payment field                   CGL009
      *================================================================   CGL009
      *                                                                   CGL009
     C           SRMAP     BEGSR                                          CGL009
      *                                                                   CGL009
      *  Set up subroutine stack name                                     CGL009
      *                                                                   CGL009
     C                     ADD  1         Q                               CGL009
     C                     MOVEL'SRMAP '  @STK,Q                          CGL009
      *                                                                   CFT006
     C           PMTPY     IFEQ '101'                                     CFT006
     C           PMTPY     OREQ '102'                                     CFT006
      *                                                                   CFT006
     C                     SELEC                                          CFT006
     C           PMTPY     WHEQ '101'                                     CFT006
      ** Need OPMSGR and OPKPRT in SRLOG                                  CFT006
     C                     Z-ADDPHMSGR    OPMSGR                          CFT006
     C                     Z-ADDPHPART    OPKPRT                          CFT006
      ** Need INMSGR and INKPRT in SRREPT                                 CFT006
     C                     Z-ADDPHMSGR    INMSGR                          CFT006
     C                     Z-ADDPHPART    INKPRT                          CFT006
      *                                                                   CFT006
      ** Map 101 tags header into screen fields                           CFT006
     C                     CLEARHDRFTF                                    CFT006
     C                     CLEARHDRFTS                                    CFT006
     C                     CALL H101CV                 90                 CFT006
     C                     PARM *BLANK    P@RETN 10                       CFT006
     C                     PARM           P@ACTN                                              221538
     C                     PARM 'SH'      CVTCDE  2                       CFT006
     C                     PARM           HDRFTF                          CFT006
     C                     PARM           PDATA                           CFT006
     C                     PARM           PDAT2                                               CSW209
     C                     PARM 0         MGMSGR                          185107
     C                     PARM           HDRFTS                          CFT006
      *                                                                   CFT006
     C           *IN90     IFEQ '1'                                       CFT006
     C           P@RETN    ORNE *BLANK                                    CFT006
     C                     MOVEL'H101CV  'W0FILE                          CFT006
     C                     MOVEL'*CALL'   W0KEY            ***************CFT006
     C                     Z-ADD105       W0ERNB           * DB ERROR 105*CFT006
     C                     MOVEL'MEM5003' W0MSGD           ***************CFT006
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT006
     C                     EXSR SRERRA                                    CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      ** Apply criteria found                                             CFT006
      *  Payment type                                                     CFT006
     C                     MOVELGNPYTP    SRHTYP                          CFT006
      *  Payment sub type                                                 CFT006
     C           #3SUBT    IFEQ *BLANKS                                                       MK0520
     C                     MOVELGNPYST    SRHPST                          CFT006
     C                     ELSE                                                               MK0520
     C                     MOVE #3SUBT    SRHPST                                              MK0520
     C                     ENDIF                                                              MK0520
      *  Branch                                                           CFT006
     C                     MOVELGNBRCA    SRHBRC                          CFT006
      *  Orig Branch                                                      CFT006
     C                     MOVELGNBRCA    SRHORB                          CFT006
      *  Book code                                                        CFT006
     C           #3BOKC    IFEQ *BLANKS                                                       MK0520
     C                     MOVELGNBOKC    SRHBKC                          CFT006
     C                     ELSE                                                               MK0520
     C                     MOVE #3BOKC    SRHBKC                                              MK0520
     C                     ENDIF                                                              MK0520
      *  Profit center                                                    CFT006
     C                     MOVELGNPYTP    WPYTP                           CFT006
     C           #3SUBT    IFEQ *BLANKS                                                       MK0520
     C                     MOVELGNPYST    WPYST                           CFT006
     C                     ELSE                                                               MK0520
     C                     MOVE #3SUBT    WPYST                                               MK0520
     C                     ENDIF                                                              MK0520
     C           #3BOKC    IFEQ *BLANKS                                                       MK0520
     C                     MOVELGNBOKC    WBOKC                           CFT006
     C                     ELSE                                                               MK0520
     C                     MOVE #3BOKC    WBOKC                                               MK0520
     C                     ENDIF                                                              MK0520
     C                     MOVELGNBRCA    WBRCA                           CFT006
     C                     EXSR SRPRFC                                    CFT006
     C           WPRFC     IFNE *BLANK                                    CFT006
     C                     MOVE WPRFC     SRHPFC                          CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      ** Map 101 tags detail into screen fields                           CFT006
     C                     CLEARDTRFTF                                    CFT006
     C                     CLEARDTRFTS                                    CFT006
     C                     CALL C101CV                 90                 CFT006
     C                     PARM *BLANK    P@RETN                          CFT006
     C                     PARM           P@ACTN                                              221538
     C                     PARM 'SC'      CVTCDE                          CFT006
     C**********           PARM           HDRFTF                                   BUG25401 BUG25829
     C                     PARM           DTRFTF                          CFT006
     C                     PARM           PHEAD                           CFT006
     C                     PARM           PDATA                           CFT006
     C                     PARM           PDAT2                                               CSW209
     C**********           PARM 0         MGMSGR                                     185107 BUG24864
     C                     PARM           DTRFTS                          CFT006
      *                                                                   CFT006
     C           *IN90     IFEQ '1'                                       CFT006
     C           P@RETN    ORNE *BLANK                                    CFT006
     C                     MOVEL'C101CV  'W0FILE                          CFT006
     C                     MOVEL'*CALL'   W0KEY            ***************CFT006
     C                     Z-ADD106       W0ERNB           * DB ERROR 106*CFT006
     C                     MOVEL'MEM5003' W0MSGD           ***************CFT006
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT006
     C                     EXSR SRERRA                                    CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C           PMTPY     WHEQ '102'                                     CFT006
      ** Need OPMSGR and OPKPRT in SRLOG                                  CFT006
     C                     Z-ADDPHMSGR    OPMSGR                          CFT006
     C                     Z-ADDPHPART    OPKPRT                          CFT006
      ** Need INMSGR and INKPRT in SRREPT                                 CFT006
     C                     Z-ADDPHMSGR    INMSGR                          CFT006
     C                     Z-ADDPHPART    INKPRT                          CFT006
      *                                                                   CFT006
      ** Map 101 tags header into screen fields                           CFT006
     C                     CLEARHDCCTF                                    CFT006
     C                     CLEARHDCCTF                                    CFT006
     C                     CALL H102CV                 90                 CFT006
     C                     PARM *BLANK    P@RETN 10                       CFT006
     C                     PARM           P@ACTN                                              221538
     C                     PARM           PDATA                           CFT006
     C                     PARM           PDAT2                                               CSW209
     C                     PARM 0         MGMSGR                          195504
     C                     PARM 'SH'      CVTCDE  2                       CFT006
     C                     PARM           HDCCTF                          CFT006
     C                     PARM           HDCCTS                          CFT006
      *                                                                   CFT006
     C           *IN90     IFEQ '1'                                       CFT006
     C           P@RETN    ORNE *BLANK                                    CFT006
     C                     MOVEL'H102CV  'W0FILE                          CFT006
     C                     MOVEL'*CALL'   W0KEY            ***************CFT006
     C                     Z-ADD85        W0ERNB           * DB ERROR 85 *CFT006
     C                     MOVEL'MEM5003' W0MSGD           ***************CFT006
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT006
     C                     EXSR SRERRA                                    CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      ** Apply criteria found                                             CFT006
      *  Payment type                                                     CFT006
     C                     MOVELGNPYTP    SCHTYP                          CFT006
      *  Payment sub type                                                 CFT006
     C           #3SUBT    IFEQ *BLANKS                                                       MK0520
     C                     MOVELGNPYST    SCHPST                          CFT006
     C                     ELSE                                                               MK0520
     C                     MOVE #3SUBT    SCHPST                                              MK0520
     C                     ENDIF                                                              MK0520
      *  Branch                                                           CFT006
     C                     MOVELGNBRCA    SCHBRC                          CFT006
      *  Orig Branch                                                      CFT006
     C                     MOVELGNBRCA    SCHORB                          CFT006
      *  Book code                                                        CFT006
     C           #3BOKC    IFEQ *BLANKS                                                       MK0520
     C                     MOVELGNBOKC    SCHBKC                          CFT006
     C                     ELSE                                                               MK0520
     C                     MOVE #3BOKC    SCHBKC                                              MK0520
     C                     ENDIF                                                              MK0520
      *  Profit center                                                    CFT006
     C                     MOVELGNPYTP    WPYTP                           CFT006
     C           #3SUBT    IFEQ *BLANKS                                                       MK0520
     C                     MOVELGNPYST    WPYST                           CFT006
     C                     ELSE                                                               MK0520
     C                     MOVE #3SUBT    WPYST                                               MK0520
     C                     ENDIF                                                              MK0520
     C           #3BOKC    IFEQ *BLANKS                                                       MK0520
     C                     MOVELGNBOKC    WBOKC                           CFT006
     C                     ELSE                                                               MK0520
     C                     MOVE #3BOKC    WBOKC                                               MK0520
     C                     ENDIF                                                              MK0520
     C                     MOVELGNBRCA    WBRCA                           CFT006
     C                     EXSR SRPRFC                                    CFT006
     C           WPRFC     IFNE *BLANK                                    CFT006
     C                     MOVE WPRFC     SCHPFC                          CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      ** Map 102 tags detail into screen fields                           CFT006
     C                     CLEARDTCCTF                                    CFT006
     C                     CALL C102CV                 90                 CFT006
     C                     PARM *BLANK    P@RETN                          CFT006
     C                     PARM           P@ACTN                                              221538
     C                     PARM           PHEAD                           CFT006
     C                     PARM           PDATA                           CFT006
     C                     PARM           PDAT2                                               CSW209
     C                     PARM 'SC'      CVTCDE                          CFT006
     C                     PARM           SCHTYP                          CFT006
     C                     PARM           SCHREF                          CFT006
     C                     PARM           DTCCTF                          CFT006
     C                     PARM           DTCCTS                          CFT006
      *                                                                   CFT006
     C           *IN90     IFEQ '1'                                       CFT006
     C           P@RETN    ORNE *BLANK                                    CFT006
     C                     MOVEL'C102CV  'W0FILE                          CFT006
     C                     MOVEL'*CALL'   W0KEY            ***************CFT006
     C                     Z-ADD86        W0ERNB           * DB ERROR 86 *CFT006
     C                     MOVEL'MEM5003' W0MSGD           ***************CFT006
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT006
     C                     EXSR SRERRA                                    CFT006
     C                     ENDIF                                          CFT006
     C                     ENDSL                                          CFT006
      *                                                                   CFT006
      ** Escape procedure                                                 CFT006
     C                     GOTO EXMAP                                     CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CGL009
      * Settlement amt currency number of decimal positions               CFT014
     C           *LIKE     DEFN A6NBDP    SCNBDP                          CGL009
      * Payment amt currency number of decimal positions                  CFT014
     C           *LIKE     DEFN A6NBDP    PCNBDP                          CGL009
      * Notify delivery amt currency number of decimal positions          CFT014
     C           *LIKE     DEFN A6NBDP    DCNBDP                          CGL009
      * Notify amt currency number of decimal positions                   CFT014
     C           *LIKE     DEFN A6NBDP    NCNBDP                          CGL009
      * EURO currency number of decimal positions                         CFT014
     C           *LIKE     DEFN A6NBDP    EUNBDP                          CGL009
      * Sender's charges currency number of decimal positions             CFT014
     C           *LIKE     DEFN A6NBDP    CHNBDP                          CFT014
      * Receiver's charges currency number of decimal positions           CFT014
     C           *LIKE     DEFN A6NBDP    RCNBDP                          CFT014
      * Transaction amt currency number of decimal positions              CFT014
     C           *LIKE     DEFN A6NBDP    TRNBDP                          CFT014
      *                                                                   CGL009
      * Set up the detail screen fields from the message.                 CGL009
      *                                                                   CGL009
      * Sender                                                            CGL009
     C                     SELEC                                          CGL009
      ** Special rule for FONTIS                                          CGL009
     C           PNWRK     WHEQ 'FONTIS'                                  CGL009
     C           W0ACT     IFEQ '*INC FT'                                 CGL009
     C                     MOVELP53       DSTRAN                          CGL009
     C                     MOVEATMLIN1    @I35                            CGL009
     C                     EXSR SLSH35                                    CGL009
     C                     MOVEA@O35      WAC                             CGL009
     C                     MOVEL'N'       WACDMP                          CGL009
     C                     EXSR RTACNT                                    CGL009
     C           WACRTN    IFEQ *BLANK                                    175474
      ** If it is a G/L account we put the branch as the end              CGL009
      ** (BRCA/CUST/CCY/ACOD/SEQ) => (CUST/CCY/ACOD/SEQ/BRCA)             CGL009
      ** If it is a retail one, we don't format it                        CGL009
     C           WACLN     IFEQ 10                                        CGL009
     C                     MOVEA@O35      S1SND1                          CGL009
     C                     ELSE                                           CGL009
     C           3         SUBSTO35:1     WGLBCH                          CGL009
     C           3         SUBSTO35:10    WGLCCY                          CGL009
     C           6         SUBSTO35:4     WGLCST                          CGL009
     C********** 4         SUBSTO35:13    WGLACD                                       CGL009 CGL029
     C********** 2         SUBSTO35:17    WGLSQN                                       CGL009 CGL029
     C           10        SUBSTO35:13    WGLACD                                              CGL029
     C           2         SUBSTO35:23    WGLSQN                                              CGL029
     C                     MOVELDSGLDG    S1SND1                          CGL009
     C                     ENDIF                                          CGL009
     C************LIKE     DEFN WACCY     W53CCY                    CGL009175475
     C*********************MOVELWACCY     W53CCY                    CGL009175475
     C                     MOVELWACBCH    S1BRCA                          CGL009
     C                     ELSE                                           175474
      ** If no valid account in tag 53 we concatenate line of             175474
      ** 53 (A/C debited)  + first lines of 50 (Ord Cust)                 175474
     C                     MOVEA@O35      S1SND1                          175474
     C                     MOVELP50       DSTRAN                          175474
     C                     MOVELTMLIN1    S1SND2                          175474
     C                     MOVELTMLIN2    S1SND3                          175474
     C                     MOVELTMLIN3    S1SND4                          175474
     C*********************MOVEL*BLANK    W53CCY                    175474175475
      ** End of account validation                                        175474
     C                     ENDIF                                          175474
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
      ** Other Networks                                                   CGL009
     C                     OTHER                                          CGL009
     C                     MOVELPSNDR     SND1                            CGL009
      *                                                                   CGL009
     C           PSN       IFNE *BLANKS                                   CGL009
     C                     MOVELPSN       DSTRAN                          CGL009
     C           PSNDR     IFEQ 'CASHIER'                                 CGL009
     C                     MOVELPSNAR,1   TMLIN2                          CGL009
     C                     END                                            CGL009
     C                     MOVELTMLIN     S1SND                           CGL009
     C                     END                                            CGL009
     C                     ENDSL                                          CGL009
      *                                                                   CGL009
      * Message type and network                                          CGL009
      *                                                                   CGL009
     C                     MOVE PMTPY     INMTPY                          CGL009
     C                     MOVE PMTPY     V#MTPY                          CGL009
     C                     MOVE PNWRK     V#NWRK                          CGL009
      *                                                                   CGL009
      * Msg Unique Reference                                              CGL009
     C                     Z-ADDPHMSGR    INMSGR                          CGL009
     C                     Z-ADDPHMSGR    OPMSGR                          CGL009
      *                                                                   CGL009
      * Swift Reference                                                   CGL009
     C                     MOVELPHMIR     MIR                             CGL009
      *                                                                   CGL009
      * Part Number                                                       CGL009
     C                     MOVE PHPART    ISEQ                            CGL009
     C                     Z-ADDPHPART    INKPRT                          CGL009
     C                     Z-ADDPHPART    OPKPRT                          CGL009
     C/COPY WNCPYSRC,FT0300C030
      *                                                                   CGL009
      * Swift Priority Code                                               CGL009
     C                     MOVE PMPRY     S1SWPC                          CGL009
     C                     MOVE PMPRY     S4SWPC                          CGL009
      *                                                                   CGL009
      * Branch Code                                                       CGL009
     C           PBRCA     IFNE *BLANKS                                   CGL009
      ** Special rule for FONTIS                                          CGL009
     C           PNWRK     IFNE 'FONTIS'                                  CGL009
     C                     MOVELPBRCA     S1BRCA                          CGL009
     C                     MOVELPBRCA     S4BRCA                          CGL009
     C                     ENDIF                                          CGL009
     C                     END                                            CGL009
      *                                                                   CGL009
      * Transaction Reference no.                                         CGL009
      *                                                                   CGL009
     C           P20       IFNE *BLANKS                                   CGL009
     C                     MOVELP20       DSTRAN                          CGL009
      *                                                                   CGL009
     C           PNWRK     IFEQ 'CASHV8'                                  CGL009
      *                                                                   CGL009
     C                     MOVELTTREF     KDRNO                           CGL009
     C                     MOVEL*BLANKS   KODRN                           CGL009
     C                     MOVELPMTPY     KACDE                           CGL009
     C           KLPDRI    CHAINREPDRIL1             11                   CGL009
      *                                                                   CGL009
     C           *IN11     IFEQ '1'                                       CGL009
     C                     Z-ADD45        W0ERNB                          CGL009
     C                     MOVEL'REPDRIL1'W0FILE                          CGL009
     C                     MOVELKDRNO     W0KEY                           CGL009
     C                     MOVEL'MEM5002' W0MSGD                          CGL009
     C                     MOVEL'MIDAS  ' W0MSGF                          CGL009
     C                     EXSR SRERRA                                    CGL009
     C                     ELSE                                           CGL009
     C                     MOVELTTREF     INTRNO                          CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
     C                     ELSE                                           CGL009
     C                     MOVELTTREF     INTRNO                          CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
     C                     ELSE                                           CGL009
     C                     MOVEL*BLANKS   INTRNO                          CGL009
     C                     END                                            CGL009
      *                                                                   CGL009
      * Related Reference                                                 CGL009
      *                                                                   CGL009
     C                     SELEC                                          CGL009
      ** Special rule for FONTIS                                          CGL009
     C           PNWRK     WHEQ 'FONTIS'                                  CGL009
     C                     MOVELP20       DSTRAN                          CGL009
     C                     MOVELTTREF     S3RLRF                          CGL009
      *                                                                   CGL009
      ** Other Networks                                                   CGL009
     C                     OTHER                                          CGL009
     C           P21       IFNE *BLANKS                                   CGL009
     C                     MOVELP21       DSTRAN                          CGL009
     C                     MOVELTTREF     S3RLRF                          CGL009
     C                     ELSE                                           CGL009
     C                     MOVEL*BLANKS   S3RLRF                          CGL009
     C                     END                                            CGL009
     C                     ENDSL                                          CGL009
      *                                                                   CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
      *                                                                   CFT014
      ** Sender's Charge field                                            CFT014
     C           P71FX     IFNE *BLANKS                                   CFT014
     C                     MOVEL*BLANK    DSTRAN                          CFT014
     C                     MOVELP71FX     DSTRAN                          CFT014
     C                     Z-ADD1         I                               CFT014
     C                     MOVELTMLIN1    TV1                             CFT014
     C                     MOVELTMLIN2    TV2                             CFT014
     C                     MOVELTMLIN3    TV3                             CFT014
     C                     MOVELTMLIN4    TV4                             CFT014
     C                     MOVELTMLIN5    TV5                             CFT014
     C           I         DOWLE5                                         CFT014
     C           LFLT,I    ANDNE*BLANK                                    CFT014
     C                     MOVEL*BLANK    DSTRAN                          CFT014
     C                     MOVELLFLT,I    DSTRAN                          CFT014
     C                     EXSR RTPCA                                     CFT014
     C                     MOVELWCAAM     CGA,I                           CFT014
     C                     MOVELWCACY     CGC,I                           CFT014
     C                     ADD  1         I                               CFT014
     C                     ENDDO                                          CFT014
     C                     MOVEACGC       S7SCCD                          CFT014
     C                     MOVEACGC       S0SCCY                          CFT014
     C                     MOVEACGA       S0SCHG                          CFT014
     C                     MOVEACGA       S7SCHD                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Receiver's Charge field                                          CFT014
     C                     MOVEL*BLANKS   #71GCY  3                       MK0546
     C           P71G      IFNE *BLANKS                                   CFT014
     C                     MOVEL*BLANK    DSTRAN                          CFT014
     C                     MOVELP71G      DSTRAN                          CFT014
     C                     EXSR RTPCA                                     CFT014
     C           *LIKE     DEFN WCACY     WRCHCY                          CFT014
     C           *LIKE     DEFN WCAAM     WRCHAM                          CFT014
      ** Memorize receiver's charges currency / amount                    CFT014
      ** to pass as input parameter to S/R OV32AM                         CFT014
     C                     MOVELWCACY     WRCHCY                          CFT014
     C                     MOVELWRCHCY    #71GCY                          MK0546
     C                     MOVELWCAAM     WRCHAM                          CFT014
     C                     MOVELWRCHAM    S1RCNW                          CFT014
     C                     MOVELWCACY     S1RCCN                          CFT014
     C                     MOVELWRCHAM    S4RCNW                          CFT014
     C                     MOVELWCACY     S4RCCN                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CGL009
      * Value Date/Ccy/Amount                                             CGL009
      *                                                                   CGL009
     C           PDCA      IFNE *BLANKS                                   CGL009
      *                                                                   CGL009
     C                     SELEC                                          CGL009
      ** Special rule for FONTIS                                          CGL009
     C           PNWRK     WHEQ 'FONTIS'                                  CGL009
     C           #EXTRN    OREQ 'Y'                                                           MK0512
     C                     MOVELPDCA      DSTRAN                          CGL009
     C                     EXSR RTPDCA                                    CGL009
     C                     MOVELW32CY     S1PCCY                          CGL009
     C                     MOVELW32CY     S4PCCY                          CGL009
     C                     MOVELW32AM     WNLAM                           CGL009
     C                     EXSR TSNULL                                    CGL009
     C           WNLNUL    IFEQ 'N'                                       CGL009
     C                     MOVELW32AM     S1PYAM                          CGL009
     C                     MOVELW32AM     S4PYAM                          CGL009
     C                     ELSE                                           CGL009
     C                     MOVEL*BLANK    S1PYAM                          CGL009
     C                     MOVEL*BLANK    S4PYAM                          CGL009
     C                     ENDIF                                          CGL009
     C           *LIKE     DEFN W32DYN    WVLDT                           CGL009
     C                     Z-ADDW32DYN    WVLDT                           CGL009
     C                     MOVE W32DT     S1SLDT                          CGL009
     C                     MOVE W32DT     S4SLDT                          CGL009
     C                     MOVE W32DT     S1PVDT                          CGL009
     C                     MOVE W32DT     S4PVDT                          CGL009
      *                                                                   CGL009
      ** Other Networks                                                   CGL009
     C                     OTHER                                          CGL009
     C                     MOVELPDCA      DSTRAN                          CGL009
     C                     EXSR RTPDCA                                    CGL009
     C           CFT012    IFNE 'Y'                                       CFT012
     C           W0ACT     OREQ '*INC FT'                                 CFT012
     C           W0ACT     OREQ '*OUT FT'                                 EEE058
     C                     MOVELW32DT     S1SLDT                          CGL009
     C                     MOVELW32DT     S4SLDT                          CGL009
     C                     MOVELW32CY     S1SMCY                          CGL009
     C                     MOVELW32CY     S4SMCY                          CGL009
     C/COPY WNCPYSRC,FT0300MK15
     C           CFT014    IFEQ 'Y'                                       CFT014
     C           P71G      ANDNE*BLANK                                    CFT014
      ** Need to overwrite transaction amount to allow for the            CFT014
      ** receiver's charges                                               CFT014
     C                     MOVELW32DYN    WOVVLD                          CFT014
     C                     MOVELW32CY     WOVICY                          CFT014
     C                     MOVELW32AM     WOVIAM                          CFT014
     C                     MOVELWRCHCY    WOVRCY                          CFT014
     C                     MOVELWRCHAM    WOVRAM                          CFT014
     C                     MOVEL'*SUB'    WOVOPR                          CFT014
     C                     EXSR OV32AM                                    CFT014
     C                     MOVELWOVAMT    S1SMAM                          CFT014
     C                     MOVELWOVAMT    S4SMAM                          CFT014
     C                     ELSE                                           CFT014
     C                     MOVELW32AM     S1SMAM                          CGL009
     C                     MOVELW32AM     S4SMAM                          CGL009
     C                     ENDIF                                          CFT014
     C                     ELSE                                           CFT012
     C                     MOVELW32DT     S1SLDT                          CFT012
     C                     MOVELW32DT     S4SLDT                          CFT012
     C                     MOVELW32DT     S1PVDT                          CFT012
     C                     MOVELW32DT     S4PVDT                          CFT012
     C                     MOVELW32CY     S1PCCY                          CFT012
     C                     MOVELW32CY     S4PCCY                          CFT012
     C           CFT014    IFEQ 'Y'                                       CFT014
     C           P71G      ANDNE*BLANK                                    CFT014
      ** Need to overwrite transaction amount to allow for the            CFT014
      ** receiver's charges                                               CFT014
     C                     MOVELW32DYN    WOVVLD                          CFT014
     C                     MOVELW32CY     WOVICY                          CFT014
     C                     MOVELW32AM     WOVIAM                          CFT014
     C                     MOVELWRCHCY    WOVRCY                          CFT014
     C                     MOVELWRCHAM    WOVRAM                          CFT014
     C                     MOVEL'*SUB'    WOVOPR                          CFT014
     C                     EXSR OV32AM                                    CFT014
     C                     MOVELWOVAMT    S1PYAM                          CFT014
     C                     MOVELWOVAMT    S4PYAM                          CFT014
     C                     ELSE                                           CFT014
     C                     MOVELW32AM     S1PYAM                          CFT012
     C                     MOVELW32AM     S4PYAM                          CFT012
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT012
      *                                                                   CGL009
     C                     ENDSL                                          CGL009
      *                                                                   CGL009
     C                     END                                            CGL009
      *                                                                   CGL009
      * Ordering Customer                                                 CGL009
      *                                                                   CGL009
     C                     SELEC                                          CGL009
      ** Special rule for FONTIS                                          CGL009
     C           PNWRK     WHEQ 'FONTIS'                                  CGL009
     C           W0ACT     IFEQ '*OUT FT'                                 CGL009
     C                     MOVELP53       DSTRAN                          CGL009
     C                     MOVEATMLIN1    @I35                            CGL009
     C                     EXSR SLSH35                                    CGL009
     C                     MOVEA@O35      WAC                             CGL009
     C                     MOVEL'N'       WACDMP                          CGL009
     C                     EXSR RTACNT                                    CGL009
     C           WACRTN    IFEQ *BLANK                                    175474
      ** If it is a G/L account we format it in a way it is               CGL009
      ** interpreted as a partial account in the validation modules.      CGL009
      ** (BRCA/CUST/CCY/ACOD/SEQ) => (CUST/ACOD/SEQ/BRCA)                 CGL009
      ** If it is a retail one, we don't format it                        CGL009
     C           WACLN     IFEQ 10                                        CGL009
     C                     MOVEA@O35      S4ORC1                          CGL009
     C                     ELSE                                           CGL009
     C           3         SUBSTO35:1     WPTBCH                          CGL009
     C           6         SUBSTO35:4     WPTCST                          CGL009
     C********** 4         SUBSTO35:13    WPTACD                                       CGL009 CGL029
     C********** 2         SUBSTO35:17    WPTSQN                                       CGL009 CGL029
     C           10        SUBSTO35:13    WPTACD                                              CGL029
     C           2         SUBSTO35:23    WPTSQN                                              CGL029
     C                     MOVELDSPTAC    S4ORC1                          CGL009
      ** We append the currency at the end of the partial account so      CGL009
      ** that the validation program checks this currency is the same     CGL009
      ** as the settlement currency. But at the end the account will be   CGL009
      ** validated as a partial account (15 char) and NOT as a general    CGL009
      ** ledger account (18 chars).                                       CGL009
     C           S4ORC1    CAT  WACCY:0   S4ORC1                          CGL009
     C                     ENDIF                                          CGL009
     C*********************MOVELWACCY     W53CCY                    CGL009175475
     C                     MOVELWACBCH    S4BRCA                          CGL009
     C                     ELSE                                           175474
      ** If no valid account in tag 53 we concatenate line of             175474
      ** 53 (A/C debited)  + first lines of 50 (Ord Cust)                 175474
     C                     MOVEA@O35      S4ORC1                          175474
     C                     MOVELP50       DSTRAN                          175474
     C                     MOVELTMLIN1    S4ORC2                          175474
     C                     MOVELTMLIN2    S4ORC3                          175474
     C                     MOVELTMLIN3    S4ORC4                          175474
     C                     MOVELTMLIN4    S4ORC5                                              CFT032
     C*********************MOVEL*BLANK    W53CCY                    175474175475
      ** End of account validation                                        175474
     C                     ENDIF                                          175474
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
     C           W0ACT     IFEQ '*INC FT'                                 CGL009
     C                     MOVELP50       DSTRAN                          CGL009
     C                     MOVELTMLIN     S2ORC                           CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
      ** Other Networks                                                   CGL009
     C                     OTHER                                          CGL009
     C           P50       IFNE *BLANKS                                   CGL009
     C                     MOVELP50       DSTRAN                          CGL009
     C                     MOVELTMLIN     S2ORC                           CGL009
     C                     MOVELTMLIN     S4ORC                           CGL009
     C                     ELSE                                           CGL009
     C                     MOVEL*BLANKS   ORCT                            CGL009
     C                     MOVEL*BLANKS   S2ORC                           CGL009
     C                     MOVEL*BLANKS   S4ORC                           CGL009
     C                     END                                            CGL009
      *                                                                   CGL009
     C                     ENDSL                                          CGL009
      *                                                                   CGL009
      * Ordering Institution                                              CGL009
      *                                                                   CGL009
     C           P52       IFNE *BLANKS                                   CGL009
     C                     MOVELP52       DSTRAN                          CGL009
     C                     MOVELTMLIN     S2ORBK                          CGL009
     C                     ELSE                                           CGL009
     C                     MOVEL*BLANKS   ORBT                            CGL009
     C                     MOVEL*BLANKS   S2ORBK                          CGL009
     C                     END                                            CGL009
      *                                                                   CGL009
      * Senders Correspondent                                             CGL009
      *                                                                   CGL009
     C                     SELEC                                          CGL009
      *                                                                   CGL009
      ** Special rule for FONTIS                                          CGL009
     C           PNWRK     WHEQ 'FONTIS'                                  CGL009
      ** Sender correspondant will be never mapped in FONTIS.             CGL009
     C                     MOVEL*BLANKS   SNCT                            CGL009
     C                     MOVEL*BLANKS   S2SNC                           CGL009
     C***********          MOVELTMLIN     S4SNCO                    177119PL0001
      *                                                                   CGL009
      ** Other Networks                                                   CGL009
     C                     OTHER                                          CGL009
     C           P53       IFNE *BLANKS                                   CGL009
     C                     MOVELP53       DSTRAN                          CGL009
     C                     MOVELTMLIN     S2SNC                           CGL009
     C*********            MOVELTMLIN     S4SNCO                    177119PL0001
     C                     ELSE                                           CGL009
     C                     MOVEL*BLANKS   SNCT                            CGL009
     C                     MOVEL*BLANKS   S2SNC                           CGL009
     C                     MOVEL*BLANKS   S4SNCO                          177119
     C                     END                                            CGL009
      *                                                                   CGL009
     C                     ENDSL                                          CGL009
      *                                                                   CGL009
      * Receivers Correspondent                                           CGL009
      *                                                                   CGL009
     C/COPY WNCPYSRC,FT0300DB09                                                              HVB002
      *                                                                   CGL009
     C           P54       IFNE *BLANKS                                   CGL009
     C                     MOVELP54       DSTRAN                          CGL009
     C*********************MOVELTMLIN1    INRCO1                    CGL009CFT014
     C*********************MOVELTMLIN2    INRCO2                    CGL009CFT014
     C*********************MOVELTMLIN3    INRCO3                    CGL009CFT014
     C*********************MOVELTMLIN4    INRCO4                    CGL009CFT014
     C*********************MOVELTMLIN5    INRCO5                    CGL009CFT014
      ** Map network field not done because RCCO is a numeric field       CFT014
      ** Map screen field to be validated                                 CFT014
     C                     MOVELTMLIN1    S1RCO1                          CFT014
     C                     MOVELTMLIN2    S1RCO2                          CFT014
     C                     MOVELTMLIN3    S1RCO3                          CFT014
     C                     MOVELTMLIN4    S1RCO4                          CFT014
     C                     MOVELTMLIN5    S1RCO5                          CFT014
      *                                                                   CGL009
      * If network is swift, find field type                              CGL009
      * otherwise default it to 'U'.                                      CGL009
      *                                                                   CGL009
     C           PNWRK     IFEQ 'SWIFT '                                  CGL009
      *                                                                   CGL009
      * Set up field type, if A->S, B->T, D->U                            CGL009
      *                                                                   CGL009
     C           1         SUBSTTRTAG:4   #WK1    1                       CGL009
     C           #WK1      IFEQ 'A'                                       CGL009
     C                     MOVEL'S'       INRCRT                          CGL009
     C                     ELSE                                           CGL009
      *                                                                   CGL009
     C           #WK1      IFEQ 'B'                                       CGL009
     C                     MOVEL'T'       INRCRT                          CGL009
     C                     ELSE                                           CGL009
     C                     MOVEL'U'       INRCRT                          CGL009
     C                     END                                            CGL009
     C                     END                                            CGL009
      *                                                                   CGL009
     C                     ELSE                                           CGL009
      *                                                                   CGL009
      * network is not swift                                              CGL009
     C                     MOVEL'U'       INRCRT                          CGL009
     C                     END                                            CGL009
      *                                                                   CGL009
     C                     ELSE                                           CGL009
     C                     MOVEL*BLANKS   INRCRT                          CGL009
     C*********************MOVEL*BLANKS   INRCO1                    CGL009CFT014
     C*********************MOVEL*BLANKS   INRCO2                    CGL009CFT014
     C*********************MOVEL*BLANKS   INRCO3                    CGL009CFT014
     C*********************MOVEL*BLANKS   INRCO4                    CGL009CFT014
     C*********************MOVEL*BLANKS   INRCO5                    CGL009CFT014
     C                     END                                            CGL009
      *                                                                   CGL009
      * Intermediary                                                      CGL009
      *                                                                   CGL009
     C           P56       IFNE *BLANKS                                   CGL009
     C                     MOVELP56       DSTRAN                          CGL009
      *                                                                   CGL009
     C                     SELEC                                          CGL009
      ** Special rule for FONTIS                                          CGL009
     C           PNWRK     WHEQ 'FONTIS'                                  CGL009
     C*********************MOVELTMLIN     S6IBK                     CGL009CFT014
     C                     MOVELTMLIN     S5IBK                           CFT014
     C                     MOVEL*BLANK    S3IBK                           CGL009
     C                     OTHER                                          CGL009
     C                     MOVELTMLIN     S3IBK                           CGL009
     C                     ENDSL                                          CGL009
      *                                                                   CGL009
     C                     ELSE                                           CGL009
     C                     MOVEL*BLANKS   INBT                            CGL009
     C                     MOVEL*BLANKS   S3IBK                           CGL009
     C*********************MOVEL*BLANKS   S6IBK                     CGL009CFT014
     C                     MOVEL*BLANKS   S5IBK                           CFT014
     C                     END                                            CGL009
      *                                                                   CGL009
      * Account with Institution                                          CGL009
      *                                                                   CGL009
     C           P57       IFNE *BLANKS                                   CGL009
      *                                                                   CGL009
     C                     SELEC                                          CGL009
      *                                                                   CGL009
      ** Special rule for FONTIS                                          CGL009
     C           PNWRK     WHEQ 'FONTIS'                                  CGL009
      ** A/C with bank not mapped for incoming payments                   CGL009
     C           W0ACT     IFEQ '*INC FT'                                 175477
     C***********W0ACT     IFEQ '*OUT FT'                           CGL009175477
     C*********************MOVELP57       DSTRAN                    CGL009175477
     C*********************MOVELTMLIN1    INACB1                    CGL009175477
     C*********************MOVELTMLIN2    INACB2                    CGL009175477
     C*********************MOVELTMLIN3    INACB3                    CGL009175477
     C*********************MOVELTMLIN4    INACB4                    CGL009175477
     C*********************MOVELTMLIN5    INACB5                    CGL009175477
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
      ** Other Networks                                                   CGL009
     C                     OTHER                                          CGL009
     C                     MOVELP57       DSTRAN                          CGL009
      ** Map screen field to be validated                                 CFT014
     C                     MOVELTMLIN1    S1ACBK                          CFT014
      ** Map network field                                                CFT014
     C                     MOVELTMLIN1    INACB1                          CGL009
     C                     MOVELTMLIN2    INACB2                          CGL009
     C                     MOVELTMLIN3    INACB3                          CGL009
     C                     MOVELTMLIN4    INACB4                          CGL009
     C                     MOVELTMLIN5    INACB5                          CGL009
      *                                                                   CGL009
     C                     ENDSL                                          CGL009
      *                                                                   CGL009
      * If network is swift, find field type                              CGL009
      * otherwise default it to 'U'.                                      CGL009
      *                                                                   CGL009
     C           PNWRK     IFEQ 'SWIFT '                                  CGL009
      *                                                                   CGL009
      * Set up field type, if A->S, B->T, D->U                            CGL009
      *                                                                   CGL009
     C           1         SUBSTTRTAG:4   #WK1                            CGL009
     C           #WK1      IFEQ 'A'                                       CGL009
     C                     MOVEL'S'       INACBT                          CGL009
     C                     ELSE                                           CGL009
      *                                                                   CGL009
     C           #WK1      IFEQ 'B'                                       CGL009
     C                     MOVEL'T'       INACBT                          CGL009
     C                     ELSE                                           CGL009
     C                     MOVEL'U'       INACBT                          CGL009
     C                     END                                            CGL009
     C                     END                                            CGL009
      *                                                                   CGL009
     C                     ELSE                                           CGL009
      *                                                                   CGL009
      * network is not swift                                              CGL009
     C                     MOVEL'U'       INACBT                          CGL009
     C                     END                                            CGL009
      *                                                                   CGL009
     C                     ELSE                                           CGL009
     C                     MOVEL*BLANKS   INACBT                          CGL009
     C                     MOVEL*BLANKS   INACB1                          CGL009
     C                     MOVEL*BLANKS   INACB2                          CGL009
     C                     MOVEL*BLANKS   INACB3                          CGL009
     C                     MOVEL*BLANKS   INACB4                          CGL009
     C                     MOVEL*BLANKS   INACB5                          CGL009
     C                     END                                            CGL009
      *                                                                   CGL009
      * Beneficiary Institution/ Beneficiary Customer                     CGL009
      *                                                                   CGL009
     C           P58       IFNE *BLANKS                                   CGL009
     C                     MOVELP58       DSTRAN                          CGL009
     C                     MOVELTMLIN     S1BNC                           CGL009
     C                     MOVELTMLIN     S5BNC                           CGL009
     C                     END                                            CGL009
      *                                                                   CGL009
     C                     SELEC                                          CGL009
      ** Special rule for FONTIS                                          CGL009
     C           PNWRK     WHEQ 'FONTIS'                                  CGL009
     C           P59       IFNE *BLANKS                                   CGL009
      ** INCOMING PAYMENT                                                 CGL009
     C           W0ACT     IFEQ '*INC FT'                                 CGL009
     C                     MOVELP59       DSTRAN                          CGL009
     C                     MOVEATMLIN1    @I35                            CGL009
     C                     EXSR SLSH35                                    CGL009
     C                     MOVEA@O35      WAC                             CGL009
     C                     MOVEL'N'       WACDMP                          CGL009
     C                     EXSR RTACNT                                    CGL009
     C           WACRTN    IFEQ *BLANK                                    CGL009
      ** Only the first line is filled                                    CGL009
      ** If it is a G/L account we format it in a way it is               CGL009
      ** interpreted as a partial account in the validation modules.      CGL009
      ** If it is a retail one, we don't format it                        CGL009
     C           WACLN     IFEQ 10                                        CGL009
     C                     MOVEA@O35      S1BNC1                          CGL009
     C                     ELSE                                           CGL009
     C           3         SUBSTO35:1     WPTBCH                          CGL009
     C           6         SUBSTO35:4     WPTCST                          CGL009
     C********** 4         SUBSTO35:13    WPTACD                                       CGL009 CGL029
     C********** 2         SUBSTO35:17    WPTSQN                                       CGL009 CGL029
     C           10        SUBSTO35:13    WPTACD                                              CGL029
     C           2         SUBSTO35:23    WPTSQN                                              CGL029
     C                     MOVELDSPTAC    S1BNC1                          CGL009
      ** We append the currency at the end of the partial account so      CGL009
      ** that the validation program checks this currency is the same     CGL009
      ** as the payment currency. But at the end the account will be      CGL009
      ** validated as a partial account (15 char) and NOT as a general    CGL009
      ** ledger account (18 chars).                                       CGL009
     C           S1BNC1    CAT  WACCY:0   S1BNC1                          CGL009
     C                     ENDIF                                          CGL009
     C                     ELSE                                           CGL009
     C                     MOVELTMLIN     S1BNC                           CGL009
     C                     ENDIF                                          CGL009
     C                     ELSE                                           CGL009
      ** OUTGOING PAYMENT                                                 CGL009
     C                     MOVELP59       DSTRAN                          CGL009
     C                     MOVELTMLIN     S5BNC                           CGL009
     C                     ENDIF                                          CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
      ** Other Networks                                                   CGL009
     C                     OTHER                                          CGL009
     C           P59       IFNE *BLANKS                                   CGL009
     C                     MOVELP59       DSTRAN                          CGL009
     C                     MOVELTMLIN     S1BNC                           CGL009
     C                     MOVELTMLIN     S5BNC                           CGL009
     C                     END                                            CGL009
      *                                                                   CGL009
     C                     ENDSL                                          CGL009
      *                                                                   CGL009
     C           CFT004    IFEQ 'Y'                                       CFT004
     C           P58       IFNE *BLANKS                                   CFT004
     C           P59       ORNE *BLANKS                                   CFT004
      * Check if Beneficiary is IBAN                                      CFT004
     C                     MOVELS1BNC     WIB1    1                       CFT004
     C           WIB1      IFEQ '/'                                       CFT004
     C           34        SUBSTS1BNC:2   P@IBN  34                       CFT004
     C* Check that it is a valid IBAN                                     CFT004
     C                     MOVE *BLANKS   DSSDY                           CFT004
     C                     CALL 'AOIBANR2'                                CFT004
     C                     PARM           @RTCD                           CFT004
     C                     PARM           P@IBN                           CFT004
     C           P@ACCN    PARM           DSSDY                           CFT004
      *                                                                   CFT004
      * Valid IBAN but not on the system, Process as Customer name and    CFT004
      * Address field                                                     CFT004
     C           @RTCD     IFEQ '      6'                                 CFT004
     C/COPY WNCPYSRC,FT0300C031
     C                     MOVE 'A'       BNCT                            CFT004
     C                     MOVEL'A'       F5BNCT                                              MK0526
     C                     ENDIF                                          CFT004
      *                                                                   CFT004
      * Check if Account Currency matchs with the pay currency            CFT004
     C           @RTCD     IFEQ *BLANKS                                   CFT004
     C                     MOVELPDCA      DSTRAN                          CFT004
     C           CCY       IFEQ TVCCY                                     CFT004
     C                     MOVE 'I'       BNCT                            CFT004
     C                     ENDIF                                          CFT004
     C                     ENDIF                                          CFT004
     C                     ENDIF                                          CFT004
     C                     ENDIF                                          CFT004
     C                     ENDIF                                          CFT004
      *                                                                   CFT004
      * Details of Payment                                                CGL009
      *                                                                   CGL009
     C           P70       IFNE *BLANKS                                   CGL009
     C                     MOVELP70       DSTRAN                          CGL009
     C                     MOVELTMLIN     S3PAY                           CGL009
      ***Special*rule*for*FONTIS************                        CGL009CFT014
     C***********PNWRK*****IFEQ 'FONTIS'                            CGL009CFT014
     C*********************MOVELTMLIN     S5PAY                     CGL009CFT014
     C                     MOVELTMLIN     S6PAY                           CFT014
     C*********************ENDIF                                    CGL009CFT014
     C                     ELSE                                           CGL009
     C                     MOVEL*BLANKS   S3PAY                           CGL009
     C*********************MOVEL*BLANKS   S5PAY                     CGL009CFT014
     C                     MOVEL*BLANK    S6PAY                           CFT014
     C                     END                                            CGL009
      *                                                                                       CER030
      ** Populate the Extended Narratives                                                     CER030
      *                                                                                       CER030
     C           CER031    IFEQ 'Y'                                                           CER030
     C           PEXN      IFNE *BLANKS                                                       CER030
     C                     MOVELPEXN      DSTRAN                                              CER030
     C                     MOVELTMLIN1    IEXN1                                               CER030
     C                     MOVELTMLIN2    IEXN2                                               CER030
     C                     MOVELTMLIN3    IEXN3                                               CER030
     C                     MOVELTMLIN4    IEXN4                                               CER030
     C                     MOVELTMLIN5    IEXN5                                               CER030
     C                     MOVELTMLIN6    IEXN6                                               CER030
      *                                                                                       CER030
     C                     MOVELTMLIN1    OPEXN1                                              CER030
     C                     MOVELTMLIN2    OPEXN2                                              CER030
     C                     MOVELTMLIN3    OPEXN3                                              CER030
     C                     MOVELTMLIN4    OPEXN4                                              CER030
     C                     MOVELTMLIN5    OPEXN5                                              CER030
     C                     MOVELTMLIN6    OPEXN6                                              CER030
      *                                                                                       CER030
     C                     ELSE                                                               CER030
      *                                                                                       CER030
     C                     MOVE *BLANKS   IEXN                                                CER030
     C                     MOVE *BLANKS   OPEXN                                               CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                   STP011
      ** Pay Date/Currency/Amount                                         STP011
      *                                                                   STP011
     C           P32A      IFNE *BLANKS                                   STP011
     C                     MOVEL*BLANK    DSTRAN                          STP011
     C                     MOVELP32A      DSTRAN                          STP011
     C                     EXSR RTPDCA                                    STP011
     C           W32CY     IFNE S4SMCY                                    STP011
     C/COPY WNCPYSRC,FT0300MK16                                           STP011
     C                     MOVELW32CY     S1PCCY                          STP011
     C                     MOVELW32CY     S4PCCY                          STP011
     C                     MOVELW32CY     S4PDCY                          STP011
     C                     MOVELW32AM     S1PYAM                          STP011
     C                     MOVELW32AM     S4PDAM                          STP011
     C                     MOVELW32AM     S4PYAM                          STP011
     C                     MOVELW32DT     S1PVDT                          STP011
     C                     MOVELW32DT     S4PVDT                          STP011
     C                     ENDIF                                          STP011
     C                     ENDIF                                          STP011
      *                                                                   STP011
      ** Central Bank Reference                                           STP011
      *                                                                   STP011
      *                                                                   CGL009
     C           P80       IFNE *BLANKS                                   STP008
     C                     MOVELP80       DSTRAN                          STP008
     C                     MOVELTMLIN1    S3CBKR                          STP008
     C                     MOVELTMLIN1    S6CBKR                          STP008
     C                     ELSE                                           STP008
     C                     MOVEL*BLANKS   S3CBKR                          STP008
     C                     MOVEL*BLANKS   S6CBKR                          STP008
     C                     END                                            STP008
      *                                                                   STP008
     C           P73       IFNE *BLANKS                                   STP008
     C                     MOVELP73       DSTRAN                          STP008
     C                     MOVELTMLIN1    S0CDRO                          STP008
     C                     MOVELTMLIN1    S7CDRO                          STP008
     C                     ELSE                                           STP008
     C                     MOVEL*BLANKS   S0CDRO                          STP008
     C                     MOVEL*BLANKS   S7CDRO                          STP008
     C                     END                                            STP008
      *                                                                   STP008
      * Details of Charges                                                CGL009
      *                                                                   CGL009
     C           P71       IFNE *BLANKS                                   CGL009
     C                     MOVELP71       DSTRAN                          CGL009
     C*********************MOVELTTREF     S3DETC                    CGL009CFT014
     C                     MOVELTTREF     S0DETC                          CFT014
     C*********************MOVELTTREF     S6DETC                    CGL009CFT014
     C                     MOVELTTREF     S7DETC                          CFT014
     C                     MOVELTTREF     V#DETC                          CFT014
      *                                                                   CGL009
     C           PNWRK     IFEQ 'FONTIS'                                  CGL009
     C           TTREF     IFEQ 'OUR'                                     CGL009
     C                     MOVEL'A'       S1ADDC                          CGL009
     C                     MOVEL'A'       S4ADDC                          CGL009
     C                     ELSE                                           CGL009
     C                     MOVEL'D'       S1ADDC                          CGL009
     C                     MOVEL'D'       S4ADDC                          CGL009
     C                     ENDIF                                          CGL009
     C                     ELSE                                           CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
     C           TTREF     IFEQ 'OUR'                                     CFT014
     C                     MOVEL'A'       S1ADDC                          CFT014
     C                     MOVEL'A'       S4ADDC                          CFT014
     C                     ELSE                                           CFT014
     C                     MOVEL'D'       S1ADDC                          CFT014
     C                     MOVEL'D'       S4ADDC                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CGL009
      *                                                                                       MK0527
     C           #EXTRN    IFEQ 'Y'                                                           MK0527
     C           TTREF     IFEQ 'OUR'                                                         MK0527
     C           TTREF     OREQ 'SHA'                                                         MK0527
     C                     MOVE 'A'       S4ADDC                                              MK0527
     C                     ELSE                                                               MK0527
     C                     MOVE 'D'       S4ADDC                                              MK0527
     C                     ENDIF                                                              MK0527
     C                     ENDIF                                                              MK0527
      *                                                                   CGL009
     C           PNWRK     IFEQ 'CASHV8'                                  CGL009
     C                     MOVEL*BLANKS   WCHCY   3                       CGL009
     C                     MOVELTTREF     WCHCY                           CGL009
     C*********************MOVEL'OUR'     S3DETC                    CGL009CFT014
     C                     MOVEL'OUR'     S0DETC                          CFT014
     C*********************MOVEL'OUR'     S6DETC                    CGL009CFT014
     C                     MOVEL'OUR'     S7DETC                          CFT014
     C                     MOVEL'OUR'     V#DETC                          CFT014
      *                                                                   CGL009
      **  Format amount field (change ',' decimal point to '.').          CGL009
      *                                                                   CGL009
     C                     MOVEL*BLANKS   WRK13  13                       CGL009
     C                     MOVE TTREF     WRK13                           CGL009
     C                     MOVEA*BLANKS   YA1                             CGL009
     C                     MOVEAWRK13     YA1                             CGL009
     C                     Z-ADD1         C       30                      CGL009
      *                                                                   CGL009
     C           C         DOUGT15                                        CGL009
     C           YA1,C     IFEQ ','                                       CGL009
     C                     MOVE '.'       YA1,C                           CGL009
     C                     Z-ADD16        C                               CGL009
     C                     ELSE                                           CGL009
     C                     ADD  1         C                               CGL009
     C                     ENDIF                                          CGL009
     C                     ENDDO                                          CGL009
      *                                                                   CGL009
     C                     MOVEAYA1       AMT    15                       CGL009
     C*********************MOVELAMT       S3MSCD                    CGL009CFT014
     C                     MOVELAMT       S0MSCD                          CFT014
     C*********************MOVELAMT       S6MSCD                    CGL009CFT014
     C                     MOVELAMT       S7MSCD                          CFT014
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
     C                     ELSE                                           CGL009
      *                                                                   CGL009
     C           PNWRK     IFEQ 'FONTIS'                                  CGL009
     C                     MOVEL'D'       S1ADDC                          CGL009
     C                     MOVEL'D'       S4ADDC                          CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
     C*********************MOVEL*BLANKS   S3DETC                    CGL009CFT014
     C                     MOVEL*BLANKS   S0DETC                          CFT014
     C*********************MOVEL*BLANKS   S6DETC                    CGL009CFT014
     C                     MOVEL*BLANKS   S7DETC                          CFT014
     C                     END                                            CGL009
      *                                                                   CGL009
      * Bank to Bank Information                                          CGL009
      *                                                                   CGL009
     C                     SELEC                                          CGL009
      ** Special rule for FONTIS                                          CGL009
     C           PNWRK     WHEQ 'FONTIS'                                  CGL009
     C           P72       IFEQ *BLANKS                                   CGL009
      ** Should never happen because FONTIS is supposed to send the       175475
      ** settlement currency via :72: /ORIG/                              175475
      ***Settlement*CCY*will*be*the*same*as*the*account*to*be*debitdCGL009175475
     C*********************MOVELW53CCY    S1SMCY                    CGL009175475
     C*********************MOVELW53CCY    S4SMCY                    CGL009175475
     C                     MOVEL*BLANKS   S2BTB                           CGL009
     C                     ELSE                                           CGL009
     C*                                                                   CGL009
     C                     EXSR ICCHK                                     CGL009
     C*                                                                   CGL009
     C                     MOVELP72       DSFONT                          CGL009
     C           FOUND     IFEQ 'Y'                                       CGL009
     C                     MOVEL*BLANK    S2BTB6                          CGL009
     C                     MOVELFN72L2    S2BTB1                          CGL009
     C                     MOVELFN72L3    S2BTB2                          CGL009
     C                     MOVELFN72L4    S2BTB3                          CGL009
     C                     MOVELFN72L5    S2BTB4                          CGL009
     C                     MOVELFN72L6    S2BTB5                          CGL009
     C*********************MOVEL*BLANK    S5BTB6                    CGL009CFT014
     C*********************MOVELFN72L2    S5BTB1                    CGL009CFT014
     C*********************MOVELFN72L3    S5BTB2                    CGL009CFT014
     C*********************MOVELFN72L4    S5BTB3                    CGL009CFT014
     C*********************MOVELFN72L5    S5BTB4                    CGL009CFT014
     C*********************MOVELFN72L6    S5BTB5                    CGL009CFT014
     C                     MOVEL*BLANK    S6BTB6                          CFT014
     C                     MOVELFN72L2    S6BTB1                          CFT014
     C                     MOVELFN72L3    S6BTB2                          CFT014
     C                     MOVELFN72L4    S6BTB3                          CFT014
     C                     MOVELFN72L5    S6BTB4                          CFT014
     C                     MOVELFN72L6    S6BTB5                          CFT014
     C                     ELSE                                           CGL009
     C                     MOVELFN72L1    S2BTB1                          CGL009
     C                     MOVELFN72L2    S2BTB2                          CGL009
     C                     MOVELFN72L3    S2BTB3                          CGL009
     C                     MOVELFN72L4    S2BTB4                          CGL009
     C                     MOVELFN72L5    S2BTB5                          CGL009
     C                     MOVELFN72L6    S2BTB6                          CGL009
     C*********************MOVELFN72L1    S5BTB1                    CGL009CFT014
     C*********************MOVELFN72L2    S5BTB2                    CGL009CFT014
     C*********************MOVELFN72L3    S5BTB3                    CGL009CFT014
     C*********************MOVELFN72L4    S5BTB4                    CGL009CFT014
     C*********************MOVELFN72L5    S5BTB5                    CGL009CFT014
     C*********************MOVELFN72L6    S5BTB6                    CGL009CFT014
     C                     MOVELFN72L1    S6BTB1                          CFT014
     C                     MOVELFN72L2    S6BTB2                          CFT014
     C                     MOVELFN72L3    S6BTB3                          CFT014
     C                     MOVELFN72L4    S6BTB4                          CFT014
     C                     MOVELFN72L5    S6BTB5                          CFT014
     C                     MOVELFN72L6    S6BTB6                          CFT014
     C                     ENDIF                                          CGL009
      *                                                                   175479
     C                     MOVEL'/REF/'   WCW                             175479
     C                     MOVELFONT72    WCWLIN                          175479
     C                     Z-ADD30        WCWLEN                          175479
     C                     EXSR CWVAL                                     175479
     C           WCWVAL    IFNE *BLANK                                    175479
     C                     MOVELWCWVAL    S1FDLR                          175479
     C                     MOVELWCWVAL    S4FDLR                          175479
     C                     ENDIF                                          175479
      *                                                                   CGL009
     C                     MOVEL'/ORIG/'  WCW                             CGL009
     C                     MOVELFONT72    WCWLIN                          CGL009
     C                     EXSR CWAMCY                                    CGL009
     C           WCWCY     IFNE *BLANK                                    CGL009
     C                     MOVELWCWCY     S1SMCY                          CGL009
     C                     MOVELWCWCY     S4SMCY                          CGL009
     C                     ELSE                                           CGL009
      ** Should never happen because FONTIS is supposed to send the       175475
      ** settlement currency via :72: /ORIG/                              175475
     C*********************MOVELW53CCY    S1SMCY                    CGL009175475
     C*********************MOVELW53CCY    S4SMCY                    CGL009175475
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
     C                     MOVELWCWAM     WNLAM                           CGL009
     C                     EXSR TSNULL                                    CGL009
     C           WNLNUL    IFEQ 'N'                                       CGL009
     C                     MOVELWCWAM     S1SMAM                          CGL009
     C                     MOVELWCWAM     S4SMAM                          CGL009
     C                     ELSE                                           CGL009
     C                     MOVEL*BLANK    S1SMAM                          CGL009
     C                     MOVEL*BLANK    S4SMAM                          CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
     C           CEU006    IFEQ 'Y'                                       CGL009
      ** Retrieve delivery currency and amount                            CGL009
     C                     MOVEL'/OCMT/'  WCW                             CGL009
     C                     MOVELFONT72    WCWLIN                          CGL009
     C                     EXSR CWAMCY                                    CGL009
     C           WCWCY     IFNE *BLANK                                    CGL009
     C           W0ACT     IFEQ '*INC FT'                                 CGL009
     C           S1SMCY    IFEQ WCWCY                                     CGL009
      ** In incoming payment settlement ccy and notified ccy              CGL009
      ** cannot be the same.                                              CGL009
     C                     ELSE                                           CGL009
     C                     MOVELWCWCY     S1NDCY                          CGL009
      ** We use the amount of :72: only if settlement amount is blank     CGL009
     C           S1SMAM    IFEQ *BLANK                                    CGL009
     C                     MOVELWCWAM     S1NDAM                          CGL009
     C                     ELSE                                           CGL009
      *                                                                   CGL009
      ** Retrieve details of settlement currency                          CGL009
     C                     MOVELS1SMCY    WCYCCY                          CGL009
     C                     MOVEL'N'       WCYDMP                          CGL009
     C                     EXSR RTCCYD                                    CGL009
     C           WCYRTN    IFEQ *BLANK                                    CGL009
     C                     Z-ADDWCYNDP    SCNBDP                          CGL009
      *                                                                   CGL009
      ** Retrieve details of notified currency                            CGL009
     C                     MOVELS1NDCY    WCYCCY                          CGL009
     C                     MOVEL'N'       WCYDMP                          CGL009
     C                     EXSR RTCCYD                                    CGL009
     C           WCYRTN    IFEQ *BLANK                                    CGL009
     C                     Z-ADDWCYNDP    NCNBDP                          CGL009
      *                                                                   CGL009
      ** Format settlement amount                                         CGL009
     C                     MOVEL*BLANK    ZFIELD                          CGL009
     C                     MOVE S1SMAM    ZFIELD                          CGL009
     C           13        SUB  SCNBDP    ZADIG                           CGL009
     C                     Z-ADDSCNBDP    ZADEC                           CGL009
     C                     EXSR ZALIGN                                    CGL009
     C                     MOVE ZFIELD    F1SMAM                          CGL009
      *                                                                   CGL009
      ** Convert the settlement amount into the notified currency         CGL009
     C                     CLEARP#0010                                    CGL009
     C                     Z-ADDWVLDT     P#FRDT                          CGL009
     C                     Z-ADDWVLDT     P#TODT                          CGL009
     C                     MOVELS1SMCY    P#FRCY                          CGL009
     C                     MOVE F1SMAM    P#FRAM                          CGL009
     C                     MOVELS1NDCY    P#TOCY                          CGL009
     C                     Z-ADD0         P#TOAM                          CGL009
     C                     Z-ADD0         P#RATE                          CGL009
     C                     CALL 'FT0010'                                  CGL009
     C                     PARM           P#0010                          CGL009
      *                                                                   CGL009
     C           P#RTCD    IFNE *BLANK                                    CGL009
     C                     MOVEL'FT0010  'W0FILE           ***************CGL009
     C                     MOVEL'*CALL  ' W0KEY            * DB ERROR 79 *CGL009
     C                     Z-ADD79        W0ERNB           ***************CGL009
     C                     MOVEL'MEM5003' W0MSGD                          CGL009
     C                     MOVEL'MIDAS  ' W0MSGF                          CGL009
     C                     EXSR SRERRA                                    CGL009
     C                     ELSE                                           CGL009
      *                                                                   CGL009
      ** Format notified amount                                           CGL009
     C                     MOVEL*BLANK    ZFIELD                          CGL009
     C                     MOVE P#TOAM    ZFIELD                          CGL009
     C                     Z-ADDNCNBDP    ZADEC                           CGL009
     C                     EXSR ZEDIT                                     CGL009
     C                     MOVE ZFIELD    S1NDAM                          CGL009
     C                     MOVELS1NDAM    WNLAM                           CGL009
     C                     EXSR TSNULL                                    CGL009
     C           WNLNUL    IFEQ 'Y'                                       CGL009
     C                     MOVEL*BLANK    S1NDAM                          CGL009
     C                     ENDIF                                          CGL009
     C                     ENDIF                                          CGL009
     C                     ENDIF                                          CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
      ** Settlement amount is not blank                                   CGL009
     C                     ENDIF                                          CGL009
      ** Notified currency and settlement currency are different          CGL009
     C                     ENDIF                                          CGL009
      ** /OCMT/ for incomig payment                                       CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
     C           W0ACT     IFEQ '*OUT FT'                                 CGL009
     C                     MOVELWCWCY     S4PDCY                          CGL009
      ** We use the amount of :72: only if payment amount is blank        CGL009
     C           S4PYAM    IFEQ *BLANK                                    CGL009
     C                     MOVELWCWAM     S4PDAM                          CGL009
     C                     ELSE                                           CGL009
      *                                                                   CGL009
      ** Retrieve details of payment currency                             CGL009
     C                     MOVELS4PCCY    WCYCCY                          CGL009
     C                     MOVEL'N'       WCYDMP                          CGL009
     C                     EXSR RTCCYD                                    CGL009
     C           WCYRTN    IFEQ *BLANK                                    CGL009
     C                     Z-ADDWCYNDP    PCNBDP                          CGL009
      *                                                                   CGL009
      ** Retrieve details of delivery currency                            CGL009
     C                     MOVELS4PDCY    WCYCCY                          CGL009
     C                     MOVEL'N'       WCYDMP                          CGL009
     C                     EXSR RTCCYD                                    CGL009
     C           WCYRTN    IFEQ *BLANK                                    CGL009
     C                     Z-ADDWCYNDP    DCNBDP                          CGL009
      *                                                                   CGL009
      ** Format payment amount                                            CGL009
     C                     MOVEL*BLANK    ZFIELD                          CGL009
     C                     MOVE S4PYAM    ZFIELD                          CGL009
     C           13        SUB  PCNBDP    ZADIG                           CGL009
     C                     Z-ADDPCNBDP    ZADEC                           CGL009
     C                     EXSR ZALIGN                                    CGL009
     C                     MOVE ZFIELD    F4PYAM                          CGL009
      *                                                                   CGL009
      ** Convert the payment amount into the delivery currency            CGL009
     C                     CLEARP#0010                                    CGL009
     C                     Z-ADDWVLDT     P#FRDT                          CGL009
     C                     Z-ADDWVLDT     P#TODT                          CGL009
     C                     MOVELS4PCCY    P#FRCY                          CGL009
     C                     MOVE F4PYAM    P#FRAM                          CGL009
     C                     MOVELS4PDCY    P#TOCY                          CGL009
     C                     Z-ADD0         P#TOAM                          CGL009
     C                     Z-ADD0         P#RATE                          CGL009
     C                     CALL 'FT0010'                                  CGL009
     C                     PARM           P#0010                          CGL009
      *                                                                   CGL009
     C           P#RTCD    IFNE *BLANK                                    CGL009
     C                     MOVEL'FT0010  'W0FILE           ***************CGL009
     C                     MOVEL'*CALL  ' W0KEY            * DB ERROR 73 *CGL009
     C                     Z-ADD73        W0ERNB           ***************CGL009
     C                     MOVEL'MEM5003' W0MSGD                          CGL009
     C                     MOVEL'MIDAS  ' W0MSGF                          CGL009
     C                     EXSR SRERRA                                    CGL009
     C                     ELSE                                           CGL009
      *                                                                   CGL009
      ** Format delivery amount                                           CGL009
     C                     MOVEL*BLANK    ZFIELD                          CGL009
     C                     MOVE P#TOAM    ZFIELD                          CGL009
     C                     Z-ADDDCNBDP    ZADEC                           CGL009
     C                     EXSR ZEDIT                                     CGL009
     C                     MOVE ZFIELD    S4PDAM                          CGL009
     C                     MOVELS4PDAM    WNLAM                           CGL009
     C                     EXSR TSNULL                                    CGL009
     C           WNLNUL    IFEQ 'Y'                                       CGL009
     C                     MOVEL*BLANK    S4PDAM                          CGL009
     C                     ENDIF                                          CGL009
     C                     ENDIF                                          CGL009
     C                     ENDIF                                          CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
      ** Payment amount is not blank                                      CGL009
     C                     ENDIF                                          CGL009
      ** /OCMT/ for outgoing payment                                      CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
      ** code work  /OCMT/ present in :72:                                CGL009
     C                     ENDIF                                          CGL009
      ** CEU006 on                                                        CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
     C                     MOVEL'/RATE/'  WCW                             CGL009
     C                     MOVELFONT72    WCWLIN                          CGL009
     C                     EXSR CWRATE                                    CGL009
     C                     MOVELWCWRT     WNLAM                           CGL009
     C                     EXSR TSNULL                                    CGL009
     C           WNLNUL    IFEQ 'Y'                                       CGL009
     C                     MOVEL*BLANK    WCWRT                           CGL009
     C                     ELSE                                           CGL009
      ** Decimal places in FT are stored on 8 digits                      CGL009
      ** => truncated if greater                                          CGL009
     C           WCWDPT    IFGT 8                                         CGL009
     C           '.'       SCAN WCWRT     I       20                      CGL009
      ** Extract Digits + comma                                           CGL009
     C           I         SUBSTWCWRT:1   #014A  14 P                     CGL009
     C                     ADD  1         I       20                      CGL009
      ** Extract Decimals after comma                                     CGL009
     C           8         SUBSTWCWRT:I   #008A   8 P                     CGL009
     C           #014A     CAT  #008A:0   WCWRT     P                     CGL009
     C                     ENDIF                                          CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
     C           WCWRT     IFNE *BLANK                                    CGL009
      *                                                                   CGL009
     C                     MOVE WCWRT     S1RATE    P                     CGL009
     C                     MOVE WCWRT     S4RATE    P                     CGL009
      ** code work /RATE/ found in Bank to Bank information               CGL009
     C                     ENDIF                                          CGL009
      ** Bank to Bank information not blank                               CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
      ** Other Networks                                                   CGL009
     C                     OTHER                                          CGL009
     C           P72       IFEQ *BLANKS                                   CGL009
     C                     MOVEL*BLANKS   S2BTB                           CGL009
     C                     ELSE                                           CGL009
     C                     MOVELP72       DSTRAN                          CGL009
     C                     MOVELTMLIN     S2BTB                           CGL009
      *                                                                   CGL009
     C           CEU006    IFEQ 'Y'                                       CGL009
      *                                                                   CGL009
      **  Retrieve notified delivery currency and amount                  CGL009
      *                                                                   CGL009
      **  For MT103 FT field Notified Ccy/Amount is renamed as            CFT014
      **  Instructed Ccy/Amount.                                          CFT014
      **  The validation of this field will be changed                    CFT014
      **  accordingly.                                                    CFT014
     C           P33B      IFEQ *BLANK                                    CFT014
     C                     MOVEL'/OCMT/'  WCW                             CGL009
     C                     MOVELTMLIN     WCWLIN                          CGL009
     C                     EXSR CWAMCY                                    CGL009
     C                     MOVELWCWCY     S1NDCY                          CGL009
     C                     MOVELWCWCY     S4NDCY                          CGL009
     C                     MOVELWCWAM     S1NDAM                          CGL009
     C                     MOVELWCWAM     S4NDAM                          CGL009
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
     C                     END                                            CGL009
      *                                                                   CGL009
     C                     ENDSL                                          CGL009
      *                                                                   CGL009
      *                                                                   CGL009
     C/COPY WNCPYSRC,FT0300CP13                                           CGL009
      *                                                                   CGL009
     C           CSW209    IFEQ 'Y'                                                           CSW209
      *                                                                                       CSW209
      ** Mapping for Network                                                                  CSW209
      *                                                                                       CSW209
     C                     MOVELPNWRK     SANWRK                                              CSW209
     C                     MOVELPNWRK     SCNWRK                                              CSW209
      *                                                                                       CSW209
      ** Mapping for Message Type                                                             CSW209
      *                                                                                       CSW209
     C                     MOVELPMTPY     SAMTPY                                              CSW209
     C                     MOVELPMTPY     SCMTPY                                              CSW209
      *                                                                                       CSW209
      ** Mapping for Validation Flag                                                          CSW209
      *                                                                                       CSW209
     C                     MOVELP119      SAVALF                                              CSW209
     C                     MOVELP119      SCVALF                                              CSW209
      *                                                                                       CSW209
      ** Mapping for Ordering Customer (Cover)                                                CSW209
      *                                                                                       CSW209
     C           PB50      IFNE *BLANKS                                                       CSW209
     C                     MOVELPB50      DSTRAN                                              CSW209
     C                     MOVELTMLIN     SACOC                                               CSW209
     C                     MOVELTMLIN     SCCOC                                               CSW209
     C                     ELSE                                                               CSW209
     C                     MOVEL*BLANKS   INCOCT                                              CSW209
     C                     MOVEL*BLANKS   OPCOCT                                              CSW209
     C                     MOVEL*BLANKS   SACOC                                               CSW209
     C                     MOVEL*BLANKS   SCCOC                                               CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
      ** Mapping for Ordering Institution (Cover)                                             CSW209
      *                                                                                       CSW209
     C           PB52      IFNE *BLANKS                                                       CSW209
     C                     MOVELPB52      DSTRAN                                              CSW209
     C                     MOVELTMLIN     SACOB                                               CSW209
     C                     MOVELTMLIN     SCCOB                                               CSW209
     C                     ELSE                                                               CSW209
     C                     MOVEL*BLANKS   INCOBT                                              CSW209
     C                     MOVEL*BLANKS   OPCOBT                                              CSW209
     C                     MOVEL*BLANKS   SACOB                                               CSW209
     C                     MOVEL*BLANKS   SCCOB                                               CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
      ** Mapping for Intermediary Institution (Cover)                                         CSW209
      *                                                                                       CSW209
     C           PB56      IFNE *BLANKS                                                       CSW209
     C                     MOVELPB56      DSTRAN                                              CSW209
     C                     MOVELTMLIN     SACIB                                               CSW209
     C                     MOVELTMLIN     SCCIB                                               CSW209
     C                     ELSE                                                               CSW209
     C                     MOVEL*BLANKS   INCIBT                                              CSW209
     C                     MOVEL*BLANKS   OPCIBT                                              CSW209
     C                     MOVEL*BLANKS   SACIB                                               CSW209
     C                     MOVEL*BLANKS   SCCIB                                               CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
      ** Mapping for Account with Institution (Cover)                                         CSW209
      *                                                                                       CSW209
     C           PB57      IFNE *BLANKS                                                       CSW209
     C                     MOVELPB57      DSTRAN                                              CSW209
     C                     MOVELTMLIN     SACAB                                               CSW209
     C                     MOVELTMLIN     SCCAB                                               CSW209
     C                     ELSE                                                               CSW209
     C                     MOVEL*BLANKS   INCABT                                              CSW209
     C                     MOVEL*BLANKS   OPCABT                                              CSW209
     C                     MOVEL*BLANKS   SACAB                                               CSW209
     C                     MOVEL*BLANKS   SCCAB                                               CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
      ** Mapping for Beneficiary Customer (Cover)                                             CSW209
      *                                                                                       CSW209
     C           PB59      IFNE *BLANKS                                                       CSW209
     C                     MOVELPB59      DSTRAN                                              CSW209
     C                     MOVELTMLIN     SACBC                                               CSW209
     C                     MOVELTMLIN     SCCBC                                               CSW209
     C                     ELSE                                                               CSW209
     C                     MOVEL*BLANKS   INCBCT                                              CSW209
     C                     MOVEL*BLANKS   OPCBCT                                              CSW209
     C                     MOVEL*BLANKS   SACBC                                               CSW209
     C                     MOVEL*BLANKS   SCCBC                                               CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
      ** Mapping for Remittance Information (Cover)                                           CSW209
      *                                                                                       CSW209
     C           PB70      IFNE *BLANKS                                                       CSW209
     C                     MOVELPB70      DSTRAN                                              CSW209
     C                     MOVELTMLIN     SBCDP                                               CSW209
     C                     MOVELTMLIN     SDCDP                                               CSW209
     C                     ELSE                                                               CSW209
     C                     MOVEL*BLANKS   SBCDP                                               CSW209
     C                     MOVEL*BLANKS   SDCDP                                               CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
      ** Mapping for Sender to Receiver Information (Cover)                                   CSW209
      *                                                                                       CSW209
     C           PB72      IFNE *BLANKS                                                       CSW209
     C                     MOVELPB72      DSTRAN                                              CSW209
     C                     MOVELTMLIN     SBCBB                                               CSW209
     C                     MOVELTMLIN     SDCBB                                               CSW209
     C                     ELSE                                                               CSW209
     C                     MOVEL*BLANKS   SBCBB                                               CSW209
     C                     MOVEL*BLANKS   SDCBB                                               CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
      ** Mapping for Instructed Currency/Amount (Cover)                                       CSW209
      *                                                                                       CSW209
     C           PB33B     IFNE *BLANKS                                                       CSW209
     C                     MOVEL*BLANKS   DSTRAN                                              CSW209
     C                     MOVELPB33B     DSTRAN                                              CSW209
     C                     EXSR RTPCA                                                         CSW209
     C                     MOVELWCACY     SBCICY                                              CSW209
     C                     MOVELWCAAM     SBCIAM                                              CSW209
     C                     MOVELWCACY     SDCICY                                              CSW209
     C                     MOVELWCAAM     SDCIAM                                              CSW209
     C                     ELSE                                                               CSW209
     C                     MOVEL*BLANKS   SBCICY                                              CSW209
     C                     MOVEL*BLANKS   SBCIAM                                              CSW209
     C                     MOVEL*BLANKS   SDCICY                                              CSW209
     C                     MOVEL*BLANKS   SDCIAM                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
      ** Mapping specific for Outgoing Payments                                               CSW209
      *                                                                                       CSW209
     C           W0ACT     IFEQ '*OUT FT'                                                     CSW209
      *                                                                                       CSW209
      ** Outgoing Validation Flag (Main)                                                      CSW209
      *                                                                                       CSW209
     C                     MOVEL*BLANKS   SCOMVF                                              CSW209
      *                                                                                       CSW209
      ** Outgoing Validation Flag (Cover)                                                     CSW209
      *                                                                                       CSW209
     C                     MOVEL*BLANKS   SCOCVF                                              CSW209
      *                                                                                       CSW209
      ** Sender to Receiver Information (Cover A)                                             CSW209
      *                                                                                       CSW209
     C                     MOVEL*BLANKS   SDOCB                                               CSW209
      *                                                                                       CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
      * Mapping for OUTGOING PAYMENTS                                     CGL009
      *                                                                   CGL009
      *                                                                   CGL009
      * Set up the detail screen fields from the message.                 CGL009
      *                                                                   CGL009
      * Destination  and Account with Bank                                CGL009
     C                     SELEC                                          CGL009
      *                                                                   CGL009
      ** Special rule for FONTIS                                          CGL009
     C           PNWRK     WHEQ 'FONTIS'                                  CGL009
     C           W0ACT     IFEQ '*OUT FT'                                 CGL009
     C*                                                                   CGL009
     C                     MOVEL*BLANK    S4DST                           CGL009
     C*                                                                   CGL009
     C           P56       IFEQ *BLANK                                    CGL009
     C                     MOVELP57       DSTRAN                          CGL009
     C                     ELSE                                           CGL009
      *                                                                   CGL009
     C                     MOVELP56       DSTRAN                          CGL009
     C                     ENDIF                                          CGL009
     C*                                                                   CGL009
     C           1         SUBSTTRTAG:4   #001A   1                       CGL009
      ** Only applicable :56A:                                            CGL009
     C           #001A     IFEQ 'A'                                       CGL009
     C                     MOVELTMLIN1    #001A                           CGL009
     C           #001A     IFEQ '/'                                       CGL009
     C                     MOVEATMLIN2    @I35                            CGL009
     C                     ELSE                                           CGL009
     C                     MOVEATMLIN1    @I35                            CGL009
     C                     ENDIF                                          CGL009
     C                     EXSR SLSH35                                    CGL009
     C           8         SUBSTO35:1     W9BICC                          CGL009
     C           3         SUBSTO35:9     W9BICB                          CGL009
      *                                                                   CGL009
     C                     CALL 'ME1400'                                  CGL009
     C                     PARM *BLANKS   W9RTN   7                       CGL009
     C                     PARM           W9BICC  8                       CGL009
     C                     PARM           W9BICB  3                       CGL009
     C                     PARM           SDCUST                          CGL009
     C                     PARM           SDCNST                          CGL009
     C                     PARM           MEBICD                          CGL009
     C                     PARM *BLANKS   W9CUST  1                       CGL009
     C                     PARM *BLANKS   W9CNST  1                       CGL009
     C                     PARM *BLANKS   W9BICD  1                       CGL009
      *                                                                   CGL009
      * If Customer details found                                         CGL009
      *                                                                   CGL009
     C           W9CUST    IFEQ 'Y'                                       CGL009
     C           KNOST3    KLIST                                          CGL009
     C                     KFLD           S4PCCY                          CGL009
     C                     KFLD           BBCUST                          CGL009
     C           KNOST3    CHAINSDNOSTL3             90                   CGL009
     C           *IN90     IFEQ '0'                                       CGL009
     C                     MOVELA7CYCD    WNOCCY                          CGL009
     C                     MOVELA7NONB    WNONUM                          CGL009
     C                     MOVELDSNOST    S4DST1    P                     CGL009
     C                     ENDIF                                          CGL009
     C                     ENDIF                                          CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
     C           S4DST1    IFEQ *BLANK                                    CGL009
     C           S4PCCY    CHAINMEFNODL1             90                   CGL009
     C           *IN90     IFEQ '0'                                       CGL009
     C           CEU006    IFEQ 'Y'                                       CGL009
     C           FHEURO    IFEQ 'Y'                                       CGL009
     C***********BKEURO    CHAINMEFNODL1             90             CGL009175469
     C************IN90     IFEQ '0'                                 CGL009175469
     C                     MOVE *BLANKS   FHEUNO                          175469
     C           FHEUNO    IFNE *BLANK                                    175469
      ** The rate in /RATE/ is no longer applicable between Settlmt and   CGL009
      ** Payment amounts (now converted in BKEURO)                        CGL009
     C                     MOVEL*BLANK    S4RATE                          CGL009
      ** /OCMT/ is redundant                                              CGL009
     C                     MOVEL*BLANK    S4PDCY                          CGL009
     C                     MOVEL*BLANK    S4PDAM                          CGL009
      *                                                                   CGL009
     C           S4SMAM    IFNE *BLANK                                    CGL009
      ** Payment will be computed by the validation programm              CGL009
     C                     MOVEL*BLANK    S4PYAM                          CGL009
      ** Destination changes => payment currency changes                  CGL009
     C                     MOVELBKEURO    S4PCCY                          CGL009
      *                                                                   CGL009
     C                     ELSE                                           CGL009
      *                                                                   CGL009
      ** Convert the old payment amount into the EURO currency            CGL009
     C                     CLEARP#0010                                    CGL009
      ** Retrieve details of payment currency                             CGL009
     C                     MOVELS4PCCY    WCYCCY                          CGL009
     C                     MOVEL'N'       WCYDMP                          CGL009
     C                     EXSR RTCCYD                                    CGL009
     C           WCYRTN    IFNE *BLANK                                    CGL009
      ** Blank the amount to make the validation fail.                    CGL009
      ** (Unknown currency or both amounts null)                          CGL009
     C                     MOVEL*BLANK    S4PYAM                          CGL009
     C                     ELSE                                           CGL009
     C                     Z-ADDWCYNDP    PCNBDP                          CGL009
      *                                                                   CGL009
      ** Retrieve details of BKEURO currency                              CGL009
     C                     MOVELBKEURO    WCYCCY                          CGL009
     C                     MOVEL'N'       WCYDMP                          CGL009
     C                     EXSR RTCCYD                                    CGL009
     C           WCYRTN    IFNE *BLANK                                    CGL009
     C                     MOVELBKEURO    S4PCCY                          CGL009
     C                     MOVEL*BLANK    S4PYAM                          CGL009
     C                     ELSE                                           CGL009
     C                     Z-ADDWCYNDP    EUNBDP                          CGL009
      ** Format payment amount for FT0010                                 CGL009
     C                     MOVEL*BLANK    ZFIELD                          CGL009
     C                     MOVE S4PYAM    ZFIELD                          CGL009
     C           13        SUB  PCNBDP    ZADIG                           CGL009
     C                     Z-ADDPCNBDP    ZADEC                           CGL009
     C                     EXSR ZALIGN                                    CGL009
     C                     MOVE ZFIELD    F4PYAM                          CGL009
     C                     MOVE ZFIELD    P#FRAM                          CGL009
     C                     MOVELS4PCCY    P#FRCY                          CGL009
     C                     Z-ADDWVLDT     P#FRDT                          CGL009
     C                     Z-ADDWVLDT     P#TODT                          CGL009
     C                     MOVELBKEURO    P#TOCY                          CGL009
     C                     Z-ADD0         P#TOAM                          CGL009
     C                     Z-ADD0         P#RATE                          CGL009
     C                     CALL 'FT0010'                                  CGL009
     C                     PARM           P#0010                          CGL009
      *                                                                   CGL009
     C           P#RTCD    IFNE *BLANK                                    CGL009
     C                     MOVEL'FT0010  'W0FILE           ***************CGL009
     C                     MOVEL'*CALL  ' W0KEY            * DB ERROR 77 *CGL009
     C                     Z-ADD77        W0ERNB           ***************CGL009
     C                     MOVEL'MEM5003' W0MSGD                          CGL009
     C                     MOVEL'MIDAS  ' W0MSGF                          CGL009
     C                     EXSR SRERRA                                    CGL009
     C                     ELSE                                           CGL009
      *                                                                   170801
      * Move the original payment ccy and amount to pay delivery          170801
      * ccy and amount                                                    170801
     C                     MOVE S4PCCY    S4PDCY                          170801
     C                     MOVE S4PYAM    S4PDAM                          170801
      *                                                                   170801
      * Move the original payment ccy and amount to pay delivery          170801
      * ccy and amount                                                    170801
     C                     MOVE S4PCCY    S4PDCY                          170801
     C                     MOVE S4PYAM    S4PDAM                          170801
      *                                                                   CGL009
      ** Format BKEURO amount                                             CGL009
     C                     MOVEL*BLANK    ZFIELD                          CGL009
     C                     MOVE P#TOAM    ZFIELD                          CGL009
     C                     Z-ADDEUNBDP    ZADEC                           CGL009
     C                     EXSR ZEDIT                                     CGL009
     C                     MOVE ZFIELD    S4PYAM                          CGL009
     C                     MOVELS4PYAM    WNLAM                           CGL009
     C                     EXSR TSNULL                                    CGL009
     C           WNLNUL    IFEQ 'Y'                                       CGL009
     C                     MOVEL*BLANK    S4PYAM                          CGL009
     C                     ENDIF                                          CGL009
      ** Destination changes => payment currency changes                  CGL009
     C                     MOVELBKEURO    S4PCCY                          CGL009
      *                                                                   CGL009
      ** Convertion in BKEURO is successfull                              CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
      ** Details of BKEURO currency found                                 CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
      ** Details of payment currency found                                CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
      ** Settlement amount is not blank                                   CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
      ** Nostro default EURO found                                        CGL009
     C                     MOVELBKEURO    WNOCCY                          175469
     C                     MOVELFHEUNO    WNONUM                          175469
     C                     ELSE                                           175469
      ** Default EURO nostro not found                                    175469
     C                     MOVELFHCYCD    WNOCCY                          175469
     C                     MOVELFHNOSN    WNONUM                          175469
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
      ** Nostro default EURO flag is Y                                    CGL009
     C                     ELSE                                           175469
      ** Default nostro is not marked as EURO                             175469
     C                     MOVELFHCYCD    WNOCCY                          175469
     C                     MOVELFHNOSN    WNONUM                          175469
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
      ** CEU006 is on                                                     CGL009
     C                     ENDIF                                          CGL009
     C*********************MOVELFHCYCD    WNOCCY                    CGL009175469
     C*********************MOVELFHNOSN    WNONUM                    CGL009175469
     C                     MOVELDSNOST    S4DST1    P                     CGL009
      *                                                                   CGL009
      ** Nostro default found                                             CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
      ** Destination is still not filled                                  CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
      * Account with Bank (always filled)                                 CGL009
      *                                                                   CGL009
     C                     MOVELP57       DSTRAN                          CGL009
      ** Format FONTIS branch code                                        175477
     C                     EXSR FONBNK                                    175477
     C                     MOVELTMLIN     S5ACB                           CGL009
      ** Alter the existing tag value in case non translated part is      175477
      ** used in S/R SROSWT SROCLR                                        175477
     C                     MOVELDSTRAN    P57                             175477
      ** W0ACT : outgoing payment                                         CGL009
     C                     ENDIF                                          CGL009
      ** Other networks                                                   CGL009
     C                     OTHER                                          CGL009
      *                                                                   CGL009
      * If Intermediary Bank is blank, use 'A/c with Institution'         CGL009
      * details, otherwise use Intermediary Bank details                  CGL009
      *                                                                   CGL009
     C           P56       IFEQ *BLANKS                                   CGL009
      *                                                                   CGL009
     C           P57       IFNE *BLANKS                                   CGL009
     C                     MOVELP57       DSTRAN                          CGL009
     C                     MOVELTMLIN     S4DST                           CGL009
     C                     END                                            CGL009
      *                                                                   CGL009
     C                     ELSE                                           CGL009
      *                                                                   CGL009
      * Intermediary Bank entered                                         CGL009
      *                                                                   CGL009
     C                     MOVELP56       DSTRAN                          CGL009
     C                     MOVELTMLIN     S4DST                           CGL009
     C                     ENDIF                                                              248105
      *                                                                   CGL009
      * Account with Bank (only filled if Intermediary Bank exist)        CGL009
      *                                                                   CGL009
     C           P57       IFNE *BLANKS                                   CGL009
     C                     MOVELP57       DSTRAN                          CGL009
     C                     MOVELTMLIN     S5ACB                           CGL009
     C                     END                                            CGL009
      *                                                                   CGL009
     C**********           END                                                         CGL009 248105
      *                                                                   CGL009
     C                     ENDSL                                          CGL009
      *                                                                   CGL009
      * Ordering Bank file fields                                         CGL009
     C                     SELEC                                          CGL009
      *                                                                   CGL009
      ** Special rule for FONTIS                                          CGL009
     C           PNWRK     WHEQ 'FONTIS'                                  CGL009
     C/COPY WNCPYSRC,FT0300MM02                                           CFT002
      ** Ordering bank is never filled with FONTIS                        CGL009
      *                                                                   CGL009
      ** Other networks                                                   CGL009
     C                     OTHER                                          CGL009
      *                                                                   CGL009
      * If Ordering Institution not blank, use it                         CGL009
      * otherwise use Sender details                                      CGL009
      *                                                                   CGL009
     C           P52       IFNE *BLANKS                                   CGL009
     C                     MOVELP52       DSTRAN                          CGL009
     C                     MOVELTMLIN1    OPORB1                          CGL009
     C                     MOVELTMLIN2    OPORB2                          CGL009
     C                     MOVELTMLIN3    OPORB3                          CGL009
     C                     MOVELTMLIN4    OPORB4                          CGL009
     C                     MOVELTMLIN5    OPORB5                          CGL009
      *                                                                   CGL009
      * If network is swift, find field type                              CGL009
      * otherwise default it to 'A'.                                      CGL009
      *                                                                   CGL009
     C           PNWRK     IFEQ 'SWIFT '                                  CGL009
      *                                                                   CGL009
      * Set up field type, if A->S, B->A, D->A                            CGL009
      *                                                                   CGL009
     C           1         SUBSTTRTAG:4   #WK1    1                       CGL009
     C           #WK1      IFEQ 'A'                                       CGL009
     C                     MOVEL'S'       OPORBT                          CGL009
     C                     ELSE                                           CGL009
      *                                                                   CGL009
     C           #WK1      IFEQ 'B'                                       CGL009
     C                     MOVEL'A'       OPORBT                          CGL009
     C                     ELSE                                           CGL009
     C                     MOVEL'A'       OPORBT                          CGL009
     C                     END                                            CGL009
     C                     END                                            CGL009
      *                                                                   CGL009
     C                     ELSE                                           CGL009
      *                                                                   CGL009
      * network is not swift                                              CGL009
      *                                                                   CGL009
     C                     MOVEL'A'       OPORBT                          CGL009
     C                     END                                            CGL009
      *                                                                   CGL009
     C                     ELSE                                           CGL009
      *                                                                   CGL009
      * Sender details                                                    CGL009
      *                                                                   CGL009
     C                     MOVELPSNDR     OPORB1                          CGL009
      *                                                                   CGL009
      * If network is swift, set up field type to 'S'                     CGL009
      * otherwise default it to 'U'.                                      CGL009
      *                                                                   CGL009
     C           PNWRK     IFEQ 'SWIFT '                                  CGL009
     C                     MOVEL'S'       OPORBT                          CGL009
     C                     ELSE                                           CGL009
     C                     MOVEL'A'       OPORBT                          CGL009
     C                     END                                            CGL009
      *                                                                   CGL009
     C                     END                                            CGL009
      *                                                                   CGL009
     C                     ENDSL                                          CGL009
      *                                                                   CGL009
      * Ordering Bank                                                     CGL009
      *                                                                   CGL009
      * If Third Reimbursement Institution is not blank, use it           CFT014
      * otherwise                                                         CFT014
      * If Receivers Correspondent is not blank, use it                   CGL009
      * otherwise use Senders Correspondent. If both are blank            CGL009
      * use Sender details.                                               CGL009
      *                                                                   CGL009
     C/COPY WNCPYSRC,FT0300MM03
     C           P55       IFNE *BLANKS                                   CGL009
      *                                                                   CGL009
     C                     MOVELP55       DSTRAN                          CGL009
     C                     MOVELTMLIN1    S4ORBK                          CFT014
      *                                                                   CGL009
     C                     ELSE                                           CGL009
      *                                                                   CGL009
     C           P54       IFNE *BLANKS                                   CGL009
      *                                                                   CGL009
     C                     MOVELP54       DSTRAN                          CGL009
     C                     MOVELTMLIN1    S4ORBK                          CFT014
      *                                                                   CGL009
     C                     ELSE                                           CGL009
      *                                                                   CGL009
     C           P53       IFNE *BLANKS                                   CGL009
     C                     MOVELP53       DSTRAN                          CGL009
     C                     MOVELTMLIN1    S4ORBK                          CFT014
      *                                                                   CGL009
     C                     ELSE                                           CGL009
     C                     MOVELPSN       DSTRAN                          CFT014
     C                     MOVELTMLIN1    S4ORBK                          CFT014
      *                                                                   CGL009
     C                     END                                            CGL009
     C                     END                                            CGL009
     C                     ENDIF                                          CFT014
     C/COPY WNCPYSRC,FT0300MM04
      *                                                                   CGL009
      * Beneficiary already done in INCOMING MAPPING                      CGL009
      *                                                                   CGL009
      *                                                                   CGL009
      * Msg Unique Reference                                              CGL009
      *                                                                   CGL009
     C                     Z-ADDPHMSGR    OPMSGR                          CGL009
      *                                                                   CGL009
      * Part Number                                                       CGL009
      *                                                                   CGL009
     C                     Z-ADDPHPART    OPKPRT                          CGL009
      *                                                                   CGL009
      * Related Reference                                                 CGL009
      *                                                                   CGL009
      * If MT100 type of message use Transaction Reference no.            CGL009
      * otherwise use related referance.                                  CGL009
      *                                                                   CGL009
     C           PMTPY     IFEQ '100'                                     CGL009
     C           PMTPY     OREQ '202'                                                         255350
     C/COPY WNCPYSRC,FT0300C061
      *                                                                   CGL009
     C           P20       IFNE *BLANKS                                   CGL009
     C                     MOVELP20       DSTRAN                          CGL009
     C                     MOVELTTREF     S6RLRF                          CGL009
     C                     MOVELTTREF     S3RLRF                          MK0550
     C                     END                                            CGL009
      *                                                                   CGL009
     C                     ELSE                                           CGL009
      *                                                                   CGL009
     C           P21       IFNE *BLANKS                                   CGL009
     C                     MOVELP21       DSTRAN                          CGL009
     C                     MOVELTTREF     S6RLRF                          CGL009
     C                     MOVELTTREF     S3RLRF                          MK0550
     C                     END                                            CGL009
      *                                                                   CGL009
     C                     END                                            CGL009
      *                                                                   CGL009
      **  Additional Mapping for CASHIER                                  CGL009
      *                                                                   CGL009
      **  Draft Currency, Draft Amount                                    CGL009
      *                                                                   CGL009
     C           SDCA      IFNE *BLANKS                                   CGL009
     C           PNWRK     ANDEQ'CASHV8'                                  ESL038
     C                     Z-ADD0         TVVDAT                          CGL009
     C                     MOVELSDCA      DSTRAN                          CGL009
      *                                                                   CGL009
     C           TVVDAT    IFNE 0                                         CGL009
      *                                                                   CGL009
      ** MMDDYY format display                                            CGL009
      *                                                                   CGL009
     C           WUDFF     IFEQ 'M'                                       CGL009
     C                     MOVELTVVDAT    SWDT1   6                       CGL009
     C           2         SUBSTSWDT1:5   MM                              CGL009
     C           2         SUBSTSWDT1:3   DD                              CGL009
     C           2         SUBSTSWDT1:1   YY                              CGL009
     C                     MOVELSWDT2     S1PVDT                          CGL009
     C                     MOVELSWDT2     S4PVDT                          CGL009
     C                     ELSE                                           CGL009
      *                                                                   CGL009
      ** DDMMYY format display                                            CGL009
      *                                                                   CGL009
     C                     MOVELTVVDAT    SWDT1   6                       CGL009
     C           2         SUBSTSWDT1:5   DD                              CGL009
     C           2         SUBSTSWDT1:3   MM                              CGL009
     C           2         SUBSTSWDT1:1   YY                              CGL009
     C                     MOVELSWDT2     S1PVDT                          CGL009
     C                     MOVELSWDT2     S4PVDT                          CGL009
     C                     END                                            CGL009
     C                     END                                            CGL009
      *                                                                   CGL009
      ** Currency                                                         CGL009
      *                                                                   CGL009
      ** Translate currency to Midas currency if it is a different                            225169
      ** SWIFT currency code.                                                                 225169
      *                                                                                       225169
     C                     MOVE TVCCY     WCCY                                                225169
     C                     EXSR WTRNCY                                                        225169
     C                     MOVE WCCY      TVCCY                                               225169
      *                                                                                       225169
     C                     MOVELTVCCY     S1PCCY                          CGL009
     C                     MOVELTVCCY     S4PCCY                          CGL009
      *                                                                   CGL009
      ** Format amount field (change ',' decimal point to '.').           CGL009
      *                                                                   CGL009
     C                     MOVEA*BLANKS   YA1                             CGL009
     C                     MOVEATVAMT     YA1                             CGL009
     C                     Z-ADD1         C       30                      CGL009
      *                                                                   CGL009
     C           C         DOUGT15                                        CGL009
     C           YA1,C     IFEQ ','                                       CGL009
     C                     MOVE '.'       YA1,C                           CGL009
     C                     Z-ADD16        C                               CGL009
     C                     ELSE                                           CGL009
     C                     ADD  1         C                               CGL009
     C                     END                                            CGL009
     C                     END                                            CGL009
      *                                                                   CGL009
     C                     MOVEAYA1       AMT    15                       CGL009
     C                     MOVELAMT       S1PYAM                          CGL009
     C                     MOVELAMT       S4PYAM                          CGL009
     C                     END                                            CGL009
      *                                                                   CGL009
      **  Funding Currency, Funding Amount                                CGL009
      *                                                                   CGL009
     C           PDC2      IFNE *BLANKS                                   CGL009
     C                     Z-ADD0         TVVDAT                          CGL009
     C                     MOVELPDC2      DSTRAN                          CGL009
      *                                                                   CGL009
     C           TVVDAT    IFNE 0                                         CGL009
      *                                                                   CGL009
      ** MMDDYY format display                                            CGL009
      *                                                                   CGL009
     C           WUDFF     IFEQ 'M'                                       CGL009
     C                     MOVELTVVDAT    SWDT1   6                       CGL009
     C           2         SUBSTSWDT1:5   MM                              CGL009
     C           2         SUBSTSWDT1:3   DD                              CGL009
     C           2         SUBSTSWDT1:1   YY                              CGL009
     C                     MOVELSWDT2     S1SLDT                          CGL009
     C                     MOVELSWDT2     S4SLDT                          CGL009
     C                     ELSE                                           CGL009
      *                                                                   CGL009
      ** DDMMYY format display                                            CGL009
      *                                                                   CGL009
     C                     MOVELTVVDAT    SWDT1   6                       CGL009
     C           2         SUBSTSWDT1:5   DD                              CGL009
     C           2         SUBSTSWDT1:3   MM                              CGL009
     C           2         SUBSTSWDT1:1   YY                              CGL009
     C                     MOVELSWDT2     S1SLDT                          CGL009
     C                     MOVELSWDT2     S4SLDT                          CGL009
     C                     END                                            CGL009
     C                     END                                            CGL009
      *                                                                   CGL009
      ** Currency                                                         CGL009
      *                                                                   CGL009
      ** Translate currency to Midas currency if it is a different                            225169
      ** SWIFT currency code.                                                                 225169
      *                                                                                       225169
     C                     MOVE TVCCY     WCCY                                                225169
     C                     EXSR WTRNCY                                                        225169
     C                     MOVE WCCY      TVCCY                                               225169
      *                                                                                       225169
     C                     MOVELTVCCY     S1SMCY                          CGL009
     C                     MOVELTVCCY     S4SMCY                          CGL009
      *                                                                   CGL009
      ** Format amount field (change ',' decimal point to '.').           CGL009
      *                                                                   CGL009
     C                     MOVEA*BLANKS   YA1                             CGL009
     C                     MOVEATVAMT     YA1                             CGL009
     C                     Z-ADD1         C       30                      CGL009
      *                                                                   CGL009
     C           C         DOUGT15                                        CGL009
     C           YA1,C     IFEQ ','                                       CGL009
     C                     MOVE '.'       YA1,C                           CGL009
     C                     Z-ADD16        C                               CGL009
     C                     ELSE                                           CGL009
     C                     ADD  1         C                               CGL009
     C                     END                                            CGL009
     C                     END                                            CGL009
      *                                                                   CGL009
     C                     MOVEAYA1       AMT    15                       CGL009
     C                     MOVELAMT       S1SMAM                          CGL009
     C                     MOVELAMT       S4SMAM                          CGL009
     C                     END                                            CGL009
      *                                                                   CGL009
      **  Rate  for other networks                                        CGL009
      *                                                                   CGL009
      ** FONTIS has its own rules to determine the rate                   CGL009
     C           PNWRK     IFNE 'FONTIS'                                  CGL009
      *                                                                   CGL009
     C           S1PYAM    IFNE *BLANKS                                   CGL009
     C           S1SMAM    ANDNE*BLANKS                                   CGL009
     C*                                                                   CGL009
     C** Get the numeric value of S1PYAM                                  CGL009
     C*                                                                   CGL009
     C                     CALL 'AOCURRR0'                                CGL009
     C                     PARM *BLANKS   @RTCD   7                       CGL009
     C                     PARM '*KEY   ' @OPTN   7                       CGL009
     C                     PARM S1PCCY    @CURR   3                       CGL009
     C           SDCURR    PARM SDCURR    DSSDY                           CGL009
      *                                                                   CGL009
     C           @RTCD     IFNE *BLANKS                                   CGL009
     C                     MOVEL'AOCURRR0'W0FILE                          CGL009
     C                     MOVEL'*CALL'   W0KEY            ***************CGL009
     C                     Z-ADD36        W0ERNB           * DB ERROR 36 *CGL009
     C                     MOVEL'MEM5003' W0MSGD           ***************CGL009
     C                     MOVEL'MIDAS  ' W0MSGF                          CGL009
     C                     EXSR SRERRA                                    CGL009
     C                     END                                            CGL009
     C                     Z-ADDA6NBDP    WPNDP   10                      CGL009
     C                     MOVELA6MDIN    WPMDI   1                       CGL009
      *                                                                   CGL009
      **  Align amount                                                    CGL009
     C                     Z-ADDWPNDP     ZADEC                           CGL009
     C           11        SUB  WPNDP     ZADIG                           CGL009
     C                     MOVEL*BLANK    ZFIELD                          CGL009
     C                     MOVE S1PYAM    ZFIELD                          CGL009
     C                     EXSR ZALIGN                                    CGL009
     C                     MOVE ZFIELD    WPYAM1 110                      CGL009
     C*                                                                   CGL009
     C** Get the numeric value of S1SMAM                                  CGL009
     C*                                                                   CGL009
     C                     CALL 'AOCURRR0'                                CGL009
     C                     PARM *BLANKS   @RTCD   7                       CGL009
     C                     PARM '*KEY   ' @OPTN   7                       CGL009
     C                     PARM S1SMCY    @CURR   3                       CGL009
     C           SDCURR    PARM SDCURR    DSSDY                           CGL009
      *                                                                   CGL009
     C           @RTCD     IFNE *BLANKS                                   CGL009
     C                     MOVEL'AOCURRR0'W0FILE                          CGL009
     C                     MOVEL'*CALL'   W0KEY            ***************CGL009
     C                     Z-ADD37        W0ERNB           * DB ERROR 37 *CGL009
     C                     MOVEL'MEM5003' W0MSGD           ***************CGL009
     C                     MOVEL'MIDAS  ' W0MSGF                          CGL009
     C                     EXSR SRERRA                                    CGL009
     C                     END                                            CGL009
     C                     Z-ADDA6NBDP    WSNDP   10                      CGL009
     C                     MOVELA6MDIN    WSMDI   1                       CGL009
      *                                                                   CGL009
      **  Align amount                                                    CGL009
     C                     Z-ADDWSNDP     ZADEC                           CGL009
     C           11        SUB  WSNDP     ZADIG                           CGL009
     C                     MOVEL*BLANK    ZFIELD                          CGL009
     C                     MOVE S1SMAM    ZFIELD                          CGL009
     C                     EXSR ZALIGN                                    CGL009
     C                     MOVE ZFIELD    WSMAM1 110                      CGL009
      *                                                                   CGL009
     C           WPYAM1    IFNE 0                                         CGL009
     C           WSMAM1    ANDNE0                                         CGL009
      *                                                                   CGL009
      ** Calculate the rate                                               CGL009
      *                                                                   CGL009
     C           S1SMCY    IFNE S1PCCY                                    CGL009
      *                                                                   CGL009
     C                     Z-ADD1         @Z      10                      CGL009
     C                     Z-ADD0         @EXRT  138                      CGL009
     C                     MOVELWPMDI     ZMDI1   1                       CGL009
     C                     MOVELS1PCCY    @CCY                            CGL009
     C                     EXSR RTCCYS                                    CGL009
      *                                                                   CGL009
     C           S1PCCY    LOKUPTCY,@Z                   48               CGL009
      *                                                                   CGL009
     C           *IN48     IFEQ '1'                                       CGL009
     C           PNWRK     ANDEQ'FONTIS'                                  STP014
     C                     EXSR LDXRAR                                    CGL009
      *                                                                   CGL009
     C           PMTPY     IFEQ 'DIC'                                     CGL009
     C                     Z-ADDBCR,@Z    ZRATE1 138                      CGL009
     C                     ELSE                                           CGL009
     C                     Z-ADDBTR,@Z    ZRATE1                          CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
     C                     ELSE                                           CGL009
     C                     Z-ADDTRT,@I    ZRATE1                          CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
     C                     Z-ADD1         @Z      10                      CGL009
     C                     MOVELWSMDI     ZMDI2   1                       CGL009
     C                     MOVELS1SMCY    @CCY                            CGL009
     C                     EXSR RTCCYS                                    CGL009
      *                                                                   CGL009
     C           S1SMCY    LOKUPTCY,@Z                   48               CGL009
      *                                                                   CGL009
     C           *IN48     IFEQ '1'                                       CGL009
     C           PNWRK     ANDEQ'FONTIS'                                  STP014
     C                     EXSR LDXRAR                                    CGL009
      *                                                                   CGL009
     C           PMTPY     IFEQ 'DIC'                                     CGL009
     C                     Z-ADDSCR,@Z    ZRATE2 138                      CGL009
     C                     ELSE                                           CGL009
     C                     Z-ADDSTR,@Z    ZRATE2                          CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
     C                     ELSE                                           CGL009
     C                     Z-ADDTRT,@I    ZRATE2                          CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
     C                     EXSR ZXRATE                                    CGL009
      *                                                                   CGL009
     C                     Z-ADDZRATEX    @EXRT                           CGL009
      *                                                                   CGL009
     C                     ELSE                                           CGL009
     C                     Z-ADD1         @EXRT                           CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
      ** Format rate field                                                CGL009
      *                                                                   CGL009
     C                     Z-ADD@EXRT     WRATE1 117                      CGL009
     C                     MOVE WRATE1    ZFIELD                          CGL009
     C                     Z-ADD7         ZADEC                           CGL009
     C                     EXSR ZEDIT                                     CGL009
     C                     MOVE ZFIELD    S1RATE                          CGL009
     C                     MOVE ZFIELD    S4RATE                          CGL009
     C                     END                                            CGL009
      *                                                                   CGL009
     C                     END                                            CGL009
      *                                                                   CGL009
      ** End of PNWRK IFNE 'FONTIS'                                       CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
      *                                                                   CFT014
      ** Bank Operation Code                                              CFT014
     C           P23B      IFNE *BLANKS                                   CFT014
     C                     MOVEL*BLANK    DSTRAN                          CFT014
     C                     MOVELP23B      DSTRAN                          CFT014
     C                     MOVELTTREF     S5BNCD                          CFT014
     C                     MOVELTTREF     S3BOCD                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Instruction Code                                                 CFT014
     C           P23E      IFNE *BLANKS                                   CFT014
     C/COPY WNCPYSRC,FT0300MK03
     C                     MOVEL*BLANK    DSTRAN                          CFT014
     C                     MOVELP23E      DSTRAN                          CFT014
     C                     MOVELTMLIN1    S6INC1                          CFT014
     C                     MOVELTMLIN2    S6INC2                          CFT014
     C                     MOVELTMLIN3    S6INC3                          CFT014
     C                     MOVELTMLIN4    S6INC4                          CFT014
     C                     MOVELTMLIN5    S6INC5                          CFT014
     C/COPY WNCPYSRC,FT0300MK04
     C                     MOVELTMLIN1    S3ICD1                          CFT014
     C                     MOVELTMLIN2    S3ICD2                          CFT014
     C                     MOVELTMLIN3    S3ICD3                          CFT014
     C                     MOVELTMLIN4    S3ICD4                          CFT014
     C                     MOVELTMLIN5    S3ICD5                          CFT014
     C/COPY WNCPYSRC,FT0300MK10
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Transaction Code                                                 CFT014
     C           P26T      IFNE *BLANKS                                   CFT014
     C                     MOVEL*BLANK    DSTRAN                          CFT014
     C                     MOVELP26T      DSTRAN                          CFT014
     C                     MOVELTTREF     S5TTCD                          CFT014
     C                     MOVELTTREF     S3TTCD                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                                       CER030
      ** Populate Transaction Type based on Trans Code                                        CER030
      *                                                                                       CER030
     C           CER030    IFEQ 'Y'                                                           CER030
     C           CGL013    OREQ 'Y'                                                           CER030
      *                                                                                       CER030
     C           P26T      IFNE *BLANKS                                                       CER030
      *                                                                                       CER030
     C           S3TTCD    IFNE *BLANKS                                                       CER030
     C           WIRTTY    ANDEQ*BLANKS                                                       CER030
      *                                                                                       CER030
     C                     MOVEL*BLANKS   WNTTI  10                                           CER030
     C                     MOVELS3TTCD    WNTTI                                               CER030
      *                                                                                       CER030
     C           WNTTI     CHAINSDNTTIL1             91                                       CER030
      *                                                                                       CER030
     C           *IN91     IFEQ *OFF                                                          CER030
     C                     MOVELNIRTTY    WIRTTY  5                                           CER030
     C                     ELSE                                                               CER030
     C                     MOVEL*BLANKS   WIRTTY                                              CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           S5TTCD    IFNE *BLANKS                                                       CER030
     C           WORTTY    ANDEQ*BLANKS                                                       CER030
      *                                                                                       CER030
     C                     MOVEL*BLANKS   WNTTI                                               CER030
     C                     MOVELS5TTCD    WNTTI                                               CER030
      *                                                                                       CER030
     C           WNTTI     CHAINSDNTTIL1             91                                       CER030
      *                                                                                       CER030
     C           *IN91     IFEQ *OFF                                                          CER030
     C                     MOVELNIRTTY    WORTTY  5                                           CER030
     C                     ELSE                                                               CER030
     C                     MOVEL*BLANKS   WORTTY                                              CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                   CFT014
      ** Instructed Currency/Amount                                       CFT014
     C           P33B      IFNE *BLANKS                                   CFT014
     C                     MOVEL*BLANK    DSTRAN                          CFT014
     C                     MOVELP33B      DSTRAN                          CFT014
     C                     EXSR RTPCA                                     CFT014
     C                     MOVELWCACY     S4PDCY                          CFT014
     C                     MOVELWCAAM     S4PDAM                          CFT014
     C                     MOVELWCACY     S1NDCY                          CFT014
     C                     MOVELWCAAM     S1NDAM                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Original Rate Currency/Amount                                    CFT014
     C           P36       IFNE *BLANKS                                   CFT014
     C                     MOVEL*BLANK    DSTRAN                          CFT014
     C                     MOVELP36       DSTRAN                          CFT014
     C                     EXSR RT36                                      CFT014
     C                     MOVELW36RT     S1OEXR                          CFT014
     C                     MOVELW36RT     S4OEXR                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Regulatory Reporting                                             CFT014
     C           P77B      IFNE *BLANKS                                   CFT014
     C                     MOVEL*BLANK    DSTRAN                          CFT014
     C                     MOVELP77B      DSTRAN                          CFT014
     C                     MOVELTMLIN1    S3RRP1                          CFT014
     C                     MOVELTMLIN2    S3RRP2                          CFT014
     C                     MOVELTMLIN3    S3RRP3                          CFT014
     C                     MOVELTMLIN1    S6RRP1                          CFT014
     C                     MOVELTMLIN2    S6RRP2                          CFT014
     C                     MOVELTMLIN3    S6RRP3                          CFT014
     C                     ENDIF                                          CFT014
     C/COPY WNCPYSRC,FT0300MK05
      *                                                                   CFT014
      ** Third Reimbursement Party                                        CFT014
     C           W0ACT     IFEQ '*INC FT '                                CFT014
     C           P55       IFNE *BLANKS                                   CFT014
     C                     MOVELP55       DSTRAN                          CFT014
      ** Map Screen field to be validated                                 CFT014
     C                     MOVELTMLIN1    S1TRIB                          CFT014
      ** Map network field                                                CFT014
     C                     MOVELTMLIN1    INTRI1                          CFT014
     C                     MOVELTMLIN2    INTRI2                          CFT014
     C                     MOVELTMLIN3    INTRI3                          CFT014
     C                     MOVELTMLIN4    INTRI4                          CFT014
     C                     MOVELTMLIN5    INTRI5                          CFT014
      *                                                                   CFT014
     C           CFT004    IFEQ 'Y'                                       CFT014
      ** Check whether the field carry an IBAN                            CFT014
      ** If it is the case, move the IBAN into the 'screen' field         CFT014
      ** which will be validated afterwards                               CFT014
      *                                                                   CFT014
      ** We do this kind of checking here (instead of within the          CFT014
      ** validation) because S1TRIB is 34 char longs and INTRI1           CFT014
      ** is 35 long ('/' + 34 char); we don't want a valid Iban           CFT014
      ** to be truncated.                                                 CFT014
     C                     MOVEL*BLANK    P@IBN2                          CFT014
     C                     MOVEAINTRI1    @I35                            CFT014
     C                     EXSR SLSH35                                    CFT014
     C                     MOVEA@O35      P@IBN2                          CFT014
     C* Check that it is a valid IBAN                                     CFT014
     C                     MOVE *BLANKS   DSSDY                           CFT014
     C                     CALL 'AOIBANR2'                                CFT014
     C                     PARM           @RTCD                           CFT014
     C                     PARM           P@IBN2                          CFT014
     C           P@ACCN    PARM           DSSDY                           CFT014
      *                                                                   CFT014
      * Network information is mapped onto the 'screen' field             CFT014
     C           @RTCD     IFEQ *BLANKS                                   CFT014
     C                     MOVEL*BLANK    S1TRIB                          CFT014
      ** '/' has been removed                                             CFT014
     C                     MOVELP@IBN2    S1TRIB                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   MK0513
     C           L82       IFNE *BLANKS                                   MK0513
     C                     MOVELL82       DSTRAN                          MK0513
     C                     MOVELTMLIN1    S1RATE                          MK0513
     C                     MOVELTMLIN1    S4RATE                          MK0513
     C                     ENDIF                                          MK0513
      *                                                                   PL0001
      * Add copy hook for setting up Sender's correspondent               PL0001
     C/COPY WNCPYSRC,FT0300D001                                           PL0001
      *                                                                   CGL009
      *  Unwind subroutine stack name                                     CGL009
      *                                                                   CGL009
     C           EXMAP     TAG                                            CGL009
     C                     MOVEA*BLANKS   @STK,Q                          CGL009
     C                     SUB  1         Q                               CGL009
      *                                                                   CGL009
     C                     ENDSR                                          CGL009
      /EJECT                                                              CGL009
      *================================================================   163446
      *  Default routing when no rules has been hit in ME1501             163446
      *================================================================   163446
      *                                                                   163446
     C           SRDFLT    BEGSR                                          163446
      *                                                                   163446
      *  Set up subroutine stack name                                     163446
      *                                                                   163446
     C                     ADD  1         Q                               163446
     C                     MOVEL'SRDFLT'  @STK,Q                          163446
     C/COPY WNCPYSRC,FT0300C056
      *                                                                   163446
      ** We apply the default routing ONLY if no rules have been hit      163446
     C           PRTN      IFEQ 'MIN0096'                                 163446
     C                     GOTO EXDFLT                                    163446
     C                     ENDIF                                          163446
      *                                                                   163446
     C                     MOVEL*BLANKS   W0ACT                           163446
      *                                                                   163446
     C                     SELEC                                          163446
      *                                                                   CGL009
      ** For FONTIS                                                       CGL009
     C           PNWRK     WHEQ 'FONTIS'                                  CGL009
     C           CGL009    IFEQ 'Y'                                       CGL009
     C                     MOVELP57       DSTRAN                          CGL009
     C           TMLIN     IFNE *BLANK                                    CGL009
     C           TMLIN1    IFEQ F8BKID                                    CGL009
     C                     MOVEL'*INC FT' W0ACT                           CGL009
     C                     ELSE                                           CGL009
     C                     MOVEL'*OUT FT' W0ACT                           CGL009
     C                     ENDIF                                          CGL009
     C                     ELSE                                           CGL009
     C                     MOVEL'*OUT FT' W0ACT                           CGL009
     C                     ENDIF                                          CGL009
     C                     ENDIF                                          CGL009
      ** For CASHIER interface                                            163446
     C           PNWRK     WHEQ 'CASHV8'                                  163446
     C                     MOVEL*BLANKS   W0ACT                           163446
     C                     MOVEL'*INC FT' W0ACT                           163446
      *                                                                   163446
      ** Other Network                                                    163446
      ** <---- put here the default action when no rules has been hit     163446
     C                     OTHER                                          163446
      *                                                                   163446
     C                     ENDSL                                          163446
      *                                                                   163446
      *  Unwind subroutine stack name                                     163446
      *                                                                   163446
     C           EXDFLT    TAG                                            163446
     C                     MOVEA*BLANKS   @STK,Q                          163446
     C                     SUB  1         Q                               163446
      *                                                                   163446
     C                     ENDSR                                          163446
      /EJECT                                                              163446
      *================================================================   CFT014
      *  Overwrite transaction amount                                     CFT014
      *================================================================   CFT014
      *                                                                   CFT014
     C           OV32AM    BEGSR                                          CFT014
      *                                                                   CFT014
      *  Set up subroutine stack name                                     CFT014
      *                                                                   CFT014
     C                     ADD  1         Q                               CFT014
     C                     MOVEL'OV32AM'  @STK,Q                          CFT014
      *                                                                   CFT014
      ** Inputs                                                           CFT014
      ** ------                                                           CFT014
      ** Input amount                                                     CFT014
     C           *LIKE     DEFN W32AM     WOVIAM                          CFT014
      ** Input currency                                                   CFT014
     C           *LIKE     DEFN W32CY     WOVICY                          CFT014
      ** Receiver's Charges amount                                        CFT014
     C           *LIKE     DEFN W32AM     WOVRAM                          CFT014
      ** Receiver's Charges currency                                      CFT014
     C           *LIKE     DEFN W32CY     WOVRCY                          CFT014
      ** Operation                                                        CFT014
     ***                                  WOVOPR                          CFT014
      ** Value date                                                       CFT014
     C           *LIKE     DEFN W32DYN    WOVVLD                          CFT014
      ** Outputs                                                          CFT014
      ** -------                                                          CFT014
      ** Amount overwritten                                               CFT014
     C           *LIKE     DEFN W32AM     WOVAMT                          CFT014
      ** Temporary variables                                              CFT014
      ** -------------------                                              CFT014
      ** Transaction amount numeric format                                CFT014
     C           *LIKE     DEFN P#TOAM    WOVTAN                          CFT014
      ** Receiver's charges amount numeric format                         CFT014
     C           *LIKE     DEFN P#TOAM    WOVRCN                          CFT014
      *                                                                   CFT014
      ** Reset output parameters and temporary variables                  CFT014
     C                     MOVEL*BLANK    WOVAMT                          CFT014
     C                     Z-ADD0         WOVTAN                          CFT014
     C                     Z-ADD0         WOVRCN                          CFT014
      *                                                                   CFT014
      ** If both currencies are the same, we don't need to perform        CFT014
      ** currency conversion before doing operation on the amounts        CFT014
     C           WOVICY    IFEQ WOVRCY                                    CFT014
      ** Retrieve details of transaction currency                         CFT014
     C                     MOVELWOVICY    WCYCCY                          CFT014
     C                     MOVEL'N'       WCYDMP                          CFT014
     C                     EXSR RTCCYD                                    CFT014
     C           WCYRTN    IFEQ *BLANK                                    CFT014
     C                     Z-ADDWCYNDP    TRNBDP                          CFT014
     C                     Z-ADDWCYNDP    RCNBDP                          CFT014
     C                     ENDIF                                          CFT014
      ** Format charges amount                                            CFT014
     C                     MOVEL*BLANK    ZFIELD                          CFT014
     C                     MOVELWOVRAM    ZFIELD                          CFT014
     C           13        SUB  RCNBDP    ZADIG                           CFT014
     C                     Z-ADDRCNBDP    ZADEC                           CFT014
     C                     EXSR ZALIGN                                    CFT014
     C                     MOVE ZFIELD    WOVRCN                          CFT014
      ** Format input amount                                              CFT014
     C                     MOVEL*BLANK    ZFIELD                          CFT014
     C                     MOVELWOVIAM    ZFIELD                          CFT014
     C           13        SUB  TRNBDP    ZADIG                           CFT014
     C                     Z-ADDTRNBDP    ZADEC                           CFT014
     C                     EXSR ZALIGN                                    CFT014
     C                     MOVE ZFIELD    WOVTAN                          CFT014
      *                                                                   CFT014
     C                     SELEC                                          CFT014
     C           WOVOPR    WHEQ '*SUB'                                    CFT014
      ** Final amount = Input amount - Charges amount                     CFT014
     C           WOVTAN    SUB  WOVRCN    WOVTAN                          CFT014
     C           WOVOPR    WHEQ '*ADD'                                    CFT014
      ** Final amount = Input amount + Charges amount                     CFT014
     C           WOVTAN    ADD  WOVRCN    WOVTAN                          CFT014
     C                     ENDSL                                          CFT014
      *                                                                   CFT014
      ** Format Final amount                                              CFT014
     C                     MOVEL*BLANK    ZFIELD                          CFT014
     C                     MOVE WOVTAN    ZFIELD                          CFT014
     C                     Z-ADDTRNBDP    ZADEC                           CFT014
     C                     EXSR ZEDIT                                     CFT014
     C                     MOVE ZFIELD    WOVAMT                          CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      ** Currencies are different                                         CFT014
      *                                                                   CFT014
      ** Begin to fill parameters for FT0010 (currency conversion)        CFT014
     C                     CLEARP#0010                                    CFT014
     C                     MOVELWOVRCY    P#FRCY                          CFT014
      ** Retrieve details of transaction currency                         CFT014
     C                     MOVELWOVICY    P#TOCY                          CFT014
     C                     MOVELWOVICY    WCYCCY                          CFT014
     C                     MOVEL'N'       WCYDMP                          CFT014
     C                     EXSR RTCCYD                                    CFT014
     C           WCYRTN    IFEQ *BLANK                                    CFT014
     C                     Z-ADDWCYNDP    TRNBDP                          CFT014
     C                     ENDIF                                          CFT014
     C                     Z-ADDWOVVLD    P#FRDT                          CFT014
     C                     Z-ADDWOVVLD    P#TODT                          CFT014
      ** Retrieve details of currency of Receiver's Charges               CFT014
     C                     MOVELWOVRCY    WCYCCY                          CFT014
     C                     MOVEL'N'       WCYDMP                          CFT014
     C                     EXSR RTCCYD                                    CFT014
     C           WCYRTN    IFEQ *BLANK                                    CFT014
     C                     Z-ADDWCYNDP    RCNBDP                          CFT014
      *                                                                   CFT014
      ** Format charges amount                                            CFT014
     C                     MOVEL*BLANK    ZFIELD                          CFT014
     C                     MOVELWOVRAM    ZFIELD                          CFT014
     C           13        SUB  RCNBDP    ZADIG                           CFT014
     C                     Z-ADDRCNBDP    ZADEC                           CFT014
     C                     EXSR ZALIGN                                    CFT014
     C                     MOVE ZFIELD    P#FRAM                          CFT014
      *                                                                   CFT014
      ** Convert the :71G: amount into the :32A: currency                 CFT014
     C                     CALL 'FT0010'                                  CFT014
     C                     PARM           P#0010                          CFT014
      *                                                                   CFT014
     C           P#RTCD    IFNE *BLANK                                    CFT014
     C                     MOVEL'FT0010  'W0FILE           ***************CFT014
     C                     MOVEL'*CALL  ' W0KEY            * DB ERROR 109*CFT014
     C                     Z-ADD109       W0ERNB           ***************CFT014
     C                     MOVEL'MEM5003' W0MSGD                          CFT014
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT014
     C                     EXSR SRERRA                                    CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C                     Z-ADDP#TOAM    WOVRCN                          CFT014
      ** Format input amount                                              CFT014
     C                     MOVEL*BLANK    ZFIELD                          CFT014
     C                     MOVELWOVIAM    ZFIELD                          CFT014
     C           13        SUB  TRNBDP    ZADIG                           CFT014
     C                     Z-ADDTRNBDP    ZADEC                           CFT014
     C                     EXSR ZALIGN                                    CFT014
     C                     MOVE ZFIELD    WOVTAN                          CFT014
      *                                                                   CFT014
     C                     SELEC                                          CFT014
     C           WOVOPR    WHEQ '*SUB'                                    CFT014
      ** Final amount = Input amount - Charges amount                     CFT014
     C           WOVTAN    SUB  WOVRCN    WOVTAN                          CFT014
     C           WOVOPR    WHEQ '*ADD'                                    CFT014
      ** Final amount = Input amount + Charges amount                     CFT014
     C           WOVTAN    ADD  WOVRCN    WOVTAN                          CFT014
     C                     ENDSL                                          CFT014
      *                                                                   CFT014
      ** Format Final amount                                              CFT014
     C                     MOVEL*BLANK    ZFIELD                          CFT014
     C                     MOVE WOVTAN    ZFIELD                          CFT014
     C                     Z-ADDTRNBDP    ZADEC                           CFT014
     C                     EXSR ZEDIT                                     CFT014
     C                     MOVE ZFIELD    WOVAMT                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Reset input parameters                                           CFT014
     C                     MOVEL*BLANK    WOVIAM                          CFT014
     C                     MOVEL*BLANK    WOVICY                          CFT014
     C                     MOVEL*BLANK    WOVRAM                          CFT014
     C                     MOVEL*BLANK    WOVRCY                          CFT014
     C                     MOVEL*BLANK    WOVOPR  4                       CFT014
     C                     Z-ADD0         WOVVLD                          CFT014
      *                                                                   CFT014
      *  Unwind subroutine stack name                                     CFT014
      *                                                                   CFT014
     C           EXOV32    TAG                                            CFT014
     C                     MOVEA*BLANKS   @STK,Q                          CFT014
     C                     SUB  1         Q                               CFT014
      *                                                                   CFT014
     C                     ENDSR                                          CFT014
      /EJECT                                                              CFT014
      *================================================================   CFT012
      *  Default the Payment Currency                                     CFT012
      *================================================================   CFT012
      *                                                                   CFT012
     C           SRDPCC    BEGSR                                          CFT012
      *                                                                   CFT012
      *  Set up subroutine stack name                                     CFT012
      *                                                                   CFT012
     C                     ADD  1         Q                               CFT012
     C                     MOVEL'SRDPCY'  @STK,Q                          CFT012
      *                                                                   CFT012
     C           CFT002    IFEQ 'Y'                                       CFT012
     C           PRTN      IFEQ 'MIN0096'                                 CFT012
     C           GNCSET    IFNE *BLANKS                                   CFT012
     C                     MOVELGNCSET    TRCDE2                          CFT012
     C                     MOVELTRCYCD    S1PCCY                          CFT012
     C                     ENDIF                                          CFT012
     C                     ENDIF                                          CFT012
     C                     ENDIF                                          CFT012
      *                                                                   CFT012
     C           S1PCCY    IFEQ *BLANK                                    CFT012
     C           CFT004    IFEQ 'Y'                                       CFT012
     C                     MOVEL*BLANKS   P@IBN                           CFT012
     C                     ENDIF                                          CFT012
     C                     MOVELS1BNC1    WIB1    1                       CFT012
     C           WIB1      IFEQ '/'                                       CFT012
     C                     MOVELS1BNC2    WAC                             CFT012
     C           CFT004    IFEQ 'Y'                                       CFT012
     C           34        SUBSTS1BNC1:2  P@IBN                           CFT012
     C                     ENDIF                                          CFT012
     C                     ELSE                                           CFT012
     C                     MOVELS1BNC1    WAC                             CFT012
     C                     ENDIF                                          CFT012
     C                     MOVEL'N'       WACDMP                          CFT012
     C                     EXSR RTACNT                                    CFT012
     C           WACRTN    IFEQ *BLANK                                    CFT012
     C                     MOVELIFCCY     S1PCCY                          CFT012
     C                     ENDIF                                          CFT012
     C                     ENDIF                                          CFT012
      *                                                                   CFT012
     C           S1PCCY    IFEQ *BLANK                                    CFT012
     C           CFT004    IFEQ 'Y'                                       CFT012
     C           P@IBN     IFNE *BLANK                                    CFT012
     C                     CALL 'AOIBANR2'                                CFT012
     C                     PARM           @RTCD                           CFT012
     C                     PARM           P@IBN                           CFT012
     C           ACCINF    PARM           DSSDY                           CFT012
      *                                                                   CFT012
     C           @RTCD     IFEQ *BLANK                                    CFT012
     C                     MOVELIFCCY     S1PCCY                          CFT012
     C                     ENDIF                                          CFT012
     C                     ENDIF                                          CFT012
     C                     ENDIF                                          CFT012
     C                     ENDIF                                          CFT012
      *                                                                   CFT012
     C           S1PCCY    IFEQ *BLANK                                    CFT012
     C                     MOVELINACB1    WAC                             CFT012
     C                     MOVEL'N'       WACDMP                          CFT012
     C                     EXSR RTACNT                                    CFT012
     C           WACRTN    IFEQ *BLANK                                    CFT012
     C                     MOVELIFCCY     S1PCCY                          CFT012
     C                     ENDIF                                          CFT012
     C                     ENDIF                                          CFT012
      *                                                                   CFT012
     C           S1PCCY    IFEQ *BLANK                                    CFT012
     C                     MOVELS1SMCY    S1PCCY                          CFT012
     C                     ENDIF                                          CFT012
      *                                                                   CFT012
      *  Unwind subroutine stack name                                     CFT012
      *                                                                   CFT012
     C           EXDPCY    TAG                                            CFT012
     C                     MOVEA*BLANKS   @STK,Q                          CFT012
     C                     SUB  1         Q                               CFT012
      *                                                                   CFT012
     C                     ENDSR                                          CFT012
      /EJECT                                                              CFT012
      *================================================================   CFT012
      *  Default the Settlement Currency                                  CFT012
      *================================================================   CFT012
      *                                                                   CFT012
     C           SRDSCY    BEGSR                                          CFT012
      *                                                                   CFT012
      *  Set up subroutine stack name                                     CFT012
      *                                                                   CFT012
     C                     ADD  1         Q                               CFT012
     C                     MOVEL'SRDSCY'  @STK,Q                          CFT012
      *                                                                   CFT012
     C           CFT002    IFEQ 'Y'                                       CFT012
     C           PRTN      IFEQ 'MIN0096'                                 CFT012
     C           GNDSET    IFNE *BLANKS                                   CFT012
     C                     MOVELGNDSET    TRCDE2                          CFT012
     C                     MOVELTRCYCD    S4SMCY                          CFT012
     C                     ENDIF                                          CFT012
     C                     ENDIF                                          CFT012
     C                     ENDIF                                          CFT012
      *                                                                   CFT012
     C           S4SMCY    IFEQ *BLANK                                    CFT012
     C                     MOVELS4ORC1    WAC                             CFT012
     C                     MOVEL'N'       WACDMP                          CFT012
     C                     EXSR RTACNT                                    CFT012
     C           WACRTN    IFEQ *BLANK                                    CFT012
     C                     MOVELIFCCY     S4SMCY                          CFT012
     C                     ENDIF                                          CFT012
      *                                                                                       CFT032
     C                     MOVE *BLANKS   PIBAN                                               CFT032
     C           S4ORC1    IFNE *BLANKS                                                       CFT032
     C                     MOVELORC1      W#C1                                                CFT032
      *                                                                                       CFT032
     C           W#C1      IFEQ '/'                                                           CFT032
     C           34        SUBSTORC1:2    PIBAN                                               CFT032
     C                     ELSE                                                               CFT032
     C                     MOVELORC1      PIBAN                                               CFT032
     C                     ENDIF                                                              CFT032
      *                                                                                       CFT032
     C                     CALL 'AOIBANR4'                                                    CFT032
     C                     PARM           @RTCD                                               CFT032
     C                     PARM '*KEY   ' @OPTN                                               CFT032
     C                     PARM           PIBAN                                               CFT032
     C           P@ACCT    PARM *BLANKS   DSSDY                                               CFT032
      *                                                                                       CFT032
     C********** @RTCD     IFNE *BLANKS                                              CFT032 BUG15042
     C           @RTCD     IFEQ *BLANKS                                                     BUG15042
     C                     MOVELP@CCY     S4SMCY                                              CFT032
     C                     ELSE                                                               CFT032
     C                     MOVELPIBAN     WAC                                                 CFT032
     C                     ENDIF                                                              CFT032
      *                                                                                       CFT032
     C                     ENDIF                                                              CFT032
      *                                                                                       CFT032
     C                     ENDIF                                          CFT012
      *                                                                   CFT012
     C           S4SMCY    IFEQ *BLANK                                    CFT012
     C                     MOVELOPORB1    WAC                             CFT012
     C                     MOVEL'N'       WACDMP                          CFT012
     C                     EXSR RTACNT                                    CFT012
     C           WACRTN    IFEQ *BLANK                                    CFT012
     C                     MOVELIFCCY     S4SMCY                          CFT012
     C                     ENDIF                                          CFT012
     C                     ENDIF                                          CFT012
      *                                                                   CFT012
     C           S4SMCY    IFEQ *BLANK                                    CFT012
     C                     MOVELS4PCCY    S4SMCY                          CFT012
     C                     ENDIF                                          CFT012
      *                                                                   CFT012
      *  Unwind subroutine stack name                                     CFT012
      *                                                                   CFT012
     C           EXDSCY    TAG                                            CFT012
     C                     MOVEA*BLANKS   @STK,Q                          CFT012
     C                     SUB  1         Q                               CFT012
      *                                                                   CFT012
     C                     ENDSR                                          CFT012
      /EJECT                                                              CFT012
      *================================================================   CGL009
      *  Profit center retrieval                                          CGL009
      *================================================================   CGL009
     C           SRPRFC    BEGSR                                          CGL009
      *                                                                   CGL009
      *  Set up subroutine stack name                                     CGL009
      *                                                                   CGL009
     C                     ADD  1         Q                               CGL009
     C                     MOVEL'SRPRFC'  @STK,Q                          CGL009
      *                                                                   CGL009
      ** Inputs                                                           CGL009
      ** ------                                                           CGL009
     C           *LIKE     DEFN U#TRTP    WPYTP                           CGL009
     C           *LIKE     DEFN U#SUTP    WPYST                           CGL009
     C           *LIKE     DEFN U#BOKC    WBOKC                           CGL009
     C           *LIKE     DEFN U#BRAN    WBRCA                           CGL009
     C           *LIKE     DEFN U#DEPT    WDEPT                           CGL009
     C           *LIKE     DEFN U#USER    WUSER                           CGL009
     C           *LIKE     DEFN U#ACOF    WACOF                           CGL009
     C           *LIKE     DEFN U#CUST    WCUST                           CGL009
      ** Outputs                                                          CGL009
      ** -------                                                          CGL009
     C           *LIKE     DEFN U#PRFC    WPRFC                           CGL009
      *                                                                   CGL009
     C                     MOVEL*BLANK    WPRFC                           CGL009
      *                                                                   CGL009
      *  If the profit centre field is blank set to a default only if     CGL009
      *  the Profit Centre Defaults Used flag is set to 'Y'.              CGL009
      *                                                                   CGL009
     C           V#PCDU    IFEQ 'Y'                                       CGL009
      *                                                                   CGL009
      *  Determine parameters to be passed                                CGL009
      *                                                                   CGL009
      *  For Outgoing Payments the Customer and Account Officer will      CGL009
      *  be blank.                                                        CGL009
      *                                                                   CGL009
      *  Get default profit centre                                        CGL009
      *                                                                   CGL009
     C                     CALL 'AOPRFMR0'             90                 CGL009
     C                     PARM *BLANKS   U#RTCD  7        Return Code    CGL009
     C                     PARM WBOKC     U#BOKC  2        Book Code      CGL009
     C                     PARM WPYTP     U#TRTP  5        Transaction TypCGL009
     C                     PARM WPYST     U#SUTP  2        Sub Type       CGL009
     C                     PARM WBRCA     U#BRAN  3        Branch Code    CGL009
     C                     PARM WDEPT     U#DEPT  3        Department CodeCGL009
     C                     PARM WUSER     U#USER 10        User           CGL009
     C                     PARM WACOF     U#ACOF  2        Account OfficerCGL009
     C                     PARM WCUST     U#CUST  6        Customer NumberCGL009
     C           WPRFC     PARM *BLANKS   U#PRFC  4        Profit Centre  CGL009
      *                                                                   CGL009
      *  If error on CALL - process as database error                     CGL009
      *                                                                   CGL009
     C           *IN90     IFEQ '1'                                       CGL009
     C                     MOVEL'AOPRFMR0'W0FILE           ***************CGL009
     C                     MOVEL'*CALL  ' W0KEY            * DB ERROR 70 *CGL009
     C                     Z-ADD70        W0ERNB           ***************CGL009
     C                     MOVEL'MEM5003' W0MSGD                          CGL009
     C                     MOVEL'MIDAS  ' W0MSGF                          CGL009
     C                     EXSR SRERRA                                    CGL009
     C                     END                                            CGL009
      *                                                                   CGL009
      * If return code is not blank - exit                                CGL009
      * If no error then the screen field is filled by passed parameter   CGL009
      *                                                                   CGL009
     C           U#RTCD    IFEQ '2'                                       CGL009
     C                     MOVEL*BLANK    WPRFC                           CGL009
     C                     GOTO EXPRFC                                    CGL009
     C                     END                                            CGL009
      *                                                                   CGL009
      *  Validate Profit Centre                                           CGL009
      *                                                                   CGL009
     C                     CALL 'AOPRFCR0'             90                 CGL009
     C                     PARM *BLANKS   U#RTCD  7                       CGL009
     C                     PARM '*KEY'    U#OPTN  7                       CGL009
     C                     PARM WPRFC     U#PRFC  4                       CGL009
     C           SDPRFC    PARM *BLANKS   DSFDY                           CGL009
      *                                                                   CGL009
      *  If error on CALL - process as database error                     CGL009
      *                                                                   CGL009
     C           *IN90     IFEQ '1'                                       CGL009
     C                     MOVEL'AOPRFCR0'W0FILE           ***************CGL009
     C                     MOVEL'*CALL  ' W0KEY            * DB ERROR 72 *CGL009
     C                     Z-ADD71        W0ERNB           ***************CGL009
     C                     MOVEL'MEM5003' W0MSGD                          CGL009
     C                     MOVEL'MIDAS  ' W0MSGF                          CGL009
     C                     EXSR SRERRA                                    CGL009
     C                     END                                            CGL009
      *                                                                   CGL009
      * If return code is not blank - exit                                CGL009
      *                                                                   CGL009
     C           U#RTCD    IFNE *BLANKS                                   CGL009
     C                     MOVEL*BLANK    WPRFC                           CGL009
     C                     GOTO EXPRFC                                    CGL009
     C                     END                                            CGL009
      *                                                                   CGL009
     C                     MOVELDSPCCD    WPRFC                           CGL009
      *                                                                   CGL009
     C                     END                                            CGL009
      *                                                                   CGL009
     C           EXPRFC    TAG                                            CGL009
      *                                                                   CGL009
      ** Reset input variables                                            CGL009
     C                     MOVEL*BLANK    WPYTP                           CGL009
     C                     MOVEL*BLANK    WPYST                           CGL009
     C                     MOVEL*BLANK    WBOKC                           CGL009
     C                     MOVEL*BLANK    WBRCA                           CGL009
     C                     MOVEL*BLANK    WDEPT                           CGL009
     C                     MOVEL*BLANK    WUSER                           CGL009
     C                     MOVEL*BLANK    WACOF                           CGL009
     C                     MOVEL*BLANK    WCUST                           CGL009
      *                                                                   CGL009
      *  Unwind subroutine stack name                                     CGL009
      *                                                                   CGL009
     C                     MOVEA*BLANKS   @STK,Q                          CGL009
     C                     SUB  1         Q       50                      CGL009
      *                                                                   CGL009
     C                     ENDSR                                          CGL009
      /EJECT                                                              CGL009
      *================================================================   CGL009
      *  Remove character '/' (for 35 chars)                              CGL009
      *================================================================   CGL009
     C           SLSH35    BEGSR                                          CGL009
      *                                                                   CGL009
      *  Set up subroutine stack name                                     CGL009
      *                                                                   CGL009
     C                     ADD  1         Q                               CGL009
     C                     MOVEL'SLSH35'  @STK,Q                          CGL009
      ** Inputs                                                           CGL009
      ** ------                                                           CGL009
      **                                  @I35                            CGL009
      ** Outputs                                                          CGL009
      ** -------                                                          CGL009
      **                                  @O35                            CGL009
      *                                                                   CGL009
      ** The field must begin with a '/'                                  CGL009
     C           @I35,1    IFNE '/'                                       CGL009
     C                     MOVEA@I35      @O35                            CGL009
     C                     GOTO EXSH35                                    CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
     C                     MOVEL*BLANK    @O35                            CGL009
     C                     Z-ADD1         I       20                      CGL009
     C           *LIKE     DEFN I         J                               CGL009
      *                                                                   CGL009
     C                     DO   34                                        CGL009
     C           I         ADD  1         J                               CGL009
     C                     MOVEA@I35,J    @O35,I                          CGL009
     C                     ADD  1         I                               CGL009
      ** 10 chars : retail account                                        CGL009
      ** 18 chars : GL account                                            CGL009
     C           @I35,I    IFEQ *BLANK                                    CGL009
     C                     LEAVE                                          CGL009
     C                     ENDIF                                          CGL009
     C                     ENDDO                                          CGL009
      *                                                                   CGL009
     C           EXSH35    TAG                                            CGL009
     C                     MOVEL*BLANK    @I35                            CGL009
      *                                                                   CGL009
      *  Unwind subroutine stack name                                     CGL009
      *                                                                   CGL009
     C                     MOVEA*BLANKS   @STK,Q                          CGL009
     C                     SUB  1         Q       50                      CGL009
      *                                                                   CGL009
     C                     ENDSR                                          CGL009
      *================================================================   175479
      *  Retrieve FONTIS alphanumeric field identified by presence        175479
      *  of codework /XXXX/                                               175479
      *================================================================   175479
     C           CWVAL     BEGSR                                          175479
      *                                                                   175479
      *  Set up subroutine stack name                                     175479
      *                                                                   175479
     C                     ADD  1         Q                               175479
     C                     MOVEL'CWVAL'   @STK,Q                          175479
      ** Inputs                                                           175479
      ** ------                                                           175479
      ** Code work lines                                                  175479
      **                                  WCWLIN                          175479
      ** Code work                                                        175479
      **                                  WCW                             175479
      ** Code work length                                                 175479
      **                                  WCWLEN                          175479
      ** Outputs                                                          175479
      ** -------                                                          175479
      ** An alphanumeric field of max 256 length                          175479
     C           *LIKE     DEFN WCWLIN    WCWVAL                          175479
      *                                                                   175479
      ** Reset temporary variables                                        175479
     C                     MOVEL*BLANK    @CW                             175479
     C                     MOVEL*BLANK    @VL                             175479
     C                     MOVEL*BLANK    WCWVAL                          175479
     C                     Z-ADD0         LN      20                      175479
     C                     Z-ADD0         VL      30                      175479
     C           *LIKE     DEFN VL        LNCW                            175479
     C           *LIKE     DEFN VL        WT                              175479
     C                     Z-ADD0         WT                              175479
     C                     Z-ADD0         LNCW                            175479
      *                                                                   175479
      ** Length of tag containing the code works                          175479
     C           ' '       CHEKRWCWLIN    LNCW                            175479
      *                                                                   175479
      ** Length of search argument                                        175479
     C           ' '       CHEKRWCW       LN                              175479
      *                                                                   175479
     C           WCW:LN    SCAN WCWLIN:1  VL             81               175479
     C           *IN81     IFEQ *ON                                       175479
     C                     MOVEAWCWLIN    @CW                             175479
     C           VL        ADD  LN        VL                              175479
      *                                                                   175479
      ** We start to extract the value right after the code work          175479
      ** (so we need to know the length of the code work)                 175479
      ** We stop extracting when                                          175479
      ** - another / (and therefore another code work) has been found     175479
      ** - we reached the length to extract                               175479
      ** - we reached the length of the tag                               175479
     C           WT        DOWLTWCWLEN                                    175479
     C           VL        ANDLELNCW                                      175479
     C           @CW,VL    ANDNE'/'                                       175479
     C                     ADD  1         WT                              175479
     C                     MOVEL@CW,VL    @VL,WT                          175479
     C                     ADD  1         VL                              175479
     C                     ENDDO                                          175479
     C                     MOVEA@VL       WCWVAL                          175479
     C                     ENDIF                                          175479
      *                                                                   175479
      ** Reset input variables                                            175479
     C                     MOVEL*BLANKS   WCWLIN256                       175479
     C                     MOVEL*BLANKS   WCW     6                       175479
     C                     Z-ADD0         WCWLEN  30                      175479
      *                                                                   175479
      *  Unwind subroutine stack name                                     175479
      *                                                                   175479
     C           EXCWVL    TAG                                            175479
     C                     MOVEA*BLANKS   @STK,Q                          175479
     C                     SUB  1         Q       50                      175479
      *                                                                   175479
     C                     ENDSR                                          175479
      *================================================================   CGL009
      *  Retrieve the amount and currency for a given code work /XXXX/    CGL009
      *  inside multiple code work lines                                  CGL009
      *================================================================   CGL009
     C           CWAMCY    BEGSR                                          CGL009
      *                                                                   CGL009
      *  Set up subroutine stack name                                     CGL009
      *                                                                   CGL009
     C                     ADD  1         Q                               CGL009
     C                     MOVEL'CWAMCY'  @STK,Q                          CGL009
      ** Inputs                                                           CGL009
      ** ------                                                           CGL009
      ** Code work lines                                                  CGL009
      **                                  WCWLIN                          CGL009
      ** Code work                                                        CGL009
      **                                  WCW                             CGL009
      ** Outputs                                                          CGL009
      ** -------                                                          CGL009
      ** Currency                                                         CGL009
     C           *LIKE     DEFN S1NDCY    WCWCY                           CGL009
      ** Amount                                                           CGL009
     C           *LIKE     DEFN S1NDAM    WCWAM                           CGL009
      *                                                                   CGL009
     C                     MOVEL*BLANK    WCWCY                           CGL009
     C                     MOVEL*BLANK    WCWAM                           CGL009
      *                                                                   CGL009
     C           WCW       SCAN WCWLIN:1  @F      30     81               CGL009
     C           *IN81     IFEQ *ON                                       CGL009
      *                                                                   CGL009
     C                     ADD  6         @F                              CGL009
     C           3         SUBSTWCWLIN:@F WCWCY                           CGL009
      *                                                                                       225169
      ** Translate currency to Midas currency if it is a different                            225169
      ** SWIFT currency code.                                                                 225169
      *                                                                                       225169
     C                     MOVE WCWCY     WCCY                                                225169
     C                     EXSR WTRNCY                                                        225169
     C                     MOVE WCCY      WCWCY                                               225169
      *                                                                                       225169
      * Map amount                                                        CGL009
      * Move possible 15 chars to work array and work string              CGL009
     C                     ADD  3         @F                              CGL009
     C           15        SUBSTWCWLIN:@F @S     15                       CGL009
     C                     MOVEA@S        @A                              CGL009
     C                     CLEAR@S                                        CGL009
      *                                                                   CGL009
      * If ',' in amount string @S change to '.'                          CGL009
      * Only need to check valid chars till one ',' found                 CGL009
     C                     Z-ADD1         @C      30                      CGL009
     C                     MOVE *BLANKS   @T      1                       CGL009
      *                                                                   CGL009
     C           1         DO   15        @C                              CGL009
     C                     MOVE @A,@C     @T                              CGL009
     C           @T        IFEQ ','                                       CGL009
     C                     MOVE '.'       @A,@C                           CGL009
     C                     LEAVE                                          CGL009
     C                     ENDIF                                          CGL009
     C                     ENDDO                                          CGL009
      *                                                                   CGL009
     C                     Z-ADD1         @C                              CGL009
     C                     MOVE *BLANKS   @T      1                       CGL009
     C                     MOVEA@A        @S                              CGL009
      * Get amount - upto 15 chars possible                               CGL009
     C           @C        DOUGT15                                        CGL009
     C                     MOVE @A,@C     @T                              CGL009
     C           @CHK      CHECK@T        @F             82               CGL009
      *                                                                   CGL009
      * Char not valid must be end of amount                              CGL009
     C           *IN82     IFEQ *ON                                       CGL009
     C           @C        IFNE 1                                         CGL009
     C           @C        SUB  1         @F                              CGL009
     C           @F        SUBST@S:1      WCWAM                           CGL009
     C                     ENDIF                                          CGL009
     C                     LEAVE                                          CGL009
     C                     ENDIF                                          CGL009
      * All chars in string ok                                            CGL009
     C           @C        IFEQ 15                                        CGL009
     C                     MOVEL@S        WCWAM                           CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
     C                     ADD  1         @C                              CGL009
      *                                                                   CGL009
     C                     ENDDO                                          CGL009
      *                                                                   CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
      ** Reset input variables                                            CGL009
     C                     MOVEL*BLANKS   WCWLIN256                       CGL009
     C                     MOVEL*BLANKS   WCW     6                       CGL009
      *                                                                   CGL009
      *  Unwind subroutine stack name                                     CGL009
      *                                                                   CGL009
     C           EXAMCY    TAG                                            CGL009
     C                     MOVEA*BLANKS   @STK,Q                          CGL009
     C                     SUB  1         Q       50                      CGL009
      *                                                                   CGL009
     C                     ENDSR                                          CGL009
      *================================================================   CGL009
      *  Test if an amount is null                                        CGL009
      *================================================================   CGL009
     C           TSNULL    BEGSR                                          CGL009
      *                                                                   CGL009
      *  Set up subroutine stack name                                     CGL009
      *                                                                   CGL009
     C                     ADD  1         Q                               CGL009
     C                     MOVEL'TSNULL'  @STK,Q                          CGL009
      ** Inputs                                                           CGL009
      ** ------                                                           CGL009
      ** Amount                                                           CGL009
      **                                  WNLAM                           CGL009
      ** Outputs                                                          CGL009
      ** -------                                                          CGL009
      ** Flag Null ? (Y/N)                                                CGL009
      **                                  WNLNUL                          CGL009
      *                                                                   CGL009
     C                     MOVEL'Y'       WNLNUL  1                       CGL009
      *                                                                   CGL009
     C           WNLAM     IFNE *BLANK                                    CGL009
     C                     MOVEAWNLAM     @NL                             CGL009
     C                     DO   15        I                               CGL009
     C           @NUL      CHECK@NL,I                    82               CGL009
     C           *IN82     IFEQ *OFF                                      CGL009
     C                     MOVEL'N'       WNLNUL                          CGL009
     C                     LEAVE                                          CGL009
     C                     ENDIF                                          CGL009
     C                     ENDDO                                          CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
     C                     MOVEL*BLANK    WNLAM  15                       CGL009
     C                     MOVEL*BLANK    @NL     1                       CGL009
      *                                                                   CGL009
      *  Unwind subroutine stack name                                     CGL009
      *                                                                   CGL009
     C           EXNULL    TAG                                            CGL009
     C                     MOVEA*BLANKS   @STK,Q                          CGL009
     C                     SUB  1         Q       50                      CGL009
      *                                                                   CGL009
     C                     ENDSR                                          CGL009
      *================================================================   CGL009
      *  Retrieve the rate and the multiply/divide indicator /XXXX/       CGL009
      *  inside multiple code work lines                                  CGL009
      *================================================================   CGL009
     C           CWRATE    BEGSR                                          CGL009
      *                                                                   CGL009
      *  Set up subroutine stack name                                     CGL009
      *                                                                   CGL009
     C                     ADD  1         Q                               CGL009
     C                     MOVEL'CWRATE'  @STK,Q                          CGL009
      *                                                                   CGL009
      ** Inputs                                                           CGL009
      ** ------                                                           CGL009
      ** Code work lines                                                  CGL009
      **                                  WCWLIN                          CGL009
      ** Code work                                                        CGL009
      **                                  WCW                             CGL009
      ** Outputs                                                          CGL009
      ** -------                                                          CGL009
      ** Rate                                                             CGL009
     C           *LIKE     DEFN S1RATE    WCWRT                           CGL009
      ** Decimal Position Truncated                                       CGL009
     C           *LIKE     DEFN A6NBDP    WCWDPT                          CGL009
      ** Decimal Position                                                 CGL009
     C           *LIKE     DEFN A6NBDP    WCWDP + 1                       CGL009
      *                                                                   CGL009
     C                     MOVEL*BLANK    WCWRT                           CGL009
     C                     Z-ADD0         WCWDPT                          CGL009
     C                     Z-ADD0         WCWDP                           CGL009
      *                                                                   CGL009
     C           WCW       SCAN WCWLIN:1  @F      30     81               CGL009
     C           *IN81     IFEQ *ON                                       CGL009
      *                                                                   CGL009
     C                     ADD  6         @F                              CGL009
      * Map Rate                                                          CGL009
      * Move possible 13 chars to work array and work string              CGL009
     C           13        SUBSTWCWLIN:@F @R     13                       CGL009
     C                     MOVEA@R        @R1                             CGL009
     C                     CLEAR@R                                        CGL009
      *                                                                   CGL009
      * If ',' in rate string @R change to '.'                            CGL009
      * Only need to check valid chars till one ',' found                 CGL009
     C                     Z-ADD1         @C      30                      CGL009
     C                     MOVE *BLANKS   @T      1                       CGL009
      *                                                                   CGL009
     C           1         DO   13        @C                              CGL009
     C           @R1,@C    IFEQ ','                                       CGL009
     C                     MOVE '.'       @R1,@C                          CGL009
      * Retrieve the number of decimal position                           CGL009
     C           @CHK      CHECKR1        @F      30                      CGL009
     C           @F        IFNE 0                                         CGL009
     C           @F        SUB  1         @F                              CGL009
     C           @F        SUB  @C        WCWDP                           CGL009
     C                     ELSE                                           CGL009
     C           13        SUB  @C        WCWDP                           CGL009
     C                     ENDIF                                          CGL009
      ** Decimal position can be handled only on one 1 digit              CGL009
      ** => range 0-9  (otherwise truncated to 9)                         CGL009
     C           WCWDP     IFGT 9                                         CGL009
     C                     Z-ADD9         WCWDPT                          CGL009
     C                     ELSE                                           CGL009
     C                     Z-ADDWCWDP     WCWDPT                          CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
     C                     LEAVE                                          CGL009
     C                     ENDIF                                          CGL009
     C                     ENDDO                                          CGL009
      *                                                                   CGL009
     C                     Z-ADD1         @C                              CGL009
     C                     MOVE *BLANKS   @T      1                       CGL009
     C                     MOVEA@R1       @R                              CGL009
      * Get amount - upto 13 chars possible                               CGL009
     C           @C        DOUGT13                                        CGL009
     C                     MOVE @R1,@C    @T                              CGL009
     C           @CHK      CHECK@T        @F             82               CGL009
      *                                                                   CGL009
      * Char not valid must be end of rate                                CGL009
     C           *IN82     IFEQ *ON                                       CGL009
     C           @C        IFNE 1                                         CGL009
     C           @C        SUB  1         @F                              CGL009
     C           @F        SUBST@R:1      WCWRT                           CGL009
     C                     ENDIF                                          CGL009
     C                     LEAVE                                          CGL009
     C                     ENDIF                                          CGL009
      * All chars in string ok                                            CGL009
     C           @C        IFEQ 13                                        CGL009
     C                     MOVEL@R        WCWRT                           CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
     C                     ADD  1         @C                              CGL009
      *                                                                   CGL009
     C                     ENDDO                                          CGL009
      *                                                                   CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
      ** Reset input variables                                            CGL009
     C                     MOVEL*BLANKS   WCWLIN                          CGL009
     C                     MOVEL*BLANKS   WCW                             CGL009
      *                                                                   CGL009
      *  Unwind subroutine stack name                                     CGL009
      *                                                                   CGL009
     C           EXCWRT    TAG                                            CGL009
     C                     MOVEA*BLANKS   @STK,Q                          CGL009
     C                     SUB  1         Q       50                      CGL009
      *                                                                   CGL009
     C                     ENDSR                                          CGL009
      *================================================================   CFT014
      *  Retrieve the rate of tag :36:                                    CFT014
      *================================================================   CFT014
     C           RT36      BEGSR                                          CFT014
      *                                                                   CFT014
      *  Set up subroutine stack name                                     CFT014
      *                                                                   CFT014
     C                     ADD  1         Q                               CFT014
     C                     MOVEL'RT36'    @STK,Q                          CFT014
      *                                                                   CFT014
      ** Inputs                                                           CFT014
      ** ------                                                           CFT014
      ** Code work lines                                                  CFT014
      **                                  DSTRAN                          CFT014
      ** Outputs                                                          CFT014
      ** -------                                                          CFT014
      ** Rate                                                             CFT014
     C           *LIKE     DEFN S1OEXR    W36RT                           CFT014
      ** Decimal Position Truncated                                       CFT014
     C           *LIKE     DEFN A6NBDP    W36DPT                          CFT014
      ** Decimal Position                                                 CFT014
     C           *LIKE     DEFN A6NBDP    W36DP + 1                       CFT014
      *                                                                   CFT014
     C                     MOVEL*BLANK    W36RT                           CFT014
     C                     Z-ADD0         W36DPT                          CFT014
     C                     Z-ADD0         W36DP                           CFT014
      *                                                                   CFT014
      * Map Rate                                                          CFT014
      * Move possible 12 chars to work array and work string              CFT014
     C           12        SUBSTTMLIN1:1  @R     13                       CFT014
     C                     MOVEA@R        @R1                             CFT014
     C                     CLEAR@R                                        CFT014
      *                                                                   CFT014
      * If ',' in rate string @R change to '.'                            CFT014
      * Only need to check valid chars till one ',' found                 CFT014
     C                     Z-ADD1         @C      30                      CFT014
     C                     MOVE *BLANKS   @T      1                       CFT014
      *                                                                   CFT014
     C           1         DO   12        @C                              CFT014
     C           @R1,@C    IFEQ ','                                       CFT014
     C                     MOVE '.'       @R1,@C                          CFT014
      * Retrieve the number of decimal position                           CFT014
     C           @CHK      CHECKR1        @F      30                      CFT014
     C           @F        IFNE 0                                         CFT014
     C           @F        SUB  1         @F                              CFT014
     C           @F        SUB  @C        W36DP                           CFT014
     C                     ELSE                                           CFT014
     C           12        SUB  @C        W36DP                           CFT014
     C                     ENDIF                                          CFT014
      ** Decimal position can be handled only on one 1 digit              CFT014
      ** => range 0-9  (otherwise truncated to 9)                         CFT014
     C           W36DP     IFGT 9                                         CFT014
     C                     Z-ADD9         W36DPT                          CFT014
     C                     ELSE                                           CFT014
     C                     Z-ADDW36DP     W36DPT                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     LEAVE                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDDO                                          CFT014
      *                                                                   CFT014
     C                     Z-ADD1         @C                              CFT014
     C                     MOVE *BLANKS   @T      1                       CFT014
     C                     MOVEA@R1       @R                              CFT014
      * Get amount - upto 12 chars possible                               CFT014
     C           @C        DOUGT12                                        CFT014
     C                     MOVE @R1,@C    @T                              CFT014
     C           @CHK      CHECK@T        @F             82               CFT014
      *                                                                   CFT014
      * Char not valid must be end of rate                                CFT014
     C           *IN82     IFEQ *ON                                       CFT014
     C           @C        IFNE 1                                         CFT014
     C           @C        SUB  1         @F                              CFT014
     C           @F        SUBST@R:1      W36RT                           CFT014
     C                     ENDIF                                          CFT014
     C                     LEAVE                                          CFT014
     C                     ENDIF                                          CFT014
      * All chars in string ok                                            CFT014
     C           @C        IFEQ 12                                        CFT014
     C                     MOVEL@R        W36RT                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ADD  1         @C                              CFT014
      *                                                                   CFT014
     C                     ENDDO                                          CFT014
      *                                                                   CFT014
      *  Unwind subroutine stack name                                     CFT014
      *                                                                   CFT014
     C           EXRT36    TAG                                            CFT014
     C                     MOVEA*BLANKS   @STK,Q                          CFT014
     C                     SUB  1         Q       50                      CFT014
      *                                                                   CFT014
     C                     ENDSR                                          CFT014
      *================================================================   CGL009
      *  Retrieve currency details                                        CGL009
      *================================================================   CGL009
     C           RTCCYD    BEGSR                                          CGL009
      *                                                                   CGL009
      *  Set up subroutine stack name                                     CGL009
      *                                                                   CGL009
     C                     ADD  1         Q       50                      CGL009
     C                     MOVEL'RTCCYD'  @STK,Q                          CGL009
      ** Inputs                                                           CGL009
      ** ------                                                           CGL009
      ** Currency                                                         CGL009
     C           *LIKE     DEFN A6CYCD    WCYCCY                          CGL009
      ** Dump flag (Y/N)                                                  CGL009
     C           *LIKE     DEFN WACDMP    WCYDMP                          CGL009
      ** Outputs                                                          CGL009
      ** -------                                                          CGL009
      ** Decimal positions                                                CGL009
     C           *LIKE     DEFN A6NBDP    WCYNDP                          CGL009
      ** Return code                                                      CGL009
     C           *LIKE     DEFN P@RTCD    WCYRTN                          CGL009
      *                                                                   CGL009
     C                     MOVEL*BLANK    WCYNDP                          CGL009
     C                     MOVEL*BLANK    WCYRTN                          CGL009
      *                                                                   CGL009
     C                     CALL 'AOCURRR0'             9090               CGL009
     C                     PARM *BLANKS   RTCD    7                       CGL009
     C                     PARM '*KEY   ' @OPTN                           CGL009
     C                     PARM WCYCCY    @K101   3                       CGL009
     C           SDCURR    PARM *BLANKS   DSSDY                           CGL009
      *                                                                   CGL009
      *  If error on call                                                 CGL009
      *                                                                   CGL009
     C           *IN90     IFEQ '1'                                       CGL009
     C           RTCD      ORNE *BLANKS                                   CGL009
     C                     MOVEL'*ERROR'  WCYRTN                          CGL009
      *                                                                   CGL009
     C           WCYDMP    IFNE 'Y'                                       CGL009
     C                     GOTO EXRCYD                                    CGL009
      *                                                                   CGL009
     C                     ELSE                                           CGL009
      *                                                                   CGL009
     C           *IN90     IFEQ '1'                                       CGL009
     C                     MOVEL'AOCURRR0'W0FILE           ***************CGL009
     C                     MOVEL'*CALL'   W0KEY            * DB ERROR 75 *CGL009
     C                     Z-ADD75        W0ERNB           ***************CGL009
     C                     MOVEL'MEM5003' W0MSGD                          CGL009
     C                     MOVEL'MIDAS  ' W0MSGF                          CGL009
     C                     EXSR SRERRA                                    CGL009
     C                     END                                            CGL009
      *                                                                   CGL009
     C           RTCD      IFNE *BLANKS                                   CGL009
     C                     MOVEL'AOCURRR0'W0FILE           ***************CGL009
     C                     MOVELWCYCCY    W0KEY            * DB ERROR 76 *CGL009
     C                     Z-ADD76        W0ERNB           ***************CGL009
     C                     MOVEL'MEM5003' W0MSGD                          CGL009
     C                     MOVEL'MIDAS  ' W0MSGF                          CGL009
     C                     EXSR SRERRA                                    CGL009
     C                     END                                            CGL009
      *                                                                   CGL009
     C                     END                                            CGL009
      *                                                                   CGL009
     C                     END                                            CGL009
      *                                                                   CGL009
      *                                                                   CGL009
      *  Move new standing data field into field used in program          CGL009
      *                                                                   CGL009
      *                                                                   CGL009
      * Store Decimal Places                                              CGL009
      *                                                                   CGL009
     C                     Z-ADDA6NBDP    WCYNDP                          CGL009
      *                                                                   CGL009
     C           EXRCYD    TAG                                            CGL009
      *                                                                   CGL009
      ** Reset input variables                                            CGL009
     C                     MOVEL*BLANK    WCYCCY                          CGL009
     C                     MOVEL*BLANK    WCYDMP                          CGL009
      *                                                                   CGL009
      *  Unwind subroutine stack name                                     CGL009
      *                                                                   CGL009
     C                     MOVEA*BLANKS   @STK,Q                          CGL009
     C                     SUB  1         Q       50                      CGL009
      *                                                                   CGL009
     C                     ENDSR                                          CGL009
      *================================================================   CGL009
      *  Retrieve the amount , currency and date in PDCA (tag :32:)       CGL009
      *================================================================   CGL009
     C           RTPDCA    BEGSR                                          CGL009
      *                                                                   CGL009
      *  Set up subroutine stack name                                     CGL009
      *                                                                   CGL009
     C                     ADD  1         Q                               CGL009
     C                     MOVEL'RTPDCA'  @STK,Q                          CGL009
      *                                                                   CGL009
      ** Inputs                                                           CGL009
      ** ------                                                           CGL009
      ** DS for tags  (will NOT be blanked at the end of the S/R)         CGL009
      **                                  DSTRAN                          CGL009
      ** Outputs                                                          CGL009
      ** -------                                                          CGL009
      ** Currency                                                         CGL009
     C           *LIKE     DEFN TVCCY     W32CY                           CGL009
      ** Amount                                                           CGL009
     C           *LIKE     DEFN S1SMAM    W32AM                           CGL009
      ** Date                                                             CGL009
     C           *LIKE     DEFN SWDT2     W32DT                           CGL009
      ** Day Number                                                       CGL009
     C           *LIKE     DEFN ZDAYNO    W32DYN                          CGL009
      *                                                                   CGL009
     C                     MOVEL*BLANK    W32CY                           CGL009
     C                     MOVEL*BLANK    W32AM                           CGL009
     C                     MOVEL*BLANK    W32DT                           CGL009
     C                     Z-ADD0         W32DYN                          CGL009
      *                                                                   CGL009
      * MMDDYY format display                                             CGL009
      *                                                                   CGL009
     C           WUDFF     IFEQ 'M'                                       CGL009
     C                     MOVELTVVDAT    SWDT1   6                       CGL009
     C           2         SUBSTSWDT1:5   MM                              CGL009
     C           2         SUBSTSWDT1:3   DD                              CGL009
     C           2         SUBSTSWDT1:1   YY                              CGL009
     C                     MOVELSWDT2     W32DT                           CGL009
     C                     ELSE                                           CGL009
      *                                                                   CGL009
      * DDMMYY format display                                             CGL009
      *                                                                   CGL009
     C                     MOVELTVVDAT    SWDT1   6                       CGL009
     C           2         SUBSTSWDT1:5   DD                              CGL009
     C           2         SUBSTSWDT1:3   MM                              CGL009
     C           2         SUBSTSWDT1:1   YY                              CGL009
     C                     MOVELSWDT2     W32DT                           CGL009
     C                     END                                            CGL009
      *                                                                   CGL009
     C                     MOVE W32DT     ZDATE                           CGL009
      * Convert it in Midas day number                                    CGL009
     C                     CALL 'ZDATE1'               9090               CGL009
     C                     PARM *BLANKS   ZERR    7                       CGL009
     C                     PARM           ZDATE   60                      CGL009
     C                     PARM WUDFF     ZDATFM  1                       CGL009
     C                     PARM *ZEROS    ZDAYNO  50                      CGL009
      *                                                                   CGL009
      *  If error on call                                                 CGL009
      *                                                                   CGL009
     C           *IN90     IFEQ '1'                                       CGL009
     C                     MOVEL'ZDATE1  'W0FILE           ***************CGL009
     C                     MOVEL'*CALL'   W0KEY            * DB ERROR 78 *CGL009
     C                     Z-ADD78        W0ERNB           ***************CGL009
     C                     MOVEL'MEM5003' W0MSGD                          CGL009
     C                     MOVEL'MIDAS  ' W0MSGF                          CGL009
     C                     EXSR SRERRA                                    CGL009
     C                     END                                            CGL009
      *                                                                   CGL009
      * Date invalid => default it (Will be rejected by validation pgm)   CGL009
      *                                                                   CGL009
     C           ZERR      IFEQ '*ERROR*'                                 CGL009
     C                     Z-ADDBJRDNB    W32DYN                          CGL009
     C                     ELSE                                           CGL009
     C                     Z-ADDZDAYNO    W32DYN                          CGL009
     C                     END                                            CGL009
      *                                                                   CGL009
      * Currency                                                          CGL009
      *                                                                   CGL009
      ** Translate currency to Midas currency if it is a different                            225169
      ** SWIFT currency code.                                                                 225169
      *                                                                                       225169
     C                     MOVE TVCCY     WCCY                                                225169
     C                     EXSR WTRNCY                                                        225169
     C                     MOVE WCCY      TVCCY                                               225169
      *                                                                                       225169
     C                     MOVELTVCCY     W32CY                           CGL009
      * Amount                                                            CGL009
      *                                                                   CGL009
      * Format amount field (change ',' decimal point to '.').            CGL009
      *                                                                   CGL009
     C                     MOVEATVAMT     YA1                             CGL009
     C                     Z-ADD1         C       30                      CGL009
      *                                                                   CGL009
     C           C         DOUGT15                                        CGL009
      *                                                                   CGL009
     C           YA1,C     IFEQ ','                                       CGL009
     C                     MOVE '.'       YA1,C                           CGL009
     C                     Z-ADD16        C                               CGL009
     C                     ELSE                                           CGL009
     C                     ADD  1         C                               CGL009
     C                     END                                            CGL009
      *                                                                   CGL009
     C                     END                                            CGL009
      *                                                                   CGL009
     C                     MOVEAYA1       AMT    15                       CGL009
     C                     MOVELAMT       W32AM                           CGL009
      *                                                                   CGL009
      *  Unwind subroutine stack name                                     CGL009
      *                                                                   CGL009
     C           EXPDCA    TAG                                            CGL009
     C                     MOVEA*BLANKS   @STK,Q                          CGL009
     C                     SUB  1         Q       50                      CGL009
      *                                                                   CGL009
     C                     ENDSR                                          CGL009
      *================================================================   CFT014
      *  Retrieve the amount , currency in P33B (tag :33B:)               CFT014
      *================================================================   CFT014
     C           RTPCA     BEGSR                                          CFT014
      *                                                                   CFT014
      *  Set up subroutine stack name                                     CFT014
      *                                                                   CFT014
     C                     ADD  1         Q                               CFT014
     C                     MOVEL'RTPCA'   @STK,Q                          CFT014
      *                                                                   CFT014
      ** Inputs                                                           CFT014
      ** ------                                                           CFT014
      ** DS for tags  (will NOT be blanked at the end of the S/R)         CFT014
      **                                  DSTRAN                          CFT014
      ** Outputs                                                          CFT014
      ** -------                                                          CFT014
      ** Currency                                                         CFT014
     C           *LIKE     DEFN TVCCY     WCACY                           CFT014
      ** Amount                                                           CFT014
     C           *LIKE     DEFN S1SMAM    WCAAM                           CFT014
      *                                                                   CFT014
     C                     MOVEL*BLANK    WCACY                           CFT014
     C                     MOVEL*BLANK    WCAAM                           CFT014
      *                                                                   CFT014
      * Currency                                                          CFT014
      *                                                                   CFT014
      ** Translate currency to Midas currency if it is a different                            225169
      ** SWIFT currency code.                                                                 225169
      *                                                                                       225169
     C                     MOVE TTCCY     WCCY                                                225169
     C                     EXSR WTRNCY                                                        225169
     C                     MOVE WCCY      TTCCY                                               225169
      *                                                                                       225169
     C                     MOVELTTCCY     WCACY                           CFT014
      * Amount                                                            CFT014
      *                                                                   CFT014
      * Format amount field (change ',' decimal point to '.').            CFT014
      *                                                                   CFT014
     C                     MOVEATTAMT     YA1                             CFT014
     C                     Z-ADD1         C       30                      CFT014
      *                                                                   CFT014
     C           C         DOUGT15                                        CFT014
      *                                                                   CFT014
     C           YA1,C     IFEQ ','                                       CFT014
     C                     MOVE '.'       YA1,C                           CFT014
     C                     Z-ADD16        C                               CFT014
     C                     ELSE                                           CFT014
     C                     ADD  1         C                               CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDDO                                          CFT014
      *                                                                   CFT014
     C                     MOVEAYA1       AMT    15                       CFT014
     C                     MOVELAMT       WCAAM                           CFT014
      *                                                                   CFT014
      *  Unwind subroutine stack name                                     CFT014
      *                                                                   CFT014
     C           EX33B     TAG                                            CFT014
     C                     MOVEA*BLANKS   @STK,Q                          CFT014
     C                     SUB  1         Q       50                      CFT014
      *                                                                   CFT014
     C                     ENDSR                                          CFT014
      *================================================================   CGL009
      *  Retrieve the data of an account                                  CGL009
      *================================================================   CGL009
     C           RTACNT    BEGSR                                          CGL009
      *                                                                   CGL009
      *  Set up subroutine stack name                                     CGL009
      *                                                                   CGL009
     C                     ADD  1         Q                               CGL009
     C                     MOVEL'RTCYAC'  @STK,Q                          CGL009
      *                                                                   CGL009
      ** Inputs                                                           CGL009
      ** ------                                                           CGL009
     C           *LIKE     DEFN TRCODE    WAC                             CGL009
      ****                                WACDMP                          CGL009
      ** Outputs                                                          CGL009
      ** -------                                                          CGL009
     C           *LIKE     DEFN IFCCY     WACCY                           CGL009
     C           *LIKE     DEFN IFBRCA    WACBCH                          CGL009
      **                                  WACLN                           CGL009
     C           *LIKE     DEFN P@RTCD    WACRTN                          CGL009
      *                                                                   CGL009
     C                     MOVEL*BLANK    WACCY                           CGL009
     C                     MOVEL*BLANK    WACBCH                          CGL009
     C                     Z-ADD0         WACLN   20                      CGL009
     C                     MOVEL*BLANK    WACRTN                          CGL009
      ** Compute length                                                   CGL009
     C           ' '       CHEKRWAC       WACLN                           CGL009
      ** It is a retail number                                            CGL009
     C           WACLN     IFEQ 10                                        CGL009
     C                     MOVELWAC       P@RETL                          CGL009
     C                     MOVEL*BLANK    P@CNUM                          CGL009
     C                     MOVEL*BLANK    P@CUCD                          CGL009
     C                     MOVEL*BLANK    P@ACCD                          CGL009
     C                     MOVEL*BLANK    P@ACSQ                          CGL009
     C                     MOVEL*BLANK    P@BRCA                          CGL009
     C                     ELSE                                           CGL009
      ** It is a G/L account number                                       CGL009
     C                     MOVEL*BLANK    P@RETL                          CGL009
     C           3         SUBSTWAC:1     P@BRCA                          CGL009
     C           6         SUBSTWAC:4     P@CNUM                          CGL009
     C           3         SUBSTWAC:10    P@CUCD                          CGL009
     C********** 4         SUBSTWAC:13    P@ACCD                                       CGL009 CGL029
     C********** 2         SUBSTWAC:17    P@ACSQ                                       CGL009 CGL029
     C           10        SUBSTWAC:13    P@ACCD                                              CGL029
     C           2         SUBSTWAC:23    P@ACSQ                                              CGL029
     C                     ENDIF                                          CGL009
     C                     CALL 'AOACCTR0'             90                 CGL009
     C                     PARM           P@RTCD  7                       CGL009
     C                     PARM '*KEY   ' P@OPTN  7                       CGL009
     C                     PARM           P@RETL 10                       CGL009
     C                     PARM           P@CNUM  6                       CGL009
     C                     PARM           P@CUCD  3                       CGL009
     C**********           PARM           P@ACCD  4                                    CGL009 CGL029
     C                     PARM           P@ACCD 10                                           CGL029
     C                     PARM           P@ACSQ  2                       CGL009
     C                     PARM           P@BRCA  3                       CGL009
     C                     PARM           ACCINF                          CGL009
      *                                                                   CGL009
     C           P@RTCD    IFNE *BLANK                                    CGL009
     C           *IN90     OREQ '1'                                       CGL009
     C                     MOVEL'*ERROR'  WACRTN                          CGL009
     C           WACDMP    IFEQ 'Y'                                       CGL009
     C                     MOVEL'AOACCTR0'W0FILE                          CGL009
      ** It is a retail number                             ***************CGL009
     C           WACLN     IFEQ 10                         * DB ERROR 74 *CGL009
     C                     MOVELP@RETL    W0KEY     P      ***************CGL009
      ** It is a G/L account number                                       CGL009
     C                     ELSE                                           CGL009
     C                     MOVEL*BLANK    W0KEY                           CGL009
     C           W0KEY     CAT  P@BRCA:0  W0KEY                           CGL009
     C           W0KEY     CAT  P@CNUM:0  W0KEY                           CGL009
     C           W0KEY     CAT  P@CUCD:0  W0KEY                           CGL009
     C           W0KEY     CAT  P@ACCD:0  W0KEY                           CGL009
     C           W0KEY     CAT  P@ACSQ:0  W0KEY                           CGL009
     C                     ENDIF                                          CGL009
     C                     Z-ADD74        W0ERNB                          CGL009
     C                     MOVEL'MEM5003' W0MSGD                          CGL009
     C                     MOVEL'MIDAS  ' W0MSGF                          CGL009
     C                     EXSR SRERRA                                    CGL009
     C                     ENDIF                                          CGL009
     C                     ELSE                                           CGL009
     C                     MOVELIFCCY     WACCY                           CGL009
     C                     MOVELIFBRCA    WACBCH                          CGL009
     C                     ENDIF                                          CGL009
      *                                                                   CGL009
      ** Reset input variables                                            CGL009
     C                     MOVEL*BLANK    WAC                             CGL009
     C                     MOVEL*BLANK    WACDMP  1                       CGL009
      *                                                                   CGL009
      *  Unwind subroutine stack name                                     CGL009
      *                                                                   CGL009
     C           EXRTAC    TAG                                            CGL009
     C                     MOVEA*BLANKS   @STK,Q                          CGL009
     C                     SUB  1         Q       50                      CGL009
      *                                                                   CGL009
     C                     ENDSR                                          CGL009
     C*                                                                   CGL009
      *================================================================   CGL009
      *  Scan for /OCMT/, /ORIG/, /RATE/                                  CGL009
      *================================================================   CGL009
     C           ICCHK     BEGSR                                          CGL009
     C*                                                                   CGL009
     C                     MOVEL*BLANKS   FOUND   1                       CGL009
     C*                                                                   CGL009
     C           '/RATE/'  SCAN P72:1     @X      30     81               CGL009
     C           *IN81     IFEQ *OFF                                      CGL009
     C           '/ORIG/'  SCAN P72:1     @X             81               CGL009
     C           *IN81     IFEQ *OFF                                      CGL009
     C           '/OCMT/'  SCAN P72:1     @X             81               CGL009
     C           *IN81     IFEQ *OFF                                      175479
     C           '/REF/'   SCAN P72:1     @X             81               175479
     C                     ENDIF                                          175479
     C                     ENDIF                                          CGL009
     C                     ENDIF                                          CGL009
     C*                                                                   CGL009
     C           *IN81     IFEQ *ON                                       CGL009
     C                     MOVE 'Y'       FOUND                           CGL009
     C                     ENDIF                                          CGL009
     C*                                                                   CGL009
     C                     ENDSR                                          CGL009
      *================================================================   CFT006
      *  FILLOG   : Fill the message log                              *   CFT006
      *================================================================   CFT006
     C           FILLOG    BEGSR                                          CFT006
      *                                                                   CFT006
      *  Set up subroutine stack name                                     CFT006
      *                                                                   CFT006
     C                     ADD  1         Q       50                      CFT006
     C                     MOVEL'FILLOG'  @STK,Q                          CFT006
      *                                                                   CFT006
      ** Inputs                                                           CFT006
      ** ------                                                           CFT006
      ** Working field names array     @WKF                               CFT006
      ** Working message id array      @WKI                               CFT006
      ** Working message dt array      @WKD                               CFT006
      *                                                                   CFT006
      ** Outputs                                                          CFT006
      ** -------                                                          CFT006
      *          *NONE                                                    CFT006
     C                     Z-ADD1         I                               CFT006
     C           I         DOWLEARRMAX                                    CFT006
      *                                                                   CFT006
     C           @WKF,I    IFEQ *BLANK                                    CFT006
     C                     LEAVE                                          CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     MOVEL@WKI,I    W0LMSG                          CFT006
     C                     MOVEL'FTUSRMSG'W0MSGF                          CFT006
     C                     MOVEL@WKD,I    W0MSDT                          CFT006
     C                     EXSR SRLOG                                     CFT006
     C                     ADD  1         I                               CFT006
     C                     ENDDO                                          CFT006
      *                                                                   CFT006
      ** Reset input  variables                                           CFT006
     C                     MOVEL*BLANK    @WKF                            CFT006
     C                     MOVEL*BLANK    @WKI                            CFT006
     C                     MOVEL*BLANK    @WKD                            CFT006
      *                                                                   CFT006
     C           EXFILG    TAG                                            CFT006
     C                     MOVEA*BLANKS   @STK,Q                          CFT006
     C                     SUB  1         Q                               CFT006
      *                                                                   CFT006
     C                     ENDSR                                          CFT006
      *================================================================   CFT006
      *  RMEMSG   : Remove a specific error message from array        *   CFT006
      *================================================================   CFT006
     C           RMEMSG    BEGSR                                          CFT006
      *                                                                   CFT006
      *  Set up subroutine stack name                                     CFT006
      *                                                                   CFT006
     C                     ADD  1         Q       50                      CFT006
     C                     MOVEL'RMEMSG'  @STK,Q                          CFT006
      *                                                                   CFT006
      ** Inputs                                                           CFT006
      ** ------                                                           CFT006
      ** Field for remove                 WREFLD                          CFT006
      ** Msg Id to remove                 WREMSG                          CFT006
      ** Nbr of messages present inside the array                         CFT006
     C           *LIKE     DEFN P@IX      WRENBR                          CFT006
      ** Working field names array        @WKF                            CFT006
      ** Working message id array         @WKI                            CFT006
      ** Working message dt array         @WKD                            CFT006
      *                                                                   CFT006
      ** Outputs                                                          CFT006
      ** -------                                                          CFT006
      ** Nbr of messages present inside the array  WRENBR                 CFT006
      ** Working field names array     @WKF                               CFT006
      ** Working message id array      @WKI                               CFT006
      ** Working message dt array      @WKD                               CFT006
      *                                                                   CFT006
      *                                                                   CFT006
     C                     Z-ADD1         I                               CFT006
     C           I         DOWLEARRMAX                                    CFT006
      *                                                                   CFT006
     C           @WKF,I    IFEQ *BLANK                                    CFT006
     C                     LEAVE                                          CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      ** If combination Field/Error Msg found                             CFT006
      ** Remove it from the array                                         CFT006
     C           @WKF,I    IFEQ WREFLD                                    CFT006
     C           @WKI,I    ANDEQWREMSG                                    CFT006
     C                     Z-ADDI         L       30                      CFT006
     C           ARRMAX    SUB  1         WARMAX  30                      CFT006
      *                                                                   CFT006
     C           L         DOWLEWARMAX                                    CFT006
      *                                                                   CFT006
     C           @WKF,L    IFEQ *BLANK                                    CFT006
     C                     LEAVE                                          CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C           L         ADD  1         K       30                      CFT006
     C                     MOVEL@WKF,K    @WKF,L                          CFT006
     C                     MOVEL@WKI,K    @WKI,L                          CFT006
     C                     MOVEL@WKD,K    @WKD,L                          CFT006
     C                     MOVEL*BLANK    @WKF,K                          CFT006
     C                     MOVEL*BLANK    @WKI,K                          CFT006
     C                     MOVEL*BLANK    @WKD,K                          CFT006
     C                     ADD  1         L                               CFT006
     C                     ENDDO                                          CFT006
      *                                                                   CFT006
     C                     SUB  1         WRENBR                          CFT006
     C                     LEAVE                                          CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ADD  1         I                               CFT006
     C                     ENDDO                                          CFT006
      *                                                                   CFT006
      ** Reset input  variables                                           CFT006
     C                     MOVEL*BLANK    WREFLD 10                       CFT006
     C                     MOVEL*BLANK    WREMSG  7                       CFT006
      *                                                                   CFT006
     C           EXRMEM    TAG                                            CFT006
     C                     MOVEA*BLANKS   @STK,Q                          CFT006
     C                     SUB  1         Q                               CFT006
      *                                                                   CFT006
     C                     ENDSR                                          CFT006
      *================================================================   178186
      *  RTMGTN   : Retrieve a message transaction                    *   178186
      *================================================================   178186
     C           RTMGTN    BEGSR                                          178186
      *                                                                   178186
      *  Set up subroutine stack name                                     178186
      *                                                                   178186
     C                     ADD  1         Q       50                      178186
     C                     MOVEL'RTMGTN'  @STK,Q                          178186
      *                                                                   178186
      ** Inputs                                                           178186
      ** ------                                                           178186
      ** Key number 1                                                     178186
      **                                  WRTKY1                          178186
      ** Key number 2                                                     178186
      **                                  WRTKY2                          178186
      ** Key number 3                                                     178186
      **                                  WRTKY3                          178186
      ** Key number 4                                                     178186
      **                                  WRTKY4                          178186
      ** Key number 5                                                     178186
      **                                  WRTKY5                          178186
      ** Message type                                                     178186
     C           *LIKE     DEFN PMTPY     WRTMTY                          178186
      ** Payment type                                                     178186
     C           *LIKE     DEFN GNPYTP    WRTPYT                          178186
      ** Payment sub type                                                 178186
     C           *LIKE     DEFN GNPYST    WRTPST                          178186
      ** Book code                                                        178186
     C           *LIKE     DEFN GNBOKC    WRTBKC                          178186
      ** Branch                                                           178186
     C           *LIKE     DEFN GNBRCA    WRTBCH                          178186
      ** Orig Branch                                                      178186
     C           *LIKE     DEFN GNBRCA    WRTORB                          178186
      ** Profit Center                                                    178186
     C           *LIKE     DEFN DSPCCD    WRTPRF                          178186
      *                                                                   178186
      ** Outputs                                                          178186
      ** -------                                                          178186
      ** Transaction number                                               178186
      **                                  WRTTRN                          178186
      ** Match Criteria                                                   178186
      **                                  WRTMCH                          178186
      ** Return code                                                      178186
      **                                  WRTRTN                          178186
      ** Errors index                                                     178186
      **                                  P@IX                            178186
      ** Errors Arrays                                                    178186
      **                                  @FN                             178186
      **                                  @MI                             178186
      **                                  @MD                             178186
      *                                                                   178186
      ** Reset output variables                                           178186
     C                     MOVEL*BLANK    WRTTRN                          178186
     C                     MOVEL*BLANK    WRTMCH                          178186
     C                     MOVEL*BLANK    WRTRTN                          178186
     C                     MOVEL*BLANK    P@IX                            178186
     C                     MOVEL*BLANK    @FN                             178186
     C                     MOVEL*BLANK    @MI                             178186
     C                     MOVEL*BLANK    @MD                             178186
      *                                                                   178186
     C                     CALL 'FT0372'               90                 178186
     C                     PARM           WRTKY1100                       178186
     C                     PARM           WRTKY2100                       178186
     C                     PARM           WRTKY3100                       178186
     C                     PARM           WRTKY4100                       178186
     C                     PARM           WRTKY5100                       178186
     C                     PARM           WRTMTY                          178186
     C                     PARM           WRTPYT                          178186
     C                     PARM           WRTPST                          178186
     C                     PARM           WRTBCH                          178186
     C                     PARM           WRTORB                          178186
     C                     PARM           WRTBKC                          178186
     C                     PARM           WRTPRF                          178186
     C                     PARM           WRTTRN 30                       178186
     C                     PARM           WRTMCH  1                       178186
     C                     PARM           WRTRTN 10                       178186
     C                     PARM 0         P@IX    30                      178186
     C                     PARM *BLANK    @FN                             178186
     C                     PARM *BLANK    @MI                             178186
     C                     PARM *BLANK    @MD                             178186
      *                                                                   178186
     C           P@RETN    IFNE *BLANK                                    178186
     C           P@RETN    ANDNE'*NOT_FND'                                178186
     C           *IN90     OREQ '1'                                       178186
     C                     MOVEL'FT0372  'W0FILE                          178186
     C                     MOVEL'*CALL'   W0KEY            ***************178186
     C                     Z-ADD108       W0ERNB           * DB ERROR 108*178186
     C                     MOVEL'MEM5003' W0MSGD           ***************178186
     C                     MOVEL'MIDAS  ' W0MSGF                          178186
     C                     EXSR SRERRA                                    178186
     C                     ENDIF                                          178186
      *                                                                   178186
      ** Reset input  variables                                           178186
     C                     MOVEL*BLANK    WRTKY1                          178186
     C                     MOVEL*BLANK    WRTKY2                          178186
     C                     MOVEL*BLANK    WRTKY3                          178186
     C                     MOVEL*BLANK    WRTKY4                          178186
     C                     MOVEL*BLANK    WRTKY5                          178186
     C                     MOVEL*BLANK    WRTMTY                          178186
     C                     MOVEL*BLANK    WRTPYT                          178186
     C                     MOVEL*BLANK    WRTPST                          178186
     C                     MOVEL*BLANK    WRTBKC                          178186
     C                     MOVEL*BLANK    WRTBCH                          178186
     C                     MOVEL*BLANK    WRTORB                          178186
     C                     MOVEL*BLANK    WRTPRF                          178186
      **                                                                  178186
     C           EXRTTN    TAG                                            178186
     C                     MOVEA*BLANKS   @STK,Q                          178186
     C                     SUB  1         Q                               178186
      *                                                                   178186
     C                     ENDSR                                          178186
      *================================================================   175477
      *  Format FONTIS branch bank information                            175477
      *================================================================   175477
     C           FONBNK    BEGSR                                          175477
      *                                                                   175477
      ** Inputs                                                           175477
      ** ------                                                           175477
      ****                                DSTRAN                          175477
      ** Outputs                                                          175477
      ** -------                                                          175477
      ****                                DSTRAN                          175477
      *                                                                   175477
      *  Set up subroutine stack name                                     175477
      *                                                                   175477
     C                     ADD  1         Q                               175477
     C                     MOVEL'FONBNK'  @STK,Q                          175477
      *                                                                   175477
     C                     MOVEL*BLANK    @I35                            175477
      *                                                                   175477
      * If first line is blank we shift the rest of the lines to the      175477
      * top                                                               175477
     C           TMLIN1    IFEQ *BLANK                                    175477
     C                     MOVELTMLIN2    TMLIN1                          175477
     C                     MOVELTMLIN3    TMLIN2                          175477
     C                     MOVELTMLIN4    TMLIN3                          175477
     C                     MOVELTMLIN5    TMLIN4                          175477
     C                     MOVELTMLIN6    TMLIN5                          175477
     C                     ENDIF                                          175477
      *                                                                   175477
      ** Check if the first line can be a swift adress                    175477
      ** If not we leave the procedure                                    175477
     C           ' '       CHEKRTMLIN1    WTMLEN  20                      175477
     C           WTMLEN    IFGT 11                                        175477
     C                     GOTO EXFNBK                                    175477
     C                     ENDIF                                          175477
      *                                                                   175477
     C                     MOVEATMLIN1    @I35                            175477
     C           8         SUBSTI35:1     W9BICC                          175477
     C           3         SUBSTI35:9     W9BICB                          175477
      *                                                                   175477
     C           W9BICB    IFEQ 'XXX'                                     175477
     C                     MOVEL*BLANK    W9BICB                          175477
     C                     ENDIF                                          175477
      *                                                                   175477
     C                     CALL 'ME1400'                                  175477
     C                     PARM *BLANKS   W9RTN   7                       175477
     C                     PARM           W9BICC  8                       175477
     C                     PARM           W9BICB  3                       175477
     C                     PARM           SDCUST                          175477
     C                     PARM           SDCNST                          175477
     C                     PARM           MEBICD                          175477
     C                     PARM *BLANKS   W9CUST  1                       175477
     C                     PARM *BLANKS   W9CNST  1                       175477
     C                     PARM *BLANKS   W9BICD  1                       175477
      *                                                                   175477
      ** If SWIFT ID found, map only the SWIFT address                    175477
      *                                                                   175477
     C           W9RTN     IFEQ *BLANKS                                   175477
     C                     MOVEL*BLANK    TMLIN1                          175477
     C                     MOVELW9BICC    TMLIN1                          175477
     C                     MOVEL*BLANK    TMLIN2                          175477
     C                     MOVEL*BLANK    TMLIN3                          175477
     C                     MOVEL*BLANK    TMLIN4                          175477
     C                     MOVEL*BLANK    TMLIN5                          175477
     C                     MOVEL*BLANK    TMLIN6                          175477
     C                     ENDIF                                          175477
      *                                                                   175477
      *  Unwind subroutine stack name                                     175477
      *                                                                   175477
     C           EXFNBK    TAG                                            175477
     C                     MOVEA*BLANKS   @STK,Q                          175477
     C                     SUB  1         Q       50                      175477
      *                                                                   175477
     C                     ENDSR                                          175477
      *================================================================   CFT014
      *  Shadow Postings for charges of Outgoing payment                  CFT014
      *================================================================   CFT014
     C           SPCGOP    BEGSR                                          CFT014
      *                                                                   CFT014
      *  Set up subroutine stack name                                     CFT014
      *                                                                   CFT014
     C                     ADD  1         Q                               CFT014
     C                     MOVEL'SPCGOP'  @STK,Q                          CFT014
      *                                                                                       CFT032
     C                     MOVE *BLANKS   PIBAN                                               CFT032
     C                     CLEARQ#DTA                                                      BUG220908
     C           ORBT      IFEQ *BLANKS                                                       CFT032
     C                     MOVELORC1      W#C1                                                CFT032
      *                                                                                       CFT032
     C           W#C1      IFEQ '/'                                                           CFT032
     C           34        SUBSTORC1:2    PIBAN                                               CFT032
     C           34        SUBSTORC1:2    Q#ACCT    P                                      BUG220908
     C                     ELSE                                                               CFT032
     C                     MOVELORC1      PIBAN                                               CFT032
     C                     MOVELORC1      Q#ACCT    P                                      BUG220908
     C                     ENDIF                                                              CFT032
      *                                                                                       CFT032
     C           ORCT      IFEQ 'I'                                                           CFT032
     C                     CALL 'AOIBANR4'                                                    CFT032
     C                     PARM           @RTCD                                               CFT032
     C                     PARM '*KEY   ' @OPTN                                               CFT032
     C                     PARM           PIBAN                                               CFT032
     C           P@ACCT    PARM *BLANKS   DSSDY                                               CFT032
     C**********           ENDIF                                                       CFT032 250600
      *                                                                                       CFT032
     C********** @RTCD     IFNE *BLANKS                                              CFT032 BUG15042
     C********** P@CNUM    CAT  P@ACOD    PIBAN     P                                CFT032 BUG15042
     C           @RTCD     IFEQ *BLANKS                                                     BUG15042
     C           P@CNUM    CAT  P@CCY     PIBAN     P                                       BUG15042
     C                     CAT  P@ACOD:0  PIBAN                                             BUG15042
     C                     CAT  P@ACSQ:0  PIBAN                                               CFT032
     C                     CAT  P@BRCA:0  PIBAN                                               CFT032
     C                     MOVELPIBAN     Q#ACCT    P                                      BUG220908
     C                     ENDIF                                                              CFT032
     C                     ENDIF                                                              250600
      *                                                                                       CFT032
     C                     ENDIF                                                              CFT032
      *                                                                   CFT014
      ** ONLY WHEN CFT009 IS NOT INSTALLED                                CFT009
      ** STP does not generate shadow posting for charges                 CFT014
      ** ------------------------------------------------                 CFT014
      ** because this process is not able to default the charges          CFT014
      ** amount. Therefore :                                              CFT014
      ** No need to generate shadow postings for charges when             CFT014
      ** - amount of receiver's charges is 0                              CFT014
      *                                                                   CFT009
      ** Sum all charges together if CFT009 on                            CFT009
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
     C                     EXSR SMOCHG                                    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT014
     C           F7RCRM    IFEQ 0                                         CFT014
     C           ##CHGS    ANDEQ0                                         CFT014
     C                     GOTO EXCGOP                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Include Receiver's Charges remitted, if present                  CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
     C                     SELEC                                          CFT014
     C           S7CDRO    WHNE *BLANKS                                   CFT014
     C                     ADD  OPRCSQ    ##CHGS                          CFT014
     C           V#ADDC    WHEQ 'A'                                       CFT014
     C                     ADD  OPRCSC    ##CHGS                          CFT014
     C                     OTHER                                          CFT014
     C                     ENDSL                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      *  Move fields to Q#DTA structure and call AOSPOSU0                 CFT014
      *                                                                   CFT014
     C*****                CLEARQ#DTA                                                      BUG220908
     C                     SELEC                                          CFT014
      *                                                                   CFT014
      *  If Account charges to be debited filled use it                   CFT014
      *                                                                   CFT014
     C           CDRT      WHNE *BLANKS                                   CFT014
     C                     MOVELCDRT      Q#ATYP                          CFT014
     C                     MOVELCDRO      Q#ACCT                          CFT014
     C                     EXSR SRFLGL                                                      HVB005
     C*****      6         SUBSTQ#ACCT:1  W#CNU1                                     CGL029 HVB005
     C*****      3         SUBSTQ#ACCT:7  Q#CCY1                                     CGL029 HVB005
     C*****      10        SUBSTQ#ACCT:10 W#ACO1                                     CGL029 HVB005
     C*****      2         SUBSTQ#ACCT:20 W#ACS1                                     CGL029 HVB005
     C*****      3         SUBSTQ#ACCT:22 Q#BRC1                                     CGL029 HVB005
     C*****                MOVE W#CNU1    Q#CNU1                                     CGL029 HVB005
     C*****                MOVE W#ACO1    Q#ACO1                                     CGL029 HVB005
     C*****                MOVE W#ACS1    Q#ACS1                                     CGL029 HVB005
     C                     MOVELCDBR      Q#BRCA                          CFT014
     C                     MOVELBJCYCD    Q#CCY                           CFT014
     C           ADDC      IFEQ 'A'                                       CFT014
     C                     Z-ADDSLDT      Q#VDAT                          CFT014
     C                     ELSE                                           CFT014
     C                     Z-ADDPVDT      Q#VDAT                          CFT014
     C                     END                                            CFT014
      *                                                                   CFT014
      *  If add use Ordering Bank and Ordering Customer                   CFT014
      *                                                                   CFT014
     C           ADDC      WHEQ 'A'                                       CFT014
     C                     MOVELSMCY      Q#CCY                           CFT014
     C           ORBT      IFNE *BLANKS                                   CFT014
     C                     MOVELORBT      Q#ATYP                          CFT014
     C                     MOVELORBK      Q#ACCT                          CFT014
     C                     EXSR SRFLGL                                                      HVB005
     C*****      6         SUBSTQ#ACCT:1  W#CNU1                                     CGL029 HVB005
     C*****      3         SUBSTQ#ACCT:7  Q#CCY1                                     CGL029 HVB005
     C*****      10        SUBSTQ#ACCT:10 W#ACO1                                     CGL029 HVB005
     C*****      2         SUBSTQ#ACCT:20 W#ACS1                                     CGL029 HVB005
     C*****      3         SUBSTQ#ACCT:22 Q#BRC1                                     CGL029 HVB005
     C*****                MOVE W#CNU1    Q#CNU1                                     CGL029 HVB005
     C*****                MOVE W#ACO1    Q#ACO1                                     CGL029 HVB005
     C*****                MOVE W#ACS1    Q#ACS1                                     CGL029 HVB005
     C                     MOVELORBB      Q#BRCA                          CFT014
     C           Q#ATYP    IFEQ 'R'                                                       AR1089518A
     C           10        SUBSTQ#ACCT:1  W#ACNO                                          AR1089518A
     C                     MOVE W#ACNO    Q#ACNO                                          AR1089518A
     C                     ENDIF                                                          AR1089518A
     C                     ELSE                                           CFT014
     C                     MOVELORCT      Q#ATYP                          CFT014
     C**********           MOVELORC1      Q#ACCT                          CFT014              CFT032
     C*********            MOVELPIBAN     Q#ACCT                                     BUG220908CFT032
     C                     EXSR SRFLGL                                                      HVB005
     C*****      6         SUBSTQ#ACCT:1  W#CNU1                                     CGL029 HVB005
     C*****      3         SUBSTQ#ACCT:7  Q#CCY1                                     CGL029 HVB005
     C*****      10        SUBSTQ#ACCT:10 W#ACO1                                     CGL029 HVB005
     C*****      2         SUBSTQ#ACCT:20 W#ACS1                                     CGL029 HVB005
     C*****      3         SUBSTQ#ACCT:22 Q#BRC1                                     CGL029 HVB005
     C*****                MOVE W#CNU1    Q#CNU1                                     CGL029 HVB005
     C*****                MOVE W#ACO1    Q#ACO1                                     CGL029 HVB005
     C*****                MOVE W#ACS1    Q#ACS1                                     CGL029 HVB005
     C                     END                                            CFT014
     C                     Z-ADDSLDT      Q#VDAT                          CFT014
     C                     OTHER                                          CFT014
      *                                                                   CFT014
      *  If deduct use Sender Correspondant Destination                   CFT014
      *                                                                   CFT014
     C                     MOVELPCCY      Q#CCY                           CFT014
     C           SNCT      IFNE *BLANKS                                   CFT014
     C                     MOVELSNCT      Q#ATYP                          CFT014
     C                     MOVELSNCO      Q#ACCT                          CFT014
     C                     EXSR SRFLGL                                                      HVB005
     C*****      6         SUBSTQ#ACCT:1  W#CNU1                                     CGL029 HVB005
     C*****      3         SUBSTQ#ACCT:7  Q#CCY1                                     CGL029 HVB005
     C*****      10        SUBSTQ#ACCT:10 W#ACO1                                     CGL029 HVB005
     C*****      2         SUBSTQ#ACCT:20 W#ACS1                                     CGL029 HVB005
     C*****      3         SUBSTQ#ACCT:22 Q#BRC1                                     CGL029 HVB005
     C*****                MOVE W#CNU1    Q#CNU1                                     CGL029 HVB005
     C*****                MOVE W#ACO1    Q#ACO1                                     CGL029 HVB005
     C*****                MOVE W#ACS1    Q#ACS1                                     CGL029 HVB005
     C                     ELSE                                           CFT014
     C                     MOVELDSTT      Q#ATYP                          CFT014
     C                     MOVELDST1      Q#ACCT                          CFT014
     C                     EXSR SRFLGL                                                      HVB005
     C*****      6         SUBSTQ#ACCT:1  W#CNU1                                     CGL029 HVB005
     C*****      3         SUBSTQ#ACCT:7  Q#CCY1                                     CGL029 HVB005
     C*****      10        SUBSTQ#ACCT:10 W#ACO1                                     CGL029 HVB005
     C*****      2         SUBSTQ#ACCT:20 W#ACS1                                     CGL029 HVB005
     C*****      3         SUBSTQ#ACCT:22 Q#BRC1                                     CGL029 HVB005
     C*****                MOVE W#CNU1    Q#CNU1                                     CGL029 HVB005
     C*****                MOVE W#ACO1    Q#ACO1                                     CGL029 HVB005
     C*****                MOVE W#ACS1    Q#ACS1                                     CGL029 HVB005
     C                     END                                            CFT014
     C                     Z-ADDPVDT      Q#VDAT                          CFT014
     C                     END                                            CFT014
      *                                                                   CFT014
      * Set posting date according to FT Control Data                     CFT014
      *                                                                   CFT014
     C           T#PDTI    IFEQ 'I'                                       CFT014
     C                     Z-ADDBJRDNB    Q#PSTD                          CFT014
     C                     ELSE                                           CFT014
     C           T#PDTI    IFEQ 'E'                                       CFT014
     C           ADDC      IFEQ 'A'                                       CFT014
     C                     Z-ADDSLDT      Q#PSTD                          CFT014
     C                     ELSE                                           CFT014
     C                     Z-ADDPVDT      Q#PSTD                          CFT014
     C                     END                                            CFT014
     C                     ELSE                                           CFT014
     C           SLDT      IFLT PVDT                                      CFT014
     C                     Z-ADDSLDT      Q#PSTD                          CFT014
     C                     ELSE                                           CFT014
     C                     Z-ADDPVDT      Q#PSTD                          CFT014
     C                     END                                            CFT014
     C                     END                                            CFT014
     C                     END                                            CFT014
      *                                                                   CFT014
     C                     MOVEL'I'       Q#IO                            CFT014
     C                     MOVELPYTP      Q#TRYP                          CFT014
     C                     MOVELPREF      Q#PREF                          CFT014
     C                     MOVEL'FT'      Q#MOD                           CFT014
     C                     MOVEL'01'      Q#OLRC                          CFT014
     C                     MOVEL##FTOV    Q#FTOV                          CFT014
     C           *LIKE     DEFN Q#AMT     ##CHGS                          CFT014
     C                     Z-ADD##CHGS    Q#AMT                           CFT014
     C                     MOVEL'Y'       Q#RPST                          CFT014
     C                     Z-ADD30        Q#RPNB                          CFT014
     C                     MOVEL'D'       Q#RTYP                          CFT014
     C           CAP205    IFEQ 'Y'                                                           CAP205
     C                     MOVEL'F'       Q#MTYP                                              CAP205
     C                     ENDIF                                                              CAP205
      *                                                                   CFT014
      *  Call AOSPOSU0                                                    CFT014
      *                                                                   CFT014
     C                     CALL 'AOSPOSU0'             90                 CFT014
     C           R#RTN     PARM *BLANKS   O#RTN   7                       CFT014
     C                     PARM '*ADD    'W0ACT   8                       CFT014
     C                     PARM Q#DTA     O#DTA 256                       CFT014
      *                                                                   CFT014
     C           *IN90     IFEQ '1'                                       CFT014
     C           R#RTN     ORNE *BLANKS                                   CFT014
     C                     MOVEL'AOSPOSU0'W0FILE           ************** CFT014
     C                     MOVEL'*CALL   'W0KEY            * DB ERROR 122 CFT014
     C                     Z-ADD122       W0ERNB           ************** CFT014
     C                     MOVEL'MEM5003' W0MSGD                          CFT014
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT014
     C                     EXSR SRERRA                                    CFT014
     C                     END                                            CFT014
      *                                                                   CFT014
      *  Unwind subroutine stack name                                     CFT014
      *                                                                   CFT014
     C           EXCGOP    TAG                                            CFT014
     C                     MOVEA*BLANKS   @STK,Q                          CFT014
     C                     SUB  1         Q       50                      CFT014
      *                                                                   CFT014
     C                     ENDSR                                          CFT014
      *================================================================   CFT014
      *  Fill fields related to MT103 Outgoing Payment                    CFT014
      *================================================================   CFT014
     C           FL103O    BEGSR                                          CFT014
      *                                                                   CFT014
      *  Set up subroutine stack name                                     CFT014
      *                                                                   CFT014
     C                     ADD  1         Q                               CFT014
     C                     MOVEL'FL103O'  @STK,Q                          CFT014
      *                                                                   CFT014
      ** Original exchange rate                                           CFT014
      *                                                                   CFT014
     C                     Z-ADDF4OEXR    OPOEXR                          CFT014
      *                                                                   CFT014
      ** Third Reimbursement institution                                  CFT014
      *                                                                   CFT014
     C                     MOVELF5TRIT    OPTRIT                          CFT014
     C                     MOVELS5TRI1    OPTRI1                          CFT014
     C                     MOVELS5TRI2    OPTRI2                          CFT014
     C                     MOVELS5TRI3    OPTRI3                          CFT014
     C                     MOVELS5TRI4    OPTRI4                          CFT014
     C                     MOVELS5TRI5    OPTRI5                          CFT014
      *                                                                   CFT014
      ** Transaction Type Code                                            CFT014
      *                                                                   CFT014
     C                     MOVELS5TTCD    OPTTCD                          CFT014
      *                                                                   CFT014
      ** Bank Operation Code                                              CFT014
      *                                                                   CFT014
     C                     MOVELS5BNCD    OPBOCD                          CFT014
      *                                                                   CFT014
      ** Instruction Code                                                 CFT014
      *                                                                   CFT014
     C                     MOVELS6INC1    OPICD1                          CFT014
     C                     MOVELS6INC2    OPICD2                          CFT014
     C                     MOVELS6INC3    OPICD3                          CFT014
     C                     MOVELS6INC4    OPICD4                          CFT014
     C                     MOVELS6INC5    OPICD5                          CFT014
      *                                                                   CFT014
      ** Regulatory reporting                                             CFT014
      *                                                                   CFT014
     C                     MOVELS6RRP1    OPRRP1                          CFT014
     C                     MOVELS6RRP2    OPRRP2                          CFT014
     C                     MOVELS6RRP3    OPRRP3                          CFT014
      *                                                                   CFT014
      ** Sender's charges                                                 CFT014
      *                                                                   CFT014
     C                     Z-ADDF7SCH1    OPSCH1                          CFT014
     C                     Z-ADDF7SCH2    OPSCH2                          CFT014
     C                     Z-ADDF7SCH3    OPSCH3                          CFT014
     C                     Z-ADDF7SCH4    OPSCH4                          CFT014
     C                     Z-ADDF7SCH5    OPSCH5                          CFT014
      *                                                                   CFT014
      ** Sender's charges currencies                                      CFT014
      *                                                                   CFT014
     C                     MOVELS7SCC1    OPSCC1                          CFT014
     C                     MOVELS7SCC2    OPSCC2                          CFT014
     C                     MOVELS7SCC3    OPSCC3                          CFT014
     C                     MOVELS7SCC4    OPSCC4                          CFT014
     C                     MOVELS7SCC5    OPSCC5                          CFT014
     C                     MOVELV#SENT    OPSCLE                          CFT014
      *                                                                   CFT014
      ** Compute charges in various currencies                            CFT014
      *                                                                   CFT014
     C                     MOVELS4PCCY    WCVCCY                          CFT014
     C                     Z-ADDF7RCRM    WCVCAM                          CFT014
     C                     MOVELS4PCCY    WCVPCY                          CFT014
     C                     MOVELS4SMCY    WCVSCY                          CFT014
     C                     Z-ADDF4PVDT    WCVPDT                          CFT014
     C                     Z-ADDF4SLDT    WCVSDT                          CFT014
     C                     MOVEL'Y'       WCVFCB                          CFT014
     C                     EXSR CVTCHG                                    CFT014
      *                                                                   CFT014
      ***Correct as processing is clearly wrong                     EEE058MK0551
      *****                                                         EEE058MK0551
     C*****                MOVEL*BLANKS   DSTRAN                    EEE058MK0551
     C*****                MOVELP71G      DSTRAN                    EEE058MK0551
     C*****      TMLIN     IFEQ *BLANKS                             EEE058MK0551
      *****                                                         EEE058MK0551
      ** Receiver's charges remitted                                      CFT014
      *                                                                   CFT014
     C                     Z-ADDWCVCRM    OPRCRM                          CFT014
      *                                                                   CFT014
      ** Receiver's charges base currency equivalent                      CFT014
     C                     Z-ADDWCVBCQ    OPRBCQ                          CFT014
      *                                                                   CFT014
      ** Calculate receiver's charges remitted in settlement ccy          CFT014
      *                                                                   CFT014
     C                     Z-ADDWCVCSC    OPRCSC                          CFT014
      *                                                                   CFT014
      ***Correct for Pekao                                          EEE058MK0551
      *****                                                         EEE058MK0551
     C*****                ELSE                                     EEE058MK0551
     C*****                Z-ADD0         OPRCRM                    EEE058MK0551
     C*****                Z-ADD0         OPRBCQ                    EEE058MK0551
     C****                 Z-ADD0         OPRCSC                    EEE058MK0551
     C*****                Z-ADDWCVCSC    OTTRCM                    EEE058MK0551
      * Set as base equivalent                                            E30002
     C*********            Z-ADDWCVCRM    ODUMA1                    EEE058E30002
     C*****                Z-ADDWCVCSQ    ODUMA1                    E30002MK0551
     C*****                ENDIF                                    EEE058MK0551
      *                                                                   CFT014
      ***Correct as processing is clearly wrong                     DB0012MK0551
      *****                                                         DB0012MK0551
     C*****                MOVEL*BLANKS   DSTRAN                    DB0012MK0551
     C*****                MOVELP71G      DSTRAN                    DB0012MK0551
     C*****      TMLIN     IFEQ *BLANKS                             DB0012MK0551
      ** Base currency equivalent of Receiver's Charges Remitted in       CFT014
      ** Settlement currency                                              CFT014
      *                                                                   CFT014
     C                     Z-ADDWCVCSQ    OPRCSQ                          CFT014
      *****                                                         DB0012MK0551
     C*****                ELSE                                     DB0012MK0551
     C*****                Z-ADD0         OPRCSQ                    DB0012MK0551
     C*****                ENDIF                                    DB0012MK0551
      *                                                                   CFT014
      ** Receiver's Charges Network used                                  CFT014
      *                                                                   CFT014
     C                     MOVEL'N'       OPRCUS                          CFT014
      *                                                                   CFT014
      ** Receiver's Charges Remitted Network ccy                          CFT014
      *                                                                   CFT014
     C                     MOVELS4RCCN    OPRCCN                          CFT014
      *                                                                   CFT014
      ** Receiver's Charges Remitted Network (Payment ccy)                CFT014
      *                                                                   CFT014
     C                     Z-ADDF4RCNW    OPRCNW                          CFT014
      *                                                                   CFT014
      *  Unwind subroutine stack name                                     CFT014
      *                                                                   CFT014
     C           EF103O    TAG                                            CFT014
     C                     MOVEA*BLANKS   @STK,Q                          CFT014
     C                     SUB  1         Q       50                      CFT014
      *                                                                   CFT014
     C                     ENDSR                                          CFT014
      *================================================================   CFT014
      *  Fill fields related to MT103 Incoming Payment                    CFT014
      *================================================================   CFT014
     C           FL103I    BEGSR                                          CFT014
      *                                                                   CFT014
      *  Set up subroutine stack name                                     CFT014
      *                                                                   CFT014
     C                     ADD  1         Q                               CFT014
     C                     MOVEL'FL103I'  @STK,Q                          CFT014
      *                                                                   CFT014
      ** Original Exchange Rate                                           CFT014
      *                                                                   CFT014
     C                     Z-ADDF1OEXR    INOEXR                          CFT014
      *                                                                   CFT014
      ** Third Reimbursement Institution (FT)                             CFT014
      *                                                                   CFT014
     C                     MOVELF1TRIT    INTRIT                          CFT014
     C                     MOVELS1TRIB    INTRIB                          CFT014
      *                                                                   CFT014
      ** Bank Operation Code                                              CFT014
      *                                                                   CFT014
     C                     MOVELS3BOCD    INBOCD                          CFT014
      *                                                                   CFT014
      ** Instruction Code                                                 CFT014
      *                                                                   CFT014
     C/COPY WNCPYSRC,FT0300MK08
     C                     MOVELS3ICD1    INICD1                          CFT014
     C                     MOVELS3ICD2    INICD2                          CFT014
     C                     MOVELS3ICD3    INICD3                          CFT014
     C                     MOVELS3ICD4    INICD4                          CFT014
     C                     MOVELS3ICD5    INICD5                          CFT014
     C/COPY WNCPYSRC,FT0300MK09
      *                                                                   CFT014
      ** Transaction type code                                            CFT014
      *                                                                   CFT014
     C                     MOVELS3TTCD    INTTCD                          CFT014
      *                                                                   CFT014
      ** Regulatory Reporting                                             CFT014
      *                                                                   CFT014
     C                     MOVELS3RRP1    INRRP1                          CFT014
     C                     MOVELS3RRP2    INRRP2                          CFT014
     C                     MOVELS3RRP3    INRRP3                          CFT014
      *                                                                   CFT014
      ** Sender's Charges                                                 CFT014
      *                                                                   CFT014
     C                     Z-ADDF0SCH1    INSCH1                          CFT014
     C                     Z-ADDF0SCH2    INSCH2                          CFT014
     C                     Z-ADDF0SCH3    INSCH3                          CFT014
     C                     Z-ADDF0SCH4    INSCH4                          CFT014
     C                     Z-ADDF0SCH5    INSCH5                          CFT014
      *                                                                   CFT014
      ** Sender's charges currencies                                      CFT014
      *                                                                   CFT014
     C                     MOVELS0SCC1    INSCY1                          CFT014
     C                     MOVELS0SCC2    INSCY2                          CFT014
     C                     MOVELS0SCC3    INSCY3                          CFT014
     C                     MOVELS0SCC4    INSCY4                          CFT014
     C                     MOVELS0SCC5    INSCY5                          CFT014
      *                                                                   CFT014
      ** Compute charges in various currencies                            CFT014
      *                                                                   CFT014
     C                     MOVELS1SMCY    WCVCCY                          CFT014
     C                     Z-ADDF0RCRM    WCVCAM                          CFT014
     C                     MOVELS1SMCY    WCVSCY                          CFT014
     C                     MOVELS1PCCY    WCVPCY                          CFT014
     C                     Z-ADDF1PVDT    WCVPDT                          CFT014
     C                     Z-ADDF1SLDT    WCVSDT                          CFT014
     C                     MOVEL'Y'       WCVFCB                          CFT014
      *                                                                   CFT014
      ** Receiver's Charges Network used                                  CFT014
      *                                                                   CFT014
     C                     MOVEL'N'       INRCUS                          CFT014
      *                                                                   CFT014
      ** Receiver's Charges Remitted Network ccy                          CFT014
      *                                                                   CFT014
     C                     MOVELS1RCCN    INRCCN                          CFT014
      *                                                                   CFT014
      ** Receiver's Charges Remitted Network                              CFT014
      *                                                                   CFT014
     C                     Z-ADDF1RCNW    INRCNW                          CFT014
     C                     Z-ADDF1RCNW    INRCRM                          EEE058
      *                                                                   CFT014
      *  Unwind subroutine stack name                                     CFT014
      *                                                                   CFT014
     C           EF103I    TAG                                            CFT014
     C                     MOVEA*BLANKS   @STK,Q                          CFT014
     C                     SUB  1         Q       50                      CFT014
      *                                                                   CFT014
     C                     ENDSR                                          CFT014
      *================================================================   CFT014
      *  Convert charges in payment, settlement, base, settlement/base    CFT014
      *================================================================   CFT014
     C           CVTCHG    BEGSR                                          CFT014
      *                                                                   CFT014
      *  Set up subroutine stack name                                     CFT014
      *                                                                   CFT014
     C                     ADD  1         Q                               CFT014
     C                     MOVEL'CVTCHG'  @STK,Q                          CFT014
      *                                                                   CFT014
      ** Inputs                                                           CFT014
      ** ------                                                           CFT014
      ** Currency of charges                                              CFT014
     C           *LIKE     DEFN WRCHCY    WCVCCY                          CFT014
      ** Pay currency                                                     CFT014
     C           *LIKE     DEFN WRCHCY    WCVPCY                          CFT014
      ** Settlement currency                                              CFT014
     C           *LIKE     DEFN WRCHCY    WCVSCY                          CFT014
      ** Amount of charges                                                CFT014
     C           *LIKE     DEFN F7RCRM    WCVCAM                          CFT014
      ** Payment value date                                               CFT014
     C           *LIKE     DEFN F4PVDT    WCVPDT                          CFT014
      ** Settlement value date                                            CFT014
     C           *LIKE     DEFN F4SLDT    WCVSDT                          CFT014
      ** Convert in base currency (Y/N)                                   CFT014
     C           *LIKE     DEFN WACDMP    WCVFCB                          CFT014
      *                                                                   CFT014
      ** Outputs                                                          CFT014
      ** -------                                                          CFT014
      ** Charges in Pay currency                                          CFT014
     C           *LIKE     DEFN F7RCRM    WCVCRM                          CFT014
      ** Charges in Base currency                                         CFT014
     C           *LIKE     DEFN OPRBCQ    WCVBCQ                          CFT014
      ** Charges in Settlement currency                                   CFT014
     C           *LIKE     DEFN OPRCSC    WCVCSC                          CFT014
      ** Charges in Base currency (From settlement currency)              CFT014
     C           *LIKE     DEFN OPRCSQ    WCVCSQ                          CFT014
      *                                                                   CFT014
     C                     Z-ADD0         WCVCRM                          CFT014
     C                     Z-ADD0         WCVBCQ                          CFT014
     C                     Z-ADD0         WCVCSC                          CFT014
     C                     Z-ADD0         WCVCSQ                          CFT014
      *                                                                   CFT014
      ** Receiver's charges remitted                                      CFT014
      ** Don't need to be converted if It is the same as                  CFT014
      ** pay currency                                                     CFT014
      *                                                                   CFT014
     C           WCVPCY    IFNE *BLANK                                    CFT014
      *                                                                   CFT014
     C           WCVCCY    IFEQ WCVPCY                                    CFT014
     C                     Z-ADDWCVCAM    WCVCRM                          CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
      ** Calculate receiver's charges remitted in pay ccy                 CFT014
     C                     CLEARP#0010                                    CFT014
     C                     Z-ADDWCVPDT    P#FRDT                          CFT014
     C                     Z-ADDWCVPDT    P#TODT                          CFT014
     C                     MOVELWCVCCY    P#FRCY                          CFT014
     C                     Z-ADDWCVCAM    P#FRAM                          CFT014
     C                     MOVELWCVPCY    P#TOCY                          CFT014
     C                     CALL 'FT0010'                                  CFT014
     C                     PARM           P#0010                          CFT014
      *                                                                   CFT014
     C           P#RTCD    IFNE *BLANK                                    CFT014
     C                     MOVEL'FT0010  'W0FILE           ***************CFT014
     C                     MOVEL'*CALL  ' W0KEY            * DB ERROR 128*CFT014
     C                     Z-ADD128       W0ERNB           ***************CFT014
     C                     MOVEL'MEM5003' W0MSGD                          CFT014
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT014
     C                     EXSR SRERRA                                    CFT014
     C                     ELSE                                           CFT014
     C                     Z-ADDP#TOAM    WCVCRM                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Note!!!! For OP transactions only.                               CFT014
      ** Ideally, the Receiver's Charges Remitted field for the           CFT014
      ** new OP transaction must be calculated by subtracting the         CFT014
      ** default OP charges from the network field 71G.  Since            CFT014
      ** Auto Generation does not default OP charges (unlike in FT0345)   CFT014
      ** the Receivers Charges received from SWIFT                        CFT014
      ** will be the SAME as the Receivers charges the outgoing           CFT014
      ** will send. However, if some form of defaulting is                CFT014
      ** added in the future, the following codes must be added by        CFT014
      ** that enhancement:                                                CFT014
      *     1.  Add all the OP charges                                    CFT014
      *     2.  Convert the sum of charges to Pay currency                CFT014
      *     3.  WCVRCM = WCVRCM less #2 result                            CFT014
      ** End of note.                                                     CFT014
     C           S4PYTP    IFEQ 'OP'                                      CFT009
     C           CFT009    ANDEQ'Y'                                       CFT009
     C           WCHGD     ANDEQ*BLANKS                                                       CFT017
      *         Add all the OP charges                                    CFT009
     C           OTCHCM    ADD  OTTRCM    SUMCHG 150                      CFT009
     C                     ADD  OTTXCH    SUMCHG                          CFT009
     C                     ADD  OTCQCH    SUMCHG                          CFT009
     C                     ADD  OTCSTA    SUMCHG                          CFT009
     C                     ADD  OTSPCH    SUMCHG                          CFT009
     C                     ADD  OTMSCH    SUMCHG                          CFT009
     C                     ADD  OMISC1    SUMCHG                          CFT009
     C                     ADD  OMISC2    SUMCHG                          CFT009
     C                     ADD  OMISC3    SUMCHG                          CFT009
     C                     ADD  OMISC4    SUMCHG                          CFT009
     C                     ADD  OMISC5    SUMCHG                          CFT009
     C           CFT010    IFEQ 'Y'                                       CFT009
     C                     ADD  OTVATT    SUMCHG                          CFT009
     C                     ENDIF                                          CFT009
      *         Convert the sum of charges to Pay currency                CFT009
     C                     CLEARP#0010                                    CFT009
     C                     Z-ADDWCVPDT    P#FRDT                          CFT009
     C                     Z-ADDWCVPDT    P#TODT                          CFT009
     C                     MOVELV#RCCY    P#FRCY                          CFT009
     C                     Z-ADDSUMCHG    P#FRAM                          CFT009
     C                     MOVELWCVPCY    P#TOCY                          CFT009
     C                     CALL 'FT0010'                                  CFT009
     C                     PARM           P#0010                          CFT009
      *                                                                   CFT009
     C           P#RTCD    IFNE *BLANK                                    CFT009
     C                     MOVEL'FT0010  'W0FILE           ***************CFT009
     C                     MOVEL'*CALL  ' W0KEY            * DB ERROR 144*CFT009
     C                     Z-ADD144       W0ERNB           ***************CFT009
     C                     MOVEL'MEM5003' W0MSGD                          CFT009
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT009
     C                     EXSR SRERRA                                    CFT009
     C                     ELSE                                           CFT009
     C                     SUB  P#TOAM    WCVCRM                          CFT009
      *                                                                   CFT009
      ** IF RESULT IS NEGATIVE, ZERO OUT WCVCRM (RECEIVER'S CHARGES       CFT009
      ** REMITTED). THIS MEANS NO FURTHER CHARGES TO BE PASSED ONTO THE   CFT009
      ** NEXT DESTINATION IN THE PAYMENT CHAIN                            CFT009
      *                                                                   CFT009
     C           WCVCRM    IFLT 0                                         CFT009
     C                     Z-ADD0         WCVCRM                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** If Outgoing payments, and MIF flag is 'Y' and                                        CFT017
      ** Receiver's charges remitted is zero, then default                                    CFT017
      ** it to MIF Interchange fee defined in ICD.                                            CFT017
      *                                                                                       CFT017
     C           S4PYTP    IFEQ 'OP'                                                          CFT017
     C           V#MIFF    ANDEQ'Y'                                                           CFT017
     C           F4RCNW    IFEQ *ZERO                                                         CFT017
     C           WCVCRM    OREQ *ZERO                                                         CFT017
     C                     Z-ADDBTMIFE    WCVCRM                                              CFT017
     C                     ENDIF                                                              CFT017
     C                     ENDIF                                                              CFT017
      *                                                                                       CFT017
      ** Calculate receiver's charges base currency equivalent            CFT014
      ** Don't need to be converted if It is the same as                  CFT014
      ** base currency equivalent                                         CFT014
     C           WCVFCB    IFEQ 'Y'                                       CFT014
     C           WCVPCY    IFEQ BJCYCD                                    CFT014
     C                     Z-ADDWCVCRM    WCVBCQ                          CFT014
     C                     ELSE                                           CFT014
     C                     CLEARP#0010                                    CFT014
     C                     Z-ADDWCVPDT    P#FRDT                          CFT014
     C                     Z-ADDWCVPDT    P#TODT                          CFT014
     C                     MOVELWCVPCY    P#FRCY                          CFT014
     C                     Z-ADDWCVCRM    P#FRAM                          CFT014
     C                     MOVELBJCYCD    P#TOCY                          CFT014
     C                     CALL 'FT0010'                                  CFT014
     C                     PARM           P#0010                          CFT014
      *                                                                   CFT014
     C           P#RTCD    IFNE *BLANK                                    CFT014
     C                     MOVEL'FT0010  'W0FILE           ***************CFT014
     C                     MOVEL'*CALL  ' W0KEY            * DB ERROR 123*CFT014
     C                     Z-ADD123       W0ERNB           ***************CFT014
     C                     MOVEL'MEM5003' W0MSGD                          CFT014
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT014
     C                     EXSR SRERRA                                    CFT014
     C                     ELSE                                           CFT014
     C                     Z-ADDP#TOAM    WCVBCQ                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Calculate receiver's charges remitted in settlement ccy          CFT014
      ** Don't need to be converted if It is the same as                  CFT014
      ** settlement currency                                              CFT014
     C           WCVSCY    IFNE *BLANK                                    CFT014
     C           WCVPCY    IFEQ WCVSCY                                    CFT014
     C                     Z-ADDWCVCRM    WCVCSC                          CFT014
     C                     ELSE                                           CFT014
     C                     CLEARP#0010                                    CFT014
     C                     Z-ADDWCVPDT    P#FRDT                          CFT014
     C                     Z-ADDWCVSDT    P#TODT                          CFT014
     C                     MOVELWCVPCY    P#FRCY                          CFT014
     C                     Z-ADDWCVCRM    P#FRAM                          CFT014
     C                     MOVELWCVSCY    P#TOCY                          CFT014
     C                     Z-ADD0         P#TOAM                          CFT014
     C                     Z-ADD0         P#RATE                          CFT014
     C                     CALL 'FT0010'                                  CFT014
     C                     PARM           P#0010                          CFT014
      *                                                                   CFT014
     C           P#RTCD    IFNE *BLANK                                    CFT014
     C                     MOVEL'FT0010  'W0FILE           ***************CFT014
     C                     MOVEL'*CALL  ' W0KEY            * DB ERROR 124*CFT014
     C                     Z-ADD124       W0ERNB           ***************CFT014
     C                     MOVEL'MEM5003' W0MSGD                          CFT014
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT014
     C                     EXSR SRERRA                                    CFT014
     C                     ELSE                                           CFT014
     C                     Z-ADDP#TOAM    WCVCSC                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Base currency equivalent of Receiver's Charges Remitted in       CFT014
      ** Settlement currency                                              CFT014
      ** Don't need to be converted if settlement currency is the         CFT014
      ** same as base currency                                            CFT014
     C           WCVSCY    IFNE *BLANK                                    CFT014
     C           WCVFCB    ANDEQ'Y'                                       CFT014
     C           WCVSCY    IFEQ BJCYCD                                    CFT014
     C                     Z-ADDWCVCSC    WCVCSQ                          CFT014
     C                     ELSE                                           CFT014
     C                     CLEARP#0010                                    CFT014
     C                     Z-ADDWCVPDT    P#FRDT                          CFT014
     C                     Z-ADDWCVSDT    P#TODT                          CFT014
     C                     MOVELWCVSCY    P#FRCY                          CFT014
     C                     Z-ADDWCVCSC    P#FRAM                          CFT014
     C                     MOVELBJCYCD    P#TOCY                          CFT014
     C                     Z-ADD0         P#TOAM                          CFT014
     C                     Z-ADD0         P#RATE                          CFT014
     C                     CALL 'FT0010'                                  CFT014
     C                     PARM           P#0010                          CFT014
      *                                                                   CFT014
     C           P#RTCD    IFNE *BLANK                                    CFT014
     C                     MOVEL'FT0010  'W0FILE           ***************CFT014
     C                     MOVEL'*CALL  ' W0KEY            * DB ERROR 125*CFT014
     C                     Z-ADD125       W0ERNB           ***************CFT014
     C                     MOVEL'MEM5003' W0MSGD                          CFT014
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT014
     C                     EXSR SRERRA                                    CFT014
     C                     ELSE                                           CFT014
     C                     Z-ADDP#TOAM    WCVCSQ                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Reset Input parameters                                           CFT014
     C                     MOVEL*BLANK    WCVCCY                          CFT014
     C                     MOVEL*BLANK    WCVPCY                          CFT014
     C                     MOVEL*BLANK    WCVSCY                          CFT014
     C                     MOVEL*BLANK    WCVFCB                          CFT014
     C                     Z-ADD0         WCVCAM                          CFT014
     C                     Z-ADD0         WCVPDT                          CFT014
     C                     Z-ADD0         WCVSDT                          CFT014
      *                                                                   CFT014
      *  Unwind subroutine stack name                                     CFT014
      *                                                                   CFT014
     C           EXCVCG    TAG                                            CFT014
     C                     MOVEA*BLANKS   @STK,Q                          CFT014
     C                     SUB  1         Q       50                      CFT014
      *                                                                   CFT014
     C                     ENDSR                                          CFT014
      *================================================================   CFT014
      *  Set up charges to be validated for outgoing payment              CFT014
      *================================================================   CFT014
     C           CHGOP     BEGSR                                          CFT014
      *                                                                   CFT014
      *  Set up subroutine stack name                                     CFT014
      *                                                                   CFT014
     C                     ADD  1         Q                               CFT014
     C                     MOVEL'CHGOP '  @STK,Q                          CFT014
      *                                                                   CFT014
      *  Set up input charge currency                                     CFT014
      *                                                                   CFT014
     C                     SELEC                                          CFT014
      *                                                                   CFT014
     C           BTCHCY    WHEQ 'B'                                       CFT014
     C           S7CDRO    ORNE *BLANKS                                   CFT014
     C                     MOVELV#BCCY    V#CCCY                          CFT014
      *                                                                   CFT014
     C           BTCHCY    WHEQ 'L'                                       CFT014
     C                     MOVELV#LCCY    V#CCCY                          CFT014
      *                                                                   CFT014
     C           BTCHCY    WHEQ 'C'                                       CFT014
     C           V#ADDC    ANDEQ'A'                                       CFT014
     C                     MOVELS4SMCY    V#CCCY                          CFT014
      *                                                                   CFT009
     C           BTCHCY    WHEQ 'C'                                       CFT009
     C           V#ADDC    ANDEQ'D'                                       CFT009
     C                     MOVELS4PCCY    V#CCCY                          CFT009
      *                                                                   CFT009
     C           BTCHCY    WHEQ 'F'                                       CFT009
     C                     MOVE FCHCCY    V#CCCY                          CFT009
      *                                                                   CFT009
     C                     OTHER                                          CFT009
     C                     Z-ADD102       DBASE            ***************CFT009
     C                     MOVEL'FT0300'  DBFILE           * DBERR 102   *CFT009
     C                     MOVEL*BLANKS   DBKEY            ***************CFT009
     C                     OUT  LDA                                       CFT009
     C                     EXSR *PSSR                                     CFT009
     C                     ENDSL                                          CFT009
     C***************      OTHER                                    CFT014CFT009
     C***************      MOVELS4PCCY    V#CCCY                    CFT014CFT009
     C***************      ENDSL                                    CFT014CFT009
      *                                                                   CFT009
      * Save LEVIED currency                                              CFT009
     C                     MOVELV#CCCY    LEVIED  3                       CFT009
      *                                                                   CFT014
      *  Set up Charge currency                                           CFT014
      *                                                                   CFT014
     C                     SELEC                                          CFT014
      *                                                                   CFT014
     C           S7CDRO    WHNE *BLANKS                                   CFT014
     C                     MOVELV#BCCY    V#RCCY                          CFT014
      *                                                                   CFT014
     C           V#ADDC    WHEQ 'A'                                       CFT014
     C                     MOVELS4SMCY    V#RCCY                          CFT014
      *                                                                   CFT014
     C                     OTHER                                          CFT014
     C                     MOVELS4PCCY    V#RCCY                          CFT014
     C                     ENDSL                                          CFT014
     C/COPY WNCPYSRC,FT0300DB04                                           EEE058
      *                                                                   CFT014
      ** NOTE : Auto Generation Payment doesn't retrieve the              CFT014
      ** default charges unlike FT0345.                                   CFT014
      ** The following codes are copied from SROPS3.                      CFT014
      *                                                                   CFT014
      * Charges                                                           CFT014
      *                                                                   CFT014
      * Transfer and Commission                                           CFT014
     C                     MOVELS7TRCD    S7TRCD                          CFT014
      * Telex                                                             CFT014
     C                     MOVELS7TXCD    S7TXCD                          CFT014
      * Cheque                                                            CFT014
     C                     MOVELS7CQCD    S7CQCD                          CFT014
      * Costs Abroad                                                      CFT014
     C                     MOVELS7CSTD    S7CSTD                          CFT014
      * SWIFT Priority                                                    CFT014
     C                     MOVELS7SPCD    S7SPCD                          CFT014
      * Miscellaneous                                                     CFT014
     C                     MOVELS7MSCD    S7MSCD                          CFT014
      *                                                                   CFT014
      ** Compute charges in payment currency                              CFT014
      *                                                                   CFT014
     C           S7DETC    IFEQ 'OUR'                                     CFT014
     C           S4ADDC    ANDEQ'A'                                       CFT014
     C                     MOVELS4RCCN    WCVCCY                          CFT014
     C                     Z-ADDF4RCNW    WCVCAM                          CFT014
     C                     MOVELS4PCCY    WCVPCY                          CFT014
     C                     Z-ADDF4PVDT    WCVPDT                          CFT014
     C                     EXSR CVTCHG                                    CFT014
      *                                                                                       CFT017
      ** Set flag to 'Y' to prevent charges to be deducted twice.                             CFT017
     C                     MOVEL'Y'       WCHGD   1                                           CFT017
      *                                                                   CFT014
      ** Format Receiver Charges to be validated                          CFT014
     C                     MOVEL*BLANK    ZFIELD                          CFT014
     C                     MOVE WCVCRM    ZFIELD                          CFT014
     C                     Z-ADDPCNBDP    ZADEC                           CFT014
     C                     EXSR ZEDIT                                     CFT014
     C                     MOVE ZFIELD    S7RCRM                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                                       STP033
     C                     Z-ADDOTTRCM    F7TRCM                                              STP033
     C                     Z-ADDOTTXCH    F7TXCH                                              STP033
     C                     Z-ADDOTCQCH    F7CQCH                                              STP033
     C                     Z-ADDOSWSCH    F7STCH                                              STP033
     C                     Z-ADDOTSPCH    F7SPCH                                              STP033
     C                     Z-ADDOTMSCH    F7MSCH                                              STP033
     C                     Z-ADDMISC01    F7M1CH                                              STP033
     C                     Z-ADDMISCC2    F7M2CH                                              STP033
     C                     Z-ADDMISCC3    F7M3CH                                              STP033
     C                     Z-ADDMISCC4    F7M4CH                                              STP033
     C                     Z-ADDMISCC5    F7M5CH                                              STP033
     C                     Z-ADDOTCSTA    F7CSTA                                              STP033
     C                     Z-ADDOTCHCM    F7CHCM                                              STP033
     C           CFT010    IFEQ 'Y'                                                           STP033
     C                     ADD  OTVATT    F7VATT                                              STP033
     C                     ENDIF                                                              STP033
      *                                                                   CFT014
      *  Unwind subroutine stack name                                     CFT014
      *                                                                   CFT014
     C           EXSGOP    TAG                                            CFT014
     C                     MOVEA*BLANKS   @STK,Q                          CFT014
     C                     SUB  1         Q       50                      CFT014
      *                                                                   CFT014
     C                     ENDSR                                          CFT014
      *================================================================   CFT014
      *  Set up charges to be validated for incoming payment              CFT014
      *================================================================   CFT014
     C           CHGIN     BEGSR                                          CFT014
      *                                                                   CFT014
      *  Set up subroutine stack name                                     CFT014
      *                                                                   CFT014
     C                     ADD  1         Q                               CFT014
     C                     MOVEL'CHGIN '  @STK,Q                          CFT014
      *                                                                   CFT014
      * Set up default charge currencies - input currency                 CFT014
      *                                                                   CFT014
     C                     SELEC                                          CFT014
     C           BTCHCY    WHEQ 'B'                                       CFT014
     C           S0CDRO    ORNE *BLANKS                                   CFT014
     C                     MOVELV#BCCY    V#CCCY                          CFT014
      *                                                                   CFT014
     C           BTCHCY    WHEQ 'L'                                       CFT014
     C                     MOVELV#LCCY    V#CCCY                          CFT014
      *                                                                   CFT014
     C           BTCHCY    WHEQ 'C'                                       CFT014
     C           V#ADDC    ANDEQ'A'                                       CFT014
     C                     MOVELS1SMCY    V#CCCY                          CFT014
      *                                                                   CFT014
      *                                                                   CFT009
     C           BTCHCY    WHEQ 'C'                                       CFT009
     C           V#ADDC    ANDEQ'D'                                       CFT009
     C                     MOVELS1PCCY    V#CCCY                          CFT009
      *                                                                   CFT014
     C           BTCHCY    WHEQ 'F'                                       CFT009
     C                     MOVE FCHCCY    V#CCCY                          CFT009
      *                                                                   CFT009
     C                     OTHER                                          CFT009
     C                     Z-ADD103       DBASE            ***************CFT009
     C                     MOVEL'FT0300'  DBFILE           * DBERR 103   *CFT009
     C                     MOVEL*BLANKS   DBKEY            ***************CFT009
     C                     OUT  LDA                                       CFT009
     C                     EXSR *PSSR                                     CFT009
     C                     ENDSL                                          CFT009
      *                                                                   CFT014
     C***************      OTHER                                    CFT014CFT009
     C***************      MOVELS1PCCY    V#CCCY                    CFT014CFT009
     C***************      ENDSL                                    CFT014CFT009
      *                                                                   CFT014
      *  Currency of charge                                               CFT014
      *                                                                   CFT014
     C                     SELEC                                          CFT014
      *                                                                   CFT014
     C           S0CDRO    WHNE *BLANKS                                   CFT014
     C                     MOVELV#BCCY    V#RCCY                          CFT014
      *                                                                   CFT014
     C           V#ADDC    WHEQ 'A'                                       CFT014
     C                     MOVELS1SMCY    V#RCCY                          CFT014
      *                                                                   CFT014
     C           PNWRK     IFEQ 'CASHV8'                                  CFT014
     C           S1PCCY    ANDEQV#BCCY                                    CFT014
     C                     MOVELS1PCCY    V#RCCY                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     OTHER                                          CFT014
     C                     MOVELS1PCCY    V#RCCY                          CFT014
     C                     ENDSL                                          CFT014
     C/COPY WNCPYSRC,FT0300MK99                                           MK0560
      *                                                                   CFT014
     C                     MOVELF0CDRT    V#CDRT                          CFT014
      *                                                                   CFT014
      * Details of Charges                                                CFT014
     C                     MOVELS0DETC    S0DETC                          CFT014
      *                                                                   CFT014
      ** NOTE : Auto Generation Payment doesn't retrieve the              CFT014
      ** default charges unlike FT0355.                                   CFT014
      ** The following codes are copied from SRINS3.                      CFT014
      *
      * Charges
      *                                                                   CFT014
      * Transfer and Commission                                           CFT014
     C                     MOVELS0TRCD    S0TRCD                          CFT014
      * Telex                                                             CFT014
     C                     MOVELS0TXCD    S0TXCD                          CFT014
      * Cheque                                                            CFT014
     C                     MOVELS0CQCD    S0CQCD                          CFT014
      * Advice Charge                                                     CFT014
     C                     MOVELS0ADCD    S0ADCD                          CFT014
      * Telephone charge                                                  CFT014
     C                     MOVELS0TLCD    S0TLCD                          CFT014
      * Miscellaneous                                                     CFT014
     C                     MOVELS0MSCD    S0MSCD                          CFT014
      *                                                                   CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
     C           S0DETC    ANDEQ'OUR'                                                       MK0560
      *                                                                   CFT014
      ** Compute charges :71G: in settlement currency                     CFT014
      *                                                                   CFT014
     C                     MOVELS1RCCN    WCVCCY                          CFT014
     C                     Z-ADDF1RCNW    WCVCAM                          CFT014
     C                     MOVELS1SMCY    WCVSCY                          CFT014
     C                     Z-ADDF1SLDT    WCVSDT                          CFT014
     C                     Z-ADDF1PVDT    WCVPDT                          CFT014
     C                     EXSR CVTCHG                                    CFT014
      *                                                                   CFT014
      ** Format Receiver Charges to be validated                          CFT014
     C                     MOVEL*BLANK    ZFIELD                          CFT014
     C                     MOVE WCVCSC    ZFIELD                          CFT014
     C                     Z-ADDSCNBDP    ZADEC                           CFT014
     C                     EXSR ZEDIT                                     CFT014
     C                     MOVE ZFIELD    S0RCRM                          CFT014
     C*                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      *  Unwind subroutine stack name                                     CFT014
      *                                                                   CFT014
     C           EXSGIN    TAG                                            CFT014
     C                     MOVEA*BLANKS   @STK,Q                          CFT014
     C                     SUB  1         Q       50                      CFT014
      *                                                                   CFT014
     C                     ENDSR                                          CFT014
      *================================================================   CGL009
     C/EJECT                                                              CFT009
      *****************************************************************   CFT009
      *                                                               *   CFT009
      *  DFICHG   : Default incoming charges                          *   CFT009
      *                                                               *   CFT009
      *  CALLED BY: SRINFT                                            *   CFT009
      *                                                               *   CFT009
      *****************************************************************   CFT009
     CSR         DFICHG    BEGSR                                          CFT009
      *                                                                   CFT009
      *  Set up subroutine stack name                                     CFT009
      *                                                                   CFT009
     C                     ADD  1         Q       50                      CFT009
     C                     MOVEL'DFICHG'  @STK,Q                          CFT009
      *                                                                   CFT009
     C                     CLEARINPYDS                                    CFT009
     C                     CLEARINPXDS                                    CFT009
     C                     CLEARTRNDET                                    CFT009
     C                     CLEARTRNEXT                                    CFT009
      *                                                                   CFT009
      * Move details into incoming payment details DS                     CFT009
      *                                                                   CFT009
     C                     EXSR MVINDS                                    CFT009
      *                                                                   CFT009
     C                     MOVELINPYDS    TRNDET                          CFT009
     C                     MOVELINPXDS    TRNEXT                          CFT009
     C                     MOVELGNMSET    SETNUM                          CFT009
     **C*PY*WNCPYSRC,FT0300DB05                                           EEE058            AR856737
      *                                                                   CFT009
     C                     CALL 'FT000980'                                CFT009
     C                     PARM *BLANKS   RETCDE                          CFT009
     C                     PARM           TRNDET                          CFT009
     C                     PARM           TRNEXT                          CFT009
     C                     PARM 'IN'      TRNTYP  2                       CFT009
     C*****                PARM 'S'       PRCMTD  1                 CFT009STP017
     C                     PARM 'Y'       PRCMTD  1                       STP017
     C                     PARM GNMTPY    MESTYP  3                       CFT009
     C                     PARM           SETNUM  3                       CFT009
     C                     PARM LCSETM    CLSTTM  2                       MKCAR1
      *                                                                   CFT009
     C                     MOVELTRNDET    INPYDS                          CFT009
     C                     MOVELTRNEXT    INPXDS                          CFT009
      *                                                                   MK0507
      ** Pay Amount                                                       MK0507
      *                                                                   MK0507
     C                     Z-ADDPYAM      F1PYAM                          MK0507
      *                                                                   MK0508
      * Set up date offset code                                           MK0508
      *                                                                   MK0508
     C           PDTOCD    IFNE *BLANKS                                   MK0508
     C                     MOVELPDTOCD    OPPDOF                          MK0508
     C                     ENDIF                                          MK0508
      *                                                                   MK0508
      *                                                                   STP997
     C           #EXTRN    IFEQ 'Y'                                       STP997
     C                     Z-ADDSMAM      F1SMAM                          STP997
     C                     ENDIF                                          STP997
      *                                                                   CFT009
      ** Exchange rate                                                    CFT009
      *                                                                   CFT009
     C                     Z-ADDRATE      F1RATE                          CFT009
      *                                                                   CFT009
      * Convert it in Midas day number - settle date                      CFT009
      *                                                                   CFT009
     C                     Z-ADDSLDTD1    ZDATE                           CFT009
      *                                                                   CFT009
     C                     CALL 'ZDATE1'               9090               CFT009
     C                     PARM *BLANKS   ZERR    7                       CFT009
     C                     PARM           ZDATE   60                      CFT009
     C                     PARM WUDFF     ZDATFM  1                       CFT009
     C                     PARM *ZEROS    ZDAYNO  50                      CFT009
      *                                                                   CFT009
     C                     Z-ADDZDAYNO    F1SLDT                          CFT009
      *                                                                   CFT009
      *  If error on call                                                 CFT009
      *                                                                   CFT009
     C           *IN90     IFEQ *ON                                       CFT009
     C                     MOVEL'ZDATE1  'W0FILE           ***************CFT009
     C                     MOVEL'*CALL'   W0KEY            * DB ERROR 145*CFT009
     C                     Z-ADD145       W0ERNB           ***************CFT009
     C                     MOVEL'MEM5003' W0MSGD                          CFT009
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT009
     C                     EXSR SRERRA                                    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      * Convert it in Midas day number - pay date                         CFT009
      *                                                                   CFT009
     C                     Z-ADDPVDTD1    ZDATE                           CFT009
      *                                                                   CFT009
     C                     CALL 'ZDATE1'               9090               CFT009
     C                     PARM *BLANKS   ZERR    7                       CFT009
     C                     PARM           ZDATE   60                      CFT009
     C                     PARM WUDFF     ZDATFM  1                       CFT009
     C                     PARM *ZEROS    ZDAYNO  50                      CFT009
      *                                                                   CFT009
     C                     Z-ADDZDAYNO    F1PVDT                          CFT009
      *                                                                   CFT009
      *  If error on call                                                 CFT009
      *                                                                   CFT009
     C           *IN90     IFEQ *ON                                       CFT009
     C                     MOVEL'ZDATE1  'W0FILE           ***************CFT009
     C                     MOVEL'*CALL'   W0KEY            * DB ERROR 146*CFT009
     C                     Z-ADD146       W0ERNB           ***************CFT009
     C                     MOVEL'MEM5003' W0MSGD                          CFT009
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT009
     C                     EXSR SRERRA                                    CFT009
     C                     ENDIF                                          CFT009
     **C*PY*WNCPYSRC,FT0300DB06                                           EEE058            AR856737
      *                                                                   CFT009
      ** Default VAT flags, total VAT, VAT rate, entry charges            CFT009
      *                                                                   CFT009
     C                     EXSR ICHGVT                                    CFT009
      *                                                                   CFT009
      *  Unwind subroutine stack name                                     CFT009
      *                                                                   CFT009
     C                     MOVEA*BLANKS   @STK,Q                          CFT009
     C                     SUB  1         Q                               CFT009
      *                                                                   CFT009
     CSR                   ENDSR                                          CFT009
      *                                                                   CFT009
     C/EJECT                                                              CFT009
      *****************************************************************   CFT009
      *                                                               *   CFT009
      *  DFOCHG   : Default outgoing charges                          *   CFT009
      *                                                               *   CFT009
      *  CALLED BY: SROTFT                                            *   CFT009
      *                                                               *   CFT009
      *****************************************************************   CFT009
     CSR         DFOCHG    BEGSR                                          CFT009
      *                                                                   CFT009
      *  Set up subroutine stack name                                     CFT009
      *                                                                   CFT009
     C                     ADD  1         Q       50                      CFT009
     C                     MOVEL'DFOCHG'  @STK,Q                          CFT009
      *                                                                   CFT009
     C                     CLEAROTPYDS                                    CFT009
     C                     CLEAROTPXDS                                    CFT009
     C                     CLEARTRNDET                                    CFT009
     C                     CLEARTRNEXT                                    CFT009
      *                                                                   CFT009
      * Move details into outgoing payment details DS                     CFT009
      *                                                                   CFT009
     C                     EXSR MVOTDS                                    CFT009
     C                     Z-ADDPHMSGR    OTMSGR                          EEE058
     C                     Z-ADDPHPART    OTKPRT                          EEE058
      *                                                                   DJBF01
      * Set up date offset code                                           DJBF01
      *                                                                   DJBF01
     C                     MOVELPDTOCD    OPPDOF                          DJBF01
      *                                                                   DJBF01
      *                                                                   CFT009
     C                     MOVELOTPYDS    TRNDET                          CFT009
     C                     MOVELOTPXDS    TRNEXT                          CFT009
     C                     MOVELGNMSET    SETNUM                          CFT009
     **C*PY*WNCPYSRC,FT0300DB07                                           EEE058            AR856737
      *                                                                   CFT009
     C                     CALL 'FT000980'                                CFT009
     C                     PARM *BLANKS   RETCDE                          CFT009
     C                     PARM           TRNDET                          CFT009
     C                     PARM           TRNEXT                          CFT009
     C                     PARM 'OP'      TRNTYP  2                       CFT009
     C*****                PARM 'S'       PRCMTD  1                 CFT009STP017
     C                     PARM 'Y'       PRCMTD  1                       STP017
     C                     PARM GNMTPY    MESTYP  3                       CFT009
     C                     PARM           SETNUM  3                       CFT009
     C                     PARM LCSETM    CLSTTM  2                       MKCAR1
      *                                                                   CFT009
     C                     MOVELTRNDET    OTPYDS                          CFT009
     C                     MOVELTRNEXT    OTPXDS                          CFT009
      *                                                                   DJBF01
      * Set up date offset code                                           DJBF01
      *                                                                   DJBF01
     C           PDTOCD    IFNE *BLANKS                                   DJBF01
     C                     MOVELPDTOCD    OPPDOF                          DJBF01
     C                     ENDIF                                          DJBF01
      *                                                                   DJBF01
      *                                                                   CFT009
      ** Exchange rate                                                    CFT009
      *                                                                   CFT009
     C                     Z-ADDOTRATE    F4RATE                          CFT009
      *                                                                   STP997
     C           #EXTRN    IFEQ 'Y'                                       STP997
     C                     Z-ADDOTSMAM    F4SMAM                          STP997
     C                     ENDIF                                          STP997
      *                                                                   CFT009
      * Convert it in Midas day number - settle date                      CFT009
      *                                                                   CFT009
     C                     Z-ADDOTSLD1    ZDATE                           CFT009
      *                                                                   CFT009
     C                     CALL 'ZDATE1'               9090               CFT009
     C                     PARM *BLANKS   ZERR    7                       CFT009
     C                     PARM           ZDATE   60                      CFT009
     C                     PARM WUDFF     ZDATFM  1                       CFT009
     C                     PARM *ZEROS    ZDAYNO  50                      CFT009
      *                                                                   CFT009
     C                     Z-ADDZDAYNO    F4SLDT                          CFT009
      *                                                                   CFT009
      *  If error on call                                                 CFT009
      *                                                                   CFT009
     C           *IN90     IFEQ *ON                                       CFT009
     C                     MOVEL'ZDATE1  'W0FILE           ***************CFT009
     C                     MOVEL'*CALL'   W0KEY            * DB ERROR 147*CFT009
     C                     Z-ADD147       W0ERNB           ***************CFT009
     C                     MOVEL'MEM5003' W0MSGD                          CFT009
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT009
     C                     EXSR SRERRA                                    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      * Convert it in Midas day number - pay date                         CFT009
      *                                                                   CFT009
     C                     Z-ADDOTPVD1    ZDATE                           CFT009
      *                                                                   CFT009
     C                     CALL 'ZDATE1'               9090               CFT009
     C                     PARM *BLANKS   ZERR    7                       CFT009
     C                     PARM           ZDATE   60                      CFT009
     C                     PARM WUDFF     ZDATFM  1                       CFT009
     C                     PARM *ZEROS    ZDAYNO  50                      CFT009
      *                                                                   CFT009
     C                     Z-ADDZDAYNO    F4PVDT                          CFT009
      *                                                                   CFT009
      *  If error on call                                                 CFT009
      *                                                                   CFT009
     C           *IN90     IFEQ *ON                                       CFT009
     C                     MOVEL'ZDATE1  'W0FILE           ***************CFT009
     C                     MOVEL'*CALL'   W0KEY            * DB ERROR 148*CFT009
     C                     Z-ADD148       W0ERNB           ***************CFT009
     C                     MOVEL'MEM5003' W0MSGD                          CFT009
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT009
     C                     EXSR SRERRA                                    CFT009
     C                     ENDIF                                          CFT009
     **C*PY*WNCPYSRC,FT0300DB08                                           EEE058            AR856737
      *                                                                   CFT009
      ** Default VAT flags, total VAT, VAT rate, entry charges            CFT009
      *                                                                   CFT009
     C                     EXSR OCHGVT                                    CFT009
      *                                                                   CFT009
      *  Unwind subroutine stack name                                     CFT009
      *                                                                   CFT009
     C                     MOVEA*BLANKS   @STK,Q                          CFT009
     C                     SUB  1         Q                               CFT009
      *                                                                   CFT009
     CSR                   ENDSR                                          CFT009
     C/EJECT                                                              CFT009
      *****************************************************************   CFT009
      *                                                               *   CFT009
      *  MVINDS   : Move data into Incoming Payments Details DS       *   CFT009
      *                                                               *   CFT009
      *  CALLED BY: DFICHG                                            *   CFT009
      *                                                               *   CFT009
      *****************************************************************   CFT009
     CSR         MVINDS    BEGSR                                          CFT009
      *                                                                   CFT009
      *  Set up subroutine stack name                                     CFT009
      *                                                                   CFT009
     C                     ADD  1         Q       50                      CFT009
     C                     MOVEL'MVINDS'  @STK,Q                          CFT009
      *                                                                   CFT009
     C                     MOVEL'IN'      PYTP                            CFT009
     C                     MOVELS1PYST    PYST                            CFT009
      *                                                                   CFT009
      *  Sender                                                           CFT009
      *                                                                   CFT009
     C                     MOVELF1SNTP    SNTP                            CFT009
     C                     MOVELS1SND1    SND1                            CFT009
     C                     MOVELS1SND2    SND2                            CFT009
     C                     MOVELS1SND3    SND3                            CFT009
     C                     MOVELS1SND4    SND4                            CFT009
      *                                                                   CFT009
      *  Account with Institution account                                 CFT009
      *                                                                   CFT009
     C                     MOVELF1ACBT    ACBT                            CFT009
     C                     MOVELS1ACBK    ACBK                            CFT009
     C                     MOVELS1ACBB    ACBB                            CFT009
      *                                                                   CFT009
      *  Beneficiary                                                      CFT009
      *                                                                   CFT009
     C                     MOVELF1BNCT    BNCT                            CFT009
     C                     MOVELS1BNC1    BNC1                            CFT009
     C                     MOVELS1BNC2    BNC2                            CFT009
     C                     MOVELS1BNC3    BNC3                            CFT009
     C                     MOVELS1BNC4    BNC4                            CFT009
     C                     MOVELS1BNC5    BNC5                            CFT009
      *                                                                   CFT009
      *  Settle amount, value date and currency                           CFT009
      *                                                                   CFT009
     C                     Z-ADDF1SMAM    SMAM                            CFT009
     C                     MOVELS1SMCY    SMCY                            CFT009
     C                     Z-ADDF1SLDT    SLDT                            CFT009
      *                                                                   CFT009
      *  Define date formats                                              CFT009
      *                                                                   CFT009
     C                     Z-ADDF1SLDT    W#MDTE                          CFT009
     C                     Z-ADD0         W#DAF1                          CFT009
     C                     Z-ADD0         W#DAF2                          CFT009
     C                     Z-ADD0         W#DAF3                          CFT009
     C                     EXSR SRDAFD                                    CFT009
     C                     Z-ADDW#DAF1    SLDTD1                          CFT009
     C                     Z-ADDW#DAF2    SLDTD2                          CFT009
     C                     Z-ADDW#DAF3    SLDTD3                          CFT009
      *                                                                   CFT009
      *  Rate and Multiply/divide indicator and override                  CFT009
      *                                                                   CFT009
     C                     MOVELF1RATE    RATE                            CFT009
     C           F1MDIN    IFEQ 'M'                                       CFT009
     C                     Z-ADD1         MDIN                            CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         MDIN                            CFT009
     C                     END                                            CFT009
     C                     MOVELS1OVRD    OVRD                            CFT009
      *                                                                   CFT009
      *  Payment amount, value date and currency                          CFT009
      *                                                                   CFT009
     C                     Z-ADDF1PYAM    PYAM                            CFT009
     C                     MOVELS1PCCY    PCCY                            CFT009
     C                     Z-ADDF1PVDT    PVDT                            CFT009
      *                                                                   CFT009
      *  Define date formats                                              CFT009
      *                                                                   CFT009
     C                     Z-ADDF1PVDT    W#MDTE                          CFT009
     C                     Z-ADD0         W#DAF1                          CFT009
     C                     Z-ADD0         W#DAF2                          CFT009
     C                     Z-ADD0         W#DAF3                          CFT009
     C                     EXSR SRDAFD                                    CFT009
     C                     Z-ADDW#DAF1    PVDTD1                          CFT009
     C                     Z-ADDW#DAF2    PVDTD2                          CFT009
     C                     Z-ADDW#DAF3    PVDTD3                          CFT009
      *                                                                   CFT009
      *  Add/deduct charges, priority code, related ref.                  CFT009
      *                                                                   CFT009
     C                     MOVELS1ADDC    ADDC                            CFT009
     C*****      S1SWPC    IFEQ 'U'                                       CFT009MKEMR1
     C*****                Z-ADD1         SWPC                            CFT009MKEMR1
     C*****                ELSE                                           CFT009MKEMR1
     C                     Z-ADD2         SWPC                            CFT009
     C*****                END                                            CFT009MKEMR1
     C                     MOVELS3RLRF    RLPR                            CFT009
      *                                                                   CFT009
      *  Ordering Bank                                                    CFT009
      *                                                                   CFT009
     C                     MOVELF2ORBT    ORBT                            CFT009
     C                     MOVELS2ORB1    ORB1                            CFT009
     C                     MOVELS2ORB2    ORB2                            CFT009
     C                     MOVELS2ORB3    ORB3                            CFT009
     C                     MOVELS2ORB4    ORB4                            CFT009
     C                     MOVELS2ORB5    ORB5                            CFT009
      *                                                                   CFT009
      *  Sender's Correspondent                                           CFT009
      *                                                                   CFT009
     C                     MOVELF2SNCT    SNCT                            CFT009
     C                     MOVELS2SNC1    SNC1                            CFT009
     C                     MOVELS2SNC2    SNC2                            CFT009
     C                     MOVELS2SNC3    SNC3                            CFT009
     C                     MOVELS2SNC4    SNC4                            CFT009
     C                     MOVELS2SNC5    SNC5                            CFT009
      *                                                                   CFT009
      *  Ordering Customer                                                CFT009
      *                                                                   CFT009
     C                     MOVELF2ORCT    ORCT                            CFT009
     C                     MOVELS2ORC1    ORC1                            CFT009
     C                     MOVELS2ORC2    ORC2                            CFT009
     C                     MOVELS2ORC3    ORC3                            CFT009
     C                     MOVELS2ORC4    ORC4                            CFT009
     C                     MOVELS2ORC5    ORC5                                                CFT032
      *                                                                   CFT009
      *  Details of Payment                                               CFT009
      *                                                                   CFT009
     C                     MOVELS3PAY1    DTP1                            CFT009
     C                     MOVELS3PAY2    DTP2                            CFT009
     C                     MOVELS3PAY3    DTP3                            CFT009
     C                     MOVELS3PAY4    DTP4                            CFT009
      *                                                                   CFT009
      *  Charge detail                                                    CFT009
      *                                                                   CFT009
     C                     MOVELS0DETC    DTCH                            CFT009
      *                                                                   CFT009
      *  Sender to Receiver Information                                   CFT009
      *                                                                   CFT009
     C                     MOVELS2BTB1    BBI1                            CFT009
     C                     MOVELS2BTB2    BBI2                            CFT009
     C                     MOVELS2BTB3    BBI3                            CFT009
     C                     MOVELS2BTB4    BBI4                            CFT009
     C                     MOVELS2BTB5    BBI5                            CFT009
     C                     MOVELS2BTB6    BBI6                            CFT009
      *                                                                   CFT009
      *  Central Bank Reference                                           CFT009
      *                                                                   CFT009
     C                     MOVELS3CBKR    DNBC                            CFT009
      *                                                                   CFT009
      *  Intermediary Bank                                                CFT009
      *                                                                   CFT009
     C                     MOVELF3INBT    INBT                            CFT009
     C                     MOVELS3IBK1    INB1                            CFT009
     C                     MOVELS3IBK2    INB2                            CFT009
     C                     MOVELS3IBK3    INB3                            CFT009
     C                     MOVELS3IBK4    INB4                            CFT009
     C                     MOVELS3IBK5    INB5                            CFT009
      *                                                                   CFT009
      *  Charges to the debit of                                          CFT009
      *                                                                   CFT009
     C                     MOVELF0CDRT    CDRT                            CFT009
     C                     MOVELS0CDRO    CDRO                            CFT009
     C                     MOVELS0CDBR    CDBR                            CFT009
      *                                                                   CFT009
      *  General Flags                                                    CFT009
      *                                                                   CFT009
     C                     MOVEL*BLANKS   IACG                            CFT009
     C                     MOVEL*BLANKS   SACG                            CFT009
     C                     MOVEL*BLANKS   PACG                            CFT009
     C                     MOVEL*BLANKS   SMSG                            CFT009
     C                     MOVEL*BLANKS   PMSG                            CFT009
     C                     MOVEL*BLANKS   AUP1                            CFT009
     C                     MOVEL*BLANKS   AUP2                            CFT009
     C                     MOVELWAUIN     AUIN                            CFT009
     C                     MOVELWAUP1     AUP1                            RK0001
     C                     MOVEL*BLANKS   ADIN                            CFT009
     C                     MOVEL*BLANKS   SRNM                            CFT009
      *                                                                   CFT009
      *  Audit Information                                                CFT009
      *                                                                   CFT009
     C                     MOVEL##USR     INUSR1                          CFT009
     C                     MOVEL*BLANKS   INUSR2                          CFT009
     C                     TIME           LCHT                            CFT009
     C                     Z-ADDWURDNB    OEDT                            CFT009
     C                     MOVEL'I'       IPCHTP                          CFT009
     C                     Z-ADDWURDNB    IPLCD                           CFT009
     C                     MOVEL##USR     INUSR1                          CFT009
      *                                                                   CFT009
      *  Incoming to Outgoing Indicator                                   CFT009
      *                                                                   CFT009
     C                     MOVELS3OPIN    OPIN                            CFT009
      *                                                                   CFT009
      *  Booking and originating branches                                 CFT009
      *                                                                   CFT009
     C                     MOVELS1BRCA    IPBRCA                          CFT009
     C                     MOVELS1ORBR    ORBR                            CFT009
      *                                                                   CFT009
      *  Message references                                               CFT009
      *                                                                   CFT009
     C                     MOVELMIR       MIR                             CFT009
     C                     MOVELISEQ      ISEQ                            CFT009
     C                     MOVELINTRNO    INTRNO                          CFT009
     C                     MOVELINMTPY    INMTPY                          CFT009
     C                     Z-ADDINMSGR    INMSGR                          CFT009
     C                     Z-ADDINKPRT    INKPRT                          CFT009
     C                     Z-ADDINMSGR    IPMSGR                          MMFIX1
     C                     Z-ADDINKPRT    IPKPRT                          MMFIX1
      *                                                                   CFT009
      *  Book code and profit centre                                      CFT009
      *                                                                   CFT009
     C                     MOVELS1BOKC    BOKC                            CFT009
     C                     MOVELS1PRFC    IPPRFC                          CFT009
      *                                                                   CFT009
      *  Actual Receiver's Correspondent                                  CFT009
      *                                                                   CFT009
     C           INRCRT    IFNE *BLANKS                                                     BUG26108
     C                     MOVELINRCRT    INRCRT                          CFT009
     C                     ELSE                                                             BUG26108
     C                     MOVELF1RCRT    INRCRT                                            BUG26108
     C                     ENDIF                                                            BUG26108
     C                     MOVELS1RCO1    INRCO1                          CFT009
     C                     MOVELS1RCO2    INRCO2                          CFT009
     C                     MOVELS1RCO3    INRCO3                          CFT009
     C                     MOVELS1RCO4    INRCO4                          CFT009
     C                     MOVELS1RCO5    INRCO5                          CFT009
      *                                                                   CFT009
      *  Actual Account with Institution                                  CFT009
      *                                                                   CFT009
     C                     MOVELINACBT    INACBT                          CFT009
     C                     MOVELINACB1    INACB1                          CFT009
     C                     MOVELINACB2    INACB2                          CFT009
     C                     MOVELINACB3    INACB3                          CFT009
     C                     MOVELINACB4    INACB4                          CFT009
     C                     MOVELINACB5    INACB5                          CFT009
      *                                                                   CFT009
      *  Settle base currency equivalent                                  CFT009
      *                                                                   CFT009
     C           I1SMCY    IFEQ *BLANKS                                   CFT009
     C                     CLEARD#DTA                                     CFT009
     C                     Z-ADDSMAM      D#FAMT                          CFT009
     C                     MOVELS1SMCY    D#FCCY                          CFT009
     C                     MOVELV#BCCY    D#TCCY                          CFT009
      *                                                                   CFT009
     C                     CALL 'AOCCYCV0'             9090               CFT009
     C                     PARM *BLANKS   O#RTN   7                       CFT009
     C                     PARM '*F*T*SPT'W2ACT   8                       CFT009
     C           D#DTA     PARM D#DTA     O#DTA 256                       CFT009
      *                                                                   CFT009
     C           *IN90     IFEQ '1'                                       CFT009
     C           O#RTN     ORNE *BLANKS                                   CFT009
     C                     MOVEL'AOCCYCV0'W0FILE           ***************CFT009
     C                     MOVEL'*CALL'   W0KEY            * DB ERROR 149*CFT009
     C                     Z-ADD149       W0ERNB           ***************CFT009
     C                     MOVEL'MEM5003' W0MSGD                          CFT009
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT009
     C                     EXSR SRERRA                                    CFT009
     C                     END                                            CFT009
      *                                                                   CFT009
     C                     Z-ADDD#TAMT    SBCQ                            CFT009
     C                     END                                            CFT009
      *                                                                   CFT009
      *  Pay base currency equivalent                                     CFT009
      *                                                                   CFT009
     C           I1PCCY    IFEQ *BLANKS                                   CFT009
     C                     CLEARD#DTA                                     CFT009
     C                     Z-ADDPYAM      D#FAMT                          CFT009
     C                     MOVELS1PCCY    D#FCCY                          CFT009
     C                     MOVELV#BCCY    D#TCCY                          CFT009
      *                                                                   CFT009
     C                     CALL 'AOCCYCV0'             9090               CFT009
     C                     PARM *BLANKS   O#RTN   7                       CFT009
     C                     PARM '*F*T*SPT'W2ACT   8                       CFT009
     C           D#DTA     PARM D#DTA     O#DTA 256                       CFT009
      *                                                                   CFT009
     C           *IN90     IFEQ '1'                                       CFT009
     C           O#RTN     ORNE *BLANKS                                   CFT009
     C                     MOVEL'AOCCYCV0'W0FILE           ***************CFT009
     C                     MOVEL'*CALL'   W0KEY            * DB ERROR 150*CFT009
     C                     Z-ADD150       W0ERNB           ***************CFT009
     C                     MOVEL'MEM5003' W0MSGD                          CFT009
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT009
     C                     EXSR SRERRA                                    CFT009
     C                     END                                            CFT009
      *                                                                   CFT009
     C                     Z-ADDD#TAMT    PBCQ                            CFT009
     C                     END                                            CFT009
      *                                                                   CFT009
      *  If Pay Currency is Base then set SBCQ to PBCQ                    CFT009
      *  else set PBCQ to SBCQ                                            CFT009
      *                                                                   CFT009
     C           PCCY      IFEQ V#BCCY                                    CFT009
     C                     Z-ADDPBCQ      SBCQ                            CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADDSBCQ      PBCQ                            CFT009
     C                     END                                            CFT009
      *                                                                   CFT009
      *  Sell and Buy rates                                               CFT009
      *                                                                   CFT009
     C                     Z-ADDSRTE      SRTE                            CFT009
     C                     Z-ADDPRTE      PRTE                            CFT009
      *                                                                   CFT009
      *  Level complete indicators                                        CFT009
      *                                                                   CFT009
     C                     MOVELINLVL1    INLVL1                          CFT009
     C                     MOVELINLVL2    INLVL2                          CFT009
      *                                                                   CFT009
      ** Notified delivery currency and amount                            CFT009
      *                                                                   CFT009
     C                     MOVE S1NDCY    NDCY                            CFT009
     C                     Z-ADDV#NDAM    NDAM                            CFT009
      *                                                                   CFT009
      ** Set up charge currency                                           CFT009
      *                                                                   CFT009
     C                     SELEC                                          CFT009
      *                                                                   CFT009
     C           BTCHCY    WHEQ 'B'                                       CFT009
     C                     MOVELV#BCCY    IPCHGC                          CFT009
      *                                                                   CFT009
     C           BTCHCY    WHEQ 'L'                                       CFT009
     C                     MOVELV#LCCY    IPCHGC                          CFT009
      *                                                                   CFT009
     C           BTCHCY    WHEQ 'C'                                       CFT009
     C           S1ADDC    IFEQ 'A'                                       CFT009
     C                     MOVELS1SMCY    IPCHGC                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVELS1PCCY    IPCHGC                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           BTCHCY    WHEQ 'F'                                       CFT009
     C                     MOVE FCHCCY    IPCHGC                          CFT009
      *                                                                   CFT009
     C                     OTHER                                          CFT009
     C                     Z-ADD100       DBASE            ***************CFT009
     C                     MOVEL'FT0300'  DBFILE           * DBERR 100   *CFT009
     C                     MOVEL*BLANKS   DBKEY            ***************CFT009
     C                     OUT  LDA                                       CFT009
     C                     EXSR *PSSR                                     CFT009
     C                     ENDSL                                          CFT009
      *                                                                   CFT009
      * If use transaction exchange rate, move to charges X-Rate          CFT009
      *                                                                   CFT009
     C           CHTRCY    IFEQ 'Y'                                       CFT009
     C                     Z-ADDF1RATE    IPCHRT                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      *  Unwind subroutine stack name                                     CFT009
      *                                                                   CFT009
     C                     MOVEA*BLANKS   @STK,Q                          CFT009
     C                     SUB  1         Q                               CFT009
      *                                                                   CFT009
     CSR                   ENDSR                                          CFT009
     C/EJECT                                                              CFT009
      *****************************************************************   CFT009
      *                                                               *   CFT009
      *  MVOTDS   : Move data into Outgoing Payments Details DS       *   CFT009
      *                                                               *   CFT009
      *  CALLED BY: DFOCHG                                            *   CFT009
      *                                                               *   CFT009
      *****************************************************************   CFT009
     CSR         MVOTDS    BEGSR                                          CFT009
      *                                                                   CFT009
      *  Set up subroutine stack name                                     CFT009
      *                                                                   CFT009
     C                     ADD  1         Q       50                      CFT009
     C                     MOVEL'MVOTDS'  @STK,Q                          CFT009
      *                                                                   CFT009
     C                     MOVELS4PYTP    OTPYTP                          CFT009
     C                     MOVELS4PYST    OTPYST                          CFT009
      *                                                                   CFT009
      *  Destination                                                      CFT009
      *                                                                   CFT009
     C                     MOVELF4DSTT    DSTT                            CFT009
     C                     MOVELS4DST1    DST1                            CFT009
     C                     MOVELS4DST2    DST2                            CFT009
     C                     MOVELS4DST3    DST3                            CFT009
     C                     MOVELS4DST4    DST4                            CFT009
      *                                                                   CFT009
      *  Senedr's Correspondent account                                   CFT009
      *                                                                   CFT009
     C                     MOVELF4SNCT    OTSNCT                          CFT009
     C                     MOVELS4SNCO    SNCO                            CFT009
      *                                                                   CFT009
      *  Ordering Bank                                                    CFT009
      *                                                                   CFT009
     C                     MOVELF4ORBT    OTORBT                          CFT009
     C                     MOVELS4ORBK    ORBK                            CFT009
     C                     MOVELS4ORBB    ORBB                            CFT009
      *                                                                   CFT009
      *  Ordering Customer                                                CFT009
      *                                                                   CFT009
     C                     MOVELS4ODMT    ODMT                            CFT009
     C                     MOVELF4ORCT    OTORCT                          CFT009
     C                     MOVELS4ORC1    OTORC1                          CFT009
     C                     MOVELS4ORC2    OTORC2                          CFT009
     C                     MOVELS4ORC3    OTORC3                          CFT009
     C                     MOVELS4ORC4    OTORC4                          CFT009
     C                     MOVELS4ORC5    OTORC5                                              CFT032
      *                                                                   CFT009
      *  Settle amount, value date and currency                           CFT009
      *                                                                   CFT009
     C                     Z-ADDF4SMAM    OTSMAM                          CFT009
     C                     MOVELS4SMCY    OTSMCY                          CFT009
     C                     Z-ADDF4SLDT    OTSLDT                          CFT009
      *                                                                   CFT009
      *  Define date formats                                              CFT009
      *                                                                   CFT009
     C                     Z-ADDF4SLDT    W#MDTE                          CFT009
     C                     Z-ADD0         W#DAF1                          CFT009
     C                     Z-ADD0         W#DAF2                          CFT009
     C                     Z-ADD0         W#DAF3                          CFT009
     C                     EXSR SRDAFD                                    CFT009
     C                     Z-ADDW#DAF1    OTSLD1                          CFT009
     C                     Z-ADDW#DAF2    OTSLD2                          CFT009
     C                     Z-ADDW#DAF3    OTSLD3                          CFT009
      *                                                                   CFT009
      *  Rate and Multiply/divide indicator and override                  CFT009
      *                                                                   CFT009
     C                     MOVELF4RATE    OTRATE                          CFT009
     C           F4MDIN    IFEQ 'M'                                       CFT009
     C                     Z-ADD1         OTMDIN                          CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         OTMDIN                          CFT009
     C                     END                                            CFT009
     C                     MOVELS4OVRD    OTOVRD                          CFT009
      *                                                                   CFT009
      *  Payment amount, value date and currency                          CFT009
      *                                                                   CFT009
     C                     Z-ADDF4PYAM    OTPYAM                          CFT009
     C                     MOVELS4PCCY    OTPCCY                          CFT009
     C                     Z-ADDF4PVDT    OTPVDT                          CFT009
      *                                                                   CFT009
      *  Define date formats                                              CFT009
      *                                                                   CFT009
     C                     Z-ADDF4PVDT    W#MDTE                          CFT009
     C                     Z-ADD0         W#DAF1                          CFT009
     C                     Z-ADD0         W#DAF2                          CFT009
     C                     Z-ADD0         W#DAF3                          CFT009
     C                     EXSR SRDAFD                                    CFT009
     C                     Z-ADDW#DAF1    OTPVD1                          CFT009
     C                     Z-ADDW#DAF2    OTPVD2                          CFT009
     C                     Z-ADDW#DAF3    OTPVD3                          CFT009
      *                                                                   CFT009
      *  Add/deduct charges, priority code, related ref.                  CFT009
      *                                                                   CFT009
     C                     MOVELS4ADDC    OTADDC                          CFT009
      *                                                                   CFT009
     C*****      S4SWPC    IFEQ 'U'                                       CFT009MKEMR1
     C*****                Z-ADD1         OTSWPC                          CFT009MKEMR1
     C*****                ELSE                                           CFT009MKEMR1
     C                     Z-ADD2         OTSWPC                          CFT009
     C*****                END                                            CFT009MKEMR1
     C                     MOVELS6RLRF    OTRLPR                          CFT009
     C                     MOVELS4STMT    STMT                            CFT009
     C                     MOVELS4SNMT    SNMT                            CFT009
      *                                                                   CFT009
      *  Receiver's Correspondent                                         CFT009
      *                                                                   CFT009
     C                     MOVELF5RCOT    OTRCRT                          CFT009
     C                     MOVELS5RCO1    RCO1                            CFT009
     C                     MOVELS5RCO2    RCO2                            CFT009
     C                     MOVELS5RCO3    RCO3                            CFT009
     C                     MOVELS5RCO4    RCO4                            CFT009
     C                     MOVELS5RCO5    RCO5                            CFT009
      *                                                                   CFT009
      *  Account with Institution                                         CFT009
      *                                                                   CFT009
     C                     MOVELF5ACBT    OTACBT                          CFT009
     C                     MOVELS5ACB1    ACB1                            CFT009
     C                     MOVELS5ACB2    ACB2                            CFT009
     C                     MOVELS5ACB3    ACB3                            CFT009
     C                     MOVELS5ACB4    ACB4                            CFT009
     C                     MOVELS5ACB5    ACB5                            CFT009
      *                                                                   CFT009
      *  Beneficiary                                                      CFT009
      *                                                                   CFT009
     C                     MOVELF5BNCT    OTBNCT                          CFT009
     C                     MOVELS5BNC1    OTBNC1                          CFT009
     C                     MOVELS5BNC2    OTBNC2                          CFT009
     C                     MOVELS5BNC3    OTBNC3                          CFT009
     C                     MOVELS5BNC4    OTBNC4                          CFT009
     C                     MOVELS5BNC5    OTBNC5                          CFT009
      *                                                                   CFT009
      *  Details of Payment                                               CFT009
      *                                                                   CFT009
     C                     MOVELS6PAY1    OTDTP1                          CFT009
     C                     MOVELS6PAY2    OTDTP2                          CFT009
     C                     MOVELS6PAY3    OTDTP3                          CFT009
     C                     MOVELS6PAY4    OTDTP4                          CFT009
      *                                                                   CFT009
      *  Charge detail                                                    CFT009
      *                                                                   CFT009
     C                     MOVELS7DETC    OTDTCH                          CFT009
      *                                                                   CFT009
      *  Sender to Receiver Information                                   CFT009
      *                                                                   CFT009
     C                     MOVELS6BTB1    OTBBI1                          CFT009
     C                     MOVELS6BTB2    OTBBI2                          CFT009
     C                     MOVELS6BTB3    OTBBI3                          CFT009
     C                     MOVELS6BTB4    OTBBI4                          CFT009
     C                     MOVELS6BTB5    OTBBI5                          CFT009
     C                     MOVELS6BTB6    OTBBI6                          CFT009
      *                                                                   CFT009
      *  Central Bank Reference                                           CFT009
      *                                                                   CFT009
     C                     MOVELS6CBKR    OTDNBC                          CFT009
      *                                                                   CFT009
      *  Charges to the debit of                                          CFT009
      *                                                                   CFT009
     C                     MOVELF7CDRT    OTCDRT                          CFT009
     C                     MOVELS7CDRO    OTCDRO                          CFT009
     C                     MOVELS7CDBR    OTCDBR                          CFT009
      *                                                                   CFT009
      *  Audit Information                                                CFT009
      *                                                                   CFT009
     C                     MOVEL##USR     OTINU1                          CFT009
     C                     MOVEL*BLANKS   OTINU2                          CFT009
     C                     TIME           OTLCHT                          CFT009
     C                     Z-ADDWURDNB    OTOEDT                          CFT009
     C                     MOVEL'I'       OTCHTP                          CFT009
     C                     Z-ADDWURDNB    OTLCD                           CFT009
      *                                                                   CFT009
      *  General Flags                                                    CFT009
      *                                                                   CFT009
     C                     MOVEL*BLANKS   OTIACG                          CFT009
     C                     MOVEL*BLANKS   OTSACG                          CFT009
     C                     MOVEL*BLANKS   OTPACG                          CFT009
     C                     MOVEL*BLANKS   OTSMSG                          CFT009
     C                     MOVEL*BLANKS   OTPMSG                          CFT009
     C                     MOVEL*BLANKS   OTAUP1                          CFT009
     C                     MOVEL*BLANKS   OTAUP2                          CFT009
     C                     MOVELWAUIN     OTAUIN                          CFT005
     C                     MOVELWAUP1     OTAUP1                          RK0001
     C                     MOVEL*BLANKS   OTADIN                          CFT009
     C                     MOVEL*BLANKS   CQIN                            CFT009
     C                     MOVEL*BLANKS   PRIN                            CFT009
     C                     MOVEL*BLANKS   MT100                           CFT009
     C                     MOVEL*BLANKS   MT202                           CFT009
     C                     MOVEL*BLANKS   TXIN                            CFT009
     C                     MOVEL*BLANKS   BAIN                            CFT009
     C                     MOVEL*BLANKS   ISIN                            CFT009
     C                     MOVEL*BLANKS   MPYI                            CFT009
     C                     MOVEL*BLANKS   MT202C                          CFT009
      *                                                                   CFT009
      *  Regular Payment information                                      CFT009
      *                                                                   CFT009
     C                     MOVELS4RPAY    RPAY                            CFT009
     C                     MOVELS4PAYF    PAYF                            CFT009
     C           S4DYIM    IFEQ *BLANKS                                   CFT009
     C                     Z-ADD0         DYIM                            CFT009
     C                     ELSE                                           CFT009
     C                     MOVELS4DYIM    DYIM                            CFT009
     C                     END                                            CFT009
     C                     Z-ADDF4NDAT    NPDT                            CFT009
     C                     Z-ADDF4FIND    FDAT                            CFT009
     C                     Z-ADDF4PRBD    PRBD                            CFT009
     C                     MOVELF4FAIN    FAIN                            CFT009
      *                                                                   CFT009
      *  Intermediary Bank                                                CFT009
      *                                                                   CFT009
     C                     MOVELF5INBT    OTINBT                          CFT009
     C                     MOVELS5IBK1    OTINB1                          CFT009
     C                     MOVELS5IBK2    OTINB2                          CFT009
     C                     MOVELS5IBK3    OTINB3                          CFT009
     C                     MOVELS5IBK4    OTINB4                          CFT009
     C                     MOVELS5IBK5    OTINB5                          CFT009
     C                     MOVELS6CHAP    CHAP                            CFT009
     C*                                                                   CFT009
     C                     MOVELS4SMAM    AMTS                            CFT009
     C                     MOVELS4SLDT    SVDT                            CFT009
     C                     MOVEL*BLANKS   NSTR                            CFT009
     C                     MOVEL*BLANKS   TSKS                            CFT009
     C                     MOVEL*BLANKS   OXPREF                          CFT009
     C                     MOVEL*BLANKS   OTOPIN                          CFT009
      *                                                                   CFT009
      *  Level complete indicators                                        CFT009
      *                                                                   CFT009
     C                     MOVELLVL1      LVL1                            CFT009
     C                     MOVELLVL2      LVL2                            CFT009
      *                                                                   CFT009
      *  Settle base currency equivalent                                  CFT009
      *                                                                   CFT009
     C           I4SMCY    IFEQ *BLANKS                                   CFT009
     C                     CLEARD#DTA                                     CFT009
     C                     Z-ADDSMAM      D#FAMT                          CFT009
     C                     MOVELS4SMCY    D#FCCY                          CFT009
     C                     MOVELV#BCCY    D#TCCY                          CFT009
      *                                                                   CFT009
     C                     CALL 'AOCCYCV0'             9090               CFT009
     C                     PARM *BLANKS   O#RTN   7                       CFT009
     C                     PARM '*F*T*SPT'W2ACT   8                       CGL009
     C           D#DTA     PARM D#DTA     O#DTA 256                       CFT009
      *                                                                   CFT009
     C           *IN90     IFEQ '1'                                       CFT009
     C           O#RTN     ORNE *BLANKS                                   CFT009
     C                     MOVEL'AOCCYCV0'W0FILE           ***************CFT009
     C                     MOVEL'*CALL'   W0KEY            * DB ERROR 151*CFT009
     C                     Z-ADD151       W0ERNB           ***************CFT009
     C                     MOVEL'MEM5003' W0MSGD                          CFT009
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT009
     C                     EXSR SRERRA                                    CFT009
     C                     END                                            CFT009
      *                                                                   CFT009
     C                     Z-ADDD#TAMT    OTSBCQ                          CFT009
     C                     END                                            CFT009
      *                                                                   CFT009
      *  Pay base currency equivalent                                     CFT009
      *                                                                   CFT009
     C           I4PCCY    IFEQ *BLANKS                                   CFT009
     C                     CLEARD#DTA                                     CFT009
     C                     Z-ADDPYAM      D#FAMT                          CFT009
     C                     MOVELS4PCCY    D#FCCY                          CFT009
     C                     MOVELV#BCCY    D#TCCY                          CFT009
      *                                                                   CFT009
     C                     CALL 'AOCCYCV0'             9090               CFT009
     C                     PARM *BLANKS   O#RTN   7                       CFT009
     C                     PARM '*F*T*SPT'W2ACT   8                       CFT009
     C           D#DTA     PARM D#DTA     O#DTA 256                       CFT009
      *                                                                   CFT009
     C           *IN90     IFEQ '1'                                       CFT009
     C           O#RTN     ORNE *BLANKS                                   CFT009
     C                     MOVEL'AOCCYCV0'W0FILE           ***************CFT009
     C                     MOVEL'*CALL'   W0KEY            * DB ERROR 152*CFT009
     C                     Z-ADD152       W0ERNB           ***************CFT009
     C                     MOVEL'MEM5003' W0MSGD                          CFT009
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT009
     C                     EXSR SRERRA                                    CFT009
     C                     END                                            CFT009
      *                                                                   CFT009
     C                     Z-ADDD#TAMT    OTPBCQ                          CFT009
     C                     END                                            CFT009
      *                                                                                       DJB002
      *  If Pay Currency is Base then set SBCQ to PBCQ                                        DJB002
      *  else set PBCQ to SBCQ                                                                DJB002
      *                                                                                       DJB002
     C           OTPCCY    IFEQ V#BCCY                                                        DJB002
     C                     Z-ADDOTPBCQ    OTSBCQ                                              DJB002
     C                     ELSE                                                               DJB002
     C                     Z-ADDOTSBCQ    OTPBCQ                                              DJB002
     C                     END                                                                DJB002
      *                                                                   CFT009
      *  Booking and originating branches                                 CFT009
      *                                                                   CFT009
     C                     MOVELS4BRCA    OTBRCA                          CFT009
     C                     MOVELS4ORBR    OTORBR                          CFT009
      *                                                                   CFT009
      *  Book code and profit centre                                      CFT009
      *                                                                   CFT009
     C                     MOVELS4BOKC    OTBOKC                          CFT009
     C                     MOVELS4PRFC    OTPRFC                          CFT009
      *                                                                   CFT009
      *  Actual Ordering Bank                                             CFT009
      *                                                                   CFT009
     C           S4ORC1    IFEQ ORCFLD                                    CFT009
     C           S4ORC2    ANDNE*BLANKS                                   CFT009
     C           S4ORC3    ANDNE*BLANKS                                   CFT009
     C           S4ORC4    ANDNE*BLANKS                                   CFT009
     C           S4ORC5    ANDNE*BLANKS                                                       CFT032
     C           S4ORC2    ANDNEOPORB1                                    CFT009
     C           S4ORC3    ANDNEOPORB2                                    CFT009
     C           S4ORC4    ANDNEOPORB3                                    CFT009
     C           S4ORC5    ANDNEOPORB4                                                        CFT032
     C                     MOVEL'A'       OPORBT                          CFT009
     C                     MOVELS4ORC2    OPORB1                          CFT009
     C                     MOVELS4ORC3    OPORB2                          CFT009
     C                     MOVELS4ORC4    OPORB3                          CFT009
     C**********           MOVEL*BLANKS   OPORB4                          CFT009              CFT032
     C                     MOVELS4ORC5    OPORB4                                              CFT032
     C                     MOVEL*BLANKS   OPORB5                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVELOPORBT    OPORBT                          CFT009
     C                     MOVELOPORB1    OPORB1                          CFT009
     C                     MOVELOPORB2    OPORB2                          CFT009
     C                     MOVELOPORB3    OPORB3                          CFT009
     C                     MOVELOPORB4    OPORB4                          CFT009
     C                     MOVELOPORB5    OPORB5                          CFT009
     C                     END                                            CFT009
      *                                                                   CFT009
      *  Message references                                               CFT009
      *                                                                   CFT009
     C                     Z-ADDOPMSGR    OPMSGR                          CFT009
     C                     Z-ADDOPKPRT    OPKPRT                          CFT009
     C                     Z-ADDOPMSGR    OTMSGR                          MMFIX1
     C                     Z-ADDOPKPRT    OTKPRT                          MMFIX1
      *                                                                   CFT009
      ** Notified delivery currency and amount                            CFT009
      *                                                                   CFT009
     C                     MOVE S4NDCY    OTNDCY                          CFT009
     C                     Z-ADDV#NDAM    OTNDAM                          CFT009
      *                                                                   CFT009
      *                                                                   CFT009
      ** Pay delivery currency and amount                                 CFT009
      *                                                                   CFT009
     C                     SELEC                                          CFT009
     C           PNWRK     WHEQ 'FONTIS'                                  CFT009
     C                     MOVE S4PDCY    PDCY                            CFT009
     C                     Z-ADDV#PDAM    PDAM                            CFT009
     C                     OTHER                                          CFT009
     C                     CLEARPDCY                                      CFT009
     C                     CLEARPDAM                                      CFT009
     C                     ENDSL                                          CFT009
      *                                                                   CFT009
      ** Set up charge currency                                           CFT009
      *                                                                   CFT009
     C                     SELEC                                          CFT009
      *                                                                   CFT009
     C           BTCHCY    WHEQ 'B'                                       CFT009
     C                     MOVELV#BCCY    OTCHGC                          CFT009
      *                                                                   CFT009
     C           BTCHCY    WHEQ 'L'                                       CFT009
     C                     MOVELV#LCCY    OTCHGC                          CFT009
      *                                                                   CFT009
     C           BTCHCY    WHEQ 'C'                                       CFT009
     C           S4ADDC    IFEQ 'A'                                       CFT009
     C                     MOVELS4SMCY    OTCHGC                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVELS4PCCY    OTCHGC                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           BTCHCY    WHEQ 'F'                                       CFT009
     C                     MOVE FCHCCY    OTCHGC                          CFT009
      *                                                                   CFT009
     C                     OTHER                                          CFT009
     C                     Z-ADD101       DBASE            ***************CFT009
     C                     MOVEL'FT0300'  DBFILE           * DBERR 101   *CFT009
     C                     MOVEL*BLANKS   DBKEY            ***************CFT009
     C                     OUT  LDA                                       CFT009
     C                     EXSR *PSSR                                     CFT009
     C                     ENDSL                                          CFT009
      *                                                                   CFT009
      * If using exchange rate from transaction, move in the correct      CFT009
      *  rate.                                                            CFT009
     C           CHTRCY    IFEQ 'Y'                                       CFT009
     C                     Z-ADDF4RATE    OTCHRT                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                                       CFT032
      ** MT103 Account Type                                                                   CFT032
      *                                                                                       CFT032
     C                     MOVELS4ORC5    OTORC5                                              CFT032
      *                                                                   CFT009
      *  Unwind subroutine stack name                                     CFT009
      *                                                                   CFT009
     C                     MOVEA*BLANKS   @STK,Q                          CFT009
     C                     SUB  1         Q                               CFT009
      *                                                                   CFT009
     CSR                   ENDSR                                          CFT009
     C/EJECT                                                              CFT009
      *****************************************************************   CFT009
      *                                                               *   CFT009
      *  ICHGVT   : Default VAT flags, total VAT, VAT rate, entry     *   CFT009
      *             charges                                           *   CFT009
      *                                                               *   CFT009
      *  CALLED BY: DFICHG                                            *   CFT009
      *                                                               *   CFT009
      *****************************************************************   CFT009
     CSR         ICHGVT    BEGSR                                          CFT009
      *                                                                   CFT009
      *  Set up subroutine stack name                                     CFT009
      *                                                                   CFT009
     C                     ADD  1         Q                               CFT009
     C                     MOVEL'ICHGVT'  @STK,Q                          CFT009
      *                                                                   CFT009
      *  Entry charges (saved in charges currency)                        CFT009
      *                                                                   CFT009
     C                     Z-ADDINTRCM    IDUMA1                          CFT009
     C                     Z-ADDINTXCH    IDUMA2                          CFT009
     C                     Z-ADDINCQCH    IDUMA3                          CFT009
     C                     Z-ADDINADCH    IDUMA4                          CFT009
     C                     Z-ADDINTLCH    IDUMA5                          CFT009
     C                     Z-ADDINMSCH    IDUMA6                          CFT009
     C                     Z-ADDIPCHCM    IPDUM7                          CFT009
      *                                                                   CFT009
      *  Existing charges are saved in levied currency, need to convert   CFT009
      *  as they are currently in charges currency from FT000980          CFT009
      *                                                                   CFT009
     C                     SELEC                                          CFT014
      *                                                                   CFT014
     C           S0CDRO    WHNE *BLANKS                                   CFT014
     C                     MOVELV#BCCY    SAVCCY  3                       CFT014
      *                                                                   CFT014
     C           S1ADDC    WHEQ 'A'                                       CFT014
     C                     MOVELS1SMCY    SAVCCY                          CFT014
      *                                                                   CFT014
     C                     OTHER                                          CFT014
     C                     MOVELS1PCCY    SAVCCY                          CFT014
     C                     ENDSL                                          CFT014
      *                                                                   CFT009
     C           CHTRCY    IFEQ 'Y'                                       CFT009
     C                     MOVELF1RATE    RATE85                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVELIPCHRT    RATE85                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      * Transfer Commission                                               CFT009
      *                                                                   CFT009
      ** SET UP CHARGE AMOUNT AND CURRENCIES FOR CALL TO FT000985.        CFT009
      *                                                                   CFT009
     C                     Z-ADDINTRCM    CHGA85                          CFT009
     C                     MOVELS1PCCY    PCCY85                          CFT009
     C                     MOVELS1SMCY    SCCY85                          CFT009
     C                     MOVELIPCHGC    CCCY85                          CFT009
     C                     MOVELSAVCCY    LCCY85                          CFT009
     C                     Z-ADD0         LCHG                            CFT009
     C                     MOVEL*BLANKS   LCHGF     P                     CFT009
      *                                                                   CFT009
     C                     CALL 'FT000985'                                CFT009
     C                     PARM           RET985 10                       CFT009
     C                     PARM           CHGA85 130                      CFT009
     C                     PARM           PCCY85  3                       CFT009
     C                     PARM           SCCY85  3                       CFT009
     C                     PARM           CCCY85  3                       CFT009
     C                     PARM           LCCY85  3                       CFT009
     C                     PARM           RATE85 138                      CFT009
     C                     PARM           LCHG   130                      CFT009
     C                     PARM           LCHGF  16                       CFT009
      *                                                                   CFT009
     C                     Z-ADDLCHG      INTRCM                          CFT009
      *                                                                   CFT009
      * Telex Charge                                                      CFT009
      *                                                                   CFT009
      ** Set up charge amount and currencies for call to FT000985.        CFT009
      *                                                                   CFT009
     C                     Z-ADDINTXCH    CHGA85                          CFT009
     C                     MOVELS1PCCY    PCCY85                          CFT009
     C                     MOVELS1SMCY    SCCY85                          CFT009
     C                     MOVELIPCHGC    CCCY85                          CFT009
     C                     MOVELSAVCCY    LCCY85                          CFT009
     C                     Z-ADD0         LCHG                            CFT009
     C                     MOVEL*BLANKS   LCHGF     P                     CFT009
      *                                                                   CFT009
     C                     CALL 'FT000985'                                CFT009
     C                     PARM           RET985 10                       CFT009
     C                     PARM           CHGA85 130                      CFT009
     C                     PARM           PCCY85  3                       CFT009
     C                     PARM           SCCY85  3                       CFT009
     C                     PARM           CCCY85  3                       CFT009
     C                     PARM           LCCY85  3                       CFT009
     C                     PARM           RATE85 138                      CFT009
     C                     PARM           LCHG   130                      CFT009
     C                     PARM           LCHGF  16                       CFT009
      *                                                                   CFT009
     C                     Z-ADDLCHG      INTXCH                          CFT009
      *                                                                   CFT009
      * Cheque Charge                                                     CFT009
      *                                                                   CFT009
      ** Set up charge amount and currencies for call to FT000985.        CFT009
      *                                                                   CFT009
     C                     Z-ADDINCQCH    CHGA85                          CFT009
     C                     MOVELS1PCCY    PCCY85                          CFT009
     C                     MOVELS1SMCY    SCCY85                          CFT009
     C                     MOVELIPCHGC    CCCY85                          CFT009
     C                     MOVELSAVCCY    LCCY85                          CFT009
     C                     Z-ADD0         LCHG                            CFT009
     C                     MOVEL*BLANKS   LCHGF     P                     CFT009
      *                                                                   CFT009
     C                     CALL 'FT000985'                                CFT009
     C                     PARM           RET985 10                       CFT009
     C                     PARM           CHGA85 130                      CFT009
     C                     PARM           PCCY85  3                       CFT009
     C                     PARM           SCCY85  3                       CFT009
     C                     PARM           CCCY85  3                       CFT009
     C                     PARM           LCCY85  3                       CFT009
     C                     PARM           RATE85 138                      CFT009
     C                     PARM           LCHG   130                      CFT009
     C                     PARM           LCHGF  16                       CFT009
      *                                                                   CFT009
     C                     Z-ADDLCHG      INCQCH                          CFT009
      *                                                                   CFT009
      * Advice Charge                                                     CFT009
      *                                                                   CFT009
      ** Set up charge amount and currencies for call to FT000985.        CFT009
      *                                                                   CFT009
     C                     Z-ADDINADCH    CHGA85                          CFT009
     C                     MOVELS1PCCY    PCCY85                          CFT009
     C                     MOVELS1SMCY    SCCY85                          CFT009
     C                     MOVELIPCHGC    CCCY85                          CFT009
     C                     MOVELSAVCCY    LCCY85                          CFT009
     C                     Z-ADD0         LCHG                            CFT009
     C                     MOVEL*BLANKS   LCHGF     P                     CFT009
      *                                                                   CFT009
     C                     CALL 'FT000985'                                CFT009
     C                     PARM           RET985 10                       CFT009
     C                     PARM           CHGA85 130                      CFT009
     C                     PARM           PCCY85  3                       CFT009
     C                     PARM           SCCY85  3                       CFT009
     C                     PARM           CCCY85  3                       CFT009
     C                     PARM           LCCY85  3                       CFT009
     C                     PARM           RATE85 138                      CFT009
     C                     PARM           LCHG   130                      CFT009
     C                     PARM           LCHGF  16                       CFT009
      *                                                                   CFT009
     C                     Z-ADDLCHG      INADCH                          CFT009
      *                                                                   CFT009
      * Telephone charge                                                  CFT009
      *                                                                   CFT009
      ** Set up charge amount and currencies for call to FT000985.        CFT009
      *                                                                   CFT009
     C                     Z-ADDINTLCH    CHGA85                          CFT009
     C                     MOVELS1PCCY    PCCY85                          CFT009
     C                     MOVELS1SMCY    SCCY85                          CFT009
     C                     MOVELIPCHGC    CCCY85                          CFT009
     C                     MOVELSAVCCY    LCCY85                          CFT009
     C                     Z-ADD0         LCHG                            CFT009
     C                     MOVEL*BLANKS   LCHGF     P                     CFT009
      *                                                                   CFT009
     C                     CALL 'FT000985'                                CFT009
     C                     PARM           RET985 10                       CFT009
     C                     PARM           CHGA85 130                      CFT009
     C                     PARM           PCCY85  3                       CFT009
     C                     PARM           SCCY85  3                       CFT009
     C                     PARM           CCCY85  3                       CFT009
     C                     PARM           LCCY85  3                       CFT009
     C                     PARM           RATE85 138                      CFT009
     C                     PARM           LCHG   130                      CFT009
     C                     PARM           LCHGF  16                       CFT009
      *                                                                   CFT009
     C                     Z-ADDLCHG      INTLCH                          CFT009
      *                                                                   CFT009
      * Miscellaneous Charge                                              CFT009
      *                                                                   CFT009
      ** Set up charge amount and currencies for call to FT000985.        CFT009
      *                                                                   CFT009
     C                     Z-ADDINMSCH    CHGA85                          CFT009
     C                     MOVELS1PCCY    PCCY85                          CFT009
     C                     MOVELS1SMCY    SCCY85                          CFT009
     C                     MOVELIPCHGC    CCCY85                          CFT009
     C                     MOVELSAVCCY    LCCY85                          CFT009
     C                     Z-ADD0         LCHG                            CFT009
     C                     MOVEL*BLANKS   LCHGF     P                     CFT009
      *                                                                   CFT009
     C                     CALL 'FT000985'                                CFT009
     C                     PARM           RET985 10                       CFT009
     C                     PARM           CHGA85 130                      CFT009
     C                     PARM           PCCY85  3                       CFT009
     C                     PARM           SCCY85  3                       CFT009
     C                     PARM           CCCY85  3                       CFT009
     C                     PARM           LCCY85  3                       CFT009
     C                     PARM           RATE85 138                      CFT009
     C                     PARM           LCHG   130                      CFT009
     C                     PARM           LCHGF  16                       CFT009
      *                                                                   CFT009
     C                     Z-ADDLCHG      INMSCH                          CFT009
      *                                                                   CFT009
      ** FX/Change                                                        CFT009
      *                                                                   CFT009
      ** Set up charge amount and currencies for call to FT000985.        CFT009
      *                                                                   CFT009
     C                     Z-ADDIPCHCM    CHGA85                          CFT009
     C                     MOVELS1PCCY    PCCY85                          CFT009
     C                     MOVELS1SMCY    SCCY85                          CFT009
     C                     MOVELIPCHGC    CCCY85                          CFT009
     C                     MOVELSAVCCY    LCCY85                          CFT009
     C                     Z-ADD0         LCHG                            CFT009
     C                     MOVEL*BLANKS   LCHGF     P                     CFT009
      *                                                                   CFT009
     C                     CALL 'FT000985'                                CFT009
     C                     PARM           RET985 10                       CFT009
     C                     PARM           CHGA85 130                      CFT009
     C                     PARM           PCCY85  3                       CFT009
     C                     PARM           SCCY85  3                       CFT009
     C                     PARM           CCCY85  3                       CFT009
     C                     PARM           LCCY85  3                       CFT009
     C                     PARM           RATE85 138                      CFT009
     C                     PARM           LCHG   130                      CFT009
     C                     PARM           LCHGF  16                       CFT009
      *                                                                   CFT009
     C                     Z-ADDLCHG      IPCHCM                          CFT009
      *                                                                   CFT009
      ** Convert new charges (miscellaneous charges 1-5) into levied      CFT009
      ** charge currency                                                  CFT009
      *                                                                   CFT009
      *                                                                   CFT009
      ** Set up charge amount and currencies for call to FT000985.        CFT009
      *                                                                   CFT009
     C                     Z-ADDIMSC01    CHGA85                          CFT009
     C                     MOVELS1PCCY    PCCY85                          CFT009
     C                     MOVELS1SMCY    SCCY85                          CFT009
     C                     MOVELIPCHGC    CCCY85                          CFT009
     C                     MOVELSAVCCY    LCCY85                          CFT009
     C                     Z-ADD0         LCHG                            CFT009
     C                     MOVEL*BLANKS   LCHGF     P                     CFT009
      *                                                                   CFT009
     C                     CALL 'FT000985'                                CFT009
     C                     PARM           RET985 10                       CFT009
     C                     PARM           CHGA85 130                      CFT009
     C                     PARM           PCCY85  3                       CFT009
     C                     PARM           SCCY85  3                       CFT009
     C                     PARM           CCCY85  3                       CFT009
     C                     PARM           LCCY85  3                       CFT009
     C                     PARM           RATE85 138                      CFT009
     C                     PARM           LCHG   130                      CFT009
     C                     PARM           LCHGF  16                       CFT009
      *                                                                   CFT009
     C                     Z-ADDLCHG      ILMSC1                          CFT009
      *                                                                   CFT009
      ** Set up charge amount and currencies for call to FT000985.        CFT009
      *                                                                   CFT009
     C                     Z-ADDIMSC02    CHGA85                          CFT009
     C                     MOVELS1PCCY    PCCY85                          CFT009
     C                     MOVELS1SMCY    SCCY85                          CFT009
     C                     MOVELIPCHGC    CCCY85                          CFT009
     C                     MOVELSAVCCY    LCCY85                          CFT009
     C                     Z-ADD0         LCHG                            CFT009
     C                     MOVEL*BLANKS   LCHGF     P                     CFT009
      *                                                                   CFT009
     C                     CALL 'FT000985'                                CFT009
     C                     PARM           RET985 10                       CFT009
     C                     PARM           CHGA85 130                      CFT009
     C                     PARM           PCCY85  3                       CFT009
     C                     PARM           SCCY85  3                       CFT009
     C                     PARM           CCCY85  3                       CFT009
     C                     PARM           LCCY85  3                       CFT009
     C                     PARM           RATE85 138                      CFT009
     C                     PARM           LCHG   130                      CFT009
     C                     PARM           LCHGF  16                       CFT009
      *                                                                   CFT009
     C                     Z-ADDLCHG      ILMSC2                          CFT009
      *                                                                   CFT009
      ** Set up charge amount and currencies for call to FT000985.        CFT009
      *                                                                   CFT009
     C                     Z-ADDIMSC03    CHGA85                          CFT009
     C                     MOVELS1PCCY    PCCY85                          CFT009
     C                     MOVELS1SMCY    SCCY85                          CFT009
     C                     MOVELIPCHGC    CCCY85                          CFT009
     C                     MOVELSAVCCY    LCCY85                          CFT009
     C                     Z-ADD0         LCHG                            CFT009
     C                     MOVEL*BLANKS   LCHGF     P                     CFT009
      *                                                                   CFT009
     C                     CALL 'FT000985'                                CFT009
     C                     PARM           RET985 10                       CFT009
     C                     PARM           CHGA85 130                      CFT009
     C                     PARM           PCCY85  3                       CFT009
     C                     PARM           SCCY85  3                       CFT009
     C                     PARM           CCCY85  3                       CFT009
     C                     PARM           LCCY85  3                       CFT009
     C                     PARM           RATE85 138                      CFT009
     C                     PARM           LCHG   130                      CFT009
     C                     PARM           LCHGF  16                       CFT009
      *                                                                   CFT009
     C                     Z-ADDLCHG      ILMSC3                          CFT009
      *                                                                   CFT009
      ** Set up charge amount and currencies for call to FT000985.        CFT009
      *                                                                   CFT009
     C                     Z-ADDIMSC04    CHGA85                          CFT009
     C                     MOVELS1PCCY    PCCY85                          CFT009
     C                     MOVELS1SMCY    SCCY85                          CFT009
     C                     MOVELIPCHGC    CCCY85                          CFT009
     C                     MOVELSAVCCY    LCCY85                          CFT009
     C                     Z-ADD0         LCHG                            CFT009
     C                     MOVEL*BLANKS   LCHGF     P                     CFT009
      *                                                                   CFT009
     C                     CALL 'FT000985'                                CFT009
     C                     PARM           RET985 10                       CFT009
     C                     PARM           CHGA85 130                      CFT009
     C                     PARM           PCCY85  3                       CFT009
     C                     PARM           SCCY85  3                       CFT009
     C                     PARM           CCCY85  3                       CFT009
     C                     PARM           LCCY85  3                       CFT009
     C                     PARM           RATE85 138                      CFT009
     C                     PARM           LCHG   130                      CFT009
     C                     PARM           LCHGF  16                       CFT009
      *                                                                   CFT009
     C                     Z-ADDLCHG      ILMSC4                          CFT009
      *                                                                   CFT009
      ** Set up charge amount and currencies for call to FT000985.        CFT009
      *                                                                   CFT009
     C                     Z-ADDIMSC05    CHGA85                          CFT009
     C                     MOVELS1PCCY    PCCY85                          CFT009
     C                     MOVELS1SMCY    SCCY85                          CFT009
     C                     MOVELIPCHGC    CCCY85                          CFT009
     C                     MOVELSAVCCY    LCCY85                          CFT009
     C                     Z-ADD0         LCHG                            CFT009
     C                     MOVEL*BLANKS   LCHGF     P                     CFT009
      *                                                                   MK0546
     C           F1RCNW    IFNE 0                                         MK0546
     C                     Z-ADD0         CHGA85                          MK0546
     C                     Z-ADD0         LCHG                            MK0546
     C                     ENDIF                                          MK0546
      *                                                                   MK0546
     C           #71GCY    IFNE *BLANKS                                   MK0546
      * Access currency details from F71G                                 MK0546
     C                     CALL 'AOCURRR0'                                MK0546
     C                     PARM *BLANKS   P@RTCD                          MK0546
     C                     PARM '*KEY    'P@OPTN                          MK0546
     C                     PARM #71GCY    WCURR   3                       MK0546
     C           SDCURR    PARM SDCURR    DSSDY                           MK0546
      *                                                                   MK0546
     C           P@RTCD    IFNE *BLANKS                                   MK0546
     C                     MOVEL'AOCURRR0'W0FILE                          MK0546
     C                     MOVEL'*CALL'   W0KEY            ************   MK0546
     C                     Z-ADD66        W0ERNB           * DBERR 66 *   MK0546
     C                     MOVEL'MEM5003' W0MSGD           ************   MK0546
     C                     MOVEL'MIDAS  ' W0MSGF                          MK0546
     C                     EXSR SRERRA                                    MK0546
     C                     ELSE                                           MK0546
     C                     Z-ADDA6NBDP    ZADEC                           MK0546
     C                     Z-ADDA6SPRT    RATE85                          MK0546
     C                     ENDIF                                          MK0546
      ** Format payment amount                                            MK0546
     C                     MOVEL*BLANK    ZFIELD                          MK0546
     C                     MOVE WRCHAM    ZFIELD                          MK0546
     C                     EXSR ZALIGN                                    MK0546
     C                     MOVE ZFIELD    CHGA85                          MK0546
     C                     CALL 'FT000985'                                MK0546
     C                     PARM           RET985 10                       MK0546
     C                     PARM           CHGA85 130                      MK0546
     C                     PARM #71GCY    PCCY85  3                       MK0546
     C                     PARM BJCYCD    SCCY85  3                       MK0546
     C                     PARM #71GCY    CCCY85  3                       MK0546
     C                     PARM BJCYCD    LCCY85  3                       MK0546
     C                     PARM           RATE85 138                      MK0546
     C                     PARM           LCHG   130                      MK0546
     C                     PARM           LCHGF  16                       MK0546
     C                     Z-ADDCHGA85    ILMSC5                          MK0546
     C                     Z-ADDLCHG      IMSC05                          MK0546
     C                     ELSE                                           MK0546
      *                                                                   CFT009
     C                     CALL 'FT000985'                                CFT009
     C                     PARM           RET985 10                       CFT009
     C                     PARM           CHGA85 130                      CFT009
     C                     PARM           PCCY85  3                       CFT009
     C                     PARM           SCCY85  3                       CFT009
     C                     PARM           CCCY85  3                       CFT009
     C                     PARM           LCCY85  3                       CFT009
     C                     PARM           RATE85 138                      CFT009
     C                     PARM           LCHG   130                      CFT009
     C                     PARM           LCHGF  16                       CFT009
      *                                                                   CFT009
     C                     Z-ADDLCHG      ILMSC5                          CFT009
     C                     ENDIF                                          MK0546
      *                                                                   CFT009
      ** Default VAT flags                                                CFT009
      *                                                                   CFT009
     C           CFT010    IFEQ 'Y'                                       CFT009
      *                                                                   CFT009
      ** VAT rate                                                         CFT009
      *                                                                   CFT009
     C                     Z-ADDWVATR     IPVATR                          CFT009
      *                                                                   CFT009
      ** Telex VAT flag                                                   CFT009
      *                                                                   CFT009
     C           ITLCOD    IFNE *BLANKS                                   CFT009
     C           ITLCOD    CHAINFTPCHGL0             90                   CFT009
      *                                                                   CFT009
     C           VATLIN    IFEQ 'Y'                                       CFT009
     C                     MOVE 'Y'       IPVAT2                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       IPVAT2                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       IPVAT2                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Cheque VAT flag                                                  CFT009
      *                                                                   CFT009
     C           ICHCHC    IFNE *BLANKS                                   CFT009
     C           ICHCHC    CHAINFTPCHGL0             90                   CFT009
      *                                                                   CFT009
     C           VATLIN    IFEQ 'Y'                                       CFT009
     C                     MOVE 'Y'       IPVAT3                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       IPVAT3                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       IPVAT3                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Advice VAT flag                                                  CFT009
      *                                                                   CFT009
     C           IADCHC    IFNE *BLANKS                                   CFT009
     C           IADCHC    CHAINFTPCHGL0             90                   CFT009
      *                                                                   CFT009
     C           VATLIN    IFEQ 'Y'                                       CFT009
     C                     MOVE 'Y'       IPVAT4                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       IPVAT4                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       IPVAT4                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Telephone VAT flag                                               CFT009
      *                                                                   CFT009
     C           ITLCHC    IFNE *BLANKS                                   CFT009
     C           ITLCHC    CHAINFTPCHGL0             90                   CFT009
      *                                                                   CFT009
     C           VATLIN    IFEQ 'Y'                                       CFT009
     C                     MOVE 'Y'       IPVAT5                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       IPVAT5                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       IPVAT5                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Miscellaneous VAT flag                                           CFT009
      *                                                                   CFT009
     C           IMISCH    IFNE *BLANKS                                   CFT009
     C           IMISCH    CHAINFTPCHGL0             90                   CFT009
      *                                                                   CFT009
     C           VATLIN    IFEQ 'Y'                                       CFT009
     C                     MOVE 'Y'       IPVAT6                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       IPVAT6                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       IPVAT6                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Miscellaneous 1 VAT flag                                         CFT009
      *                                                                   CFT009
     C           IMSCH1    IFNE *BLANKS                                   CFT009
     C           IMSCH1    CHAINFTPCHGL0             90                   CFT009
      *                                                                   CFT009
     C           VATLIN    IFEQ 'Y'                                       CFT009
     C                     MOVE 'Y'       IVTMI1                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       IVTMI1                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       IVTMI1                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Miscellaneous 2 VAT flag                                         CFT009
      *                                                                   CFT009
     C           IMSCH2    IFNE *BLANKS                                   CFT009
     C           IMSCH2    CHAINFTPCHGL0             90                   CFT009
      *                                                                   CFT009
     C           VATLIN    IFEQ 'Y'                                       CFT009
     C                     MOVE 'Y'       IVTMI2                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       IVTMI2                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       IVTMI2                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Miscellaneous 3 VAT flag                                         CFT009
      *                                                                   CFT009
     C           IMSCH3    IFNE *BLANKS                                   CFT009
     C           IMSCH3    CHAINFTPCHGL0             90                   CFT009
      *                                                                   CFT009
     C           VATLIN    IFEQ 'Y'                                       CFT009
     C                     MOVE 'Y'       IVTMI3                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       IVTMI3                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       IVTMI3                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Miscellaneous 4 VAT flag                                         CFT009
      *                                                                   CFT009
     C           IMSCH4    IFNE *BLANKS                                   CFT009
     C           IMSCH4    CHAINFTPCHGL0             90                   CFT009
      *                                                                   CFT009
     C           VATLIN    IFEQ 'Y'                                       CFT009
     C                     MOVE 'Y'       IVTMI4                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       IVTMI4                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       IVTMI4                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Miscellaneous 5 VAT flag                                         CFT009
      *                                                                   CFT009
     C           IMSCH5    IFNE *BLANKS                                   CFT009
     C           IMSCH5    CHAINFTPCHGL0             90                   CFT009
      *                                                                   CFT009
     C           VATLIN    IFEQ 'Y'                                       CFT009
     C                     MOVE 'Y'       IVTMI5                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       IVTMI5                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       IVTMI5                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Transfer Commission VAT flag                                     CFT009
      *                                                                   CFT009
     C           ITFCCC    IFNE *BLANKS                                   CFT009
     C           ITFCCC    CHAINFTPCHGL0             90                   CFT009
      *                                                                   CFT009
     C           VATLIN    IFEQ 'Y'                                       CFT009
     C                     MOVE 'Y'       IPVAT1                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       IPVAT1                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       IPVAT1                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** FX/change VAT flag                                               CFT009
      *                                                                   CFT009
     C           IFXCHE    IFNE *BLANKS                                   CFT009
     C           IFXCHE    CHAINFTPCHGL0             90                   CFT009
      *                                                                   CFT009
     C           VATLIN    IFEQ 'Y'                                       CFT009
     C                     MOVE 'Y'       IPVAT7                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       IPVAT7                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       IPVAT7                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
      *                                                                   CFT009
      ** Set all VAT flags to 'N'                                         CFT009
      *                                                                   CFT009
     C                     MOVE 'N'       IPVAT2                          CFT009
     C                     MOVE 'N'       IPVAT3                          CFT009
     C                     MOVE 'N'       IPVAT4                          CFT009
     C                     MOVE 'N'       IPVAT5                          CFT009
     C                     MOVE 'N'       IPVAT6                          CFT009
     C                     MOVE 'N'       IVTMI1                          CFT009
     C                     MOVE 'N'       IVTMI2                          CFT009
     C                     MOVE 'N'       IVTMI3                          CFT009
     C                     MOVE 'N'       IVTMI4                          CFT009
     C                     MOVE 'N'       IVTMI5                          CFT009
     C                     MOVE 'N'       IPVAT1                          CFT009
     C                     MOVE 'N'       IPVAT7                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** VAT totals                                                       CFT009
      *                                                                   CFT009
     C           IPVAT2    IFEQ 'Y'                                       CFT009
     C                     Z-ADDINTXCH    SUMVAT 150                      CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT    150                      CFT009
     C                     Z-ADD0         SUMVAT                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           IPVAT3    IFEQ 'Y'                                       CFT009
     C                     Z-ADDINCQCH    VAT                             CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
      *                                                                   CFT009
     C           IPVAT4    IFEQ 'Y'                                       CFT009
     C                     Z-ADDINADCH    VAT                             CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
      *                                                                   CFT009
     C           IPVAT5    IFEQ 'Y'                                       CFT009
     C                     Z-ADDINTLCH    VAT                             CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
      *                                                                   CFT009
     C           IPVAT6    IFEQ 'Y'                                       CFT009
     C                     Z-ADDINMSCH    VAT                             CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
      *                                                                   CFT009
     C           IVTMI1    IFEQ 'Y'                                       CFT009
     C                     Z-ADDILMSC1    VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
      *                                                                   CFT009
     C           IVTMI2    IFEQ 'Y'                                       CFT009
     C                     Z-ADDILMSC2    VAT                             CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
      *                                                                   CFT009
     C           IVTMI3    IFEQ 'Y'                                       CFT009
     C                     Z-ADDILMSC3    VAT                             CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
      *                                                                   CFT009
     C           IVTMI4    IFEQ 'Y'                                       CFT009
     C                     Z-ADDILMSC4    VAT                             CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
      *                                                                   CFT009
     C           IVTMI5    IFEQ 'Y'                                       CFT009
     C                     Z-ADDILMSC5    VAT                             CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
      *                                                                   CFT009
     C           IPVAT1    IFEQ 'Y'                                       CFT009
     C                     Z-ADDINTRCM    VAT                             CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
      *                                                                   CFT009
     C           IPVAT7    IFEQ 'Y'                                       CFT009
     C                     Z-ADDIPCHCM    VAT                             CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
      *                                                                   CFT009
      ** Calculate total VAT at end to avoid rounding errors.             CFT009
      *                                                                   CFT009
     C           IPVATR    MULT SUMVAT    VAT       H                     CFT009
     C                     Z-ADDVAT       SUMVAT                          CFT009
     C                     Z-ADDSUMVAT    IPVATT                          CFT009
      *                                                                   CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE SAVCCY    P#FRCY                          CFT009
     C                     Z-ADDIPVATT    P#FRAM                          CFT009
     C                     MOVE IPCHGC    P#TOCY                          CFT009
      *                                                                   CFT009
      ** Calculate Instructed amount via FT0010                           CFT009
      *                                                                   CFT009
     C                     CALL 'FT0010'                                  CFT009
     C                     PARM           P#0010                          CFT009
      *                                                                   CFT009
      ** Error calling FT0010                                             CFT009
      *                                                                   CFT009
     C           P#RTCD    IFEQ '*ERROR*'                                 CFT009
     C                     MOVEL'FT0010  'W0FILE           ***************CFT009
     C                     MOVEL'*CALL  ' W0KEY            * DB ERROR 153*CFT009
     C                     Z-ADD153       W0ERNB           ***************CFT009
     C                     MOVEL'MEM5003' W0MSGD                          CFT009
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT009
     C                     EXSR SRERRA                                    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVE P#TOAM    IPDUM8                          CFT009
      *                                                                   CFT009
      *  Unwind subroutine stack name                                     CFT009
      *                                                                   CFT009
     C                     MOVEA*BLANKS   @STK,Q                          CFT009
     C                     SUB  1         Q       50                      CFT009
      *                                                                   CFT009
     CSR                   ENDSR                                          CFT009
     C/EJECT                                                              CFT009
      *****************************************************************   CFT009
      *                                                               *   CFT009
      *  OCHGVT   : Default VAT flags, total VAT, VAT rate, entry     *   CFT009
      *             charges                                           *   CFT009
      *                                                               *   CFT009
      *  CALLED BY: DFOCHG                                            *   CFT009
      *                                                               *   CFT009
      *****************************************************************   CFT009
     CSR         OCHGVT    BEGSR                                          CFT009
      *                                                                   CFT009
      *  Set up subroutine stack name                                     CFT009
      *                                                                   CFT009
     C                     ADD  1         Q                               CFT009
     C                     MOVEL'OCHGVT'  @STK,Q                          CFT009
      *                                                                   CFT009
      *  Entry charges (saved in charges currency)                        CFT009
      *                                                                   CFT009
     C                     Z-ADDOTTRCM    ODUMA1                          CFT009
     C                     Z-ADDOTTXCH    ODUMA2                          CFT009
     C                     Z-ADDOTCQCH    ODUMA3                          CFT009
     C                     Z-ADDOTCSTA    ODUMA4                          CFT009
     C                     Z-ADDOTSPCH    ODUMA5                          CFT009
     C                     Z-ADDOTMSCH    ODUMA6                          CFT009
     C                     Z-ADDOTCHCM    OTDUM7                          CFT009
      *                                                                   CFT009
      *  Existing charges are saved in levied currency, need to convert   CFT009
      *  as they are currently in charges currency from FT000980          CFT009
      *                                                                   CFT009
     C                     SELEC                                          CFT009
      *                                                                   CFT009
     C           S7CDRO    WHNE *BLANKS                                   CFT009
     C                     MOVELV#BCCY    SAVCCY  3                       CFT009
      *                                                                   CFT009
     C           S4ADDC    WHEQ 'A'                                       CFT009
     C                     MOVELS4SMCY    SAVCCY                          CFT009
      *                                                                   CFT009
     C                     OTHER                                          CFT009
     C                     MOVELS4PCCY    SAVCCY                          CFT009
     C                     ENDSL                                          CFT009
      *                                                                   CFT009
     C           CHTRCY    IFEQ 'Y'                                       CFT009
     C                     MOVELF4RATE    RATE85                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVELOTCHRT    RATE85                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      * Transfer Commission                                               CFT009
      *                                                                   CFT009
      ** Set up charge amount and currencies for call to FT000985.        CFT009
      *                                                                   CFT009
     C                     Z-ADDOTTRCM    CHGA85                          CFT009
     C                     MOVELS4PCCY    PCCY85                          CFT009
     C                     MOVELS4SMCY    SCCY85                          CFT009
     C                     MOVELOTCHGC    CCCY85                          CFT009
     C                     MOVELSAVCCY    LCCY85                          CFT009
     C                     Z-ADD0         LCHG                            CFT009
     C                     MOVEL*BLANKS   LCHGF     P                     CFT009
      *                                                                   CFT009
     C                     CALL 'FT000985'                                CFT009
     C                     PARM           RET985 10                       CFT009
     C                     PARM           CHGA85 130                      CFT009
     C                     PARM           PCCY85  3                       CFT009
     C                     PARM           SCCY85  3                       CFT009
     C                     PARM           CCCY85  3                       CFT009
     C                     PARM           LCCY85  3                       CFT009
     C                     PARM           RATE85 138                      CFT009
     C                     PARM           LCHG   130                      CFT009
     C                     PARM           LCHGF  16                       CFT009
      *                                                                   CFT009
     C                     Z-ADDLCHG      OTTRCM                          CFT009
      *                                                                   CFT009
      * Telex Charge                                                      CFT009
      *                                                                   CFT009
      ** Set up charge amount and currencies for call to FT000985.        CFT009
      *                                                                   CFT009
     C                     Z-ADDOTTXCH    CHGA85                          CFT009
     C                     MOVELS4PCCY    PCCY85                          CFT009
     C                     MOVELS4SMCY    SCCY85                          CFT009
     C                     MOVELOTCHGC    CCCY85                          CFT009
     C                     MOVELSAVCCY    LCCY85                          CFT009
     C                     Z-ADD0         LCHG                            CFT009
     C                     MOVEL*BLANKS   LCHGF     P                     CFT009
      *                                                                   CFT009
     C                     CALL 'FT000985'                                CFT009
     C                     PARM           RET985 10                       CFT009
     C                     PARM           CHGA85 130                      CFT009
     C                     PARM           PCCY85  3                       CFT009
     C                     PARM           SCCY85  3                       CFT009
     C                     PARM           CCCY85  3                       CFT009
     C                     PARM           LCCY85  3                       CFT009
     C                     PARM           RATE85 138                      CFT009
     C                     PARM           LCHG   130                      CFT009
     C                     PARM           LCHGF  16                       CFT009
      *                                                                   CFT009
     C                     Z-ADDLCHG      OTTXCH                          CFT009
      *                                                                   CFT009
      * Cheque Charge                                                     CFT009
      *                                                                   CFT009
      ** Set up charge amount and currencies for call to FT000985.        CFT009
      *                                                                   CFT009
     C                     Z-ADDOTCQCH    CHGA85                          CFT009
     C                     MOVELS4PCCY    PCCY85                          CFT009
     C                     MOVELS4SMCY    SCCY85                          CFT009
     C                     MOVELOTCHGC    CCCY85                          CFT009
     C                     MOVELSAVCCY    LCCY85                          CFT009
     C                     Z-ADD0         LCHG                            CFT009
     C                     MOVEL*BLANKS   LCHGF     P                     CFT009
      *                                                                   CFT009
     C                     CALL 'FT000985'                                CFT009
     C                     PARM           RET985 10                       CFT009
     C                     PARM           CHGA85 130                      CFT009
     C                     PARM           PCCY85  3                       CFT009
     C                     PARM           SCCY85  3                       CFT009
     C                     PARM           CCCY85  3                       CFT009
     C                     PARM           LCCY85  3                       CFT009
     C                     PARM           RATE85 138                      CFT009
     C                     PARM           LCHG   130                      CFT009
     C                     PARM           LCHGF  16                       CFT009
      *                                                                   CFT009
     C                     Z-ADDLCHG      OTCQCH                          CFT009
      *                                                                   CFT009
      * Costs Abroad                                                      CFT009
      *                                                                   CFT009
      ** Set up charge amount and currencies for call to FT000985.        CFT009
      *                                                                   CFT009
     C                     Z-ADDOTCSTA    CHGA85                          CFT009
     C                     MOVELS4PCCY    PCCY85                          CFT009
     C                     MOVELS4SMCY    SCCY85                          CFT009
     C                     MOVELOTCHGC    CCCY85                          CFT009
     C                     MOVELSAVCCY    LCCY85                          CFT009
     C                     Z-ADD0         LCHG                            CFT009
     C                     MOVEL*BLANKS   LCHGF     P                     CFT009
      *                                                                   CFT009
     C                     CALL 'FT000985'                                CFT009
     C                     PARM           RET985 10                       CFT009
     C                     PARM           CHGA85 130                      CFT009
     C                     PARM           PCCY85  3                       CFT009
     C                     PARM           SCCY85  3                       CFT009
     C                     PARM           CCCY85  3                       CFT009
     C                     PARM           LCCY85  3                       CFT009
     C                     PARM           RATE85 138                      CFT009
     C                     PARM           LCHG   130                      CFT009
     C                     PARM           LCHGF  16                       CFT009
      *                                                                   CFT009
     C                     Z-ADDLCHG      OTCSTA                          CFT009
      *                                                                   CFT009
      * SWIFT Priority charge                                             CFT009
      *                                                                   CFT009
      ** Set up charge amount and currencies for call to FT000985.        CFT009
      *                                                                   CFT009
     C                     Z-ADDOTSPCH    CHGA85                          CFT009
     C                     MOVELS4PCCY    PCCY85                          CFT009
     C                     MOVELS4SMCY    SCCY85                          CFT009
     C                     MOVELOTCHGC    CCCY85                          CFT009
     C                     MOVELSAVCCY    LCCY85                          CFT009
     C                     Z-ADD0         LCHG                            CFT009
     C                     MOVEL*BLANKS   LCHGF     P                     CFT009
      *                                                                   CFT009
     C                     CALL 'FT000985'                                CFT009
     C                     PARM           RET985 10                       CFT009
     C                     PARM           CHGA85 130                      CFT009
     C                     PARM           PCCY85  3                       CFT009
     C                     PARM           SCCY85  3                       CFT009
     C                     PARM           CCCY85  3                       CFT009
     C                     PARM           LCCY85  3                       CFT009
     C                     PARM           RATE85 138                      CFT009
     C                     PARM           LCHG   130                      CFT009
     C                     PARM           LCHGF  16                       CFT009
      *                                                                   CFT009
     C                     Z-ADDLCHG      OTSPCH                          CFT009
      *                                                                   CFT009
      * Miscellaneous Charge                                              CFT009
      *                                                                   CFT009
      ** Set up charge amount and currencies for call to FT000985.        CFT009
      *                                                                   CFT009
     C                     Z-ADDOTMSCH    CHGA85                          CFT009
     C                     MOVELS4PCCY    PCCY85                          CFT009
     C                     MOVELS4SMCY    SCCY85                          CFT009
     C                     MOVELOTCHGC    CCCY85                          CFT009
     C                     MOVELSAVCCY    LCCY85                          CFT009
     C                     Z-ADD0         LCHG                            CFT009
     C                     MOVEL*BLANKS   LCHGF     P                     CFT009
      *                                                                   CFT009
     C                     CALL 'FT000985'                                CFT009
     C                     PARM           RET985 10                       CFT009
     C                     PARM           CHGA85 130                      CFT009
     C                     PARM           PCCY85  3                       CFT009
     C                     PARM           SCCY85  3                       CFT009
     C                     PARM           CCCY85  3                       CFT009
     C                     PARM           LCCY85  3                       CFT009
     C                     PARM           RATE85 138                      CFT009
     C                     PARM           LCHG   130                      CFT009
     C                     PARM           LCHGF  16                       CFT009
      *                                                                   CFT009
     C                     Z-ADDLCHG      OTMSCH                          CFT009
      *                                                                   CFT009
      ** FX/Change                                                        CFT009
      *                                                                   CFT009
      ** Set up charge amount and currencies for call to FT000985.        CFT009
      *                                                                   CFT009
     C                     Z-ADDOTCHCM    CHGA85                          CFT009
     C                     MOVELS4PCCY    PCCY85                          CFT009
     C                     MOVELS4SMCY    SCCY85                          CFT009
     C                     MOVELOTCHGC    CCCY85                          CFT009
     C                     MOVELSAVCCY    LCCY85                          CFT009
     C                     Z-ADD0         LCHG                            CFT009
     C                     MOVEL*BLANKS   LCHGF     P                     CFT009
      *                                                                   CFT009
     C                     CALL 'FT000985'                                CFT009
     C                     PARM           RET985 10                       CFT009
     C                     PARM           CHGA85 130                      CFT009
     C                     PARM           PCCY85  3                       CFT009
     C                     PARM           SCCY85  3                       CFT009
     C                     PARM           CCCY85  3                       CFT009
     C                     PARM           LCCY85  3                       CFT009
     C                     PARM           RATE85 138                      CFT009
     C                     PARM           LCHG   130                      CFT009
     C                     PARM           LCHGF  16                       CFT009
      *                                                                   CFT009
     C                     Z-ADDLCHG      OTCHCM                          CFT009
      *                                                                   CFT009
      ** Convert new charges (miscellaneous charges 1-5 & swift std)      CFT009
      ** into levied charge currency                                      CFT009
      *                                                                   CFT009
      ** Set up charge amount and currencies for call to FT000985.        CFT009
      *                                                                   CFT009
     C                     Z-ADDOPMIC1    CHGA85                          CFT009
     C                     MOVELS4PCCY    PCCY85                          CFT009
     C                     MOVELS4SMCY    SCCY85                          CFT009
     C                     MOVELOTCHGC    CCCY85                          CFT009
     C                     MOVELSAVCCY    LCCY85                          CFT009
     C                     Z-ADD0         LCHG                            CFT009
     C                     MOVEL*BLANKS   LCHGF     P                     CFT009
      *                                                                   CFT009
     C                     CALL 'FT000985'                                CFT009
     C                     PARM           RET985 10                       CFT009
     C                     PARM           CHGA85 130                      CFT009
     C                     PARM           PCCY85  3                       CFT009
     C                     PARM           SCCY85  3                       CFT009
     C                     PARM           CCCY85  3                       CFT009
     C                     PARM           LCCY85  3                       CFT009
     C                     PARM           RATE85 138                      CFT009
     C                     PARM           LCHG   130                      CFT009
     C                     PARM           LCHGF  16                       CFT009
      *                                                                   CFT009
     C                     Z-ADDLCHG      OMISC1                          CFT009
      *                                                                   CFT009
      ** Set up charge amount and currencies for call to FT000985.        CFT009
      *                                                                   CFT009
     C                     Z-ADDOPMIC2    CHGA85                          CFT009
     C                     MOVELS4PCCY    PCCY85                          CFT009
     C                     MOVELS4SMCY    SCCY85                          CFT009
     C                     MOVELOTCHGC    CCCY85                          CFT009
     C                     MOVELSAVCCY    LCCY85                          CFT009
     C                     Z-ADD0         LCHG                            CFT009
     C                     MOVEL*BLANKS   LCHGF     P                     CFT009
      *                                                                   CFT009
     C                     CALL 'FT000985'                                CFT009
     C                     PARM           RET985 10                       CFT009
     C                     PARM           CHGA85 130                      CFT009
     C                     PARM           PCCY85  3                       CFT009
     C                     PARM           SCCY85  3                       CFT009
     C                     PARM           CCCY85  3                       CFT009
     C                     PARM           LCCY85  3                       CFT009
     C                     PARM           RATE85 138                      CFT009
     C                     PARM           LCHG   130                      CFT009
     C                     PARM           LCHGF  16                       CFT009
      *                                                                   CFT009
     C                     Z-ADDLCHG      OMISC2                          CFT009
      *                                                                   CFT009
      ** Set up charge amount and currencies for call to FT000985.        CFT009
      *                                                                   CFT009
     C                     Z-ADDOPMIC3    CHGA85                          CFT009
     C                     MOVELS4PCCY    PCCY85                          CFT009
     C                     MOVELS4SMCY    SCCY85                          CFT009
     C                     MOVELOTCHGC    CCCY85                          CFT009
     C                     MOVELSAVCCY    LCCY85                          CFT009
     C                     Z-ADD0         LCHG                            CFT009
     C                     MOVEL*BLANKS   LCHGF     P                     CFT009
      *                                                                   CFT009
     C                     CALL 'FT000985'                                CFT009
     C                     PARM           RET985 10                       CFT009
     C                     PARM           CHGA85 130                      CFT009
     C                     PARM           PCCY85  3                       CFT009
     C                     PARM           SCCY85  3                       CFT009
     C                     PARM           CCCY85  3                       CFT009
     C                     PARM           LCCY85  3                       CFT009
     C                     PARM           RATE85 138                      CFT009
     C                     PARM           LCHG   130                      CFT009
     C                     PARM           LCHGF  16                       CFT009
      *                                                                   CFT009
     C                     Z-ADDLCHG      OMISC3                          CFT009
      *                                                                   CFT009
      ** Set up charge amount and currencies for call to FT000985.        CFT009
      *                                                                   CFT009
     C                     Z-ADDOPMIC4    CHGA85                          CFT009
     C                     MOVELS4PCCY    PCCY85                          CFT009
     C                     MOVELS4SMCY    SCCY85                          CFT009
     C                     MOVELOTCHGC    CCCY85                          CFT009
     C                     MOVELSAVCCY    LCCY85                          CFT009
     C                     Z-ADD0         LCHG                            CFT009
     C                     MOVEL*BLANKS   LCHGF     P                     CFT009
      *                                                                   CFT009
     C                     CALL 'FT000985'                                CFT009
     C                     PARM           RET985 10                       CFT009
     C                     PARM           CHGA85 130                      CFT009
     C                     PARM           PCCY85  3                       CFT009
     C                     PARM           SCCY85  3                       CFT009
     C                     PARM           CCCY85  3                       CFT009
     C                     PARM           LCCY85  3                       CFT009
     C                     PARM           RATE85 138                      CFT009
     C                     PARM           LCHG   130                      CFT009
     C                     PARM           LCHGF  16                       CFT009
      *                                                                   CFT009
     C                     Z-ADDLCHG      OMISC4                          CFT009
      *                                                                   CFT009
      ** Set up charge amount and currencies for call to FT000985.        CFT009
      *                                                                   CFT009
     C                     Z-ADDOPMIC5    CHGA85                          CFT009
     C                     MOVELS4PCCY    PCCY85                          CFT009
     C                     MOVELS4SMCY    SCCY85                          CFT009
     C                     MOVELOTCHGC    CCCY85                          CFT009
     C                     MOVELSAVCCY    LCCY85                          CFT009
     C                     Z-ADD0         LCHG                            CFT009
     C                     MOVEL*BLANKS   LCHGF     P                     CFT009
      *                                                                   CFT009
     C                     CALL 'FT000985'                                CFT009
     C                     PARM           RET985 10                       CFT009
     C                     PARM           CHGA85 130                      CFT009
     C                     PARM           PCCY85  3                       CFT009
     C                     PARM           SCCY85  3                       CFT009
     C                     PARM           CCCY85  3                       CFT009
     C                     PARM           LCCY85  3                       CFT009
     C                     PARM           RATE85 138                      CFT009
     C                     PARM           LCHG   130                      CFT009
     C                     PARM           LCHGF  16                       CFT009
      *                                                                   CFT009
     C                     Z-ADDLCHG      OMISC5                          CFT009
      *                                                                   CFT009
      ** Set up charge amount and currencies for call to FT000985.        CFT009
      *                                                                   CFT009
     C                     Z-ADDOSWSCC    CHGA85                          CFT009
     C                     MOVELS4PCCY    PCCY85                          CFT009
     C                     MOVELS4SMCY    SCCY85                          CFT009
     C                     MOVELOTCHGC    CCCY85                          CFT009
     C                     MOVELSAVCCY    LCCY85                          CFT009
     C                     Z-ADD0         LCHG                            CFT009
     C                     MOVEL*BLANKS   LCHGF     P                     CFT009
      *                                                                   CFT009
     C                     CALL 'FT000985'                                CFT009
     C                     PARM           RET985 10                       CFT009
     C                     PARM           CHGA85 130                      CFT009
     C                     PARM           PCCY85  3                       CFT009
     C                     PARM           SCCY85  3                       CFT009
     C                     PARM           CCCY85  3                       CFT009
     C                     PARM           LCCY85  3                       CFT009
     C                     PARM           RATE85 138                      CFT009
     C                     PARM           LCHG   130                      CFT009
     C                     PARM           LCHGF  16                       CFT009
      *                                                                   CFT009
     C                     Z-ADDLCHG      OSWSCH                          CFT009
      *                                                                   CFT009
      ** Default VAT flags                                                CFT009
      *                                                                   CFT009
     C           CFT010    IFEQ 'Y'                                       CFT009
      *                                                                   CFT009
      ** VAT rate                                                         CFT009
      *                                                                   CFT009
     C                     Z-ADDWVATR     OTVATR                          CFT009
      *                                                                   CFT009
      ** Telex VAT flag                                                   CFT009
      *                                                                   CFT009
     C           OTLXCD    IFNE *BLANKS                                   CFT009
     C           OTLXCD    CHAINFTPCHGL0             90                   CFT009
      *                                                                   CFT009
     C           VATLIN    IFEQ 'Y'                                       CFT009
     C                     MOVE 'Y'       OTVAT2                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       OTVAT2                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       OTVAT2                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Cheque VAT flag                                                  CFT009
      *                                                                   CFT009
     C           OCHQCH    IFNE *BLANKS                                   CFT009
     C           OCHQCH    CHAINFTPCHGL0             90                   CFT009
      *                                                                   CFT009
     C           VATLIN    IFEQ 'Y'                                       CFT009
     C                     MOVE 'Y'       OTVAT3                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       OTVAT3                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       OTVAT3                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Costs Abroad VAT flag                                            CFT009
      *                                                                   CFT009
     C           OCACHC    IFNE *BLANKS                                   CFT009
     C           OCACHC    CHAINFTPCHGL0             90                   CFT009
      *                                                                   CFT009
     C           VATLIN    IFEQ 'Y'                                       CFT009
     C                     MOVE 'Y'       OTVAT4                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       OTVAT4                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       OTVAT4                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** SWIFT standard Abroad VAT flag                                   CFT009
      *                                                                   CFT009
     C           OSSTCC    IFNE *BLANKS                                   CFT009
     C           OSSTCC    CHAINFTPCHGL0             90                   CFT009
      *                                                                   CFT009
     C           VATLIN    IFEQ 'Y'                                       CFT009
     C                     MOVE 'Y'       OVTSWS                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       OVTSWS                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       OVTSWS                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** SWIFT priority VAT flag                                          CFT009
      *                                                                   CFT009
     C           OSPRCC    IFNE *BLANKS                                   CFT009
     C           OSPRCC    CHAINFTPCHGL0             90                   CFT009
      *                                                                   CFT009
     C           VATLIN    IFEQ 'Y'                                       CFT009
     C                     MOVE 'Y'       OTVAT5                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       OTVAT5                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       OTVAT5                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Miscellaneous VAT flag                                           CFT009
      *                                                                   CFT009
     C           OMSCHC    IFNE *BLANKS                                   CFT009
     C           OMSCHC    CHAINFTPCHGL0             90                   CFT009
      *                                                                   CFT009
     C           VATLIN    IFEQ 'Y'                                       CFT009
     C                     MOVE 'Y'       OTVAT6                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       OTVAT6                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       OTVAT6                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Miscellaneous 1 VAT flag                                         CFT009
      *                                                                   CFT009
     C           OMSCH1    IFNE *BLANKS                                   CFT009
     C           OMSCH1    CHAINFTPCHGL0             90                   CFT009
      *                                                                   CFT009
     C           VATLIN    IFEQ 'Y'                                       CFT009
     C                     MOVE 'Y'       OVMIC1                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       OVMIC1                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       OVMIC1                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Miscellaneous 2 VAT flag                                         CFT009
      *                                                                   CFT009
     C           OMSCH2    IFNE *BLANKS                                   CFT009
     C           OMSCH2    CHAINFTPCHGL0             90                   CFT009
      *                                                                   CFT009
     C           VATLIN    IFEQ 'Y'                                       CFT009
     C                     MOVE 'Y'       OVMIC2                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       OVMIC2                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       OVMIC2                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Miscellaneous 3 VAT flag                                         CFT009
      *                                                                   CFT009
     C           OMSCH3    IFNE *BLANKS                                   CFT009
     C           OMSCH3    CHAINFTPCHGL0             90                   CFT009
      *                                                                   CFT009
     C           VATLIN    IFEQ 'Y'                                       CFT009
     C                     MOVE 'Y'       OVMIC3                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       OVMIC3                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       OVMIC3                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Miscellaneous 4 VAT flag                                         CFT009
      *                                                                   CFT009
     C           OMSCH4    IFNE *BLANKS                                   CFT009
     C           OMSCH4    CHAINFTPCHGL0             90                   CFT009
      *                                                                   CFT009
     C           VATLIN    IFEQ 'Y'                                       CFT009
     C                     MOVE 'Y'       OVMIC4                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       OVMIC4                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       OVMIC4                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Miscellaneous 5 VAT flag                                         CFT009
      *                                                                   CFT009
     C           OMSCH5    IFNE *BLANKS                                   CFT009
     C           OMSCH5    CHAINFTPCHGL0             90                   CFT009
      *                                                                   CFT009
     C           VATLIN    IFEQ 'Y'                                       CFT009
     C                     MOVE 'Y'       OVMIC5                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       OVMIC5                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       OVMIC5                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Transfer Commission VAT flag                                     CFT009
      *                                                                   CFT009
     C           OTFCCD    IFNE *BLANKS                                   CFT009
     C           OTFCCD    CHAINFTPCHGL0             90                   CFT009
      *                                                                   CFT009
     C           VATLIN    IFEQ 'Y'                                       CFT009
     C                     MOVE 'Y'       OTVAT1                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       OTVAT1                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       OTVAT1                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** FX/change VAT flag                                               CFT009
      *                                                                   CFT009
     C           OFXCAC    IFNE *BLANKS                                   CFT009
     C           OFXCAC    CHAINFTPCHGL0             90                   CFT009
      *                                                                   CFT009
     C           VATLIN    IFEQ 'Y'                                       CFT009
     C                     MOVE 'Y'       OTVAT7                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       OTVAT7                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       OTVAT7                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
      *                                                                   CFT009
      ** Set all VAT flags to 'N'                                         CFT009
      *                                                                   CFT009
     C                     MOVE 'N'       OTVAT2                          CFT009
     C                     MOVE 'N'       OTVAT3                          CFT009
     C                     MOVE 'N'       OTVAT4                          CFT009
     C                     MOVE 'N'       OVTSWS                          CFT009
     C                     MOVE 'N'       OTVAT5                          CFT009
     C                     MOVE 'N'       OTVAT6                          CFT009
     C                     MOVE 'N'       OVMIC1                          CFT009
     C                     MOVE 'N'       OVMIC2                          CFT009
     C                     MOVE 'N'       OVMIC3                          CFT009
     C                     MOVE 'N'       OVMIC4                          CFT009
     C                     MOVE 'N'       OVMIC5                          CFT009
     C                     MOVE 'N'       OTVAT1                          CFT009
     C                     MOVE 'N'       OTVAT7                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** VAT totals                                                       CFT009
      *                                                                   CFT009
     C           OTVAT1    IFEQ 'Y'                                       CFT009
     C                     Z-ADDOTTRCM    SUMVAT 150                      CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT    150                      CFT009
     C                     Z-ADD0         SUMVAT                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           OTVAT7    IFEQ 'Y'                                       CFT009
     C                     Z-ADDOTCHCM    VAT                             CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
      *                                                                   CFT009
     C           OTVAT3    IFEQ 'Y'                                       CFT009
     C                     Z-ADDOTCQCH    VAT                             CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
      *                                                                   CFT009
     C           OTVAT4    IFEQ 'Y'                                       CFT009
     C                     Z-ADDOTCSTA    VAT                             CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
      *                                                                   CFT009
     C           OTVAT2    IFEQ 'Y'                                       CFT009
     C                     Z-ADDOTTXCH    VAT                             CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
      *                                                                   CFT009
     C           OTVAT5    IFEQ 'Y'                                       CFT009
     C                     Z-ADDOTSPCH    VAT                             CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
      *                                                                   CFT009
     C           OVTSWS    IFEQ 'Y'                                       CFT009
     C                     Z-ADDOSWSCH    VAT                             CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
      *                                                                   CFT009
     C           OTVAT6    IFEQ 'Y'                                       CFT009
     C                     Z-ADDOTMSCH    VAT                             CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
      *                                                                   CFT009
     C           OVMIC1    IFEQ 'Y'                                       CFT009
     C                     Z-ADDOMISC1    VAT                             CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
      *                                                                   CFT009
     C           OVMIC2    IFEQ 'Y'                                       CFT009
     C                     Z-ADDOMISC2    VAT                             CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
      *                                                                   CFT009
     C           OVMIC3    IFEQ 'Y'                                       CFT009
     C                     Z-ADDOMISC3    VAT                             CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
      *                                                                   CFT009
     C           OVMIC4    IFEQ 'Y'                                       CFT009
     C                     Z-ADDOMISC4    VAT                             CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
      *                                                                   CFT009
     C           OVMIC5    IFEQ 'Y'                                       CFT009
     C                     Z-ADDOMISC5    VAT                             CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
      *                                                                   CFT009
      ** Calculate total VAT at end to avoid rounding errors.             CFT009
      *                                                                   CFT009
     C           OTVATR    MULT SUMVAT    VAT       H                     CFT009
     C                     Z-ADDVAT       SUMVAT                          CFT009
     C                     Z-ADDSUMVAT    OTVATT                          CFT009
      *                                                                   CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE SAVCCY    P#FRCY                          CFT009
     C                     Z-ADDOTVATT    P#FRAM                          CFT009
     C                     MOVE OTCHGC    P#TOCY                          CFT009
      *                                                                   CFT009
      ** Calculate Instructed amount via FT0010                           CFT009
      *                                                                   CFT009
     C                     CALL 'FT0010'                                  CFT009
     C                     PARM           P#0010                          CFT009
      *                                                                   CFT009
      ** Error calling FT0010                                             CFT009
      *                                                                   CFT009
      *                                                                   CFT009
     C           P#RTCD    IFEQ '*ERROR*'                                 CFT009
     C                     MOVEL'FT0010  'W0FILE           ***************CFT009
     C                     MOVEL'*CALL  ' W0KEY            * DB ERROR 154*CFT009
     C                     Z-ADD154       W0ERNB           ***************CFT009
     C                     MOVEL'MEM5003' W0MSGD                          CFT009
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT009
     C                     EXSR SRERRA                                    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVE P#TOAM    OTDUM8                          CFT009
      *  Unwind subroutine stack name                                     CFT009
      *                                                                   CFT009
     C                     MOVEA*BLANKS   @STK,Q                          CFT009
     C                     SUB  1         Q       50                      CFT009
      *                                                                   CFT009
     CSR                   ENDSR                                          CFT009
     C/EJECT                                                              CFT009
      *****************************************************************   CFT009
      *                                                               *   CFT009
      *  MVICHG   : Move new charges before writing                   *   CFT009
      *                                                               *   CFT009
      *  CALLED BY: SRMVIN                                            *   CFT009
      *                                                               *   CFT009
      *****************************************************************   CFT009
     CSR         MVICHG    BEGSR                                          CFT009
      *                                                                   CFT009
      *  Set up subroutine stack name                                     CFT009
      *                                                                   CFT009
     C                     ADD  1         Q                               CFT009
     C                     MOVEL'MVICHG'  @STK,Q                          CFT009
      *                                                                   CFT009
     C                     MOVELIFXSPS    FXSPSC                          CFT009
     C                     MOVELIPPDOF    INPDOF                          CFT009
     C                     MOVELIPVAT1    INVAT1                          CFT009
     C                     MOVELIPVAT2    INVAT2                          CFT009
     C                     MOVELIPVAT3    INVAT3                          CFT009
     C                     MOVELIPVAT4    INVAT4                          CFT009
     C                     MOVELIPVAT5    INVAT5                          CFT009
     C                     MOVELIPVAT6    INVAT6                          CFT009
     C                     MOVELIPVAT7    INVAT7                          CFT009
     C                     MOVELIPVATR    INVATR                          CFT009
     C                     MOVELIPVATT    INVATT                          CFT009
     C                     MOVELIPDUM8    INDUM8                          CFT009
     C                     Z-ADDINTRCM    TRCM                            CFT009
     C                     Z-ADDINTXCH    TXCH                            CFT009
     C                     Z-ADDINCQCH    CQCH                            CFT009
     C                     Z-ADDINADCH    ADCH                            CFT009
     C                     Z-ADDINTLCH    TLCH                            CFT009
     C                     Z-ADDINMSCH    MSCH                            CFT009
     C                     Z-ADDIPCHCM    INCHCM                          CFT009
     C                     Z-ADDIDUMA1    DUMA1                           CFT009
     C                     Z-ADDIDUMA2    DUMA2                           CFT009
     C                     Z-ADDIDUMA3    DUMA3                           CFT009
     C                     Z-ADDIDUMA4    DUMA4                           CFT009
     C                     Z-ADDIDUMA5    DUMA5                           CFT009
     C                     Z-ADDIDUMA6    DUMA6                           CFT009
     C                     Z-ADDIPDUM7    INDUM7                          CFT009
     C                     MOVELITLCOD    TLCODE                          CFT009
     C                     MOVELICHCHC    CHCHCD                          CFT009
     C                     MOVELIADCHC    ADCHCD                          CFT009
     C                     MOVELITLCHC    TLCHCD                          CFT009
     C                     MOVELIMISCH    MISCH                           CFT009
     C                     MOVELIMSCH1    MSCH1                           CFT009
     C                     MOVELIMSCH2    MSCH2                           CFT009
     C                     MOVELIMSCH3    MSCH3                           CFT009
     C                     MOVELIMSCH4    MSCH4                           CFT009
     C                     MOVELIMSCH5    MSCH5                           CFT009
     C                     MOVELITFCCC    TFCCCO                          CFT009
     C                     MOVELIFXCHE    FXCHEC                          CFT009
     C                     MOVELIVTMI1    VTMIC1                          CFT009
     C                     MOVELIVTMI2    VTMIC2                          CFT009
     C                     MOVELIVTMI3    VTMIC3                          CFT009
     C                     MOVELIVTMI4    VTMIC4                          CFT009
     C                     MOVELIVTMI5    VTMIC5                          CFT009
     C                     Z-ADDIMSC01    CMSC01                          CFT009
     C                     Z-ADDIMSC02    CMSC02                          CFT009
     C                     Z-ADDIMSC03    CMSC03                          CFT009
     C                     Z-ADDIMSC04    CMSC04                          CFT009
     C                     Z-ADDIMSC05    CMSC05                          CFT009
     C                     Z-ADDILMSC1    MSC01                           CFT009
     C                     Z-ADDILMSC2    MSC02                           CFT009
     C                     Z-ADDILMSC3    MSC03                           CFT009
     C                     Z-ADDILMSC4    MSC04                           CFT009
     C                     Z-ADDILMSC5    MSC05                           CFT009
     C                     Z-ADDIDATNA    DATNAH                          CFT009
     C                     Z-ADDIPCHRT    INCHRT                          CFT009
     C                     MOVELIPCHGC    INCHGC                          CFT009
     C                     Z-ADDWURDNB    DATNOE                          CFT009
     C                     MOVELWNTFY     CUNFLG                          CFT009
      *                                                                   CFT009
      * If use transaction exchange rate, move to charges X-Rate          CFT009
      *                                                                   CFT009
     C           CHTRCY    IFEQ 'Y'                                       CFT009
     C                     Z-ADDF1RATE    INCHRT                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      *  Unwind subroutine stack name                                     CFT009
      *                                                                   CFT009
     C                     MOVEA*BLANKS   @STK,Q                          CFT009
     C                     SUB  1         Q       50                      CFT009
      *                                                                   CFT009
     CSR                   ENDSR                                          CFT009
     C/EJECT                                                              CFT009
      *****************************************************************   CFT009
      *                                                               *   CFT009
      *  MVOCHG   : Move new charges before writing                   *   CFT009
      *                                                               *   CFT009
      *  CALLED BY: SRMVOT                                            *   CFT009
      *                                                               *   CFT009
      *****************************************************************   CFT009
     CSR         MVOCHG    BEGSR                                          CFT009
      *                                                                   CFT009
      *  Set up subroutine stack name                                     CFT009
      *                                                                   CFT009
     C                     ADD  1         Q                               CFT009
     C                     MOVEL'MVOCHG'  @STK,Q                          CFT009
      *                                                                   CFT009
     C                     MOVELOTVAT1    OPVAT1                          CFT009
     C                     MOVELOTVAT2    OPVAT2                          CFT009
     C                     MOVELOTVAT3    OPVAT3                          CFT009
     C                     MOVELOTVAT4    OPVAT4                          CFT009
     C                     MOVELOTVAT5    OPVAT5                          CFT009
     C                     MOVELOTVAT6    OPVAT6                          CFT009
     C                     MOVELOTVAT7    OPVAT7                          CFT009
     C                     MOVELOTVATR    OPVATR                          CFT009
     C                     MOVELOTVATT    OPVATT                          CFT009
     C                     MOVELOTDUM8    OPDUM8                          CFT009
     C                     Z-ADDOTTRCM    TRCM                            CFT009
     C                     Z-ADDOTTXCH    TXCH                            CFT009
     C                     Z-ADDOTCQCH    CQCH                            CFT009
     C                     Z-ADDOTCSTA    CSTA                            CFT009
     C                     Z-ADDOTSPCH    SPCH                            CFT009
     C                     Z-ADDOTMSCH    MSCH                            CFT009
     C                     Z-ADDOTCHCM    OPCHCM                          CFT009
     C                     Z-ADDODUMA1    DUMA1                           CFT009
     C                     Z-ADDODUMA2    DUMA2                           CFT009
     C                     Z-ADDODUMA3    DUMA3                           CFT009
     C                     Z-ADDODUMA4    DUMA4                           CFT009
     C                     Z-ADDODUMA5    DUMA5                           CFT009
     C                     Z-ADDODUMA6    DUMA6                           CFT009
     C                     Z-ADDOTDUM7    OPDUM7                          CFT009
     C                     MOVELOPPDOF    OTPDOF                          CFT009
     C                     MOVELOFXSRS    FXSRSC                          CFT009
     C                     MOVELOTLXCD    TLXCDE                          CFT009
     C                     MOVELOCHQCH    CHQCHC                          CFT009
     C                     MOVELOCACHC    CACHCD                          CFT009
     C                     MOVELOSSTCC    SSTCCD                          CFT009
     C                     MOVELOSPRCC    SPRCCD                          CFT009
     C                     MOVELOMSCHC    MSCHC                           CFT009
     C                     MOVELOMSCH1    MSCHC1                          CFT009
     C                     MOVELOMSCH2    MSCHC2                          CFT009
     C                     MOVELOMSCH3    MSCHC3                          CFT009
     C                     MOVELOMSCH4    MSCHC4                          CFT009
     C                     MOVELOMSCH5    MSCHC5                          CFT009
     C                     MOVELOTFCCD    TFCCCD                          CFT009
     C                     MOVELOFXCAC    FXCACC                          CFT009
     C                     MOVELOVTSWS    VTSWSC                          CFT009
     C                     MOVELOVMIC1    VMIC1                           CFT009
     C                     MOVELOVMIC2    VMIC2                           CFT009
     C                     MOVELOVMIC3    VMIC3                           CFT009
     C                     MOVELOVMIC4    VMIC4                           CFT009
     C                     MOVELOVMIC5    VMIC5                           CFT009
     C                     Z-ADDOMISC1    MISC01                          CFT009
     C                     Z-ADDOMISC2    MISC02                          CFT009
     C                     Z-ADDOMISC3    MISC03                          CFT009
     C                     Z-ADDOMISC4    MISC04                          CFT009
     C                     Z-ADDOMISC5    MISC05                          CFT009
     C                     Z-ADDOSWSCH    SWSCHG                          CFT009
     C                     Z-ADDOPMIC1    MISCC1                          CFT009
     C                     Z-ADDOPMIC2    MISCC2                          CFT009
     C                     Z-ADDOPMIC3    MISCC3                          CFT009
     C                     Z-ADDOPMIC4    MISCC4                          CFT009
     C                     Z-ADDOPMIC5    MISCC5                          CFT009
     C                     Z-ADDOSWSCC    SWSCCC                          CFT009
     C                     Z-ADDODATNA    DATNAO                          CFT009
     C                     MOVELOTCHGC    OPCHGC                          CFT009
     C                     Z-ADDWURDNB    DATNED                          CFT009
     C                     MOVELWNTFY     CUNFLA                          CFT009
     C                     Z-ADDOTCHRT    OPCHRT                          CFT009
      *                                                                   CFT009
      * If using exchange rate from transaction, move in the correct      CFT009
      *  rate.                                                            CFT009
     C           CHTRCY    IFEQ 'Y'                                       CFT009
     C                     Z-ADDF4RATE    OPCHRT                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      *  Unwind subroutine stack name                                     CFT009
      *                                                                   CFT009
     C                     MOVEA*BLANKS   @STK,Q                          CFT009
     C                     SUB  1         Q       50                      CFT009
      *                                                                   CFT009
     CSR                   ENDSR                                          CFT009
     C/EJECT                                                              CFT009
      *****************************************************************   CFT009
      *                                                               *   CFT009
      *  SMOCHG   : Sum charges for outgoing payments                 *   CFT009
      *                                                               *   CFT009
      *  CALLED BY:                                                   *   CFT009
      *                                                               *   CFT009
      *****************************************************************   CFT009
     CSR         SMOCHG    BEGSR                                          CFT009
      *                                                                   CFT009
      *  Set up subroutine stack name                                     CFT009
      *                                                                   CFT009
     C                     ADD  1         Q                               CFT009
     C                     MOVEL'SMOCHG'  @STK,Q                          CFT009
      *                                                                   CFT009
     C           TXCH      ADD  CQCH      ##CHGS                          CFT009
     C                     ADD  CSTA      ##CHGS                          CFT009
     C                     ADD  SPCH      ##CHGS                          CFT009
     C                     ADD  MSCH      ##CHGS                          CFT009
     C                     ADD  TRCM      ##CHGS                          CFT009
     C                     ADD  SWSCHG    ##CHGS                          CFT009
     C                     ADD  MISC01    ##CHGS                          CFT009
     C                     ADD  MISC02    ##CHGS                          CFT009
     C                     ADD  MISC03    ##CHGS                          CFT009
     C                     ADD  MISC04    ##CHGS                          CFT009
     C                     ADD  MISC05    ##CHGS                          CFT009
      *                                                                   CFT009
     C           S01494    IFEQ 'Y'                                       CFT009
     C                     ADD  OPCHCM    ##CHGS                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           CFT010    IFEQ 'Y'                                       CFT009
     C                     ADD  OPVATT    ##CHGS                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      *  Unwind subroutine stack name                                     CFT009
      *                                                                   CFT009
     C                     MOVEA*BLANKS   @STK,Q                          CFT009
     C                     SUB  1         Q                               CFT009
      *                                                                   CFT009
     CSR                   ENDSR                                          CFT009
     C/EJECT                                                              CFT009
      *****************************************************************   CFT009
      *                                                               *   CFT009
      *  SMICHG   : Sum charges for Incoming payments                 *   CFT009
      *                                                               *   CFT009
      *  CALLED BY:                                                   *   CFT009
      *                                                               *   CFT009
      *****************************************************************   CFT009
     CSR         SMICHG    BEGSR                                          CFT009
      *                                                                   CFT009
      *  Set up subroutine stack name                                     CFT009
      *                                                                   CFT009
     C                     ADD  1         Q                               CFT009
     C                     MOVEL'SMICHG'  @STK,Q                          CFT009
      *                                                                   CFT009
     C           TXCH      ADD  CQCH      ##CHGS                          CFT009
     C                     ADD  ADCH      ##CHGS                          CFT009
     C                     ADD  TLCH      ##CHGS                          CFT009
     C                     ADD  MSCH      ##CHGS                          CFT009
     C                     ADD  TRCM      ##CHGS                          CFT009
     C                     ADD  MSC01     ##CHGS                          CFT009
     C                     ADD  MSC02     ##CHGS                          CFT009
     C                     ADD  MSC03     ##CHGS                          CFT009
     C                     ADD  MSC04     ##CHGS                          CFT009
     C                     ADD  MSC05     ##CHGS                          CFT009
      *                                                                   CFT009
     C           S01494    IFEQ 'Y'                                       CFT009
     C                     ADD  INCHCM    ##CHGS                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           CFT010    IFEQ 'Y'                                       CFT009
     C                     ADD  INVATT    ##CHGS                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      *  Unwind subroutine stack name                                     CFT009
      *                                                                   CFT009
     C                     MOVEA*BLANKS   @STK,Q                          CFT009
     C                     SUB  1         Q                               CFT009
      *                                                                   CFT009
     CSR                   ENDSR                                          CFT009
     C/EJECT                                                              CFT009
      *****************************************************************   CFT009
      *                                                               *   CFT009
      *  SPCGIN   :                                                   *   CFT009
      *                                                               *   CFT009
      *  CALLED BY:                                                   *   CFT009
      *                                                               *   CFT009
      *****************************************************************   CFT009
     CSR         SPCGIN    BEGSR                                          CFT009
      *                                                                   CFT009
      *  Set up subroutine stack name                                     CFT009
      *                                                                   CFT009
     C                     ADD  1         Q                               CFT009
     C                     MOVEL'SPCGIN'  @STK,Q                          CFT009
      *                                                                   CFT009
      ** Sum all charges together                                         CFT009
      *                                                                   CFT009
     C                     EXSR SMICHG                                    CFT009
      *                                                                   CFT009
     C           ##CHGS    IFEQ 0                                         CFT009
     C                     GOTO EXCGIN                                    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      *  Move fields to Q#DTA structure and call AOSPOSU0                 CFT009
      *                                                                   CFT009
     C                     CLEARQ#DTA                                     CFT009
      *                                                                   CFT009
      *  If add use Receiver's Correspondent and Sender                   CFT009
      *                                                                   CFT009
     C                     SELEC                                          CFT009
     C           CDRT      WHNE *BLANKS                                   CFT009
     C                     MOVELCDRT      Q#ATYP                          CFT009
     C                     MOVELCDRO      Q#ACCT                          CFT009
     C                     EXSR SRFLGL                                                      HVB005
     C*****      6         SUBSTQ#ACCT:1  W#CNU1                                     CGL029 HVB005
     C*****      3         SUBSTQ#ACCT:7  Q#CCY1                                     CGL029 HVB005
     C*****      10        SUBSTQ#ACCT:10 W#ACO1                                     CGL029 HVB005
     C*****      2         SUBSTQ#ACCT:20 W#ACS1                                     CGL029 HVB005
     C*****      3         SUBSTQ#ACCT:22 Q#BRC1                                     CGL029 HVB005
     C*****                MOVE W#CNU1    Q#CNU1                                     CGL029 HVB005
     C*****                MOVE W#ACO1    Q#ACO1                                     CGL029 HVB005
     C*****                MOVE W#ACS1    Q#ACS1                                     CGL029 HVB005
     C                     MOVELCDBR      Q#BRCA                          CFT009
     C                     MOVELBJCYCD    Q#CCY                           CFT009
     C           Q#ATYP    IFEQ 'R'                                                       AR1089518A
     C           10        SUBSTQ#ACCT:1  W#ACNO                                          AR1089518A
     C                     MOVE W#ACNO    Q#ACNO                                          AR1089518A
     C                     ENDIF                                                          AR1089518A
     C           ADDC      IFEQ 'A'                                       CFT009
     C                     Z-ADDSLDT      Q#VDAT                          CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADDPVDT      Q#VDAT                          CFT009
     C                     ENDIF                                          CFT009
     C           ADDC      WHEQ 'A'                                       CFT009
     C                     MOVELSMCY      Q#CCY                           CFT009
      *                                                                   CFT009
     C           CFT014    IFEQ 'Y'                                       CFT009
     C           INTRIT    ANDNE*BLANK                                    CFT009
     C                     MOVE INTRIT    Q#ATYP                          CFT009
      *                                                                   CFT009
      ** Determine corresponding Midas account of IBAN account            CFT009
      ** for Third Reimbursement Institution.                             CFT009
      *                                                                   CFT009
     C           INTRIT    IFEQ 'I'                                       CFT009
     C           CFT004    ANDEQ'Y'                                       CFT009
     C                     MOVELINTRIB    W#C1                                              HVB005
     C           W#C1      IFEQ '/'                                                         HVB005
     C           33        SUBSTINTRIB:2  P@IBN2                                            HVB005
     C                     ELSE                                                             HVB005
     C                     MOVELINTRIB    P@IBN2                                            HVB005
     C                     ENDIF                                                            HVB005
     C*****                MOVELINTRIB    P@IBN2                          CFT009            HVB005
     C                     MOVE *BLANKS   DSSDY                           CFT009
     C                     CALL 'AOIBANR4'                                CFT009
     C                     PARM *BLANKS   P@RTCD                          CFT009
     C                     PARM '*KEY   ' P@OPTN                          CFT009
     C                     PARM           P@IBN2                          CFT009
     C           P@ACCN    PARM           DSSDY                           CFT009
      *                                                                   CFT009
     C           P@RTCD    IFNE *BLANKS                                   CFT009
     C                     Z-ADD155       W0ERNB                          CFT009
     C                     MOVELP@IBN2    W0KEY                           CFT009
     C                     MOVEL'ACCNTL6' W0FILE                          CFT009
     C                     MOVEL'MEM5004' W0MSGD                          CFT009
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT009
     C                     EXSR SRERRA                                    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C**********           Z-ADDCNUM      WICNUM                                       CFT009 CSD027
     C                     MOVE CNUM      WICNUM                                              CSD027
     C                     MOVE CCY       WICCY                           CFT009
     C                     Z-ADDACOD      WIACOD                          CFT009
     C                     Z-ADDACSQ      WIACSQ                          CFT009
     C                     MOVE IBBRCA    WIBRCA                          CFT009
     C                     MOVELWIACNT    Q#ACCT                          CFT009
     C                     EXSR SRFLGL                                                      HVB005
     C*****      6         SUBSTQ#ACCT:1  W#CNU1                                     CGL029 HVB005
     C*****      3         SUBSTQ#ACCT:7  Q#CCY1                                     CGL029 HVB005
     C*****      10        SUBSTQ#ACCT:10 W#ACO1                                     CGL029 HVB005
     C*****      2         SUBSTQ#ACCT:20 W#ACS1                                     CGL029 HVB005
     C*****      3         SUBSTQ#ACCT:22 Q#BRC1                                     CGL029 HVB005
     C*****                MOVE W#CNU1    Q#CNU1                                     CGL029 HVB005
     C*****                MOVE W#ACO1    Q#ACO1                                     CGL029 HVB005
     C*****                MOVE W#ACS1    Q#ACS1                                     CGL029 HVB005
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     MOVELINTRIB    Q#ACCT                          CFT009
     C                     EXSR SRFLGL                                                      HVB005
     C*****      6         SUBSTQ#ACCT:1  W#CNU1                                     CGL029 HVB005
     C*****      3         SUBSTQ#ACCT:7  Q#CCY1                                     CGL029 HVB005
     C*****      10        SUBSTQ#ACCT:10 W#ACO1                                     CGL029 HVB005
     C*****      2         SUBSTQ#ACCT:20 W#ACS1                                     CGL029 HVB005
     C*****      3         SUBSTQ#ACCT:22 Q#BRC1                                     CGL029 HVB005
     C*****                MOVE W#CNU1    Q#CNU1                                     CGL029 HVB005
     C*****                MOVE W#ACO1    Q#ACO1                                     CGL029 HVB005
     C*****                MOVE W#ACS1    Q#ACS1                                     CGL029 HVB005
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
      *                                                                   CFT009
     C           INRCRT    IFNE *BLANKS                                   CFT009
     C                     MOVELINRCRT    Q#ATYP                          CFT009
      *                                                                   CFT009
      ** Determine corresponding Midas account of IBAN account            CFT009
      ** for Receiver's Correspondent.                                    CFT009
      *                                                                   CFT009
     C           INRCRT    IFEQ 'I'                                       CFT009
     C           CFT004    ANDEQ'Y'                                       CFT009
     C           34        SUBSTINRCO1:2  P@IBN2                          CFT009
     C                     MOVE *BLANKS   DSSDY                           CFT009
     C                     CALL 'AOIBANR4'                                CFT009
     C                     PARM *BLANKS   P@RTCD                          CFT009
     C                     PARM '*KEY   ' P@OPTN                          CFT009
     C                     PARM           P@IBN2                          CFT009
     C           P@ACCN    PARM           DSSDY                           CFT009
      *                                                                   CFT009
     C           P@RTCD    IFNE *BLANKS                                   CFT009
     C                     Z-ADD156       W0ERNB                          CFT009
     C                     MOVELP@IBN2    W0KEY                           CFT009
     C                     MOVEL'ACCNTL6' W0FILE                          CFT009
     C                     MOVEL'MEM5004' W0MSGD                          CFT009
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT009
     C                     EXSR SRERRA                                    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C**********           Z-ADDCNUM      WICNUM                                       CFT009 CSD027
     C                     MOVE CNUM      WICNUM                                              CSD027
     C                     MOVE CCY       WICCY                           CFT009
     C                     Z-ADDACOD      WIACOD                          CFT009
     C                     Z-ADDACSQ      WIACSQ                          CFT009
     C                     MOVE IBBRCA    WIBRCA                          CFT009
     C                     MOVELWIACNT    Q#ACCT                          CFT009
     C                     EXSR SRFLGL                                                      HVB005
     C*****      6         SUBSTQ#ACCT:1  W#CNU1                                     CGL029 HVB005
     C*****      3         SUBSTQ#ACCT:7  Q#CCY1                                     CGL029 HVB005
     C*****      10        SUBSTQ#ACCT:10 W#ACO1                                     CGL029 HVB005
     C*****      2         SUBSTQ#ACCT:20 W#ACS1                                     CGL029 HVB005
     C*****      3         SUBSTQ#ACCT:22 Q#BRC1                                     CGL029 HVB005
     C*****                MOVE W#CNU1    Q#CNU1                                     CGL029 HVB005
     C*****                MOVE W#ACO1    Q#ACO1                                     CGL029 HVB005
     C*****                MOVE W#ACS1    Q#ACS1                                     CGL029 HVB005
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     MOVELINRCO1    Q#ACCT                          CFT009
     C                     EXSR SRFLGL                                                      HVB005
     C*****      6         SUBSTQ#ACCT:1  W#CNU1                                     CGL029 HVB005
     C*****      3         SUBSTQ#ACCT:7  Q#CCY1                                     CGL029 HVB005
     C*****      10        SUBSTQ#ACCT:10 W#ACO1                                     CGL029 HVB005
     C*****      2         SUBSTQ#ACCT:20 W#ACS1                                     CGL029 HVB005
     C*****      3         SUBSTQ#ACCT:22 Q#BRC1                                     CGL029 HVB005
     C*****                MOVE W#CNU1    Q#CNU1                                     CGL029 HVB005
     C*****                MOVE W#ACO1    Q#ACO1                                     CGL029 HVB005
     C*****                MOVE W#ACS1    Q#ACS1                                     CGL029 HVB005
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     MOVELSNTP      Q#ATYP                          CFT009
     C                     MOVELSND1      Q#ACCT                          CFT009
     C                     EXSR SRFLGL                                                      HVB005
     C*****      6         SUBSTQ#ACCT:1  W#CNU1                                     CGL029 HVB005
     C*****      3         SUBSTQ#ACCT:7  Q#CCY1                                     CGL029 HVB005
     C*****      10        SUBSTQ#ACCT:10 W#ACO1                                     CGL029 HVB005
     C*****      2         SUBSTQ#ACCT:20 W#ACS1                                     CGL029 HVB005
     C*****      3         SUBSTQ#ACCT:22 Q#BRC1                                     CGL029 HVB005
     C*****                MOVE W#CNU1    Q#CNU1                                     CGL029 HVB005
     C*****                MOVE W#ACO1    Q#ACO1                                     CGL029 HVB005
     C*****                MOVE W#ACS1    Q#ACS1                                     CGL029 HVB005
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C/COPY WNCPYSRC,FT0355C036                                           CFT009
     C                     Z-ADDSLDT      Q#VDAT                          CFT009
     C                     OTHER                                          CFT009
      *                                                                   CFT009
      *  If deduct use Account with Bank and Beneficiary                  CFT009
      *                                                                   CFT009
     C                     MOVELPCCY      Q#CCY                           CFT009
     C           ACBT      IFNE *BLANKS                                   CFT009
     C                     MOVELACBT      Q#ATYP                          CFT009
     C                     MOVELACBK      Q#ACCT                          CFT009
     C                     EXSR SRFLGL                                                      HVB005
     C*****      6         SUBSTQ#ACCT:1  W#CNU1                                     CGL029 HVB005
     C*****      3         SUBSTQ#ACCT:7  Q#CCY1                                     CGL029 HVB005
     C*****      10        SUBSTQ#ACCT:10 W#ACO1                                     CGL029 HVB005
     C*****      2         SUBSTQ#ACCT:20 W#ACS1                                     CGL029 HVB005
     C*****      3         SUBSTQ#ACCT:22 Q#BRC1                                     CGL029 HVB005
     C*****                MOVE W#CNU1    Q#CNU1                                     CGL029 HVB005
     C*****                MOVE W#ACO1    Q#ACO1                                     CGL029 HVB005
     C*****                MOVE W#ACS1    Q#ACS1                                     CGL029 HVB005
     C                     MOVELACBB      Q#BRCA                          CFT009
     C           Q#ATYP    IFEQ 'R'                                                       AR1089518A
     C           10        SUBSTQ#ACCT:1  W#ACNO                                          AR1089518A
     C                     MOVE W#ACNO    Q#ACNO                                          AR1089518A
     C                     ENDIF                                                          AR1089518A
     C                     ELSE                                           CFT009
     C                     MOVELBNCT      Q#ATYP                          CFT009
      * If not IBAN                                                       CFT009
     C           CFT004    IFNE 'Y'                                       CFT009
     C           CFT004    OREQ 'Y'                                       CFT009
     C           BNCT      ANDNE'I'                                       CFT009
     C                     MOVELBNC1      Q#ACCT                          CFT009
     C                     EXSR SRFLGL                                                      HVB005
     C*****      6         SUBSTQ#ACCT:1  W#CNU1                                     CGL029 HVB005
     C*****      3         SUBSTQ#ACCT:7  Q#CCY1                                     CGL029 HVB005
     C*****      10        SUBSTQ#ACCT:10 W#ACO1                                     CGL029 HVB005
     C*****      2         SUBSTQ#ACCT:20 W#ACS1                                     CGL029 HVB005
     C*****      3         SUBSTQ#ACCT:22 Q#BRC1                                     CGL029 HVB005
     C*****                MOVE W#CNU1    Q#CNU1                                     CGL029 HVB005
     C*****                MOVE W#ACO1    Q#ACO1                                     CGL029 HVB005
     C*****                MOVE W#ACS1    Q#ACS1                                     CGL029 HVB005
     C                     ELSE                                           CFT009
     C           34        SUBSTBNC1:2    BIBAN  34                       CFT009
     C                     MOVE *BLANKS   DSSDY                           CFT009
     C                     CALL 'AOIBANR4'                                CFT009
     C                     PARM           P@RTCD                          CFT009
     C                     PARM '*KEY   ' P@OPTN                          CFT009
     C                     PARM BIBAN     P@IBN2 34                       CFT009
     C           P@ACCN    PARM           DSSDY                           CFT009
     C**********           Z-ADDCNUM      Q#CNU1                                       CFT009 CSD027
     C                     MOVE CNUM      Q#CNU1                                              CSD027
     C                     MOVE CCY       Q#CCY1                          CFT009
     C                     Z-ADDACOD      Q#ACO1                          CFT009
     C                     Z-ADDACSQ      Q#ACS1                          CFT009
     C                     MOVE IBBRCA    Q#BRC1                          CFT009
     C                     ENDIF                                          CFT009
     C                     END                                            CFT009
     C                     Z-ADDPVDT      Q#VDAT                          CFT009
     C                     END                                            CFT009
      *                                                                   CFT009
      * Set posting date according to FT Control Data                     CFT009
      *                                                                   CFT009
     C           T#PDTI    IFEQ 'I'                                       CFT009
     C                     Z-ADDBJRDNB    Q#PSTD                          CFT009
     C                     ELSE                                           CFT009
     C           T#PDTI    IFEQ 'E'                                       CFT009
     C           ADDC      IFEQ 'A'                                       CFT009
     C                     Z-ADDSLDT      Q#PSTD                          CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADDPVDT      Q#PSTD                          CFT009
     C                     END                                            CFT009
     C                     ELSE                                           CFT009
     C           SLDT      IFLT PVDT                                      CFT009
     C                     Z-ADDSLDT      Q#PSTD                          CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADDPVDT      Q#PSTD                          CFT009
     C                     END                                            CFT009
     C                     END                                            CFT009
     C                     END                                            CFT009
      *                                                                   CFT009
     C                     MOVEL'I'       Q#IO                            CFT009
     C                     MOVELPYTP      Q#TRYP                          CFT009
     C                     MOVELPREF      Q#PREF                          CFT009
     C                     MOVEL'FT'      Q#MOD                           CFT009
     C                     MOVEL'01'      Q#OLRC                          CFT009
     C                     MOVEL##FTOV    Q#FTOV                          CFT009
     C                     Z-ADD##CHGS    Q#AMT                           CFT009
     C                     MOVEL'Y'       Q#RPST                          CFT009
     C                     Z-ADD30        Q#RPNB                          CFT009
     C                     MOVEL'D'       Q#RTYP                          CFT009
     C           CAP205    IFEQ 'Y'                                                           CAP205
     C                     MOVEL'F'       Q#MTYP                                              CAP205
     C                     ENDIF                                                              CAP205
      *                                                                   CFT009
      *  Call AOSPOSU0                                                    CFT009
      *                                                                   CFT009
     C                     CALL 'AOSPOSU0'             9090               CFT009
     C           R#RTN     PARM *BLANKS   O#RTN   7                       CFT009
     C                     PARM '*ADD    'W2ACT   8                       CFT009
     C                     PARM Q#DTA     O#DTA 256                       CFT009
      *                                                                   CFT009
     C           *IN90     IFEQ '1'                                       CFT009
     C           R#RTN     ORNE *BLANKS                                   CFT009
     C                     MOVEL'AOSPOSU0'W0FILE           ************** CFT009
     C                     MOVEL'*CALL   'W0KEY            * DB ERROR 157 CFT009
     C                     Z-ADD157       W0ERNB           ************** CFT009
     C                     MOVEL'MEM5003' W0MSGD                          CFT009
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT009
     C                     EXSR SRERRA                                    CFT009
     C                     END                                            CFT009
      *                                                                   CFT009
      *  Unwind subroutine stack name                                     CFT009
      *                                                                   CFT009
     C           EXCGIN    TAG                                            CFT009
     C                     MOVEA*BLANKS   @STK,Q                          CFT009
     C                     SUB  1         Q                               CFT009
      *                                                                   CFT009
     CSR                   ENDSR                                          CFT009
      /EJECT                                                                                  CSW209
      *****************************************************************                       CSW209
      *                                                               *                       CSW209
      *  SRCVIN   : Move cover messages data into Incoming Payments   *                       CSW209
      *             Record                                            *                       CSW209
      *                                                               *                       CSW209
      *  CALLED BY: SRMVIN                                            *                       CSW209
      *                                                               *                       CSW209
      *****************************************************************                       CSW209
     CSR         SRCVIN    BEGSR                                                              CSW209
      *                                                                                       CSW209
      ** Network, Message Type, Validation Flag                                               CSW209
      *                                                                                       CSW209
     C                     MOVELSANWRK    INNWRK                                              CSW209
     C                     MOVELSAMTPY    INMTPY                                              CSW209
     C                     MOVELSAVALF    INVALF                                              CSW209
      *                                                                                       CSW209
      ** Ordering Customer (Cover)                                                            CSW209
      *                                                                                       CSW209
     C                     MOVELFACOCT    INCOCT                                              CSW209
     C                     MOVELSACOC1    INCOC1                                              CSW209
     C                     MOVELSACOC2    INCOC2                                              CSW209
     C                     MOVELSACOC3    INCOC3                                              CSW209
     C                     MOVELSACOC4    INCOC4                                              CSW209
     C                     MOVELSACOC5    INCOC5                                              CSW209
      *                                                                                       CSW209
      ** Ordering Institution (Cover)                                                         CSW209
      *                                                                                       CSW209
     C                     MOVELFACOBT    INCOBT                                              CSW209
     C                     MOVELSACOB1    INCOB1                                              CSW209
     C                     MOVELSACOB2    INCOB2                                              CSW209
     C                     MOVELSACOB3    INCOB3                                              CSW209
     C                     MOVELSACOB4    INCOB4                                              CSW209
     C                     MOVELSACOB5    INCOB5                                              CSW209
      *                                                                                       CSW209
      ** Intermediary Institution (Cover)                                                     CSW209
      *                                                                                       CSW209
     C                     MOVELFACIBT    INCIBT                                              CSW209
     C                     MOVELSACIB1    INCIB1                                              CSW209
     C                     MOVELSACIB2    INCIB2                                              CSW209
     C                     MOVELSACIB3    INCIB3                                              CSW209
     C                     MOVELSACIB4    INCIB4                                              CSW209
     C                     MOVELSACIB5    INCIB5                                              CSW209
      *                                                                                       CSW209
      ** Account with Institution (Cover)                                                     CSW209
      *                                                                                       CSW209
     C                     MOVELFACABT    INCABT                                              CSW209
     C                     MOVELSACAB1    INCAB1                                              CSW209
     C                     MOVELSACAB2    INCAB2                                              CSW209
     C                     MOVELSACAB3    INCAB3                                              CSW209
     C                     MOVELSACAB4    INCAB4                                              CSW209
     C                     MOVELSACAB5    INCAB5                                              CSW209
      *                                                                                       CSW209
      ** Beneficiary Customer (Cover)                                                         CSW209
      *                                                                                       CSW209
     C                     MOVELFACBCT    INCBCT                                              CSW209
     C                     MOVELSACBC1    INCBC1                                              CSW209
     C                     MOVELSACBC2    INCBC2                                              CSW209
     C                     MOVELSACBC3    INCBC3                                              CSW209
     C                     MOVELSACBC4    INCBC4                                              CSW209
     C                     MOVELSACBC5    INCBC5                                              CSW209
      *                                                                                       CSW209
      ** Remittance Information (Cover)                                                       CSW209
      *                                                                                       CSW209
     C                     MOVELSBCDP1    INCDP1                                              CSW209
     C                     MOVELSBCDP2    INCDP2                                              CSW209
     C                     MOVELSBCDP3    INCDP3                                              CSW209
     C                     MOVELSBCDP4    INCDP4                                              CSW209
      *                                                                                       CSW209
      ** Sender to Receiver Information (Cover)                                               CSW209
      *                                                                                       CSW209
     C                     MOVELSBCBB1    INCBB1                                              CSW209
     C                     MOVELSBCBB2    INCBB2                                              CSW209
     C                     MOVELSBCBB3    INCBB3                                              CSW209
     C                     MOVELSBCBB4    INCBB4                                              CSW209
     C                     MOVELSBCBB5    INCBB5                                              CSW209
     C                     MOVELSBCBB6    INCBB6                                              CSW209
      *                                                                                       CSW209
      ** Instructed Currency/Amount (Cover)                                                   CSW209
      *                                                                                       CSW209
     C                     MOVELSBCICY    INCICY                                              CSW209
     C                     MOVELFBCIAM    INCIAM                                              CSW209
      *                                                                                       CSW209
     CSR                   ENDSR                                                              CSW209
      *                                                                                       CSW209
      /EJECT                                                                                  CSW209
      *****************************************************************                       CSW209
      *                                                               *                       CSW209
      *  SRCVOT   : Move cover messages data into Outgoing Payments   *                       CSW209
      *             Record                                            *                       CSW209
      *                                                               *                       CSW209
      *  CALLED BY: SRMVOT                                            *                       CSW209
      *                                                               *                       CSW209
      *****************************************************************                       CSW209
     CSR         SRCVOT    BEGSR                                                              CSW209
      *                                                                                       CSW209
      ** Incoming Network, Incoming Message Type, Incoming Validation Flag                    CSW209
      ** Outgoing Validation Flag (Main), Outgoing Validation Flag (Cover)                    CSW209
      *                                                                                       CSW209
     C                     MOVELSCNWRK    OPNWRK                                              CSW209
     C                     MOVELSCMTPY    OPMTPY                                              CSW209
     C                     MOVELSCVALF    OPVALF                                              CSW209
     C                     MOVELSCOMVF    OPOMVF                                              CSW209
     C                     MOVELSCOCVF    OPOCVF                                              CSW209
      *                                                                                       CSW209
      ** Ordering Customer (Cover)                                                            CSW209
      *                                                                                       CSW209
     C                     MOVELFCCOCT    OPCOCT                                              CSW209
     C                     MOVELSCCOC1    OPCOC1                                              CSW209
     C                     MOVELSCCOC2    OPCOC2                                              CSW209
     C                     MOVELSCCOC3    OPCOC3                                              CSW209
     C                     MOVELSCCOC4    OPCOC4                                              CSW209
     C                     MOVELSCCOC5    OPCOC5                                              CSW209
      *                                                                                       CSW209
      ** Ordering Institution (Cover)                                                         CSW209
      *                                                                                       CSW209
     C                     MOVELFCCOBT    OPCOBT                                              CSW209
     C                     MOVELSCCOB1    OPCOB1                                              CSW209
     C                     MOVELSCCOB2    OPCOB2                                              CSW209
     C                     MOVELSCCOB3    OPCOB3                                              CSW209
     C                     MOVELSCCOB4    OPCOB4                                              CSW209
     C                     MOVELSCCOB5    OPCOB5                                              CSW209
      *                                                                                       CSW209
      ** Intermediary Institution (Cover)                                                     CSW209
      *                                                                                       CSW209
     C                     MOVELFCCIBT    OPCIBT                                              CSW209
     C                     MOVELSCCIB1    OPCIB1                                              CSW209
     C                     MOVELSCCIB2    OPCIB2                                              CSW209
     C                     MOVELSCCIB3    OPCIB3                                              CSW209
     C                     MOVELSCCIB4    OPCIB4                                              CSW209
     C                     MOVELSCCIB5    OPCIB5                                              CSW209
      *                                                                                       CSW209
      ** Account with Institution (Cover)                                                     CSW209
      *                                                                                       CSW209
     C                     MOVELFCCABT    OPCABT                                              CSW209
     C                     MOVELSCCAB1    OPCAB1                                              CSW209
     C                     MOVELSCCAB2    OPCAB2                                              CSW209
     C                     MOVELSCCAB3    OPCAB3                                              CSW209
     C                     MOVELSCCAB4    OPCAB4                                              CSW209
     C                     MOVELSCCAB5    OPCAB5                                              CSW209
      *                                                                                       CSW209
      ** Beneficiary Customer (Cover)                                                         CSW209
      *                                                                                       CSW209
     C                     MOVELFCCBCT    OPCBCT                                              CSW209
     C                     MOVELSCCBC1    OPCBC1                                              CSW209
     C                     MOVELSCCBC2    OPCBC2                                              CSW209
     C                     MOVELSCCBC3    OPCBC3                                              CSW209
     C                     MOVELSCCBC4    OPCBC4                                              CSW209
     C                     MOVELSCCBC5    OPCBC5                                              CSW209
      *                                                                                       CSW209
      ** Remittance Information (Cover)                                                       CSW209
      *                                                                                       CSW209
     C                     MOVELSDCDP1    OPCDP1                                              CSW209
     C                     MOVELSDCDP2    OPCDP2                                              CSW209
     C                     MOVELSDCDP3    OPCDP3                                              CSW209
     C                     MOVELSDCDP4    OPCDP4                                              CSW209
      *                                                                                       CSW209
      ** Sender to Receiver Information (Cover B)                                             CSW209
      *                                                                                       CSW209
     C                     MOVELSDCBB1    OPCBB1                                              CSW209
     C                     MOVELSDCBB2    OPCBB2                                              CSW209
     C                     MOVELSDCBB3    OPCBB3                                              CSW209
     C                     MOVELSDCBB4    OPCBB4                                              CSW209
     C                     MOVELSDCBB5    OPCBB5                                              CSW209
     C                     MOVELSDCBB6    OPCBB6                                              CSW209
      *                                                                                       CSW209
      ** Instructed Currency/Amount (Cover)                                                   CSW209
      *                                                                                       CSW209
     C                     MOVELSDCICY    OPCICY                                              CSW209
     C                     MOVELFDCIAM    OPCIAM                                              CSW209
      *                                                                                       CSW209
      ** Sender to Receiver Information (Cover A)                                             CSW209
      *                                                                                       CSW209
     C                     MOVELSDOCB1    OPOCB1                                              CSW209
     C                     MOVELSDOCB2    OPOCB2                                              CSW209
     C                     MOVELSDOCB3    OPOCB3                                              CSW209
     C                     MOVELSDOCB4    OPOCB4                                              CSW209
     C                     MOVELSDOCB5    OPOCB5                                              CSW209
     C                     MOVELSDOCB6    OPOCB6                                              CSW209
      *                                                                                       CSW209
     CSR                   ENDSR                                                              CSW209
      *                                                                                       CSW209
     C/EJECT
      *****************************************************************                       CSD015
      * Subroutine  :  SRIPWT                                         *                       CSD015
      * Function    :  This subroutine will send details to the       *                       CSD015
      *                Compliance watch engine program.               *                       CSD015
      *                                                               *                       CSD015
      * Called by   :  Subroutine SRINUP                              *                       CSD015
      * Calls       :  SDCWLCHK                                       *                       CSD015
      *****************************************************************                       CSD015
      *                                                                                       CSD015
     C           SRIPWT    BEGSR                                                              CSD015
      *                                                                                       CSD015
      ** Sender                                                                               CSD015
      *                                                                                       CSD015
     C                     MOVE *BLANKS   OUTFMT                                              CSD015
     C                     MOVE *BLANKS   PSTRNG                                              CSD015
     C                     MOVE *BLANKS   PDS1                                                CSD015
      *                                                                                       CSD015
     C           SND1      IFNE *BLANKS                                                       CSD015
     C           SND2      ORNE *BLANKS                                                       CSD015
     C           SND3      ORNE *BLANKS                                                       CSD015
     C           SND4      ORNE *BLANKS                                                       CSD015
     C                     MOVE *BLANKS   FLD1   35                                           CSD015
     C                     MOVELSND1      FLD1                                                CSD015
     C                     MOVELSND2      WRTC2                                               CSD015
     C                     MOVELSND3      WRTC3                                               CSD015
     C                     MOVELSND4      WRTC4                                               CSD015
     C                     MOVEL*BLANKS   WRTC5                                               CSD015
     C                     MOVEL*BLANKS   WRTC6                                               CSD015
     C                     EXSR CONV                                                          CSD015
     C                     CAT  IPARR,1:0 PSTRNG                                              CSD015
     C           PSTRNG    CAT  OUTFMT:0  PSTRNG                                              CSD015
     C                     CAT  IPARR,2:0 PSTRNG                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Receivers Correspondent - FT Version                                                 CSD015
      *                                                                                       CSD015
     C***********RCCO      IFNE 0                                                      CSD015 CSD027
     C           RCCO      IFNE *BLANKS                                                       CSD027
     C                     MOVE *BLANKS   FLD1                                                CSD015
     C                     MOVELRCCO      FLD1                                                CSD015
     C                     MOVEL*BLANKS   WRTC2                                               CSD015
     C                     MOVEL*BLANKS   WRTC3                                               CSD015
     C                     MOVEL*BLANKS   WRTC4                                               CSD015
     C                     MOVEL*BLANKS   WRTC5                                               CSD015
     C                     MOVEL*BLANKS   WRTC6                                               CSD015
     C                     EXSR CONV                                                          CSD015
     C           PSTRNG    CAT  IPARR,3:0 PSTRNG                                              CSD015
     C           PSTRNG    CAT  OUTFMT:0  PSTRNG                                              CSD015
     C           PSTRNG    CAT  IPARR,4:0 PSTRNG                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Account with Bank - FT Version                                                       CSD015
      *                                                                                       CSD015
     C           ACBK      IFNE *BLANKS                                                       CSD015
     C                     MOVE *BLANKS   FLD1                                                CSD015
     C                     MOVELACBK      FLD1                                                CSD015
     C                     MOVEL*BLANKS   WRTC2                                               CSD015
     C                     MOVEL*BLANKS   WRTC3                                               CSD015
     C                     MOVEL*BLANKS   WRTC4                                               CSD015
     C                     MOVEL*BLANKS   WRTC5                                               CSD015
     C                     MOVEL*BLANKS   WRTC6                                               CSD015
     C                     EXSR CONV                                                          CSD015
     C           PSTRNG    CAT  IPARR,5:0 PSTRNG                                              CSD015
     C           PSTRNG    CAT  OUTFMT:0  PSTRNG                                              CSD015
     C           PSTRNG    CAT  IPARR,6:0 PSTRNG                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Beneficiary                                                                          CSD015
      *                                                                                       CSD015
     C           BNC1      IFNE *BLANKS                                                       CSD015
     C           BNC2      ORNE *BLANKS                                                       CSD015
     C           BNC3      ORNE *BLANKS                                                       CSD015
     C           BNC4      ORNE *BLANKS                                                       CSD015
     C           BNC5      ORNE *BLANKS                                                       CSD015
     C                     MOVE *BLANKS   FLD1                                                CSD015
     C                     MOVELBNC1      FLD1                                                CSD015
     C                     MOVELBNC2      WRTC2                                               CSD015
     C                     MOVELBNC3      WRTC3                                               CSD015
     C                     MOVELBNC4      WRTC4                                               CSD015
     C                     MOVELBNC5      WRTC5                                               CSD015
     C                     MOVEL*BLANKS   WRTC6                                               CSD015
     C                     EXSR CONV                                                          CSD015
     C           PSTRNG    CAT  IPARR,7:0 PSTRNG                                              CSD015
     C           PSTRNG    CAT  OUTFMT:0  PSTRNG                                              CSD015
     C           PSTRNG    CAT  IPARR,8:0 PSTRNG                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Ordering Bank                                                                        CSD015
      *                                                                                       CSD015
     C           ORB1      IFNE *BLANKS                                                       CSD015
     C           ORB2      ORNE *BLANKS                                                       CSD015
     C           ORB3      ORNE *BLANKS                                                       CSD015
     C           ORB4      ORNE *BLANKS                                                       CSD015
     C           ORB5      ORNE *BLANKS                                                       CSD015
     C                     MOVE *BLANKS   FLD1                                                CSD015
     C                     MOVELORB1      FLD1                                                CSD015
     C                     MOVELORB2      WRTC2                                               CSD015
     C                     MOVELORB3      WRTC3                                               CSD015
     C                     MOVELORB4      WRTC4                                               CSD015
     C                     MOVELORB5      WRTC5                                               CSD015
     C                     MOVEL*BLANKS   WRTC6                                               CSD015
     C                     EXSR CONV                                                          CSD015
     C           PSTRNG    CAT  IPARR,9:0 PSTRNG                                              CSD015
     C           PSTRNG    CAT  OUTFMT:0  PSTRNG                                              CSD015
     C           PSTRNG    CAT  IPARR,10:0PSTRNG                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Senders Correspondent                                                                CSD015
      *                                                                                       CSD015
     C           SNC1      IFNE *BLANKS                                                       CSD015
     C           SNC2      ORNE *BLANKS                                                       CSD015
     C           SNC3      ORNE *BLANKS                                                       CSD015
     C           SNC4      ORNE *BLANKS                                                       CSD015
     C           SNC5      ORNE *BLANKS                                                       CSD015
     C                     MOVE *BLANKS   FLD1                                                CSD015
     C                     MOVELSNC1      FLD1                                                CSD015
     C                     MOVELSNC2      WRTC2                                               CSD015
     C                     MOVELSNC3      WRTC3                                               CSD015
     C                     MOVELSNC4      WRTC4                                               CSD015
     C                     MOVELSNC5      WRTC5                                               CSD015
     C                     MOVEL*BLANKS   WRTC6                                               CSD015
     C                     EXSR CONV                                                          CSD015
     C           PSTRNG    CAT  IPARR,11:0PSTRNG                                              CSD015
     C           PSTRNG    CAT  OUTFMT:0  PSTRNG                                              CSD015
     C           PSTRNG    CAT  IPARR,12:0PSTRNG                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Ordering Customer                                                                    CSD015
      *                                                                                       CSD015
     C           ORC1      IFNE *BLANKS                                                       CSD015
     C           ORC2      ORNE *BLANKS                                                       CSD015
     C           ORC3      ORNE *BLANKS                                                       CSD015
     C           ORC4      ORNE *BLANKS                                                       CSD015
     C                     MOVE *BLANKS   FLD1                                                CSD015
     C                     MOVELORC1      FLD1                                                CSD015
     C                     MOVELORC2      WRTC2                                               CSD015
     C                     MOVELORC3      WRTC3                                               CSD015
     C                     MOVELORC4      WRTC4                                               CSD015
     C                     MOVEL*BLANKS   WRTC5                                               CSD015
     C                     MOVEL*BLANKS   WRTC6                                               CSD015
     C                     EXSR CONV                                                          CSD015
     C           PSTRNG    CAT  IPARR,13:0PSTRNG                                              CSD015
     C           PSTRNG    CAT  OUTFMT:0  PSTRNG                                              CSD015
     C           PSTRNG    CAT  IPARR,14:0PSTRNG                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Details of Payment                                                                   CSD015
      *                                                                                       CSD015
     C           DTP1      IFNE *BLANKS                                                       CSD015
     C           DTP2      ORNE *BLANKS                                                       CSD015
     C           DTP3      ORNE *BLANKS                                                       CSD015
     C           DTP4      ORNE *BLANKS                                                       CSD015
     C                     MOVE *BLANKS   FLD1                                                CSD015
     C                     MOVELDTP1      FLD1                                                CSD015
     C                     MOVELDTP2      WRTC2                                               CSD015
     C                     MOVELDTP3      WRTC3                                               CSD015
     C                     MOVELDTP4      WRTC4                                               CSD015
     C                     MOVEL*BLANKS   WRTC5                                               CSD015
     C                     MOVEL*BLANKS   WRTC6                                               CSD015
     C                     EXSR CONV                                                          CSD015
     C           PSTRNG    CAT  IPARR,15:0PSTRNG                                              CSD015
     C           PSTRNG    CAT  OUTFMT:0  PSTRNG                                              CSD015
     C           PSTRNG    CAT  IPARR,16:0PSTRNG                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Intermediary Bank                                                                    CSD015
      *                                                                                       CSD015
     C           INB1      IFNE *BLANKS                                                       CSD015
     C           INB2      ORNE *BLANKS                                                       CSD015
     C           INB3      ORNE *BLANKS                                                       CSD015
     C           INB4      ORNE *BLANKS                                                       CSD015
     C           INB5      ORNE *BLANKS                                                       CSD015
     C                     MOVE *BLANKS   FLD1                                                CSD015
     C                     MOVELINB1      FLD1                                                CSD015
     C                     MOVELINB2      WRTC2                                               CSD015
     C                     MOVELINB3      WRTC3                                               CSD015
     C                     MOVELINB4      WRTC4                                               CSD015
     C                     MOVELINB5      WRTC5                                               CSD015
     C                     MOVEL*BLANKS   WRTC6                                               CSD015
     C                     EXSR CONV                                                          CSD015
     C           PSTRNG    CAT  IPARR,17:0PSTRNG                                              CSD015
     C           PSTRNG    CAT  OUTFMT:0  PSTRNG                                              CSD015
     C           PSTRNG    CAT  IPARR,18:0PSTRNG                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Receivers Correspondent                                                              CSD015
      *                                                                                       CSD015
     C           INRCO1    IFNE *BLANKS                                                       CSD015
     C           INRCO2    ORNE *BLANKS                                                       CSD015
     C           INRCO3    ORNE *BLANKS                                                       CSD015
     C           INRCO4    ORNE *BLANKS                                                       CSD015
     C           INRCO5    ORNE *BLANKS                                                       CSD015
     C                     MOVE *BLANKS   FLD1                                                CSD015
     C                     MOVELINRCO1    FLD1                                                CSD015
     C                     MOVELINRCO2    WRTC2                                               CSD015
     C                     MOVELINRCO3    WRTC3                                               CSD015
     C                     MOVELINRCO4    WRTC4                                               CSD015
     C                     MOVELINRCO5    WRTC5                                               CSD015
     C                     MOVEL*BLANKS   WRTC6                                               CSD015
     C                     EXSR CONV                                                          CSD015
     C           PSTRNG    CAT  IPARR,19:0PSTRNG                                              CSD015
     C           PSTRNG    CAT  OUTFMT:0  PSTRNG                                              CSD015
     C           PSTRNG    CAT  IPARR,20:0PSTRNG                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Account with Bank                                                                    CSD015
      *                                                                                       CSD015
     C           INACB1    IFNE *BLANKS                                                       CSD015
     C           INACB2    ORNE *BLANKS                                                       CSD015
     C           INACB3    ORNE *BLANKS                                                       CSD015
     C           INACB4    ORNE *BLANKS                                                       CSD015
     C           INACB5    ORNE *BLANKS                                                       CSD015
     C                     MOVE *BLANKS   FLD1                                                CSD015
     C                     MOVELINACB1    FLD1                                                CSD015
     C                     MOVELINACB2    WRTC2                                               CSD015
     C                     MOVELINACB3    WRTC3                                               CSD015
     C                     MOVELINACB4    WRTC4                                               CSD015
     C                     MOVELINACB5    WRTC5                                               CSD015
     C                     MOVEL*BLANKS   WRTC6                                               CSD015
     C                     EXSR CONV                                                          CSD015
     C           PSTRNG    CAT  IPARR,21:0PSTRNG                                              CSD015
     C           PSTRNG    CAT  OUTFMT:0  PSTRNG                                              CSD015
     C           PSTRNG    CAT  IPARR,22:0PSTRNG                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Third Reimbursement Institution                                                      CSD015
      *                                                                                       CSD015
     C           INTRIB    IFNE *BLANKS                                                       CSD015
     C           INTRI1    ORNE *BLANKS                                                       CSD015
     C           INTRI2    ORNE *BLANKS                                                       CSD015
     C           INTRI3    ORNE *BLANKS                                                       CSD015
     C           INTRI4    ORNE *BLANKS                                                       CSD015
     C           INTRI5    ORNE *BLANKS                                                       CSD015
     C                     MOVE *BLANKS   FLD1                                                CSD015
     C                     MOVELINTRIB    FLD1                                                CSD015
     C                     MOVELINTRI1    WRTC2                                               CSD015
     C                     MOVELINTRI2    WRTC3                                               CSD015
     C                     MOVELINTRI3    WRTC4                                               CSD015
     C                     MOVELINTRI4    WRTC5                                               CSD015
     C                     MOVELINTRI5    WRTC6                                               CSD015
     C                     EXSR CONV                                                          CSD015
     C           PSTRNG    CAT  IPARR,23:0PSTRNG                                              CSD015
     C           PSTRNG    CAT  OUTFMT:0  PSTRNG                                              CSD015
     C           PSTRNG    CAT  IPARR,24:0PSTRNG                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSW209
     C           CSW209    IFEQ 'Y'                                                           CSW209
      *                                                                                       CSW209
      ** Ordering Customer Cover                                                              CSW209
      *                                                                                       CSW209
     C           INCOC1    IFNE *BLANKS                                                       CSW209
     C           INCOC2    ORNE *BLANKS                                                       CSW209
     C           INCOC3    ORNE *BLANKS                                                       CSW209
     C           INCOC4    ORNE *BLANKS                                                       CSW209
     C           INCOC5    ORNE *BLANKS                                                       CSW209
     C                     MOVE *BLANKS   FLD1                                                CSW209
     C                     MOVELINCOC1    FLD1                                                CSW209
     C                     MOVELINCOC2    WRTC2                                               CSW209
     C                     MOVELINCOC3    WRTC3                                               CSW209
     C                     MOVELINCOC4    WRTC4                                               CSW209
     C                     MOVELINCOC5    WRTC5                                               CSW209
     C                     MOVEL*BLANKS   WRTC6                                               CSW209
     C                     EXSR CONV                                                          CSW209
     C           PSTRNG    CAT  IPARR,25:0PSTRNG                                              CSW209
     C           PSTRNG    CAT  OUTFMT:0  PSTRNG                                              CSW209
     C           PSTRNG    CAT  IPARR,26:0PSTRNG                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
      ** Ordering Bank Cover                                                                  CSW209
      *                                                                                       CSW209
     C           INCOB1    IFNE *BLANKS                                                       CSW209
     C           INCOB2    ORNE *BLANKS                                                       CSW209
     C           INCOB3    ORNE *BLANKS                                                       CSW209
     C           INCOB4    ORNE *BLANKS                                                       CSW209
     C           INCOB5    ORNE *BLANKS                                                       CSW209
     C                     MOVE *BLANKS   FLD1                                                CSW209
     C                     MOVELINCOB1    FLD1                                                CSW209
     C                     MOVELINCOB2    WRTC2                                               CSW209
     C                     MOVELINCOB3    WRTC3                                               CSW209
     C                     MOVELINCOB4    WRTC4                                               CSW209
     C                     MOVELINCOB5    WRTC5                                               CSW209
     C                     MOVEL*BLANKS   WRTC6                                               CSW209
     C                     EXSR CONV                                                          CSW209
     C           PSTRNG    CAT  IPARR,27:0PSTRNG                                              CSW209
     C           PSTRNG    CAT  OUTFMT:0  PSTRNG                                              CSW209
     C           PSTRNG    CAT  IPARR,28:0PSTRNG                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
      ** Intermediary Bank Cover                                                              CSW209
      *                                                                                       CSW209
     C           INCIB1    IFNE *BLANKS                                                       CSW209
     C           INCIB2    ORNE *BLANKS                                                       CSW209
     C           INCIB3    ORNE *BLANKS                                                       CSW209
     C           INCIB4    ORNE *BLANKS                                                       CSW209
     C           INCIB5    ORNE *BLANKS                                                       CSW209
     C                     MOVE *BLANKS   FLD1                                                CSW209
     C                     MOVELINCIB1    FLD1                                                CSW209
     C                     MOVELINCIB2    WRTC2                                               CSW209
     C                     MOVELINCIB3    WRTC3                                               CSW209
     C                     MOVELINCIB4    WRTC4                                               CSW209
     C                     MOVELINCIB5    WRTC5                                               CSW209
     C                     MOVEL*BLANKS   WRTC6                                               CSW209
     C                     EXSR CONV                                                          CSW209
     C           PSTRNG    CAT  IPARR,29:0PSTRNG                                              CSW209
     C           PSTRNG    CAT  OUTFMT:0  PSTRNG                                              CSW209
     C           PSTRNG    CAT  IPARR,30:0PSTRNG                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
      ** Account with Bank Cover                                                              CSW209
      *                                                                                       CSW209
     C           INCAB1    IFNE *BLANKS                                                       CSW209
     C           INCAB2    ORNE *BLANKS                                                       CSW209
     C           INCAB3    ORNE *BLANKS                                                       CSW209
     C           INCAB4    ORNE *BLANKS                                                       CSW209
     C           INCAB5    ORNE *BLANKS                                                       CSW209
     C                     MOVE *BLANKS   FLD1                                                CSW209
     C                     MOVELINCAB1    FLD1                                                CSW209
     C                     MOVELINCAB2    WRTC2                                               CSW209
     C                     MOVELINCAB3    WRTC3                                               CSW209
     C                     MOVELINCAB4    WRTC4                                               CSW209
     C                     MOVELINCAB5    WRTC5                                               CSW209
     C                     MOVEL*BLANKS   WRTC6                                               CSW209
     C                     EXSR CONV                                                          CSW209
     C           PSTRNG    CAT  IPARR,31:0PSTRNG                                              CSW209
     C           PSTRNG    CAT  OUTFMT:0  PSTRNG                                              CSW209
     C           PSTRNG    CAT  IPARR,32:0PSTRNG                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
      ** Beneficiary Cover                                                                    CSW209
      *                                                                                       CSW209
     C           INCBC1    IFNE *BLANKS                                                       CSW209
     C           INCBC2    ORNE *BLANKS                                                       CSW209
     C           INCBC3    ORNE *BLANKS                                                       CSW209
     C           INCBC4    ORNE *BLANKS                                                       CSW209
     C           INCBC5    ORNE *BLANKS                                                       CSW209
     C                     MOVE *BLANKS   FLD1                                                CSW209
     C                     MOVELINCBC1    FLD1                                                CSW209
     C                     MOVELINCBC2    WRTC2                                               CSW209
     C                     MOVELINCBC3    WRTC3                                               CSW209
     C                     MOVELINCBC4    WRTC4                                               CSW209
     C                     MOVELINCBC5    WRTC5                                               CSW209
     C                     MOVEL*BLANKS   WRTC6                                               CSW209
     C                     EXSR CONV                                                          CSW209
     C           PSTRNG    CAT  IPARR,33:0PSTRNG                                              CSW209
     C           PSTRNG    CAT  OUTFMT:0  PSTRNG                                              CSW209
     C           PSTRNG    CAT  IPARR,34:0PSTRNG                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
      ** Details of Payment Cover                                                             CSW209
      *                                                                                       CSW209
     C           INCDP1    IFNE *BLANKS                                                       CSW209
     C           INCDP2    ORNE *BLANKS                                                       CSW209
     C           INCDP3    ORNE *BLANKS                                                       CSW209
     C           INCDP4    ORNE *BLANKS                                                       CSW209
     C                     MOVE *BLANKS   FLD1                                                CSW209
     C                     MOVELINCDP1    FLD1                                                CSW209
     C                     MOVELINCDP2    WRTC2                                               CSW209
     C                     MOVELINCDP3    WRTC3                                               CSW209
     C                     MOVELINCDP4    WRTC4                                               CSW209
     C                     MOVEL*BLANKS   WRTC5                                               CSW209
     C                     MOVEL*BLANKS   WRTC6                                               CSW209
     C                     EXSR CONV                                                          CSW209
     C           PSTRNG    CAT  IPARR,35:0PSTRNG                                              CSW209
     C           PSTRNG    CAT  OUTFMT:0  PSTRNG                                              CSW209
     C           PSTRNG    CAT  IPARR,36:0PSTRNG                                              CSW209
     C                     ENDIF                                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSD015
     C           PSTRNG    IFNE *BLANKS                                                       CSD015
      *                                                                                       CSD015
      **  First parameter                                                                     CSD015
      *                                                                                       CSD015
     C                     MOVE 'FTIPAY'  W4ITEM                                              CSD015
     C**********           MOVE PREF      W4IDEN                                        CSD015221934
     C                     MOVELPREF      W4IDEN                                              221934
     C                     MOVE BRCA      W4BRCH                                              CSD015
     C                     MOVE LIBR      W4SYSM                                              CSD015
     C**********           MOVE 'INPAYDD' W4FUNT                                        CSD015221934
     C                     MOVEL'INPAYDD' W4FUNT                                              221934
     C                     Z-ADD0         W4DDAT                                              CSD015
     C                     Z-ADDSLDT      W4VDAT                                              CSD015
     C                     Z-ADDPVDT      W4MDAT                                              CSD015
     C                     MOVELSMCY      W4DEN1                                              CSD015
     C                     MOVELPCCY      W4DEN2                                              CSD015
     C                     Z-ADDSMAM      W4AMT1                                              CSD015
     C                     Z-ADDPYAM      W4AMT2                                              CSD015
      *                                                                                       CSD015
      ** Counterparty Details                                                                 CSD015
      *                                                                                       CSD015
     C                     MOVEL*BLANKS   W4CNUM                                              CSD015
     C                     MOVEL*BLANKS   W4CTYP                                              CSD015
     C                     MOVE *BLANKS   W4CUST                                              CSD015
     C                     MOVELRCCO      WRCCO   6                                           CSD015
      *                                                                                       CSD015
     C           SND1      IFNE *BLANKS                                                       CSD015
     C           SND2      ORNE *BLANKS                                                       CSD015
     C           SND3      ORNE *BLANKS                                                       CSD015
     C           SND4      ORNE *BLANKS                                                       CSD015
     C                     MOVELSND1      FLD1                                                CSD015
     C                     MOVELSND2      WRTC2                                               CSD015
     C                     MOVELSND3      WRTC3                                               CSD015
     C                     MOVELSND4      WRTC4                                               CSD015
     C                     MOVEL*BLANKS   WRTC5                                               CSD015
     C                     MOVEL*BLANKS   WRTC6                                               CSD015
     C                     EXSR CONV                                                          CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           OUTCUS    IFEQ '*FREE'                                                       CSD015
     C           OUTCUS    OREQ '*CPART'                                                      CSD015
     C           SND1      OREQ *BLANKS                                                       CSD015
     C           SND2      ANDEQ*BLANKS                                                       CSD015
     C           SND3      ANDEQ*BLANKS                                                       CSD015
     C           SND4      ANDEQ*BLANKS                                                       CSD015
     C                     MOVELWRCCO     FLD1                                                CSD015
     C                     MOVEL*BLANKS   WRTC2                                               CSD015
     C                     MOVEL*BLANKS   WRTC3                                               CSD015
     C                     MOVEL*BLANKS   WRTC4                                               CSD015
     C                     MOVEL*BLANKS   WRTC5                                               CSD015
     C                     MOVEL*BLANKS   WRTC6                                               CSD015
     C                     EXSR CONV                                                          CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           OUTCUS    IFEQ '*FREE'                                                       CSD015
     C           OUTCUS    OREQ '*CPART'                                                      CSD015
     C           SND1      OREQ *BLANKS                                                       CSD015
     C           SND2      ANDEQ*BLANKS                                                       CSD015
     C           SND3      ANDEQ*BLANKS                                                       CSD015
     C           SND4      ANDEQ*BLANKS                                                       CSD015
     C           WRCCO     ANDEQ*BLANKS                                                       CSD015
     C           INTRIB    ANDNE*BLANKS                                                       CSD015
     C                     MOVELINTRIB    FLD1                                                CSD015
     C                     MOVEL*BLANKS   WRTC2                                               CSD015
     C                     MOVEL*BLANKS   WRTC3                                               CSD015
     C                     MOVEL*BLANKS   WRTC4                                               CSD015
     C                     MOVEL*BLANKS   WRTC5                                               CSD015
     C                     MOVEL*BLANKS   WRTC6                                               CSD015
     C                     EXSR CONV                                                          CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           OUTCUS    IFNE '*FREE'                                                       CSD015
     C           OUTCUS    ANDNE'*CPART'                                                      CSD015
      *                                                                                       CSD015
     C                     MOVELOUTCUS    W4CNUM                                              CSD015
      *                                                                                       CSD015
     C                     CALL 'AOCUSTR0'                                                    CSD015
     C                     PARM *BLANKS   @RTCD                                               CSD015
     C                     PARM '*KEY   ' @OPTN                                               CSD015
     C                     PARM OUTCUS    @KEY1  10                                           CSD015
     C                     PARM *BLANKS   @KYST   7                                           CSD015
     C           SDCUST    PARM SDCUST    DSSDY                                               CSD015
      *                                                                                       CSD015
     C           @RTCD     IFNE *BLANKS                                                       CSD015
     C           @RTCD     ANDNE'*NRF   '                                                     CSD015
     C                     MOVE 47        DBASE                                               CSD015
     C                     MOVELOUTCUS    DBKEY                                               CSD015
     C                     MOVEL'SDCUSTPD'DBFILE                                              CSD015
     C                     EXSR *PSSR                                                         CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           @RTCD     IFEQ *BLANKS                                                       CSD015
      *                                                                                       CSD015
     C           BBCRNM    CAT  BBCRTN    W4CUST                                              CSD015
      *                                                                                       CSD015
     C           CCF001    IFEQ 'Y'                                                           CSD015
      *                                                                                       CSD015
     C           BBCRPC    IFEQ 'Y'                                                           CSD015
     C                     MOVE 'C'       W4CTYP                                              CSD015
     C                     ELSE                                                               CSD015
     C                     MOVE 'I'       W4CTYP                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     ELSE                                                               CSD015
      *                                                                                       CSD015
     C           BBLICD    IFNE *BLANK                                                        CSD015
     C           BBLICD    ANDNEW1IND1                                                        CSD015
     C           BBLICD    ANDNEW1IND2                                                        CSD015
     C           BBLICD    ANDNEW1IND3                                                        CSD015
     C           BBLICD    ANDNEW1IND4                                                        CSD015
     C           BBLICD    ANDNEW1IND5                                                        CSD015
     C                     MOVEL'C'       W4CTYP                                              CSD015
     C                     ELSE                                                               CSD015
     C                     MOVEL'I'       W4CTYP                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     ENDIF                                                              CSD015
     C                     ENDIF                                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     CALL 'SDWLCLOP'                                                    CSD015
     C                     PARM           PDS1                                                CSD015
     C                     PARM           PSTRNG                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     ENDSR                                                              CSD015
      *****************************************************************                       CSD015
      /EJECT                                                                                  CSD015
      *****************************************************************                       CSD015
      * Subroutine  :  SROPWT                                         *                       CSD015
      * Function    :  This subroutine will send details to the       *                       CSD015
      *                Compliance watch engine program.               *                       CSD015
      *                                                               *                       CSD015
      * Called by   :  Subroutine SRINOP                              *                       CSD015
      * Calls       :  SDCWLCHK                                       *                       CSD015
      *****************************************************************                       CSD015
      *                                                                                       CSD015
     C           SROPWT    BEGSR                                                              CSD015
      *                                                                                       CSD015
      ** Destination                                                                          CSD015
      *                                                                                       CSD015
     C                     MOVE *BLANKS   OUTFMT                                              CSD015
     C                     MOVE *BLANKS   PSTRNG                                              CSD015
     C                     MOVE *BLANKS   PDS1                                                CSD015
      *                                                                                       CSD015
     C           DST1      IFNE *BLANKS                                                       CSD015
     C           DST2      ORNE *BLANKS                                                       CSD015
     C           DST3      ORNE *BLANKS                                                       CSD015
     C           DST4      ORNE *BLANKS                                                       CSD015
     C                     MOVE *BLANKS   FLD1   35                                           CSD015
     C                     MOVELDST1      FLD1                                                CSD015
     C                     MOVELDST2      WRTC2                                               CSD015
     C                     MOVELDST3      WRTC3                                               CSD015
     C                     MOVELDST4      WRTC4                                               CSD015
     C                     MOVEL*BLANKS   WRTC5                                               CSD015
     C                     MOVEL*BLANKS   WRTC6                                               CSD015
     C                     EXSR CONV                                                          CSD015
     C           PSTRNG    CAT  OPARR,1:0 PSTRNG                                              CSD015
     C           PSTRNG    CAT  OUTFMT:0  PSTRNG                                              CSD015
     C           PSTRNG    CAT  OPARR,2:0 PSTRNG                                              CSD015
     C                     MOVE OUTCUS    DSTCUS  6                                           CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Ordering Bank                                                                        CSD015
      *                                                                                       CSD015
     C***********ORBK      IFNE 0                                                      CSD015 CSD027
     C           ORBK      IFNE *BLANKS                                                       CSD027
     C                     MOVE *BLANKS   FLD1                                                CSD015
     C                     MOVELORBK      FLD1                                                CSD015
     C                     MOVEL*BLANKS   WRTC2                                               CSD015
     C                     MOVEL*BLANKS   WRTC3                                               CSD015
     C                     MOVEL*BLANKS   WRTC4                                               CSD015
     C                     MOVEL*BLANKS   WRTC5                                               CSD015
     C                     MOVEL*BLANKS   WRTC6                                               CSD015
     C                     EXSR CONV                                                          CSD015
     C           PSTRNG    CAT  OPARR,3:0 PSTRNG                                              CSD015
     C           PSTRNG    CAT  OUTFMT:0  PSTRNG                                              CSD015
     C           PSTRNG    CAT  OPARR,4:0 PSTRNG                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Ordering Customer                                                                    CSD015
      *                                                                                       CSD015
     C           ORC1      IFNE *BLANKS                                                       CSD015
     C           ORC2      ORNE *BLANKS                                                       CSD015
     C           ORC3      ORNE *BLANKS                                                       CSD015
     C           ORC4      ORNE *BLANKS                                                       CSD015
     C                     MOVE *BLANKS   FLD1                                                CSD015
     C                     MOVELORC1      FLD1                                                CSD015
     C                     MOVELORC2      WRTC2                                               CSD015
     C                     MOVELORC3      WRTC3                                               CSD015
     C                     MOVELORC4      WRTC4                                               CSD015
     C                     MOVEL*BLANKS   WRTC5                                               CSD015
     C                     MOVEL*BLANKS   WRTC6                                               CSD015
     C                     EXSR CONV                                                          CSD015
     C           PSTRNG    CAT  OPARR,5:0 PSTRNG                                              CSD015
     C           PSTRNG    CAT  OUTFMT:0  PSTRNG                                              CSD015
     C           PSTRNG    CAT  OPARR,6:0 PSTRNG                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Receiver Correspondent                                                               CSD015
      *                                                                                       CSD015
     C           RCO1      IFNE *BLANKS                                                       CSD015
     C           RCO2      ORNE *BLANKS                                                       CSD015
     C           RCO3      ORNE *BLANKS                                                       CSD015
     C           RCO4      ORNE *BLANKS                                                       CSD015
     C           RCO5      ORNE *BLANKS                                                       CSD015
     C                     MOVE *BLANKS   FLD1                                                CSD015
     C                     MOVELRCO1      FLD1                                                CSD015
     C                     MOVELRCO2      WRTC2                                               CSD015
     C                     MOVELRCO3      WRTC3                                               CSD015
     C                     MOVELRCO4      WRTC4                                               CSD015
     C                     MOVELRCO5      WRTC5                                               CSD015
     C                     MOVEL*BLANKS   WRTC6                                               CSD015
     C                     EXSR CONV                                                          CSD015
     C           PSTRNG    CAT  OPARR,7:0 PSTRNG                                              CSD015
     C           PSTRNG    CAT  OUTFMT:0  PSTRNG                                              CSD015
     C           PSTRNG    CAT  OPARR,8:0 PSTRNG                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Account with Bank                                                                    CSD015
      *                                                                                       CSD015
     C           ACB1      IFNE *BLANKS                                                       CSD015
     C           ACB2      ORNE *BLANKS                                                       CSD015
     C           ACB3      ORNE *BLANKS                                                       CSD015
     C           ACB4      ORNE *BLANKS                                                       CSD015
     C           ACB5      ORNE *BLANKS                                                       CSD015
     C                     MOVE *BLANKS   FLD1                                                CSD015
     C                     MOVELACB1      FLD1                                                CSD015
     C                     MOVELACB2      WRTC2                                               CSD015
     C                     MOVELACB3      WRTC3                                               CSD015
     C                     MOVELACB4      WRTC4                                               CSD015
     C                     MOVELACB5      WRTC5                                               CSD015
     C                     MOVEL*BLANKS   WRTC6                                               CSD015
     C                     EXSR CONV                                                          CSD015
     C           PSTRNG    CAT  OPARR,9:0 PSTRNG                                              CSD015
     C           PSTRNG    CAT  OUTFMT:0  PSTRNG                                              CSD015
     C           PSTRNG    CAT  OPARR,10:0PSTRNG                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Beneficiary                                                                          CSD015
      *                                                                                       CSD015
     C           BNC1      IFNE *BLANKS                                                       CSD015
     C           BNC2      ORNE *BLANKS                                                       CSD015
     C           BNC3      ORNE *BLANKS                                                       CSD015
     C           BNC4      ORNE *BLANKS                                                       CSD015
     C           BNC5      ORNE *BLANKS                                                       CSD015
     C                     MOVE *BLANKS   FLD1                                                CSD015
     C                     MOVELBNC1      FLD1                                                CSD015
     C                     MOVELBNC2      WRTC2                                               CSD015
     C                     MOVELBNC3      WRTC3                                               CSD015
     C                     MOVELBNC4      WRTC4                                               CSD015
     C                     MOVELBNC5      WRTC5                                               CSD015
     C                     MOVEL*BLANKS   WRTC6                                               CSD015
     C                     EXSR CONV                                                          CSD015
     C           PSTRNG    CAT  OPARR,11:0PSTRNG                                              CSD015
     C           PSTRNG    CAT  OUTFMT:0  PSTRNG                                              CSD015
     C           PSTRNG    CAT  OPARR,12:0PSTRNG                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Details of Payment                                                                   CSD015
      *                                                                                       CSD015
     C           DTP1      IFNE *BLANKS                                                       CSD015
     C           DTP2      ORNE *BLANKS                                                       CSD015
     C           DTP3      ORNE *BLANKS                                                       CSD015
     C           DTP4      ORNE *BLANKS                                                       CSD015
     C                     MOVE *BLANKS   FLD1                                                CSD015
     C                     MOVELDTP1      FLD1                                                CSD015
     C                     MOVELDTP2      WRTC2                                               CSD015
     C                     MOVELDTP3      WRTC3                                               CSD015
     C                     MOVELDTP4      WRTC4                                               CSD015
     C                     MOVEL*BLANKS   WRTC5                                               CSD015
     C                     MOVEL*BLANKS   WRTC6                                               CSD015
     C                     EXSR CONV                                                          CSD015
     C           PSTRNG    CAT  OPARR,13:0PSTRNG                                              CSD015
     C           PSTRNG    CAT  OUTFMT:0  PSTRNG                                              CSD015
     C           PSTRNG    CAT  OPARR,14:0PSTRNG                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Intermediary Bank                                                                    CSD015
      *                                                                                       CSD015
     C           INB1      IFNE *BLANKS                                                       CSD015
     C           INB2      ORNE *BLANKS                                                       CSD015
     C           INB3      ORNE *BLANKS                                                       CSD015
     C           INB4      ORNE *BLANKS                                                       CSD015
     C           INB5      ORNE *BLANKS                                                       CSD015
     C                     MOVE *BLANKS   FLD1                                                CSD015
     C                     MOVELINB1      FLD1                                                CSD015
     C                     MOVELINB2      WRTC2                                               CSD015
     C                     MOVELINB3      WRTC3                                               CSD015
     C                     MOVELINB4      WRTC4                                               CSD015
     C                     MOVELINB5      WRTC5                                               CSD015
     C                     MOVEL*BLANKS   WRTC6                                               CSD015
     C                     EXSR CONV                                                          CSD015
     C           PSTRNG    CAT  OPARR,15:0PSTRNG                                              CSD015
     C           PSTRNG    CAT  OUTFMT:0  PSTRNG                                              CSD015
     C           PSTRNG    CAT  OPARR,16:0PSTRNG                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** MT100 Ordering Customer                                                              CSD015
      *                                                                                       CSD015
     C           ODMT      IFNE *BLANKS                                                       CSD015
     C                     MOVE *BLANKS   FLD1                                                CSD015
     C                     MOVELODMT      FLD1                                                CSD015
     C                     EXSR CONV                                                          CSD015
     C           PSTRNG    CAT  OPARR,17:0PSTRNG                                              CSD015
     C           PSTRNG    CAT  OUTFMT:0  PSTRNG                                              CSD015
     C           PSTRNG    CAT  OPARR,18:0PSTRNG                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Third Reimbursement Institution                                                      CSD015
      *                                                                                       CSD015
     C           OPTRI1    IFNE *BLANKS                                                       CSD015
     C           OPTRI2    ORNE *BLANKS                                                       CSD015
     C           OPTRI3    ORNE *BLANKS                                                       CSD015
     C           OPTRI4    ORNE *BLANKS                                                       CSD015
     C           OPTRI5    ORNE *BLANKS                                                       CSD015
     C                     MOVE *BLANKS   FLD1                                                CSD015
     C                     MOVELOPTRI1    FLD1                                                CSD015
     C                     MOVELOPTRI2    WRTC2                                               CSD015
     C                     MOVELOPTRI3    WRTC3                                               CSD015
     C                     MOVELOPTRI4    WRTC4                                               CSD015
     C                     MOVELOPTRI5    WRTC5                                               CSD015
     C                     MOVEL*BLANKS   WRTC6                                               CSD015
     C                     EXSR CONV                                                          CSD015
     C           PSTRNG    CAT  OPARR,19:0PSTRNG                                              CSD015
     C           PSTRNG    CAT  OUTFMT:0  PSTRNG                                              CSD015
     C           PSTRNG    CAT  OPARR,20:0PSTRNG                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSW209
     C           CSW209    IFEQ 'Y'                                                           CSW209
      *                                                                                       CSW209
      ** Ordering Customer Cover                                                              CSW209
      *                                                                                       CSW209
     C           OPCOC1    IFNE *BLANKS                                                       CSW209
     C           OPCOC2    ORNE *BLANKS                                                       CSW209
     C           OPCOC3    ORNE *BLANKS                                                       CSW209
     C           OPCOC4    ORNE *BLANKS                                                       CSW209
     C           OPCOC5    ORNE *BLANKS                                                       CSW209
     C                     MOVE *BLANKS   FLD1                                                CSW209
     C                     MOVELOPCOC1    FLD1                                                CSW209
     C                     MOVELOPCOC2    WRTC2                                               CSW209
     C                     MOVELOPCOC3    WRTC3                                               CSW209
     C                     MOVELOPCOC4    WRTC4                                               CSW209
     C                     MOVELOPCOC5    WRTC5                                               CSW209
     C                     MOVEL*BLANKS   WRTC6                                               CSW209
     C                     EXSR CONV                                                          CSW209
     C           PSTRNG    CAT  OPARR,21:0PSTRNG                                              CSW209
     C           PSTRNG    CAT  OUTFMT:0  PSTRNG                                              CSW209
     C           PSTRNG    CAT  OPARR,22:0PSTRNG                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
      ** Ordering Bank Cover                                                                  CSW209
      *                                                                                       CSW209
     C           OPCOB1    IFNE *BLANKS                                                       CSW209
     C           OPCOB2    ORNE *BLANKS                                                       CSW209
     C           OPCOB3    ORNE *BLANKS                                                       CSW209
     C           OPCOB4    ORNE *BLANKS                                                       CSW209
     C           OPCOB5    ORNE *BLANKS                                                       CSW209
     C                     MOVE *BLANKS   FLD1                                                CSW209
     C                     MOVELOPCOB1    FLD1                                                CSW209
     C                     MOVELOPCOB2    WRTC2                                               CSW209
     C                     MOVELOPCOB3    WRTC3                                               CSW209
     C                     MOVELOPCOB4    WRTC4                                               CSW209
     C                     MOVELOPCOB5    WRTC5                                               CSW209
     C                     MOVEL*BLANKS   WRTC6                                               CSW209
     C                     EXSR CONV                                                          CSW209
     C           PSTRNG    CAT  OPARR,23:0PSTRNG                                              CSW209
     C           PSTRNG    CAT  OUTFMT:0  PSTRNG                                              CSW209
     C           PSTRNG    CAT  OPARR,24:0PSTRNG                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
      ** Intermediary Bank Cover                                                              CSW209
      *                                                                                       CSW209
     C           OPCIB1    IFNE *BLANKS                                                       CSW209
     C           OPCIB2    ORNE *BLANKS                                                       CSW209
     C           OPCIB3    ORNE *BLANKS                                                       CSW209
     C           OPCIB4    ORNE *BLANKS                                                       CSW209
     C           OPCIB5    ORNE *BLANKS                                                       CSW209
     C                     MOVE *BLANKS   FLD1                                                CSW209
     C                     MOVELOPCIB1    FLD1                                                CSW209
     C                     MOVELOPCIB2    WRTC2                                               CSW209
     C                     MOVELOPCIB3    WRTC3                                               CSW209
     C                     MOVELOPCIB4    WRTC4                                               CSW209
     C                     MOVELOPCIB5    WRTC5                                               CSW209
     C                     MOVEL*BLANKS   WRTC6                                               CSW209
     C                     EXSR CONV                                                          CSW209
     C           PSTRNG    CAT  OPARR,25:0PSTRNG                                              CSW209
     C           PSTRNG    CAT  OUTFMT:0  PSTRNG                                              CSW209
     C           PSTRNG    CAT  OPARR,26:0PSTRNG                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
      ** Account with Bank Cover                                                              CSW209
      *                                                                                       CSW209
     C           OPCAB1    IFNE *BLANKS                                                       CSW209
     C           OPCAB2    ORNE *BLANKS                                                       CSW209
     C           OPCAB3    ORNE *BLANKS                                                       CSW209
     C           OPCAB4    ORNE *BLANKS                                                       CSW209
     C           OPCAB5    ORNE *BLANKS                                                       CSW209
     C                     MOVE *BLANKS   FLD1                                                CSW209
     C                     MOVELOPCAB1    FLD1                                                CSW209
     C                     MOVELOPCAB2    WRTC2                                               CSW209
     C                     MOVELOPCAB3    WRTC3                                               CSW209
     C                     MOVELOPCAB4    WRTC4                                               CSW209
     C                     MOVELOPCAB5    WRTC5                                               CSW209
     C                     MOVEL*BLANKS   WRTC6                                               CSW209
     C                     EXSR CONV                                                          CSW209
     C           PSTRNG    CAT  OPARR,27:0PSTRNG                                              CSW209
     C           PSTRNG    CAT  OUTFMT:0  PSTRNG                                              CSW209
     C           PSTRNG    CAT  OPARR,28:0PSTRNG                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
      ** Beneficiary Cover                                                                    CSW209
      *                                                                                       CSW209
     C           OPCBC1    IFNE *BLANKS                                                       CSW209
     C           OPCBC2    ORNE *BLANKS                                                       CSW209
     C           OPCBC3    ORNE *BLANKS                                                       CSW209
     C           OPCBC4    ORNE *BLANKS                                                       CSW209
     C           OPCBC5    ORNE *BLANKS                                                       CSW209
     C                     MOVE *BLANKS   FLD1                                                CSW209
     C                     MOVELOPCBC1    FLD1                                                CSW209
     C                     MOVELOPCBC2    WRTC2                                               CSW209
     C                     MOVELOPCBC3    WRTC3                                               CSW209
     C                     MOVELOPCBC4    WRTC4                                               CSW209
     C                     MOVELOPCBC5    WRTC5                                               CSW209
     C                     MOVEL*BLANKS   WRTC6                                               CSW209
     C                     EXSR CONV                                                          CSW209
     C           PSTRNG    CAT  OPARR,29:0PSTRNG                                              CSW209
     C           PSTRNG    CAT  OUTFMT:0  PSTRNG                                              CSW209
     C           PSTRNG    CAT  OPARR,30:0PSTRNG                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
      ** Details of Payment Cover                                                             CSW209
      *                                                                                       CSW209
     C           OPCDP1    IFNE *BLANKS                                                       CSW209
     C           OPCDP2    ORNE *BLANKS                                                       CSW209
     C           OPCDP3    ORNE *BLANKS                                                       CSW209
     C           OPCDP4    ORNE *BLANKS                                                       CSW209
     C                     MOVE *BLANKS   FLD1                                                CSW209
     C                     MOVELOPCDP1    FLD1                                                CSW209
     C                     MOVELOPCDP2    WRTC2                                               CSW209
     C                     MOVELOPCDP3    WRTC3                                               CSW209
     C                     MOVELOPCDP4    WRTC4                                               CSW209
     C                     MOVEL*BLANKS   WRTC5                                               CSW209
     C                     MOVEL*BLANKS   WRTC6                                               CSW209
     C                     EXSR CONV                                                          CSW209
     C           PSTRNG    CAT  OPARR,31:0PSTRNG                                              CSW209
     C           PSTRNG    CAT  OUTFMT:0  PSTRNG                                              CSW209
     C           PSTRNG    CAT  OPARR,32:0PSTRNG                                              CSW209
     C                     ENDIF                                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSD015
     C           PSTRNG    IFNE *BLANKS                                                       CSD015
      *                                                                                       CSD015
      **  First parameter                                                                     CSD015
      *                                                                                       CSD015
     C                     MOVE 'FTOPAY'  W4ITEM                                              CSD015
     C**********           MOVE PREF      W4IDEN                                        CSD015221934
     C                     MOVELPREF      W4IDEN                                              221934
     C                     MOVE BRCA      W4BRCH                                              CSD015
     C                     MOVE LIBR      W4SYSM                                              CSD015
     C**********           MOVE 'OTPAYDD' W4FUNT                                        CSD015221934
     C                     MOVEL'OTPAYDD' W4FUNT                                              221934
     C                     Z-ADD0         W4DDAT                                              CSD015
     C                     Z-ADDSLDT      W4VDAT                                              CSD015
     C                     Z-ADDPVDT      W4MDAT                                              CSD015
     C                     MOVELSMCY      W4DEN1                                              CSD015
     C                     MOVELPCCY      W4DEN2                                              CSD015
     C                     Z-ADDSMAM      W4AMT1                                              CSD015
     C                     Z-ADDPYAM      W4AMT2                                              CSD015
      *                                                                                       CSD015
      ** Counterparty Details                                                                 CSD015
      *                                                                                       CSD015
     C                     MOVEL*BLANKS   W4CNUM                                              CSD015
     C                     MOVEL*BLANKS   W4CTYP                                              CSD015
     C                     MOVE *BLANKS   W4CUST                                              CSD015
     C           ODMT      IFNE *BLANKS                                                       CSD015
     C                     MOVELODMT      FLD1                                                CSD015
     C                     MOVEL*BLANKS   WRTC2                                               CSD015
     C                     MOVEL*BLANKS   WRTC3                                               CSD015
     C                     MOVEL*BLANKS   WRTC4                                               CSD015
     C                     MOVEL*BLANKS   WRTC5                                               CSD015
     C                     MOVEL*BLANKS   WRTC6                                               CSD015
     C                     EXSR CONV                                                          CSD015
     C                     ELSE                                                               CSD015
     C           ORC1      IFNE *BLANKS                                                       CSD015
     C           ORC2      ORNE *BLANKS                                                       CSD015
     C           ORC3      ORNE *BLANKS                                                       CSD015
     C           ORC4      ORNE *BLANKS                                                       CSD015
     C                     MOVELORC1      FLD1                                                CSD015
     C                     MOVELORC2      WRTC2                                               CSD015
     C                     MOVELORC3      WRTC3                                               CSD015
     C                     MOVELORC4      WRTC4                                               CSD015
     C                     MOVEL*BLANKS   WRTC5                                               CSD015
     C                     MOVEL*BLANKS   WRTC6                                               CSD015
     C                     EXSR CONV                                                          CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           OUTCUS    IFEQ '*FREE'                                                       CSD015
     C           OUTCUS    OREQ '*CPART'                                                      CSD015
     C           ORC1      OREQ *BLANKS                                                       CSD015
     C           ORC2      ANDEQ*BLANKS                                                       CSD015
     C           ORC3      ANDEQ*BLANKS                                                       CSD015
     C           ORC4      ANDEQ*BLANKS                                                       CSD015
     C           OPMSGR    IFGT 0                                                             CSD015
     C                     MOVELOPORB1    FLD1                                                CSD015
     C                     MOVELOPORB2    WRTC2                                               CSD015
     C                     MOVELOPORB3    WRTC3                                               CSD015
     C                     MOVELOPORB4    WRTC4                                               CSD015
     C                     MOVELOPORB5    WRTC5                                               CSD015
     C                     MOVEL*BLANKS   WRTC6                                               CSD015
     C                     EXSR CONV                                                          CSD015
     C                     ENDIF                                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           OUTCUS    IFEQ '*FREE'                                                       CSD015
     C           OUTCUS    OREQ '*CPART'                                                      CSD015
     C           ORC1      OREQ *BLANKS                                                       CSD015
     C           ORC2      ANDEQ*BLANKS                                                       CSD015
     C           ORC3      ANDEQ*BLANKS                                                       CSD015
     C           ORC4      ANDEQ*BLANKS                                                       CSD015
     C           OPMSGR    ANDEQ0                                                             CSD015
     C                     MOVE *BLANKS   ORDBK                                               CSD015
     C                     SELEC                                                              CSD015
     C           OTORBT    WHEQ 'N'                                                           CSD015
     C                     MOVELORBK      NORBK                                               CSD015
     C                     MOVELORDBK     FLD1                                                CSD015
     C           OTORBT    WHEQ 'R'                                                           CSD015
     C                     MOVELORBK      RORBK                                               CSD015
     C                     MOVELORDBK     FLD1                                                CSD015
     C                     OTHER                                                              CSD015
     C                     MOVELORBK      FLD1                                                CSD015
     C                     ENDSL                                                              CSD015
     C                     MOVEL*BLANKS   WRTC2                                               CSD015
     C                     MOVEL*BLANKS   WRTC3                                               CSD015
     C                     MOVEL*BLANKS   WRTC4                                               CSD015
     C                     MOVEL*BLANKS   WRTC5                                               CSD015
     C                     MOVEL*BLANKS   WRTC6                                               CSD015
     C                     EXSR CONV                                                          CSD015
     C                     ENDIF                                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           OUTCUS    IFNE '*FREE'                                                       CSD015
     C           OUTCUS    ANDNE'*CPART'                                                      CSD015
      *                                                                                       CSD015
     C                     MOVELOUTCUS    W4CNUM                                              CSD015
      *                                                                                       CSD015
     C                     CALL 'AOCUSTR0'                                                    CSD015
     C                     PARM *BLANKS   @RTCD                                               CSD015
     C                     PARM '*KEY   ' @OPTN                                               CSD015
     C                     PARM OUTCUS    @KEY1  10                                           CSD015
     C                     PARM *BLANKS   @KYST   7                                           CSD015
     C           SDCUST    PARM SDCUST    DSSDY                                               CSD015
      *                                                                                       CSD015
     C           @RTCD     IFNE *BLANKS                                                       CSD015
     C           @RTCD     ANDNE'*NRF   '                                                     CSD015
     C                     MOVE 47        DBASE                                               CSD015
     C                     MOVELDSTCUS    DBKEY                                               CSD015
     C                     MOVEL'SDCUSTPD'DBFILE                                              CSD015
     C                     EXSR *PSSR                                                         CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           @RTCD     IFEQ *BLANKS                                                       CSD015
      *                                                                                       CSD015
     C           BBCRNM    CAT  BBCRTN    W4CUST                                              CSD015
      *                                                                                       CSD015
     C           CCF001    IFEQ 'Y'                                                           CSD015
      *                                                                                       CSD015
     C           BBCRPC    IFEQ 'Y'                                                           CSD015
     C                     MOVE 'C'       W4CTYP                                              CSD015
     C                     ELSE                                                               CSD015
     C                     MOVE 'I'       W4CTYP                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     ELSE                                                               CSD015
      *                                                                                       CSD015
     C           BBLICD    IFNE *BLANK                                                        CSD015
     C           BBLICD    ANDNEW1IND1                                                        CSD015
     C           BBLICD    ANDNEW1IND2                                                        CSD015
     C           BBLICD    ANDNEW1IND3                                                        CSD015
     C           BBLICD    ANDNEW1IND4                                                        CSD015
     C           BBLICD    ANDNEW1IND5                                                        CSD015
     C                     MOVEL'C'       W4CTYP                                              CSD015
     C                     ELSE                                                               CSD015
     C                     MOVEL'I'       W4CTYP                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     ENDIF                                                              CSD015
     C                     ENDIF                                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     CALL 'SDWLCLOP'                                                    CSD015
     C                     PARM           PDS1                                                CSD015
     C                     PARM           PSTRNG                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     ENDSR                                                              CSD015
      *****************************************************************                       CSD015
      /EJECT                                                                                  CSD015
      * Subroutine  :  CONV                                           *                       CSD015
      * Function    :  This subroutine will convert accounts, customer*                       CSD015
      *                no. to customer name and address.              *                       CSD015
      *                                                               *                       CSD015
      * Called by   :  Subroutine UPDFLS                              *                       CSD015
      * Calls       :  SDCWLCHK                                       *                       CSD015
      *****************************************************************                       CSD015
      *                                                                                       CSD015
     C           CONV      BEGSR                                                              CSD015
      *                                                                                       CSD015
     C                     MOVE *BLANKS   OUTFMT216                                           CSD015
     C                     MOVE *BLANKS   WRTCD  35                                           CSD015
      *                                                                                       CSD015
     C           FLD1      IFNE *BLANKS                                                       CSD015
     C                     CALL 'SDCWLFMT'                                                    CSD015
     C                     PARM *BLANKS   PRTCD   7                                           CSD015
     C                     PARM FLD1      WRTC1  35                                           CSD015
     C                     PARM           WRTC2  35                                           CSD015
     C                     PARM           WRTC3  35                                           CSD015
     C                     PARM           WRTC4  35                                           CSD015
     C                     PARM           WRTC5  35                                           CSD015
     C                     PARM           WRTC6  35                                           CSD015
     C                     PARM SMCY      WRTC7   3                                           CSD015
     C                     PARM           OUTFMT216                                           CSD015
     C                     PARM           OUTCUS  6                                           CSD015
     C                     ENDIF                                                              CSD015
     C                     ENDSR                                                              CSD015
      *****************************************************************                       CSD015
     C/EJECT                                                                                  212229
      *****************************************************************                       212229
      *                                                               *                       212229
      *  ZEROFD   : Zeroise all numeric pack fields in the passing    *                       212229
      *             parameter for A101PS and A102PS.                  *                       212229
      *                                                               *                       212229
      *  Called by: SRINRF                                            *                       212229
      *             SRINCT                                            *                       212229
      *                                                               *                       212229
      *  Calls    : None                                              *                       212229
      *                                                               *                       212229
      *****************************************************************                       212229
     CSR         ZEROFD    BEGSR                                                              212229
      *                                                                                       212229
      ** Header file of MT101                                                                 212229
      *                                                                                       212229
     C                     Z-ADD0         H1TODB                                              212229
     C                     Z-ADD0         H1SQNO                                              212229
     C                     Z-ADD0         H1MSGR                                              212229
     C                     Z-ADD0         H1SSDC                                              212229
     C                     Z-ADD0         H1SPRC                                              212229
     C                     Z-ADD0         H1OMC1                                              212229
     C                     Z-ADD0         H1OMC2                                              212229
     C                     Z-ADD0         H1OMC3                                              212229
     C                     Z-ADD0         H1OMC4                                              212229
     C                     Z-ADD0         H1OMC5                                              212229
     C                     Z-ADD0         H1VRAT                                              212229
     C                     Z-ADD0         H1VAMT                                              212229
      *                                                                                       212229
      ** Detail file of MT101                                                                 212229
      *                                                                                       212229
     C                     Z-ADD0         D1TFAM                                              212229
     C                     Z-ADD0         D1PYAM                                              212229
     C                     Z-ADD0         D1PYBQ                                              212229
     C                     Z-ADD0         D1TFBC                                              212229
     C                     Z-ADD0         D1XRAT                                              212229
     C                     Z-ADD0         D1TAMT                                              212229
     C                     Z-ADD0         D1RCCG                                              212229
     C                     Z-ADD0         D1PCHG                                              212229
     C                     Z-ADD0         D1TCHG                                              212229
     C                     Z-ADD0         D1CQNU                                              212229
     C                     Z-ADD0         D1SQNO                                              212229
     C                     Z-ADD0         D1FCCC                                              212229
     C                     Z-ADD0         D1TCCC                                              212229
     C                     Z-ADD0         D1IMC1                                              212229
     C                     Z-ADD0         D1IMC2                                              212229
     C                     Z-ADD0         D1IMC3                                              212229
     C                     Z-ADD0         D1IMC4                                              212229
     C                     Z-ADD0         D1IMC5                                              212229
     C                     Z-ADD0         D1VAMT                                              212229
     C                     Z-ADD0         D1NOEN                                              212229
     C                     Z-ADD0         D1NOAU                                              212229
     C                     Z-ADD0         D1CHRT                                              212229
      *                                                                                       212229
      ** Header file of MT102                                                                 212229
      *                                                                                       212229
     C                     Z-ADD0         H2DRTE                                              212229
     C                     Z-ADD0         H2DTFR                                              212229
     C                     Z-ADD0         H2DAMT                                              212229
     C                     Z-ADD0         H2DSCT                                              212229
     C                     Z-ADD0         H2DSCG                                              212229
     C                     Z-ADD0         H2DRCG                                              212229
     C                     Z-ADD0         H2DTDB                                              212229
     C                     Z-ADD0         H2SQNO                                              212229
     C                     Z-ADD0         H2STAC                                              212229
     C                     Z-ADD0         H2PRIR                                              212229
      *                                                                                       212229
      ** Detail file of MT102                                                                 212229
      *                                                                                       212229
     C                     Z-ADD0         D2TAMT                                              212229
     C                     Z-ADD0         D2ORAM                                              212229
     C                     Z-ADD0         D2PYAM                                              212229
     C                     Z-ADD0         D2PYBQ                                              212229
     C                     Z-ADD0         D2TFBQ                                              212229
     C                     Z-ADD0         D2SNCH                                              212229
     C                     Z-ADD0         D2SNOC                                              212229
     C                     Z-ADD0         D2SNCF                                              212229
     C                     Z-ADD0         D2RCCH                                              212229
     C                     Z-ADD0         D2RCOC                                              212229
     C                     Z-ADD0         D2RCCF                                              212229
     C                     Z-ADD0         D2XRAT                                              212229
     C                     Z-ADD0         D2CQNU                                              212229
     C                     Z-ADD0         D2SQNO                                              212229
     C                     Z-ADD0         D2MIC1                                              212229
     C                     Z-ADD0         D2MIC2                                              212229
     C                     Z-ADD0         D2MIC3                                              212229
     C                     Z-ADD0         D2MIC4                                              212229
     C                     Z-ADD0         D2MIC5                                              212229
     C                     Z-ADD0         D2FXCH                                              212229
     C                     Z-ADD0         D2TCCH                                              212229
     C                     Z-ADD0         D2VAMT                                              212229
     C                     Z-ADD0         D2VRAT                                              212229
     C                     Z-ADD0         D2TNNT                                              212229
     C                     Z-ADD0         D2TNAT                                              212229
     C                     Z-ADD0         D2CHRT                                              212229
     C                     Z-ADD0         D2SCH2                                              212229
     C                     Z-ADD0         D2SCP2                                              212229
     C                     Z-ADD0         D2SCT2                                              212229
     C                     Z-ADD0         D2SCH3                                              212229
     C                     Z-ADD0         D2SCP3                                              212229
     C                     Z-ADD0         D2SCT3                                              212229
     C                     Z-ADD0         D2SCH4                                              212229
     C                     Z-ADD0         D2SCP4                                              212229
     C                     Z-ADD0         D2SCT4                                              212229
     C                     Z-ADD0         D2SCH5                                              212229
     C                     Z-ADD0         D2SCP5                                              212229
     C                     Z-ADD0         D2SCT5                                              212229
     CSR                   ENDSR                                                              212229
      /EJECT
     C/EJECT
      *****************************************************************                       208219
      /TITLE SR/SRB103                                                                        208219
      *****************************************************************                       208219
      *                                                               *                       208219
      *  SRB103 - Check MT103 agreement                               *                       208219
      *                                                               *                       208219
      *  Called By: CADSDA subroutine                                 *                       208219
      *                                                               *                       208219
      *  Calls:                                                       *                       208219
      *  AOCUSTR0  - Access Object to get customer details            *                       208219
      *  AOBRCHR0  - Access Object to get branch details              *                       208219
      *  ME1730    - Determines whether an MT103 exists               *                       208219
      *  SRERR     - Error subroutine                                 *                       208219
      *                                                               *                       208219
      *****************************************************************                       208219
      *                                                                                       208219
     C           SRB103    BEGSR                           *** SRB103 ***                     208219
      *                                                                                       208219
      ** Set up subroutine stack name                                                         208219
      *                                                                                       208219
     C                     ADD  1         Q                                                   208219
     C                     MOVEL'SRB103'  @STK,Q                                              208219
     C                     MOVEL*BLANK    PSNBRC                                              208219
     C                     MOVEL*BLANK    PSBICA                                              208219
     C                     MOVEL*BLANK    PSWIFT                                              208219
     C                     MOVEL*BLANK    PORDBK                                              208219
     C                     MOVEL*BLANK    PORTCD                                              208219
     C                     MOVEL*BLANK    WSWIFT                                              208219
     C                     MOVEL*BLANK    WCNUM                                               208219
      *                                                                                       208219
      ** Get SWIFT-BIC of destination                                                         208219
      *                                                                                       208219
     C           F4DSTT    IFEQ 'S'                                                           208219
     C           11        SUBSTS4DST1:1  WSWIFT 11                                           208219
     C                     ENDIF                                                              208219
      *                                                                                       208219
      ** Destination type is a full nostro 'F', customer number 'C'                           208219
      ** retail account 'R' or GL account 'G', get SWIFT ID through                           208219
      ** customer number                                                                      208219
      *                                                                                       208219
     C           F4DSTT    IFEQ 'F'                                                           208219
     C           F4DSTT    OREQ 'C'                                                           208219
     C           F4DSTT    OREQ 'R'                                                           208219
     C           F4DSTT    OREQ 'G'                                                           208219
      *                                                                                       208219
     C                     SELEC                                                              208219
     C           F4DSTT    WHEQ 'F'                                                           208219
     C           3         SUBSTS4DST1:1  WCYCD                                               208219
     C           2         SUBSTS4DST1:4  WNONB                                               208219
     C                     CALL 'AONOSTR0'             9090                                   208219
     C                     PARM *BLANKS   WWRTCD  7                                           208219
     C                     PARM '*KEY   ' WOPTN   7                                           208219
     C                     PARM *BLANKS   WCUST                                               208219
     C                     PARM           WCYCD   3                                           208219
     C                     PARM *BLANKS   WACCN   4                                           208219
     C                     PARM *BLANKS   WACSN   2                                           208219
     C                     PARM           WNONB   2                                           208219
     C                     PARM *BLANKS   WBRCD   3                                           208219
     C                     PARM *BLANKS   WCSSN  10                                           208219
     C                     PARM *BLANKS   WPNOI   1                                           208219
     C           SDNOST    PARM SDNOST    DSFDY                                               208219
      *                                                                                       208219
      ** If error on call                                                                     208219
      *                                                                                       208219
     C           *IN90     IFEQ *ON                                                           208219
     C           WWRTCD    ORNE *BLANK                                                        208219
     C                     MOVE 'SDNOSTPD'W0FILE                                              208219
     C                     MOVELWCYCD     W0KEY5  5                                           208219
     C                     MOVE WNONB     W0KEY5                                              208219
     C                     MOVELWNONB     W0KEY                                               208219
     C                     Z-ADD158       W0ERNB                                              208219
     C                     MOVEL'MEM5003' W0MSGD                                              208219
     C                     MOVEL'MIDAS  ' W0MSGF                                              208219
     C                     EXSR SRERR                                                         208219
     C                     ENDIF                                                              208219
     C                     MOVELA7CUST    WCNUM  10                                           208219
      *                                                                                       208219
     C           F4DSTT    WHEQ 'R'                                                           CFT162
     C           6         SUBSTV#TOGL:1  WCNUM     P                                         CFT162
      *                                                                                       CFT162
     C           F4DSTT    WHEQ 'C'                                                           208219
     C           10        SUBSTS4DST1:1  WCNUM                                               208219
      *                                                                                       208219
     C                     OTHER                                                              208219
     C           6         SUBSTS4DST1:1  WCNUM                                               208219
     C                     ENDSL                                                              208219
      *                                                                                       208219
      ** Access customer's file to get SWIFT id                                               208219
      *                                                                                       208219
     C                     CALL 'AOCUSTR0'                                                    208219
     C                     PARM *BLANKS   @RTRN   7                                           208219
     C                     PARM '*KEY   ' @OPTN   7                                           208219
     C                     PARM WCNUM     @KEY1  10                                           208219
     C                     PARM *BLANKS   @KYST   7                                           208219
     C           SDCUST    PARM SDCUST    DSSDY                                               208219
      *                                                                                       208219
     C           @RTRN     IFEQ *BLANK                                                        208219
     C           BBCSID    IFNE *BLANK                                                        208219
     C                     MOVELBBCSID    WSWIFT                                              208219
     C                     ENDIF                                                              208219
     C                     ELSE                                                               208219
     C                     MOVEL'SDCUSTPD'W0FILE                                              208219
     C                     Z-ADD159       W0ERNB                                              208219
     C                     MOVELWCNUM     W0KEY                                               208219
     C                     EXSR SRERR                                                         208219
     C                     ENDIF                                                              208219
     C                     ENDIF                                                              208219
      *                                                                                       208219
      ** Setup parameter to ME1730                                                            208219
      *                                                                                       208219
     C           WSWIFT    IFNE *BLANK                                                        208219
     C                     MOVELS4BRCA    PSNBRC                                              208219
     C                     CALL 'AOBRCHR0'             9090                                   208219
     C                     PARM *BLANKS   RTCD                                                208219
     C                     PARM '*KEY   ' @OPTN                                               208219
     C                     PARM S4BRCA    @BRCD   3                                           208219
     C           SDBRCH    PARM SDBRCH    DSFDY                                               208219
      *                                                                                       208219
      ** Error found on call                                                                  208219
      *                                                                                       208219
     C           *IN90     IFEQ *ON                                                           208219
     C           RTCD      ORNE *BLANK                                                        208219
     C                     MOVEL'AOBRCHR0'W0FILE                                              208219
     C                     MOVEL'*CALL'   W0KEY                                               208219
     C                     Z-ADD160       W0ERNB                                              208219
     C                     MOVEL'MEM5003' W0MSGD                                              208219
     C                     MOVEL'MIDAS  ' W0MSGF                                              208219
     C                     EXSR SRERR                                                         208219
     C                     ENDIF                                                              208219
     C                     MOVELA8BTID    PSBICA                                              208219
     C                     MOVELWSWIFT    PSWIFT                                              208219
     C                     MOVELS4ORBK    PORDBK                                              208219
      *                                                                                       208219
      ** Call ME1730                                                                          208219
      *                                                                                       208219
     C                     CALL 'ME1730'                                                      208219
     C                     PARM           PSNBRC  3                                           208219
     C                     PARM           PSBICA 11                                           208219
     C                     PARM           PSWIFT 11                                           208219
     C                     PARM           PORDBK256                                           208219
     C                     PARM *BLANK    PBBINF256                                           208219
     C                     PARM *BLANK    PSNCOR256                                           208219
     C                     PARM *BLANK    PRCCOR256                                           208219
     C                     PARM *BLANK    PORTCD  7                                           208219
      *                                                                                       208219
      ** Error on call                                                                        208219
      *                                                                                       208219
     C           PORTCD    IFEQ '*ERROR '                                                     208219
     C                     MOVEL'ME1730  'W0FILE                                              208219
     C                     Z-ADD161       W0ERNB                                              208219
     C                     MOVEL'*CALL   'W0KEY                                               208219
     C                     EXSR SRERR                                                         208219
     C                     ELSE                                                               208219
     C           PORTCD    IFEQ '*CRT103'                                                     208219
     C                     MOVE 'Y'       V#M103                                              208219
     C                     ENDIF                                                              208219
     C                     ENDIF                                                              208219
     C                     ENDIF                                                              208219
      *                                                                                       208219
      ** Unwind subroutine stack name                                                         208219
      *                                                                                       208219
     C                     MOVEA*BLANKS   @STK,Q                                              208219
     C                     SUB  1         Q                                                   208219
      *                                                                                       208219
     CSR                   ENDSR                                                              208219
      /EJECT                                                                                  208219
      *****************************************************************                       208219
     C/EJECT
      *****************************************************************                       225169
      *                                                               *                       225169
      *  WTRNCY   :  Translate SWIFT ccy to Midas ccy if needed.      *                       225169
      *                                                               *                       225169
      *  CALLED BY:  RTPCA, RTPDCA, CWAMCY, SRMAP                     *                       225169
      *                                                               *                       225169
      *****************************************************************                       225169
     CSR         WTRNCY    BEGSR                                                              225169
     C           WCCY      IFNE *BLANKS                                                       225169
     C                     CALL 'AOCURRR0'                                                    225169
     C                     PARM *BLANKS   @RTCD                                               225169
     C                     PARM '*KEY   ' @OPTN                                               225169
     C                     PARM WCCY      @CURR                                               225169
     C           SDCURR    PARM SDCURR    DSSDY                                               225169
      *                                                                                       225169
     C           @RTCD     IFNE *BLANKS                                                       225169
      *                                                                                       225169
      ** Access SDCURRLD keyed by SWIFT currency code, in case this is                        225169
      ** different from Midas currency code.                                                  225169
      *                                                                                       225169
     C           WCCY      CHAINSDCURRLD             88                                       225169
     C********** *IN88     IFEQ *ON                                                    225169 226917
     C**********           MOVEL'AOCURR0' DBFILE                                       225169 226917
     C**********           MOVEL'*CALL'   DBKEY                                        225169 226917
     C**********           Z-ADD87        DBASE                                        225169 226917
     C**********           EXSR *PSSR                                                  225169 226917
     C**********           ENDIF                                                       225169 226917
     C**********           ENDIF                                                       225169 226917
      *                                                                                       226917
      * Overwrite currency code if found                                                      226917
     C           *IN88     IFEQ '0'                                                           226917
     C                     MOVE A6CYCD    WCCY    3                                           225169
     C                     ENDIF                                                              226917
      *                                                                                       226917
     C                     ENDIF                                                              226917
     C                     ENDIF                                                              225169
      *                                                                                       225169
     CSR                   ENDSR                                                              225169
     C/EJECT                                                                                  225169
      *****************************************************************                       CER030
      *                                                               *                       CER030
      *  SREXVL : Extended Narrative Validations                      *                       CER030
      *                                                               *                       CER030
      *  CALLED BY:  SRINFT, SROTFT                                   *                       CER030
      *                                                               *                       CER030
      *****************************************************************                       CER030
     C           SREXVL    BEGSR                                                              CER030
      *                                                                                       CER030
      ** Set up subroutine stack name                                                         CER030
      *                                                                                       CER030
     C                     ADD  1         Q       50                                          CER030
     C                     MOVEL'SREXVL'  @STK,Q                                              CER030
      *                                                                                       CER030
     C                     MOVEL*BLANKS   E#NOUP                                              CER030
     C                     MOVEL*BLANKS   E#MSGS                                              CER030
     C                     MOVEL##PGM     E#CPGM                                              CER030
     C                     MOVEL*BLANKS   C#ERCD                                              CER030
      *                                                                                       CER030
     C                     CALL 'MG001900'                                                    CER030
     C                     PARM           PRTCD1 10                                           CER030
     C                     PARM '*VALID ' POPTN1  7                                           CER030
     C                     PARM PNWRK     PNWRK1  6                                           CER030
     C                     PARM           PMSGTP  3                                           CER030
     C                     PARM PBRCA     PBRCA   3                                           CER030
     C**********           PARM CNUM      PCUSNO  60                                   CER030 CER059
     C                     PARM CNUM      PCUSNO  6                                           CER059
     C                     PARM CCY       PCCY    3                                           CER030
     C                     PARM ACOD      PACCD                                               CER030
     C                     PARM ACSQ      PACSQ                                               CER030
     C                     PARM           PDCIN   1                                           CER030
     C                     PARM           PTRTP   5                                           CER030
     C                     PARM           PNAR1  65                                           CER030
     C                     PARM           PNAR2  65                                           CER030
     C                     PARM           PNAR3  65                                           CER030
     C                     PARM           PNAR4  65                                           CER030
     C                     PARM           PNAR5  65                                           CER030
     C                     PARM           PNAR6  65                                           CER030
     C                     PARM           PFOR1  70                                           CER030
     C                     PARM           PFOR2  70                                           CER030
     C                     PARM           PFOR3  70                                           CER030
     C                     PARM           PFOR4  70                                           CER030
     C                     PARM           PFOR5  70                                           CER030
     C                     PARM           PFOR6  70                                           CER030
     C                     PARM           PFOR7  70                                           CER030
     C                     PARM           PFOR8  70                                           CER030
     C                     PARM           PFOR9  70                                           CER030
     C                     PARM           PFOR10 70                                           CER030
     C                     PARM           PFOR11 70                                           CER030
     C                     PARM           PFOR12 70                                           CER030
     C                     PARM           PFOR13 70                                           CER030
     C                     PARM           PFOR14 70                                           CER030
     C                     PARM           PFOR15 70                                           CER030
     C                     PARM           PFOR16 70                                           CER030
     C                     PARM           PFOR17 70                                           CER030
     C                     PARM           PFOR18 70                                           CER030
     C                     PARM           PFOR19 70                                           CER030
     C                     PARM           PFOR20 70                                           CER030
     C                     PARM           IDX     30                                          CER030
     C                     PARM           FNMARR                                              CER030
     C                     PARM           MIDARR                                              CER030
     C                     PARM           MDTARR                                              CER030
     C                     PARM           WFLDAR                                              CER030
     C                     PARM           WMIDAR                                              CER030
     C                     PARM           WMDTAR                                              CER030
      *                                                                                       CER030
      *  If error on call                                                                     CER030
      *                                                                                       CER030
     C           *IN90     IFEQ *ON                                                           CER030
     C                     MOVEL'MG001900'W0FILE                                              CER030
     C                     MOVEL'*CALL'   W0KEY                                               CER030
     C                     Z-ADD122       W0ERNB                                              CER030
     C                     MOVEL'MEM5003' W0MSGD                                              CER030
     C                     MOVEL'MIDAS  ' W0MSGF                                              CER030
     C                     EXSR SRERRA                                                        CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     MOVEAMIDARR    C#ERCD                                              CER030
      *                                                                                       CER030
      ** Reprot errors                                                                        CER030
      *                                                                                       CER030
     C                     EXSR SRRERR                                                        CER030
      *                                                                                       CER030
     C           PRTCD1    IFEQ *BLANKS                                                       CER030
      *                                                                                       CER030
     C                     MOVEL'FTM5054' W0LMSG                                              CER030
     C                     MOVEL'FTUSRMSG'W0MSGF                                              CER030
     C                     EXSR SRLOG                                                         CER030
      *                                                                                       CER030
     C                     ELSE                                                               CER030
      *                                                                                       CER030
     C                     MOVEL'Y'       E#NOUP                                              CER030
     C**********           MOVEL'FTM7114' W0LMSG                                       CER030 CER059
     C                     MOVEL'FTM7118' W0LMSG                                              CER059
     C                     MOVEL'FTUSRMSG'W0MSGF                                              CER030
     C                     EXSR SRLOG                                                         CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     MOVEA*BLANKS   @STK,Q                                              CER030
     C                     SUB  1         Q                                                   CER030
      *                                                                                       CER030
     C                     ENDSR                                                              CER030
     C/EJECT                                                                                  CER030
      *****************************************************************                       CER030
      *                                                               *                       CER030
      *  SRTRTY : Transaction Type Validations                        *                       CER030
      *                                                               *                       CER030
      *  CALLED BY:  SRINFT, SROTFT                                   *                       CER030
      *                                                               *                       CER030
      *****************************************************************                       CER030
     C           SRTRTY    BEGSR                                                              CER030
      *                                                                                       CER030
      ** Set up subroutine stack name                                                         CER030
      *                                                                                       CER030
     C                     ADD  1         Q       50                                          CER030
     C                     MOVEL'SRTRTY'  @STK,Q                                              CER030
      *                                                                                       CER030
     C                     MOVEL*BLANKS   E#NOUP                                              CER030
     C                     MOVEL*BLANKS   E#MSGS                                              CER030
     C                     MOVEL##PGM     E#CPGM                                              CER030
     C                     MOVEL*BLANKS   C#ERCD                                              CER030
      *                                                                                       CER030
     C           WRTTY     IFNE *BLANKS                                                       CER030
      *                                                                                       CER030
     C           WTTCD     IFNE *BLANKS                                                       CER030
     C           CFT014    ANDEQ'Y'                                                           CER030
      *                                                                                       CER030
     C                     CALL 'AONTTIR1'             9090                                   CER030
     C                     PARM *BLANKS   PRTCD                                               CER030
     C                     PARM '*KEY'    POPTN                                               CER030
     C           WRTTY     PARM WRTTY     PRTTY   5                                           CER030
     C                     PARM WTTCD     PTTCD  10                                           CER030
     C                     PARM *BLANKS   DSFDY                                               CER030
      *                                                                                       CER030
      *  If error on call                                                                     CER030
      *                                                                                       CER030
     C           *IN90     IFEQ *ON                                                           CER030
     C                     MOVEL'AONTTIR1'W0FILE                                              CER030
     C                     MOVEL'*CALL'   W0KEY                                               CER030
     C                     Z-ADD123       W0ERNB                                              CER030
     C                     MOVEL'MEM5003' W0MSGD                                              CER030
     C                     MOVEL'MIDAS  ' W0MSGF                                              CER030
     C                     EXSR SRERRA                                                        CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           PRTCD     IFNE *BLANKS                                                       CER030
     C                     MOVEL'FTM3264' C#ERCD                                              CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ELSE                                                               CER030
      *                                                                                       CER030
     C                     CALL 'AORETRR0'             9090                                   CER030
     C                     PARM *BLANKS   PRTCD                                               CER030
     C                     PARM '*KEY'    POPTN                                               CER030
     C           WRTTY     PARM WRTTY     PRTTY                                               CER030
     C                     PARM *BLANKS   DSFDY                                               CER030
      *                                                                                       CER030
      *  If error on call                                                                     CER030
      *                                                                                       CER030
     C           *IN90     IFEQ *ON                                                           CER030
     C                     MOVEL'AORETRR0'W0FILE                                              CER030
     C                     MOVEL'*CALL'   W0KEY                                               CER030
     C                     Z-ADD124       W0ERNB                                              CER030
     C                     MOVEL'MEM5003' W0MSGD                                              CER030
     C                     MOVEL'MIDAS  ' W0MSGF                                              CER030
     C                     EXSR SRERRA                                                        CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           PRTCD     IFNE *BLANKS                                                       CER030
     C                     MOVEL'FTM5055' C#ERCD                                              CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      ** Reprot errors                                                                        CER030
      *                                                                                       CER030
     C                     EXSR SRRERR                                                        CER030
      *                                                                                       CER030
     C           PRTCD     IFEQ *BLANKS                                                       CER030
      *                                                                                       CER030
     C**********           MOVEL'FTM7115' W0LMSG                                       CER030 CER059
     C                     MOVEL'FTM7117' W0LMSG                                              CER059
     C                     MOVEL'FTUSRMSG'W0MSGF                                              CER030
     C                     EXSR SRLOG                                                         CER030
      *                                                                                       CER030
     C                     ELSE                                                               CER030
      *                                                                                       CER030
     C                     MOVEL'Y'       E#NOUP                                              CER030
     C                     MOVEL'FTM7116' W0LMSG                                              CER030
     C                     MOVEL'FTUSRMSG'W0MSGF                                              CER030
     C                     EXSR SRLOG                                                         CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     MOVEA*BLANKS   @STK,Q                                              CER030
     C                     SUB  1         Q                                                   CER030
      *                                                                                       CER030
     C                     ENDSR                                                              CER030
     C/EJECT                                                                                  CER030
      *****************************************************************                       225169
      /TITLE SR/SRFLGL                                                                      HVB005
      *****************************************************************                     HVB005
      *                                                               *                     HVB005
      *  SRFLGL - Sobroutine to assess full General Ledger.           *                     HVB005
      *                                                               *                     HVB005
      *****************************************************************                     HVB005
      *                                                                                     HVB005
     C           SRFLGL    BEGSR                                                            HVB005
      *                                                                                     HVB005
      ** Set up subroutine stack name                                                       HVB005
      *                                                                                     HVB005
     C                     ADD  1         Q                                                 HVB005
     C                     MOVEL'SRFLGL'  @STK,Q                                            HVB005
      *                                                                                     HVB005
     C                     MOVE Q#ACCT    W#ACCT                                           MD31937
      *                                                                                    MD31937
     C                     SELEC                                                            HVB005
      *                                                                                     HVB005
     C           Q#ATYP    WHEQ 'N'                                                         HVB005
     C                     Z-ADDW#NOSN    Q#NOSN                                            HVB005
      *                                                                                     HVB005
     C           Q#ATYP    WHEQ 'F'                                                         HVB005
     C                     MOVE W#NOS     Q#NOS                                             HVB005
      *                                                                                     HVB005
     C           Q#ATYP    WHEQ 'R'                                                         HVB005
     C*****                Z-ADDW#ACNO    Q#ACNO                                   HVB005  MD31937
     C                     Z-ADDW#ACNN    Q#ACNO                                           MD31937
      *                                                                                     HVB005
     C           Q#ATYP    WHEQ 'G'                                                         HVB005
     C           Q#ATYP    OREQ 'I'                                                         HVB005
     C*****                Z-ADDW#CNU1    Q#CNU1                                   HVB005  MD31937
     C                     MOVE W#CNU1    Q#CNU1                                           MD31937
     C                     MOVE W#CCY1    Q#CCY1                                            HVB005
     C                     Z-ADDW#ACO1    Q#ACO1                                            HVB005
     C                     Z-ADDW#ACS1    Q#ACS1                                            HVB005
     C                     MOVE W#BRC1    Q#BRC1                                            HVB005
      *                                                                                     HVB005
     C           Q#ATYP    WHEQ 'P'                                                         HVB005
     C*****                Z-ADDP#CNUM    Q#CNUM                                    HVB005 MD31937
     C                     MOVE P#CNUM    Q#CNUM                                           MD31937
     C                     Z-ADDP#ACSQ    Q#ACSQ                                            HVB005
     C                     MOVE P#BRCA    Q#BRCA                                            HVB005
     C                     Z-ADDP#ACOD    Q#ACOD                                            HVB005
      *                                                                                     HVB005
     C                     ENDSL                                                            HVB005
      *                                                                                     HVB005
      ** Unwind subroutine stack name                                                       HVB005
      *                                                                                     HVB005
     C                     MOVEA*BLANKS   @STK,Q                                            HVB005
     C                     SUB  1         Q                                                 HVB005
      *                                                                                     HVB005
     CSR                   ENDSR                                                            HVB005
      *****************************************************************                     HVB005
      /EJECT
      *****************************************************************
     C/COPY WNCPYSRC,FT0300DCPG
     C/COPY OFCPYSRCZ,CFT135_013                                                              CFT135
      *
      *  /Copy point for Calculations
      *
     C/EJECT
      *
      *  File and Program Error Processing
      *
     C/COPY FTCPYSRC,SRERRC
      *                                                                   130869
      ** Calculate available balance                                      130869
      *                                                                   130869
      /COPY ZSRSRC,RTBALCC1                                               130869
      /EJECT                                                              130869
      *                                                                   130869
      ** Send DataQ Message                                               130869
      *                                                                   130869
      /COPY ZSRSRC,RBSDQMS                                                130869
      /EJECT                                                              130869
      *                                                                   130869
      ** Compute Exchange Rate                                            130869
      *                                                                   130869
     C/EJECT
      /COPY ZSRSRC,ZXRATEZ1                                               CAC002
     C/EJECT                                                              CAC002
      *                                                                   122060
      /COPY ZSRSRC,RTCCYSC1                                               122060
      /EJECT                                                              122060
      *                                                                   130869
      /EJECT                                                              130869
      *                                                                   130869
      ** SR.ZALIGN subroutine                                             130869
      *                                                                   130869
     C/COPY ZSRSRC,ZALIGNZ2                                               130869
     C/EJECT                                                              130869
      *                                                                   130869
      ** SR.ZEDIT subroutine                                              130869
      *                                                                   130869
      /COPY ZSRSRC,ZEDITZ2                                                130869
     C/EJECT                                                              130869
     O/COPY WNCPYSRC,FT0300DOPG
      *
      *  /Copy point for Outputs
      *
     O/EJECT
**  CPY@ table
(c) Misys International Banking Systems Ltd. 2001
** OPARR - Watch List Fields                                                                  CSD015
<Destination>                                                                                 CSD015
</Destination>                                                                                CSD015
<Ordering Bank>                                                                               CSD015
</Ordering Bank>                                                                              CSD015
<Ordering Customer>                                                                           CSD015
</Ordering Customer>                                                                          CSD015
<Receivers Correspondent>                                                                     CSD015
</Receivers Correspondent>                                                                    CSD015
<Account with Bank>                                                                           CSD015
</Account with Bank>                                                                          CSD015
<Beneficiary>                                                                                 CSD015
</Beneficiary>                                                                                CSD015
<Details of Payment>                                                                          CSD015
</Details of Payment>                                                                         CSD015
<Intermediary Bank>                                                                           CSD015
</Intermediary Bank>                                                                          CSD015
<MT100 Ordering Customer>                                                                     CSD015
</MT100 Ordering Customer>                                                                    CSD015
<Third Reimbursement Institution>                                                             CSD015
</Third Reimbursement Institution>                                                            CSD015
<Ordering Customer Cover>                                                                     CSW209
</Ordering Customer Cover>                                                                    CSW209
<Ordering Bank Cover>                                                                         CSW209
</Ordering Bank Cover>                                                                        CSW209
<Intermediary Bank Cover>                                                                     CSW209
</Intermediary Bank Cover>                                                                    CSW209
<Account with Bank Cover>                                                                     CSW209
</Account with Bank Cover>                                                                    CSW209
<Beneficiary Cover>                                                                           CSW209
</Beneficiary Cover>                                                                          CSW209
<Details of Payment Cover>                                                                    CSW209
</Details of Payment Cover>                                                                   CSW209
** IPARR - Watch List Fields                                                                  CSD015
<Sender>                                                                                      CSD015
</Sender>                                                                                     CSD015
<Receiver Corr - FT>                                                                          CSD015
</Receiver Corr - FT>                                                                         CSD015
<A/C with Bank>                                                                               CSD015
</A/C with Bank>                                                                      CSD015 BUG4556
<Beneficiary>                                                                                 CSD015
</Beneficiary>                                                                                CSD015
<Ordering Bank>                                                                               CSD015
</Ordering Bank>                                                                              CSD015
<Sender Corr>                                                                                 CSD015
</Sender Corr>                                                                                CSD015
<Ordering Cust>                                                                               CSD015
</Ordering Cust>                                                                              CSD015
<Details of Payment>                                                                          CSD015
</Details of Payment>                                                                         CSD015
<Intermediary Bank>                                                                           CSD015
</Intermediary Bank>                                                                          CSD015
<Receivers Corr>                                                                              CSD015
</Receivers Corr>                                                                             CSD015
<A/C with Bank>                                                                               CSD015
</A/C with Bank>                                                                              CSD015
<Third Reimbur Inst>                                                                          CSD015
</Third Reimbur Inst>                                                                         CSD015
<Ordering Customer Cover>                                                                     CSW209
</Ordering Customer Cover>                                                                    CSW209
<Ordering Bank Cover>                                                                         CSW209
</Ordering Bank Cover>                                                                        CSW209
<Intermediary Bank Cover>                                                                     CSW209
</Intermediary Bank Cover>                                                                    CSW209
<Account with Bank Cover>                                                                     CSW209
</Account with Bank Cover>                                                                    CSW209
<Beneficiary Cover>                                                                           CSW209
</Beneficiary Cover>                                                                          CSW209
<Details of Payment Cover>                                                                    CSW209
</Details of Payment Cover>                                                                   CSW209
** STAMP - Dummy timestamp                                                                    CFT017
0001-01-01-00.00.00.000000                                                                    CFT017
**  PSNAR table                                                           130869
Payment Advice From Cashier System                                        130869
** AP - Array of powers of 10.                                            CAC002
0000000001                                                                CAC002
0000000010                                                                CAC002
0000000100                                                                CAC002
0000001000                                                                CAC002
0000010000                                                                CAC002
0000100000                                                                CAC002
0001000000                                                                CAC002
0010000000                                                                CAC002
0100000000                                                                CAC002
1000000000                                                                CAC002
     X/COPY WNCPYSRC,FT0300X001
