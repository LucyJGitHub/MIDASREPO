     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas FT Default charges calculation')
     F*****************************************************************
     F*                                                               *
     F*  Midas - Funds Transfer Module                            *
     F*                                                               *
     F*  FT0320 - FT Default Charges Calculation                      *
     F*                                                               *
     F*                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
     F*                                                               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *  Last Amend No. CSD031             Date 10Apr06               *
      *  Prev Amend No. CSD027             Date 09Dec05               *
      *                 CSC022             Date 24Feb04               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 189095             Date 20Jun01               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 148229             Date 13Dec98               *
     F*                 140624             DATE 26Aug98               *
     F*                 CEU006             DATE 29APR98               *
     F*                 109214             DATE 06MAY97               *
     F*                 100660             DATE 01MAY97               *
     F*                 S01408             DATE 25JUL96               *
     F*                 078189             DATE 22NOV94               *
     F*                 S01508             DATE 27JUN94               *
     F*                 S01506             DATE 27JUN94               *
     F*                 S01494             DATE 25MAY94               *
     F*                 S01435             DATE 05NOV93               *
     F*                                                               *
     F*---------------------------------------------------------------*
     F*                                                               *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CSC022 - Commitment Control Changes for MidasPlus            *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  189095 - Corrected problem of rounding in the calulation of  *
      *           charges.  Applied fix 161109.                       *
     F*  148229 - Changes to /COPY FT0010I001 (Recompile only)        *
     F*  140624 - Create a new SR to access ccy details each time     *
     F*           this pgm is called since *IN50 is not reset to '0'  *
     F*           (due to RETRN) when several input are done.         *
     F*  CEU006 - EMU Funds Transfer Payments and Settlements.        *
     F*  109214 - Extend length of program variables to cope with     *
     F*           very large settlement amount.                       *
     F*  100660 - Commission tariff 4 - tiered calculation, not       *
     F*           picking up correct minimum charge.                  *
     F*  S01408 - Core Hook FT0320CCP7 Added                          *
     F*         - Core Hook FT0320CCP6 Added                          *
     F*  078189 - Reinstate the creation parameters inadvertently     *
     F*           removed by 069250                                   *
     F*  S01508 - BLI Extended Payment Charges                        *
     F*  S01506 - BLI Payment Charges Enhancements                    *
     F*  S01494 - BLI Funds Transfer Enhancements                     *
     F*           ALSO ADDITION OF CORE HOOKS FROM CCP1 TO CCP5       *
     F*  S01435 - Incoming Message Management                         *
     F*                                                               *
     F*****************************************************************
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
     F*                                                               *
     F*  Indicator usage                                              *
     F*  ~~~~~~~~~~~~~~~                                              *
     F*                                                               *
     F*  50    First cycle                                            *
     F*  90    General work indicator                                 *
     F*  91    General work indicator                                 *
     F*                                                               *
     F*  U7/U8 Error Ocurred                                          *
     F*  LR    End program                                            *
     F*                                                               *
     F*****************************************************************
     F***PYCHGDB IF  E           K        DISK         KINFSR SRFILE  UC  S01508
     FPYCHGL1 IF  E           K        DISK         KINFSR SRFILE     UC  S01508
     FSDCMRKL1IF  E           K        DISK         KINFSR SRFILE         S01508
      *
      * RSQ : Payment and charges details
      *
     F/COPY WNCPYSRC,FT0320DFPG
      *
      *  /Copy point for File Definition
      *
     F/EJECT
     E                    CPY@    1   1 80
      *
      *  Copyright table
      *
     E/COPY WNCPYSRC,FT0320DEPG
      *
      *  /Copy point for Arrays
      *
     E/COPY FTCPYSRC,SRERRE
      *
      *  end of Copysource for error processing
      *
      ** Array of Commitment Job Names                                                        CSC022
     E                    CMTJOB     10 10                                                    CSC022
     E/EJECT
     I/COPY WNCPYSRC,FT0320DIPG
      *
      *  /Copy point for Input specifications
      *
      *
     ICPYR@#      DS
      *
      *  Data structure for compilation  - Copyright insertion
      *
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
      *
     I/COPY FTCPYSRC,SRERRI
      *
      *  End of Program Error Processing copysource member
      *
     IRUNDTA    E DSRUNDAT
      *
      *  Define rundat data area
      *
     ISDBANK    E DSSDBANKPD
      *
      *  Define rundat data area
      *
     IDSFDY     E DSDSFDY
      *
      * Data Structures used by Access Programs
      *
     IDSSDY     E DSDSSDY
      *
      * Data Structures used by Access Programs
      *
      *
     IDSMTR       DS
      *
      *  Define fields for message transalation
      *
     I                                        1 132 #MSDTA
     I                                       15  30 #MPREF
     I                                    P   1   20#MPART
     I                                      133 264 #MSTX1
     I#MSTX2      DS
     I                                        1 256 #MSTXA
     I                                      257 512 #MSTXB
      /EJECT
      *
      *  Define parameter data structure
     I/COPY WNCPYSRC,FT0320I001
      *
     I***W0DATA******DS****************************256                    S01494
     I***W0DATA******DS*                           310              S01494CEU006
     IW0DATA      DS                            321                       CEU006
     I/COPY WNCPYSRC,FT0320I002
      *
      * Payment type and subtype
     I                                        1   2 W0PYTP
     I                                        3   4 W0PYST
      *
      * Input currency and charge currency
     I                                        5   7 W0ICCY
     I                                        8  10 W0CCCY
      *
      * Settlement method
     I                                       11  12 W0STMT
      *
      * Defaults required
     I                                       13  13 W0DFRQ
      *
      * Charges branch
     I                                       14  16 W0BRCA
      *
      * Charge currency amount
     I                                       17  290W0CAMT
      *
      * Transfer Commission type
     I                                       30  30 W0TRCT
      *
      * SWIFT priority code
     I                                       31  31 W0SWPC
      *
      * Transfer Commission amount
     I                                       32  420W0TRCD
     I                                       43  530W0TRCH
      *
      * Telex charge
     I                                       54  640W0TXCD
     I                                       65  750W0TXCH
      *
      * Cheque Charge
     I                                       76  860W0CQCD
     I                                       87  970W0CQCH
      *
      * Costs Abroad
     I                                       98 1080W0CSTD
     I                                      109 1190W0CSTA
      *
      * SWIFT Priority Charge
     I                                      120 1300W0SPCD
     I                                      131 1410W0SPCH
      *
      * Miscellaneous charge
     I                                      142 1520W0MSCD
     I                                      153 1630W0MSCH
      *
      * Advice Charge
     I                                      164 1740W0ADCD
     I                                      175 1850W0ADCH
      *
      * Telephone Charge
     I                                      186 1960W0TLCD
     I                                      197 2070W0TLCH
      *
      * Collection Charge
     I                                      208 2180W0COLD
     I                                      219 2290W0COLL
      *
      * Payment amount currency
     I                                      230 232 W0PCCY
     I*                                                                   S01494
     I** Other currency                                                   S01494
     I                                      233 235 W0OCCY                S01494
     I*                                                                   S01494
     I** FX/Change commission (input ccy)                                 S01494
     I                                      236 2460W0FXCD                S01494
     I*                                                                   S01494
     I** FX/Change commission (charge ccy)                                S01494
     I                                      247 2570W0FXCH                S01494
     I*                                                                   S01494
     I** Our deductions (input ccy)                                       S01494
     I                                      258 2680W0DEDD                S01494
     I*                                                                   S01494
     I** Our deductions (charge ccy)                                      S01494
     I                                      269 2790W0DEDS                S01494
     I*                                                                   S01494
     I** Correspondent charge (input ccy)                                 S01494
     I                                      280 2900W0COCH                S01494
     I*                                                                   S01494
     I** Correspondent charge (charge ccy)                                S01494
     I                                      291 3010W0COCC                S01494
     I*                                                                   S01494
     I** Default type (HDR or DET or " ")                                 S01494
     I                                      302 304 W0DFTT                S01494
     I*                                                                   S01494
     I** Customer to be debited the charge                                S01494
     I                                      305 310 W0CUST                S01494
     I** Settle value date                                                CEU006
     I                                      311 3150W0SLDT                CEU006
     I** Pay/Credit value date                                            CEU006
     I                                      316 3200W0PVDT                CEU006
     I** Add/Deduct charges indicator                                     CEU006
     I                                      321 321 W0ADDC                CEU006
     I/COPY WNCPYSRC,FT0320I003
     I*                                                                   S01508
     ISEARCH      DS                         24                           S01508
     I** Multiple occurrence DS for updating key list                     S01508
     I*                                                                   S01508
     I                                        1   1 S#BRCA                S01508
     I                                        2   2 S#CUST                S01508
     I                                        3   3 S#PYTP                S01508
     I                                        4   4 S#PYST                S01508
     I                                        5   5 S#CMGC                S01508
      *
      *  Calling parameter data structure for AOCCYCV0
      *
     ID#DTA       DS                            256
      *                                       From Currency & amount
     I                                        1   3 D#FCCY
     I                                    P   4  110D#FAMT
      *                                       To Currency & amount
     I                                       12  14 D#TCCY
     I                                    P  15  220D#TAMT
      *                                       Rate and multi/div ind.
     I                                       23  23 I#MDIN
     I                                    P  24  368I#RATE
      *                            Output     Rate and multi/div ind.
      *                                       If no in rate
     I                                       37  37 O#MDIN
     I                                    P  38  508O#RATE
     I*                                                                   CEU006
     I/COPY FTCPYSRC,FT0010I001                                           CEU006
      **  Input/output parameters for call to FT0010.                     CEU006
     I*                                                                   S01494
     ISCSARD    E DSSCSARDPD                                              S01494
     I** External data structure for SAR file details                     S01494
     I*                                                                   S01494
     ISDGELR    E DSSDGELRPD                                              CEU006
     I** External data structure for General Ledger ICD details           CEU006
     ISDCURR    E DSSDCURRPD                                              CEU006
     I** External data structure for Currency details                     CEU006
     ISCCMT       DS                            256                                           CSC022
     I                                        1   30CMTNUM                                    CSC022
     I                                        4 103 CMTARR                                    CSC022
      /EJECT
      *****************************************************************
      *                 M A I N L I N E
      *****************************************************************
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q
     C                     MOVEL'MAIN'    @STK,Q
      *
      *  Define entry parameters
      *
     C           *ENTRY    PLIST
     C                     PARM           W0RTN   7
     C                     PARM           W0ACT   8
     C                     PARM           W0DATA
      *
      *  Set up primary reference
      *
     C                     MOVELW0DATA    W0PREF
      *
      * Initialise program
      *
     C           *IN50     IFEQ '0'
     C                     EXSR SRINIT
     C                     END
     C/COPY WNCPYSRC,FT0320C003
      *
      * Access CCY detail                                                 140624
     C           CEU006    IFEQ 'Y'                                       140624
     C                     EXSR CEUINI                                    140624
     C                     END                                            140624
      *                                                                   140624
      * Calculate default charges
      *
     C           W0ACT     CASEQ'OP'      SROTPY           Outgoing
     C           W0ACT     CASEQ'IN'      SRINPY           Incoming
     C           W0ACT     CASEQ'CP'      SRCP                            S01506
     C           W0ACT     CASEQ'CC'      SRCC                            S01506
     C                     CAS            SRACT
     C                     ENDCS
      *
      *
      *  Unwind subroutine stack name
      *
     C           EXMAIN    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
      *  Return to calling program
      *
     C                     RETRN
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRSET    : Set fields to default values                      *
      *                                                               *
      *  CALLED BY: Main processing                                   *
      *                                                               *
      *****************************************************************
     CSR         SRSET     BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SRSET '  @STK,Q
      *
      *  /Copy point for Outgoing Payments
      *
     C/COPY WNCPYSRC,FT0320SET
      *
      * Transfer and Commission
     C                     Z-ADD0         W0TRCD
     C                     Z-ADD0         W0TRCH
      *
      * Telex charge
     C                     Z-ADD0         W0TXCD
     C                     Z-ADD0         W0TXCH
      *
      * Cheque Charge
     C                     Z-ADD0         W0CQCD
     C                     Z-ADD0         W0CQCH
      *
      * Costs Abroad
     C                     Z-ADD0         W0CSTD
     C                     Z-ADD0         W0CSTA
      *
      * SWIFT Priority Charge
     C                     Z-ADD0         W0SPCD
     C                     Z-ADD0         W0SPCH
      *
      * Miscellaneous charge
     C                     Z-ADD0         W0MSCD
     C                     Z-ADD0         W0MSCH
      *
      * Advice Charge
     C                     Z-ADD0         W0ADCD
     C                     Z-ADD0         W0ADCH
      *
      * Telephone Charge
     C                     Z-ADD0         W0TLCD
     C                     Z-ADD0         W0TLCH
      *
      * Collection Charge
     C                     Z-ADD0         W0COLD
     C                     Z-ADD0         W0COLL
     C*                                                                   S01494
     C** FX/Change commission                                             S01494
     C*                                                                   S01494
     C                     Z-ADD0         W0FXCD                          S01494
     C                     Z-ADD0         W0FXCH                          S01494
     C*                                                                   S01494
     C** Our deduction                                                    S01494
     C*                                                                   S01494
     C                     Z-ADD0         W0DEDD                          S01494
     C                     Z-ADD0         W0DEDS                          S01494
     C*                                                                   S01494
     C** Correspondent charge                                             S01494
     C*                                                                   S01494
     C                     Z-ADD0         W0COCH                          S01494
     C                     Z-ADD0         W0COCC                          S01494
      *
      *  Get charge information from branch
      *
     C                     EXSR SRPYCH                                    S01506
     C*                                                                   S01506
     C***********W0BRCA    CHAINPYCHGDB              90    Get defaults.  S01506
     C***********                                                         S01506
     C***No*record*found***********************************************   S01506
     C***********                                                         S01506
     C************IN90     IFEQ '1'                                       S01506
     C***********          MOVEL'PYCHGDB 'W0FILE           ***************S01506
     C***********          MOVELPYBR      W0KEY            * DB ERROR 04 *S01506
     C***********          Z-ADD5         W0ERNB           ***************S01506
     C***********          MOVEL'MEM5004' W0MSGD                          S01506
     C***********          MOVEL'MIDAS  ' W0MSGF                          S01506
     C***********          EXSR SRERR                                     S01506
     C***********          END                                            S01506
      *
      *  Unwind subroutine stack name
      *
     C           EXSET     TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
     C/EJECT
     C*****************************************************************   S01506
     C*                                                               *   S01506
     C*  SRPYCH   : Obtain Payment Charge Defaults                    *   S01506
     C*                                                               *   S01506
     C*  CALLED BY: Main processing                                   *   S01506
     C*                                                               *   S01506
     C*****************************************************************   S01506
     CSR         SRPYCH    BEGSR                                          S01506
     C*                                                                   S01506
     C** Set up subroutine stack name                                     S01506
     C*                                                                   S01506
     C                     ADD  1         Q       50                      S01506
     C                     MOVEL'SRPYCH'  @STK,Q                          S01506
     C*                                                                   S01506
     C** /Copy point for Payment Charge Defaults                          S01506
     C*                                                                   S01506
     C/COPY WNCPYSRC,FT0320CCP1                                           S01506
     C*                                                                   S01506
     C** Declare key list for PYCHGL1                                     S01506
     C*                                                                   S01506
     C           PYKEY     KLIST                                          S01506
     C                     KFLD           PYBR                            S01506
     C                     KFLD           PYCNUM                          S01506
     C                     KFLD           PYPYTP                          S01506
     C                     KFLD           PYPYST                          S01506
     C                     KFLD           PYGPCD                          S01506
     C*                                                                   S01508
     C** Get customer market group details via SDCMRKL1                   S01508
     C*                                                                   S01508
     C           W0CUST    IFNE *BLANK                                    S01508
     C           W0CUST    CHAINSDCMRKL1             51                   S01508
     C                     END                                            S01508
     C*                                                                   S01508
     C                     Z-ADDL#        LTEMP   50                      S01508
     C                     Z-ADD1         S#      50                      S01508
     C*                                                                   S01508
     C           LTEMP     DOWGE1                                         S01508
     C*                                                                   S01508
     C           S#        OCUR SEARCH                                    S01508
     C*                                                                   S01508
     C                     SUB  1         LTEMP                           S01508
     C                     ADD  1         S#                              S01508
     C*                                                                   S01508
     C           S#CMGC    IFNE 'N'                                       S01508
     C           W0CUST    ANDEQ*BLANK                                    S01508
     C                     ITER                                           S01508
     C                     END                                            S01508
     C           S#CUST    IFEQ 'Y'                                       S01508
     C           W0CUST    ANDEQ*BLANK                                    S01508
     C                     ITER                                           S01508
     C                     END                                            S01508
     C*                                                                   S01508
     C                     MOVE *BLANK    PYBR                            S01508
     C                     MOVE *BLANK    PYCNUM                          S01508
     C                     MOVE *BLANK    PYPYTP                          S01508
     C                     MOVE *BLANK    PYPYST                          S01508
     C                     MOVE *BLANK    PYGPCD                          S01508
     C*                                                                   S01508
     C           S#BRCA    IFEQ 'Y'                                       S01508
     C                     MOVE W0BRCA    PYBR                            S01508
     C                     END                                            S01508
     C           S#CUST    IFEQ 'Y'                                       S01508
     C                     MOVE W0CUST    PYCNUM                          S01508
     C                     END                                            S01508
     C           S#PYTP    IFEQ 'Y'                                       S01508
     C                     MOVE W0PYTP    PYPYTP                          S01508
     C                     END                                            S01508
     C           S#PYST    IFEQ 'Y'                                       S01508
     C                     MOVE W0PYST    PYPYST                          S01508
     C                     END                                            S01508
     C*                                                                   S01508
     C           S#CMGC    IFEQ '1'                                       S01508
     C                     MOVE D7GPC1    PYGPCD                          S01508
     C                     END                                            S01508
     C           S#CMGC    IFEQ '2'                                       S01508
     C                     MOVE D7GPC2    PYGPCD                          S01508
     C                     END                                            S01508
     C           S#CMGC    IFEQ '3'                                       S01508
     C                     MOVE D7GPC3    PYGPCD                          S01508
     C                     END                                            S01508
     C           S#CMGC    IFEQ '4'                                       S01508
     C                     MOVE D7GPC4    PYGPCD                          S01508
     C                     END                                            S01508
     C           S#CMGC    IFEQ '5'                                       S01508
     C                     MOVE D7GPC5    PYGPCD                          S01508
     C                     END                                            S01508
     C*                                                                   S01508
     C           PYKEY     CHAINPYCHGL1              52                   S01508
     C           *IN52     IFEQ '0'                                       S01508
     C                     LEAVE                                          S01508
     C                     END                                            S01508
     C*                                                                   S01508
     C                     END                                            S01508
     C*                                                                   S01506
     C** Unwind subroutine stack name                                     S01506
     C*                                                                   S01506
     C           EXPYCH    TAG                                            S01506
     C                     MOVEA*BLANKS   @STK,Q                          S01506
     C                     SUB  1         Q                               S01506
     C*                                                                   S01506
     CSR                   ENDSR                                          S01506
     C/EJECT                                                              S01506
      *****************************************************************
      *                                                               *
      *  SROTPY   : FT Calculate Outgoing Payments Defaults           *
      *                                                               *
      *  CALLED BY: Main processing                                   *
      *                                                               *
      *****************************************************************
     CSR         SROTPY    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SROTPY'  @STK,Q
      *
      *  /Copy point for Outgoing Payments
      *
     C/COPY WNCPYSRC,FT0320OTPY
      *
      * Reset fields to zero
      *
     C                     EXSR SRSET                                     S01194
      *
      * Calculate Base currency equivalent
     C*                                                                   CEU006
     C           CEU006    IFEQ 'Y'                                       CEU006
     C*                                                                   CEU006
     C* If EMU FT Enhancement is switched on then call FT0010             CEU006
     C*                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE W0PCCY    P#FRCY                          CEU006
     C                     Z-ADDW0CAMT    P#FRAM                          CEU006
     C                     Z-ADDW0PVDT    P#FRDT                          CEU006
     C                     MOVE BJCYCD    P#TOCY                          CEU006
     C                     Z-ADDW0PVDT    P#TODT                          CEU006
     C                     EXSR SRFT10                                    CEU006
     C                     Z-ADDP#TOAM    W#AMT                           CEU006
     C*                                                                   CEU006
     C                     ELSE                                           CEU006
      *
     C                     CLEARD#DTA
     C                     MOVELW0PCCY    D#FCCY
     C                     MOVELBJCYCD    D#TCCY
     C                     Z-ADDW0CAMT    D#FAMT
      *
     C/COPY WNCPYSRC,FT0320C004
     C                     CALL 'AOCCYCV0'             9090
     C                     PARM *BLANKS   O#RTN   7
     C                     PARM '*F*T*SPT'W0ACT   8
     C           D#DTA     PARM D#DTA     O#DTA 256
     C/COPY WNCPYSRC,FT0320C005
      *
     C           *IN90     IFEQ '1'
     C           O#RTN     ORNE *BLANKS
     C                     MOVEL'*CALL   'W0FILE
     C                     MOVEL'AOCCYCV0'W0KEY
     C                     Z-ADD1         W0ERNB
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *
      * Set up work amount
      *
     C                     Z-ADDD#TAMT    W#AMT  150
     C*                                                                   CEU006
     C                     ENDIF                                          CEU006
      *
      * Set work rate to zero and calculated amount to zero
      *
     C                     Z-ADD0         W#AMTI 130
     C                     Z-ADD0         W#RATE 138
     C                     Z-ADD0         W#AMTC 130
      *
      * If EMU FT Enhancement is switched on then                         CEU006
      * save work date parameter for call to FT0010 as W#DT               CEU006
      *                                                                   CEU006
     C           CEU006    IFEQ 'Y'                                       CEU006
     C           *LIKE     DEFN W0SLDT    W#DT                            CEU006
     C           W0ADDC    IFEQ 'A'                                       CEU006
     C                     Z-ADDW0SLDT    W#DT                            CEU006
     C                     ELSE                                           CEU006
     C                     Z-ADDW0PVDT    W#DT                            CEU006
     C                     ENDIF                                          CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
      * Calculate transfer commission depending on tarriff code
      *
     C           W0TRCT    CASEQ'1'       SRTRF1
     C           W0TRCT    CASEQ'2'       SRTRF2
     C           W0TRCT    CASEQ'3'       SRTRF3
     C           W0TRCT    CASEQ'4'       SRTRF4
     C           W0TRCT    CASEQ'5'       SRTRF5
     C                     ENDCS
      *
      * If rate not zero then calculate amount
      *
     C           W#RATE    IFNE 0
     C           W#AMT     MULT W#RATE    W#AMTC    H
     C                     END
      *
      * If calculated amount is not zero convert to input ccy
      *
     C           W#AMTC    IFNE 0
      *
      * Calculate Base currency equivalent
      *
     C           CEU006    IFEQ 'Y'                                       CEU006
      *                                                                   CEU006
      * If EMU FT Enhancement is switched on then call FT0010             CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE BJCYCD    P#FRCY                          CEU006
     C                     Z-ADDW#AMTC    P#FRAM                          CEU006
     C                     Z-ADDW#DT      P#FRDT                          CEU006
     C                     MOVE W0ICCY    P#TOCY                          CEU006
     C                     Z-ADDW#DT      P#TODT                          CEU006
     C                     EXSR SRFT10                                    CEU006
     C                     Z-ADDP#TOAM    W0TRCD                          CEU006
     C                     ELSE                                           CEU006
     C*                                                                   CEU006
     C                     CLEARD#DTA
     C                     MOVELBJCYCD    D#FCCY
     C                     MOVELW0ICCY    D#TCCY
     C                     Z-ADDW#AMTC    D#FAMT
      *
     C/COPY WNCPYSRC,FT0320C006
     C                     CALL 'AOCCYCV0'             9090
     C                     PARM *BLANKS   O#RTN   7
     C                     PARM '*F*T*SPT'W0ACT   8
     C           D#DTA     PARM D#DTA     O#DTA 256
     C/COPY WNCPYSRC,FT0320C007
      *
     C           *IN90     IFEQ '1'
     C           O#RTN     ORNE *BLANKS
     C                     MOVEL'*CALL   'W0FILE
     C                     MOVEL'AOCCYCV0'W0KEY
     C                     Z-ADD1         W0ERNB
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *
      * Set up work amount
      *
     C                     Z-ADDD#TAMT    W0TRCD
     C*                                                                   CEU006
     C                     ENDIF                                          CEU006
      *
      * Calculate Base currency equivalent
      *
     C           CEU006    IFEQ 'Y'                                       CEU006
      *                                                                   CEU006
      * If EMU FT Enhancement is switched on then call FT0010             CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE BJCYCD    P#FRCY                          CEU006
     C                     Z-ADDW#AMTC    P#FRAM                          CEU006
     C                     Z-ADDW#DT      P#FRDT                          CEU006
     C                     MOVE W0CCCY    P#TOCY                          CEU006
     C                     Z-ADDW#DT      P#TODT                          CEU006
     C                     EXSR SRFT10                                    CEU006
     C                     Z-ADDP#TOAM    W0TRCH                          CEU006
     C                     ELSE                                           CEU006
     C*                                                                   CEU006
     C                     CLEARD#DTA
     C                     MOVELBJCYCD    D#FCCY
     C                     MOVELW0CCCY    D#TCCY
     C                     Z-ADDW#AMTC    D#FAMT
      *
     C/COPY WNCPYSRC,FT0320C008
     C                     CALL 'AOCCYCV0'             9090
     C                     PARM *BLANKS   O#RTN   7
     C                     PARM '*F*T*SPT'W0ACT   8
     C           D#DTA     PARM D#DTA     O#DTA 256
     C/COPY WNCPYSRC,FT0320C009
      *
     C           *IN90     IFEQ '1'
     C           O#RTN     ORNE *BLANKS
     C                     MOVEL'*CALL   'W0FILE
     C                     MOVEL'AOCCYCV0'W0KEY
     C                     Z-ADD1         W0ERNB
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *
      * Set up work amount
      *
     C                     Z-ADDD#TAMT    W0TRCH
     C*                                                                   CEU006
     C                     ENDIF                                          CEU006
      *
     C                     END
     C*                                                                   S01494
     C** If FX/change commission installed and other currency             S01494
     C**   not equal to payment amount currency ---                       S01494
     C*                                                                   S01494
     C           S01494    IFEQ 'S01494'                                  S01494
     C           W0OCCY    ANDNEW0PCCY                                    S01494
     C*                                                                   S01494
     C** Set work fields to 0                                             S01494
     C*                                                                   S01494
     C                     Z-ADD0         W#AMTI                          S01494
     C                     Z-ADD0         W#RATE                          S01494
     C                     Z-ADD0         W#AMTC                          S01494
     C*                                                                   S01494
     C* If EMU FT  Enhancement is switched on                             CEU006
     C*  and both Other Ccy and Pay Ccy are either 'In' or Euros,         CEU006
     C*  or Other Ccy is *** (ie. Charges To The Debit Of <>0)            CEU006
     C*  then FX/Change Commission must be zero.                          CEU006
     C*                                                                   CEU006
     C           CEU006    IFEQ 'Y'                                       CEU006
     C           #INCYO    ANDEQ'Y'                                       CEU006
     C           #TPSDO    ANDLEW#DT                                      CEU006
     C           W0PCCY    ANDEQBKEURO                                    CEU006
     C           CEU006    OREQ 'Y'                                       CEU006
     C           #INCYP    ANDEQ'Y'                                       CEU006
     C           #TPSDP    ANDLEW#DT                                      CEU006
     C           W0OCCY    ANDEQBKEURO                                    CEU006
     C           CEU006    OREQ 'Y'                                       CEU006
     C           #INCYO    ANDEQ'Y'                                       CEU006
     C           #TPSDO    ANDLEW#DT                                      CEU006
     C           #INCYP    ANDEQ'Y'                                       CEU006
     C           #TPSDP    ANDLEW#DT                                      CEU006
     C           CEU006    OREQ 'Y'                                       CEU006
     C           W0OCCY    ANDEQ'***'                                     CEU006
     C                     Z-ADD0         W0FXCD                          CEU006
     C                     Z-ADD0         W0FXCH                          CEU006
     C                     ELSE                                           CEU006
     C*                                                                   CEU006
     C           W0TRCT    CASEQ'3'       SRTR3C                          S01494
     C           W0TRCT    CASEQ'4'       SRTR4C                          S01494
     C                     ENDCS                                          S01494
     C*                                                                   S01494
     C** If rate not zero then calculate amount                           S01494
     C*                                                                   S01494
     C           W#RATE    IFNE 0                                         S01494
     C           W#AMT     MULT W#RATE    W#AMTC    H                     S01494
     C                     END                                            S01494
     C*                                                                   CEU006
     C                     ENDIF                                          CEU006
     C*                                                                   S01494
     C** If calculated amount is not 0,                                   S01494
     C**   convert to input and charge currency                           S01494
     C*                                                                   S01494
     C           W#AMTC    IFNE 0                                         S01494
     C*                                                                   S01494
     C** Calculate base currency equivalent                               S01494
     C*                                                                   S01494
     C           CEU006    IFEQ 'Y'                                       CEU006
      *                                                                   CEU006
      * If EMU FT Enhancement is switched on then call FT0010             CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE BJCYCD    P#FRCY                          CEU006
     C                     Z-ADDW#AMTC    P#FRAM                          CEU006
     C                     Z-ADDW#DT      P#FRDT                          CEU006
     C                     MOVE W0ICCY    P#TOCY                          CEU006
     C                     Z-ADDW#DT      P#TODT                          CEU006
     C                     EXSR SRFT10                                    CEU006
     C                     Z-ADDP#TOAM    W0FXCD                          CEU006
     C                     ELSE                                           CEU006
     C*                                                                   CEU006
     C                     CLEARD#DTA                                     S01494
     C                     MOVELBJCYCD    D#FCCY                          S01494
     C                     MOVELW0ICCY    D#TCCY                          S01494
     C                     Z-ADDW#AMTC    D#FAMT                          S01494
     C*                                                                   S01494
     C/COPY WNCPYSRC,FT0320C010
     C                     CALL 'AOCCYCV0'             9090               S01494
     C                     PARM *BLANKS   O#RTN   7                       S01494
     C                     PARM '*F*T*SPT'W0ACT   8                       S01494
     C           D#DTA     PARM D#DTA     O#DTA 256                       S01494
     C/COPY WNCPYSRC,FT0320C011
     C*                                                                   S01494
     C           *IN90     IFEQ '1'                                       S01494
     C           O#RTN     ORNE *BLANKS                                   S01494
     C                     MOVEL'*CALL   'W0FILE                          S01494
     C                     MOVEL'AOCCYCV0'W0KEY                           S01494
     C                     Z-ADD1         W0ERNB                          S01494
     C                     MOVEL'MEM5003' W0MSGD                          S01494
     C                     MOVEL'MIDAS  ' W0MSGF                          S01494
     C                     EXSR SRERR                                     S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C** Set up work amount                                               S01494
     C*                                                                   S01494
     C                     Z-ADDD#TAMT    W0FXCD                          S01494
     C*                                                                   CEU006
     C                     ENDIF                                          CEU006
     C*                                                                   S01494
     C** Calculate base currency equivalent                               S01494
     C*                                                                   S01494
     C           CEU006    IFEQ 'Y'                                       CEU006
      *                                                                   CEU006
      * If EMU FT Enhancement is switched on then call FT0010             CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE BJCYCD    P#FRCY                          CEU006
     C                     Z-ADDW#AMTC    P#FRAM                          CEU006
     C                     Z-ADDW#DT      P#FRDT                          CEU006
     C                     MOVE W0CCCY    P#TOCY                          CEU006
     C                     Z-ADDW#DT      P#TODT                          CEU006
     C                     EXSR SRFT10                                    CEU006
     C                     Z-ADDP#TOAM    W0FXCH                          CEU006
     C                     ELSE                                           CEU006
     C*                                                                   CEU006
     C                     CLEARD#DTA                                     S01494
     C                     MOVELBJCYCD    D#FCCY                          S01494
     C                     MOVELW0CCCY    D#TCCY                          S01494
     C                     Z-ADDW#AMTC    D#FAMT                          S01494
     C*                                                                   S01494
     C/COPY WNCPYSRC,FT0320C012
     C                     CALL 'AOCCYCV0'             9090               S01494
     C                     PARM *BLANKS   O#RTN   7                       S01494
     C                     PARM '*F*T*SPT'W0ACT   8                       S01494
     C           D#DTA     PARM D#DTA     O#DTA 256                       S01494
     C/COPY WNCPYSRC,FT0320C013
     C*                                                                   S01494
     C           *IN90     IFEQ '1'                                       S01494
     C           O#RTN     ORNE *BLANKS                                   S01494
     C                     MOVEL'*CALL   'W0FILE                          S01494
     C                     MOVEL'AOCCYCV0'W0KEY                           S01494
     C                     Z-ADD1         W0ERNB                          S01494
     C                     MOVEL'MEM5003' W0MSGD                          S01494
     C                     MOVEL'MIDAS  ' W0MSGF                          S01494
     C                     EXSR SRERR                                     S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C** Set up work amount                                               S01494
     C*                                                                   S01494
     C                     Z-ADDD#TAMT    W0FXCH                          S01494
     C*                                                                   CEU006
     C                     ENDIF                                          CEU006
     C*                                                                   S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C                     END                                            S01494
     C/COPY WNCPYSRC,FT0320C054
      *
      * If SWIFT priority set then calculate default
      *
     C           W0SWPC    IFEQ 'U'                                       054801
     C/COPY WNCPYSRC,FT0320C055
      *
      * Calculate Charge currency amount
      *                                                                   CEU006
     C           CEU006    IFEQ 'Y'                                       CEU006
      *                                                                   CEU006
      * If EMU FT Enhancement is switched on then call FT0010             CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE BJCYCD    P#FRCY                          CEU006
     C                     Z-ADDSPCH      P#FRAM                          CEU006
     C                     Z-ADDW#DT      P#FRDT                          CEU006
     C                     MOVE W0CCCY    P#TOCY                          CEU006
     C                     Z-ADDW#DT      P#TODT                          CEU006
     C                     EXSR SRFT10                                    CEU006
     C                     Z-ADDP#TOAM    W0SPCH                          CEU006
     C                     ELSE                                           CEU006
      *
     C                     CLEARD#DTA
     C                     MOVELBJCYCD    D#FCCY
     C                     MOVELW0CCCY    D#TCCY
     C                     Z-ADDSPCH      D#FAMT
      *
     C/COPY WNCPYSRC,FT0320C014
     C                     CALL 'AOCCYCV0'             9090
     C                     PARM *BLANKS   O#RTN   7
     C                     PARM '*F*T*SPT'W0ACT   8
     C           D#DTA     PARM D#DTA     O#DTA 256
     C/COPY WNCPYSRC,FT0320C015
      *
     C           *IN90     IFEQ '1'
     C           O#RTN     ORNE *BLANKS
     C                     MOVEL'*CALL   'W0FILE
     C                     MOVEL'AOCCYCV0'W0KEY
     C                     Z-ADD1         W0ERNB
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *
      * Set up work amount
      *
     C                     Z-ADDD#TAMT    W0SPCH
     C*                                                                   CEU006
     C                     ENDIF                                          CEU006
      *
      * Calculate input amount
      *
     C           CEU006    IFEQ 'Y'                                       CEU006
      *                                                                   CEU006
      * If EMU FT Enhancement is switched on then call FT0010             CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE BJCYCD    P#FRCY                          CEU006
     C                     Z-ADDSPCH      P#FRAM                          CEU006
     C                     Z-ADDW#DT      P#FRDT                          CEU006
     C                     MOVE W0ICCY    P#TOCY                          CEU006
     C                     Z-ADDW#DT      P#TODT                          CEU006
     C                     EXSR SRFT10                                    CEU006
     C                     Z-ADDP#TOAM    W0SPCD                          CEU006
     C                     ELSE                                           CEU006
     C*                                                                   CEU006
     C                     CLEARD#DTA
     C                     MOVELBJCYCD    D#FCCY
     C                     MOVELW0ICCY    D#TCCY
     C                     Z-ADDSPCH      D#FAMT
      *
     C/COPY WNCPYSRC,FT0320C016
     C                     CALL 'AOCCYCV0'             9090
     C                     PARM *BLANKS   O#RTN   7
     C                     PARM '*F*T*SPT'W0ACT   8
     C           D#DTA     PARM D#DTA     O#DTA 256
     C/COPY WNCPYSRC,FT0320C017
      *
     C           *IN90     IFEQ '1'
     C           O#RTN     ORNE *BLANKS
     C                     MOVEL'*CALL   'W0FILE
     C                     MOVEL'AOCCYCV0'W0KEY
     C                     Z-ADD1         W0ERNB
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *
      * Set up work amount
      *
     C                     Z-ADDD#TAMT    W0SPCD
     C*                                                                   CEU006
     C                     ENDIF                                          CEU006
      *
     C                     END                                            054801
      *
      * Default Cheque charge if settlement is 12 or 13                   054801
      *                                                                   054801
     C/COPY WNCPYSRC,FT0320C056
     C           W0STMT    IFEQ '12'
     C           W0STMT    OREQ '13'
      *
      * Calculate Charge currency amount
      *
     C           CEU006    IFEQ 'Y'                                       CEU006
      *                                                                   CEU006
      * If EMU FT Enhancement is switched on then call FT0010             CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE BJCYCD    P#FRCY                          CEU006
     C                     Z-ADDCQCH      P#FRAM                          CEU006
     C                     Z-ADDW#DT      P#FRDT                          CEU006
     C                     MOVE W0CCCY    P#TOCY                          CEU006
     C                     Z-ADDW#DT      P#TODT                          CEU006
     C                     EXSR SRFT10                                    CEU006
     C                     Z-ADDP#TOAM    W0CQCH                          CEU006
      *                                                                   CEU006
     C                     ELSE                                           CEU006
     C*                                                                   CEU006
     C                     CLEARD#DTA
     C                     MOVELBJCYCD    D#FCCY
     C                     MOVELW0CCCY    D#TCCY
     C                     Z-ADDCQCH      D#FAMT
      *
     C/COPY WNCPYSRC,FT0320C018
     C                     CALL 'AOCCYCV0'             9090
     C                     PARM *BLANKS   O#RTN   7
     C                     PARM '*F*T*SPT'W0ACT   8
     C           D#DTA     PARM D#DTA     O#DTA 256
     C/COPY WNCPYSRC,FT0320C019
      *
     C           *IN90     IFEQ '1'
     C           O#RTN     ORNE *BLANKS
     C                     MOVEL'*CALL   'W0FILE
     C                     MOVEL'AOCCYCV0'W0KEY
     C                     Z-ADD1         W0ERNB
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *
      * Set up work amount
      *
     C                     Z-ADDD#TAMT    W0CQCH
     C*                                                                   CEU006
     C                     ENDIF                                          CEU006
      *
      * Calculate input amount
      *
     C           CEU006    IFEQ 'Y'                                       CEU006
      *                                                                   CEU006
      * If EMU FT Enhancement is switched on then call FT0010             CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE BJCYCD    P#FRCY                          CEU006
     C                     Z-ADDCQCH      P#FRAM                          CEU006
     C                     Z-ADDW#DT      P#FRDT                          CEU006
     C                     MOVE W0ICCY    P#TOCY                          CEU006
     C                     Z-ADDW#DT      P#TODT                          CEU006
     C                     EXSR SRFT10                                    CEU006
     C                     Z-ADDP#TOAM    W0CQCD                          CEU006
      *                                                                   CEU006
     C                     ELSE                                           CEU006
     C*                                                                   CEU006
     C                     CLEARD#DTA
     C                     MOVELBJCYCD    D#FCCY
     C                     MOVELW0ICCY    D#TCCY
     C                     Z-ADDCQCH      D#FAMT
      *
     C/COPY WNCPYSRC,FT0320C020
     C                     CALL 'AOCCYCV0'             9090
     C                     PARM *BLANKS   O#RTN   7
     C                     PARM '*F*T*SPT'W0ACT   8
     C           D#DTA     PARM D#DTA     O#DTA 256
     C/COPY WNCPYSRC,FT0320C021
      *
     C           *IN90     IFEQ '1'
     C           O#RTN     ORNE *BLANKS
     C                     MOVEL'*CALL   'W0FILE
     C                     MOVEL'AOCCYCV0'W0KEY
     C                     Z-ADD1         W0ERNB
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *
      * Set up work amount
      *
     C                     Z-ADDD#TAMT    W0CQCD
     C*                                                                   CEU006
     C                     ENDIF                                          CEU006
      *
     C                     END                                            054801
      *
      *  Unwind subroutine stack name
      *
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0320CCP6                                           S01408
     C*                                                                   S01408
     C           EXOTPY    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRINPY   : FT Calculate Incoming Payments Defaults           *
      *                                                               *
      *  CALLED BY: Main processing                                   *
      *                                                               *
      *****************************************************************
     CSR         SRINPY    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SROTPY'  @STK,Q
      *
      *  /Copy point for Incoming Payments
      *
     C/COPY WNCPYSRC,FT0320INPY
      *
      * Reset fields to zero
      *
     C                     EXSR SRSET                                     S01194
      *
      * Calculate Base currency equivalent
     C*                                                                   CEU006
     C           CEU006    IFEQ 'Y'                                       CEU006
     C*                                                                   CEU006
     C* If EMU FT Enhancement is switched on then call FT0010             CEU006
     C*                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE W0PCCY    P#FRCY                          CEU006
     C                     Z-ADDW0CAMT    P#FRAM                          CEU006
     C                     Z-ADDW0PVDT    P#FRDT                          CEU006
     C                     MOVE BJCYCD    P#TOCY                          CEU006
     C                     Z-ADDW0PVDT    P#TODT                          CEU006
     C                     EXSR SRFT10                                    CEU006
     C                     Z-ADDP#TOAM    W#AMT                           CEU006
     C*                                                                   CEU006
     C                     ELSE                                           CEU006
      *
     C                     CLEARD#DTA
     C                     MOVELW0PCCY    D#FCCY
     C                     MOVELBJCYCD    D#TCCY
     C                     Z-ADDW0CAMT    D#FAMT
      *
     C/COPY WNCPYSRC,FT0320C022
     C                     CALL 'AOCCYCV0'             9090
     C                     PARM *BLANKS   O#RTN   7
     C                     PARM '*F*T*SPT'W0ACT   8
     C           D#DTA     PARM D#DTA     O#DTA 256
     C/COPY WNCPYSRC,FT0320C023
      *
     C           *IN90     IFEQ '1'
     C           O#RTN     ORNE *BLANKS
     C                     MOVEL'*CALL   'W0FILE
     C                     MOVEL'AOCCYCV0'W0KEY
     C                     Z-ADD1         W0ERNB
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *
      * Set up work amount
      *
     C                     Z-ADDD#TAMT    W#AMT  150
     C*                                                                   CEU006
     C                     ENDIF                                          CEU006
      *
      * Set work rate to zero and calculated amount to zero
      *
     C                     Z-ADD0         W#AMTI 130
     C                     Z-ADD0         W#RATE 138
     C                     Z-ADD0         W#AMTC 130
      *
      * If EMU FT Enhancement is switched on then                         CEU006
      * save work date parameter for call to FT0010 as W#DT               CEU006
      *                                                                   CEU006
     C           CEU006    IFEQ 'Y'                                       CEU006
     C           W0ADDC    IFEQ 'A'                                       CEU006
     C                     Z-ADDW0SLDT    W#DT                            CEU006
     C                     ELSE                                           CEU006
     C                     Z-ADDW0PVDT    W#DT                            CEU006
     C                     ENDIF                                          CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
      * Calculate transfer commission depending on tarriff code
      *
     C           W0TRCT    CASEQ'1'       SRTRF1
     C           W0TRCT    CASEQ'2'       SRTRF2
     C           W0TRCT    CASEQ'3'       SRTRF3
     C           W0TRCT    CASEQ'4'       SRTRF4
     C           W0TRCT    CASEQ'5'       SRTRF5
     C                     ENDCS
      *
      * If rate not zero then calculate amount
      *
     C           W#RATE    IFNE 0
     C           W#AMT     MULT W#RATE    W#AMTC    H
     C                     END
      *
      * If calculated amount is not zero convert to input ccy
      *
     C           W#AMTC    IFNE 0
      *
      * Calculate Base currency equivalent
      *
     C           CEU006    IFEQ 'Y'                                       CEU006
      *                                                                   CEU006
      * If EMU FT Enhancement is switched on then call FT0010             CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE BJCYCD    P#FRCY                          CEU006
     C                     Z-ADDW#AMTC    P#FRAM                          CEU006
     C                     Z-ADDW#DT      P#FRDT                          CEU006
     C                     MOVE W0ICCY    P#TOCY                          CEU006
     C                     Z-ADDW#DT      P#TODT                          CEU006
     C                     EXSR SRFT10                                    CEU006
     C                     Z-ADDP#TOAM    W0TRCD                          CEU006
     C                     ELSE                                           CEU006
     C*                                                                   CEU006
     C                     CLEARD#DTA
     C                     MOVELBJCYCD    D#FCCY
     C                     MOVELW0ICCY    D#TCCY
     C                     Z-ADDW#AMTC    D#FAMT
      *
     C/COPY WNCPYSRC,FT0320C024
     C                     CALL 'AOCCYCV0'             9090
     C                     PARM *BLANKS   O#RTN   7
     C                     PARM '*F*T*SPT'W0ACT   8
     C           D#DTA     PARM D#DTA     O#DTA 256
     C/COPY WNCPYSRC,FT0320C025
      *
     C           *IN90     IFEQ '1'
     C           O#RTN     ORNE *BLANKS
     C                     MOVEL'*CALL   'W0FILE
     C                     MOVEL'AOCCYCV0'W0KEY
     C                     Z-ADD1         W0ERNB
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *
      * Set up work amount
      *
     C                     Z-ADDD#TAMT    W0TRCD
     C*                                                                   CEU006
     C                     ENDIF                                          CEU006
      *
      * Calculate Base currency equivalent
      *
     C           CEU006    IFEQ 'Y'                                       CEU006
      *                                                                   CEU006
      * If EMU FT Enhancement is switched on then call FT0010             CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE BJCYCD    P#FRCY                          CEU006
     C                     Z-ADDW#AMTC    P#FRAM                          CEU006
     C                     Z-ADDW#DT      P#FRDT                          CEU006
     C                     MOVE W0CCCY    P#TOCY                          CEU006
     C                     Z-ADDW#DT      P#TODT                          CEU006
     C                     EXSR SRFT10                                    CEU006
     C                     Z-ADDP#TOAM    W0TRCH                          CEU006
     C                     ELSE                                           CEU006
     C*                                                                   CEU006
     C                     CLEARD#DTA
     C                     MOVELBJCYCD    D#FCCY
     C                     MOVELW0CCCY    D#TCCY
     C                     Z-ADDW#AMTC    D#FAMT
      *
     C/COPY WNCPYSRC,FT0320C026
     C                     CALL 'AOCCYCV0'             9090
     C                     PARM *BLANKS   O#RTN   7
     C                     PARM '*F*T*SPT'W0ACT   8
     C           D#DTA     PARM D#DTA     O#DTA 256
     C/COPY WNCPYSRC,FT0320C027
      *
     C           *IN90     IFEQ '1'
     C           O#RTN     ORNE *BLANKS
     C                     MOVEL'*CALL   'W0FILE
     C                     MOVEL'AOCCYCV0'W0KEY
     C                     Z-ADD1         W0ERNB
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *
      * Set up work amount
      *
     C                     Z-ADDD#TAMT    W0TRCH
     C*                                                                   CEU006
     C                     ENDIF                                          CEU006
      *
     C                     END
     C*                                                                   S01494
     C** If FX/change commission installed and other currency             S01494
     C**   not equal to payment amount currency ---                       S01494
     C*                                                                   S01494
     C           S01494    IFEQ 'S01494'                                  S01494
     C           W0OCCY    ANDNEW0PCCY                                    S01494
     C*                                                                   S01494
     C** Set work fields to 0                                             S01494
     C*                                                                   S01494
     C                     Z-ADD0         W#AMTI                          S01494
     C                     Z-ADD0         W#RATE                          S01494
     C                     Z-ADD0         W#AMTC                          S01494
     C*                                                                   S01494
     C* If EMU FT  Enhancement is switched on                             CEU006
     C*  and both Other Ccy and Pay Ccy are either 'In' or Euros,         CEU006
     C*  or Other Ccy is *** (ie. Charges To The Debit Of <>0)            CEU006
     C*  then FX/Change Commission must be zero.                          CEU006
     C*                                                                   CEU006
     C           CEU006    IFEQ 'Y'                                       CEU006
     C           #INCYO    ANDEQ'Y'                                       CEU006
     C           #TPSDO    ANDLEW#DT                                      CEU006
     C           W0PCCY    ANDEQBKEURO                                    CEU006
     C           CEU006    OREQ 'Y'                                       CEU006
     C           #INCYP    ANDEQ'Y'                                       CEU006
     C           #TPSDP    ANDLEW#DT                                      CEU006
     C           W0OCCY    ANDEQBKEURO                                    CEU006
     C           CEU006    OREQ 'Y'                                       CEU006
     C           #INCYO    ANDEQ'Y'                                       CEU006
     C           #TPSDO    ANDLEW#DT                                      CEU006
     C           #INCYP    ANDEQ'Y'                                       CEU006
     C           #TPSDP    ANDLEW#DT                                      CEU006
     C           CEU006    OREQ 'Y'                                       CEU006
     C           W0OCCY    ANDEQ'***'                                     CEU006
     C                     Z-ADD0         W0FXCD                          CEU006
     C                     Z-ADD0         W0FXCH                          CEU006
     C                     ELSE                                           CEU006
     C*                                                                   CEU006
     C           W0TRCT    CASEQ'3'       SRTR3C                          S01494
     C           W0TRCT    CASEQ'4'       SRTR4C                          S01494
     C                     ENDCS                                          S01494
     C*                                                                   S01494
     C** If rate not zero then calculate amount                           S01494
     C*                                                                   S01494
     C           W#RATE    IFNE 0                                         S01494
     C           W#AMT     MULT W#RATE    W#AMTC    H                     S01494
     C                     END                                            S01494
     C*                                                                   CEU006
     C                     ENDIF                                          CEU006
     C*                                                                   S01494
     C** If calculated amount is not 0,                                   S01494
     C**   convert to input and charge currency                           S01494
     C*                                                                   S01494
     C           W#AMTC    IFNE 0                                         S01494
     C*                                                                   S01494
     C** Calculate base currency equivalent                               S01494
     C*                                                                   S01494
     C           CEU006    IFEQ 'Y'                                       CEU006
      *                                                                   CEU006
      * If EMU FT Enhancement is switched on then call FT0010             CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE BJCYCD    P#FRCY                          CEU006
     C                     Z-ADDW#AMTC    P#FRAM                          CEU006
     C                     Z-ADDW#DT      P#FRDT                          CEU006
     C                     MOVE W0ICCY    P#TOCY                          CEU006
     C                     Z-ADDW#DT      P#TODT                          CEU006
     C                     EXSR SRFT10                                    CEU006
     C                     Z-ADDP#TOAM    W0FXCD                          CEU006
     C                     ELSE                                           CEU006
     C*                                                                   CEU006
     C                     CLEARD#DTA                                     S01494
     C                     MOVELBJCYCD    D#FCCY                          S01494
     C                     MOVELW0ICCY    D#TCCY                          S01494
     C                     Z-ADDW#AMTC    D#FAMT                          S01494
     C*                                                                   S01494
     C/COPY WNCPYSRC,FT0320C028
     C                     CALL 'AOCCYCV0'             9090               S01494
     C                     PARM *BLANKS   O#RTN   7                       S01494
     C                     PARM '*F*T*SPT'W0ACT   8                       S01494
     C           D#DTA     PARM D#DTA     O#DTA 256                       S01494
     C/COPY WNCPYSRC,FT0320C029
     C*                                                                   S01494
     C           *IN90     IFEQ '1'                                       S01494
     C           O#RTN     ORNE *BLANKS                                   S01494
     C                     MOVEL'*CALL   'W0FILE                          S01494
     C                     MOVEL'AOCCYCV0'W0KEY                           S01494
     C                     Z-ADD1         W0ERNB                          S01494
     C                     MOVEL'MEM5003' W0MSGD                          S01494
     C                     MOVEL'MIDAS  ' W0MSGF                          S01494
     C                     EXSR SRERR                                     S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C** Set up work amount                                               S01494
     C*                                                                   S01494
     C                     Z-ADDD#TAMT    W0FXCD                          S01494
     C*                                                                   CEU006
     C                     ENDIF                                          CEU006
     C*                                                                   S01494
     C** Calculate base currency equivalent                               S01494
     C*                                                                   S01494
     C           CEU006    IFEQ 'Y'                                       CEU006
      *                                                                   CEU006
      * If EMU FT Enhancement is switched on then call FT0010             CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE BJCYCD    P#FRCY                          CEU006
     C                     Z-ADDW#AMTC    P#FRAM                          CEU006
     C                     Z-ADDW#DT      P#FRDT                          CEU006
     C                     MOVE W0CCCY    P#TOCY                          CEU006
     C                     Z-ADDW#DT      P#TODT                          CEU006
     C                     EXSR SRFT10                                    CEU006
     C                     Z-ADDP#TOAM    W0FXCH                          CEU006
     C                     ELSE                                           CEU006
     C*                                                                   CEU006
     C                     CLEARD#DTA                                     S01494
     C                     MOVELBJCYCD    D#FCCY                          S01494
     C                     MOVELW0CCCY    D#TCCY                          S01494
     C                     Z-ADDW#AMTC    D#FAMT                          S01494
     C*                                                                   S01494
     C/COPY WNCPYSRC,FT0320C030
     C                     CALL 'AOCCYCV0'             9090               S01494
     C                     PARM *BLANKS   O#RTN   7                       S01494
     C                     PARM '*F*T*SPT'W0ACT   8                       S01494
     C           D#DTA     PARM D#DTA     O#DTA 256                       S01494
     C/COPY WNCPYSRC,FT0320C031
     C*                                                                   S01494
     C           *IN90     IFEQ '1'                                       S01494
     C           O#RTN     ORNE *BLANKS                                   S01494
     C                     MOVEL'*CALL   'W0FILE                          S01494
     C                     MOVEL'AOCCYCV0'W0KEY                           S01494
     C                     Z-ADD1         W0ERNB                          S01494
     C                     MOVEL'MEM5003' W0MSGD                          S01494
     C                     MOVEL'MIDAS  ' W0MSGF                          S01494
     C                     EXSR SRERR                                     S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C** Set up work amount                                               S01494
     C*                                                                   S01494
     C                     Z-ADDD#TAMT    W0FXCH                          S01494
     C*                                                                   CEU006
     C                     ENDIF                                          CEU006
     C*                                                                   S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C                     END                                            S01494
      *
      *  Unwind subroutine stack name
      *
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0320CCP7                                           S01408
     C*                                                                   S01408
     C           EXINPY    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
     C/EJECT
     C*****************************************************************   S01506
     C*                                                               *   S01506
     C*  SRCP     : FT Calculate Cheques to be Paid Defaults          *   S01506
     C*                                                               *   S01506
     C*  CALLED BY: Main processing                                   *   S01506
     C*                                                               *   S01506
     C*****************************************************************   S01506
     CSR         SRCP      BEGSR                                          S01506
     C*                                                                   S01506
     C** Set up subroutine stack name                                     S01506
     C*                                                                   S01506
     C                     ADD  1         Q       50                      S01506
     C                     MOVEL'SRCP  '  @STK,Q                          S01506
     C*                                                                   S01506
     C** /Copy point for Cheques to be Paid                               S01506
     C*                                                                   S01506
     C/COPY WNCPYSRC,FT0320CCP2                                           S01506
     C*                                                                   S01506
     C** Reset fields to zero                                             S01506
     C*                                                                   S01506
     C                     EXSR SRSET                                     S01506
     C*                                                                   S01506
     C** Calculate Base currency equivalent                               S01506
     C*                                                                   CEU006
     C           CEU006    IFEQ 'Y'                                       CEU006
     C*                                                                   CEU006
     C* If EMU FT Enhancement is switched on then call FT0010             CEU006
     C*                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE W0PCCY    P#FRCY                          CEU006
     C                     Z-ADDW0CAMT    P#FRAM                          CEU006
     C                     Z-ADDW0PVDT    P#FRDT                          CEU006
     C                     MOVE BJCYCD    P#TOCY                          CEU006
     C                     Z-ADDW0PVDT    P#TODT                          CEU006
     C                     EXSR SRFT10                                    CEU006
     C                     Z-ADDP#TOAM    W#AMT                           CEU006
     C*                                                                   CEU006
     C                     ELSE                                           CEU006
     C*                                                                   S01506
     C                     CLEARD#DTA                                     S01506
     C                     MOVELW0PCCY    D#FCCY                          S01506
     C                     MOVELBJCYCD    D#TCCY                          S01506
     C                     Z-ADDW0CAMT    D#FAMT                          S01506
     C*                                                                   S01506
     C/COPY WNCPYSRC,FT0320C032
     C                     CALL 'AOCCYCV0'             9090               S01506
     C                     PARM *BLANKS   O#RTN   7                       S01506
     C                     PARM '*F*T*SPT'W0ACT   8                       S01506
     C           D#DTA     PARM D#DTA     O#DTA 256                       S01506
     C/COPY WNCPYSRC,FT0320C033
     C*                                                                   S01506
     C           *IN90     IFEQ '1'                                       S01506
     C           O#RTN     ORNE *BLANKS                                   S01506
     C                     MOVEL'*CALL   'W0FILE                          S01506
     C                     MOVEL'AOCCYCV0'W0KEY                           S01506
     C                     Z-ADD1         W0ERNB                          S01506
     C                     MOVEL'MEM5003' W0MSGD                          S01506
     C                     MOVEL'MIDAS  ' W0MSGF                          S01506
     C                     EXSR SRERR                                     S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C** Set up work amount                                               S01506
     C*                                                                   S01506
     C                     Z-ADDD#TAMT    W#AMT  150                      S01506
     C*                                                                   CEU006
     C                     ENDIF                                          CEU006
     C*                                                                   S01506
     C** Set work rate to zero and calculated amount to zero              S01506
     C*                                                                   S01506
     C                     Z-ADD0         W#AMTI 130                      S01506
     C                     Z-ADD0         W#RATE 138                      S01506
     C                     Z-ADD0         W#AMTC 130                      S01506
     C*                                                                   S01506
      * If EMU FT Enhancement is switched on then save Settlement Date    CEU006
      * as work date parameter W#DT for call to FT0010.                   CEU006
      *                                                                   CEU006
     C           CEU006    IFEQ 'Y'                                       CEU006
     C                     Z-ADDW0SLDT    W#DT                            CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
     C** Calculate transfer commission depending on tarriff code          S01506
     C*                                                                   S01506
     C           W0TRCT    CASEQ'1'       SRTRF1                          S01506
     C           W0TRCT    CASEQ'2'       SRTRF2                          S01506
     C           W0TRCT    CASEQ'3'       SRTRF3                          S01506
     C           W0TRCT    CASEQ'4'       SRTRF4                          S01506
     C           W0TRCT    CASEQ'5'       SRTRF5                          S01506
     C                     ENDCS                                          S01506
     C*                                                                   S01506
     C** If rate not zero then calculate amount                           S01506
     C*                                                                   S01506
     C           W#RATE    IFNE 0                                         S01506
     C           W#AMT     MULT W#RATE    W#AMTC    H                     S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C** If calculated amount is not zero convert to input ccy            S01506
     C*                                                                   S01506
     C           W#AMTC    IFNE 0                                         S01506
     C*                                                                   S01506
     C** Calculate Base currency equivalent                               S01506
     C*                                                                   S01506
     C           CEU006    IFEQ 'Y'                                       CEU006
      *                                                                   CEU006
      * If EMU FT Enhancement is switched on then call FT0010             CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE BJCYCD    P#FRCY                          CEU006
     C                     Z-ADDW#AMTC    P#FRAM                          CEU006
     C                     Z-ADDW#DT      P#FRDT                          CEU006
     C                     MOVE W0ICCY    P#TOCY                          CEU006
     C                     Z-ADDW#DT      P#TODT                          CEU006
     C                     EXSR SRFT10                                    CEU006
     C                     Z-ADDP#TOAM    W0TRCD                          CEU006
     C                     ELSE                                           CEU006
     C*                                                                   CEU006
     C                     CLEARD#DTA                                     S01506
     C                     MOVELBJCYCD    D#FCCY                          S01506
     C                     MOVELW0ICCY    D#TCCY                          S01506
     C                     Z-ADDW#AMTC    D#FAMT                          S01506
     C*                                                                   S01506
     C/COPY WNCPYSRC,FT0320C034
     C                     CALL 'AOCCYCV0'             9090               S01506
     C                     PARM *BLANKS   O#RTN   7                       S01506
     C                     PARM '*F*T*SPT'W0ACT   8                       S01506
     C           D#DTA     PARM D#DTA     O#DTA 256                       S01506
     C/COPY WNCPYSRC,FT0320C035
     C*                                                                   S01506
     C           *IN90     IFEQ '1'                                       S01506
     C           O#RTN     ORNE *BLANKS                                   S01506
     C                     MOVEL'*CALL   'W0FILE                          S01506
     C                     MOVEL'AOCCYCV0'W0KEY                           S01506
     C                     Z-ADD1         W0ERNB                          S01506
     C                     MOVEL'MEM5003' W0MSGD                          S01506
     C                     MOVEL'MIDAS  ' W0MSGF                          S01506
     C                     EXSR SRERR                                     S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C** Set up work amount                                               S01506
     C*                                                                   S01506
     C                     Z-ADDD#TAMT    W0TRCD                          S01506
     C*                                                                   CEU006
     C                     ENDIF                                          CEU006
     C*                                                                   S01506
     C** Calculate Base currency equivalent                               S01506
     C*                                                                   S01506
     C           CEU006    IFEQ 'Y'                                       CEU006
      *                                                                   CEU006
      * If EMU FT Enhancement is switched on then call FT0010             CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE BJCYCD    P#FRCY                          CEU006
     C                     Z-ADDW#AMTC    P#FRAM                          CEU006
     C                     Z-ADDW#DT      P#FRDT                          CEU006
     C                     MOVE W0CCCY    P#TOCY                          CEU006
     C                     Z-ADDW#DT      P#TODT                          CEU006
     C                     EXSR SRFT10                                    CEU006
     C                     Z-ADDP#TOAM    W0TRCH                          CEU006
     C                     ELSE                                           CEU006
     C*                                                                   CEU006
     C                     CLEARD#DTA                                     S01506
     C                     MOVELBJCYCD    D#FCCY                          S01506
     C                     MOVELW0CCCY    D#TCCY                          S01506
     C                     Z-ADDW#AMTC    D#FAMT                          S01506
     C*                                                                   S01506
     C/COPY WNCPYSRC,FT0320C036
     C                     CALL 'AOCCYCV0'             9090               S01506
     C                     PARM *BLANKS   O#RTN   7                       S01506
     C                     PARM '*F*T*SPT'W0ACT   8                       S01506
     C           D#DTA     PARM D#DTA     O#DTA 256                       S01506
     C/COPY WNCPYSRC,FT0320C037
     C*                                                                   S01506
     C           *IN90     IFEQ '1'                                       S01506
     C           O#RTN     ORNE *BLANKS                                   S01506
     C                     MOVEL'*CALL   'W0FILE                          S01506
     C                     MOVEL'AOCCYCV0'W0KEY                           S01506
     C                     Z-ADD1         W0ERNB                          S01506
     C                     MOVEL'MEM5003' W0MSGD                          S01506
     C                     MOVEL'MIDAS  ' W0MSGF                          S01506
     C                     EXSR SRERR                                     S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C** Set up work amount                                               S01506
     C*                                                                   S01506
     C                     Z-ADDD#TAMT    W0TRCH                          S01506
     C*                                                                   CEU006
     C                     ENDIF                                          CEU006
     C*                                                                   S01506
     C                     END                                            S01506
     C*                                                                   S01494
     C** If FX/change commission installed and other currency             S01494
     C**   not equal to payment amount currency ---                       S01494
     C*                                                                   S01494
     C           S01494    IFEQ 'S01494'                                  S01494
     C           W0OCCY    ANDNEW0PCCY                                    S01494
     C*                                                                   S01494
     C** Set work fields to 0                                             S01494
     C*                                                                   S01494
     C                     Z-ADD0         W#AMTI                          S01494
     C                     Z-ADD0         W#RATE                          S01494
     C                     Z-ADD0         W#AMTC                          S01494
     C*                                                                   S01494
     C* If EMU FT  Enhancement is switched on                             CEU006
     C*  and both Other Ccy and Pay Ccy are either 'In' or Euros,         CEU006
     C*  or Other Ccy is *** (ie. Charges To The Debit Of <>0)            CEU006
     C*  then FX/Change Commission must be zero.                          CEU006
     C*                                                                   CEU006
     C           CEU006    IFEQ 'Y'                                       CEU006
     C           #INCYO    ANDEQ'Y'                                       CEU006
     C           #TPSDO    ANDLEW#DT                                      CEU006
     C           W0PCCY    ANDEQBKEURO                                    CEU006
     C           CEU006    OREQ 'Y'                                       CEU006
     C           #INCYP    ANDEQ'Y'                                       CEU006
     C           #TPSDP    ANDLEW#DT                                      CEU006
     C           W0OCCY    ANDEQBKEURO                                    CEU006
     C           CEU006    OREQ 'Y'                                       CEU006
     C           #INCYO    ANDEQ'Y'                                       CEU006
     C           #TPSDO    ANDLEW#DT                                      CEU006
     C           #INCYP    ANDEQ'Y'                                       CEU006
     C           #TPSDP    ANDLEW#DT                                      CEU006
     C           CEU006    OREQ 'Y'                                       CEU006
     C           W0OCCY    ANDEQ'***'                                     CEU006
     C                     Z-ADD0         W0FXCD                          CEU006
     C                     Z-ADD0         W0FXCH                          CEU006
     C                     ELSE                                           CEU006
     C*                                                                   CEU006
     C           W0TRCT    CASEQ'3'       SRTR3C                          S01494
     C           W0TRCT    CASEQ'4'       SRTR4C                          S01494
     C                     ENDCS                                          S01494
     C*                                                                   S01494
     C** If rate not zero then calculate amount                           S01494
     C*                                                                   S01494
     C           W#RATE    IFNE 0                                         S01494
     C           W#AMT     MULT W#RATE    W#AMTC    H                     S01494
     C                     END                                            S01494
     C*                                                                   CEU006
     C                     ENDIF                                          CEU006
     C*                                                                   S01494
     C** If calculated amount is not 0,                                   S01494
     C**   convert to input and charge currency                           S01494
     C*                                                                   S01494
     C           W#AMTC    IFNE 0                                         S01494
     C*                                                                   S01494
     C** Calculate base currency equivalent                               S01494
     C*                                                                   S01494
     C           CEU006    IFEQ 'Y'                                       CEU006
      *                                                                   CEU006
      * If EMU FT Enhancement is switched on then call FT0010             CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE BJCYCD    P#FRCY                          CEU006
     C                     Z-ADDW#AMTC    P#FRAM                          CEU006
     C                     Z-ADDW#DT      P#FRDT                          CEU006
     C                     MOVE W0ICCY    P#TOCY                          CEU006
     C                     Z-ADDW#DT      P#TODT                          CEU006
     C                     EXSR SRFT10                                    CEU006
     C                     Z-ADDP#TOAM    W0FXCD                          CEU006
     C                     ELSE                                           CEU006
     C*                                                                   CEU006
     C                     CLEARD#DTA                                     S01494
     C                     MOVELBJCYCD    D#FCCY                          S01494
     C                     MOVELW0ICCY    D#TCCY                          S01494
     C                     Z-ADDW#AMTC    D#FAMT                          S01494
     C*                                                                   S01494
     C/COPY WNCPYSRC,FT0320C038
     C                     CALL 'AOCCYCV0'             9090               S01494
     C                     PARM *BLANKS   O#RTN   7                       S01494
     C                     PARM '*F*T*SPT'W0ACT   8                       S01494
     C           D#DTA     PARM D#DTA     O#DTA 256                       S01494
     C/COPY WNCPYSRC,FT0320C039
     C*                                                                   S01494
     C           *IN90     IFEQ '1'                                       S01494
     C           O#RTN     ORNE *BLANKS                                   S01494
     C                     MOVEL'*CALL   'W0FILE                          S01494
     C                     MOVEL'AOCCYCV0'W0KEY                           S01494
     C                     Z-ADD1         W0ERNB                          S01494
     C                     MOVEL'MEM5003' W0MSGD                          S01494
     C                     MOVEL'MIDAS  ' W0MSGF                          S01494
     C                     EXSR SRERR                                     S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C** Set up work amount                                               S01494
     C*                                                                   S01494
     C                     Z-ADDD#TAMT    W0FXCD                          S01494
     C*                                                                   CEU006
     C                     ENDIF                                          CEU006
     C*                                                                   S01494
     C** Calculate base currency equivalent                               S01494
     C*                                                                   S01494
     C           CEU006    IFEQ 'Y'                                       CEU006
      *                                                                   CEU006
      * If EMU FT Enhancement is switched on then call FT0010             CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE BJCYCD    P#FRCY                          CEU006
     C                     Z-ADDW#AMTC    P#FRAM                          CEU006
     C                     Z-ADDW#DT      P#FRDT                          CEU006
     C                     MOVE W0CCCY    P#TOCY                          CEU006
     C                     Z-ADDW#DT      P#TODT                          CEU006
     C                     EXSR SRFT10                                    CEU006
     C                     Z-ADDP#TOAM    W0FXCH                          CEU006
     C                     ELSE                                           CEU006
     C*                                                                   CEU006
     C                     CLEARD#DTA                                     S01494
     C                     MOVELBJCYCD    D#FCCY                          S01494
     C                     MOVELW0CCCY    D#TCCY                          S01494
     C                     Z-ADDW#AMTC    D#FAMT                          S01494
     C*                                                                   S01494
     C/COPY WNCPYSRC,FT0320C040
     C                     CALL 'AOCCYCV0'             9090               S01494
     C                     PARM *BLANKS   O#RTN   7                       S01494
     C                     PARM '*F*T*SPT'W0ACT   8                       S01494
     C           D#DTA     PARM D#DTA     O#DTA 256                       S01494
     C/COPY WNCPYSRC,FT0320C041
     C*                                                                   S01494
     C           *IN90     IFEQ '1'                                       S01494
     C           O#RTN     ORNE *BLANKS                                   S01494
     C                     MOVEL'*CALL   'W0FILE                          S01494
     C                     MOVEL'AOCCYCV0'W0KEY                           S01494
     C                     Z-ADD1         W0ERNB                          S01494
     C                     MOVEL'MEM5003' W0MSGD                          S01494
     C                     MOVEL'MIDAS  ' W0MSGF                          S01494
     C                     EXSR SRERR                                     S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C** Set up work amount                                               S01494
     C*                                                                   S01494
     C                     Z-ADDD#TAMT    W0FXCH                          S01494
     C*                                                                   CEU006
     C                     ENDIF                                          CEU006
     C*                                                                   S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C                     END                                            S01494
     C*                                                                   S01506
     C** Unwind subroutine stack name                                     S01506
     C*                                                                   S01506
     C           EXSRCP    TAG                                            S01506
     C                     MOVEA*BLANKS   @STK,Q                          S01506
     C                     SUB  1         Q                               S01506
     C*                                                                   S01506
     CSR                   ENDSR                                          S01506
     C/EJECT                                                              S01506
     C*****************************************************************   S01506
     C*                                                               *   S01506
     C*  SRCC     : FT Calculate Cheques for Collection Defaults      *   S01506
     C*                                                               *   S01506
     C*  CALLED BY: Main processing                                   *   S01506
     C*                                                               *   S01506
     C*****************************************************************   S01506
     CSR         SRCC      BEGSR                                          S01506
     C*                                                                   S01506
     C** Set up subroutine stack name                                     S01506
     C*                                                                   S01506
     C                     ADD  1         Q       50                      S01506
     C                     MOVEL'SRCC  '  @STK,Q                          S01506
     C*                                                                   S01506
     C** /Copy point for Cheques for Collection                           S01506
     C*                                                                   S01506
     C/COPY WNCPYSRC,FT0320CCP3                                           S01506
     C*                                                                   S01506
     C** Reset fields to zero                                             S01506
     C*                                                                   S01506
     C                     EXSR SRSET                                     S01506
     C*                                                                   S01506
     C** Calculate Base currency equivalent                               S01506
     C*                                                                   CEU006
     C           CEU006    IFEQ 'Y'                                       CEU006
     C*                                                                   CEU006
     C* If EMU FT Enhancement is switched on then call FT0010             CEU006
     C*                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE W0PCCY    P#FRCY                          CEU006
     C                     Z-ADDW0CAMT    P#FRAM                          CEU006
     C                     Z-ADDW0PVDT    P#FRDT                          CEU006
     C                     MOVE BJCYCD    P#TOCY                          CEU006
     C                     Z-ADDW0PVDT    P#TODT                          CEU006
     C                     EXSR SRFT10                                    CEU006
     C                     Z-ADDP#TOAM    W#AMT                           CEU006
     C*                                                                   CEU006
     C                     ELSE                                           CEU006
     C*                                                                   S01506
     C                     CLEARD#DTA                                     S01506
     C                     MOVELW0PCCY    D#FCCY                          S01506
     C                     MOVELBJCYCD    D#TCCY                          S01506
     C                     Z-ADDW0CAMT    D#FAMT                          S01506
     C*                                                                   S01506
     C/COPY WNCPYSRC,FT0320C042
     C                     CALL 'AOCCYCV0'             9090               S01506
     C                     PARM *BLANKS   O#RTN   7                       S01506
     C                     PARM '*F*T*SPT'W0ACT   8                       S01506
     C           D#DTA     PARM D#DTA     O#DTA 256                       S01506
     C/COPY WNCPYSRC,FT0320C043
     C*                                                                   S01506
     C           *IN90     IFEQ '1'                                       S01506
     C           O#RTN     ORNE *BLANKS                                   S01506
     C                     MOVEL'*CALL   'W0FILE                          S01506
     C                     MOVEL'AOCCYCV0'W0KEY                           S01506
     C                     Z-ADD1         W0ERNB                          S01506
     C                     MOVEL'MEM5003' W0MSGD                          S01506
     C                     MOVEL'MIDAS  ' W0MSGF                          S01506
     C                     EXSR SRERR                                     S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C** Set up work amount                                               S01506
     C*                                                                   S01506
     C                     Z-ADDD#TAMT    W#AMT  150                      S01506
     C*                                                                   CEU006
     C                     ENDIF                                          CEU006
     C*                                                                   S01506
     C** Set work rate to zero and calculated amount to zero              S01506
     C*                                                                   S01506
     C                     Z-ADD0         W#AMTI 130                      S01506
     C                     Z-ADD0         W#RATE 138                      S01506
     C                     Z-ADD0         W#AMTC 130                      S01506
     C*                                                                   S01506
      * If EMU FT Enhancement is switched on then save Credit Value Date  CEU006
      * as work date parameter W#DT for call to FT0010.                   CEU006
      *                                                                   CEU006
     C           CEU006    IFEQ 'Y'                                       CEU006
     C                     Z-ADDW0PVDT    W#DT                            CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
     C** Calculate transfer commission depending on tarriff code          S01506
     C*                                                                   S01506
     C           W0TRCT    CASEQ'1'       SRTRF1                          S01506
     C           W0TRCT    CASEQ'2'       SRTRF2                          S01506
     C           W0TRCT    CASEQ'3'       SRTRF3                          S01506
     C           W0TRCT    CASEQ'4'       SRTRF4                          S01506
     C           W0TRCT    CASEQ'5'       SRTRF5                          S01506
     C                     ENDCS                                          S01506
     C*                                                                   S01506
     C** If rate not zero then calculate amount                           S01506
     C*                                                                   S01506
     C           W#RATE    IFNE 0                                         S01506
     C           W#AMT     MULT W#RATE    W#AMTC    H                     S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C** If calculated amount is not zero convert to input ccy            S01506
     C*                                                                   S01506
     C           W#AMTC    IFNE 0                                         S01506
     C*                                                                   S01506
     C** Calculate Base currency equivalent                               S01506
     C*                                                                   S01506
     C           CEU006    IFEQ 'Y'                                       CEU006
      *                                                                   CEU006
      * If EMU FT Enhancement is switched on then call FT0010             CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE BJCYCD    P#FRCY                          CEU006
     C                     Z-ADDW#AMTC    P#FRAM                          CEU006
     C                     Z-ADDW#DT      P#FRDT                          CEU006
     C                     MOVE W0ICCY    P#TOCY                          CEU006
     C                     Z-ADDW#DT      P#TODT                          CEU006
     C                     EXSR SRFT10                                    CEU006
     C                     Z-ADDP#TOAM    W0TRCD                          CEU006
     C                     ELSE                                           CEU006
     C*                                                                   CEU006
     C                     CLEARD#DTA                                     S01506
     C                     MOVELBJCYCD    D#FCCY                          S01506
     C                     MOVELW0ICCY    D#TCCY                          S01506
     C                     Z-ADDW#AMTC    D#FAMT                          S01506
     C*                                                                   S01506
     C/COPY WNCPYSRC,FT0320C044
     C                     CALL 'AOCCYCV0'             9090               S01506
     C                     PARM *BLANKS   O#RTN   7                       S01506
     C                     PARM '*F*T*SPT'W0ACT   8                       S01506
     C           D#DTA     PARM D#DTA     O#DTA 256                       S01506
     C/COPY WNCPYSRC,FT0320C045
     C*                                                                   S01506
     C           *IN90     IFEQ '1'                                       S01506
     C           O#RTN     ORNE *BLANKS                                   S01506
     C                     MOVEL'*CALL   'W0FILE                          S01506
     C                     MOVEL'AOCCYCV0'W0KEY                           S01506
     C                     Z-ADD1         W0ERNB                          S01506
     C                     MOVEL'MEM5003' W0MSGD                          S01506
     C                     MOVEL'MIDAS  ' W0MSGF                          S01506
     C                     EXSR SRERR                                     S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C** Set up work amount                                               S01506
     C*                                                                   S01506
     C                     Z-ADDD#TAMT    W0TRCD                          S01506
     C*                                                                   CEU006
     C                     ENDIF                                          CEU006
     C*                                                                   S01506
     C** Calculate Base currency equivalent                               S01506
     C*                                                                   S01506
     C           CEU006    IFEQ 'Y'                                       CEU006
      *                                                                   CEU006
      * If EMU FT Enhancement is switched on then call FT0010             CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE BJCYCD    P#FRCY                          CEU006
     C                     Z-ADDW#AMTC    P#FRAM                          CEU006
     C                     Z-ADDW#DT      P#FRDT                          CEU006
     C                     MOVE W0CCCY    P#TOCY                          CEU006
     C                     Z-ADDW#DT      P#TODT                          CEU006
     C                     EXSR SRFT10                                    CEU006
     C                     Z-ADDP#TOAM    W0TRCH                          CEU006
     C                     ELSE                                           CEU006
     C*                                                                   CEU006
     C                     CLEARD#DTA                                     S01506
     C                     MOVELBJCYCD    D#FCCY                          S01506
     C                     MOVELW0CCCY    D#TCCY                          S01506
     C                     Z-ADDW#AMTC    D#FAMT                          S01506
     C*                                                                   S01506
     C/COPY WNCPYSRC,FT0320C046
     C                     CALL 'AOCCYCV0'             9090               S01506
     C                     PARM *BLANKS   O#RTN   7                       S01506
     C                     PARM '*F*T*SPT'W0ACT   8                       S01506
     C           D#DTA     PARM D#DTA     O#DTA 256                       S01506
     C/COPY WNCPYSRC,FT0320C047
     C*                                                                   S01506
     C           *IN90     IFEQ '1'                                       S01506
     C           O#RTN     ORNE *BLANKS                                   S01506
     C                     MOVEL'*CALL   'W0FILE                          S01506
     C                     MOVEL'AOCCYCV0'W0KEY                           S01506
     C                     Z-ADD1         W0ERNB                          S01506
     C                     MOVEL'MEM5003' W0MSGD                          S01506
     C                     MOVEL'MIDAS  ' W0MSGF                          S01506
     C                     EXSR SRERR                                     S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C** Set up work amount                                               S01506
     C*                                                                   S01506
     C                     Z-ADDD#TAMT    W0TRCH                          S01506
     C*                                                                   CEU006
     C                     ENDIF                                          CEU006
     C*                                                                   S01506
     C                     END                                            S01506
     C*                                                                   S01494
     C** If FX/change commission installed and other currency             S01494
     C**   not equal to payment amount currency ---                       S01494
     C*                                                                   S01494
     C           S01494    IFEQ 'S01494'                                  S01494
     C           W0OCCY    ANDNEW0PCCY                                    S01494
     C*                                                                   S01494
     C** Set work fields to 0                                             S01494
     C*                                                                   S01494
     C                     Z-ADD0         W#AMTI                          S01494
     C                     Z-ADD0         W#RATE                          S01494
     C                     Z-ADD0         W#AMTC                          S01494
     C*                                                                   S01494
     C* If EMU FT  Enhancement is switched on                             CEU006
     C*  and both Other Ccy and Pay Ccy are either 'In' or Euros,         CEU006
     C*  or Other Ccy is *** (ie. Charges To The Debit Of <>0)            CEU006
     C*  then FX/Change Commission must be zero.                          CEU006
     C*                                                                   CEU006
     C           CEU006    IFEQ 'Y'                                       CEU006
     C           #INCYO    ANDEQ'Y'                                       CEU006
     C           #TPSDO    ANDLEW#DT                                      CEU006
     C           W0PCCY    ANDEQBKEURO                                    CEU006
     C           CEU006    OREQ 'Y'                                       CEU006
     C           #INCYP    ANDEQ'Y'                                       CEU006
     C           #TPSDP    ANDLEW#DT                                      CEU006
     C           W0OCCY    ANDEQBKEURO                                    CEU006
     C           CEU006    OREQ 'Y'                                       CEU006
     C           #INCYO    ANDEQ'Y'                                       CEU006
     C           #TPSDO    ANDLEW#DT                                      CEU006
     C           #INCYP    ANDEQ'Y'                                       CEU006
     C           #TPSDP    ANDLEW#DT                                      CEU006
     C           CEU006    OREQ 'Y'                                       CEU006
     C           W0OCCY    ANDEQ'***'                                     CEU006
     C                     Z-ADD0         W0FXCD                          CEU006
     C                     Z-ADD0         W0FXCH                          CEU006
     C                     ELSE                                           CEU006
     C*                                                                   CEU006
     C           W0TRCT    CASEQ'3'       SRTR3C                          S01494
     C           W0TRCT    CASEQ'4'       SRTR4C                          S01494
     C                     ENDCS                                          S01494
     C*                                                                   S01494
     C** If rate not zero then calculate amount                           S01494
     C*                                                                   S01494
     C           W#RATE    IFNE 0                                         S01494
     C           W#AMT     MULT W#RATE    W#AMTC    H                     S01494
     C                     END                                            S01494
     C*                                                                   CEU006
     C                     ENDIF                                          CEU006
     C*                                                                   S01494
     C** If calculated amount is not 0,                                   S01494
     C**   convert to input and charge currency                           S01494
     C*                                                                   S01494
     C           W#AMTC    IFNE 0                                         S01494
     C*                                                                   S01494
     C** Calculate base currency equivalent                               S01494
     C*                                                                   S01494
     C           CEU006    IFEQ 'Y'                                       CEU006
      *                                                                   CEU006
      * If EMU FT Enhancement is switched on then call FT0010             CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE BJCYCD    P#FRCY                          CEU006
     C                     Z-ADDW#AMTC    P#FRAM                          CEU006
     C                     Z-ADDW#DT      P#FRDT                          CEU006
     C                     MOVE W0ICCY    P#TOCY                          CEU006
     C                     Z-ADDW#DT      P#TODT                          CEU006
     C                     EXSR SRFT10                                    CEU006
     C                     Z-ADDP#TOAM    W0FXCD                          CEU006
     C                     ELSE                                           CEU006
     C*                                                                   CEU006
     C                     CLEARD#DTA                                     S01494
     C                     MOVELBJCYCD    D#FCCY                          S01494
     C                     MOVELW0ICCY    D#TCCY                          S01494
     C                     Z-ADDW#AMTC    D#FAMT                          S01494
     C*                                                                   S01494
     C/COPY WNCPYSRC,FT0320C048
     C                     CALL 'AOCCYCV0'             9090               S01494
     C                     PARM *BLANKS   O#RTN   7                       S01494
     C                     PARM '*F*T*SPT'W0ACT   8                       S01494
     C           D#DTA     PARM D#DTA     O#DTA 256                       S01494
     C/COPY WNCPYSRC,FT0320C049
     C*                                                                   S01494
     C           *IN90     IFEQ '1'                                       S01494
     C           O#RTN     ORNE *BLANKS                                   S01494
     C                     MOVEL'*CALL   'W0FILE                          S01494
     C                     MOVEL'AOCCYCV0'W0KEY                           S01494
     C                     Z-ADD1         W0ERNB                          S01494
     C                     MOVEL'MEM5003' W0MSGD                          S01494
     C                     MOVEL'MIDAS  ' W0MSGF                          S01494
     C                     EXSR SRERR                                     S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C** Set up work amount                                               S01494
     C*                                                                   S01494
     C                     Z-ADDD#TAMT    W0FXCD                          S01494
     C*                                                                   CEU006
     C                     ENDIF                                          CEU006
     C*                                                                   S01494
     C** Calculate base currency equivalent                               S01494
     C*                                                                   S01494
     C           CEU006    IFEQ 'Y'                                       CEU006
      *                                                                   CEU006
      * If EMU FT Enhancement is switched on then call FT0010             CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE BJCYCD    P#FRCY                          CEU006
     C                     Z-ADDW#AMTC    P#FRAM                          CEU006
     C                     Z-ADDW#DT      P#FRDT                          CEU006
     C                     MOVE W0CCCY    P#TOCY                          CEU006
     C                     Z-ADDW#DT      P#TODT                          CEU006
     C                     EXSR SRFT10                                    CEU006
     C                     Z-ADDP#TOAM    W0FXCH                          CEU006
     C                     ELSE                                           CEU006
     C*                                                                   CEU006
     C                     CLEARD#DTA                                     S01494
     C                     MOVELBJCYCD    D#FCCY                          S01494
     C                     MOVELW0CCCY    D#TCCY                          S01494
     C                     Z-ADDW#AMTC    D#FAMT                          S01494
     C*                                                                   S01494
     C/COPY WNCPYSRC,FT0320C050
     C                     CALL 'AOCCYCV0'             9090               S01494
     C                     PARM *BLANKS   O#RTN   7                       S01494
     C                     PARM '*F*T*SPT'W0ACT   8                       S01494
     C           D#DTA     PARM D#DTA     O#DTA 256                       S01494
     C/COPY WNCPYSRC,FT0320C051
     C*                                                                   S01494
     C           *IN90     IFEQ '1'                                       S01494
     C           O#RTN     ORNE *BLANKS                                   S01494
     C                     MOVEL'*CALL   'W0FILE                          S01494
     C                     MOVEL'AOCCYCV0'W0KEY                           S01494
     C                     Z-ADD1         W0ERNB                          S01494
     C                     MOVEL'MEM5003' W0MSGD                          S01494
     C                     MOVEL'MIDAS  ' W0MSGF                          S01494
     C                     EXSR SRERR                                     S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C** Set up work amount                                               S01494
     C*                                                                   S01494
     C                     Z-ADDD#TAMT    W0FXCH                          S01494
     C*                                                                   CEU006
     C                     ENDIF                                          CEU006
     C*                                                                   S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C                     END                                            S01494
     C*                                                                   S01506
     C** Unwind subroutine stack name                                     S01506
     C*                                                                   S01506
     C           EXSRCC    TAG                                            S01506
     C                     MOVEA*BLANKS   @STK,Q                          S01506
     C                     SUB  1         Q                               S01506
     C*                                                                   S01506
     CSR                   ENDSR                                          S01506
     C/EJECT                                                              S01506
      *****************************************************************
      *                                                               *
      *  SRACT    : Undefined action - error                          *
      *                                                               *
      *  CALLED BY: Main Processing                                   *
      *                                                               *
      *  CALLS    : SRERR   - report error and close down program     *
      *                                                               *
      *****************************************************************
     CSR         SRACT     BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q
     C                     MOVEL'SRACT '  @STK,Q
      *
      *  Database error undefined action
      *
     C                     MOVEL'*ACTION 'W0FILE           ***************
     C                     MOVELW0ACT     W0KEY            * DB ERROR 15 *
     C                     Z-ADD15        W0ERNB           ***************
     C                     MOVEL'MEM5006' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
      *
      *  Unwind subroutine stack name
      *
     C           EXACT     TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRTRF1   : Transfer Commission type 1                        *
      *                                                               *
      *  CALLED BY: Main Processing                                   *
      *                                                               *
      *  CALLS    : SRERR   - report error and close down program     *
      *                                                               *
      *****************************************************************
     CSR         SRTRF1    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q
     C                     MOVEL'SRTRF1'  @STK,Q
      *
      *  /Copy point for Charge cal. 1
      *
     C/COPY WNCPYSRC,FT0320TRF1
      *
      * Transfer and Commission
      *
     C                     Z-ADD0         W0TRCD
     C                     Z-ADD0         W0TRCH
      *
      *  Unwind subroutine stack name
      *
     C           EXTRF1    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRTRF2   : Transfer Commission type 2                        *
      *                                                               *
      *  CALLED BY: Main Processing                                   *
      *                                                               *
      *  CALLS    : SRERR   - report error and close down program     *
      *                                                               *
      *****************************************************************
     CSR         SRTRF2    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q
     C                     MOVEL'SRTRF2'  @STK,Q
      *
      *  /Copy point for Charge cal. 2
      *
     C/COPY WNCPYSRC,FT0320TRF2
      *
      * Transfer and Commission
      *
     C                     Z-ADD0         W0TRCD
     C                     Z-ADD0         W0TRCH
      *
      *  Unwind subroutine stack name
      *
     C           EXTRF2    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRTRF3   : Transfer Commission type 3                        *
      *                                                               *
      *  CALLED BY: Main Processing                                   *
      *                                                               *
      *  CALLS    : SRERR   - report error and close down program     *
      *                                                               *
      *****************************************************************
     CSR         SRTRF3    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q
     C                     MOVEL'SRTRF3'  @STK,Q
      *
      *  /Copy point for Charge cal. 3
      *
     C/COPY WNCPYSRC,FT0320TRF3
     C*                                                                   S01506
     C** For threshold calculations (calc type '2') ---                   S01506
     C*                                                                   S01506
     C           TR3C      IFEQ '2'                                       S01506
      *
      * If amount is less than strat of range 1
      *
     C           W#AMT     IFLT RNS1
     C                     Z-ADD0         W#AMTC
     C                     GOTO EXTRF3
     C                     END
      *
      * If amount in range 1
      *
     C           W#AMT     IFLE RNE1
     C********** W#AMT     MULT RNR1      W#AMTC                                              189095
     C           W#AMT     MULT RNR1      W#AMTC    H                                         189095
      *
      *  If commission is less than minimum
      *
     C           W#AMTC    IFLT RNMN
     C                     Z-ADDRNMN      W#AMTC
     C                     ELSE
      *
      *  If commission is more than maximum
      *
     C           RNMX      IFNE *ZEROS
     C           W#AMTC    ANDGTRNMX
     C                     Z-ADDRNMX      W#AMTC
     C                     END
     C                     END
      *
     C                     GOTO EXTRF3
     C                     END
      *
      * If range 2 is not entered, set comm to max of range 1 if
      * entered
      *
     C           RNS2      IFEQ *ZEROS
     C           RNMX      ANDNE*ZEROS
     C                     Z-ADDRNMX      W#AMTC
     C                     GOTO EXTRF3
     C                     END
      *
      * If amount in range 2
      *
     C           W#AMT     IFGE RNS2
     C           W#AMT     ANDLERNE2
     C********** W#AMT     MULT RNR2      W#AMTC                                              189095
     C           W#AMT     MULT RNR2      W#AMTC    H                                         189095
      *
      *  If commission is less than minimum
      *
     C           W#AMTC    IFLT RNMN2
     C                     Z-ADDRNMN2     W#AMTC
     C                     ELSE
      *
      *  If commission is more than maximum
      *
     C           RNMX2     IFNE *ZEROS
     C           W#AMTC    ANDGTRNMX2
     C                     Z-ADDRNMX2     W#AMTC
     C                     END
     C                     END
      *
     C                     GOTO EXTRF3
     C                     END
      *
      * If range 3 is not entered, set comm to max of range 2 if
      * entered
      *
     C           RNS3      IFEQ *ZEROS
     C           RNMX2     ANDNE*ZEROS
     C                     Z-ADDRNMX2     W#AMTC
     C                     GOTO EXTRF3
     C                     END
      *
      * If amount in range 3
     C           W#AMT     IFGE RNS3
     C           W#AMT     ANDLERNE3
     C********** W#AMT     MULT RNR3      W#AMTC                                              189095
     C           W#AMT     MULT RNR3      W#AMTC    H                                         189095
      *
      *  If commission is less than minimum
      *
     C           W#AMTC    IFLT RNMN3
     C                     Z-ADDRNMN3     W#AMTC
     C                     ELSE
      *
      *  If commission is more than maximum
      *
     C           RNMX3     IFNE *ZEROS
     C           W#AMTC    ANDGTRNMX3
     C                     Z-ADDRNMX3     W#AMTC
     C                     END
     C                     END
      *
     C                     GOTO EXTRF3
     C                     END
     C*                                                                   S01506
     C** If range 4 is not entered, set comm to max of range 3 if         S01506
     C**   entered                                                        S01506
     C*                                                                   S01506
     C           RNS4      IFEQ *ZEROS                                    S01506
     C           RNMX3     ANDNE*ZEROS                                    S01506
     C                     Z-ADDRNMX3     W#AMTC                          S01506
     C                     GOTO EXTRF3                                    S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C** If amount in range 4                                             S01506
     C*                                                                   S01506
     C           W#AMT     IFGE RNS4                                      S01506
     C           W#AMT     ANDLERNE4                                      S01506
     C********** W#AMT     MULT RNR4      W#AMTC                                       S01506 189095
     C           W#AMT     MULT RNR4      W#AMTC    H                                         189095
     C*                                                                   S01506
     C** If commission is less than minimum                               S01506
     c*                                                                   S01506
     C           W#AMTC    IFLT RNMN4                                     S01506
     C                     Z-ADDRNMN4     W#AMTC                          S01506
     C                     ELSE                                           S01506
     C*                                                                   S01506
     C** If commission is more than maximum                               S01506
     c*                                                                   S01506
     C           RNMX4     IFNE *ZEROS                                    S01506
     C           W#AMTC    ANDGTRNMX4                                     S01506
     C                     Z-ADDRNMX4     W#AMTC                          S01506
     C                     END                                            S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C                     GOTO EXTRF3                                    S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C** If range 5 is not entered, set comm to max of range 4 if         S01506
     C**   entered                                                        S01506
     C*                                                                   S01506
     C           RNS5      IFEQ *ZEROS                                    S01506
     C           RNMX4     ANDNE*ZEROS                                    S01506
     C                     Z-ADDRNMX4     W#AMTC                          S01506
     C                     GOTO EXTRF3                                    S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C** If amount in range 5                                             S01506
     C*                                                                   S01506
     C           W#AMT     IFGE RNS5                                      S01506
     C           W#AMT     ANDLERNE5                                      S01506
     C********** W#AMT     MULT RNR5      W#AMTC                                       S01506 189095
     C           W#AMT     MULT RNR5      W#AMTC    H                                         189095
     C*                                                                   S01506
     C** If commission is less than minimum                               S01506
     c*                                                                   S01506
     C           W#AMTC    IFLT RNMN5                                     S01506
     C                     Z-ADDRNMN5     W#AMTC                          S01506
     C                     ELSE                                           S01506
     C*                                                                   S01506
     C** If commission is more than maximum                               S01506
     c*                                                                   S01506
     C           RNMX5     IFNE *ZEROS                                    S01506
     C           W#AMTC    ANDGTRNMX5                                     S01506
     C                     Z-ADDRNMX5     W#AMTC                          S01506
     C                     END                                            S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C                     GOTO EXTRF3                                    S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C** If range 6 is not entered, set comm to max of range 5 if         S01506
     C**   entered                                                        S01506
     C*                                                                   S01506
     C           RNS6      IFEQ *ZEROS                                    S01506
     C           RNMX5     ANDNE*ZEROS                                    S01506
     C                     Z-ADDRNMX5     W#AMTC                          S01506
     C                     GOTO EXTRF3                                    S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C** If amount in range 6                                             S01506
     C*                                                                   S01506
     C           W#AMT     IFGE RNS6                                      S01506
     C           W#AMT     ANDLERNE6                                      S01506
     C********** W#AMT     MULT RNR6      W#AMTC                                       S01506 189095
     C           W#AMT     MULT RNR6      W#AMTC    H                                         189095
     C*                                                                   S01506
     C** If commission is less than minimum                               S01506
     c*                                                                   S01506
     C           W#AMTC    IFLT RNMN6                                     S01506
     C                     Z-ADDRNMN6     W#AMTC                          S01506
     C                     ELSE                                           S01506
     C*                                                                   S01506
     C** If commission is more than maximum                               S01506
     c*                                                                   S01506
     C           RNMX6     IFNE *ZEROS                                    S01506
     C           W#AMTC    ANDGTRNMX6                                     S01506
     C                     Z-ADDRNMX6     W#AMTC                          S01506
     C                     END                                            S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C                     GOTO EXTRF3                                    S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C** If range 7 is not entered, set comm to max of range 6 if         S01506
     C**   entered                                                        S01506
     C*                                                                   S01506
     C           RNS7      IFEQ *ZEROS                                    S01506
     C           RNMX6     ANDNE*ZEROS                                    S01506
     C                     Z-ADDRNMX6     W#AMTC                          S01506
     C                     GOTO EXTRF3                                    S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C** If amount in range 7                                             S01506
     C*                                                                   S01506
     C           W#AMT     IFGE RNS7                                      S01506
     C           W#AMT     ANDLERNE7                                      S01506
     C********** W#AMT     MULT RNR7      W#AMTC                                       S01506 189095
     C           W#AMT     MULT RNR7      W#AMTC    H                                         189095
     C*                                                                   S01506
     C** If commission is less than minimum                               S01506
     c*                                                                   S01506
     C           W#AMTC    IFLT RNMN7                                     S01506
     C                     Z-ADDRNMN7     W#AMTC                          S01506
     C                     ELSE                                           S01506
     C*                                                                   S01506
     C** If commission is more than maximum                               S01506
     c*                                                                   S01506
     C           RNMX7     IFNE *ZEROS                                    S01506
     C           W#AMTC    ANDGTRNMX7                                     S01506
     C                     Z-ADDRNMX7     W#AMTC                          S01506
     C                     END                                            S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C                     GOTO EXTRF3                                    S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C** If range 8 is not entered, set comm to max of range 7 if         S01506
     C**   entered                                                        S01506
     C*                                                                   S01506
     C           RNS8      IFEQ *ZEROS                                    S01506
     C           RNMX7     ANDNE*ZEROS                                    S01506
     C                     Z-ADDRNMX7     W#AMTC                          S01506
     C                     GOTO EXTRF3                                    S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C** If amount in range 8                                             S01506
     C*                                                                   S01506
     C           W#AMT     IFGE RNS8                                      S01506
     C           W#AMT     ANDLERNE8                                      S01506
     C********** W#AMT     MULT RNR8      W#AMTC                                       S01506 189095
     C           W#AMT     MULT RNR8      W#AMTC    H                                         189095
     C*                                                                   S01506
     C** If commission is less than minimum                               S01506
     c*                                                                   S01506
     C           W#AMTC    IFLT RNMN8                                     S01506
     C                     Z-ADDRNMN8     W#AMTC                          S01506
     C                     ELSE                                           S01506
     C*                                                                   S01506
     C** If commission is more than maximum                               S01506
     c*                                                                   S01506
     C           RNMX8     IFNE *ZEROS                                    S01506
     C           W#AMTC    ANDGTRNMX8                                     S01506
     C                     Z-ADDRNMX8     W#AMTC                          S01506
     C                     END                                            S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C                     GOTO EXTRF3                                    S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C** If range 9 is not entered, set comm to max of range 8 if         S01506
     C**   entered                                                        S01506
     C*                                                                   S01506
     C           RNS9      IFEQ *ZEROS                                    S01506
     C           RNMX8     ANDNE*ZEROS                                    S01506
     C                     Z-ADDRNMX8     W#AMTC                          S01506
     C                     GOTO EXTRF3                                    S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C** If amount in range 9                                             S01506
     C*                                                                   S01506
     C           W#AMT     IFGE RNS9                                      S01506
     C           W#AMT     ANDLERNE9                                      S01506
     C********** W#AMT     MULT RNR9      W#AMTC                                       S01506 189095
     C           W#AMT     MULT RNR9      W#AMTC    H                                         189095
     C*                                                                   S01506
     C** If commission is less than minimum                               S01506
     c*                                                                   S01506
     C           W#AMTC    IFLT RNMN9                                     S01506
     C                     Z-ADDRNMN9     W#AMTC                          S01506
     C                     ELSE                                           S01506
     C*                                                                   S01506
     C** If commission is more than maximum                               S01506
     c*                                                                   S01506
     C           RNMX9     IFNE *ZEROS                                    S01506
     C           W#AMTC    ANDGTRNMX9                                     S01506
     C                     Z-ADDRNMX9     W#AMTC                          S01506
     C                     END                                            S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C                     GOTO EXTRF3                                    S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C** If range 0 is not entered, set comm to max of range 9 if         S01506
     C**   entered                                                        S01506
     C*                                                                   S01506
     C           RNS0      IFEQ *ZEROS                                    S01506
     C           RNMX9     ANDNE*ZEROS                                    S01506
     C                     Z-ADDRNMX9     W#AMTC                          S01506
     C                     GOTO EXTRF3                                    S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C** If amount in range 0                                             S01506
     C*                                                                   S01506
     C           W#AMT     IFGE RNS0                                      S01506
     C           W#AMT     ANDLERNE0                                      S01506
     C********** W#AMT     MULT RNR0      W#AMTC                                       S01506 189095
     C           W#AMT     MULT RNR0      W#AMTC    H                                         189095
     C*                                                                   S01506
     C** If commission is less than minimum                               S01506
     c*                                                                   S01506
     C           W#AMTC    IFLT RNMN0                                     S01506
     C                     Z-ADDRNMN0     W#AMTC                          S01506
     C                     ELSE                                           S01506
     C*                                                                   S01506
     C** If commission is more than maximum                               S01506
     c*                                                                   S01506
     C           RNMX0     IFNE *ZEROS                                    S01506
     C           W#AMTC    ANDGTRNMX0                                     S01506
     C                     Z-ADDRNMX0     W#AMTC                          S01506
     C                     END                                            S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C                     GOTO EXTRF3                                    S01506
     C                     END                                            S01506
     C***********                                                         S01506
     C**If*amount*not*in*ranges****************************************   S01506
     C***********                                                         S01506
     C***********W#AMT     IFGT RNE3                                      S01506
     C***********          Z-ADDRNMX3     W#AMTC                          S01506
     C***********          END                                            S01506
     C*                                                                   S01506
     C** If amount not in ranges                                          S01506
     C*                                                                   S01506
     C           W#AMT     IFGT RNE0                                      S01506
     C                     Z-ADDRNMX0     W#AMTC                          S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C** END for threshold calculations (calc type '2')                   S01506
     C*                                                                   S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C** For tiered calculations (calc type '1') ---                      S01506
     C*                                                                   S01506
     C           TR3C      IFEQ '1'                                       S01506
     C*                                                                   S01506
     C                     Z-ADDW#AMT     W#AMTI                          S01506
     C                     Z-ADD0         W#COM  130                      S01506
     C                     Z-ADD0         W#AMTC                          S01506
     C*                                                                   S01506
     C** If amount is less than the start of range                        S01506
     C*                                                                   S01506
     C           W#AMT     IFLT RNS1                                      S01506
     C                     Z-ADD0         W#AMTC                          S01506
     C                     GOTO EXTRF3                                    S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C** Calculate commission                                             S01506
     C*                                                                   S01506
     C           RNS0      IFGT 0                                         S01506
     C********** W#AMTI    SUB  RNS0      W#TMP1 110               S01506 109214
     C           W#AMTI    SUB  RNS0      W#TMP1 130                      109214
     C           W#TMP1    IFGT 0                                         S01506
     C*                                                                   S01506
     C           W#AMTI    IFGT RNE0                                      S01506
     C           RNE0      SUB  RNS0      W#TMP2                          S01506
     C                     ELSE                                           S01506
     C*********************Z-ADDW#TMP1    W#TMP2 110               S01506 109214
     C                     Z-ADDW#TMP1    W#TMP2 130                      109214
     C                     END                                            S01506
     C*                                                                   S01506
     C********** W#TMP2    MULT RNR0      W#COM                                        S01506 189095
     C           W#TMP2    MULT RNR0      W#COM     H                                         189095
     C                     ADD  W#COM     W#AMTC                          S01506
     C                     SUB  W#TMP1    W#AMTI                          S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C           RNS9      IFGT 0                                         S01506
     C***********W#AMTI    SUB  RNS9      W#TMP1 110               S01506 109214
     C           W#AMTI    SUB  RNS9      W#TMP1                          109214
     C           W#TMP1    IFGT 0                                         S01506
     C********** W#TMP1    MULT RNR9      W#COM                                        S01506 189095
     C           W#TMP1    MULT RNR9      W#COM     H                                         189095
     C                     SUB  W#TMP1    W#AMTI                          S01506
     C                     ADD  W#COM     W#AMTC                          S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C           RNS8      IFGT 0                                         S01506
     C***********W#AMTI    SUB  RNS8      W#TMP1 110               S01506 109214
     C           W#AMTI    SUB  RNS8      W#TMP1                          109214
     C           W#TMP1    IFGT 0                                         S01506
     C********** W#TMP1    MULT RNR8      W#COM                                        S01506 189095
     C           W#TMP1    MULT RNR8      W#COM     H                                         189095
     C                     SUB  W#TMP1    W#AMTI                          S01506
     C                     ADD  W#COM     W#AMTC                          S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C           RNS7      IFGT 0                                         S01506
     C***********W#AMTI    SUB  RNS7      W#TMP1 110               S01506 109214
     C           W#AMTI    SUB  RNS7      W#TMP1                          109214
     C           W#TMP1    IFGT 0                                         S01506
     C********** W#TMP1    MULT RNR7      W#COM                                        S01506 189095
     C           W#TMP1    MULT RNR7      W#COM     H                                         189095
     C                     SUB  W#TMP1    W#AMTI                          S01506
     C                     ADD  W#COM     W#AMTC                          S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C           RNS6      IFGT 0                                         S01506
     C***********W#AMTI    SUB  RNS6      W#TMP1 110               S01506 109214
     C           W#AMTI    SUB  RNS6      W#TMP1                          109214
     C           W#TMP1    IFGT 0                                         S01506
     C********** W#TMP1    MULT RNR6      W#COM                                        S01506 189095
     C           W#TMP1    MULT RNR6      W#COM     H                                         189095
     C                     ADD  W#COM     W#AMTC                          S01506
     C                     SUB  W#TMP1    W#AMTI                          S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C           RNS5      IFGT 0                                         S01506
     C***********W#AMTI    SUB  RNS5      W#TMP1 110               S01506 109214
     C           W#AMTI    SUB  RNS5      W#TMP1                          109214
     C           W#TMP1    IFGT 0                                         S01506
     C********** W#TMP1    MULT RNR5      W#COM                                        S01506 189095
     C           W#TMP1    MULT RNR5      W#COM     H                                         189095
     C                     ADD  W#COM     W#AMTC                          S01506
     C                     SUB  W#TMP1    W#AMTI                          S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C           RNS4      IFGT 0                                         S01506
     C***********W#AMTI    SUB  RNS4      W#TMP1 110               S01506 109214
     C           W#AMTI    SUB  RNS4      W#TMP1                          109214
     C           W#TMP1    IFGT 0                                         S01506
     C********** W#TMP1    MULT RNR4      W#COM                                        S01506 189095
     C           W#TMP1    MULT RNR4      W#COM     H                                         189095
     C                     ADD  W#COM     W#AMTC                          S01506
     C                     SUB  W#TMP1    W#AMTI                          S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C           RNS3      IFGT 0                                         S01506
     C********** W#AMTI    SUB  RNS3      W#TMP1 110               S01506 109214
     C           W#AMTI    SUB  RNS3      W#TMP1                          109214
     C           W#TMP1    IFGT 0                                         S01506
     C********** W#TMP1    MULT RNR3      W#COM                                        S01506 189095
     C           W#TMP1    MULT RNR3      W#COM     H                                         189095
     C                     ADD  W#COM     W#AMTC                          S01506
     C                     SUB  W#TMP1    W#AMTI                          S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C           RNS2      IFGT 0                                         S01506
     C********** W#AMTI    SUB  RNS2      W#TMP1 110               S01506 109214
     C           W#AMTI    SUB  RNS2      W#TMP1                          109214
     C           W#TMP1    IFGT 0                                         S01506
     C********** W#TMP1    MULT RNR2      W#COM                                        S01506 189095
     C           W#TMP1    MULT RNR2      W#COM     H                                         189095
     C                     ADD  W#COM     W#AMTC                          S01506
     C                     SUB  W#TMP1    W#AMTI                          S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C           RNS1      IFGT 0                                         S01506
     C********** W#AMTI    SUB  RNS1      W#TMP1 110               S01506 109214
     C           W#AMTI    SUB  RNS1      W#TMP1                          109214
     C           W#TMP1    IFGT 0                                         S01506
     C********** W#TMP1    MULT RNR1      W#COM                                        S01506 189095
     C           W#TMP1    MULT RNR1      W#COM     H                                         189095
     C                     ADD  W#COM     W#AMTC                          S01506
     C                     SUB  W#TMP1    W#AMTI                          S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C           RNS0      IFGT 0                                         S01506
     C           W#AMT     IFGT RNS0                                      S01506
     C*                                                                   S01506
     C** If commission is less than minimum                               S01506
     C*                                                                   S01506
     C           W#AMTC    IFLT RNMN0                                     S01506
     C                     Z-ADDRNMN0     W#AMTC                          S01506
     C                     ELSE                                           S01506
     C*                                                                   S01506
     C** If commission is more than maximum                               S01506
     C*                                                                   S01506
     C           RNMX0     IFNE *ZEROS                                    S01506
     C           W#AMTC    ANDGTRNMX0                                     S01506
     C                     Z-ADDRNMX0     W#AMTC                          S01506
     C                     END                                            S01506
     C                     END                                            S01506
     C                     GOTO EXTRF3                                    S01506
     C                     END                                            S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C*                                                                   S01506
     C           RNS9      IFGT 0                                         S01506
     C           W#AMT     IFGT RNS9                                      S01506
     C*                                                                   S01506
     C** If commission is less than minimum                               S01506
     C*                                                                   S01506
     C           W#AMTC    IFLT RNMN9                                     S01506
     C                     Z-ADDRNMN9     W#AMTC                          S01506
     C                     ELSE                                           S01506
     C*                                                                   S01506
     C** If commission is more than maximum                               S01506
     C*                                                                   S01506
     C           RNMX9     IFNE *ZEROS                                    S01506
     C           W#AMTC    ANDGTRNMX9                                     S01506
     C                     Z-ADDRNMX9     W#AMTC                          S01506
     C                     END                                            S01506
     C                     END                                            S01506
     C                     GOTO EXTRF3                                    S01506
     C                     END                                            S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C*                                                                   S01506
     C           RNS8      IFGT 0                                         S01506
     C           W#AMT     IFGT RNS8                                      S01506
     C*                                                                   S01506
     C** If commission is less than minimum                               S01506
     C*                                                                   S01506
     C           W#AMTC    IFLT RNMN8                                     S01506
     C                     Z-ADDRNMN8     W#AMTC                          S01506
     C                     ELSE                                           S01506
     C*                                                                   S01506
     C** If commission is more than maximum                               S01506
     C*                                                                   S01506
     C           RNMX8     IFNE *ZEROS                                    S01506
     C           W#AMTC    ANDGTRNMX8                                     S01506
     C                     Z-ADDRNMX8     W#AMTC                          S01506
     C                     END                                            S01506
     C                     END                                            S01506
     C                     GOTO EXTRF3                                    S01506
     C                     END                                            S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C*                                                                   S01506
     C           RNS7      IFGT 0                                         S01506
     C           W#AMT     IFGT RNS7                                      S01506
     C*                                                                   S01506
     C** If commission is less than minimum                               S01506
     C*                                                                   S01506
     C           W#AMTC    IFLT RNMN7                                     S01506
     C                     Z-ADDRNMN7     W#AMTC                          S01506
     C                     ELSE                                           S01506
     C*                                                                   S01506
     C** If commission is more than maximum                               S01506
     C*                                                                   S01506
     C           RNMX7     IFNE *ZEROS                                    S01506
     C           W#AMTC    ANDGTRNMX7                                     S01506
     C                     Z-ADDRNMX7     W#AMTC                          S01506
     C                     END                                            S01506
     C                     END                                            S01506
     C                     GOTO EXTRF3                                    S01506
     C                     END                                            S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C*                                                                   S01506
     C           RNS6      IFGT 0                                         S01506
     C           W#AMT     IFGT RNS6                                      S01506
     C*                                                                   S01506
     C** If commission is less than minimum                               S01506
     C*                                                                   S01506
     C           W#AMTC    IFLT RNMN6                                     S01506
     C                     Z-ADDRNMN6     W#AMTC                          S01506
     C                     ELSE                                           S01506
     C*                                                                   S01506
     C** If commission is more than maximum                               S01506
     C*                                                                   S01506
     C           RNMX6     IFNE *ZEROS                                    S01506
     C           W#AMTC    ANDGTRNMX6                                     S01506
     C                     Z-ADDRNMX6     W#AMTC                          S01506
     C                     END                                            S01506
     C                     END                                            S01506
     C                     GOTO EXTRF3                                    S01506
     C                     END                                            S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C*                                                                   S01506
     C           RNS5      IFGT 0                                         S01506
     C           W#AMT     IFGT RNS5                                      S01506
     C*                                                                   S01506
     C** If commission is less than minimum                               S01506
     C*                                                                   S01506
     C           W#AMTC    IFLT RNMN5                                     S01506
     C                     Z-ADDRNMN5     W#AMTC                          S01506
     C                     ELSE                                           S01506
     C*                                                                   S01506
     C** If commission is more than maximum                               S01506
     C*                                                                   S01506
     C           RNMX5     IFNE *ZEROS                                    S01506
     C           W#AMTC    ANDGTRNMX5                                     S01506
     C                     Z-ADDRNMX5     W#AMTC                          S01506
     C                     END                                            S01506
     C                     END                                            S01506
     C                     GOTO EXTRF3                                    S01506
     C                     END                                            S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C*                                                                   S01506
     C           RNS4      IFGT 0                                         S01506
     C           W#AMT     IFGT RNS4                                      S01506
     C*                                                                   S01506
     C** If commission is less than minimum                               S01506
     C*                                                                   S01506
     C           W#AMTC    IFLT RNMN4                                     S01506
     C                     Z-ADDRNMN4     W#AMTC                          S01506
     C                     ELSE                                           S01506
     C*                                                                   S01506
     C** If commission is more than maximum                               S01506
     C*                                                                   S01506
     C           RNMX4     IFNE *ZEROS                                    S01506
     C           W#AMTC    ANDGTRNMX4                                     S01506
     C                     Z-ADDRNMX4     W#AMTC                          S01506
     C                     END                                            S01506
     C                     END                                            S01506
     C                     GOTO EXTRF3                                    S01506
     C                     END                                            S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C*                                                                   S01506
     C           RNS3      IFGT 0                                         S01506
     C           W#AMT     IFGT RNS3                                      S01506
     C*                                                                   S01506
     C** If commission is less than minimum                               S01506
     C*                                                                   S01506
     C           W#AMTC    IFLT RNMN3                                     S01506
     C                     Z-ADDRNMN3     W#AMTC                          S01506
     C                     ELSE                                           S01506
     C*                                                                   S01506
     C** If commission is more than maximum                               S01506
     C*                                                                   S01506
     C           RNMX3     IFNE *ZEROS                                    S01506
     C           W#AMTC    ANDGTRNMX3                                     S01506
     C                     Z-ADDRNMX3     W#AMTC                          S01506
     C                     END                                            S01506
     C                     END                                            S01506
     C                     GOTO EXTRF3                                    S01506
     C                     END                                            S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C*                                                                   S01506
     C           RNS2      IFGT 0                                         S01506
     C           W#AMT     IFGT RNS2                                      S01506
     C*                                                                   S01506
     C** If commission is less than minimum                               S01506
     C*                                                                   S01506
     C           W#AMTC    IFLT RNMN2                                     S01506
     C                     Z-ADDRNMN2     W#AMTC                          S01506
     C                     ELSE                                           S01506
     C*                                                                   S01506
     C** If commission is more than maximum                               S01506
     C*                                                                   S01506
     C           RNMX2     IFNE *ZEROS                                    S01506
     C           W#AMTC    ANDGTRNMX2                                     S01506
     C                     Z-ADDRNMX2     W#AMTC                          S01506
     C                     END                                            S01506
     C                     END                                            S01506
     C                     GOTO EXTRF3                                    S01506
     C                     END                                            S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C*                                                                   S01506
     C           RNS1      IFGT 0                                         S01506
     C           W#AMT     IFGT RNS1                                      S01506
     C*                                                                   S01506
     C** If commission is less than minimum                               S01506
     C*                                                                   S01506
     C           W#AMTC    IFLT RNMN                                      S01506
     C                     Z-ADDRNMN      W#AMTC                          S01506
     C                     ELSE                                           S01506
     C*                                                                   S01506
     C** If commission is more than maximum                               S01506
     C*                                                                   S01506
     C           RNMX      IFNE *ZEROS                                    S01506
     C           W#AMTC    ANDGTRNMX                                      S01506
     C                     Z-ADDRNMX      W#AMTC                          S01506
     C                     END                                            S01506
     C                     END                                            S01506
     C                     GOTO EXTRF3                                    S01506
     C                     END                                            S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C** END for tiered calculations (calc type '1')                      S01506
     C*                                                                   S01506
     C                     END                                            S01506
      *
      *  Unwind subroutine stack name
      *
     C           EXTRF3    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRTRF4   : Transfer Commission type 4                        *
      *                                                               *
      *  CALLED BY: Main Processing                                   *
      *                                                               *
      *  CALLS    : SRERR   - report error and close down program     *
      *                                                               *
      *****************************************************************
     CSR         SRTRF4    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q
     C                     MOVEL'SRTRF4'  @STK,Q
      *
      *  /Copy point for Charge cal. 4
      *
     C/COPY WNCPYSRC,FT0320TRF4
     C*                                                                   S01506
     C** For threshold calculations (calc type '2') ---                   S01506
     C*                                                                   S01506
     C           TR4C      IFEQ '2'                                       S01506
      *
      *  Amount less than range 1
      *
     C           W#AMT     IFLT RRS1
     C                     Z-ADD0         W#AMTC
     C                     GOTO EXTRF4
     C                     END
      *
      * If amount in range 1
      *
     C           W#AMT     IFLE RRE1
     C********** W#AMT     MULT RRR1      W#AMTC                                              189095
     C           W#AMT     MULT RRR1      W#AMTC    H                                         189095
      *
      *  If commission is less than minimum
      *
     C           W#AMTC    IFLT RRMN
     C                     Z-ADDRRMN      W#AMTC
     C                     ELSE
      *
      *  If commission is more than maximum
      *
     C           RRMX      IFNE *ZEROS
     C           W#AMTC    ANDGTRRMX
     C                     Z-ADDRRMX      W#AMTC
     C                     END
     C                     END
      *
     C                     GOTO EXTRF4
     C                     END
      *
      * If range 2 is not entered, set comm to max of range 1 if
      * entered
      *
     C           RRS2      IFEQ *ZEROS
     C           RRMX      ANDNE*ZEROS
     C                     Z-ADDRRMX      W#AMTC
     C                     GOTO EXTRF4
     C                     END
      *
      * If amount in range 2
      *
     C           W#AMT     IFGE RRS2
     C           W#AMT     ANDLERRE2
     C********** W#AMT     MULT RRR2      W#AMTC                                              189095
     C           W#AMT     MULT RRR2      W#AMTC    H                                         189095
      *
      *  If commission is less than minimum
      *
     C           W#AMTC    IFLT RRMN2
     C                     Z-ADDRRMN2     W#AMTC
     C                     ELSE
      *
      *  If commission is more than maximum
      *
     C           RRMX2     IFNE *ZEROS
     C           W#AMTC    ANDGTRRMX2
     C                     Z-ADDRRMX2     W#AMTC
     C                     END
     C                     END
      *
     C                     GOTO EXTRF4
     C                     END
     C*                                                                   S01506
     C** If range 3 is not entered, set comm to max of range 2 if         S01506
     C**   entered                                                        S01506
     C*                                                                   S01506
     C           RRS3      IFEQ *ZEROS                                    S01506
     C           RRMX2     ANDNE*ZEROS                                    S01506
     C                     Z-ADDRRMX2     W#AMTC                          S01506
     C                     GOTO EXTRF4                                    S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C** If amount in range 3                                             S01506
     C*                                                                   S01506
     C           W#AMT     IFGE RRS3                                      S01506
     C           W#AMT     ANDLERRE3                                      S01506
     C********** W#AMT     MULT RRR3      W#AMTC                                       S01506 189095
     C           W#AMT     MULT RRR3      W#AMTC    H                                         189095
     C*                                                                   S01506
     C** If commission is less than minimum                               S01506
     C*                                                                   S01506
     C           W#AMTC    IFLT RRMN3                                     S01506
     C                     Z-ADDRRMN3     W#AMTC                          S01506
     C                     ELSE                                           S01506
     C*                                                                   S01506
     C** If commission is more than maximum                               S01506
     C*                                                                   S01506
     C           RRMX3     IFNE *ZEROS                                    S01506
     C           W#AMTC    ANDGTRRMX3                                     S01506
     C                     Z-ADDRRMX3     W#AMTC                          S01506
     C                     END                                            S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C                     GOTO EXTRF4                                    S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C** If range 4 is not entered, set comm to max of range 3 if         S01506
     C**   entered                                                        S01506
     C*                                                                   S01506
     C           RRS4      IFEQ *ZEROS                                    S01506
     C           RRMX3     ANDNE*ZEROS                                    S01506
     C                     Z-ADDRRMX3     W#AMTC                          S01506
     C                     GOTO EXTRF4                                    S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C** If amount in range 4                                             S01506
     C*                                                                   S01506
     C           W#AMT     IFGE RRS4                                      S01506
     C           W#AMT     ANDLERRE4                                      S01506
     C********** W#AMT     MULT RRR4      W#AMTC                                       S01506 189095
     C           W#AMT     MULT RRR4      W#AMTC    H                                         189095
     C*                                                                   S01506
     C** If commission is less than minimum                               S01506
     C*                                                                   S01506
     C           W#AMTC    IFLT RRMN4                                     S01506
     C                     Z-ADDRRMN4     W#AMTC                          S01506
     C                     ELSE                                           S01506
     C*                                                                   S01506
     C** If commission is more than maximum                               S01506
     C*                                                                   S01506
     C           RRMX4     IFNE *ZEROS                                    S01506
     C           W#AMTC    ANDGTRRMX4                                     S01506
     C                     Z-ADDRRMX4     W#AMTC                          S01506
     C                     END                                            S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C                     GOTO EXTRF4                                    S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C** If range 5 is not entered, set comm to max of range 4 if         S01506
     C**   entered                                                        S01506
     C*                                                                   S01506
     C           RRS5      IFEQ *ZEROS                                    S01506
     C           RRMX4     ANDNE*ZEROS                                    S01506
     C                     Z-ADDRRMX4     W#AMTC                          S01506
     C                     GOTO EXTRF4                                    S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C** If amount in range 5                                             S01506
     C*                                                                   S01506
     C           W#AMT     IFGE RRS5                                      S01506
     C           W#AMT     ANDLERRE5                                      S01506
     C********** W#AMT     MULT RRR5      W#AMTC                                       S01506 189095
     C           W#AMT     MULT RRR5      W#AMTC    H                                         189095
     C*                                                                   S01506
     C** If commission is less than minimum                               S01506
     C*                                                                   S01506
     C           W#AMTC    IFLT RRMN5                                     S01506
     C                     Z-ADDRRMN5     W#AMTC                          S01506
     C                     ELSE                                           S01506
     C*                                                                   S01506
     C** If commission is more than maximum                               S01506
     C*                                                                   S01506
     C           RRMX5     IFNE *ZEROS                                    S01506
     C           W#AMTC    ANDGTRRMX5                                     S01506
     C                     Z-ADDRRMX5     W#AMTC                          S01506
     C                     END                                            S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C                     GOTO EXTRF4                                    S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C** If range 6 is not entered, set comm to max of range 5 if         S01506
     C**   entered                                                        S01506
     C*                                                                   S01506
     C           RRS6      IFEQ *ZEROS                                    S01506
     C           RRMX5     ANDNE*ZEROS                                    S01506
     C                     Z-ADDRRMX5     W#AMTC                          S01506
     C                     GOTO EXTRF4                                    S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C** If amount in range 6                                             S01506
     C*                                                                   S01506
     C           W#AMT     IFGE RRS6                                      S01506
     C           W#AMT     ANDLERRE6                                      S01506
     C********** W#AMT     MULT RRR6      W#AMTC                                       S01506 189095
     C           W#AMT     MULT RRR6      W#AMTC    H                                         189095
     C*                                                                   S01506
     C** If commission is less than minimum                               S01506
     C*                                                                   S01506
     C           W#AMTC    IFLT RRMN6                                     S01506
     C                     Z-ADDRRMN6     W#AMTC                          S01506
     C                     ELSE                                           S01506
     C*                                                                   S01506
     C** If commission is more than maximum                               S01506
     C*                                                                   S01506
     C           RRMX6     IFNE *ZEROS                                    S01506
     C           W#AMTC    ANDGTRRMX6                                     S01506
     C                     Z-ADDRRMX6     W#AMTC                          S01506
     C                     END                                            S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C                     GOTO EXTRF4                                    S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C** If range 7 is not entered, set comm to max of range 6 if         S01506
     C**   entered                                                        S01506
     C*                                                                   S01506
     C           RRS7      IFEQ *ZEROS                                    S01506
     C           RRMX6     ANDNE*ZEROS                                    S01506
     C                     Z-ADDRRMX6     W#AMTC                          S01506
     C                     GOTO EXTRF4                                    S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C** If amount in range 7                                             S01506
     C*                                                                   S01506
     C           W#AMT     IFGE RRS7                                      S01506
     C           W#AMT     ANDLERRE7                                      S01506
     C********** W#AMT     MULT RRR7      W#AMTC                                       S01506 189095
     C           W#AMT     MULT RRR7      W#AMTC    H                                         189095
     C*                                                                   S01506
     C** If commission is less than minimum                               S01506
     C*                                                                   S01506
     C           W#AMTC    IFLT RRMN7                                     S01506
     C                     Z-ADDRRMN7     W#AMTC                          S01506
     C                     ELSE                                           S01506
     C*                                                                   S01506
     C** If commission is more than maximum                               S01506
     C*                                                                   S01506
     C           RRMX7     IFNE *ZEROS                                    S01506
     C           W#AMTC    ANDGTRRMX7                                     S01506
     C                     Z-ADDRRMX7     W#AMTC                          S01506
     C                     END                                            S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C                     GOTO EXTRF4                                    S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C** If range 8 is not entered, set comm to max of range 7 if         S01506
     C**   entered                                                        S01506
     C*                                                                   S01506
     C           RRS8      IFEQ *ZEROS                                    S01506
     C           RRMX7     ANDNE*ZEROS                                    S01506
     C                     Z-ADDRRMX7     W#AMTC                          S01506
     C                     GOTO EXTRF4                                    S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C** If amount in range 8                                             S01506
     C*                                                                   S01506
     C           W#AMT     IFGE RRS8                                      S01506
     C           W#AMT     ANDLERRE8                                      S01506
     C********** W#AMT     MULT RRR8      W#AMTC                                       S01506 189095
     C           W#AMT     MULT RRR8      W#AMTC    H                                         189095
     C*                                                                   S01506
     C** If commission is less than minimum                               S01506
     C*                                                                   S01506
     C           W#AMTC    IFLT RRMN8                                     S01506
     C                     Z-ADDRRMN8     W#AMTC                          S01506
     C                     ELSE                                           S01506
     C*                                                                   S01506
     C** If commission is more than maximum                               S01506
     C*                                                                   S01506
     C           RRMX8     IFNE *ZEROS                                    S01506
     C           W#AMTC    ANDGTRRMX8                                     S01506
     C                     Z-ADDRRMX8     W#AMTC                          S01506
     C                     END                                            S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C                     GOTO EXTRF4                                    S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C** If range 9 is not entered, set comm to max of range 8 if         S01506
     C**   entered                                                        S01506
     C*                                                                   S01506
     C           RRS9      IFEQ *ZEROS                                    S01506
     C           RRMX8     ANDNE*ZEROS                                    S01506
     C                     Z-ADDRRMX8     W#AMTC                          S01506
     C                     GOTO EXTRF4                                    S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C** If amount in range 9                                             S01506
     C*                                                                   S01506
     C           W#AMT     IFGE RRS9                                      S01506
     C           W#AMT     ANDLERRE9                                      S01506
     C********** W#AMT     MULT RRR9      W#AMTC                                       S01506 189095
     C           W#AMT     MULT RRR9      W#AMTC    H                                         189095
     C*                                                                   S01506
     C** If commission is less than minimum                               S01506
     C*                                                                   S01506
     C           W#AMTC    IFLT RRMN9                                     S01506
     C                     Z-ADDRRMN9     W#AMTC                          S01506
     C                     ELSE                                           S01506
     C*                                                                   S01506
     C** If commission is more than maximum                               S01506
     C*                                                                   S01506
     C           RRMX9     IFNE *ZEROS                                    S01506
     C           W#AMTC    ANDGTRRMX9                                     S01506
     C                     Z-ADDRRMX9     W#AMTC                          S01506
     C                     END                                            S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C                     GOTO EXTRF4                                    S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C** If range 0 is not entered, set comm to max of range 9 if         S01506
     C**   entered                                                        S01506
     C*                                                                   S01506
     C           RRS0      IFEQ *ZEROS                                    S01506
     C           RRMX9     ANDNE*ZEROS                                    S01506
     C                     Z-ADDRRMX9     W#AMTC                          S01506
     C                     GOTO EXTRF4                                    S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C** If amount in range 0                                             S01506
     C*                                                                   S01506
     C           W#AMT     IFGE RRS0                                      S01506
     C           W#AMT     ANDLERRE0                                      S01506
     C********** W#AMT     MULT RRR0      W#AMTC                                       S01506 189095
     C           W#AMT     MULT RRR0      W#AMTC    H                                         189095
     C*                                                                   S01506
     C** If commission is less than minimum                               S01506
     C*                                                                   S01506
     C           W#AMTC    IFLT RRMN0                                     S01506
     C                     Z-ADDRRMN0     W#AMTC                          S01506
     C                     ELSE                                           S01506
     C*                                                                   S01506
     C** If commission is more than maximum                               S01506
     C*                                                                   S01506
     C           RRMX0     IFNE *ZEROS                                    S01506
     C           W#AMTC    ANDGTRRMX0                                     S01506
     C                     Z-ADDRRMX0     W#AMTC                          S01506
     C                     END                                            S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C                     GOTO EXTRF4                                    S01506
     C                     END                                            S01506
     C***********                                                         S01506
     C**If*amount*is*above*highest*range*******************************   S01506
     C***********                                                         S01506
     C***********W#AMT     IFGT RRE2                                      S01506
     C***********          Z-ADDRRMX2     W#AMTC                          S01506
     C***********          END                                            S01506
     C*                                                                   S01506
     C** If amount is above highest range                                 S01506
     C*                                                                   S01506
     C           W#AMT     IFGT RRE0                                      S01506
     C                     Z-ADDRRMX0     W#AMTC                          S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C** END for threshold calculations (calc type '2')                   S01506
     C*                                                                   S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C** For tiered calculations (calc type '1') ---                      S01506
     C*                                                                   S01506
     C           TR4C      IFEQ '1'                                       S01506
     C*                                                                   S01506
     C                     Z-ADDW#AMT     W#AMTI                          S01506
     C                     Z-ADD0         W#COM                           S01506
     C                     Z-ADD0         W#AMTC                          S01506
     C*                                                                   S01506
     C** If amount is less than start of range 1                          S01506
     C*                                                                   S01506
     C           W#AMT     IFLT RRS1                                      S01506
     C                     Z-ADD0         W#AMTC                          S01506
     C                     GOTO EXTRF4                                    S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C** Calculate commission                                             S01506
     C*                                                                   S01506
     C           RRS0      IFGT 0                                         S01506
     C********** W#AMTI    SUB  RRS0      W#TMP1 110               S01506 109214
     C           W#AMTI    SUB  RRS0      W#TMP1                          109214
     C           W#TMP1    IFGT 0                                         S01506
     C*                                                                   S01506
     C           W#AMTI    IFGT RRE0                                      S01506
     C           RRE0      SUB  RRS0      W#TMP2                          S01506
     C                     ELSE                                           S01506
     C******************** Z-ADDW#TMP1    W#TMP2 110               S01506 109214
     C                     Z-ADDW#TMP1    W#TMP2                          109214
     C                     END                                            S01506
     C*                                                                   S01506
     C********** W#TMP2    MULT RRR0      W#COM                                        S01506 189095
     C           W#TMP2    MULT RRR0      W#COM     H                                         189095
     C                     ADD  W#COM     W#AMTC                          S01506
     C                     SUB  W#TMP1    W#AMTI                          S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C           RRS9      IFGT 0                                         S01506
     C***********W#AMTI    SUB  RRS9      W#TMP1 110               S01506 109214
     C           W#AMTI    SUB  RRS9      W#TMP1                          109214
     C           W#TMP1    IFGT 0                                         S01506
     C********** W#TMP1    MULT RRR9      W#COM                                        S01506 189095
     C           W#TMP1    MULT RRR9      W#COM     H                                         189095
     C                     SUB  W#TMP1    W#AMTI                          S01506
     C                     ADD  W#COM     W#AMTC                          S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C           RRS8      IFGT 0                                         S01506
     C********** W#AMTI    SUB  RRS8      W#TMP1 110               S01506 109214
     C           W#AMTI    SUB  RRS8      W#TMP1                          109214
     C           W#TMP1    IFGT 0                                         S01506
     C********** W#TMP1    MULT RRR8      W#COM                                        S01506 189095
     C           W#TMP1    MULT RRR8      W#COM     H                                         189095
     C                     SUB  W#TMP1    W#AMTI                          S01506
     C                     ADD  W#COM     W#AMTC                          S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C           RRS7      IFGT 0                                         S01506
     C********** W#AMTI    SUB  RRS7      W#TMP1 110               S01506 109214
     C           W#AMTI    SUB  RRS7      W#TMP1                          109214
     C           W#TMP1    IFGT 0                                         S01506
     C********** W#TMP1    MULT RRR7      W#COM                                        S01506 189095
     C           W#TMP1    MULT RRR7      W#COM     H                                         189095
     C                     SUB  W#TMP1    W#AMTI                          S01506
     C                     ADD  W#COM     W#AMTC                          S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C           RRS6      IFGT 0                                         S01506
     C********** W#AMTI    SUB  RRS6      W#TMP1 110               S01506 109214
     C           W#AMTI    SUB  RRS6      W#TMP1                          109214
     C           W#TMP1    IFGT 0                                         S01506
     C********** W#TMP1    MULT RRR6      W#COM                                        S01506 189095
     C           W#TMP1    MULT RRR6      W#COM     H                                         189095
     C                     ADD  W#COM     W#AMTC                          S01506
     C                     SUB  W#TMP1    W#AMTI                          S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C           RRS5      IFGT 0                                         S01506
     C********** W#AMTI    SUB  RRS5      W#TMP1 110               S01506 109214
     C           W#AMTI    SUB  RRS5      W#TMP1                          109214
     C           W#TMP1    IFGT 0                                         S01506
     C********** W#TMP1    MULT RRR5      W#COM                                        S01506 189095
     C           W#TMP1    MULT RRR5      W#COM     H                                         189095
     C                     ADD  W#COM     W#AMTC                          S01506
     C                     SUB  W#TMP1    W#AMTI                          S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C           RRS4      IFGT 0                                         S01506
     C********** W#AMTI    SUB  RRS4      W#TMP1 110               S01506 109214
     C           W#AMTI    SUB  RRS4      W#TMP1                          109214
     C           W#TMP1    IFGT 0                                         S01506
     C********** W#TMP1    MULT RRR4      W#COM                                        S01506 189095
     C           W#TMP1    MULT RRR4      W#COM     H                                         189095
     C                     ADD  W#COM     W#AMTC                          S01506
     C                     SUB  W#TMP1    W#AMTI                          S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C           RRS3      IFGT 0                                         S01506
     C********** W#AMTI    SUB  RRS3      W#TMP1 110               S01506 109214
     C           W#AMTI    SUB  RRS3      W#TMP1                          109214
     C           W#TMP1    IFGT 0                                         S01506
     C********** W#TMP1    MULT RRR3      W#COM                                        S01506 189095
     C           W#TMP1    MULT RRR3      W#COM     H                                         189095
     C                     ADD  W#COM     W#AMTC                          S01506
     C                     SUB  W#TMP1    W#AMTI                          S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C           RRS2      IFGT 0                                         S01506
     C********** W#AMTI    SUB  RRS2      W#TMP1 110               S01506 109214
     C           W#AMTI    SUB  RRS2      W#TMP1                          109214
     C           W#TMP1    IFGT 0                                         S01506
     C********** W#TMP1    MULT RRR2      W#COM                                        S01506 189095
     C           W#TMP1    MULT RRR2      W#COM     H                                         189095
     C                     ADD  W#COM     W#AMTC                          S01506
     C                     SUB  W#TMP1    W#AMTI                          S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C           RRS1      IFGT 0                                         S01506
     C********** W#AMTI    SUB  RRS1      W#TMP1 110               S01506 109214
     C           W#AMTI    SUB  RRS1      W#TMP1                          109214
     C           W#TMP1    IFGT 0                                         S01506
     C********** W#TMP1    MULT RRR1      W#COM                                        S01506 189095
     C           W#TMP1    MULT RRR1      W#COM     H                                         189095
     C                     ADD  W#COM     W#AMTC                          S01506
     C                     SUB  W#TMP1    W#AMTI                          S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C                     END                                            S01506
     C*                                                                   S01506
     C           RRS0      IFGT 0                                         100660
     C           W#AMT     IFGT RRS0                                      S01506
     C*                                                                   S01506
     C** If commission is less than minimum                               S01506
     C*                                                                   S01506
     C           W#AMTC    IFLT RRMN0                                     S01506
     C                     Z-ADDRRMN0     W#AMTC                          S01506
     C                     ELSE                                           S01506
     C*                                                                   S01506
     C** If commission is more than maximum                               S01506
     C*                                                                   S01506
     C           RRMX0     IFNE *ZEROS                                    S01506
     C           W#AMTC    ANDGTRRMX0                                     S01506
     C                     Z-ADDRRMX0     W#AMTC                          S01506
     C                     END                                            S01506
     C                     END                                            S01506
     C                     GOTO EXTRF4                                    S01506
     C                     END                                            S01506
     C                     END                                            100660
     C*                                                                   S01506
     C*                                                                   S01506
     C           RRS9      IFGT 0                                         100660
     C           W#AMT     IFGT RRS9                                      S01506
     C*                                                                   S01506
     C** If commission is less than minimum                               S01506
     C*                                                                   S01506
     C           W#AMTC    IFLT RRMN9                                     S01506
     C                     Z-ADDRRMN9     W#AMTC                          S01506
     C                     ELSE                                           S01506
     C*                                                                   S01506
     C** If commission is more than maximum                               S01506
     C*                                                                   S01506
     C           RRMX9     IFNE *ZEROS                                    S01506
     C           W#AMTC    ANDGTRRMX9                                     S01506
     C                     Z-ADDRRMX9     W#AMTC                          S01506
     C                     END                                            S01506
     C                     END                                            S01506
     C                     GOTO EXTRF4                                    S01506
     C                     END                                            S01506
     C                     END                                            100660
     C*                                                                   S01506
     C*                                                                   S01506
     C           RRS8      IFGT 0                                         100660
     C           W#AMT     IFGT RRS8                                      S01506
     C*                                                                   S01506
     C** If commission is less than minimum                               S01506
     C*                                                                   S01506
     C           W#AMTC    IFLT RRMN8                                     S01506
     C                     Z-ADDRRMN8     W#AMTC                          S01506
     C                     ELSE                                           S01506
     C*                                                                   S01506
     C** If commission is more than maximum                               S01506
     C*                                                                   S01506
     C           RRMX8     IFNE *ZEROS                                    S01506
     C           W#AMTC    ANDGTRRMX8                                     S01506
     C                     Z-ADDRRMX8     W#AMTC                          S01506
     C                     END                                            S01506
     C                     END                                            S01506
     C                     GOTO EXTRF4                                    S01506
     C                     END                                            S01506
     C                     END                                            100660
     C*                                                                   S01506
     C*                                                                   S01506
     C           RRS7      IFGT 0                                         100660
     C           W#AMT     IFGT RRS7                                      S01506
     C*                                                                   S01506
     C** If commission is less than minimum                               S01506
     C*                                                                   S01506
     C           W#AMTC    IFLT RRMN7                                     S01506
     C                     Z-ADDRRMN7     W#AMTC                          S01506
     C                     ELSE                                           S01506
     C*                                                                   S01506
     C** If commission is more than maximum                               S01506
     C*                                                                   S01506
     C           RRMX7     IFNE *ZEROS                                    S01506
     C           W#AMTC    ANDGTRRMX7                                     S01506
     C                     Z-ADDRRMX7     W#AMTC                          S01506
     C                     END                                            S01506
     C                     END                                            S01506
     C                     GOTO EXTRF4                                    S01506
     C                     END                                            S01506
     C                     END                                            100660
     C*                                                                   S01506
     C*                                                                   S01506
     C           RRS6      IFGT 0                                         100660
     C           W#AMT     IFGT RRS6                                      S01506
     C*                                                                   S01506
     C** If commission is less than minimum                               S01506
     C*                                                                   S01506
     C           W#AMTC    IFLT RRMN6                                     S01506
     C                     Z-ADDRRMN6     W#AMTC                          S01506
     C                     ELSE                                           S01506
     C*                                                                   S01506
     C** If commission is more than maximum                               S01506
     C*                                                                   S01506
     C           RRMX6     IFNE *ZEROS                                    S01506
     C           W#AMTC    ANDGTRRMX6                                     S01506
     C                     Z-ADDRRMX6     W#AMTC                          S01506
     C                     END                                            S01506
     C                     END                                            S01506
     C                     GOTO EXTRF4                                    S01506
     C                     END                                            S01506
     C                     END                                            100660
     C*                                                                   S01506
     C*                                                                   S01506
     C           RRS5      IFGT 0                                         100660
     C           W#AMT     IFGT RRS5                                      S01506
     C*                                                                   S01506
     C** If commission is less than minimum                               S01506
     C*                                                                   S01506
     C           W#AMTC    IFLT RRMN5                                     S01506
     C                     Z-ADDRRMN5     W#AMTC                          S01506
     C                     ELSE                                           S01506
     C*                                                                   S01506
     C** If commission is more than maximum                               S01506
     C*                                                                   S01506
     C           RRMX5     IFNE *ZEROS                                    S01506
     C           W#AMTC    ANDGTRRMX5                                     S01506
     C                     Z-ADDRRMX5     W#AMTC                          S01506
     C                     END                                            S01506
     C                     END                                            S01506
     C                     GOTO EXTRF4                                    S01506
     C                     END                                            S01506
     C                     END                                            100660
     C*                                                                   S01506
     C*                                                                   S01506
     C           RRS4      IFGT 0                                         100660
     C           W#AMT     IFGT RRS4                                      S01506
     C*                                                                   S01506
     C** If commission is less than minimum                               S01506
     C*                                                                   S01506
     C           W#AMTC    IFLT RRMN4                                     S01506
     C                     Z-ADDRRMN4     W#AMTC                          S01506
     C                     ELSE                                           S01506
     C*                                                                   S01506
     C** If commission is more than maximum                               S01506
     C*                                                                   S01506
     C           RRMX4     IFNE *ZEROS                                    S01506
     C           W#AMTC    ANDGTRRMX4                                     S01506
     C                     Z-ADDRRMX4     W#AMTC                          S01506
     C                     END                                            S01506
     C                     END                                            S01506
     C                     GOTO EXTRF4                                    S01506
     C                     END                                            S01506
     C                     END                                            100660
     C*                                                                   S01506
     C*                                                                   S01506
     C           RRS3      IFGT 0                                         100660
     C           W#AMT     IFGT RRS3                                      S01506
     C*                                                                   S01506
     C** If commission is less than minimum                               S01506
     C*                                                                   S01506
     C           W#AMTC    IFLT RRMN3                                     S01506
     C                     Z-ADDRRMN3     W#AMTC                          S01506
     C                     ELSE                                           S01506
     C*                                                                   S01506
     C** If commission is more than maximum                               S01506
     C*                                                                   S01506
     C           RRMX3     IFNE *ZEROS                                    S01506
     C           W#AMTC    ANDGTRRMX3                                     S01506
     C                     Z-ADDRRMX3     W#AMTC                          S01506
     C                     END                                            S01506
     C                     END                                            S01506
     C                     GOTO EXTRF4                                    S01506
     C                     END                                            S01506
     C                     END                                            100660
     C*                                                                   S01506
     C*                                                                   S01506
     C           RRS2      IFGT 0                                         100660
     C           W#AMT     IFGT RRS2                                      S01506
     C*                                                                   S01506
     C** If commission is less than minimum                               S01506
     C*                                                                   S01506
     C           W#AMTC    IFLT RRMN2                                     S01506
     C                     Z-ADDRRMN2     W#AMTC                          S01506
     C                     ELSE                                           S01506
     C*                                                                   S01506
     C** If commission is more than maximum                               S01506
     C*                                                                   S01506
     C           RRMX2     IFNE *ZEROS                                    S01506
     C           W#AMTC    ANDGTRRMX2                                     S01506
     C                     Z-ADDRRMX2     W#AMTC                          S01506
     C                     END                                            S01506
     C                     END                                            S01506
     C                     GOTO EXTRF4                                    S01506
     C                     END                                            S01506
     C                     END                                            100660
     C*                                                                   S01506
     C*                                                                   S01506
     C           RRS1      IFGT 0                                         100660
     C           W#AMT     IFGT RRS1                                      S01506
     C*                                                                   S01506
     C** If commission is less than minimum                               S01506
     C*                                                                   S01506
     C           W#AMTC    IFLT RRMN                                      S01506
     C                     Z-ADDRRMN      W#AMTC                          S01506
     C                     ELSE                                           S01506
     C*                                                                   S01506
     C** If commission is more than maximum                               S01506
     C*                                                                   S01506
     C           RRMX      IFNE *ZEROS                                    S01506
     C           W#AMTC    ANDGTRRMX                                      S01506
     C                     Z-ADDRRMX      W#AMTC                          S01506
     C                     END                                            S01506
     C                     END                                            S01506
     C                     GOTO EXTRF4                                    S01506
     C                     END                                            S01506
     C                     END                                            100660
     C*                                                                   S01506
     C** END for tiered calculations (calc type '1')                      S01506
     C*                                                                   S01506
     C                     END                                            S01506
      *
      *  Unwind subroutine stack name
      *
     C           EXTRF4    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRTRF5   : Transfer Commission type 5                        *
      *                                                               *
      *  CALLED BY: Main Processing                                   *
      *                                                               *
      *  CALLS    : SRERR   - report error and close down program     *
      *                                                               *
      *****************************************************************
     CSR         SRTRF5    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q
     C                     MOVEL'SRTRF5'  @STK,Q
      *
      *  /Copy point for Charge cal. 5
      *
     C/COPY WNCPYSRC,FT0320TRF5
      *
      * Calculate from rate
      *
     C********** W#AMT     MULT NNRT      W#AMTC                                              189095
     C           W#AMT     MULT NNRT      W#AMTC    H                                         189095
      *
      *  If commission is less than minimum
      *
     C           W#AMTC    IFLT NNMN
     C                     Z-ADDNNMN      W#AMTC
     C                     ELSE
      *
      *  If commission is more than maximum
      *
     C           NNMX      IFNE *ZEROS
     C           W#AMTC    ANDGTNNMX
     C                     Z-ADDNNMX      W#AMTC
     C                     END
     C                     END
      *
      *  Unwind subroutine stack name
      *
     C           EXTRF5    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
     C/EJECT
     C*****************************************************************   S01494
     C*                                                               *   S01494
     C*  SRTR3C   : FX/Change Commission Type 3                       *   S01494
     C*                                                               *   S01494
     C*  CALLED BY: Main Processing                                   *   S01494
     C*                                                               *   S01494
     C*  CALLS    : SRERR   - report error and close down program     *   S01494
     C*                                                               *   S01494
     C*****************************************************************   S01494
     CSR         SRTR3C    BEGSR                                          S01494
     C*                                                                   S01494
     C** Set up subroutine stack name                                     S01494
     C*                                                                   S01494
     C                     ADD  1         Q                               S01494
     C                     MOVEL'SRTR3C'  @STK,Q                          S01494
     C*                                                                   S01494
     C*  /Copy point for FX/change commission type 3                      S01494
     C*                                                                   S01494
     C/COPY WNCPYSRC,FT0320CCP4                                           S01494
     C*                                                                   S01494
     C** For threshold calculations (calc type '2') ---                   S01494
     C*                                                                   S01494
     C           TR3C      IFEQ '2'                                       S01494
     C*                                                                   S01494
     C**If amount is less than strat of range 1                           S01494
     C*                                                                   S01494
     C           W#AMT     IFLT CNS1                                      S01494
     C                     Z-ADD0         W#AMTC                          S01494
     C                     GOTO EXTR3C                                    S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C** If amount in range 1                                             S01494
     C*                                                                   S01494
     C           W#AMT     IFLE CNE1                                      S01494
     C           W#AMT     MULT CNR1      W#AMTC                          S01494
     C*                                                                   S01494
     C** If commission is less than minimum                               S01494
     C*                                                                   S01494
     C           W#AMTC    IFLT CNMN1                                     S01494
     C                     Z-ADDCNMN1     W#AMTC                          S01494
     C                     ELSE                                           S01494
     C*                                                                   S01494
     C** If commission is more than maximum                               S01494
     C*                                                                   S01494
     C           CNMX1     IFNE *ZEROS                                    S01494
     C           W#AMTC    ANDGTCNMX1                                     S01494
     C                     Z-ADDCNMX1     W#AMTC                          S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C                     GOTO EXTR3C                                    S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C** If range 2 is not entered, set comm to max of range 1 if         S01494
     C**   entered                                                        S01494
     C*                                                                   S01494
     C           CNS2      IFEQ *ZEROS                                    S01494
     C           CNMX1     ANDNE*ZEROS                                    S01494
     C                     Z-ADDCNMX1     W#AMTC                          S01494
     C                     GOTO EXTR3C                                    S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C** If amount in range 2                                             S01494
     C*                                                                   S01494
     C           W#AMT     IFGE CNS2                                      S01494
     C           W#AMT     ANDLECNE2                                      S01494
     C           W#AMT     MULT CNR2      W#AMTC                          S01494
     C*                                                                   S01494
     C** If commission is less than minimum                               S01494
     C*                                                                   S01494
     C           W#AMTC    IFLT CNMN2                                     S01494
     C                     Z-ADDCNMN2     W#AMTC                          S01494
     C                     ELSE                                           S01494
     C*                                                                   S01494
     C** If commission is more than maximum                               S01494
     C*                                                                   S01494
     C           CNMX2     IFNE *ZEROS                                    S01494
     C           W#AMTC    ANDGTCNMX2                                     S01494
     C                     Z-ADDCNMX2     W#AMTC                          S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C                     GOTO EXTR3C                                    S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C** If range 3 is not entered, set comm to max of range 2 if         S01494
     C**   entered                                                        S01494
     C*                                                                   S01494
     C           CNS3      IFEQ *ZEROS                                    S01494
     C           CNMX2     ANDNE*ZEROS                                    S01494
     C                     Z-ADDCNMX2     W#AMTC                          S01494
     C                     GOTO EXTR3C                                    S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C* If amount in range 3                                              S01494
     C           W#AMT     IFGE CNS3                                      S01494
     C           W#AMT     ANDLECNE3                                      S01494
     C           W#AMT     MULT CNR3      W#AMTC                          S01494
     C*                                                                   S01494
     C** If commission is less than minimum                               S01494
     C*                                                                   S01494
     C           W#AMTC    IFLT CNMN3                                     S01494
     C                     Z-ADDCNMN3     W#AMTC                          S01494
     C                     ELSE                                           S01494
     C*                                                                   S01494
     C** If commission is more than maximum                               S01494
     C*                                                                   S01494
     C           CNMX3     IFNE *ZEROS                                    S01494
     C           W#AMTC    ANDGTCNMX3                                     S01494
     C                     Z-ADDCNMX3     W#AMTC                          S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C                     GOTO EXTR3C                                    S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C** If range 4 is not entered, set comm to max of range 3 if         S01494
     C**   entered                                                        S01494
     C*                                                                   S01494
     C           CNS4      IFEQ *ZEROS                                    S01494
     C           CNMX3     ANDNE*ZEROS                                    S01494
     C                     Z-ADDCNMX3     W#AMTC                          S01494
     C                     GOTO EXTR3C                                    S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C** If amount in range 4                                             S01494
     C*                                                                   S01494
     C           W#AMT     IFGE CNS4                                      S01494
     C           W#AMT     ANDLECNE4                                      S01494
     C           W#AMT     MULT CNR4      W#AMTC                          S01494
     C*                                                                   S01494
     C** If commission is less than minimum                               S01494
     c*                                                                   S01494
     C           W#AMTC    IFLT CNMN4                                     S01494
     C                     Z-ADDCNMN4     W#AMTC                          S01494
     C                     ELSE                                           S01494
     C*                                                                   S01494
     C** If commission is more than maximum                               S01494
     c*                                                                   S01494
     C           CNMX4     IFNE *ZEROS                                    S01494
     C           W#AMTC    ANDGTCNMX4                                     S01494
     C                     Z-ADDCNMX4     W#AMTC                          S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C                     GOTO EXTR3C                                    S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C** If range 5 is not entered, set comm to max of range 4 if         S01494
     C**   entered                                                        S01494
     C*                                                                   S01494
     C           CNS5      IFEQ *ZEROS                                    S01494
     C           CNMX4     ANDNE*ZEROS                                    S01494
     C                     Z-ADDCNMX4     W#AMTC                          S01494
     C                     GOTO EXTR3C                                    S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C** If amount in range 5                                             S01494
     C*                                                                   S01494
     C           W#AMT     IFGE CNS5                                      S01494
     C           W#AMT     ANDLECNE5                                      S01494
     C           W#AMT     MULT CNR5      W#AMTC                          S01494
     C*                                                                   S01494
     C** If commission is less than minimum                               S01494
     c*                                                                   S01494
     C           W#AMTC    IFLT CNMN5                                     S01494
     C                     Z-ADDCNMN5     W#AMTC                          S01494
     C                     ELSE                                           S01494
     C*                                                                   S01494
     C** If commission is more than maximum                               S01494
     c*                                                                   S01494
     C           CNMX5     IFNE *ZEROS                                    S01494
     C           W#AMTC    ANDGTCNMX5                                     S01494
     C                     Z-ADDCNMX5     W#AMTC                          S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C                     GOTO EXTR3C                                    S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C** If range 6 is not entered, set comm to max of range 5 if         S01494
     C**   entered                                                        S01494
     C*                                                                   S01494
     C           CNS6      IFEQ *ZEROS                                    S01494
     C           CNMX5     ANDNE*ZEROS                                    S01494
     C                     Z-ADDCNMX5     W#AMTC                          S01494
     C                     GOTO EXTR3C                                    S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C** If amount in range 6                                             S01494
     C*                                                                   S01494
     C           W#AMT     IFGE CNS6                                      S01494
     C           W#AMT     ANDLECNE6                                      S01494
     C           W#AMT     MULT CNR6      W#AMTC                          S01494
     C*                                                                   S01494
     C** If commission is less than minimum                               S01494
     c*                                                                   S01494
     C           W#AMTC    IFLT CNMN6                                     S01494
     C                     Z-ADDCNMN6     W#AMTC                          S01494
     C                     ELSE                                           S01494
     C*                                                                   S01494
     C** If commission is more than maximum                               S01494
     c*                                                                   S01494
     C           CNMX6     IFNE *ZEROS                                    S01494
     C           W#AMTC    ANDGTCNMX6                                     S01494
     C                     Z-ADDCNMX6     W#AMTC                          S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C                     GOTO EXTR3C                                    S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C** If range 7 is not entered, set comm to max of range 6 if         S01494
     C**   entered                                                        S01494
     C*                                                                   S01494
     C           CNS7      IFEQ *ZEROS                                    S01494
     C           CNMX6     ANDNE*ZEROS                                    S01494
     C                     Z-ADDCNMX6     W#AMTC                          S01494
     C                     GOTO EXTR3C                                    S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C** If amount in range 7                                             S01494
     C*                                                                   S01494
     C           W#AMT     IFGE CNS7                                      S01494
     C           W#AMT     ANDLECNE7                                      S01494
     C           W#AMT     MULT CNR7      W#AMTC                          S01494
     C*                                                                   S01494
     C** If commission is less than minimum                               S01494
     c*                                                                   S01494
     C           W#AMTC    IFLT CNMN7                                     S01494
     C                     Z-ADDCNMN7     W#AMTC                          S01494
     C                     ELSE                                           S01494
     C*                                                                   S01494
     C** If commission is more than maximum                               S01494
     c*                                                                   S01494
     C           CNMX7     IFNE *ZEROS                                    S01494
     C           W#AMTC    ANDGTCNMX7                                     S01494
     C                     Z-ADDCNMX7     W#AMTC                          S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C                     GOTO EXTR3C                                    S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C** If range 8 is not entered, set comm to max of range 7 if         S01494
     C**   entered                                                        S01494
     C*                                                                   S01494
     C           CNS8      IFEQ *ZEROS                                    S01494
     C           CNMX7     ANDNE*ZEROS                                    S01494
     C                     Z-ADDCNMX7     W#AMTC                          S01494
     C                     GOTO EXTR3C                                    S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C** If amount in range 8                                             S01494
     C*                                                                   S01494
     C           W#AMT     IFGE CNS8                                      S01494
     C           W#AMT     ANDLECNE8                                      S01494
     C           W#AMT     MULT CNR8      W#AMTC                          S01494
     C*                                                                   S01494
     C** If commission is less than minimum                               S01494
     c*                                                                   S01494
     C           W#AMTC    IFLT CNMN8                                     S01494
     C                     Z-ADDCNMN8     W#AMTC                          S01494
     C                     ELSE                                           S01494
     C*                                                                   S01494
     C** If commission is more than maximum                               S01494
     c*                                                                   S01494
     C           CNMX8     IFNE *ZEROS                                    S01494
     C           W#AMTC    ANDGTCNMX8                                     S01494
     C                     Z-ADDCNMX8     W#AMTC                          S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C                     GOTO EXTR3C                                    S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C** If range 9 is not entered, set comm to max of range 8 if         S01494
     C**   entered                                                        S01494
     C*                                                                   S01494
     C           CNS9      IFEQ *ZEROS                                    S01494
     C           CNMX8     ANDNE*ZEROS                                    S01494
     C                     Z-ADDCNMX8     W#AMTC                          S01494
     C                     GOTO EXTR3C                                    S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C** If amount in range 9                                             S01494
     C*                                                                   S01494
     C           W#AMT     IFGE CNS9                                      S01494
     C           W#AMT     ANDLECNE9                                      S01494
     C           W#AMT     MULT CNR9      W#AMTC                          S01494
     C*                                                                   S01494
     C** If commission is less than minimum                               S01494
     c*                                                                   S01494
     C           W#AMTC    IFLT CNMN9                                     S01494
     C                     Z-ADDCNMN9     W#AMTC                          S01494
     C                     ELSE                                           S01494
     C*                                                                   S01494
     C** If commission is more than maximum                               S01494
     c*                                                                   S01494
     C           CNMX9     IFNE *ZEROS                                    S01494
     C           W#AMTC    ANDGTCNMX9                                     S01494
     C                     Z-ADDCNMX9     W#AMTC                          S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C                     GOTO EXTR3C                                    S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C** If range 0 is not entered, set comm to max of range 9 if         S01494
     C**   entered                                                        S01494
     C*                                                                   S01494
     C           CNS0      IFEQ *ZEROS                                    S01494
     C           CNMX9     ANDNE*ZEROS                                    S01494
     C                     Z-ADDCNMX9     W#AMTC                          S01494
     C                     GOTO EXTR3C                                    S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C** If amount in range 0                                             S01494
     C*                                                                   S01494
     C           W#AMT     IFGE CNS0                                      S01494
     C           W#AMT     ANDLECNE0                                      S01494
     C           W#AMT     MULT CNR0      W#AMTC                          S01494
     C*                                                                   S01494
     C** If commission is less than minimum                               S01494
     c*                                                                   S01494
     C           W#AMTC    IFLT CNMN0                                     S01494
     C                     Z-ADDCNMN0     W#AMTC                          S01494
     C                     ELSE                                           S01494
     C*                                                                   S01494
     C** If commission is more than maximum                               S01494
     c*                                                                   S01494
     C           CNMX0     IFNE *ZEROS                                    S01494
     C           W#AMTC    ANDGTCNMX0                                     S01494
     C                     Z-ADDCNMX0     W#AMTC                          S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C                     GOTO EXTR3C                                    S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C** If amount not in ranges                                          S01494
     C*                                                                   S01494
     C           W#AMT     IFGT CNE0                                      S01494
     C                     Z-ADDCNMX0     W#AMTC                          S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C** END for threshold calculations (calc type '2')                   S01494
     C*                                                                   S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C** For tiered calculations (calc type '1') ---                      S01494
     C*                                                                   S01494
     C           TR3C      IFEQ '1'                                       S01494
     C*                                                                   S01494
     C                     Z-ADDW#AMT     W#AMTI                          S01494
     C                     Z-ADD0         W#COM  130                      S01494
     C                     Z-ADD0         W#AMTC                          S01494
     C*                                                                   S01494
     C** If amount is less than the start of range                        S01494
     C*                                                                   S01494
     C           W#AMT     IFLT CNS1                                      S01494
     C                     Z-ADD0         W#AMTC                          S01494
     C                     GOTO EXTR3C                                    S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C** Calculate commission                                             S01494
     C*                                                                   S01494
     C           CNS0      IFGT 0                                         S01494
     C***********W#AMTI    SUB  CNS0      W#TMP1 110               S01494 109214
     C           W#AMTI    SUB  CNS0      W#TMP1                          109214
     C           W#TMP1    IFGT 0                                         S01494
     C*                                                                   S01494
     C           W#AMTI    IFGT CNE0                                      S01494
     C           CNE0      SUB  CNS0      W#TMP2                          S01494
     C                     ELSE                                           S01494
     C*********************Z-ADDW#TMP1    W#TMP2 110               S01494 109214
     C                     Z-ADDW#TMP1    W#TMP2                          109214
     C                     END                                            S01494
     C*                                                                   S01494
     C           W#TMP2    MULT CNR0      W#COM                           S01494
     C                     ADD  W#COM     W#AMTC                          S01494
     C                     SUB  W#TMP1    W#AMTI                          S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C           CNS9      IFGT 0                                         S01494
     C********** W#AMTI    SUB  CNS9      W#TMP1 110               S01494 109214
     C           W#AMTI    SUB  CNS9      W#TMP1                          109214
     C           W#TMP1    IFGT 0                                         S01494
     C           W#TMP1    MULT CNR9      W#COM                           S01494
     C                     SUB  W#TMP1    W#AMTI                          S01494
     C                     ADD  W#COM     W#AMTC                          S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C           CNS8      IFGT 0                                         S01494
     C********** W#AMTI    SUB  CNS8      W#TMP1 110               S01494 109214
     C           W#AMTI    SUB  CNS8      W#TMP1                          109214
     C           W#TMP1    IFGT 0                                         S01494
     C           W#TMP1    MULT CNR8      W#COM                           S01494
     C                     SUB  W#TMP1    W#AMTI                          S01494
     C                     ADD  W#COM     W#AMTC                          S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C           CNS7      IFGT 0                                         S01494
     C********** W#AMTI    SUB  CNS7      W#TMP1 110               S01494 109214
     C           W#AMTI    SUB  CNS7      W#TMP1                          109214
     C           W#TMP1    IFGT 0                                         S01494
     C           W#TMP1    MULT CNR7      W#COM                           S01494
     C                     SUB  W#TMP1    W#AMTI                          S01494
     C                     ADD  W#COM     W#AMTC                          S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C           CNS6      IFGT 0                                         S01494
     C***********W#AMTI    SUB  CNS6      W#TMP1 110               S01494 109214
     C           W#AMTI    SUB  CNS6      W#TMP1                          109214
     C           W#TMP1    IFGT 0                                         S01494
     C           W#TMP1    MULT CNR6      W#COM                           S01494
     C                     ADD  W#COM     W#AMTC                          S01494
     C                     SUB  W#TMP1    W#AMTI                          S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C           CNS5      IFGT 0                                         S01494
     C********** W#AMTI    SUB  CNS5      W#TMP1 110               S01494 109214
     C           W#AMTI    SUB  CNS5      W#TMP1                          109214
     C           W#TMP1    IFGT 0                                         S01494
     C           W#TMP1    MULT CNR5      W#COM                           S01494
     C                     ADD  W#COM     W#AMTC                          S01494
     C                     SUB  W#TMP1    W#AMTI                          S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C           CNS4      IFGT 0                                         S01494
     C********** W#AMTI    SUB  CNS4      W#TMP1 110               S01494 109214
     C           W#AMTI    SUB  CNS4      W#TMP1                          109214
     C           W#TMP1    IFGT 0                                         S01494
     C           W#TMP1    MULT CNR4      W#COM                           S01494
     C                     ADD  W#COM     W#AMTC                          S01494
     C                     SUB  W#TMP1    W#AMTI                          S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C           CNS3      IFGT 0                                         S01494
     C********** W#AMTI    SUB  CNS3      W#TMP1 110               S01494 109214
     C           W#AMTI    SUB  CNS3      W#TMP1                          109214
     C           W#TMP1    IFGT 0                                         S01494
     C           W#TMP1    MULT CNR3      W#COM                           S01494
     C                     ADD  W#COM     W#AMTC                          S01494
     C                     SUB  W#TMP1    W#AMTI                          S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C           CNS2      IFGT 0                                         S01494
     C********** W#AMTI    SUB  CNS2      W#TMP1 110               S01494 109214
     C           W#AMTI    SUB  CNS2      W#TMP1                          109214
     C           W#TMP1    IFGT 0                                         S01494
     C           W#TMP1    MULT CNR2      W#COM                           S01494
     C                     ADD  W#COM     W#AMTC                          S01494
     C                     SUB  W#TMP1    W#AMTI                          S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C           CNS1      IFGT 0                                         S01494
     C********** W#AMTI    SUB  CNS1      W#TMP1 110               S01494 109214
     C           W#AMTI    SUB  CNS1      W#TMP1                          109214
     C           W#TMP1    IFGT 0                                         S01494
     C           W#TMP1    MULT CNR1      W#COM                           S01494
     C                     ADD  W#COM     W#AMTC                          S01494
     C                     SUB  W#TMP1    W#AMTI                          S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C           CNS0      IFGT 0                                         S01494
     C           W#AMT     IFGT CNS0                                      S01494
     C*                                                                   S01494
     C** If commission is less than minimum                               S01494
     C*                                                                   S01494
     C           W#AMTC    IFLT CNMN0                                     S01494
     C                     Z-ADDCNMN0     W#AMTC                          S01494
     C                     ELSE                                           S01494
     C*                                                                   S01494
     C** If commission is more than maximum                               S01494
     C*                                                                   S01494
     C           CNMX0     IFNE *ZEROS                                    S01494
     C           W#AMTC    ANDGTCNMX0                                     S01494
     C                     Z-ADDCNMX0     W#AMTC                          S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C                     GOTO EXTR3C                                    S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C*                                                                   S01494
     C           CNS9      IFGT 0                                         S01494
     C           W#AMT     IFGT CNS9                                      S01494
     C*                                                                   S01494
     C** If commission is less than minimum                               S01494
     C*                                                                   S01494
     C           W#AMTC    IFLT CNMN9                                     S01494
     C                     Z-ADDCNMN9     W#AMTC                          S01494
     C                     ELSE                                           S01494
     C*                                                                   S01494
     C** If commission is more than maximum                               S01494
     C*                                                                   S01494
     C           CNMX9     IFNE *ZEROS                                    S01494
     C           W#AMTC    ANDGTCNMX9                                     S01494
     C                     Z-ADDCNMX9     W#AMTC                          S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C                     GOTO EXTR3C                                    S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C*                                                                   S01494
     C           CNS8      IFGT 0                                         S01494
     C           W#AMT     IFGT CNS8                                      S01494
     C*                                                                   S01494
     C** If commission is less than minimum                               S01494
     C*                                                                   S01494
     C           W#AMTC    IFLT CNMN8                                     S01494
     C                     Z-ADDCNMN8     W#AMTC                          S01494
     C                     ELSE                                           S01494
     C*                                                                   S01494
     C** If commission is more than maximum                               S01494
     C*                                                                   S01494
     C           CNMX8     IFNE *ZEROS                                    S01494
     C           W#AMTC    ANDGTCNMX8                                     S01494
     C                     Z-ADDCNMX8     W#AMTC                          S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C                     GOTO EXTR3C                                    S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C*                                                                   S01494
     C           CNS7      IFGT 0                                         S01494
     C           W#AMT     IFGT CNS7                                      S01494
     C*                                                                   S01494
     C** If commission is less than minimum                               S01494
     C*                                                                   S01494
     C           W#AMTC    IFLT CNMN7                                     S01494
     C                     Z-ADDCNMN7     W#AMTC                          S01494
     C                     ELSE                                           S01494
     C*                                                                   S01494
     C** If commission is more than maximum                               S01494
     C*                                                                   S01494
     C           CNMX7     IFNE *ZEROS                                    S01494
     C           W#AMTC    ANDGTCNMX7                                     S01494
     C                     Z-ADDCNMX7     W#AMTC                          S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C                     GOTO EXTR3C                                    S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C*                                                                   S01494
     C           CNS6      IFGT 0                                         S01494
     C           W#AMT     IFGT CNS6                                      S01494
     C*                                                                   S01494
     C** If commission is less than minimum                               S01494
     C*                                                                   S01494
     C           W#AMTC    IFLT CNMN6                                     S01494
     C                     Z-ADDCNMN6     W#AMTC                          S01494
     C                     ELSE                                           S01494
     C*                                                                   S01494
     C** If commission is more than maximum                               S01494
     C*                                                                   S01494
     C           CNMX6     IFNE *ZEROS                                    S01494
     C           W#AMTC    ANDGTCNMX6                                     S01494
     C                     Z-ADDCNMX6     W#AMTC                          S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C                     GOTO EXTR3C                                    S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C*                                                                   S01494
     C           CNS5      IFGT 0                                         S01494
     C           W#AMT     IFGT CNS5                                      S01494
     C*                                                                   S01494
     C** If commission is less than minimum                               S01494
     C*                                                                   S01494
     C           W#AMTC    IFLT CNMN5                                     S01494
     C                     Z-ADDCNMN5     W#AMTC                          S01494
     C                     ELSE                                           S01494
     C*                                                                   S01494
     C** If commission is more than maximum                               S01494
     C*                                                                   S01494
     C           CNMX5     IFNE *ZEROS                                    S01494
     C           W#AMTC    ANDGTCNMX5                                     S01494
     C                     Z-ADDCNMX5     W#AMTC                          S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C                     GOTO EXTR3C                                    S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C*                                                                   S01494
     C           CNS4      IFGT 0                                         S01494
     C           W#AMT     IFGT CNS4                                      S01494
     C*                                                                   S01494
     C** If commission is less than minimum                               S01494
     C*                                                                   S01494
     C           W#AMTC    IFLT CNMN4                                     S01494
     C                     Z-ADDCNMN4     W#AMTC                          S01494
     C                     ELSE                                           S01494
     C*                                                                   S01494
     C** If commission is more than maximum                               S01494
     C*                                                                   S01494
     C           CNMX4     IFNE *ZEROS                                    S01494
     C           W#AMTC    ANDGTCNMX4                                     S01494
     C                     Z-ADDCNMX4     W#AMTC                          S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C                     GOTO EXTR3C                                    S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C*                                                                   S01494
     C           CNS3      IFGT 0                                         S01494
     C           W#AMT     IFGT CNS3                                      S01494
     C*                                                                   S01494
     C** If commission is less than minimum                               S01494
     C*                                                                   S01494
     C           W#AMTC    IFLT CNMN3                                     S01494
     C                     Z-ADDCNMN3     W#AMTC                          S01494
     C                     ELSE                                           S01494
     C*                                                                   S01494
     C** If commission is more than maximum                               S01494
     C*                                                                   S01494
     C           CNMX3     IFNE *ZEROS                                    S01494
     C           W#AMTC    ANDGTCNMX3                                     S01494
     C                     Z-ADDCNMX3     W#AMTC                          S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C                     GOTO EXTR3C                                    S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C*                                                                   S01494
     C           CNS2      IFGT 0                                         S01494
     C           W#AMT     IFGT CNS2                                      S01494
     C*                                                                   S01494
     C** If commission is less than minimum                               S01494
     C*                                                                   S01494
     C           W#AMTC    IFLT CNMN2                                     S01494
     C                     Z-ADDCNMN2     W#AMTC                          S01494
     C                     ELSE                                           S01494
     C*                                                                   S01494
     C** If commission is more than maximum                               S01494
     C*                                                                   S01494
     C           CNMX2     IFNE *ZEROS                                    S01494
     C           W#AMTC    ANDGTCNMX2                                     S01494
     C                     Z-ADDCNMX2     W#AMTC                          S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C                     GOTO EXTR3C                                    S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C*                                                                   S01494
     C           CNS1      IFGT 0                                         S01494
     C           W#AMT     IFGT CNS1                                      S01494
     C*                                                                   S01494
     C** If commission is less than minimum                               S01494
     C*                                                                   S01494
     C           W#AMTC    IFLT CNMN1                                     S01494
     C                     Z-ADDCNMN1     W#AMTC                          S01494
     C                     ELSE                                           S01494
     C*                                                                   S01494
     C** If commission is more than maximum                               S01494
     C*                                                                   S01494
     C           CNMX1     IFNE *ZEROS                                    S01494
     C           W#AMTC    ANDGTCNMX1                                     S01494
     C                     Z-ADDCNMX1     W#AMTC                          S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C                     GOTO EXTR3C                                    S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C** END for tiered calculations (calc type '1')                      S01494
     C*                                                                   S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C*  Unwind subroutine stack name                                     S01494
     C*                                                                   S01494
     C           EXTR3C    TAG                                            S01494
     C                     MOVEA*BLANKS   @STK,Q                          S01494
     C                     SUB  1         Q                               S01494
     C*                                                                   S01494
     CSR                   ENDSR                                          S01494
     C/EJECT                                                              S01494
     C*****************************************************************   S01494
     C*                                                               *   S01494
     C*  SRTR4C   : FX/Change Commission Type 4                       *   S01494
     C*                                                               *   S01494
     C*  CALLED BY: Main Processing                                   *   S01494
     C*                                                               *   S01494
     C*  CALLS    : SRERR   - report error and close down program     *   S01494
     C*                                                               *   S01494
     C*****************************************************************   S01494
     CSR         SRTR4C    BEGSR                                          S01494
     C*                                                                   S01494
     C** Set up subroutine stack name                                     S01494
     C*                                                                   S01494
     C                     ADD  1         Q                               S01494
     C                     MOVEL'SRTR4C'  @STK,Q                          S01494
     C*                                                                   S01494
     C*  /Copy point for FX/change commission type 4                      S01494
     C*                                                                   S01494
     C/COPY WNCPYSRC,FT0320CCP5                                           S01494
     C*                                                                   S01494
     C** For threshold calculations (calc type '2') ---                   S01494
     C*                                                                   S01494
     C           TR4C      IFEQ '2'                                       S01494
     C*                                                                   S01494
     C** Amount less than range 1                                         S01494
     C*                                                                   S01494
     C           W#AMT     IFLT CRS1                                      S01494
     C                     Z-ADD0         W#AMTC                          S01494
     C                     GOTO EXTR4C                                    S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C** If amount in range 1                                             S01494
     C*                                                                   S01494
     C           W#AMT     IFLE CRE1                                      S01494
     C           W#AMT     MULT CRR1      W#AMTC                          S01494
     C*                                                                   S01494
     C** If commission is less than minimum                               S01494
     C*                                                                   S01494
     C           W#AMTC    IFLT CRMN1                                     S01494
     C                     Z-ADDCRMN1     W#AMTC                          S01494
     C                     ELSE                                           S01494
     C*                                                                   S01494
     C** If commission is more than maximum                               S01494
     C*                                                                   S01494
     C           CRMX1     IFNE *ZEROS                                    S01494
     C           W#AMTC    ANDGTCRMX1                                     S01494
     C                     Z-ADDCRMX1     W#AMTC                          S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C                     GOTO EXTR4C                                    S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C** If range 2 is not entered, set comm to max of range 1 if         S01494
     C**   entered                                                        S01494
     C*                                                                   S01494
     C           CRS2      IFEQ *ZEROS                                    S01494
     C           CRMX1     ANDNE*ZEROS                                    S01494
     C                     Z-ADDCRMX1     W#AMTC                          S01494
     C                     GOTO EXTR4C                                    S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C** If amount in range 2                                             S01494
     C*                                                                   S01494
     C           W#AMT     IFGE CRS2                                      S01494
     C           W#AMT     ANDLECRE2                                      S01494
     C           W#AMT     MULT CRR2      W#AMTC                          S01494
     C*                                                                   S01494
     C** If commission is less than minimum                               S01494
     C*                                                                   S01494
     C           W#AMTC    IFLT CRMN2                                     S01494
     C                     Z-ADDCRMN2     W#AMTC                          S01494
     C                     ELSE                                           S01494
     C*                                                                   S01494
     C** If commission is more than maximum                               S01494
     C*                                                                   S01494
     C           CRMX2     IFNE *ZEROS                                    S01494
     C           W#AMTC    ANDGTCRMX2                                     S01494
     C                     Z-ADDCRMX2     W#AMTC                          S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C                     GOTO EXTR4C                                    S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C** If range 3 is not entered, set comm to max of range 2 if         S01494
     C**   entered                                                        S01494
     C*                                                                   S01494
     C           CRS3      IFEQ *ZEROS                                    S01494
     C           CRMX2     ANDNE*ZEROS                                    S01494
     C                     Z-ADDCRMX2     W#AMTC                          S01494
     C                     GOTO EXTR4C                                    S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C** If amount in range 3                                             S01494
     C*                                                                   S01494
     C           W#AMT     IFGE CRS3                                      S01494
     C           W#AMT     ANDLECRE3                                      S01494
     C           W#AMT     MULT CRR3      W#AMTC                          S01494
     C*                                                                   S01494
     C** If commission is less than minimum                               S01494
     C*                                                                   S01494
     C           W#AMTC    IFLT CRMN3                                     S01494
     C                     Z-ADDCRMN3     W#AMTC                          S01494
     C                     ELSE                                           S01494
     C*                                                                   S01494
     C** If commission is more than maximum                               S01494
     C*                                                                   S01494
     C           CRMX3     IFNE *ZEROS                                    S01494
     C           W#AMTC    ANDGTCRMX3                                     S01494
     C                     Z-ADDCRMX3     W#AMTC                          S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C                     GOTO EXTR4C                                    S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C** If range 4 is not entered, set comm to max of range 3 if         S01494
     C**   entered                                                        S01494
     C*                                                                   S01494
     C           CRS4      IFEQ *ZEROS                                    S01494
     C           CRMX3     ANDNE*ZEROS                                    S01494
     C                     Z-ADDCRMX3     W#AMTC                          S01494
     C                     GOTO EXTR4C                                    S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C** If amount in range 4                                             S01494
     C*                                                                   S01494
     C           W#AMT     IFGE CRS4                                      S01494
     C           W#AMT     ANDLECRE4                                      S01494
     C           W#AMT     MULT CRR4      W#AMTC                          S01494
     C*                                                                   S01494
     C** If commission is less than minimum                               S01494
     C*                                                                   S01494
     C           W#AMTC    IFLT CRMN4                                     S01494
     C                     Z-ADDCRMN4     W#AMTC                          S01494
     C                     ELSE                                           S01494
     C*                                                                   S01494
     C** If commission is more than maximum                               S01494
     C*                                                                   S01494
     C           CRMX4     IFNE *ZEROS                                    S01494
     C           W#AMTC    ANDGTCRMX4                                     S01494
     C                     Z-ADDCRMX4     W#AMTC                          S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C                     GOTO EXTR4C                                    S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C** If range 5 is not entered, set comm to max of range 4 if         S01494
     C**   entered                                                        S01494
     C*                                                                   S01494
     C           CRS5      IFEQ *ZEROS                                    S01494
     C           CRMX4     ANDNE*ZEROS                                    S01494
     C                     Z-ADDCRMX4     W#AMTC                          S01494
     C                     GOTO EXTR4C                                    S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C** If amount in range 5                                             S01494
     C*                                                                   S01494
     C           W#AMT     IFGE CRS5                                      S01494
     C           W#AMT     ANDLECRE5                                      S01494
     C           W#AMT     MULT CRR5      W#AMTC                          S01494
     C*                                                                   S01494
     C** If commission is less than minimum                               S01494
     C*                                                                   S01494
     C           W#AMTC    IFLT CRMN5                                     S01494
     C                     Z-ADDCRMN5     W#AMTC                          S01494
     C                     ELSE                                           S01494
     C*                                                                   S01494
     C** If commission is more than maximum                               S01494
     C*                                                                   S01494
     C           CRMX5     IFNE *ZEROS                                    S01494
     C           W#AMTC    ANDGTCRMX5                                     S01494
     C                     Z-ADDCRMX5     W#AMTC                          S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C                     GOTO EXTR4C                                    S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C** If range 6 is not entered, set comm to max of range 5 if         S01494
     C**   entered                                                        S01494
     C*                                                                   S01494
     C           CRS6      IFEQ *ZEROS                                    S01494
     C           CRMX5     ANDNE*ZEROS                                    S01494
     C                     Z-ADDCRMX5     W#AMTC                          S01494
     C                     GOTO EXTR4C                                    S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C** If amount in range 6                                             S01494
     C*                                                                   S01494
     C           W#AMT     IFGE CRS6                                      S01494
     C           W#AMT     ANDLECRE6                                      S01494
     C           W#AMT     MULT CRR6      W#AMTC                          S01494
     C*                                                                   S01494
     C** If commission is less than minimum                               S01494
     C*                                                                   S01494
     C           W#AMTC    IFLT CRMN6                                     S01494
     C                     Z-ADDCRMN6     W#AMTC                          S01494
     C                     ELSE                                           S01494
     C*                                                                   S01494
     C** If commission is more than maximum                               S01494
     C*                                                                   S01494
     C           CRMX6     IFNE *ZEROS                                    S01494
     C           W#AMTC    ANDGTCRMX6                                     S01494
     C                     Z-ADDCRMX6     W#AMTC                          S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C                     GOTO EXTR4C                                    S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C** If range 7 is not entered, set comm to max of range 6 if         S01494
     C**   entered                                                        S01494
     C*                                                                   S01494
     C           CRS7      IFEQ *ZEROS                                    S01494
     C           CRMX6     ANDNE*ZEROS                                    S01494
     C                     Z-ADDCRMX6     W#AMTC                          S01494
     C                     GOTO EXTR4C                                    S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C** If amount in range 7                                             S01494
     C*                                                                   S01494
     C           W#AMT     IFGE CRS7                                      S01494
     C           W#AMT     ANDLECRE7                                      S01494
     C           W#AMT     MULT CRR7      W#AMTC                          S01494
     C*                                                                   S01494
     C** If commission is less than minimum                               S01494
     C*                                                                   S01494
     C           W#AMTC    IFLT CRMN7                                     S01494
     C                     Z-ADDCRMN7     W#AMTC                          S01494
     C                     ELSE                                           S01494
     C*                                                                   S01494
     C** If commission is more than maximum                               S01494
     C*                                                                   S01494
     C           CRMX7     IFNE *ZEROS                                    S01494
     C           W#AMTC    ANDGTCRMX7                                     S01494
     C                     Z-ADDCRMX7     W#AMTC                          S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C                     GOTO EXTR4C                                    S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C** If range 8 is not entered, set comm to max of range 7 if         S01494
     C**   entered                                                        S01494
     C*                                                                   S01494
     C           CRS8      IFEQ *ZEROS                                    S01494
     C           CRMX7     ANDNE*ZEROS                                    S01494
     C                     Z-ADDCRMX7     W#AMTC                          S01494
     C                     GOTO EXTR4C                                    S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C** If amount in range 8                                             S01494
     C*                                                                   S01494
     C           W#AMT     IFGE CRS8                                      S01494
     C           W#AMT     ANDLECRE8                                      S01494
     C           W#AMT     MULT CRR8      W#AMTC                          S01494
     C*                                                                   S01494
     C** If commission is less than minimum                               S01494
     C*                                                                   S01494
     C           W#AMTC    IFLT CRMN8                                     S01494
     C                     Z-ADDCRMN8     W#AMTC                          S01494
     C                     ELSE                                           S01494
     C*                                                                   S01494
     C** If commission is more than maximum                               S01494
     C*                                                                   S01494
     C           CRMX8     IFNE *ZEROS                                    S01494
     C           W#AMTC    ANDGTCRMX8                                     S01494
     C                     Z-ADDCRMX8     W#AMTC                          S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C                     GOTO EXTR4C                                    S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C** If range 9 is not entered, set comm to max of range 8 if         S01494
     C**   entered                                                        S01494
     C*                                                                   S01494
     C           CRS9      IFEQ *ZEROS                                    S01494
     C           CRMX8     ANDNE*ZEROS                                    S01494
     C                     Z-ADDCRMX8     W#AMTC                          S01494
     C                     GOTO EXTR4C                                    S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C** If amount in range 9                                             S01494
     C*                                                                   S01494
     C           W#AMT     IFGE CRS9                                      S01494
     C           W#AMT     ANDLECRE9                                      S01494
     C           W#AMT     MULT CRR9      W#AMTC                          S01494
     C*                                                                   S01494
     C** If commission is less than minimum                               S01494
     C*                                                                   S01494
     C           W#AMTC    IFLT CRMN9                                     S01494
     C                     Z-ADDCRMN9     W#AMTC                          S01494
     C                     ELSE                                           S01494
     C*                                                                   S01494
     C** If commission is more than maximum                               S01494
     C*                                                                   S01494
     C           CRMX9     IFNE *ZEROS                                    S01494
     C           W#AMTC    ANDGTCRMX9                                     S01494
     C                     Z-ADDCRMX9     W#AMTC                          S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C                     GOTO EXTR4C                                    S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C** If range 0 is not entered, set comm to max of range 9 if         S01494
     C**   entered                                                        S01494
     C*                                                                   S01494
     C           CRS0      IFEQ *ZEROS                                    S01494
     C           CRMX9     ANDNE*ZEROS                                    S01494
     C                     Z-ADDCRMX9     W#AMTC                          S01494
     C                     GOTO EXTR4C                                    S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C** If amount in range 0                                             S01494
     C*                                                                   S01494
     C           W#AMT     IFGE CRS0                                      S01494
     C           W#AMT     ANDLECRE0                                      S01494
     C           W#AMT     MULT CRR0      W#AMTC                          S01494
     C*                                                                   S01494
     C** If commission is less than minimum                               S01494
     C*                                                                   S01494
     C           W#AMTC    IFLT CRMN0                                     S01494
     C                     Z-ADDCRMN0     W#AMTC                          S01494
     C                     ELSE                                           S01494
     C*                                                                   S01494
     C** If commission is more than maximum                               S01494
     C*                                                                   S01494
     C           CRMX0     IFNE *ZEROS                                    S01494
     C           W#AMTC    ANDGTCRMX0                                     S01494
     C                     Z-ADDCRMX0     W#AMTC                          S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C                     GOTO EXTR4C                                    S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C** If amount is above highest range                                 S01494
     C*                                                                   S01494
     C           W#AMT     IFGT CRE0                                      S01494
     C                     Z-ADDCRMX0     W#AMTC                          S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C** END for threshold calculations (calc type '2')                   S01494
     C*                                                                   S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C** For tiered calculations (calc type '1') ---                      S01494
     C*                                                                   S01494
     C           TR4C      IFEQ '1'                                       S01494
     C*                                                                   S01494
     C                     Z-ADDW#AMT     W#AMTI                          S01494
     C                     Z-ADD0         W#COM                           S01494
     C                     Z-ADD0         W#AMTC                          S01494
     C*                                                                   S01494
     C** If amount is less than start of range 1                          S01494
     C*                                                                   S01494
     C           W#AMT     IFLT CRS1                                      S01494
     C                     Z-ADD0         W#AMTC                          S01494
     C                     GOTO EXTR4C                                    S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C** Calculate commission                                             S01494
     C*                                                                   S01494
     C           CRS0      IFGT 0                                         S01494
     C***********W#AMTI    SUB  CRS0      W#TMP1 110               S01494 109214
     C           W#AMTI    SUB  CRS0      W#TMP1                          109214
     C           W#TMP1    IFGT 0                                         S01494
     C*                                                                   S01494
     C           W#AMTI    IFGT CRE0                                      S01494
     C           CRE0      SUB  CRS0      W#TMP2                          S01494
     C                     ELSE                                           S01494
     C*********************Z-ADDW#TMP1    W#TMP2 110               S01494 109214
     C                     Z-ADDW#TMP1    W#TMP2                          109214
     C                     END                                            S01494
     C*                                                                   S01494
     C           W#TMP2    MULT CRR0      W#COM                           S01494
     C                     ADD  W#COM     W#AMTC                          S01494
     C                     SUB  W#TMP1    W#AMTI                          S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C           CRS9      IFGT 0                                         S01494
     C********** W#AMTI    SUB  CRS9      W#TMP1 110               S01494 109214
     C           W#AMTI    SUB  CRS9      W#TMP1                          109214
     C           W#TMP1    IFGT 0                                         S01494
     C           W#TMP1    MULT CRR9      W#COM                           S01494
     C                     SUB  W#TMP1    W#AMTI                          S01494
     C                     ADD  W#COM     W#AMTC                          S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C           CRS8      IFGT 0                                         S01494
     C********** W#AMTI    SUB  CRS8      W#TMP1 110               S01494 109214
     C           W#AMTI    SUB  CRS8      W#TMP1                          109214
     C           W#TMP1    IFGT 0                                         S01494
     C           W#TMP1    MULT CRR8      W#COM                           S01494
     C                     SUB  W#TMP1    W#AMTI                          S01494
     C                     ADD  W#COM     W#AMTC                          S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C           CRS7      IFGT 0                                         S01494
     C********** W#AMTI    SUB  CRS7      W#TMP1 110               S01494 109214
     C           W#AMTI    SUB  CRS7      W#TMP1                          109214
     C           W#TMP1    IFGT 0                                         S01494
     C           W#TMP1    MULT CRR7      W#COM                           S01494
     C                     SUB  W#TMP1    W#AMTI                          S01494
     C                     ADD  W#COM     W#AMTC                          S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C           CRS6      IFGT 0                                         S01494
     C***********W#AMTI    SUB  CRS6      W#TMP1 110               S01494 109214
     C           W#AMTI    SUB  CRS6      W#TMP1                          109214
     C           W#TMP1    IFGT 0                                         S01494
     C           W#TMP1    MULT CRR6      W#COM                           S01494
     C                     ADD  W#COM     W#AMTC                          S01494
     C                     SUB  W#TMP1    W#AMTI                          S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C           CRS5      IFGT 0                                         S01494
     C********** W#AMTI    SUB  CRS5      W#TMP1 110               S01494 109214
     C           W#AMTI    SUB  CRS5      W#TMP1                          109214
     C           W#TMP1    IFGT 0                                         S01494
     C           W#TMP1    MULT CRR5      W#COM                           S01494
     C                     ADD  W#COM     W#AMTC                          S01494
     C                     SUB  W#TMP1    W#AMTI                          S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C           CRS4      IFGT 0                                         S01494
     C***********W#AMTI    SUB  CRS4      W#TMP1 110               S01494 109214
     C           W#AMTI    SUB  CRS4      W#TMP1                          109214
     C           W#TMP1    IFGT 0                                         S01494
     C           W#TMP1    MULT CRR4      W#COM                           S01494
     C                     ADD  W#COM     W#AMTC                          S01494
     C                     SUB  W#TMP1    W#AMTI                          S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C           CRS3      IFGT 0                                         S01494
     C********** W#AMTI    SUB  CRS3      W#TMP1 110               S01494 109214
     C           W#AMTI    SUB  CRS3      W#TMP1                          109214
     C           W#TMP1    IFGT 0                                         S01494
     C           W#TMP1    MULT CRR3      W#COM                           S01494
     C                     ADD  W#COM     W#AMTC                          S01494
     C                     SUB  W#TMP1    W#AMTI                          S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C           CRS2      IFGT 0                                         S01494
     C********** W#AMTI    SUB  CRS2      W#TMP1 110               S01494 109214
     C           W#AMTI    SUB  CRS2      W#TMP1                          109214
     C           W#TMP1    IFGT 0                                         S01494
     C           W#TMP1    MULT CRR2      W#COM                           S01494
     C                     ADD  W#COM     W#AMTC                          S01494
     C                     SUB  W#TMP1    W#AMTI                          S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C           CRS1      IFGT 0                                         S01494
     C********** W#AMTI    SUB  CRS1      W#TMP1 110               S01494 109214
     C           W#AMTI    SUB  CRS1      W#TMP1                          109214
     C           W#TMP1    IFGT 0                                         S01494
     C           W#TMP1    MULT CRR1      W#COM                           S01494
     C                     ADD  W#COM     W#AMTC                          S01494
     C                     SUB  W#TMP1    W#AMTI                          S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C           W#AMT     IFGT CRS0                                      S01494
     C*                                                                   S01494
     C** If commission is less than minimum                               S01494
     C*                                                                   S01494
     C           W#AMTC    IFLT CRMN0                                     S01494
     C                     Z-ADDCRMN0     W#AMTC                          S01494
     C                     ELSE                                           S01494
     C*                                                                   S01494
     C** If commission is more than maximum                               S01494
     C*                                                                   S01494
     C           CRMX0     IFNE *ZEROS                                    S01494
     C           W#AMTC    ANDGTCRMX0                                     S01494
     C                     Z-ADDCRMX0     W#AMTC                          S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C                     GOTO EXTR4C                                    S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C*                                                                   S01494
     C           W#AMT     IFGT CRS9                                      S01494
     C*                                                                   S01494
     C** If commission is less than minimum                               S01494
     C*                                                                   S01494
     C           W#AMTC    IFLT CRMN9                                     S01494
     C                     Z-ADDCRMN9     W#AMTC                          S01494
     C                     ELSE                                           S01494
     C*                                                                   S01494
     C** If commission is more than maximum                               S01494
     C*                                                                   S01494
     C           CRMX9     IFNE *ZEROS                                    S01494
     C           W#AMTC    ANDGTCRMX9                                     S01494
     C                     Z-ADDCRMX9     W#AMTC                          S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C                     GOTO EXTR4C                                    S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C*                                                                   S01494
     C           W#AMT     IFGT CRS8                                      S01494
     C*                                                                   S01494
     C** If commission is less than minimum                               S01494
     C*                                                                   S01494
     C           W#AMTC    IFLT CRMN8                                     S01494
     C                     Z-ADDCRMN8     W#AMTC                          S01494
     C                     ELSE                                           S01494
     C*                                                                   S01494
     C** If commission is more than maximum                               S01494
     C*                                                                   S01494
     C           CRMX8     IFNE *ZEROS                                    S01494
     C           W#AMTC    ANDGTCRMX8                                     S01494
     C                     Z-ADDCRMX8     W#AMTC                          S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C                     GOTO EXTR4C                                    S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C*                                                                   S01494
     C           W#AMT     IFGT CRS7                                      S01494
     C*                                                                   S01494
     C** If commission is less than minimum                               S01494
     C*                                                                   S01494
     C           W#AMTC    IFLT CRMN7                                     S01494
     C                     Z-ADDCRMN7     W#AMTC                          S01494
     C                     ELSE                                           S01494
     C*                                                                   S01494
     C** If commission is more than maximum                               S01494
     C*                                                                   S01494
     C           CRMX7     IFNE *ZEROS                                    S01494
     C           W#AMTC    ANDGTCRMX7                                     S01494
     C                     Z-ADDCRMX7     W#AMTC                          S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C                     GOTO EXTR4C                                    S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C*                                                                   S01494
     C           W#AMT     IFGT CRS6                                      S01494
     C*                                                                   S01494
     C** If commission is less than minimum                               S01494
     C*                                                                   S01494
     C           W#AMTC    IFLT CRMN6                                     S01494
     C                     Z-ADDCRMN6     W#AMTC                          S01494
     C                     ELSE                                           S01494
     C*                                                                   S01494
     C** If commission is more than maximum                               S01494
     C*                                                                   S01494
     C           CRMX6     IFNE *ZEROS                                    S01494
     C           W#AMTC    ANDGTCRMX6                                     S01494
     C                     Z-ADDCRMX6     W#AMTC                          S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C                     GOTO EXTR4C                                    S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C*                                                                   S01494
     C           W#AMT     IFGT CRS5                                      S01494
     C*                                                                   S01494
     C** If commission is less than minimum                               S01494
     C*                                                                   S01494
     C           W#AMTC    IFLT CRMN5                                     S01494
     C                     Z-ADDCRMN5     W#AMTC                          S01494
     C                     ELSE                                           S01494
     C*                                                                   S01494
     C** If commission is more than maximum                               S01494
     C*                                                                   S01494
     C           CRMX5     IFNE *ZEROS                                    S01494
     C           W#AMTC    ANDGTCRMX5                                     S01494
     C                     Z-ADDCRMX5     W#AMTC                          S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C                     GOTO EXTR4C                                    S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C*                                                                   S01494
     C           W#AMT     IFGT CRS4                                      S01494
     C*                                                                   S01494
     C** If commission is less than minimum                               S01494
     C*                                                                   S01494
     C           W#AMTC    IFLT CRMN4                                     S01494
     C                     Z-ADDCRMN4     W#AMTC                          S01494
     C                     ELSE                                           S01494
     C*                                                                   S01494
     C** If commission is more than maximum                               S01494
     C*                                                                   S01494
     C           CRMX4     IFNE *ZEROS                                    S01494
     C           W#AMTC    ANDGTCRMX4                                     S01494
     C                     Z-ADDCRMX4     W#AMTC                          S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C                     GOTO EXTR4C                                    S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C*                                                                   S01494
     C           W#AMT     IFGT CRS3                                      S01494
     C*                                                                   S01494
     C** If commission is less than minimum                               S01494
     C*                                                                   S01494
     C           W#AMTC    IFLT CRMN3                                     S01494
     C                     Z-ADDCRMN3     W#AMTC                          S01494
     C                     ELSE                                           S01494
     C*                                                                   S01494
     C** If commission is more than maximum                               S01494
     C*                                                                   S01494
     C           CRMX3     IFNE *ZEROS                                    S01494
     C           W#AMTC    ANDGTCRMX3                                     S01494
     C                     Z-ADDCRMX3     W#AMTC                          S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C                     GOTO EXTR4C                                    S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C*                                                                   S01494
     C           W#AMT     IFGT CRS2                                      S01494
     C*                                                                   S01494
     C** If commission is less than minimum                               S01494
     C*                                                                   S01494
     C           W#AMTC    IFLT CRMN2                                     S01494
     C                     Z-ADDCRMN2     W#AMTC                          S01494
     C                     ELSE                                           S01494
     C*                                                                   S01494
     C** If commission is more than maximum                               S01494
     C*                                                                   S01494
     C           CRMX2     IFNE *ZEROS                                    S01494
     C           W#AMTC    ANDGTCRMX2                                     S01494
     C                     Z-ADDCRMX2     W#AMTC                          S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C                     GOTO EXTR4C                                    S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C*                                                                   S01494
     C           W#AMT     IFGT CRS1                                      S01494
     C*                                                                   S01494
     C** If commission is less than minimum                               S01494
     C*                                                                   S01494
     C           W#AMTC    IFLT CRMN1                                     S01494
     C                     Z-ADDCRMN1     W#AMTC                          S01494
     C                     ELSE                                           S01494
     C*                                                                   S01494
     C** If commission is more than maximum                               S01494
     C*                                                                   S01494
     C           CRMX1     IFNE *ZEROS                                    S01494
     C           W#AMTC    ANDGTCRMX1                                     S01494
     C                     Z-ADDCRMX1     W#AMTC                          S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C                     GOTO EXTR4C                                    S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C** END for tiered calculations (calc type '1')                      S01494
     C*                                                                   S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C** Unwind subroutine stack name                                     S01494
     C*                                                                   S01494
     C           EXTR4C    TAG                                            S01494
     C                     MOVEA*BLANKS   @STK,Q                          S01494
     C                     SUB  1         Q                               S01494
     C*                                                                   S01494
     CSR                   ENDSR                                          S01494
     C/EJECT                                                              CEU006
     C*****************************************************************   CEU006
     C*                                                               *   CEU006
     C*  SRFT10   : Calculates Currency Amounts for EMU               *   CEU006
     C*                                                               *   CEU006
     C*             Converts P#FRAM in P#FRCY -> P#TOAM in P#TOCY.    *   CEU006
     C*                                                               *   CEU006
     C*  Called by: SROTPY                                            *   CEU006
     C*             SRINPY                                            *   CEU006
     C*             SRCP                                              *   CEU006
     C*             SRCC                                              *   CEU006
     C*                                                               *   CEU006
     C*  Calls    : FT0010 - Midas FT Calculate Currency Amounts.     *   CEU006
     C*                                                               *   CEU006
     C*****************************************************************   CEU006
     CSR         SRFT10    BEGSR                                          CEU006
     C/COPY WNCPYSRC,FT0320C052
     C*                                                                   CEU006
     C                     CALL 'FT0010'                                  CEU006
     C                     PARM           P#0010                          CEU006
      *                                                                   CEU006
      *  Check if database error occurred                                 CEU006
      *                                                                   CEU006
     C           P#RTCD    IFNE *BLANKS                                   CEU006
     C                     MOVEL'FT0010  'W0FILE                          CEU006
     C                     MOVELP#TOCY    W0KEY            ***************CEU006
     C                     Z-ADD26        W0ERNB           * DB ERROR 26 *CEU006
     C                     MOVEL'MEM5004' W0MSGD           ***************CEU006
     C                     MOVEL'MIDAS  ' W0MSGF                          CEU006
     C                     EXSR SRERR                                     CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
     CSR                   ENDSR                                          CEU006
     C/EJECT                                                              S01494
      *****************************************************************
      *                                                               *
      *  SRINIT   : Initialise and define fields                      *
      *                                                               *
      *  CALLED BY: Main processing                                   *
      *                                                               *
      *****************************************************************
     CSR         SRINIT    BEGSR
      *
      *  Set up copyright statement
      *
     C                     MOVEACPY@      BIS@   80
      *                                                                                       CSC022
      ** Check if CSC022 is switched *ON.                                                     CSC022
      *                                                                                       CSC022
     C                     CALL 'AOSARDR0'                                                    CSC022
     C                     PARM *BLANKS   @RTCD   7                                           CSC022
     C                     PARM '*VERIFY' @OPTN   7                                           CSC022
     C                     PARM 'CSC022'  @SARD   6                                           CSC022
      *                                                                                       CSC022
     C           @RTCD     IFEQ *BLANKS                                                       CSC022
     C                     MOVE 'Y'       CSC022  1                                           CSC022
     C           *NAMVAR   DEFN SCCMTJOB  SCCMT                                               CSC022
     C                     IN   SCCMT                                                         CSC022
     C                     Z-ADD1         C       30                                          CSC022
     C                     MOVEL*BLANKS   WCMTSK  1                                           CSC022
     C                     MOVEACMTARR    CMTJOB                                              CSC022
     C           CMTNUM    IFGT 0                                                             CSC022
     C           C         DOWLECMTNUM                                                        CSC022
     C           ##JOB     IFEQ CMTJOB,C                                                      CSC022
     C                     MOVEL'Y'       WCMTSK                                              CSC022
     C                     ENDIF                                                              CSC022
     C                     ADD  1         C                                                   CSC022
     C                     ENDDO                                                              CSC022
     C                     ENDIF                                                              CSC022
     C                     ELSE                                                               CSC022
     C                     MOVE 'N'       CSC022                                              CSC022
     C                     ENDIF                                                              CSC022
     C*                                                                   S01494
     C** Access SAR details file to determine if S01494 is switched ON    S01494
     C*                                                                   S01494
     C                     CALL 'AOSARDR0'                                S01494
     C                     PARM *BLANKS   P@RTCD  7                       S01494
     C                     PARM '*VERIFY' P@OPTN  7                       S01494
     C                     PARM 'S01494'  P@SARD  6                       S01494
     C           SCSARD    PARM SCSARD    DSFDY                           S01494
     C                     MOVE *BLANKS   S01494  6                       S01494
     C*                                                                   S01494
     C** If core feature is switched ON, set a variable field to          S01494
     C** condition the rest of the processing                             S01494
     C*                                                                   S01494
     C           P@RTCD    IFEQ *BLANKS                                   S01494
     C                     MOVE 'S01494'  S01494                          S01494
     C                     ELSE                                           S01494
     C*                                                                   S01494
     C** else, database error (return code other than *NRF)               S01494
     C*                                                                   S01494
     C           P@RTCD    IFNE '*NRF   '                                 S01494
     C                     MOVEL'SCSARDPD'W0FILE                          S01494
     C                     MOVEL'*CALL'   W0KEY             ************  S01494
     C                     Z-ADD17        W0ERNB            * DBERR 17 *  S01494
     C                     MOVEL'MEM5003' W0MSGD            ************  S01494
     C                     MOVEL'MIDAS  ' W0MSGF                          S01494
     C                     EXSR SRERR                                     S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C*                                                                   S01508
     C** Access SAR details file to determine if S01508 is switched ON    S01508
     C*                                                                   S01508
     C                     CALL 'AOSARDR0'                                S01508
     C                     PARM *BLANKS   P@RTCD  7                       S01508
     C                     PARM '*VERIFY' P@OPTN  7                       S01508
     C                     PARM 'S01508'  P@SARD  6                       S01508
     C           SCSARD    PARM SCSARD    DSFDY                           S01508
     C                     MOVE *BLANKS   S01508  6                       S01508
     C*                                                                   S01508
     C** If core feature is switched ON, set a variable field to          S01508
     C** condition the rest of the processing                             S01508
     C*                                                                   S01508
     C           P@RTCD    IFEQ *BLANKS                                   S01508
     C                     MOVE 'S01508'  S01508                          S01508
     C                     ELSE                                           S01508
     C*                                                                   S01508
     C** else, database error (return code other than *NRF)               S01508
     C*                                                                   S01508
     C           P@RTCD    IFNE '*NRF   '                                 S01508
     C                     MOVEL'SCSARDPD'W0FILE                          S01508
     C                     MOVEL'*CALL'   W0KEY             ************  S01508
     C                     Z-ADD18        W0ERNB            * DBERR 18 *  S01508
     C                     MOVEL'MEM5003' W0MSGD            ************  S01508
     C                     MOVEL'MIDAS  ' W0MSGF                          S01508
     C                     EXSR SRERR                                     S01508
     C                     END                                            S01508
     C                     END                                            S01508
     C*                                                                   S01508
     C** Set up data structure SEARCH fields                              S01508
     C*                                                                   S01508
     C           S01508    IFEQ 'S01508'                                  S01508
     C/COPY WNCPYSRC,FT0320C001
     C                     Z-ADD6         L#      50                      S01508
     C                     MOVE 'YYYYN'   SEARCH                          S01508
     C           2         OCUR SEARCH                                    S01508
     C                     MOVE 'YYNNN'   SEARCH                          S01508
     C           3         OCUR SEARCH                                    S01508
     C                     MOVE 'YNYYN'   SEARCH                          S01508
     C           4         OCUR SEARCH                                    S01508
     C                     MOVE 'YNYNN'   SEARCH                          S01508
     C           5         OCUR SEARCH                                    S01508
     C                     MOVE 'YNNN1'   SEARCH                          S01508
     C           6         OCUR SEARCH                                    S01508
     C                     MOVE 'YNNNN'   SEARCH                          S01508
     C/COPY WNCPYSRC,FT0320C002
     C                     ELSE                                           S01508
     C                     Z-ADD1         L#                              S01508
     C                     MOVE 'YNNNN'   SEARCH                          S01508
     C                     END                                            S01508
     C/COPY WNCPYSRC,FT0320C057
     C*                                                                   CEU006
     C** Access SAR details file to determine if CEU006 is switched ON    CEU006
     C*                                                                   CEU006
     C                     CALL 'AOSARDR0'                                CEU006
     C                     PARM *BLANKS   P@RTCD  7                       CEU006
     C                     PARM '*VERIFY' P@OPTN  7                       CEU006
     C                     PARM 'CEU006'  P@SARD  6                       CEU006
     C           SCSARD    PARM SCSARD    DSFDY                           CEU006
     C*                                                                   CEU006
     C** If core feature is switched ON, set a variable field to          CEU006
     C** condition the rest of the processing                             CEU006
     C*                                                                   CEU006
     C           P@RTCD    IFEQ *BLANKS                                   CEU006
     C                     MOVE 'Y'       CEU006  1                       CEU006
     C                     ELSE                                           CEU006
     C*                                                                   CEU006
     C** else, database error (return code other than *NRF)               CEU006
     C*                                                                   CEU006
     C           P@RTCD    IFNE '*NRF   '                                 CEU006
     C                     MOVEL'SCSARDPD'W0FILE                          CEU006
     C                     MOVEL'*CALL'   W0KEY             ************  CEU006
     C                     Z-ADD19        W0ERNB            * DBERR 19 *  CEU006
     C                     MOVEL'MEM5003' W0MSGD            ************  CEU006
     C                     MOVEL'MIDAS  ' W0MSGF                          CEU006
     C                     EXSR SRERR                                     CEU006
     C                     ENDIF                                          CEU006
     C                     ENDIF                                          CEU006
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SRINIT'  @STK,Q
      *
      *  Open file
      *
     C***********          OPEN PYCHGDB                                   S01508
     C                     OPEN PYCHGL1                                   S01508
      *
      *  Indicate that set up is complete
      *
     C                     SETON                     50
      *
      *  Get Rundate information
      *
     C           *NAMVAR   DEFN RUNDAT    RUNDTA
     C                     IN   RUNDTA
     C                     MOVE AGMRDT    WUMRDT  7        Midas Run date
     C                     MOVE AGRDNB    WURDNB  50       Run day number
     C                     MOVE AGSUC     WUSUC   1        Set up complete
     C                     MOVE AGDFF     WUDFF   1        Date Format
     C                     MOVE AGMBIN    WUMBIN  1        Multi Branched
      *
      *  Extract bank details
      *
     C                     CALL 'AOBANKR0'             9090
     C                     PARM *BLANKS   @RTCD   7        B:Return code
     C                     PARM '*FIRST ' @OPTN   7        I:Option
     C           SDBANK    PARM *BLANKS   DSFDY
      *
      *  If return with an error (LR seton in called program) then
      *  process for database error.
      *
     C           *IN90     IFEQ '1'
     C           @RTCD     OREQ '*ERROR*'
     C                     MOVEL'AOBANKR0'W0FILE
     C                     MOVEL'*CALL'   W0KEY            ***************
     C                     Z-ADD16        W0ERNB           * DB ERROR 16 *
     C                     MOVEL'MEM5003' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *
      *  Access Euro Currency Code from General Ledger ICD details.       CEU006
      *                                                                   CEU006
     C**********           CALL 'AOGELRR0'                                CEU006              CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM *BLANKS   @RTCD                           CEU006
     C                     PARM '*FIRST ' @OPTN                           CEU006
     C********** SDGELR    PARM SDGELR    DSFDY                           CEU006              CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
      *                                                                   CEU006
      *  Database error                                                   CEU006
      *                                                                   CEU006
     C           @RTCD     IFNE *BLANKS                                   CEU006
     C                     MOVEL'SDGELRPD'W0FILE                          CEU006
     C                     MOVEL'*CALL'   W0KEY            ***************CEU006
     C                     Z-ADD20        W0ERNB           * DB ERROR 20 *CEU006
     C                     MOVEL'MEM5003' W0MSGD           ***************CEU006
     C                     MOVEL'MIDAS  ' W0MSGF                          CEU006
     C                     EXSR SRERR                                     CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
      * Access Currency details for Other Currency (unless it's ***).     CEU006
      *                                                                   CEU006
     C                     MOVE 'N'       #INCYO  1                       CEU006
     C                     Z-ADD0         #TPSDO  50                      CEU006
     C           W0OCCY    IFNE '***'                                     CEU006
     C                     CALL 'AOCURRR0'                                CEU006
     C                     PARM *BLANKS   @RTCD                           CEU006
     C                     PARM '*KEY   ' @OPTN                           CEU006
     C                     PARM W0OCCY    @AJCD   3                       CEU006
     C           SDCURR    PARM SDCURR    DSSDY                           CEU006
      *                                                                   CEU006
      ** Database error                                                   CEU006
     C           @RTCD     IFNE *BLANK                                    CEU006
     C                     MOVEL'SDCURRPD'W0FILE                          CEU006
     C                     MOVELW0OCCY    W0KEY            ***************CEU006
     C                     Z-ADD21        W0ERNB           * DB ERROR 21 *CEU006
     C                     MOVEL'MEM5004' W0MSGD           ***************CEU006
     C                     MOVEL'MIDAS  ' W0MSGF                          CEU006
     C                     EXSR SRERR                                     CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
      * Save In Ccy Indicator as #INCYO and Transition Start as #TPSDO    CEU006
      *                                                                   CEU006
     C                     MOVE A6INCY    #INCYO                          CEU006
     C                     MOVE A6TPSD    #TPSDO                          CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
      * Access Currency details for Pay Currency                          CEU006
      *                                                                   CEU006
     C                     CALL 'AOCURRR0'                                CEU006
     C                     PARM *BLANKS   @RTCD                           CEU006
     C                     PARM '*KEY   ' @OPTN                           CEU006
     C                     PARM W0PCCY    @AJCD                           CEU006
     C           SDCURR    PARM SDCURR    DSSDY                           CEU006
      *                                                                   CEU006
      ** Database error                                                   CEU006
     C           @RTCD     IFNE *BLANK                                    CEU006
     C                     MOVEL'SDCURRPD'W0FILE                          CEU006
     C                     MOVELW0PCCY    W0KEY            ***************CEU006
     C                     Z-ADD22        W0ERNB           * DB ERROR 22 *CEU006
     C                     MOVEL'MEM5004' W0MSGD           ***************CEU006
     C                     MOVEL'MIDAS  ' W0MSGF                          CEU006
     C                     EXSR SRERR                                     CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
      * Save In Ccy Indicator as #INCYP and Transition Start as #TPSDP    CEU006
      *                                                                   CEU006
     C                     MOVE A6INCY    #INCYP  1                       CEU006
     C                     MOVE A6TPSD    #TPSDP  50                      CEU006
      *                                                                   CEU006
      * Access Currency details for Base Currency                         CEU006
      *                                                                   CEU006
     C                     CALL 'AOCURRR0'                                CEU006
     C                     PARM *BLANKS   @RTCD                           CEU006
     C                     PARM '*KEY   ' @OPTN                           CEU006
     C                     PARM BJCYCD    @AJCD                           CEU006
     C           SDCURR    PARM SDCURR    DSSDY                           CEU006
      *                                                                   CEU006
      ** Database error                                                   CEU006
     C           @RTCD     IFNE *BLANK                                    CEU006
     C                     MOVEL'SDCURRPD'W0FILE                          CEU006
     C                     MOVELBJCYCD    W0KEY            ***************CEU006
     C                     Z-ADD23        W0ERNB           * DB ERROR 23 *CEU006
     C                     MOVEL'MEM5004' W0MSGD           ***************CEU006
     C                     MOVEL'MIDAS  ' W0MSGF                          CEU006
     C                     EXSR SRERR                                     CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
      * Save In Ccy Indicator as #INCYB and Transition Start as #TPSDB    CEU006
      *                                                                   CEU006
     C                     MOVE A6INCY    #INCYB  1                       CEU006
     C                     MOVE A6TPSD    #TPSDB  50                      CEU006
      *                                                                   CEU006
      * Access Currency details for Input Currency                        CEU006
      *                                                                   CEU006
     C                     CALL 'AOCURRR0'                                CEU006
     C                     PARM *BLANKS   @RTCD                           CEU006
     C                     PARM '*KEY   ' @OPTN                           CEU006
     C                     PARM W0ICCY    @AJCD                           CEU006
     C           SDCURR    PARM SDCURR    DSSDY                           CEU006
      *                                                                   CEU006
      ** Database error                                                   CEU006
     C           @RTCD     IFNE *BLANK                                    CEU006
     C                     MOVEL'SDCURRPD'W0FILE                          CEU006
     C                     MOVELW0ICCY    W0KEY            ***************CEU006
     C                     Z-ADD24        W0ERNB           * DB ERROR 24 *CEU006
     C                     MOVEL'MEM5004' W0MSGD           ***************CEU006
     C                     MOVEL'MIDAS  ' W0MSGF                          CEU006
     C                     EXSR SRERR                                     CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
      * Save In Ccy Indicator as #INCYI and Transition Start as #TPSDI    CEU006
      *                                                                   CEU006
     C                     MOVE A6INCY    #INCYI  1                       CEU006
     C                     MOVE A6TPSD    #TPSDI  50                      CEU006
      *                                                                   CEU006
      * Access Currency details for Charge Currency                       CEU006
      *                                                                   CEU006
     C                     CALL 'AOCURRR0'                                CEU006
     C                     PARM *BLANKS   @RTCD                           CEU006
     C                     PARM '*KEY   ' @OPTN                           CEU006
     C                     PARM W0CCCY    @AJCD                           CEU006
     C           SDCURR    PARM SDCURR    DSSDY                           CEU006
      *                                                                   CEU006
      ** Database error                                                   CEU006
     C           @RTCD     IFNE *BLANK                                    CEU006
     C                     MOVEL'SDCURRPD'W0FILE                          CEU006
     C                     MOVELW0CCCY    W0KEY            ***************CEU006
     C                     Z-ADD25        W0ERNB           * DB ERROR 25 *CEU006
     C                     MOVEL'MEM5004' W0MSGD           ***************CEU006
     C                     MOVEL'MIDAS  ' W0MSGF                          CEU006
     C                     EXSR SRERR                                     CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
      * Save In Ccy Indicator as #INCYC and Transition Start as #TPSDC    CEU006
      *                                                                   CEU006
     C                     MOVE A6INCY    #INCYC  1                       CEU006
     C                     MOVE A6TPSD    #TPSDC  50                      CEU006
     C/COPY WNCPYSRC,FT0320C053
      *                                                                   CEU006
      *  Unwind subroutine stack name
      *
     C           EXINIT    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
     C/EJECT
      *****************************************************************   140624
      *                                                               *   140624
      *  CEU006   : Access currency details.                          *   140624
      *                                                               *   140624
      *  CALLED BY: Main processing                                   *   140624
      *                                                               *   140624
      *****************************************************************   140624
     C           CEUINI    BEGSR                                          140624
      *                                                                   140624
     C                     ADD  1         Q       50                      140624
     C                     MOVEL'CEUINI'  @STK,Q                          140624
      *                                                                   140624
      *                                                                   140624
      * Access Currency details for Other Currency (unless it's ***).     140624
      *                                                                   140624
     C                     MOVE 'N'       #INCYO  1                       140624
     C                     Z-ADD0         #TPSDO  50                      140624
     C           W0OCCY    IFNE '***'                                     140624
     C                     CALL 'AOCURRR0'                                140624
     C                     PARM *BLANKS   @RTCD                           140624
     C                     PARM '*KEY   ' @OPTN                           140624
     C                     PARM W0OCCY    @AJCD   3                       140624
     C           SDCURR    PARM SDCURR    DSSDY                           140624
      *                                                                   140624
      ** Database error                                                   140624
     C           @RTCD     IFNE *BLANK                                    140624
     C                     MOVEL'SDCURRPD'W0FILE                          140624
     C                     MOVELW0OCCY    W0KEY            ***************140624
     C                     Z-ADD21        W0ERNB           * DB ERROR 21 *140624
     C                     MOVEL'MEM5004' W0MSGD           ***************140624
     C                     MOVEL'MIDAS  ' W0MSGF                          140624
     C                     EXSR SRERR                                     140624
     C                     ENDIF                                          140624
      *                                                                   140624
      * Save In Ccy Indicator as #INCYO and Transition Start as #TPSDO    140624
      *                                                                   140624
     C                     MOVE A6INCY    #INCYO                          140624
     C                     MOVE A6TPSD    #TPSDO                          140624
     C                     ENDIF                                          140624
      *                                                                   140624
      * Access Currency details for Pay Currency                          140624
      *                                                                   140624
     C                     CALL 'AOCURRR0'                                140624
     C                     PARM *BLANKS   @RTCD                           140624
     C                     PARM '*KEY   ' @OPTN                           140624
     C                     PARM W0PCCY    @AJCD                           140624
     C           SDCURR    PARM SDCURR    DSSDY                           140624
      *                                                                   140624
      ** Database error                                                   140624
     C           @RTCD     IFNE *BLANK                                    140624
     C                     MOVEL'SDCURRPD'W0FILE                          140624
     C                     MOVELW0PCCY    W0KEY            ***************140624
     C                     Z-ADD22        W0ERNB           * DB ERROR 22 *140624
     C                     MOVEL'MEM5004' W0MSGD           ***************140624
     C                     MOVEL'MIDAS  ' W0MSGF                          140624
     C                     EXSR SRERR                                     140624
     C                     ENDIF                                          140624
      *                                                                   140624
      * Save In Ccy Indicator as #INCYP and Transition Start as #TPSDP    140624
      *                                                                   140624
     C                     MOVE A6INCY    #INCYP  1                       140624
     C                     MOVE A6TPSD    #TPSDP  50                      140624
      *                                                                   140624
      * Access Currency details for Base Currency                         140624
      *                                                                   140624
     C                     CALL 'AOCURRR0'                                140624
     C                     PARM *BLANKS   @RTCD                           140624
     C                     PARM '*KEY   ' @OPTN                           140624
     C                     PARM BJCYCD    @AJCD                           140624
     C           SDCURR    PARM SDCURR    DSSDY                           140624
      *                                                                   140624
      ** Database error                                                   140624
     C           @RTCD     IFNE *BLANK                                    140624
     C                     MOVEL'SDCURRPD'W0FILE                          140624
     C                     MOVELBJCYCD    W0KEY            ***************140624
     C                     Z-ADD23        W0ERNB           * DB ERROR 23 *140624
     C                     MOVEL'MEM5004' W0MSGD           ***************140624
     C                     MOVEL'MIDAS  ' W0MSGF                          140624
     C                     EXSR SRERR                                     140624
     C                     ENDIF                                          140624
      *                                                                   140624
      * Save In Ccy Indicator as #INCYB and Transition Start as #TPSDB    140624
      *                                                                   140624
     C                     MOVE A6INCY    #INCYB  1                       140624
     C                     MOVE A6TPSD    #TPSDB  50                      140624
      *                                                                   140624
      * Access Currency details for Input Currency                        140624
      *                                                                   140624
     C                     CALL 'AOCURRR0'                                140624
     C                     PARM *BLANKS   @RTCD                           140624
     C                     PARM '*KEY   ' @OPTN                           140624
     C                     PARM W0ICCY    @AJCD                           140624
     C           SDCURR    PARM SDCURR    DSSDY                           140624
      *                                                                   140624
      ** Database error                                                   140624
     C           @RTCD     IFNE *BLANK                                    140624
     C                     MOVEL'SDCURRPD'W0FILE                          140624
     C                     MOVELW0ICCY    W0KEY            ***************140624
     C                     Z-ADD24        W0ERNB           * DB ERROR 24 *140624
     C                     MOVEL'MEM5004' W0MSGD           ***************140624
     C                     MOVEL'MIDAS  ' W0MSGF                          140624
     C                     EXSR SRERR                                     140624
     C                     ENDIF                                          140624
      *                                                                   140624
      * Save In Ccy Indicator as #INCYI and Transition Start as #TPSDI    140624
      *                                                                   140624
     C                     MOVE A6INCY    #INCYI  1                       140624
     C                     MOVE A6TPSD    #TPSDI  50                      140624
      *                                                                   140624
      * Access Currency details for Charge Currency                       140624
      *                                                                   140624
     C                     CALL 'AOCURRR0'                                140624
     C                     PARM *BLANKS   @RTCD                           140624
     C                     PARM '*KEY   ' @OPTN                           140624
     C                     PARM W0CCCY    @AJCD                           140624
     C           SDCURR    PARM SDCURR    DSSDY                           140624
      *                                                                   140624
      ** Database error                                                   140624
     C           @RTCD     IFNE *BLANK                                    140624
     C                     MOVEL'SDCURRPD'W0FILE                          140624
     C                     MOVELW0CCCY    W0KEY            ***************140624
     C                     Z-ADD25        W0ERNB           * DB ERROR 25 *140624
     C                     MOVEL'MEM5004' W0MSGD           ***************140624
     C                     MOVEL'MIDAS  ' W0MSGF                          140624
     C                     EXSR SRERR                                     140624
     C                     ENDIF                                          140624
      *                                                                   140624
      * Save In Ccy Indicator as #INCYC and Transition Start as #TPSDC    140624
      *                                                                   140624
     C                     MOVE A6INCY    #INCYC  1                       140624
     C                     MOVE A6TPSD    #TPSDC  50                      140624
      *                                                                   140624
      *  Unwind subroutine stack name                                     140624
      *                                                                   140624
     C                     MOVEA*BLANKS   @STK,Q                          140624
     C                     SUB  1         Q                               140624
      *                                                                   140624
     CSR                   ENDSR                                          140624
     C/EJECT                                                              PHSFIX
     C/COPY WNCPYSRC,FT0320DCPG
      *
      *  /Copy point for Calculations
      *
     C/EJECT
      *
      *  File and Program Error Processing
      *
     C/COPY FTCPYSRC,SRERRC
     C/EJECT
     O/COPY WNCPYSRC,FT0320DOPG
      *
      *  /Copy point for Outputs
      *
     O/EJECT
**  CPY@ table
(c) Misys International Banking Systems Ltd. 2001
