     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas FT Outgoing payments valid. S2/Lvl 2')           *
     F*****************************************************************
     F*                                                               *
     F*  Midas - Funds Transfer Module                            *
     F*                                                               *
     F*  FT0348 - Validate Outgoing Payments - Screen 2, Level 2      *
     F*                                                               *
     F*  Function:  This program validates the level 2 input for      *
     F*  Outgoing Payments.                                           *
     F*                                                               *
     F*  Called By: FT0345  - Outgoing Payments Maintenence Level 2   *
     F*                                                               *
      *  (c) Finastra International Limited 2001                      *
     F*                                                               *
      *  Last Amend No. AR918975           Date 21Mar12               *
      *  Prev Amend No. AR954113           Date 13Apr12               *
      *                 AR920077           Date 21Mar12               *
      *                 MD046248           Date 27Oct17               *
      *                 CLE134             Date 01Aug12               *
      *                 BUG26775           Date 23Nov09               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 BUG15201           Date 30Oct07               *
      *                 250600             Date 07Oct07               *
      *                 CRE026             Date 24May06               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CFT032             Date 11Sep06               *
      *                 CSW206             Date 03Jul06               *
      *                 CSD031             Date 10Apr06               *
      *                 CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 BUG3644            Date 12Jul04               *
      *                 CLE025             Date 20Oct03               *
      *                 CSC022             Date 24Feb04               *
      *                 CGL029             Date 01Sep03               *
      *                 CSW203             Date 26May03               *
      * Midas Release 4.01.01 ----------------------------------------*
      *                 CSW202             Date 20May02               *
      * Midas Release 4.01 -------------------------------------------*
      *                 CFT017             Date 08Nov01               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 CSW201             Date 02May01               *
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CFT009             Date 18Jul00               *
      * Midas DBA 3.04 -----------------------------------------------*
      *                 CFT014             Date 25May00               *
      * Midas DBA 3.03 -----------------------------------------------*
      * Midas DBA 3.02 -----------------------------------------------*
     F*                 CFT004             Date 05Aug99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
     F*                 148229             Date 13Dec98               *
     F*                 140624             DATE 26Aug98               *
     F*                 CEU006             DATE 30APR98               *
     F*                 S01408             DATE 11OCT96               *
     F*                 S01499             DATE 06JUN94               *
     F*                 S01494             DATE 25MAY94               *
     F*                 S01435             DATE 28SEP93               *
     F*                                                               *
     F*---------------------------------------------------------------*
     F*                                                               *
      *  AR918975 - Allow lower case SWIFT characters for STP.        *
      *             (Child: AR919050)                                 *
      *  AR954113 - Correct passed parameters to FT1020 for ordering  *
      *             customer/beneficiary validation.                  *
      *             (Child: AR654114)                                 *
      *  AR920077 - Correct :77B: validation. (Child: AR922613)       *
      *  MD046248 - Finastra Rebranding                               *
      *  CLE134 - Past Due Call Loan Processing (Recompile)           *
      *  BUG26775 - Validation error in Outgoing Validation Flag      *
      *  BUG15201 - Encounter Database Errors (Recompile)             *
      *  250600 - Fix CFT032 and CSW207 (recompile)                   *
      *  CRE026 - Consumer Banking (Recompile)                        *
      *  CFT032 - Account line in field 50k in MT103 (recompile)      *
      *  CSW206 - SWIFT 2006 Standard Changes                         *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  BUG3644 - Serious Error in Collateralised Lending (Recompile)*
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CSC022 - Commitment Control Changes for MidasPlus            *
      *           (Recompile)                                         *
      *  CGL029 - Increase Account Code to 10 digits (Recompile)      *
      *  CSW203 - SWIFT 2003 Standards Update                         *
      *  CSW202 - SWIFT 2002 Standards Update                         *
      *  CFT017 - Multilateral Inter-bank Exchange Fee. (Recompile)   *
      *  CSW201 - SWIFT 2001 Standards Update                         *
     F*  CFT009 - Fees and Charges Development                        *
      *  CFT014 - Straight-through Processing Phase 2 MT103           *
      *           Messages Generation for FT.                         *
     F*  CFT004 - International Bank Account Number                   *
     F*           Enable IBAN Number in field Intermediary Bank       *
     F*  148229 - Changes to /COPY FT0010I001 (Recompile only)        *
     F*  140624 - Create a new SR to access ccy details each time     *
     F*           this pgm is called since *IN50 is not reset to '0'  *
     F*           (due to RETRN) when several input are done.         *
     F*  CEU006 - EMU Funds Transfer Enhancement.                     *
     F*  S01408 - Addition of Core Hook FT0348CCP1                    *
     F*  S01499 - BLI V.A.T. Processing                               *
     F*         - Add total V.A.T. amount to total charges (TEMP02)   *
     F*         - Array @VAT should be loaded from the                *
     F*           message file (TEMP14)                               *
     F*  S01494 - BLI Funds Transfer Enhancements                     *
     F*  S01435 - Incoming Message Management                         *
     F*                                                               *
     F*****************************************************************
     F*
     F*  Indicator usage
     F*  ~~~~~~~~~~~~~~~
     F*
     F*  31    Invalid S.W.I.F.T. Address format
     F*  32    S.W.I.F.T. Address not on file
     F*
     F*  50    Program Initialised
     F*
     F*  90    General Error Indicator
     F*  91    / found
     F*  92    Embedded spaces found
     F*  93    Illegal characters found
     F*  94    Work indicator used in checking illegal characters
     F*
     F*  U7/U8 Error Ocurred
     F*  LR    End program
     F*
     F*****************************************************************
     F/COPY FTCPYSRC,SFTSWFTF
     F/COPY WNCPYSRC,FT0348DFPG
      *
      *  /Copy point for File Definition
      *
     F/EJECT
     E                    CPY@    1   1 80
      *
      *  Copyright table
      *
     E***********         ALPH   26  26  1                         CFT004 CFT014
      *Alphabetic array                                                   CFT004
     E***********         NUMC   10  10  1                         CFT004 CFT014
      *Numeric array                                                      CFT004
      *
     E**********          CODE1  12  12  4                                             CFT014 CSW202
     E                    CODE1  13  13  4                                                    CSW202
      ** Codewords use for MT103 messages                                 CFT014
      *                                                                   CFT014
     E**********          CODE2   7   7  4                                             CFT014 CSW202
     E                    CODE2   8   8  4                                                    CSW202
      ** Codewords use for MT103 messages                                 CFT014
      *                                                                   CFT014
     E                    #ER         6  1                                CFT014
      ** Array for validating Bank to Bank                                CFT014
      *                                                                   CFT014
     E/COPY WNCPYSRC,FT0348DEPG
      *
      *  /Copy point for Arrays
      *
     E/COPY FTCPYSRC,SRERRE
      *
      *  End of Copysource for error processing
      *
     E                    ERCD       38  4               Codes
     E/COPY FTCPYSRC,SFTSWFTE
      *
      *  Warning codes array
      *
     E                    WRN@       40  1               Warning array
      *                                                                                       CSW201
      ** Array for comparing entered Instruction Codes                                        CSW201
      *                                                                                       CSW201
     E                    WFD         5  4                                                    CSW201
      *                                                                                       CSW201
      ** Array of Instruction codewords in correct order                                      CSW201
      *                                                                                       CSW201
     E**********          WICOR  12  12  4                                             CSW201 CSW202
     E                    WICOR  13  13  4                                                    CSW202
     E********************@VAT    1   7 20               V.A.T. chaS01499 S01499
      *
     E/EJECT
      *
      * Constants                                                         CFT004
     I***********   'Intermediary     '   C         WINT           CFT004 CFT014
     I              '/CHGS/'              C         WCHGS                 CFT014
      *                                                                   CFT004
     I/COPY WNCPYSRC,FT0348DIPG
      *
      *  /Copy point for Input specifications
      *
     ICPYR@#      DS
      *
      *  Data structure for compilation  - Copyright insertion
      *
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
     I/COPY FTCPYSRC,SRERRI
      *
      *  End of Program Error Processing source
      *
     IRUNDTA    E DSRUNDAT
      *
      *  Define rundat data area
      *
      *
      *  Data Structures used by access programs
      *
     IDSFDY     E DSDSFDY                                                 S01494
     I*    DS for access program , short data structure                   S01494
     I*                                                                   S01494
     IDSSDY     E DSDSSDY
     I*
     I***SDCUST**  E DSSDCUSTPD                                           CFT014
      *
      *  Calling parameter data structure for AOCUSTR0
      *
     ISDCNST    E DSSDCNSTPD
      *
      *  Calling parameter data structure for ME1400
      *
     IMEBICD    E DSMEBICDPD
      *
      *  Calling parameter data structure for ME1400
      *
     ISDCURR    E DSSDCURRPD
      *
      *  Calling parameter data structure for AOCURRR0
      *
     ISDBANK    E DSSDBANKPD                                              CEU006
      *  Calling parameter data structure for AOBANKR0                    CEU006
      *                                                                   CEU006
     ISDGELR    E DSSDGELRPD                                              CEU006
      *  Calling parameter data structure for AOGELRR0                    CEU006
     I**                                                                  S01494
     ISCSARD    E DSSCSARDPD                                              S01494
     I* External data structure for SAR file details                      S01494
     I*                                                                   S01494
     ISDCTRY    E DSSDCTRYPD                                              CFT014
      ** Country Codes external data structure                            CFT014
      *                                                                   CFT014
     I/COPY FTCPYSRC,FT0010I001                                           CEU006
      **  Input/output parameters for call to FT0010.                     CEU006
      *                                                                   CEU006
     I***D#DTA***    DS                            256                    CFT014
      ************                                                        CFT014
      ***Calling*parameter*data*structure*for*AOCCYCV0*****************   CFT014
      ***********                                                         CFT014
      ***********                             From Currency & amount      CFT014
     I***********                             1   3 D#FCCY                CFT014
     I***********                         P   4  110D#FAMT                CFT014
      ***********                             To Currency & amount        CFT014
     I***********                            12  14 D#TCCY                CFT014
     I***********                         P  15  220D#TAMT                CFT014
      ***********                             Rate and multi/div ind.     CFT014
     I***********                            23  23 I#MDIN                CFT014
     I***********                         P  24  368I#RATE                CFT014
      ***********                  Output     Rate and multi/div ind.     CFT014
      ***********                             If no in rate               CFT014
     I***********                            37  37 O#MDIN                CFT014
     I***********                         P  38  508O#RATE                CFT014
      /EJECT
      *
     E/COPY FTCPYSRC,SFT0345S6
     E/COPY WNCPYSRC,FT0348E001
     E/COPY FTCPYSRC,SFTVALDI
     E/COPY FTCPYSRC,SFT0345F6
     E/COPY FTCPYSRC,SFT0345I6
     E/COPY FTCPYSRC,SFTADDRI
     E/COPY FTCPYSRC,SFT0340F                                                               BUG26775
     E/COPY FTCPYSRC,SFT0340S                                                               BUG26775
     E/COPY FTCPYSRC,SFT0345S5                                                              BUG26775
     E/COPY FTCPYSRC,SFT0345F5                                                              BUG26775
     I***CLSWTK**    DS                                                   CFT014
      ***********                                                         CFT014
      ***Redefine*SWIFT*array*as*field*for*SETLL.**********************   CFT014
      ***********                                                         CFT014
     I***********                             1  12 SW                    CFT014
      *
     IDSMTR       DS
      *
      *  Define fields for message transalation
      *
     I                                        1 132 #MSDTA
     I                                       15  30 #MPREF
     I                                    P   1   20#MPART
     I                                      133 264 #MSTX1
     I#MSTX2      DS
     I                                        1 256 #MSTXA
     I                                      257 512 #MSTXB
      *                                                                   CFT014
      ** Input paramter                                                   CFT014
     I***I#PARM*     DS                            512                                 CFT014 CGL029
     II#PARM      DS                            514                                           CGL029
      * Field to be validated                                             CFT014
     I                                        1   5 I#VFLD                CFT014
      * Pay/Receive Settlement (PAY/REC)                                  CFT014
     I                                        6   8 I#PR                  CFT014
      * Customer/Counterparty Nostro /BIC indentified type                CFT014
      *    C           X              S  X-> C'party Nostro or Customer   CFT014
      * Customer/Counterparty/BIC indentified                             CFT014
     I                                        9   9 I#PRTT                CFT014
     I                                       10  20 I#PRTY                CFT014
      * Pay Currency                                                      CFT014
     I                                       21  23 I#PCCY                CFT014
      * Receive Currency                                                  CFT014
     I                                       24  26 I#RCCY                CFT014
      * Account Line                                                      CFT014
     I                                       27  61 I#ACLN                CFT014
      * Account Line Character 1                                          CFT014
     I                                       27  27 I#ACC1                CFT014
      * Account Line Character 2                                          CFT014
     I                                       28  28 I#ACC2                CFT014
      * Account Line Character 3                                          CFT014
     I                                       29  29 I#ACC3                CFT014
      * Account Line first 4 characters                                   CFT014
     I                                       27  30 I#ACCL                CFT014
      * Account Line Clearing System                                      CFT014
     I                                       29  30 I#ACCS                CFT014
      * Account Line No account data                                      CFT014
     I                                       31  61 I#SPC1                CFT014
      * Message Type                                                      CFT014
     I                                       62  64 I#MTYP                CFT014
      * Intermediary Institution for Bank to Bank validation              CFT014
     I                                       65  65 I#INBT                CFT014
     I                                       66  76 I#INBK                CFT014
      * Account with Institution for Bank to Bank validation              CFT014
     I                                       77  77 I#AWBT                CFT014
     I                                       78  88 I#AWBK                CFT014
      * Beneficiary for Bank to Bank validation                           CFT014
     I                                       89  89 I#BENT                CFT014
     I                                       90 100 I#BENF                CFT014
      * Pay and Receive Settlement Methods                                CFT014
     I                                      101 102 I#RSTM                CFT014
     I                                      103 104 I#PSTM                CFT014
      * Field 53 and 54 Entered                                           CFT014
     I                                      105 105 I#5354                CFT014
      * Midas Module                                                      CFT014
     I                                      106 107 I#MMOD                CFT014
      * Pay and Receive Settlement Accounts                               CFT014
     I**********                            108 125 I#PYAC                             CFT014 CGL029
     I**********                            126 143 I#RCAC                             CFT014 CGL029
     I                                      108 125 QQPYAC                                    CGL029
     I                                      126 143 QQRCAC                                    CGL029
      * Transaction Type                                                  CFT014
     I                                      144 145 I#TTYP                CFT014
      * Cover Required ?                                                  CFT014
     I                                      146 146 I#COVR                CFT014
      * Bank to Bank Information                                          CFT014
     I                                      257 466 I#BTB                 CFT014
     I                                      257 291 I#BTB1                CFT014
     I                                      292 326 I#BTB2                CFT014
     I                                      327 361 I#BTB3                CFT014
     I                                      362 396 I#BTB4                CFT014
     I                                      397 431 I#BTB5                CFT014
     I                                      432 466 I#BTB6                CFT014
     I                                      467 490 I#PYAC                                    CGL029
     I                                      491 514 I#RCAC                                    CGL029
      *                                                                   CFT014
      ** Output parameters                                                CFT014
     I***O#PARM*     DS                            512                                 CFT014 CGL029
     IO#PARM      DS                            514                                           CGL029
      * Account Line modified                                             CFT014
     I                                        1  35 O#ACLN                CFT014
      * Bank to Bank Information                                          CFT014
     I                                      257 466 O#BTB                 CFT014
     I                                      257 291 O#BTB1                CFT014
     I                                      292 326 O#BTB2                CFT014
     I                                      327 361 O#BTB3                CFT014
     I                                      362 396 O#BTB4                CFT014
     I                                      397 431 O#BTB5                CFT014
     I                                      432 466 O#BTB6                CFT014
      *                                                                   CFT014
      ** Error parameters                                                 CFT014
     IX#PARM      DS                            256                       CFT014
      * Calling Program                                                   CFT014
     I                                        1  10 X#CPGM                CFT014
      * Error message sent                                                CFT014
     I                                       12  12 X#ERRM                CFT014
      * Warning message sent                                              CFT014
     I                                       13  13 X#WARN                CFT014
      * Error index                                                       CFT014
     I                                       14  180X#INDX                CFT014
      * Message text to prefix error message                              CFT014
     I                                       19  25 X#MSGD                CFT014
     I                                       26  35 X#MSGF                CFT014
      * Fields in error                                                   CFT014
     I                                       36  41 X#FLDS                CFT014
      * Error codes array                                                 CFT014
     I                                       51 200 X#ERCD                CFT014
     I                                       51 200 O#E                   CFT014
      *                                                                   CFT014
     I            DS                                                      CFT014
     I                                        1 175 WSINCD                CFT014
     I                                        1   4 WCDWD1                CFT014
     I                                        5   5 WSLSH1                CFT014
     I                                        1  35 WSINC1                CFT014
     I                                       36 175 WL2345                CFT014
     I                                       36  39 WCDWD2                CFT014
     I                                       40  40 WSLSH2                CFT014
     I                                       36  70 WSINC2                CFT014
     I                                       71 175 WL345                 CFT014
     I                                       71  74 WCDWD3                CFT014
     I                                       75  75 WSLSH3                CFT014
     I                                       71 105 WSINC3                CFT014
     I                                      106 175 WL45                  CFT014
     I                                      106 109 WCDWD4                CFT014
     I                                      110 110 WSLSH4                CFT014
     I                                      106 140 WSINC4                CFT014
     I                                      141 144 WCDWD5                CFT014
     I                                      145 145 WSLSH5                CFT014
     I                                      141 175 WSINC5                CFT014
      *                                                                   CFT014
     I            DS                                                      CFT014
     I                                        1 105 WRRPT                 CFT014
     I                                        1  10 WCWORD                CFT014
     I                                       11  12 WISOCD                CFT014
     I                                       13  14 WADSLH                CFT014
     I                                       15  35 WADINF                CFT014
     I                                       38  70 WADIN2                CFT014
     I                                       73 105 WADIN3                CFT014
     I                                       36 105 WRL23                 CFT014
      *                                                                   CFT014
     I              '/ORDERRES/'          C         WORDER                CFT014
     I              '/BENEFRES/'          C         WBENEF                CFT014
      *                                                                   CFT014
     I/COPY WNCPYSRC,FT0348I001
      *
     E/COPY FTCPYSRC,SFTVALCS
     I/EJECT
      *****************************************************************
      *                 M A I N L I N E
      *****************************************************************
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q
     C                     MOVEL'MAIN'    @STK,Q
      *
      *  Define entry parameters
      *
     C           *ENTRY    PLIST
     C                     PARM           W0RTN   7
     C                     PARM           W0ACT   8
     C                     PARM           S6DATA
     C                     PARM           V#DATA
     C                     PARM           F6DATA
     C                     PARM           E#DATA
     C                     PARM           C#DATA
     C                     PARM           I6DATA
     C                     PARM           S4DATA                                            BUG26775
     C                     PARM           F4DATA                                            BUG26775
     C                     PARM           S5DATA                                            BUG26775
     C                     PARM           F5DATA                                            BUG26775
     C/COPY WNCPYSRC,FT0348C033
      *
      *  Initialise program
      *
     C           *IN50     IFEQ '0'
     C                     EXSR SRINIT
     C                     END
     C/COPY WNCPYSRC,FT0348C013
      *
      * Access CCY detail                                                 140624
     C***********CEU006    IFEQ 'Y'                                140624 CFT014
     C***********          EXSR CEUINI                             140624 CFT014
     C***********          END                                     140624 CFT014
      *                                                                   140624
      *  Set up primary reference for errors
      *
     C                     MOVELS6DATA    W0PREF
      *
      *  Determine the mode of processing and execute subroutine :-
      *
      *
      *  Action Code : *VALID
      *  --------------------
      *
      *  Called from FT0355
      *  To validate all input fields on the detail screen.
      *  Once verified, control returns to the calling program where
      *  the appropriate error indicators are set on and processing
      *  continues.
      *
      *
     C           W0ACT     CASEQ'*VALID  'SRPROC
     C                     CAS            SRACT
     C                     END
      *
      *  Unwind subroutine stack name
      *
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
      *  Return to calling program
      *
     C                     RETRN
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRPROC   : Validate All Detail Fields Entered                *
      *             Seton appropriate indicators and set up the array *
      *             of relevant error codes for display.              *
      *                                                               *
      *  CALLED BY: Main processing section                           *
      *                                                               *
      *  CALLS    : SRERR   - report error and close down program     *
      *                                                               *
      *****************************************************************
     CSR         SRPROC    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q
     C                     MOVEL'SRPROC'  @STK,Q
      *
      *  /COPY Statement
      *
     C/COPY WNCPYSRC,FT0348PROC
      *
      *  Move warning array passed to WRN@ and error indicators
      *
     C                     MOVEAE#WARA    WRN@
     C                     MOVEA*BLANKS   ERCD
     C                     MOVE I6INB1    W6INB1 35                                           CSW201
     C                     CLEARI6DATA
     C                     Z-ADD0         X       50
      ***********                                                         CFT014
      ***Validate*Intermediary*Bank************************************   CFT014
      ***********                                                         CFT014
     C***********          EXSR SRINBK                                    CFT014
      *                                                                   CFT014
      ** Validate Details of Payment                                      CFT014
      *                                                                   CFT014
     C                     EXSR SRDPAY                                    CFT014
      *                                                                   CFT014
      ** Validate Bank to Bank Information                                CFT014
      *                                                                   CFT014
     C                     EXSR SRBTOB                                    CFT014
      *
      *  Validate Central Bank Reference
      *
     C                     EXSR SRNBKC
      *                                                                   CFT014
      ** Transfer Commission Tariff                                       CFT014
      *                                                                   CFT014
     C           CFT009    IFEQ 'N'                                       CFT009
     C                     EXSR SRTRCT                                    CFT014
     C                     ENDIF                                          CFT009
      ***********                                                         CFT014
      ***Validate*Details*Of*Charges***********************************   CFT014
      ***********                                                         CFT014
     C***********          EXSR SRDETC                                    CFT014
      ***********                                                         CFT014
      ***Get*currency*information*for*charge*amount*validation*********   CFT014
      ***********                                                         CFT014
     C***********          EXSR SRCCCY                                    CFT014
      ***********                                                         CFT014
      ***Validate*Transmission*Charge**********************************   CFT014
      ***********                                                         CFT014
     C***********          EXSR SRTRCM                                    CFT014
      ***********                                                         CFT014
      ***Validate*Telex*Charge*****************************************   CFT014
      ***********                                                         CFT014
     C***********          EXSR SRTXCH                                    CFT014
      ***********                                                         CFT014
      ***Validate*Cheque*Charge****************************************   CFT014
      ***********                                                         CFT014
     C***********          EXSR SRCQCH                                    CFT014
      ***********                                                         CFT014
      ***Validate*Costs*Abroad*****************************************   CFT014
      ***********                                                         CFT014
     C***********          EXSR SRCSTH                                    CFT014
      ***********                                                         CFT014
      ***Validate*SWIFT*Priority***************************************   CFT014
      ***********                                                         CFT014
     C***********          EXSR SRSPCH                                    CFT014
      ***********                                                         CFT014
      ***Validate*Miscellaneous*Charge*********************************   CFT014
      ***********                                                         CFT014
     C***********          EXSR SRMSCH                                    CFT014
     C***********                                                  S01494 CFT014
     C***Validate*FX/Change*Commission*if*S01494*is*switched*ON****S01494 CFT014
     C***********                                                  S01494 CFT014
     C***********S01494    IFEQ 'Y'                                S01494 CFT014
     C***********          EXSR SRCHCM                             S01494 CFT014
     C***********          END                                     S01494 CFT014
     C***********                                                  S01499 CFT014
     C***Validate*V.A.T.*flags*if*V.A.T.*processing*allowed********S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********V#VATP    IFEQ 'Y'                                S01499 CFT014
     C***********          EXSR SRVATT                             S01499 CFT014
     C***********          END                                     S01499 CFT014
     C***********                                                  S01499 CFT014
     C***Calculate*V.A.T.*charge*amounts*if*V.A.T.*processing*allowS01499 CFT014
     C***********                                                  S01499 CFT014
     C***********V#VATP    IFEQ 'Y'                                S01499 CFT014
     C***********          EXSR SRVATC                             S01499 CFT014
     C***********          END                                     S01499 CFT014
      ***********                                                         CFT014
      ***Check*that*Total*Charges*do*not*exceed*payment*amount*********   CFT014
      ***********                                                         CFT014
     C***********          EXSR SRTOT                                     CFT014
     C/COPY WNCPYSRC,FT0348C032
      *
      *  Validate CHAPS Code
      *
     C                     EXSR SRCHAP
      *                                                                   CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
     C                     EXSR SRINCD                                    CFT014
     C                     EXSR SRRRPT                                    CFT014
     C                     ENDIF                                          CFT014
      *
      *  Cross validations
      *
     C           E#NOUP    IFEQ *BLANKS
     C                     EXSR SRXVAL
     C/COPY WNCPYSRC,FT0348C011
     C                     END
     C/COPY WNCPYSRC,FT0348C031
      *
      *  End Of Validation - set parameters for return
      *
      *
      *  Move waring array back and errors
      *
     C                     MOVEAWRN@      E#WARA
     C                     MOVEAERCD      C#ERCD
      *
      *  Unwind subroutine stack name
      *
     C           EXPROC    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
     C/EJECT
      *****************************************************************   CFT014
      /TITLE SR/SRDPAY                                                    CFT014
      *****************************************************************   CFT014
      *                                                               *   CFT014
      *  SRDPAY - Validate Details of Payment                         *   CFT014
      *                                                               *   CFT014
      *  Called By: SRPROC subroutine                                 *   CFT014
      *                                                               *   CFT014
      *  Calls:                                                       *   CFT014
      *  FTSNMS    - Send message to program message queue.           *   CFT014
      *  ADCHK     - Validate Address fields.                         *   CFT014
      *                                                               *   CFT014
      *****************************************************************   CFT014
      *                                                                   CFT014
     C           SRDPAY    BEGSR                           *** SRDPAY *** CFT014
      *                                                                   CFT014
      ** Set up subroutine stack name                                     CFT014
      *                                                                   CFT014
     C                     ADD  1         Q       50                      CFT014
     C                     MOVEL'SRDPAY'  @STK,Q                          CFT014
      *                                                                                     BUG26775
      ** Check if Ordering Customer/Beneficiary is a bank                                   BUG26775
      *                                                                                     BUG26775
     C                     CALL 'FT1020'                                                    BUG26775
     C                     PARM F4ORCT    INTYP   1                                         BUG26775
     C                     PARM V#SMCY    INCCY   3                                         BUG26775
     C                     PARM S4ORC1    ENTR1  35                                         BUG26775
     C                     PARM S4ORC2    ENTR2  35                                         BUG26775
     C                     PARM S4ORC3    ENTR3  35                                         BUG26775
     C                     PARM S4ORC4    ENTR4  35                                         BUG26775
     C                     PARM *BLANKS   ENTR5  35                                         BUG26775
     C                     PARM F5BNCT    INTYP   1                                         BUG26775
     C                     PARM V#PCCY    INCCY   3                                         BUG26775
     C**********           PARM S5BNC1    ENTR1  35                                BUG26775 AR954113
     C**********           PARM S5BNC2    ENTR2  35                                BUG26775 AR954113
     C**********           PARM S5BNC3    ENTR3  35                                BUG26775 AR954113
     C**********           PARM S5BNC4    ENTR4  35                                BUG26775 AR954113
     C**********           PARM S5BNC5    ENTR5  35                                BUG26775 AR954113
     C                     PARM S5BNC1    BNTR1  35                                         AR954113
     C                     PARM S5BNC2    BNTR2  35                                         AR954113
     C                     PARM S5BNC3    BNTR3  35                                         AR954113
     C                     PARM S5BNC4    BNTR4  35                                         AR954113
     C                     PARM S5BNC5    BNTR5  35                                         AR954113
     C                     PARM 'C'       CTYP    1                                         BUG26775
      *                                                                   CFT014
      ** If MT202 in Ordering Customer then this field should be          CFT014
      ** blank as :70: not on MT200 series messages                       CFT014
      *                                                                   CFT014
     C           S6PAY     IFNE *BLANKS                                   CFT014
     C           V#ORC1    ANDEQORCFLD                                    CFT014
     C           S6PAY     ORNE *BLANKS                                                     BUG26775
     C           CTYP      ANDEQ'B'                                                         BUG26775
     C/COPY WNCPYSRC,FT0348C046
     C                     MOVEL'Y'       E#MSGS                          CFT014
     C                     MOVELS6PAY1    FTMSDT                          CFT014
     C                     MOVELE#CPGM    FTPGMQ                          CFT014
     C                     MOVEL'FTM2351' FTMSID                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVEL'Y'       I6PAY                           CFT014
     C                     MOVEL'Y'       E#NOUP                          CFT014
     C                     GOTO EXDPAY                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Validate details of payment                                      CFT014
      *                                                                   CFT014
     C           S6PAY     IFNE *BLANKS                                   CFT014
      *                                                                   CFT014
      ** Prevent first check in ADCHK subroutine                          CFT014
      *                                                                   CFT014
     C                     MOVEL' '       ADLINE                          CFT014
     C                     MOVEL'FTM2317' ADFLDM                          CFT014
     C                     MOVEL'FTUSRMSG'ADFLDF                          CFT014
      *                                                                   CFT014
     C                     MOVE *BLANKS   ADDRSS                          CFT014
     C                     MOVELS6PAY     ADDRSS                          CFT014
      *                                                                   CFT014
     C                     EXSR ADCHK                                     CFT014
      *                                                                   CFT014
      ** Depending on the indicators, highlight the field in error        CFT014
      *                                                                   CFT014
     C           *IN92     IFEQ *ON                                       CFT014
     C                     MOVEL'Y'       E#MSGS                          CFT014
     C                     MOVELS6PAY1    FTMSDT                          CFT014
     C                     MOVELE#CPGM    FTPGMQ                          CFT014
     C                     MOVEL'FTM2225' FTMSID                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVEL'Y'       I6PAY                           CFT014
     C                     MOVEL'Y'       E#NOUP                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Illegal Characters found                                         CFT014
      *                                                                   CFT014
     C           *IN93     IFEQ *ON                                       CFT014
     C                     MOVEL'Y'       E#NOUP                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           AD#1      IFEQ 'Y'                                       CFT014
     C                     MOVEL'Y'       I6PAY1                          CFT014
     C                     ENDIF                                          CFT014
     C           AD#2      IFEQ 'Y'                                       CFT014
     C                     MOVEL'Y'       I6PAY2                          CFT014
     C                     ENDIF                                          CFT014
     C           AD#3      IFEQ 'Y'                                       CFT014
     C                     MOVEL'Y'       I6PAY3                          CFT014
     C                     ENDIF                                          CFT014
     C           AD#4      IFEQ 'Y'                                       CFT014
     C                     MOVEL'Y'       I6PAY4                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C/COPY WNCPYSRC,FT0348C040
      ** Unwind subroutine stack name                                     CFT014
      *                                                                   CFT014
     C           EXDPAY    TAG                                            CFT014
     C                     MOVEA*BLANKS   @STK,Q                          CFT014
     C                     SUB  1         Q                               CFT014
      *                                                                   CFT014
     CSR                   ENDSR                                          CFT014
      *                                                                   CFT014
      *****************************************************************   CFT014
     C/EJECT                                                              CFT014
      *****************************************************************   CFT014
      /TITLE SR/SRBTOB                                                    CFT014
      *****************************************************************   CFT014
      *                                                               *   CFT014
      *  SRBTOB - Validate Bank to Bank Information                   *   CFT014
      *                                                               *   CFT014
      *  Called By: SRPROC subroutine                                 *   CFT014
      *                                                               *   CFT014
      *  Calls:                                                       *   CFT014
      *  FTSNMS    - Send message to program message queue.           *   CFT014
      *  ADCHK     - Validate Address fields.                         *   CFT014
      *  SRSEPT    - SWIFT validation changes.                        *   CFT014
      *                                                               *   CFT014
      *****************************************************************   CFT014
      *                                                                   CFT014
     C           SRBTOB    BEGSR                           *** SRBTOB *** CFT014
      *                                                                   CFT014
      ** Set up subroutine stack name                                     CFT014
      *                                                                   CFT014
     C                     ADD  1         Q       50                      CFT014
     C                     MOVEL'SRBTOB'  @STK,Q                          CFT014
     C                     Z-ADD11        Z       30                      CFT014
      *                                                                   CFT014
      ** Validate Bank to Bank Information                                CFT014
      *                                                                   CFT014
     C           S6BTB     IFNE *BLANKS                                   CFT014
     C                     MOVEL*BLANKS   ADDRSS                          CFT014
     C                     MOVELS6BTB     ADDRSS                          CFT014
     C                     MOVEL'FTM2318' ADFLDM                          CFT014
     C                     MOVEL'FTUSRMSG'ADFLDF                          CFT014
     C                     EXSR ADCHK                                     CFT014
      *                                                                   CFT014
      ** Depending on the indicators, highlight the field in error        CFT014
      *                                                                   CFT014
     C           *IN92     IFEQ *ON                                       CFT014
     C                     MOVEL'Y'       E#MSGS                          CFT014
     C                     MOVELS6PAY1    FTMSDT                          CFT014
     C                     MOVELE#CPGM    FTPGMQ                          CFT014
     C                     MOVEL'FTM2226' FTMSID                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVEL'Y'       I6BTB                           CFT014
     C                     MOVEL'Y'       E#NOUP                          CFT014
     C                     MOVEA' '       WRN@,Z                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C/COPY WNCPYSRC,FT0348C041
     C           *IN93     IFEQ *ON                                       CFT014
     C                     MOVEL'Y'       E#NOUP                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           AD#1      IFEQ 'Y'                                       CFT014
     C                     MOVEL'Y'       I6BTB1                          CFT014
     C                     ENDIF                                          CFT014
     C           AD#2      IFEQ 'Y'                                       CFT014
     C                     MOVEL'Y'       I6BTB2                          CFT014
     C                     ENDIF                                          CFT014
     C           AD#3      IFEQ 'Y'                                       CFT014
     C                     MOVEL'Y'       I6BTB3                          CFT014
     C                     ENDIF                                          CFT014
     C           AD#4      IFEQ 'Y'                                       CFT014
     C                     MOVEL'Y'       I6BTB4                          CFT014
     C                     ENDIF                                          CFT014
     C           AD#5      IFEQ 'Y'                                       CFT014
     C                     MOVEL'Y'       I6BTB5                          CFT014
     C                     ENDIF                                          CFT014
     C           AD#6      IFEQ 'Y'                                       CFT014
     C                     MOVEL'Y'       I6BTB6                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Warning if codeword /CHGS/ exists in bank to bank fields         CFT014
      *                                                                   CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
     C           WCHGS:6   SCAN S6BTB:1   WLOCAT  30     38               CFT014
     C           *IN38     IFEQ *ON                                       CFT014
      *                                                                   CFT014
     C           WLOCAT    IFLE 35                                        CFT014
     C                     MOVE 'Y'       I6BTB1                          CFT014
     C                     ENDIF                                          CFT014
     C           WLOCAT    IFLE 70                                        CFT014
     C           WLOCAT    ANDGT35                                        CFT014
     C                     MOVE 'Y'       I6BTB2                          CFT014
     C                     ENDIF                                          CFT014
     C           WLOCAT    IFLE 105                                       CFT014
     C           WLOCAT    ANDGT70                                        CFT014
     C                     MOVE 'Y'       I6BTB3                          CFT014
     C                     ENDIF                                          CFT014
     C           WLOCAT    IFLE 140                                       CFT014
     C           WLOCAT    ANDGT105                                       CFT014
     C                     MOVE 'Y'       I6BTB4                          CFT014
     C                     ENDIF                                          CFT014
     C           WLOCAT    IFLE 175                                       CFT014
     C           WLOCAT    ANDGT140                                       CFT014
     C                     MOVE 'Y'       I6BTB5                          CFT014
     C                     ENDIF                                          CFT014
     C           WLOCAT    IFGT 175                                       CFT014
     C                     MOVE 'Y'       I6BTB6                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVEL'Y'       E#WARN                          CFT014
     C                     MOVEL'Y'       E#MSGS                          CFT014
     C                     MOVEL*BLANK    FTMSDT                          CFT014
     C                     MOVELE#CPGM    FTPGMQ                          CFT014
     C                     MOVEL'FTM3217' FTMSID                          CFT014
     C                     EXSR FTSNMS                                    CFT014
      *                                                                   CFT014
     C           WRN@,Z    IFEQ ' '                                       CFT014
     C                     MOVEL*BLANKS   E#RSND                          CFT014
     C                     MOVEA'Y'       WRN@,Z                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
     C/COPY WNCPYSRC,FT0348C044
      *                                                                   CFT014
      ** If settlement type if "01" or "08" or Sender's Corres. then      CFT014
      ** validate as SWIFT.                                               CFT014
      *                                                                   CFT014
     C           I6BTB     IFEQ *BLANKS                                   CFT014
     C           V#STMT    IFEQ '01'                                      CFT014
     C           V#STMT    OREQ '08'                                      CFT014
     C           V#SNCT    ORNE *BLANKS                                   CFT014
     C           V#SNMT    ANDEQ'Y'                                       CFT014
     C                     EXSR SRSEPT                                    CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Unwind subroutine stack name                                     CFT014
      *                                                                   CFT014
     C           EXBTOB    TAG                                            CFT014
     C                     MOVEA*BLANKS   @STK,Q                          CFT014
     C                     SUB  1         Q                               CFT014
      *                                                                   CFT014
     CSR                   ENDSR                                          CFT014
      *                                                                   CFT014
      *****************************************************************   CFT014
     C/EJECT                                                              CFT014
      *****************************************************************   CFT014
      /TITLE SR/SRSEPT                                                    CFT014
      *****************************************************************   CFT014
      *                                                               *   CFT014
      *  SRSEPT - SWIFT validation changes                            *   CFT014
      *                                                               *   CFT014
      *  Called By: SRBTOB subroutine                                 *   CFT014
      *                                                               *   CFT014
      *  Calls:                                                       *   CFT014
      *  FTSNMS    - Send message to program message queue.           *   CFT014
      *                                                               *   CFT014
      *****************************************************************   CFT014
      *                                                                   CFT014
     C           SRSEPT    BEGSR                           *** SRSEPT *** CFT014
      *                                                                   CFT014
      ** Set up subroutine stack name                                     CFT014
      *                                                                   CFT014
     C                     ADD  1         Q       50                      CFT014
     C                     MOVEL'SRSEPT'  @STK,Q                          CFT014
     C/COPY WNCPYSRC,FT0348C042
      *                                                                   CFT014
      ** Check through each of the 6 fields in turn.                      CFT014
      *                                                                   CFT014
     C                     Z-ADD1         #S      50                      CFT014
     C                     MOVEA*BLANKS   #ER                             CFT014
     C           1         DO   6         #T      50                      CFT014
     C/COPY WNCPYSRC,FT0348C043
      *                                                                   CFT014
      ** Set flag to show line correct and move data to work fields       CFT014
      *                                                                   CFT014
     C                     MOVE 'F'       SSF     1                       CFT014
     C           35        SUBSTS6BTB:#S  I#FLD                           CFT014
      *                                                                   CFT014
      ** If not equal to blanks validate                                  CFT014
      *                                                                   CFT014
     C           I#FLD     IFNE *BLANKS                                   CFT014
      *                                                                   CFT014
      * If line is not blank then first position must be a "/"            CFT014
      *                                                                   CFT014
     C           1         SUBSTI#FLD:1   ##001   1                       CFT014
      *                                                                   CFT014
      ** First position must be a '/'                                     CFT014
      *                                                                   CFT014
     C           ##001     IFNE '/'                                       CFT014
     C                     MOVEA'Y'       #ER,#T                          CFT014
     C                     MOVEL'Y'       E#MSGS                          CFT014
     C                     MOVEL'Y'       E#NOUP                          CFT014
     C                     MOVEL*BLANKS   FTMSDT                          CFT014
     C                     MOVELE#CPGM    FTPGMQ                          CFT014
     C                     MOVEL'FTM2171' FTMSID                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
      ** The first special instruction line cannot have '/'               CFT014
      ** in position 2                                                    CFT014
      *                                                                   CFT014
     C           #S        IFEQ 1                                         CFT014
     C           1         SUBSTI#FLD:2   ##001   1                       CFT014
     C           ##001     IFEQ '/'                                       CFT014
     C                     MOVEL'Y'       E#MSGS                          CFT014
     C                     MOVEL'Y'       E#NOUP                          CFT014
     C                     MOVEL*BLANKS   FTMSDT                          CFT014
     C                     MOVELE#CPGM    FTPGMQ                          CFT014
     C                     MOVEL'FTM2172' FTMSID                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVEA'Y'       #ER,#T                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** 2nd - 6th special instruction line cannot have '/'               CFT014
      ** in position 2 followed by a narrative of blanks.                 CFT014
      *                                                                   CFT014
     C           #S        IFNE 1                                         CFT014
     C           1         SUBSTI#FLD:2   POS02   1                       CFT014
     C           33        SUBSTI#FLD:3   NARR   33                       CFT014
     C           POS02     IFEQ '/'                                       CFT014
     C           NARR      ANDEQ*BLANKS                                   CFT014
     C                     MOVEL'Y'       E#MSGS                          CFT014
     C                     MOVEL'Y'       E#NOUP                          CFT014
     C                     MOVEL*BLANKS   FTMSDT                          CFT014
     C                     MOVELE#CPGM    FTPGMQ                          CFT014
     C                     MOVEL'FTM2170' FTMSID                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVEA'Y'       #ER,#T                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Check the line for '8a/', where 8a represents                    CFT014
      ** up to eight upper case alphabetic charaters                      CFT014
      ** If Swift 2001 is on, check line for '8c/', where                                     CSW201
      ** 8c represents up to eight uppercase alphabetic                                       CSW201
      ** letters and digits                                                                   CSW201
      *                                                                   CFT014
     C                     Z-ADD2         #R      30                      CFT014
     C           CSW201    IFEQ 'Y'                                                           CSW201
     C           ALPHAN    CHECKI#FLD:#R  #R                                                  CSW201
     C                     ELSE                                                               CSW201
     C           ALPHAB    CHECKI#FLD:#R  #R                              CFT014
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C           #R        IFGE 11                                        CFT014
     C                     MOVEL'Y'       E#MSGS                          CFT014
     C                     MOVEL'Y'       E#NOUP                          CFT014
     C                     MOVEL*BLANKS   FTMSDT                          CFT014
     C                     MOVELE#CPGM    FTPGMQ                          CFT014
      *                                                                                       CSW201
     C           CSW201    IFEQ 'Y'                                                           CSW201
     C                     MOVEL'FTM5200' FTMSID                                              CSW201
     C                     ELSE                                                               CSW201
     C                     MOVEL'FTM2173' FTMSID                          CFT014
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVEA'Y'       #ER,#T                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** If #R less than eleven then this character must be "/"           CFT014
      *                                                                   CFT014
     C           #R        IFLT 11                                        CFT014
     C           1         SUBSTI#FLD:#R  ##001                           CFT014
     C           ##001     IFNE '/'                                       CFT014
     C                     MOVEL'Y'       E#MSGS                          CFT014
     C                     MOVEL'Y'       E#NOUP                          CFT014
     C                     MOVEL*BLANKS   FTMSDT                          CFT014
     C                     MOVELE#CPGM    FTPGMQ                          CFT014
     C                     MOVEL'FTM2174' FTMSID                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVEA'Y'       #ER,#T                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Move pointer on 35 characters                                    CFT014
      *                                                                   CFT014
     C                     ADD  35        #S                              CFT014
     C                     ENDDO                                          CFT014
      *                                                                   CFT014
      * Move array of errors to I6BTB                                     CFT014
      *                                                                   CFT014
     C                     MOVEA#ER       ##006   6                       CFT014
     C                     MOVE ##006     I6BTB                           CFT014
      *                                                                   CFT014
      ** Unwind subroutine stack name                                     CFT014
      *                                                                   CFT014
     C           EXSEPT    TAG                                            CFT014
     C                     MOVEA*BLANKS   @STK,Q                          CFT014
     C                     SUB  1         Q                               CFT014
      *                                                                   CFT014
     CSR                   ENDSR                                          CFT014
      *                                                                   CFT014
      *****************************************************************   CFT014
     C/EJECT                                                              CFT014
      *****************************************************************   CFT014
      /TITLE SR/SRTRCT                                                    CFT014
      *****************************************************************   CFT014
      *                                                               *   CFT014
      *  SRTRCT - Validate Transfer Commission Tariff                 *   CFT014
      *                                                               *   CFT014
      *  Called By: SRPROC subroutine                                 *   CFT014
      *                                                               *   CFT014
      *  Calls:                                                       *   CFT014
      *  FTSNMS    - Send message to program message queue.           *   CFT014
      *                                                               *   CFT014
      *****************************************************************   CFT014
      *                                                                   CFT014
     C           SRTRCT    BEGSR                           *** SRTRCT *** CFT014
      *                                                                   CFT014
      ** Set up subroutine stack name                                     CFT014
      *                                                                   CFT014
     C                     ADD  1         Q                               CFT014
     C                     MOVEL'SRTRCT'  @STK,Q                          CFT014
      *                                                                   CFT014
      ** Tariff is optional but if entered must be 1/2/3/4/5.             CFT014
      *                                                                   CFT014
     C           S6TRCT    IFNE '1'                                       CFT014
     C           S6TRCT    ANDNE'2'                                       CFT014
     C           S6TRCT    ANDNE'3'                                       CFT014
     C           S6TRCT    ANDNE'4'                                       CFT014
     C           S6TRCT    ANDNE'5'                                       CFT014
     C                     MOVEL'Y'       E#MSGS                          CFT014
     C                     MOVELS6TRCT    FTMSDT                          CFT014
     C                     MOVELE#CPGM    FTPGMQ                          CFT014
     C                     MOVEL'FTM2055' FTMSID                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVEL'Y'       I6TRCT                          CFT014
     C                     MOVEL'Y'       E#NOUP                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Unwind subroutine stack name                                     CFT014
      *                                                                   CFT014
     C           EXTRCT    TAG                                            CFT014
     C                     MOVEA*BLANKS   @STK,Q                          CFT014
     C                     SUB  1         Q       50                      CFT014
      *                                                                   CFT014
     CSR                   ENDSR                                          CFT014
      *                                                                   CFT014
      *****************************************************************   CFT014
     C/EJECT                                                              CFT014
      *****************************************************************   CFT014
      /TITLE SR/SRINCD                                                    CFT014
      *****************************************************************   CFT014
      *                                                               *   CFT014
      *  SRINCD - Validate Instruction Code                           *   CFT014
      *                                                               *   CFT014
      *  Called By: SRPROC subroutine                                 *   CFT014
      *                                                               *   CFT014
      *  Calls:                                                       *   CFT014
      *  FTSNMS    - Send message to program message queue.           *   CFT014
      *                                                               *   CFT014
      *****************************************************************   CFT014
      *                                                                   CFT014
     C           SRINCD    BEGSR                           *** SRINCD *** CFT014
      *                                                                   CFT014
      ** Set up subroutine stack name                                     CFT014
      *                                                                   CFT014
     C                     ADD  1         Q       50                      CFT014
     C                     MOVEL'SRINCD'  @STK,Q                          CFT014
      *                                                                   CFT014
     C                     MOVELS6INCD    WSINCD                          CFT014
     C           1         SUBSTV#BNF1    WBENSL  1                       CFT014
      *                                                                   CFT014
      ** Entry is optional and must be a valid codeword if entered.       CFT014
      *                                                                   CFT014
     C           S6INCD    IFNE *BLANK                                    CFT014
      *                                                                   CFT014
      ** Check if an invalid character exists                             CFT014
      *                                                                   CFT014
     C                     MOVEL' '       ADLINE                          CFT014
     C                     MOVEL'FTM3245' ADFLDM                          CFT014
     C                     MOVEL'FTUSRMSG'ADFLDF                          CFT014
      *                                                                   CFT014
     C                     MOVE *BLANKS   ADDRSS                          CFT014
     C                     MOVELS6INCD    ADDRSS                          CFT014
      *                                                                   CFT014
     C                     EXSR ADCHK                                     CFT014
      *                                                                   CFT014
      ** Illegal Characters found                                         CFT014
      *                                                                   CFT014
     C           *IN93     IFEQ *ON                                       CFT014
     C                     MOVEL'Y'       E#NOUP                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           AD#1      IFEQ 'Y'                                       CFT014
     C                     MOVEL'Y'       I6INC1                          CFT014
     C                     ENDIF                                          CFT014
     C           AD#2      IFEQ 'Y'                                       CFT014
     C                     MOVEL'Y'       I6INC2                          CFT014
     C                     ENDIF                                          CFT014
     C           AD#3      IFEQ 'Y'                                       CFT014
     C                     MOVEL'Y'       I6INC3                          CFT014
     C                     ENDIF                                          CFT014
     C           AD#4      IFEQ 'Y'                                       CFT014
     C                     MOVEL'Y'       I6INC4                          CFT014
     C                     ENDIF                                          CFT014
     C           AD#5      IFEQ 'Y'                                       CFT014
     C                     MOVEL'Y'       I6INC5                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Entry not allowed when the bank operation code is 'SSTD' or      CFT014
      ** 'SPAY'.                                                          CFT014
      *                                                                   CFT014
     C           V#BNCD    IFEQ 'SSTD'                                    CFT014
     C           V#BNCD    OREQ 'SPAY'                                    CFT014
     C                     MOVEL'Y'       E#MSGS                          CFT014
     C                     MOVEL*BLANKS   FTMSDT                          CFT014
     C                     MOVELE#CPGM    FTPGMQ                          CFT014
     C                     MOVEL'FTM3218' FTMSID                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVEL'Y'       I6INCD                          CFT014
     C                     MOVEL'Y'       E#NOUP                          CFT014
     C                     GOTO EXINCD                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Instruction code 1                                               CFT014
      *                                                                   CFT014
     C           S6INC1    IFNE *BLANK                                    CFT014
      *                                                                   CFT014
      ** '?' not available                                                CFT014
      *                                                                   CFT014
     C           '?'       SCAN S6INC1    Y#             90               CFT014
      *                                                                   CFT014
     C           *IN90     IFEQ *ON                                       CFT014
     C                     MOVEL'Y'       E#MSGS                          CFT014
     C                     MOVELS6INC1    FTMSDT                          CFT014
     C                     MOVELE#CPGM    FTPGMQ                          CFT014
     C                     MOVEL'FTM3224' FTMSID                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVEL'Y'       I6INC1                          CFT014
     C                     MOVEL'Y'       E#NOUP                          CFT014
     C                     GOTO EXINCD                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** If SWIFT 2002 Standards Update is switched on, new code 'REPA'                       CSW202
      ** - Payment has related E-Payments reference may also be used.                         CSW202
      *                                                                                       CSW202
     C           WCDWD1    LOKUPCODE1                    35               CFT014
      *                                                                   CFT014
      ** Invalid code word                                                CFT014
      *                                                                   CFT014
     C           *IN35     IFEQ *OFF                                      CFT014
     C           WCDWD1    OREQ 'REPA'                                                        CSW202
     C           CSW202    ANDEQ'N'                                                           CSW202
     C           WCDWD1    OREQ 'BONL'                                                        CSW206
     C           CSW206    ANDEQ'Y'                                                           CSW206
     C                     MOVEL'Y'       E#MSGS                          CFT014
     C                     MOVEL*BLANKS   FTMSDT                          CFT014
     C                     MOVELE#CPGM    FTPGMQ                          CFT014
     C           CSW202    IFEQ 'Y'                                                           CSW202
     C                     MOVEL'FTM5505' FTMSID                                              CSW202
     C                     ELSE                                                               CSW202
     C                     MOVEL'FTM3219' FTMSID                          CFT014
     C                     ENDIF                                                              CSW202
      *                                                                                       CSW206
      ** If SWIFT Changes 2006 (CSW206) is installed, Instruction Code "BONL"                 CSW206
      **    is not allowed.  If CSW206 is switched ON, override the message IDs               CSW206
      **    FTM5505 or FTM3219 with FTM5601 because BONL codeword should not be               CSW206
      **    present in 2nd level text message                                                 CSW206
      *                                                                                       CSW206
     C           CSW206    IFEQ 'Y'                                                           CSW206
     C                     MOVELWCDWD1    FTMSDT    P                                         CSW206
     C                     MOVEL'FTM5601' FTMSID                                              CSW206
     C                     ENDIF                                                              CSW206
      *                                                                                       CSW206
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVEL'Y'       I6INC1                          CFT014
     C                     MOVEL'Y'       E#NOUP                          CFT014
     C                     GOTO EXINCD                                    CFT014
      *                                                                                       CSW201
     C                     ELSE                                                               CSW201
     C           CSW201    IFEQ 'Y'                                                           CSW201
      *                                                                                       CSW201
      ** If CSW201 is 'Y' and Intermediary Bank field is not                                  CSW201
      ** entered, codewords TELI and PHOI must not be used.                                   CSW201
      *                                                                                       CSW201
     C           W6INB1    IFEQ *BLANKS                                                       CSW201
     C           WCDWD1    IFEQ 'TELI'                                                        CSW201
     C           WCDWD1    OREQ 'PHOI'                                                        CSW201
     C                     MOVEL'Y'       E#MSGS                                              CSW201
     C                     MOVEL*BLANKS   FTMSDT                                              CSW201
     C                     MOVELE#CPGM    FTPGMQ                                              CSW201
     C                     MOVEL'FTM5046' FTMSID                                              CSW201
     C                     EXSR FTSNMS                                                        CSW201
     C                     MOVEL'Y'       I6INC1                                              CSW201
     C                     MOVEL'Y'       E#NOUP                                              CSW201
     C                     GOTO EXINCD                                                        CSW201
     C                     ENDIF                                                              CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
      ** If CSW201 is 'Y' and Account with Bank is not                                        CSW201
      ** entered, codewords TELE and PHON must not be used.                                   CSW201
      *                                                                                       CSW201
     C********** V#ABK     IFEQ *BLANKS                                              CSW201 AR920077
     C           V#ACBT    IFEQ *BLANKS                                                     AR920077
     C           WCDWD1    IFEQ 'TELE'                                                        CSW201
     C           WCDWD1    OREQ 'PHON'                                                        CSW201
     C                     MOVEL'Y'       E#MSGS                                              CSW201
     C                     MOVEL*BLANKS   FTMSDT                                              CSW201
     C                     MOVELE#CPGM    FTPGMQ                                              CSW201
     C                     MOVEL'FTM5047' FTMSID                                              CSW201
     C                     EXSR FTSNMS                                                        CSW201
     C                     MOVEL'Y'       I6INC1                                              CSW201
     C                     MOVEL'Y'       E#NOUP                                              CSW201
     C                     GOTO EXINCD                                                        CSW201
     C                     ENDIF                                                              CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C                     ENDIF                                                              CSW201
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Valid code word with additional information, check if additio    CFT014
      ** nal information allowed.                                         CFT014
      *                                                                   CFT014
     C                     MOVE WSINC1    WLEN31 31                       CFT014
     C           *IN35     IFEQ *ON                                       CFT014
     C           WLEN31    ANDNE*BLANK                                    CFT014
     C           WCDWD1    LOKUPCODE2                    36               CFT014
      *                                                                   CFT014
      ** Additional information not allowed for code word entered.        CFT014
      *                                                                   CFT014
     C           *IN36     IFEQ *OFF                                      CFT014
      *                                                                   CFT014
     C           WSLSH1    IFEQ '/'                                       CFT014
     C           CSW202    IFEQ 'Y'                                                           CSW202
     C                     MOVEL'FTM5501' FTMSID                                              CSW202
     C                     ELSE                                                               CSW202
     C                     MOVEL'FTM3220' FTMSID                          CFT014
     C                     ENDIF                                                              CSW202
     C                     ELSE                                           CFT014
     C           CSW202    IFEQ 'Y'                                                           CSW202
     C                     MOVEL'FTM5505' FTMSID                                              CSW202
     C                     ELSE                                                               CSW202
     C                     MOVEL'FTM3219' FTMSID                          CFT014
     C                     ENDIF                                                              CSW202
     C                     ENDIF                                          CFT014
     C                     MOVEL'Y'       E#MSGS                          CFT014
     C                     MOVEL*BLANKS   FTMSDT                          CFT014
     C                     MOVELE#CPGM    FTPGMQ                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVEL'Y'       I6INC1                          CFT014
     C                     MOVEL'Y'       E#NOUP                          CFT014
     C                     GOTO EXINCD                                    CFT014
      *                                                                   CFT014
      ** Else, if additional information is allowed for codeword.         CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C           WSLSH1    IFNE '/'                                       CFT014
     C           WSLSH1    OREQ *BLANK                                    CFT014
     C           WLEN31    ANDNE*BLANK                                    CFT014
     C                     MOVEL'Y'       E#MSGS                          CFT014
     C                     MOVEL*BLANKS   FTMSDT                          CFT014
     C                     MOVELE#CPGM    FTPGMQ                          CFT014
     C           CSW202    IFEQ 'Y'                                                           CSW202
     C                     MOVEL'FTM5505' FTMSID                                              CSW202
     C                     ELSE                                                               CSW202
     C                     MOVEL'FTM3219' FTMSID                          CFT014
     C                     ENDIF                                                              CSW202
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVEL'Y'       I6INC1                          CFT014
     C                     MOVEL'Y'       E#NOUP                          CFT014
     C                     GOTO EXINCD                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Bank operation code is 'SPRI', only 'SDVA', 'TELB', 'PHOB' or    CFT014
      ** 'INTC' code word is allowed.                                     CFT014
      *                                                                   CFT014
     C           V#BNCD    IFEQ 'SPRI'                                    CFT014
     C********** WCDWD1    LOKUPCODE1,9                  35                            CFT014 CSW202
     C           WCDWD1    LOKUPCODE1,10                 35                                   CSW202
      *                                                                   CFT014
      ** Code word not allowed                                            CFT014
      *                                                                   CFT014
     C           *IN35     IFEQ *OFF                                      CFT014
     C                     MOVEL'Y'       E#MSGS                          CFT014
     C                     MOVEL*BLANKS   FTMSDT                          CFT014
     C                     MOVELE#CPGM    FTPGMQ                          CFT014
     C                     MOVEL'FTM3221' FTMSID                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVEL'Y'       I6INC1                          CFT014
     C                     MOVEL'Y'       E#NOUP                          CFT014
     C                     GOTO EXINCD                                    CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Instruction code must not be a 'CHQB' when first line of         CFT014
      ** Beneficiary contains an account identifier ('/').                CFT014
      *                                                                   CFT014
     C           WCDWD1    IFEQ 'CHQB'                                    CFT014
     C           WBENSL    ANDEQ'/'                                       CFT014
     C                     MOVEL'Y'       E#MSGS                          CFT014
     C                     MOVEL*BLANKS   FTMSDT                          CFT014
     C                     MOVELE#CPGM    FTPGMQ                          CFT014
     C                     MOVEL'FTM3222' FTMSID                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVEL'Y'       I6INC1                          CFT014
     C                     MOVEL'Y'       E#NOUP                          CFT014
     C                     GOTO EXINCD                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                                       CSW201
     C           CSW201    IFEQ 'Y'                                                           CSW201
     C                     Z-ADD1         WX      10                                          CSW201
     C                     MOVEA*BLANKS   WFD,1                                               CSW201
     C                     MOVE WCDWD1    WFD,WX                                              CSW201
     C                     ENDIF                                                              CSW201
      *                                                                   CFT014
      ** 1st line is blank while other code lines have been entered       CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
     C           WL2345    IFNE *BLANK                                    CFT014
     C                     MOVEL'Y'       E#MSGS                          CFT014
     C                     MOVEL*BLANKS   FTMSDT                          CFT014
     C                     MOVELE#CPGM    FTPGMQ                          CFT014
     C                     MOVEL'FTM3223' FTMSID                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVEL'Y'       I6INCD                          CFT014
     C                     MOVEL'Y'       E#NOUP                          CFT014
     C                     GOTO EXINCD                                    CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Instruction code 2                                               CFT014
      *                                                                   CFT014
     C           S6INC2    IFNE *BLANK                                    CFT014
      *                                                                                       CSW202
      ** If SWIFT 2002 Standards Update is switched on, new code 'REPA'                       CSW202
      ** - Payment has related E-Payments reference may also be used.                         CSW202
      *                                                                                       CSW202
     C           WCDWD2    LOKUPCODE1                    35               CFT014
      *                                                                   CFT014
      ** Invalid code word                                                CFT014
      *                                                                   CFT014
     C           *IN35     IFEQ *OFF                                      CFT014
     C           WCDWD2    OREQ 'REPA'                                                        CSW202
     C           CSW202    ANDEQ'N'                                                           CSW202
     C           WCDWD2    OREQ 'BONL'                                                        CSW206
     C           CSW206    ANDEQ'Y'                                                           CSW206
     C                     MOVEL'Y'       E#MSGS                          CFT014
     C                     MOVEL*BLANKS   FTMSDT                          CFT014
     C                     MOVELE#CPGM    FTPGMQ                          CFT014
     C           CSW202    IFEQ 'Y'                                                           CSW202
     C                     MOVEL'FTM5505' FTMSID                                              CSW202
     C                     ELSE                                                               CSW202
     C                     MOVEL'FTM3219' FTMSID                          CFT014
     C                     ENDIF                                                              CSW202
      *                                                                                       CSW206
      ** If SWIFT Changes 2006 (CSW206) is installed, Instruction Code "BONL"                 CSW206
      **    is not allowed.  If CSW206 is switched ON, override the message IDs               CSW206
      **    FTM5505 or FTM3219 with FTM5601 because BONL codeword should not be               CSW206
      **    present in 2nd level text message                                                 CSW206
      *                                                                                       CSW206
     C           CSW206    IFEQ 'Y'                                                           CSW206
     C                     MOVELWCDWD2    FTMSDT    P                                         CSW206
     C                     MOVEL'FTM5601' FTMSID                                              CSW206
     C                     ENDIF                                                              CSW206
      *                                                                                       CSW206
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVEL'Y'       I6INC2                          CFT014
     C                     MOVEL'Y'       E#NOUP                          CFT014
     C                     GOTO EXINCD                                    CFT014
      *                                                                                       CSW201
     C                     ELSE                                                               CSW201
     C           CSW201    IFEQ 'Y'                                                           CSW201
      *                                                                                       CSW201
      ** If CSW201 is 'Y' and Intermediary Bank field is not                                  CSW201
      ** entered, codewords TELI and PHOI must not be used.                                   CSW201
      *                                                                                       CSW201
     C           W6INB1    IFEQ *BLANKS                                                       CSW201
     C           WCDWD2    IFEQ 'TELI'                                                        CSW201
     C           WCDWD2    OREQ 'PHOI'                                                        CSW201
     C                     MOVEL'Y'       E#MSGS                                              CSW201
     C                     MOVEL*BLANKS   FTMSDT                                              CSW201
     C                     MOVELE#CPGM    FTPGMQ                                              CSW201
     C                     MOVEL'FTM5046' FTMSID                                              CSW201
     C                     EXSR FTSNMS                                                        CSW201
     C                     MOVEL'Y'       I6INC2                                              CSW201
     C                     MOVEL'Y'       E#NOUP                                              CSW201
     C                     GOTO EXINCD                                                        CSW201
     C                     ENDIF                                                              CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
      ** If CSW201 is 'Y' and Account with Bank is not                                        CSW201
      ** entered, codewords TELE and PHON must not be used.                                   CSW201
      *                                                                                       CSW201
     C********** V#ABK     IFEQ *BLANKS                                              CSW201 AR920077
     C           V#ACBT    IFEQ *BLANKS                                                     AR920077
     C           WCDWD2    IFEQ 'TELE'                                                        CSW201
     C           WCDWD2    OREQ 'PHON'                                                        CSW201
     C                     MOVEL'Y'       E#MSGS                                              CSW201
     C                     MOVEL*BLANKS   FTMSDT                                              CSW201
     C                     MOVELE#CPGM    FTPGMQ                                              CSW201
     C                     MOVEL'FTM5047' FTMSID                                              CSW201
     C                     EXSR FTSNMS                                                        CSW201
     C                     MOVEL'Y'       I6INC2                                              CSW201
     C                     MOVEL'Y'       E#NOUP                                              CSW201
     C                     GOTO EXINCD                                                        CSW201
     C                     ENDIF                                                              CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C                     ENDIF                                                              CSW201
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Valid code word with additional information, check if additio    CFT014
      ** nal information allowed.                                         CFT014
      *                                                                   CFT014
     C                     MOVE WSINC2    WLEN31                          CFT014
     C           *IN35     IFEQ *ON                                       CFT014
     C           WLEN31    ANDNE*BLANK                                    CFT014
     C           WCDWD2    LOKUPCODE2                    36               CFT014
      *                                                                   CFT014
      ** Additional information not allowed for code word entered.        CFT014
      *                                                                   CFT014
     C           *IN36     IFEQ *OFF                                      CFT014
      *                                                                   CFT014
     C           WSLSH2    IFEQ '/'                                       CFT014
     C           CSW202    IFEQ 'Y'                                                           CSW202
     C                     MOVEL'FTM5501' FTMSID                                              CSW202
     C                     ELSE                                                               CSW202
     C                     MOVEL'FTM3220' FTMSID                          CFT014
     C                     ENDIF                                                              CSW202
     C                     ELSE                                           CFT014
     C           CSW202    IFEQ 'Y'                                                           CSW202
     C                     MOVEL'FTM5505' FTMSID                                              CSW202
     C                     ELSE                                                               CSW202
     C                     MOVEL'FTM3219' FTMSID                          CFT014
     C                     ENDIF                                                              CSW202
     C                     ENDIF                                          CFT014
     C                     MOVEL'Y'       E#MSGS                          CFT014
     C                     MOVEL*BLANKS   FTMSDT                          CFT014
     C                     MOVELE#CPGM    FTPGMQ                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVEL'Y'       I6INC2                          CFT014
     C                     MOVEL'Y'       E#NOUP                          CFT014
     C                     GOTO EXINCD                                    CFT014
      *                                                                   CFT014
      ** Else, if additional information is allowed for codeword.         CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C           WSLSH2    IFNE '/'                                       CFT014
     C           WSLSH2    OREQ *BLANK                                    CFT014
     C           WLEN31    ANDNE*BLANK                                    CFT014
     C                     MOVEL'Y'       E#MSGS                          CFT014
     C                     MOVEL*BLANKS   FTMSDT                          CFT014
     C                     MOVELE#CPGM    FTPGMQ                          CFT014
     C           CSW202    IFEQ 'Y'                                                           CSW202
     C                     MOVEL'FTM5505' FTMSID                                              CSW202
     C                     ELSE                                                               CSW202
     C                     MOVEL'FTM3219' FTMSID                          CFT014
     C                     ENDIF                                                              CSW202
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVEL'Y'       I6INC2                          CFT014
     C                     MOVEL'Y'       E#NOUP                          CFT014
     C                     GOTO EXINCD                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Bank operation code is 'SPRI', only 'SDVA', 'TELB', 'PHOB' or    CFT014
      ** 'INTC' code word is allowed.                                     CFT014
      *                                                                   CFT014
     C           V#BNCD    IFEQ 'SPRI'                                    CFT014
     C********** WCDWD2    LOKUPCODE1,9                  35                            CFT014 CSW202
     C           WCDWD2    LOKUPCODE1,10                 35                                   CSW202
      *                                                                   CFT014
      ** Code word not allowed                                            CFT014
      *                                                                   CFT014
     C           *IN35     IFEQ *OFF                                      CFT014
     C                     MOVEL'Y'       E#MSGS                          CFT014
     C                     MOVEL*BLANKS   FTMSDT                          CFT014
     C                     MOVELE#CPGM    FTPGMQ                          CFT014
     C                     MOVEL'FTM3221' FTMSID                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVEL'Y'       I6INC2                          CFT014
     C                     MOVEL'Y'       E#NOUP                          CFT014
     C                     GOTO EXINCD                                    CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Instruction code must not be a 'CHQB' when first line of         CFT014
      ** Beneficiary contains an account identifier ('/').                CFT014
      *                                                                   CFT014
     C           WCDWD2    IFEQ 'CHQB'                                    CFT014
     C           WBENSL    ANDEQ'/'                                       CFT014
     C                     MOVEL'Y'       E#MSGS                          CFT014
     C                     MOVEL*BLANKS   FTMSDT                          CFT014
     C                     MOVELE#CPGM    FTPGMQ                          CFT014
     C                     MOVEL'FTM3222' FTMSID                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVEL'Y'       I6INC2                          CFT014
     C                     MOVEL'Y'       E#NOUP                          CFT014
     C                     GOTO EXINCD                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                                       CSW201
      ** If CSW201 is on, codewords cannot be used more than once.                            CSW201
      *                                                                                       CSW201
     C           CSW201    IFEQ 'Y'                                                           CSW201
      *                                                                                       CSW201
     C           WCDWD2    LOKUPWFD                      01                                   CSW201
     C           *IN01     IFEQ '1'                                                           CSW201
     C                     MOVEL'Y'       E#MSGS                                              CSW201
     C                     MOVEL*BLANKS   FTMSDT                                              CSW201
     C                     MOVELE#CPGM    FTPGMQ                                              CSW201
     C                     MOVEL'FTM5202' FTMSID                                              CSW201
     C                     EXSR FTSNMS                                                        CSW201
     C                     MOVEL'Y'       I6INC2                                              CSW201
     C                     MOVEL'Y'       E#NOUP                                              CSW201
     C                     GOTO EXINCD                                                        CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C                     ADD  1         WX                                                  CSW201
     C                     MOVE WCDWD2    WFD,WX                                              CSW201
     C                     ENDIF                                                              CSW201
      *                                                                   CFT014
      ** 2nd line is blank while remaining lines are entered.             CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
     C           WL345     IFNE *BLANK                                    CFT014
     C                     MOVEL'Y'       E#MSGS                          CFT014
     C                     MOVEL*BLANKS   FTMSDT                          CFT014
     C                     MOVELE#CPGM    FTPGMQ                          CFT014
     C                     MOVEL'FTM3223' FTMSID                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVEL'Y'       I6INCD                          CFT014
     C                     MOVEL'Y'       E#NOUP                          CFT014
     C                     GOTO EXINCD                                    CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Instruction code 3                                               CFT014
      *                                                                   CFT014
     C           S6INC3    IFNE *BLANK                                    CFT014
      *                                                                                       CSW202
      ** If SWIFT 2002 Standards Update is switched on, new code 'REPA'                       CSW202
      ** - Payment has related E-Payments reference may also be used.                         CSW202
      *                                                                                       CSW202
     C           WCDWD3    LOKUPCODE1                    35               CFT014
      *                                                                   CFT014
      ** Invalid code word                                                CFT014
      *                                                                   CFT014
     C           *IN35     IFEQ *OFF                                      CFT014
     C           WCDWD3    OREQ 'REPA'                                                        CSW202
     C           CSW202    ANDEQ'N'                                                           CSW202
     C           WCDWD3    OREQ 'BONL'                                                        CSW206
     C           CSW206    ANDEQ'Y'                                                           CSW206
     C                     MOVEL'Y'       E#MSGS                          CFT014
     C                     MOVEL*BLANKS   FTMSDT                          CFT014
     C                     MOVELE#CPGM    FTPGMQ                          CFT014
     C           CSW202    IFEQ 'Y'                                                           CSW202
     C                     MOVEL'FTM5505' FTMSID                                              CSW202
     C                     ELSE                                                               CSW202
     C                     MOVEL'FTM3219' FTMSID                          CFT014
     C                     ENDIF                                                              CSW202
      *                                                                                       CSW206
      ** If SWIFT Changes 2006 (CSW206) is installed, Instruction Code "BONL"                 CSW206
      **    is not allowed.  If CSW206 is switched ON, override the message IDs               CSW206
      **    FTM5505 or FTM3219 with FTM5601 because BONL codeword should not be               CSW206
      **    present in 2nd level text message                                                 CSW206
      *                                                                                       CSW206
     C           CSW206    IFEQ 'Y'                                                           CSW206
     C                     MOVELWCDWD3    FTMSDT    P                                         CSW206
     C                     MOVEL'FTM5601' FTMSID                                              CSW206
     C                     ENDIF                                                              CSW206
      *                                                                                       CSW206
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVEL'Y'       I6INC3                          CFT014
     C                     MOVEL'Y'       E#NOUP                          CFT014
     C                     GOTO EXINCD                                    CFT014
      *                                                                                       CSW201
     C                     ELSE                                                               CSW201
     C           CSW201    IFEQ 'Y'                                                           CSW201
      *                                                                                       CSW201
      ** If CSW201 is 'Y' and Intermediary Bank field is not                                  CSW201
      ** entered, codewords TELI and PHOI must not be used.                                   CSW201
      *                                                                                       CSW201
     C           W6INB1    IFEQ *BLANKS                                                       CSW201
     C           WCDWD3    IFEQ 'TELI'                                                        CSW201
     C           WCDWD3    OREQ 'PHOI'                                                        CSW201
     C                     MOVEL'Y'       E#MSGS                                              CSW201
     C                     MOVEL*BLANKS   FTMSDT                                              CSW201
     C                     MOVELE#CPGM    FTPGMQ                                              CSW201
     C                     MOVEL'FTM5046' FTMSID                                              CSW201
     C                     EXSR FTSNMS                                                        CSW201
     C                     MOVEL'Y'       I6INC3                                              CSW201
     C                     MOVEL'Y'       E#NOUP                                              CSW201
     C                     GOTO EXINCD                                                        CSW201
     C                     ENDIF                                                              CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
      ** If CSW201 is 'Y' and Account with Bank is not                                        CSW201
      ** entered, codewords TELE and PHON must not be used.                                   CSW201
      *                                                                                       CSW201
     C********** V#ABK     IFEQ *BLANKS                                              CSW201 AR920077
     C           V#ACBT    IFEQ *BLANKS                                                     AR920077
     C           WCDWD3    IFEQ 'TELE'                                                        CSW201
     C           WCDWD3    OREQ 'PHON'                                                        CSW201
     C                     MOVEL'Y'       E#MSGS                                              CSW201
     C                     MOVEL*BLANKS   FTMSDT                                              CSW201
     C                     MOVELE#CPGM    FTPGMQ                                              CSW201
     C                     MOVEL'FTM5047' FTMSID                                              CSW201
     C                     EXSR FTSNMS                                                        CSW201
     C                     MOVEL'Y'       I6INC3                                              CSW201
     C                     MOVEL'Y'       E#NOUP                                              CSW201
     C                     GOTO EXINCD                                                        CSW201
     C                     ENDIF                                                              CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C                     ENDIF                                                              CSW201
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Valid code word with additional information, check if additio    CFT014
      ** nal information allowed.                                         CFT014
      *                                                                   CFT014
     C                     MOVE WSINC3    WLEN31                          CFT014
     C           *IN35     IFEQ *ON                                       CFT014
     C           WLEN31    ANDNE*BLANK                                    CFT014
     C           WCDWD3    LOKUPCODE2                    36               CFT014
      *                                                                   CFT014
      ** Additional information not allowed for code word entered.        CFT014
      *                                                                   CFT014
     C           *IN36     IFEQ *OFF                                      CFT014
      *                                                                   CFT014
     C           WSLSH3    IFEQ '/'                                       CFT014
     C           CSW202    IFEQ 'Y'                                                           CSW202
     C                     MOVEL'FTM5501' FTMSID                                              CSW202
     C                     ELSE                                                               CSW202
     C                     MOVEL'FTM3220' FTMSID                          CFT014
     C                     ENDIF                                                              CSW202
     C                     ELSE                                           CFT014
     C           CSW202    IFEQ 'Y'                                                           CSW202
     C                     MOVEL'FTM5505' FTMSID                                              CSW202
     C                     ELSE                                                               CSW202
     C                     MOVEL'FTM3219' FTMSID                          CFT014
     C                     ENDIF                                                              CSW202
     C                     ENDIF                                          CFT014
     C                     MOVEL'Y'       E#MSGS                          CFT014
     C                     MOVEL*BLANKS   FTMSDT                          CFT014
     C                     MOVELE#CPGM    FTPGMQ                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVEL'Y'       I6INC3                          CFT014
     C                     MOVEL'Y'       E#NOUP                          CFT014
     C                     GOTO EXINCD                                    CFT014
      *                                                                   CFT014
      ** Else, if additional information is allowed for codeword.         CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C           WSLSH3    IFNE '/'                                       CFT014
     C           WSLSH3    OREQ *BLANK                                    CFT014
     C           WLEN31    ANDNE*BLANK                                    CFT014
     C                     MOVEL'Y'       E#MSGS                          CFT014
     C                     MOVEL*BLANKS   FTMSDT                          CFT014
     C                     MOVELE#CPGM    FTPGMQ                          CFT014
     C           CSW202    IFEQ 'Y'                                                           CSW202
     C                     MOVEL'FTM5505' FTMSID                                              CSW202
     C                     ELSE                                                               CSW202
     C                     MOVEL'FTM3219' FTMSID                          CFT014
     C                     ENDIF                                                              CSW202
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVEL'Y'       I6INC3                          CFT014
     C                     MOVEL'Y'       E#NOUP                          CFT014
     C                     GOTO EXINCD                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Bank operation code is 'SPRI', only 'SDVA', 'TELB', 'PHOB' or    CFT014
      ** 'INTC' code word is allowed.                                     CFT014
      *                                                                   CFT014
     C           V#BNCD    IFEQ 'SPRI'                                    CFT014
     C********** WCDWD3    LOKUPCODE1,9                  35                            CFT014 CSW202
     C           WCDWD3    LOKUPCODE1,10                 35                                   CSW202
      *                                                                   CFT014
      ** Code word not allowed                                            CFT014
      *                                                                   CFT014
     C           *IN35     IFEQ *OFF                                      CFT014
     C                     MOVEL'Y'       E#MSGS                          CFT014
     C                     MOVEL*BLANKS   FTMSDT                          CFT014
     C                     MOVELE#CPGM    FTPGMQ                          CFT014
     C                     MOVEL'FTM3221' FTMSID                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVEL'Y'       I6INC3                          CFT014
     C                     MOVEL'Y'       E#NOUP                          CFT014
     C                     GOTO EXINCD                                    CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Instruction code must not be a 'CHQB' when first line of         CFT014
      ** Beneficiary contains an account identifier ('/').                CFT014
      *                                                                   CFT014
     C           WCDWD3    IFEQ 'CHQB'                                    CFT014
     C           WBENSL    ANDEQ'/'                                       CFT014
     C                     MOVEL'Y'       E#MSGS                          CFT014
     C                     MOVEL*BLANKS   FTMSDT                          CFT014
     C                     MOVELE#CPGM    FTPGMQ                          CFT014
     C                     MOVEL'FTM3222' FTMSID                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVEL'Y'       I6INC3                          CFT014
     C                     MOVEL'Y'       E#NOUP                          CFT014
     C                     GOTO EXINCD                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                                       CSW201
      ** If CSW201 is on, codewords cannot be used more than once.                            CSW201
      *                                                                                       CSW201
     C           CSW201    IFEQ 'Y'                                                           CSW201
      *                                                                                       CSW201
     C           WCDWD3    LOKUPWFD                      01                                   CSW201
     C           *IN01     IFEQ '1'                                                           CSW201
     C                     MOVEL'Y'       E#MSGS                                              CSW201
     C                     MOVEL*BLANKS   FTMSDT                                              CSW201
     C                     MOVELE#CPGM    FTPGMQ                                              CSW201
     C                     MOVEL'FTM5202' FTMSID                                              CSW201
     C                     EXSR FTSNMS                                                        CSW201
     C                     MOVEL'Y'       I6INC3                                              CSW201
     C                     MOVEL'Y'       E#NOUP                                              CSW201
     C                     GOTO EXINCD                                                        CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C                     ADD  1         WX                                                  CSW201
     C                     MOVE WCDWD3    WFD,WX                                              CSW201
     C                     ENDIF                                                              CSW201
      *                                                                   CFT014
      ** 3nd line is blank while the remaining lines are entered.         CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
     C           WL45      IFNE *BLANK                                    CFT014
     C                     MOVEL'Y'       E#MSGS                          CFT014
     C                     MOVEL*BLANKS   FTMSDT                          CFT014
     C                     MOVELE#CPGM    FTPGMQ                          CFT014
     C                     MOVEL'FTM3223' FTMSID                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVEL'Y'       I6INCD                          CFT014
     C                     MOVEL'Y'       E#NOUP                          CFT014
     C                     GOTO EXINCD                                    CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Instruction code 4                                               CFT014
      *                                                                   CFT014
     C           S6INC4    IFNE *BLANK                                    CFT014
      *                                                                                       CSW202
      ** If SWIFT 2002 Standards Update is switched on, new code 'REPA'                       CSW202
      ** - Payment has related E-Payments reference may also be used.                         CSW202
      *                                                                                       CSW202
     C           WCDWD4    LOKUPCODE1                    35               CFT014
      *                                                                   CFT014
      ** Invalid code word                                                CFT014
      *                                                                   CFT014
     C           *IN35     IFEQ *OFF                                      CFT014
     C           WCDWD4    OREQ 'REPA'                                                        CSW202
     C           CSW202    ANDEQ'N'                                                           CSW202
     C           WCDWD4    OREQ 'BONL'                                                        CSW206
     C           CSW206    ANDEQ'Y'                                                           CSW206
     C                     MOVEL'Y'       E#MSGS                          CFT014
     C                     MOVEL*BLANKS   FTMSDT                          CFT014
     C                     MOVELE#CPGM    FTPGMQ                          CFT014
     C           CSW202    IFEQ 'Y'                                                           CSW202
     C                     MOVEL'FTM5505' FTMSID                                              CSW202
     C                     ELSE                                                               CSW202
     C                     MOVEL'FTM3219' FTMSID                          CFT014
     C                     ENDIF                                                              CSW202
      *                                                                                       CSW206
      ** If SWIFT Changes 2006 (CSW206) is installed, Instruction Code "BONL"                 CSW206
      **    is not allowed.  If CSW206 is switched ON, override the message IDs               CSW206
      **    FTM5505 or FTM3219 with FTM5601 because BONL codeword should not be               CSW206
      **    present in 2nd level text message                                                 CSW206
      *                                                                                       CSW206
     C           CSW206    IFEQ 'Y'                                                           CSW206
     C                     MOVELWCDWD4    FTMSDT    P                                         CSW206
     C                     MOVEL'FTM5601' FTMSID                                              CSW206
     C                     ENDIF                                                              CSW206
      *                                                                                       CSW206
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVEL'Y'       I6INC4                          CFT014
     C                     MOVEL'Y'       E#NOUP                          CFT014
     C                     GOTO EXINCD                                    CFT014
      *                                                                                       CSW201
     C                     ELSE                                                               CSW201
     C           CSW201    IFEQ 'Y'                                                           CSW201
      *                                                                                       CSW201
      ** If CSW201 is 'Y' and Intermediary Bank field is not                                  CSW201
      ** entered, codewords TELI and PHOI must not be used.                                   CSW201
      *                                                                                       CSW201
     C           W6INB1    IFEQ *BLANKS                                                       CSW201
     C           WCDWD4    IFEQ 'TELI'                                                        CSW201
     C           WCDWD4    OREQ 'PHOI'                                                        CSW201
     C                     MOVEL'Y'       E#MSGS                                              CSW201
     C                     MOVEL*BLANKS   FTMSDT                                              CSW201
     C                     MOVELE#CPGM    FTPGMQ                                              CSW201
     C                     MOVEL'FTM5046' FTMSID                                              CSW201
     C                     EXSR FTSNMS                                                        CSW201
     C                     MOVEL'Y'       I6INC4                                              CSW201
     C                     MOVEL'Y'       E#NOUP                                              CSW201
     C                     GOTO EXINCD                                                        CSW201
     C                     ENDIF                                                              CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
      ** If CSW201 is 'Y' and Account with Bank is not                                        CSW201
      ** entered, codewords TELE and PHON must not be used.                                   CSW201
      *                                                                                       CSW201
     C********** V#ABK     IFEQ *BLANKS                                              CSW201 AR920077
     C           V#ACBT    IFEQ *BLANKS                                                     AR920077
     C           WCDWD4    IFEQ 'TELE'                                                        CSW201
     C           WCDWD4    OREQ 'PHON'                                                        CSW201
     C                     MOVEL'Y'       E#MSGS                                              CSW201
     C                     MOVEL*BLANKS   FTMSDT                                              CSW201
     C                     MOVELE#CPGM    FTPGMQ                                              CSW201
     C                     MOVEL'FTM5047' FTMSID                                              CSW201
     C                     EXSR FTSNMS                                                        CSW201
     C                     MOVEL'Y'       I6INC4                                              CSW201
     C                     MOVEL'Y'       E#NOUP                                              CSW201
     C                     GOTO EXINCD                                                        CSW201
     C                     ENDIF                                                              CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C                     ENDIF                                                              CSW201
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Valid code word with additional information, check if additio    CFT014
      ** nal information allowed.                                         CFT014
      *                                                                   CFT014
     C                     MOVE WSINC4    WLEN31                          CFT014
     C           *IN35     IFEQ *ON                                       CFT014
     C           WLEN31    ANDNE*BLANK                                    CFT014
     C           WCDWD4    LOKUPCODE2                    36               CFT014
      *                                                                   CFT014
      ** Additional information not allowed for code word entered.        CFT014
      *                                                                   CFT014
     C           *IN36     IFEQ *OFF                                      CFT014
      *                                                                   CFT014
     C           WSLSH4    IFEQ '/'                                       CFT014
     C           CSW202    IFEQ 'Y'                                                           CSW202
     C                     MOVEL'FTM5501' FTMSID                                              CSW202
     C                     ELSE                                                               CSW202
     C                     MOVEL'FTM3220' FTMSID                          CFT014
     C                     ENDIF                                                              CSW202
     C                     ELSE                                           CFT014
     C           CSW202    IFEQ 'Y'                                                           CSW202
     C                     MOVEL'FTM5505' FTMSID                                              CSW202
     C                     ELSE                                                               CSW202
     C                     MOVEL'FTM3219' FTMSID                          CFT014
     C                     ENDIF                                                              CSW202
     C                     ENDIF                                          CFT014
     C                     MOVEL'Y'       E#MSGS                          CFT014
     C                     MOVEL*BLANKS   FTMSDT                          CFT014
     C                     MOVELE#CPGM    FTPGMQ                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVEL'Y'       I6INC4                          CFT014
     C                     MOVEL'Y'       E#NOUP                          CFT014
     C                     GOTO EXINCD                                    CFT014
      *                                                                   CFT014
      ** Else, if additional information is allowed for codeword.         CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C           WSLSH4    IFNE '/'                                       CFT014
     C           WSLSH4    OREQ *BLANK                                    CFT014
     C           WLEN31    ANDNE*BLANK                                    CFT014
     C                     MOVEL'Y'       E#MSGS                          CFT014
     C                     MOVEL*BLANKS   FTMSDT                          CFT014
     C                     MOVELE#CPGM    FTPGMQ                          CFT014
     C           CSW202    IFEQ 'Y'                                                           CSW202
     C                     MOVEL'FTM5505' FTMSID                                              CSW202
     C                     ELSE                                                               CSW202
     C                     MOVEL'FTM3219' FTMSID                          CFT014
     C                     ENDIF                                                              CSW202
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVEL'Y'       I6INC4                          CFT014
     C                     MOVEL'Y'       E#NOUP                          CFT014
     C                     GOTO EXINCD                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Bank operation code is 'SPRI', only 'SDVA', 'TELB', 'PHOB' or    CFT014
      ** 'INTC' code word is allowed.                                     CFT014
      *                                                                   CFT014
     C           V#BNCD    IFEQ 'SPRI'                                    CFT014
     C********** WCDWD4    LOKUPCODE1,9                  35                            CFT014 CSW202
     C           WCDWD4    LOKUPCODE1,10                 35                                   CSW202
      *                                                                   CFT014
      ** Code word not allowed                                            CFT014
      *                                                                   CFT014
     C           *IN35     IFEQ *OFF                                      CFT014
     C                     MOVEL'Y'       E#MSGS                          CFT014
     C                     MOVEL*BLANKS   FTMSDT                          CFT014
     C                     MOVELE#CPGM    FTPGMQ                          CFT014
     C                     MOVEL'FTM3221' FTMSID                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVEL'Y'       I6INC4                          CFT014
     C                     MOVEL'Y'       E#NOUP                          CFT014
     C                     GOTO EXINCD                                    CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Instruction code must not be a 'CHQB' when first line of         CFT014
      ** Beneficiary contains an account identifier ('/').                CFT014
      *                                                                   CFT014
     C           WCDWD4    IFEQ 'CHQB'                                    CFT014
     C           WBENSL    ANDEQ'/'                                       CFT014
     C                     MOVEL'Y'       E#MSGS                          CFT014
     C                     MOVEL*BLANKS   FTMSDT                          CFT014
     C                     MOVELE#CPGM    FTPGMQ                          CFT014
     C                     MOVEL'FTM3222' FTMSID                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVEL'Y'       I6INC4                          CFT014
     C                     MOVEL'Y'       E#NOUP                          CFT014
     C                     GOTO EXINCD                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                                       CSW201
      ** If CSW201 is on, codewords cannot be used more than once.                            CSW201
      *                                                                                       CSW201
     C           CSW201    IFEQ 'Y'                                                           CSW201
      *                                                                                       CSW201
     C           WCDWD4    LOKUPWFD                      01                                   CSW201
     C           *IN01     IFEQ '1'                                                           CSW201
     C                     MOVEL'Y'       E#MSGS                                              CSW201
     C                     MOVEL*BLANKS   FTMSDT                                              CSW201
     C                     MOVELE#CPGM    FTPGMQ                                              CSW201
     C                     MOVEL'FTM5202' FTMSID                                              CSW201
     C                     EXSR FTSNMS                                                        CSW201
     C                     MOVEL'Y'       I6INC4                                              CSW201
     C                     MOVEL'Y'       E#NOUP                                              CSW201
     C                     GOTO EXINCD                                                        CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C                     ADD  1         WX                                                  CSW201
     C                     MOVE WCDWD4    WFD,WX                                              CSW201
     C                     ENDIF                                                              CSW201
      *                                                                   CFT014
      ** 4th line is blank while 5th line is entered.                     CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
     C           WSINC5    IFNE *BLANK                                    CFT014
     C                     MOVEL'Y'       E#MSGS                          CFT014
     C                     MOVEL*BLANKS   FTMSDT                          CFT014
     C                     MOVELE#CPGM    FTPGMQ                          CFT014
     C                     MOVEL'FTM3223' FTMSID                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVEL'Y'       I6INCD                          CFT014
     C                     MOVEL'Y'       E#NOUP                          CFT014
     C                     GOTO EXINCD                                    CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Instruction code 5                                               CFT014
      *                                                                   CFT014
     C           S6INC5    IFNE *BLANK                                    CFT014
      *                                                                                       CSW202
      ** If SWIFT 2002 Standards Update is switched on, new code 'REPA'                       CSW202
      ** - Payment has related E-Payments reference may also be used.                         CSW202
      *                                                                                       CSW202
     C           WCDWD5    LOKUPCODE1                    35               CFT014
      *                                                                   CFT014
      ** Invalid code word                                                CFT014
      *                                                                   CFT014
     C           *IN35     IFEQ *OFF                                      CFT014
     C           WCDWD5    OREQ 'REPA'                                                        CSW202
     C           CSW202    ANDEQ'N'                                                           CSW202
     C           WCDWD5    OREQ 'BONL'                                                        CSW206
     C           CSW206    ANDEQ'Y'                                                           CSW206
     C                     MOVEL'Y'       E#MSGS                          CFT014
     C                     MOVEL*BLANKS   FTMSDT                          CFT014
     C                     MOVELE#CPGM    FTPGMQ                          CFT014
     C           CSW202    IFEQ 'Y'                                                           CSW202
     C                     MOVEL'FTM5505' FTMSID                                              CSW202
     C                     ELSE                                                               CSW202
     C                     MOVEL'FTM3219' FTMSID                          CFT014
     C                     ENDIF                                                              CSW202
      *                                                                                       CSW206
      ** If SWIFT Changes 2006 (CSW206) is installed, Instruction Code "BONL"                 CSW206
      **    is not allowed.  If CSW206 is switched ON, override the message IDs               CSW206
      **    FTM5505 or FTM3219 with FTM5601 because BONL codeword should not be               CSW206
      **    present in 2nd level text message                                                 CSW206
      *                                                                                       CSW206
     C           CSW206    IFEQ 'Y'                                                           CSW206
     C                     MOVELWCDWD5    FTMSDT    P                                         CSW206
     C                     MOVEL'FTM5601' FTMSID                                              CSW206
     C                     ENDIF                                                              CSW206
      *                                                                                       CSW206
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVEL'Y'       I6INC5                          CFT014
     C                     MOVEL'Y'       E#NOUP                          CFT014
     C                     GOTO EXINCD                                    CFT014
      *                                                                                       CSW201
     C                     ELSE                                                               CSW201
     C           CSW201    IFEQ 'Y'                                                           CSW201
      *                                                                                       CSW201
      ** If CSW201 is 'Y' and Intermediary Bank field is not                                  CSW201
      ** entered, codewords TELI and PHOI must not be used.                                   CSW201
      *                                                                                       CSW201
     C           W6INB1    IFEQ *BLANKS                                                       CSW201
     C           WCDWD5    IFEQ 'TELI'                                                        CSW201
     C           WCDWD5    OREQ 'PHOI'                                                        CSW201
     C                     MOVEL'Y'       E#MSGS                                              CSW201
     C                     MOVEL*BLANKS   FTMSDT                                              CSW201
     C                     MOVELE#CPGM    FTPGMQ                                              CSW201
     C                     MOVEL'FTM5046' FTMSID                                              CSW201
     C                     EXSR FTSNMS                                                        CSW201
     C                     MOVEL'Y'       I6INC5                                              CSW201
     C                     MOVEL'Y'       E#NOUP                                              CSW201
     C                     GOTO EXINCD                                                        CSW201
     C                     ENDIF                                                              CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
      ** If CSW201 is 'Y' and Account with Bank is not                                        CSW201
      ** entered, codewords TELE and PHON must not be used.                                   CSW201
      *                                                                                       CSW201
     C********** V#ABK     IFEQ *BLANKS                                              CSW201 AR920077
     C           V#ACBT    IFEQ *BLANKS                                                     AR920077
     C           WCDWD5    IFEQ 'TELE'                                                        CSW201
     C           WCDWD5    OREQ 'PHON'                                                        CSW201
     C                     MOVEL'Y'       E#MSGS                                              CSW201
     C                     MOVEL*BLANKS   FTMSDT                                              CSW201
     C                     MOVELE#CPGM    FTPGMQ                                              CSW201
     C                     MOVEL'FTM5047' FTMSID                                              CSW201
     C                     EXSR FTSNMS                                                        CSW201
     C                     MOVEL'Y'       I6INC5                                              CSW201
     C                     MOVEL'Y'       E#NOUP                                              CSW201
     C                     GOTO EXINCD                                                        CSW201
     C                     ENDIF                                                              CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C                     ENDIF                                                              CSW201
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Valid code word with additional information, check if additio    CFT014
      ** nal information allowed.                                         CFT014
      *                                                                   CFT014
     C                     MOVE WSINC5    WLEN31                          CFT014
     C           *IN35     IFEQ *ON                                       CFT014
     C           WLEN31    ANDNE*BLANK                                    CFT014
     C           WCDWD5    LOKUPCODE2                    36               CFT014
      *                                                                   CFT014
      ** Additional information not allowed for code word entered.        CFT014
      *                                                                   CFT014
     C           *IN36     IFEQ *OFF                                      CFT014
      *                                                                   CFT014
     C           WSLSH5    IFEQ '/'                                       CFT014
     C           CSW202    IFEQ 'Y'                                                           CSW202
     C                     MOVEL'FTM5501' FTMSID                                              CSW202
     C                     ELSE                                                               CSW202
     C                     MOVEL'FTM3220' FTMSID                          CFT014
     C                     ENDIF                                                              CSW202
     C                     ELSE                                           CFT014
     C           CSW202    IFEQ 'Y'                                                           CSW202
     C                     MOVEL'FTM5505' FTMSID                                              CSW202
     C                     ELSE                                                               CSW202
     C                     MOVEL'FTM3219' FTMSID                          CFT014
     C                     ENDIF                                                              CSW202
     C                     ENDIF                                          CFT014
     C                     MOVEL'Y'       E#MSGS                          CFT014
     C                     MOVEL*BLANKS   FTMSDT                          CFT014
     C                     MOVELE#CPGM    FTPGMQ                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVEL'Y'       I6INC5                          CFT014
     C                     MOVEL'Y'       E#NOUP                          CFT014
     C                     GOTO EXINCD                                    CFT014
      *                                                                   CFT014
      ** Else, if additional information is allowed for codeword.         CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C           WSLSH5    IFNE '/'                                       CFT014
     C           WSLSH5    OREQ *BLANK                                    CFT014
     C           WLEN31    ANDNE*BLANK                                    CFT014
     C                     MOVEL'Y'       E#MSGS                          CFT014
     C                     MOVEL*BLANKS   FTMSDT                          CFT014
     C                     MOVELE#CPGM    FTPGMQ                          CFT014
     C           CSW202    IFEQ 'Y'                                                           CSW202
     C                     MOVEL'FTM5505' FTMSID                                              CSW202
     C                     ELSE                                                               CSW202
     C                     MOVEL'FTM3219' FTMSID                          CFT014
     C                     ENDIF                                                              CSW202
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVEL'Y'       I6INC5                          CFT014
     C                     MOVEL'Y'       E#NOUP                          CFT014
     C                     GOTO EXINCD                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Bank operation code is 'SPRI', only 'SDVA', 'TELB', 'PHOB' or    CFT014
      ** 'INTC' code word is allowed.                                     CFT014
      *                                                                   CFT014
     C           V#BNCD    IFEQ 'SPRI'                                    CFT014
     C********** WCDWD5    LOKUPCODE1,9                  35                            CFT014 CSW202
     C           WCDWD5    LOKUPCODE1,10                 35                                   CSW202
      *                                                                   CFT014
      ** Code word not allowed                                            CFT014
      *                                                                   CFT014
     C           *IN35     IFEQ *OFF                                      CFT014
     C                     MOVEL'Y'       E#MSGS                          CFT014
     C                     MOVEL*BLANKS   FTMSDT                          CFT014
     C                     MOVELE#CPGM    FTPGMQ                          CFT014
     C                     MOVEL'FTM3221' FTMSID                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVEL'Y'       I6INC5                          CFT014
     C                     MOVEL'Y'       E#NOUP                          CFT014
     C                     GOTO EXINCD                                    CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Instruction code must not be a 'CHQB' when first line of         CFT014
      ** Beneficiary contains an account identifier ('/').                CFT014
      *                                                                   CFT014
     C           WCDWD5    IFEQ 'CHQB'                                    CFT014
     C           WBENSL    ANDEQ'/'                                       CFT014
     C                     MOVEL'Y'       E#MSGS                          CFT014
     C                     MOVEL*BLANKS   FTMSDT                          CFT014
     C                     MOVELE#CPGM    FTPGMQ                          CFT014
     C                     MOVEL'FTM3222' FTMSID                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVEL'Y'       I6INC5                          CFT014
     C                     MOVEL'Y'       E#NOUP                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                                       CSW201
      ** If CSW201 is on, codewords cannot be used more than once.                            CSW201
      *                                                                                       CSW201
     C           CSW201    IFEQ 'Y'                                                           CSW201
      *                                                                                       CSW201
     C           WCDWD5    LOKUPWFD                      01                                   CSW201
      *                                                                                       CSW201
     C           *IN01     IFEQ '1'                                                           CSW201
     C                     MOVEL'Y'       E#MSGS                                              CSW201
     C                     MOVEL*BLANKS   FTMSDT                                              CSW201
     C                     MOVELE#CPGM    FTPGMQ                                              CSW201
     C                     MOVEL'FTM5202' FTMSID                                              CSW201
     C                     EXSR FTSNMS                                                        CSW201
     C                     MOVEL'Y'       I6INC5                                              CSW201
     C                     MOVEL'Y'       E#NOUP                                              CSW201
     C                     GOTO EXINCD                                                        CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C                     ADD  1         WX                                                  CSW201
     C                     MOVE WCDWD5    WFD,WX                                              CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                                       CSW201
     C           WCDWD5    IFEQ 'CHQB'                                                        CSW201
     C           WBENSL    ANDEQ'/'                                                           CSW201
     C                     MOVEL'Y'       E#MSGS                                              CSW201
     C                     MOVEL*BLANKS   FTMSDT                                              CSW201
     C                     MOVELE#CPGM    FTPGMQ                                              CSW201
     C                     MOVEL'FTM3222' FTMSID                                              CSW201
     C                     EXSR FTSNMS                                                        CSW201
     C                     MOVEL'Y'       I6INC5                                              CSW201
     C                     MOVEL'Y'       E#NOUP                                              CSW201
     C                     GOTO EXINCD                                                        CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
      ** The following codeword combinations are prohibited                                   CSW201
      ** if CSW201 is installed                                                               CSW201
      *                                                                                       CSW201
     C           CSW201    IFEQ 'Y'                                                           CSW201
      *                                                                                       CSW201
      ** SDVA with HOLD                                                                       CSW201
      ** SDVA with CHQB                                                                       CSW201
      *                                                                                       CSW201
     C           'SDVA'    LOKUPWFD                      01                                   CSW201
      *                                                                                       CSW201
     C           *IN01     IFEQ '1'                                                           CSW201
     C           'HOLD'    LOKUPWFD                      02                                   CSW201
     C           'CHQB'    LOKUPWFD                      03                                   CSW201
      *                                                                                       CSW201
     C           *IN02     IFEQ '1'                                                           CSW201
     C           *IN03     OREQ '1'                                                           CSW201
     C                     MOVEL'Y'       E#MSGS                                              CSW201
     C                     MOVEL*BLANKS   FTMSDT                                              CSW201
     C                     MOVELE#CPGM    FTPGMQ                                              CSW201
     C                     MOVEL'FTM5203' FTMSID                                              CSW201
     C                     EXSR FTSNMS                                                        CSW201
     C                     MOVEL'Y'       I6INC1                                              CSW201
     C                     MOVEL'Y'       I6INC2                                              CSW201
     C                     MOVEL'Y'       I6INC3                                              CSW201
     C                     MOVEL'Y'       I6INC4                                              CSW201
     C                     MOVEL'Y'       I6INC5                                              CSW201
     C                     MOVEL'Y'       E#NOUP                                              CSW201
     C                     GOTO EXINCD                                                        CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
      ** INTC with BONL                                                                       CSW201
      ** INTC with HOLD                                                                       CSW201
      ** INTC with CHQB                                                                       CSW201
      *                                                                                       CSW201
     C           'INTC'    LOKUPWFD                      01                                   CSW201
      *                                                                                       CSW201
     C           *IN01     IFEQ '1'                                                           CSW201
     C           'BONL'    LOKUPWFD                      02                                   CSW201
     C           'HOLD'    LOKUPWFD                      03                                   CSW201
     C           'CHQB'    LOKUPWFD                      04                                   CSW201
      *                                                                                       CSW201
     C           *IN02     IFEQ '1'                                                           CSW201
     C           *IN03     OREQ '1'                                                           CSW201
     C           *IN04     OREQ '1'                                                           CSW201
     C                     MOVEL'Y'       E#MSGS                                              CSW201
     C                     MOVEL*BLANKS   FTMSDT                                              CSW201
     C                     MOVELE#CPGM    FTPGMQ                                              CSW201
     C                     MOVEL'FTM5204' FTMSID                                              CSW201
     C                     EXSR FTSNMS                                                        CSW201
     C                     MOVEL'Y'       I6INC1                                              CSW201
     C                     MOVEL'Y'       I6INC2                                              CSW201
     C                     MOVEL'Y'       I6INC3                                              CSW201
     C                     MOVEL'Y'       I6INC4                                              CSW201
     C                     MOVEL'Y'       I6INC5                                              CSW201
     C                     MOVEL'Y'       E#NOUP                                              CSW201
     C                     GOTO EXINCD                                                        CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
      ** CORT with BONL                                                                       CSW201
      ** CORT with HOLD                                                                       CSW201
      ** CORT with CHQB                                                                       CSW201
      *                                                                                       CSW201
     C           'CORT'    LOKUPWFD                      01                                   CSW201
      *                                                                                       CSW201
     C           *IN01     IFEQ '1'                                                           CSW201
     C           'BONL'    LOKUPWFD                      02                                   CSW201
     C           'HOLD'    LOKUPWFD                      03                                   CSW201
     C           'CHQB'    LOKUPWFD                      04                                   CSW201
      *                                                                                       CSW201
     C           *IN02     IFEQ '1'                                                           CSW201
     C           *IN03     OREQ '1'                                                           CSW201
     C           *IN04     OREQ '1'                                                           CSW201
     C                     MOVEL'Y'       E#MSGS                                              CSW201
     C                     MOVEL*BLANKS   FTMSDT                                              CSW201
     C                     MOVELE#CPGM    FTPGMQ                                              CSW201
     C                     MOVEL'FTM5205' FTMSID                                              CSW201
     C                     EXSR FTSNMS                                                        CSW201
     C                     MOVEL'Y'       I6INC1                                              CSW201
     C                     MOVEL'Y'       I6INC2                                              CSW201
     C                     MOVEL'Y'       I6INC3                                              CSW201
     C                     MOVEL'Y'       I6INC4                                              CSW201
     C                     MOVEL'Y'       I6INC5                                              CSW201
     C                     MOVEL'Y'       E#NOUP                                              CSW201
     C                     GOTO EXINCD                                                        CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
      ** HOLD with CHQB                                                                       CSW201
      *                                                                                       CSW201
     C           'HOLD'    LOKUPWFD                      01                                   CSW201
      *                                                                                       CSW201
     C           *IN01     IFEQ '1'                                                           CSW201
     C           'CHQB'    LOKUPWFD                      02                                   CSW201
      *                                                                                       CSW201
     C           *IN02     IFEQ '1'                                                           CSW201
     C                     MOVEL'Y'       E#MSGS                                              CSW201
     C                     MOVEL*BLANKS   FTMSDT                                              CSW201
     C                     MOVELE#CPGM    FTPGMQ                                              CSW201
     C                     MOVEL'FTM5206' FTMSID                                              CSW201
     C                     EXSR FTSNMS                                                        CSW201
     C                     MOVEL'Y'       I6INC1                                              CSW201
     C                     MOVEL'Y'       I6INC2                                              CSW201
     C                     MOVEL'Y'       I6INC3                                              CSW201
     C                     MOVEL'Y'       I6INC4                                              CSW201
     C                     MOVEL'Y'       I6INC5                                              CSW201
     C                     MOVEL'Y'       E#NOUP                                              CSW201
     C                     GOTO EXINCD                                                        CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
      ** PHOB with TELB                                                                       CSW201
      *                                                                                       CSW201
     C           'PHOB'    LOKUPWFD                      01                                   CSW201
      *                                                                                       CSW201
     C           *IN01     IFEQ '1'                                                           CSW201
     C           'TELB'    LOKUPWFD                      02                                   CSW201
      *                                                                                       CSW201
     C           *IN02     IFEQ '1'                                                           CSW201
     C                     MOVEL'Y'       E#MSGS                                              CSW201
     C                     MOVEL*BLANKS   FTMSDT                                              CSW201
     C                     MOVELE#CPGM    FTPGMQ                                              CSW201
     C                     MOVEL'FTM5207' FTMSID                                              CSW201
     C                     EXSR FTSNMS                                                        CSW201
     C                     MOVEL'Y'       I6INC1                                              CSW201
     C                     MOVEL'Y'       I6INC2                                              CSW201
     C                     MOVEL'Y'       I6INC3                                              CSW201
     C                     MOVEL'Y'       I6INC4                                              CSW201
     C                     MOVEL'Y'       I6INC5                                              CSW201
     C                     MOVEL'Y'       E#NOUP                                              CSW201
     C                     GOTO EXINCD                                                        CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
      ** PHON with TELE                                                                       CSW201
      *                                                                                       CSW201
     C           'PHON'    LOKUPWFD                      01                                   CSW201
      *                                                                                       CSW201
     C           *IN01     IFEQ '1'                                                           CSW201
     C           'TELE'    LOKUPWFD                      02                                   CSW201
      *                                                                                       CSW201
     C           *IN02     IFEQ '1'                                                           CSW201
     C                     MOVEL'Y'       E#MSGS                                              CSW201
     C                     MOVEL*BLANKS   FTMSDT                                              CSW201
     C                     MOVELE#CPGM    FTPGMQ                                              CSW201
     C                     MOVEL'FTM5208' FTMSID                                              CSW201
     C                     EXSR FTSNMS                                                        CSW201
     C                     MOVEL'Y'       I6INC1                                              CSW201
     C                     MOVEL'Y'       I6INC2                                              CSW201
     C                     MOVEL'Y'       I6INC3                                              CSW201
     C                     MOVEL'Y'       I6INC4                                              CSW201
     C                     MOVEL'Y'       I6INC5                                              CSW201
     C                     MOVEL'Y'       E#NOUP                                              CSW201
     C                     GOTO EXINCD                                                        CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
      ** PHOI with TELI                                                                       CSW201
      *                                                                                       CSW201
     C           'PHOI'    LOKUPWFD                      01                                   CSW201
      *                                                                                       CSW201
     C           *IN01     IFEQ '1'                                                           CSW201
     C           'TELI'    LOKUPWFD                      02                                   CSW201
      *                                                                                       CSW201
     C           *IN02     IFEQ '1'                                                           CSW201
     C                     MOVEL'Y'       E#MSGS                                              CSW201
     C                     MOVEL*BLANKS   FTMSDT                                              CSW201
     C                     MOVELE#CPGM    FTPGMQ                                              CSW201
     C                     MOVEL'FTM5209' FTMSID                                              CSW201
     C                     EXSR FTSNMS                                                        CSW201
     C                     MOVEL'Y'       I6INC1                                              CSW201
     C                     MOVEL'Y'       I6INC2                                              CSW201
     C                     MOVEL'Y'       I6INC3                                              CSW201
     C                     MOVEL'Y'       I6INC4                                              CSW201
     C                     MOVEL'Y'       I6INC5                                              CSW201
     C                     MOVEL'Y'       E#NOUP                                              CSW201
     C                     GOTO EXINCD                                                        CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW202
      ** REPA with HOLD                                                                       CSW202
      ** REPA with CHQB                                                                       CSW202
      ** REPA with BONL                                                                       CSW202
      ** REPA with CORT                                                                       CSW202
      *                                                                                       CSW202
     C           'REPA'    LOKUPWFD                      01                                   CSW202
      *                                                                                       CSW202
     C           *IN01     IFEQ '1'                                                           CSW202
     C           'HOLD'    LOKUPWFD                      02                                   CSW202
     C           'CHQB'    LOKUPWFD                      03                                   CSW202
     C           'BONL'    LOKUPWFD                      04                                   CSW202
     C           'CORT'    LOKUPWFD                      05                                   CSW202
      *                                                                                       CSW202
     C           *IN02     IFEQ '1'                                                           CSW202
     C           *IN03     OREQ '1'                                                           CSW202
     C           *IN04     OREQ '1'                                                           CSW202
     C           *IN05     OREQ '1'                                                           CSW202
     C                     MOVEL'Y'       E#MSGS                                              CSW202
     C                     MOVEL*BLANKS   FTMSDT                                              CSW202
     C                     MOVELE#CPGM    FTPGMQ                                              CSW202
     C                     MOVEL'FTM5502' FTMSID                                              CSW202
     C                     EXSR FTSNMS                                                        CSW202
     C                     MOVEL'Y'       I6INC1                                              CSW202
     C                     MOVEL'Y'       I6INC2                                              CSW202
     C                     MOVEL'Y'       I6INC3                                              CSW202
     C                     MOVEL'Y'       I6INC4                                              CSW202
     C                     MOVEL'Y'       I6INC5                                              CSW202
     C                     MOVEL'Y'       E#NOUP                                              CSW202
     C                     GOTO EXINCD                                                        CSW202
     C                     ENDIF                                                              CSW202
      *                                                                                       CSW202
     C                     ENDIF                                                              CSW202
      *                                                                                       CSW201
      ** If there are no more errors, and there is more than 1 instruction code               CSW201
      ** entered, then check order of sequence.                                               CSW201
      *                                                                                       CSW201
     C                     Z-ADD1         WX2     20                                          CSW201
     C           *BLANK    LOKUPWFD,WX2                  01                                   CSW201
     C           *IN01     IFEQ *ON                                                           CSW201
     C                     SUB  1         WX2                                                 CSW201
     C                     ELSE                                                               CSW201
     C                     Z-ADD5         WX2                                                 CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C           WX2       IFLE 1                                                             CSW201
     C                     GOTO EXINCD                                                        CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C                     Z-ADD1         WIN     20                                          CSW201
      *                                                                                       CSW201
     C           WIN       DOWLTWX2                                                           CSW201
     C                     Z-ADD1         WIX     20                                          CSW201
      *                                                                                       CSW201
     C           WFD,WIN   LOKUPWICOR,WIX                01                                   CSW201
     C           WIN       ADD  1         WIZ     20                                          CSW201
     C           WX2       ADD  1         WX3     20                                          CSW201
      *                                                                                       CSW201
     C           *IN01     IFEQ *ON                                                           CSW201
     C           WIZ       ANDLEWX3                                                           CSW201
     C           WFD,WIZ   LOKUPWICOR,WIX                01                                   CSW201
      *                                                                                       CSW201
     C           *IN01     IFEQ *OFF                                                          CSW201
     C                     MOVEL'Y'       E#MSGS                                              CSW201
     C                     MOVEL*BLANKS   FTMSDT                                              CSW201
     C                     MOVELE#CPGM    FTPGMQ                                              CSW201
     C           CSW202    IFEQ 'Y'                                                           CSW202
     C                     MOVEL'FTM5503' FTMSID                                              CSW202
     C                     ELSE                                                               CSW202
     C                     MOVEL'FTM5210' FTMSID                                              CSW201
     C                     ENDIF                                                              CSW202
      *                                                                                       CSW206
      ** If CSW206 is switched ON, override the message IDs FTM5503 or FTM5210 with           CSW206
      **  FTM5602 because BONL codeword should not be present in 2nd level text               CSW206
      *   message                                                                             CSW206
      *                                                                                       CSW206
     C           CSW206    IFEQ 'Y'                                                           CSW206
     C                     MOVEL'FTM5602' FTMSID                                              CSW206
     C                     ENDIF                                                              CSW206
      *                                                                                       CSW206
     C                     EXSR FTSNMS                                                        CSW201
     C                     MOVEL'Y'       I6INC1                                              CSW201
     C                     MOVEL'Y'       I6INC2                                              CSW201
     C                     MOVEL'Y'       I6INC3                                              CSW201
     C                     MOVEL'Y'       I6INC4                                              CSW201
     C                     MOVEL'Y'       I6INC5                                              CSW201
     C                     MOVEL'Y'       E#NOUP                                              CSW201
     C                     LEAVE                                                              CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C                     ENDIF                                                              CSW201
     C                     ADD  1         WIN                                                 CSW201
      *                                                                                       CSW201
     C                     ENDDO                                                              CSW201
     C                     ENDIF                                                              CSW201
      *                                                                   CFT014
     C           EXINCD    TAG                                            CFT014
      *                                                                   CFT014
      ** Unwind subroutine stack name                                     CFT014
      *                                                                   CFT014
     C                     MOVEA*BLANKS   @STK,Q                          CFT014
     C                     SUB  1         Q                               CFT014
      *                                                                   CFT014
     CSR                   ENDSR                                          CFT014
      *                                                                   CFT014
      *****************************************************************   CFT014
      /EJECT                                                              CFT014
      *****************************************************************   CFT014
      /TITLE SR/SRRRPT                                                    CFT014
      *****************************************************************   CFT014
      *                                                               *   CFT014
      *  SRRRPT - Validate Regulatory Reporting                       *   CFT014
      *                                                               *   CFT014
      *  Called By: SRPROC subroutine                                 *   CFT014
      *                                                               *   CFT014
      *  Calls:                                                       *   CFT014
      *  FTSNMS    - Send message to program message queue.           *   CFT014
      *  AOCTRYR0  - Access Object to get ISO Country Code.           *   CFT014
      *                                                               *   CFT014
      *****************************************************************   CFT014
      *                                                                   CFT014
     C           SRRRPT    BEGSR                           *** SRRRPT *** CFT014
      *                                                                   CFT014
      ** Set up subroutine stack name                                     CFT014
      *                                                                   CFT014
     C                     ADD  1         Q       50                      CFT014
     C                     MOVEL'SRRRPT'  @STK,Q                          CFT014
      *                                                                   CFT014
      ** Entry is optional but if entered, it must follow the correct     CFT014
      ** syntax (Codeword + ISO Country Code + Additional Info) entered   CFT014
      ** on the first line.                                               CFT014
      *                                                                   CFT014
     C           S6RRPT    IFNE *BLANK                                    CFT014
      *                                                                   CFT014
      ** Check if an invalid character exists                             CFT014
      *                                                                   CFT014
     C                     MOVEL' '       ADLINE                          CFT014
     C                     MOVEL'FTM3246' ADFLDM                          CFT014
     C                     MOVEL'FTUSRMSG'ADFLDF                          CFT014
      *                                                                   CFT014
     C                     MOVE *BLANKS   ADDRSS                          CFT014
     C                     MOVELS6RRPT    ADDRSS                          CFT014
      *                                                                   CFT014
     C                     EXSR ADCHK                                     CFT014
      *                                                                   CFT014
      ** Illegal Characters found                                         CFT014
      *                                                                   CFT014
     C           *IN93     IFEQ *ON                                       CFT014
     C                     MOVEL'Y'       E#NOUP                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           AD#1      IFEQ 'Y'                                       CFT014
     C                     MOVEL'Y'       I6RRP1                          CFT014
     C                     ENDIF                                          CFT014
     C           AD#2      IFEQ 'Y'                                       CFT014
     C                     MOVEL'Y'       I6RRP2                          CFT014
     C                     ENDIF                                          CFT014
     C           AD#3      IFEQ 'Y'                                       CFT014
     C                     MOVEL'Y'       I6RRP3                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVELS6RRPT    WRRPT                           CFT014
      *                                                                   CFT014
     C           S6RRP1    IFNE *BLANK                                    CFT014
      *                                                                   CFT014
      ** '?' not available                                                CFT014
      *                                                                   CFT014
     C           '?'       SCAN S6RRP1    Y#             90               CFT014
      *                                                                   CFT014
     C           *IN90     IFEQ *ON                                       CFT014
     C                     MOVEL'Y'       E#MSGS                          CFT014
     C                     MOVELS6RRP1    FTMSDT                          CFT014
     C                     MOVELE#CPGM    FTPGMQ                          CFT014
     C                     MOVEL'FTM3225' FTMSID                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVEL'Y'       I6RRP1                          CFT014
     C                     MOVEL'Y'       E#NOUP                          CFT014
     C                     GOTO EXRRPT                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           WCWORD    IFEQ WORDER                                    CFT014
     C           WCWORD    OREQ WBENEF                                    CFT014
      *                                                                   CFT014
      ** Access ISO Country Code via access object AOCTRYR0               CFT014
      *                                                                   CFT014
     C                     CALL 'AOCTRYR0'                                CFT014
     C                     PARM *BLANKS   @RTCD                           CFT014
     C                     PARM '*KEY   ' @OPTN                           CFT014
     C                     PARM WISOCD    @CNCD   2                       CFT014
     C           SDCTRY    PARM SDCTRY    DSFDY                           CFT014
      *                                                                   CFT014
      ** Validate Syntax                                                  CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE *BLANK                                    CFT014
     C           WADSLH    ORNE '//'                                      CFT014
     C           WADSLH    ANDNE*BLANK                                    CFT014
     C                     MOVEL'Y'       E#MSGS                          CFT014
     C                     MOVEL*BLANKS   FTMSDT                          CFT014
     C                     MOVELE#CPGM    FTPGMQ                          CFT014
     C                     MOVEL'FTM3227' FTMSID                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVEL'Y'       I6RRP1                          CFT014
     C                     MOVEL'Y'       E#NOUP                          CFT014
     C                     GOTO EXRRPT                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           @RTCD     IFEQ *BLANK                                    CFT014
     C           WADSLH    ANDEQ'//'                                      CFT014
     C           WADINF    ANDEQ*BLANK                                    CFT014
     C                     MOVEL'Y'       E#MSGS                          CFT014
     C                     MOVEL*BLANKS   FTMSDT                          CFT014
     C                     MOVELE#CPGM    FTPGMQ                          CFT014
     C                     MOVEL'FTM2170' FTMSID                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVEL'Y'       I6RRP1                          CFT014
     C                     MOVEL'Y'       E#NOUP                          CFT014
     C                     GOTO EXRRPT                                    CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** 1st line is blank and the remaining lines are entered.           CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
     C           WRL23     IFNE *BLANK                                    CFT014
     C                     MOVEL'Y'       E#MSGS                          CFT014
     C                     MOVEL*BLANKS   FTMSDT                          CFT014
     C                     MOVELE#CPGM    FTPGMQ                          CFT014
     C                     MOVEL'FTM3228' FTMSID                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVEL'Y'       I6RRP1                          CFT014
     C                     MOVEL'Y'       E#NOUP                          CFT014
     C                     GOTO EXRRPT                                    CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                                     AR920077
      ** Pre check second line if either Order or Bene then rest                            AR920077
      *                                                                                     AR920077
     C           10        SUBSTS6RRP2    U#010A 10                                         AR920077
      *                                                                                     AR920077
      ** If second code word then check                                                     AR920077
      *                                                                                     AR920077
     C           U#010A    IFEQ WORDER                                                      AR920077
     C           U#010A    OREQ WBENEF                                                      AR920077
      *                                                                                     AR920077
     C                     MOVELS6RRP2    WRRPT                                             AR920077
      *                                                                                     AR920077
      ** Access ISO Country Code via access object AOCTRYR0                                 AR920077
      *                                                                                     AR920077
     C                     CALL 'AOCTRYR0'                                                  AR920077
     C                     PARM *BLANKS   @RTCD                                             AR920077
     C                     PARM '*KEY   ' @OPTN                                             AR920077
     C                     PARM WISOCD    @CNCD   2                                         AR920077
     C           SDCTRY    PARM SDCTRY    DSFDY                                             AR920077
      *                                                                                     AR920077
      ** Validate Syntax                                                                    AR920077
      *                                                                                     AR920077
     C           @RTCD     IFNE *BLANK                                                      AR920077
     C           WADSLH    ORNE '//'                                                        AR920077
     C           WADSLH    ANDNE*BLANK                                                      AR920077
     C                     MOVEL'Y'       E#MSGS                                            AR920077
     C                     MOVEL*BLANKS   FTMSDT                                            AR920077
     C                     MOVELE#CPGM    FTPGMQ                                            AR920077
     C                     MOVEL'FTM3227' FTMSID                                            AR920077
     C                     EXSR FTSNMS                                                      AR920077
     C                     MOVEL'Y'       I6RRP2                                            AR920077
     C                     MOVEL'Y'       E#NOUP                                            AR920077
     C                     GOTO EXRRPT                                                      AR920077
     C                     ENDIF                                                            AR920077
      *                                                                                     AR920077
     C           @RTCD     IFEQ *BLANK                                                      AR920077
     C           WADSLH    ANDEQ'//'                                                        AR920077
     C           WADINF    ANDEQ*BLANK                                                      AR920077
     C                     MOVEL'Y'       E#MSGS                                            AR920077
     C                     MOVEL*BLANKS   FTMSDT                                            AR920077
     C                     MOVELE#CPGM    FTPGMQ                                            AR920077
     C                     MOVEL'FTM2170' FTMSID                                            AR920077
     C                     EXSR FTSNMS                                                      AR920077
     C                     MOVEL'Y'       I6RRP2                                            AR920077
     C                     MOVEL'Y'       E#NOUP                                            AR920077
     C                     GOTO EXRRPT                                                      AR920077
     C                     ENDIF                                                            AR920077
      *                                                                                     AR920077
      ** Additional info line 3 is entered.                                                 AR920077
      *                                                                                     AR920077
     C           S6RRP3    IFNE *BLANK                                                      AR920077
     C           2         SUBSTS6RRP3    WINFO2  2                                         AR920077
      *                                                                                     AR920077
      ** Error, additional info must be preceded by '//'                                    AR920077
      *                                                                                     AR920077
     C           WCWORD    IFEQ WORDER                                                      AR920077
     C           WCWORD    OREQ WBENEF                                                      AR920077
     C           WINFO2    IFNE '//'                                                        AR920077
     C                     MOVEL'Y'       E#MSGS                                            AR920077
     C                     MOVEL*BLANKS   FTMSDT                                            AR920077
     C                     MOVELE#CPGM    FTPGMQ                                            AR920077
     C                     MOVEL'FTM3230' FTMSID                                            AR920077
     C                     EXSR FTSNMS                                                      AR920077
     C                     MOVEL'Y'       I6RRP3                                            AR920077
     C                     MOVEL'Y'       E#NOUP                                            AR920077
     C                     ELSE                                                             AR920077
     C           WADIN3    IFEQ *BLANK                                                      AR920077
     C                     MOVEL'Y'       E#MSGS                                            AR920077
     C                     MOVEL*BLANKS   FTMSDT                                            AR920077
     C                     MOVELE#CPGM    FTPGMQ                                            AR920077
     C                     MOVEL'FTM2170' FTMSID                                            AR920077
     C                     EXSR FTSNMS                                                      AR920077
     C                     MOVEL'Y'       I6RRP3                                            AR920077
     C                     MOVEL'Y'       E#NOUP                                            AR920077
     C                     GOTO EXRRPT                                                      AR920077
     C                     ENDIF                                                            AR920077
     C                     ENDIF                                                            AR920077
     C                     ENDIF                                                            AR920077
     C                     ENDIF                                                            AR920077
      *                                                                                     AR920077
     C                     ELSE                                                             AR920077
      *                                                                   CFT014
      ** Additional info line 2 is entered.                               CFT014
      *                                                                   CFT014
     C           S6RRP2    IFNE *BLANK                                    CFT014
     C           2         SUBSTS6RRP2    WINFO1  2                       CFT014
      *                                                                   CFT014
      ** Error, additional info must be preceded by '//'                  CFT014
      *                                                                   CFT014
     C           WCWORD    IFEQ WORDER                                    CFT014
     C           WCWORD    OREQ WBENEF                                    CFT014
     C           WINFO1    IFNE '//'                                      CFT014
     C                     MOVEL'Y'       E#MSGS                          CFT014
     C                     MOVEL*BLANKS   FTMSDT                          CFT014
     C                     MOVELE#CPGM    FTPGMQ                          CFT014
     C                     MOVEL'FTM3230' FTMSID                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVEL'Y'       I6RRP2                          CFT014
     C                     MOVEL'Y'       E#NOUP                          CFT014
     C                     GOTO EXRRPT                                    CFT014
     C                     ELSE                                           CFT014
     C           WADIN2    IFEQ *BLANK                                    CFT014
     C                     MOVEL'Y'       E#MSGS                          CFT014
     C                     MOVEL*BLANKS   FTMSDT                          CFT014
     C                     MOVELE#CPGM    FTPGMQ                          CFT014
     C                     MOVEL'FTM2170' FTMSID                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVEL'Y'       I6RRP2                          CFT014
     C                     MOVEL'Y'       E#NOUP                          CFT014
     C                     GOTO EXRRPT                                    CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** 2nd line is blank and the remaining line is entered.             CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
     C           S6RRP3    IFNE *BLANK                                    CFT014
     C                     MOVEL'Y'       E#MSGS                          CFT014
     C                     MOVEL*BLANKS   FTMSDT                          CFT014
     C                     MOVELE#CPGM    FTPGMQ                          CFT014
     C                     MOVEL'FTM3229' FTMSID                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVEL'Y'       I6RRP2                          CFT014
     C                     MOVEL'Y'       E#NOUP                          CFT014
     C                     GOTO EXRRPT                                    CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Additional info line 3 is entered.                               CFT014
      *                                                                   CFT014
     C           S6RRP3    IFNE *BLANK                                    CFT014
     C           2         SUBSTS6RRP3    WINFO2  2                       CFT014
      *                                                                   CFT014
      ** Error, additional info must be preceded by '//'                  CFT014
      *                                                                   CFT014
     C           WCWORD    IFEQ WORDER                                    CFT014
     C           WCWORD    OREQ WBENEF                                    CFT014
     C           WINFO2    IFNE '//'                                      CFT014
     C                     MOVEL'Y'       E#MSGS                          CFT014
     C                     MOVEL*BLANKS   FTMSDT                          CFT014
     C                     MOVELE#CPGM    FTPGMQ                          CFT014
     C                     MOVEL'FTM3230' FTMSID                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVEL'Y'       I6RRP3                          CFT014
     C                     MOVEL'Y'       E#NOUP                          CFT014
     C                     ELSE                                           CFT014
     C           WADIN3    IFEQ *BLANK                                    CFT014
     C                     MOVEL'Y'       E#MSGS                          CFT014
     C                     MOVEL*BLANKS   FTMSDT                          CFT014
     C                     MOVELE#CPGM    FTPGMQ                          CFT014
     C                     MOVEL'FTM2170' FTMSID                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVEL'Y'       I6RRP3                          CFT014
     C                     MOVEL'Y'       E#NOUP                          CFT014
     C                     GOTO EXRRPT                                    CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                                            AR920077
      *                                                                                     AR920077
     C           EXRRPT    TAG                                            CFT014
      *                                                                   CFT014
      ** Unwind subroutine stack name                                     CFT014
      *                                                                   CFT014
     C                     MOVEA*BLANKS   @STK,Q                          CFT014
     C                     SUB  1         Q                               CFT014
      *                                                                   CFT014
     CSR                   ENDSR                                          CFT014
      *                                                                   CFT014
      ** This subroutine has been moved to FT0347 (1st screen val.)       CFT014
      *                                                                   CFT014
      *****************************************************************   CFT014
      *****************************************************************   CFT014
      ***SRINBK***:*Validate*Intermediary*Bank*************************   CFT014
      *****************************************************************   CFT014
      ***CALLED*BY:*SRPROC*********************************************   CFT014
      *****************************************************************   CFT014
      ***CALLS****:****************************************************   CFT014
      *****************************************************************   CFT014
      *****************************************************************   CFT014
     C***SR******   SRINBK    BEGSR                                       CFT014
      ***********                                                         CFT014
      ***Set*up*subroutine*stack*name**********************************   CFT014
      ***********                                                         CFT014
     C***********          ADD  1         Q                               CFT014
     C***********          MOVEL'SRINBK'  @STK,Q                          CFT014
      ***********                                                         CFT014
      ***/COPY*Statement***********************************************   CFT014
      ***********                                                         CFT014
     C***/COPY*WNCPYSRC,FT0348INBK                                        CFT014
      ***********                                                         CFT014
      ***Intermediary*Bank*is*optional*********************************   CFT014
      ***********                                                         CFT014
     C***********          MOVEL*BLANKS   F6INBT                          CFT014
      ***********                                                         CFT014
     C***********S6IBK     IFEQ *BLANKS                                   CFT014
     C***********          MOVEL*BLANKS   ADDRSS                   CFT004 CFT004
     C***********          GOTO EXINBK                                    CFT014
     C***********          END                                            CFT014
     C***/COPY*WNCPYSRC,FT0348C005*************************************   CFT014
      ***********                                                         CFT014
      ***Entry*not*allowed*if*no*Account*with*Institution**************   CFT014
      ***********                                                         CFT014
     C***********V#ACBT    IFEQ *BLANKS                                   CFT014
     C***********          MOVEL'Y'       E#MSGS                          CFT014
     C***********          MOVEL*BLANKS   FTMSDT                          CFT014
     C***********          MOVELE#CPGM    FTPGMQ                          CFT014
     C***********          MOVEL'FTM2182' FTMSID                          CFT014
     C***********          EXSR FTSNMS                                    CFT014
     C***********          MOVEL'Y'       I6INB1                          CFT014
     C***********          MOVEL'Y'       E#NOUP                          CFT014
     C***********          MOVEA' '       WRN@,1                          CFT014
     C***********          GOTO EXINBK                                    CFT014
     C***********          END                                            CFT014
     C***/COPY*WNCPYSRC,FT0348C006                                        CFT014
      ***********                                                         CFT014
      ***?*not*allowed*************************************************   CFT014
      ***********                                                         CFT014
     C***********'?'       SCAN S6IBK1    Y#             90               CFT014
      ***********                                                         CFT014
     C************IN90     IFEQ '1'                                       CFT014
     C***********          MOVEL'Y'       E#MSGS                          CFT014
     C***********          MOVEL*BLANKS   FTMSDT                          CFT014
     C***********          MOVELE#CPGM    FTPGMQ                          CFT014
     C***********          MOVEL'FTM2183' FTMSID                          CFT014
     C***********          EXSR FTSNMS                                    CFT014
     C***********          MOVEL'Y'       I6INB1                          CFT014
     C***********          MOVEL'Y'       E#NOUP                          CFT014
     C***********          MOVEA' '       WRN@,1                          CFT014
     C***********          GOTO EXINBK                                    CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
      ***Move*in*data*for*address*validation***************************   CFT014
      ***********                                                         CFT014
     C***********          MOVE *BLANKS   ADDRSS                          CFT014
     C***********          MOVELS6IBK     ADDRSS                          CFT014
      ***********                                                         CFT014
      ***If*first*ten*characters*used*then*try*to*find*via*SDCUSTPD****   CFT014
      ***********                                                         CFT014
     C***********ADCH26    IFEQ *BLANKS                                   CFT014
     C***********ADEXCS    ANDEQ*BLANKS                                   CFT014
     C***********ADSLSH    ANDNE'/'                                       CFT014
     C***********ADCH36    OREQ *BLANKS                                   CFT014
     C***********ADXCS2    ANDEQ*BLANKS                                   CFT014
     C***********ADCHK2    ANDNE*BLANKS                                   CFT014
     C***********ADSLSH    ANDEQ'/'                                       CFT014
     C***********ADSLS2    ANDNE'/'                                       CFT014
      ***********                                                         CFT014
      ***First*10*characters*should*be*key*for*SDCUST******************   CFT014
      ***********                                                         CFT014
     C***********ADSLSH    IFNE '/'                                       CFT014
     C***********          MOVELADCHK1    @CNUM                           CFT014
     C***********          ELSE                                           CFT014
     C***********          MOVELADCHK2    @CNUM                           CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
      ***Call*to*access*pgm*for*Customer*details***********************   CFT014
      ***********                                                         CFT014
     C***********          CALL 'AOCUSTR0'             9090               CFT014
     C***********          PARM *BLANKS   @RTCD   7                       CFT014
     C***********          PARM '*KEY   ' @OPTN   7                       CFT014
     C***********          PARM           @CNUM  10                       CFT014
     C***********          PARM *BLANKS   @KYST   7                       CFT014
     C***********SDCUST    PARM *BLANKS   DSSDY                           CFT014
      ***********                                                         CFT014
     C************IN90     IFEQ '1'                                       CFT014
     C***********          MOVEL'AOCUSTR0'W0FILE           ***************CFT014
     C***********          MOVEL'*CALL'   W0KEY            * DB ERROR 02 *CFT014
     C***********          Z-ADD2         W0ERNB           ***************CFT014
     C***********          MOVEL'MEM5003' W0MSGD                          CFT014
     C***********          MOVEL'MIDAS  ' W0MSGF                          CFT014
     C***********          EXSR SRERR                                     CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
     C***********@RTCD     IFEQ *BLANKS                                   CFT014
      ***********                                                         CFT014
      **Overwrite*shortname********************************************   CFT014
      ***********                                                         CFT014
     C***********ADSLSH    IFNE '/'                                       CFT014
     C***********          MOVEL*BLANKS   S6IBK1                          CFT014
     C***********          MOVELBBCUST    S6IBK1                          CFT014
     C***********          ELSE                                           CFT014
     C***********          MOVEL*BLANKS   S6IBK2                          CFT014
     C***********          MOVELBBCUST    S6IBK2                          CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
     C***********          MOVEL'C'       F6INBT                          CFT014
      ***********                                                         CFT014
      **Valid*information*exit*****************************************   CFT014
      ***********                                                         CFT014
     C***********          GOTO EXINBK                                    CFT014
      ***********                                                         CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
      ***If*only*1st*line*entered*then*SWIFT*Address*assumed***********   CFT014
      ***Or*first*is*'/'*and*second*is*SWIFT*Address*******************   CFT014
      ***********                                                         CFT014
      ***********                                                         CFT014
      ***If*field*does*not*begin*with*'/'*and*is*not*longer*than*11****   CFT014
      ***characters,*validate*as*a*S.W.I.F.T.*Address******************   CFT014
      ***********                                                         CFT014
     C***********ADCH26    IFEQ *BLANKS                                   CFT014
     C***********ADEXSW    ANDEQ*BLANKS                                   CFT014
     C***********ADSLSH    ANDNE'/'                                       CFT014
     C***********ADCH36    OREQ *BLANKS                                   CFT014
     C***********ADEXS2    ANDEQ*BLANKS                                   CFT014
     C***********ADSLSH    ANDEQ'/'                                       CFT014
     C***********ADSLS2    ANDNE'/'                                       CFT014
      ***********                                                         CFT014
      ***First*11*characters*should*be*key*for*CLSWT.******************   CFT014
      ***********                                                         CFT014
     C***********ADSLSH    IFNE '/'                                       CFT014
     C***********          MOVELADCHK1    CLSWTK                          CFT014
     C***********          ELSE                                           CFT014
     C***********          MOVELADCHK2    CLSWTK                          CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
     C***********          EXSR SWIFT                                     CFT014
      ***********                                                         CFT014
     C***********##CSID    IFEQ 'Y'                                       CFT014
     C************IN31     IFEQ '1'                                       CFT014
     C***/COPY*WNCPYSRC,FT0348C003                                        CFT014
     C***********          MOVEL'Y'       E#MSGS                          CFT014
     C***********          MOVELCLSWTK    FTMSDT                          CFT014
     C***********          MOVELE#CPGM    FTPGMQ                          CFT014
     C***********          MOVEL'FTM2184' FTMSID                          CFT014
     C***********          EXSR FTSNMS                                    CFT014
      ***********                                                         CFT014
      ***Highlight*correct*field***************************************   CFT014
      ***********                                                         CFT014
     C***********ADSLSH    IFNE '/'                                       CFT014
     C***********          MOVEL'Y'       I6INB1                          CFT014
     C***********          ELSE                                           CFT014
     C***********          MOVEL'Y'       I6INB2                          CFT014
     C***********          END                                            CFT014
     C***********          MOVEL'Y'       E#NOUP                          CFT014
     C***********          MOVEA' '       WRN@,1                          CFT014
     C***********          GOTO EXINBK                                    CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
     C***********          MOVEL'S'       F6INBT                          CFT014
      ***********                                                         CFT014
      ***No*SWIFT*address*record.**************************************   CFT014
      ***********                                                         CFT014
     C************IN32     IFEQ '1'                                       CFT014
     C************IN31     ANDEQ'0'                                       CFT014
     C***/COPY WNCPYSRC,FT0348C004                                        CFT014
      ***********                                                         CFT014
      ***If*text*changed*then*warning*needs*to*be*changed**************   CFT014
      ***********                                                         CFT014
     C***********CLSWTK    IFNE V#INB1                                    CFT014
     C***********          MOVEA' '       WRN@,1                          CFT014
     C***********          MOVELCLSWTK    V#INB1                          CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
      ***********                                                         CFT014
      ***Highlight*correct*field***************************************   CFT014
      ***********                                                         CFT014
     C***********ADSLSH    IFNE '/'                                       CFT014
     C***********          MOVEL'Y'       I6INB1                          CFT014
     C***********          ELSE                                           CFT014
     C***********          MOVEL'Y'       I6INB2                          CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
     C***********          MOVEL'Y'       E#WARN                          CFT014
     C***********          MOVEL'Y'       E#MSGS                          CFT014
     C***********          MOVELCLSWTK    FTMSDT                          CFT014
     C***********          MOVELE#CPGM    FTPGMQ                          CFT014
     C***********          MOVEL'FTM2185' FTMSID                          CFT014
     C***********          EXSR FTSNMS                                    CFT014
      ***********                                                         CFT014
     C***********WRN@,1    IFEQ ' '                                       CFT014
     C***********          MOVEL*BLANKS   E#RSND                          CFT014
     C***********          MOVEA'Y'       WRN@,1                          CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
     C***********          ELSE                                           CFT014
     C***********          MOVEA' '       WRN@,1                          CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
      **Exit*as*validation*complete*for*S.W.I.F.T.*********************   CFT014
      ***********                                                         CFT014
     C***********          GOTO EXINBK                                    CFT014
      ***********                                                         CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
     C***********          MOVEA' '       WRN@,1                          CFT014
      ***********                                                         CFT014
      **Invalid*customer*number*or*shortname.**************************   CFT014
      ***********                                                         CFT014
     C***/COPY*WNCPYSRC,FT0348C001                                        CFT014
     C***********ADCH26    IFEQ *BLANKS                                   CFT014
     C***********ADEXCS    ANDEQ*BLANKS                                   CFT014
     C***********ADSLSH    ANDNE'/'                                       CFT014
     C***********ADCH36    OREQ *BLANKS                                   CFT014
     C***********ADXCS2    ANDEQ*BLANKS                                   CFT014
     C***********ADCHK2    ANDNE*BLANKS                                   CFT014
     C***********ADSLSH    ANDEQ'/'                                       CFT014
     C***********ADSLS2    ANDNE'/'                                       CFT014
      ***********                                                         CFT014
      ***First*10*characters*should*be*key*for*SDCUST******************   CFT014
      ***********                                                         CFT014
     C***********ADSLSH    IFNE '/'                                       CFT014
     C***********          MOVELADCHK1    FTMSDT                          CFT014
     C***********          MOVEL'Y'       I6INB1                          CFT014
     C***********          ELSE                                           CFT014
     C***********          MOVELADCHK2    FTMSDT                          CFT014
     C***********          MOVEL'Y'       I6INB2                          CFT014
     C***********          END                                            CFT014
     C***********          MOVEL'Y'       E#MSGS                          CFT014
     C***********          MOVELE#CPGM    FTPGMQ                          CFT014
     C***********          MOVEL'FTM2186' FTMSID                          CFT014
     C***********          EXSR FTSNMS                                    CFT014
     C***********          MOVEL'Y'       E#NOUP                          CFT014
     C***********          MOVEA' '       WRN@,1                          CFT014
     C***********          GOTO EXINBK                                    CFT014
     C***********          END                                            CFT014
     C***/COPY*WNCPYSRC,FT0348C002                                        CFT014
      ***********                                                         CFT014
      **Validate*as*an*address*****************************************   CFT014
      ***********                                                         CFT014
     C***********          MOVEL'Y'       ADLINE  1                       CFT014
     C***********          MOVEL'FTM2319' ADFLDM                          CFT014
     C***********          MOVEL'FTUSRMSG'ADFLDF                          CFT014
     C***********          EXSR ADCHK                                     CFT014
      ***********                                                         CFT014
      ***Depending*on*the*indicators,*highlight*the*field*in*error*****   CFT014
      ***********                                                         CFT014
     C************IN91     IFEQ '1'                                       CFT014
     C***********          MOVEL'Y'       E#MSGS                          CFT014
     C***********          MOVELADCHK1    FTMSDT                          CFT014
     C***********          MOVELE#CPGM    FTPGMQ                          CFT014
     C***********          MOVEL'FTM2187' FTMSID                          CFT014
     C***********          EXSR FTSNMS                                    CFT014
     C***********          MOVEL'Y'       I6INB1                          CFT014
     C***********          MOVEL'Y'       E#NOUP                          CFT014
     C***********          END                                            CFT014
     C***********                                                         CFT014
     C************IN92     IFEQ '1'                                       CFT014
     C***********          MOVEL'Y'       E#MSGS                          CFT014
     C***********          MOVELADCHK1    FTMSDT                          CFT014
     C***********          MOVELE#CPGM    FTPGMQ                          CFT014
     C***********          MOVEL'FTM2188' FTMSID                          CFT014
     C***********          EXSR FTSNMS                                    CFT014
     C***********          MOVEL'Y'       I6INBK                          CFT014
     C***********          MOVEL'Y'       E#NOUP                          CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
      ***Illegal*Characters*found**************************************   CFT014
      ***********                                                         CFT014
     C************IN93     IFEQ '1'                                       CFT014
     C***********          MOVEL'Y'       E#NOUP                          CFT014
     C***********          END                                            CFT014
     C***********                                                         CFT014
     C***********AD#1      IFEQ 'Y'                                       CFT014
     C***********          MOVEL'Y'       I6INB1                          CFT014
     C***********          END                                            CFT014
     C***********AD#2      IFEQ 'Y'                                       CFT014
     C***********          MOVEL'Y'       I6INB2                          CFT014
     C***********          END                                            CFT014
     C***********AD#3      IFEQ 'Y'                                       CFT014
     C***********          MOVEL'Y'       I6INB3                          CFT014
     C***********          END                                            CFT014
     C***********AD#4      IFEQ 'Y'                                       CFT014
     C***********          MOVEL'Y'       I6INB4                          CFT014
     C***********          END                                            CFT014
     C***********AD#5      IFEQ 'Y'                                       CFT014
     C***********          MOVEL'Y'       I6INB5                          CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
     C***********I6INBK    IFEQ *BLANKS                                   CFT014
     C***********          MOVEL'A'       F6INBT                          CFT014
     C***********          END                                            CFT014
     C***/COPY*WNCPYSRC,FT0348C008                                        CFT014
      ***********                                                         CFT014
      ***Unwind*subroutine*stack*name**********************************   CFT014
      ***********                                                         CFT014
     C***********EXINBK    TAG                                            CFT014
     C***********                                                  CFT004 CFT014
      **Check*if*line*one*contain*an*IBAN**************************CFT004 CFT014
     C***********CFT004    IFEQ 'Y'                                CFT004 CFT014
     C***********                                                  CFT004 CFT014
     C***If*the*field*start*with*'/aann'*or*'aann'*****************CFT004 CFT014
     C***validate*as*an*IBAN*(INTERNATIONAL*BANK*ACCOUNT*NUMBER)***CFT004 CFT014
     C***having*first*formatted*field*removing*blanks*and*IBAN*prefixT004 CFT014
     C***********                                                  CFT004 CFT014
     C***********ADSLSH    IFEQ '/'                                CFT004 CFT014
     C***********34        SUBSTADCHK1:2  PIBAN                    CFT004 CFT014
     C***********          ELSE                                    CFT004 CFT014
     C***********          MOVELADCHK1    PIBAN                    CFT004 CFT014
     C***********          ENDIF                                   CFT004 CFT014
     C***********                                                  CFT004 CFT014
     C***********          CALL 'AOIBANR3'                         CFT004 CFT014
     C***********          PARM           @RTCD                    CFT004 CFT014
     C***********          PARM           PIBAN  47                CFT004 CFT014
     C***********          PARM           POWITH 47                CFT004 CFT014
     C***********P@IBAN    PARM           PONOBL 34                CFT004 CFT014
     C***********                                                  CFT004 CFT014
     C***********1         SUBSTP@IBAN:1  IBCTY1  1                CFT004 CFT014
     C***********1         SUBSTP@IBAN:2  IBCTY2  1                CFT004 CFT014
     C***********1         SUBSTP@IBAN:3  IBCHK1  1                CFT004 CFT014
     C***********1         SUBSTP@IBAN:4  IBCHK2  1                CFT004 CFT014
     C***********IBCTY1    LOKUPALPH                     94        CFT004 CFT014
     C***94******IBCTY2    LOKUPALPH                     94        CFT004 CFT014
     C***94******IBCHK1    LOKUPNUMC                     94        CFT004 CFT014
     C***94******IBCHK2    LOKUPNUMC                     94        CFT004 CFT014
     C***********                                                  CFT004 CFT014
     C************IN94     IFEQ *ON                                CFT004 CFT014
     C***********          CALL 'AOIBANR5'             90          CFT004 CFT014
     C***********          PARM *BLANKS   @RTCD   7                CFT004 CFT014
     C***********          PARM           P@IBAN 34                CFT004 CFT014
     C***********                                                  CFT004 CFT014
     C************IN90     IFEQ *OFF                               CFT004 CFT014
     C***********@RTCD     ANDEQ*BLANKS                            CFT004 CFT014
     C***********'/'       CAT  P@IBAN    S6IBK1                   CFT004 CFT014
     C***********          MOVEA' '       WRN@,2                   CFT004 CFT014
     C***********          ELSE                                    CFT004 CFT014
     C***********          MOVE @RTCD     WRTCD   1                CFT004 CFT014
     C***********          MOVELWINT      FTMSDT                   CFT004 CFT014
     C***********          SELEC                                   CFT004 CFT014
      **Invalid*ISO*Country*Code***********************************CFT004 CFT014
     C***********WRTCD     WHEQ '1'                                CFT004 CFT014
     C***********          MOVEL'FTM2400' FTMSID                   CFT004 CFT014
      **Invalid*BBAN*Length****************************************CFT004 CFT014
     C***********WRTCD     WHEQ '2'                                CFT004 CFT014
     C***********          MOVEL'FTM2401' FTMSID                   CFT004 CFT014
      **Invalid*Character******************************************CFT004 CFT014
     C***********WRTCD     WHEQ '3'                                CFT004 CFT014
     C***********          MOVEL'FTM2402' FTMSID                   CFT004 CFT014
      **Invalid*IBAN*Length****************************************CFT004 CFT014
     C***********WRTCD     WHEQ '4'                                CFT004 CFT014
     C***********          MOVEL'FTM2403' FTMSID                   CFT004 CFT014
      **Invalid*Check*Digit****************************************CFT004 CFT014
     C***********WRTCD     WHEQ '5'                                CFT004 CFT014
     C***********          MOVEL'FTM2404' FTMSID                   CFT004 CFT014
     C***********          OTHER                                   CFT004 CFT014
     C***********          MOVEL'FTM2405' FTMSID                   CFT004 CFT014
     C***********          ENDSL                                   CFT004 CFT014
     C***********          MOVE 'Y'       I6INB1                   CFT004 CFT014
     C***********          MOVEL'Y'       E#WARN                   CFT004 CFT014
     C***********          MOVEL'Y'       E#MSGS                   CFT004 CFT014
     C***********          MOVELE#CPGM    FTPGMQ                   CFT004 CFT014
     C***********          EXSR FTSNMS                             CFT004 CFT014
     C***********                                                  CFT004 CFT014
     C***********WRN@,2    IFEQ ' '                                CFT004 CFT014
     C***********          MOVEL*BLANKS   E#RSND                   CFT004 CFT014
     C***********          MOVEA'Y'       WRN@,2                   CFT004 CFT014
     C***********          END                                     CFT004 CFT014
     C***********          ENDIF                                   CFT004 CFT014
     C***********          ENDIF                                   CFT004 CFT014
     C***********          ENDIF                                   CFT004 CFT014
      ***********                                                  CFT004 CFT014
     C***********          MOVEA*BLANKS   @STK,Q                          CFT014
     C***********          SUB  1         Q       50                      CFT014
      ***********                                                         CFT014
     C***SR******             ENDSR                                       CFT014
     C***/EJECT**                                                         CFT014
      *****************************************************************
      *                                                               *
      *  SRCHAP   : Validate CHAPS code                               *
      *                                                               *
      *  CALLED BY: SRPROC - Control Process of Validation            *
      *                                                               *
      *  CALLS    :        -                                          *
      *                                                               *
      *****************************************************************
     CSR         SRCHAP    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SRCHAP'  @STK,Q
      *
      *  /COPY Statement
      *
     C/COPY WNCPYSRC,FT0348CHAP
      *
      *  If settle through CHAPS then must not be blank or zero
      *
     C           V#STMT    IFEQ '10'
     C           S6CHAP    ANDEQ*BLANKS
     C                     MOVEL'Y'       E#MSGS
     C                     MOVELS6CHAP    FTMSDT
     C                     MOVELE#CPGM    FTPGMQ
     C                     MOVEL'FTM2189' FTMSID
     C                     EXSR FTSNMS
     C                     MOVEL'Y'       I6CHAP
     C                     MOVEL'Y'       E#NOUP
     C                     GOTO EXCHAP
     C                     END
      *
     C           V#STMT    IFEQ '10'
     C           S6CHAP    ANDEQ*ALL'0'
     C                     MOVEL'Y'       E#MSGS
     C                     MOVELS6CHAP    FTMSDT
     C                     MOVELE#CPGM    FTPGMQ
     C                     MOVEL'FTM2190' FTMSID
     C                     EXSR FTSNMS
     C                     MOVEL'Y'       I6CHAP
     C                     MOVEL'Y'       E#NOUP
     C                     GOTO EXCHAP
     C                     END
      *
      *  Must be numeric
      *
     C           S6CHAP    IFNE *BLANKS
     C                     MOVEL*BLANKS   I#FLD
     C                     MOVELS6CHAP    I#FLD  35
     C           DIGITS    CHECKI#FLD     Y#      30     90
      *
      *  Valid only if 6 digits
      *
     C           *IN90     IFEQ '1'
     C           Y#        ANDNE7
     C                     MOVEL'Y'       E#MSGS
     C                     MOVELS6CHAP    FTMSDT
     C                     MOVELE#CPGM    FTPGMQ
     C                     MOVEL'FTM2191' FTMSID
     C                     EXSR FTSNMS
     C                     MOVEL'Y'       I6CHAP
     C                     MOVEL'Y'       E#NOUP
     C                     GOTO EXCHAP
     C                     END
     C                     END
      *
      *  Unwind subroutine stack name
      *
     C           EXCHAP    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRNBKC   : Validate Central Bank Reference                   *
      *                                                               *
      *  CALLED BY: SRPROC - Control Process of Validation            *
      *                                                               *
      *  CALLS    :        -                                          *
      *                                                               *
      *****************************************************************
     CSR         SRNBKC    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SRNBKC'  @STK,Q
      *
      *  /COPY Statement
      *
     C/COPY WNCPYSRC,FT0348NBKC
      *
      *  Central Bank Reference Code is optional
      *
     C           S6CBKR    IFEQ *BLANKS
     C           S6CBKR    OREQ *ALL'0'
     C/COPY WNCPYSRC,FT0348C037
     C                     GOTO EXNBKC
     C                     END
     C/COPY WNCPYSRC,FT0348C039
      *
      *  Validate via ZALIGN as an 11,0 numeric field
      *
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVELS6CBKR    ZFIELD
     C                     Z-ADD0         ZADEC
     C                     Z-ADD11        ZADIG
     C                     EXSR SRALGN
      *
     C           ZRTN      IFEQ '*ERROR*'
     C                     MOVEL'Y'       E#MSGS
     C                     MOVELS6CBKR    FTMSDT
     C                     MOVELE#CPGM    FTPGMQ
     C                     MOVEL'FTM2192' FTMSID
     C                     EXSR FTSNMS
     C                     MOVEL'Y'       I6CBKR
     C                     MOVEL'Y'       E#NOUP
     C                     ELSE
     C/COPY WNCPYSRC,FT0348C038
     C                     MOVE ZFIELD    S6CBKR
     C                     END
     C*
     C/COPY WNCPYSRC,FT0348CCP1
     C*
      *
      *  Unwind subroutine stack name
      *
     C           EXNBKC    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
     C/EJECT
      *                                                                   CFT014
      ** This subroutine has been moved to FT0349 (3rd screen val.)       CFT014
      *                                                                   CFT014
      *****************************************************************   CFT014
      *****************************************************************   CFT014
      ***SRDETC***:*Validate*Details*Of*Charges************************   CFT014
      *****************************************************************   CFT014
      ***CALLED*BY:*SRPROC*-*Control*Process*of*Validation*************   CFT014
      *****************************************************************   CFT014
      ***CALLS****:********-*******************************************   CFT014
      *****************************************************************   CFT014
      *****************************************************************   CFT014
     C***SR******   SRDETC    BEGSR                                       CFT014
      ***********                                                         CFT014
      ***Set*up*subroutine*stack*name**********************************   CFT014
      ***********                                                         CFT014
     C***********          ADD  1         Q       50                      CFT014
     C***********          MOVEL'SRDETC'  @STK,Q                          CFT014
      ***********                                                         CFT014
      ***/COPY*Statement***********************************************   CFT014
      ***********                                                         CFT014
     C***/COPY*WNCPYSRC,FT0348DETC                                        CFT014
      ************                                                        CFT014
      ***Details*of*Charges*optional, Defaults*to*BEN******************   CFT014
      ***********                                                         CFT014
     C***********S6DETC    IFEQ *BLANKS                                   CFT014
     C***********          MOVE 'BEN'     S6DETC                          CFT014
     C***/COPY*WNCPYSRC,FT0348C009*************************************   CFT014
     C***********          ELSE                                           CFT014
      ***********                                                         CFT014
      ****Valid*entries*are*'OUR'*or*'BEN'*****************************   CFT014
      ***********                                                         CFT014
     C***********S6DETC    IFNE 'OUR'                                     CFT014
     C***********S6DETC    ANDNE'BEN'                                     CFT014
     C***/COPY*WNCPYSRC,FT0348C010                                        CFT014
     C***********          MOVEL'Y'       E#MSGS                          CFT014
     C***********          MOVELS6DETC    FTMSDT                          CFT014
     C***********          MOVELE#CPGM    FTPGMQ                          CFT014
     C***********          MOVEL'FTM2193' FTMSID                          CFT014
     C***********          EXSR FTSNMS                                    CFT014
     C***********          MOVEL'Y'       I6DETC                          CFT014
     C***********          MOVEL'Y'       E#NOUP                          CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
      ***Unwind*subroutine*stack*name**********************************   CFT014
      ***********                                                         CFT014
     C***********EXDETC    TAG                                            CFT014
     C***********          MOVEA*BLANKS   @STK,Q                          CFT014
     C***********          SUB  1         Q                               CFT014
      ***********                                                         CFT014
     C***SR******             ENDSR                                       CFT014
     C***/EJECT**                                                         CFT014
     C***/EJECT**                                                         CFT014
      *                                                                   CFT014
      ** This subroutine has been moved to FT0349 (3rd screen val.)       CFT014
      *                                                                   CFT014
      *****************************************************************   CFT014
      *****************************************************************   CFT014
      ***SRCCCY***:*Get*Currency*information*for*Charge*amount*val'n***   CFT014
      *****************************************************************   CFT014
      ***CALLED*BY:*SRPROC*-*Control*Process*of*Validation*************   CFT014
      *****************************************************************   CFT014
      ***CALLS****:********-*******************************************   CFT014
      *****************************************************************   CFT014
      *****************************************************************   CFT014
     C***SR*****    SRCCCY    BEGSR                                       CFT014
      ***********                                                         CFT014
      ***Set*up*subroutine*stack*name**********************************   CFT014
      ***********                                                         CFT014
     C***********          ADD  1         Q       50                      CFT014
     C***********          MOVEL'SRCCCY'  @STK,Q                          CFT014
      ***********                                                         CFT014
      ***/COPY*Statement***********************************************   CFT014
      ***********                                                         CFT014
     C***/COPY*WNCPYSRC,FT0348CCCY                                        CFT014
      ***********                                                         CFT014
      ***Access*currency*record****************************************   CFT014
      ***********                                                         CFT014
     C***********          CALL 'AOCURRR0'             9090               CFT014
     C***********          PARM           @RTCD   7                       CFT014
     C***********          PARM '*KEY   ' @OPTN   7                       CFT014
     C***********          PARM V#CCCY    @CCY    3                       CFT014
     C***********SDCURR    PARM *BLANKS   DSSDY                           CFT014
      ***********                                                         CFT014
      **Option*ended*in*error******************************************   CFT014
      ***********                                                         CFT014
     C************IN90     IFEQ '1'                        *IF            CFT014
     C***********@RTCD     ORNE *BLANKS                    *IF            CFT014
     C***********          MOVEL'AOCURRR0'W0FILE           ***************CFT014
     C***********          MOVEL'*CALL'   W0KEY            * DB ERROR 01 *CFT014
     C***********          Z-ADD1         W0ERNB           ***************CFT014
     C***********          MOVEL'MEM5003' W0MSGD                          CFT014
     C***********          MOVEL'MIDAS  ' W0MSGF                          CFT014
     C***********          EXSR SRERR                                     CFT014
     C***********          END                             *FI            CFT014
      ***********                                                         CFT014
      ***Unwind*subroutine*stack*name**********************************   CFT014
      ***********                                                         CFT014
     C***********EXCCCY    TAG                                            CFT014
     C***********          MOVEA*BLANKS   @STK,Q                          CFT014
     C***********          SUB  1         Q                               CFT014
      ***********                                                         CFT014
     C***SR******             ENDSR                                       CFT014
     C***/EJECT**                                                         CFT014
      *                                                                   CFT014
      ** This subroutine has been moved to FT0349 (3rd screen val.)       CFT014
      *                                                                   CFT014
      *****************************************************************   CFT014
      *****************************************************************   CFT014
      ***SRTRCM***:*Validate*Transfer*Commission*Charge****************   CFT014
      *****************************************************************   CFT014
      ***CALLED*BY:*SRPROC*-*Control*Process*of*Validation*************   CFT014
      *****************************************************************   CFT014
      ***CALLS****:********-*******************************************   CFT014
      *****************************************************************   CFT014
      *****************************************************************   CFT014
     C***SR******   SRTRCM    BEGSR                                       CFT014
      ***********                                                         CFT014
      ***Set*up*subroutine*stack*name**********************************   CFT014
      ***********                                                         CFT014
     C***********          ADD  1         Q       50                      CFT014
     C***********          MOVEL'SRTRCM'  @STK,Q                          CFT014
      ***********                                                         CFT014
      ***/COPY*Statement***********************************************   CFT014
      ***********                                                         CFT014
     C***/COPY*WNCPYSRC,FT0348TRCM                                        CFT014
      *****************************************************************   CFT014
      ***Transfer*Commission*Charge************************************   CFT014
      ***--------------------------************************************   CFT014
      ***Transfer*Commission*is*optional.******************************   CFT014
      ***If*entered*must*be*valid*for*charge*currency*details**********   CFT014
      ***********                                                         CFT014
     C***********          Z-ADD0         F6TRCD                          CFT014
     C***********          Z-ADD0         F6TRCM                          CFT014
      ***********                                                         CFT014
     C***********S6TRCD    IFNE *BLANKS                                   CFT014
      ***********                                                         CFT014
     C***********11        SUB  A6NBDP    ZADIG                           CFT014
     C***********          Z-ADDA6NBDP    ZADEC                           CFT014
     C***********          MOVEL*BLANKS   ZFIELD                          CFT014
     C***********          MOVELS6TRCD    ZFIELD                          CFT014
      ***********                                                         CFT014
     C***********          EXSR SRALGN                                    CFT014
      ***********                                                         CFT014
     C***********ZRTN      IFEQ '*ERROR*'                                 CFT014
     C***********          MOVEL'Y'       E#MSGS                          CFT014
     C***********V#CCCY    CAT  S6TRCD    FTMSDT    P                     CFT014
     C***********          MOVELE#CPGM    FTPGMQ                          CFT014
     C***********          MOVEL'FTM2194' FTMSID                          CFT014
     C***********          EXSR FTSNMS                                    CFT014
     C***********          MOVEL'Y'       I6TRCM                          CFT014
     C***********          MOVEL'Y'       E#NOUP                          CFT014
     C***********          ELSE                                           CFT014
     C***********          MOVE ZFIELD    F6TRCD                          CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
      ***Unwind*subroutine*stack*name**********************************   CFT014
      ***********                                                         CFT014
     C***********EXTRCM    TAG                                            CFT014
     C***********          MOVEA*BLANKS   @STK,Q                          CFT014
     C***********          SUB  1         Q                               CFT014
      ***********                                                         CFT014
     C***SR******             ENDSR                                       CFT014
     C***/EJECT**                                                         CFT014
      *                                                                   CFT014
      ** This subroutine has been moved to FT0349 (3rd screen val.)       CFT014
      *                                                                   CFT014
      *****************************************************************   CFT014
      *****************************************************************   CFT014
      ***SRTXCH***:*Validate*Telex*Charges*****************************   CFT014
      *****************************************************************   CFT014
      ***CALLED*BY:*SRPROC*-*Control*Process*of*Validation*************   CFT014
      *****************************************************************   CFT014
      ***CALLS****:********-*******************************************   CFT014
      *****************************************************************   CFT014
      *****************************************************************   CFT014
     C***SR******   SRTXCH    BEGSR                                       CFT014
      ***********                                                         CFT014
      ***Set*up*subroutine*stack*name**********************************   CFT014
      ***********                                                         CFT014
     C***********          ADD  1         Q       50                      CFT014
     C***********          MOVEL'SRTXCH'  @STK,Q                          CFT014
      ***********                                                         CFT014
      ***/COPY*Statement***********************************************   CFT014
      ***********                                                         CFT014
     C***/COPY*WNCPYSRC,FT0348TXCH                                        CFT014
      ***********                                                         CFT014
      ***Telex*Charge*is*mandatory,*on*insert*only,*if*settlement******   CFT014
      ***type*is*'01'**************************************************   CFT014
     C***********          Z-ADD0         F6TXCD                          CFT014
     C***********          Z-ADD0         F6TXCH                          CFT014
      ***********                                                         CFT014
     C***********V#STMT    IFEQ '01'                                      CFT014
     C***********S6TXCD    ANDEQ*BLANKS                                   CFT014
     C***********S6ACTD    ANDEQ'I'                                       CFT014
     C***********          MOVEL'Y'       E#MSGS                          CFT014
     C***********V#CCCY    CAT  S6TXCD    FTMSDT    P                     CFT014
     C***********          MOVELE#CPGM    FTPGMQ                          CFT014
     C***********          MOVEL'FTM2196' FTMSID                          CFT014
     C***********          EXSR FTSNMS                                    CFT014
     C***********          MOVEL'Y'       I6TXCH                          CFT014
     C***********          MOVEL'Y'       E#NOUP                          CFT014
     C***********          GOTO EXTXCH                                    CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
     C***********S6TXCD    IFNE *BLANKS                                   CFT014
      ***********                                                         CFT014
     C***********11        SUB  A6NBDP    ZADIG                           CFT014
     C***********          Z-ADDA6NBDP    ZADEC                           CFT014
     C***********          MOVEL*BLANKS   ZFIELD                          CFT014
     C***********          MOVELS6TXCD    ZFIELD                          CFT014
     C***********          EXSR SRALGN                                    CFT014
      ***********                                                         CFT014
     C***********ZRTN      IFEQ '*ERROR*'                                 CFT014
     C***********          MOVEL'Y'       E#MSGS                          CFT014
     C***********V#CCCY    CAT  S6TXCD    FTMSDT    P                     CFT014
     C***********          MOVELE#CPGM    FTPGMQ                          CFT014
     C***********          MOVEL'FTM2195' FTMSID                          CFT014
     C***********          EXSR FTSNMS                                    CFT014
     C***********          MOVEL'Y'       I6TXCH                          CFT014
     C***********          MOVEL'Y'       E#NOUP                          CFT014
     C***********          ELSE                                           CFT014
     C***********          MOVE ZFIELD    F6TXCD                          CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
      ***Unwind*subroutine*stack*name**********************************   CFT014
      ***********                                                         CFT014
     C***********EXTXCH    TAG                                            CFT014
     C***********          MOVEA*BLANKS   @STK,Q                          CFT014
     C***********          SUB  1         Q                               CFT014
      ***********                                                         CFT014
     C***SR******             ENDSR                                       CFT014
     C***/EJECT**                                                         CFT014
      *                                                                   CFT014
      ** This subroutine has been moved to FT0349 (3rd screen val.)       CFT014
      *                                                                   CFT014
      *****************************************************************   CFT014
      *****************************************************************   CFT014
      ***SRCQCH***:*Validate*Cheque*Charges****************************   CFT014
      *****************************************************************   CFT014
      ***CALLED*BY:*SRPROC*-*Control*Process*of*Validation*************   CFT014
      *****************************************************************   CFT014
      ***CALLS****:********-*******************************************   CFT014
      *****************************************************************   CFT014
      *****************************************************************   CFT014
     C***SR*****    SRCQCH    BEGSR                                       CFT014
      ***********                                                         CFT014
      ***Set*up*subroutine*stack*name**********************************   CFT014
      ***********                                                         CFT014
     C***********          ADD  1         Q       50                      CFT014
     C***********          MOVEL'SRCQCH'  @STK,Q                          CFT014
      ***********                                                         CFT014
      ***/COPY*Statement***********************************************   CFT014
      ***********                                                         CFT014
     C***/COPY*WNCPYSRC,FT0348CQCH                                        CFT014
      ***********                                                         CFT014
      ***Cheque*Charge*is*optional.************************************   CFT014
      ***If*entered*must*be*valid*for*charge*currency*details**********   CFT014
      ***********                                                         CFT014
     C***********          Z-ADD0         F6CQCD                          CFT014
     C***********          Z-ADD0         F6CQCH                          CFT014
      ***********                                                         CFT014
     C***********S6CQCD    IFNE *BLANKS                                   CFT014
      ***********                                                         CFT014
     C***********11        SUB  A6NBDP    ZADIG                           CFT014
     C***********          Z-ADDA6NBDP    ZADEC                           CFT014
     C***********          MOVEL*BLANKS   ZFIELD                          CFT014
     C***********          MOVELS6CQCD    ZFIELD                          CFT014
     C***********          EXSR SRALGN                                    CFT014
      ***********                                                         CFT014
     C***********ZRTN      IFEQ '*ERROR*'                                 CFT014
     C***********          MOVEL'Y'       E#MSGS                          CFT014
     C***********V#CCCY    CAT  S6CQCD    FTMSDT    P                     CFT014
     C***********          MOVELE#CPGM    FTPGMQ                          CFT014
     C***********          MOVEL'FTM2197' FTMSID                          CFT014
     C***********          EXSR FTSNMS                                    CFT014
     C***********          MOVEL'Y'       I6CQCH                          CFT014
     C***********          MOVEL'Y'       E#NOUP                          CFT014
     C***********          ELSE                                           CFT014
     C***********          MOVE ZFIELD    F6CQCD                          CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
      ***Unwind*subroutine*stack*name**********************************   CFT014
      ***********                                                         CFT014
     C***********EXCQCH    TAG                                            CFT014
     C***********          MOVEA*BLANKS   @STK,Q                          CFT014
     C***********          SUB  1         Q                               CFT014
      ***********                                                         CFT014
     C***SR******             ENDSR                                       CFT014
     C***/EJECT**                                                         CFT014
      *                                                                   CFT014
      ** This subroutine has been moved to FT0349 (3rd screen val.)       CFT014
      *                                                                   CFT014
      *****************************************************************   CFT014
      *****************************************************************   CFT014
      ***SRCSTH***:*Validate*Costs*Abroad******************************   CFT014
      *****************************************************************   CFT014
      ***CALLED*BY:*SRPROC*-*Control*Process*of*Validation*************   CFT014
      *****************************************************************   CFT014
      ***CALLS****:********-*******************************************   CFT014
      *****************************************************************   CFT014
      *****************************************************************   CFT014
     C***SR*****    SRCSTH    BEGSR                                       CFT014
      ***********                                                         CFT014
      ***Set*up*subroutine*stack*name**********************************   CFT014
      ***********                                                         CFT014
     C***********          ADD  1         Q       50                      CFT014
     C***********          MOVEL'SRCSTH'  @STK,Q                          CFT014
      ***********                                                         CFT014
      ***/COPY*Statement***********************************************   CFT014
      ***********                                                         CFT014
     C***/COPY*WNCPYSRC,FT0348CSTH                                        CFT014
      ***********                                                         CFT014
      ***Costs*Abroad*is*optional.*************************************   CFT014
      ***If*entered*must*be*valid*for*charge*currency*details**********   CFT014
      ***********                                                         CFT014
     C***********          Z-ADD0         F6CSTD                          CFT014
     C***********          Z-ADD0         F6CSTA                          CFT014
      ***********                                                         CFT014
     C***********S6CSTD    IFNE *BLANKS                                   CFT014
      ***********                                                         CFT014
     C***********11        SUB  A6NBDP    ZADIG                           CFT014
     C***********          Z-ADDA6NBDP    ZADEC                           CFT014
     C***********          MOVEL*BLANKS   ZFIELD                          CFT014
     C***********          MOVELS6CSTD    ZFIELD                          CFT014
     C***********          EXSR SRALGN                                    CFT014
      ***********                                                         CFT014
     C***********ZRTN      IFEQ '*ERROR*'                                 CFT014
     C***********          MOVEL'Y'       E#MSGS                          CFT014
     C***********V#CCCY    CAT  S6CSTD    FTMSDT    P                     CFT014
     C***********          MOVELE#CPGM    FTPGMQ                          CFT014
     C***********          MOVEL'FTM2198' FTMSID                          CFT014
     C***********          EXSR FTSNMS                                    CFT014
     C***********          MOVEL'Y'       I6CSTH                          CFT014
     C***********          MOVEL'Y'       E#NOUP                          CFT014
     C***********          ELSE                                           CFT014
     C***********          MOVE ZFIELD    F6CSTD                          CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
      ***Unwind*subroutine*stack*name**********************************   CFT014
      ***********                                                         CFT014
     C***********EXCSTH    TAG                                            CFT014
     C***********          MOVEA*BLANKS   @STK,Q                          CFT014
     C***********          SUB  1         Q                               CFT014
      ***********                                                         CFT014
     C***SR******             ENDSR                                       CFT014
     C***/EJECT**                                                         CFT014
      *                                                                   CFT014
      ** This subroutine has been moved to FT0349 (3rd screen val.)       CFT014
      *                                                                   CFT014
      *****************************************************************   CFT014
      *****************************************************************   CFT014
      ***SRSPCH***:*Validate*SWIFT*Priority*Charge*********************   CFT014
      *****************************************************************   CFT014
      ***CALLED*BY:*SRPROC*-*Control*Process*of*Validation*************   CFT014
      *****************************************************************   CFT014
      ***CALLS****:********-*******************************************   CFT014
      *****************************************************************   CFT014
      *****************************************************************   CFT014
     C***SR*****    SRSPCH    BEGSR                                       CFT014
      ***********                                                         CFT014
      ***Set*up*subroutine*stack*name**********************************   CFT014
      ***********                                                         CFT014
     C***********          ADD  1         Q       50                      CFT014
     C***********          MOVEL'SRSPCH'  @STK,Q                          CFT014
      ***********                                                         CFT014
      ***/COPY*Statement***********************************************   CFT014
      ***********                                                         CFT014
     C***/COPY*WNCPYSRC,FT0348SPCH                                        CFT014
      ***********                                                         CFT014
      ***SWIFT*Priority*charge*is*optional.****************************   CFT014
      ***If*entered*must*be*valid*for*charge*currency*details**********   CFT014
      ***********                                                         CFT014
     C***********          Z-ADD0         F6SPCD                          CFT014
     C***********          Z-ADD0         F6SPCH                          CFT014
      ***********                                                         CFT014
     C***********S6SPCD    IFNE *BLANKS                                   CFT014
      ***********                                                         CFT014
     C***********11        SUB  A6NBDP    ZADIG                           CFT014
     C***********          Z-ADDA6NBDP    ZADEC                           CFT014
     C***********          MOVEL*BLANKS   ZFIELD                          CFT014
     C***********          MOVELS6SPCD    ZFIELD                          CFT014
     C***********          EXSR SRALGN                                    CFT014
      ***********                                                         CFT014
     C***********ZRTN      IFEQ '*ERROR*'                                 CFT014
     C***********          MOVEL'Y'       E#MSGS                          CFT014
     C***********V#CCCY    CAT  S6SPCD    FTMSDT    P                     CFT014
     C***********          MOVELE#CPGM    FTPGMQ                          CFT014
     C***********          MOVEL'FTM2199' FTMSID                          CFT014
     C***********          EXSR FTSNMS                                    CFT014
     C***********          MOVEL'Y'       I6SPCH                          CFT014
     C***********          MOVEL'Y'       E#NOUP                          CFT014
     C***********          ELSE                                           CFT014
     C***********          MOVE ZFIELD    F6SPCD                          CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
      ***Unwind*subroutine*stack*name**********************************   CFT014
      ***********                                                         CFT014
     C***********EXSPCH    TAG                                            CFT014
     C***********          MOVEA*BLANKS   @STK,Q                          CFT014
     C***********          SUB  1         Q                               CFT014
      ***********                                                         CFT014
     C***SR******             ENDSR                                       CFT014
     C***/EJECT**                                                         CFT014
      *****************************************************************   CFT014
      *****************************************************************   CFT014
      ***SRMSCH***:*Validate*Miscellaneous*Charges*********************   CFT014
      *****************************************************************   CFT014
      ***CALLED*BY:*SRPROC*-*Control*Process*of*Validation*************   CFT014
      *****************************************************************   CFT014
      ***CALLS****:********-*******************************************   CFT014
      *****************************************************************   CFT014
      *****************************************************************   CFT014
     C***SR******   SRMSCH    BEGSR                                       CFT014
      ***********                                                         CFT014
      ***Set*up*subroutine*stack*name**********************************   CFT014
      ***********                                                         CFT014
     C***********          ADD  1         Q       50                      CFT014
     C***********          MOVEL'SRMSCH'  @STK,Q                          CFT014
      ***********                                                         CFT014
      ***/COPY*Statement***********************************************   CFT014
      ***********                                                         CFT014
     C***/COPY*WNCPYSRC,FT0348MSCH                                        CFT014
      ***********                                                         CFT014
      ***Miscellaneous*Charge*is*optional.*****************************   CFT014
      ***If*entered*must*be*valid*for*charge*currency*details**********   CFT014
      ***********                                                         CFT014
     C***********          Z-ADD0         F6MSCD                          CFT014
     C***********          Z-ADD0         F6MSCH                          CFT014
      ***********                                                         CFT014
     C***********S6MSCD    IFNE *BLANKS                                   CFT014
      ***********                                                         CFT014
     C***********11        SUB  A6NBDP    ZADIG                           CFT014
     C***********          Z-ADDA6NBDP    ZADEC                           CFT014
     C***********          MOVEL*BLANKS   ZFIELD                          CFT014
     C***********          MOVELS6MSCD    ZFIELD                          CFT014
     C***********          EXSR SRALGN                                    CFT014
      ***********                                                         CFT014
     C***********ZRTN      IFEQ '*ERROR*'                                 CFT014
     C***********          MOVEL'Y'       E#MSGS                          CFT014
     C***********V#CCCY    CAT  S6MSCD    FTMSDT    P                     CFT014
     C***********          MOVELE#CPGM    FTPGMQ                          CFT014
     C***********          MOVEL'FTM2200' FTMSID                          CFT014
     C***********          EXSR FTSNMS                                    CFT014
     C***********          MOVEL'Y'       I6MSCH                          CFT014
     C***********          MOVEL'Y'       E#NOUP                          CFT014
     C***********          ELSE                                           CFT014
     C***********          MOVE ZFIELD    F6MSCD                          CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
      ***Unwind*subroutine*stack*name**********************************   CFT014
      ***********                                                         CFT014
     C***********EXMSCH    TAG                                            CFT014
     C***********          MOVEA*BLANKS   @STK,Q                          CFT014
     C***********          SUB  1         Q                               CFT014
      ***********                                                         CFT014
     C***SR******             ENDSR                                       CFT014
     C***/EJECT**                                                  S01494 CFT014
      *                                                                   CFT014
      ** This subroutine has been moved to FT0349 (3rd screen val.)       CFT014
      *                                                                   CFT014
     C*************************************************************S01494 CFT014
     C*************************************************************S01494 CFT014
     C***SRCHCM***:*Validate*FX/Change*Commission******************S01494 CFT014
     C*************************************************************S01494 CFT014
     C***CALLED*BY:*SRPROC*-*Control*Process*of*Validation*********S01494 CFT014
     C*************************************************************S01494 CFT014
     C***CALLS****:********-***************************************S01494 CFT014
     C*************************************************************S01494 CFT014
     C*************************************************************S01494 CFT014
     C***SR******   SRCHCM    BEGSR                                S01494 CFT014
     C***********                                                  S01494 CFT014
     C***Set*up*subroutine*stack*name******************************S01494 CFT014
     C***********                                                  S01494 CFT014
     C***********          ADD  1         Q       50               S01494 CFT014
     C***********          MOVEL'SRCHCM'  @STK,Q                   S01494 CFT014
     C***********                                                  S01494 CFT014
     C***FX/Change*commission*only*allowed*if*Pay*and*Settle*currenS01494 CFT014
     C***are*different.**If*entered*must*be*valid*for*charge*currenS01494 CFT014
     C***details.**************************************************S01494 CFT014
     C***********                                                  S01494 CFT014
     C***********          Z-ADD0         F6CHCD                   S01494 CFT014
     C***********          Z-ADD0         F6CHCM                   S01494 CFT014
     C***********                                                  S01494 CFT014
      **If*EMU*FT*Enhancement*is*switched*on*then******************CEU006 CFT014
      **save*work*date*parameter*for*call*to*FT0010*as*W#DT********CEU006 CFT014
      ***********                                                  CEU006 CFT014
     C***********CEU006    IFEQ 'Y'                                CEU006 CFT014
     C************LIKE     DEFN V#SLDT    W#DT                     CEU006 CFT014
     C***********V#ADDC    IFEQ 'A'                                CEU006 CFT014
     C***********          Z-ADDV#SLDT    W#DT                     CEU006 CFT014
     C***********          ELSE                                    CEU006 CFT014
     C***********          Z-ADDV#PVDT    W#DT                     CEU006 CFT014
     C***********          ENDIF                                   CEU006 CFT014
     C***********          ENDIF                                   CEU006 CFT014
      ***********                                                  CEU006 CFT014
     C***********S6CHCD    IFNE *BLANKS                            S01494 CFT014
     C***********                                                  S01494 CFT014
     C***********V#SMCY    IFNE V#PCCY                             S01494 CFT014
     C***********                                                  CEU006 CFT014
     C**If*EMU*FT**Enhancement*is*switched*on**********************CEU006 CFT014
     C***and*both*Settle*Ccy*and*Pay*Ccy*are*either*'In'*or*Euros,*CEU006 CFT014
     C***then*FX/Change*Commission*must*be*zero.*******************CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C***********CEU006    IFEQ 'Y'                                CEU006 CFT014
     C***********#INCYS    ANDEQ'Y'                                CEU006 CFT014
     C***********#TPSDS    ANDLEW#DT                               CEU006 CFT014
     C***********V#PCCY    ANDEQBKEURO                             CEU006 CFT014
     C***********CEU006    OREQ 'Y'                                CEU006 CFT014
     C***********#INCYP    ANDEQ'Y'                                CEU006 CFT014
     C***********#TPSDP    ANDLEW#DT                               CEU006 CFT014
     C***********V#SMCY    ANDEQBKEURO                             CEU006 CFT014
     C***********CEU006    OREQ 'Y'                                CEU006 CFT014
     C***********#INCYS    ANDEQ'Y'                                CEU006 CFT014
     C***********#TPSDS    ANDLEW#DT                               CEU006 CFT014
     C***********#INCYP    ANDEQ'Y'                                CEU006 CFT014
     C***********#TPSDP    ANDLEW#DT                               CEU006 CFT014
     C***********          MOVEL'Y'       E#MSGS                   CEU006 CFT014
     C***********          MOVEL*BLANKS   FTMSDT                   CEU006 CFT014
     C***********          MOVELE#CPGM    FTPGMQ                   CEU006 CFT014
     C***********          MOVEL'FTM2599' FTMSID                   CEU006 CFT014
     C***********          EXSR FTSNMS                             CEU006 CFT014
     C***********          MOVEL'Y'       I6CHCM                   CEU006 CFT014
     C***********          MOVEL'Y'       E#NOUP                   CEU006 CFT014
     C***********          ELSE                                    CEU006 CFT014
     C***********                                                  S01494 CFT014
     C***********11        SUB  A6NBDP    ZADIG                    S01494 CFT014
     C***********          Z-ADDA6NBDP    ZADEC                    S01494 CFT014
     C***********          MOVEL*BLANKS   ZFIELD                   S01494 CFT014
     C***********          MOVELS6CHCD    ZFIELD                   S01494 CFT014
     C***********          EXSR SRALGN                             S01494 CFT014
     C***********                                                  S01494 CFT014
     C***********ZRTN      IFEQ '*ERROR*'                          S01494 CFT014
     C***********          MOVEL'Y'       E#MSGS                   S01494 CFT014
     C***********V#CCCY    CAT  S6CHCD    FTMSDT    P              S01494 CFT014
     C***********          MOVELE#CPGM    FTPGMQ                   S01494 CFT014
     C***********          MOVEL'FTM2520' FTMSID                   S01494 CFT014
     C***********          EXSR FTSNMS                             S01494 CFT014
     C***********          MOVEL'Y'       I6CHCM                   S01494 CFT014
     C***********          MOVEL'Y'       E#NOUP                   S01494 CFT014
     C***********          ELSE                                    S01494 CFT014
     C***********          MOVE ZFIELD    F6CHCD                   S01494 CFT014
     C***********          END                                     S01494 CFT014
     C***********                                                  CEU006 CFT014
     C***********          ENDIF                                   CEU006 CFT014
     C***********                                                  S01494 CFT014
     C***********          ELSE                                    S01494 CFT014
     C***********          MOVEL'Y'       E#MSGS                   S01494 CFT014
     C***********          MOVEL*BLANKS   FTMSDT                   S01494 CFT014
     C***********          MOVELE#CPGM    FTPGMQ                   S01494 CFT014
     C***********          MOVEL'FTM2521' FTMSID                   S01494 CFT014
     C***********          EXSR FTSNMS                             S01494 CFT014
     C***********          MOVEL'Y'       I6CHCM                   S01494 CFT014
     C***********          MOVEL'Y'       E#NOUP                   S01494 CFT014
     C***********          END                                     S01494 CFT014
     C***********                                                  S01494 CFT014
     C***********          END                                     S01494 CFT014
     C***********                                                  S01494 CFT014
     C***Unwind*subroutine*stack*name******************************S01494 CFT014
     C***********                                                  S01494 CFT014
     C***********EXCHCM    TAG                                     S01494 CFT014
     C***********          MOVEA*BLANKS   @STK,Q                   S01494 CFT014
     C***********          SUB  1         Q                        S01494 CFT014
     C***********                                                  S01494 CFT014
     C***SR******             ENDSR                                S01494 CFT014
     C***/EJECT**                                                  S01499 CFT014
      *                                                                   CFT014
      ** This subroutine has been moved to FT0349 (3rd screen val.)       CFT014
      *                                                                   CFT014
     C*************************************************************S01499 CFT014
     C*************************************************************S01499 CFT014
     C***SRVATT***:*Validate*V.A.T.*flags**************************S01499 CFT014
     C*************************************************************S01499 CFT014
     C***CALLED*BY:*SRPROC*-*Control*Process*of*Validation*********S01499 CFT014
     C*************************************************************S01499 CFT014
     C***CALLS****:********-***************************************S01499 CFT014
     C*************************************************************S01499 CFT014
     C*************************************************************S01499 CFT014
     C***SR******   SRVATT    BEGSR                                S01499 CFT014
     C***********                                                  S01499 CFT014
     C***Set*up*subroutine*stack*name******************************S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********          ADD  1         Q       50               S01499 CFT014
     C***********          MOVEL'SRVATT'  @STK,Q                   S01499 CFT014
     C***********                                                  S01499 CFT014
     C***Apply*V.A.T.*flag*must*be*'Y'*or*'N'*or*blank.**If*blank,*S01499 CFT014
     C***default*to*value*retrieved*from*program*FT0005.***********S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********          MOVEL*BLANKS   @VCHG  20                S01499 CFT014
     C***********          MOVE @VAT,1    @VCHG                    S01499 S01499
     C***********          MOVE WVAT1     @VCHG                    S01499 CFT014
     C***********S6VAT1    IFEQ *BLANKS                            S01499 CFT014
     C***********          MOVELV#VATT    S6VAT1                   S01499 CFT014
     C***********          ELSE                                    S01499 CFT014
     C***********S6VAT1    IFNE 'Y'                                S01499 CFT014
     C***********S6VAT1    ANDNE'N'                                S01499 CFT014
     C***********          MOVEL'Y'       E#MSGS                   S01499 CFT014
     C***********S6VAT1    CAT  @VCHG     FTMSDT                   S01499 CFT014
     C***********          MOVELE#CPGM    FTPGMQ                   S01499 CFT014
     C***********          MOVEL'FTM2524' FTMSID                   S01499 CFT014
     C***********          EXSR FTSNMS                             S01499 CFT014
     C***********          MOVEL'Y'       I6VAT1                   S01499 CFT014
     C***********          MOVEL'Y'       E#NOUP                   S01499 CFT014
     C***********          END                                     S01499 CFT014
     C***********          END                                     S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********          MOVEL*BLANKS   @VCHG  20                S01499 CFT014
     C***********          MOVE @VAT,2    @VCHG                    S01499 S01499
     C***********          MOVE WVAT2     @VCHG                    S01499 CFT014
     C***********S6VAT2    IFEQ *BLANKS                            S01499 CFT014
     C***********          MOVELV#VATT    S6VAT2                   S01499 CFT014
     C***********          ELSE                                    S01499 CFT014
     C***********S6VAT2    IFNE 'Y'                                S01499 CFT014
     C***********S6VAT2    ANDNE'N'                                S01499 CFT014
     C***********          MOVEL'Y'       E#MSGS                   S01499 CFT014
     C***********S6VAT2    CAT  @VCHG     FTMSDT                   S01499 CFT014
     C***********          MOVELE#CPGM    FTPGMQ                   S01499 CFT014
     C***********          MOVEL'FTM2524' FTMSID                   S01499 CFT014
     C***********          EXSR FTSNMS                             S01499 CFT014
     C***********          MOVEL'Y'       I6VAT2                   S01499 CFT014
     C***********          MOVEL'Y'       E#NOUP                   S01499 CFT014
     C***********          END                                     S01499 CFT014
     C***********          END                                     S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********          MOVEL*BLANKS   @VCHG  20                S01499 CFT014
     C***********          MOVE @VAT,3    @VCHG                    S01499 S01499
     C***********          MOVE WVAT3     @VCHG                    S01499 CFT014
     C***********S6VAT3    IFEQ *BLANKS                            S01499 CFT014
     C***********          MOVELV#VATT    S6VAT3                   S01499 CFT014
     C***********          ELSE                                    S01499 CFT014
     C***********S6VAT3    IFNE 'Y'                                S01499 CFT014
     C***********S6VAT3    ANDNE'N'                                S01499 CFT014
     C***********          MOVEL'Y'       E#MSGS                   S01499 CFT014
     C***********S6VAT3    CAT  @VCHG     FTMSDT                   S01499 CFT014
     C***********          MOVELE#CPGM    FTPGMQ                   S01499 CFT014
     C***********          MOVEL'FTM2524' FTMSID                   S01499 CFT014
     C***********          EXSR FTSNMS                             S01499 CFT014
     C***********          MOVEL'Y'       I6VAT3                   S01499 CFT014
     C***********          MOVEL'Y'       E#NOUP                   S01499 CFT014
     C***********          END                                     S01499 CFT014
     C***********          END                                     S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********          MOVEL*BLANKS   @VCHG  20                S01499 CFT014
     C***********          MOVE @VAT,4    @VCHG                    S01499 S01499
     C***********          MOVE WVAT4     @VCHG                    S01499 CFT014
     C***********S6VAT4    IFEQ *BLANKS                            S01499 CFT014
     C***********          MOVELV#VATT    S6VAT4                   S01499 CFT014
     C***********          ELSE                                    S01499 CFT014
     C***********S6VAT4    IFNE 'Y'                                S01499 CFT014
     C***********S6VAT4    ANDNE'N'                                S01499 CFT014
     C***********          MOVEL'Y'       E#MSGS                   S01499 CFT014
     C***********S6VAT4    CAT  @VCHG     FTMSDT                   S01499 CFT014
     C***********          MOVELE#CPGM    FTPGMQ                   S01499 CFT014
     C***********          MOVEL'FTM2524' FTMSID                   S01499 CFT014
     C***********          EXSR FTSNMS                             S01499 CFT014
     C***********          MOVEL'Y'       I6VAT4                   S01499 CFT014
     C***********          MOVEL'Y'       E#NOUP                   S01499 CFT014
     C***********          END                                     S01499 CFT014
     C***********          END                                     S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********          MOVEL*BLANKS   @VCHG  20                S01499 CFT014
     C***********          MOVE @VAT,5    @VCHG                    S01499 S01499
     C***********          MOVE WVAT5     @VCHG                    S01499 CFT014
     C***********S6VAT5    IFEQ *BLANKS                            S01499 CFT014
     C***********          MOVELV#VATT    S6VAT5                   S01499 CFT014
     C***********          ELSE                                    S01499 CFT014
     C***********S6VAT5    IFNE 'Y'                                S01499 CFT014
     C***********S6VAT5    ANDNE'N'                                S01499 CFT014
     C***********          MOVEL'Y'       E#MSGS                   S01499 CFT014
     C***********S6VAT5    CAT  @VCHG     FTMSDT                   S01499 CFT014
     C***********          MOVELE#CPGM    FTPGMQ                   S01499 CFT014
     C***********          MOVEL'FTM2524' FTMSID                   S01499 CFT014
     C***********          EXSR FTSNMS                             S01499 CFT014
     C***********          MOVEL'Y'       I6VAT5                   S01499 CFT014
     C***********          MOVEL'Y'       E#NOUP                   S01499 CFT014
     C***********          END                                     S01499 CFT014
     C***********          END                                     S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********          MOVEL*BLANKS   @VCHG  20                S01499 CFT014
     C***********          MOVE @VAT,6    @VCHG                    S01499 S01499
     C***********          MOVE WVAT6     @VCHG                    S01499 CFT014
     C***********S6VAT6    IFEQ *BLANKS                            S01499 CFT014
     C***********          MOVELV#VATT    S6VAT6                   S01499 CFT014
     C***********          ELSE                                    S01499 CFT014
     C***********S6VAT6    IFNE 'Y'                                S01499 CFT014
     C***********S6VAT6    ANDNE'N'                                S01499 CFT014
     C***********          MOVEL'Y'       E#MSGS                   S01499 CFT014
     C***********S6VAT6    CAT  @VCHG     FTMSDT                   S01499 CFT014
     C***********          MOVELE#CPGM    FTPGMQ                   S01499 CFT014
     C***********          MOVEL'FTM2524' FTMSID                   S01499 CFT014
     C***********          EXSR FTSNMS                             S01499 CFT014
     C***********          MOVEL'Y'       I6VAT6                   S01499 CFT014
     C***********          MOVEL'Y'       E#NOUP                   S01499 CFT014
     C***********          END                                     S01499 CFT014
     C***********          END                                     S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********          MOVEL*BLANKS   @VCHG  20                S01499 CFT014
     C***********          MOVE @VAT,7    @VCHG                    S01499 S01499
     C***********          MOVE WVAT7     @VCHG                    S01494 CFT014
     C***********S6VAT7    IFEQ *BLANKS                            S01499 CFT014
     C***********          MOVELV#VATT    S6VAT7                   S01499 CFT014
     C***********          ELSE                                    S01499 CFT014
     C***********S6VAT7    IFNE 'Y'                                S01499 CFT014
     C***********S6VAT7    ANDNE'N'                                S01499 CFT014
     C***********          MOVEL'Y'       E#MSGS                   S01499 CFT014
     C***********S6VAT7    CAT  @VCHG     FTMSDT                   S01499 CFT014
     C***********          MOVELE#CPGM    FTPGMQ                   S01499 CFT014
     C***********          MOVEL'FTM2524' FTMSID                   S01499 CFT014
     C***********          EXSR FTSNMS                             S01499 CFT014
     C***********          MOVEL'Y'       I6VAT7                   S01499 CFT014
     C***********          MOVEL'Y'       E#NOUP                   S01499 CFT014
     C***********          END                                     S01499 CFT014
     C***********          END                                     S01499 CFT014
     C***********                                                  S01499 CFT014
     C***Unwind*subroutine*stack*name******************************S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********EXVATT    TAG                                     S01499 CFT014
     C***********          MOVEA*BLANKS   @STK,Q                   S01499 CFT014
     C***********          SUB  1         Q                        S01499 CFT014
     C***********                                                  S01499 CFT014
     C***SR******             ENDSR                                S01499 CFT014
     C***/EJECT**                                                         CFT014
      *                                                                   CFT014
      ** This subroutine has been moved to FT0349 (3rd screen val.)       CFT014
      *                                                                   CFT014
      *****************************************************************   CFT014
      *****************************************************************   CFT014
      ***SRTOT****:*Check*Total*Charges*Do*Not*Exceed*Payment*Amount***   CFT014
      *****************************************************************   CFT014
      ***CALLED*BY:*SRPROC*-*Control*Process*of*Validation*************   CFT014
      *****************************************************************   CFT014
      ***CALLS****:********-*******************************************   CFT014
      *****************************************************************   CFT014
      *****************************************************************   CFT014
     C***SR******   SRTOT     BEGSR                                       CFT014
      ***********                                                         CFT014
      ***Set*up*subroutine*stack*name**********************************   CFT014
      ***********                                                         CFT014
     C***********          ADD  1         Q       50                      CFT014
     C***********          MOVEL'SRTOT '  @STK,Q                          CFT014
      ***********                                                         CFT014
      ***/COPY*Statement***********************************************   CFT014
      ***********                                                         CFT014
     C***/COPY*WNCPYSRC,FT0348RTOT                                        CFT014
      ***********                                                         CFT014
      **If*EMU*FT*Enhancement*is*switched*on*then******************CEU006 CFT014
      **save*work*date*parameter*for*call*to*FT0010*as*W#DT********CEU006 CFT014
      ***********                                                  CEU006 CFT014
     C***********CEU006    IFEQ 'Y'                                CEU006 CFT014
     C***********V#ADDC    IFEQ 'A'                                CEU006 CFT014
     C***********          Z-ADDV#SLDT    W#DT                     CEU006 CFT014
     C***********          ELSE                                    CEU006 CFT014
     C***********          Z-ADDV#PVDT    W#DT                     CEU006 CFT014
     C***********          ENDIF                                   CEU006 CFT014
     C***********          ENDIF                                   CEU006 CFT014
      ***********                                                  CEU006 CFT014
      ***Transfer*Commission*Charge************************************   CFT014
      ***--------------------------************************************   CFT014
      ***********                                                         CFT014
     C***********F6TRCD    IFNE 0                                         CFT014
     C***********                                                  CEU006 CFT014
     C***********CEU006    IFEQ 'Y'                                CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C**If*EMU*FT*Enhancement*is*switched*on*then*call*FT0010******CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C***********          CLEARP#0010                             CEU006 CFT014
     C***********          MOVE V#CCCY    P#FRCY                   CEU006 CFT014
     C***********          Z-ADDF6TRCD    P#FRAM                   CEU006 CFT014
     C***********          Z-ADDW#DT      P#FRDT                   CEU006 CFT014
     C***********          MOVE V#RCCY    P#TOCY                   CEU006 CFT014
     C***********          Z-ADDW#DT      P#TODT                   CEU006 CFT014
     C***********          EXSR SRFT10                             CEU006 CFT014
     C***********          Z-ADDP#TOAM    F6TRCM                   CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C***********          ELSE                                    CEU006 CFT014
      ***********                                                         CFT014
     C***********          CLEARD#DTA                                     CFT014
     C***********          MOVE F6TRCD    D#FAMT                          CFT014
     C***********          MOVELV#CCCY    D#FCCY                          CFT014
     C***********          MOVELV#RCCY    D#TCCY                          CFT014
      ***********                                                         CFT014
     C***/COPY*WNCPYSRC,FT0348C014                                        CFT014
     C***********          CALL 'AOCCYCV0'             9090               CFT014
     C***********          PARM *BLANKS   O#RTN   7                       CFT014
     C***********          PARM '*F*T*SPT'W0ACT   8                       CFT014
     C***********D#DTA     PARM D#DTA     O#DTA 256                       CFT014
     C***/COPY*WNCPYSRC,FT0348C015                                        CFT014
      ***********                                                         CFT014
     C************IN90     IFEQ '1'                                       CFT014
     C***********O#RTN     ORNE *BLANKS                                   CFT014
     C***********          MOVEL'AOCCYCV0'W0FILE           ***************CFT014
     C***********          MOVEL'*CALL'   W0KEY            * DB ERROR 02 *CFT014
     C***********          Z-ADD2         W0ERNB           ***************CFT014
     C***********          MOVEL'MEM5003' W0MSGD                          CFT014
     C***********          MOVEL'MIDAS  ' W0MSGF                          CFT014
     C***********          EXSR SRERR                                     CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
     C***********          Z-ADDD#TAMT    F6TRCM                          CFT014
     C***********                                                  CEU006 CFT014
     C***********          ENDIF                                   CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
     C***********          Z-ADDF6TRCM    TTLCHG 130                      CFT014
      ***********                                                         CFT014
      ***Telex*Charge**************************************************   CFT014
      ***------------**************************************************   CFT014
      ***********                                                         CFT014
     C***********F6TXCD    IFNE 0                                         CFT014
     C***********                                                  CEU006 CFT014
     C***********CEU006    IFEQ 'Y'                                CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C**If*EMU*FT*Enhancement*is*switched*on*then*call*FT0010******CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C***********          CLEARP#0010                             CEU006 CFT014
     C***********          MOVE V#CCCY    P#FRCY                   CEU006 CFT014
     C***********          Z-ADDF6TXCD    P#FRAM                   CEU006 CFT014
     C***********          Z-ADDW#DT      P#FRDT                   CEU006 CFT014
     C***********          MOVE V#RCCY    P#TOCY                   CEU006 CFT014
     C***********          Z-ADDW#DT      P#TODT                   CEU006 CFT014
     C***********          EXSR SRFT10                             CEU006 CFT014
     C***********          Z-ADDP#TOAM    F6TXCH                   CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C***********          ELSE                                    CEU006 CFT014
      ***********                                                         CFT014
     C***********          CLEARD#DTA                                     CFT014
     C***********          MOVE F6TXCD    D#FAMT                          CFT014
     C***********          MOVELV#CCCY    D#FCCY                          CFT014
     C***********          MOVELV#RCCY    D#TCCY                          CFT014
      ***********                                                         CFT014
     C***/COPY*WNCPYSRC,FT0348C016                                        CFT014
     C***********          CALL 'AOCCYCV0'             9090               CFT014
     C***********          PARM *BLANKS   O#RTN   7                       CFT014
     C***********          PARM '*F*T*SPT'W0ACT   8                       CFT014
     C***********D#DTA     PARM D#DTA     O#DTA 256                       CFT014
     C***/COPY*WNCPYSRC,FT0348C017                                        CFT014
      ***********                                                         CFT014
     C************IN90     IFEQ '1'                                       CFT014
     C***********O#RTN     ORNE *BLANKS                                   CFT014
     C***********          MOVEL'AOCCYCV0'W0FILE           ***************CFT014
     C***********          MOVEL'*CALL'   W0KEY            * DB ERROR 03 *CFT014
     C***********          Z-ADD3         W0ERNB           ***************CFT014
     C***********          MOVEL'MEM5003' W0MSGD                          CFT014
     C***********          MOVEL'MIDAS  ' W0MSGF                          CFT014
     C***********          EXSR SRERR                                     CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
     C***********          Z-ADDD#TAMT    F6TXCH                          CFT014
     C***********                                                  CEU006 CFT014
     C***********          ENDIF                                   CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
     C***********          ADD  F6TXCH    TTLCHG                          CFT014
      ***********                                                         CFT014
      ***Cheque*Charge*************************************************   CFT014
      ***-------------*************************************************   CFT014
      ***********                                                         CFT014
     C***********F6CQCD    IFNE 0                                         CFT014
     C***********                                                  CEU006 CFT014
     C***********CEU006    IFEQ 'Y'                                CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C**If*EMU*FT*Enhancement*is*switched*on*then*call*FT0010******CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C***********          CLEARP#0010                             CEU006 CFT014
     C***********          MOVE V#CCCY    P#FRCY                   CEU006 CFT014
     C***********          Z-ADDF6CQCD    P#FRAM                   CEU006 CFT014
     C***********          Z-ADDW#DT      P#FRDT                   CEU006 CFT014
     C***********          MOVE V#RCCY    P#TOCY                   CEU006 CFT014
     C***********          Z-ADDW#DT      P#TODT                   CEU006 CFT014
     C***********          EXSR SRFT10                             CEU006 CFT014
     C***********          Z-ADDP#TOAM    F6CQCH                   CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C***********          ELSE                                    CEU006 CFT014
      ***********                                                         CFT014
     C***********          CLEARD#DTA                                     CFT014
     C***********          MOVE F6CQCD    D#FAMT                          CFT014
     C***********          MOVELV#CCCY    D#FCCY                          CFT014
     C***********          MOVELV#RCCY    D#TCCY                          CFT014
      ***********                                                         CFT014
     C***/COPY*WNCPYSRC,FT0348C018                                        CFT014
     C***********          CALL 'AOCCYCV0'             9090               CFT014
     C***********          PARM *BLANKS   O#RTN   7                       CFT014
     C***********          PARM '*F*T*SPT'W0ACT   8                       CFT014
     C***********D#DTA     PARM D#DTA     O#DTA 256                       CFT014
     C***/COPYWWNCPYSRC,FT0348C019                                        CFT014
      ***********                                                         CFT014
     C************IN90     IFEQ '1'                                       CFT014
     C***********O#RTN     ORNE *BLANKS                                   CFT014
     C***********          MOVEL'AOCCYCV0'W0FILE           ***************CFT014
     C***********          MOVEL'*CALL'   W0KEY            * DB ERROR 04 *CFT014
     C***********          Z-ADD4         W0ERNB           ***************CFT014
     C***********          MOVEL'MEM5003' W0MSGD                          CFT014
     C***********          MOVEL'MIDAS  ' W0MSGF                          CFT014
     C***********          EXSR SRERR                                     CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
     C***********          Z-ADDD#TAMT    F6CQCH                          CFT014
     C***********                                                  CEU006 CFT014
     C***********          ENDIF                                   CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
     C***********          ADD  F6CQCH    TTLCHG                          CFT014
      ***********                                                         CFT014
      ***Costs*Abroad**************************************************   CFT014
      ***------------**************************************************   CFT014
      ***********                                                         CFT014
     C***********F6CSTD    IFNE 0                                         CFT014
     C***********                                                  CEU006 CFT014
     C***********CEU006    IFEQ 'Y'                                CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C**If*EMU*FT*Enhancement*is*switched*on*then*call*FT0010******CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C***********          CLEARP#0010                             CEU006 CFT014
     C***********          MOVE V#CCCY    P#FRCY                   CEU006 CFT014
     C***********          Z-ADDF6CSTD    P#FRAM                   CEU006 CFT014
     C***********          Z-ADDW#DT      P#FRDT                   CEU006 CFT014
     C***********          MOVE V#RCCY    P#TOCY                   CEU006 CFT014
     C***********          Z-ADDW#DT      P#TODT                   CEU006 CFT014
     C***********          EXSR SRFT10                             CEU006 CFT014
     C***********          Z-ADDP#TOAM    F6CSTA                   CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C***********          ELSE                                    CEU006 CFT014
      ***********                                                         CFT014
     C***********          CLEARD#DTA                                     CFT014
     C***********          MOVE F6CSTD    D#FAMT                          CFT014
     C***********          MOVELV#CCCY    D#FCCY                          CFT014
     C***********          MOVELV#RCCY    D#TCCY                          CFT014
      ***********                                                         CFT014
     C***/COPY*WNCPYSRC,FT0348C020                                        CFT014
     C***********          CALL 'AOCCYCV0'             9090               CFT014
     C***********          PARM *BLANKS   O#RTN   7                       CFT014
     C***********          PARM '*F*T*SPT'W0ACT   8                       CFT014
     C***********D#DTA     PARM D#DTA     O#DTA 256                       CFT014
     C***/COPY*WNCPYSRC,FT0348C021                                        CFT014
      ***********                                                         CFT014
     C************IN90     IFEQ '1'                                       CFT014
     C***********O#RTN     ORNE *BLANKS                                   CFT014
     C***********          MOVEL'AOCCYCV0'W0FILE           ***************CFT014
     C***********          MOVEL'*CALL'   W0KEY            * DB ERROR 05 *CFT014
     C***********          Z-ADD5         W0ERNB           ***************CFT014
     C***********          MOVEL'MEM5003' W0MSGD                          CFT014
     C***********          MOVEL'MIDAS  ' W0MSGF                          CFT014
     C***********          EXSR SRERR                                     CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
     C***********          Z-ADDD#TAMT    F6CSTA                          CFT014
     C***********                                                  CEU006 CFT014
     C***********          ENDIF                                   CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
     C***********          ADD  F6CSTA    TTLCHG                          CFT014
      ***********                                                         CFT014
      ***SWIFT*Priority*Charge*****************************************   CFT014
      ***---------------------*****************************************   CFT014
      ***********                                                         CFT014
     C***********F6SPCD    IFNE 0                                         CFT014
     C***********                                                  CEU006 CFT014
     C***********CEU006    IFEQ 'Y'                                CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C**If*EMU*FT*Enhancement*is*switched*on*then*call*FT0010******CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C***********          CLEARP#0010                             CEU006 CFT014
     C***********          MOVE V#CCCY    P#FRCY                   CEU006 CFT014
     C***********          Z-ADDF6SPCD    P#FRAM                   CEU006 CFT014
     C***********          Z-ADDW#DT      P#FRDT                   CEU006 CFT014
     C***********          MOVE V#RCCY    P#TOCY                   CEU006 CFT014
     C***********          Z-ADDW#DT      P#TODT                   CEU006 CFT014
     C***********          EXSR SRFT10                             CEU006 CFT014
     C***********          Z-ADDP#TOAM    F6SPCH                   CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C***********          ELSE                                    CEU006 CFT014
      ***********                                                         CFT014
     C***********          CLEARD#DTA                                     CFT014
     C***********          MOVE F6SPCD    D#FAMT                          CFT014
     C***********          MOVELV#CCCY    D#FCCY                          CFT014
     C***********          MOVELV#RCCY    D#TCCY                          CFT014
      ***********                                                         CFT014
     C***/COPY*WNCPYSRC,FT0348C022                                        CFT014
     C***********          CALL 'AOCCYCV0'             9090               CFT014
     C***********          PARM *BLANKS   O#RTN   7                       CFT014
     C***********          PARM '*F*T*SPT'W0ACT   8                       CFT014
     C***********D#DTA     PARM D#DTA     O#DTA 256                       CFT014
     C***/COPY*WNCPYSRC,FT0348C023                                        CFT014
      ***********                                                         CFT014
     C************IN90     IFEQ '1'                                       CFT014
     C***********O#RTN     ORNE *BLANKS                                   CFT014
     C***********          MOVEL'AOCCYCV0'W0FILE           ***************CFT014
     C***********          MOVEL'*CALL'   W0KEY            * DB ERROR 06 *CFT014
     C***********          Z-ADD6         W0ERNB           ***************CFT014
     C***********          MOVEL'MEM5003' W0MSGD                          CFT014
     C***********          MOVEL'MIDAS  ' W0MSGF                          CFT014
     C***********          EXSR SRERR                                     CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
     C***********          Z-ADDD#TAMT    F6SPCH                          CFT014
     C***********                                                  CEU006 CFT014
     C***********          ENDIF                                   CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
     C***********          ADD  F6SPCH    TTLCHG                          CFT014
      ***********                                                         CFT014
      ***Miscellaneous*Charge******************************************   CFT014
      ***--------------------******************************************   CFT014
      ***********                                                         CFT014
     C***********F6MSCD    IFNE 0                                         CFT014
     C***********                                                  CEU006 CFT014
     C***********CEU006    IFEQ 'Y'                                CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C**If*EMU*FT*Enhancement*is*switched*on*then*call*FT0010******CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C***********          CLEARP#0010                             CEU006 CFT014
     C***********          MOVE V#CCCY    P#FRCY                   CEU006 CFT014
     C***********          Z-ADDF6MSCD    P#FRAM                   CEU006 CFT014
     C***********          Z-ADDW#DT      P#FRDT                   CEU006 CFT014
     C***********          MOVE V#RCCY    P#TOCY                   CEU006 CFT014
     C***********          Z-ADDW#DT      P#TODT                   CEU006 CFT014
     C***********          EXSR SRFT10                             CEU006 CFT014
     C***********          Z-ADDP#TOAM    F6MSCH                   CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C***********          ELSE                                    CEU006 CFT014
      ***********                                                         CFT014
     C***********          CLEARD#DTA                                     CFT014
     C***********          MOVE F6MSCD    D#FAMT                          CFT014
     C***********          MOVELV#CCCY    D#FCCY                          CFT014
     C***********          MOVELV#RCCY    D#TCCY                          CFT014
      ***********                                                         CFT014
     C***/COPY*WNCPYSRC,FT0348C024                                        CFT014
     C***********          CALL 'AOCCYCV0'             9090               CFT014
     C***********          PARM *BLANKS   O#RTN   7                       CFT014
     C***********          PARM '*F*T*SPT'W0ACT   8                       CFT014
     C***********D#DTA     PARM D#DTA     O#DTA 256                       CFT014
     C***/COPY*WNCPYSRC,FT0348C025                                        CFT014
      ***********                                                         CFT014
     C************IN90     IFEQ '1'                                       CFT014
     C***********O#RTN     ORNE *BLANKS                                   CFT014
     C***********          MOVEL'AOCCYCV0'W0FILE           ***************CFT014
     C***********          MOVEL'*CALL'   W0KEY            * DB ERROR 07 *CFT014
     C***********          Z-ADD7         W0ERNB           ***************CFT014
     C***********          MOVEL'MEM5003' W0MSGD                          CFT014
     C***********          MOVEL'MIDAS  ' W0MSGF                          CFT014
     C***********          EXSR SRERR                                     CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
     C***********          Z-ADDD#TAMT    F6MSCH                          CFT014
     C***********                                                  CEU006 CFT014
     C***********          ENDIF                                   CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
     C***********          ADD  F6MSCH    TTLCHG                          CFT014
     C***********                                                  S01494 CFT014
     C***FX/Change*Commission**************************************S01494 CFT014
     C***--------------------**************************************S01494 CFT014
     C***********                                                  S01494 CFT014
     C***********F6CHCD    IFNE 0                                  S01494 CFT014
     C***********S01494    ANDEQ'Y'                                S01494 CFT014
     C***********                                                  CEU006 CFT014
     C***********CEU006    IFEQ 'Y'                                CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C**If*EMU*FT*Enhancement*is*switched*on*then*call*FT0010******CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C***********          CLEARP#0010                             CEU006 CFT014
     C***********          MOVE V#CCCY    P#FRCY                   CEU006 CFT014
     C***********          Z-ADDF6CHCD    P#FRAM                   CEU006 CFT014
     C***********          Z-ADDW#DT      P#FRDT                   CEU006 CFT014
     C***********          MOVE V#RCCY    P#TOCY                   CEU006 CFT014
     C***********          Z-ADDW#DT      P#TODT                   CEU006 CFT014
     C***********          EXSR SRFT10                             CEU006 CFT014
     C***********          Z-ADDP#TOAM    F6CHCM                   CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C***********          ELSE                                    CEU006 CFT014
     C***********                                                  S01494 CFT014
     C***********          CLEARD#DTA                              S01494 CFT014
     C***********          MOVE F6CHCD    D#FAMT                   S01494 CFT014
     C***********          MOVELV#CCCY    D#FCCY                   S01494 CFT014
     C***********          MOVELV#RCCY    D#TCCY                   S01494 CFT014
     C***********                                                  S01494 CFT014
     C***/COPY*WNCPYSRC,FT0348C026                                        CFT014
     C***********          CALL 'AOCCYCV0'             9090        S01494 CFT014
     C***********          PARM *BLANKS   O#RTN   7                S01494 CFT014
     C***********          PARM '*F*T*SPT'W0ACT   8                S01494 CFT014
     C***********D#DTA     PARM D#DTA     O#DTA 256                S01494 CFT014
     C***/COPY*WNCPYSRC,FT0348C027                                        CFT014
     C***********                                                  S01494 CFT014
     C************IN90     IFEQ '1'                                S01494 CFT014
     C***********O#RTN     ORNE *BLANKS                            S01494 CFT014
     C***********          MOVEL'AOCCYCV0'W0FILE           ***************CFT014
     C***********          MOVEL'*CALL'   W0KEY            * DB ERROR1084*CFT014
     C***********          Z-ADD8         W0ERNB           ***************CFT014
     C***********          MOVEL'MEM5003' W0MSGD                   S01494 CFT014
     C***********          MOVEL'MIDAS  ' W0MSGF                   S01494 CFT014
     C***********          EXSR SRERR                              S01494 CFT014
     C***********          END                                     S01494 CFT014
     C***********                                                  S01494 CFT014
     C***********          Z-ADDD#TAMT    F6CHCM                   S01494 CFT014
     C***********                                                  CEU006 CFT014
     C***********          ENDIF                                   CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C***********          END                                     S01494 CFT014
     C***********                                                  S01494 CFT014
     C***********          ADD  F6CHCM    TTLCHG                   S01494 CFT014
     C***********                                                  S01499 CFT014
     C***Inlcude*V.A.T.*amount*if*V.A.T.*processing*allowed********S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********V#VATP    IFEQ 'Y'                                S01499 CFT014
     C***********F6VATD    ANDNE0                                  S01499 CFT014
     C***********                                                  CEU006 CFT014
     C***********CEU006    IFEQ 'Y'                                CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C**If*EMU*FT*Enhancement*is*switched*on*then*call*FT0010******CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C***********          CLEARP#0010                             CEU006 CFT014
     C***********          MOVE V#CCCY    P#FRCY                   CEU006 CFT014
     C***********          Z-ADDF6VATD    P#FRAM                   CEU006 CFT014
     C***********          Z-ADDW#DT      P#FRDT                   CEU006 CFT014
     C***********          MOVE V#RCCY    P#TOCY                   CEU006 CFT014
     C***********          Z-ADDW#DT      P#TODT                   CEU006 CFT014
     C***********          EXSR SRFT10                             CEU006 CFT014
     C***********          Z-ADDP#TOAM    F6VATT                   CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C***********          ELSE                                    CEU006 CFT014
     C***********                                                  S01499 CFT014
     C***********          CLEARD#DTA                              S01499 CFT014
     C***********          MOVE F6VATD    D#FAMT                   S01499 CFT014
     C***********          MOVELV#CCCY    D#FCCY                   S01499 CFT014
     C***********          MOVELV#RCCY    D#TCCY                   S01499 CFT014
     C***********                                                  S01499 CFT014
     C***/COPY*WNCPYSRC,FT0348C028                                        CFT014
     C***********          CALL 'AOCCYCV0'             9090        S01499 CFT014
     C***********          PARM *BLANKS   O#RTN   7                S01499 CFT014
     C***********          PARM '*F*T*SPT'W0ACT   8                S01499 CFT014
     C***********D#DTA     PARM D#DTA     O#DTA 256                S01499 CFT014
     C***/COPY*WNCPYSRC,FT0348C029                                        CFT014
     C***********                                                  S01499 CFT014
     C************IN90     IFEQ '1'                                S01499 CFT014
     C***********O#RTN     ORNE *BLANKS                            S01499 CFT014
     C***********          MOVEL'AOCCYCV0'W0FILE           ***************CFT014
     C***********          MOVEL'*CALL'   W0KEY            * DB ERROR1109*CFT014
     C***********          Z-ADD10        W0ERNB           ***************CFT014
     C***********          MOVEL'MEM5003' W0MSGD                   S01499 CFT014
     C***********          MOVEL'MIDAS  ' W0MSGF                   S01499 CFT014
     C***********          EXSR SRERR                              S01499 CFT014
     C***********          END                                     S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********          Z-ADDD#TAMT    F6VATT                   S01499 CFT014
     C***********                                                  CEU006 CFT014
     C***********          ENDIF                                   CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C***********          END                                     S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********          ADD  F6VATT    TTLCHG                   S01499 CFT014
     C***********                                                  S01494 CFT014
      ***Check*that*total*charges*do*not*exceed*payment*amount*if*the**   CFT014
      ***add/deduct*indicator*is*'D'*and*'Charges*To*The*Debit*Of'*has*   CFT014
      ***not*been*entered.*********************************************   CFT014
      ***********                                                         CFT014
     C***********V#ADDC    IFEQ 'D'                                       CFT014
     C***********V#CDRT    ANDEQ*BLANKS                                   CFT014
      ***********                                                         CFT014
      ***Check*if*total*charges*are*greater*than*the*payment*value*****   CFT014
      ***********                                                         CFT014
     C***********TTLCHG    IFGE V#PYAM                                    CFT014
     C***********          MOVEL'Y'       E#MSGS                          CFT014
     C***********          MOVEL*BLANKS   FTMSDT                          CFT014
     C***********          MOVELE#CPGM    FTPGMQ                          CFT014
     C***********          MOVEL'FTM2201' FTMSID                          CFT014
     C***********          EXSR FTSNMS                                    CFT014
     C***********          MOVEL'Y'       E#NOUP                          CFT014
      ***********                                                         CFT014
      ***Reverse*image*the*Charge*fields*with*amounts*in*them**********   CFT014
      ***********                                                         CFT014
     C***********F6TRCM    IFNE 0                                         CFT014
     C***********          MOVEL'Y'       I6TRCM                          CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
     C***********F6TXCH    IFNE 0                                         CFT014
     C***********          MOVEL'Y'       I6TXCH                          CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
     C***********F6CQCH    IFNE 0                                         CFT014
     C***********          MOVEL'Y'       I6CQCH                          CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
     C***********F6CSTA    IFNE 0                                         CFT014
     C***********          MOVEL'Y'       I6CSTH                          CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
     C***********F6SPCH    IFNE 0                                         CFT014
     C***********          MOVEL'Y'       I6SPCH                          CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
     C***********F6MSCH    IFNE 0                                         CFT014
     C***********          MOVEL'Y'       I6MSCH                          CFT014
     C***********          END                                            CFT014
     C***********                                                  S01494 CFT014
     C***********F6CHCM    IFNE 0                                  S01494 CFT014
     C***********S01494    ANDEQ'Y'                                S01494 CFT014
     C***********          MOVEL'Y'       I6CHCM                   S01494 CFT014
     C***********          END                                     S01494 CFT014
      ***********                                                         CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
      ***Unwind*subroutine*stack*name**********************************   CFT014
      ***********                                                         CFT014
     C***********EXTOT     TAG                                            CFT014
     C***********          MOVEA*BLANKS   @STK,Q                          CFT014
     C***********          SUB  1         Q                               CFT014
      ***********                                                         CFT014
     C***SR******             ENDSR                                       CFT014
     C***/EJECT**                                                  S01499 CFT014
      *                                                                   CFT014
      ** This subroutine has been moved to FT0349 (3rd screen val.)       CFT014
      *                                                                   CFT014
     C*************************************************************S01499 CFT014
     C*************************************************************S01499 CFT014
     C***SRVATC***:*V.A.T.*Calculation*****************************S01499 CFT014
     C*************************************************************S01499 CFT014
     C***CALLED*BY:*SRPROC*-*Control*Process*of*Validation*********S01499 CFT014
     C*************************************************************S01499 CFT014
     C***CALLS****:********-***************************************S01499 CFT014
     C*************************************************************S01499 CFT014
     C*************************************************************S01499 CFT014
     C***SR******   SRVATC    BEGSR                                S01499 CFT014
     C***********                                                  S01499 CFT014
     C***Set*up*subroutine*stack*name******************************S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********          ADD  1         Q       50               S01499 CFT014
     C***********          MOVEL'SRVATC'  @STK,Q                   S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********          Z-ADD0         F6VATD                   S01499 CFT014
     C***********          Z-ADD0         F6VATT                   S01499 CFT014
     C/COPY WNCPYSRC,FT0348C034
     C***********                                                  S01499 CFT014
     C***If*apply*V.A.T.*flag*is*'Y',*calculate*V.A.T.*charge******S01499 CFT014
     C***********                                                  S01499 CFT014
     C***....*Transfer*commission**********************************S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********S6VAT1    IFEQ 'Y'                                S01499 CFT014
     C***********F6TRCD    MULT V#VATR    @TVATD 130H              S01499 CFT014
     C***********F6TRCM    MULT V#VATR    @TVATT 130H              S01499 CFT014
     C***********          ADD  @TVATD    F6VATD                   S01499 CFT014
     C***********          ADD  @TVATT    F6VATT                   S01499 CFT014
     C/COPY WNCPYSRC,FT0348C035
     C***********          END                                     S01499 CFT014
     C***********                                                  S01499 CFT014
     C***....*Telex************************************************S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********S6VAT2    IFEQ 'Y'                                S01499 CFT014
     C***********F6TXCD    MULT V#VATR    @TVATD    H              S01499 CFT014
     C***********F6TXCH    MULT V#VATR    @TVATT    H              S01499 CFT014
     C***********          ADD  @TVATD    F6VATD                   S01499 CFT014
     C***********          ADD  @TVATT    F6VATT                   S01499 CFT014
     C***********          END                                     S01499 CFT014
     C***********                                                  S01499 CFT014
     C***....*Cheque***********************************************S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********S6VAT3    IFEQ 'Y'                                S01499 CFT014
     C***********F6CQCD    MULT V#VATR    @TVATD    H              S01499 CFT014
     C***********F6CQCH    MULT V#VATR    @TVATT    H              S01499 CFT014
     C***********          ADD  @TVATD    F6VATD                   S01499 CFT014
     C***********          ADD  @TVATT    F6VATT                   S01499 CFT014
     C***********          END                                     S01499 CFT014
     C***********                                                  S01499 CFT014
     C***....*Costs************************************************S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********S6VAT4    IFEQ 'Y'                                S01499 CFT014
     C***********F6CSTD    MULT V#VATR    @TVATD    H              S01499 CFT014
     C***********F6CSTA    MULT V#VATR    @TVATT    H              S01499 CFT014
     C***********          ADD  @TVATD    F6VATD                   S01499 CFT014
     C***********          ADD  @TVATT    F6VATT                   S01499 CFT014
     C***********          END                                     S01499 CFT014
     C***********                                                  S01499 CFT014
     C***....*SWIFT************************************************S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********S6VAT5    IFEQ 'Y'                                S01499 CFT014
     C***********F6SPCD    MULT V#VATR    @TVATD    H              S01499 CFT014
     C***********F6SPCH    MULT V#VATR    @TVATT    H              S01499 CFT014
     C***********          ADD  @TVATD    F6VATD                   S01499 CFT014
     C***********          ADD  @TVATT    F6VATT                   S01499 CFT014
     C***********          END                                     S01499 CFT014
     C***********                                                  S01499 CFT014
     C***....*Miscellaneous****************************************S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********S6VAT6    IFEQ 'Y'                                S01499 CFT014
     C***********F6MSCD    MULT V#VATR    @TVATD    H              S01499 CFT014
     C***********F6MSCH    MULT V#VATR    @TVATT    H              S01499 CFT014
     C***********          ADD  @TVATD    F6VATD                   S01499 CFT014
     C***********          ADD  @TVATT    F6VATT                   S01499 CFT014
     C/COPY WNCPYSRC,FT0348C036
     C***********          END                                     S01499 CFT014
     C***********                                                  S01499 CFT014
     C***....*FX/Change*commission*********************************S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********S6VAT7    IFEQ 'Y'                                S01499 CFT014
     C***********S01494    ANDEQ'Y'                                S01499 CFT014
     C***********F6CHCD    MULT V#VATR    @TVATD    H              S01499 CFT014
     C***********F6CHCM    MULT V#VATR    @TVATT    H              S01499 CFT014
     C***********          ADD  @TVATD    F6VATD                   S01499 CFT014
     C***********          ADD  @TVATT    F6VATT                   S01499 CFT014
     C***********          END                                     S01499 CFT014
     C***********                                                  S01499 CFT014
     C***Unwind*subroutine*stack*name******************************S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********EXVATC    TAG                                     S01499 CFT014
     C***********          MOVEA*BLANKS   @STK,Q                   S01499 CFT014
     C***********          SUB  1         Q                        S01499 CFT014
     C***********                                                  S01499 CFT014
     C***SR******             ENDSR                                S01499 CFT014
     C***/EJECT**                                                         CFT014
      *****************************************************************
      *                                                               *
      *  SRXVAL   : Cross validations                                 *
      *                                                               *
      *  CALLED BY: SRPROC - Control Process of Validation            *
      *                                                               *
      *  CALLS    :        -                                          *
      *                                                               *
      *****************************************************************
     CSR         SRXVAL    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SRXVAL'  @STK,Q
      *                                                                   CFT014
      ** Call Bank to Bank Validation object.                             CFT014
      ** Set up parameters                                                CFT014
      *                                                                   CFT014
     C                     MOVEL*BLANKS   W0RTN                           CFT014
     C                     CLEARI#PARM                                    CFT014
      *                                                                   CFT014
      ** Set up Control fields                                            CFT014
      *                                                                   CFT014
     C                     MOVEL':72: '   I#VFLD                          CFT014
     C                     MOVEL'PAY'     I#PR                            CFT014
      *                                                                   CFT014
      ** Set up Currency fields                                           CFT014
      *                                                                   CFT014
     C                     MOVELV#PCCY    I#PCCY                          CFT014
     C                     MOVELV#SMCY    I#RCCY                          CFT014
      *                                                                   CFT014
      ** Set up Account with Bank                                         CFT014
      *                                                                   CFT014
     C           V#ACBT    IFNE *BLANKS                                   CFT014
     C                     MOVELV#ACBT    I#AWBT                          CFT014
     C                     MOVELV#ABK1    ##001A  1                       CFT014
     C           ##001A    IFEQ '/'                                       CFT014
     C                     MOVELV#ABK2    I#AWBK                          CFT014
     C                     ELSE                                           CFT014
     C                     MOVELV#ABK1    I#AWBK                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Set up Beneficiary                                               CFT014
      *                                                                   CFT014
     C           V#BNCT    IFNE *BLANKS                                   CFT014
     C                     MOVELV#BNCT    I#BENT                          CFT014
     C                     MOVELV#BNF1    ##001A  1                       CFT014
     C           ##001A    IFEQ '/'                                       CFT014
     C                     MOVELV#BNF2    I#BENF                          CFT014
     C                     ELSE                                           CFT014
     C                     MOVELV#BNF1    I#BENF                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Move in Bank to Bank Information                                 CFT014
      *                                                                   CFT014
     C                     MOVELS6BTB     I#BTB                           CFT014
     C                     MOVELV#STMT    I#PSTM                          CFT014
     C                     MOVEL*BLANKS   I#RSTM                          CFT014
      *                                                                   CFT014
      ** Set up Receive/Settle account information                        CFT014
      *                                                                   CFT014
     C                     MOVELV#FRGL    I#RCAC                          CFT014
      *                                                                   CFT014
      ** Set up Pay account information                                   CFT014
      *                                                                   CFT014
     C                     MOVELV#TOGL    I#PYAC                          CFT014
      *                                                                   CFT014
      ** If extra message and Rec Corr. then set 5354 field               CFT014
      *                                                                   CFT014
     C           V#SNCT    IFNE *BLANKS                                   CFT014
     C           V#RCOT    ANDNE*BLANKS                                   CFT014
     C                     MOVEL'Y'       I#5354                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Transaction Type                                                 CFT014
      *                                                                   CFT014
     C                     MOVEL'OP'      I#TTYP                          CFT014
      *                                                                   CFT014
      ** Covered Required                                                 CFT014
      *                                                                   CFT014
     C                     MOVELV#SNMT    I#COVR                          CFT014
      *                                                                   CFT014
      ** Set up message type                                              CFT014
      *                                                                   CFT014
     C                     SELEC                                          CFT014
     C           V#ORC1    WHEQ ORCFLD                                    CFT014
     C                     MOVEL'202'     I#MTYP                          CFT014
     C                     OTHER                                          CFT014
     C           CSW203    IFEQ 'N'                                                           CSW203
     C                     MOVEL'100'     I#MTYP                          CFT014
     C                     ELSE                                                               CSW203
     C                     MOVEL'103'     I#MTYP                                              CSW203
     C                     ENDIF                                                              CSW203
     C                     ENDSL                                          CFT014
     C                     CLEARO#PARM                                    CFT014
     C                     CLEARX#PARM                                    CFT014
      *                                                                   CFT014
      ** Send messages to correct calling process                         CFT014
      *                                                                   CFT014
     C                     MOVELE#CPGM    X#CPGM                          CFT014
     C                     MOVEL'FT'      I#MMOD                          CFT014
      *                                                                   CFT014
     C                     MOVEL'MEC0114' X#MSGD                          CFT014
     C                     MOVEL'MEMSG'   X#MSGF                          CFT014
      *                                                                   CFT014
     C                     CALL 'ME9950'                                  CFT014
     C                     PARM           W0RTN   7                       CFT014
     C                     PARM           I#PARM                          CFT014
     C                     PARM           O#PARM                          CFT014
     C                     PARM           X#PARM                          CFT014
     C                     PARM           Z#PARM256                       CFT014
      *                                                                   CFT014
      ** On return if errors copy into error array                        CFT014
      *                                                                   CFT014
     C                     MOVELO#BTB     S6BTB                           CFT014
      *                                                                   CFT014
     C           X#ERRM    IFNE *BLANKS                                   CFT014
      *                                                                   CFT014
     C                     MOVE X#FLDS    I6BTB                           CFT014
     C                     MOVEL'Y'       E#MSGS                          CFT014
     C                     MOVEL'Y'       E#NOUP                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *
      *  /COPY Statement
      *
     C/COPY WNCPYSRC,FT0348XVAL
      *
      *  Unwind subroutine stack name
      *
     C           EXXVAL    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
     C/COPY WNCPYSRC,FT0348C012
     E/COPY FTCPYSRC,SFTADDRC
     E/COPY FTCPYSRC,SFTADDRSC
     E***/COPY*FTCPYSRC,SFTSWFTC                                          CFT014
     E/COPY FTCPYSRC,SFTSNMSC
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRALGN   : To call ZALIGN                                    *
      *                                                               *
      *  CALLED BY:        -                                          *
      *                                                               *
      *  CALLS    :        -                                          *
      *                                                               *
      *****************************************************************
     CSR         SRALGN    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SRALGN'  @STK,Q
      *
     C                     CALL 'ZALIGN'               90
     C                     PARM *BLANKS   ZRTN    7        B:Return Code
     C                     PARM           ZFIELD 16        B:Check Field
     C                     PARM           ZADEC   10       I:No Of Decs
     C                     PARM           ZADIG   20       I:No Of Digits
     C                     PARM *BLANKS   ZAFLD  16        O:Check Field
      *
      *  If return with an error (LR seton in called program) then
      *  process for database error.
      *
     C           *IN90     IFEQ '1'
     C                     MOVEL'ZALIGN  'W0FILE
     C                     MOVEL'*CALL'   W0KEY            ***************
     C                     Z-ADD2         W0ERNB           * DB ERROR 02 *
     C                     MOVEL'MEM5003' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *
      *  Unwind subroutine stack name
      *
     C           EXALGN    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRACT    : Undefined action - error                          *
      *                                                               *
      *  CALLED BY: Main Processing                                   *
      *                                                               *
      *  CALLS    : SRERR   - report error and close down program     *
      *                                                               *
      *****************************************************************
     CSR         SRACT     BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q
     C                     MOVEL'SRACT '  @STK,Q
      *
      *  Database error undefined action
      *
     C                     MOVEL'*ACTION 'W0FILE           ***************
     C                     MOVELW0ACT     W0KEY            * DB ERROR 03 *
     C                     Z-ADD3         W0ERNB           ***************
     C                     MOVEL'MEM5006' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
      *
      *  Unwind subroutine stack name
      *
     C           EXACT     TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
     C/EJECT                                                              CEU006
      *                                                                   CFT014
      ** This subroutine has been moved to FT0349 (3rd screen val.)       CFT014
      *                                                                   CFT014
     C*************************************************************CEU006 CFT014
     C*************************************************************CEU006 CFT014
     C***SRFT10***:*Calculates*Currency*Amounts*for*EMU************CEU006 CFT014
     C*************************************************************CEU006 CFT014
     C**************Converts*P#FRAM*in*P#FRCY*->*P#TOAM*in*P#TOCY.*CEU006 CFT014
     C*************************************************************CEU006 CFT014
     C***Called*by:*SRTOT******************************************CEU006 CFT014
     C*************************************************************CEU006 CFT014
     C***Calls****:*FT0010*-*Midas*FT*Calculate*Currency*Amounts.**CEU006 CFT014
     C*************************************************************CEU006 CFT014
     C*************************************************************CEU006 CFT014
     C***SR******   SRFT10    BEGSR                                CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C***/COPY*WNCPYSRC,FT0348C030                                        CFT014
     C***********          CALL 'FT0010'                           CEU006 CFT014
     C***********          PARM           P#0010                   CEU006 CFT014
      ***********                                                  CEU006 CFT014
      ***Check*if*database*error*occurred**************************CEU006 CFT014
      ***********                                                  CEU006 CFT014
     C***********P#RTCD    IFNE *BLANKS                            CEU006 CFT014
     C***********          MOVEL'FT0010  'W0FILE                   CEU006 CFT014
     C***********          MOVELP#TOCY    W0KEY            ********CEU006 CFT014
     C***********          Z-ADD11        W0ERNB           * DB ERRCEU006 CFT014
     C***********          MOVEL'MEM5004' W0MSGD           ********CEU006 CFT014
     C***********          MOVEL'MIDAS  ' W0MSGF                   CEU006 CFT014
     C***********          EXSR SRERR                              CEU006 CFT014
     C***********          ENDIF                                   CEU006 CFT014
      ***********                                                  CEU006 CFT014
     C***SR******             ENDSR                                CEU006 CFT014
     C***/EJECT**                                                         CFT014
      *****************************************************************
      *                                                               *
      *  SRINIT   : Initialise and define fields                      *
      *                                                               *
      *  CALLED BY: Main processing                                   *
      *                                                               *
      *  CALLS    :        -                                          *
      *                                                               *
      *****************************************************************
     CSR         SRINIT    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SRINIT'  @STK,Q
      *
      *  Set up copyright statement
      *
     C                     MOVEACPY@      BIS@   80
      *
      *  Indicate that set up is complete
      *
     C                     SETON                     50
      *
      *  Open Files
      *
      *
      *  Get Rundate information
      *
     C           *NAMVAR   DEFN RUNDAT    RUNDTA
     C                     IN   RUNDTA
     C                     MOVE AGMRDT    WUMRDT  7        Midas Run date
     C                     MOVE AGRDNB    WURDNB  50       Run day number
     C                     MOVE AGSUC     WUSUC   1        Set up complete
     C                     MOVE AGDFF     WUDFF   1        Date Format
     C                     MOVE AGMBIN    WUMBIN  1        Multi Branched
      *                                                                   CFT014
      ** Set up MT202 compare variable                                    CFT014
      *                                                                   CFT014
     C           *LIKE     DEFN V#ORC1    ORCFLD                          CFT014
     C                     MOVEL*BLANKS   ORCFLD                          CFT014
     C                     MOVEL'MT202'   ORCFLD                          CFT014
      *                                                                   CEU006
      *  Access Base Currency from Bank Details file                      CEU006
      *                                                                   CEU006
     C                     CALL 'AOBANKR0'             9090               CEU006
     C                     PARM *BLANKS   @RTCD            B:Return code  CEU006
     C                     PARM '*FIRST ' @OPTN            I:Option       CEU006
     C           SDBANK    PARM *BLANKS   DSFDY                           CEU006
      *                                                                   CEU006
      *  If return with an error (LR seton in called program) then        CEU006
      *  process for database error.                                      CEU006
      *                                                                   CEU006
     C           *IN90     IFEQ *ON                                       CEU006
     C           @RTCD     OREQ '*ERROR*'                                 CEU006
     C                     MOVEL'AOBANKR0'W0FILE                          CEU006
     C                     MOVEL'*CALL'   W0KEY            ***************CEU006
     C                     Z-ADD12        W0ERNB           * DB ERROR 12 *CEU006
     C                     MOVEL'MEM5003' W0MSGD           ***************CEU006
     C                     MOVEL'MIDAS  ' W0MSGF                          CEU006
     C                     EXSR SRERR                                     CEU006
     C                     ENDIF                                          CEU006
     C/COPY WNCPYSRC,FT0348C045
      *                                                                   CEU006
      * This part is made redundant due to movement of Charges            CFT014
      * to the Debit of Account validation to program FT0349              CFT014
      ***Access*Euro Currency Code from General Ledger ICD details.CEU006 CFT014
      ***********                                                  CEU006 CFT014
     C***********          CALL 'AOGELRR0'                         CEU006 CFT014
     C***********          PARM *BLANKS   @RTCD                    CEU006 CFT014
     C***********          PARM '*FIRST ' @OPTN                    CEU006 CFT014
     C***********SDGELR    PARM SDGELR    DSFDY                    CEU006 CFT014
      ***********                                                  CEU006 CFT014
      ** Database error                                            CEU006 CFT014
      ***********                                                  CEU006 CFT014
     C***********@RTCD     IFNE *BLANKS                            CEU006 CFT014
     C***********          MOVEL'SDGELRPD'W0FILE                   CEU006 CFT014
     C***********          MOVEL'*CALL'   W0KEY            ********CEU006 CFT014
     C***********          Z-ADD13        W0ERNB           * DB ERRCEU006 CFT014
     C***********          MOVEL'MEM5003' W0MSGD           ********CEU006 CFT014
     C***********          MOVEL'MIDAS  ' W0MSGF                   CEU006 CFT014
     C***********          EXSR SRERR                              CEU006 CFT014
     C***********          ENDIF                                   CEU006 CFT014
      ***********                                                  CEU006 CFT014
      **Access*Currency*details*for*Settlement*Currency************CEU006 CFT014
      ***********                                                  CEU006 CFT014
     C***********          CALL 'AOCURRR0'                         CEU006 CFT014
     C***********          PARM *BLANKS   @RTCD                    CEU006 CFT014
     C***********          PARM '*KEY   ' @OPTN                    CEU006 CFT014
     C***********          PARM V#SMCY    @AJCD   3                CEU006 CFT014
     C***********SDCURR    PARM SDCURR    DSSDY                    CEU006 CFT014
      ***********                                                  CEU006 CFT014
      ***Database*error********************************************CEU006 CFT014
     C***********@RTCD     IFNE *BLANK                             CEU006 CFT014
     C***********          MOVEL'SDCURRPD'W0FILE                   CEU006 CFT014
     C***********          MOVELV#SMCY    W0KEY            ********CEU006 CFT014
     C***********          Z-ADD14        W0ERNB           * DB ERRCEU006 CFT014
     C***********          MOVEL'MEM5004' W0MSGD           ********CEU006 CFT014
     C***********          MOVEL'MIDAS  ' W0MSGF                   CEU006 CFT014
     C***********          EXSR SRERR                              CEU006 CFT014
     C***********          ENDIF                                   CEU006 CFT014
      ***********                                                  CEU006 CFT014
      **Save*In*Ccy*Indicator*for*Settlement*Currency*as*#INCYS*andCEU006 CFT014
      **save*Transition*Start*Date*for*Settlement*Currency*as*#TPSDCEU006 CFT014
      ***********                                                  CEU006 CFT014
     C***********          MOVE A6INCY    #INCYS  1                CEU006 CFT014
     C***********          Z-ADDA6TPSD    #TPSDS  50               CEU006 CFT014
      ***********                                                  CEU006 CFT014
      **Access*Currency*details*for*Pay*Currency*******************CEU006 CFT014
      ***********                                                  CEU006 CFT014
     C***********          CALL 'AOCURRR0'                         CEU006 CFT014
     C***********          PARM *BLANKS   @RTCD                    CEU006 CFT014
     C***********          PARM '*KEY   ' @OPTN                    CEU006 CFT014
     C***********          PARM V#PCCY    @AJCD                    CEU006 CFT014
     C***********SDCURR    PARM SDCURR    DSSDY                    CEU006 CFT014
      ***********                                                  CEU006 CFT014
      ***Database*error********************************************CEU006 CFT014
     C***********@RTCD     IFNE *BLANK                             CEU006 CFT014
     C***********          MOVEL'SDCURRPD'W0FILE                   CEU006 CFT014
     C***********          MOVELV#PCCY    W0KEY            ********CEU006 CFT014
     C***********          Z-ADD15        W0ERNB           * DB ERRCEU006 CFT014
     C***********          MOVEL'MEM5004' W0MSGD           ********CEU006 CFT014
     C***********          MOVEL'MIDAS  ' W0MSGF                   CEU006 CFT014
     C***********          EXSR SRERR                              CEU006 CFT014
     C***********          ENDIF                                   CEU006 CFT014
      ***********                                                  CEU006 CFT014
      **Save*In*Ccy*Indicator*for*Pay*Currency*as*#INCYP*and*******CEU006 CFT014
      **save*Transition*Start*Date*for*Pay*Currency*as*#TPSDP.*****CEU006 CFT014
      ***********                                                  CEU006 CFT014
     C***********          MOVE A6INCY    #INCYP  1                CEU006 CFT014
     C***********          Z-ADDA6TPSD    #TPSDP  50               CEU006 CFT014
     C*                                                                   S01494
     C** Access SAR details file to determine if S01494 is switched ON    S01494
     C*                                                                   S01494
     C                     CALL 'AOSARDR0'                                S01494
     C                     PARM *BLANKS   @RTCD   7                       S01494
     C                     PARM '*VERIFY' @OPTN   7                       S01494
     C                     PARM 'S01494'  @SARD   6                       S01494
     C           SCSARD    PARM SCSARD    DSFDY                           S01494
     C                     MOVE 'N'       S01494  1                       S01494
     C*                                                                   S01494
     C** If core feature is switched ON, set a variable field to          S01494
     C** condition the rest of the processing                             S01494
     C*                                                                   S01494
     C           @RTCD     IFEQ *BLANKS                                   S01494
     C                     MOVE 'Y'       S01494                          S01494
     C                     ELSE                                           S01494
     C*                                                                   S01494
     C** else, database error (return code other than *NRF)               S01494
     C*                                                                   S01494
     C           @RTCD     IFNE '*NRF   '                                 S01494
     C                     MOVEL'SCSARDPD'W0FILE                          S01494
     C                     MOVEL'*CALL'   W0KEY            ***************S01494
     C                     Z-ADD9         W0ERNB           * DB ERROR 09 *S01494
     C                     MOVEL'MEM5003' W0MSGD           ***************S01494
     C                     MOVEL'MIDAS  ' W0MSGF                          S01494
     C                     EXSR SRERR                                     S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C*                                                                   S01499
     C** Access SAR details file to determine if CEU006 is switched ON    CEU006
     C*                                                                   CEU006
     C                     CALL 'AOSARDR0'                                CEU006
     C                     PARM *BLANKS   @RTCD                           CEU006
     C                     PARM '*VERIFY' @OPTN                           CEU006
     C                     PARM 'CEU006'  @SARD                           CEU006
     C           SCSARD    PARM SCSARD    DSFDY                           CEU006
     C                     MOVE 'N'       CEU006  1                       CEU006
     C*                                                                   CEU006
     C           @RTCD     IFEQ *BLANKS                                   CEU006
     C                     MOVE 'Y'       CEU006                          CEU006
     C                     ELSE                                           CEU006
     C*                                                                   CEU006
     C** database error (return code other than *NRF)                     CEU006
     C*                                                                   CEU006
     C           @RTCD     IFNE '*NRF   '                                 CEU006
     C                     MOVEL'SCSARDPD'W0FILE                          CEU006
     C                     MOVEL'*CALL'   W0KEY            ***************CEU006
     C                     Z-ADD16        W0ERNB           * DB ERROR 16 *CEU006
     C                     MOVEL'MEM5003' W0MSGD           ***************CEU006
     C                     MOVEL'MIDAS  ' W0MSGF                          CEU006
     C                     EXSR SRERR                                     CEU006
     C                     ENDIF                                          CEU006
     C                     ENDIF                                          CEU006
     C*                                                                   CEU006
     C** Access SAR details file to determine if CFT004 is switched ON    CFT004
     C*                                                                   CFT004
     C                     CALL 'AOSARDR0'                                CFT004
     C                     PARM *BLANKS   @RTCD                           CFT004
     C                     PARM '*VERIFY' @OPTN                           CFT004
     C                     PARM 'CFT004'  @SARD                           CFT004
     C           SCSARD    PARM SCSARD    DSFDY                           CFT004
     C                     MOVE 'N'       CFT004  1                       CFT004
     C*                                                                   CFT004
     C           @RTCD     IFEQ *BLANKS                                   CFT004
     C                     MOVE 'Y'       CFT004                          CFT004
     C                     ELSE                                           CFT004
     C*                                                                   CFT004
     C** database error (return code other than *NRF)                     CFT004
     C*                                                                   CFT004
     C           @RTCD     IFNE '*NRF   '                                 CFT004
     C                     MOVEL'SCSARDPD'W0FILE                          CFT004
     C                     MOVEL'*CALL'   W0KEY            ***************CFT004
     C                     Z-ADD17        W0ERNB           * DB ERROR 17 *CFT004
     C                     MOVEL'MEM5003' W0MSGD           ***************CFT004
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT004
     C                     EXSR SRERR                                     CFT004
     C                     ENDIF                                          CFT004
     C                     ENDIF                                          CFT004
      *                                                                   CFT014
      ** Determine if SAR CFT014 MT103 Message Generation is ins -        CFT014
      ** talled.                                                          CFT014
      *                                                                   CFT014
     C                     CALL 'AOSARDR0'                                CFT014
     C                     PARM *BLANKS   @RTCD                           CFT014
     C                     PARM '*VERIFY '@OPTN                           CFT014
     C                     PARM 'CFT014'  @SARD                           CFT014
     C           SCSARD    PARM SCSARD    DSFDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C           @RTCD     ANDNE'*NRF   '                                 CFT014
     C                     MOVEL'SCSARDPD'W0FILE                          CFT014
     C                     Z-ADD18        W0ERNB                          CFT014
     C                     MOVEL'CFT014'  W0KEY                           CFT014
     C                     EXSR SRERR                                     CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           @RTCD     IFEQ *BLANKS                                   CFT014
     C                     MOVE 'Y'       CFT014  1                       CFT014
     C                     ELSE                                           CFT014
     C                     MOVE 'N'       CFT014                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT009
      ** Determine if SAR CFT009 is installed                             CFT009
      *                                                                   CFT009
     C                     CALL 'AOSARDR0'                                CFT009
     C                     PARM *BLANKS   @RTCD                           CFT009
     C                     PARM '*VERIFY '@OPTN                           CFT009
     C                     PARM 'CFT009'  @SARD                           CFT009
     C           SCSARD    PARM SCSARD    DSFDY                           CFT009
      *                                                                   CFT009
     C           @RTCD     IFNE *BLANKS                                   CFT009
     C           @RTCD     ANDNE'*NRF   '                                 CFT009
     C                     MOVEL'SCSARDPD'W0FILE                          CFT009
     C                     Z-ADD19        W0ERNB                          CFT009
     C                     MOVEL'CFT009'  W0KEY                           CFT009
     C                     EXSR SRERR                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           @RTCD     IFEQ *BLANKS                                   CFT009
     C                     MOVE 'Y'       CFT009  1                       CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       CFT009                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                                       CSW201
      ** Check if SWIFT 2001 (CSW201) is installed                                            CSW201
      *                                                                                       CSW201
     C                     CALL 'SWIF2001'                                                    CSW201
     C                     PARM *BLANKS   PRTCD   7                                           CSW201
      *                                                                                       CSW201
     C           PRTCD     IFEQ 'CSW2001'                                                     CSW201
     C                     MOVE 'Y'       CSW201  1                                           CSW201
     C                     ELSE                                                               CSW201
     C                     MOVE 'N'       CSW201                                              CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW202
      ** Check if switchable feature CSW202 is switched on.                                   CSW202
      *                                                                                       CSW202
     C                     CALL 'SWIF2002'                                                    CSW202
     C                     PARM *BLANKS   PRTCD                                               CSW202
      *                                                                                       CSW202
     C           PRTCD     IFEQ 'CSW2002'                                                     CSW202
     C                     MOVE 'Y'       CSW202  1                                           CSW202
     C                     ELSE                                                               CSW202
     C                     MOVE 'N'       CSW202                                              CSW202
     C                     ENDIF                                                              CSW202
      *                                                                                       CSW203
      ** Check if SWIFT Changes 2003 (CSW203) is installed                                    CSW203
      *                                                                                       CSW203
     C                     CALL 'SWIF2003'                                                    CSW203
     C                     PARM *BLANKS   PRTCD                                               CSW203
      *                                                                                       CSW203
     C           PRTCD     IFEQ 'CSW2003'                                                     CSW203
     C                     MOVE 'Y'       CSW203  1                                           CSW203
     C                     ELSE                                                               CSW203
     C                     MOVE 'N'       CSW203                                              CSW203
     C                     ENDIF                                                              CSW203
      *                                                                                       CSW206
      ** Check if SWIFT Changes 2006 (CSW206) is installed                                    CSW206
      *                                                                                       CSW206
     C                     CALL 'SWIF2006'                                                    CSW206
     C                     PARM *BLANKS   PRTCD                                               CSW206
      *                                                                                       CSW206
     C           PRTCD     IFEQ 'CSW2006'                                                     CSW206
     C                     MOVE 'Y'       CSW206  1                                           CSW206
     C                     ELSE                                                               CSW206
     C                     MOVE 'N'       CSW206                                              CSW206
     C                     ENDIF                                                              CSW206
      *                                                                                       CSW202
     C***********                                                  CFT004 CFT014
     C***Retrieve*the*text*for*Transfer*Commission*using*MEC1150***S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********          CALL 'MEC1150'              9090        S01499 CFT014
     C***********          PARM 'FTM2544' #MSGID                   S01499 CFT014
     C***********          PARM 'FTUSRMSG'#MSGF                    S01499 CFT014
     C***********          PARM           #MSDTA                   S01499 CFT014
     C***********          PARM *BLANKS   #MSTX1                   S01499 CFT014
     C***********          PARM *BLANKS   #MSTX2                   S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********          MOVEL#MSTX1    WVAT1  20                S01499 CFT014
     C***********                                                  S01499 CFT014
     C***Retrieve*the*text*for*Telex*Charge*using*MEC1150**********S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********          CALL 'MEC1150'              9090        S01499 CFT014
     C***********          PARM 'FTM2545' #MSGID                   S01499 CFT014
     C***********          PARM 'FTUSRMSG'#MSGF                    S01499 CFT014
     C***********          PARM           #MSDTA                   S01499 CFT014
     C***********          PARM *BLANKS   #MSTX1                   S01499 CFT014
     C***********          PARM *BLANKS   #MSTX2                   S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********          MOVEL#MSTX1    WVAT2  20                S01499 CFT014
     C***********                                                  S01499 CFT014
     C***Retrieve*the*text*for*Cheque*Charge*using*MEC1150*********S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********          CALL 'MEC1150'              9090        S01499 CFT014
     C***********          PARM 'FTM2546' #MSGID                   S01499 CFT014
     C***********          PARM 'FTUSRMSG'#MSGF                    S01499 CFT014
     C***********          PARM           #MSDTA                   S01499 CFT014
     C***********          PARM *BLANKS   #MSTX1                   S01499 CFT014
     C***********          PARM *BLANKS   #MSTX2                   S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********          MOVEL#MSTX1    WVAT3  20                S01499 CFT014
     C***********                                                  S01499 CFT014
     C***Retrieve*the*text*for*Costs*Abroad*using*MEC1150**********S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********          CALL 'MEC1150'              9090        S01499 CFT014
     C***********          PARM 'FTM2547' #MSGID                   S01499 CFT014
     C***********          PARM 'FTUSRMSG'#MSGF                    S01499 CFT014
     C***********          PARM           #MSDTA                   S01499 CFT014
     C***********          PARM *BLANKS   #MSTX1                   S01499 CFT014
     C***********          PARM *BLANKS   #MSTX2                   S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********          MOVEL#MSTX1    WVAT4  20                S01499 CFT014
     C***********                                                  S01499 CFT014
     C***Retrieve*the*text*for*SWIFT*Priority*using*MEC1150********S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********          CALL 'MEC1150'              9090        S01499 CFT014
     C***********          PARM 'FTM2548' #MSGID                   S01499 CFT014
     C***********          PARM 'FTUSRMSG'#MSGF                    S01499 CFT014
     C***********          PARM           #MSDTA                   S01499 CFT014
     C***********          PARM *BLANKS   #MSTX1                   S01499 CFT014
     C***********          PARM *BLANKS   #MSTX2                   S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********          MOVEL#MSTX1    WVAT5  20                S01499 CFT014
     C***********                                                  S01499 CFT014
     C***Retrieve*the*text*for*Miscellaneous*Charge*using*MEC1150**S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********          CALL 'MEC1150'              9090        S01499 CFT014
     C***********          PARM 'FTM2549' #MSGID                   S01499 CFT014
     C***********          PARM 'FTUSRMSG'#MSGF                    S01499 CFT014
     C***********          PARM           #MSDTA                   S01499 CFT014
     C***********          PARM *BLANKS   #MSTX1                   S01499 CFT014
     C***********          PARM *BLANKS   #MSTX2                   S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********          MOVEL#MSTX1    WVAT6  20                S01499 CFT014
     C***********                                                  S01499 CFT014
     C***Retrieve*the*text*for*FX/Change*Commission*using*MEC1150**S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********          CALL 'MEC1150'              9090        S01499 CFT014
     C***********          PARM 'FTM2550' #MSGID                   S01499 CFT014
     C***********          PARM 'FTUSRMSG'#MSGF                    S01499 CFT014
     C***********          PARM           #MSDTA                   S01499 CFT014
     C***********          PARM *BLANKS   #MSTX1                   S01499 CFT014
     C***********          PARM *BLANKS   #MSTX2                   S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********          MOVEL#MSTX1    WVAT7  20                S01499 CFT014
     C/COPY WNCPYSRC,FT0348C007
      *
      *  Unwind subroutine stack name
      *
     C           EXINIT    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
      *************************************************************140624 CFT014
      *************************************************************140624 CFT014
      ***CEUINI***:*Access*currency*details************************140624 CFT014
      *************************************************************140624 CFT014
      ***CALLED*BY:*Main*processing********************************140624 CFT014
      *************************************************************140624 CFT014
      ***CALLS****:********-***************************************140624 CFT014
      *************************************************************140624 CFT014
      *************************************************************140624 CFT014
     C***********CEUINI    BEGSR                                   140624 CFT014
      ***********                                                  140624 CFT014
      ***Set*up*subroutine*stack*name******************************140624 CFT014
      ***********                                                  140624 CFT014
     C***********          ADD  1         Q       50               140624 CFT014
     C***********          MOVEL'CEUINI'  @STK,Q                   140624 CFT014
      ***********                                                  140624 CFT014
      ***Access*Base*Currency*from*Bank*Details*file***************140624 CFT014
      ***********                                                  140624 CFT014
     C***********          CALL 'AOBANKR0'             9090        140624 CFT014
     C***********          PARM *BLANKS   @RTCD            B:Return140624 CFT014
     C***********          PARM '*FIRST ' @OPTN            I:Option140624 CFT014
     C***********SDBANK    PARM *BLANKS   DSFDY                    140624 CFT014
      ***********                                                  140624 CFT014
      ***If*return*with*an*error*(LR*seton*in*called*program)*then*140624 CFT014
      ***process*for*database error.*******************************140624 CFT014
      ***********                                                  140624 CFT014
     C************IN90     IFEQ *ON                                140624 CFT014
     C***********@RTCD     OREQ '*ERROR*'                          140624 CFT014
     C***********          MOVEL'AOBANKR0'W0FILE                   140624 CFT014
     C***********          MOVEL'*CALL'   W0KEY            ********140624 CFT014
     C***********          Z-ADD12        W0ERNB           * DB ERR140624 CFT014
     C***********          MOVEL'MEM5003' W0MSGD           ********140624 CFT014
     C***********          MOVEL'MIDAS  ' W0MSGF                   140624 CFT014
     C***********          EXSR SRERR                              140624 CFT014
     C***********          ENDIF                                   140624 CFT014
      ***********                                                  140624 CFT014
      **Access*Currency*details*for*Settlement*Currency************140624 CFT014
      ***********                                                  140624 CFT014
     C***********          CALL 'AOCURRR0'                         140624 CFT014
     C***********          PARM *BLANKS   @RTCD                    140624 CFT014
     C***********          PARM '*KEY   ' @OPTN                    140624 CFT014
     C***********          PARM V#SMCY    @AJCD   3                140624 CFT014
     C***********SDCURR    PARM SDCURR    DSSDY                    140624 CFT014
      ***********                                                  140624 CFT014
      ***Database*error********************************************140624 CFT014
     C***********@RTCD     IFNE *BLANK                             140624 CFT014
     C***********          MOVEL'SDCURRPD'W0FILE                   140624 CFT014
     C***********          MOVELV#SMCY    W0KEY            ********140624 CFT014
     C***********          Z-ADD14        W0ERNB           * DB ERR140624 CFT014
     C***********          MOVEL'MEM5004' W0MSGD           ********140624 CFT014
     C***********          MOVEL'MIDAS  ' W0MSGF                   140624 CFT014
     C***********          EXSR SRERR                              140624 CFT014
     C***********          ENDIF                                   140624 CFT014
      ***********                                                  140624 CFT014
      **Save*In*Ccy*Indicator*for*Settlement*Currency*as*#INCYS*and140624 CFT014
      **save*Transition*Start*Date*for*Settlement*Currency*as*#TPSD140624 CFT014
      ***********                                                  140624 CFT014
     C***********          MOVE A6INCY    #INCYS  1                140624 CFT014
     C***********          Z-ADDA6TPSD    #TPSDS  50               140624 CFT014
      ***********                                                  140624 CFT014
      **Access*Currency*details*for*Pay*Currency*******************140624 CFT014
      ***********                                                  140624 CFT014
     C***********          CALL 'AOCURRR0'                         140624 CFT014
     C***********          PARM *BLANKS   @RTCD                    140624 CFT014
     C***********          PARM '*KEY   ' @OPTN                    140624 CFT014
     C***********          PARM V#PCCY    @AJCD                    140624 CFT014
     C***********SDCURR    PARM SDCURR    DSSDY                    140624 CFT014
      ***********                                                  140624 CFT014
      ***Database*error********************************************140624 CFT014
     C***********@RTCD     IFNE *BLANK                             140624 CFT014
     C***********          MOVEL'SDCURRPD'W0FILE                   140624 CFT014
     C***********          MOVELV#PCCY    W0KEY            ********140624 CFT014
     C***********          Z-ADD15        W0ERNB           * DB ERR140624 CFT014
     C***********          MOVEL'MEM5004' W0MSGD           ********140624 CFT014
     C***********          MOVEL'MIDAS  ' W0MSGF                   140624 CFT014
     C***********          EXSR SRERR                              140624 CFT014
     C***********          ENDIF                                   140624 CFT014
      ***********                                                  140624 CFT014
      **Save*In*Ccy*Indicator*for*Pay*Currency*as*#INCYP*and*******140624 CFT014
      **save*Transition*Start*Date*for*Pay*Currency*as*#TPSDP.*****140624 CFT014
      ***********                                                  140624 CFT014
     C***********          MOVE A6INCY    #INCYP  1                140624 CFT014
     C***********          Z-ADDA6TPSD    #TPSDP  50               140624 CFT014
      ***********                                                  140624 CFT014
      ***Unwind*subroutine*stack*name******************************140624 CFT014
      ***********                                                  140624 CFT014
     C***********          MOVEA*BLANKS   @STK,Q                   140624 CFT014
     C***********          SUB  1         Q                        140624 CFT014
      ***********                                                  140624 CFT014
     C***SR******             ENDSR                                140624 CFT014
     C***/COPY*WNCPYSRC,FT0348DCPG                                        CFT014
      *
      *  /Copy point for Calculations
      *
     C**
     C/EJECT
      *
      *  File and Program Error Processing
      *
     C/COPY FTCPYSRC,SRERRC
     C/EJECT
     O/COPY WNCPYSRC,FT0348DOPG
      *
      *  /Copy point for Outputs
      *
     O/EJECT
      *                                                                                       CSW202
      ** CODE1 , CODE2 and WICOR were amended to add codeword REPA.                           CSW202
      *                                                                                       CSW202
**  CPY@ table
(c) Finastra International Limited 2001
**  CODE1 - Valid code words for MT103 messages                           CFT014
PHONPHOITELETELIHOLDBONLCHQBCORTREPATELBPHOBSDVAINTC                                   CFT014 CSW202
**  CODE2 - Code words that could have an additional info.                CFT014
PHONPHOBPHOITELETELBTELIHOLDREPA                                                       CFT014 CSW202
**  WICOR                                                                                     CSW201
SDVAINTCREPACORTBONLHOLDCHQBPHOBTELBPHONTELEPHOITELI                                   CSW201 CSW202
