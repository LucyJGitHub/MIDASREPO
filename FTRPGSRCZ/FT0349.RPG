     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas FT Outgoing payments valid. S3 level 2')         *
      *****************************************************************
      *                                                               *
      *  Midas - Funds Transfer Module                                *
      *                                                               *
      *  FT0349 - Validate Outgoing Payments - Screen 3, Level 2      *
      *                                                               *
      *  Function:  This program validates the screen 3 level 2       *
      *             inputs for Outgoing Payments. All charge-related  *
      *             fields have been moved to this screen to give way *
      *             for the new MT103 fields.  Original validations   *
      *             were copied from where they previously            *
      *             belong (either from FT0347 or FT0348) and new     *
      *             validations added for the charges transparency    *
      *             fields.                                           *
      *                                                               *
      *  Called By: FT0345  - Outgoing Payments Maintenance Level 2   *
      *                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. CSD103             Date 10Aug20               *
      *  Prev Amend No. MD046248           Date 27Oct17               *
      *                 MD033624           Date 03Jun15               *
      *                 CFT120             Date 28Sep12               *
      *                 CER059             Date 19Jul10               *
      *                 CER030             Date 09Jul08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 BUG24724           Date 03Jul09               *
      *                 CSW209             Date 01Apr09               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 BUG15201           Date 30Oct07               *
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 250600             Date 07Oct07               *
      *                 200949             Date 05Oct06               *
      *                 CFT032             Date 11Sep06               *
      *                 CSD031             Date 10Apr06               *
      *                 BUG433             Date 05Dec05               *
      *                 CDL049             Date 07Jul06               *
      *                 CSD027             Date 09Dec05               *
      *                 CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 CSC022             Date 24Feb04               *
      *                 CGL029             Date 01Sep03               *
      *                 CGP001             Date 11Sep03               *
      *                 219241             Date 01Jul03               *
      * Midas Release 4.01 -------------------------------------------*
      *                 CFT017             Date 08Nov01               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 CPK014             Date 04Oct01               *
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CFT009             Date 25Aug00               *
      * Midas DBA 3.04 -----------------------------------------------*
      *                 187058             Date 06Dec00               *
      *                 CFT014  *CREATE    Date 25May00               *
      *                                                               *
      *---------------------------------------------------------------*
      *                                                               *
      *  CSD103 - LIBOR Deregulation - Common Layer/Standing Data     *
      *  MD046248 - Finastra Rebranding                               *
      *  MD033624 - Error during Compilation due to conflict in field *
      *             definition. Renamed fields from OTPAYDD           *
      *  CFT120 - FT IN/OP - Charges to DR of Account Currency        *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER030 - Multicash German Feature                            *
      *  BUG24724 - Senders and receivers charge error                *
      *  CSW209 - SWIFT 2009 Changes                                  *
      *  BUG15201 - Encounter Database Errors (Recompile)             *
      *  250600 - Fix CFT032 and CSW207 (recompile)                   *
      *  200949 - Suppress FTM3244 if payment will not produce        *
      *           a MT103.  Applied core fix 197943.                  *
      *  CFT032 - Account Line in Field 50X in MT103                  *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  BUG433 - Recompiled due to change in FTPCHGPD                *
      *  CDL049 - Addition of a Reference Rate field (recompile AND   *
      *           rename of OPRRAT to avoid duplication of subfields) *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CSC022 - Commitment Control Changes for MidasPlus            *
      *           (Recompile)                                         *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CGP001 - Global Processing.                                  *
      *  219241 - Defaulting of "Details of Charges" assign a         *
      *           system value                                        *
      *  CFT017 - Multilateral Inter-bank Exchange Fee.               *
      *  CPK014 - Release 4 packaging.  Rename of timestamp field.    *
      *  CFT009 - Fees and Charges Development                        *
      *  187058 - Suppress FTM3244 message for Regular Payments       *
      *  CFT014 - Straight-through Processing Phase 2 MT103           *
      *           Messages Generation for FT.                         *
      *                                                               *
      *****************************************************************
     F/COPY FTCPYSRC,SFTSWFTF
     FACCNT   IF  E           K        DISK         KINFSR SRFILE     UC
     F            ACCNTAAF                          KIGNORE
     F            ACCNTACF                          KIGNORE
     FACNUMA  IF  E           K        DISK         KINFSR SRFILE     UC
     F            ACCNTABF                          KRENAMEACNUMABF
      *                                                                   CFT009
     FOTPAY   IF  E           K        DISK                               CFT009
     FOTPAYXL2IF  E           K        DISK                               CFT009
     FFTPCHGL0IF  E           K        DISK                               CFT009
     F/COPY WNCPYSRC,FT0349F001
      *                                                                   CFT009
      *****************************************************************
      *                                                               *
      *  F U N C T I O N   O F   I N D I C A T O R S                  *
      *                                                               *
      *   50  - Program Initialised                                   *
      *                                                               *
      * 90-99 - Used by Standard Subroutines                          *
      *                                                               *
      * U7+U8 - Database Error                                        *
      *                                                               *
      *****************************************************************
      /SPACE 3
      *****************************************************************
      *                                                               *
      *  S U B R O U T I N E   I N D E X                              *
      *                                                               *
      *  SRINIT    - Program Initialisation.                          *
      *  SRRTXT    - Retrieve Texts.                                  *
      *  SRPROC    - Detail Processing.                               *
      *  SRCDRO    - Validates Charges to the debit of.               *
      *  SRDETC    - Validates Details of Charges.                    *
      *  SRCCCY    - Get Currency Information for Charge Validation.  *
      *  SRTRCM    - Validate Transfer Commission Charges.            *
      *  SRCHCM    - Validate FX/Change Commission.                   *
      *  SRTXCH    - Validate Telex Charge.                           *
      *  SRCQCH    - Validate Cheque Charge.                          *
      *  SRCSTH    - Validate Costs Abroad.                           *
      *  SRSPCH    - Validate SWIFT Priority.                         *
      *  SRMSCH    - Validate Miscellaneous.                          *
      *  SRVATT    - Validate V.A.T. Flags.                           *
      *  SRVATC    - V.A.T. Calculation.                              *
      *  SRRCRM    - Validate Receiver's Charges Remitted.            *
      *  SRSNCD    - Validate Sender's Charges Deducted.              *
      *  SRTOT     - Check Total Charges do not exceed Payment Amount.*
      *  SRCTOT    - Check Total Charges.                             *
      *  SRALGN    - Calls ZALIGN.                                    *
      *  SRACT     - Undefined action.                                *
      *  SRFT10    - Validate and Calculate currencies.               *
      *  SRSWST    - Validate SWIFT Standard                          *   CFT009
      *  SRM1CH    - Validate Miscellaneous 1                         *   CFT009
      *  SRM2CH    - Validate Miscellaneous 2                         *   CFT009
      *  SRM3CH    - Validate Miscellaneous 3                         *   CFT009
      *  SRM4CH    - Validate Miscellaneous 4                         *   CFT009
      *  SRM5CH    - Validate Miscellaneous 5                         *   CFT009
      *                                                               *
      *****************************************************************
      /EJECT
     E                    CPY@    1   1 80
      ** Array containing Copyright statement
      *
     E/COPY ZSRSRC,ZEDITZ1
     E/COPY FTCPYSRC,SRERRE
      ** Copy source for error subroutine
      *
     E                    ERCD       38  4               Codes
      ** Error codes array
      *
     E                    WRN@       40  1               Warning array
      ** Warning codes array
      *                                                                   CFT009
     E                    PTIERC     13 11                                CFT009
      **  Charge on each tier                                             CFT009
      *                                                                   CFT009
     E                    PTIERA     13 11                                CFT009
      **  Chargeable Amount on each tier                                  CFT009
      *                                                                   CFT009
      *
      /SPACE 3
     IACCNTABF
     I              PRFC                            ACPRFC
      *
     IACNUMABF
     I              PRFC                            ACPRFC
      *
     I/COPY FTCPYSRC,FT0010I001
      **  Input/output parameters for call to FT0010.
      *
     ID#DTA       DS                            256
      ** Calling parameter data structure for AOCCYCV0
      *
     I                                        1   3 D#FCCY
     I                                    P   4  110D#FAMT
      ** To currency amount
     I                                       12  14 D#TCCY
     I                                    P  15  220D#TAMT
      ** Rate and Mult/Div ind.
     I                                       23  23 I#MDIN
     I                                    P  24  368I#RATE
      ** Output Rate and Mult/Div ind.
     I                                       37  37 O#MDIN
     I                                    P  38  508O#RATE
      *
     IDSMTR       DS
      ** Define fields for message transalation
      *
     I                                        1 132 #MSDTA
     I                                       15  30 #MPREF
     I                                    P   1   20#MPART
     I                                      133 264 #MSTX1
     I#MSTX2      DS
     I                                        1 256 #MSTXA
     I                                      257 512 #MSTXB
      *
     I***ACKYDS*     DS                             18                                        CGL029
     IACKYDS      DS                             24                                           CGL029
      ** Data Structure for DB errors on ACCNT
      *
     I**********                              1   60KACNUM                                    CSD027
     I                                        1   6 KACNUM                                    CSD027
     I                                        1   6 KACNMA
     I                                        7   9 KACCCY
     I**********                             10  130KACCD                                     CGL029
     I**********                             10  13 KACCDA                                    CGL029
     I**********                             14  150KACSQ                                     CGL029
     I**********                             14  15 KACSQA                                    CGL029
     I**********                             16  18 KBRCA                                     CGL029
     I                                       10  190KACCD                                     CGL029
     I                                       10  19 KACCDA                                    CGL029
     I                                       20  210KACSQ                                     CGL029
     I                                       20  21 KACSQA                                    CGL029
     I                                       22  24 KBRCA                                     CGL029
      *
     ICLSWTK      DS
      ** Redefine SWIFT array as field for SETLL.
      *
     I                                        1  12 SW
      *
     I            DS
      ** Data structure for sender's charges validation
      *
     I                                        1  60 WSCHD
     I                                       13  60 WSCH48
     I                                       25  60 WSCH36
     I                                       37  60 WSCH24
     I                                       61  75 WSCCD
     I                                       64  75 WSCC12
     I                                       67  75 WSCC9
     I                                       70  75 WSCC6
      *
     IRUNDTA    E DSRUNDAT
      ** Data Area giving Installation Control Details
      *
     IDSFDY     E DSDSFDY
      ** Dummy Data Structures used by Access Programs.
      *
     IDSSDY     E DSDSSDY
      ** Dummy Data Structures used by Access Programs.
      ** DS for funds Transfer details                                    CFT009
     ISDFTFR    E DSSDFTFRPD                                              CFT009
      *                                                                   CFT009
      *
     ISDBANK    E DSSDBANKPD
      ** External data structures for Bank Details
      *
     ISDCUST    E DSSDCUSTPD
      ** External data structures for Customer Details
      *
     ISDNOST    E DSSDNOSTPD
      ** External data structures for Nostro Details
      *
     ISDCNST    E DSSDCNSTPD
      ** External data structures for Counterparty Nostro
      *
     ISDCURR    E DSSDCURRPD
      ** External data structures for Currency Details
      *
     ISDGELR    E DSSDGELRPD
      ** External data structures for General Ledger's details
     I              QQACCD                          ACCDQQ                                    CGL029
      *
     ISCSARD    E DSSCSARDPD
      ** External data structures for SAR's
      *
     IMEBICD    E DSMEBICDPD
      ** Calling parameter data structure for ME1400
      *                                                                                       219241
     ISDMGME    E DSSDMGMEPD                                                                  219241
      ** External Data structure for Message Management ICD.                                  219241
      *
      *                                                                   CFT009
      *  Transaction details file parameter for FT000980                  CFT009
      *                                                                   CFT009
     ITRNDET      DS                           3000                       CFT009
      *                                                                   CFT009
      *  Transaction details extension file parameter for FT000980        CFT009
      *                                                                   CFT009
     ITRNEXT      DS                           3000                       CFT009
     I/COPY WNCPYSRC,FT0349I001
      *                                                                   CFT009
      *  Outgoing Payments Details data structure                         CFT009
      *                                                                   CFT009
     IOTPYDS    E DSOTPAYDD                                               CFT009
     I              LCD                             TLCD                  CFT009
      *                                                                   CFT009
      *  Outgoing Payments Details Extension data structure               CFT009
      *                                                                   CFT009
     IOTPXDS    E DSOTPAYXPD                                              CFT009
     I              OPZONE                          ZZZONE                                    CGP001
      *                                                                   CFT009
      *  WORKING Outgoing Payments Details data structure                 CFT009
      *                                                                   CFT009
     IWOTPYD    E DSOTPAYDD                                               CFT009
     I              RECI                            MREC1                 CFT009
     I              PREF                            MPREF                 CFT009
     I              PYTP                            MPYTP                 CFT009
     I              PYST                            MPYST                 CFT009
     I              DSTT                            MDSTT                 CFT009
     I              DST1                            MDST1                 CFT009
     I              DST2                            MDST2                 CFT009
     I              DST3                            MDST3                 CFT009
     I              DST4                            MDST4                 CFT009
     I              SNCT                            MSNCT                 CFT009
     I              SNCO                            MSNCO                 CFT009
     I              ORBT                            MORBT                 CFT009
     I              ORBKQQ                          QQORBK                                    CGL029
     I              ORBK                            MORBK                 CFT009
     I              ORCT                            MORCT                 CFT009
     I              ORC1                            MORC1                 CFT009
     I              ORC2                            MORC2                 CFT009
     I              ORC3                            MORC3                 CFT009
     I              ORC4                            MORC4                 CFT009
     I              ORC5                            MORC5                                     CFT032
     I              ODMTT                           MODMTT                                    CFT032
     I              ODMTO                           MODMTO                                    CFT032
     I              SMAM                            MSMAM                 CFT009
     I              SMAMD                           MSMAMD                CFT009
     I              SMCY                            MSMCY                 CFT009
     I              MDIN                            MMDIN                 CFT009
     I              RATE                            MRATE                 CFT009
     I              RATED                           MRATED                CFT009
     I              OVRD                            MOVRD                 CFT009
     I              PYAM                            MPYAM                 CFT009
     I              PYAMD                           MPYAMD                CFT009
     I              PCCY                            MPCCY                 CFT009
     I              SLDT                            MSLDT                 CFT009
     I              SLDTD1                          MSLDT1                CFT009
     I              SLDTD2                          MSLDT2                CFT009
     I              SLDTD3                          MSLDT3                CFT009
     I              PVDT                            MPVDT                 CFT009
     I              PVDTD1                          MPVDT1                CFT009
     I              PVDTD2                          MPVDT2                CFT009
     I              PVDTD3                          MPVDT3                CFT009
     I              ADDC                            MADDC                 CFT009
     I              RPAY                            MRPAY                 CFT009
     I              PAYF                            MPAYF                 CFT009
     I              DYIM                            MDYIM                 CFT009
     I              FDAT                            MFDAT                 CFT009
     I              FDATD1                          MFDAT1                CFT009
     I              FDATD2                          MFDAT2                CFT009
     I              FDATD3                          MFDAT3                CFT009
     I              SWPC                            MSWPC                 CFT009
     I              STMT                            MSTMT                 CFT009
     I              SNMT                            MSNMT                 CFT009
     I              RCRT                            MRCRT                 CFT009
     I              RCO1                            MRCO1                 CFT009
     I              RCO2                            MRCO2                 CFT009
     I              RCO3                            MRCO3                 CFT009
     I              RCO4                            MRCO4                 CFT009
     I              RCO5                            MRCO5                 CFT009
     I              ACBT                            MACBT                 CFT009
     I              ACB1                            MACB1                 CFT009
     I              ACB2                            MACB2                 CFT009
     I              ACB3                            MACB3                 CFT009
     I              ACB4                            MACB4                 CFT009
     I              ACB5                            MACB5                 CFT009
     I              BNCT                            MBNCT                 CFT009
     I              BNC1                            MBNC1                 CFT009
     I              BNC2                            MBNC2                 CFT009
     I              BNC3                            MBNC3                 CFT009
     I              BNC4                            MBNC4                 CFT009
     I              BNC5                            MBNC5                 CFT009
     I              DTP1                            MDTP1                 CFT009
     I              DTP2                            MDTP2                 CFT009
     I              DTP3                            MDTP3                 CFT009
     I              DTP4                            MDTP4                 CFT009
     I              DTCH                            MDTCH                 CFT009
     I              BBI1                            MBBI1                 CFT009
     I              BBI2                            MBBI2                 CFT009
     I              BBI3                            MBBI3                 CFT009
     I              BBI4                            MBBI4                 CFT009
     I              BBI5                            MBBI5                 CFT009
     I              BBI6                            MBBI6                 CFT009
     I              DNBC                            MDNBC                 CFT009
     I              TRCT                            MTRCT                 CFT009
     I              TRCM                            MTRCM                 CFT009
     I              TRCMD                           MTRCMD                CFT009
     I              TXCH                            MTXCH                 CFT009
     I              TXCHD                           MTXCHD                CFT009
     I              CQCH                            MCQCH                 CFT009
     I              CQCHD                           MCQCHD                CFT009
     I              CSTA                            MCSTA                 CFT009
     I              CSTAD                           MCSTAD                CFT009
     I              SPCH                            MSPCH                 CFT009
     I              SPCHD                           MSPCHD                CFT009
     I              MSCH                            MMSCH                 CFT009
     I              MSCHD                           MMSCHD                CFT009
     I              CDRT                            MCDRT                 CFT009
     I              CDROQQ                          QQCDR1                                    CGL029
     I              CDRO                            MCDRO                 CFT009
     I              LCHT                            MLCHT                 CFT009
     I              LCD                             MLCD                  CFT009
     I              CHTP                            MCHTP                 CFT009
     I              AUP1                            MAUP1                 CFT009
     I              AUP2                            MAUP2                 CFT009
     I              AUIN                            MAUIN                 CFT009
     I              IACG                            MIACG                 CFT009
     I              SACG                            MSACG                 CFT009
     I              PACG                            MPACG                 CFT009
     I              SMSG                            MSMSG                 CFT009
     I              PMSG                            MPMSG                 CFT009
     I              OEDT                            MOEDT                 CFT009
     I              OEDTD1                          MOEDT1                CFT009
     I              OEDTD2                          MOEDT2                CFT009
     I              OEDTD3                          MOEDT3                CFT009
     I              NPDT                            MNPDT                 CFT009
     I              NPDTD1                          MNPDT1                CFT009
     I              NPDTD2                          MNPDT2                CFT009
     I              NPDTD3                          MNPDT3                CFT009
     I              PRBD                            MPRBD                 CFT009
     I              FAIN                            MFAIN                 CFT009
     I              ADIN                            MADIN                 CFT009
     I              CQIN                            MCQIN                 CFT009
     I              PRIN                            MPRIN                 CFT009
     I              MT100                           MMT100                CFT009
     I              MT202                           MMT202                CFT009
     I              TXIN                            MTXIN                 CFT009
     I              BAIN                            MBAIN                 CFT009
     I              ISIN                            MISIN                 CFT009
     I              MPYI                            MMPYI                 CFT009
     I              RLPR                            MPLPR                 CFT009
     I              INBT                            MINBT                 CFT009
     I              INB1                            MINB1                 CFT009
     I              INB2                            MINB2                 CFT009
     I              INB3                            MINB3                 CFT009
     I              INB4                            MINB4                 CFT009
     I              INB5                            MINB5                 CFT009
     I              CHAP                            MCHAP                 CFT009
     I              LVL1                            MLVL1                 CFT009
     I              LVL2                            MLVL2                 CFT009
     I              SBCQ                            MSBCQ                 CFT009
     I              PBCQ                            MPBCQ                 CFT009
     I              ODMT                            MODMT                 CFT009
     I              OPIN                            MOPIN                 CFT009
     I              OXPREF                          MXPREF                CFT009
     I              ZZ011                           MZZ011                CFT009
     I              AMTS                            MAMTS                 CFT009
     I              SVDT                            MSVDT                 CFT009
     I              NSTR                            MNSTR                 CFT009
     I              TSKS                            MTSKS                 CFT009
     I              INUSR1                          MINUS1                CFT009
     I              INUSR2                          MINUS2                CFT009
     I              DUMA1                           MDUMA1                CFT009
     I              DUMA2                           MDUMA2                CFT009
     I              DUMA3                           MDUMA3                CFT009
     I              DUMA4                           MDUMA4                CFT009
     I              DUMA5                           MDUMA5                CFT009
     I              DUMA6                           MDUMA6                CFT009
     I              BRCA                            MBRCA                 CFT009
     I              ORBR                            MORBR                 CFT009
     I              ORBB                            MORBB                 CFT009
     I              CDBR                            MCDBR                 CFT009
     I              MT202C                          MMT20C                CFT009
     I              BOKC                            MBOKC                 CFT009
     I              PRFC                            MPRFC                 CFT009
     I              OPORBT                          MOORBT                CFT009
     I              OPORB1                          MOORB1                CFT009
     I              OPORB2                          MOORB2                CFT009
     I              OPORB3                          MOORB3                CFT009
     I              OPORB4                          MOORB4                CFT009
     I              OPORB5                          MOORB5                CFT009
     I              OPMSGR                          MOMSGR                CFT009
     I              OPKPRT                          MOKPRT                CFT009
     I              OPVAT1                          MOVAT1                CFT009
     I              OPVAT2                          MOVAT2                CFT009
     I              OPVAT3                          MOVAT3                CFT009
     I              OPVAT4                          MOVAT4                CFT009
     I              OPVAT5                          MOVAT5                CFT009
     I              OPVAT6                          MOVAT6                CFT009
     I              OPVAT7                          MOVAT7                CFT009
     I              OPCHCM                          MOCHCM                CFT009
     I              OPVATT                          MOVATT                CFT009
     I              OPDUM7                          MODUM7                CFT009
     I              OPDUM8                          MODUM8                CFT009
     I              OPRPRF                          MORPRF                CFT009
     I              OPVATR                          MOVATR                CFT009
     I              FXMP                            MFXMP                 CFT009
     I              FXMD                            MFXMD                 CFT009
     I              MBSI                            MMBSI                 CFT009
     I              MSIG                            MMSIG                 CFT009
     I              MAMT                            MMAMT                 CFT009
     I              NDCY                            MNDCY                 CFT009
     I              NDAM                            MNDAM                 CFT009
     I              PDCY                            MPDCY                 CFT009
     I              PDAM                            MPDAM                 CFT009
     I              FRNT                            MFRNT                 CFT009
     I              REPA                            MREPA                 CFT009
     I              OPREPI                          MOREPI                CFT009
     I              FDLR                            MFDLR                 CFT009
     I              TMST                            XXTMST                                    CPK014
     I              OPRRAT                          OPRRTE                                    CDL049
     I              OPCDRC                          MCDRC                                     CFT120
      *                                                                                       CER030
     I              OPRTTY                          MORTTY                                    CER030
     I              OPEXT1                          MOEXT1                                    CER030
     I              OPEXT2                          MOEXT2                                    CER030
     I              OPEXT3                          MOEXT3                                    CER030
     I              OPEXT4                          MOEXT4                                    CER030
     I              OPEXT5                          MOEXT5                                    CER030
     I              OPEXT6                          MOEXT6                                    CER030
     I              OPEXC1                          MOEXC1                                    CER030
     I              OPEXC2                          MOEXC2                                    CER030
     I              OPEXC3                          MOEXC3                                    CER030
     I              OPEXC4                          MOEXC4                                    CER030
     I              OPEXC5                          MOEXC5                                    CER030
     I              OPEXC6                          MOEXC6                                    CER030
     I              DATE                            MDATE                                   MD033624
     I              SUSR                            MSUSR                                   MD033624
     I              SAUS                            MSAUS                                   MD033624
      *                                                                   CFT009
      *  WORKING Outgoing Payments Details Extension data structure       CFT009
      *                                                                   CFT009
     IWOTPXD    E DSOTPAYXPD                                              CFT009
      *                                                                   CFT009
     I              OPRECI                          WPRECI                CFT009
     I              OPPREF                          WPPREF                CFT009
     I              OPBJPR                          WPBJPR                CFT009
     I              OPAUTO                          WPAURO                CFT009
     I              OPSTPI                          WPSTPI                CFT009
     I              OPBANO                          WPBANO                CFT009
     I              OPRUSR                          WPRUSR                CFT009
     I              OPWSID                          WPWSID                CFT009
     I              OPRDAT                          WPRDAT                CFT009
     I              OPSETM                          WPSETM                CFT009
     I              OPBOCD                          WPBOCD                CFT009
     I              OPICD1                          WPICD1                CFT009
     I              OPICD2                          WPICD2                CFT009
     I              OPICD3                          WPICD3                CFT009
     I              OPICD4                          WPICD4                CFT009
     I              OPICD5                          WPICD5                CFT009
     I              OPTTCD                          WPTTCD                CFT009
     I              OPOEXR                          WPOEXR                CFT009
     I              OPTRIT                          WPTRIT                CFT009
     I              OPTRI1                          WPTRI1                CFT009
     I              OPTRI2                          WPTRI2                CFT009
     I              OPTRI3                          WPTRI3                CFT009
     I              OPTRI4                          WPTRI4                CFT009
     I              OPTRI5                          WPTRI5                CFT009
     I              OPSCH1                          WPSCH1                CFT009
     I              OPSCH2                          WPSCH2                CFT009
     I              OPSCH3                          WPSCH3                CFT009
     I              OPSCH4                          WPSCH4                CFT009
     I              OPSCH5                          WPSCH5                CFT009
     I              OPSCC1                          WPSCC1                CFT009
     I              OPSCC2                          WPSCC2                CFT009
     I              OPSCC3                          WPSCC3                CFT009
     I              OPSCC4                          WPSCC4                CFT009
     I              OPSCC5                          WPSCC5                CFT009
     I              OPSCLE                          WPSCLE                CFT009
     I              OPRCNW                          WPRCNW                CFT009
     I              OPRCCN                          WPRCCN                CFT009
     I              OPRCUS                          WPRCUS                CFT009
     I              OPRCRM                          WPRCRM                CFT009
     I              OPRBCQ                          WPRBCQ                CFT009
     I              OPRCSC                          WPRCSC                CFT009
     I              OPRCSQ                          WPRCSQ                CFT009
     I              OPRRP1                          WPRRP1                CFT009
     I              OPRRP2                          WPRRP                 CFT009
     I              OPRRP3                          WPRRP3                CFT009
     I              OPFRNT                          WPFRNT                CFT009
     I              OPREPA                          WPREPA                CFT009
     I              FXSRSC                          WFXSRS                CFT009
     I              OTPDOF                          WTPDOF                CFT009
     I              TLXCDE                          WTLXCD                CFT009
     I              CHQCHC                          WCHQCH                CFT009
     I              CACHCD                          WCACHC                CFT009
     I              SSTCCD                          WSSTCC                CFT009
     I              SPRCCD                          WSPRCC                CFT009
     I              MSCHC                           WMSCHC                CFT009
     I              MSCHC1                          WMSCH1                CFT009
     I              MSCHC2                          WMSCH2                CFT009
     I              MSCHC3                          WMSCH3                CFT009
     I              MSCHC4                          WMSCH4                CFT009
     I              MSCHC5                          WMSCH5                CFT009
     I              TFCCCD                          WTFCCD                CFT009
     I              FXCACC                          WFXCAC                CFT009
     I              VTSWSC                          WVTSWS                CFT009
     I              VMIC1                           WVMIC1                CFT009
     I              VMIC2                           WVMIC2                CFT009
     I              VMIC3                           WVMIC3                CFT009
     I              VMIC4                           WVMIC4                CFT009
     I              VMIC5                           WVMIC5                CFT009
     I              MISC01                          WMISC1                CFT009
     I              MISC02                          WMISC2                CFT009
     I              MISC03                          WMISC3                CFT009
     I              MISC04                          WMISC4                CFT009
     I              MISC05                          WMISC5                CFT009
     I              SWSCHG                          WSWSCH                CFT009
     I              DATNED                          WDATNE                CFT009
     I              DATNAO                          WDATNA                CFT009
     I              CUNFLA                          WCUNFL                CFT009
     I              OPCHRT                          WPCHRT                CFT009
     I              OPCHGC                          WPCHGC                CFT009
     I              MISCC1                          WISCC1                CFT009
     I              MISCC2                          WISCC2                CFT009
     I              MISCC3                          WISCC3                CFT009
     I              MISCC4                          WISCC4                CFT009
     I              MISCC5                          WISCC5                CFT009
     I              SWSCCC                          WWSCCC                CFT009
     I              OPTMST                          WWTMST                                    CPK014
     I              OPNWRK                          WWNWRK                                    CSW209
     I              OPMTPY                          WWMTPY                                    CSW209
     I              OPVALF                          WWVALF                                    CSW209
     I              OPOMVF                          WWOMVF                                    CSW209
     I              OPOCVF                          WWOCVF                                    CSW209
     I              OPCOCT                          WWCOCT                                    CSW209
     I              OPCOC1                          WWCOC1                                    CSW209
     I              OPCOC2                          WWCOC2                                    CSW209
     I              OPCOC3                          WWCOC3                                    CSW209
     I              OPCOC4                          WWCOC4                                    CSW209
     I              OPCOC5                          WWCOC5                                    CSW209
     I              OPCOBT                          WWCOBT                                    CSW209
     I              OPCOB1                          WWCOB1                                    CSW209
     I              OPCOB2                          WWCOB2                                    CSW209
     I              OPCOB3                          WWCOB3                                    CSW209
     I              OPCOB4                          WWCOB4                                    CSW209
     I              OPCOB5                          WWCOB5                                    CSW209
     I              OPCIBT                          WWCIBT                                    CSW209
     I              OPCIB1                          WWCIB1                                    CSW209
     I              OPCIB2                          WWCIB2                                    CSW209
     I              OPCIB3                          WWCIB3                                    CSW209
     I              OPCIB4                          WWCIB4                                    CSW209
     I              OPCIB5                          WWCIB5                                    CSW209
     I              OPCABT                          WWCABT                                    CSW209
     I              OPCAB1                          WWCAB1                                    CSW209
     I              OPCAB2                          WWCAB2                                    CSW209
     I              OPCAB3                          WWCAB3                                    CSW209
     I              OPCAB4                          WWCAB4                                    CSW209
     I              OPCAB5                          WWCAB5                                    CSW209
     I              OPCBCT                          WWCBCT                                    CSW209
     I              OPCBC1                          WWCBC1                                    CSW209
     I              OPCBC2                          WWCBC2                                    CSW209
     I              OPCBC3                          WWCBC3                                    CSW209
     I              OPCBC4                          WWCBC4                                    CSW209
     I              OPCBC5                          WWCBC5                                    CSW209
     I              OPCDP1                          WWCDP1                                    CSW209
     I              OPCDP2                          WWCDP2                                    CSW209
     I              OPCDP3                          WWCDP3                                    CSW209
     I              OPCDP4                          WWCDP4                                    CSW209
     I              OPCBB1                          WWCBB1                                    CSW209
     I              OPCBB2                          WWCBB2                                    CSW209
     I              OPCBB3                          WWCBB3                                    CSW209
     I              OPCBB4                          WWCBB4                                    CSW209
     I              OPCBB5                          WWCBB5                                    CSW209
     I              OPCBB6                          WWCBB6                                    CSW209
     I              OPCICY                          WWCICY                                    CSW209
     I              OPCIAM                          WWCIAM                                    CSW209
     I              OPOCB1                          WWOCB1                                    CSW209
     I              OPOCB2                          WWOCB2                                    CSW209
     I              OPOCB3                          WWOCB3                                    CSW209
     I              OPOCB4                          WWOCB4                                    CSW209
     I              OPOCB5                          WWOCB5                                    CSW209
     I              OPOCB6                          WWOCB6                                    CSW209
      *                                                                   CFT009
      *                                                                   CFT009
     I/COPY FTCPYSRC,SFTVALDI
     I/COPY FTCPYSRC,SFTADDRI
     I/COPY FTCPYSRC,SRERRI
      *
     I/COPY FTCPYSRC,SFT0345S7
     I/COPY FTCPYSRC,SFT0345F7
     I/COPY FTCPYSRC,SFT0345I7
      *
     I/COPY FTCPYSRC,SFTVALCS
      /EJECT
      *
     C/TITLE Main Processing
      *================================================================
      *  P R O G R A M   S T A R T                                    *
      *================================================================
      *
      ** Setup subroutine stack name
      *
     C                     ADD  1         Q
     C                     MOVEL'MAIN'    @STK,Q
      *
      ** Define entry parameters
      *
     C           *ENTRY    PLIST
     C                     PARM           W0RTN   7
     C                     PARM           W0ACT   8
     C                     PARM           S7DATA
     C                     PARM           V#DATA
     C                     PARM           F7DATA
     C                     PARM           E#DATA
     C                     PARM           C#DATA
     C                     PARM           I7DATA
     C                     PARM           STP     1                       CFT009
      *
      ** Perform Initialisation.
      *
     C                     EXSR SRINIT
      *
     C           *IN50     IFEQ *OFF
     C                     EXSR SRRTXT
     C                     ENDIF
      *
      ** Set up primary reference for errors
      *
     C                     MOVELS7DATA    W0PREF
      *
      ** Determine the mode of processing and execute subroutine :
      ** Action Code : *VALID
      ** Called from FT0355:
      ** To validate all input fields on the detail screen.
      ** Once verified, control returns to the calling program where
      ** the appropriate error indicators are set on and processing
      ** continues.
      *
     C           W0ACT     CASEQ'*VALID  'SRPROC
     C                     CAS            SRACT
     C                     ENDCS
      *
      ** Unwind subroutine stack name
      *
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
      ** Return to calling program
      *
     C                     RETRN
      /EJECT
      *================================================================
      *  P R O G R A M   E N D                                        *
      *================================================================
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRINIT - Subroutine to do Program Initialisation.            *
      *                                                               *
      *  Called By: Main Processing                                   *
      *                                                               *
      *  Calls:                                                       *
      *  AOBANKR0  - Access Object to get Bank Details.               *
      *  AOGELRR0  - Access Object to get General Ledger Details.     *
      *  AOCURRR0  - Access Object to get Currency Details.           *
      *  AOSARDR0  - Access Object to get Switchable Feautre Details. *
      *  MEC1150   - Extracts Message Information.                    *
      *                                                               *
      *****************************************************************
      *
     C           SRINIT    BEGSR                           *** SRINIT ***
      *
      ** Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SRINIT'  @STK,Q
      *
      ** Set up copyright parameter
      *
     C                     MOVEACPY@      CPY2@  80
      *
     C           *NAMVAR   DEFN RUNDAT    RUNDTA
     C                     IN   RUNDTA
     C                     MOVE AGMRDT    WUMRDT  7        Midas Run date
     C                     MOVE AGRDNB    WURDNB  50       Run day number
     C                     MOVE AGSUC     WUSUC   1        Set up complete
     C                     MOVE AGDFF     WUDFF   1        Date Format
     C                     MOVE AGMBIN    WUMBIN  1        Multi Branched
      *
      ** Call Access Program for Bank Details - Title, Run Date and
      ** Run Day Number.
      *
     C                     CALL 'AOBANKR0'
     C                     PARM '*MSG   ' WRTCD   7
     C                     PARM '*FIRST ' WOPTN   7
     C           SDBANK    PARM SDBANK    DSFDY
      *
      ** Handle Database Error.
      *
     C           WRTCD     IFNE *BLANKS
     C                     MOVE 'SDBANKPD'W0FILE
     C                     MOVELWOPTN     W0KEY
     C                     Z-ADD1         W0ERNB
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     ENDIF
      *
      ** Access Euro Currency Code from General Ledger ICD details.
      *
     C**********           CALL 'AOGELRR0'                                                    CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM *BLANKS   WRTCD
     C                     PARM '*FIRST ' WOPTN
     C********** SDGELR    PARM SDGELR    DSFDY                                               CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
      *
      ** Database error
      *
     C           WRTCD     IFNE *BLANKS
     C                     MOVEL'SDGELRPD'W0FILE
     C                     MOVEL'*CALL'   W0KEY
     C                     Z-ADD2         W0ERNB
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     ENDIF
      *
      ** Access Currency details for Settlement Currency
      *
     C                     CALL 'AOCURRR0'
     C                     PARM *BLANKS   WRTCD
     C                     PARM '*KEY   ' WOPTN
     C                     PARM V#SMCY    WAJCD   3
     C           SDCURR    PARM SDCURR    DSSDY
      *
      ** Database error
      *
     C           WRTCD     IFNE *BLANK
     C                     MOVEL'SDCURRPD'W0FILE
     C                     MOVELV#SMCY    W0KEY
     C                     Z-ADD3         W0ERNB
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     ENDIF
      *
      ** Save In Ccy Indicator for Settlement Currency as #INCYS and
      ** save Transition Start Date for Settlement Currency as #TPSDS.
      *
     C                     MOVE A6INCY    #INCYS  1
     C                     Z-ADDA6TPSD    #TPSDS  50
      *
      ** Access Currency details for Pay Currency
      *
     C                     CALL 'AOCURRR0'
     C                     PARM *BLANKS   WRTCD
     C                     PARM '*KEY   ' WOPTN
     C                     PARM V#PCCY    WAJCD
     C           SDCURR    PARM SDCURR    DSSDY
      *
      ** Database error
      *
     C           WRTCD     IFNE *BLANK
     C                     MOVEL'SDCURRPD'W0FILE
     C                     MOVELV#PCCY    W0KEY
     C                     Z-ADD4         W0ERNB
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     ENDIF
      *
      ** Save In Ccy Indicator for Pay Currency as #INCYP and
      ** save Transition Start Date for Pay Currency as #TPSDP and
      ** save number of decimal places for Pay Currency as #PNBDP and
      *
     C                     MOVE A6INCY    #INCYP  1
     C                     Z-ADDA6TPSD    #TPSDP  50
     C                     Z-ADDA6NBDP    #PNBDP  10
      *
      ** Determine if SAR S01494 is installed.
      *
     C                     CALL 'AOSARDR0'
     C                     PARM *BLANKS   WRTCD   7
     C                     PARM '*VERIFY 'WOPTN   7
     C                     PARM 'S01494'  WSARD   6
     C           SCSARD    PARM SCSARD    DSFDY
      *
     C           WRTCD     IFNE *BLANKS
     C           WRTCD     ANDNE'*NRF   '
     C                     MOVEL'SCSARDPD'W0FILE
     C                     Z-ADD5         W0ERNB
     C                     MOVEL'S01494'  W0KEY
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     ENDIF
      *
     C           WRTCD     IFEQ *BLANKS
     C                     MOVE 'Y'       S01494  1
     C                     ELSE
     C                     MOVE 'N'       S01494
     C                     ENDIF
      *
      ** Determine if SAR CEU006 is installed.
      *
     C                     CALL 'AOSARDR0'
     C                     PARM *BLANKS   WRTCD
     C                     PARM '*VERIFY 'WOPTN
     C                     PARM 'CEU006'  WSARD
     C           SCSARD    PARM SCSARD    DSFDY
      *
     C           WRTCD     IFNE *BLANKS
     C           WRTCD     ANDNE'*NRF   '
     C                     MOVEL'SCSARDPD'W0FILE
     C                     Z-ADD6         W0ERNB
     C                     MOVEL'CEU006'  W0KEY
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     ENDIF
      *
     C           WRTCD     IFEQ *BLANKS
     C                     MOVE 'Y'       CEU006  1
     C                     ELSE
     C                     MOVE 'N'       CEU006
     C                     ENDIF
      *
      ** Determine if SAR CFT004 is installed.
      *
     C                     CALL 'AOSARDR0'
     C                     PARM *BLANKS   WRTCD
     C                     PARM '*VERIFY 'WOPTN
     C                     PARM 'CFT004'  WSARD
     C           SCSARD    PARM SCSARD    DSFDY
      *
     C           WRTCD     IFNE *BLANKS
     C           WRTCD     ANDNE'*NRF   '
     C                     MOVEL'SCSARDPD'W0FILE
     C                     Z-ADD7         W0ERNB
     C                     MOVEL'CFT004'  W0KEY
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     ENDIF
      *
     C           WRTCD     IFEQ *BLANKS
     C                     MOVE 'Y'       CFT004  1
     C                     ELSE
     C                     MOVE 'N'       CFT004
     C                     ENDIF
      *
      ** Determine if SAR CFT014 is installed.
      *
     C                     CALL 'AOSARDR0'
     C                     PARM *BLANKS   WRTCD
     C                     PARM '*VERIFY 'WOPTN
     C                     PARM 'CFT014'  WSARD
     C           SCSARD    PARM SCSARD    DSFDY
      *
     C           WRTCD     IFNE *BLANKS
     C           WRTCD     ANDNE'*NRF   '
     C                     MOVEL'SCSARDPD'W0FILE
     C                     Z-ADD8         W0ERNB
     C                     MOVEL'CFT014'  W0KEY
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     ENDIF
      *
     C           WRTCD     IFEQ *BLANKS
     C                     MOVE 'Y'       CFT014  1
     C                     ELSE
     C                     MOVE 'N'       CFT014
     C                     ENDIF
      *
     C                     CALL 'AOSARDR0'                                CFT009
     C                     PARM *BLANKS   WRTCD                           CFT009
     C                     PARM '*VERIFY 'WOPTN                           CFT009
     C                     PARM 'CFT009'  WSARD                           CFT009
     C           SCSARD    PARM SCSARD    DSFDY                           CFT009
      *                                                                   CFT009
     C           WRTCD     IFNE *BLANKS                                   CFT009
     C           WRTCD     ANDNE'*NRF   '                                 CFT009
     C                     MOVEL'SCSARDPD'W0FILE                          CFT009
     C                     Z-ADD22        W0ERNB                          CFT009
     C                     MOVEL'CFT009'  W0KEY                           CFT009
     C                     MOVEL'MEM5003' W0MSGD                          CFT009
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT009
     C                     EXSR SRERR                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           WRTCD     IFEQ *BLANKS                                   CFT009
     C                     MOVE 'Y'       CFT009  1                       CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       CFT009                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     CALL 'AOSARDR0'                                CFT009
     C                     PARM *BLANKS   WRTCD                           CFT009
     C                     PARM '*VERIFY 'WOPTN                           CFT009
     C                     PARM 'CFT010'  WSARD                           CFT009
     C           SCSARD    PARM SCSARD    DSFDY                           CFT009
      *                                                                   CFT009
     C           WRTCD     IFNE *BLANKS                                   CFT009
     C           WRTCD     ANDNE'*NRF   '                                 CFT009
     C                     MOVEL'SCSARDPD'W0FILE                          CFT009
     C                     Z-ADD23        W0ERNB                          CFT009
     C                     MOVEL'CFT010'  W0KEY                           CFT009
     C                     MOVEL'MEM5003' W0MSGD                          CFT009
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT009
     C                     EXSR SRERR                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           WRTCD     IFEQ *BLANKS                                   CFT009
     C                     MOVE 'Y'       CFT010  1                       CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       CFT010                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                                       CFT017
      ** Access SAR details file to determine if CFT017 is switched on.                       CFT017
      *                                                                                       CFT017
     C                     CALL 'AOSARDR0'                                                    CFT017
     C                     PARM *BLANKS   WRTCD                                               CFT017
     C                     PARM '*VERIFY' WOPTN                                               CFT017
     C                     PARM 'CFT017'  WSARD                                               CFT017
     C           SCSARD    PARM SCSARD    DSFDY                                               CFT017
      *                                                                                       CFT017
     C           WRTCD     IFEQ *BLANKS                                                       CFT017
     C                     MOVE 'Y'       CFT017  1                                           CFT017
     C                     ELSE                                                               CFT017
     C                     MOVE 'N'       CFT017                                              CFT017
     C                     ENDIF                                                              CFT017
      *                                                                                       219241
      ** If CFT014 is installed, read SDMGMEPD                                                219241
      *                                                                                       219241
     C           CFT014    IFEQ 'Y'                                                           219241
      *                                                                                       219241
     C                     CALL 'AOMGMER1'                                                    219241
     C                     PARM *BLANKS   WRTCD                                               219241
     C                     PARM '*FIRST'  WOPTN                                               219241
     C           SDMGME    PARM SDMGME    DSSDY                                               219241
      *                                                                                       219241
     C           WRTCD     IFNE *BLANKS                                                       219241
     C                     MOVEL'SDMGMEPD'W0FILE                                              219241
     C                     MOVELWOPTN     W0KEY                                               219241
     C                     Z-ADD28        W0ERNB                                              219241
     C                     MOVEL'MEM5003' W0MSGD                                              219241
     C                     MOVEL'MIDAS  ' W0MSGF                                              219241
     C                     EXSR SRERR                                                         219241
     C                     ENDIF                                                              219241
      *                                                                                       219241
     C                     ENDIF                                                              219241
      *                                                                   CFT009
      ** Funds Transfer Standing Data                                     CFT009
      *                                                                   CFT009
     C                     CALL 'AOFTFRR0'                                CFT009
     C                     PARM '*DBERR ' @RTCD   7                       CFT009
     C                     PARM '*FIRST ' @OPTN   7                       CFT009
     C           SDFTFR    PARM SDFTFR    DSFDY                           CFT009
      *                                                                   CFT009
      ** If CFT009 on and STP, clear working DS                           CFT009
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
     C           STP       ANDEQ'S'                                       CFT009
     C                     CLEARWOTPYD                                    CFT009
     C                     CLEARWOTPXD                                    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           S7PREF    CHAINOTPAY                90                   CFT009
     C           S7PREF    CHAINOTPAYXL2             90                   CFT009
      *                                                                   CFT009
      * Save initial charge codes                                         CFT009
     C                     EXSR SRCCCY                                    CFT009
     C                     EXSR CCYCNV                                    CFT009
      *                                                                   CFT009
      * Transfer Commission Charge Code                                   CFT009
     C           *LIKE     DEFN S7CDE1    SVCDE1                          CFT009
     C                     MOVE S7CDE1    SVCDE1                          CFT009
      *                                                                   CFT009
      * Transfer commission                                               CFT009
     C           *LIKE     DEFN F7TRCM    DFTTRM                          CFT009
     C                     MOVELSVCDE1    CHGCDE                          CFT009
     C           CHGCDE    IFNE *BLANKS                                   CFT009
     C                     EXSR RECALC                                    CFT009
     C                     Z-ADDTOTCHG    INPAMT                          CFT009
      *                                                                   CFT009
      ** Convert file default using screen ccy for comparison of          CFT009
      ** entered field and defaulted                                      CFT009
      *                                                                   CFT009
      ** Set up charge amount and currencies for call to FT000985.        CFT009
      *                                                                   CFT009
     C                     Z-ADDINPAMT    CHGA85                          CFT009
     C                     MOVELPCCY      PCCY85                          CFT009
     C                     MOVELSMCY      SCCY85                          CFT009
     C                     MOVELOPCHGC    CCCY85                          CFT009
     C                     MOVELLEVIED    LCCY85                          CFT009
     C                     MOVELCVTRAT    RATE85                          CFT009
     C                     Z-ADD0         LCHG                            CFT009
     C                     MOVEL*BLANKS   LCHGF     P                     CFT009
      *                                                                   CFT009
     C                     CALL 'FT000985'                                CFT009
     C                     PARM           RET985 10                       CFT009
     C                     PARM           CHGA85 130                      CFT009
     C                     PARM           PCCY85  3                       CFT009
     C                     PARM           SCCY85  3                       CFT009
     C                     PARM           CCCY85  3                       CFT009
     C                     PARM           LCCY85  3                       CFT009
     C                     PARM           RATE85 138                      CFT009
     C                     PARM           LCHG   130                      CFT009
     C                     PARM           LCHGF  16                       CFT009
      *                                                                   CFT009
      ** Convert file default using screen ccy for comparison of          CFT009
      ** entered field and defaulted                                      CFT009
      *                                                                   CFT009
     C                     Z-ADDLCHG      OUTAMT                          CFT009
     C                     Z-ADDLCHG      DFTTRM                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         DFTTRM                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      * FX/Change Charge Code                                             CFT009
     C           *LIKE     DEFN S7CDE2    SVCDE2                          CFT009
     C                     MOVE S7CDE2    SVCDE2                          CFT009
     C           *LIKE     DEFN F7CHCM    DFTFXC                          CFT009
     C                     MOVELSVCDE2    CHGCDE                          CFT009
     C           CHGCDE    IFNE *BLANKS                                   CFT009
     C                     EXSR RECALC                                    CFT009
     C                     Z-ADDTOTCHG    INPAMT                          CFT009
      *                                                                   CFT009
      ** Convert file default using screen ccy for comparison of          CFT009
      ** entered field and defaulted                                      CFT009
      *                                                                   CFT009
      ** Set up charge amount and currencies for call to FT000985.        CFT009
      *                                                                   CFT009
     C                     Z-ADDINPAMT    CHGA85                          CFT009
     C                     MOVELPCCY      PCCY85                          CFT009
     C                     MOVELSMCY      SCCY85                          CFT009
     C                     MOVELOPCHGC    CCCY85                          CFT009
     C                     MOVELLEVIED    LCCY85                          CFT009
     C                     MOVELCVTRAT    RATE85                          CFT009
     C                     Z-ADD0         LCHG                            CFT009
     C                     MOVEL*BLANKS   LCHGF     P                     CFT009
      *                                                                   CFT009
     C                     CALL 'FT000985'                                CFT009
     C                     PARM           RET985 10                       CFT009
     C                     PARM           CHGA85 130                      CFT009
     C                     PARM           PCCY85  3                       CFT009
     C                     PARM           SCCY85  3                       CFT009
     C                     PARM           CCCY85  3                       CFT009
     C                     PARM           LCCY85  3                       CFT009
     C                     PARM           RATE85 138                      CFT009
     C                     PARM           LCHG   130                      CFT009
     C                     PARM           LCHGF  16                       CFT009
      *                                                                   CFT009
      ** Convert file default using screen ccy for comparison of          CFT009
      ** entered field and defaulted                                      CFT009
      *                                                                   CFT009
     C                     Z-ADDLCHG      OUTAMT                          CFT009
     C                     Z-ADDLCHG      DFTFXC                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         DFTFXC                          CFT009
     C                     ENDIF                                          CFT009
      * Telex Charge Code                                                 CFT009
     C           *LIKE     DEFN S7CDE3    SVCDE3                          CFT009
     C                     MOVE S7CDE3    SVCDE3                          CFT009
     C           *LIKE     DEFN F7TRCM    DFTTLX                          CFT009
     C                     MOVELSVCDE3    CHGCDE                          CFT009
     C           CHGCDE    IFNE *BLANKS                                   CFT009
     C                     EXSR RECALC                                    CFT009
     C                     Z-ADDTOTCHG    INPAMT                          CFT009
      *                                                                   CFT009
      ** Convert file default using screen ccy for comparison of          CFT009
      ** entered field and defaulted                                      CFT009
      *                                                                   CFT009
      ** Set up charge amount and currencies for call to FT000985.        CFT009
      *                                                                   CFT009
     C                     Z-ADDINPAMT    CHGA85                          CFT009
     C                     MOVELPCCY      PCCY85                          CFT009
     C                     MOVELSMCY      SCCY85                          CFT009
     C                     MOVELOPCHGC    CCCY85                          CFT009
     C                     MOVELLEVIED    LCCY85                          CFT009
     C                     MOVELCVTRAT    RATE85                          CFT009
     C                     Z-ADD0         LCHG                            CFT009
     C                     MOVEL*BLANKS   LCHGF     P                     CFT009
      *                                                                   CFT009
     C                     CALL 'FT000985'                                CFT009
     C                     PARM           RET985 10                       CFT009
     C                     PARM           CHGA85 130                      CFT009
     C                     PARM           PCCY85  3                       CFT009
     C                     PARM           SCCY85  3                       CFT009
     C                     PARM           CCCY85  3                       CFT009
     C                     PARM           LCCY85  3                       CFT009
     C                     PARM           RATE85 138                      CFT009
     C                     PARM           LCHG   130                      CFT009
     C                     PARM           LCHGF  16                       CFT009
      *                                                                   CFT009
      ** Set up amounts                                                   CFT009
      *                                                                   CFT009
     C                     Z-ADDLCHG      OUTAMT                          CFT009
     C                     Z-ADDLCHG      DFTTLX                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         DFTTLX                          CFT009
     C                     ENDIF                                          CFT009
      * Cheque Charge Code                                                CFT009
     C           *LIKE     DEFN S7CDE4    SVCDE4                          CFT009
     C                     MOVE S7CDE4    SVCDE4                          CFT009
     C           *LIKE     DEFN F7TRCM    DFTCQC                          CFT009
     C                     MOVELSVCDE4    CHGCDE                          CFT009
     C           CHGCDE    IFNE *BLANKS                                   CFT009
     C                     EXSR RECALC                                    CFT009
     C                     Z-ADDTOTCHG    INPAMT                          CFT009
      *                                                                   CFT009
      ** Convert file default using screen ccy for comparison of          CFT009
      ** entered field and defaulted                                      CFT009
      *                                                                   CFT009
      ** Set up charge amount and currencies for call to FT000985.        CFT009
      *                                                                   CFT009
     C                     Z-ADDINPAMT    CHGA85                          CFT009
     C                     MOVELPCCY      PCCY85                          CFT009
     C                     MOVELSMCY      SCCY85                          CFT009
     C                     MOVELOPCHGC    CCCY85                          CFT009
     C                     MOVELLEVIED    LCCY85                          CFT009
     C                     MOVELCVTRAT    RATE85                          CFT009
     C                     Z-ADD0         LCHG                            CFT009
     C                     MOVEL*BLANKS   LCHGF     P                     CFT009
      *                                                                   CFT009
     C                     CALL 'FT000985'                                CFT009
     C                     PARM           RET985 10                       CFT009
     C                     PARM           CHGA85 130                      CFT009
     C                     PARM           PCCY85  3                       CFT009
     C                     PARM           SCCY85  3                       CFT009
     C                     PARM           CCCY85  3                       CFT009
     C                     PARM           LCCY85  3                       CFT009
     C                     PARM           RATE85 138                      CFT009
     C                     PARM           LCHG   130                      CFT009
     C                     PARM           LCHGF  16                       CFT009
      *                                                                   CFT009
      ** Set up amounts                                                   CFT009
      *                                                                   CFT009
     C                     Z-ADDLCHG      OUTAMT                          CFT009
     C                     Z-ADDLCHG      DFTCQC                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         DFTCQC                          CFT009
     C                     ENDIF                                          CFT009
      * Costs Abroad Charge Code                                          CFT009
     C           *LIKE     DEFN S7CDE5    SVCDE5                          CFT009
     C                     MOVE S7CDE5    SVCDE5                          CFT009
     C           *LIKE     DEFN F7TRCM    DFTCSA                          CFT009
     C                     MOVELSVCDE5    CHGCDE                          CFT009
     C           CHGCDE    IFNE *BLANKS                                   CFT009
     C                     EXSR RECALC                                    CFT009
     C                     Z-ADDTOTCHG    INPAMT                          CFT009
      *                                                                   CFT009
      ** Convert file default using screen ccy for comparison of          CFT009
      ** entered field and defaulted                                      CFT009
      *                                                                   CFT009
      ** Set up charge amount and currencies for call to FT000985.        CFT009
      *                                                                   CFT009
     C                     Z-ADDINPAMT    CHGA85                          CFT009
     C                     MOVELPCCY      PCCY85                          CFT009
     C                     MOVELSMCY      SCCY85                          CFT009
     C                     MOVELOPCHGC    CCCY85                          CFT009
     C                     MOVELLEVIED    LCCY85                          CFT009
     C                     MOVELCVTRAT    RATE85                          CFT009
     C                     Z-ADD0         LCHG                            CFT009
     C                     MOVEL*BLANKS   LCHGF     P                     CFT009
      *                                                                   CFT009
     C                     CALL 'FT000985'                                CFT009
     C                     PARM           RET985 10                       CFT009
     C                     PARM           CHGA85 130                      CFT009
     C                     PARM           PCCY85  3                       CFT009
     C                     PARM           SCCY85  3                       CFT009
     C                     PARM           CCCY85  3                       CFT009
     C                     PARM           LCCY85  3                       CFT009
     C                     PARM           RATE85 138                      CFT009
     C                     PARM           LCHG   130                      CFT009
     C                     PARM           LCHGF  16                       CFT009
      *                                                                   CFT009
      ** Set up amounts                                                   CFT009
      *                                                                   CFT009
     C                     Z-ADDLCHG      OUTAMT                          CFT009
     C                     Z-ADDLCHG      DFTCSA                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         DFTCSA                          CFT009
     C                     ENDIF                                          CFT009
      * SWIFT Standard Charge Code                                        CFT009
     C           *LIKE     DEFN S7CDE6    SVCDE6                          CFT009
     C                     MOVE S7CDE6    SVCDE6                          CFT009
     C           *LIKE     DEFN F7TRCM    DFTSWS                          CFT009
     C                     MOVELSVCDE6    CHGCDE                          CFT009
     C           CHGCDE    IFNE *BLANKS                                   CFT009
     C                     EXSR RECALC                                    CFT009
     C                     Z-ADDTOTCHG    INPAMT                          CFT009
      *                                                                   CFT009
      ** Convert file default using screen ccy for comparison of          CFT009
      ** entered field and defaulted                                      CFT009
      *                                                                   CFT009
      ** Set up charge amount and currencies for call to FT000985.        CFT009
      *                                                                   CFT009
     C                     Z-ADDINPAMT    CHGA85                          CFT009
     C                     MOVELPCCY      PCCY85                          CFT009
     C                     MOVELSMCY      SCCY85                          CFT009
     C                     MOVELOPCHGC    CCCY85                          CFT009
     C                     MOVELLEVIED    LCCY85                          CFT009
     C                     MOVELCVTRAT    RATE85                          CFT009
     C                     Z-ADD0         LCHG                            CFT009
     C                     MOVEL*BLANKS   LCHGF     P                     CFT009
      *                                                                   CFT009
     C                     CALL 'FT000985'                                CFT009
     C                     PARM           RET985 10                       CFT009
     C                     PARM           CHGA85 130                      CFT009
     C                     PARM           PCCY85  3                       CFT009
     C                     PARM           SCCY85  3                       CFT009
     C                     PARM           CCCY85  3                       CFT009
     C                     PARM           LCCY85  3                       CFT009
     C                     PARM           RATE85 138                      CFT009
     C                     PARM           LCHG   130                      CFT009
     C                     PARM           LCHGF  16                       CFT009
      *                                                                   CFT009
      ** Set up amounts                                                   CFT009
      *                                                                   CFT009
     C                     Z-ADDLCHG      OUTAMT                          CFT009
     C                     Z-ADDLCHG      DFTSWS                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         DFTSWS                          CFT009
     C                     ENDIF                                          CFT009
      * SWIFT Priority Charge Code                                        CFT009
     C           *LIKE     DEFN S7CDE7    SVCDE7                          CFT009
     C                     MOVE S7CDE7    SVCDE7                          CFT009
     C           *LIKE     DEFN F7TRCM    DFTSWP                          CFT009
     C                     MOVELSVCDE7    CHGCDE                          CFT009
     C           CHGCDE    IFNE *BLANKS                                   CFT009
     C                     EXSR RECALC                                    CFT009
     C                     Z-ADDTOTCHG    INPAMT                          CFT009
      *                                                                   CFT009
      ** Convert file default using screen ccy for comparison of          CFT009
      ** entered field and defaulted                                      CFT009
      *                                                                   CFT009
      ** Set up charge amount and currencies for call to FT000985.        CFT009
      *                                                                   CFT009
     C                     Z-ADDINPAMT    CHGA85                          CFT009
     C                     MOVELPCCY      PCCY85                          CFT009
     C                     MOVELSMCY      SCCY85                          CFT009
     C                     MOVELOPCHGC    CCCY85                          CFT009
     C                     MOVELLEVIED    LCCY85                          CFT009
     C                     MOVELCVTRAT    RATE85                          CFT009
     C                     Z-ADD0         LCHG                            CFT009
     C                     MOVEL*BLANKS   LCHGF     P                     CFT009
      *                                                                   CFT009
     C                     CALL 'FT000985'                                CFT009
     C                     PARM           RET985 10                       CFT009
     C                     PARM           CHGA85 130                      CFT009
     C                     PARM           PCCY85  3                       CFT009
     C                     PARM           SCCY85  3                       CFT009
     C                     PARM           CCCY85  3                       CFT009
     C                     PARM           LCCY85  3                       CFT009
     C                     PARM           RATE85 138                      CFT009
     C                     PARM           LCHG   130                      CFT009
     C                     PARM           LCHGF  16                       CFT009
      *                                                                   CFT009
      ** Set up amounts                                                   CFT009
      *                                                                   CFT009
     C                     Z-ADDLCHG      OUTAMT                          CFT009
     C                     Z-ADDLCHG      DFTSWP                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         DFTSWP                          CFT009
     C                     ENDIF                                          CFT009
      * Miscellaneous Charge Code                                         CFT009
     C           *LIKE     DEFN S7CDE8    SVCDE8                          CFT009
     C                     MOVE S7CDE8    SVCDE8                          CFT009
     C           *LIKE     DEFN F7TRCM    DFTMSC                          CFT009
     C                     MOVELSVCDE8    CHGCDE                          CFT009
     C           CHGCDE    IFNE *BLANKS                                   CFT009
     C                     EXSR RECALC                                    CFT009
     C                     Z-ADDTOTCHG    INPAMT                          CFT009
      *                                                                   CFT009
      ** Convert file default using screen ccy for comparison of          CFT009
      ** entered field and defaulted                                      CFT009
      *                                                                   CFT009
      ** Set up charge amount and currencies for call to FT000985.        CFT009
      *                                                                   CFT009
     C                     Z-ADDINPAMT    CHGA85                          CFT009
     C                     MOVELPCCY      PCCY85                          CFT009
     C                     MOVELSMCY      SCCY85                          CFT009
     C                     MOVELOPCHGC    CCCY85                          CFT009
     C                     MOVELLEVIED    LCCY85                          CFT009
     C                     MOVELCVTRAT    RATE85                          CFT009
     C                     Z-ADD0         LCHG                            CFT009
     C                     MOVEL*BLANKS   LCHGF     P                     CFT009
      *                                                                   CFT009
     C                     CALL 'FT000985'                                CFT009
     C                     PARM           RET985 10                       CFT009
     C                     PARM           CHGA85 130                      CFT009
     C                     PARM           PCCY85  3                       CFT009
     C                     PARM           SCCY85  3                       CFT009
     C                     PARM           CCCY85  3                       CFT009
     C                     PARM           LCCY85  3                       CFT009
     C                     PARM           RATE85 138                      CFT009
     C                     PARM           LCHG   130                      CFT009
     C                     PARM           LCHGF  16                       CFT009
      *                                                                   CFT009
      ** Set up amounts                                                   CFT009
      *                                                                   CFT009
     C                     Z-ADDLCHG      OUTAMT                          CFT009
     C                     Z-ADDLCHG      DFTMSC                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         DFTMSC                          CFT009
     C                     ENDIF                                          CFT009
      * Miscellaneous Charge Code 1                                       CFT009
     C           *LIKE     DEFN S7CDE9    SVCDE9                          CFT009
     C                     MOVE S7CDE9    SVCDE9                          CFT009
     C           *LIKE     DEFN F7TRCM    DFTMS1                          CFT009
     C                     MOVELSVCDE9    CHGCDE                          CFT009
     C           CHGCDE    IFNE *BLANKS                                   CFT009
     C                     EXSR RECALC                                    CFT009
     C                     Z-ADDTOTCHG    INPAMT                          CFT009
      *                                                                   CFT009
      ** Convert file default using screen ccy for comparison of          CFT009
      ** entered field and defaulted                                      CFT009
      *                                                                   CFT009
      ** Set up charge amount and currencies for call to FT000985.        CFT009
      *                                                                   CFT009
     C                     Z-ADDINPAMT    CHGA85                          CFT009
     C                     MOVELPCCY      PCCY85                          CFT009
     C                     MOVELSMCY      SCCY85                          CFT009
     C                     MOVELOPCHGC    CCCY85                          CFT009
     C                     MOVELLEVIED    LCCY85                          CFT009
     C                     MOVELCVTRAT    RATE85                          CFT009
     C                     Z-ADD0         LCHG                            CFT009
     C                     MOVEL*BLANKS   LCHGF     P                     CFT009
      *                                                                   CFT009
     C                     CALL 'FT000985'                                CFT009
     C                     PARM           RET985 10                       CFT009
     C                     PARM           CHGA85 130                      CFT009
     C                     PARM           PCCY85  3                       CFT009
     C                     PARM           SCCY85  3                       CFT009
     C                     PARM           CCCY85  3                       CFT009
     C                     PARM           LCCY85  3                       CFT009
     C                     PARM           RATE85 138                      CFT009
     C                     PARM           LCHG   130                      CFT009
     C                     PARM           LCHGF  16                       CFT009
      *                                                                   CFT009
      ** Set up amounts                                                   CFT009
      *                                                                   CFT009
     C                     Z-ADDLCHG      OUTAMT                          CFT009
     C                     Z-ADDLCHG      DFTMS1                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         DFTMS1                          CFT009
     C                     ENDIF                                          CFT009
      * Miscellaneous Charge Code 2                                       CFT009
     C           *LIKE     DEFN S7CD10    SVCD10                          CFT009
     C                     MOVE S7CD10    SVCD10                          CFT009
     C           *LIKE     DEFN F7TRCM    DFTMS2                          CFT009
     C                     MOVELSVCD10    CHGCDE                          CFT009
     C           CHGCDE    IFNE *BLANKS                                   CFT009
     C                     EXSR RECALC                                    CFT009
     C                     Z-ADDTOTCHG    INPAMT                          CFT009
      *                                                                   CFT009
      ** Convert file default using screen ccy for comparison of          CFT009
      ** entered field and defaulted                                      CFT009
      *                                                                   CFT009
      ** Set up charge amount and currencies for call to FT000985.        CFT009
      *                                                                   CFT009
     C                     Z-ADDINPAMT    CHGA85                          CFT009
     C                     MOVELPCCY      PCCY85                          CFT009
     C                     MOVELSMCY      SCCY85                          CFT009
     C                     MOVELOPCHGC    CCCY85                          CFT009
     C                     MOVELLEVIED    LCCY85                          CFT009
     C                     MOVELCVTRAT    RATE85                          CFT009
     C                     Z-ADD0         LCHG                            CFT009
     C                     MOVEL*BLANKS   LCHGF     P                     CFT009
      *                                                                   CFT009
     C                     CALL 'FT000985'                                CFT009
     C                     PARM           RET985 10                       CFT009
     C                     PARM           CHGA85 130                      CFT009
     C                     PARM           PCCY85  3                       CFT009
     C                     PARM           SCCY85  3                       CFT009
     C                     PARM           CCCY85  3                       CFT009
     C                     PARM           LCCY85  3                       CFT009
     C                     PARM           RATE85 138                      CFT009
     C                     PARM           LCHG   130                      CFT009
     C                     PARM           LCHGF  16                       CFT009
      *                                                                   CFT009
      ** Set up amounts                                                   CFT009
      *                                                                   CFT009
     C                     Z-ADDLCHG      OUTAMT                          CFT009
     C                     Z-ADDLCHG      DFTMS2                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         DFTMS2                          CFT009
     C                     ENDIF                                          CFT009
      * Miscellaneous Charge Code 3                                       CFT009
     C           *LIKE     DEFN S7CD11    SVCD11                          CFT009
     C                     MOVE S7CD11    SVCD11                          CFT009
     C           *LIKE     DEFN F7TRCM    DFTMS3                          CFT009
     C                     MOVELSVCD11    CHGCDE                          CFT009
     C           CHGCDE    IFNE *BLANKS                                   CFT009
     C                     EXSR RECALC                                    CFT009
     C                     Z-ADDTOTCHG    INPAMT                          CFT009
      *                                                                   CFT009
      ** Convert file default using screen ccy for comparison of          CFT009
      ** entered field and defaulted                                      CFT009
      *                                                                   CFT009
      ** Set up charge amount and currencies for call to FT000985.        CFT009
      *                                                                   CFT009
     C                     Z-ADDINPAMT    CHGA85                          CFT009
     C                     MOVELPCCY      PCCY85                          CFT009
     C                     MOVELSMCY      SCCY85                          CFT009
     C                     MOVELOPCHGC    CCCY85                          CFT009
     C                     MOVELLEVIED    LCCY85                          CFT009
     C                     MOVELCVTRAT    RATE85                          CFT009
     C                     Z-ADD0         LCHG                            CFT009
     C                     MOVEL*BLANKS   LCHGF     P                     CFT009
      *                                                                   CFT009
     C                     CALL 'FT000985'                                CFT009
     C                     PARM           RET985 10                       CFT009
     C                     PARM           CHGA85 130                      CFT009
     C                     PARM           PCCY85  3                       CFT009
     C                     PARM           SCCY85  3                       CFT009
     C                     PARM           CCCY85  3                       CFT009
     C                     PARM           LCCY85  3                       CFT009
     C                     PARM           RATE85 138                      CFT009
     C                     PARM           LCHG   130                      CFT009
     C                     PARM           LCHGF  16                       CFT009
      *                                                                   CFT009
      ** Set up amounts                                                   CFT009
      *                                                                   CFT009
     C                     Z-ADDLCHG      OUTAMT                          CFT009
     C                     Z-ADDLCHG      DFTMS3                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         DFTMS3                          CFT009
     C                     ENDIF                                          CFT009
      * Miscellaneous Charge Code 4                                       CFT009
     C           *LIKE     DEFN S7CD12    SVCD12                          CFT009
     C                     MOVE S7CD12    SVCD12                          CFT009
     C           *LIKE     DEFN F7TRCM    DFTMS4                          CFT009
     C                     MOVELSVCD12    CHGCDE                          CFT009
     C           CHGCDE    IFNE *BLANKS                                   CFT009
     C                     EXSR RECALC                                    CFT009
     C                     Z-ADDTOTCHG    INPAMT                          CFT009
      *                                                                   CFT009
      ** Convert file default using screen ccy for comparison of          CFT009
      ** entered field and defaulted                                      CFT009
      *                                                                   CFT009
      ** Set up charge amount and currencies for call to FT000985.        CFT009
      *                                                                   CFT009
     C                     Z-ADDINPAMT    CHGA85                          CFT009
     C                     MOVELPCCY      PCCY85                          CFT009
     C                     MOVELSMCY      SCCY85                          CFT009
     C                     MOVELOPCHGC    CCCY85                          CFT009
     C                     MOVELLEVIED    LCCY85                          CFT009
     C                     MOVELCVTRAT    RATE85                          CFT009
     C                     Z-ADD0         LCHG                            CFT009
     C                     MOVEL*BLANKS   LCHGF     P                     CFT009
      *                                                                   CFT009
     C                     CALL 'FT000985'                                CFT009
     C                     PARM           RET985 10                       CFT009
     C                     PARM           CHGA85 130                      CFT009
     C                     PARM           PCCY85  3                       CFT009
     C                     PARM           SCCY85  3                       CFT009
     C                     PARM           CCCY85  3                       CFT009
     C                     PARM           LCCY85  3                       CFT009
     C                     PARM           RATE85 138                      CFT009
     C                     PARM           LCHG   130                      CFT009
     C                     PARM           LCHGF  16                       CFT009
      *                                                                   CFT009
      ** Set up amounts                                                   CFT009
      *                                                                   CFT009
     C                     Z-ADDLCHG      OUTAMT                          CFT009
     C                     Z-ADDLCHG      DFTMS4                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         DFTMS4                          CFT009
     C                     ENDIF                                          CFT009
      * Miscellaneous Charge Code 5                                       CFT009
     C           *LIKE     DEFN S7CD13    SVCD13                          CFT009
     C                     MOVE S7CD13    SVCD13                          CFT009
     C           *LIKE     DEFN F7TRCM    DFTMS5                          CFT009
     C                     MOVELSVCD13    CHGCDE                          CFT009
     C           CHGCDE    IFNE *BLANKS                                   CFT009
     C                     EXSR RECALC                                    CFT009
     C                     Z-ADDTOTCHG    INPAMT                          CFT009
      *                                                                   CFT009
      ** Convert file default using screen ccy for comparison of          CFT009
      ** entered field and defaulted                                      CFT009
      *                                                                   CFT009
      ** Set up charge amount and currencies for call to FT000985.        CFT009
      *                                                                   CFT009
     C                     Z-ADDINPAMT    CHGA85                          CFT009
     C                     MOVELPCCY      PCCY85                          CFT009
     C                     MOVELSMCY      SCCY85                          CFT009
     C                     MOVELOPCHGC    CCCY85                          CFT009
     C                     MOVELLEVIED    LCCY85                          CFT009
     C                     MOVELCVTRAT    RATE85                          CFT009
     C                     Z-ADD0         LCHG                            CFT009
     C                     MOVEL*BLANKS   LCHGF     P                     CFT009
      *                                                                   CFT009
     C                     CALL 'FT000985'                                CFT009
     C                     PARM           RET985 10                       CFT009
     C                     PARM           CHGA85 130                      CFT009
     C                     PARM           PCCY85  3                       CFT009
     C                     PARM           SCCY85  3                       CFT009
     C                     PARM           CCCY85  3                       CFT009
     C                     PARM           LCCY85  3                       CFT009
     C                     PARM           RATE85 138                      CFT009
     C                     PARM           LCHG   130                      CFT009
     C                     PARM           LCHGF  16                       CFT009
      *                                                                   CFT009
      ** Set up amounts                                                   CFT009
      *                                                                   CFT009
     C                     Z-ADDLCHG      OUTAMT                          CFT009
     C                     Z-ADDLCHG      DFTMS5                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         DFTMS5                          CFT009
     C                     ENDIF                                          CFT009
     C/COPY WNCPYSRC,FT0349C001
      *
      ** Unwind subroutine stack name
      *
     C           EXINIT    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      /TITLE SR/SRRTXT
      *****************************************************************
      *                                                               *
      *  SRRTXT - Retrieves Texts for the Charges.                    *
      *                                                               *
      *  Called By: Main Processing                                   *
      *                                                               *
      *  Calls:                                                       *
      *  MEC1150   - Extracts Message Information.                    *
      *                                                               *
      *****************************************************************
      *
     C           SRRTXT    BEGSR                           *** SRRTXT ***
      *
      ** Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SRRTXT'  @STK,Q
      *
      ** Indicate that set up is complete
      *
     C                     MOVE *ON       *IN50
      *
      ** Open Files
      *
     C                     OPEN ACCNT
     C                     OPEN ACNUMA
      *
      ** Retrieve the text for Transfer Commission using MEC1150
      *
     C                     CALL 'MEC1150'              9090
     C                     PARM 'FTM2544' #MSGID
     C                     PARM 'FTUSRMSG'#MSGF
     C                     PARM           #MSDTA
     C                     PARM *BLANKS   #MSTX1
     C                     PARM *BLANKS   #MSTX2
      *
     C                     MOVEL#MSTX1    WVAT1  20
      *
      ** Retrieve the text for Telex Charge using MEC1150
      *
     C                     CALL 'MEC1150'              9090
     C                     PARM 'FTM2545' #MSGID
     C                     PARM 'FTUSRMSG'#MSGF
     C                     PARM           #MSDTA
     C                     PARM *BLANKS   #MSTX1
     C                     PARM *BLANKS   #MSTX2
      *
     C                     MOVEL#MSTX1    WVAT2  20
      *
      ** Retrieve the text for Cheque Charge using MEC1150
      *
     C                     CALL 'MEC1150'              9090
     C                     PARM 'FTM2546' #MSGID
     C                     PARM 'FTUSRMSG'#MSGF
     C                     PARM           #MSDTA
     C                     PARM *BLANKS   #MSTX1
     C                     PARM *BLANKS   #MSTX2
      *
     C                     MOVEL#MSTX1    WVAT3  20
      *
      ** Retrieve the text for Costs Abroad using MEC1150
      *
     C                     CALL 'MEC1150'              9090
     C                     PARM 'FTM2547' #MSGID
     C                     PARM 'FTUSRMSG'#MSGF
     C                     PARM           #MSDTA
     C                     PARM *BLANKS   #MSTX1
     C                     PARM *BLANKS   #MSTX2
      *
     C                     MOVEL#MSTX1    WVAT4  20
      *
      ** Retrieve the text for SWIFT Priority using MEC1150
      *
     C                     CALL 'MEC1150'              9090
     C                     PARM 'FTM2548' #MSGID
     C                     PARM 'FTUSRMSG'#MSGF
     C                     PARM           #MSDTA
     C                     PARM *BLANKS   #MSTX1
     C                     PARM *BLANKS   #MSTX2
      *
     C                     MOVEL#MSTX1    WVAT5  20
      *
      ** Retrieve the text for Miscellaneous Charge using MEC1150
      *
     C                     CALL 'MEC1150'              9090
     C                     PARM 'FTM2549' #MSGID
     C                     PARM 'FTUSRMSG'#MSGF
     C                     PARM           #MSDTA
     C                     PARM *BLANKS   #MSTX1
     C                     PARM *BLANKS   #MSTX2
      *
     C                     MOVEL#MSTX1    WVAT6  20
      *
      ** Retrieve the text for FX/Change Commission using MEC1150
      *
     C                     CALL 'MEC1150'              9090
     C                     PARM 'FTM2550' #MSGID
     C                     PARM 'FTUSRMSG'#MSGF
     C                     PARM           #MSDTA
     C                     PARM *BLANKS   #MSTX1
     C                     PARM *BLANKS   #MSTX2
      *
     C                     MOVEL#MSTX1    WVAT7  20
      *
      ** Unwind subroutine stack name
      *
     C           EXRTXT    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      /TITLE SR/SRPROC
      *****************************************************************
      *                                                               *
      *  SRPROC - Validate all detail fields entered. Seton appro -   *
      *           priate indicators and set up the array of relevant  *
      *           error codes for display.                            *
      *                                                               *
      *  Called By: Main Processing                                   *
      *                                                               *
      *  Calls:                                                       *
      *  SRCDRO    - Validates Charges to the debit of.               *
      *  SRDETC    - Validates Details of Charges.                    *
      *  SRCCCY    - Get Currency Information for Charge Validation.  *
      *  SRTRCM    - Validate Transfer Commission Charges.            *
      *  SRCHCM    - Validate FX/Change Commission.                   *
      *  SRTXCH    - Validate Telex Charge.                           *
      *  SRCQCH    - Validate Cheque Charge.                          *
      *  SRCSTH    - Validate Costs Abroad.                           *
      *  SRSPCH    - Validate SWIFT Priority.                         *
      *  SRMSCH    - Validate Miscellaneous.                          *
      *  SRVATT    - Validate V.A.T. Flags.                           *
      *  SRVATC    - V.A.T. Calculation.                              *
      *  SRRCRM    - Validate Receiver's Charges Remitted.            *
      *  SRSNCD    - Validate Sender's Charges Deducted.              *
      *  SRTOT     - Check Total Charges do not exceed Payment Amount.*
      *  SRSWST    - Validate SWIFT Standard                          *   CFT009
      *  SRM1CH    - Validate Miscellaneous 1                         *   CFT009
      *  SRM2CH    - Validate Miscellaneous 2                         *   CFT009
      *  SRM3CH    - Validate Miscellaneous 3                         *   CFT009
      *  SRM4CH    - Validate Miscellaneous 4                         *   CFT009
      *  SRM5CH    - Validate Miscellaneous 5                         *   CFT009
      *                                                               *
      *****************************************************************
      *
     C           SRPROC    BEGSR                           *** SRPROC ***
      *
      ** Set up subroutine stack name
      *
     C                     ADD  1         Q
     C                     MOVEL'SRPROC'  @STK,Q
      *
      ** Move warning array passed to WRN@ and error indicators
      *
     C                     MOVEAE#WARA    WRN@
     C                     MOVEA*BLANKS   ERCD
     C                     CLEARI7DATA
     C                     Z-ADD0         X       50
      *                                                                   CFT009
      ** If Core switchable feature CFT009 is on then the charge          CFT009
      ** codes will be validated (NOT FOR STP)                            CFT009
      ** Retrieve the saved file fields from the defaulted codes          CFT009
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
     C           STP       ANDNE'S'                                       CFT009
      *                                                                   CFT009
     C           S7PREF    CHAINOTPAY                90                   CFT009
      *                                                                   CFT009
     C           *IN90     IFEQ *ON                                       CFT009
     C                     MOVEL'OTPAY   'W0FILE                          CFT009
     C                     MOVELW0PREF    W0KEY                           CFT009
     C                     Z-ADD24        W0ERNB                          CFT009
     C                     MOVEL'MEM5003' W0MSGD                          CFT009
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT009
     C                     EXSR SRERR                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           S7PREF    CHAINOTPAYXL2             90                   CFT009
      *                                                                   CFT009
     C           *IN90     IFEQ *ON                                       CFT009
     C                     MOVEL'OTPAYXL2'W0FILE                          CFT009
     C                     MOVELW0PREF    W0KEY                           CFT009
     C                     Z-ADD25        W0ERNB                          CFT009
     C                     MOVEL'MEM5003' W0MSGD                          CFT009
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT009
     C                     EXSR SRERR                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *
      ** Validate Charges To The Debit Of
      *
     C                     EXSR SRCDRO
      *
      ** Validate Details Of Charges
      *
     C                     EXSR SRDETC
      *
      *  Get currency information for charge amount validation
      *
     C                     EXSR SRCCCY
      ** Validate Charge code and amounts if CFT009 switched ON           CFT009
      ** against default values (NOT FOR STP)                             CFT009
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
     C           STP       ANDNE'S'                                       CFT009
     C                     EXSR DEFLT                                     CFT009
     C                     ENDIF                                          CFT009
      *
      ** Validate Transmission Charge
      *
     C                     EXSR SRTRCM
      *
      ** Validate FX/Change Commission if S01494 is switched ON
      *
     C           S01494    IFEQ 'Y'
     C                     EXSR SRCHCM
     C                     ENDIF
      *
      ** Validate Telex Charge
      *
     C                     EXSR SRTXCH
      *
      ** Validate Cheque Charge
      *
     C                     EXSR SRCQCH
      *
      ** Validate Costs Abroad
      *
     C                     EXSR SRCSTH
      *                                                                   CFT009
      ** If SAR CFT009 Validate additional charges                        CFT009
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
      *                                                                   CFT009
      ** Validate S.W.I.F.T. Standard Charge                              CFT009
      *                                                                   CFT009
     C                     EXSR SRSWST                                    CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *
      ** Validate SWIFT Priority
      *
     C                     EXSR SRSPCH
      *
      ** Validate Miscellaneous Charge
      *
     C                     EXSR SRMSCH
      *                                                                   CFT009
      ** If SAR CFT009 Validate additional charges                        CFT009
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
      *                                                                   CFT009
      ** Validate Miscellaneous Charge 1                                  CFT009
      *                                                                   CFT009
     C                     EXSR SRMSC1                                    CFT009
      *                                                                   CFT009
      ** Validate Miscellaneous Charge 2                                  CFT009
      *                                                                   CFT009
     C                     EXSR SRMSC2                                    CFT009
      *                                                                   CFT009
      ** Validate Miscellaneous Charge 3                                  CFT009
      *                                                                   CFT009
     C                     EXSR SRMSC3                                    CFT009
      *                                                                   CFT009
      ** Validate Miscellaneous Charge 4                                  CFT009
      *                                                                   CFT009
     C                     EXSR SRMSC4                                    CFT009
      *                                                                   CFT009
      ** Validate Miscellaneous Charge 5                                  CFT009
      *                                                                   CFT009
     C                     EXSR SRMSC5                                    CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      * Save Rate                                                         CFT009
     C                     Z-ADDCVTRAT    F7CHXR                          CFT009
      *
      ** Validate V.A.T. flags if V.A.T. processing allowed
      *
     C           V#VATP    IFEQ 'Y'
     C                     EXSR SRVATT
     C                     ENDIF
      *
      ** Calculate V.A.T. charge amounts if V.A.T. processing allowed
      *
     C           V#VATP    IFEQ 'Y'
     C                     EXSR SRVATC
     C                     ENDIF
      *
      ** Check that Total Charges do not exceed payment amount
      *
     C                     EXSR SRTOT
      *
     C           CFT014    IFEQ 'Y'
      *
      ** Validate Receiver's Charges Remitted
      *
     C                     EXSR SRRCRM
      *
      ** Validate Sender's Charges Deducted
      *
     C                     EXSR SRSNCD
     C                     ENDIF
     C/COPY WNCPYSRC,FT0349C003
      *
      ** Move waring array back and errors
      *
     C                     MOVEAWRN@      E#WARA
     C                     MOVEAERCD      C#ERCD
      *
      ** Unwind subroutine stack name
      *
     C           EXPROC    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      /TITLE SR/SRCDRO
      *****************************************************************
      *                                                               *
      *  SRCDRO - Validate Charges to the debit of                    *
      *                                                               *
      *  Called By: SRPROC Subroutine                                 *
      *                                                               *
      *  Calls:                                                       *
      *  FTSNMS    - Send message to program message queue.           *
      *  AONOSTR0  - Access Object to get Nostro details.             *
      *  SRERR     - Error subroutine.                                *
      *                                                               *
      *****************************************************************
      *
     C           SRCDRO    BEGSR                           *** SRCDRO ***
      *
      ** Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SRCDRO'  @STK,Q
      *
     C                     Z-ADD0         F7CDRO
     C                     MOVEL*BLANKS   F7CDRT
      *
      ** Charges To The Debit of A/C is optional.
      ** 3 formats acceptable - Nostro, Retail A/C, A/C No.
      ** If blank and branch entered error.
      *
     C           S7CDRO    IFEQ *BLANKS
     C           S7CDBR    ANDNE*BLANKS
     C                     MOVEL'Y'       E#MSGS
     C                     MOVELS7CDRO    FTMSDT
     C                     MOVELE#CPGM    FTPGMQ
     C                     MOVEL'FTM2056' FTMSID
     C                     EXSR FTSNMS
     C                     MOVEL'Y'       I7CDRT
     C                     MOVEL'Y'       I7CDBR
     C                     MOVEL'Y'       E#NOUP
     C                     GOTO EXCDRO
     C                     ENDIF
      *
      ** Field is optional, exit if blank
      *
     C           S7CDRO    IFEQ *BLANKS
     C                     GOTO EXCDRO
     C                     ENDIF
      *
      ** ? not allowed
      *
     C           '?'       SCAN S7CDRO    Y#             90
      *
     C           *IN90     IFEQ *ON
     C                     MOVEL'Y'       E#MSGS
     C                     MOVELS7CDRO    FTMSDT
     C                     MOVELE#CPGM    FTPGMQ
     C                     MOVEL'FTM2202' FTMSID
     C                     EXSR FTSNMS
     C                     MOVEL'Y'       I7CDRT
     C                     MOVEL'Y'       I7CDBR
     C                     MOVEL'Y'       E#NOUP
     C                     GOTO EXCDRO
     C                     ENDIF
      *
      ** Determine the number of digits in the field.
      ** Check first two characters are numeric and rest is blank.
      *
     C                     MOVEL*BLANKS   I#FLD
     C                     MOVELS7CDRO    I#FLD  35
     C           DIGITS    CHECKI#FLD     Y#      30     90
      *
      ** 2, 10 and 12 digits allowed
      *
     C           *IN90     IFEQ *ON
     C           Y#        ANDEQ3
     C           *IN90     OREQ *ON
     C           Y#        ANDEQ11
     C           *IN90     OREQ *ON
     C           Y#        ANDEQ13
     C           S7CDBR    ANDNE*BLANKS
     C           WUMBIN    ANDEQ'Y'
     C           *IN90     OREQ *ON
     C           Y#        ANDEQ13
     C           WUMBIN    ANDNE'Y'
     C                     MOVE *OFF      *IN90
     C                     ENDIF
      *
      ** Field is invalid format
      *
     C           *IN90     IFEQ *ON
     C                     MOVEL'Y'       E#MSGS
     C                     MOVELS7CDRO    FTMSDT
     C                     MOVELE#CPGM    FTPGMQ
     C                     MOVEL'FTM2057' FTMSID
     C                     EXSR FTSNMS
     C                     MOVEL'Y'       I7CDRT
     C                     MOVEL'Y'       I7CDBR
     C                     MOVEL'Y'       E#NOUP
     C                     GOTO EXCDRO
     C                     ENDIF
      *
      ** If 10 digits and Retail accounts not used error
      *
     C           V#RANR    IFNE 'Y'
     C           Y#        ANDEQ11
     C           S7CDBR    ANDEQ*BLANKS
     C                     MOVEL'Y'       E#MSGS
     C                     MOVELS7CDRO    FTMSDT
     C                     MOVELE#CPGM    FTPGMQ
     C                     MOVEL'FTM2058' FTMSID
     C                     EXSR FTSNMS
     C                     MOVEL'Y'       I7CDRT
     C                     MOVEL'Y'       I7CDBR
     C                     MOVEL'Y'       E#NOUP
     C                     GOTO EXCDRO
     C                     ENDIF
      *
      ** Check if a 2 digit Nostro code has been entered - based on
      ** no. of blanks found in field
      *
     C           Y#        IFEQ 3
     C           S7CDBR    ANDEQ*BLANKS
      *
      ** Validate Nostro Code
      *
     C                     MOVELS7CDRO    TNOSN   2
      *
     C                     CALL 'AONOSTR0'             9090
     C                     PARM *BLANKS   WRTCD
     C                     PARM '*KEY   ' WOPTN
     C                     PARM *BLANKS   WCUST   6
     C                     PARM V#BCCY    WCYCD   3
     C**********           PARM *BLANKS   WACCN   4                                           CGL029
     C                     PARM *BLANKS   WACCN  10                                           CGL029
     C                     PARM *BLANKS   WACSN   2
     C                     PARM TNOSN     WNONB   2
     C                     PARM *BLANKS   WBRCD   3
     C                     PARM *BLANKS   WCSSN  10
     C                     PARM *BLANKS   WPNOI   1
     C           SDNOST    PARM SDNOST    DSFDY
      *
      ** If error on call
      *
     C           *IN90     IFEQ *ON
     C                     MOVE 'SDNOSTPD'W0FILE
     C                     MOVELTNOSN     W0KEY
     C                     Z-ADD9         W0ERNB
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     ENDIF
      *
      ** If not found error
      *
     C           WRTCD     IFNE *BLANKS
     C                     MOVEL'Y'       E#MSGS
     C                     MOVELS7CDRO    FTMSDT
     C                     MOVELE#CPGM    FTPGMQ
     C                     MOVEL'FTM2059' FTMSID
     C                     EXSR FTSNMS
     C                     MOVEL'Y'       I7CDRT
     C                     MOVEL'Y'       I7CDBR
     C                     MOVEL'Y'       E#NOUP
     C                     GOTO EXCDRO
     C                     ENDIF
      *
      ** Set up ACCNTAB fields
      *
     C                     MOVE A7ACCD    ACOD
     C                     MOVE A7ACSN    ACSQ
     C                     MOVE A7CUST    CNUM
     C                     MOVE A7CYCD    CCY
     C                     MOVE A7BRCD    BRCA
      *
      ** Access Full Account Details for later validation
      *
     C                     MOVELA7CYCD    KACCCY
     C**********           Z-ADDCNUM      KACNUM                                              CSD027
     C                     MOVE CNUM      KACNUM                                              CSD027
     C                     Z-ADDACOD      KACCD
     C                     Z-ADDACSQ      KACSQ
     C                     MOVE BRCA      KBRCA
      *
     C           TACKEY    CHAINACCNTABF             90
      *
     C           *IN90     IFEQ *ON
     C           RECI      ORNE 'D'
     C                     MOVEL'ACCNT   'W0FILE
     C                     MOVELACKYDS    W0KEY
     C                     Z-ADD10        W0ERNB
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     ENDIF
      *
     C                     ENDIF
      *
      ** Check for Retail Account No. being entered
      ** only if Debit Customer reference is not entered OR
      ** multibranching is not active.
      *
     C           Y#        IFEQ 11
     C           S7CDBR    ANDEQ*BLANKS
      *
     C                     MOVELS7CDRO    TRENO  100
     C           TRENO     CHAINACNUMA               90
      *
     C           *IN90     IFEQ *ON
     C           RECI      ORNE 'D'
     C                     MOVEL'Y'       E#MSGS
     C                     MOVELS7CDRO    FTMSDT
     C                     MOVELE#CPGM    FTPGMQ
     C                     MOVEL'FTM2060' FTMSID
     C                     EXSR FTSNMS
     C                     MOVEL'Y'       I7CDRT
     C                     MOVEL'Y'       I7CDBR
     C                     MOVEL'Y'       E#NOUP
     C                     GOTO EXCDRO
     C                     ENDIF
      *
      ** A/C Currency must be base currency
      *
     C           CCY       IFNE V#BCCY
     C                     MOVEL'Y'       E#MSGS
     C                     MOVELS7CDRO    FTMSDT
     C                     MOVELE#CPGM    FTPGMQ
     C                     MOVEL'FTM2061' FTMSID
     C                     EXSR FTSNMS
     C                     MOVEL'Y'       I7CDRT
     C                     MOVEL'Y'       I7CDBR
     C                     MOVEL'Y'       E#NOUP
     C                     GOTO EXCDRO
     C                     ENDIF
     C                     ENDIF
      *
      ** Validate for G/L Account No.
      ** If 12 digits when combined with base currency must exist
      ** on PF/ACCNTAB.
      *
     C           Y#        IFEQ 13
     C           S7CDBR    ORNE *BLANKS
     C**********           MOVELS7CDRO    KACNUM  60                                          CSD027
     C                     MOVELS7CDRO    KACNUM  6                                           CSD027
     C                     MOVE S7CDRO    ACCS    6
     C**********           MOVELACCS      KACCD   40                                          CGL029
     C                     MOVELACCS      KACCD                                               CGL029
     C                     MOVE ACCS      KACSQ   20
      *
      ** If multibranched use screen branch else use passed branch
      *
     C           WUMBIN    IFEQ 'Y'
     C                     MOVELS7CDBR    KBRCA   3
     C                     ELSE
     C                     MOVELV#SBRC    KBRCA
     C                     ENDIF
      *
     C           TACKEY    KLIST
     C                     KFLD           KACNUM
     C                     KFLD           V#BCCY
     C                     KFLD           KACCD
     C                     KFLD           KACSQ
     C                     KFLD           KBRCA
      *
     C           TACKEY    CHAINACCNTABF             90
      *
     C           *IN90     IFEQ *ON
     C           RECI      ORNE 'D'
     C                     MOVEL'Y'       E#MSGS
     C           S7CDRO    CAT  S7CDBR    FTMSDT    P
     C                     MOVELE#CPGM    FTPGMQ
     C                     MOVEL'FTM2062' FTMSID
     C                     EXSR FTSNMS
     C                     MOVEL'Y'       I7CDRT
     C                     MOVEL'Y'       I7CDBR
     C                     MOVEL'Y'       E#NOUP
      *
      ** Highlight branch if entered
      *
     C           S7CDBR    IFNE *BLANK
     C                     MOVEL'Y'       I7CDBR
     C                     ENDIF
      *
     C                     GOTO EXCDRO
     C                     ENDIF
      *
     C                     ENDIF
      *
      ** If 'Charges To The Debit Of is entered then
      ** check if date is in the future and if the account is
      ** closing today
      *
     C           V#ADDC    IFEQ 'A'
     C                     Z-ADDV#SLDT    @DATE   50
     C                     ELSE
     C                     Z-ADDV#PVDT    @DATE
     C                     ENDIF
      *
     C           @DATE     IFGT WURDNB
     C           ACST      ANDEQ'C'
     C                     MOVEL'Y'       E#MSGS
     C                     MOVELS7CDRO    FTMSDT
     C                     MOVELE#CPGM    FTPGMQ
     C                     MOVEL'FTM2063' FTMSID
     C                     EXSR FTSNMS
     C                     MOVEL'Y'       I7CDRT
     C                     MOVEL'Y'       I7CDBR
     C                     MOVEL'Y'       E#NOUP
     C                     ENDIF
      *
      ** Check not past backvalue period
      *
     C           @DATE     IFLT V#BVLD
     C                     MOVEL'Y'       E#MSGS
     C                     MOVELS7CDRO    FTMSDT
     C                     MOVELE#CPGM    FTPGMQ
     C                     MOVEL'FTM2064' FTMSID
     C                     EXSR FTSNMS
     C                     MOVEL'Y'       I7CDRT
     C                     MOVEL'Y'       I7CDBR
     C                     MOVEL'Y'       E#NOUP
     C                     ENDIF
      *
      ** For Retail accounts only, check that the
      ** earlier of the two value dates is not before the Backvalue
      ** Limit Date nor before the account was opened
      *
     C           ATYP      IFEQ 'R'
      *
     C           @DATE     IFLT DACO
     C                     MOVEL'Y'       E#MSGS
     C                     MOVELS7CDRO    FTMSDT
     C                     MOVELE#CPGM    FTPGMQ
     C                     MOVEL'FTM2065' FTMSID
     C                     EXSR FTSNMS
     C                     MOVEL'Y'       I7CDRT
     C                     MOVEL'Y'       I7CDBR
     C                     MOVEL'Y'       E#NOUP
     C                     ENDIF
      *
     C                     ENDIF
      *
      ** If no errors then set file fields
      *
     C           I7CDRT    IFEQ *BLANKS
     C                     SELEC
     C           Y#        WHEQ 3
     C                     MOVEL'N'       F7CDRT
     C           Y#        WHEQ 11
     C                     MOVEL'R'       F7CDRT
     C           Y#        WHEQ 13
     C                     MOVEL'P'       F7CDRT
     C                     ENDSL
      *
     C                     MOVELS7CDRO    F7CDRO
      *
     C                     ENDIF
      *
      ** Unwind subroutine stack name
      *
     C           EXCDRO    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      /TITLE SR/SRDETC
      *****************************************************************
      *                                                               *
      *  SRDETC - Validate Details of Charges                         *
      *                                                               *
      *  Called By: SRPROC Subroutine                                 *
      *                                                               *
      *  Calls:                                                       *
      *  FTSNMS    - Send message to program message queue.           *
      *                                                               *
      *****************************************************************
      *
     C           SRDETC    BEGSR                           *** SRDETC ***
      *
      ** Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SRDETC'  @STK,Q
      *
      ** Details of Charges optional, Defaults to BEN
      *
     C           S7DETC    IFEQ *BLANKS
      *                                                                                       219241
      ** If CFT014 is installed, use the default value from the                               219241
      ** Message Management ICD                                                               219241
      *                                                                                       219241
     C           CFT014    IFEQ 'Y'                                                           219241
     C                     MOVELENDCHG    S7DETC                                              219241
     C                     ELSE                                                               219241
     C                     MOVE 'BEN'     S7DETC
     C/COPY WNCPYSRC,FT0349C005
     C                     ENDIF                                                              219241
      *                                                                                       219241
     C                     ELSE
      *
      ** Valid entries are 'OUR' or 'BEN'
      ** If CFT014 is on, accept 'SHA'
      *
     C                     MOVE 'N'       WSHA    1
     C           CFT014    IFEQ 'Y'
     C           S7DETC    ANDEQ'SHA'
     C                     MOVE 'Y'       WSHA
     C                     ENDIF
      *
     C           S7DETC    IFNE 'OUR'
     C           S7DETC    ANDNE'BEN'
     C           WSHA      ANDNE'Y'
     C                     MOVEL'Y'       E#MSGS
     C                     MOVELS7DETC    FTMSDT
     C                     MOVELE#CPGM    FTPGMQ
     C           CFT014    IFEQ 'Y'
     C                     MOVEL'FTM5045' FTMSID
     C                     ELSE
     C                     MOVEL'FTM2193' FTMSID
     C                     ENDIF
     C                     EXSR FTSNMS
     C                     MOVEL'Y'       I7DETC
     C                     MOVEL'Y'       E#NOUP
     C                     ENDIF
      *
      ** 'SHA' not allowed if OP will potentially create a MT100                              200949
      *                                                                                       200949
     C           WSHA      IFEQ 'Y'                                                           200949
     C           V#M103    ANDNE'Y'                                                           200949
     C                     MOVEL'Y'       E#MSGS                                              200949
     C                     MOVELS7DETC    FTMSDT                                              200949
     C                     MOVELE#CPGM    FTPGMQ                                              200949
     C                     MOVEL'FTM5211' FTMSID                                              200949
     C                     EXSR FTSNMS                                                        200949
     C                     MOVEL'Y'       I7DETC                                              200949
     C                     MOVEL'Y'       E#NOUP                                              200949
     C                     ENDIF                                                              200949
      *                                                                                       200949
     C                     ENDIF
      *
      ** Unwind subroutine stack name
      *
     C           EXDETC    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      /TITLE SR/SRCCCY
      *****************************************************************
      *                                                               *
      *  SRCCCY - Get Currency information for Charge amount valida   *
      *           tion                                                *
      *                                                               *
      *  Called By: SRPROC Subroutine                                 *
      *                                                               *
      *  Calls:                                                       *
      *  AOCURRR0  - Access Object to get Currency details.           *
      *  SRERR     - Error subroutine.                                *
      *                                                               *
      *****************************************************************
      *
     C           SRCCCY    BEGSR                           *** SRCCCY ***
      *
      ** Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SRCCCY'  @STK,Q
      *
     C           I7CDRT    IFEQ *BLANK
     C           I7CDBR    ANDEQ*BLANK
      *
     C                     SELEC
      *
     C           V#CHCY    WHEQ 'B'
     C           S7CDRO    ORNE *BLANKS
     C                     MOVELV#BCCY    V#CCCY
      *
     C           V#CHCY    WHEQ 'L'
     C                     MOVELV#LCCY    V#CCCY
      *
     C           V#CHCY    WHEQ 'F'                                       CFT009
     C                     MOVELFCHCCY    V#CCCY                          CFT009
      *                                                                   CFT009
     C           V#CHCY    WHEQ 'C'
     C           V#ADDC    ANDEQ'A'
     C                     MOVELV#SMCY    V#CCCY
      *
     C                     OTHER
     C                     MOVELV#PCCY    V#CCCY
      *
     C                     ENDSL
      *
     C           CFT009    IFEQ 'Y'                                       CFT009
     C                     MOVE V#CCCY    OPCHGC                          CFT009
     C                     MOVE V#CCCY    F7CHCY                          CFT009
     C                     ENDIF                                          CFT009
      *
     C                     SELEC
      *
     C           S7CDRO    WHNE *BLANKS
     C                     MOVELV#BCCY    V#RCCY
      *
     C           V#ADDC    WHEQ 'A'
     C                     MOVELV#SMCY    V#RCCY
      *
     C                     OTHER
     C                     MOVELV#PCCY    V#RCCY
      *
     C                     ENDSL
      *
      * Save LEVIED currency                                              CFT009
     C                     MOVELV#RCCY    LEVIED  3                       CFT009
      *
      *
     C                     ENDIF
      *
      ** Access currency record
      *
     C                     CALL 'AOCURRR0'             9090
     C                     PARM           WRTCD
     C                     PARM '*KEY   ' WOPTN
     C                     PARM V#CCCY    WAJCD
     C           SDCURR    PARM *BLANKS   DSSDY
      *
      ** Option ended in error
      *
     C           *IN90     IFEQ *ON
     C           WRTCD     ORNE *BLANKS
     C                     MOVEL'AOCURRR0'W0FILE
     C                     MOVEL'*CALL'   W0KEY
     C                     Z-ADD21        W0ERNB
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     ENDIF
      *
      ** Unwind subroutine stack name
      *
     C           EXCCCY    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      /TITLE SR/SRTRCM
      *****************************************************************
      *                                                               *
      *  SRTRCM - Validate Transfer Commission Charge                 *
      *                                                               *
      *  Called By: SRPROC Subroutine                                 *
      *                                                               *
      *  Calls:                                                       *
      *  SRALGN    - Calls ZALIGN.                                    *
      *  FTSNMS    - Send message to program message queue.           *
      *                                                               *
      *****************************************************************
      *
     C           SRTRCM    BEGSR                           *** SRTRCM ***
      *
      ** Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SRTRCM'  @STK,Q
      *                                                                   CFT009
      ** If Core switchable feature CFT009 is on then the charge          CFT009
      ** code/amounts will be validated                                   CFT009
      *                                                                   CFT009
     C           CFT009    IFNE 'Y'                                       CFT009
      *
      ** Transfer Commission Charge
      ** --------------------------
      ** Transfer Commission is optional.
      ** If entered must be valid for charge currency details
      *
     C                     Z-ADD0         F7TRCD
     C                     Z-ADD0         F7TRCM
      *
     C           S7TRCD    IFNE *BLANKS
      *
     C           11        SUB  A6NBDP    ZADIG
     C                     Z-ADDA6NBDP    ZADEC
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVELS7TRCD    ZFIELD
      *
     C                     EXSR SRALGN
      *
     C           ZRTN      IFEQ '*ERROR*'
     C                     MOVEL'Y'       E#MSGS
     C           V#CCCY    CAT  S7TRCD    FTMSDT    P
     C                     MOVELE#CPGM    FTPGMQ
     C                     MOVEL'FTM2194' FTMSID
     C                     EXSR FTSNMS
     C                     MOVEL'Y'       I7TRCM
     C                     MOVEL'Y'       E#NOUP
     C                     ELSE
     C                     MOVE ZFIELD    F7TRCD
     C                     ENDIF
      *
     C                     ENDIF
      *                                                                   CFT009
     C                     ELSE                                           CFT009
      *                                                                   CFT009
      ** Charge Code/Amounts will be validated                            CFT009
      *                                                                   CFT009
     C                     Z-ADD13        Z       30                      CFT009
      *                                                                   CFT009
      ** If the screen charge code is not equal to the defaulted          CFT009
      ** file charge code,  then send a warning message                   CFT009
      ** & recalculate charges                                            CFT009
      *                                                                   CFT009
     C                     MOVE S7CDE1    CHGCDE                          CFT009
     C           S7CDE1    IFNE *BLANKS                                   CFT009
     C                     EXSR VALID                                     CFT009
     C           WI7CDE    IFEQ 'Y'                                       CFT009
     C                     MOVE 'Y'       I7CDE1                          CFT009
     C                     ELSE                                           CFT009
     C           S7TRCD    IFEQ *BLANKS                                   CFT009
     C                     EXSR RECALC                                    CFT009
     C                     MOVE ZFIELD    S7TRCD                          CFT009
     C                     Z-ADDTOTCHG    F7TRCD                          CFT009
     C                     Z-ADDTOTCHG    F7TRCM                          CFT009
     C           S7VAT1    IFEQ *BLANK                                    CFT009
     C           VATLIN    IFEQ 'Y'                                       CFT009
     C                     MOVELVATLIN    S7VAT1                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       S7VAT1                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           S7CDE1    IFNE TFCCCD                                    CFT009
     C           WI7CDE    ANDNE'Y'                                       CFT009
     C           WRN@,Z    IFEQ ' '                                       CFT009
     C           S7ACTD    ANDNE'E'                                       CFT009
     C                     MOVEL'Y'       E#WARN                          CFT009
     C                     MOVEL'Y'       E#MSGS                          CFT009
     C                     MOVELS7CDE1    FTMSDT    P                     CFT009
     C                     MOVELE#CPGM    FTPGMQ                          CFT009
     C                     MOVEL'FTF3176' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVEL'Y'       I7CDE1                          CFT009
     C                     MOVEL*BLANKS   E#RSND                          CFT009
     C                     MOVEA'Y'       WRN@,Z                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Transfer Commission is optional.                                 CFT009
      *                                                                   CFT009
     C                     Z-ADD14        Z       30                      CFT009
      *                                                                   CFT009
     C                     Z-ADD0         F7TRCD                          CFT009
     C                     Z-ADD0         F7TRCM                          CFT009
      *                                                                   CFT009
      ** If entered and the file default is blank then send a warning     CFT009
      ** message                                                          CFT009
      *                                                                   CFT009
     C           S7TRCD    IFNE *BLANKS                                   CFT009
      *                                                                   CFT009
      ** Convert screen field to numeric value for comparison             CFT009
      *                                                                   CFT009
     C           *LIKE     DEFN A6SPRT    CVTRAT                          CFT009
     C           *LIKE     DEFN A6NBDP    FRMDEC                          CFT009
     C           *LIKE     DEFN A6NBDP    TODEC                           CFT009
     C           *LIKE     DEFN A6MDIN    FRMMD                           CFT009
      *                                                                   CFT009
      ** Call currency conversion subroutine                              CFT009
      *                                                                   CFT009
     C                     EXSR CCYCNV                                    CFT009
      *                                                                   CFT009
     C           11        SUB  FRMDEC    ZADIG                           CFT009
     C                     Z-ADDFRMDEC    ZADEC                           CFT009
     C                     MOVEL*BLANKS   ZFIELD                          CFT009
     C                     MOVELS7TRCD    ZFIELD                          CFT009
      *                                                                   CFT009
     C                     EXSR SRALGN                                    CFT009
      *                                                                   CFT009
     C           ZRTN      IFEQ '*ERROR*'                                 CFT009
     C                     MOVEL'Y'       E#MSGS                          CFT009
     C           OPCHGC    CAT  S7TRCD    FTMSDT    P                     CFT009
     C                     MOVELE#CPGM    FTPGMQ                          CFT009
     C                     MOVEL'FTF3194' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVEL'Y'       I7TRCM                          CFT009
     C                     MOVEL'Y'       E#NOUP                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE ZFIELD    F7TRCD                          CFT009
     C                     MOVE ZFIELD    INPAMT                          CFT009
      *                                                                   CFT009
      ** Convert file default using screen ccy for comparison of          CFT009
      ** entered field and defaulted                                      CFT009
      *                                                                   CFT009
      ** Set up charge amount and currencies for call to FT000985.        CFT009
      *                                                                   CFT009
     C                     Z-ADDF7TRCD    CHGA85                          CFT009
     C                     MOVELPCCY      PCCY85                          CFT009
     C                     MOVELSMCY      SCCY85                          CFT009
     C                     MOVELOPCHGC    CCCY85                          CFT009
     C                     MOVELLEVIED    LCCY85                          CFT009
     C                     MOVELCVTRAT    RATE85                          CFT009
     C                     Z-ADD0         LCHG                            CFT009
     C                     MOVEL*BLANKS   LCHGF     P                     CFT009
      *                                                                   CFT009
     C                     CALL 'FT000985'                                CFT009
     C                     PARM           RET985 10                       CFT009
     C                     PARM           CHGA85 130                      CFT009
     C                     PARM           PCCY85  3                       CFT009
     C                     PARM           SCCY85  3                       CFT009
     C                     PARM           CCCY85  3                       CFT009
     C                     PARM           LCCY85  3                       CFT009
     C                     PARM           RATE85 138                      CFT009
     C                     PARM           LCHG   130                      CFT009
     C                     PARM           LCHGF  16                       CFT009
      *                                                                   CFT009
      ** Set up amounts                                                   CFT009
      *                                                                   CFT009
     C                     Z-ADDLCHG      OUTAMT                          CFT009
     C                     Z-ADDLCHG      F7TRCM                          CFT009
      *                                                                   CFT009
     C           OUTAMT    IFNE DFTTRM                                    CFT009
     C           WRN@,Z    IFEQ ' '                                       CFT009
     C           S7ACTD    ANDNE'E'                                       CFT009
     C                     MOVEL'Y'       E#WARN                          CFT009
     C                     MOVEL'Y'       E#MSGS                          CFT009
     C                     MOVELS7TRCD    FTMSDT    P                     CFT009
     C                     MOVELE#CPGM    FTPGMQ                          CFT009
     C                     MOVEL'FTF3158' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVEL'Y'       I7TRCM                          CFT009
     C                     MOVEL*BLANKS   E#RSND                          CFT009
     C                     MOVEA'Y'       WRN@,Z                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
      *                                                                   CFT009
      ** If screen field is blank and file field default is not then      CFT009
      ** send warning message to say fields are not the same.             CFT009
      *                                                                   CFT009
     C           MTRCM     IFNE *ZEROS                                    CFT009
     C           WRN@,Z    IFEQ ' '                                       CFT009
     C           S7ACTD    ANDNE'E'                                       CFT009
     C                     MOVEL'Y'       E#WARN                          CFT009
     C                     MOVEL'Y'       E#MSGS                          CFT009
     C                     MOVELS7TRCD    FTMSDT    P                     CFT009
     C                     MOVELE#CPGM    FTPGMQ                          CFT009
     C                     MOVEL'FTF3158' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVEL'Y'       I7TRCM                          CFT009
      *                                                                   CFT009
     C                     MOVEL*BLANKS   E#RSND                          CFT009
     C                     MOVEA'Y'       WRN@,Z                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *
      ** Unwind subroutine stack name
      *
     C           EXTRCM    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      /TITLE SR/SRCHCM
      *****************************************************************
      *                                                               *
      *  SRCHCM - Validate FX/Change Commission                       *
      *                                                               *
      *  Called By: SRPROC subroutine                                 *
      *                                                               *
      *  Calls:                                                       *
      *  SRALGN    - Calls ZALIGN.                                    *
      *  FTSNMS    - Send message to program message queue.           *
      *                                                               *
      *****************************************************************
      *
     C           SRCHCM    BEGSR                           *** SRCHCM ***
      *
      ** Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SRCHCM'  @STK,Q
      *                                                                   CFT009
      ** If Core switchable feature CFT009 is on then the charge          CFT009
      ** code/amounts will be validated                                   CFT009
      *                                                                   CFT009
     C           CFT009    IFNE 'Y'                                       CFT009
      *
      ** FX/Change commission only allowed if Pay and Settle currencies
      ** are different.  If entered must be valid for charge currency
      ** details.
      *
     C                     Z-ADD0         F7CHCD
     C                     Z-ADD0         F7CHCM
      *
      ** If EMU FT Enhancement is switched on then
      ** save work date parameter for call to FT0010 as W#DT
      *
     C           CEU006    IFEQ 'Y'
     C           *LIKE     DEFN V#SLDT    W#DT
     C           V#ADDC    IFEQ 'A'
     C                     Z-ADDV#SLDT    W#DT
     C                     ELSE
     C                     Z-ADDV#PVDT    W#DT
     C                     ENDIF
     C                     ENDIF
      *
     C           S7CHCD    IFNE *BLANKS
      *
     C           V#SMCY    IFNE V#PCCY
      *
      ** If EMU FT  Enhancement is switched on
      ** and both Settle Ccy and Pay Ccy are either 'In' or Euros,
      ** then FX/Change Commission must be zero.
      *
     C           CEU006    IFEQ 'Y'
     C           #INCYS    ANDEQ'Y'
     C           #TPSDS    ANDLEW#DT
     C           V#PCCY    ANDEQBKEURO
     C           CEU006    OREQ 'Y'
     C           #INCYP    ANDEQ'Y'
     C           #TPSDP    ANDLEW#DT
     C           V#SMCY    ANDEQBKEURO
     C           CEU006    OREQ 'Y'
     C           #INCYS    ANDEQ'Y'
     C           #TPSDS    ANDLEW#DT
     C           #INCYP    ANDEQ'Y'
     C           #TPSDP    ANDLEW#DT
     C                     MOVEL'Y'       E#MSGS
     C                     MOVEL*BLANKS   FTMSDT
     C                     MOVELE#CPGM    FTPGMQ
     C                     MOVEL'FTM2599' FTMSID
     C                     EXSR FTSNMS
     C                     MOVEL'Y'       I7CHCM
     C                     MOVEL'Y'       E#NOUP
     C                     ELSE
      *
     C           11        SUB  A6NBDP    ZADIG
     C                     Z-ADDA6NBDP    ZADEC
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVELS7CHCD    ZFIELD
     C                     EXSR SRALGN
      *
     C           ZRTN      IFEQ '*ERROR*'
     C                     MOVEL'Y'       E#MSGS
     C           V#CCCY    CAT  S7CHCD    FTMSDT    P
     C                     MOVELE#CPGM    FTPGMQ
     C                     MOVEL'FTM2520' FTMSID
     C                     EXSR FTSNMS
     C                     MOVEL'Y'       I7CHCM
     C                     MOVEL'Y'       E#NOUP
     C                     ELSE
     C                     MOVE ZFIELD    F7CHCD
     C                     ENDIF
      *
     C                     ENDIF
      *
     C                     ELSE
     C                     MOVEL'Y'       E#MSGS
     C                     MOVEL*BLANKS   FTMSDT
     C                     MOVELE#CPGM    FTPGMQ
     C                     MOVEL'FTM2521' FTMSID
     C                     EXSR FTSNMS
     C                     MOVEL'Y'       I7CHCM
     C                     MOVEL'Y'       E#NOUP
     C                     ENDIF
      *
     C                     ENDIF
      *                                                                   CFT009
     C                     ELSE                                           CFT009
      *                                                                   CFT009
      ** Charge Code/Amounts will be validated                            CFT009
      *                                                                   CFT009
     C           V#SMCY    IFEQ V#PCCY                                    CFT009
     C                     Z-ADD15        Z       30                      CFT009
     C           S7CDE2    IFNE *BLANKS                                   CFT009
     C                     MOVEL'Y'       E#MSGS                          CFT009
     C           V#CCCY    CAT  S7CDE2    FTMSDT    P                     CFT009
     C                     MOVELE#CPGM    FTPGMQ                          CFT009
     C                     MOVEL'FTF3200' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVEL'Y'       I7CDE2                          CFT009
     C                     MOVEL'Y'       E#NOUP                          CFT009
     C                     MOVEL' '       WRN@,Z                          CFT009
     C                     ENDIF                                          CFT009
     C                     Z-ADD16        Z       30                      CFT009
     C                     Z-ADD0         F7CHCD                          CFT009
     C                     Z-ADD0         F7CHCM                          CFT009
     C           S7CHCD    IFNE *BLANKS                                   CFT009
     C                     MOVEL'Y'       E#MSGS                          CFT009
     C           V#CCCY    CAT  S7CHCD    FTMSDT    P                     CFT009
     C                     MOVELE#CPGM    FTPGMQ                          CFT009
     C                     MOVEL'FTF3201' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVEL'Y'       I7CHCM                          CFT009
     C                     MOVEL'Y'       E#NOUP                          CFT009
     C                     MOVEL' '       WRN@,Z                          CFT009
     C                     ENDIF                                          CFT009
     C                     ELSE                                           CFT009
      *                                                                   CFT009
      ** If the screen charge code is not equal to the defaulted          CFT009
      ** file charge code,  then send a warning message                   CFT009
      *                                                                   CFT009
     C                     Z-ADD15        Z       30                      CFT009
     C                     MOVE S7CDE2    CHGCDE                          CFT009
     C           S7CDE2    IFNE *BLANKS                                   CFT009
     C                     EXSR VALID                                     CFT009
     C           WI7CDE    IFEQ 'Y'                                       CFT009
     C                     MOVE 'Y'       I7CDE2                          CFT009
     C                     ELSE                                           CFT009
     C           S7CHCD    IFEQ *BLANKS                                   CFT009
     C                     EXSR RECALC                                    CFT009
     C                     Z-ADDTOTCHG    F7CHCD                          CFT009
     C                     Z-ADDTOTCHG    F7CHCM                          CFT009
     C                     MOVE ZFIELD    S7CHCD                          CFT009
     C           S7VAT7    IFEQ *BLANK                                    CFT009
     C           VATLIN    IFEQ 'Y'                                       CFT009
     C                     MOVELVATLIN    S7VAT7                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       S7VAT7                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C           S7CDE2    IFNE FXCACC                                    CFT009
     C           WI7CDE    ANDNE'Y'                                       CFT009
     C           WRN@,Z    IFEQ ' '                                       CFT009
     C           S7ACTD    ANDNE'E'                                       CFT009
     C                     MOVEL'Y'       E#WARN                          CFT009
     C                     MOVEL'Y'       E#MSGS                          CFT009
     C                     MOVELS7CDE2    FTMSDT    P                     CFT009
     C                     MOVELE#CPGM    FTPGMQ                          CFT009
     C                     MOVEL'FTF3177' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVEL'Y'       I7CDE2                          CFT009
     C                     MOVEL*BLANKS   E#RSND                          CFT009
     C                     MOVEA'Y'       WRN@,Z                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** FX/Change commission only allowed if Pay and Settle currencies   CFT009
      ** are different.  If entered must be valid for charge currency     CFT009
      ** details.                                                         CFT009
      *                                                                   CFT009
     C                     Z-ADD16        Z       30                      CFT009
     C                     Z-ADD0         F7CHCD                          CFT009
     C                     Z-ADD0         F7CHCM                          CFT009
      *                                                                   CFT009
      ** If screen field is entered and the defaulted field is blank      CFT009
      ** then send a warning message to say field is not same as default  CFT009
      *                                                                   CFT009
     C           S7CHCD    IFNE *BLANKS                                   CFT009
      *                                                                   CFT009
      ** Call currency conversion subroutine                              CFT009
      *                                                                   CFT009
     C                     EXSR CCYCNV                                    CFT009
      *                                                                   CFT009
      *                                                                   CFT009
      ** If EMU FT Enhancement is switched on then                        CFT009
      ** save work date parameter for call to FT0010 as W#DT              CFT009
      *                                                                   CFT009
     C           CEU006    IFEQ 'Y'                                       CFT009
     C           V#ADDC    IFEQ 'A'                                       CFT009
     C                     Z-ADDV#SLDT    W#DT                            CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADDV#PVDT    W#DT                            CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           V#SMCY    IFEQ V#PCCY                                    CFT009
     C                     MOVEL'Y'       E#MSGS                          CFT009
     C                     MOVEL*BLANKS   FTMSDT                          CFT009
     C                     MOVELE#CPGM    FTPGMQ                          CFT009
     C                     MOVEL'FTF2521' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVEL'Y'       I7CHCM                          CFT009
     C                     MOVEL'Y'       E#NOUP                          CFT009
     C                     ELSE                                           CFT009
      *                                                                   CFT009
      ** If EMU FT  Enhancement is switched on                            CFT009
      ** and both Settle Ccy and Pay Ccy are either 'In' or Euros,        CFT009
      ** then FX/Change Commission must be zero.                          CFT009
      *                                                                   CFT009
     C           CEU006    IFEQ 'Y'                                       CFT009
     C           #INCYS    ANDEQ'Y'                                       CFT009
     C           #TPSDS    ANDLEW#DT                                      CFT009
     C           V#PCCY    ANDEQBKEURO                                    CFT009
     C           CEU006    OREQ 'Y'                                       CFT009
     C           #INCYP    ANDEQ'Y'                                       CFT009
     C           #TPSDP    ANDLEW#DT                                      CFT009
     C           V#SMCY    ANDEQBKEURO                                    CFT009
     C           CEU006    OREQ 'Y'                                       CFT009
     C           #INCYS    ANDEQ'Y'                                       CFT009
     C           #TPSDS    ANDLEW#DT                                      CFT009
     C           #INCYP    ANDEQ'Y'                                       CFT009
     C           #TPSDP    ANDLEW#DT                                      CFT009
     C                     MOVEL'Y'       E#MSGS                          CFT009
     C                     MOVEL*BLANKS   FTMSDT                          CFT009
     C                     MOVELE#CPGM    FTPGMQ                          CFT009
     C                     MOVEL'FTF3286' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVEL'Y'       I7CHCM                          CFT009
     C                     MOVEL'Y'       E#NOUP                          CFT009
     C                     ELSE                                           CFT009
      *                                                                   CFT009
     C           11        SUB  FRMDEC    ZADIG                           CFT009
     C                     Z-ADDFRMDEC    ZADEC                           CFT009
     C                     MOVEL*BLANKS   ZFIELD                          CFT009
     C                     MOVELS7CHCD    ZFIELD                          CFT009
     C                     EXSR SRALGN                                    CFT009
      *                                                                   CFT009
     C           ZRTN      IFEQ '*ERROR*'                                 CFT009
     C                     MOVEL'Y'       E#MSGS                          CFT009
     C           V#CCCY    CAT  S7CHCD    FTMSDT    P                     CFT009
     C                     MOVELE#CPGM    FTPGMQ                          CFT009
     C                     MOVEL'FTF2520' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVEL'Y'       I7CHCM                          CFT009
     C                     MOVEL'Y'       E#NOUP                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE ZFIELD    F7CHCD                          CFT009
     C                     MOVE ZFIELD    INPAMT                          CFT009
      *                                                                   CFT009
      ** Convert file default using screen ccy for comparison of          CFT009
      ** entered field and defaulted                                      CFT009
      *                                                                   CFT009
      ** Set up charge amount and currencies for call to FT000985.        CFT009
      *                                                                   CFT009
     C                     Z-ADDF7CHCD    CHGA85                          CFT009
     C                     MOVELPCCY      PCCY85                          CFT009
     C                     MOVELSMCY      SCCY85                          CFT009
     C                     MOVELOPCHGC    CCCY85                          CFT009
     C                     MOVELLEVIED    LCCY85                          CFT009
     C                     MOVELCVTRAT    RATE85                          CFT009
     C                     Z-ADD0         LCHG                            CFT009
     C                     MOVEL*BLANKS   LCHGF     P                     CFT009
      *                                                                   CFT009
     C                     CALL 'FT000985'                                CFT009
     C                     PARM           RET985 10                       CFT009
     C                     PARM           CHGA85 130                      CFT009
     C                     PARM           PCCY85  3                       CFT009
     C                     PARM           SCCY85  3                       CFT009
     C                     PARM           CCCY85  3                       CFT009
     C                     PARM           LCCY85  3                       CFT009
     C                     PARM           RATE85 138                      CFT009
     C                     PARM           LCHG   130                      CFT009
     C                     PARM           LCHGF  16                       CFT009
      *                                                                   CFT009
      ** Set up amounts                                                   CFT009
      *                                                                   CFT009
     C                     Z-ADDLCHG      OUTAMT                          CFT009
     C                     Z-ADDLCHG      F7CHCM                          CFT009
      *                                                                   CFT009
     C           DFTFXC    IFNE OUTAMT                                    CFT009
     C           WRN@,Z    IFEQ ' '                                       CFT009
     C           S7ACTD    ANDNE'E'                                       CFT009
     C                     MOVEL'Y'       E#WARN                          CFT009
     C                     MOVEL'Y'       E#MSGS                          CFT009
     C                     MOVELS7CHCD    FTMSDT    P                     CFT009
     C                     MOVELE#CPGM    FTPGMQ                          CFT009
     C                     MOVEL'FTF3159' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVEL'Y'       I7CHCM                          CFT009
     C                     MOVEL*BLANKS   E#RSND                          CFT009
     C                     MOVEA'Y'       WRN@,Z                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** If screen field is blank and file field default is not then      CFT009
      ** send warning message to say fields are not the same.             CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
      *                                                                   CFT009
     C           MOCHCM    IFNE *ZEROS                                    CFT009
     C           WRN@,Z    IFEQ ' '                                       CFT009
     C           S7ACTD    ANDNE'E'                                       CFT009
     C                     MOVEL'Y'       E#WARN                          CFT009
     C                     MOVEL'Y'       E#MSGS                          CFT009
     C                     MOVELS7CHCD    FTMSDT    P                     CFT009
     C                     MOVELE#CPGM    FTPGMQ                          CFT009
     C                     MOVEL'FTF3159' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVEL'Y'       I7CHCM                          CFT009
      *                                                                   CFT009
     C                     MOVEL*BLANKS   E#RSND                          CFT009
     C                     MOVEA'Y'       WRN@,Z                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *
      ** Unwind subroutine stack name
      *
     C           EXCHCM    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      /TITLE SR/SRTXCH
      *****************************************************************
      *                                                               *
      *  SRTXCH - Validate Telex Charges                              *
      *                                                               *
      *  Called By: SRPROC subroutine                                 *
      *                                                               *
      *  Calls:                                                       *
      *  SRALGN    - Calls ZALIGN.                                    *
      *  FTSNMS    - Send message to program message queue.           *
      *                                                               *
      *****************************************************************
      *
     C           SRTXCH    BEGSR                           *** SRTXCH ***
      *
      ** Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SRTXCH'  @STK,Q
      *                                                                   CFT009
      ** If Core switchable feature CFT009 is on then the charge          CFT009
      ** code/amounts will be validated                                   CFT009
      *                                                                   CFT009
     C           CFT009    IFNE 'Y'                                       CFT009
      *
      ** Telex Charge is mandatory, on insert only, if settlement
      ** type is '01'
      *
     C                     Z-ADD0         F7TXCD
     C                     Z-ADD0         F7TXCH
      *
     C           V#STMT    IFEQ '01'
     C           S7TXCD    ANDEQ*BLANKS
     C           S7ACTD    ANDEQ'I'
     C                     MOVEL'Y'       E#MSGS
     C           V#CCCY    CAT  S7TXCD    FTMSDT    P
     C                     MOVELE#CPGM    FTPGMQ
     C                     MOVEL'FTM2196' FTMSID
     C                     EXSR FTSNMS
     C                     MOVEL'Y'       I7TXCH
     C                     MOVEL'Y'       E#NOUP
     C                     GOTO EXTXCH
     C                     ENDIF
      *
     C           S7TXCD    IFNE *BLANKS
      *
     C           11        SUB  A6NBDP    ZADIG
     C                     Z-ADDA6NBDP    ZADEC
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVELS7TXCD    ZFIELD
     C                     EXSR SRALGN
      *
     C           ZRTN      IFEQ '*ERROR*'
     C                     MOVEL'Y'       E#MSGS
     C           V#CCCY    CAT  S7TXCD    FTMSDT    P
     C                     MOVELE#CPGM    FTPGMQ
     C                     MOVEL'FTM2195' FTMSID
     C                     EXSR FTSNMS
     C                     MOVEL'Y'       I7TXCH
     C                     MOVEL'Y'       E#NOUP
     C                     ELSE
     C                     MOVE ZFIELD    F7TXCD
     C                     ENDIF
      *
     C                     ENDIF
      *                                                                   CFT009
      ** Charge Code/Amounts will be validated                            CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
      *                                                                   CFT009
     C                     Z-ADD17        Z       30                      CFT009
      *                                                                   CFT009
      ** If the screen charge code is not equal to the defaulted          CFT009
      ** file charge code,  then send a warning message                   CFT009
      *                                                                   CFT009
     C                     MOVE S7CDE3    CHGCDE                          CFT009
     C           S7CDE3    IFNE *BLANKS                                   CFT009
     C                     EXSR VALID                                     CFT009
     C           WI7CDE    IFEQ 'Y'                                       CFT009
     C                     MOVE 'Y'       I7CDE3                          CFT009
     C                     ELSE                                           CFT009
     C           S7TXCD    IFEQ *BLANKS                                   CFT009
     C                     EXSR RECALC                                    CFT009
     C                     MOVE ZFIELD    S7TXCD                          CFT009
     C                     Z-ADDTOTCHG    F7TXCD                          CFT009
     C                     Z-ADDTOTCHG    F7TXCH                          CFT009
     C           S7VAT2    IFEQ *BLANK                                    CFT009
     C           VATLIN    IFEQ 'Y'                                       CFT009
     C                     MOVELVATLIN    S7VAT2                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       S7VAT2                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C           S7CDE3    IFNE TLXCDE                                    CFT009
     C           WI7CDE    ANDNE'Y'                                       CFT009
     C           WRN@,Z    IFEQ ' '                                       CFT009
     C           S7ACTD    ANDNE'E'                                       CFT009
     C                     MOVEL'Y'       E#WARN                          CFT009
     C                     MOVEL'Y'       E#MSGS                          CFT009
     C                     MOVELS7CDE3    FTMSDT    P                     CFT009
     C                     MOVELE#CPGM    FTPGMQ                          CFT009
     C                     MOVEL'FTF3178' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVEL'Y'       I7CDE3                          CFT009
     C                     MOVEL*BLANKS   E#RSND                          CFT009
     C                     MOVEA'Y'       WRN@,Z                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     Z-ADD18        Z       30                      CFT009
     C                     Z-ADD0         F7TXCD                          CFT009
     C                     Z-ADD0         F7TXCH                          CFT009
      *                                                                   CFT009
      ** Telex Charge is mandatory, on insert only, if settlement         CFT009
      ** type is '01'                                                     CFT009
      *                                                                   CFT009
     C           V#STMT    IFEQ '01'                                      CFT009
     C           S7TXCD    ANDEQ*BLANKS                                   CFT009
     C           S7ACTD    ANDEQ'I'                                       CFT009
     C                     MOVEL'Y'       E#MSGS                          CFT009
     C           V#CCCY    CAT  S7TXCD    FTMSDT    P                     CFT009
     C                     MOVELE#CPGM    FTPGMQ                          CFT009
     C                     MOVEL'FTF2196' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVEL'Y'       I7TXCH                          CFT009
     C                     MOVEL'Y'       E#NOUP                          CFT009
     C                     GOTO EXTXCH                                    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** If screen field is entered and the defaulted field is blank      CFT009
      ** then send a warning message to say field is not same as default  CFT009
      *                                                                   CFT009
     C           S7TXCD    IFNE *BLANKS                                   CFT009
      *                                                                   CFT009
      ** Call currency conversion subroutine                              CFT009
      *                                                                   CFT009
     C                     EXSR CCYCNV                                    CFT009
      *                                                                   CFT009
     C           11        SUB  FRMDEC    ZADIG                           CFT009
     C                     Z-ADDFRMDEC    ZADEC                           CFT009
     C                     MOVEL*BLANKS   ZFIELD                          CFT009
     C                     MOVELS7TXCD    ZFIELD                          CFT009
     C                     EXSR SRALGN                                    CFT009
      *                                                                   CFT009
     C           ZRTN      IFEQ '*ERROR*'                                 CFT009
     C                     MOVEL'Y'       E#MSGS                          CFT009
     C           V#CCCY    CAT  S7TXCD    FTMSDT    P                     CFT009
     C                     MOVELE#CPGM    FTPGMQ                          CFT009
     C                     MOVEL'FTF2195' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVEL'Y'       I7TXCH                          CFT009
     C                     MOVEL'Y'       E#NOUP                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE ZFIELD    F7TXCD                          CFT009
     C                     MOVE ZFIELD    INPAMT                          CFT009
      *                                                                   CFT009
      ** Convert file default using screen ccy for comparison of          CFT009
      ** entered field and defaulted                                      CFT009
      *                                                                   CFT009
      ** Set up charge amount and currencies for call to FT000985.        CFT009
      *                                                                   CFT009
     C                     Z-ADDF7TXCD    CHGA85                          CFT009
     C                     MOVELPCCY      PCCY85                          CFT009
     C                     MOVELSMCY      SCCY85                          CFT009
     C                     MOVELOPCHGC    CCCY85                          CFT009
     C                     MOVELLEVIED    LCCY85                          CFT009
     C                     MOVELCVTRAT    RATE85                          CFT009
     C                     Z-ADD0         LCHG                            CFT009
     C                     MOVEL*BLANKS   LCHGF     P                     CFT009
      *                                                                   CFT009
     C                     CALL 'FT000985'                                CFT009
     C                     PARM           RET985 10                       CFT009
     C                     PARM           CHGA85 130                      CFT009
     C                     PARM           PCCY85  3                       CFT009
     C                     PARM           SCCY85  3                       CFT009
     C                     PARM           CCCY85  3                       CFT009
     C                     PARM           LCCY85  3                       CFT009
     C                     PARM           RATE85 138                      CFT009
     C                     PARM           LCHG   130                      CFT009
     C                     PARM           LCHGF  16                       CFT009
      *                                                                   CFT009
      ** Set up amounts                                                   CFT009
      *                                                                   CFT009
     C                     Z-ADDLCHG      OUTAMT                          CFT009
     C                     Z-ADDLCHG      F7TXCH                          CFT009
      *                                                                   CFT009
     C           DFTTLX    IFNE OUTAMT                                    CFT009
     C           WRN@,Z    IFEQ ' '                                       CFT009
     C           S7ACTD    ANDNE'E'                                       CFT009
     C                     MOVEL'Y'       E#WARN                          CFT009
     C                     MOVEL'Y'       E#MSGS                          CFT009
     C                     MOVELS7TXCD    FTMSDT    P                     CFT009
     C                     MOVELE#CPGM    FTPGMQ                          CFT009
     C                     MOVEL'FTF3160' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVEL'Y'       I7TXCH                          CFT009
     C                     MOVEL*BLANKS   E#RSND                          CFT009
     C                     MOVEA'Y'       WRN@,Z                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** If screen field is blank and file field default is not then      CFT009
      ** send warning message to say fields are not the same.             CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
      *                                                                   CFT009
     C           MTXCH     IFNE *ZEROS                                    CFT009
     C           WRN@,Z    IFEQ ' '                                       CFT009
     C           S7ACTD    ANDNE'E'                                       CFT009
     C                     MOVEL'Y'       E#WARN                          CFT009
     C                     MOVEL'Y'       E#MSGS                          CFT009
     C                     MOVELS7TXCD    FTMSDT    P                     CFT009
     C                     MOVELE#CPGM    FTPGMQ                          CFT009
     C                     MOVEL'FTF3160' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVEL'Y'       I7TXCH                          CFT009
     C                     MOVEL*BLANKS   E#RSND                          CFT009
     C                     MOVEA'Y'       WRN@,Z                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *
      ** Unwind subroutine stack name
      *
     C           EXTXCH    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      /TITLE SR/SRCQCH
      *****************************************************************
      *                                                               *
      *  SRCQCH - Validate Cheque Charges                             *
      *                                                               *
      *  Called By: SRPROC Subroutine                                 *
      *                                                               *
      *  Calls:                                                       *
      *  SRALGN    - Calls ZALIGN.                                    *
      *  FTSNMS    - Send message to program message queue.           *
      *                                                               *
      *****************************************************************
      *
     C           SRCQCH    BEGSR                           *** SRCQCH ***
      *
      ** Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SRCQCH'  @STK,Q
      *                                                                   CFT009
      ** If Core switchable feature CFT009 is on then the charge          CFT009
      ** code/amounts will be validated                                   CFT009
      *                                                                   CFT009
     C           CFT009    IFNE 'Y'                                       CFT009
      *
      ** Cheque Charge is optional.
      ** If entered must be valid for charge currency details
      *
     C                     Z-ADD0         F7CQCD
     C                     Z-ADD0         F7CQCH
      *
     C           S7CQCD    IFNE *BLANKS
      *
     C           11        SUB  A6NBDP    ZADIG
     C                     Z-ADDA6NBDP    ZADEC
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVELS7CQCD    ZFIELD
     C                     EXSR SRALGN
      *
     C           ZRTN      IFEQ '*ERROR*'
     C                     MOVEL'Y'       E#MSGS
     C           V#CCCY    CAT  S7CQCD    FTMSDT    P
     C                     MOVELE#CPGM    FTPGMQ
     C                     MOVEL'FTM2197' FTMSID
     C                     EXSR FTSNMS
     C                     MOVEL'Y'       I7CQCH
     C                     MOVEL'Y'       E#NOUP
     C                     ELSE
     C                     MOVE ZFIELD    F7CQCD
     C                     ENDIF
      *
     C                     ENDIF
      *                                                                   CFT009
     C                     ELSE                                           CFT009
      *                                                                   CFT009
      ** Charge Code/Amounts will be validated                            CFT009
      *                                                                   CFT009
     C                     Z-ADD19        Z       30                      CFT009
     C                     Z-ADD0         F7CQCD                          CFT009
     C                     Z-ADD0         F7CQCH                          CFT009
      *                                                                   CFT009
      ** If the screen charge code is not equal to the defaulted          CFT009
      ** file charge code,  then send a warning message                   CFT009
      *                                                                   CFT009
      ** Cheque Charge code is optional,but may only be entered for       CFT009
      ** settlement method 12 or 13                                       CFT009
      *                                                                   CFT009
     C           V#STMT    IFNE '12'                                      CFT009
     C           V#STMT    ANDNE'13'                                      CFT009
     C           S7CDE4    IFNE *BLANKS                                   CFT009
     C                     MOVEL'Y'       E#MSGS                          CFT009
     C           V#CCCY    CAT  S7CDE4    FTMSDT    P                     CFT009
     C                     MOVELE#CPGM    FTPGMQ                          CFT009
     C                     MOVEL'FTF3165' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVEL'Y'       I7CDE4                          CFT009
     C                     MOVEL'Y'       E#NOUP                          CFT009
     C                     MOVEA' '       WRN@,Z                          CFT009
     C                     ENDIF                                          CFT009
     C                     Z-ADD20        Z       30                      CFT009
     C           S7CQCD    IFNE *BLANKS                                   CFT009
     C                     MOVEL'Y'       E#MSGS                          CFT009
     C           V#CCCY    CAT  S7CQCD    FTMSDT    P                     CFT009
     C                     MOVELE#CPGM    FTPGMQ                          CFT009
     C                     MOVEL'FTF3197' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVEL'Y'       I7CQCH                          CFT009
     C                     MOVEL'Y'       E#NOUP                          CFT009
     C                     MOVEA' '       WRN@,Z                          CFT009
     C                     ENDIF                                          CFT009
     C                     ELSE                                           CFT009
      *                                                                   CFT009
     C                     Z-ADD19        Z       30                      CFT009
     C                     MOVE S7CDE4    CHGCDE                          CFT009
     C           S7CDE4    IFNE *BLANKS                                   CFT009
     C                     EXSR VALID                                     CFT009
     C           WI7CDE    IFEQ 'Y'                                       CFT009
     C                     MOVE 'Y'       I7CDE4                          CFT009
     C                     ELSE                                           CFT009
     C           S7CQCD    IFEQ *BLANKS                                   CFT009
     C                     EXSR RECALC                                    CFT009
     C                     MOVE ZFIELD    S7CQCD                          CFT009
     C                     Z-ADDTOTCHG    F7CQCD                          CFT009
     C                     Z-ADDTOTCHG    F7CQCH                          CFT009
     C           S7VAT3    IFEQ *BLANK                                    CFT009
     C           VATLIN    IFEQ 'Y'                                       CFT009
     C                     MOVELVATLIN    S7VAT3                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       S7VAT3                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C           S7CDE4    IFNE CHQCHC                                    CFT009
     C           WI7CDE    ANDNE'Y'                                       CFT009
     C           WRN@,Z    IFEQ ' '                                       CFT009
     C           S7ACTD    ANDNE'E'                                       CFT009
     C                     MOVEL'Y'       E#WARN                          CFT009
     C                     MOVEL'Y'       E#MSGS                          CFT009
     C                     MOVELS7CDE4    FTMSDT    P                     CFT009
     C                     MOVELE#CPGM    FTPGMQ                          CFT009
     C                     MOVEL'FTF3179' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVEL'Y'       I7CDE4                          CFT009
     C                     MOVEL*BLANKS   E#RSND                          CFT009
     C                     MOVEA'Y'       WRN@,Z                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Cheque Charge is optional.                                       CFT009
      *                                                                   CFT009
     C                     Z-ADD20        Z       30                      CFT009
      *                                                                   CFT009
      ** If screen field is entered and the defaulted field is blank      CFT009
      ** then send a warning message to say field is not same as default  CFT009
      *                                                                   CFT009
     C           S7CQCD    IFNE *BLANKS                                   CFT009
      *                                                                   CFT009
      ** Call currency conversion subroutine                              CFT009
      *                                                                   CFT009
     C                     EXSR CCYCNV                                    CFT009
      *                                                                   CFT009
     C           11        SUB  FRMDEC    ZADIG                           CFT009
     C                     Z-ADDFRMDEC    ZADEC                           CFT009
     C                     MOVEL*BLANKS   ZFIELD                          CFT009
     C                     MOVELS7CQCD    ZFIELD                          CFT009
     C                     EXSR SRALGN                                    CFT009
      *                                                                   CFT009
     C           ZRTN      IFEQ '*ERROR*'                                 CFT009
     C                     MOVEL'Y'       E#MSGS                          CFT009
     C           V#CCCY    CAT  S7CQCD    FTMSDT    P                     CFT009
     C                     MOVELE#CPGM    FTPGMQ                          CFT009
     C                     MOVEL'FTF2197' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVEL'Y'       I7CQCH                          CFT009
     C                     MOVEL'Y'       E#NOUP                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE ZFIELD    F7CQCD                          CFT009
     C                     MOVE ZFIELD    INPAMT                          CFT009
      *                                                                   CFT009
      ** Convert file default using screen ccy for comparison of          CFT009
      ** entered field and defaulted                                      CFT009
      *                                                                   CFT009
      ** Set up charge amount and currencies for call to FT000985.        CFT009
      *                                                                   CFT009
     C                     Z-ADDF7CQCD    CHGA85                          CFT009
     C                     MOVELPCCY      PCCY85                          CFT009
     C                     MOVELSMCY      SCCY85                          CFT009
     C                     MOVELOPCHGC    CCCY85                          CFT009
     C                     MOVELLEVIED    LCCY85                          CFT009
     C                     MOVELCVTRAT    RATE85                          CFT009
     C                     Z-ADD0         LCHG                            CFT009
     C                     MOVEL*BLANKS   LCHGF     P                     CFT009
      *                                                                   CFT009
     C                     CALL 'FT000985'                                CFT009
     C                     PARM           RET985 10                       CFT009
     C                     PARM           CHGA85 130                      CFT009
     C                     PARM           PCCY85  3                       CFT009
     C                     PARM           SCCY85  3                       CFT009
     C                     PARM           CCCY85  3                       CFT009
     C                     PARM           LCCY85  3                       CFT009
     C                     PARM           RATE85 138                      CFT009
     C                     PARM           LCHG   130                      CFT009
     C                     PARM           LCHGF  16                       CFT009
      *                                                                   CFT009
      ** Set up amounts                                                   CFT009
      *                                                                   CFT009
     C                     Z-ADDLCHG      OUTAMT                          CFT009
     C                     Z-ADDLCHG      F7CQCH                          CFT009
      *                                                                   CFT009
     C           DFTCQC    IFNE F7CQCH                                    CFT009
     C           WRN@,Z    IFEQ ' '                                       CFT009
     C           S7ACTD    ANDNE'E'                                       CFT009
     C                     MOVEL'Y'       E#WARN                          CFT009
     C                     MOVEL'Y'       E#MSGS                          CFT009
     C                     MOVELS7CQCD    FTMSDT    P                     CFT009
     C                     MOVELE#CPGM    FTPGMQ                          CFT009
     C                     MOVEL'FTF3161' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVEL'Y'       I7CQCH                          CFT009
     C                     MOVEL*BLANKS   E#RSND                          CFT009
     C                     MOVEA'Y'       WRN@,Z                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
      *                                                                   CFT009
      ** If screen field is blank and file field default is not then      CFT009
      ** send warning message to say fields are not the same.             CFT009
      *                                                                   CFT009
     C           MCQCH     IFNE *ZEROS                                    CFT009
     C           WRN@,Z    IFEQ ' '                                       CFT009
     C           S7ACTD    ANDNE'E'                                       CFT009
     C                     MOVEL'Y'       E#WARN                          CFT009
     C                     MOVEL'Y'       E#MSGS                          CFT009
     C                     MOVELS7CQCD    FTMSDT    P                     CFT009
     C                     MOVELE#CPGM    FTPGMQ                          CFT009
     C                     MOVEL'FTF3161' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVEL'Y'       I7CQCH                          CFT009
     C                     MOVEL*BLANKS   E#RSND                          CFT009
     C                     MOVEA'Y'       WRN@,Z                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *
      ** Unwind subroutine stack name
      *
     C           EXCQCH    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      /TITLE SR/SRCSTH
      *****************************************************************
      *                                                               *
      *  SRCSTH - Validate Costs Abroad                               *
      *                                                               *
      *  Called By: SRPROC Subroutine                                 *
      *                                                               *
      *  Calls:                                                       *
      *  SRALGN    - Calls ZALIGN.                                    *
      *  FTSNMS    - Send message to program message queue.           *
      *                                                               *
      *****************************************************************
      *
     C           SRCSTH    BEGSR                           *** SRCSTH ***
      *
      ** Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SRCSTH'  @STK,Q
      *                                                                   CFT009
      ** If Core switchable feature CFT009 is on then the charge          CFT009
      ** code/amounts will be validated                                   CFT009
      *                                                                   CFT009
     C           CFT009    IFNE 'Y'                                       CFT009
      *
      ** Costs Abroad is optional.
      ** If entered must be valid for charge currency details
      *
     C                     Z-ADD0         F7CSTD
     C                     Z-ADD0         F7CSTA
      *
     C           S7CSTD    IFNE *BLANKS
      *
     C           11        SUB  A6NBDP    ZADIG
     C                     Z-ADDA6NBDP    ZADEC
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVELS7CSTD    ZFIELD
     C                     EXSR SRALGN
      *
     C           ZRTN      IFEQ '*ERROR*'
     C                     MOVEL'Y'       E#MSGS
     C           V#CCCY    CAT  S7CSTD    FTMSDT    P
     C                     MOVELE#CPGM    FTPGMQ
     C                     MOVEL'FTM2198' FTMSID
     C                     EXSR FTSNMS
     C                     MOVEL'Y'       I7CSTH
     C                     MOVEL'Y'       E#NOUP
     C                     ELSE
     C                     MOVE ZFIELD    F7CSTD
     C                     ENDIF
      *
     C                     ENDIF
      *                                                                   CFT009
     C                     ELSE                                           CFT009
      *                                                                   CFT009
      ** Charge Code/Amounts will be validated                            CFT009
      *                                                                   CFT009
     C                     Z-ADD21        Z       30                      CFT009
      *                                                                   CFT009
      ** If the screen charge code is not equal to the defaulted          CFT009
      ** file charge code,  then send a warning message                   CFT009
      *                                                                   CFT009
     C                     MOVE S7CDE5    CHGCDE                          CFT009
     C           S7CDE5    IFNE *BLANKS                                   CFT009
     C                     EXSR VALID                                     CFT009
     C           WI7CDE    IFEQ 'Y'                                       CFT009
     C                     MOVE 'Y'       I7CDE5                          CFT009
     C                     ELSE                                           CFT009
     C           S7CSTD    IFEQ *BLANKS                                   CFT009
     C                     EXSR RECALC                                    CFT009
     C                     MOVE ZFIELD    S7CSTD                          CFT009
     C                     Z-ADDTOTCHG    F7CSTD                          CFT009
     C                     Z-ADDTOTCHG    F7CSTA                          CFT009
     C           S7VAT4    IFEQ *BLANK                                    CFT009
     C           VATLIN    IFEQ 'Y'                                       CFT009
     C                     MOVELVATLIN    S7VAT4                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       VATLIN                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C           S7CDE5    IFNE CACHCD                                    CFT009
     C           WI7CDE    ANDNE'Y'                                       CFT009
     C           WRN@,Z    IFEQ ' '                                       CFT009
     C           S7ACTD    ANDNE'E'                                       CFT009
     C                     MOVEL'Y'       E#WARN                          CFT009
     C                     MOVEL'Y'       E#MSGS                          CFT009
     C                     MOVELS7CDE5    FTMSDT    P                     CFT009
     C                     MOVELE#CPGM    FTPGMQ                          CFT009
     C                     MOVEL'FTF3180' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVEL'Y'       I7CDE5                          CFT009
     C                     MOVEL*BLANKS   E#RSND                          CFT009
     C                     MOVEA'Y'       WRN@,Z                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Costs Abroad is optional.                                        CFT009
      *                                                                   CFT009
     C                     Z-ADD22        Z       30                      CFT009
     C                     Z-ADD0         F7CSTD                          CFT009
     C                     Z-ADD0         F7CSTA                          CFT009
      *                                                                   CFT009
      ** If screen field is entered and the defaulted field is blank      CFT009
      ** then send a warning message to say field is not same as default  CFT009
      *                                                                   CFT009
     C           S7CSTD    IFNE *BLANKS                                   CFT009
      *                                                                   CFT009
      ** Call currency conversion subroutine                              CFT009
      *                                                                   CFT009
     C                     EXSR CCYCNV                                    CFT009
      *                                                                   CFT009
      *                                                                   CFT009
     C           11        SUB  FRMDEC    ZADIG                           CFT009
     C                     Z-ADDFRMDEC    ZADEC                           CFT009
     C                     MOVEL*BLANKS   ZFIELD                          CFT009
     C                     MOVELS7CSTD    ZFIELD                          CFT009
     C                     EXSR SRALGN                                    CFT009
      *                                                                   CFT009
     C           ZRTN      IFEQ '*ERROR*'                                 CFT009
     C                     MOVEL'Y'       E#MSGS                          CFT009
     C           V#CCCY    CAT  S7CSTD    FTMSDT    P                     CFT009
     C                     MOVELE#CPGM    FTPGMQ                          CFT009
     C                     MOVEL'FTF2198' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVEL'Y'       I7CSTH                          CFT009
     C                     MOVEL'Y'       E#NOUP                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE ZFIELD    F7CSTD                          CFT009
     C                     MOVE ZFIELD    INPAMT                          CFT009
      *                                                                   CFT009
      ** Convert file default using screen ccy for comparison of          CFT009
      ** entered field and defaulted                                      CFT009
      *                                                                   CFT009
      ** Set up charge amount and currencies for call to FT000985.        CFT009
      *                                                                   CFT009
     C                     Z-ADDF7CSTD    CHGA85                          CFT009
     C                     MOVELPCCY      PCCY85                          CFT009
     C                     MOVELSMCY      SCCY85                          CFT009
     C                     MOVELOPCHGC    CCCY85                          CFT009
     C                     MOVELLEVIED    LCCY85                          CFT009
     C                     MOVELCVTRAT    RATE85                          CFT009
     C                     Z-ADD0         LCHG                            CFT009
     C                     MOVEL*BLANKS   LCHGF     P                     CFT009
      *                                                                   CFT009
     C                     CALL 'FT000985'                                CFT009
     C                     PARM           RET985 10                       CFT009
     C                     PARM           CHGA85 130                      CFT009
     C                     PARM           PCCY85  3                       CFT009
     C                     PARM           SCCY85  3                       CFT009
     C                     PARM           CCCY85  3                       CFT009
     C                     PARM           LCCY85  3                       CFT009
     C                     PARM           RATE85 138                      CFT009
     C                     PARM           LCHG   130                      CFT009
     C                     PARM           LCHGF  16                       CFT009
      *                                                                   CFT009
      ** Set up amounts                                                   CFT009
      *                                                                   CFT009
     C                     Z-ADDLCHG      OUTAMT                          CFT009
     C                     Z-ADDLCHG      F7CSTA                          CFT009
      *                                                                   CFT009
     C           DFTCSA    IFNE OUTAMT                                    CFT009
     C           WRN@,Z    IFEQ ' '                                       CFT009
     C           S7ACTD    ANDNE'E'                                       CFT009
     C                     MOVEL'Y'       E#WARN                          CFT009
     C                     MOVEL'Y'       E#MSGS                          CFT009
     C                     MOVELS7CSTD    FTMSDT    P                     CFT009
     C                     MOVELE#CPGM    FTPGMQ                          CFT009
     C                     MOVEL'FTF3162' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVEL'Y'       I7CSTH                          CFT009
     C                     MOVEL*BLANKS   E#RSND                          CFT009
     C                     MOVEA'Y'       WRN@,Z                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
      *                                                                   CFT009
      ** If screen field is blank and file field default is not then      CFT009
      ** send warning message to say fields are not the same.             CFT009
      *                                                                   CFT009
     C           DFTCSA    IFNE *ZEROS                                    CFT009
     C           WRN@,Z    IFEQ ' '                                       CFT009
     C           S7ACTD    ANDNE'E'                                       CFT009
     C                     MOVEL'Y'       E#WARN                          CFT009
     C                     MOVEL'Y'       E#MSGS                          CFT009
     C                     MOVELS7CSTD    FTMSDT    P                     CFT009
     C                     MOVELE#CPGM    FTPGMQ                          CFT009
     C                     MOVEL'FTF3162' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVEL'Y'       I7CSTH                          CFT009
      *                                                                   CFT009
     C                     MOVEL*BLANKS   E#RSND                          CFT009
     C                     MOVEA'Y'       WRN@,Z                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *
      ** Unwind subroutine stack name
      *
     C           EXCSTH    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      /TITLE SR/SRSPCH
      *****************************************************************
      *                                                               *
      *  SRSPCH - Validate SWIFT Priority Charge                      *
      *                                                               *
      *  Called By: SRPROC Subroutine                                 *
      *                                                               *
      *  Calls:                                                       *
      *  SRALGN    - Calls ZALIGN.                                    *
      *  FTSNMS    - Send message to program message queue.           *
      *                                                               *
      *****************************************************************
      *
     C           SRSPCH    BEGSR                           *** SRSPCH ***
      *
      ** Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SRSPCH'  @STK,Q
      *                                                                   CFT009
      ** If Core switchable feature CFT009 is on then the charge          CFT009
      ** code/amounts will be validated                                   CFT009
      *                                                                   CFT009
     C           CFT009    IFNE 'Y'                                       CFT009
      *
      ** SWIFT Priority charge is optional.
      ** If entered must be valid for charge currency details
      *
     C                     Z-ADD0         F7SPCD
     C                     Z-ADD0         F7SPCH
      *
     C           S7SPCD    IFNE *BLANKS
      *
     C           11        SUB  A6NBDP    ZADIG
     C                     Z-ADDA6NBDP    ZADEC
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVELS7SPCD    ZFIELD
     C                     EXSR SRALGN
      *
     C           ZRTN      IFEQ '*ERROR*'
     C                     MOVEL'Y'       E#MSGS
     C           V#CCCY    CAT  S7SPCD    FTMSDT    P
     C                     MOVELE#CPGM    FTPGMQ
     C                     MOVEL'FTM2199' FTMSID
     C                     EXSR FTSNMS
     C                     MOVEL'Y'       I7SPCH
     C                     MOVEL'Y'       E#NOUP
     C                     ELSE
     C                     MOVE ZFIELD    F7SPCD
     C                     ENDIF
      *
     C                     ENDIF
      *                                                                   CFT009
  1  C                     ELSE                                           CFT009
      *                                                                   CFT009
      ** Charge Code/Amounts will be validated                            CFT009
      *                                                                   CFT009
     C                     Z-ADD23        Z       30                      CFT009
     C                     Z-ADD0         F7SPCD                          CFT009
     C                     Z-ADD0         F7SPCH                          CFT009
      *                                                                   CFT009
      ** If the screen charge code is not equal to the defaulted          CFT009
      ** file charge code, then send a warning message                    CFT009
      *                                                                   CFT009
      *                                                                   CFT009
      ** SWIFT Priority code is optional,but may only be entered if       CFT009
      ** priority code is'U'                                              CFT009
      *                                                                   CFT009
     C           V#SWPC    IFNE 1                                         CFT009
     C           S7CDE7    IFNE *BLANKS                                   CFT009
     C                     MOVEL'Y'       E#MSGS                          CFT009
     C           V#CCCY    CAT  S7CDE7    FTMSDT    P                     CFT009
     C                     MOVELE#CPGM    FTPGMQ                          CFT009
     C                     MOVEL'FTF3166' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVEL'Y'       I7CDE7                          CFT009
     C                     MOVEL'Y'       E#NOUP                          CFT009
     C                     MOVEA' '       WRN@,Z                          CFT009
     C                     ENDIF                                          CFT009
     C                     Z-ADD24        Z       30                      CFT009
     C           S7SPCD    IFNE *BLANKS                                   CFT009
     C                     MOVEL'Y'       E#MSGS                          CFT009
     C           V#CCCY    CAT  S7SPCD    FTMSDT    P                     CFT009
     C                     MOVELE#CPGM    FTPGMQ                          CFT009
     C                     MOVEL'FTF3198' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVEL'Y'       I7SPCH                          CFT009
     C                     MOVEL'Y'       E#NOUP                          CFT009
     C                     MOVEA' '       WRN@,Z                          CFT009
     C                     ENDIF                                          CFT009
     C                     ELSE                                           CFT009
      *                                                                   CFT009
     C                     Z-ADD23        Z       30                      CFT009
     C                     MOVE S7CDE7    CHGCDE                          CFT009
     C           S7CDE7    IFNE *BLANKS                                   CFT009
     C                     EXSR VALID                                     CFT009
     C           WI7CDE    IFEQ 'Y'                                       CFT009
     C                     MOVE 'Y'       I7CDE7                          CFT009
     C                     ELSE                                           CFT009
     C           S7SPCD    IFEQ *BLANKS                                   CFT009
     C                     EXSR RECALC                                    CFT009
     C                     MOVE ZFIELD    S7SPCD                          CFT009
     C                     Z-ADDTOTCHG    F7SPCD                          CFT009
     C                     Z-ADDTOTCHG    F7SPCH                          CFT009
     C           S7VAT5    IFEQ *BLANK                                    CFT009
     C           VATLIN    IFEQ 'Y'                                       CFT009
     C                     MOVELVATLIN    S7VAT5                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       S7VAT5                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C           S7CDE7    IFNE SPRCCD                                    CFT009
     C           WI7CDE    ANDNE'Y'                                       CFT009
     C           WRN@,Z    IFEQ ' '                                       CFT009
     C           S7ACTD    ANDNE'E'                                       CFT009
     C                     MOVEL'Y'       E#WARN                          CFT009
     C                     MOVEL'Y'       E#MSGS                          CFT009
     C                     MOVELS7CDE7    FTMSDT    P                     CFT009
     C                     MOVELE#CPGM    FTPGMQ                          CFT009
     C                     MOVEL'FTF3181' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVEL'Y'       I7CDE7                          CFT009
     C                     MOVEL*BLANKS   E#RSND                          CFT009
     C                     MOVEA'Y'       WRN@,Z                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      *                                                                   CFT009
      ** SWIFT Priority charge is optional.                               CFT009
      *                                                                   CFT009
     C                     Z-ADD24        Z       30                      CFT009
      *                                                                   CFT009
      ** If screen field is entered and the defaulted field is blank      CFT009
      ** then send a warning message to say field is not same as default  CFT009
      *                                                                   CFT009
     C           S7SPCD    IFNE *BLANKS                                   CFT009
      *                                                                   CFT009
      ** Call currency conversion subroutine                              CFT009
      *                                                                   CFT009
     C                     EXSR CCYCNV                                    CFT009
      *                                                                   CFT009
     C           11        SUB  FRMDEC    ZADIG                           CFT009
     C                     Z-ADDFRMDEC    ZADEC                           CFT009
     C                     MOVEL*BLANKS   ZFIELD                          CFT009
     C                     MOVELS7SPCD    ZFIELD                          CFT009
     C                     EXSR SRALGN                                    CFT009
      *                                                                   CFT009
     C           ZRTN      IFEQ '*ERROR*'                                 CFT009
     C                     MOVEL'Y'       E#MSGS                          CFT009
     C           V#CCCY    CAT  S7SPCD    FTMSDT    P                     CFT009
     C                     MOVELE#CPGM    FTPGMQ                          CFT009
     C                     MOVEL'FTF2199' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVEL'Y'       I7SPCH                          CFT009
     C                     MOVEL'Y'       E#NOUP                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE ZFIELD    F7SPCD                          CFT009
     C                     MOVE ZFIELD    INPAMT                          CFT009
      *                                                                   CFT009
      ** Convert file default using screen ccy for comparison of          CFT009
      ** entered field and defaulted                                      CFT009
      *                                                                   CFT009
      ** Set up charge amount and currencies for call to FT000985.        CFT009
      *                                                                   CFT009
     C                     Z-ADDF7SPCD    CHGA85                          CFT009
     C                     MOVELPCCY      PCCY85                          CFT009
     C                     MOVELSMCY      SCCY85                          CFT009
     C                     MOVELOPCHGC    CCCY85                          CFT009
     C                     MOVELLEVIED    LCCY85                          CFT009
     C                     MOVELCVTRAT    RATE85                          CFT009
     C                     Z-ADD0         LCHG                            CFT009
     C                     MOVEL*BLANKS   LCHGF     P                     CFT009
      *                                                                   CFT009
     C                     CALL 'FT000985'                                CFT009
     C                     PARM           RET985 10                       CFT009
     C                     PARM           CHGA85 130                      CFT009
     C                     PARM           PCCY85  3                       CFT009
     C                     PARM           SCCY85  3                       CFT009
     C                     PARM           CCCY85  3                       CFT009
     C                     PARM           LCCY85  3                       CFT009
     C                     PARM           RATE85 138                      CFT009
     C                     PARM           LCHG   130                      CFT009
     C                     PARM           LCHGF  16                       CFT009
      *                                                                   CFT009
      ** Set up amounts                                                   CFT009
      *                                                                   CFT009
     C                     Z-ADDLCHG      OUTAMT                          CFT009
     C                     Z-ADDLCHG      F7SPCH                          CFT009
      *                                                                   CFT009
     C           DFTSWP    IFNE OUTAMT                                    CFT009
     C           WRN@,Z    IFEQ ' '                                       CFT009
     C           S7ACTD    ANDNE'E'                                       CFT009
     C                     MOVEL'Y'       E#WARN                          CFT009
     C                     MOVEL'Y'       E#MSGS                          CFT009
     C                     MOVELS7SPCD    FTMSDT    P                     CFT009
     C                     MOVELE#CPGM    FTPGMQ                          CFT009
     C                     MOVEL'FTF3163' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVEL'Y'       I7SPCH                          CFT009
      *                                                                   CFT009
     C                     MOVEL*BLANKS   E#RSND                          CFT009
     C                     MOVEA'Y'       WRN@,Z                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
      *                                                                   CFT009
      ** If screen field is blank and file field default is not then      CFT009
      ** send warning message to say fields are not the same.             CFT009
      *                                                                   CFT009
     C           MSPCH     IFNE *ZEROS                                    CFT009
     C           WRN@,Z    IFEQ ' '                                       CFT009
     C           S7ACTD    ANDNE'E'                                       CFT009
     C                     MOVEL'Y'       E#WARN                          CFT009
     C                     MOVEL'Y'       E#MSGS                          CFT009
     C                     MOVELS7SPCD    FTMSDT    P                     CFT009
     C                     MOVELE#CPGM    FTPGMQ                          CFT009
     C                     MOVEL'FTF3163' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVEL'Y'       I7SPCH                          CFT009
      *                                                                   CFT009
     C                     MOVEL*BLANKS   E#RSND                          CFT009
     C                     MOVEA'Y'       WRN@,Z                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *
      ** Unwind subroutine stack name
      *
     C           EXSPCH    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      /TITLE SR/SRMSCH
      *****************************************************************
      *                                                               *
      *  SRMSCH - Validate Miscellaneous Charges                      *
      *                                                               *
      *  Called By: SRPROC subroutine                                 *
      *                                                               *
      *  Calls:                                                       *
      *  SRALGN    - Calls ZALIGN.                                    *
      *  FTSNMS    - Send message to program message queue.           *
      *                                                               *
      *****************************************************************
      *
     C           SRMSCH    BEGSR                           *** SRMSCH ***
      *
      ** Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SRMSCH'  @STK,Q
      *                                                                   CFT009
      ** If Core switchable feature CFT009 is on then the charge          CFT009
      ** code/amounts will be validated                                   CFT009
      *                                                                   CFT009
     C           CFT009    IFNE 'Y'                                       CFT009
      *
      ** Miscellaneous Charge is optional.
      ** If entered must be valid for charge currency details
      *
     C                     Z-ADD0         F7MSCD
     C                     Z-ADD0         F7MSCH
      *
     C           S7MSCD    IFNE *BLANKS
      *
     C           11        SUB  A6NBDP    ZADIG
     C                     Z-ADDA6NBDP    ZADEC
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVELS7MSCD    ZFIELD
     C                     EXSR SRALGN
      *
     C           ZRTN      IFEQ '*ERROR*'
     C                     MOVEL'Y'       E#MSGS
     C           V#CCCY    CAT  S7MSCD    FTMSDT    P
     C                     MOVELE#CPGM    FTPGMQ
     C                     MOVEL'FTM2200' FTMSID
     C                     EXSR FTSNMS
     C                     MOVEL'Y'       I7MSCH
     C                     MOVEL'Y'       E#NOUP
     C                     ELSE
     C                     MOVE ZFIELD    F7MSCD
     C                     ENDIF
      *
     C                     ENDIF
      *                                                                   CFT009
     C                     ELSE                                           CFT009
      *                                                                   CFT009
      ** Charge Code/Amounts will be validated                            CFT009
      *                                                                   CFT009
     C                     Z-ADD25        Z       30                      CFT009
      *                                                                   CFT009
      ** If the screen charge code is not equal to the defaulted          CFT009
      ** file charge code, then send a warning message                    CFT009
      *                                                                   CFT009
     C                     MOVE S7CDE8    CHGCDE                          CFT009
     C           S7CDE8    IFNE *BLANKS                                   CFT009
     C                     EXSR VALID                                     CFT009
     C           WI7CDE    IFEQ 'Y'                                       CFT009
     C                     MOVE 'Y'       I7CDE8                          CFT009
     C                     ELSE                                           CFT009
     C           S7MSCD    IFEQ *BLANKS                                   CFT009
     C                     EXSR RECALC                                    CFT009
     C                     MOVE ZFIELD    S7MSCD                          CFT009
     C                     Z-ADDTOTCHG    F7MSCD                          CFT009
     C                     Z-ADDTOTCHG    F7MSCH                          CFT009
     C           S7VAT6    IFEQ *BLANK                                    CFT009
     C           VATLIN    IFEQ 'Y'                                       CFT009
     C                     MOVELVATLIN    S7VAT6                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       S7VAT6                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C           S7CDE8    IFNE MSCHC                                     CFT009
     C           WI7CDE    ANDNE'Y'                                       CFT009
     C           WRN@,Z    IFEQ ' '                                       CFT009
     C           S7ACTD    ANDNE'E'                                       CFT009
     C                     MOVEL'Y'       E#WARN                          CFT009
     C                     MOVEL'Y'       E#MSGS                          CFT009
     C                     MOVELS7CDE8    FTMSDT    P                     CFT009
     C                     MOVELE#CPGM    FTPGMQ                          CFT009
     C                     MOVEL'FTF3182' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVEL'Y'       I7CDE8                          CFT009
     C                     MOVEL*BLANKS   E#RSND                          CFT009
     C                     MOVEA'Y'       WRN@,Z                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Miscellaneous Charge is optional.                                CFT009
      *                                                                   CFT009
     C                     Z-ADD26        Z       30                      CFT009
      *                                                                   CFT009
     C                     Z-ADD0         F7MSCD                          CFT009
     C                     Z-ADD0         F7MSCH                          CFT009
      *                                                                   CFT009
      ** If screen field is entered and the defaulted field is blank      CFT009
      ** then send a warning message to say field is not same as default  CFT009
      *                                                                   CFT009
     C           S7MSCD    IFNE *BLANKS                                   CFT009
      *                                                                   CFT009
      *                                                                   CFT009
      ** Call currency conversion subroutine                              CFT009
      *                                                                   CFT009
     C                     EXSR CCYCNV                                    CFT009
      *                                                                   CFT009
     C           11        SUB  FRMDEC    ZADIG                           CFT009
     C                     Z-ADDFRMDEC    ZADEC                           CFT009
     C                     MOVEL*BLANKS   ZFIELD                          CFT009
     C                     MOVELS7MSCD    ZFIELD                          CFT009
     C                     EXSR SRALGN                                    CFT009
      *                                                                   CFT009
     C           ZRTN      IFEQ '*ERROR*'                                 CFT009
     C                     MOVEL'Y'       E#MSGS                          CFT009
     C           V#CCCY    CAT  S7MSCD    FTMSDT    P                     CFT009
     C                     MOVELE#CPGM    FTPGMQ                          CFT009
     C                     MOVEL'FTF2200' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVEL'Y'       I7MSCH                          CFT009
     C                     MOVEL'Y'       E#NOUP                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE ZFIELD    F7MSCD                          CFT009
     C                     MOVE ZFIELD    INPAMT                          CFT009
      *                                                                   CFT009
      ** Get defaulted field ccy and then use it to convert from this     CFT009
      ** CCy to the screen ccy so that a comparison can be made of the    CFT009
      ** two amounts                                                      CFT009
      *                                                                   CFT009
      ** Convert file default using screen ccy for comparison of          CFT009
      ** entered field and defaulted                                      CFT009
      *                                                                   CFT009
      ** Set up charge amount and currencies for call to FT000985.        CFT009
      *                                                                   CFT009
     C                     Z-ADDF7MSCD    CHGA85                          CFT009
     C                     MOVELPCCY      PCCY85                          CFT009
     C                     MOVELSMCY      SCCY85                          CFT009
     C                     MOVELOPCHGC    CCCY85                          CFT009
     C                     MOVELLEVIED    LCCY85                          CFT009
     C                     MOVELCVTRAT    RATE85                          CFT009
     C                     Z-ADD0         LCHG                            CFT009
     C                     MOVEL*BLANKS   LCHGF     P                     CFT009
      *                                                                   CFT009
     C                     CALL 'FT000985'                                CFT009
     C                     PARM           RET985 10                       CFT009
     C                     PARM           CHGA85 130                      CFT009
     C                     PARM           PCCY85  3                       CFT009
     C                     PARM           SCCY85  3                       CFT009
     C                     PARM           CCCY85  3                       CFT009
     C                     PARM           LCCY85  3                       CFT009
     C                     PARM           RATE85 138                      CFT009
     C                     PARM           LCHG   130                      CFT009
     C                     PARM           LCHGF  16                       CFT009
      *                                                                   CFT009
      ** Set up amounts                                                   CFT009
      *                                                                   CFT009
     C                     Z-ADDLCHG      OUTAMT                          CFT009
     C                     Z-ADDLCHG      F7MSCH                          CFT009
      *                                                                   CFT009
     C           DFTMSC    IFNE OUTAMT                                    CFT009
     C           WRN@,Z    IFEQ ' '                                       CFT009
     C           S7ACTD    ANDNE'E'                                       CFT009
     C                     MOVEL'Y'       E#WARN                          CFT009
     C                     MOVEL'Y'       E#MSGS                          CFT009
     C                     MOVELS7MSCD    FTMSDT    P                     CFT009
     C                     MOVELE#CPGM    FTPGMQ                          CFT009
     C                     MOVEL'FTF3164' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVEL'Y'       I7MSCH                          CFT009
      *                                                                   CFT009
     C                     MOVEL*BLANKS   E#RSND                          CFT009
     C                     MOVEA'Y'       WRN@,Z                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
      *                                                                   CFT009
      ** If screen field is blank and file field default is not then      CFT009
      ** send warning message to say fields are not the same.             CFT009
      *                                                                   CFT009
     C           MMSCH     IFNE *ZEROS                                    CFT009
     C           WRN@,Z    IFEQ ' '                                       CFT009
     C           S7ACTD    ANDNE'E'                                       CFT009
     C                     MOVEL'Y'       E#WARN                          CFT009
     C                     MOVEL'Y'       E#MSGS                          CFT009
     C                     MOVELS7MSCD    FTMSDT    P                     CFT009
     C                     MOVELE#CPGM    FTPGMQ                          CFT009
     C                     MOVEL'FTF3164' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVEL'Y'       I7MSCH                          CFT009
      *                                                                   CFT009
     C                     MOVEL*BLANKS   E#RSND                          CFT009
     C                     MOVEA'Y'       WRN@,Z                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *
      ** Unwind subroutine stack name
      *
     C           EXMSCH    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
      *
      *****************************************************************
      *****************************************************************   CFT009
      /EJECT                                                              CFT009
      *****************************************************************   CFT009
      /TITLE SR/SRSWST                                                    CFT009
      *****************************************************************   CFT009
      *                                                               *   CFT009
      *  SRSWST - Validate Swift Standard Charge                      *   CFT009
      *                                                               *   CFT009
      *  Called By: SRPROC Subroutine                                 *   CFT009
      *                                                               *   CFT009
      *  Calls:                                                       *   CFT009
      *  SRALGN    - Calls ZALIGN.                                    *   CFT009
      *  FTSNMS    - Send message to program message queue.           *   CFT009
      *                                                               *   CFT009
      *****************************************************************   CFT009
      *                                                                   CFT009
     C           SRSWST    BEGSR                           *** SRSWST**** CFT009
      *                                                                   CFT009
      ** Set up subroutine stack name                                     CFT009
      *                                                                   CFT009
     C                     ADD  1         Q       50                      CFT009
     C                     MOVEL'SRSWST'  @STK,Q                          CFT009
      *                                                                   CFT009
      ** If Core switchable feature CFT009 is on then the charge          CFT009
      ** code/amounts will be validated                                   CFT009
      *                                                                   CFT009
      ** Charge Code/Amounts will be validated                            CFT009
      *                                                                   CFT009
     C                     Z-ADD27        Z       30                      CFT009
     C                     Z-ADD0         F7STCD                          CFT009
     C                     Z-ADD0         F7STCH                          CFT009
      *                                                                   CFT009
      ** If the screen charge code is not equal to the defaulted          CFT009
      ** file charge code,  then send a warning message                   CFT009
      *                                                                   CFT009
      ** SWIFT St. Charge code is optional,but may only be entered for    CFT009
      ** settlement method '08'                                           CFT009
      *                                                                   CFT009
     C           V#STMT    IFNE '08'                                      CFT009
     C           S7CDE6    IFNE *BLANKS                                   CFT009
     C                     MOVEL'Y'       E#MSGS                          CFT009
     C           V#CCCY    CAT  S7CDE6    FTMSDT    P                     CFT009
     C                     MOVELE#CPGM    FTPGMQ                          CFT009
     C                     MOVEL'FTF3167' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVEL'Y'       I7CDE6                          CFT009
     C                     MOVEL'Y'       E#NOUP                          CFT009
     C                     MOVEL' '       WRN@,Z                          CFT009
     C                     ENDIF                                          CFT009
     C                     Z-ADD28        Z       30                      CFT009
     C           S7STCD    IFNE *BLANKS                                   CFT009
     C                     MOVEL'Y'       E#MSGS                          CFT009
     C           V#CCCY    CAT  S7STCD    FTMSDT    P                     CFT009
     C                     MOVELE#CPGM    FTPGMQ                          CFT009
     C                     MOVEL'FTF3199' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVEL'Y'       I7STCD                          CFT009
     C                     MOVEL'Y'       E#NOUP                          CFT009
     C                     MOVEL' '       WRN@,Z                          CFT009
     C                     ENDIF                                          CFT009
     C                     ELSE                                           CFT009
      *                                                                   CFT009
     C                     Z-ADD27        Z       30                      CFT009
     C                     MOVE S7CDE6    CHGCDE                          CFT009
     C           S7CDE6    IFNE *BLANKS                                   CFT009
     C                     EXSR VALID                                     CFT009
     C           WI7CDE    IFEQ 'Y'                                       CFT009
     C                     MOVE 'Y'       I7CDE6                          CFT009
     C                     ELSE                                           CFT009
     C           S7STCD    IFEQ *BLANKS                                   CFT009
     C                     EXSR RECALC                                    CFT009
     C                     MOVE ZFIELD    S7STCD                          CFT009
     C                     Z-ADDTOTCHG    F7STCD                          CFT009
     C                     Z-ADDTOTCHG    F7STCH                          CFT009
     C           S7VT14    IFEQ *BLANK                                    CFT009
     C           VATLIN    IFEQ 'Y'                                       CFT009
     C                     MOVE VATLIN    S7VT14                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       S7VT14                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C           S7CDE6    IFNE SSTCCD                                    CFT009
     C           WI7CDE    ANDNE'Y'                                       CFT009
     C           WRN@,Z    IFEQ ' '                                       CFT009
     C           S7ACTD    ANDNE'E'                                       CFT009
     C                     MOVEL'Y'       E#WARN                          CFT009
     C                     MOVEL'Y'       E#MSGS                          CFT009
     C                     MOVELS7CDE6    FTMSDT    P                     CFT009
     C                     MOVELE#CPGM    FTPGMQ                          CFT009
     C                     MOVEL'FTF3183' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVEL'Y'       I7CDE6                          CFT009
     C                     MOVEL*BLANKS   E#RSND                          CFT009
     C                     MOVEA'Y'       WRN@,Z                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      *                                                                   CFT009
      ** SWIFT Standard Charge code is optional                           CFT009
      *                                                                   CFT009
     C                     Z-ADD28        Z       30                      CFT009
      *                                                                   CFT009
      ** If screen field is entered and the defaulted field is blank      CFT009
      ** then send a warning message to say field is not same as default  CFT009
      *                                                                   CFT009
     C           S7STCD    IFNE *BLANKS                                   CFT009
      *                                                                   CFT009
      ** If entered must be valid for charge currency details             CFT009
      *                                                                   CFT009
      ** If screen field is entered and the default is not blank          CFT009
      ** then check to see if entered value is same as default.           CFT009
      *                                                                   CFT009
      ** Convert screen field to numeric value for comparison             CFT009
      *                                                                   CFT009
      *                                                                   CFT009
      ** Call currency conversion subroutine                              CFT009
      *                                                                   CFT009
     C                     EXSR CCYCNV                                    CFT009
      *                                                                   CFT009
      *                                                                   CFT009
     C           11        SUB  FRMDEC    ZADIG                           CFT009
     C                     Z-ADDFRMDEC    ZADEC                           CFT009
     C                     MOVEL*BLANKS   ZFIELD                          CFT009
     C                     MOVELS7STCD    ZFIELD                          CFT009
      *                                                                   CFT009
     C                     EXSR SRALGN                                    CFT009
      *                                                                   CFT009
     C           ZRTN      IFEQ '*ERROR*'                                 CFT009
     C                     MOVEL'Y'       E#MSGS                          CFT009
     C           OPCHGC    CAT  S7STCD    FTMSDT    P                     CFT009
     C                     MOVELE#CPGM    FTPGMQ                          CFT009
     C                     MOVEL'FTF3169' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVEL'Y'       I7STCD                          CFT009
     C                     MOVEL'Y'       E#NOUP                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE ZFIELD    F7STCD                          CFT009
     C                     MOVE ZFIELD    INPAMT                          CFT009
      *                                                                   CFT009
      ** Convert file default using screen ccy for comparison of          CFT009
      ** entered field and defaulted                                      CFT009
      *                                                                   CFT009
      ** Set up charge amount and currencies for call to FT000985.        CFT009
      *                                                                   CFT009
     C                     Z-ADDF7STCD    CHGA85                          CFT009
     C                     MOVELPCCY      PCCY85                          CFT009
     C                     MOVELSMCY      SCCY85                          CFT009
     C                     MOVELOPCHGC    CCCY85                          CFT009
     C                     MOVELLEVIED    LCCY85                          CFT009
     C                     MOVELCVTRAT    RATE85                          CFT009
     C                     Z-ADD0         LCHG                            CFT009
     C                     MOVEL*BLANKS   LCHGF     P                     CFT009
      *                                                                   CFT009
     C                     CALL 'FT000985'                                CFT009
     C                     PARM           RET985 10                       CFT009
     C                     PARM           CHGA85 130                      CFT009
     C                     PARM           PCCY85  3                       CFT009
     C                     PARM           SCCY85  3                       CFT009
     C                     PARM           CCCY85  3                       CFT009
     C                     PARM           LCCY85  3                       CFT009
     C                     PARM           RATE85 138                      CFT009
     C                     PARM           LCHG   130                      CFT009
     C                     PARM           LCHGF  16                       CFT009
      *                                                                   CFT009
      ** Set up amounts                                                   CFT009
      *                                                                   CFT009
     C                     Z-ADDLCHG      OUTAMT                          CFT009
     C                     Z-ADDLCHG      F7STCH                          CFT009
      *                                                                   CFT009
     C           DFTSWS    IFNE F7STCH                                    CFT009
     C           WRN@,Z    IFEQ ' '                                       CFT009
     C           S7ACTD    ANDNE'E'                                       CFT009
     C                     MOVEL'Y'       E#WARN                          CFT009
     C                     MOVEL'Y'       E#MSGS                          CFT009
     C                     MOVELS7STCD    FTMSDT    P                     CFT009
     C                     MOVELE#CPGM    FTPGMQ                          CFT009
     C                     MOVEL'FTF3168' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVEL'Y'       I7STCD                          CFT009
      *                                                                   CFT009
     C                     MOVEL*BLANKS   E#RSND                          CFT009
     C                     MOVEA'Y'       WRN@,Z                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
      *                                                                   CFT009
      ** If screen field is blank and file field default is not then      CFT009
      ** send warning message to say fields are not the same.             CFT009
      *                                                                   CFT009
     C           WSWSCH    IFNE *ZEROS                                    CFT009
     C           WRN@,Z    IFEQ ' '                                       CFT009
     C           S7ACTD    ANDNE'E'                                       CFT009
     C                     MOVEL'Y'       E#WARN                          CFT009
     C                     MOVEL'Y'       E#MSGS                          CFT009
     C                     MOVELS7STCD    FTMSDT    P                     CFT009
     C                     MOVELE#CPGM    FTPGMQ                          CFT009
     C                     MOVEL'FTF3168' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVEL'Y'       I7STCD                          CFT009
      *                                                                   CFT009
     C                     MOVEL*BLANKS   E#RSND                          CFT009
     C                     MOVEA'Y'       WRN@,Z                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Unwind subroutine stack name                                     CFT009
      *                                                                   CFT009
     C           EXSTCH    TAG                                            CFT009
     C                     MOVEA*BLANKS   @STK,Q                          CFT009
     C                     SUB  1         Q                               CFT009
      *                                                                   CFT009
     CSR                   ENDSR                                          CFT009
      *                                                                   CFT009
      *****************************************************************   CFT009
      /EJECT                                                              CFT009
      *****************************************************************   CFT009
      /TITLE SR/SRMSC1                                                    CFT009
      *****************************************************************   CFT009
      *                                                               *   CFT009
      *  SRMSC1 - Validate Miscellaneous Charge 1                     *   CFT009
      *                                                               *   CFT009
      *  Called By: SRPROC Subroutine                                 *   CFT009
      *                                                               *   CFT009
      *  Calls:                                                       *   CFT009
      *  SRALGN    - Calls ZALIGN.                                    *   CFT009
      *  FTSNMS    - Send message to program message queue.           *   CFT009
      *                                                               *   CFT009
      *****************************************************************   CFT009
      *                                                                   CFT009
     C           SRMSC1    BEGSR                           *** SRMSC1**** CFT009
      *                                                                   CFT009
      ** Set up subroutine stack name                                     CFT009
      *                                                                   CFT009
     C                     ADD  1         Q       50                      CFT009
     C                     MOVEL'SRMSC1'  @STK,Q                          CFT009
      *                                                                   CFT009
      ** Charge Code/Amounts will be validated                            CFT009
      *                                                                   CFT009
     C                     Z-ADD29        Z       30                      CFT009
      *                                                                   CFT009
      ** If the screen charge code is not equal to the defaulted          CFT009
      ** file charge code,  then send a warning message                   CFT009
      *                                                                   CFT009
      ** Miscellaneous Charge code is optional.                           CFT009
      *                                                                   CFT009
     C                     MOVE S7CDE9    CHGCDE                          CFT009
     C           S7CDE9    IFNE *BLANKS                                   CFT009
     C                     EXSR VALID                                     CFT009
     C           WI7CDE    IFEQ 'Y'                                       CFT009
     C                     MOVE 'Y'       I7CDE9                          CFT009
     C                     ELSE                                           CFT009
     C           S7M1CD    IFEQ *BLANKS                                   CFT009
     C                     EXSR RECALC                                    CFT009
     C                     MOVE ZFIELD    S7M1CD                          CFT009
     C                     Z-ADDTOTCHG    F7M1CD                          CFT009
     C                     Z-ADDTOTCHG    F7M1CH                          CFT009
     C           S7VT9     IFEQ *BLANK                                    CFT009
     C           VATLIN    IFEQ 'Y'                                       CFT009
     C                     MOVE VATLIN    S7VT9                           CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       S7VT9                           CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C           S7CDE9    IFNE MSCHC1                                    CFT009
     C           WI7CDE    ANDNE'Y'                                       CFT009
     C           WRN@,Z    IFEQ ' '                                       CFT009
     C           S7ACTD    ANDNE'E'                                       CFT009
     C                     MOVEL'Y'       E#WARN                          CFT009
     C                     MOVEL'Y'       E#MSGS                          CFT009
     C                     MOVELS7CDE9    FTMSDT    P                     CFT009
     C                     MOVELE#CPGM    FTPGMQ                          CFT009
     C                     MOVEL'FTF3184' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVEL'Y'       I7CDE9                          CFT009
     C                     MOVEL*BLANKS   E#RSND                          CFT009
     C                     MOVEA'Y'       WRN@,Z                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Miscellaneous Charge code is optional                            CFT009
      *                                                                   CFT009
     C                     Z-ADD30        Z       30                      CFT009
      *                                                                   CFT009
     C                     Z-ADD0         F7M1CD                          CFT009
     C                     Z-ADD0         F7M1CH                          CFT009
      *                                                                   CFT009
      ** If screen field is entered and the defaulted field is blank      CFT009
      ** then send a warning message to say field is not same as default  CFT009
      *                                                                   CFT009
     C           S7M1CD    IFNE *BLANKS                                   CFT009
      *                                                                   CFT009
      ** Convert screen field to numeric value for comparison             CFT009
      *                                                                   CFT009
      ** Call currency conversion subroutine                              CFT009
      *                                                                   CFT009
     C                     EXSR CCYCNV                                    CFT009
      *                                                                   CFT009
      *                                                                   CFT009
     C           11        SUB  FRMDEC    ZADIG                           CFT009
     C                     Z-ADDFRMDEC    ZADEC                           CFT009
     C                     MOVEL*BLANKS   ZFIELD                          CFT009
     C                     MOVELS7M1CD    ZFIELD                          CFT009
     C                     EXSR SRALGN                                    CFT009
      *                                                                   CFT009
     C           ZRTN      IFEQ '*ERROR*'                                 CFT009
     C                     MOVEL'Y'       E#MSGS                          CFT009
     C           OPCHGC    CAT  S7M1CD    FTMSDT    P                     CFT009
     C                     MOVELE#CPGM    FTPGMQ                          CFT009
     C                     MOVEL'FTF3190' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVEL'Y'       I7M1CD                          CFT009
     C                     MOVEL'Y'       E#NOUP                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE ZFIELD    F7M1CD                          CFT009
     C                     MOVE ZFIELD    INPAMT                          CFT009
      *                                                                   CFT009
      ** Convert file default using screen ccy for comparison of          CFT009
      ** entered field and defaulted                                      CFT009
      *                                                                   CFT009
      ** Set up charge amount and currencies for call to FT000985.        CFT009
      *                                                                   CFT009
     C                     Z-ADDF7M1CD    CHGA85                          CFT009
     C                     MOVELPCCY      PCCY85                          CFT009
     C                     MOVELSMCY      SCCY85                          CFT009
     C                     MOVELOPCHGC    CCCY85                          CFT009
     C                     MOVELLEVIED    LCCY85                          CFT009
     C                     MOVELCVTRAT    RATE85                          CFT009
     C                     Z-ADD0         LCHG                            CFT009
     C                     MOVEL*BLANKS   LCHGF     P                     CFT009
      *                                                                   CFT009
     C                     CALL 'FT000985'                                CFT009
     C                     PARM           RET985 10                       CFT009
     C                     PARM           CHGA85 130                      CFT009
     C                     PARM           PCCY85  3                       CFT009
     C                     PARM           SCCY85  3                       CFT009
     C                     PARM           CCCY85  3                       CFT009
     C                     PARM           LCCY85  3                       CFT009
     C                     PARM           RATE85 138                      CFT009
     C                     PARM           LCHG   130                      CFT009
     C                     PARM           LCHGF  16                       CFT009
      *                                                                   CFT009
      ** Set up amounts                                                   CFT009
      *                                                                   CFT009
     C                     Z-ADDLCHG      OUTAMT                          CFT009
     C                     Z-ADDLCHG      F7M1CH                          CFT009
      *                                                                   CFT009
     C           DFTMS1    IFNE OUTAMT                                    CFT009
     C           WRN@,Z    IFEQ ' '                                       CFT009
     C           S7ACTD    ANDNE'E'                                       CFT009
     C                     MOVEL'Y'       E#WARN                          CFT009
     C                     MOVEL'Y'       E#MSGS                          CFT009
     C                     MOVELS7M1CD    FTMSDT    P                     CFT009
     C                     MOVELE#CPGM    FTPGMQ                          CFT009
     C                     MOVEL'FTF3171' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVEL'Y'       I7M1CD                          CFT009
     C                     MOVEL*BLANKS   E#RSND                          CFT009
     C                     MOVEA'Y'       WRN@,Z                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
      *                                                                   CFT009
      ** If screen field is blank and file field default is not then      CFT009
      ** send warning message to say fields are not the same.             CFT009
      *                                                                   CFT009
     C           WMISC1    IFNE *ZEROS                                    CFT009
     C           WRN@,Z    IFEQ ' '                                       CFT009
     C           S7ACTD    ANDNE'E'                                       CFT009
     C                     MOVEL'Y'       E#WARN                          CFT009
     C                     MOVEL'Y'       E#MSGS                          CFT009
     C                     MOVELS7M1CD    FTMSDT    P                     CFT009
     C                     MOVELE#CPGM    FTPGMQ                          CFT009
     C                     MOVEL'FTF3171' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVEL'Y'       I7M1CD                          CFT009
     C                     MOVEL*BLANKS   E#RSND                          CFT009
     C                     MOVEA'Y'       WRN@,Z                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Unwind subroutine stack name                                     CFT009
      *                                                                   CFT009
     C           EXM1CH    TAG                                            CFT009
     C                     MOVEA*BLANKS   @STK,Q                          CFT009
     C                     SUB  1         Q                               CFT009
      *                                                                   CFT009
     CSR                   ENDSR                                          CFT009
      *                                                                   CFT009
      *****************************************************************   CFT009
      /EJECT                                                              CFT009
      *****************************************************************   CFT009
      /TITLE SR/SRMSC2                                                    CFT009
      *****************************************************************   CFT009
      *                                                               *   CFT009
      *  SRMSC2 - Validate Miscellaneous Charge 2                     *   CFT009
      *                                                               *   CFT009
      *  Called By: SRPROC Subroutine                                 *   CFT009
      *                                                               *   CFT009
      *  Calls:                                                       *   CFT009
      *  SRALGN    - Calls ZALIGN.                                    *   CFT009
      *  FTSNMS    - Send message to program message queue.           *   CFT009
      *                                                               *   CFT009
      *****************************************************************   CFT009
      *                                                                   CFT009
     C           SRMSC2    BEGSR                           *** SRMSC2**** CFT009
      *                                                                   CFT009
      ** Set up subroutine stack name                                     CFT009
      *                                                                   CFT009
     C                     ADD  1         Q       50                      CFT009
     C                     MOVEL'SRMSC2'  @STK,Q                          CFT009
      *                                                                   CFT009
      ** Charge Code/Amounts will be validated                            CFT009
      *                                                                   CFT009
     C                     Z-ADD31        Z       30                      CFT009
      *                                                                   CFT009
      ** If the screen charge code is not equal to the defaulted          CFT009
      ** file charge code,  then send a warning message                   CFT009
      *                                                                   CFT009
      ** Miscellaneous Charge code is optional.                           CFT009
      *                                                                   CFT009
     C                     MOVE S7CD10    CHGCDE                          CFT009
     C           S7CD10    IFNE *BLANKS                                   CFT009
     C                     EXSR VALID                                     CFT009
     C           WI7CDE    IFEQ 'Y'                                       CFT009
     C                     MOVE 'Y'       I7CD10                          CFT009
     C                     ELSE                                           CFT009
     C           S7M2CD    IFEQ *BLANKS                                   CFT009
     C                     EXSR RECALC                                    CFT009
     C                     MOVE ZFIELD    S7M2CD                          CFT009
     C                     Z-ADDTOTCHG    F7M2CD                          CFT009
     C                     Z-ADDTOTCHG    F7M2CH                          CFT009
     C           S7VT10    IFEQ *BLANK                                    CFT009
     C           VATLIN    IFEQ 'Y'                                       CFT009
     C                     MOVE VATLIN    S7VT10                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       S7VT10                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C           S7CD10    IFNE MSCHC2                                    CFT009
     C           WI7CDE    ANDNE'Y'                                       CFT009
     C           WRN@,Z    IFEQ ' '                                       CFT009
     C           S7ACTD    ANDNE'E'                                       CFT009
     C                     MOVEL'Y'       E#WARN                          CFT009
     C                     MOVEL'Y'       E#MSGS                          CFT009
     C                     MOVELS7CD10    FTMSDT    P                     CFT009
     C                     MOVELE#CPGM    FTPGMQ                          CFT009
     C                     MOVEL'FTF3185' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVEL'Y'       I7CD10                          CFT009
     C                     MOVEL*BLANKS   E#RSND                          CFT009
     C                     MOVEA'Y'       WRN@,Z                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Miscellaneous Charge code is optional                            CFT009
      *                                                                   CFT009
     C                     Z-ADD32        Z       30                      CFT009
      *                                                                   CFT009
     C                     Z-ADD0         F7M2CD                          CFT009
     C                     Z-ADD0         F7M2CH                          CFT009
      *                                                                   CFT009
      ** If screen field is entered and the defaulted field is blank      CFT009
      ** then send a warning message to say field is not same as default  CFT009
      *                                                                   CFT009
     C           S7M2CD    IFNE *BLANKS                                   CFT009
      *                                                                   CFT009
      ** Call currency conversion subroutine                              CFT009
      *                                                                   CFT009
     C                     EXSR CCYCNV                                    CFT009
      *                                                                   CFT009
     C           11        SUB  FRMDEC    ZADIG                           CFT009
     C                     Z-ADDFRMDEC    ZADEC                           CFT009
     C                     MOVEL*BLANKS   ZFIELD                          CFT009
     C                     MOVELS7M2CD    ZFIELD                          CFT009
     C                     EXSR SRALGN                                    CFT009
      *                                                                   CFT009
     C           ZRTN      IFEQ '*ERROR*'                                 CFT009
     C                     MOVEL'Y'       E#MSGS                          CFT009
     C           OPCHGC    CAT  S7M2CD    FTMSDT    P                     CFT009
     C                     MOVELE#CPGM    FTPGMQ                          CFT009
     C                     MOVEL'FTF3191' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVEL'Y'       I7M2CD                          CFT009
     C                     MOVEL'Y'       E#NOUP                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE ZFIELD    F7M2CD                          CFT009
     C                     MOVE ZFIELD    INPAMT                          CFT009
      *                                                                   CFT009
      ** Convert file default using screen ccy for comparison of          CFT009
      ** entered field and defaulted                                      CFT009
      *                                                                   CFT009
      ** Set up charge amount and currencies for call to FT000985.        CFT009
      *                                                                   CFT009
     C                     Z-ADDF7M2CD    CHGA85                          CFT009
     C                     MOVELPCCY      PCCY85                          CFT009
     C                     MOVELSMCY      SCCY85                          CFT009
     C                     MOVELOPCHGC    CCCY85                          CFT009
     C                     MOVELLEVIED    LCCY85                          CFT009
     C                     MOVELCVTRAT    RATE85                          CFT009
     C                     Z-ADD0         LCHG                            CFT009
     C                     MOVEL*BLANKS   LCHGF     P                     CFT009
      *                                                                   CFT009
     C                     CALL 'FT000985'                                CFT009
     C                     PARM           RET985 10                       CFT009
     C                     PARM           CHGA85 130                      CFT009
     C                     PARM           PCCY85  3                       CFT009
     C                     PARM           SCCY85  3                       CFT009
     C                     PARM           CCCY85  3                       CFT009
     C                     PARM           LCCY85  3                       CFT009
     C                     PARM           RATE85 138                      CFT009
     C                     PARM           LCHG   130                      CFT009
     C                     PARM           LCHGF  16                       CFT009
      *                                                                   CFT009
      ** Set up amounts                                                   CFT009
      *                                                                   CFT009
     C                     Z-ADDLCHG      OUTAMT                          CFT009
     C                     Z-ADDLCHG      F7M2CH                          CFT009
      *                                                                   CFT009
     C           DFTMS2    IFNE OUTAMT                                    CFT009
     C           WRN@,Z    IFEQ ' '                                       CFT009
     C           S7ACTD    ANDNE'E'                                       CFT009
     C                     MOVEL'Y'       E#WARN                          CFT009
     C                     MOVEL'Y'       E#MSGS                          CFT009
     C                     MOVELS7M2CD    FTMSDT    P                     CFT009
     C                     MOVELE#CPGM    FTPGMQ                          CFT009
     C                     MOVEL'FTF3172' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVEL'Y'       I7M2CD                          CFT009
      *                                                                   CFT009
     C                     MOVEL*BLANKS   E#RSND                          CFT009
     C                     MOVEA'Y'       WRN@,Z                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
      *                                                                   CFT009
      ** If screen field is blank and file field default is not then      CFT009
      ** send warning message to say fields are not the same.             CFT009
      *                                                                   CFT009
     C           WMISC2    IFNE *ZEROS                                    CFT009
     C           WRN@,Z    IFEQ ' '                                       CFT009
     C           S7ACTD    ANDNE'E'                                       CFT009
     C                     MOVEL'Y'       E#WARN                          CFT009
     C                     MOVEL'Y'       E#MSGS                          CFT009
     C                     MOVELS7M2CD    FTMSDT    P                     CFT009
     C                     MOVELE#CPGM    FTPGMQ                          CFT009
     C                     MOVEL'FTF3172' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVEL'Y'       I7M2CD                          CFT009
      *                                                                   CFT009
     C                     MOVEL*BLANKS   E#RSND                          CFT009
     C                     MOVEA'Y'       WRN@,Z                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Unwind subroutine stack name                                     CFT009
      *                                                                   CFT009
     C           EXM2CH    TAG                                            CFT009
     C                     MOVEA*BLANKS   @STK,Q                          CFT009
     C                     SUB  1         Q                               CFT009
      *                                                                   CFT009
     CSR                   ENDSR                                          CFT009
      *                                                                   CFT009
      *****************************************************************   CFT009
      /EJECT                                                              CFT009
      *****************************************************************   CFT009
      /TITLE SR/SRMSC3                                                    CFT009
      *****************************************************************   CFT009
      *                                                               *   CFT009
      *  SRMSC3 - Validate Miscellaneous Charge 3                     *   CFT009
      *                                                               *   CFT009
      *  Called By: SRPROC Subroutine                                 *   CFT009
      *                                                               *   CFT009
      *  Calls:                                                       *   CFT009
      *  SRALGN    - Calls ZALIGN.                                    *   CFT009
      *  FTSNMS    - Send message to program message queue.           *   CFT009
      *                                                               *   CFT009
      *****************************************************************   CFT009
      *                                                                   CFT009
     C           SRMSC3    BEGSR                           *** SRMSC3**** CFT009
      *                                                                   CFT009
      ** Set up subroutine stack name                                     CFT009
      *                                                                   CFT009
     C                     ADD  1         Q       50                      CFT009
     C                     MOVEL'SRMSC3'  @STK,Q                          CFT009
      *                                                                   CFT009
      ** Charge Code/Amounts will be validated                            CFT009
      *                                                                   CFT009
     C                     Z-ADD33        Z       30                      CFT009
      *                                                                   CFT009
      ** If the screen charge code is not equal to the defaulted          CFT009
      ** file charge code,  then send a warning message                   CFT009
      *                                                                   CFT009
      ** Miscellaneous Charge code is optional.                           CFT009
      *                                                                   CFT009
     C                     MOVE S7CD11    CHGCDE                          CFT009
     C           S7CD11    IFNE *BLANKS                                   CFT009
     C                     EXSR VALID                                     CFT009
     C           WI7CDE    IFEQ 'Y'                                       CFT009
     C                     MOVE 'Y'       I7CD11                          CFT009
     C                     ELSE                                           CFT009
     C           S7M3CD    IFEQ *BLANKS                                   CFT009
     C                     EXSR RECALC                                    CFT009
     C                     MOVE ZFIELD    S7M3CD                          CFT009
     C                     Z-ADDTOTCHG    F7M3CD                          CFT009
     C                     Z-ADDTOTCHG    F7M3CH                          CFT009
     C           S7VT11    IFEQ *BLANK                                    CFT009
     C           VATLIN    IFEQ 'Y'                                       CFT009
     C                     MOVE VATLIN    S7VT11                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       S7VT11                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C           S7CD11    IFNE MSCHC3                                    CFT009
     C           WI7CDE    ANDNE'Y'                                       CFT009
     C           WRN@,Z    IFEQ ' '                                       CFT009
     C           S7ACTD    ANDNE'E'                                       CFT009
     C                     MOVEL'Y'       E#WARN                          CFT009
     C                     MOVEL'Y'       E#MSGS                          CFT009
     C                     MOVELS7CD11    FTMSDT    P                     CFT009
     C                     MOVELE#CPGM    FTPGMQ                          CFT009
     C                     MOVEL'FTF3186' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVEL'Y'       I7CD11                          CFT009
     C                     MOVEL*BLANKS   E#RSND                          CFT009
     C                     MOVEA'Y'       WRN@,Z                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Miscellaneous Charge code is optional                            CFT009
      *                                                                   CFT009
     C                     Z-ADD34        Z       30                      CFT009
      *                                                                   CFT009
     C                     Z-ADD0         F7M3CD                          CFT009
     C                     Z-ADD0         F7M3CH                          CFT009
      *                                                                   CFT009
      ** If screen field is entered and the defaulted field is blank      CFT009
      ** then send a warning message to say field is not same as default  CFT009
      *                                                                   CFT009
     C           S7M3CD    IFNE *BLANKS                                   CFT009
      *                                                                   CFT009
      ** Call currency conversion subroutine                              CFT009
      *                                                                   CFT009
     C                     EXSR CCYCNV                                    CFT009
      *                                                                   CFT009
     C           11        SUB  FRMDEC    ZADIG                           CFT009
     C                     Z-ADDFRMDEC    ZADEC                           CFT009
     C                     MOVEL*BLANKS   ZFIELD                          CFT009
     C                     MOVELS7M3CD    ZFIELD                          CFT009
     C                     EXSR SRALGN                                    CFT009
      *                                                                   CFT009
     C           ZRTN      IFEQ '*ERROR*'                                 CFT009
     C                     MOVEL'Y'       E#MSGS                          CFT009
     C           OPCHGC    CAT  S7M3CD    FTMSDT    P                     CFT009
     C                     MOVELE#CPGM    FTPGMQ                          CFT009
     C                     MOVEL'FTF3192' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVEL'Y'       I7M3CD                          CFT009
     C                     MOVEL'Y'       E#NOUP                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE ZFIELD    F7M3CD                          CFT009
     C                     MOVE ZFIELD    INPAMT                          CFT009
      *                                                                   CFT009
      ** Convert file default using screen ccy for comparison of          CFT009
      ** entered field and defaulted                                      CFT009
      *                                                                   CFT009
      ** Set up charge amount and currencies for call to FT000985.        CFT009
      *                                                                   CFT009
     C                     Z-ADDF7M3CD    CHGA85                          CFT009
     C                     MOVELPCCY      PCCY85                          CFT009
     C                     MOVELSMCY      SCCY85                          CFT009
     C                     MOVELOPCHGC    CCCY85                          CFT009
     C                     MOVELLEVIED    LCCY85                          CFT009
     C                     MOVELCVTRAT    RATE85                          CFT009
     C                     Z-ADD0         LCHG                            CFT009
     C                     MOVEL*BLANKS   LCHGF     P                     CFT009
      *                                                                   CFT009
     C                     CALL 'FT000985'                                CFT009
     C                     PARM           RET985 10                       CFT009
     C                     PARM           CHGA85 130                      CFT009
     C                     PARM           PCCY85  3                       CFT009
     C                     PARM           SCCY85  3                       CFT009
     C                     PARM           CCCY85  3                       CFT009
     C                     PARM           LCCY85  3                       CFT009
     C                     PARM           RATE85 138                      CFT009
     C                     PARM           LCHG   130                      CFT009
     C                     PARM           LCHGF  16                       CFT009
      *                                                                   CFT009
      ** Set up amounts                                                   CFT009
      *                                                                   CFT009
     C                     Z-ADDLCHG      OUTAMT                          CFT009
     C                     Z-ADDLCHG      F7M3CH                          CFT009
      *                                                                   CFT009
     C           DFTMS3    IFNE OUTAMT                                    CFT009
     C           WRN@,Z    IFEQ ' '                                       CFT009
     C           S7ACTD    ANDNE'E'                                       CFT009
     C                     MOVEL'Y'       E#WARN                          CFT009
     C                     MOVEL'Y'       E#MSGS                          CFT009
     C                     MOVELS7M3CD    FTMSDT    P                     CFT009
     C                     MOVELE#CPGM    FTPGMQ                          CFT009
     C                     MOVEL'FTF3173' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVEL'Y'       I7M3CD                          CFT009
      *                                                                   CFT009
     C                     MOVEL*BLANKS   E#RSND                          CFT009
     C                     MOVEA'Y'       WRN@,Z                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
      *                                                                   CFT009
      ** If screen field is blank and file field default is not then      CFT009
      ** send warning message to say fields are not the same.             CFT009
      *                                                                   CFT009
     C           WMISC3    IFNE *ZEROS                                    CFT009
     C           WRN@,Z    IFEQ ' '                                       CFT009
     C           S7ACTD    ANDNE'E'                                       CFT009
     C                     MOVEL'Y'       E#WARN                          CFT009
     C                     MOVEL'Y'       E#MSGS                          CFT009
     C                     MOVELS7M3CD    FTMSDT    P                     CFT009
     C                     MOVELE#CPGM    FTPGMQ                          CFT009
     C                     MOVEL'FTF3173' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVEL'Y'       I7M3CD                          CFT009
      *                                                                   CFT009
     C                     MOVEL*BLANKS   E#RSND                          CFT009
     C                     MOVEA'Y'       WRN@,Z                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Unwind subroutine stack name                                     CFT009
      *                                                                   CFT009
     C           EXM3CH    TAG                                            CFT009
     C                     MOVEA*BLANKS   @STK,Q                          CFT009
     C                     SUB  1         Q                               CFT009
      *                                                                   CFT009
     CSR                   ENDSR                                          CFT009
      *                                                                   CFT009
      *****************************************************************   CFT009
      /EJECT                                                              CFT009
      *****************************************************************   CFT009
      /TITLE SR/SRMSC4                                                    CFT009
      *****************************************************************   CFT009
      *                                                               *   CFT009
      *  SRMSC4 - Validate Miscellaneous Charge 4                     *   CFT009
      *                                                               *   CFT009
      *  Called By: SRPROC Subroutine                                 *   CFT009
      *                                                               *   CFT009
      *  Calls:                                                       *   CFT009
      *  SRALGN    - Calls ZALIGN.                                    *   CFT009
      *  FTSNMS    - Send message to program message queue.           *   CFT009
      *                                                               *   CFT009
      *****************************************************************   CFT009
      *                                                                   CFT009
     C           SRMSC4    BEGSR                           *** SRMSC4**** CFT009
      *                                                                   CFT009
      ** Set up subroutine stack name                                     CFT009
      *                                                                   CFT009
     C                     ADD  1         Q       50                      CFT009
     C                     MOVEL'SRMSC4'  @STK,Q                          CFT009
      *                                                                   CFT009
      ** Charge Code/Amounts will be validated                            CFT009
      *                                                                   CFT009
     C                     Z-ADD35        Z       30                      CFT009
      *                                                                   CFT009
      ** If the screen charge code is not equal to the defaulted          CFT009
      ** file charge code,  then send a warning message                   CFT009
      *                                                                   CFT009
      ** Miscellaneous Charge code is optional.                           CFT009
      *                                                                   CFT009
     C                     MOVE S7CD12    CHGCDE                          CFT009
     C           S7CD12    IFNE *BLANKS                                   CFT009
     C                     EXSR VALID                                     CFT009
     C           WI7CDE    IFEQ 'Y'                                       CFT009
     C                     MOVE 'Y'       I7CD12                          CFT009
     C                     ELSE                                           CFT009
     C           S7M4CD    IFEQ *BLANKS                                   CFT009
     C                     EXSR RECALC                                    CFT009
     C                     MOVE ZFIELD    S7M4CD                          CFT009
     C                     Z-ADDTOTCHG    F7M4CD                          CFT009
     C                     Z-ADDTOTCHG    F7M4CH                          CFT009
     C           S7VT12    IFEQ *BLANK                                    CFT009
     C           VATLIN    IFEQ 'Y'                                       CFT009
     C                     MOVE VATLIN    S7VT12                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       S7VT12                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C           S7CD12    IFNE MSCHC4                                    CFT009
     C           WI7CDE    ANDNE'Y'                                       CFT009
     C           WRN@,Z    IFEQ ' '                                       CFT009
     C           S7ACTD    ANDNE'E'                                       CFT009
     C                     MOVEL'Y'       E#WARN                          CFT009
     C                     MOVEL'Y'       E#MSGS                          CFT009
     C                     MOVELS7CD12    FTMSDT    P                     CFT009
     C                     MOVELE#CPGM    FTPGMQ                          CFT009
     C                     MOVEL'FTF3187' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVEL'Y'       I7CD12                          CFT009
     C                     MOVEL*BLANKS   E#RSND                          CFT009
     C                     MOVEA'Y'       WRN@,Z                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Miscellaneous Charge code is optional                            CFT009
      *                                                                   CFT009
     C                     Z-ADD36        Z       30                      CFT009
      *                                                                   CFT009
     C                     Z-ADD0         F7M4CD                          CFT009
     C                     Z-ADD0         F7M4CH                          CFT009
      *                                                                   CFT009
      ** If screen field is entered and the defaulted field is blank      CFT009
      ** then send a warning message to say field is not same as default  CFT009
      *                                                                   CFT009
     C           S7M4CD    IFNE *BLANKS                                   CFT009
      *                                                                   CFT009
      ** Call currency conversion subroutine                              CFT009
      *                                                                   CFT009
     C                     EXSR CCYCNV                                    CFT009
      *                                                                   CFT009
     C           11        SUB  FRMDEC    ZADIG                           CFT009
     C                     Z-ADDFRMDEC    ZADEC                           CFT009
     C                     MOVEL*BLANKS   ZFIELD                          CFT009
     C                     MOVELS7M4CD    ZFIELD                          CFT009
     C                     EXSR SRALGN                                    CFT009
      *                                                                   CFT009
     C           ZRTN      IFEQ '*ERROR*'                                 CFT009
     C                     MOVEL'Y'       E#MSGS                          CFT009
     C           OPCHGC    CAT  S7M4CD    FTMSDT    P                     CFT009
     C                     MOVELE#CPGM    FTPGMQ                          CFT009
     C                     MOVEL'FTF3193' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVEL'Y'       I7M4CD                          CFT009
     C                     MOVEL'Y'       E#NOUP                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE ZFIELD    F7M4CD                          CFT009
     C                     MOVE ZFIELD    INPAMT                          CFT009
      *                                                                   CFT009
      ** Convert file default using screen ccy for comparison of          CFT009
      ** entered field and defaulted                                      CFT009
      *                                                                   CFT009
      ** Set up charge amount and currencies for call to FT000985.        CFT009
      *                                                                   CFT009
     C                     Z-ADDF7M4CD    CHGA85                          CFT009
     C                     MOVELPCCY      PCCY85                          CFT009
     C                     MOVELSMCY      SCCY85                          CFT009
     C                     MOVELOPCHGC    CCCY85                          CFT009
     C                     MOVELLEVIED    LCCY85                          CFT009
     C                     MOVELCVTRAT    RATE85                          CFT009
     C                     Z-ADD0         LCHG                            CFT009
     C                     MOVEL*BLANKS   LCHGF     P                     CFT009
      *                                                                   CFT009
     C                     CALL 'FT000985'                                CFT009
     C                     PARM           RET985 10                       CFT009
     C                     PARM           CHGA85 130                      CFT009
     C                     PARM           PCCY85  3                       CFT009
     C                     PARM           SCCY85  3                       CFT009
     C                     PARM           CCCY85  3                       CFT009
     C                     PARM           LCCY85  3                       CFT009
     C                     PARM           RATE85 138                      CFT009
     C                     PARM           LCHG   130                      CFT009
     C                     PARM           LCHGF  16                       CFT009
      *                                                                   CFT009
      ** Set up amounts                                                   CFT009
      *                                                                   CFT009
     C                     Z-ADDLCHG      OUTAMT                          CFT009
     C                     Z-ADDLCHG      F7M4CH                          CFT009
      *                                                                   CFT009
     C           DFTMS4    IFNE OUTAMT                                    CFT009
     C           WRN@,Z    IFEQ ' '                                       CFT009
     C           S7ACTD    ANDNE'E'                                       CFT009
     C                     MOVEL'Y'       E#WARN                          CFT009
     C                     MOVEL'Y'       E#MSGS                          CFT009
     C                     MOVELS7M4CD    FTMSDT    P                     CFT009
     C                     MOVELE#CPGM    FTPGMQ                          CFT009
     C                     MOVEL'FTF3174' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVEL'Y'       I7M4CD                          CFT009
      *                                                                   CFT009
     C                     MOVEL*BLANKS   E#RSND                          CFT009
     C                     MOVEA'Y'       WRN@,Z                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
      *                                                                   CFT009
      ** If screen field is blank and file field default is not then      CFT009
      ** send warning message to say fields are not the same.             CFT009
      *                                                                   CFT009
     C           WMISC4    IFNE *ZEROS                                    CFT009
     C           WRN@,Z    IFEQ ' '                                       CFT009
     C           S7ACTD    ANDNE'E'                                       CFT009
     C                     MOVEL'Y'       E#WARN                          CFT009
     C                     MOVEL'Y'       E#MSGS                          CFT009
     C                     MOVELS7M4CD    FTMSDT    P                     CFT009
     C                     MOVELE#CPGM    FTPGMQ                          CFT009
     C                     MOVEL'FTF3174' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVEL'Y'       I7M4CD                          CFT009
      *                                                                   CFT009
     C                     MOVEL*BLANKS   E#RSND                          CFT009
     C                     MOVEA'Y'       WRN@,Z                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Unwind subroutine stack name                                     CFT009
      *                                                                   CFT009
     C           EXM4CH    TAG                                            CFT009
     C                     MOVEA*BLANKS   @STK,Q                          CFT009
     C                     SUB  1         Q                               CFT009
      *                                                                   CFT009
     CSR                   ENDSR                                          CFT009
      *                                                                   CFT009
      *****************************************************************   CFT009
      /EJECT                                                              CFT009
      *****************************************************************   CFT009
      /TITLE SR/SRMSC5                                                    CFT009
      *****************************************************************   CFT009
      *                                                               *   CFT009
      *  SRMSC5 - Validate Miscellaneous Charge 5                     *   CFT009
      *                                                               *   CFT009
      *  Called By: SRPROC Subroutine                                 *   CFT009
      *                                                               *   CFT009
      *  Calls:                                                       *   CFT009
      *  SRALGN    - Calls ZALIGN.                                    *   CFT009
      *  FTSNMS    - Send message to program message queue.           *   CFT009
      *                                                               *   CFT009
      *****************************************************************   CFT009
      *                                                                   CFT009
     C           SRMSC5    BEGSR                           *** SRMSC5**** CFT009
      *                                                                   CFT009
      ** Set up subroutine stack name                                     CFT009
      *                                                                   CFT009
     C                     ADD  1         Q       50                      CFT009
     C                     MOVEL'SRMSC5'  @STK,Q                          CFT009
      *                                                                   CFT009
      ** Charge Code/Amounts will be validated                            CFT009
      *                                                                   CFT009
     C                     Z-ADD37        Z       30                      CFT009
      *                                                                   CFT009
      ** If the screen charge code is not equal to the defaulted          CFT009
      ** file charge code,  then send a warning message                   CFT009
      *                                                                   CFT009
      ** Miscellaneous Charge code is optional.                           CFT009
      *                                                                   CFT009
     C                     MOVE S7CD13    CHGCDE                          CFT009
     C           S7CD13    IFNE *BLANKS                                   CFT009
     C                     EXSR VALID                                     CFT009
     C           WI7CDE    IFEQ 'Y'                                       CFT009
     C                     MOVE 'Y'       I7CD13                          CFT009
     C                     ELSE                                           CFT009
     C           S7M5CD    IFEQ *BLANKS                                   CFT009
     C                     EXSR RECALC                                    CFT009
     C                     MOVE ZFIELD    S7M5CD                          CFT009
     C                     Z-ADDTOTCHG    F7M5CD                          CFT009
     C                     Z-ADDTOTCHG    F7M5CH                          CFT009
     C           S7VT13    IFEQ *BLANK                                    CFT009
     C           VATLIN    IFEQ 'Y'                                       CFT009
     C                     MOVE VATLIN    S7VT13                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE 'N'       S7VT13                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
     C           S7CD13    IFNE MSCHC5                                    CFT009
     C           WI7CDE    ANDNE'Y'                                       CFT009
     C           WRN@,Z    IFEQ ' '                                       CFT009
     C           S7ACTD    ANDNE'E'                                       CFT009
     C                     MOVEL'Y'       E#WARN                          CFT009
     C                     MOVEL'Y'       E#MSGS                          CFT009
     C                     MOVELS7CD13    FTMSDT    P                     CFT009
     C                     MOVELE#CPGM    FTPGMQ                          CFT009
     C                     MOVEL'FTF3188' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVEL'Y'       I7CD13                          CFT009
      *                                                                   CFT009
     C                     MOVEL*BLANKS   E#RSND                          CFT009
     C                     MOVEA'Y'       WRN@,Z                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Miscellaneous Charge code is optional                            CFT009
      *                                                                   CFT009
     C                     Z-ADD38        Z       30                      CFT009
      *                                                                   CFT009
     C                     Z-ADD0         F7M5CD                          CFT009
     C                     Z-ADD0         F7M5CH                          CFT009
      *                                                                   CFT009
      ** If screen field is entered and the defaulted field is blank      CFT009
      ** then send a warning message to say field is not same as default  CFT009
      *                                                                   CFT009
     C           S7M5CD    IFNE *BLANKS                                   CFT009
      *                                                                   CFT009
      ** Call currency conversion subroutine                              CFT009
      *                                                                   CFT009
     C                     EXSR CCYCNV                                    CFT009
      *                                                                   CFT009
     C           11        SUB  FRMDEC    ZADIG                           CFT009
     C                     Z-ADDFRMDEC    ZADEC                           CFT009
     C                     MOVEL*BLANKS   ZFIELD                          CFT009
     C                     MOVELS7M5CD    ZFIELD                          CFT009
     C                     EXSR SRALGN                                    CFT009
      *                                                                   CFT009
     C           ZRTN      IFEQ '*ERROR*'                                 CFT009
     C                     MOVEL'Y'       E#MSGS                          CFT009
     C           OPCHGC    CAT  S7M5CD    FTMSDT    P                     CFT009
     C                     MOVELE#CPGM    FTPGMQ                          CFT009
     C                     MOVEL'FTF3194' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVEL'Y'       I7M5CD                          CFT009
     C                     MOVEL'Y'       E#NOUP                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE ZFIELD    F7M5CD                          CFT009
     C                     MOVE ZFIELD    INPAMT                          CFT009
      *                                                                   CFT009
      ** Convert file default using screen ccy for comparison of          CFT009
      ** entered field and defaulted                                      CFT009
      *                                                                   CFT009
      ** Set up charge amount and currencies for call to FT000985.        CFT009
      *                                                                   CFT009
     C                     Z-ADDF7M5CD    CHGA85                          CFT009
     C                     MOVELPCCY      PCCY85                          CFT009
     C                     MOVELSMCY      SCCY85                          CFT009
     C                     MOVELOPCHGC    CCCY85                          CFT009
     C                     MOVELLEVIED    LCCY85                          CFT009
     C                     MOVELCVTRAT    RATE85                          CFT009
     C                     Z-ADD0         LCHG                            CFT009
     C                     MOVEL*BLANKS   LCHGF     P                     CFT009
      *                                                                   CFT009
     C                     CALL 'FT000985'                                CFT009
     C                     PARM           RET985 10                       CFT009
     C                     PARM           CHGA85 130                      CFT009
     C                     PARM           PCCY85  3                       CFT009
     C                     PARM           SCCY85  3                       CFT009
     C                     PARM           CCCY85  3                       CFT009
     C                     PARM           LCCY85  3                       CFT009
     C                     PARM           RATE85 138                      CFT009
     C                     PARM           LCHG   130                      CFT009
     C                     PARM           LCHGF  16                       CFT009
      *                                                                   CFT009
      ** Set up amounts                                                   CFT009
      *                                                                   CFT009
     C                     Z-ADDLCHG      OUTAMT                          CFT009
     C                     Z-ADDLCHG      F7M5CH                          CFT009
      *                                                                   CFT009
     C           DFTMS5    IFNE OUTAMT                                    CFT009
     C           WRN@,Z    IFEQ ' '                                       CFT009
     C           S7ACTD    ANDNE'E'                                       CFT009
     C                     MOVEL'Y'       E#WARN                          CFT009
     C                     MOVEL'Y'       E#MSGS                          CFT009
     C                     MOVELS7M5CD    FTMSDT    P                     CFT009
     C                     MOVELE#CPGM    FTPGMQ                          CFT009
     C                     MOVEL'FTF3175' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVEL'Y'       I7M5CD                          CFT009
      *                                                                   CFT009
     C                     MOVEL*BLANKS   E#RSND                          CFT009
     C                     MOVEA'Y'       WRN@,Z                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
      *                                                                   CFT009
      ** If screen field is blank and file field default is not then      CFT009
      ** send warning message to say fields are not the same.             CFT009
      *                                                                   CFT009
     C           WMISC5    IFNE *ZEROS                                    CFT009
     C           WRN@,Z    IFEQ ' '                                       CFT009
     C           S7ACTD    ANDNE'E'                                       CFT009
     C                     MOVEL'Y'       E#WARN                          CFT009
     C                     MOVEL'Y'       E#MSGS                          CFT009
     C                     MOVELS7M5CD    FTMSDT    P                     CFT009
     C                     MOVELE#CPGM    FTPGMQ                          CFT009
     C                     MOVEL'FTF3175' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVEL'Y'       I7M5CD                          CFT009
      *                                                                   CFT009
     C                     MOVEL*BLANKS   E#RSND                          CFT009
     C                     MOVEA'Y'       WRN@,Z                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
     C           EXM5CH    TAG                                            CFT009
     C                     MOVEA*BLANKS   @STK,Q                          CFT009
     C                     SUB  1         Q                               CFT009
      *                                                                   CFT009
     CSR                   ENDSR                                          CFT009
      *                                                                   CFT009
      *****************************************************************   CFT009
      /EJECT                                                              CFT009
      *****************************************************************   CFT009
      /TITLE SR/CCYCNV                                                    CFT009
      *****************************************************************   CFT009
      *                                                               *   CFT009
      *  CCYCNV - Currenct conversion                                 *   CFT009
      *                                                               *   CFT009
      *  Called By: SRTRCM Subroutine                                 *   CFT009
      *             SRCHCM Subroutine                                 *   CFT009
      *             SRTXCH Subroutine                                 *   CFT009
      *             SRCQCH Subroutine                                 *   CFT009
      *             SRCSTH Subroutine                                 *   CFT009
      *             SRSPCH Subroutine                                 *   CFT009
      *             SRMSCH Subroutine                                 *   CFT009
      *             SRM1CH Subroutine                                 *   CFT009
      *             SRM2CH Subroutine                                 *   CFT009
      *             SRM3CH Subroutine                                 *   CFT009
      *             SRM4CH Subroutine                                 *   CFT009
      *             SRM5CH Subroutine                                 *   CFT009
      *             SRSWST Subroutine                                 *   CFT009
      *  Calls:                                                       *   CFT009
      *  AOCURRRO                                                     *   CFT009
      *                                                               *   CFT009
      *****************************************************************   CFT009
      *                                                                   CFT009
     C           CCYCNV    BEGSR                           *** CCYCNV**** CFT009
      *                                                                   CFT009
      ** Set up subroutine stack name                                     CFT009
      *                                                                   CFT009
     C                     ADD  1         Q       50                      CFT009
     C                     MOVEL'CCYCNV'  @STK,Q                          CFT009
      *                                                                   CFT009
     C                     MOVE OPCHRT    CVTRAT                          CFT009
      *                                                                   CFT009
     C                     MOVELOPCHGC    FRMCCY  3                       CFT009
      *                                                                   CFT009
     C                     CALL 'AOCURRR0'                                CFT009
     C                     PARM *BLANKS   WRTCD                           CFT009
     C                     PARM '*KEY   ' WOPTN                           CFT009
     C                     PARM FRMCCY    WAJCD   3                       CFT009
     C           SDCURR    PARM SDCURR    DSSDY                           CFT009
      *                                                                   CFT009
     C                     MOVELA6NBDP    FRMDEC                          CFT009
     C                     MOVELA6MDIN    FRMMDI  1                       CFT009
     C                     MOVELA6SPRT    FRMSPT 138                      CFT009
      *                                                                   CFT009
     C                     MOVELV#RCCY    TOCCY   3                       CFT009
      *                                                                   CFT009
      ** Calculate Charge currency equivalent                             CFT009
      *                                                                   CFT009
     C                     CALL 'AOCURRR0'                                CFT009
     C                     PARM *BLANKS   WRTCD                           CFT009
     C                     PARM '*KEY   ' WOPTN                           CFT009
     C                     PARM TOCCY     WAJCD   3                       CFT009
     C           SDCURR    PARM SDCURR    DSSDY                           CFT009
      *                                                                   CFT009
     C                     MOVELA6NBDP    TODEC                           CFT009
     C                     MOVELA6MDIN    TOMDI   1                       CFT009
     C                     MOVELA6SPRT    TOSPT  138                      CFT009
      *                                                                   CFT009
     C           FRMCCY    IFEQ TOCCY                                     CFT009
     C                     Z-ADD1         CVTRAT                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Get the X-rate between from and to ccy.                          CFT009
      *                                                                   CFT009
     C                     MOVELFRMMDI    ZMDI1   1                       CFT009
     C                     Z-ADDFRMSPT    ZRATE1 138                      CFT009
      *                                                                   CFT009
     C                     MOVELTOMDI     ZMDI2   1                       CFT009
     C                     Z-ADDTOSPT     ZRATE2 138                      CFT009
      *                                                                   CFT009
     C                     EXSR ZXRATE                                    CFT009
      *                                                                   CFT009
     C                     Z-ADDZRATEX    CHGRAT 138                      CFT009
     C                     Z-ADDZRATEX    CVTRAT                          CFT009
     C                     MOVE ZMDIX     CHGMDI  1                       CFT009
      *                                                                   CFT009
     C                     MOVE CHGMDI    FRMMD                           CFT009
      *                                                                   CFT009
      * If use transaction exchange rate, add it in                       CFT009
     C           CHTRCY    IFEQ 'Y'                                       CFT009
      *                                                                   CFT009
     C                     Z-ADDRATE      CVTRAT                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** UNWIND subroutine stack name                                     CFT009
      *                                                                   CFT009
     C                     MOVEA*BLANKS   @STK,Q                          CFT009
     C                     SUB  1         Q                               CFT009
      *                                                                   CFT009
     CSR                   ENDSR                                          CFT009
      *                                                                   CFT009
      *****************************************************************   CFT009
      /EJECT                                                              CFT009
      *****************************************************************   CFT009
      /TITLE SR/VALID                                                     CFT009
      *****************************************************************   CFT009
      *                                                               *   CFT009
      *  VALID  - Validate charge codes                               *   CFT009
      *                                                               *   CFT009
      *  Called By: SRTRCM Subroutine                                 *   CFT009
      *             SRCHCM Subroutine                                 *   CFT009
      *             SRTXCH Subroutine                                 *   CFT009
      *             SRCQCH Subroutine                                 *   CFT009
      *             SRCSTH Subroutine                                 *   CFT009
      *             SRSPCH Subroutine                                 *   CFT009
      *             SRMSCH Subroutine                                 *   CFT009
      *             SRM1CH Subroutine                                 *   CFT009
      *             SRM2CH Subroutine                                 *   CFT009
      *             SRM3CH Subroutine                                 *   CFT009
      *             SRM4CH Subroutine                                 *   CFT009
      *             SRM5CH Subroutine                                 *   CFT009
      *             SRSWST Subroutine                                 *   CFT009
      *  Calls:                                                       *   CFT009
      *  SRALGN    - Calls ZALIGN.                                    *   CFT009
      *  FTSNMS    - Send message to program message queue.           *   CFT009
      *                                                               *   CFT009
      *****************************************************************   CFT009
      *                                                                   CFT009
     C           VALID     BEGSR                           *** VALID **** CFT009
      *                                                                   CFT009
      ** Set up subroutine stack name                                     CFT009
      *                                                                   CFT009
     C                     ADD  1         Q       50                      CFT009
     C                     MOVEL'VALID '  @STK,Q                          CFT009
      *                                                                   CFT009
     C                     MOVEL*BLANKS   ZFIELD                          CFT009
     C                     MOVEL*BLANKS   WI7CDE                          CFT009
      *                                                                   CFT009
     C           CHGCDE    IFNE *BLANKS                                   CFT009
      *                                                                   CFT009
      ** Check that charge code exists if it does recalculate charges     CFT009
      *                                                                   CFT009
     C           CHGCDE    CHAINFTPCHGL0             90                   CFT009
      *                                                                   CFT009
     C           *IN90     IFEQ *ON                                       CFT009
     C                     MOVEL'Y'       E#MSGS                          CFT009
     C                     MOVELCHGCDE    FTMSDT                          CFT009
     C                     MOVELE#CPGM    FTPGMQ                          CFT009
     C                     MOVEL'FTF3189' FTMSID                          CFT009
     C                     EXSR FTSNMS                                    CFT009
     C                     MOVEL'Y'       WI7CDE  1                       CFT009
     C                     MOVEL'Y'       E#NOUP                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVEL' '       WI7CDE                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** UNWIND subroutine stack name                                     CFT009
      *                                                                   CFT009
     C           EXVALI    TAG                                            CFT009
     C                     MOVEA*BLANKS   @STK,Q                          CFT009
     C                     SUB  1         Q                               CFT009
      *                                                                   CFT009
     CSR                   ENDSR                                          CFT009
      *                                                                   CFT009
      *****************************************************************   CFT009
      /EJECT                                                              CFT009
      *****************************************************************   CFT009
      /TITLE SR/DEFLT                                                     CFT009
      *****************************************************************   CFT009
      *                                                               *   CFT009
      *  DEFLT  - Check charge code defaults and amounts              *   CFT009
      *                                                               *   CFT009
      *  Called By: SRTRCM Subroutine                                 *   CFT009
      *                                                               *   CFT009
      *  Calls:                                                       *   CFT009
      *  SRALGN    - Calls ZALIGN.                                    *   CFT009
      *  FTSNMS    - Send message to program message queue.           *   CFT009
      *                                                               *   CFT009
      *****************************************************************   CFT009
      *                                                                   CFT009
     C           DEFLT     BEGSR                           *** DEFLT **** CFT009
      *                                                                   CFT009
      ** Set up subroutine stack name                                     CFT009
      *                                                                   CFT009
     C                     ADD  1         Q       50                      CFT009
     C                     MOVEL'DEFLT '  @STK,Q                          CFT009
      *                                                                   CFT009
      * If charges currency changed, reapply defaults                     CFT009
     C           *LIKE     DEFN OPCHGC    SAVCHG                          CFT009
      *                                                                   CFT009
     C           OPCHGC    IFNE SAVCHG                                    CFT009
     C                     EXSR CLRS7                                     CFT009
     C                     EXSR APYDFT                                    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVELCHGCCY    SAVCHG                          CFT009
      *                                                                   CFT009
     C                     MOVEL*BLANKS   ZFIELD                          CFT009
      *                                                                   CFT009
     C                     MOVELV#INBX    INBT                            CFT009
     C                     MOVELV#INBY    INB1                            CFT009
     C                     MOVELV#INBZ    INB2                            CFT009
     C                     MOVELV#ACBX    ACBT                            CFT009
     C                     MOVELV#ACBY    ACB1                            CFT009
     C                     MOVELV#ACBZ    ACB2                            CFT009
      *                                                                   CFT009
      ** UNWIND subroutine stack name                                     CFT009
      *                                                                   CFT009
     C           EXDEFT    TAG                                            CFT009
     C                     MOVEA*BLANKS   @STK,Q                          CFT009
     C                     SUB  1         Q                               CFT009
      *                                                                   CFT009
     CSR                   ENDSR                                          CFT009
      *                                                                   CFT009
      *****************************************************************   CFT009
      /EJECT                                                              CFT009
      *****************************************************************   CFT009
      /TITLE SR/RECALC                                                    CFT009
      *****************************************************************   CFT009
      *                                                               *   CFT009
      *  RECALC - Recalculate chagre code amounts                     *   CFT009
      *                                                               *   CFT009
      *  Called By: SRTRCM Subroutine                                 *   CFT009
      *             SRCHCM Subroutine                                 *   CFT009
      *             SRTXCH Subroutine                                 *   CFT009
      *             SRCQCH Subroutine                                 *   CFT009
      *             SRCSTH Subroutine                                 *   CFT009
      *             SRSPCH Subroutine                                 *   CFT009
      *             SRMSCH Subroutine                                 *   CFT009
      *             SRM1CH Subroutine                                 *   CFT009
      *             SRM2CH Subroutine                                 *   CFT009
      *             SRM3CH Subroutine                                 *   CFT009
      *             SRM4CH Subroutine                                 *   CFT009
      *             SRM5CH Subroutine                                 *   CFT009
      *             SRSWST Subroutine                                 *   CFT009
      *  Calls:                                                       *   CFT009
      *  SRALGN    - Calls ZALIGN.                                    *   CFT009
      *  FTSNMS    - Send message to program message queue.           *   CFT009
      *                                                               *   CFT009
      *****************************************************************   CFT009
      *                                                                   CFT009
     C           RECALC    BEGSR                           *** RECALC**** CFT009
      *                                                                   CFT009
      ** Set up subroutine stack name                                     CFT009
      *                                                                   CFT009
     C                     ADD  1         Q       50                      CFT009
     C                     MOVEL'RECALC'  @STK,Q                          CFT009
      *                                                                   CFT009
     C                     MOVEL*BLANKS   ZFIELD                          CFT009
      *                                                                   CFT009
     C           CHGCDE    IFNE *BLANKS                                   CFT009
      *                                                                   CFT009
     C           CHGCDE    CHAINFTPCHGL0             90                   CFT009
      *                                                                   CFT009
     C           *IN90     IFEQ *OFF                                      CFT009
      *                                                                   CFT009
      * OUTPUTS:                                                          CFT009
      ** Return Code (10A)                                                CFT009
      ** Payment Amount (13,0)                                            CFT009
      ** Payment Currency (3A)                                            CFT009
      ** Charges Currency (3A)                                            CFT009
      ** Exchange Rate from transaction (13,8)                            CFT009
      ** STP flag (1A)                                                    CFT009
      ** Payment Charge Code (5A)                                         CFT009
      ** Settle Amount (13,0)                                                                 CFT120
      ** Charges to debit of account (18A)                                                    CFT120
      ** Add deduct indicator (1A)                                                            CFT120
      ** Charges to the DR of Currency (3A)                                                   CFT120
      *                                                                   CFT009
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
     C                     MOVE V#CCCY    OPCHGC                          CFT009
     C                     MOVE V#CCCY    F7CHCY                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVELOPCHGC    CHGCCY                          CFT009
     C                     Z-ADDPYAM      PAYAMT                          CFT009
     C                     MOVE PCCY      PAYCCY                          CFT009
      *                                                                   CFT009
      *                                                                   CFT009
     C                     CALL 'AOCURRR0'                                CFT009
     C                     PARM *BLANKS   WRTCD                           CFT009
     C                     PARM '*KEY   ' WOPTN                           CFT009
     C                     PARM           CHGCCY                          CFT009
     C           SDCURR    PARM SDCURR    DSSDY                           CFT009
     C                     Z-ADDA6SPRT    CHGEXC                          CFT009
      *                                                                   CFT009
      * If use transaction exchange rate, add it in                       CFT009
     C           CHTRCY    IFEQ 'Y'                                       CFT009
     C                     Z-ADDRATE      CHGEXC                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      *                                                                   CFT009
     C                     CALL 'FT000981'                                CFT009
     C                     PARM *BLANKS   WRTCD                           CFT009
     C                     PARM           PAYAMT 130                      CFT009
     C                     PARM           PAYCCY  3                       CFT009
     C                     PARM V#SMCY    SETCCY  3                       CFT009
     C                     PARM           CHGCCY  3                       CFT009
     C                     PARM           CHGEXC 138                      CFT009
     C                     PARM           STP     1                       CFT009
     C                     PARM           CHGCDE  5                       CFT009
     C                     PARM SMAM      PSMAM  130                      CFT009
     C                     PARM           S7CDRO                          CFT009
     C                     PARM ADDC      PADDC   1                       CFT009
     C                     PARM *BLANKS   PCDRC   3                                           CFT120
      *                                                                   CFT009
      * RETURNS:                                                          CFT009
      ** Total Charge (13,0)                                              CFT009
      ** Chargeable Amount (13,0)                                         CFT009
      ** Charge per Tier (11 x 13A)                                       CFT009
      ** Amount being charged by Tier (11 x 13A)                          CFT009
     C                     PARM           TOTCHG 130                      CFT009
     C                     PARM           CHGAMT 130                      CFT009
     C                     PARM           PTIERC                          CFT009
     C                     PARM           PTIERA                          CFT009
      *                                                                   CFT009
     C           WRTCD     IFEQ *BLANKS                                   CFT009
     C                     CALL 'AOCURRR0'                                CFT009
     C                     PARM *BLANKS   WRTCD                           CFT009
     C                     PARM '*KEY   ' WOPTN                           CFT009
     C                     PARM CHGCCY    WAJCD   3                       CFT009
     C           SDCURR    PARM SDCURR    DSSDY                           CFT009
      *                                                                   CFT009
      ** Database error                                                   CFT009
      *                                                                   CFT009
     C           WRTCD     IFNE *BLANK                                    CFT009
     C                     MOVEL'SDCURRPD'W0FILE                          CFT009
     C                     MOVELCHGCCY    W0KEY                           CFT009
     C                     Z-ADD26        W0ERNB                          CFT009
     C                     MOVEL'MEM5003' W0MSGD                          CFT009
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT009
     C                     EXSR SRERR                                     CFT009
     C                     ENDIF                                          CFT009
     C                     MOVE TOTCHG    ZFIELD                          CFT009
     C                     CALL 'ZEDIT'                9090               CFT009
     C                     PARM           ZFIELD 16                       CFT009
     C                     PARM A6NBDP    ZADEC   10                      CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     MOVEL'FT000981'W0FILE                          CFT009
     C                     MOVELCHGCDE    W0KEY                           CFT009
     C                     Z-ADD27        W0ERNB                          CFT009
     C                     MOVEL'MEM5003' W0MSGD                          CFT009
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT009
     C                     EXSR SRERR                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** UNWIND subroutine stack name                                     CFT009
      *                                                                   CFT009
     C           EXRECA    TAG                                            CFT009
     C                     MOVEA*BLANKS   @STK,Q                          CFT009
     C                     SUB  1         Q                               CFT009
      *                                                                   CFT009
     CSR                   ENDSR                                          CFT009
      *                                                                   CFT009
      /EJECT
      *****************************************************************
      /TITLE SR/SRVATT
      *****************************************************************
      *                                                               *
      *  SRVATT - Validate V.A.T flags                                *
      *                                                               *
      *  Called By: SRPROC subroutine                                 *
      *                                                               *
      *  Calls:                                                       *
      *  FTSNMS    - Send message to program message queue.           *
      *                                                               *
      *****************************************************************
      *
     C           SRVATT    BEGSR                           *** SRVATT ***
      *
      ** Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SRVATT'  @STK,Q
      *
      ** Apply V.A.T. flag must be 'Y' or 'N' or blank.  If blank,
      ** default to value retrieved from program FT0005.
      *
     C                     MOVEL*BLANKS   @VCHG  20
     C                     MOVE WVAT1     @VCHG
     C           S7VAT1    IFEQ *BLANKS
     C                     MOVELV#VATT    S7VAT1
     C                     ELSE
     C           S7VAT1    IFNE 'Y'
     C           S7VAT1    ANDNE'N'
     C                     MOVEL'Y'       E#MSGS
     C           S7VAT1    CAT  @VCHG     FTMSDT
     C                     MOVELE#CPGM    FTPGMQ
     C                     MOVEL'FTM2524' FTMSID
     C                     EXSR FTSNMS
     C                     MOVEL'Y'       I7VAT1
     C                     MOVEL'Y'       E#NOUP
     C                     ENDIF
     C                     ENDIF
      *
     C                     MOVEL*BLANKS   @VCHG  20
     C                     MOVE WVAT2     @VCHG
     C           S7VAT2    IFEQ *BLANKS
     C                     MOVELV#VATT    S7VAT2
     C                     ELSE
     C           S7VAT2    IFNE 'Y'
     C           S7VAT2    ANDNE'N'
     C                     MOVEL'Y'       E#MSGS
     C           S7VAT2    CAT  @VCHG     FTMSDT
     C                     MOVELE#CPGM    FTPGMQ
     C                     MOVEL'FTM2524' FTMSID
     C                     EXSR FTSNMS
     C                     MOVEL'Y'       I7VAT2
     C                     MOVEL'Y'       E#NOUP
     C                     ENDIF
     C                     ENDIF
      *
     C                     MOVEL*BLANKS   @VCHG  20
     C                     MOVE WVAT3     @VCHG
     C           S7VAT3    IFEQ *BLANKS
     C                     MOVELV#VATT    S7VAT3
     C                     ELSE
     C           S7VAT3    IFNE 'Y'
     C           S7VAT3    ANDNE'N'
     C                     MOVEL'Y'       E#MSGS
     C           S7VAT3    CAT  @VCHG     FTMSDT
     C                     MOVELE#CPGM    FTPGMQ
     C                     MOVEL'FTM2524' FTMSID
     C                     EXSR FTSNMS
     C                     MOVEL'Y'       I7VAT3
     C                     MOVEL'Y'       E#NOUP
     C                     ENDIF
     C                     ENDIF
      *
     C                     MOVEL*BLANKS   @VCHG  20
     C                     MOVE WVAT4     @VCHG
     C           S7VAT4    IFEQ *BLANKS
     C                     MOVELV#VATT    S7VAT4
     C                     ELSE
     C           S7VAT4    IFNE 'Y'
     C           S7VAT4    ANDNE'N'
     C                     MOVEL'Y'       E#MSGS
     C           S7VAT4    CAT  @VCHG     FTMSDT
     C                     MOVELE#CPGM    FTPGMQ
     C                     MOVEL'FTM2524' FTMSID
     C                     EXSR FTSNMS
     C                     MOVEL'Y'       I7VAT4
     C                     MOVEL'Y'       E#NOUP
     C                     ENDIF
     C                     ENDIF
      *
     C                     MOVEL*BLANKS   @VCHG  20
     C                     MOVE WVAT5     @VCHG
     C           S7VAT5    IFEQ *BLANKS
     C                     MOVELV#VATT    S7VAT5
     C                     ELSE
     C           S7VAT5    IFNE 'Y'
     C           S7VAT5    ANDNE'N'
     C                     MOVEL'Y'       E#MSGS
     C           S7VAT5    CAT  @VCHG     FTMSDT
     C                     MOVELE#CPGM    FTPGMQ
     C                     MOVEL'FTM2524' FTMSID
     C                     EXSR FTSNMS
     C                     MOVEL'Y'       I7VAT5
     C                     MOVEL'Y'       E#NOUP
     C                     ENDIF
     C                     ENDIF
      *
     C                     MOVEL*BLANKS   @VCHG  20
     C                     MOVE WVAT6     @VCHG
     C           S7VAT6    IFEQ *BLANKS
     C                     MOVELV#VATT    S7VAT6
     C                     ELSE
     C           S7VAT6    IFNE 'Y'
     C           S7VAT6    ANDNE'N'
     C                     MOVEL'Y'       E#MSGS
     C           S7VAT6    CAT  @VCHG     FTMSDT
     C                     MOVELE#CPGM    FTPGMQ
     C                     MOVEL'FTM2524' FTMSID
     C                     EXSR FTSNMS
     C                     MOVEL'Y'       I7VAT6
     C                     MOVEL'Y'       E#NOUP
     C                     ENDIF
     C                     ENDIF
      *
     C                     MOVEL*BLANKS   @VCHG  20
     C                     MOVE WVAT7     @VCHG
     C           S7VAT7    IFEQ *BLANKS
     C                     MOVELV#VATT    S7VAT7
     C                     ELSE
     C           S7VAT7    IFNE 'Y'
     C           S7VAT7    ANDNE'N'
     C                     MOVEL'Y'       E#MSGS
     C           S7VAT7    CAT  @VCHG     FTMSDT
     C                     MOVELE#CPGM    FTPGMQ
     C                     MOVEL'FTM2524' FTMSID
     C                     EXSR FTSNMS
     C                     MOVEL'Y'       I7VAT7
     C                     MOVEL'Y'       E#NOUP
     C                     ENDIF
     C                     ENDIF
      *                                                                   CFT009
     C           S7CDE6    IFEQ *BLANKS                                   CFT009
     C           S7STCD    ANDEQ*BLANKS                                   CFT009
     C                     MOVEL*BLANK    S7VT14                          CFT009
     C                     ELSE                                           CFT009
     C           S7VT14    IFNE 'Y'                                       CFT009
     C           S7VT14    ANDNE'N'                                       CFT009
     C                     MOVEL'Y'       I7VT14                          CFT009
     C                     MOVEL'Y'       E#NOUP                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           S7CDE9    IFEQ *BLANKS                                   CFT009
     C           S7M1CD    ANDEQ*BLANKS                                   CFT009
     C                     MOVEL*BLANK    S7VT9                           CFT009
     C                     ELSE                                           CFT009
     C           S7VT9     IFNE 'Y'                                       CFT009
     C           S7VT9     ANDNE'N'                                       CFT009
     C                     MOVEL'Y'       I7VT9                           CFT009
     C                     MOVEL'Y'       E#NOUP                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           S7CD10    IFEQ *BLANKS                                   CFT009
     C           S7M2CD    ANDEQ*BLANKS                                   CFT009
     C                     MOVEL*BLANK    S7VT10                          CFT009
     C                     ELSE                                           CFT009
     C           S7VT10    IFNE 'Y'                                       CFT009
     C           S7VT10    ANDNE'N'                                       CFT009
     C                     MOVEL'Y'       I7VT10                          CFT009
     C                     MOVEL'Y'       E#NOUP                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           S7CD11    IFEQ *BLANKS                                   CFT009
     C           S7M3CD    ANDEQ*BLANKS                                   CFT009
     C                     MOVEL*BLANK    S7VT11                          CFT009
     C                     ELSE                                           CFT009
     C           S7VT11    IFNE 'Y'                                       CFT009
     C           S7VT11    ANDNE'N'                                       CFT009
     C                     MOVEL'Y'       I7VT11                          CFT009
     C                     MOVEL'Y'       E#NOUP                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           S7CD12    IFEQ *BLANKS                                   CFT009
     C           S7M4CD    ANDEQ*BLANKS                                   CFT009
     C                     MOVEL*BLANK    S7VT12                          CFT009
     C                     ELSE                                           CFT009
     C           S7VT12    IFNE 'Y'                                       CFT009
     C           S7VT12    ANDNE'N'                                       CFT009
     C                     MOVEL'Y'       I7VT12                          CFT009
     C                     MOVEL'Y'       E#NOUP                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           S7CD13    IFEQ *BLANKS                                   CFT009
     C           S7M5CD    ANDEQ*BLANKS                                   CFT009
     C                     MOVEL*BLANK    S7VT13                          CFT009
     C                     ELSE                                           CFT009
     C           S7VT13    IFNE 'Y'                                       CFT009
     C           S7VT13    ANDNE'N'                                       CFT009
     C                     MOVEL'Y'       I7VT13                          CFT009
     C                     MOVEL'Y'       E#NOUP                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      *
      ** Unwind subroutine stack name
      *
     C           EXVATT    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      /TITLE SR/SRTOT
      *****************************************************************
      *                                                               *
      *  SRTOT  - Check Total Charges do not exceed Payment Amount    *
      *                                                               *
      *  Called By: SRPROC Subroutine                                 *
      *                                                               *
      *  Calls:                                                       *
      *  AOCUSTR0  - Access Object to convert currency.               *
      *  SRFT10    - Validate and Calculate currencies.               *
      *  SRERR     - Error subroutine.                                *
      *  FTSNMS    - Send message to program message queue.           *
      *                                                               *
      *****************************************************************
      *
     C           SRTOT     BEGSR                           *** SRTOT  ***
      *
      ** Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SRTOT '  @STK,Q
      *
      *                                                                   CFT009
      ** IF CFT009 ACTIVE, ALREADY CALCULATED                             CFT009
      *                                                                   CFT009
     C           CFT009    IFEQ 'N'                                       CFT009
      ** If EMU FT Enhancement is switched on then
      ** save work date parameter for call to FT0010 as W#DT
      *
     C           CEU006    IFEQ 'Y'
     C           V#ADDC    IFEQ 'A'
     C                     Z-ADDV#SLDT    W#DT
     C                     ELSE
     C                     Z-ADDV#PVDT    W#DT
     C                     ENDIF
     C                     ENDIF
      *
      ** Transfer Commission Charge
      ** --------------------------
      *
     C           F7TRCD    IFNE 0
      *
     C           CEU006    IFEQ 'Y'
      *
      ** If EMU FT Enhancement is switched on then call FT0010
      *
     C                     CLEARP#0010
     C                     MOVE V#CCCY    P#FRCY
     C                     Z-ADDF7TRCD    P#FRAM
     C                     Z-ADDW#DT      P#FRDT
     C                     MOVE V#RCCY    P#TOCY
     C                     Z-ADDW#DT      P#TODT
     C                     EXSR SRFT10
     C                     Z-ADDP#TOAM    F7TRCM
      *
     C                     ELSE
      *
     C                     CLEARD#DTA
     C                     MOVE F7TRCD    D#FAMT
     C                     MOVELV#CCCY    D#FCCY
     C                     MOVELV#RCCY    D#TCCY
      *
     C                     CALL 'AOCCYCV0'             9090
     C                     PARM *BLANKS   O#RTN   7
     C                     PARM '*F*T*SPT'W0ACT   8
     C           D#DTA     PARM D#DTA     O#DTA 256
      *
     C           *IN90     IFEQ *ON
     C           O#RTN     ORNE *BLANKS
     C                     MOVEL'AOCCYCV0'W0FILE
     C                     MOVEL'*CALL'   W0KEY
     C                     Z-ADD11        W0ERNB
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     ENDIF
      *
     C                     Z-ADDD#TAMT    F7TRCM
      *
     C                     ENDIF
      *
     C                     ENDIF
      *
     C                     Z-ADDF7TRCM    TTLCHG 130
      *
      ** Telex Charge
      ** ------------
      *
     C           F7TXCD    IFNE 0
      *
     C           CEU006    IFEQ 'Y'
      *
      ** If EMU FT Enhancement is switched on then call FT0010
      *
     C                     CLEARP#0010
     C                     MOVE V#CCCY    P#FRCY
     C                     Z-ADDF7TXCD    P#FRAM
     C                     Z-ADDW#DT      P#FRDT
     C                     MOVE V#RCCY    P#TOCY
     C                     Z-ADDW#DT      P#TODT
     C                     EXSR SRFT10
     C                     Z-ADDP#TOAM    F7TXCH
     C                     ELSE
     C                     CLEARD#DTA
     C                     MOVE F7TXCD    D#FAMT
     C                     MOVELV#CCCY    D#FCCY
     C                     MOVELV#RCCY    D#TCCY
      *
     C                     CALL 'AOCCYCV0'             9090
     C                     PARM *BLANKS   O#RTN   7
     C                     PARM '*F*T*SPT'W0ACT   8
     C           D#DTA     PARM D#DTA     O#DTA 256
      *
     C           *IN90     IFEQ *ON
     C           O#RTN     ORNE *BLANKS
     C                     MOVEL'AOCCYCV0'W0FILE
     C                     MOVEL'*CALL'   W0KEY
     C                     Z-ADD12        W0ERNB
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     ENDIF
      *
     C                     Z-ADDD#TAMT    F7TXCH
      *
     C                     ENDIF
      *
     C                     ENDIF
      *
     C                     ADD  F7TXCH    TTLCHG
      *
      ** Cheque Charge
      ** -------------
      *
     C           F7CQCD    IFNE 0
     C           CEU006    IFEQ 'Y'
      *
      ** If EMU FT Enhancement is switched on then call FT0010
      *
     C                     CLEARP#0010
     C                     MOVE V#CCCY    P#FRCY
     C                     Z-ADDF7CQCD    P#FRAM
     C                     Z-ADDW#DT      P#FRDT
     C                     MOVE V#RCCY    P#TOCY
     C                     Z-ADDW#DT      P#TODT
     C                     EXSR SRFT10
     C                     Z-ADDP#TOAM    F7CQCH
     C                     ELSE
     C                     CLEARD#DTA
     C                     MOVE F7CQCD    D#FAMT
     C                     MOVELV#CCCY    D#FCCY
     C                     MOVELV#RCCY    D#TCCY
      *
     C                     CALL 'AOCCYCV0'             9090
     C                     PARM *BLANKS   O#RTN   7
     C                     PARM '*F*T*SPT'W0ACT   8
     C           D#DTA     PARM D#DTA     O#DTA 256
      *
     C           *IN90     IFEQ *ON
     C           O#RTN     ORNE *BLANKS
     C                     MOVEL'AOCCYCV0'W0FILE
     C                     MOVEL'*CALL'   W0KEY
     C                     Z-ADD13        W0ERNB
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     ENDIF
      *
     C                     Z-ADDD#TAMT    F7CQCH
      *
     C                     ENDIF
      *
     C                     ENDIF
      *
     C                     ADD  F7CQCH    TTLCHG
      *
      ** Costs Abroad
      ** ------------
      *
     C           F7CSTD    IFNE 0
      *
     C           CEU006    IFEQ 'Y'
      *
      ** If EMU FT Enhancement is switched on then call FT0010
      *
     C                     CLEARP#0010
     C                     MOVE V#CCCY    P#FRCY
     C                     Z-ADDF7CSTD    P#FRAM
     C                     Z-ADDW#DT      P#FRDT
     C                     MOVE V#RCCY    P#TOCY
     C                     Z-ADDW#DT      P#TODT
     C                     EXSR SRFT10
     C                     Z-ADDP#TOAM    F7CSTA
     C                     ELSE
     C                     CLEARD#DTA
     C                     MOVE F7CSTD    D#FAMT
     C                     MOVELV#CCCY    D#FCCY
     C                     MOVELV#RCCY    D#TCCY
      *
     C                     CALL 'AOCCYCV0'             9090
     C                     PARM *BLANKS   O#RTN
     C                     PARM '*F*T*SPT'W0ACT
     C           D#DTA     PARM D#DTA     O#DTA
      *
     C           *IN90     IFEQ *ON
     C           O#RTN     ORNE *BLANKS
     C                     MOVEL'AOCCYCV0'W0FILE
     C                     MOVEL'*CALL'   W0KEY
     C                     Z-ADD14        W0ERNB
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     ENDIF
      *
     C                     Z-ADDD#TAMT    F7CSTA
      *
     C                     ENDIF
      *
     C                     ENDIF
      *
     C                     ADD  F7CSTA    TTLCHG
      *
      ** SWIFT Priority Charge
      ** ---------------------
      *
     C           F7SPCD    IFNE 0
      *
     C           CEU006    IFEQ 'Y'
      *
      ** If EMU FT Enhancement is switched on then call FT0010
      *
     C                     CLEARP#0010
     C                     MOVE V#CCCY    P#FRCY
     C                     Z-ADDF7SPCD    P#FRAM
     C                     Z-ADDW#DT      P#FRDT
     C                     MOVE V#RCCY    P#TOCY
     C                     Z-ADDW#DT      P#TODT
     C                     EXSR SRFT10
     C                     Z-ADDP#TOAM    F7SPCH
     C                     ELSE
     C                     CLEARD#DTA
     C                     MOVE F7SPCD    D#FAMT
     C                     MOVELV#CCCY    D#FCCY
     C                     MOVELV#RCCY    D#TCCY
      *
     C                     CALL 'AOCCYCV0'             9090
     C                     PARM *BLANKS   O#RTN
     C                     PARM '*F*T*SPT'W0ACT
     C           D#DTA     PARM D#DTA     O#DTA
      *
     C           *IN90     IFEQ *ON
     C           O#RTN     ORNE *BLANKS
     C                     MOVEL'AOCCYCV0'W0FILE
     C                     MOVEL'*CALL'   W0KEY
     C                     Z-ADD15        W0ERNB
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     ENDIF
      *
     C                     Z-ADDD#TAMT    F7SPCH
      *
     C                     ENDIF
      *
     C                     ENDIF
      *
     C                     ADD  F7SPCH    TTLCHG
      *
      ** Miscellaneous Charge
      ** --------------------
      *
     C           F7MSCD    IFNE 0
     C           CEU006    IFEQ 'Y'
      *
      ** If EMU FT Enhancement is switched on then call FT0010
      *
     C                     CLEARP#0010
     C                     MOVE V#CCCY    P#FRCY
     C                     Z-ADDF7MSCD    P#FRAM
     C                     Z-ADDW#DT      P#FRDT
     C                     MOVE V#RCCY    P#TOCY
     C                     Z-ADDW#DT      P#TODT
     C                     EXSR SRFT10
     C                     Z-ADDP#TOAM    F7MSCH
     C                     ELSE
     C                     CLEARD#DTA
     C                     MOVE F7MSCD    D#FAMT
     C                     MOVELV#CCCY    D#FCCY
     C                     MOVELV#RCCY    D#TCCY
      *
     C                     CALL 'AOCCYCV0'             9090
     C                     PARM *BLANKS   O#RTN
     C                     PARM '*F*T*SPT'W0ACT
     C           D#DTA     PARM D#DTA     O#DTA
      *
     C           *IN90     IFEQ *ON
     C           O#RTN     ORNE *BLANKS
     C                     MOVEL'AOCCYCV0'W0FILE
     C                     MOVEL'*CALL'   W0KEY
     C                     Z-ADD16        W0ERNB
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     ENDIF
      *
     C                     Z-ADDD#TAMT    F7MSCH
      *
     C                     ENDIF
      *
     C                     ENDIF
      *
     C                     ADD  F7MSCH    TTLCHG
      *
      ** FX/Change Commission
      ** --------------------
      *
     C           F7CHCD    IFNE 0
     C           S01494    ANDEQ'Y'
      *
     C           CEU006    IFEQ 'Y'
      *
      ** If EMU FT Enhancement is switched on then call FT0010
      *
     C                     CLEARP#0010
     C                     MOVE V#CCCY    P#FRCY
     C                     Z-ADDF7CHCD    P#FRAM
     C                     Z-ADDW#DT      P#FRDT
     C                     MOVE V#RCCY    P#TOCY
     C                     Z-ADDW#DT      P#TODT
     C                     EXSR SRFT10
     C                     Z-ADDP#TOAM    F7CHCM
     C                     ELSE
     C                     CLEARD#DTA
     C                     MOVE F7CHCD    D#FAMT
     C                     MOVELV#CCCY    D#FCCY
     C                     MOVELV#RCCY    D#TCCY
      *
     C                     CALL 'AOCCYCV0'             9090
     C                     PARM *BLANKS   O#RTN
     C                     PARM '*F*T*SPT'W0ACT
     C           D#DTA     PARM D#DTA     O#DTA
      *
     C           *IN90     IFEQ *ON
     C           O#RTN     ORNE *BLANKS
     C                     MOVEL'AOCCYCV0'W0FILE
     C                     MOVEL'*CALL'   W0KEY
     C                     Z-ADD17        W0ERNB
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     ENDIF
      *
     C                     Z-ADDD#TAMT    F7CHCM
      *
     C                     ENDIF
      *
     C                     ENDIF
      *
     C                     ADD  F7CHCM    TTLCHG
     C                     ELSE                                           CFT009
     C                     Z-ADDF7TRCM    TTLCHG 130                      CFT009
     C                     ADD  F7TXCH    TTLCHG                          CFT009
     C                     ADD  F7CQCH    TTLCHG                          CFT009
     C                     ADD  F7CSTA    TTLCHG                          CFT009
     C                     ADD  F7SPCH    TTLCHG                          CFT009
     C                     ADD  F7CHCM    TTLCHG                          CFT009
     C                     ADD  F7MSCH    TTLCHG                          CFT009
     C                     ADD  F7STCH    TTLCHG                          CFT009
     C                     ADD  F7M1CH    TTLCHG                          CFT009
     C                     ADD  F7M2CH    TTLCHG                          CFT009
     C                     ADD  F7M3CH    TTLCHG                          CFT009
     C                     ADD  F7M4CH    TTLCHG                          CFT009
     C                     ADD  F7M5CH    TTLCHG                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *
      ** Inlcude V.A.T. amount if V.A.T. processing allowed
      *
     C           V#VATP    IFEQ 'Y'
     C           F7VATD    ANDNE0
     C           CFT009    ANDNE'Y'                                       CFT009
      *
     C           CEU006    IFEQ 'Y'
      *
      ** If EMU FT Enhancement is switched on then call FT0010
      *
     C                     CLEARP#0010
     C                     MOVE V#CCCY    P#FRCY
     C                     Z-ADDF7VATD    P#FRAM
     C                     Z-ADDW#DT      P#FRDT
     C                     MOVE V#RCCY    P#TOCY
     C                     Z-ADDW#DT      P#TODT
     C                     EXSR SRFT10
     C                     Z-ADDP#TOAM    F7VATT
     C                     ELSE
     C                     CLEARD#DTA
     C                     MOVE F7VATD    D#FAMT
     C                     MOVELV#CCCY    D#FCCY
     C                     MOVELV#RCCY    D#TCCY
      *
     C                     CALL 'AOCCYCV0'             9090
     C                     PARM *BLANKS   O#RTN
     C                     PARM '*F*T*SPT'W0ACT
     C           D#DTA     PARM D#DTA     O#DTA
      *
     C           *IN90     IFEQ *ON
     C           O#RTN     ORNE *BLANKS
     C                     MOVEL'AOCCYCV0'W0FILE
     C                     MOVEL'*CALL'   W0KEY
     C                     Z-ADD18        W0ERNB
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     ENDIF
      *
     C                     Z-ADDD#TAMT    F7VATT
      *
     C                     ENDIF
      *
     C                     ENDIF
      *
     C                     ADD  F7VATT    TTLCHG
      *
      ** Check that total charges do not exceed payment amount if the
      ** add/deduct indicator is 'D' and 'Charges To The Debit Of' has
      ** not been entered.
      *
     C           V#ADDC    IFEQ 'D'
     C           V#CDRT    ANDEQ*BLANKS
      *
      ** Check if total charges are greater than the payment value
      *
     C           TTLCHG    IFGE V#PYAM
     C                     MOVEL'Y'       E#MSGS
     C                     MOVEL*BLANKS   FTMSDT
     C                     MOVELE#CPGM    FTPGMQ
     C                     MOVEL'FTM2201' FTMSID
     C                     EXSR FTSNMS
     C                     MOVEL'Y'       E#NOUP
      *
      ** Reverse image the Charge fields with amounts in them
      *
     C           F7TRCM    IFNE 0
     C                     MOVEL'Y'       I7TRCM
     C                     ENDIF
      *
     C           F7TXCH    IFNE 0
     C                     MOVEL'Y'       I7TXCH
     C                     ENDIF
      *
     C           F7CQCH    IFNE 0
     C                     MOVEL'Y'       I7CQCH
     C                     ENDIF
      *
     C           F7CSTA    IFNE 0
     C                     MOVEL'Y'       I7CSTH
     C                     ENDIF
      *
     C           F7SPCH    IFNE 0
     C                     MOVEL'Y'       I7SPCH
     C                     ENDIF
      *
     C           F7MSCH    IFNE 0
     C                     MOVEL'Y'       I7MSCH
     C                     ENDIF
      *
     C           F7CHCM    IFNE 0
     C           S01494    ANDEQ'Y'
     C                     MOVEL'Y'       I7CHCM
     C                     ENDIF
      *                                                                   CFT009
      ** If SAR CFT009 is active                                          CFT009
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
      *                                                                   CFT009
     C           F7STCH    IFNE 0                                         CFT009
     C                     MOVEL'Y'       I7STCD                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           F7M1CH    IFNE 0                                         CFT009
     C                     MOVEL'Y'       I7M1CD                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           F7M2CH    IFNE 0                                         CFT009
     C                     MOVEL'Y'       I7M2CD                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           F7M3CH    IFNE 0                                         CFT009
     C                     MOVEL'Y'       I7M3CD                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           F7M4CH    IFNE 0                                         CFT009
     C                     MOVEL'Y'       I7M4CD                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           F7M5CH    IFNE 0                                         CFT009
     C                     MOVEL'Y'       I7M5CD                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *
     C                     ENDIF
      *
     C                     ENDIF
      *
      ** Unwind subroutine stack name
      *
     C           EXTOT     TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      /TITLE SR/SRDETC
      *****************************************************************
      *                                                               *
      *  SRVATC - V.A.T. Calculation                                  *
      *                                                               *
      *  Called By: SRPROC Subroutine                                 *
      *                                                               *
      *  Calls: None                                                  *
      *                                                               *
      *****************************************************************
      *
     C           SRVATC    BEGSR                           *** SRVATC ***
      *
      ** Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SRVATC'  @STK,Q
      *                                                                   CFT009
      ** If CFT009 is turned off, use original code. Otherwise            CFT009
      ** use improved VAT calculation.                                    CFT009
      *                                                                   CFT009
      *
     C                     Z-ADD0         F7VATD
     C                     Z-ADD0         F7VATT
      *
     C           CFT009    IFEQ 'N'                                       CFT009
      *
      ** If apply V.A.T. flag is 'Y', calculate V.A.T. charge
      ** .... Transfer commission
      *
     C           S7VAT1    IFEQ 'Y'
     C           F7TRCD    MULT V#VATR    @TVATD 130H
     C           F7TRCM    MULT V#VATR    @TVATT 130H
     C                     ADD  @TVATD    F7VATD
     C                     ADD  @TVATT    F7VATT
     C                     ENDIF
      *
      ** .... Telex
      *
     C           S7VAT2    IFEQ 'Y'
     C           F7TXCD    MULT V#VATR    @TVATD    H
     C           F7TXCH    MULT V#VATR    @TVATT    H
     C                     ADD  @TVATD    F7VATD
     C                     ADD  @TVATT    F7VATT
     C                     ENDIF
      *
      ** .... Cheque
      *
     C           S7VAT3    IFEQ 'Y'
     C           F7CQCD    MULT V#VATR    @TVATD    H
     C           F7CQCH    MULT V#VATR    @TVATT    H
     C                     ADD  @TVATD    F7VATD
     C                     ADD  @TVATT    F7VATT
     C                     ENDIF
      *
      ** .... Costs
      *
     C           S7VAT4    IFEQ 'Y'
     C           F7CSTD    MULT V#VATR    @TVATD    H
     C           F7CSTA    MULT V#VATR    @TVATT    H
     C                     ADD  @TVATD    F7VATD
     C                     ADD  @TVATT    F7VATT
     C                     ENDIF
      *
      ** .... SWIFT
      *
     C           S7VAT5    IFEQ 'Y'
     C           F7SPCD    MULT V#VATR    @TVATD    H
     C           F7SPCH    MULT V#VATR    @TVATT    H
     C                     ADD  @TVATD    F7VATD
     C                     ADD  @TVATT    F7VATT
     C                     ENDIF
      *
      ** .... Miscellaneous
      *
     C           S7VAT6    IFEQ 'Y'
     C           F7MSCD    MULT V#VATR    @TVATD    H
     C           F7MSCH    MULT V#VATR    @TVATT    H
     C                     ADD  @TVATD    F7VATD
     C                     ADD  @TVATT    F7VATT
     C                     ENDIF
      *
      ** .... FX/Change commission
      *
     C           S7VAT7    IFEQ 'Y'
     C           S01494    ANDEQ'Y'
     C           F7CHCD    MULT V#VATR    @TVATD    H
     C           F7CHCM    MULT V#VATR    @TVATT    H
     C                     ADD  @TVATD    F7VATD
     C                     ADD  @TVATT    F7VATT
     C                     ENDIF
      *
     C                     ELSE                                           CFT009
      *                                                                   CFT009
      ** Total VAT liable charge, and calculate VAT total from this,      CFT009
      ** rather from original charges.                                    CFT009
      *                                                                   CFT009
      ** If apply V.A.T. flag is 'Y', calculate V.A.T. charge             CFT009
      ** .... Transfer commission                                         CFT009
      *                                                                   CFT009
     C           S7VAT1    IFEQ 'Y'                                       CFT009
     C                     ADD  F7TRCD    F7VATD                          CFT009
     C                     ADD  F7TRCM    F7VATT                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** .... Telex                                                       CFT009
      *                                                                   CFT009
     C           S7VAT2    IFEQ 'Y'                                       CFT009
     C                     ADD  F7TXCD    F7VATD                          CFT009
     C                     ADD  F7TXCH    F7VATT                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** .... Cheque                                                      CFT009
      *                                                                   CFT009
     C           S7VAT3    IFEQ 'Y'                                       CFT009
     C                     ADD  F7CQCD    F7VATD                          CFT009
     C                     ADD  F7CQCH    F7VATT                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** .... Costs                                                       CFT009
      *                                                                   CFT009
     C           S7VAT4    IFEQ 'Y'                                       CFT009
     C                     ADD  F7CSTD    F7VATD                          CFT009
     C                     ADD  F7CSTA    F7VATT                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** .... SWIFT                                                       CFT009
      *                                                                   CFT009
     C           S7VAT5    IFEQ 'Y'                                       CFT009
     C                     ADD  F7SPCD    F7VATD                          CFT009
     C                     ADD  F7SPCH    F7VATT                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** .... Miscellaneous                                               CFT009
      *                                                                   CFT009
     C           S7VAT6    IFEQ 'Y'                                       CFT009
     C                     ADD  F7MSCD    F7VATD                          CFT009
     C                     ADD  F7MSCH    F7VATT                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** .... FX/Change commission                                        CFT009
      *                                                                   CFT009
     C           S7VAT7    IFEQ 'Y'                                       CFT009
     C           S01494    ANDEQ'Y'                                       CFT009
     C                     ADD  F7CHCD    F7VATD                          CFT009
     C                     ADD  F7CHCM    F7VATT                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** .... Swift standard                                              CFT009
      *                                                                   CFT009
     C           S7VT14    IFEQ 'Y'                                       CFT009
     C                     ADD  F7STCD    F7VATD                          CFT009
     C                     ADD  F7STCH    F7VATT                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** .... Miscellaneous charge 1                                      CFT009
      *                                                                   CFT009
     C           S7VT9     IFEQ 'Y'                                       CFT009
     C                     ADD  F7M1CD    F7VATD                          CFT009
     C                     ADD  F7M1CH    F7VATT                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** .... Miscellaneous charge 2                                      CFT009
      *                                                                   CFT009
     C           S7VT10    IFEQ 'Y'                                       CFT009
     C                     ADD  F7M2CD    F7VATD                          CFT009
     C                     ADD  F7M2CH    F7VATT                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** .... Miscellaneous charge 3                                      CFT009
      *                                                                   CFT009
     C           S7VT11    IFEQ 'Y'                                       CFT009
     C                     ADD  F7M3CD    F7VATD                          CFT009
     C                     ADD  F7M3CH    F7VATT                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** .... Miscellaneous charge 4                                      CFT009
      *                                                                   CFT009
     C           S7VT12    IFEQ 'Y'                                       CFT009
     C                     ADD  F7M4CD    F7VATD                          CFT009
     C                     ADD  F7M4CH    F7VATT                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** .... Miscellaneous charge 5                                      CFT009
      *                                                                   CFT009
     C           S7VT13    IFEQ 'Y'                                       CFT009
     C                     ADD  F7M5CD    F7VATD                          CFT009
     C                     ADD  F7M5CH    F7VATT                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Multiply total by the VAT rate, to get the VAT amounts           CFT009
      *                                                                   CFT009
     C           F7VATD    MULT V#VATR    F7VATD    H                     CFT009
     C           F7VATT    MULT V#VATR    F7VATT    H                     CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      *
      ** Unwind subroutine stack name
      *
     C           EXVATC    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      /TITLE SR/SRRCRM
      *****************************************************************
      *                                                               *
      *  SRRCRM - Validate Receiver's Charges Remitted                *
      *                                                               *
      *  Called By: SRPROC Subroutine                                 *
      *                                                               *
      *  Calls:                                                       *
      *  SRALGN    - Calls ZALIGN.                                    *
      *  FTSNMS    - Send message to program message queue.           *
      *                                                               *
      *****************************************************************
      *
     C           SRRCRM    BEGSR                           *** SRRCRM ***
      *
      ** Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SRRCRM'  @STK,Q
      *
      ** Receiver's Charges Remitted is optional.
      ** If entered must be valid for payment currency details
      *
     C                     Z-ADD0         F7RCRM
     C/COPY WNCPYSRC,FT0349C002
      *
      ** Receiver's charges remitted entered while the Detail of Char -
      ** ges is 'BEN', or Detail of Charges is 'OUR' and the add/deduct
      ** indicator is not 'A', error.
      *  or Details of Charges is 'SHA'
      *
     C           S7RCRM    IFNE *BLANK
     C           S7DETC    IFEQ 'BEN'
     C           S7DETC    OREQ 'SHA'
     C           S7DETC    OREQ 'OUR'
     C           V#ADDC    ANDNE'A'
     C           S7ACTD    IFNE 'E'                                       CFT009
     C                     MOVEL'Y'       E#MSGS
     C                     MOVELS7RCRM    FTMSDT
     C                     MOVELE#CPGM    FTPGMQ
     C                     MOVEL'FTM3231' FTMSID
     C                     EXSR FTSNMS
     C                     MOVEL'Y'       I7RCRM
     C                     MOVEL'Y'       E#NOUP
     C                     GOTO EXRCRM
     C                     ENDIF                                          CFT009
     C                     ENDIF
      *
     C           11        SUB  #PNBDP    ZADIG
     C                     Z-ADD#PNBDP    ZADEC
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVELS7RCRM    ZFIELD
     C                     EXSR SRALGN
      *
     C           ZRTN      IFEQ '*ERROR*'
     C                     MOVEL'Y'       E#MSGS
     C           V#PCCY    CAT  S7RCRM    FTMSDT    P
     C                     MOVELE#CPGM    FTPGMQ
     C                     MOVEL'FTM3232' FTMSID
     C                     EXSR FTSNMS
     C                     MOVEL'Y'       I7RCRM
     C                     MOVEL'Y'       E#NOUP
     C                     ELSE
     C                     MOVE ZFIELD    F7RCRM
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    S7RCRM
      *                                                                                       CFT017
      ** Compare amount computed to Multilateral Inter-change Fee                             CFT017
      ** defined in FT ICD. Generate warning message if Receiver's                            CFT017
      ** charges is less than the Multilateral Interchange Fee.                               CFT017
      *                                                                                       CFT017
     C           CFT017    IFEQ 'Y'                                                           CFT017
     C           V#MIFF    ANDEQ'Y'                                                           CFT017
     C           F7RCRM    ANDLTBTMIFE                                                        CFT017
     C                     MOVEL'Y'       I7RCRM                                              CFT017
     C                     MOVEL'Y'       E#WARN                                              CFT017
     C                     MOVEL'Y'       E#MSGS                                              CFT017
     C           V#PCCY    CAT  S7RCRM    FTMSDT    P                                         CFT017
     C                     MOVELE#CPGM    FTPGMQ                                              CFT017
     C                     MOVEL'FTM6000' FTMSID                                              CFT017
     C                     EXSR FTSNMS                                                        CFT017
     C           WRN@,Z    IFEQ ' '                                                           CFT017
     C                     MOVEL*BLANKS   E#RSND                                              CFT017
     C                     MOVEA'Y'       WRN@,Z                                              CFT017
     C                     ENDIF                                                              CFT017
     C                     ENDIF                                                              CFT017
      *                                                                                       CFT017
     C                     ENDIF
      *
      ** If Receiver's charges is entered, instructed amount must not
      ** be zero.
      ** Issue this error message only if payment type is not regular payments.               187058
      *
     C           V#PDAM    IFEQ *ZERO
     C           V#PYTP    ANDNE'RP'                                                          187058
     C           V#M103    IFEQ 'Y'                                                           200949
     C                     MOVEL'Y'       E#MSGS
     C                     MOVEL*BLANK    FTMSDT    P
     C                     MOVELE#CPGM    FTPGMQ
     C                     MOVEL'FTM3244' FTMSID
     C                     EXSR FTSNMS
     C                     MOVEL'Y'       I7RCRM
     C                     MOVEL'Y'       E#NOUP
     C                     ENDIF                                                              200949
     C                     ENDIF
      *
     C                     ENDIF
      *
      ** Unwind subroutine stack name
      *
     C           EXRCRM    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      /TITLE SR/SRSNCD
      *****************************************************************
      *                                                               *
      *  SRSNCD - Validate Sender's Charges Deducted                  *
      *                                                               *
      *  Called By: SRPROC Subroutine                                 *
      *                                                               *
      *  Calls:                                                       *
      *  SRALGN    - Calls ZALIGN.                                    *
      *  FTSNMS    - Send message to program message queue.           *
      *  SRCALC    - Calculate Total Charges.                         *
      *  SRCTOT    - Check Total Charges.                             *
      *                                                               *
      *****************************************************************
      *
     C           SRSNCD    BEGSR                           *** SRSNCD ***
      *
      ** Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SRSNCD'  @STK,Q
     C                     Z-ADD12        Z       30
      *
      ** Sender's Charges  is  mandatory if 'BEN'
      **     and optional if 'SHA'
      ** If entered must be valid for sender's charges currency entered
      *
     C                     Z-ADD0         F7SCH1
     C                     Z-ADD0         F7SCH2
     C                     Z-ADD0         F7SCH3
     C                     Z-ADD0         F7SCH4
     C                     Z-ADD0         F7SCH5
     C                     MOVE *BLANK    F7SCC1
     C                     MOVE *BLANK    F7SCC2
     C                     MOVE *BLANK    F7SCC3
     C                     MOVE *BLANK    F7SCC4
     C                     MOVE *BLANK    F7SCC5
      *
      ** Calculate first the Total Charges
      *
     C                     EXSR SRCALC
      *
      ** If entered blanks, default 1st sender's charge to 0 with
      ** currency equal to pay currency.
      *
     C           S7SCHD    IFEQ *BLANK
     C           S7SCCD    ANDEQ*BLANK
     C           S7DETC    ANDEQ'BEN'
     C           V#M103    ANDEQ'Y'                                                         BUG24724
     C           V#ADDC    IFEQ 'A'
     C                     MOVE '0'       S7SCH1
     C                     ELSE
      *
      ** Default first sender amount field by the total charge accumu-
      ** lated.
      *
     C                     MOVE WTOTAL    S7SCH1
     C                     ENDIF
     C                     MOVE V#PCCY    S7SCC1
     C                     ENDIF
      *
      ** Sender's charges deducted is entered while the Detail of Char
      ** ges is 'OUR', error.
      *
     C           S7SCHD    IFNE *BLANK
     C           S7SCCD    ORNE *BLANK
     C           S7DETC    IFEQ 'BEN'
     C           S7DETC    OREQ 'SHA'
      *
      ** If sender's charges is entered, instructed amount must not be
      ** zero.
      ** Issue this error message only if payment type is not regular payments.               187058
      *
     C           V#PDAM    IFEQ *ZERO
     C           V#PYTP    ANDNE'RP'                                                          187058
     C           WTOTCH    ANDNE*ZERO                                                       BUG24724
     C           V#M103    IFEQ 'Y'                                                           200949
     C                     MOVEL'Y'       E#MSGS
     C                     MOVEL*BLANK    FTMSDT    P
     C                     MOVELE#CPGM    FTPGMQ
     C                     MOVEL'FTM3244' FTMSID
     C                     EXSR FTSNMS
     C                     MOVEL'Y'       I7SCC1
     C                     MOVEL'Y'       I7SCC2
     C                     MOVEL'Y'       I7SCC3
     C                     MOVEL'Y'       I7SCC4
     C                     MOVEL'Y'       I7SCC5
     C                     MOVEL'Y'       I7SCH1
     C                     MOVEL'Y'       I7SCH2
     C                     MOVEL'Y'       I7SCH3
     C                     MOVEL'Y'       I7SCH4
     C                     MOVEL'Y'       I7SCH5
     C                     MOVEL'Y'       E#NOUP
     C                     MOVEA' '       WRN@,Z
     C                     GOTO EXSNCD
     C                     ENDIF                                                              200949
     C                     ENDIF
     C                     MOVELS7SCHD    WSCHD
     C                     MOVELS7SCCD    WSCCD
     C                     ELSE
     C           S7SCH1    IFNE *BLANK
     C                     MOVEL'Y'       I7SCH1
     C                     ENDIF
     C           S7SCH2    IFNE *BLANK
     C                     MOVEL'Y'       I7SCH2
     C                     ENDIF
     C           S7SCH3    IFNE *BLANK
     C                     MOVEL'Y'       I7SCH3
     C                     ENDIF
     C           S7SCH4    IFNE *BLANK
     C                     MOVEL'Y'       I7SCH4
     C                     ENDIF
     C           S7SCH5    IFNE *BLANK
     C                     MOVEL'Y'       I7SCH5
     C                     ENDIF
     C           S7SCC1    IFNE *BLANK
     C                     MOVEL'Y'       I7SCC1
     C                     ENDIF
     C           S7SCC2    IFNE *BLANK
     C                     MOVEL'Y'       I7SCC2
     C                     ENDIF
     C           S7SCC3    IFNE *BLANK
     C                     MOVEL'Y'       I7SCC3
     C                     ENDIF
     C           S7SCC4    IFNE *BLANK
     C                     MOVEL'Y'       I7SCC4
     C                     ENDIF
     C           S7SCC5    IFNE *BLANK
     C                     MOVEL'Y'       I7SCC5
     C                     ENDIF
     C                     MOVEL'Y'       E#MSGS
     C                     MOVEL*BLANK    FTMSDT
     C                     MOVELE#CPGM    FTPGMQ
     C                     MOVEL'FTM3233' FTMSID
     C                     EXSR FTSNMS
     C                     MOVEL'Y'       E#NOUP
     C                     MOVEA' '       WRN@,Z
     C                     GOTO EXSNCD
     C                     ENDIF
      *
      ** Validate 1st Sender Charge field
      *
     C           S7SCH1    IFEQ *BLANK
     C           S7SCC1    ANDEQ*BLANK
      *
      ** Other charges entered while the first sender's charge is blank
      ** - error.
      *
     C           WSCH48    IFNE *BLANK
     C           WSCC12    ORNE *BLANK
     C                     MOVEL'Y'       E#MSGS
     C                     MOVEL*BLANK    FTMSDT    P
     C                     MOVELE#CPGM    FTPGMQ
     C                     MOVEL'FTM3235' FTMSID
     C                     EXSR FTSNMS
     C                     MOVEL'Y'       I7SCC1
     C                     MOVEL'Y'       I7SCH1
     C                     MOVEL'Y'       E#NOUP
     C                     MOVEA' '       WRN@,Z
     C                     GOTO EXSNCD
     C                     ENDIF
     C                     ELSE
      *
      ** Validate currency if entered
      *
     C           S7SCC1    IFNE *BLANK
     C                     MOVE S7SCC1    WCURCY  3
     C                     MOVE '1'       WCYIND  1
     C                     MOVE 'N'       WCYERR  1
     C                     EXSR SRACCY
      *
      ** Currency not found on currencies file, skip other processing.
      *
     C           WCYERR    IFEQ 'Y'
     C                     GOTO EXSNCD
     C                     ENDIF
      *
      ** 1st currency entered and the 1st charge amount is blank while
      ** currency is not equal to pay currency, error.
      *
     C           S7SCH1    IFEQ *BLANK
     C           S7SCC1    IFNE V#PCCY
     C                     MOVEL'Y'       E#MSGS
     C                     MOVEL*BLANK    FTMSDT    P
     C                     MOVELE#CPGM    FTPGMQ
     C                     MOVEL'FTM3260' FTMSID
     C                     EXSR FTSNMS
     C                     MOVEL'Y'       I7SCH1
     C                     MOVEL'Y'       E#NOUP
     C                     MOVEA' '       WRN@,Z
     C                     GOTO EXSNCD
     C                     ELSE
     C           V#ADDC    IFEQ 'A'
     C                     MOVE '0'       S7SCH1
     C                     ELSE
     C                     MOVE WTOTAL    S7SCH1
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
      *
      ** 1st charge currency entered not equal to pay currency and the
      ** entry is the last of the sender's charges entries, default
      ** 2nd sender's charge to pay currency with amount equal to 0 if
      ** the add/deduct is 'A' otherwise total charges.
      *
     C           S7SCC1    IFNE V#PCCY
     C           WSCH48    ANDEQ*BLANK
     C           WSCC12    ANDEQ*BLANK
     C           V#ADDC    IFEQ 'A'
     C                     MOVE '0'       S7SCH2
     C                     ELSE
      *
      ** Default 2nd sender amount field by the total charge accumu-
      ** lated.
      *
     C                     MOVE WTOTAL    S7SCH2
     C                     ENDIF
     C                     MOVE V#PCCY    S7SCC2
     C                     ENDIF
     C                     ENDIF
      *
      ** 1st charge amount is entered w/ blank charge currency and en -
      ** try is the last of the sender's charges entries, default
      ** charge currency to pay currency.
      *
     C           S7SCH1    IFNE *BLANK
     C           S7SCC1    IFEQ *BLANK
     C           WSCH48    IFEQ *BLANK
     C           WSCC12    ANDEQ*BLANK
     C                     MOVE V#PCCY    S7SCC1
     C                     ELSE
      *
      ** 1st charge amount is entered with blank charge currency and
      ** entry is not the last of the sender's charges entries,
      ** error.
      *
     C                     MOVEL'Y'       E#MSGS
     C                     MOVEL*BLANK    FTMSDT    P
     C                     MOVELE#CPGM    FTPGMQ
     C                     MOVEL'FTM3254' FTMSID
     C                     EXSR FTSNMS
     C                     MOVEL'Y'       I7SCC1
     C                     MOVEL'Y'       E#NOUP
     C                     MOVEA' '       WRN@,Z
     C                     GOTO EXSNCD
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
      *
     C           11        SUB  A6NBDP    ZADIG
     C                     Z-ADDA6NBDP    ZADEC
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVELS7SCH1    ZFIELD
     C                     EXSR SRALGN
      *
     C           ZRTN      IFEQ '*ERROR*'
     C                     MOVEL'Y'       E#MSGS
     C           S7SCC1    CAT  S7SCH1    FTMSDT    P
     C                     MOVELE#CPGM    FTPGMQ
     C                     MOVEL'FTM3234' FTMSID
     C                     EXSR FTSNMS
     C                     MOVEL'Y'       I7SCH1
     C                     MOVEL'Y'       E#NOUP
     C                     MOVEA' '       WRN@,Z
     C                     GOTO EXSNCD
     C                     ELSE
     C                     MOVE S7SCC1    F7SCC1
     C                     MOVE ZFIELD    F7SCH1
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    S7SCH1
      *
      ** Check if this is the last entry.
      *
     C           WSCH48    IFEQ *BLANK
     C           WSCC12    ANDEQ*BLANK
     C                     Z-ADDF7SCH1    WLAST  130
     C                     Z-ADD1         V#SENT
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
      *
      ** Validate 2nd Sender Charge field
      *
     C           S7SCH2    IFEQ *BLANK
     C           S7SCC2    ANDEQ*BLANK
      *
      ** 3rd,4th or 5th entered while the 2nd sender's charge is blank
      ** - error.
      *
     C           WSCH36    IFNE *BLANK
     C           WSCC9     ORNE *BLANK
     C                     MOVEL'Y'       E#MSGS
     C                     MOVEL*BLANK    FTMSDT    P
     C                     MOVELE#CPGM    FTPGMQ
     C                     MOVEL'FTM3237' FTMSID
     C                     EXSR FTSNMS
     C                     MOVEL'Y'       I7SCC2
     C                     MOVEL'Y'       I7SCH2
     C                     MOVEL'Y'       E#NOUP
     C                     MOVEA' '       WRN@,Z
     C                     GOTO EXSNCD
     C                     ENDIF
     C                     ELSE
      *
      ** Validate currency if entered
      *
     C           S7SCC2    IFNE *BLANK
     C                     MOVE S7SCC2    WCURCY
     C                     MOVE '2'       WCYIND
     C                     MOVE 'N'       WCYERR
     C                     EXSR SRACCY
      *
      ** Currency not found on currencies file, skip other processing.
      *
     C           WCYERR    IFEQ 'Y'
     C                     GOTO EXSNCD
     C                     ENDIF
      *
      ** 2nd currency entered and the 2nd charge amount is blank while
      ** the currency is not equal to pay currency.
      *
     C           S7SCH2    IFEQ *BLANK
     C           S7SCC2    IFNE V#PCCY
     C                     MOVEL'Y'       E#MSGS
     C                     MOVEL*BLANK    FTMSDT    P
     C                     MOVELE#CPGM    FTPGMQ
     C                     MOVEL'FTM3260' FTMSID
     C                     EXSR FTSNMS
     C                     MOVEL'Y'       I7SCH2
     C                     MOVEL'Y'       E#NOUP
     C                     MOVEA' '       WRN@,Z
     C                     GOTO EXSNCD
     C                     ELSE
     C           V#ADDC    IFEQ 'A'
     C                     MOVE '0'       S7SCH2
     C                     ELSE
     C                     MOVE WTOTAL    S7SCH2
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
      *
      ** 2nd charge currency entered not equal to pay currency and the
      ** entry is the last of the sender's charges entries, default
      ** 3rd sender's charge to pay currency with amount equal to 0 if
      ** the add/deduct is 'A' otherwise total charges.
      *
     C           S7SCC2    IFNE V#PCCY
     C           WSCH36    ANDEQ*BLANK
     C           WSCC9     ANDEQ*BLANK
     C           V#ADDC    IFEQ 'A'
     C                     MOVE '0'       S7SCH3
     C                     ELSE
      *
      ** Default 3rd sender amount field by the total charge accumu-
      ** lated.
      *
     C                     MOVE WTOTAL    S7SCH3
     C                     ENDIF
     C                     MOVE V#PCCY    S7SCC3
     C                     ENDIF
     C                     ENDIF
      *
      ** 2nd charge amount is entered w/ blank charge currency and en -
      ** try is the last of the sender's charges entries, default
      ** charge currency to pay currency.
      *
     C           S7SCH2    IFNE *BLANK
     C           S7SCC2    IFEQ *BLANK
     C           WSCH36    IFEQ *BLANK
     C           WSCC9     ANDEQ*BLANK
     C                     MOVE V#PCCY    S7SCC2
     C                     ELSE
      *
      ** 2nd charge amount is entered with blank charge currency and
      ** entry is not the last of the sender's charges entries,
      ** error.
      *
     C                     MOVEL'Y'       E#MSGS
     C                     MOVEL*BLANK    FTMSDT    P
     C                     MOVELE#CPGM    FTPGMQ
     C                     MOVEL'FTM3254' FTMSID
     C                     EXSR FTSNMS
     C                     MOVEL'Y'       I7SCC2
     C                     MOVEL'Y'       E#NOUP
     C                     MOVEA' '       WRN@,Z
     C                     GOTO EXSNCD
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
      *
     C           11        SUB  A6NBDP    ZADIG
     C                     Z-ADDA6NBDP    ZADEC
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVELS7SCH2    ZFIELD
     C                     EXSR SRALGN
      *
     C           ZRTN      IFEQ '*ERROR*'
     C                     MOVEL'Y'       E#MSGS
     C           S7SCC2    CAT  S7SCH2    FTMSDT    P
     C                     MOVELE#CPGM    FTPGMQ
     C                     MOVEL'FTM3236' FTMSID
     C                     EXSR FTSNMS
     C                     MOVEL'Y'       I7SCH2
     C                     MOVEL'Y'       E#NOUP
     C                     MOVEA' '       WRN@,Z
     C                     GOTO EXSNCD
     C                     ELSE
     C                     MOVE S7SCC2    F7SCC2
     C                     MOVE ZFIELD    F7SCH2
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    S7SCH2
      *
      ** Check if this is the last entry.
      *
     C           WSCH36    IFEQ *BLANK
     C           WSCC9     ANDEQ*BLANK
     C                     Z-ADDF7SCH2    WLAST
     C                     Z-ADD2         V#SENT
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
      *
      ** Validate 3rd Sender Charge field
      *
     C           S7SCH3    IFEQ *BLANK
     C           S7SCC3    ANDEQ*BLANK
      *
      ** 4th or 5th entered while the 3rd sender's charge is blank
      ** - error.
      *
     C           WSCH24    IFNE *BLANK
     C           WSCC6     ORNE *BLANK
     C                     MOVEL'Y'       E#MSGS
     C                     MOVEL*BLANK    FTMSDT    P
     C                     MOVELE#CPGM    FTPGMQ
     C                     MOVEL'FTM3239' FTMSID
     C                     EXSR FTSNMS
     C                     MOVEL'Y'       I7SCC3
     C                     MOVEL'Y'       I7SCH3
     C                     MOVEL'Y'       E#NOUP
     C                     MOVEA' '       WRN@,Z
     C                     GOTO EXSNCD
     C                     ENDIF
     C                     ELSE
      *
      ** Validate currency if entered
      *
     C           S7SCC3    IFNE *BLANK
     C                     MOVE S7SCC3    WCURCY
     C                     MOVE '3'       WCYIND
     C                     MOVE 'N'       WCYERR
     C                     EXSR SRACCY
      *
      ** Currency not found on currencies file, skip other processing.
      *
     C           WCYERR    IFEQ 'Y'
     C                     GOTO EXSNCD
     C                     ENDIF
      *
      ** 3rd currency entered and the 3rd charge amount is blank while
      ** the currency is not equal to the pay currency, error.
      *
     C           S7SCH3    IFEQ *BLANK
     C           S7SCC3    IFNE V#PCCY
     C                     MOVEL'Y'       E#MSGS
     C                     MOVEL*BLANK    FTMSDT    P
     C                     MOVELE#CPGM    FTPGMQ
     C                     MOVEL'FTM3260' FTMSID
     C                     EXSR FTSNMS
     C                     MOVEL'Y'       I7SCH3
     C                     MOVEL'Y'       E#NOUP
     C                     MOVEA' '       WRN@,Z
     C                     GOTO EXSNCD
     C                     ELSE
     C           V#ADDC    IFEQ 'A'
     C                     MOVE '0'       S7SCH3
     C                     ELSE
     C                     MOVE WTOTAL    S7SCH3
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
      *
      ** 3rd charge currency entered not equal to pay currency and the
      ** entry is the last of the sender's charges entries, default
      ** 4th sender's charge to pay currency with amount equal to 0 if
      ** the add/deduct is 'A' otherwise total charges.
      *
     C           S7SCC3    IFNE V#PCCY
     C           WSCH24    ANDEQ*BLANK
     C           WSCC6     ANDEQ*BLANK
     C           V#ADDC    IFEQ 'A'
     C                     MOVE '0'       S7SCH4
     C                     ELSE
      *
      ** Default 4th sender amount field by the total charge accumu-
      ** lated.
      *
     C                     MOVE WTOTAL    S7SCH4
     C                     ENDIF
     C                     MOVE V#PCCY    S7SCC4
     C                     ENDIF
     C                     ENDIF
      *
      ** 3rd charge amount is entered w/ blank charge currency and en -
      ** try is the last of the sender's charges entries, default
      ** charge currency to pay currency.
      *
     C           S7SCH3    IFNE *BLANK
     C           S7SCC3    IFEQ *BLANK
     C           WSCH24    IFEQ *BLANK
     C           WSCC6     ANDEQ*BLANK
     C                     MOVE V#PCCY    S7SCC3
     C                     ELSE
      *
      ** 3rd charge amount is entered with blank charge currency and
      ** entry is not the last of the sender's charges entries,
      ** error.
      *
     C                     MOVEL'Y'       E#MSGS
     C                     MOVEL*BLANK    FTMSDT    P
     C                     MOVELE#CPGM    FTPGMQ
     C                     MOVEL'FTM3254' FTMSID
     C                     EXSR FTSNMS
     C                     MOVEL'Y'       I7SCC3
     C                     MOVEL'Y'       E#NOUP
     C                     MOVEA' '       WRN@,Z
     C                     GOTO EXSNCD
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
      *
     C           11        SUB  A6NBDP    ZADIG
     C                     Z-ADDA6NBDP    ZADEC
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVELS7SCH3    ZFIELD
     C                     EXSR SRALGN
      *
     C           ZRTN      IFEQ '*ERROR*'
     C                     MOVEL'Y'       E#MSGS
     C           S7SCC3    CAT  S7SCH3    FTMSDT    P
     C                     MOVELE#CPGM    FTPGMQ
     C                     MOVEL'FTM3238' FTMSID
     C                     EXSR FTSNMS
     C                     MOVEL'Y'       I7SCH3
     C                     MOVEL'Y'       E#NOUP
     C                     MOVEA' '       WRN@,Z
     C                     GOTO EXSNCD
     C                     ELSE
     C                     MOVE S7SCC3    F7SCC3
     C                     MOVE ZFIELD    F7SCH3
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    S7SCH3
      *
      ** Check if this is the last entry.
      *
     C           WSCH24    IFEQ *BLANK
     C           WSCC6     ANDEQ*BLANK
     C                     Z-ADDF7SCH3    WLAST
     C                     Z-ADD3         V#SENT
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
      *
      ** Validate 4th Sender Charge field
      *
     C           S7SCH4    IFEQ *BLANK
     C           S7SCC4    ANDEQ*BLANK
      *
      ** 5th entered while the 4th sender's charge is blank
      ** - error.
      *
     C           S7SCH5    IFNE *BLANK
     C           S7SCC5    ORNE *BLANK
     C                     MOVEL'Y'       E#MSGS
     C                     MOVEL*BLANK    FTMSDT    P
     C                     MOVELE#CPGM    FTPGMQ
     C                     MOVEL'FTM3241' FTMSID
     C                     EXSR FTSNMS
     C                     MOVEL'Y'       I7SCC4
     C                     MOVEL'Y'       I7SCH4
     C                     MOVEL'Y'       E#NOUP
     C                     MOVEA' '       WRN@,Z
     C                     GOTO EXSNCD
     C                     ENDIF
     C                     ELSE
      *
      ** Validate currency if entered
      *
     C           S7SCC4    IFNE *BLANK
     C                     MOVE S7SCC4    WCURCY
     C                     MOVE '4'       WCYIND
     C                     MOVE 'N'       WCYERR
     C                     EXSR SRACCY
      *
      ** Currency not found on currencies file, skip other processing.
      *
     C           WCYERR    IFEQ 'Y'
     C                     GOTO EXSNCD
     C                     ENDIF
      *
      ** 4th currency entered and the 4th charge amount is blank while
      ** the currency is not equal to the pay currency, error.
      *
     C           S7SCH4    IFEQ *BLANK
     C           S7SCC4    IFNE V#PCCY
     C                     MOVEL'Y'       E#MSGS
     C                     MOVEL*BLANK    FTMSDT    P
     C                     MOVELE#CPGM    FTPGMQ
     C                     MOVEL'FTM3260' FTMSID
     C                     EXSR FTSNMS
     C                     MOVEL'Y'       I7SCH4
     C                     MOVEL'Y'       E#NOUP
     C                     MOVEA' '       WRN@,Z
     C                     GOTO EXSNCD
     C                     ELSE
     C           V#ADDC    IFEQ 'A'
     C                     MOVE '0'       S7SCH4
     C                     ELSE
     C                     MOVE WTOTAL    S7SCH4
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
      *
      ** 4th charge currency entered not equal to pay currency and the
      ** entry is the last of the sender's charges entries, default
      ** 5th sender's charge to pay currency with amount equal to 0 if
      ** the add/deduct is 'A' otherwise total charges.
      *
     C           S7SCC4    IFNE V#PCCY
     C           S7SCH5    ANDEQ*BLANK
     C           S7SCC5    ANDEQ*BLANK
     C           V#ADDC    IFEQ 'A'
     C                     MOVE '0'       S7SCH5
     C                     ELSE
      *
      ** Default 5th sender amount field by the total charge accumu-
      ** lated.
      *
     C                     MOVE WTOTAL    S7SCH5
     C                     ENDIF
     C                     MOVE V#PCCY    S7SCC5
     C                     ENDIF
     C                     ENDIF
      *
      ** 4th charge amount is entered w/ blank charge currency and en -
      ** try is the last of the sender's charges entries, default
      ** charge currency to pay currency.
      *
     C           S7SCH4    IFNE *BLANK
     C           S7SCC4    IFEQ *BLANK
     C           S7SCH5    IFEQ *BLANK
     C           S7SCC5    ANDEQ*BLANK
     C                     MOVE V#PCCY    S7SCC4
     C                     ELSE
      *
      ** 4th charge amount is entered with blank charge currency and
      ** entry is not the last of the sender's charges entries,
      ** error.
      *
     C                     MOVEL'Y'       E#MSGS
     C                     MOVEL*BLANK    FTMSDT    P
     C                     MOVELE#CPGM    FTPGMQ
     C                     MOVEL'FTM3254' FTMSID
     C                     EXSR FTSNMS
     C                     MOVEL'Y'       I7SCC4
     C                     MOVEL'Y'       E#NOUP
     C                     MOVEA' '       WRN@,Z
     C                     GOTO EXSNCD
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
      *
     C           11        SUB  A6NBDP    ZADIG
     C                     Z-ADDA6NBDP    ZADEC
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVELS7SCH4    ZFIELD
     C                     EXSR SRALGN
      *
     C           ZRTN      IFEQ '*ERROR*'
     C                     MOVEL'Y'       E#MSGS
     C           S7SCC4    CAT  S7SCH4    FTMSDT    P
     C                     MOVELE#CPGM    FTPGMQ
     C                     MOVEL'FTM3240' FTMSID
     C                     EXSR FTSNMS
     C                     MOVEL'Y'       I7SCH4
     C                     MOVEL'Y'       E#NOUP
     C                     MOVEA' '       WRN@,Z
     C                     GOTO EXSNCD
     C                     ELSE
     C                     MOVE S7SCC4    F7SCC4
     C                     MOVE ZFIELD    F7SCH4
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    S7SCH4
      *
      ** Check if this is the last entry.
      *
     C           S7SCH5    IFEQ *BLANK
     C           S7SCC5    ANDEQ*BLANK
     C                     Z-ADDF7SCH4    WLAST
     C                     Z-ADD4         V#SENT
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
      *
      ** Validate last Sender Charge field.
      *
     C           S7SCH5    IFNE *BLANK
     C           S7SCC5    ORNE *BLANK
      *
      ** Validate currency if entered
      *
     C           S7SCC5    IFNE *BLANK
     C                     MOVE S7SCC5    WCURCY
     C                     MOVE '5'       WCYIND
     C                     MOVE 'N'       WCYERR
     C                     EXSR SRACCY
      *
      ** Currency not found on currencies file, skip other processing.
      *
     C           WCYERR    IFEQ 'Y'
     C                     GOTO EXSNCD
     C                     ENDIF
      *
      ** 5th charge currency entered not equal to pay currency,
      ** error.
      *
     C           S7SCC5    IFNE V#PCCY
     C                     MOVEL'Y'       E#MSGS
     C                     MOVEL*BLANK    FTMSDT    P
     C                     MOVELE#CPGM    FTPGMQ
     C                     MOVEL'FTM3256' FTMSID
     C                     EXSR FTSNMS
     C                     MOVEL'Y'       I7SCC5
     C                     MOVEL'Y'       E#NOUP
     C                     MOVEA' '       WRN@,Z
     C                     GOTO EXSNCD
     C                     ENDIF
      *
      ** 5th currency entered and the 5th charge amount is blank, de -
      ** fault charge amount to 0 if the add/deduct is 'A' otherwise
      ** total charges.
      *
     C           S7SCH5    IFEQ *BLANK
     C           V#ADDC    IFEQ 'A'
     C                     MOVE '0'       S7SCH5
     C                     ELSE
     C                     MOVE WTOTAL    S7SCH5
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
      *
      ** 5th charge amount is entered w/ blank charge currency,
      ** default charge currency to pay currency.
      *
     C           S7SCH5    IFNE *BLANK
     C           S7SCC5    ANDEQ*BLANK
     C                     MOVE V#PCCY    S7SCC5
     C                     ENDIF
      *
     C           11        SUB  A6NBDP    ZADIG
     C                     Z-ADDA6NBDP    ZADEC
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVELS7SCH5    ZFIELD
     C                     EXSR SRALGN
      *
     C           ZRTN      IFEQ '*ERROR*'
     C                     MOVEL'Y'       E#MSGS
     C           S7SCC5    CAT  S7SCH5    FTMSDT    P
     C                     MOVELE#CPGM    FTPGMQ
     C                     MOVEL'FTM3242' FTMSID
     C                     EXSR FTSNMS
     C                     MOVEL'Y'       I7SCH5
     C                     MOVEL'Y'       E#NOUP
     C                     MOVEA' '       WRN@,Z
     C                     GOTO EXSNCD
     C                     ELSE
     C                     MOVE S7SCC5    F7SCC5
     C                     MOVE ZFIELD    F7SCH5
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    S7SCH5
     C                     Z-ADDF7SCH5    WLAST
     C                     Z-ADD5         V#SENT
     C                     ENDIF
     C                     ENDIF
      *
      ** Check charges total
      *
     C           I7SCH1    IFEQ *BLANK
     C           I7SCH2    ANDEQ*BLANK
     C           I7SCH3    ANDEQ*BLANK
     C           I7SCH4    ANDEQ*BLANK
     C           I7SCH5    ANDEQ*BLANK
     C                     EXSR SRCTOT
     C                     ENDIF
     C                     ENDIF
      *
      ** Unwind subroutine stack name
      *
     C           EXSNCD    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************   CFT014
      /TITLE SR/SRACCY                                                    CFT014
      *****************************************************************   CFT014
      *                                                               *   CFT014
      *  SRACCY - Access Currency details                             *   CFT014
      *                                                               *   CFT014
      *  Called By: SRSNCD subroutine                                 *   CFT014
      *                                                               *   CFT014
      *  Calls:                                                       *   CFT014
      *  AOCURRR0  - Access Object to get currency details            *   CFT014
      *                                                               *   CFT014
      *****************************************************************   CFT014
      *                                                                   CFT014
     C           SRACCY    BEGSR                           *** SRACCY *** CFT014
      *                                                                   CFT014
     C                     CALL 'AOCURRR0'                                CFT014
     C                     PARM *BLANKS   WRTCD                           CFT014
     C                     PARM '*KEY   ' WOPTN                           CFT014
     C                     PARM WCURCY    WAJCD                           CFT014
     C           SDCURR    PARM SDCURR    DSSDY                           CFT014
      *
      ** Invalid currency is entered
      *
     C           WRTCD     IFNE *BLANK                                    CFT014
     C                     MOVEL'Y'       E#MSGS
     C                     MOVEL*BLANK    FTMSDT
     C                     MOVELE#CPGM    FTPGMQ
     C                     MOVEL'FTM3255' FTMSID
     C                     EXSR FTSNMS
     C           WCYIND    IFEQ '1'
     C                     MOVE 'Y'       I7SCC1
     C                     ENDIF
     C           WCYIND    IFEQ '2'
     C                     MOVE 'Y'       I7SCC2
     C                     ENDIF
     C           WCYIND    IFEQ '3'
     C                     MOVE 'Y'       I7SCC3
     C                     ENDIF
     C           WCYIND    IFEQ '4'
     C                     MOVE 'Y'       I7SCC4
     C                     ENDIF
     C           WCYIND    IFEQ '5'
     C                     MOVE 'Y'       I7SCC5
     C                     ENDIF
     C                     MOVEL'Y'       WCYERR
     C                     MOVEL'Y'       E#NOUP
     C                     MOVEA' '       WRN@,Z
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDSR                                          CFT014
      *                                                                   CFT014
      *****************************************************************
      /EJECT
      *****************************************************************
      /TITLE SR/SRCTOT
      *****************************************************************
      *                                                               *
      *  SRCTOT - Check Total Charges                                 *
      *                                                               *
      *  Called By: SRSNCD Subroutine                                 *
      *                                                               *
      *  Calls:                                                       *
      *  FTSNMS    - Send message to program message queue.           *
      *                                                               *
      *****************************************************************
      *
     C           SRCTOT    BEGSR                           *** SRCTOT ***
      *
      ** Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SRCTOT'  @STK,Q
      *
      ** Send warning message, Last sender's charge field entry does
      ** not equal the actual sum of the charges levied.
      *
     C           WLAST     IFNE WTOTCH
     C           S7ACTD    ANDNE'E'                                       CFT009
     C                     SELEC
     C           V#SENT    WHEQ 1
     C                     MOVEL'Y'       I7SCH1
     C           V#SENT    WHEQ 2
     C                     MOVEL'Y'       I7SCH2
     C           V#SENT    WHEQ 3
     C                     MOVEL'Y'       I7SCH3
     C           V#SENT    WHEQ 4
     C                     MOVEL'Y'       I7SCH4
     C           V#SENT    WHEQ 5
     C                     MOVEL'Y'       I7SCH5
     C                     ENDSL
      *
     C                     MOVEL'Y'       E#WARN
     C                     MOVEL'Y'       E#MSGS
     C           V#PCCY    CAT  WTOTAL    FTMSDT    P
     C                     MOVELE#CPGM    FTPGMQ
     C                     MOVEL'FTM3243' FTMSID
     C                     EXSR FTSNMS
      *
     C           WRN@,Z    IFEQ ' '
     C                     MOVEL*BLANKS   E#RSND
     C                     MOVEA'Y'       WRN@,Z
     C                     ENDIF
     C                     ENDIF
      *
      ** Unwind subroutine stack name
      *
     C           EXCTOT    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      /TITLE SR/SRCALC
      *****************************************************************
      *                                                               *
      *  SRCALC - Calculate Total Charges                             *
      *                                                               *
      *  Called By: SRSNCD and SRCTOT subroutine                      *
      *                                                               *
      *  Calls:                                                       *
      *  SRFT10    - Validate and Calculate currencies.               *
      *  FTSNMS    - Send message to program message queue.           *
      *                                                               *
      *****************************************************************
      *
     C           SRCALC    BEGSR                           *** SRCTOT ***
      *
      ** Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SRCALC'  @STK,Q
      *
     C                     SELEC
     C           V#PCCY    WHEQ V#RCCY
     C                     Z-ADDTTLCHG    WTOTCH 130
     C           V#PCCY    WHEQ V#CCCY
     C                     Z-ADDF7TRCD    WTOTCH
     C                     ADD  F7CHCD    WTOTCH
     C                     ADD  F7TXCD    WTOTCH
     C                     ADD  F7CQCD    WTOTCH
     C                     ADD  F7CSTD    WTOTCH
     C                     ADD  F7SPCD    WTOTCH
     C                     ADD  F7MSCD    WTOTCH
     C                     ADD  F7VATD    WTOTCH
     C           CFT009    IFEQ 'Y'                                       CFT009
     C                     ADD  F7STCD    WTOTCH                          CFT009
     C                     ADD  F7M1CD    WTOTCH                          CFT009
     C                     ADD  F7M2CD    WTOTCH                          CFT009
     C                     ADD  F7M3CD    WTOTCH                          CFT009
     C                     ADD  F7M4CD    WTOTCH                          CFT009
     C                     ADD  F7M5CD    WTOTCH                          CFT009
     C                     ENDIF                                          CFT009
     C           V#PCCY    WHNE V#CCCY
     C           V#PCCY    ANDNEV#RCCY
     C                     CLEARP#0010
     C                     MOVELV#RCCY    P#FRCY
     C                     MOVELV#PCCY    P#TOCY
     C                     Z-ADDTTLCHG    P#FRAM
     C                     EXSR SRFT10
     C                     Z-ADDP#TOAM    WTOTCH
     C                     ENDSL
      *
      ** Format total amount to be displayed in message data
      *
     C           11        SUB  #PNBDP    ZADIG
     C                     Z-ADD#PNBDP    ZADEC
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE WTOTCH    ZFIELD
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    WTOTAL 12
      *
      ** Unwind subroutine stack name
      *
     C           EXCALC    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      /TITLE SR/SRCHCM
      *****************************************************************
      *                                                               *
      *  SRALGN - To call ZALIGN                                      *
      *                                                               *
      *  Called By: SRTRCM, SRCHCM, SRTXCH, SRCQCH, SRCSTH, SRSPCH    *
      *             and SRMSCH subroutines.                           *
      *                                                               *
      *  Calls:                                                       *
      *  ZALIGN    - Zalign Screen Field.                             *
      *  SRERR     - Error subroutine.                                *
      *                                                               *
      *****************************************************************
      *
     C           SRALGN    BEGSR                           *** SRALGN ***
      *
      ** Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SRALGN'  @STK,Q
      *
     C                     CALL 'ZALIGN'               90
     C                     PARM *BLANKS   ZRTN    7
     C                     PARM           ZFIELD 16
     C                     PARM           ZADEC   10
     C                     PARM           ZADIG   20
     C                     PARM *BLANKS   ZAFLD  16
      *
      ** If return with an error (LR seton in called program) then
      ** process for database error.
      *
     C           *IN90     IFEQ *ON
     C                     MOVEL'ZALIGN  'W0FILE
     C                     MOVEL'*CALL'   W0KEY
     C                     Z-ADD19        W0ERNB
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     ENDIF
      *
      ** Unwind subroutine stack name
      *
     C           EXALGN    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      /TITLE SR/SRACT
      *****************************************************************
      *                                                               *
      *  SRACT  - Undefined action                                    *
      *                                                               *
      *  Called By: Main Processing                                   *
      *                                                               *
      *  Calls:                                                       *
      *  SRERR     - Error subroutine.                                *
      *                                                               *
      *****************************************************************
      *
     C           SRACT     BEGSR                           *** SRACT  ***
      *
      ** Set up subroutine stack name
      *
     C                     ADD  1         Q
     C                     MOVEL'SRACT '  @STK,Q
      *
      ** Database error undefined action
      *
     C                     MOVEL'*ACTION 'W0FILE
     C                     MOVELW0ACT     W0KEY
     C                     Z-ADD20        W0ERNB
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
      *
      *  Unwind subroutine stack name
      *
     C           EXACT     TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************   CFT009
      /TITLE SR/CLRS7                                                     CFT009
      *****************************************************************   CFT009
      *                                                               *   CFT009
      *  CLRS7  - Clear field values                                  *   CFT009
      *                                                               *   CFT009
      *  Called By: DEFLT                                             *   CFT009
      *                                                               *   CFT009
      *  Calls:                                                       *   CFT009
      *                                                               *   CFT009
      *****************************************************************   CFT009
     C           CLRS7     BEGSR                                          CFT009
     C                     MOVE *BLANKS   S7TRCD                          CFT009
     C                     MOVE *BLANKS   S7CHCD                          CFT009
     C                     MOVE *BLANKS   S7TXCD                          CFT009
     C                     MOVE *BLANKS   S7CQCD                          CFT009
     C                     MOVE *BLANKS   S7CSTD                          CFT009
     C                     MOVE *BLANKS   S7SPCD                          CFT009
     C                     MOVE *BLANKS   S7MSCD                          CFT009
     C                     MOVE *BLANKS   S7STCD                          CFT009
     C                     MOVE *BLANKS   S7M1CD                          CFT009
     C                     MOVE *BLANKS   S7M2CD                          CFT009
     C                     MOVE *BLANKS   S7M3CD                          CFT009
     C                     MOVE *BLANKS   S7M4CD                          CFT009
     C                     MOVE *BLANKS   S7M5CD                          CFT009
     C                     MOVE *BLANKS   S7CDE1                          CFT009
     C                     MOVE *BLANKS   S7CDE2                          CFT009
      *                                                                   CFT009
     C                     ENDSR                                          CFT009
      /EJECT                                                              CFT009
      *****************************************************************   CFT009
      /TITLE SR/APYDFT                                                    CFT009
      *****************************************************************   CFT009
      *                                                               *   CFT009
      *  APYDFT - Reapplies default charge codes                      *   CFT009
      *                                                               *   CFT009
      *  Called By: DEFLT                                             *   CFT009
      *                                                               *   CFT009
      *  Calls:                                                       *   CFT009
      *                                                               *   CFT009
      *****************************************************************   CFT009
     C           APYDFT    BEGSR                                          CFT009
      *                                                                   CFT009
     C                     EXSR CCYCNV                                    CFT009
      *                                                                   CFT009
      * Transfer commission                                               CFT009
     C                     MOVE SVCDE1    S7CDE1                          CFT009
     C                     MOVE SVCDE1    TFCCCD                          CFT009
      *                                                                   CFT009
      * Get default value                                                 CFT009
     C                     MOVELS7CDE1    CHGCDE                          CFT009
     C                     EXSR RECALC                                    CFT009
     C                     Z-ADDTOTCHG    INPAMT                          CFT009
     C                     EXSR CVT2                                      CFT009
     C                     Z-ADDOUTAMT    MTRCM                           CFT009
     C                     MOVE TOTCHG    ZFIELD                          CFT009
     C                     CALL 'ZEDIT'                                   CFT009
     C                     PARM           ZFIELD                          CFT009
     C                     PARM           ZADEC                           CFT009
      *                                                                   CFT009
      * FX Change Commission                                              CFT009
     C                     MOVE SVCDE2    S7CDE2                          CFT009
     C                     MOVE SVCDE2    FXCACC                          CFT009
      *                                                                   CFT009
      * Get default value                                                 CFT009
     C                     MOVELS7CDE2    CHGCDE                          CFT009
     C                     EXSR RECALC                                    CFT009
     C                     Z-ADDTOTCHG    INPAMT                          CFT009
     C                     EXSR CVT2                                      CFT009
     C                     Z-ADDOUTAMT    MOCHCM                          CFT009
     C                     MOVE TOTCHG    ZFIELD                          CFT009
     C                     CALL 'ZEDIT'                                   CFT009
     C                     PARM           ZFIELD                          CFT009
     C                     PARM           ZADEC                           CFT009
      *                                                                   CFT009
      * Telex                                                             CFT009
     C                     MOVE SVCDE3    S7CDE3                          CFT009
     C                     MOVE SVCDE3    TLXCDE                          CFT009
      *                                                                   CFT009
      * Get default value                                                 CFT009
     C                     MOVELS7CDE3    CHGCDE                          CFT009
     C                     EXSR RECALC                                    CFT009
     C                     Z-ADDTOTCHG    INPAMT                          CFT009
     C                     EXSR CVT2                                      CFT009
     C                     Z-ADDOUTAMT    MTXCH                           CFT009
     C                     MOVE TOTCHG    ZFIELD                          CFT009
     C                     CALL 'ZEDIT'                                   CFT009
     C                     PARM           ZFIELD                          CFT009
     C                     PARM           ZADEC                           CFT009
      *                                                                   CFT009
      * Cheque Charge                                                     CFT009
     C                     MOVE SVCDE4    S7CDE4                          CFT009
     C                     MOVE SVCDE4    CHQCHC                          CFT009
      *                                                                   CFT009
      * Get default value                                                 CFT009
     C                     MOVELS7CDE4    CHGCDE                          CFT009
     C                     EXSR RECALC                                    CFT009
     C                     Z-ADDTOTCHG    INPAMT                          CFT009
     C                     EXSR CVT2                                      CFT009
     C                     Z-ADDOUTAMT    MCQCH                           CFT009
     C                     MOVE TOTCHG    ZFIELD                          CFT009
     C                     CALL 'ZEDIT'                                   CFT009
     C                     PARM           ZFIELD                          CFT009
     C                     PARM           ZADEC                           CFT009
      *                                                                   CFT009
      * Costs abroad                                                      CFT009
     C                     MOVE SVCDE5    S7CDE5                          CFT009
     C                     MOVE SVCDE5    CACHCD                          CFT009
      *                                                                   CFT009
      * Get default value                                                 CFT009
     C                     MOVELS7CDE5    CHGCDE                          CFT009
     C                     EXSR RECALC                                    CFT009
     C                     Z-ADDTOTCHG    INPAMT                          CFT009
     C                     EXSR CVT2                                      CFT009
     C                     Z-ADDOUTAMT    MCSTA                           CFT009
     C                     MOVE TOTCHG    ZFIELD                          CFT009
     C                     CALL 'ZEDIT'                                   CFT009
     C                     PARM           ZFIELD                          CFT009
     C                     PARM           ZADEC                           CFT009
      *                                                                   CFT009
      * Swift Standard                                                    CFT009
     C                     MOVE SVCDE6    S7CDE6                          CFT009
     C                     MOVE SVCDE6    SSTCCD                          CFT009
      *                                                                   CFT009
      * Get default value                                                 CFT009
     C                     MOVELS7CDE6    CHGCDE                          CFT009
     C                     EXSR RECALC                                    CFT009
     C                     Z-ADDTOTCHG    INPAMT                          CFT009
     C                     EXSR CVT2                                      CFT009
     C                     Z-ADDOUTAMT    WSWSCH                          CFT009
     C                     MOVE TOTCHG    ZFIELD                          CFT009
     C                     CALL 'ZEDIT'                                   CFT009
     C                     PARM           ZFIELD                          CFT009
     C                     PARM           ZADEC                           CFT009
      *                                                                   CFT009
      * Swift Priority                                                    CFT009
     C                     MOVE SVCDE7    S7CDE7                          CFT009
     C                     MOVE SVCDE7    SPRCCD                          CFT009
      *                                                                   CFT009
      * Get default value                                                 CFT009
     C                     MOVELS7CDE7    CHGCDE                          CFT009
     C                     EXSR RECALC                                    CFT009
     C                     Z-ADDTOTCHG    INPAMT                          CFT009
     C                     EXSR CVT2                                      CFT009
     C                     Z-ADDOUTAMT    MSPCH                           CFT009
     C                     MOVE TOTCHG    ZFIELD                          CFT009
     C                     CALL 'ZEDIT'                                   CFT009
     C                     PARM           ZFIELD                          CFT009
     C                     PARM           ZADEC                           CFT009
      *                                                                   CFT009
      * Misc Charge                                                       CFT009
     C                     MOVE SVCDE8    S7CDE8                          CFT009
     C                     MOVE SVCDE8    MSCHC                           CFT009
      *                                                                   CFT009
      * Get default value                                                 CFT009
     C                     MOVELS7CDE8    CHGCDE                          CFT009
     C                     EXSR RECALC                                    CFT009
     C                     Z-ADDTOTCHG    INPAMT                          CFT009
     C                     EXSR CVT2                                      CFT009
     C                     Z-ADDOUTAMT    MMSCH                           CFT009
     C                     MOVE TOTCHG    ZFIELD                          CFT009
     C                     CALL 'ZEDIT'                                   CFT009
     C                     PARM           ZFIELD                          CFT009
     C                     PARM           ZADEC                           CFT009
      *                                                                   CFT009
      * Misc Charge 1                                                     CFT009
     C                     MOVE SVCDE9    S7CDE9                          CFT009
     C                     MOVE SVCDE9    MSCHC1                          CFT009
      *                                                                   CFT009
      * Get default value                                                 CFT009
     C                     MOVELS7CDE9    CHGCDE                          CFT009
     C                     EXSR RECALC                                    CFT009
     C                     Z-ADDTOTCHG    INPAMT                          CFT009
     C                     EXSR CVT2                                      CFT009
     C                     Z-ADDOUTAMT    WMISC1                          CFT009
     C                     MOVE TOTCHG    ZFIELD                          CFT009
     C                     CALL 'ZEDIT'                                   CFT009
     C                     PARM           ZFIELD                          CFT009
     C                     PARM           ZADEC                           CFT009
      *                                                                   CFT009
      * Misc Charge 2                                                     CFT009
     C                     MOVE SVCD10    S7CD10                          CFT009
     C                     MOVE SVCD10    MSCHC2                          CFT009
      *                                                                   CFT009
      * Get default value                                                 CFT009
     C                     MOVELS7CD10    CHGCDE                          CFT009
     C                     EXSR RECALC                                    CFT009
     C                     Z-ADDTOTCHG    INPAMT                          CFT009
     C                     EXSR CVT2                                      CFT009
     C                     Z-ADDOUTAMT    WMISC2                          CFT009
     C                     MOVE TOTCHG    ZFIELD                          CFT009
     C                     CALL 'ZEDIT'                                   CFT009
     C                     PARM           ZFIELD                          CFT009
     C                     PARM           ZADEC                           CFT009
      *                                                                   CFT009
      * Misc Charge 3                                                     CFT009
     C                     MOVE SVCD11    S7CD11                          CFT009
     C                     MOVE SVCD11    MSCHC3                          CFT009
      *                                                                   CFT009
      * Get default value                                                 CFT009
     C                     MOVELS7CD11    CHGCDE                          CFT009
     C                     EXSR RECALC                                    CFT009
     C                     Z-ADDTOTCHG    INPAMT                          CFT009
     C                     EXSR CVT2                                      CFT009
     C                     Z-ADDOUTAMT    WMISC3                          CFT009
     C                     MOVE TOTCHG    ZFIELD                          CFT009
     C                     CALL 'ZEDIT'                                   CFT009
     C                     PARM           ZFIELD                          CFT009
     C                     PARM           ZADEC                           CFT009
      *                                                                   CFT009
      * Misc Charge 4                                                     CFT009
     C                     MOVE SVCD12    S7CD12                          CFT009
     C                     MOVE SVCD12    MSCHC4                          CFT009
      *                                                                   CFT009
      * Get default value                                                 CFT009
     C                     MOVELS7CD12    CHGCDE                          CFT009
     C                     EXSR RECALC                                    CFT009
     C                     Z-ADDTOTCHG    INPAMT                          CFT009
     C                     EXSR CVT2                                      CFT009
     C                     Z-ADDOUTAMT    WMISC4                          CFT009
     C                     MOVE TOTCHG    ZFIELD                          CFT009
     C                     CALL 'ZEDIT'                                   CFT009
     C                     PARM           ZFIELD                          CFT009
     C                     PARM           ZADEC                           CFT009
      *                                                                   CFT009
      * Misc Charge 5                                                     CFT009
     C                     MOVE SVCD13    S7CD13                          CFT009
     C                     MOVE SVCD13    MSCHC5                          CFT009
      *                                                                   CFT009
      * Get default value                                                 CFT009
     C                     MOVELS7CD13    CHGCDE                          CFT009
     C                     EXSR RECALC                                    CFT009
     C                     Z-ADDTOTCHG    INPAMT                          CFT009
     C                     EXSR CVT2                                      CFT009
     C                     Z-ADDOUTAMT    WMISC5                          CFT009
     C                     MOVE TOTCHG    ZFIELD                          CFT009
     C                     CALL 'ZEDIT'                                   CFT009
     C                     PARM           ZFIELD                          CFT009
     C                     PARM           ZADEC                           CFT009
      *                                                                   CFT009
     C                     ENDSR                                          CFT009
      /EJECT                                                              CFT009
      *****************************************************************   CFT009
      /TITLE SR/CVT2                                                      CFT009
      *****************************************************************   CFT009
      *                                                               *   CFT009
      *  CVT2 - Second currency routine                               *   CFT009
      *                                                               *   CFT009
      *  Called By: APYDFT                                            *   CFT009
      *                                                               *   CFT009
      *****************************************************************   CFT009
     C           CVT2      BEGSR                                          CFT009
     C                     MOVE ZFIELD    INPAMT                          CFT009
      *                                                                   CFT009
     C           FRMCCY    IFNE TOCCY                                     CFT009
     C                     CALL 'ZCONVZ1'                                 CFT009
     C                     PARM           INPAMT 150                      CFT009
     C                     PARM           CVTRAT                          CFT009
     C                     PARM           FRMMD                           CFT009
     C                     PARM           FRMCCY  3                       CFT009
     C                     PARM           TOCCY   3                       CFT009
     C                     PARM           FRMDEC                          CFT009
     C                     PARM           TODEC                           CFT009
     C                     PARM *ZEROS    OUTAMT 150                      CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADDINPAMT    OUTAMT                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      *                                                                   CFT009
     C                     ENDSR                                          CFT009
      *****************************************************************
      /TITLE SR/SRFT10
      *****************************************************************
      *                                                               *
      *  SRFT10 - Calculates Currency Amounts for EMU                 *
      *                                                               *
      *  Called By: SRTOT and SRCTOT subroutine.                      *
      *                                                               *
      *  Calls:                                                       *
      *  FT0010    - Validates and Calculates Currencies.             *
      *  SRERR     - Error subroutine.                                *
      *                                                               *
      *****************************************************************
      *
     C           SRFT10    BEGSR                           *** SRFT10 ***
      *
      ** Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SRFT10'  @STK,Q
      *
     C                     CALL 'FT0010'
     C                     PARM           P#0010
      *
      ** Check if database error occurred
      *
     C           P#RTCD    IFNE *BLANKS
     C                     MOVEL'FT0010  'W0FILE
     C                     MOVELP#TOCY    W0KEY
     C                     Z-ADD21        W0ERNB
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     ENDIF
      *
      ** Unwind subroutine stack name
      *
     C           EXFT10    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
     C/COPY WNCPYSRC,FT0349C004
     C/COPY ZSRSRC,ZEDITZ2
     C/COPY ZSRSRC,ZXRATEZ1                                               CFT009
     C/COPY FTCPYSRC,SFTADDRC
     C/COPY FTCPYSRC,SFTADDRSC
     C/COPY FTCPYSRC,SFTSWFTC
     C/COPY FTCPYSRC,SFTSNMSC
     C/COPY FTCPYSRC,SRERRC
      *****************************************************************
**  CPY@
(c) Finastra International Limited 2001
