     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas FT Incoming payments valid. S2/Lvl 2')           *
     F*****************************************************************
     F*                                                               *
     F*  Midas - Funds Transfer Module                            *
     F*                                                               *
     F*  FT0358 - Validate Incoming Payments - Screen 2, Level 2      *
     F*                                                               *
     F*  Function:  This program validates the level 2 input for      *
     F*  Incoming Payments.                                           *
     F*                                                               *
     F*  Called By: FT0355  - Incomimg Payments Maintenence Level 2   *
     F*                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
     F*                                                               *
      *  Last Amend No. CER059             Date 19Jul10               *
      *  Prev Amend No. CER045             Date 20Jul09               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 BUG15201           Date 30Oct07               *
      *                 250600             Date 07Oct07               *
      *                 CRE026             Date 24May06               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CFT032             Date 11Sep06               *
      *                 CSW206             Date 03Jul06               *
      *                 CSD031             Date 10Apr06               *
      *                 CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 CSC022             Date 24Feb04               *
      * Midas Release 4.01.01 ----------------------------------------*
      *                 CSW202             Date 20May02               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 CSW201             Date 02May01               *
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CFT009             Date 18Aug00               *
      * Midas DBA 3.04 -----------------------------------------------*
      *                 CFT014             Date 25May00               *
      * Midas DBA 3.03 -----------------------------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 148229             Date 13Dec98               *
      *                 135176             Date 14May98               *
     F*                 CEU006             Date 30APR98               *
     F*                 122060             Date 30Oct97               *
     F*                 S01408             Date 01Nov96               *
     F*                 S01408             Date 04Oct96               *
     F*                 S01499             DATE 06JUN94               *
     F*                 S01494             DATE 25MAY94               *
     F*                 S01435             DATE 22AUG93               *
     F*                                                               *
     F*---------------------------------------------------------------*
     F*                                                               *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER045 - German Features - Reporting Bundesbank (Recompile)  *
      *  BUG15201 - Encounter Database Errors (Recompile)             *
      *  250600 - Fix CFT032 and CSW207 (recompile)                   *
      *  CRE026 - Consumer Banking (Recompile)                        *
      *  CFT032 - Account line in field 50k in MT103 (recompile)      *
      *  CSW206 - SWIFT 2006 Standard Changes                         *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CSC022 - Commitment Control Changes for MidasPlus            *
      *           (Recompile)                                         *
      *  CSW202 - SWIFT 2002 Standards Update                         *
      *  CSW201 - SWIFT 2001 Standards Update                         *
     F*  CFT009 - Fees and Charges Development                        *
      *  CFT014 - Straight-through Processing Phase 2 MT103           *
      *           Messages Generation for FT.                         *
     F*  148229 - Changes to /COPY FT0010I001 (Recompile only)        *
     F*  135176 - Default Outgoing Payment indicator to 'N' if        *
     F*           blank when it comes in                              *
     F*  CEU006 - EMU Funds Transfer Enhancement.                     *
     F*  122060 - Drafts Issuance Function.                           *
     F*  S01408 - Addition of hooks FT0358CCP2                        *  *
     F*  S01408 - Addition of hooks FT0358CCP1                        *  *
     F*  S01499 - BLI V.A.T. Processing                               *
     F*         - Add total V.A.T. amount to total charges. (TEMP02)  *
     F*         - Array @VAT should be loaded from the                *
     F*           message file (TEMP14)                               *
     F*  S01494 - BLI Funds Transfer Enhancements                     *
     F*  S01435 - Incoming Message Management                         *
     F*                                                               *
     F*****************************************************************
     F*
     F*  Indicator usage
     F*  ~~~~~~~~~~~~~~~
     F*
     F*  31    Invalid S.W.I.F.T. Address format
     F*  32    S.W.I.F.T. Address not on file
     F*
     F*  50    Program Initialised
     F*
     F*  90    General Error Indicator
     F*  91    / found
     F*  92    Embedded spaces found
     F*  93    Illegal characters found
     F*  94    Work indicator used in checking illegal characters
     F*
     F*  U7/U8 Error Ocurred
     F*  LR    End program
     F*
     F*****************************************************************
     E/COPY FTCPYSRC,SFTSWFTF
     F/COPY WNCPYSRC,FT0358DFPG
      *
      *  /Copy point for File Definition
      *
      *                                                                   CFT014
      ** Country Codes file                                               CFT014
     FSDCTRYL2IF  E           K        DISK         KINFSR SRFILE     UC  CFT014
      *                                                                   CFT014
     F/EJECT
     E                    CPY@    1   1 80
     E                    ALPHA  26  26  1                                CFT014
      *                                                                                       CSW201
      ** Array of Instruction codewords in correct order                                      CSW201
      *                                                                                       CSW201
     E**********          WICOR  12  12  4                                             CSW201 CSW202
     E                    WICOR  13  13  4                                                    CSW202
      *                                                                                       CSW202
      ** Array that contains uppercase alphabetic letters and numeric                         CSW202
      ** digits 0-9                                                                           CSW202
      *                                                                                       CSW202
     E                    ALPHNU 36  36  1                                                    CSW202
      *
      *  Copyright table
      *
     E/COPY WNCPYSRC,FT0358DEPG
      *
      *  /Copy point for Arrays
      *
     E/COPY FTCPYSRC,SRERRE
      *
      *  End of Copysource for error processing
      *
     E                    ERCD       38  4               Codes
      *
      *  Error Codes Output
      *
     E/COPY FTCPYSRC,SFTSWFTE
      *
      *  Warning codes array
      *
     E                    WRN@       40  1               Warning array
     E********************@VAT    1   7 20               V.A.T. chaS01499 S01499
      *                                                                   CFT014
     E                    WA1         5 35               Work array 1     CFT014
     E                    WA2         5  1               Work array 2     CFT014
      *                                                                                       CSW201
     E                    CD          5  4                                                    CSW201
      *
     E/EJECT
      *
     I/COPY WNCPYSRC,FT0358DIPG
      *
      *  /Copy point for Input specifications
      *
     ICPYR@#      DS
      *
      *  Data structure for compilation  - Copyright insertion
      *
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
     I/COPY FTCPYSRC,SRERRI
      *
      *  End of Program Error Processing source
      *
     IRUNDTA    E DSRUNDAT
      *
      *  Define rundat data area
      *
      *
      *  Data Structures used by access programs
      *
     IDSFDY     E DSDSFDY                                                 S01494
     I*    DS for access program , short data structure                   S01494
     I*                                                                   S01494
     I***DSSDY***  E DSDSSDY                                              CFT014
     I*
     ISDCUST    E DSSDCUSTPD
      *
      *  Calling parameter data structure for AOCUSTR0
      *
     ISDCNST    E DSSDCNSTPD
      *
      *  Calling parameter data structure for ME1400
      *
     IMEBICD    E DSMEBICDPD
      *
      *  Calling parameter data structure for ME1400
      *
     I***SDCURR**  E DSSDCURRPD                                           CFT014
      ***********                                                         CFT014
      ***Calling*parameter*data*structure*for*AOCCYCV0*****************   CFT014
      *
     ISDBANK    E DSSDBANKPD                                              CEU006
      *  Calling parameter data structure for AOBANKR0                    CEU006
      *                                                                   CEU006
     I***SDGELR**  E DSSDGELRPD                                    CEU006 CFT014
      ***Calling*parameter*data*structure*for*AOGELRR0************ CEU006 CFT014
     I**                                                                  S01494
     ISCSARD    E DSSCSARDPD                                              S01494
     I* External data structure for SAR file details                      S01494
     I*                                                                   S01494
     I***/COPY*FTCPYSRC,FT0010I001                                 CEU006 CFT014
      ****Input/output*parameters*for*call*to*FT0010.************* CEU006 CFT014
      ***********                                                  CEU006 CFT014
     I***D#DTA***    DS                            256                    CFT014
      ****************************************From*Currency*&*amount***   CFT014
     I***********                             1   3 D#FCCY                CFT014
     I***********                         P   4  110D#FAMT                CFT014
      ****************************************To*Currency*&*amount*****   CFT014
     I***********                            12  14 D#TCCY                CFT014
     I***********                         P  15  220D#TAMT                CFT014
      ****************************************Rate*and*multi/div*ind.**   CFT014
     I***********                            23  23 I#MDIN                CFT014
     I***********                         P  24  368I#RATE                CFT014
      *****************************Output*****Rate*and*multi/div*ind.**   CFT014
      ****************************************If*no*in*rate************   CFT014
     I***********                            37  37 O#MDIN                CFT014
     I***********                         P  38  508O#RATE                CFT014
      /EJECT
      *
     E/COPY FTCPYSRC,SFT0355S3
     E/COPY FTCPYSRC,SFTVALDI
     E/COPY FTCPYSRC,SFT0355F3
     E/COPY FTCPYSRC,SFT0355I3
     E/COPY FTCPYSRC,SFTADDRI
     ICLSWTK      DS
      *
      *  Redefine SWIFT array as field for SETLL.
      *
     I                                        1  12 SW
      *
     IDSMTR       DS
      *
      *  Define fields for message transalation
      *
     I                                        1 132 #MSDTA
     I                                       15  30 #MPREF
     I                                    P   1   20#MPART
     I                                      133 264 #MSTX1
     I#MSTX2      DS
     I                                        1 256 #MSTXA
     I                                      257 512 #MSTXB
      *
     I            DS                                                      CFT014
     I                                    P   1   30IX                    CFT014
      *                                                                   CFT014
     I            DS                                                      CFT014
     I                                        1   3 WTTCD                 CFT014
     I                                        1   1 TTCD1                 CFT014
     I                                        2   2 TTCD2                 CFT014
     I                                        3   3 TTCD3                 CFT014
      *                                                                   CFT014
     IICD25       DS                                                      CFT014
     I                                        1  35 WSICDA                CFT014
     I                                       36  70 WSICDB                CFT014
     I                                       71 105 WSICDC                CFT014
     I                                      106 140 WSICDD                CFT014
      *                                                                   CFT014
     IICD35       DS                                                      CFT014
     I                                        1  35 WSICDE                CFT014
     I                                       36  70 WSICDF                CFT014
     I                                       71 105 WSICDG                CFT014
      *                                                                   CFT014
     IICD45       DS                                                      CFT014
     I                                        1  35 WSICDH                CFT014
     I                                       36  70 WSICDI                CFT014
      *                                                                   CFT014
     IWS3RRP      DS                                                      CFT014
     I                                        1  35 WSRRP1                CFT014
     I                                        1  10 RR1X10                CFT014
     I                                       11  12 RR1X2A                CFT014
     I                                       13  14 RR1X2B                CFT014
     I                                       13  35 RR1X23                CFT014
     I                                       15  35 RR1X21                CFT014
      *                                                                   CFT014
     I                                       36  70 WSRRP2                CFT014
     I                                       36  37 RR2X2A                CFT014
     I                                       38  70 RR2X33                CFT014
      *                                                                   CFT014
     I                                       71 105 WSRRP3                CFT014
     I                                       71  72 RR3X2A                CFT014
     I                                       73 105 RR3X33                CFT014
      *                                                                   CFT014
     IRRP23       DS                                                      CFT014
     I                                        1  35 WSRRPA                CFT014
     I                                       36  70 WSRRPB                CFT014
      *                                                                   CFT014
     I              '/ORDERRES/'          C         CORDER                CFT014
     I              '/BENEFRES/'          C         CBENEF                CFT014
     E/COPY FTCPYSRC,SFTVALCS
     I/EJECT
      *****************************************************************
      *                 M A I N L I N E
      *****************************************************************
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q
     C                     MOVEL'MAIN'    @STK,Q
      *
      *  Define entry parameters
      *
     C           *ENTRY    PLIST
     C                     PARM           W0RTN   7
     C                     PARM           W0ACT   8
     C                     PARM           S3DATA
     C                     PARM           V#DATA
     C                     PARM           F3DATA
     C                     PARM           E#DATA
     C                     PARM           C#DATA
     C                     PARM           I3DATA
     C/COPY WNCPYSRC,FT0358C024
      *
      *  Set up Primary Reference for database errors
      *
     C                     MOVELS3DATA    W0PREF
      *
      *  Initialise program
      *
     C           *IN50     IFEQ '0'
     C                     EXSR SRINIT
     C                     END
     C/COPY WNCPYSRC,FT0358C004
      *
      *  Determine the mode of processing and execute subroutine :-
      *
      *
      *  Action Code : *VALID
      *  --------------------
      *
      *  Called from FT0355
      *  To validate all input fields on the detail screen.
      *  Once verified, control returns to the calling program where
      *  the appropriate error indicators are set on and processing
      *  continues.
      *
      *
     C           W0ACT     CASEQ'*VALID  'SRPROC
     C                     CAS            SRACT
     C                     END
      *
      *  Unwind subroutine stack name
      *
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
      *  Return to calling program
      *
     C                     RETRN
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRPROC   : Validate All Detail Fields Entered                *
      *             Seton appropriate indicators and set up the array *
      *             of relevant error codes for display.              *
      *                                                               *
      *  CALLED BY: Main processing section                           *
      *                                                               *
      *  CALLS    : SRERR   - report error and close down program     *
      *                                                               *
      *****************************************************************
     CSR         SRPROC    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q
     C                     MOVEL'SRPROC'  @STK,Q
      *
      *  /COPY Statement
      *
     C/COPY WNCPYSRC,FT0358PROC
      *
      *  Move warning array passed to WRN@ and error indicators
      *
     C                     MOVEAE#WARA    WRN@
     C                     MOVEA*BLANKS   ERCD
     C                     CLEARI3DATA
     C                     Z-ADD0         X       50
      *
      *  Validate Intermediary Bank
      *
     C                     EXSR SRINBK
      *
      *  Validate Details Of Payment
      *
     C                     EXSR SRDPAY
      *
      *  Validate Central Bank Reference
      *
     C                     EXSR SRNBKC
      *                                                                   CFT014
      ** Validate Transfer Commission Tariff.                             CFT014
      *                                                                   CFT014
     C           CFT009    IFEQ 'N'                                       CFT009
     C                     EXSR SRTRCT                                    CFT014
     C                     ENDIF                                          CFT009
      *
      *  Validate Outward Payment Generated Indicator
      *
     C                     EXSR SROPIN
      *                                                                   CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
      *                                                                   CFT014
      ** Validate Bank Operation Code.                                    CFT014
      *                                                                   CFT014
     C                     EXSR SRBOCD                                    CFT014
      *                                                                   CFT014
      ** Validate Transaction Type Code.                                  CFT014
      *                                                                   CFT014
     C                     EXSR SRTTCD                                    CFT014
      *                                                                   CFT014
      ** Validate Instruction Code.                                       CFT014
      *                                                                   CFT014
     C                     EXSR SRICDE                                    CFT014
      *                                                                   CFT014
      ** Validate Regulatory Reporting.                                   CFT014
      *                                                                   CFT014
     C                     EXSR SRRRPT                                    CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ***********                                                         CFT014
      ***Validate*Details*Of*Charges***********************************   CFT014
      ***********                                                         CFT014
     C***********          EXSR SRDETC                                    CFT014
      ***********                                                         CFT014
      ***Get*currency*information*for*charge*amount*validation*********   CFT014
      ***********                                                         CFT014
     C***********          EXSR SRCCCY                                    CFT014
      ***********                                                         CFT014
      ***Validate*Transmission*Charge**********************************   CFT014
      ***********                                                         CFT014
     C***********          EXSR SRTRCM                                    CFT014
      ***********                                                         CFT014
      ***Validate*Telex*Charge*****************************************   CFT014
      ***********                                                         CFT014
     C***********          EXSR SRTXCH                                    CFT014
      ***********                                                         CFT014
      ***Validate*Cheque*Charge****************************************   CFT014
      ***********                                                         CFT014
     C***********          EXSR SRCQCH                                    CFT014
      ***********                                                         CFT014
      ***Validate*Advice*Charge****************************************   CFT014
      ***********                                                         CFT014
     C***********          EXSR SRADCH                                    CFT014
      ***********                                                         CFT014
      ***Validate*Telephone*Charge*************************************   CFT014
      ***********                                                         CFT014
     C***********          EXSR SRTLCH                                    CFT014
      ***********                                                         CFT014
      ***Validate*Miscellaneous*Charge*********************************   CFT014
      ***********                                                         CFT014
     C***********          EXSR SRMSCH                                    CFT014
     C***********                                                  S01494 CFT014
     C***Validate*FX/Change*Commission*if*S01494*is*switched*ON*** S01494 CFT014
     C***********                                                  S01494 CFT014
     C***********S01494    IFEQ 'Y'                                S01494 CFT014
     C***********          EXSR SRCHCM                             S01494 CFT014
     C***********          END                                     S01494 CFT014
     C***********                                                  S01499 CFT014
     C***Validate*V.A.T.*flags*if*V.A.T.*processing*allowed******* S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********V#VATP    IFEQ 'Y'                                S01499 CFT014
     C***********          EXSR SRVATT                             S01499 CFT014
     C***********          END                                     S01499 CFT014
     C***********                                                  S01499 CFT014
     C***Calculate*V.A.T.*charge*amounts*ifV.A.T.processingallowed S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********V#VATP    IFEQ 'Y'                                S01499 CFT014
     C***********          EXSR SRVATC                             S01499 CFT014
     C***********          END                                     S01499 CFT014
      ***********                                                         CFT014
      ***Check*that*Total*Charges*do*not*exceed*payment*amount*********   CFT014
      ***********                                                         CFT014
     C***********          EXSR SRTOT                                     CFT014
     C/COPY WNCPYSRC,FT0358C023
      *
      *  Cross validations
      *
     C           E#NOUP    IFEQ *BLANKS
     C                     EXSR SRXVAL
     C                     END
      *
      *  End Of Validation - set parameters for return
      *
      *
      *  Move waring array back and errors
      *
     C                     MOVEAWRN@      E#WARA
     C                     MOVEAERCD      C#ERCD
      *
      *  Unwind subroutine stack name
      *
     C           EXPROC    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRINBK   : Validate Intermediary Bank                        *
      *                                                               *
      *  CALLED BY: SRPROC                                            *
      *                                                               *
      *  CALLS    :                                                   *
      *                                                               *
      *****************************************************************
     CSR         SRINBK    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q
     C                     MOVEL'SRINBK'  @STK,Q
      *
      *  /COPY Statement
      *
     C/COPY WNCPYSRC,FT0358INBK
      *
      *  Intermediary Bank is optional
      *
     C                     MOVEL*BLANKS   F3INBT
      *
     C           S3IBK     IFEQ *BLANKS
     C                     GOTO EXINBK
     C                     END
      *
      *  Move in data for address validation
      *
     C                     MOVE *BLANKS   ADDRSS
     C                     MOVELS3IBK     ADDRSS
      *
      *  If only 1st line entered then SWIFT Address assumed
      *  Or first is '/' and second is SWIFT Address
      *
      *
      *  If field does not begin with '/' and is not longer than 11
      *  characters, validate as a S.W.I.F.T. Address
      *
     C           ADCH26    IFEQ *BLANKS
     C           ADEXSW    ANDEQ*BLANKS
     C           ADSLSH    ANDNE'/'
     C           ADCH36    OREQ *BLANKS
     C           ADEXS2    ANDEQ*BLANKS
     C           ADSLSH    ANDEQ'/'
     C           ADSLS2    ANDNE'/'
      *
      *  First 11 characters should be key for CLSWT.
      *
     C           ADSLSH    IFNE '/'
     C                     MOVELADCHK1    CLSWTK
     C                     ELSE
     C                     MOVELADCHK2    CLSWTK
     C                     END
      *
     C                     EXSR SWIFT
      *
     C           ##CSID    IFEQ 'Y'
     C           *IN31     IFEQ '1'
     C/COPY WNCPYSRC,FT0358C001
     C                     MOVEL'Y'       E#MSGS
     C                     MOVELCLSWTK    FTMSDT
     C                     MOVELE#CPGM    FTPGMQ
     C                     MOVEL'FTM2073' FTMSID
     C                     EXSR FTSNMS
      *
      *  Highlight correct field
      *
     C           ADSLSH    IFNE '/'
     C                     MOVEL'Y'       I3INB1
     C                     ELSE
     C                     MOVEL'Y'       I3INB2
     C                     END
     C                     MOVEL'Y'       E#NOUP
     C                     MOVEA' '       WRN@,1
     C                     GOTO EXINBK
     C                     END
      *
     C                     MOVEL'S'       F3INBT
      *
      *  No SWIFT address record.
      *
     C           *IN32     IFEQ '1'
     C           *IN31     ANDEQ'0'
     C/COPY WNCPYSRC,FT0358C002
      *
      *  If text changed then warning needs to be changed
      *
     C           CLSWTK    IFNE V#INB1
     C                     MOVEA' '       WRN@,1
     C                     MOVELCLSWTK    V#INB1
     C                     END
      *
     C                     MOVEL'Y'       E#WARN
      *
      *  Highlight correct field
      *
     C           ADSLSH    IFNE '/'
     C                     MOVEL'Y'       I3INB1
     C                     ELSE
     C                     MOVEL'Y'       I3INB2
     C                     END
     C                     MOVEL'Y'       E#MSGS
     C                     MOVELCLSWTK    FTMSDT
     C                     MOVELE#CPGM    FTPGMQ
     C                     MOVEL'FTM2074' FTMSID
     C                     EXSR FTSNMS
      *
     C           WRN@,1    IFEQ ' '
     C                     MOVEL*BLANKS   E#RSND
     C                     MOVEA'Y'       WRN@,1
     C                     END
      *
     C                     ELSE
     C                     MOVEA' '       WRN@,1
     C                     END
      *
      * Exit as validation complete for S.W.I.F.T.
      *
     C                     GOTO EXINBK
      *
     C                     END
      *
     C                     END
      *
     C                     MOVEA' '       WRN@,1
     C/COPY WNCPYSRC,FT0358C003
      *
      * Do not check address lines unless address check Yes
      *
     C           ##ADCK    IFNE 'Y'
     C                     MOVEL'A'       F3INBT
     C                     GOTO EXINBK
     C                     END
      *
      * Validate as an address
      *
     C                     MOVEL'Y'       ADLINE  1
     C                     MOVEL'FTM2319' ADFLDM
     C                     MOVEL'FTUSRMSG'ADFLDF
     C                     EXSR ADCHK
      *
      *  Depending on the indicators, highlight the field in error
      *
     C           *IN91     IFEQ '1'
     C                     MOVEL'Y'       E#MSGS
     C                     MOVELS3IBK1    FTMSDT
     C                     MOVELE#CPGM    FTPGMQ
     C                     MOVEL'FTM2159' FTMSID
     C                     EXSR FTSNMS
     C                     MOVEL'Y'       I3INB1
     C                     MOVEL'Y'       E#NOUP
     C                     END
     C*
     C           *IN92     IFEQ '1'
     C                     MOVEL'Y'       E#MSGS
     C                     MOVELS3IBK1    FTMSDT
     C                     MOVELE#CPGM    FTPGMQ
     C                     MOVEL'FTM2159' FTMSID
     C                     EXSR FTSNMS
     C                     MOVEL'Y'       I3INBK
     C                     MOVEL'Y'       E#NOUP
     C                     END
      *
      *  Illegal Characters found
      *
     C           *IN93     IFEQ '1'
     C                     MOVEL'Y'       E#NOUP
     C                     END
     C*
     C           AD#1      IFEQ 'Y'
     C                     MOVEL'Y'       I3INB1
     C                     END
     C           AD#2      IFEQ 'Y'
     C                     MOVEL'Y'       I3INB2
     C                     END
     C           AD#3      IFEQ 'Y'
     C                     MOVEL'Y'       I3INB3
     C                     END
     C           AD#4      IFEQ 'Y'
     C                     MOVEL'Y'       I3INB4
     C                     END
     C           AD#5      IFEQ 'Y'
     C                     MOVEL'Y'       I3INB5
     C                     END
      *
     C           I3INBK    IFEQ *BLANKS
     C                     MOVEL'A'       F3INBT
     C                     END
      *
      *  Unwind subroutine stack name
      *
     C           EXINBK    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q       50
      *
     CSR                   ENDSR
      *
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRDPAY   : Validate Details Of Payment                       *
      *                                                               *
      *  CALLED BY: SRPROC - Control Process of Validation            *
      *                                                               *
      *  CALLS    :        -                                          *
      *                                                               *
      *****************************************************************
     CSR         SRDPAY    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SRDPAY'  @STK,Q
      *
      *  /COPY Statement
      *
     C/COPY WNCPYSRC,FT0358DPAY
      *
      * VALIDATE DETAILS OF PAYMENT
      *
     C           S3PAY     IFNE *BLANKS
      *
      * Do not check address lines unless address check Yes
      *
     C           ##ADCK    IFNE 'Y'
     C                     GOTO EXDPAY
     C                     END
      *
      * Prevent first check in ADCHK subroutine
      *
     C                     MOVEL' '       ADLINE
      *
     C                     MOVE *BLANKS   ADDRSS
     C                     MOVELS3PAY     ADDRSS
      *
     C                     MOVEL'FTM2317' ADFLDM
     C                     MOVEL'FTUSRMSG'ADFLDF
     C                     EXSR ADCHK
      *
      *  Depending on the indicators, highlight the field in error
      *
     C           *IN92     IFEQ '1'
     C                     MOVEL'Y'       E#MSGS
     C                     MOVELS3PAY1    FTMSDT
     C                     MOVELE#CPGM    FTPGMQ
     C                     MOVEL'FTM2161' FTMSID
     C                     EXSR FTSNMS
     C                     MOVEL'Y'       E#NOUP
     C                     END
     C*
     C           AD#1      IFEQ 'Y'
     C                     MOVEL'Y'       I3PAY1
     C                     END
     C           AD#2      IFEQ 'Y'
     C                     MOVEL'Y'       I3PAY2
     C                     END
     C           AD#3      IFEQ 'Y'
     C                     MOVEL'Y'       I3PAY3
     C                     END
     C           AD#4      IFEQ 'Y'
     C                     MOVEL'Y'       I3PAY4
     C                     END
      *
      *  Illegal Characters found
      *
     C           *IN93     IFEQ '1'
     C                     MOVEL'Y'       I3PAY
     C                     MOVEL'Y'       E#NOUP
     C                     END
      *
     C                     END
      *
      *  Unwind subroutine stack name
      *
     C           EXDPAY    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRNBKC   : Validate Central Bank Reference                   *
      *                                                               *
      *  CALLED BY: SRPROC - Control Process of Validation            *
      *                                                               *
      *  CALLS    :        -                                          *
      *                                                               *
      *****************************************************************
     CSR         SRNBKC    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SRNBKC'  @STK,Q
      *
      *  /COPY Statement
      *
     C/COPY WNCPYSRC,FT0358NBKC
      *
      *  Central Bank Reference Code is optional
      *
     C           S3CBKR    IFEQ *BLANKS
     C           S3CBKR    OREQ *ALL'0'
     C/COPY WNCPYSRC,FT0358C028
     C                     GOTO EXNBKC
     C                     END
     C/COPY WNCPYSRC,FT0358C030
      *
      *  Validate via ZALIGN as an 11,0 numeric field
      *
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVELS3CBKR    ZFIELD
     C                     Z-ADD0         ZADEC
     C                     Z-ADD11        ZADIG
     C                     EXSR SRALGN
      *
     C           ZRTN      IFEQ '*ERROR*'
     C                     MOVEL'Y'       E#MSGS
     C                     MOVELS3CBKR    FTMSDT
     C                     MOVELE#CPGM    FTPGMQ
     C                     MOVEL'FTM2075' FTMSID
     C                     EXSR FTSNMS
     C                     MOVEL'Y'       I3CBKR
     C                     MOVEL'Y'       E#NOUP
     C                     ELSE
     C/COPY WNCPYSRC,FT0358C029
     C                     MOVE ZFIELD    S3CBKR
     C                     END
      *                                                                   S01408
     C/COPY WNCPYSRC,FT0358CCP1                                           S01408
      *                                                                   S01408
      *
      *  Unwind subroutine stack name
      *
     C           EXNBKC    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
     C/EJECT
      *****************************************************************   CFT014
      *                                                               *   CFT014
      *  SRTRCT   : Validate Transfer Commission Tariff               *   CFT014
      *                                                               *   CFT014
      *  CALLED BY: SRPROC                                            *   CFT014
      *                                                               *   CFT014
      *  CALLS    : FTSNMS                                            *   CFT014
      *                                                               *   CFT014
      *****************************************************************   CFT014
     CSR         SRTRCT    BEGSR                                          CFT014
      *                                                                   CFT014
      ** Set up subroutine stack name.                                    CFT014
      *                                                                   CFT014
     C                     ADD  1         Q                               CFT014
     C                     MOVEL'SRTRCT'  @STK,Q                          CFT014
      *                                                                   CFT014
      ** Tariff is optional but if entered must be 1/2/3/4/5.             CFT014
      *                                                                   CFT014
     C           S3TRCT    IFNE '1'                                       CFT014
     C           S3TRCT    ANDNE'2'                                       CFT014
     C           S3TRCT    ANDNE'3'                                       CFT014
     C           S3TRCT    ANDNE'4'                                       CFT014
     C           S3TRCT    ANDNE'5'                                       CFT014
     C                     MOVEL'Y'       E#MSGS                          CFT014
     C                     MOVELS3TRCT    FTMSDT                          CFT014
     C                     MOVELE#CPGM    FTPGMQ                          CFT014
     C                     MOVEL'FTM2055' FTMSID                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVEL'Y'       I3TRCT                          CFT014
     C                     MOVEL'Y'       E#NOUP                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Unwind subroutine stack name.                                    CFT014
      *                                                                   CFT014
     C           EXTRCT    TAG                                            CFT014
     C                     MOVEA*BLANKS   @STK,Q                          CFT014
     C                     SUB  1         Q       50                      CFT014
      *                                                                   CFT014
     CSR                   ENDSR                                          CFT014
      *                                                                   CFT014
     C/EJECT                                                              CFT014
      *****************************************************************
      *                                                               *
      *  SROPIN   : Validate Outward Payment Generator                *
      *                                                               *
      *  CALLED BY: SRPROC - Control Process of Validation            *
      *                                                               *
      *  CALLS    :        -                                          *
      *                                                               *
      *****************************************************************
     CSR         SROPIN    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SROPIN'  @STK,Q
      *
      *  /COPY Statement
      *
     C/COPY WNCPYSRC,FT0358OPIN
      *
      *  Valid only if Account with Institution entered
      *
     C           V#ACBT    IFNE *BLANKS
      *                                                                   135176
      * Indicator can be blank if called via auto generation,             135176
      * therefore default to 'N' if blank                                 135176
     C           S3OPIN    IFEQ *BLANKS                                   135176
     C                     MOVE 'N'       S3OPIN                          135176
     C                     ENDIF                                          135176
      *                                                                   135176
     C           S3OPIN    IFEQ *BLANKS
     C                     MOVEL'Y'       E#MSGS
     C                     MOVELS3OPIN    FTMSDT
     C                     MOVELE#CPGM    FTPGMQ
     C                     MOVEL'FTM2076' FTMSID
     C                     EXSR FTSNMS
     C                     MOVEL'Y'       I3OPIN
     C                     MOVEL'Y'       E#NOUP
     C                     ELSE
      *
     C           S3OPIN    IFNE 'Y'
     C           S3OPIN    ANDNE'N'
     C                     MOVEL'Y'       E#MSGS
     C                     MOVELS3OPIN    FTMSDT
     C                     MOVELE#CPGM    FTPGMQ
     C                     MOVEL'FTM2077' FTMSID
     C                     EXSR FTSNMS
     C                     MOVEL'Y'       I3OPIN
     C                     MOVEL'Y'       E#NOUP
     C                     END                             E003
      *
     C                     END                             E002
      *
     C                     END                             E001
      *
      *  Unwind subroutine stack name
      *
     C           EXOPIN    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
     C/EJECT
      *****************************************************************   CFT014
      *                                                               *   CFT014
      *  SRBOCD   : Validate Bank Operation Code                      *   CFT014
      *                                                               *   CFT014
      *  CALLED BY: SRPROC                                            *   CFT014
      *                                                               *   CFT014
      *  CALLS    : FTSNMS                                            *   CFT014
      *                                                               *   CFT014
      *****************************************************************   CFT014
     CSR         SRBOCD    BEGSR                                          CFT014
      *                                                                   CFT014
      ** Set up subroutine stack name.                                    CFT014
      *                                                                   CFT014
     C                     ADD  1         Q                               CFT014
     C                     MOVEL'SRBOCD'  @STK,Q                          CFT014
      *                                                                   CFT014
      ** Default Bank Operation Code to 'CRED'.                           CFT014
      *                                                                   CFT014
     C           S3BOCD    IFEQ *BLANKS                                   CFT014
     C                     MOVE 'CRED'    S3BOCD                          CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
      ** Bank Operation Code must be 'CRED', 'SPAY', 'SSTD',              CFT014
      ** 'SPRI' if entered.                                               CFT014
      *                                                                   CFT014
     C           S3BOCD    IFNE 'CRED'                                    CFT014
     C           S3BOCD    ANDNE'SPAY'                                    CFT014
     C           S3BOCD    ANDNE'SSTD'                                    CFT014
     C           S3BOCD    ANDNE'SPRI'                                    CFT014
     C                     MOVE 'Y'       E#MSGS                          CFT014
     C                     MOVEL'FTM5009' FTMSID                          CFT014
     C                     MOVE E#CPGM    FTPGMQ                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVE 'Y'       I3BOCD                          CFT014
     C                     MOVE 'Y'       E#NOUP                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Unwind subroutine stack name.                                    CFT014
      *                                                                   CFT014
     C           EXBOCD    TAG                                            CFT014
     C                     MOVEA*BLANKS   @STK,Q                          CFT014
     C                     SUB  1         Q                               CFT014
      *                                                                   CFT014
     CSR                   ENDSR                                          CFT014
      *                                                                   CFT014
     C/EJECT                                                              CFT014
      *****************************************************************   CFT014
      *                                                               *   CFT014
      *  SRTTCD   : Validate Transaction Type Code                    *   CFT014
      *                                                               *   CFT014
      *  CALLED BY: SRPROC                                            *   CFT014
      *                                                               *   CFT014
      *  CALLS    : FTSNMS                                            *   CFT014
      *                                                               *   CFT014
      *****************************************************************   CFT014
     CSR         SRTTCD    BEGSR                                          CFT014
      *                                                                   CFT014
      ** Set up subroutine stack name.                                    CFT014
      *                                                                   CFT014
     C                     ADD  1         Q                               CFT014
     C                     MOVEL'SRBOCD'  @STK,Q                          CFT014
      *                                                                   CFT014
      ** Bypass validation if Transaction Type Code is blank.             CFT014
      *                                                                   CFT014
     C           S3TTCD    IFEQ *BLANKS                                   CFT014
     C                     GOTO EXTTCD                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Check if all characters of Transaction Type Code is present      CFT014
      ** in Alphabet.                                                     CFT014
      *                                                                   CFT014
     C                     MOVELS3TTCD    WTTCD                           CFT014
      *                                                                                       CSW202
      ** If SWIFT 2002 Standards Update is switched on, characters of                         CSW202
      ** Transaction Type Code may now be of type Alphanumeric.                               CSW202
      *                                                                                       CSW202
     C           CSW202    IFEQ 'Y'                                                           CSW202
     C           TTCD1     LOKUPALPHNU                   61                                   CSW202
     C           TTCD2     LOKUPALPHNU                   62                                   CSW202
     C           TTCD3     LOKUPALPHNU                   63                                   CSW202
     C                     ELSE                                                               CSW202
     C           TTCD1     LOKUPALPHA                    61               CFT014
     C           TTCD2     LOKUPALPHA                    62               CFT014
     C           TTCD3     LOKUPALPHA                    63               CFT014
     C                     ENDIF                                                              CSW202
     C           *IN61     IFEQ *OFF                                      CFT014
     C           *IN62     OREQ *OFF                                      CFT014
     C           *IN63     OREQ *OFF                                      CFT014
     C                     MOVE 'Y'       E#MSGS                          CFT014
     C                     MOVEL'FTM5010' FTMSID                          CFT014
     C                     MOVELS3TTCD    FTMSDT                          CFT014
     C                     MOVE E#CPGM    FTPGMQ                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVE 'Y'       I3TTCD                          CFT014
     C                     MOVE 'Y'       E#NOUP                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Unwind subroutine stack name.                                    CFT014
      *                                                                   CFT014
     C           EXTTCD    TAG                                            CFT014
     C                     MOVEA*BLANKS   @STK,Q                          CFT014
     C                     SUB  1         Q                               CFT014
      *                                                                   CFT014
     CSR                   ENDSR                                          CFT014
      *                                                                   CFT014
     C/EJECT                                                              CFT014
      *****************************************************************   CFT014
      *                                                               *   CFT014
      *  SRICDE   : Validate Instruction Code                         *   CFT014
      *                                                               *   CFT014
      *  CALLED BY: SRPROC                                            *   CFT014
      *                                                               *   CFT014
      *  CALLS    : FTSNMS                                            *   CFT014
      *                                                               *   CFT014
      *****************************************************************   CFT014
     CSR         SRICDE    BEGSR                                          CFT014
      *                                                                   CFT014
      ** Set up subroutine stack name.                                    CFT014
      *                                                                   CFT014
     C                     ADD  1         Q                               CFT014
     C                     MOVEL'SRICDE'  @STK,Q                          CFT014
      *                                                                   CFT014
      ** Bypass validation if Instruction Code is blank.                  CFT014
      *                                                                   CFT014
     C           S3ICDE    IFEQ *BLANKS                                   CFT014
     C                     GOTO EXICDE                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Entry for Instruction Code is prohibited if Bank Operation Code  CFT014
      ** is 'SSTD' or 'SPAY'.                                             CFT014
      *                                                                   CFT014
     C           S3BOCD    IFEQ 'SSTD'                                    CFT014
     C           S3BOCD    OREQ 'SPAY'                                    CFT014
     C                     MOVE 'Y'       E#MSGS                          CFT014
     C                     MOVEL'FTM5011' FTMSID                          CFT014
     C                     MOVE E#CPGM    FTPGMQ                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVEL'Y'       I3ICDE                          CFT014
     C                     MOVE 'Y'       E#NOUP                          CFT014
     C                     GOTO EXICDE                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVELS3ICD2    WSICDA                          CFT014
     C                     MOVELS3ICD3    WSICDB                          CFT014
     C                     MOVELS3ICD4    WSICDC                          CFT014
     C                     MOVELS3ICD5    WSICDD                          CFT014
      *                                                                   CFT014
     C                     MOVELS3ICD3    WSICDE                          CFT014
     C                     MOVELS3ICD4    WSICDF                          CFT014
     C                     MOVELS3ICD5    WSICDG                          CFT014
      *                                                                   CFT014
     C                     MOVELS3ICD4    WSICDH                          CFT014
     C                     MOVELS3ICD5    WSICDI                          CFT014
      *                                                                   CFT014
      ** Check for embedded blank lines.                                  CFT014
      *                                                                   CFT014
     C           S3ICD1    IFEQ *BLANKS                                   CFT014
     C           ICD25     ANDNE*BLANKS                                   CFT014
     C           S3ICD2    OREQ *BLANKS                                   CFT014
     C           ICD35     ANDNE*BLANKS                                   CFT014
     C           S3ICD3    OREQ *BLANKS                                   CFT014
     C           ICD45     ANDNE*BLANKS                                   CFT014
     C           S3ICD4    OREQ *BLANKS                                   CFT014
     C           S3ICD5    ANDNE*BLANKS                                   CFT014
     C                     MOVE 'Y'       E#MSGS                          CFT014
     C                     MOVEL'FTM5012' FTMSID                          CFT014
     C                     MOVE E#CPGM    FTPGMQ                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVEL'Y'       I3ICDE                          CFT014
     C                     MOVE 'Y'       E#NOUP                          CFT014
     C                     GOTO EXICDE                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     Z-ADD0         IX                              CFT014
     C                     MOVEA*BLANKS   WA1                             CFT014
     C                     MOVEA*BLANKS   WA2                             CFT014
     C                     MOVEAS3ICDE    WA1                             CFT014
     C                     MOVE I3ICDE    ICDERR                          CFT014
     C                     MOVEAICDERR    WA2                             CFT014
     C                     MOVEA*BLANKS   CD                                                  CSW201
      *                                                                   CFT014
     C           IX        DOWLT5                                         CFT014
      *                                                                   CFT014
     C                     ADD  1         IX                              CFT014
      *                                                                   CFT014
     C           WA1,IX    IFEQ *BLANKS                                   CFT014
     C                     LEAVE                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVELWA1,IX    WICD4   4                       CFT014
     C                     MOVE WA1,IX    WICD31 31                       CFT014
     C                     MOVELWICD31    WICD5   1                       CFT014
     C                     MOVE WICD31    WICD30 30                       CFT014
      *                                                                   CFT014
     C                     SELEC                                          CFT014
      *                                                                   CFT014
      ** Check that pos. 1-4 is a valid codeword.                         CFT014
      *                                                                   CFT014
     C           WICD4     WHNE 'BONL'                                    CFT014
     C           WICD4     ANDNE'CHQB'                                    CFT014
     C           WICD4     ANDNE'CORT'                                    CFT014
     C           WICD4     ANDNE'HOLD'                                    CFT014
     C           WICD4     ANDNE'INTC'                                    CFT014
     C           WICD4     ANDNE'PHON'                                    CFT014
     C           WICD4     ANDNE'PHOB'                                    CFT014
     C           WICD4     ANDNE'PHOI'                                    CFT014
     C           WICD4     ANDNE'SDVA'                                    CFT014
     C           WICD4     ANDNE'TELE'                                    CFT014
     C           WICD4     ANDNE'TELB'                                    CFT014
     C           WICD4     ANDNE'TELI'                                    CFT014
      *                                                                                       CSW202
      ** If SWIFT 2002 Standards Update is switched on, new code 'REPA'                       CSW202
      ** - Payment has related e-Payments reference may also be used.                         CSW202
      *                                                                                       CSW202
     C           WICD4     ANDNE'REPA'                                                        CSW202
     C           WICD4     OREQ 'REPA'                                                        CSW202
     C           CSW202    ANDEQ'N'                                                           CSW202
     C           WICD4     OREQ 'BONL'                                                        CSW206
     C           CSW206    ANDEQ'Y'                                                           CSW206
     C                     MOVE 'Y'       E#MSGS                          CFT014
     C           CSW202    IFEQ 'Y'                                                           CSW202
     C                     MOVEL'FTM5500' FTMSID                                              CSW202
     C                     ELSE                                                               CSW202
     C                     MOVEL'FTM5013' FTMSID                          CFT014
     C                     ENDIF                                                              CSW202
      *                                                                                       CSW206
      ** If SWIFT Changes 2006 (CSW206) is installed, Instruction Code "BONL"                 CSW206
      **    is not allowed.  If CSW206 is switched ON, override the message IDs               CSW206
      **    FTM5500 or FTM5013 with FTM5601 because BONL codeword should not be               CSW206
      **    present in 2nd level text message                                                 CSW206
      *                                                                                       CSW206
     C           CSW206    IFEQ 'Y'                                                           CSW206
     C                     MOVEL'FTM5601' FTMSID                                              CSW206
     C                     ENDIF                                                              CSW206
      *                                                                                       CSW206
     C                     MOVELWICD4     FTMSDT                          CFT014
     C                     MOVE E#CPGM    FTPGMQ                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVE 'Y'       WA2,IX                          CFT014
     C                     MOVE 'Y'       E#NOUP                          CFT014
      *                                                                   CFT014
      ** When Bank Operation Code is 'SPRI', codewords should be          CFT014
      ** 'SDVA' or 'TELB' or 'PHOB' or 'INTC.                             CFT014
      *                                                                   CFT014
     C           S3BOCD    WHEQ 'SPRI'                                    CFT014
     C           WICD4     ANDNE'SDVA'                                    CFT014
     C           WICD4     ANDNE'TELB'                                    CFT014
     C           WICD4     ANDNE'PHOB'                                    CFT014
     C           WICD4     ANDNE'INTC'                                    CFT014
     C                     MOVE 'Y'       E#MSGS                          CFT014
     C                     MOVEL'FTM5014' FTMSID                          CFT014
     C                     MOVELWICD4     FTMSDT                          CFT014
     C                     MOVE E#CPGM    FTPGMQ                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVE 'Y'       WA2,IX                          CFT014
     C                     MOVE 'Y'       E#NOUP                          CFT014
      *                                                                                       CSW201
      ** When CSW201 is Y, intermediary bank is blank and codeword                            CSW201
      ** is either TELI or PHOI                                                               CSW201
      *                                                                                       CSW201
     C           CSW201    WHEQ 'Y'                                                           CSW201
     C           S3IBK     ANDEQ*BLANKS                                                       CSW201
     C           WICD4     ANDEQ'TELI'                                                        CSW201
     C           CSW201    OREQ 'Y'                                                           CSW201
     C           S3IBK     ANDEQ*BLANKS                                                       CSW201
     C           WICD4     ANDEQ'PHOI'                                                        CSW201
     C                     MOVE 'Y'       E#MSGS                                              CSW201
     C                     MOVEL'FTM5046' FTMSID                                              CSW201
     C                     MOVELWICD4     FTMSDT                                              CSW201
     C                     MOVE E#CPGM    FTPGMQ                                              CSW201
     C                     EXSR FTSNMS                                                        CSW201
     C                     MOVE 'Y'       WA2,IX                                              CSW201
     C                     MOVE 'Y'       E#NOUP                                              CSW201
      *                                                                                       CSW201
      ** When CSW201 is Y, account with bank is blank and codeword                            CSW201
      ** is either TELE or PHON                                                               CSW201
      *                                                                                       CSW201
     C           CSW201    WHEQ 'Y'                                                           CSW201
     C           V#ACBT    ANDEQ*BLANKS                                                       CSW201
     C           WICD4     ANDEQ'TELE'                                                        CSW201
     C           CSW201    OREQ 'Y'                                                           CSW201
     C           V#ACBT    ANDEQ*BLANKS                                                       CSW201
     C           WICD4     ANDEQ'PHON'                                                        CSW201
     C                     MOVE 'Y'       E#MSGS                                              CSW201
     C                     MOVEL'FTM5047' FTMSID                                              CSW201
     C                     MOVELWICD4     FTMSDT                                              CSW201
     C                     MOVE E#CPGM    FTPGMQ                                              CSW201
     C                     EXSR FTSNMS                                                        CSW201
     C                     MOVE 'Y'       WA2,IX                                              CSW201
     C                     MOVE 'Y'       E#NOUP                                              CSW201
      *                                                                   CFT014
      ** Pos. 5-35 should not contain additional information              CFT014
      ** when codeword is not PHON/PHOB/PHOI/TELE/TELB/TELI/HOLD.         CFT014
      *                                                                   CFT014
     C           WICD31    WHNE *BLANKS                                   CFT014
     C           WICD4     ANDNE'PHON'                                    CFT014
     C           WICD4     ANDNE'PHOB'                                    CFT014
     C           WICD4     ANDNE'PHOI'                                    CFT014
     C           WICD4     ANDNE'TELE'                                    CFT014
     C           WICD4     ANDNE'TELB'                                    CFT014
     C           WICD4     ANDNE'TELI'                                    CFT014
     C           WICD4     ANDNE'HOLD'                                    CFT014
      *                                                                                       CSW202
      ** If SWIFT 2002 Standards Update is switched on, additional                            CSW202
      ** information  may also be entered if codeword 'REPA' is used.                         CSW202
      *                                                                                       CSW202
     C           WICD4     ANDNE'REPA'                                                        CSW202
     C                     MOVE 'Y'       E#MSGS                          CFT014
     C           CSW202    IFEQ 'Y'                                                           CSW202
     C                     MOVEL'FTM5501' FTMSID                                              CSW202
     C                     ELSE                                                               CSW202
     C                     MOVEL'FTM5015' FTMSID                          CFT014
     C                     ENDIF                                                              CSW202
     C                     MOVELWICD4     FTMSDT                          CFT014
     C                     MOVE E#CPGM    FTPGMQ                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVE 'Y'       WA2,IX                          CFT014
     C                     MOVE 'Y'       E#NOUP                          CFT014
      *                                                                   CFT014
      ** Codeword must be followed by '/' if additional info is           CFT014
      ** supplied in pos. 6-35.                                           CFT014
      *                                                                   CFT014
     C           WICD31    WHNE *BLANKS                                   CFT014
     C           WICD5     ANDNE'/'                                       CFT014
     C                     MOVE 'Y'       E#MSGS                          CFT014
     C                     MOVEL'FTM5016' FTMSID                          CFT014
     C                     MOVELWICD4     FTMSDT                          CFT014
     C                     MOVE E#CPGM    FTPGMQ                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVE 'Y'       WA2,IX                          CFT014
     C                     MOVE 'Y'       E#NOUP                          CFT014
      *                                                                   CFT014
      ** Additional info must be supplied in pos. 6-35 when '/' has       CFT014
      ** been entered after the codeword.                                 CFT014
      *                                                                   CFT014
     C           WICD5     WHEQ '/'                                       CFT014
     C           WICD30    ANDEQ*BLANKS                                   CFT014
     C                     MOVE 'Y'       E#MSGS                          CFT014
     C                     MOVEL'FTM5029' FTMSID                          CFT014
     C                     MOVELWICD4     FTMSDT                          CFT014
     C                     MOVE E#CPGM    FTPGMQ                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVE 'Y'       WA2,IX                          CFT014
     C                     MOVE 'Y'       E#NOUP                          CFT014
      *                                                                   CFT014
      ** Additional info in pos. 6-35 should be valid SWIFT characters.   CFT014
      *                                                                   CFT014
     C           WICD30    WHNE *BLANKS                                   CFT014
     C                     MOVEL*BLANKS   I#FLD                           CFT014
     C                     MOVELWICD30    I#FLD                           CFT014
     C                     EXSR SWSET                                     CFT014
     C           *IN94     IFEQ *ON                                       CFT014
     C                     MOVE 'Y'       E#MSGS                          CFT014
     C                     MOVEL'FTM5030' FTMSID                          CFT014
     C                     MOVELWICD4     FTMSDT                          CFT014
     C                     MOVE E#CPGM    FTPGMQ                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVE 'Y'       WA2,IX                          CFT014
     C                     MOVE 'Y'       E#NOUP                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDSL                                          CFT014
      *                                                                                       CSW201
     C                     MOVE WICD4     CD,IX                                               CSW201
      *                                                                   CFT014
     C                     ENDDO                                          CFT014
      *                                                                                       CSW201
     C           CSW201    IFEQ 'Y'                                                           CSW201
     C                     Z-ADD5         I       10                                          CSW201
     C                     MOVEL'N'       WDUP1   1                                           CSW201
     C                     MOVEL'N'       WCOMBI  1                                           CSW201
      *                                                                                       CSW201
     C           I         DOWGT1                                                             CSW201
     C           WDUP1     ANDEQ'N'                                                           CSW201
     C           WCOMBI    ANDEQ'N'                                                           CSW201
      *                                                                                       CSW201
     C           CD,I      IFNE *BLANKS                                                       CSW201
     C                     Z-ADD0         J       10                                          CSW201
     C           I         SUB  1         J                                                   CSW201
      *                                                                                       CSW201
     C           J         DOWGE1                                                             CSW201
     C           WDUP1     ANDEQ'N'                                                           CSW201
     C           WCOMBI    ANDEQ'N'                                                           CSW201
      *                                                                                       CSW201
     C           CD,I      IFEQ CD,J                                                          CSW201
     C                     MOVE 'Y'       WDUP1                                               CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C                     SELEC                                                              CSW201
     C           CD,I      WHEQ 'SDVA'                                                        CSW201
     C           CD,J      ANDEQ'HOLD'                                                        CSW201
     C           CD,I      OREQ 'HOLD'                                                        CSW201
     C           CD,J      ANDEQ'SDVA'                                                        CSW201
     C           CD,I      OREQ 'SDVA'                                                        CSW201
     C           CD,J      ANDEQ'CHQB'                                                        CSW201
     C           CD,I      OREQ 'CHQB'                                                        CSW201
     C           CD,J      ANDEQ'SDVA'                                                        CSW201
     C                     MOVE 'Y'       E#MSGS                                              CSW201
     C                     MOVEL'FTM5203' FTMSID                                              CSW201
     C                     MOVELWICD4     FTMSDT                                              CSW201
     C                     MOVE E#CPGM    FTPGMQ                                              CSW201
     C                     EXSR FTSNMS                                                        CSW201
     C                     MOVE 'Y'       WA2,I                                               CSW201
     C                     MOVE 'Y'       E#NOUP                                              CSW201
     C                     MOVE 'Y'       WCOMBI                                              CSW201
      *                                                                                       CSW201
     C           CD,I      WHEQ 'INTC'                                                        CSW201
     C           CD,J      ANDEQ'BONL'                                                        CSW201
     C           CD,I      OREQ 'BONL'                                                        CSW201
     C           CD,J      ANDEQ'INTC'                                                        CSW201
     C           CD,I      OREQ 'INTC'                                                        CSW201
     C           CD,J      ANDEQ'HOLD'                                                        CSW201
     C           CD,I      OREQ 'HOLD'                                                        CSW201
     C           CD,J      ANDEQ'INTC'                                                        CSW201
     C           CD,I      OREQ 'INTC'                                                        CSW201
     C           CD,J      ANDEQ'CHQB'                                                        CSW201
     C           CD,I      OREQ 'CHQB'                                                        CSW201
     C           CD,J      ANDEQ'INTC'                                                        CSW201
     C                     MOVE 'Y'       E#MSGS                                              CSW201
     C                     MOVEL'FTM5204' FTMSID                                              CSW201
     C                     MOVELWICD4     FTMSDT                                              CSW201
     C                     MOVE E#CPGM    FTPGMQ                                              CSW201
     C                     EXSR FTSNMS                                                        CSW201
     C                     MOVE 'Y'       WA2,I                                               CSW201
     C                     MOVE 'Y'       E#NOUP                                              CSW201
     C                     MOVE 'Y'       WCOMBI                                              CSW201
      *                                                                                       CSW201
     C           CD,I      WHEQ 'CORT'                                                        CSW201
     C           CD,J      ANDEQ'BONL'                                                        CSW201
     C           CD,I      OREQ 'BONL'                                                        CSW201
     C           CD,J      ANDEQ'CORT'                                                        CSW201
     C           CD,I      OREQ 'CORT'                                                        CSW201
     C           CD,J      ANDEQ'HOLD'                                                        CSW201
     C           CD,I      OREQ 'HOLD'                                                        CSW201
     C           CD,J      ANDEQ'CORT'                                                        CSW201
     C           CD,I      OREQ 'CORT'                                                        CSW201
     C           CD,J      ANDEQ'CHQB'                                                        CSW201
     C           CD,I      OREQ 'CHQB'                                                        CSW201
     C           CD,J      ANDEQ'CORT'                                                        CSW201
     C                     MOVE 'Y'       E#MSGS                                              CSW201
     C                     MOVEL'FTM5205' FTMSID                                              CSW201
     C                     MOVELWICD4     FTMSDT                                              CSW201
     C                     MOVE E#CPGM    FTPGMQ                                              CSW201
     C                     EXSR FTSNMS                                                        CSW201
     C                     MOVE 'Y'       WA2,I                                               CSW201
     C                     MOVE 'Y'       E#NOUP                                              CSW201
     C                     MOVE 'Y'       WCOMBI                                              CSW201
      *                                                                                       CSW201
     C           CD,I      WHEQ 'HOLD'                                                        CSW201
     C           CD,J      ANDEQ'CHQB'                                                        CSW201
     C           CD,I      OREQ 'CHQB'                                                        CSW201
     C           CD,J      ANDEQ'HOLD'                                                        CSW201
     C                     MOVE 'Y'       E#MSGS                                              CSW201
     C                     MOVEL'FTM5206' FTMSID                                              CSW201
     C                     MOVELWICD4     FTMSDT                                              CSW201
     C                     MOVE E#CPGM    FTPGMQ                                              CSW201
     C                     EXSR FTSNMS                                                        CSW201
     C                     MOVE 'Y'       WA2,I                                               CSW201
     C                     MOVE 'Y'       E#NOUP                                              CSW201
     C                     MOVE 'Y'       WCOMBI                                              CSW201
      *                                                                                       CSW201
     C           CD,I      WHEQ 'PHOB'                                                        CSW201
     C           CD,J      ANDEQ'TELB'                                                        CSW201
     C           CD,I      OREQ 'TELB'                                                        CSW201
     C           CD,J      ANDEQ'PHOB'                                                        CSW201
     C                     MOVE 'Y'       E#MSGS                                              CSW201
     C                     MOVEL'FTM5207' FTMSID                                              CSW201
     C                     MOVELWICD4     FTMSDT                                              CSW201
     C                     MOVE E#CPGM    FTPGMQ                                              CSW201
     C                     EXSR FTSNMS                                                        CSW201
     C                     MOVE 'Y'       WA2,I                                               CSW201
     C                     MOVE 'Y'       E#NOUP                                              CSW201
     C                     MOVE 'Y'       WCOMBI                                              CSW201
      *                                                                                       CSW201
     C           CD,I      WHEQ 'PHON'                                                        CSW201
     C           CD,J      ANDEQ'TELE'                                                        CSW201
     C           CD,I      OREQ 'TELE'                                                        CSW201
     C           CD,J      ANDEQ'PHON'                                                        CSW201
     C                     MOVE 'Y'       E#MSGS                                              CSW201
     C                     MOVEL'FTM5208' FTMSID                                              CSW201
     C                     MOVELWICD4     FTMSDT                                              CSW201
     C                     MOVE E#CPGM    FTPGMQ                                              CSW201
     C                     EXSR FTSNMS                                                        CSW201
     C                     MOVE 'Y'       WA2,I                                               CSW201
     C                     MOVE 'Y'       E#NOUP                                              CSW201
     C                     MOVE 'Y'       WCOMBI                                              CSW201
      *                                                                                       CSW201
     C           CD,I      WHEQ 'PHOI'                                                        CSW201
     C           CD,J      ANDEQ'TELI'                                                        CSW201
     C           CD,I      OREQ 'TELI'                                                        CSW201
     C           CD,J      ANDEQ'PHOI'                                                        CSW201
     C                     MOVE 'Y'       E#MSGS                                              CSW201
     C                     MOVEL'FTM5209' FTMSID                                              CSW201
     C                     MOVELWICD4     FTMSDT                                              CSW201
     C                     MOVE E#CPGM    FTPGMQ                                              CSW201
     C                     EXSR FTSNMS                                                        CSW201
     C                     MOVE 'Y'       WA2,I                                               CSW201
     C                     MOVE 'Y'       E#NOUP                                              CSW201
     C                     MOVE 'Y'       WCOMBI                                              CSW201
      *                                                                                       CSW202
     C           CD,I      WHEQ 'REPA'                                                        CSW202
     C           CD,J      ANDEQ'HOLD'                                                        CSW202
     C           CD,I      OREQ 'HOLD'                                                        CSW202
     C           CD,J      ANDEQ'REPA'                                                        CSW202
     C           CD,I      OREQ 'REPA'                                                        CSW202
     C           CD,J      ANDEQ'CHQB'                                                        CSW202
     C           CD,I      OREQ 'CHQB'                                                        CSW202
     C           CD,J      ANDEQ'REPA'                                                        CSW202
     C           CD,I      OREQ 'REPA'                                                        CSW202
     C           CD,J      ANDEQ'BONL'                                                        CSW202
     C           CD,I      OREQ 'BONL'                                                        CSW202
     C           CD,J      ANDEQ'REPA'                                                        CSW202
     C           CD,I      OREQ 'REPA'                                                        CSW202
     C           CD,J      ANDEQ'CORT'                                                        CSW202
     C           CD,I      OREQ 'CORT'                                                        CSW202
     C           CD,J      ANDEQ'REPA'                                                        CSW202
      *                                                                                       CSW202
     C           CSW202    IFEQ 'Y'                                                           CSW202
     C                     MOVE 'Y'       E#MSGS                                              CSW202
     C                     MOVEL'FTM5502' FTMSID                                              CSW202
     C                     MOVELWICD4     FTMSDT                                              CSW202
     C                     MOVE E#CPGM    FTPGMQ                                              CSW202
     C                     EXSR FTSNMS                                                        CSW202
     C                     MOVE 'Y'       WA2,I                                               CSW202
     C                     MOVE 'Y'       E#NOUP                                              CSW202
     C                     MOVE 'Y'       WCOMBI                                              CSW202
     C                     ENDIF                                                              CSW202
      *                                                                                       CSW202
     C                     ENDSL                                                              CSW201
      *                                                                                       CSW201
     C           J         SUB  1         J                                                   CSW201
     C                     ENDDO                                                              CSW201
      *                                                                                       CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C           I         SUB  1         I                                                   CSW201
     C                     ENDDO                                                              CSW201
      *                                                                                       CSW201
     C           WDUP1     IFEQ 'Y'                                                           CSW201
     C                     MOVE 'Y'       E#MSGS                                              CSW201
     C                     MOVEL'FTM5202' FTMSID                                              CSW201
     C                     ADD  1         I                                                   CSW201
     C                     MOVELCD,I      FTMSDT                                              CSW201
     C                     MOVE E#CPGM    FTPGMQ                                              CSW201
     C                     EXSR FTSNMS                                                        CSW201
     C                     MOVE 'Y'       WA2,I                                               CSW201
     C                     MOVE 'Y'       E#NOUP                                              CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
      ** If there is more than 1 instruction code entered, check order                        CSW201
      ** of sequence.                                                                         CSW201
      *                                                                                       CSW201
     C                     Z-ADD1         WX      20                                          CSW201
     C           *BLANK    LOKUPCD,WX                    01                                   CSW201
     C           *IN01     IFEQ *ON                                                           CSW201
     C                     SUB  1         WX                                                  CSW201
     C                     ELSE                                                               CSW201
     C                     Z-ADD5         WX                                                  CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C           WX        IFLE 1                                                             CSW201
     C                     MOVEAWA2       ICDERR                                              CSW201
     C                     MOVE ICDERR    I3ICDE                                              CSW201
     C                     GOTO EXICDE                                                        CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C                     Z-ADD1         WIN     20                                          CSW201
      *                                                                                       CSW201
     C           WIN       DOWLTWX                                                            CSW201
     C                     Z-ADD1         WIX     20                                          CSW201
      *                                                                                       CSW201
     C           CD,WIN    LOKUPWICOR,WIX                01                                   CSW201
     C           WIN       ADD  1         WIZ     20                                          CSW201
     C           WX        ADD  1         WX2     20                                          CSW201
      *                                                                                       CSW201
     C           *IN01     IFEQ *ON                                                           CSW201
     C           WIZ       ANDLEWX2                                                           CSW201
     C           CD,WIZ    LOKUPWICOR,WIX                01                                   CSW201
      *                                                                                       CSW201
     C           *IN01     IFEQ *OFF                                                          CSW201
     C                     MOVE 'Y'       E#MSGS                                              CSW201
     C                     MOVEL*BLANKS   FTMSDT                                              CSW201
     C                     MOVE E#CPGM    FTPGMQ                                              CSW201
     C           CSW202    IFEQ 'Y'                                                           CSW202
     C                     MOVEL'FTM5503' FTMSID                                              CSW202
     C                     ELSE                                                               CSW202
     C                     MOVEL'FTM5210' FTMSID                                              CSW201
     C                     ENDIF                                                              CSW202
      *                                                                                       CSW206
      ** If CSW206 is switched ON, override the message IDs FTM5503 or FTM5210 with           CSW206
      **  FTM5602 because BONL codeword should not be present in 2nd level text               CSW206
      *   message                                                                             CSW206
      *                                                                                       CSW206
     C           CSW206    IFEQ 'Y'                                                           CSW206
     C                     MOVEL'FTM5602' FTMSID                                              CSW206
     C                     ENDIF                                                              CSW206
      *                                                                                       CSW206
     C                     EXSR FTSNMS                                                        CSW201
     C                     MOVE *ALL'Y'   I3ICDE                                              CSW201
     C                     MOVE 'Y'       E#NOUP                                              CSW201
     C                     GOTO EXICDE                                                        CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C                     ENDIF                                                              CSW201
     C                     ADD  1         WIN                                                 CSW201
      *                                                                                       CSW201
     C                     ENDDO                                                              CSW201
     C                     ENDIF                                                              CSW201
      *                                                                   CFT014
     C                     MOVEAWA2       ICDERR  5                       CFT014
     C                     MOVE ICDERR    I3ICDE                          CFT014
      *                                                                   CFT014
      ** Unwind subroutine stack name.                                    CFT014
      *                                                                   CFT014
     C           EXICDE    TAG                                            CFT014
     C                     MOVEA*BLANKS   @STK,Q                          CFT014
     C                     SUB  1         Q                               CFT014
      *                                                                   CFT014
     CSR                   ENDSR                                          CFT014
      *                                                                   CFT014
     C/EJECT                                                              CFT014
      *****************************************************************   CFT014
      *                                                               *   CFT014
      *  SRRRPT   : Validate Regulatory Reporting                     *   CFT014
      *                                                               *   CFT014
      *  CALLED BY: SRPROC                                            *   CFT014
      *                                                               *   CFT014
      *  CALLS    : FTSNMS                                            *   CFT014
      *                                                               *   CFT014
      *****************************************************************   CFT014
     CSR         SRRRPT    BEGSR                                          CFT014
      *                                                                   CFT014
      ** Set up subroutine stack name.                                    CFT014
      *                                                                   CFT014
     C                     ADD  1         Q                               CFT014
     C                     MOVEL'SRRRPT'  @STK,Q                          CFT014
      *                                                                   CFT014
     C                     MOVE S3RRPT    WS3RRP                          CFT014
      *                                                                   CFT014
     C                     MOVELS3RRP2    WSRRPA                          CFT014
     C                     MOVELS3RRP3    WSRRPB                          CFT014
      *                                                                   CFT014
      ** Bypass validation if Regulatory Reporting is blank.              CFT014
      *                                                                   CFT014
     C           WS3RRP    IFEQ *BLANKS                                   CFT014
     C                     GOTO EXRRPT                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Check for embedded blank lines.                                  CFT014
      *                                                                   CFT014
     C           WSRRP1    IFEQ *BLANKS                                   CFT014
     C           RRP23     ANDNE*BLANKS                                   CFT014
     C           WSRRP2    OREQ *BLANKS                                   CFT014
     C           WSRRP3    ANDNE*BLANKS                                   CFT014
     C                     MOVE 'Y'       E#MSGS                          CFT014
     C                     MOVEL'FTM5017' FTMSID                          CFT014
     C                     MOVE E#CPGM    FTPGMQ                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVEL'Y'       I3RRPT                          CFT014
     C                     MOVE 'Y'       E#NOUP                          CFT014
     C                     GOTO EXRRPT                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** If Pos. 1-10 of the 1st line is not '/ORDERRES' or               CFT014
      ** '/BENEFRES', accept free format text.                            CFT014
      *                                                                   CFT014
     C           RR1X10    IFNE CORDER                                    CFT014
     C           RR1X10    ANDNECBENEF                                    CFT014
      *                                                                   CFT014
     C           WSRRP1    IFNE *BLANKS                                   CFT014
     C                     MOVEL*BLANKS   I#FLD                           CFT014
     C                     MOVELWSRRP1    I#FLD                           CFT014
     C                     EXSR SWSET                                     CFT014
     C           *IN94     IFEQ *ON                                       CFT014
     C                     MOVE 'Y'       E#MSGS                          CFT014
     C                     MOVEL'FTM5018' FTMSID                          CFT014
     C                     MOVE E#CPGM    FTPGMQ                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVE 'Y'       I3RRP1                          CFT014
     C                     MOVE 'Y'       E#NOUP                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           WSRRP2    IFNE *BLANKS                                   CFT014
     C                     MOVEL*BLANKS   I#FLD                           CFT014
     C                     MOVELWSRRP2    I#FLD                           CFT014
     C                     EXSR SWSET                                     CFT014
     C           *IN94     IFEQ *ON                                       CFT014
     C                     MOVE 'Y'       E#MSGS                          CFT014
     C                     MOVEL'FTM5018' FTMSID                          CFT014
     C                     MOVE E#CPGM    FTPGMQ                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVE 'Y'       I3RRP2                          CFT014
     C                     MOVE 'Y'       E#NOUP                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           WSRRP3    IFNE *BLANKS                                   CFT014
     C                     MOVEL*BLANKS   I#FLD                           CFT014
     C                     MOVELWSRRP3    I#FLD                           CFT014
     C                     EXSR SWSET                                     CFT014
     C           *IN94     IFEQ *ON                                       CFT014
     C                     MOVE 'Y'       E#MSGS                          CFT014
     C                     MOVEL'FTM5018' FTMSID                          CFT014
     C                     MOVE E#CPGM    FTPGMQ                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVE 'Y'       I3RRP3                          CFT014
     C                     MOVE 'Y'       E#NOUP                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     GOTO EXRRPT                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Pos. 11-12 should contain a live ISO Coutry Code in              CFT014
      ** Country Codes file for codewords '/ORDERRES/' and                CFT014
      ** '/BENEFRES/'.                                                    CFT014
      *                                                                   CFT014
     C           RR1X2A    CHAINSDCTRYL2             90                   CFT014
     C           *IN90     IFEQ *ON                                       CFT014
     C                     MOVE 'Y'       E#MSGS                          CFT014
     C                     MOVEL'FTM5019' FTMSID                          CFT014
     C                     MOVELRR1X2A    FTMSDT                          CFT014
     C                     MOVE E#CPGM    FTPGMQ                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVE 'Y'       I3RRP1                          CFT014
     C                     MOVE 'Y'       E#NOUP                          CFT014
     C                     GOTO EXRRPT                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Validate additional information.                                 CFT014
      *                                                                   CFT014
     C           RR1X23    IFNE *BLANKS                                   CFT014
      *                                                                   CFT014
     C                     SELEC                                          CFT014
      *                                                                   CFT014
      ** Positions 13-14 should be '//'.                                  CFT014
      *                                                                   CFT014
     C           RR1X2B    WHNE '//'                                      CFT014
     C                     MOVE 'Y'       E#MSGS                          CFT014
     C                     MOVEL'FTM5020' FTMSID                          CFT014
     C                     MOVE E#CPGM    FTPGMQ                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVE 'Y'       I3RRP1                          CFT014
     C                     MOVE 'Y'       E#NOUP                          CFT014
     C                     GOTO EXRRPT                                    CFT014
      *                                                                   CFT014
      ** Additional info must be supplied after '//'.         '           CFT014
      *                                                                   CFT014
     C           RR1X2B    WHEQ '//'                                      CFT014
     C           RR1X21    ANDEQ*BLANKS                                   CFT014
     C                     MOVE 'Y'       E#MSGS                          CFT014
     C                     MOVEL'FTM5021' FTMSID                          CFT014
     C                     MOVE E#CPGM    FTPGMQ                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVE 'Y'       I3RRP1                          CFT014
     C                     MOVE 'Y'       E#NOUP                          CFT014
     C                     GOTO EXRRPT                                    CFT014
      *                                                                   CFT014
      ** Additional info in pos. 15-35 must be valid SWIFT characters.    CFT014
      *                                                                   CFT014
     C                     OTHER                                          CFT014
     C                     MOVEL*BLANKS   I#FLD                           CFT014
     C                     MOVELRR1X21    I#FLD                           CFT014
     C                     EXSR SWSET                                     CFT014
     C           *IN94     IFEQ *ON                                       CFT014
     C                     MOVE 'Y'       E#MSGS                          CFT014
     C                     MOVEL'FTM5022' FTMSID                          CFT014
     C                     MOVE E#CPGM    FTPGMQ                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVE 'Y'       I3RRP1                          CFT014
     C                     MOVE 'Y'       E#NOUP                          CFT014
     C                     GOTO EXRRPT                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDSL                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Validate 2nd line of Regulatory Reporting if not blank.          CFT014
      *                                                                   CFT014
     C           WSRRP2    IFNE *BLANKS                                   CFT014
      *                                                                   CFT014
     C                     SELEC                                          CFT014
      *                                                                   CFT014
      ** First 2 positions should be '//'.                                CFT014
      *                                                                   CFT014
     C           RR2X2A    WHNE '//'                                      CFT014
     C                     MOVE 'Y'       E#MSGS                          CFT014
     C                     MOVEL'FTM5023' FTMSID                          CFT014
     C                     MOVE E#CPGM    FTPGMQ                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVE 'Y'       I3RRP2                          CFT014
     C                     MOVE 'Y'       E#NOUP                          CFT014
     C                     GOTO EXRRPT                                    CFT014
      *                                                                   CFT014
      ** Additional info is required after '//'.                          CFT014
      *                                                                   CFT014
     C           RR2X2A    WHEQ '//'                                      CFT014
     C           RR2X33    ANDEQ*BLANKS                                   CFT014
     C                     MOVE 'Y'       E#MSGS                          CFT014
     C                     MOVEL'FTM5024' FTMSID                          CFT014
     C                     MOVE E#CPGM    FTPGMQ                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVE 'Y'       I3RRP2                          CFT014
     C                     MOVE 'Y'       E#NOUP                          CFT014
     C                     GOTO EXRRPT                                    CFT014
      *                                                                   CFT014
      ** Additional info must be valid SWIFT characters.                  CFT014
      *                                                                   CFT014
     C                     OTHER                                          CFT014
     C                     MOVEL*BLANKS   I#FLD                           CFT014
     C                     MOVELRR2X33    I#FLD                           CFT014
     C                     EXSR SWSET                                     CFT014
     C           *IN94     IFEQ *ON                                       CFT014
     C                     MOVE 'Y'       E#MSGS                          CFT014
     C                     MOVEL'FTM5025' FTMSID                          CFT014
     C                     MOVE E#CPGM    FTPGMQ                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVE 'Y'       I3RRP2                          CFT014
     C                     MOVE 'Y'       E#NOUP                          CFT014
     C                     GOTO EXRRPT                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDSL                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Validate 3rd line of Regulatory Reporting if not blank.          CFT014
      *                                                                   CFT014
     C           WSRRP3    IFNE *BLANKS                                   CFT014
      *                                                                   CFT014
     C                     SELEC                                          CFT014
      *                                                                   CFT014
      ** First 2 position should be '//'.                                 CFT014
      *                                                                   CFT014
     C           RR3X2A    WHNE '//'                                      CFT014
     C                     MOVE 'Y'       E#MSGS                          CFT014
     C                     MOVEL'FTM5026' FTMSID                          CFT014
     C                     MOVE E#CPGM    FTPGMQ                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVE 'Y'       I3RRP3                          CFT014
     C                     MOVE 'Y'       E#NOUP                          CFT014
     C                     GOTO EXRRPT                                    CFT014
      *                                                                   CFT014
      ** Additional info is required after '//'.                          CFT014
      *                                                                   CFT014
     C           RR3X2A    WHEQ '//'                                      CFT014
     C           RR3X33    ANDEQ*BLANKS                                   CFT014
     C                     MOVE 'Y'       E#MSGS                          CFT014
     C                     MOVEL'FTM5027' FTMSID                          CFT014
     C                     MOVE E#CPGM    FTPGMQ                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVE 'Y'       I3RRP3                          CFT014
     C                     MOVE 'Y'       E#NOUP                          CFT014
     C                     GOTO EXRRPT                                    CFT014
      *                                                                   CFT014
      ** Additional info must be valid SWIFT characters.                  CFT014
      *                                                                   CFT014
     C                     OTHER                                          CFT014
     C                     MOVEL*BLANKS   I#FLD                           CFT014
     C                     MOVELRR3X33    I#FLD                           CFT014
     C                     EXSR SWSET                                     CFT014
     C           *IN94     IFEQ *ON                                       CFT014
     C                     MOVE 'Y'       E#MSGS                          CFT014
     C                     MOVEL'FTM5028' FTMSID                          CFT014
     C                     MOVE E#CPGM    FTPGMQ                          CFT014
     C                     EXSR FTSNMS                                    CFT014
     C                     MOVE 'Y'       I3RRP3                          CFT014
     C                     MOVE 'Y'       E#NOUP                          CFT014
     C                     GOTO EXRRPT                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDSL                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Unwind subroutine stack name.                                    CFT014
      *                                                                   CFT014
     C           EXRRPT    TAG                                            CFT014
     C                     MOVEA*BLANKS   @STK,Q                          CFT014
     C                     SUB  1         Q                               CFT014
      *                                                                   CFT014
     CSR                   ENDSR                                          CFT014
      *                                                                   CFT014
     C/EJECT                                                              CFT014
      *****************************************************************   CFT014
      *****************************************************************   CFT014
      ***SRDETC***:*Validate*Details*Of*Charges************************   CFT014
      *****************************************************************   CFT014
      ***CALLED*BY:*SRPROC*-*Control*Process*of*Validation*************   CFT014
      *****************************************************************   CFT014
      ***CALLS****:********-*******************************************   CFT014
      *****************************************************************   CFT014
      *****************************************************************   CFT014
     C***SR******SRDETC    BEGSR                                          CFT014
      ***********                                                         CFT014
      ***Set*up*subroutine*stack*name**********************************   CFT014
      ***********                                                         CFT014
     C***********          ADD  1         Q       50                      CFT014
     C***********          MOVEL'SRDETC'  @STK,Q                          CFT014
      ***********                                                         CFT014
      ***/COPY*Statement***********************************************   CFT014
      ***********                                                         CFT014
     C***/COPY*WNCPYSRC,FT0358DETC                                        CFT014
      ***********                                                         CFT014
      ***Details*of*Charges*optional,*Defaults*to*BEN******************   CFT014
      ***********                                                         CFT014
     C***********S3DETC    IFEQ *BLANKS                                   CFT014
     C***********          MOVE 'BEN'     S3DETC                          CFT014
     C***********          ELSE                                           CFT014
      ***********                                                         CFT014
      ****Valid*entries*are*'OUR'*or*'BEN'*****************************   CFT014
      ***********                                                         CFT014
     C***********S3DETC    IFNE 'OUR'                                     CFT014
     C***********S3DETC    ANDNE'BEN'                                     CFT014
     C***********          MOVEL'Y'       E#MSGS                          CFT014
     C***********          MOVELS3DETC    FTMSDT                          CFT014
     C***********          MOVELE#CPGM    FTPGMQ                          CFT014
     C***********          MOVEL'FTM2078' FTMSID                          CFT014
     C***********          EXSR FTSNMS                                    CFT014
     C***********          MOVEL'Y'       I3DETC                          CFT014
     C***********          MOVEL'Y'       E#NOUP                          CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
      ***Unwind*subroutine*stack*name**********************************   CFT014
      ***********                                                         CFT014
     C***********EXDETC    TAG                                            CFT014
     C***********          MOVEA*BLANKS   @STK,Q                          CFT014
     C***********          SUB  1         Q                               CFT014
      ***********                                                         CFT014
     C***SR******          ENDSR                                          CFT014
     C***/EJECT**                                                         CFT014
      *****************************************************************   CFT014
      *****************************************************************   CFT014
      ***SRCCCY***:*Get*Currency*information*for*Charge*amount*val'n***   CFT014
      *****************************************************************   CFT014
      ***CALLED*BY:*SRPROC*-*Control*Process*of*Validation*************   CFT014
      *****************************************************************   CFT014
      ***CALLS****:********-*******************************************   CFT014
      *****************************************************************   CFT014
      *****************************************************************   CFT014
     C***SR******SRCCCY    BEGSR                                          CFT014
      ***********                                                         CFT014
      ***Set*up*subroutine*stack*name**********************************   CFT014
      ***********                                                         CFT014
     C***********          ADD  1         Q       50                      CFT014
     C***********          MOVEL'SRCCCY'  @STK,Q                          CFT014
      ***********                                                         CFT014
      ***/COPY*Statement***********************************************   CFT014
      ***********                                                         CFT014
     C***/COPY*WNCPYSRC,FT0358CCCY                                        CFT014
      ***********                                                         CFT014
      ***Access*currency*record****************************************   CFT014
      ***********                                                         CFT014
     C***********          CALL 'AOCURRR0'             9090               CFT014
     C***********          PARM           @RTCD   7                       CFT014
     C***********          PARM '*KEY   ' @OPTN   7                       CFT014
     C***********          PARM V#CCCY    @CCY    3                       CFT014
     C***********SDCURR    PARM *BLANKS   DSSDY                           CFT014
      ***********                                                         CFT014
      **Option*ended*in*error******************************************   CFT014
      ***********                                                         CFT014
     C************IN90     IFEQ '1'                        *IF            CFT014
     C***********@RTCD     ORNE *BLANKS                    *IF            CFT014
     C***********          MOVEL'AOCURRR0'W0FILE          *************** CFT014
     C***********          MOVEL'*CALL'   W0KEY           * DB ERROR 01 * CFT014
     C***********          Z-ADD1         W0ERNB          *************** CFT014
     C***********          MOVEL'MEM5003' W0MSGD                          CFT014
     C***********          MOVEL'MIDAS  ' W0MSGF                          CFT014
     C***********          EXSR SRERR                                     CFT014
     C***********          END                             *FI            CFT014
      ***********                                                         CFT014
      ***Unwind*subroutine*stack*name**********************************   CFT014
      ***********                                                         CFT014
     C***********EXCCCY    TAG                                            CFT014
     C***********          MOVEA*BLANKS   @STK,Q                          CFT014
     C***********          SUB  1         Q                               CFT014
      ***********                                                         CFT014
     C***SR******          ENDSR                                          CFT014
     C***/EJECT**                                                         CFT014
      *****************************************************************   CFT014
      *****************************************************************   CFT014
      ***SRTRCM***:*Validate*Transfer*Commission*Charge****************   CFT014
      *****************************************************************   CFT014
      ***CALLED*BY:*SRPROC*-*Control*Process*of*Validation*************   CFT014
      *****************************************************************   CFT014
      ***CALLS****:********-*******************************************   CFT014
      *****************************************************************   CFT014
      *****************************************************************   CFT014
     C***SR******SRTRCM    BEGSR                                          CFT014
      ***********                                                         CFT014
      ***Set*up*subroutine*stack*name**********************************   CFT014
      ***********                                                         CFT014
     C***********          ADD  1         Q       50                      CFT014
     C***********          MOVEL'SRTRCM'  @STK,Q                          CFT014
      ***********                                                         CFT014
      ***/COPY*Statement***********************************************   CFT014
      ***********                                                         CFT014
     C***/COPY*WNCPYSRC,FT0358TRCM                                        CFT014
      ***********                                                         CFT014
      ***Transfer*Commission*Charge************************************   CFT014
      ***--------------------------************************************   CFT014
      ***Transfer*Commission*is*optional.******************************   CFT014
      ***If*entered*must*be*valid*for*charge*currency*details**********   CFT014
      ***********                                                         CFT014
     C***********          Z-ADD0         F3TRCD                          CFT014
     C***********          Z-ADD0         F3TRCM                          CFT014
      ***********                                                         CFT014
     C***********S3TRCD    IFNE *BLANKS                                   CFT014
      ***********                                                         CFT014
     C***********11        SUB  A6NBDP    ZADIG                           CFT014
     C***********          Z-ADDA6NBDP    ZADEC                           CFT014
     C***********          MOVEL*BLANKS   ZFIELD                          CFT014
     C***********          MOVELS3TRCD    ZFIELD                          CFT014
      ***********                                                         CFT014
     C***********          EXSR SRALGN                                    CFT014
      ***********                                                         CFT014
     C***********ZRTN      IFEQ '*ERROR*'                                 CFT014
     C***********          MOVEL'Y'       E#MSGS                          CFT014
     C***********S3TRCD    CAT  V#CCCY    FTMSDT    P                     CFT014
     C***********          MOVELE#CPGM    FTPGMQ                          CFT014
     C***********          MOVEL'FTM2078' FTMSID                          CFT014
     C***********          EXSR FTSNMS                                    CFT014
     C***********          MOVEL'Y'       I3TRCM                          CFT014
     C***********          MOVEL'Y'       E#NOUP                          CFT014
     C***********          ELSE                                           CFT014
     C***********          MOVE ZFIELD    F3TRCD                          CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
      ***Unwind*subroutine*stack*name**********************************   CFT014
      ***********                                                         CFT014
     C***********EXTRCM    TAG                                            CFT014
     C***********          MOVEA*BLANKS   @STK,Q                          CFT014
     C***********          SUB  1         Q                               CFT014
      ***********                                                         CFT014
     C***SR******          ENDSR                                          CFT014
     C***/EJECT**                                                         CFT014
      *****************************************************************   CFT014
      *****************************************************************   CFT014
      ***SRTXCH***:*Validate*Telex*Charges*****************************   CFT014
      *****************************************************************   CFT014
      ***CALLED*BY:*SRPROC*-*Control*Process*of*Validation*************   CFT014
      *****************************************************************   CFT014
      ***CALLS****:********-*******************************************   CFT014
      *****************************************************************   CFT014
      *****************************************************************   CFT014
     C***SR******SRTXCH    BEGSR                                          CFT014
      ***********                                                         CFT014
      ***Set*up*subroutine*stack*name**********************************   CFT014
      ***********                                                         CFT014
     C***********          ADD  1         Q       50                      CFT014
     C***********          MOVEL'SRTXCH'  @STK,Q                          CFT014
      ***********                                                         CFT014
      ***/COPY*Statement***********************************************   CFT014
      ***********                                                         CFT014
     C***/COPY*WNCPYSRC,FT0358TXCH                                        CFT014
      ***********                                                         CFT014
      ***Telex*Charge*is*optional.*************************************   CFT014
      ***If*entered*must*be*valid*for*charge*currency*details**********   CFT014
      ***********                                                         CFT014
     C***********          Z-ADD0         F3TXCD                          CFT014
     C***********          Z-ADD0         F3TXCH                          CFT014
      ***********                                                         CFT014
     C***********S3TXCD    IFNE *BLANKS                                   CFT014
      ***********                                                         CFT014
     C***********11        SUB  A6NBDP    ZADIG                           CFT014
     C***********          Z-ADDA6NBDP    ZADEC                           CFT014
     C***********          MOVEL*BLANKS   ZFIELD                          CFT014
     C***********          MOVELS3TXCD    ZFIELD                          CFT014
     C***********          EXSR SRALGN                                    CFT014
      ***********                                                         CFT014
     C***********ZRTN      IFEQ '*ERROR*'                                 CFT014
     C***********          MOVEL'Y'       E#MSGS                          CFT014
     C***********S3TXCD    CAT  V#CCCY    FTMSDT    P                     CFT014
     C***********          MOVELE#CPGM    FTPGMQ                          CFT014
     C***********          MOVEL'FTM2102' FTMSID                          CFT014
     C***********          EXSR FTSNMS                                    CFT014
     C***********          MOVEL'Y'       I3TXCH                          CFT014
     C***********          MOVEL'Y'       E#NOUP                          CFT014
     C***********          ELSE                                           CFT014
     C***********          MOVE ZFIELD    F3TXCD                          CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
      ***Unwind*subroutine*stack*name**********************************   CFT014
      ***********                                                         CFT014
     C***********EXTXCH    TAG                                            CFT014
     C***********          MOVEA*BLANKS   @STK,Q                          CFT014
     C***********          SUB  1         Q                               CFT014
      ***********                                                         CFT014
     C***SR******          ENDSR                                          CFT014
     C***/EJECT**                                                         CFT014
      *****************************************************************   CFT014
      *****************************************************************   CFT014
      ***SRCQCH***:*Validate*Cheque*Charges****************************   CFT014
      *****************************************************************   CFT014
      ***CALLED*BY:*SRPROC*-*Control*Process*of*Validation*************   CFT014
      *****************************************************************   CFT014
      ***CALLS****:********-*******************************************   CFT014
      *****************************************************************   CFT014
      *****************************************************************   CFT014
     C***SR******SRCQCH    BEGSR                                          CFT014
      ***********                                                         CFT014
      ***Set*up*subroutine*stack*name**********************************   CFT014
      ***********                                                         CFT014
     C***********          ADD  1         Q       50                      CFT014
     C***********          MOVEL'SRCQCH'  @STK,Q                          CFT014
      ***********                                                         CFT014
      ***/COPY*Statement***********************************************   CFT014
      ***********                                                         CFT014
     C***/COPY*WNCPYSRC,FT0358CQCH                                        CFT014
      ***********                                                         CFT014
      ***Cheque*Charge*is*optional.************************************   CFT014
      ***If*entered*must*be*valid*for*charge*currency*details**********   CFT014
      ***********                                                         CFT014
     C***********          Z-ADD0         F3CQCD                          CFT014
     C***********          Z-ADD0         F3CQCH                          CFT014
      ***********                                                         CFT014
     C***********S3CQCD    IFNE *BLANKS                                   CFT014
      ***********                                                         CFT014
     C***********11        SUB  A6NBDP    ZADIG                           CFT014
     C***********          Z-ADDA6NBDP    ZADEC                           CFT014
     C***********          MOVEL*BLANKS   ZFIELD                          CFT014
     C***********          MOVELS3CQCD    ZFIELD                          CFT014
     C***********          EXSR SRALGN                                    CFT014
      ***********                                                         CFT014
     C***********ZRTN      IFEQ '*ERROR*'                                 CFT014
     C***********          MOVEL'Y'       E#MSGS                          CFT014
     C***********S3CQCD    CAT  V#CCCY    FTMSDT    P                     CFT014
     C***********          MOVELE#CPGM    FTPGMQ                          CFT014
     C***********          MOVEL'FTM2103' FTMSID                          CFT014
     C***********          EXSR FTSNMS                                    CFT014
     C***********          MOVEL'Y'       I3CQCH                          CFT014
     C***********          MOVEL'Y'       E#NOUP                          CFT014
     C***********          ELSE                                           CFT014
     C***********          MOVE ZFIELD    F3CQCD                          CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
      ***Unwind*subroutine*stack*name**********************************   CFT014
      ***********                                                         CFT014
     C***********EXCQCH    TAG                                            CFT014
     C***********          MOVEA*BLANKS   @STK,Q                          CFT014
     C***********          SUB  1         Q                               CFT014
      ***********                                                         CFT014
     C***SR******          ENDSR                                          CFT014
     C***/EJECT**                                                         CFT014
      *****************************************************************   CFT014
      *****************************************************************   CFT014
      ***SRADCH***:*Validate*Advice*Charges****************************   CFT014
      *****************************************************************   CFT014
      ***CALLED*BY:*SRPROC*-*Control*Process*of*Validation*************   CFT014
      *****************************************************************   CFT014
      ***CALLS****:********-*******************************************   CFT014
      *****************************************************************   CFT014
      *****************************************************************   CFT014
     C***SR******SRADCH    BEGSR                                          CFT014
      ***********                                                         CFT014
      ***Set*up*subroutine*stack*name**********************************   CFT014
      ***********                                                         CFT014
     C***********          ADD  1         Q       50                      CFT014
     C***********          MOVEL'SRADCH'  @STK,Q                          CFT014
      ***********                                                         CFT014
      ***/COPY*Statement***********************************************   CFT014
      ***********                                                         CFT014
     C***/COPY*WNCPYSRC,FT0358ADCH                                        CFT014
      ***********                                                         CFT014
      ***Advice*Charge*is*optional.************************************   CFT014
      ***If*entered*must*be*valid*for*charge*currency*details**********   CFT014
      ***********                                                         CFT014
     C***********          Z-ADD0         F3ADCD                          CFT014
     C***********          Z-ADD0         F3ADCH                          CFT014
      ***********                                                         CFT014
     C***********S3ADCD    IFNE *BLANKS                                   CFT014
      ***********                                                         CFT014
     C***********11        SUB  A6NBDP    ZADIG                           CFT014
     C***********          Z-ADDA6NBDP    ZADEC                           CFT014
     C***********          MOVEL*BLANKS   ZFIELD                          CFT014
     C***********          MOVELS3ADCD    ZFIELD                          CFT014
     C***********          EXSR SRALGN                                    CFT014
      ***********                                                         CFT014
     C***********ZRTN      IFEQ '*ERROR*'                                 CFT014
     C***********          MOVEL'Y'       E#MSGS                          CFT014
     C***********S3ADCD    CAT  V#CCCY    FTMSDT    P                     CFT014
     C***********          MOVELE#CPGM    FTPGMQ                          CFT014
     C***********          MOVEL'FTM2104' FTMSID                          CFT014
     C***********          EXSR FTSNMS                                    CFT014
     C***********          MOVEL'Y'       I3ADCH                          CFT014
     C***********          MOVEL'Y'       E#NOUP                          CFT014
     C***********          ELSE                                           CFT014
     C***********          MOVE ZFIELD    F3ADCD                          CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
      ***Unwind*subroutine*stack*name**********************************   CFT014
      ***********                                                         CFT014
     C***********EXADCH    TAG                                            CFT014
     C***********          MOVEA*BLANKS   @STK,Q                          CFT014
     C***********          SUB  1         Q                               CFT014
      ***********                                                         CFT014
     C***SR******          ENDSR                                          CFT014
     C***/EJECT**                                                         CFT014
      *****************************************************************   CFT014
      *****************************************************************   CFT014
      ***SRTLCH***:*Validate*Telephone*Charge**************************   CFT014
      *****************************************************************   CFT014
      ***CALLED*BY:*SRPROC*-*Control*Process*of*Validation*************   CFT014
      *****************************************************************   CFT014
      ***CALLS****:********-*******************************************   CFT014
      *****************************************************************   CFT014
      *****************************************************************   CFT014
     C***SR******SRTLCH    BEGSR                                          CFT014
      ***********                                                         CFT014
      ***Set*up*subroutine*stack*name**********************************   CFT014
      ***********                                                         CFT014
     C***********          ADD  1         Q       50                      CFT014
     C***********          MOVEL'SRTLCH'  @STK,Q                          CFT014
      ***********                                                         CFT014
      ***/COPY*Statement***********************************************   CFT014
      ***********                                                         CFT014
     C***/COPY*WNCPYSRC,FT0358TLCH                                        CFT014
      ***********                                                         CFT014
      ***Telephone*Charge*is*optional.*********************************   CFT014
      ***If*entered*must*be*valid*for*charge*currency*details**********   CFT014
      ***********                                                         CFT014
     C***********          Z-ADD0         F3TLCD                          CFT014
     C***********          Z-ADD0         F3TLCH                          CFT014
      ***********                                                         CFT014
     C***********S3TLCD    IFNE *BLANKS                                   CFT014
      ***********                                                         CFT014
     C***********11        SUB  A6NBDP    ZADIG                           CFT014
     C***********          Z-ADDA6NBDP    ZADEC                           CFT014
     C***********          MOVEL*BLANKS   ZFIELD                          CFT014
     C***********          MOVELS3TLCD    ZFIELD                          CFT014
     C***********          EXSR SRALGN                                    CFT014
      ***********                                                         CFT014
     C***********ZRTN      IFEQ '*ERROR*'                                 CFT014
     C***********          MOVEL'Y'       E#MSGS                          CFT014
     C***********S3TLCD    CAT  V#CCCY    FTMSDT    P                     CFT014
     C***********          MOVELE#CPGM    FTPGMQ                          CFT014
     C***********          MOVEL'FTM2105' FTMSID                          CFT014
     C***********          EXSR FTSNMS                                    CFT014
     C***********          MOVEL'Y'       I3TLCH                          CFT014
     C***********          MOVEL'Y'       E#NOUP                          CFT014
     C***********          ELSE                                           CFT014
     C***********          MOVE ZFIELD    F3TLCD                          CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
     C***********          END                                            CFT014
      ***********                                                  S01408 CFT014
     C***/COPY*WNCPYSRC,FT0358CCP2                                 S01408 CFT014
      ***********                                                  S01408 CFT014
      ***********                                                         CFT014
      ***Unwind*subroutine*stack*name**********************************   CFT014
      ***********                                                         CFT014
     C***********EXTLCH    TAG                                            CFT014
     C***********          MOVEA*BLANKS   @STK,Q                          CFT014
     C***********          SUB  1         Q                               CFT014
      ***********                                                         CFT014
     C***SR******          ENDSR                                          CFT014
     C***/EJECT**                                                         CFT014
      *****************************************************************   CFT014
      *****************************************************************   CFT014
      ***SRMSCH***:*Validate*Miscellaneous*Charges*********************   CFT014
      *****************************************************************   CFT014
      ***CALLED*BY:*SRPROC*-*Control*Process*of*Validation*************   CFT014
      *****************************************************************   CFT014
      ***CALLS****:********-*******************************************   CFT014
      *****************************************************************   CFT014
      *****************************************************************   CFT014
     C***SR******SRMSCH    BEGSR                                          CFT014
      ***********                                                         CFT014
      ***Set*up*subroutine*stack*name**********************************   CFT014
      ***********                                                         CFT014
     C***********          ADD  1         Q       50                      CFT014
     C***********          MOVEL'SRMSCH'  @STK,Q                          CFT014
      ***********                                                         CFT014
      ***/COPY*Statement***********************************************   CFT014
      ***********                                                         CFT014
     C***/COPY*WNCPYSRC,FT0358MSCH                                        CFT014
      ***********                                                         CFT014
      ***Miscellaneous*Charge*is*optional.*****************************   CFT014
      ***If*entered*must*be*valid*for*charge*currency*details**********   CFT014
      ***********                                                         CFT014
     C***********          Z-ADD0         F3MSCD                          CFT014
     C***********          Z-ADD0         F3MSCH                          CFT014
      ***********                                                         CFT014
     C***********S3MSCD    IFNE *BLANKS                                   CFT014
      ***********                                                         CFT014
     C***********11        SUB  A6NBDP    ZADIG                           CFT014
     C***********          Z-ADDA6NBDP    ZADEC                           CFT014
     C***********          MOVEL*BLANKS   ZFIELD                          CFT014
     C***********          MOVELS3MSCD    ZFIELD                          CFT014
     C***********          EXSR SRALGN                                    CFT014
      ***********                                                         CFT014
     C***********ZRTN      IFEQ '*ERROR*'                                 CFT014
     C***********          MOVEL'Y'       E#MSGS                          CFT014
     C***********S3MSCD    CAT  V#CCCY    FTMSDT    P                     CFT014
     C***********          MOVELE#CPGM    FTPGMQ                          CFT014
     C***********          MOVEL'FTM2106' FTMSID                          CFT014
     C***********          EXSR FTSNMS                                    CFT014
     C***********          MOVEL'Y'       I3MSCH                          CFT014
     C***********          MOVEL'Y'       E#NOUP                          CFT014
     C***********          ELSE                                           CFT014
     C***********          MOVE ZFIELD    F3MSCD                          CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
      ***Unwind*subroutine*stack*name**********************************   CFT014
      ***********                                                         CFT014
     C***********EXMSCH    TAG                                            CFT014
     C***********          MOVEA*BLANKS   @STK,Q                          CFT014
     C***********          SUB  1         Q                               CFT014
      ***********                                                         CFT014
     C***SR******          ENDSR                                          CFT014
     C***/EJECT**                                                  S01494 CFT014
     C************************************************************ S01494 CFT014
     C************************************************************ S01494 CFT014
     C***SRCHCM***:*Validate*FX/Change*Commission***************** S01494 CFT014
     C************************************************************ S01494 CFT014
     C***CALLED*BY:*SRPROC*-*Control*Process*of*Validation******** S01494 CFT014
     C************************************************************ S01494 CFT014
     C***CALLS****:********-************************************** S01494 CFT014
     C************************************************************ S01494 CFT014
     C************************************************************ S01494 CFT014
     C***SR******SRCHCM    BEGSR                                   S01494 CFT014
     C***********                                                  S01494 CFT014
     C***Set*up*subroutine*stack*name***************************** S01494 CFT014
     C***********                                                  S01494 CFT014
     C***********          ADD  1         Q       50               S01494 CFT014
     C***********          MOVEL'SRCHCM'  @STK,Q                   S01494 CFT014
     C***********                                                  S01494 CFT014
     C***FX/Change*commission*only*allowedifPayandSettlecurrencies S01494 CFT014
     C***are*different.**If*entered*must*be*validforchargecurrency S01494 CFT014
     C***details.************************************************* S01494 CFT014
     C***********                                                  S01494 CFT014
     C***********          Z-ADD0         F3CHCD                   S01494 CFT014
     C***********          Z-ADD0         F3CHCM                   S01494 CFT014
     C***********                                                  S01494 CFT014
      **If*EMU*FT*Enhancement*is*switched*on*then***************** CEU006 CFT014
      **save*work*date*parameter*for*call*to*FT0010*as*W#DT******* CEU006 CFT014
      ***********                                                  CEU006 CFT014
     C***********CEU006    IFEQ 'Y'                                CEU006 CFT014
     C************LIKE     DEFN V#SLDT    W#DT                     CEU006 CFT014
     C***********V#ADDC    IFEQ 'A'                                CEU006 CFT014
     C***********          Z-ADDV#SLDT    W#DT                     CEU006 CFT014
     C***********          ELSE                                    CEU006 CFT014
     C***********          Z-ADDV#PVDT    W#DT                     CEU006 CFT014
     C***********          ENDIF                                   CEU006 CFT014
     C***********          ENDIF                                   CEU006 CFT014
      ***********                                                  CEU006 CFT014
     C***********S3CHCD    IFNE *BLANKS                            S01494 CFT014
     C***********                                                  S01494 CFT014
     C***********V#SMCY    IFNE V#PCCY                             S01494 CFT014
     C***********                                                  CEU006 CFT014
     C**If*EMU*FT**Enhancement*is*switched*on********************* CEU006 CFT014
     C***and*both*Settle*Ccy*and*Pay*Ccy*are*either*'In'*or*Euros, CEU006 CFT014
     C***then*FX/Change*Commission*must*be*zero.****************** CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C***********CEU006    IFEQ 'Y'                                CEU006 CFT014
     C***********#INCYS    ANDEQ'Y'                                CEU006 CFT014
     C***********#TPSDS    ANDLEW#DT                               CEU006 CFT014
     C***********V#PCCY    ANDEQBKEURO                             CEU006 CFT014
     C***********CEU006    OREQ 'Y'                                CEU006 CFT014
     C***********#INCYP    ANDEQ'Y'                                CEU006 CFT014
     C***********#TPSDP    ANDLEW#DT                               CEU006 CFT014
     C***********V#SMCY    ANDEQBKEURO                             CEU006 CFT014
     C***********CEU006    OREQ 'Y'                                CEU006 CFT014
     C***********#INCYS    ANDEQ'Y'                                CEU006 CFT014
     C***********#TPSDS    ANDLEW#DT                               CEU006 CFT014
     C***********#INCYP    ANDEQ'Y'                                CEU006 CFT014
     C***********#TPSDP    ANDLEW#DT                               CEU006 CFT014
     C***********          MOVEL'Y'       E#MSGS                   CEU006 CFT014
     C***********          MOVEL*BLANKS   FTMSDT                   CEU006 CFT014
     C***********          MOVELE#CPGM    FTPGMQ                   CEU006 CFT014
     C***********          MOVEL'FTM2599' FTMSID                   CEU006 CFT014
     C***********          EXSR FTSNMS                             CEU006 CFT014
     C***********          MOVEL'Y'       I3CHCM                   CEU006 CFT014
     C***********          MOVEL'Y'       E#NOUP                   CEU006 CFT014
     C***********          ELSE                                    CEU006 CFT014
     C***********                                                  S01494 CFT014
     C***********11        SUB  A6NBDP    ZADIG                    S01494 CFT014
     C***********          Z-ADDA6NBDP    ZADEC                    S01494 CFT014
     C***********          MOVEL*BLANKS   ZFIELD                   S01494 CFT014
     C***********          MOVELS3CHCD    ZFIELD                   S01494 CFT014
     C***********          EXSR SRALGN                             S01494 CFT014
     C***********                                                  S01494 CFT014
     C***********ZRTN      IFEQ '*ERROR*'                          S01494 CFT014
     C***********          MOVEL'Y'       E#MSGS                   S01494 CFT014
     C***********S3CHCD    CAT  V#CCCY    FTMSDT    P              S01494 CFT014
     C***********          MOVELE#CPGM    FTPGMQ                   S01494 CFT014
     C***********          MOVEL'FTM2523' FTMSID                   S01494 CFT014
     C***********          EXSR FTSNMS                             S01494 CFT014
     C***********          MOVEL'Y'       I3CHCM                   S01494 CFT014
     C***********          MOVEL'Y'       E#NOUP                   S01494 CFT014
     C***********          ELSE                                    S01494 CFT014
     C***********          MOVE ZFIELD    F3CHCD                   S01494 CFT014
     C***********          END                                     S01494 CFT014
     C***********                                                  CEU006 CFT014
     C***********          ENDIF                                   CEU006 CFT014
     C***********                                                  S01494 CFT014
     C***********          ELSE                                    S01494 CFT014
     C***********          MOVEL'Y'       E#MSGS                   S01494 CFT014
     C***********          MOVEL*BLANKS   FTMSDT                   S01494 CFT014
     C***********          MOVELE#CPGM    FTPGMQ                   S01494 CFT014
     C***********          MOVEL'FTM2521' FTMSID                   S01494 CFT014
     C***********          EXSR FTSNMS                             S01494 CFT014
     C***********          MOVEL'Y'       I3CHCM                   S01494 CFT014
     C***********          MOVEL'Y'       E#NOUP                   S01494 CFT014
     C***********          END                                     S01494 CFT014
     C***********                                                  S01494 CFT014
     C***********          END                                     S01494 CFT014
     C***********                                                  S01494 CFT014
     C***Unwind*subroutine*stack*name***************************** S01494 CFT014
     C***********                                                  S01494 CFT014
     C***********EXCHCM    TAG                                     S01494 CFT014
     C***********          MOVEA*BLANKS   @STK,Q                   S01494 CFT014
     C***********          SUB  1         Q                        S01494 CFT014
     C***********                                                  S01494 CFT014
     C***SR******          ENDSR                                   S01494 CFT014
     C***/EJECT**                                                  S01499 CFT014
     C************************************************************ S01499 CFT014
     C************************************************************ S01499 CFT014
     C***SRVATT***:*Validate*V.A.T.*flags************************* S01499 CFT014
     C************************************************************ S01499 CFT014
     C***CALLED*BY:*SRPROC*-*Control*Process*of*Validation******** S01499 CFT014
     C************************************************************ S01499 CFT014
     C***CALLS****:********-************************************** S01499 CFT014
     C************************************************************ S01499 CFT014
     C************************************************************ S01499 CFT014
     C***SR******SRVATT    BEGSR                                   S01499 CFT014
     C***********                                                  S01499 CFT014
     C***Set*up*subroutine*stack*name***************************** S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********          ADD  1         Q       50               S01499 CFT014
     C***********          MOVEL'SRVATT'  @STK,Q                   S01499 CFT014
     C***********                                                  S01499 CFT014
     C***Apply*V.A.T.*flag*must*be*'Y'*or*'N'*or*blank.**If*blank, S01499 CFT014
     C***default*to*value*retrieved*from*program*FT0005.********** S01499 CFT014
     C***********                                                  S01499 CFT014
     C*********************MOVEL*BLANKS***@VCHG**20*************** S01499 CFT014
     C***********          MOVE @VAT,1    @VCHG                    S01499 S01499
     C***********          MOVE WVAT1     @VCHG                    S01499 CFT014
     C***********S3VAT1    IFEQ *BLANKS                            S01499 CFT014
     C***********          MOVELV#VATT    S3VAT1                   S01499 CFT014
     C***********          ELSE                                    S01499 CFT014
     C***********S3VAT1    IFNE 'Y'                                S01499 CFT014
     C***********S3VAT1    ANDNE'N'                                S01499 CFT014
     C***********          MOVEL'Y'       E#MSGS                   S01499 CFT014
     C***********S3VAT1    CAT  @VCHG     FTMSDT                   S01499 CFT014
     C***********          MOVELE#CPGM    FTPGMQ                   S01499 CFT014
     C***********          MOVEL'FTM2524' FTMSID                   S01499 CFT014
     C***********          EXSR FTSNMS                             S01499 CFT014
     C***********          MOVEL'Y'       I3VAT1                   S01499 CFT014
     C***********          MOVEL'Y'       E#NOUP                   S01499 CFT014
     C***********          END                                     S01499 CFT014
     C***********          END                                     S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********          MOVEL*BLANKS   @VCHG  20                S01499 CFT014
     C***********          MOVE @VAT,2    @VCHG                    S01499 S01499
     C***********          MOVE WVAT2     @VCHG                    S01499 CFT014
     C***********S3VAT2    IFEQ *BLANKS                            S01499 CFT014
     C***********          MOVELV#VATT    S3VAT2                   S01499 CFT014
     C***********          ELSE                                    S01499 CFT014
     C***********S3VAT2    IFNE 'Y'                                S01499 CFT014
     C***********S3VAT2    ANDNE'N'                                S01499 CFT014
     C***********          MOVEL'Y'       E#MSGS                   S01499 CFT014
     C***********S3VAT2    CAT  @VCHG     FTMSDT                   S01499 CFT014
     C***********          MOVELE#CPGM    FTPGMQ                   S01499 CFT014
     C***********          MOVEL'FTM2524' FTMSID                   S01499 CFT014
     C***********          EXSR FTSNMS                             S01499 CFT014
     C***********          MOVEL'Y'       I3VAT2                   S01499 CFT014
     C***********          MOVEL'Y'       E#NOUP                   S01499 CFT014
     C***********          END                                     S01499 CFT014
     C***********          END                                     S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********          MOVEL*BLANKS   @VCHG  20                S01499 CFT014
     C***********          MOVE @VAT,3    @VCHG                    S01499 S01499
     C***********          MOVE WVAT3     @VCHG                    S01499 CFT014
     C***********S3VAT3    IFEQ *BLANKS                            S01499 CFT014
     C***********          MOVELV#VATT    S3VAT3                   S01499 CFT014
     C***********          ELSE                                    S01499 CFT014
     C***********S3VAT3    IFNE 'Y'                                S01499 CFT014
     C***********S3VAT3    ANDNE'N'                                S01499 CFT014
     C***********          MOVEL'Y'       E#MSGS                   S01499 CFT014
     C***********S3VAT3    CAT  @VCHG     FTMSDT                   S01499 CFT014
     C***********          MOVELE#CPGM    FTPGMQ                   S01499 CFT014
     C***********          MOVEL'FTM2524' FTMSID                   S01499 CFT014
     C***********          EXSR FTSNMS                             S01499 CFT014
     C***********          MOVEL'Y'       I3VAT3                   S01499 CFT014
     C***********          MOVEL'Y'       E#NOUP                   S01499 CFT014
     C***********          END                                     S01499 CFT014
     C***********          END                                     S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********          MOVEL*BLANKS   @VCHG  20                S01499 CFT014
     C***********          MOVE @VAT,4    @VCHG                    S01499 S01499
     C***********          MOVE WVAT4     @VCHG                    S01499 CFT014
     C***********S3VAT4    IFEQ *BLANKS                            S01499 CFT014
     C***********          MOVELV#VATT    S3VAT4                   S01499 CFT014
     C***********          ELSE                                    S01499 CFT014
     C***********S3VAT4    IFNE 'Y'                                S01499 CFT014
     C***********S3VAT4    ANDNE'N'                                S01499 CFT014
     C***********          MOVEL'Y'       E#MSGS                   S01499 CFT014
     C***********S3VAT4    CAT  @VCHG     FTMSDT                   S01499 CFT014
     C***********          MOVELE#CPGM    FTPGMQ                   S01499 CFT014
     C***********          MOVEL'FTM2524' FTMSID                   S01499 CFT014
     C***********          EXSR FTSNMS                             S01499 CFT014
     C***********          MOVEL'Y'       I3VAT4                   S01499 CFT014
     C***********          MOVEL'Y'       E#NOUP                   S01499 CFT014
     C***********          END                                     S01499 CFT014
     C***********          END                                     S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********          MOVEL*BLANKS   @VCHG  20                S01499 CFT014
     C***********          MOVE @VAT,5    @VCHG                    S01499 S01499
     C***********          MOVE WVAT5     @VCHG                    S01499 CFT014
     C***********S3VAT5    IFEQ *BLANKS                            S01499 CFT014
     C***********          MOVELV#VATT    S3VAT5                   S01499 CFT014
     C***********          ELSE                                    S01499 CFT014
     C***********S3VAT5    IFNE 'Y'                                S01499 CFT014
     C***********S3VAT5    ANDNE'N'                                S01499 CFT014
     C***********          MOVEL'Y'       E#MSGS                   S01499 CFT014
     C***********S3VAT5    CAT  @VCHG     FTMSDT                   S01499 CFT014
     C***********          MOVELE#CPGM    FTPGMQ                   S01499 CFT014
     C***********          MOVEL'FTM2524' FTMSID                   S01499 CFT014
     C***********          EXSR FTSNMS                             S01499 CFT014
     C***********          MOVEL'Y'       I3VAT5                   S01499 CFT014
     C***********          MOVEL'Y'       E#NOUP                   S01499 CFT014
     C***********          END                                     S01499 CFT014
     C***********          END                                     S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********          MOVEL*BLANKS   @VCHG  20                S01499 CFT014
     C***********          MOVE @VAT,6    @VCHG                    S01499 S01499
     C***********          MOVE WVAT6     @VCHG                    S01499 CFT014
     C***********S3VAT6    IFEQ *BLANKS                            S01499 CFT014
     C***********          MOVELV#VATT    S3VAT6                   S01499 CFT014
     C***********          ELSE                                    S01499 CFT014
     C***********S3VAT6    IFNE 'Y'                                S01499 CFT014
     C***********S3VAT6    ANDNE'N'                                S01499 CFT014
     C***********          MOVEL'Y'       E#MSGS                   S01499 CFT014
     C***********S3VAT6    CAT  @VCHG     FTMSDT                   S01499 CFT014
     C***********          MOVELE#CPGM    FTPGMQ                   S01499 CFT014
     C***********          MOVEL'FTM2524' FTMSID                   S01499 CFT014
     C***********          EXSR FTSNMS                             S01499 CFT014
     C***********          MOVEL'Y'       I3VAT6                   S01499 CFT014
     C***********          MOVEL'Y'       E#NOUP                   S01499 CFT014
     C***********          END                                     S01499 CFT014
     C***********          END                                     S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********          MOVEL*BLANKS   @VCHG  20                S01499 CFT014
     C***********          MOVE @VAT,7    @VCHG                    S01499 S01499
     C***********          MOVE WVAT7     @VCHG                    S01499 CFT014
     C***********S3VAT7    IFEQ *BLANKS                            S01499 CFT014
     C***********          MOVELV#VATT    S3VAT7                   S01499 CFT014
     C***********          ELSE                                    S01499 CFT014
     C***********S3VAT7    IFNE 'Y'                                S01499 CFT014
     C***********S3VAT7    ANDNE'N'                                S01499 CFT014
     C***********          MOVEL'Y'       E#MSGS                   S01499 CFT014
     C***********S3VAT7    CAT  @VCHG     FTMSDT                   S01499 CFT014
     C***********          MOVELE#CPGM    FTPGMQ                   S01499 CFT014
     C***********          MOVEL'FTM2524' FTMSID                   S01499 CFT014
     C***********          EXSR FTSNMS                             S01499 CFT014
     C***********          MOVEL'Y'       I3VAT7                   S01499 CFT014
     C***********          MOVEL'Y'       E#NOUP                   S01499 CFT014
     C***********          END                                     S01499 CFT014
     C***********          END                                     S01499 CFT014
     C***********                                                  S01499 CFT014
     C***Unwind*subroutine*stack*name***************************** S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********EXVATT    TAG                                     S01499 CFT014
     C***********          MOVEA*BLANKS   @STK,Q                   S01499 CFT014
     C***********          SUB  1         Q                        S01499 CFT014
     C***********                                                  S01499 CFT014
     C***SR******          ENDSR                                   S01499 CFT014
     C***/EJECT**                                                         CFT014
      *****************************************************************   CFT014
      *****************************************************************   CFT014
      ***SRTOT****:*Check*Total*Charges*Do*Not*Exceed*Payment*Amount***   CFT014
      *****************************************************************   CFT014
      ***CALLED*BY:*SRPROC*-*Control*Process*of*Validation*************   CFT014
      *****************************************************************   CFT014
      ***CALLS****:********-*******************************************   CFT014
      *****************************************************************   CFT014
      *****************************************************************   CFT014
     C***SR******SRTOT     BEGSR                                          CFT014
      ***********                                                         CFT014
      ***Set*up*subroutine*stack*name**********************************   CFT014
      ***********                                                         CFT014
     C***********          ADD  1         Q       50                      CFT014
     C***********          MOVEL'SRTOT '  @STK,Q                          CFT014
      ***********                                                         CFT014
      ***/COPY*Statement***********************************************   CFT014
      ***********                                                         CFT014
     C***/COPY*WNCPYSRC,FT0358RTOT                                        CFT014
      ***********                                                         CFT014
      **If*EMU*FT*Enhancement*is*switched*on*then***************** CEU006 CFT014
      **save*work*date*parameter*for*call*to*FT0010*as*W#DT******* CEU006 CFT014
      ***********                                                  CEU006 CFT014
     C***********CEU006    IFEQ 'Y'                                CEU006 CFT014
     C***********V#ADDC    IFEQ 'A'                                CEU006 CFT014
     C***********          Z-ADDV#SLDT    W#DT                     CEU006 CFT014
     C***********          ELSE                                    CEU006 CFT014
     C***********          Z-ADDV#PVDT    W#DT                     CEU006 CFT014
     C***********          ENDIF                                   CEU006 CFT014
     C***********          ENDIF                                   CEU006 CFT014
      ***********                                                  CEU006 CFT014
      ***Transfer*Commission*Charge************************************   CFT014
      ***--------------------------************************************   CFT014
      ***********                                                         CFT014
     C***********F3TRCD    IFNE 0                                         CFT014
     C***********                                                  CEU006 CFT014
     C***********CEU006    IFEQ 'Y'                                CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C**If*EMU*FT*Enhancement*is*switched*on*then*call*FT0010***** CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C***********          CLEARP#0010                             CEU006 CFT014
     C***********          MOVE V#CCCY    P#FRCY                   CEU006 CFT014
     C***********          Z-ADDF3TRCD    P#FRAM                   CEU006 CFT014
     C***********          Z-ADDW#DT      P#FRDT                   CEU006 CFT014
     C***********          MOVE V#RCCY    P#TOCY                   CEU006 CFT014
     C***********          Z-ADDW#DT      P#TODT                   CEU006 CFT014
     C***********          EXSR SRFT10                             CEU006 CFT014
     C***********          Z-ADDP#TOAM    F3TRCM                   CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C***********          ELSE                                    CEU006 CFT014
      ***********                                                         CFT014
     C***********          CLEARD#DTA                                     CFT014
     C***********          MOVE F3TRCD    D#FAMT                          CFT014
     C***********          MOVELV#CCCY    D#FCCY                          CFT014
     C***********          MOVELV#RCCY    D#TCCY                          CFT014
     C***/COPY*WNCPYSRC,FT0358C005                                        CFT014
      ***********                                                         CFT014
     C***********          CALL 'AOCCYCV0'             9090               CFT014
     C***********          PARM *BLANKS   O#RTN   7                       CFT014
     C***********          PARM '*F*T*SPT'W0ACT   8                       CFT014
     C***********D#DTA     PARM D#DTA     O#DTA 256                       CFT014
     C***/COPY*WNCPYSRC,FT0358C006                                        CFT014
      ***********                                                         CFT014
     C************IN90     IFEQ '1'                                       CFT014
     C***********O#RTN     ORNE *BLANKS                                   CFT014
     C***********          MOVEL'AOCCYCV0'W0FILE          *************** CFT014
     C***********          MOVEL'*CALL'   W0KEY           * DB ERROR 02 * CFT014
     C***********          Z-ADD2         W0ERNB          *************** CFT014
     C***********          MOVEL'MEM5003' W0MSGD                          CFT014
     C***********          MOVEL'MIDAS  ' W0MSGF                          CFT014
     C***********          EXSR SRERR                                     CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
     C***********          Z-ADDD#TAMT    F3TRCM                          CFT014
     C***********                                                  CEU006 CFT014
     C***********          ENDIF                                   CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
     C***********          Z-ADDF3TRCM    TTLCHG 130                      CFT014
      ***********                                                         CFT014
      ***Telex*Charge**************************************************   CFT014
      ***------------**************************************************   CFT014
      ***********                                                         CFT014
     C***********F3TXCD    IFNE 0                                         CFT014
     C***********                                                  CEU006 CFT014
     C***********CEU006    IFEQ 'Y'                                CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C**If*EMU*FT*Enhancement*is*switched*on*then*call*FT0010***** CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C***********          CLEARP#0010                             CEU006 CFT014
     C***********          MOVE V#CCCY    P#FRCY                   CEU006 CFT014
     C***********          Z-ADDF3TXCD    P#FRAM                   CEU006 CFT014
     C***********          Z-ADDW#DT      P#FRDT                   CEU006 CFT014
     C***********          MOVE V#RCCY    P#TOCY                   CEU006 CFT014
     C***********          Z-ADDW#DT      P#TODT                   CEU006 CFT014
     C***********          EXSR SRFT10                             CEU006 CFT014
     C***********          Z-ADDP#TOAM    F3TXCH                   CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C***********          ELSE                                    CEU006 CFT014
      ***********                                                         CFT014
     C***********          CLEARD#DTA                                     CFT014
     C***********          MOVE F3TXCD    D#FAMT                          CFT014
     C***********          MOVELV#CCCY    D#FCCY                          CFT014
     C***********          MOVELV#RCCY    D#TCCY                          CFT014
     C***/COPY*WNCPYSRC,FT0358C007                                        CFT014
      ***********                                                         CFT014
     C***********          CALL 'AOCCYCV0'             9090               CFT014
     C***********          PARM *BLANKS   O#RTN   7                       CFT014
     C***********          PARM '*F*T*SPT'W0ACT   8                       CFT014
     C***********D#DTA     PARM D#DTA     O#DTA 256                       CFT014
     C***/COPY*WNCPYSRC,FT0358C008                                        CFT014
      ***********                                                         CFT014
     C************IN90     IFEQ '1'                                       CFT014
     C***********O#RTN     ORNE *BLANKS                                   CFT014
     C***********          MOVEL'AOCCYCV0'W0FILE          *************** CFT014
     C***********          MOVEL'*CALL'   W0KEY           * DB ERROR 03 * CFT014
     C***********          Z-ADD3         W0ERNB          *************** CFT014
     C***********          MOVEL'MEM5003' W0MSGD                          CFT014
     C***********          MOVEL'MIDAS  ' W0MSGF                          CFT014
     C***********          EXSR SRERR                                     CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
     C***********          Z-ADDD#TAMT    F3TXCH                          CFT014
     C***********                                                  CEU006 CFT014
     C***********          ENDIF                                   CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
     C***********          ADD  F3TXCH    TTLCHG                          CFT014
      ***********                                                         CFT014
      ***Cheque*Charge*************************************************   CFT014
      ***-------------*************************************************   CFT014
      ***********                                                         CFT014
     C***********F3CQCD    IFNE 0                                         CFT014
     C***********                                                  CEU006 CFT014
     C***********CEU006    IFEQ 'Y'                                CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C**If*EMU*FT*Enhancement*is*switched*on*then*call*FT0010***** CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C***********          CLEARP#0010                             CEU006 CFT014
     C***********          MOVE V#CCCY    P#FRCY                   CEU006 CFT014
     C***********          Z-ADDF3CQCD    P#FRAM                   CEU006 CFT014
     C***********          Z-ADDW#DT      P#FRDT                   CEU006 CFT014
     C***********          MOVE V#RCCY    P#TOCY                   CEU006 CFT014
     C***********          Z-ADDW#DT      P#TODT                   CEU006 CFT014
     C***********          EXSR SRFT10                             CEU006 CFT014
     C***********          Z-ADDP#TOAM    F3CQCH                   CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C***********          ELSE                                    CEU006 CFT014
      ***********                                                         CFT014
     C***********          CLEARD#DTA                                     CFT014
     C***********          MOVE F3CQCD    D#FAMT                          CFT014
     C***********          MOVELV#CCCY    D#FCCY                          CFT014
     C***********          MOVELV#RCCY    D#TCCY                          CFT014
     C***/COPY*WNCPYSRC,FT0358C009                                        CFT014
      ***********                                                         CFT014
     C***********          CALL 'AOCCYCV0'             9090               CFT014
     C***********          PARM *BLANKS   O#RTN   7                       CFT014
     C***********          PARM '*F*T*SPT'W0ACT   8                       CFT014
     C***********D#DTA     PARM D#DTA     O#DTA 256                       CFT014
     C***/COPY*WNCPYSRC,FT0358C010                                        CFT014
      ***********                                                         CFT014
     C************IN90     IFEQ '1'                                       CFT014
     C***********O#RTN     ORNE *BLANKS                                   CFT014
     C***********          MOVEL'AOCCYCV0'W0FILE          *************** CFT014
     C***********          MOVEL'*CALL'   W0KEY           * DB ERROR 04 * CFT014
     C***********          Z-ADD4         W0ERNB          *************** CFT014
     C***********          MOVEL'MEM5003' W0MSGD                          CFT014
     C***********          MOVEL'MIDAS  ' W0MSGF                          CFT014
     C***********          EXSR SRERR                                     CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
     C***********          Z-ADDD#TAMT    F3CQCH                          CFT014
     C***********                                                  CEU006 CFT014
     C***********          ENDIF                                   CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
     C***********          ADD  F3CQCH    TTLCHG                          CFT014
      ***********                                                         CFT014
      ***Advice*Charge*************************************************   CFT014
      ***-------------*************************************************   CFT014
      ***********                                                         CFT014
     C***********F3ADCD    IFNE 0                                         CFT014
     C***********                                                  CEU006 CFT014
     C***********CEU006    IFEQ 'Y'                                CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C**If*EMU*FT*Enhancement*is*switched*on*then*call*FT0010***** CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C***********          CLEARP#0010                             CEU006 CFT014
     C***********          MOVE V#CCCY    P#FRCY                   CEU006 CFT014
     C***********          Z-ADDF3ADCD    P#FRAM                   CEU006 CFT014
     C***********          Z-ADDW#DT      P#FRDT                   CEU006 CFT014
     C***********          MOVE V#RCCY    P#TOCY                   CEU006 CFT014
     C***********          Z-ADDW#DT      P#TODT                   CEU006 CFT014
     C***********          EXSR SRFT10                             CEU006 CFT014
     C***********          Z-ADDP#TOAM    F3ADCH                   CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C***********          ELSE                                    CEU006 CFT014
      ***********                                                         CFT014
     C***********          CLEARD#DTA                                     CFT014
     C***********          MOVE F3ADCD    D#FAMT                          CFT014
     C***********          MOVELV#CCCY    D#FCCY                          CFT014
     C***********          MOVELV#RCCY    D#TCCY                          CFT014
     C***/COPY*WNCPYSRC,FT0358C011                                        CFT014
      ***********                                                         CFT014
     C***********          CALL 'AOCCYCV0'             9090               CFT014
     C***********          PARM *BLANKS   O#RTN   7                       CFT014
     C***********          PARM '*F*T*SPT'W0ACT   8                       CFT014
     C***********D#DTA     PARM D#DTA     O#DTA 256                       CFT014
     C***/COPY*WNCPYSRC,FT0358C012                                        CFT014
      ***********                                                         CFT014
     C************IN90     IFEQ '1'                                       CFT014
     C***********O#RTN     ORNE *BLANKS                                   CFT014
     C***********          MOVEL'AOCCYCV0'W0FILE          *************** CFT014
     C***********          MOVEL'*CALL'   W0KEY           * DB ERROR 05 * CFT014
     C***********          Z-ADD5         W0ERNB          *************** CFT014
     C***********          MOVEL'MEM5003' W0MSGD                          CFT014
     C***********          MOVEL'MIDAS  ' W0MSGF                          CFT014
     C***********          EXSR SRERR                                     CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
     C***********          Z-ADDD#TAMT    F3ADCH                          CFT014
     C***********                                                  CEU006 CFT014
     C***********          ENDIF                                   CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
     C***********          ADD  F3ADCH    TTLCHG                          CFT014
      ***********                                                         CFT014
      ***Telephone*Charge**********************************************   CFT014
      ***----------------**********************************************   CFT014
      ***********                                                         CFT014
     C***********F3TLCD    IFNE 0                                         CFT014
     C***********                                                  CEU006 CFT014
     C***********CEU006    IFEQ 'Y'                                CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C**If*EMU*FT*Enhancement*is*switched*on*then*call*FT0010***** CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C***********          CLEARP#0010                             CEU006 CFT014
     C***********          MOVE V#CCCY    P#FRCY                   CEU006 CFT014
     C***********          Z-ADDF3TLCD    P#FRAM                   CEU006 CFT014
     C***********          Z-ADDW#DT      P#FRDT                   CEU006 CFT014
     C***********          MOVE V#RCCY    P#TOCY                   CEU006 CFT014
     C***********          Z-ADDW#DT      P#TODT                   CEU006 CFT014
     C***********          EXSR SRFT10                             CEU006 CFT014
     C***********          Z-ADDP#TOAM    F3TLCH                   CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C***********          ELSE                                    CEU006 CFT014
      ***********                                                         CFT014
     C***********          CLEARD#DTA                                     CFT014
     C***********          MOVE F3TLCD    D#FAMT                          CFT014
     C***********          MOVELV#CCCY    D#FCCY                          CFT014
     C***********          MOVELV#RCCY    D#TCCY                          CFT014
     C***/COPY*WNCPYSRC,FT0358C013                                        CFT014
      ***********                                                         CFT014
     C***********          CALL 'AOCCYCV0'             9090               CFT014
     C***********          PARM *BLANKS   O#RTN   7                       CFT014
     C***********          PARM '*F*T*SPT'W0ACT   8                       CFT014
     C***********D#DTA     PARM D#DTA     O#DTA 256                       CFT014
     C***/COPY*WNCPYSRC,FT0358C014                                        CFT014
      ***********                                                         CFT014
     C************IN90     IFEQ '1'                                       CFT014
     C***********O#RTN     ORNE *BLANKS                                   CFT014
     C***********          MOVEL'AOCCYCV0'W0FILE          *************** CFT014
     C***********          MOVEL'*CALL'   W0KEY           * DB ERROR 06 * CFT014
     C***********          Z-ADD6         W0ERNB          *************** CFT014
     C***********          MOVEL'MEM5003' W0MSGD                          CFT014
     C***********          MOVEL'MIDAS  ' W0MSGF                          CFT014
     C***********          EXSR SRERR                                     CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
     C***********          Z-ADDD#TAMT    F3TLCH                          CFT014
     C***********                                                  CEU006 CFT014
     C***********          ENDIF                                   CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
     C***********          ADD  F3TLCH    TTLCHG                          CFT014
      ***********                                                         CFT014
      ***Miscellaneous*Charge******************************************   CFT014
      ***--------------------******************************************   CFT014
      ***********                                                         CFT014
     C***********F3MSCD    IFNE 0                                         CFT014
     C***********                                                  CEU006 CFT014
     C***********CEU006    IFEQ 'Y'                                CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C**If*EMU*FT*Enhancement*is*switched*on*then*call*FT0010***** CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C***********          CLEARP#0010                             CEU006 CFT014
     C***********V#NWRK    IFEQ 'CASHV8'                           CEU006 CFT014
     C***********          MOVELV#RCCY    P#FRCY                   CEU006 CFT014
     C***********          MOVELV#CCCY    P#TOCY                   CEU006 CFT014
     C***********          ELSE                                    CEU006 CFT014
     C***********          MOVELV#CCCY    P#FRCY                   CEU006 CFT014
     C***********          MOVELV#RCCY    P#TOCY                   CEU006 CFT014
     C***********          ENDIF                                   CEU006 CFT014
     C***********          Z-ADDF3MSCD    P#FRAM                   CEU006 CFT014
     C***********          Z-ADDW#DT      P#FRDT                   CEU006 CFT014
     C***********          Z-ADDW#DT      P#TODT                   CEU006 CFT014
     C***********          EXSR SRFT10                             CEU006 CFT014
     C***********V#NWRK    IFEQ 'CASHV8'                           CEU006 CFT014
     C***********          Z-ADDF3MSCD    F3MSCH                   CEU006 CFT014
     C***********          Z-ADDP#TOAM    F3MSCD                   CEU006 CFT014
     C***********          ELSE                                    CEU006 CFT014
     C***********          Z-ADDP#TOAM    F3MSCH                   CEU006 CFT014
     C***********          ENDIF                                   CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C***********          ELSE                                    CEU006 CFT014
      ***********                                                         CFT014
     C***********          CLEARD#DTA                                     CFT014
     C***********          MOVE F3MSCD    D#FAMT                          CFT014
      ***********                                                  122060 CFT014
     C***********V#NWRK    IFEQ 'CASHV8'                           122060 CFT014
     C***********          MOVELV#RCCY    D#FCCY                   122060 CFT014
     C***********          MOVELV#CCCY    D#TCCY                   122060 CFT014
     C***********          ELSE                                    122060 CFT014
     C***********          MOVELV#CCCY    D#FCCY                          CFT014
     C***********          MOVELV#RCCY    D#TCCY                          CFT014
     C***********          ENDIF                                   122060 CFT014
     C***/COPY*WNCPYSRC,FT0358C015                                        CFT014
      ***********                                                         CFT014
     C***********          CALL 'AOCCYCV0'             9090               CFT014
     C***********          PARM *BLANKS   O#RTN   7                       CFT014
     C***********          PARM '*F*T*SPT'W0ACT   8                       CFT014
     C***********D#DTA     PARM D#DTA     O#DTA 256                       CFT014
     C***/COPY*WNCPYSRC,FT0358C016                                        CFT014
      ***********                                                         CFT014
     C************IN90     IFEQ '1'                                       CFT014
     C***********O#RTN     ORNE *BLANKS                                   CFT014
     C***********          MOVEL'AOCCYCV0'W0FILE          *************** CFT014
     C***********          MOVEL'*CALL'   W0KEY           * DB ERROR 07 * CFT014
     C***********          Z-ADD7         W0ERNB          *************** CFT014
     C***********          MOVEL'MEM5003' W0MSGD                          CFT014
     C***********          MOVEL'MIDAS  ' W0MSGF                          CFT014
     C***********          EXSR SRERR                                     CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
     C***********V#NWRK    IFEQ 'CASHV8'                           122060 CFT014
      ***********                                                  122060 CFT014
     C***********          Z-ADDF3MSCD    WRK110 110               122060 CFT014
     C***********          Z-ADDD#TAMT    F3MSCD                   122060 CFT014
     C***********          Z-ADDWRK110    F3MSCH                   122060 CFT014
      ***********                                                  122060 CFT014
     C***********          MOVELD#FCCY    WRK3    3                122060 CFT014
     C***********          MOVELD#TCCY    D#FCCY                   122060 CFT014
     C***********          MOVELWRK3      D#TCCY                   122060 CFT014
      ***********                                                  122060 CFT014
     C***********          ELSE                                    122060 CFT014
     C***********          Z-ADDD#TAMT    F3MSCH                          CFT014
     C***********          ENDIF                                   122060 CFT014
     C***********                                                  CEU006 CFT014
     C***********          ENDIF                                   CEU006 CFT014
      ***********                                                  122060 CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
     C***********          ADD  F3MSCH    TTLCHG                          CFT014
     C***********                                                  S01494 CFT014
     C***FX/Change*Commission************************************* S01494 CFT014
     C***--------------------************************************* S01494 CFT014
     C***********                                                  S01494 CFT014
     C***********F3CHCD    IFNE 0                                  S01494 CFT014
     C***********S01494    ANDEQ'Y'                                S01494 CFT014
     C***********                                                  CEU006 CFT014
     C***********CEU006    IFEQ 'Y'                                CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C**If*EMU*FT*Enhancement*is*switched*on*then*call*FT0010***** CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C***********          CLEARP#0010                             CEU006 CFT014
     C***********          MOVE V#CCCY    P#FRCY                   CEU006 CFT014
     C***********          Z-ADDF3CHCD    P#FRAM                   CEU006 CFT014
     C***********          Z-ADDW#DT      P#FRDT                   CEU006 CFT014
     C***********          MOVE V#RCCY    P#TOCY                   CEU006 CFT014
     C***********          Z-ADDW#DT      P#TODT                   CEU006 CFT014
     C***********          EXSR SRFT10                             CEU006 CFT014
     C***********          Z-ADDP#TOAM    F3CHCM                   CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C***********          ELSE                                    CEU006 CFT014
     C***********                                                  S01494 CFT014
     C***********          CLEARD#DTA                              S01494 CFT014
     C***********          MOVE F3CHCD    D#FAMT                   S01494 CFT014
     C***********          MOVELV#CCCY    D#FCCY                   S01494 CFT014
     C***********          MOVELV#RCCY    D#TCCY                   S01494 CFT014
     C***/COPY*WNCPYSRC,FT0358C017                                        CFT014
     C***********                                                  S01494 CFT014
     C***********          CALL 'AOCCYCV0'             9090        S01494 CFT014
     C***********          PARM *BLANKS   O#RTN   7                S01494 CFT014
     C***********          PARM '*F*T*SPT'W0ACT   8                S01494 CFT014
     C***********D#DTA     PARM D#DTA     O#DTA 256                S01494 CFT014
     C***/COPY*WNCPYSRC,FT0358C018                                        CFT014
     C***********                                                  S01494 CFT014
     C************IN90     IFEQ '1'                                S01494 CFT014
     C***********O#RTN     ORNE *BLANKS                            S01494 CFT014
     C***********          MOVEL'AOCCYCV0'W0FILE     ************* S01494 CFT014
     C***********          MOVEL'*CALL'   W0KEY      * DB ERROR 10 S01494 CFT014
     C***********          Z-ADD10        W0ERNB     ************* S01494 CFT014
     C***********          MOVEL'MEM5003' W0MSGD                   S01494 CFT014
     C***********          MOVEL'MIDAS  ' W0MSGF                   S01494 CFT014
     C***********          EXSR SRERR                              S01494 CFT014
     C***********          END                                     S01494 CFT014
     C***********                                                  S01494 CFT014
     C***********          Z-ADDD#TAMT    F3CHCM                   S01494 CFT014
     C***********                                                  CEU006 CFT014
     C***********          ENDIF                                   CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C***********          END                                     S01494 CFT014
     C***********                                                  S01494 CFT014
     C***********          ADD  F3CHCM    TTLCHG                   S01494 CFT014
     C***********                                                  S01499 CFT014
     C***Inlcude*V.A.T.*amount*if*V.A.T.*processing*allowed******* S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********V#VATP    IFEQ 'Y'                                S01499 CFT014
     C***********F3VATD    ANDNE0                                  S01499 CFT014
     C***********                                                  CEU006 CFT014
     C***********CEU006    IFEQ 'Y'                                CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C**If*EMU*FT*Enhancement*is*switched*on*then*call*FT0010***** CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C***********          CLEARP#0010                             CEU006 CFT014
     C***********          MOVE V#CCCY    P#FRCY                   CEU006 CFT014
     C***********          Z-ADDF3VATD    P#FRAM                   CEU006 CFT014
     C***********          Z-ADDW#DT      P#FRDT                   CEU006 CFT014
     C***********          MOVE V#RCCY    P#TOCY                   CEU006 CFT014
     C***********          Z-ADDW#DT      P#TODT                   CEU006 CFT014
     C***********          EXSR SRFT10                             CEU006 CFT014
     C***********          Z-ADDP#TOAM    F3VATT                   CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C***********          ELSE                                    CEU006 CFT014
     C***********                                                  S01499 CFT014
     C***********          CLEARD#DTA                              S01499 CFT014
     C***********          MOVE F3VATD    D#FAMT                   S01499 CFT014
     C***********          MOVELV#CCCY    D#FCCY                   S01499 CFT014
     C***********          MOVELV#RCCY    D#TCCY                   S01499 CFT014
     C***/COPY*WNCPYSRC,FT0358C019                                        CFT014
     C***********                                                  S01499 CFT014
     C***********          CALL 'AOCCYCV0'             9090        S01499 CFT014
     C***********          PARM *BLANKS   O#RTN   7                S01499 CFT014
     C***********          PARM '*F*T*SPT'W0ACT   8                S01499 CFT014
     C***********D#DTA     PARM D#DTA     O#DTA 256                S01499 CFT014
     C***/COPY*WNCPYSRC,FT0358C020                                        CFT014
     C***********                                                  S01499 CFT014
     C************IN90     IFEQ '1'                                S01499 CFT014
     C***********O#RTN     ORNE *BLANKS                            S01499 CFT014
     C***********          MOVEL'AOCCYCV0'W0FILE     ************* S01499 CFT014
     C***********          MOVEL'*CALL'   W0KEY      * DB ERROR 12 S01499 CFT014
     C***********          Z-ADD12        W0ERNB     ************* S01499 CFT014
     C***********          MOVEL'MEM5003' W0MSGD                   S01499 CFT014
     C***********          MOVEL'MIDAS  ' W0MSGF                   S01499 CFT014
     C***********          EXSR SRERR                              S01499 CFT014
     C***********          END                                     S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********          Z-ADDD#TAMT    F3VATT                   S01499 CFT014
     C***********                                                  CEU006 CFT014
     C***********          ENDIF                                   CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C***********          END                                     S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********          ADD  F3VATT    TTLCHG                   S01499 CFT014
      ***********                                                         CFT014
      ***Check*that*total*charges*do*not*exceed*payment*amount*if*the**   CFT014
      ***add/deduct*indicator*is*'D'*and*'Charges*To*The*Debit*Of'*has*   CFT014
      ***not*been*entered.*********************************************   CFT014
      ***********                                                         CFT014
     C***********V#ADDC    IFEQ 'D'                                       CFT014
     C***********V#CDRT    ANDEQ*BLANKS                                   CFT014
      ***********                                                         CFT014
      ***Check*if*total*charges*are*greater*than*the*payment*value*****   CFT014
      ***********                                                         CFT014
     C***********TTLCHG    IFGE V#PYAM                                    CFT014
     C***********          MOVEL'Y'       E#MSGS                          CFT014
     C***********          MOVEL*BLANKS   FTMSDT                          CFT014
     C***********          MOVELE#CPGM    FTPGMQ                          CFT014
     C***********          MOVEL'FTM2107' FTMSID                          CFT014
     C***********          EXSR FTSNMS                                    CFT014
     C***********          MOVEL'Y'       E#NOUP                          CFT014
      ***********                                                         CFT014
      ***Reverse*image*the*Charge*fields*with*amounts*in*them**********   CFT014
      ***********                                                         CFT014
     C***********F3TRCM    IFNE 0                                         CFT014
     C***********          MOVEL'Y'       I3TRCM                          CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
     C***********F3TXCH    IFNE 0                                         CFT014
     C***********          MOVEL'Y'       I3TXCH                          CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
     C***********F3CQCH    IFNE 0                                         CFT014
     C***********          MOVEL'Y'       I3CQCH                          CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
     C***********F3ADCH    IFNE 0                                         CFT014
     C***********          MOVEL'Y'       I3ADCH                          CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
     C***********F3TLCH    IFNE 0                                         CFT014
     C***********          MOVEL'Y'       I3TLCH                          CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
     C***********F3MSCH    IFNE 0                                         CFT014
     C***********          MOVEL'Y'       I3MSCH                          CFT014
     C***********          END                                            CFT014
     C***********                                                  S01494 CFT014
     C***********F3CHCM    IFNE 0                                  S01494 CFT014
     C***********S01494    ANDEQ'Y'                                S01494 CFT014
     C***********          MOVEL'Y'       I3CHCM                   S01494 CFT014
     C***********          END                                     S01494 CFT014
      ***********                                                         CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
     C***********          END                                            CFT014
      ***********                                                         CFT014
      ***Unwind*subroutine*stack*name**********************************   CFT014
      ***********                                                         CFT014
     C***********EXTOT     TAG                                            CFT014
     C***********          MOVEA*BLANKS   @STK,Q                          CFT014
     C***********          SUB  1         Q                               CFT014
      ***********                                                         CFT014
     C***SR******          ENDSR                                          CFT014
     C***/EJECT**                                                  S01499 CFT014
     C************************************************************ S01499 CFT014
     C************************************************************ S01499 CFT014
     C***SRVATC***:*V.A.T.*Calculation**************************** S01499 CFT014
     C************************************************************ S01499 CFT014
     C***CALLED*BY:*SRPROC*-*Control*Process*of*Validation******** S01499 CFT014
     C************************************************************ S01499 CFT014
     C***CALLS****:********-************************************** S01499 CFT014
     C************************************************************ S01499 CFT014
     C************************************************************ S01499 CFT014
     C***SR******SRVATC    BEGSR                                   S01499 CFT014
     C***********                                                  S01499 CFT014
     C***Set*up*subroutine*stack*name***************************** S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********          ADD  1         Q       50               S01499 CFT014
     C***********          MOVEL'SRVATC'  @STK,Q                   S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********          Z-ADD0         F3VATD                   S01499 CFT014
     C***********          Z-ADD0         F3VATT                   S01499 CFT014
     C/COPY WNCPYSRC,FT0358C025
     C***********                                                  S01499 CFT014
     C***If*apply*V.A.T.*flag*is*'Y',*calculate*V.A.T.*charge***** S01499 CFT014
     C***********                                                  S01499 CFT014
     C***....*Transfer*commission********************************* S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********S3VAT1    IFEQ 'Y'                                S01499 CFT014
     C***********F3TRCD    MULT V#VATR    @TVATD 130H              S01499 CFT014
     C***********F3TRCM    MULT V#VATR    @TVATT 130H              S01499 CFT014
     C***********          ADD  @TVATD    F3VATD                   S01499 CFT014
     C***********          ADD  @TVATT    F3VATT                   S01499 CFT014
     C/COPY WNCPYSRC,FT0358C026
     C***********          END                                     S01499 CFT014
     C***********                                                  S01499 CFT014
     C***....*Telex*********************************************** S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********S3VAT2    IFEQ 'Y'                                S01499 CFT014
     C***********F3TXCD    MULT V#VATR    @TVATD    H              S01499 CFT014
     C***********F3TXCH    MULT V#VATR    @TVATT    H              S01499 CFT014
     C***********          ADD  @TVATD    F3VATD                   S01499 CFT014
     C***********          ADD  @TVATT    F3VATT                   S01499 CFT014
     C***********          END                                     S01499 CFT014
     C***********                                                  S01499 CFT014
     C***....*Cheque********************************************** S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********S3VAT3    IFEQ 'Y'                                S01499 CFT014
     C***********F3CQCD    MULT V#VATR    @TVATD    H              S01499 CFT014
     C***********F3CQCH    MULT V#VATR    @TVATT    H              S01499 CFT014
     C***********          ADD  @TVATD    F3VATD                   S01499 CFT014
     C***********          ADD  @TVATT    F3VATT                   S01499 CFT014
     C***********          END                                     S01499 CFT014
     C***********                                                  S01499 CFT014
     C***....*Advice********************************************** S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********S3VAT4    IFEQ 'Y'                                S01499 CFT014
     C***********F3ADCD    MULT V#VATR    @TVATD    H              S01499 CFT014
     C***********F3ADCH    MULT V#VATR    @TVATT    H              S01499 CFT014
     C***********          ADD  @TVATD    F3VATD                   S01499 CFT014
     C***********          ADD  @TVATT    F3VATT                   S01499 CFT014
     C***********          END                                     S01499 CFT014
     C***********                                                  S01499 CFT014
     C***....*Telephone******************************************* S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********S3VAT5    IFEQ 'Y'                                S01499 CFT014
     C***********F3TLCD    MULT V#VATR    @TVATD    H              S01499 CFT014
     C***********F3TLCH    MULT V#VATR    @TVATT    H              S01499 CFT014
     C***********          ADD  @TVATD    F3VATD                   S01499 CFT014
     C***********          ADD  @TVATT    F3VATT                   S01499 CFT014
     C***********          END                                     S01499 CFT014
     C***********                                                  S01499 CFT014
     C***....*Miscellaneous*************************************** S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********S3VAT6    IFEQ 'Y'                                S01499 CFT014
     C***********F3MSCD    MULT V#VATR    @TVATD    H              S01499 CFT014
     C***********F3MSCH    MULT V#VATR    @TVATT    H              S01499 CFT014
     C***********          ADD  @TVATD    F3VATD                   S01499 CFT014
     C***********          ADD  @TVATT    F3VATT                   S01499 CFT014
     C/COPY WNCPYSRC,FT0358C027
     C***********          END                                     S01499 CFT014
     C***********                                                  S01499 CFT014
     C***....*FX/Change*commission******************************** S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********S3VAT7    IFEQ 'Y'                                S01499 CFT014
     C***********S01494    ANDEQ'Y'                                S01499 CFT014
     C***********F3CHCD    MULT V#VATR    @TVATD    H              S01499 CFT014
     C***********F3CHCM    MULT V#VATR    @TVATT    H              S01499 CFT014
     C***********          ADD  @TVATD    F3VATD                   S01499 CFT014
     C***********          ADD  @TVATT    F3VATT                   S01499 CFT014
     C***********          END                                     S01499 CFT014
     C***********                                                  S01499 CFT014
     C***Unwind*subroutine*stack*name***************************** S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********EXVATC    TAG                                     S01499 CFT014
     C***********          MOVEA*BLANKS   @STK,Q                   S01499 CFT014
     C***********          SUB  1         Q                        S01499 CFT014
     C***********                                                  S01499 CFT014
     C***SR******          ENDSR                                   S01499 CFT014
     C***/EJECT**                                                         CFT014
      *****************************************************************
      *                                                               *
      *  SRXVAL   : Cross validations                                 *
      *                                                               *
      *  CALLED BY: SRPROC - Control Process of Validation            *
      *                                                               *
      *  CALLS    :        -                                          *
      *                                                               *
      *****************************************************************
     CSR         SRXVAL    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SRXVAL'  @STK,Q
      *
      *  /COPY Statement
      *
     C/COPY WNCPYSRC,FT0358XVAL
      *
      *  Unwind subroutine stack name
      *
     C           EXXVAL    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
     E/COPY FTCPYSRC,SFTADDRC
     E/COPY FTCPYSRC,SFTADDRSC
     E/COPY FTCPYSRC,SFTSWFTC
     E/COPY FTCPYSRC,SFTSNMSC
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRALGN   : To call ZALIGN                                    *
      *                                                               *
      *  CALLED BY:        -                                          *
      *                                                               *
      *  CALLS    :        -                                          *
      *                                                               *
      *****************************************************************
     CSR         SRALGN    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SRALGN'  @STK,Q
      *
     C                     CALL 'ZALIGN'               90
     C                     PARM *BLANKS   ZRTN    7        B:Return Code
     C                     PARM           ZFIELD 16        B:Check Field
     C                     PARM           ZADEC   10       I:No Of Decs
     C                     PARM           ZADIG   20       I:No Of Digits
     C                     PARM *BLANKS   ZAFLD  16        O:Check Field
      *
      *  If return with an error (LR seton in called program) then
      *  process for database error.
      *
     C           *IN90     IFEQ '1'
     C                     MOVEL'ZALIGN  'W0FILE
     C                     MOVEL'*CALL'   W0KEY            ***************
     C                     Z-ADD8         W0ERNB           * DB ERROR 08 *
     C                     MOVEL'MEM5003' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *
      *  Unwind subroutine stack name
      *
     C           EXALGN    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRACT    : Undefined action - error                          *
      *                                                               *
      *  CALLED BY: Main Processing                                   *
      *                                                               *
      *  CALLS    : SRERR   - report error and close down program     *
      *                                                               *
      *****************************************************************
     CSR         SRACT     BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q
     C                     MOVEL'SRACT '  @STK,Q
      *
      *  Database error undefined action
      *
     C                     MOVEL'*ACTION 'W0FILE           ***************
     C                     MOVELW0ACT     W0KEY            * DB ERROR 09 *
     C                     Z-ADD9         W0ERNB           ***************
     C                     MOVEL'MEM5006' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
      *
      *  Unwind subroutine stack name
      *
     C           EXACT     TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
     C***/EJECT**                                                  CEU006 CFT014
     C************************************************************ CEU006 CFT014
     C************************************************************ CEU006 CFT014
     C***SRFT10***:*Calculates*Currency*Amounts*for*EMU*********** CEU006 CFT014
     C************************************************************ CEU006 CFT014
     C**************Converts*P#FRAM*in*P#FRCY*->*P#TOAM*in*P#TOCY. CEU006 CFT014
     C************************************************************ CEU006 CFT014
     C***Called*by:*SRTOT***************************************** CEU006 CFT014
     C************************************************************ CEU006 CFT014
     C***Calls****:*FT0010*-*Midas*FT*Calculate*Currency*Amounts.* CEU006 CFT014
     C************************************************************ CEU006 CFT014
     C************************************************************ CEU006 CFT014
     C***SR******SRFT10    BEGSR                                   CEU006 CFT014
     C***/COPY*WNCPYSRC,FT0358C021                                        CFT014
     C***********                                                  CEU006 CFT014
     C***********          CALL 'FT0010'                           CEU006 CFT014
     C***********          PARM           P#0010                   CEU006 CFT014
      ***********                                                  CEU006 CFT014
      ***Check*if*database*error*occurred************************* CEU006 CFT014
      ***********                                                  CEU006 CFT014
     C***********P#RTCD    IFNE *BLANKS                            CEU006 CFT014
     C***********          MOVEL'FT0010  'W0FILE                   CEU006 CFT014
     C***********          MOVELP#TOCY    W0KEY      ************* CEU006 CFT014
     C***********          Z-ADD15        W0ERNB     * DB ERROR 15 CEU006 CFT014
     C***********          MOVEL'MEM5004' W0MSGD     ************* CEU006 CFT014
     C***********          MOVEL'MIDAS  ' W0MSGF                   CEU006 CFT014
     C***********          EXSR SRERR                              CEU006 CFT014
     C***********          ENDIF                                   CEU006 CFT014
      ***********                                                  CEU006 CFT014
     C***SR******          ENDSR                                   CEU006 CFT014
     C***/EJECT**                                                         CFT014
      *****************************************************************
      *                                                               *
      *  SRINIT   : Initialise and define fields                      *
      *                                                               *
      *  CALLED BY: Main processing                                   *
      *                                                               *
      *  CALLS    :        -                                          *
      *                                                               *
      *****************************************************************
     CSR         SRINIT    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SRINIT'  @STK,Q
      *
      *  Set up copyright statement
      *
     C                     MOVEACPY@      BIS@   80
      *
      *  Open Files
      *
      *
      *  Indicate that set up is complete
      *
     C                     SETON                     50
      *
      *  Get Rundate information
      *
     C           *NAMVAR   DEFN RUNDAT    RUNDTA
     C                     IN   RUNDTA
     C                     MOVE AGMRDT    WUMRDT  7        Midas Run date
     C                     MOVE AGRDNB    WURDNB  50       Run day number
     C                     MOVE AGSUC     WUSUC   1        Set up complete
     C                     MOVE AGDFF     WUDFF   1        Date Format
     C                     MOVE AGMBIN    WUMBIN  1        Multi Branched
      *                                                                   CEU006
      *  Access Base Currency from Bank Details file                      CEU006
      *                                                                   CEU006
     C                     CALL 'AOBANKR0'             9090               CEU006
     C***********          PARM *BLANKS   @RTCD      B:Return code CEU006 CFT014
     C                     PARM *BLANKS   @RTCD   7        B:Return code  CFT014
     C***********          PARM '*FIRST ' @OPTN      I:Option      CEU006 CFT014
     C                     PARM '*FIRST ' @OPTN   7        I:Option       CFT014
     C           SDBANK    PARM *BLANKS   DSFDY                           CEU006
      *                                                                   CEU006
      *  If return with an error (LR seton in called program) then        CEU006
      *  process for database error.                                      CEU006
      *                                                                   CEU006
     C           *IN90     IFEQ *ON                                       CEU006
     C           @RTCD     OREQ '*ERROR*'                                 CEU006
     C                     MOVEL'AOBANKR0'W0FILE                          CEU006
     C                     MOVEL'*CALL'   W0KEY            ***************CEU006
     C                     Z-ADD13        W0ERNB           * DB ERROR 13 *CEU006
     C                     MOVEL'MEM5003' W0MSGD           ***************CEU006
     C                     MOVEL'MIDAS  ' W0MSGF                          CEU006
     C                     EXSR SRERR                                     CEU006
     C                     ENDIF                                          CEU006
      ***********                                                  CEU006 CFT014
      ***Access*Euro*Currency*Code*from*General*Ledger*ICDdetails. CEU006 CFT014
      ***********                                                  CEU006 CFT014
     C***********          CALL 'AOGELRR0'                         CEU006 CFT014
     C***********          PARM *BLANKS   @RTCD                    CEU006 CFT014
     C***********          PARM '*FIRST ' @OPTN                    CEU006 CFT014
     C***********SDGELR    PARM SDGELR    DSFDY                    CEU006 CFT014
      ***********                                                  CEU006 CFT014
      ***Database*error******************************************* CEU006 CFT014
      ***********                                                  CEU006 CFT014
     C***********@RTCD     IFNE *BLANKS                            CEU006 CFT014
     C***********          MOVEL'SDGELRPD'W0FILE                   CEU006 CFT014
     C***********          MOVEL'*CALL'   W0KEY      ************* CEU006 CFT014
     C***********          Z-ADD14        W0ERNB     * DB ERROR 14 CEU006 CFT014
     C***********          MOVEL'MEM5003' W0MSGD     ************* CEU006 CFT014
     C***********          MOVEL'MIDAS  ' W0MSGF                   CEU006 CFT014
     C***********          EXSR SRERR                              CEU006 CFT014
     C***********          ENDIF                                   CEU006 CFT014
      ***********                                                  CEU006 CFT014
      **Access*Currency*details*for*Settlement*Currency*********** CEU006 CFT014
      ***********                                                  CEU006 CFT014
     C***********          CALL 'AOCURRR0'                         CEU006 CFT014
     C***********          PARM *BLANKS   @RTCD                    CEU006 CFT014
     C***********          PARM '*KEY   ' @OPTN                    CEU006 CFT014
     C***********          PARM V#SMCY    @AJCD   3                CEU006 CFT014
     C***********SDCURR    PARM SDCURR    DSSDY                    CEU006 CFT014
      ***********                                                  CEU006 CFT014
      ***Database*error******************************************* CEU006 CFT014
     C***********@RTCD     IFNE *BLANK                             CEU006 CFT014
     C***********          MOVEL'SDCURRPD'W0FILE                   CEU006 CFT014
     C***********          MOVELV#SMCY    W0KEY      ************* CEU006 CFT014
     C***********          Z-ADD16        W0ERNB     * DB ERROR 16 CEU006 CFT014
     C***********          MOVEL'MEM5004' W0MSGD     ************* CEU006 CFT014
     C***********          MOVEL'MIDAS  ' W0MSGF                   CEU006 CFT014
     C***********          EXSR SRERR                              CEU006 CFT014
     C***********          ENDIF                                   CEU006 CFT014
      ***********                                                  CEU006 CFT014
      **Save*In*Ccy*Indicator*for*Settlement*Currency*as*#INCYSand CEU006 CFT014
      **save*Transition*Start*Date*for*Settlement*Currencyas#TPSDS CEU006 CFT014
      ***********                                                  CEU006 CFT014
     C***********          MOVE A6INCY    #INCYS  1                CEU006 CFT014
     C***********          Z-ADDA6TPSD    #TPSDS  50               CEU006 CFT014
      ***********                                                  CEU006 CFT014
      **Access*Currency*details*for*Pay*Currency****************** CEU006 CFT014
      ***********                                                  CEU006 CFT014
     C***********          CALL 'AOCURRR0'                         CEU006 CFT014
     C***********          PARM *BLANKS   @RTCD                    CEU006 CFT014
     C***********          PARM '*KEY   ' @OPTN                    CEU006 CFT014
     C***********          PARM V#PCCY    @AJCD                    CEU006 CFT014
     C***********SDCURR    PARM SDCURR    DSSDY                    CEU006 CFT014
      ***********                                                  CEU006 CFT014
      ***Database*error******************************************* CEU006 CFT014
     C***********@RTCD     IFNE *BLANK                             CEU006 CFT014
     C***********          MOVEL'SDCURRPD'W0FILE                   CEU006 CFT014
     C***********          MOVELV#PCCY    W0KEY      ************* CEU006 CFT014
     C***********          Z-ADD17        W0ERNB     * DB ERROR 17 CEU006 CFT014
     C***********          MOVEL'MEM5004' W0MSGD     ************* CEU006 CFT014
     C***********          MOVEL'MIDAS  ' W0MSGF                   CEU006 CFT014
     C***********          EXSR SRERR                              CEU006 CFT014
     C***********          ENDIF                                   CEU006 CFT014
      ***********                                                  CEU006 CFT014
      **Save*In*Ccy*Indicator*for*Pay*Currency*as*#INCYP*and****** CEU006 CFT014
      **save*Transition*Start*Date*for*Pay*Currency*as*#TPSDP.**** CEU006 CFT014
      ***********                                                  CEU006 CFT014
     C***********          MOVE A6INCY    #INCYP  1                CEU006 CFT014
     C***********          Z-ADDA6TPSD    #TPSDP  50               CEU006 CFT014
     C***********                                                  S01494 CFT014
     C***Access*SAR*details*file*to*determine*ifS01494isswitchedON S01494 CFT014
     C***********                                                  S01494 CFT014
     C***********          CALL 'AOSARDR0'                         S01494 CFT014
     C***********          PARM *BLANKS   @RTCD   7                S01494 CFT014
     C***********          PARM '*VERIFY' @OPTN   7                S01494 CFT014
     C***********          PARM 'S01494'  @SARD   6                S01494 CFT014
     C***********SCSARD    PARM SCSARD    DSFDY                    S01494 CFT014
     C***********          MOVE 'N'       S01494  1                S01494 CFT014
     C***********                                                  S01494 CFT014
     C***If*core*feature*is*switched*ON,*set*a*variable*field*to** S01494 CFT014
     C***condition*the*rest*of*the*processing********************* S01494 CFT014
     C***********                                                  S01494 CFT014
     C***********@RTCD     IFEQ *BLANKS                            S01494 CFT014
     C***********          MOVE 'Y'       S01494                   S01494 CFT014
     C***********          ELSE                                    S01494 CFT014
     C***********                                                  S01494 CFT014
     C***else,*database*error*(return*code*other*than**NRF)******* S01494 CFT014
     C***********                                                  S01494 CFT014
     C***********@RTCD     IFNE '*NRF   '                          S01494 CFT014
     C***********          MOVEL'SCSARDPD'W0FILE                   S01494 CFT014
     C***********          MOVEL'*CALL'   W0KEY      ************* S01494 CFT014
     C***********          Z-ADD11        W0ERNB     * DB ERROR 11 S01494 CFT014
     C***********          MOVEL'MEM5003' W0MSGD     ************* S01494 CFT014
     C***********          MOVEL'MIDAS  ' W0MSGF                   S01494 CFT014
     C***********          EXSR SRERR                              S01494 CFT014
     C***********          END                                     S01494 CFT014
     C***********          END                                     S01494 CFT014
     C***********                                                  S01499 CFT014
     C***Access*SAR*details*file*to*determine*ifCEU006isswitchedON CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C***********          CALL 'AOSARDR0'                         CEU006 CFT014
     C***********          PARM *BLANKS   @RTCD                    CEU006 CFT014
     C***********          PARM '*VERIFY' @OPTN                    CEU006 CFT014
     C***********          PARM 'CEU006'  @SARD                    CEU006 CFT014
     C***********SCSARD    PARM SCSARD    DSFDY                    CEU006 CFT014
     C***********          MOVE 'N'       CEU006  1                CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C***********@RTCD     IFEQ *BLANKS                            CEU006 CFT014
     C***********          MOVE 'Y'       CEU006                   CEU006 CFT014
     C***********          ELSE                                    CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C***database*error*(return*code*other*than**NRF)************* CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C***********@RTCD     IFNE '*NRF   '                          CEU006 CFT014
     C***********          MOVEL'SCSARDPD'W0FILE                   CEU006 CFT014
     C***********          MOVEL'*CALL'   W0KEY      ************* CEU006 CFT014
     C***********          Z-ADD18        W0ERNB     * DB ERROR 18 CEU006 CFT014
     C***********          MOVEL'MEM5003' W0MSGD     ************* CEU006 CFT014
     C***********          MOVEL'MIDAS  ' W0MSGF                   CEU006 CFT014
     C***********          EXSR SRERR                              CEU006 CFT014
     C***********          ENDIF                                   CEU006 CFT014
     C***********          ENDIF                                   CEU006 CFT014
     C***********                                                  CEU006 CFT014
     C***Retrieve*the*text*for*Transfer*Commission*using*MEC1150** S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********          CALL 'MEC1150'              9090        S01499 CFT014
     C***********          PARM 'FTM2544' #MSGID                   S01499 CFT014
     C***********          PARM 'FTUSRMSG'#MSGF                    S01499 CFT014
     C***********          PARM           #MSDTA                   S01499 CFT014
     C***********          PARM *BLANKS   #MSTX1                   S01499 CFT014
     C***********          PARM *BLANKS   #MSTX2                   S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********          MOVEL#MSTX1    WVAT1  20                S01499 CFT014
     C***********                                                  S01499 CFT014
     C***Retrieve*the*text*for*Telex*Charge*using*MEC1150********* S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********          CALL 'MEC1150'              9090        S01499 CFT014
     C***********          PARM 'FTM2545' #MSGID                   S01499 CFT014
     C***********          PARM 'FTUSRMSG'#MSGF                    S01499 CFT014
     C***********          PARM           #MSDTA                   S01499 CFT014
     C***********          PARM *BLANKS   #MSTX1                   S01499 CFT014
     C***********          PARM *BLANKS   #MSTX2                   S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********          MOVEL#MSTX1    WVAT2  20                S01499 CFT014
     C***********                                                  S01499 CFT014
     C***Retrieve*the*text*for*Cheque*Charge*using*MEC1150******** S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********          CALL 'MEC1150'              9090        S01499 CFT014
     C***********          PARM 'FTM2546' #MSGID                   S01499 CFT014
     C***********          PARM 'FTUSRMSG'#MSGF                    S01499 CFT014
     C***********          PARM           #MSDTA                   S01499 CFT014
     C***********          PARM *BLANKS   #MSTX1                   S01499 CFT014
     C***********          PARM *BLANKS   #MSTX2                   S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********          MOVEL#MSTX1    WVAT3  20                S01499 CFT014
     C***********                                                  S01499 CFT014
     C***Retrieve*the*text*for*Advice*charge*using*MEC1150******** S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********          CALL 'MEC1150'              9090        S01499 CFT014
     C***********          PARM 'FTM2551' #MSGID                   S01499 CFT014
     C***********          PARM 'FTUSRMSG'#MSGF                    S01499 CFT014
     C***********          PARM           #MSDTA                   S01499 CFT014
     C***********          PARM *BLANKS   #MSTX1                   S01499 CFT014
     C***********          PARM *BLANKS   #MSTX2                   S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********          MOVEL#MSTX1    WVAT4  20                S01499 CFT014
     C***********                                                  S01499 CFT014
     C***Retrieve*the*text*for*Telephone*charge*using*MEC1150***** S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********          CALL 'MEC1150'              9090        S01499 CFT014
     C***********          PARM 'FTM2552' #MSGID                   S01499 CFT014
     C***********          PARM 'FTUSRMSG'#MSGF                    S01499 CFT014
     C***********          PARM           #MSDTA                   S01499 CFT014
     C***********          PARM *BLANKS   #MSTX1                   S01499 CFT014
     C***********          PARM *BLANKS   #MSTX2                   S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********          MOVEL#MSTX1    WVAT5  20                S01499 CFT014
     C***********                                                  S01499 CFT014
     C***Retrieve*the*text*for*Miscellaneous*Charge*using*MEC1150* S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********          CALL 'MEC1150'              9090        S01499 CFT014
     C***********          PARM 'FTM2549' #MSGID                   S01499 CFT014
     C***********          PARM 'FTUSRMSG'#MSGF                    S01499 CFT014
     C***********          PARM           #MSDTA                   S01499 CFT014
     C***********          PARM *BLANKS   #MSTX1                   S01499 CFT014
     C***********          PARM *BLANKS   #MSTX2                   S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********          MOVEL#MSTX1    WVAT6  20                S01499 CFT014
     C***********                                                  S01499 CFT014
     C***Retrieve*the*text*for*FX/Change*Commission*using*MEC1150* S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********          CALL 'MEC1150'              9090        S01499 CFT014
     C***********          PARM 'FTM2550' #MSGID                   S01499 CFT014
     C***********          PARM 'FTUSRMSG'#MSGF                    S01499 CFT014
     C***********          PARM           #MSDTA                   S01499 CFT014
     C***********          PARM *BLANKS   #MSTX1                   S01499 CFT014
     C***********          PARM *BLANKS   #MSTX2                   S01499 CFT014
     C***********                                                  S01499 CFT014
     C***********          MOVEL#MSTX1    WVAT7  20                S01499 CFT014
      *                                                                   CFT014
      ** Access SAR details file to determine if CFT014 is switched ON.   CFT014
      *                                                                   CFT014
     C                     CALL 'AOSARDR0'                                CFT014
     C                     PARM *BLANKS   P@RTCD  7                       CFT014
     C                     PARM '*VERIFY 'P@OPTN  7                       CFT014
     C                     PARM 'CFT014'  P@SARD  6                       CFT014
     C           SCSARD    PARM SCSARD    DSFDY                           CFT014
      *                                                                   CFT014
      ** If core feature is switched ON, set a variable field to          CFT014
      ** condition the rest of the processing.                            CFT014
      *                                                                   CFT014
     C           P@RTCD    IFEQ *BLANKS                                   CFT014
     C                     MOVE 'Y'       CFT014  1                       CFT014
     C                     OPEN SDCTRYL2                                  CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C           P@RTCD    IFNE '*NRF   '                                 CFT014
     C                     Z-ADD001       W0ERNB                          CFT014
     C                     MOVEL'CFT014'  W0KEY                           CFT014
     C                     MOVEL'SCSARDPD'W0FILE                          CFT014
     C                     MOVEL'MEM5003' W0MSGD                          CFT014
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT014
     C                     EXSR SRERR                                     CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT009
      ** Access SAR details file to determine if CFT009 is switched ON.   CFT009
      *                                                                   CFT009
     C                     CALL 'AOSARDR0'                                CFT009
     C                     PARM *BLANKS   P@RTCD  7                       CFT009
     C                     PARM '*VERIFY 'P@OPTN  7                       CFT009
     C                     PARM 'CFT009'  P@SARD  6                       CFT009
     C           SCSARD    PARM SCSARD    DSFDY                           CFT009
      *                                                                   CFT009
      ** If core feature is switched ON, set a variable field to          CFT009
      ** condition the rest of the processing.                            CFT009
      *                                                                   CFT009
     C           P@RTCD    IFEQ *BLANKS                                   CFT009
     C                     MOVE 'Y'       CFT009  1                       CFT009
     C                     ELSE                                           CFT009
      *                                                                   CFT009
     C                     MOVE 'N'       CFT009  1                       CFT009
      *                                                                   CFT009
     C           P@RTCD    IFNE '*NRF   '                                 CFT009
     C                     Z-ADD002       W0ERNB                          CFT009
     C                     MOVEL'CFT009'  W0KEY                           CFT009
     C                     MOVEL'SCSARDPD'W0FILE                          CFT009
     C                     MOVEL'MEM5003' W0MSGD                          CFT009
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT009
     C                     EXSR SRERR                                     CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                                       CSW201
      ** Check if enhancement CSW201 is on                                                    CSW201
      *                                                                                       CSW201
     C                     CALL 'SWIF2001'             9090                                   CSW201
     C                     PARM *BLANKS   @RTCD                                               CSW201
      *                                                                                       CSW201
     C           *IN90     IFEQ '1'                                                           CSW201
     C                     MOVEL'SCSARDPD'W0FILE           ***************                    CSW201
     C                     MOVEL'CSW201'  W0KEY            * DB ERROR 10 *                    CSW201
     C                     Z-ADD10        W0ERNB           ***************                    CSW201
     C                     MOVEL'MEM5003' W0MSGD                                              CSW201
     C                     MOVEL'MIDAS  ' W0MSGF                                              CSW201
     C                     EXSR SRERR                                                         CSW201
     C                     ELSE                                                               CSW201
      *                                                                                       CSW201
     C           @RTCD     IFEQ 'CSW2001'                                                     CSW201
     C                     MOVE 'Y'       CSW201  1                                           CSW201
     C                     ELSE                                                               CSW201
     C                     MOVE 'N'       CSW201                                              CSW201
     C                     ENDIF                                                              CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW202
      ** Check if switchable feature CSW202 is switched on                                    CSW202
      *                                                                                       CSW202
     C                     CALL 'SWIF2002'                                                    CSW202
     C                     PARM *BLANKS   P@RTCD                                              CSW202
      *                                                                                       CSW202
     C           P@RTCD    IFEQ 'CSW2002'                                                     CSW202
     C                     MOVE 'Y'       CSW202  1                                           CSW202
     C                     ELSE                                                               CSW202
     C                     MOVE 'N'       CSW202                                              CSW202
     C                     ENDIF                                                              CSW202
      *                                                                                       CSW206
      ** Check if SWIFT Changes 2006 (CSW206) is installed                                    CSW206
      *                                                                                       CSW206
     C                     CALL 'SWIF2006'                                                    CSW206
     C                     PARM *BLANKS   P@RTCD                                              CSW206
      *                                                                                       CSW206
     C           P@RTCD    IFEQ 'CSW2006'                                                     CSW206
     C                     MOVE 'Y'       CSW206  1                                           CSW206
     C                     ELSE                                                               CSW206
     C                     MOVE 'N'       CSW206                                              CSW206
     C                     ENDIF                                                              CSW206
      *                                                                                       CSW202
      *
      *  Set up general codes for address checking
      *
     C                     MOVEL*BLANKS   ##ADCK  1
     C/COPY WNCPYSRC,FT0358C022
      *
      *  Unwind subroutine stack name
      *
     C           EXINIT    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
     C/COPY WNCPYSRC,FT0358DCPG
      *
      *  /Copy point for Calculations
      *
     C/EJECT
      *
      *  File and Program Error Processing
      *
     C/COPY FTCPYSRC,SRERRC
     C/EJECT
     O/COPY WNCPYSRC,FT0358DOPG
      *
      *  /Copy point for Outputs
      *
     O/EJECT
      *                                                                                       CSW202
      ** WICOR was amended to insert codeword REPA before CORT.                               CSW202
      *                                                                                       CSW202
**  CPY@ table
(c) Misys International Banking Systems Ltd. 2001
**  ALPHA                                                                 CFT014
ABCDEFGHIJKLMNOPQRSTUVWXYZ                                                CFT014
**  WICOR                                                                                     CSW201
SDVAINTCREPACORTBONLHOLDCHQBPHOBTELBPHONTELEPHOITELI                                   CSW201 CSW202
**  ALPHNU                                                                                    CSW202
ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789                                                          CSW202
