     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas FT Outgoing payments audit and report')          *
     F*****************************************************************
     F*                                                               *
     F*  Midas - Funds Transfer Module                                *
     F*                                                               *
     F*  FT0510 - Outgoing Payments Reporting                         *
     F*                                                               *
      *  (c) Finastra International Limited 2001                      *
     F*                                                               *
      *                                                               *
      *  Last Amend No. HUT110             Date 17Apr20               *
      *  Prev Amend No. MD046248           Date 27Oct17               *
      *                 MD034618           Date 24Jul15               *
      *                 CFT157             Date 29Aug14               *
      *                 CFT120             Date 28Sep12               *
      *                 CLE134             Date 01Aug12               *
      *                 CER059             Date 19Jul10               *
      *                 BUG23832A          Date 29May09               *
      *                 BUG23869           Date 30Apr09               *
      *                 BUG22580           Date 02Feb09               *
      *                 CER048             Date 19May08               *
      *                 CER047             Date 19May08               *
      *                 CER030             Date 09Jul08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 BUG25102           Date 22Jul09               *
      *                 CSW209             Date 01Apr09               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 246426             Date 27Mar07               *
      *                 BUG15232           Date 03Nov07               *
      *                 BUG14166           Date 22Jun07               *
      *                 CSW207             Date 14Jun07               *
      *                 247652             Date 09May07               *
      *                 235937             Date 27Nov06               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CRE026             Date 24May06               *
      *                 BUG12944A          Date 20Dec06               *
      *                 BUG12944           Date 19Dec06               *
      *                 224147             Date 04Oct06               *
      *                 GBO018             Date 18May04               *
      *                 CFT032             Date 11Sep06               *
      *                 BUG433             Date 05Dec05               *
      *                 CDL049             Date 07Jul06               *
      *                 CSD027             Date 09Dec05               *
      *                 BUG7985            Date 07Jul05               *
      *                 CER001             Date 25Apr05               *
      *                 TDA035             Date 02Apr04               *
      *                 CGL029             Date 01Sep03               *
      *                 CSW203             Date 26May03               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CFT009             Date 09Jun00               *
      * Midas DBA 3.04 -----------------------------------------------*
      *                 CFT014             Date 25May00               *
      * Midas DBA 3.03 -----------------------------------------------*
      *                 175479             Date 08Feb00               *
      * Midas DBA 3.02 -----------------------------------------------*
      *                 CFT004             Date 28Sep99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
     F*                 134117             DATE 18OCT98               *
     F*                 CEU006             DATE 01Apr98               *
     F*                 070846             DATE 21May96               *
      *                 S01408             Date 04Sep95               *
     F*                 084523             DATE 10MAR95               *
     F*                 082130             DATE 09FEB95               *
     F*                 074815             DATE 19JUL94               *
     F*                 S01499             DATE 06JUN94               *
     F*                 S01494             DATE 25MAY94               *
     F*                 068172             DATE 18DEC93               *
     F*                 S01435             DATE 08SEP93               *
     F*                 S01408             DATE 24JUN93               *
     F*                 055293             DATE 17MAY93               *
     F*                 S01414             DATE 29MAR93               *
     F*                 050920             DATE 19MAR91               *
     F*                 E25232             DATE 26JUN91               *
     F*                 E32872             DATE 30APR91               *
     F*                 S01117             DATE 04OCT90               *
     F*                 S01194             DATE 04OCT90               *
     F*                 E23052             DATE 02AUG90               *
     F*                 E21463             DATE 09JUL90               *
     F*                 E16477             DATE 27JUN90               *
     F*                                                               *
     F*---------------------------------------------------------------*
     F*                                                               *
      *  HUT110 - Upgrade HUT022 to FBM 2.1 SP22.                     *
      *           RTGS via SWIFT.                                     *
      *           Fix MD030805 no longer upgraded as it has been      *
      *           fixed under MD034618.  Added the following hooks:   *
      *           HUT110_016  HUT110_017  HUT110_018                  *
      *           HUT110_019  HUT110_020                              *
      *  MD046248 - Finastra Rebranding                               *
      *  MD034618 - CPF5004 I/O error was detected in FT0510P1 on     *
      *             P3DETL                                            *
      *  CFT157 - Stop FT Transaction after Authorisation.            *
      *  CFT120 - FT IN/OP - Charges to DR of Account Currency        *
      *  CLE134 - Past Due Call Loan Processing (Recompile)           *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  BUG23832A - Transaction Type code not reflected in report    *
      *  BUG23869 - Dump in FT0510P1 and FT0520P1                     *
      *  BUG22580 - Fields incorrectly labeled and lengths            *
      *           (Recompile)                                         *
      *  CER048 - German Features - Taxes (Recompile)                 *
      *  CER047 - German Features LF037-00 Reporting §24c KWG         *
      *           (Recompile)                                         *
      *  CER030 - Multicash German Feature                            *
      *  BUG25102 - Cover Message Information page not printed        *
      *  CSW209 - SWIFT 2009 Changes                                  *
     F*  246426 - Printer overflow. Recompile due to change Pinter    *
     F*           file.                                               *
      *  BUG15232 - Component FTC0510 failed for retail account       *
      *  BUG14166 - Incorrect length for P1ODMT (Recompile)           *
      *  CSW207 - SWIFT 2007 Changes                                  *
      *  247652 - DBASE 9 if ext file OPCHGC charge ccy blank         *
      *           BUG12944A incomplete.                               *
      *  235937 - Suppress database error in FT0315 for all fields    *
      *           that contain a SWIFT BIC ID which cannot be found   *
      *           in the BIC directory.                               *
      *  CRE026 - Consumer Banking (Recompile)                        *
      *  BUG12944A - FTC0510 00001 Failed                             *
      *  BUG12944 - FTC0510 00001 Failed                              *
     F*  224147 - Avoid overprinting at DEST'N field level            *
     F*         - Recompiled for changes in FT0510P1                  *
      *  GBO018 - Demand Drafts Printing                              *
      *         - Added core hooks: FT0510C014, FT0510C015.           *
      *  CFT032 - Account line in field 50X in MT103                  *
      *  BUG433 - Recompiled due to change in FTPCHGPD                *
      *  CDL049 - Addition of a Reference Rate field (recompile)      *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  BUG7985- Several components failed due to accessing TABLETR  *
      *  CER001 - LUX Upgrade to MidasPlus                            *
      *  TDA035 - RTS Signon changes for MidasPlus. (Recompile)       *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CSW203 - SWIFT 2003 Standards Update                         *
      *  CFT009 - FT Fees and Charge Development                      *
      *  CFT014 - Straight-through Processing Phase 2 MT103           *
      *           Messages Generation for FT.                         *
      *  175479 - Recompiled over changes in OTPAYDD                  *
     F*  CFT004 - International Bank Account Number                   *
     F*           New Account Type 'I' (IBAN)                         *
     F*  134117 - Display the Net Settle/Pay amount if charges to the *
     F*           debit of a/c field is equal to zero. FT0510P1 was   *
     F*           also changed. Apply fix 072595. Amend the fields    *
     F*           being moved into P1SMCC and P1PCCC in the code of   *
     F*           072595. In FT0510P1, the line 'WITH CHARGES' or     *
     F*           'LESS CHARGES' shows the settle/pay currency from   *
     F*           the previous page. Apply fix 111154.                *
      *  CEU006 - EMU FT Payments and Settlement.                     *
     F*  070846 - Suppress database error in FT0315 for deleted recs  *
     F*  S01408 - Addition of hooks FT0510CCP1                        *  *
     F*                             FT0510CCP2                        *  *
     F*                             FT0510CCP3                        *  *
     F*                             FT0510EEP1                        *  *
     F*                             FT0510IIP1                        *  *
     F*  084523 - NO DBERROR IF RECORD NOT FOUND FOR USER             *
     F*                                                               *
     F*  082130 - DO NOT INCLUDE DELETED PAYMENTS IN LIST MODE        *
     F*  074815 - Charge currency is sometimes incorrect              *
     F*           Fixed during development of S01494.                 *
     F*  S01499 - BLI V.A.T Processing                                *
     F*  S01494 - BLI Funds Transfer Enhancements                     *
     F*         - Move correct spool file name before                 *
     F*           calling ZSFILE.  (xEMP05)                           *
     F*  068172 - ADD 1 LINE TO SET XCCY TO SMCY BEFOR THE CALL TO    *
     F*           FT0315 FOR ORDERING CUSTOMER.  MOVE BACK PCCY TO    *
     F*           XCCY RIGHT AFTER THE CALL TO FT0315.                *
     F*  S01435 - Incoming Message Management.                        *
     F*  S01408 - Core hook FT0510CPLH added                          *
     F*         - Core hook FT0510FPG added                           *
     F*  055293 - Include Ordering Institution information            *
     F*  S01414 - Book Code and Profit Centre Incorporation.          *
     F*  050920 - TO ALLOW PAYMENT EVEN IF SWIFT ID IS NOT FOUND;     *
     F*           WARNING MESSAGE IS SENT.                            *
     F*  E25232 - INCLUDE OUTGOING PAYMENT REF                        *
     F*  E32872 - INCLUDE OVERRIDE FIELD                              *
     F*  S01117 - RELEASE 10 MULTIBRANCHING CHANGES                   *
     F*  S01194 - STANDING DATA CHANGES                               *
     F*  E23052 - AUTHORISING OFFICER FIELDS NOT CLEARED.             *
     F*  E21463 - THE MT100 CUSTOMER FIELD IS NOT SHOWN.              *
     F*  E16477 - IF  THE  SETTLEMENT  METHOD  IS SWIFT,              *
     F*           A  CUSTOMER  NUMBER  ENTERED  FOR THE               *
     F*           RECEIVING  BANK,  THE  ORDERING  BANK;              *
     F*           OR,  A   SWIFT  ADDRESS  ENTERED  FOR               *
     F*           THE   RECEIVER'S  CORRESPONDENT,  THE               *
     F*           ACCOUNT WITH BANK OR THE INTERMEDIARY               *
     F*           BANK  IS CONVERTED TO A SWIFT ADDRESS               *
     F*           AND A FULL ADDRESS.                                 *
     F*                                                               *
     F*****************************************************************
     F* ID F  C  H  L    FUNCTION OF INDICATORS
     F*
     F*       10      MULTIBRANCHING INDICATOR                            S01117
     F*       11      SYSTEM LEVEL INDICATOR                              S01117
     F*       12      DIRECT COB INDICATOR                                S01117
     F*       14      ORIGINATING/BOOKING BRANCH INDICATOR (ON IF ORIG BR)S01117
     F*       15      ORIGINATING BRANCH USED INDICATOR ON (SDGELRPD)  BR)S01117
     F*       20      FIRST CYCLE PROCESSING HAS BEEN DONE
     F*       21      THERE HAS BEEN OUTPUT
     F*       22      REGULAR PAYMENT PROCESSING                          S01494
     F*       23      CORE FEATURE S01494 IS SWITCHED ON                  S01494
     F*       24      CORE FEATURE S01499 IS SWITCHED ON                  S01499
     F*       50      AUDIT REPORT INDICATOR FOR REPORTING
      *  55    - Notified Delivery Amount is not zero.                    CEU006
      *  56    - Pay Delivery Amount is not zero.                         CEU006
     F*       70      Profit Centres In Use Flag                          S01414
      *       77      Switchable feature CFT014 is installed.             CFT014
      *       79      Switchable feature ULX043 is installed.                                 CER001
      *       88      Switchable feature CEU006 is installed.             CFT014
     F*       89      GENERAL WORK INDICATOR
     F********98******ZSYSTM,*DATE*FORMAT*MMDDYY*IF*ON.*                  S01117
     F********99******ZSYSTM,*INSTALLATION*CONTROL*DATA*RECORD*NOT*FOUND.*S01117
     F*       98      SYSTEM, DATE FORMAT MMDDYY IF ON.                   S01117
     F*       99      SYSTEM, INSTALLATION CONTROL DATA RECORD NOT FOUND. S01117
     F**
     F*     U7 & U8   DATABASE ERROR, REQUIRED RECORDS NOT FOUND.
     F*     U8 ONLY   FILE CONTROL ERROR
     F*****************************************************************
     F/EJECT
     F*OTPAY***IP**E***********K********DISK                              S01117
     FOTPAYBB IP  E           K        DISK                               S01117
     F*OTPAYZZ*IS**E********************DISK                              S01117
     FOTPAYZZ IF  E                    DISK                               S01117
     FOTPAYXL2IF  E           K        DISK                           UC  CFT014
      * Outgoing Payments Details Extension retrieval index               CFT014
      *                                                                   CFT014
     F/COPY WNCPYSRC,HUT110_016                                                               HUT110
     FTABFP   IF  E           K        DISK
     F            TABTB20F                          KIGNORE
     F            TABTG20F                          KIGNORE
     F************TABLETJF*************             KIGNORE               S01117
     F            TABLETLF                          KIGNORE
     F            TABLETPF                          KIGNORE
     F            TABLETHF                          KIGNORE               S01117
     F            TABTE10F                          KIGNORE               S01117
     F            TABTG40F                          KIGNORE               S01117
     F            TABLET5F                          KIGNORE               S01117
     FCLINT   IF  E           K        DISK
     F            CLINTCAF                          KIGNORE
     F**********  CLINTCBF    *************         KIGNORE               E16477
     F            CLINTSEF                          KIGNORE               S01117
     F            CLINTC1F                          KIGNORE               S01117
     F*MSADR***IF**E           K        DISK                        E16477S01194
     F************CLINTCBF                          KRENAMEFLINTCBF E16477S01194
     F*SDCUSTL7IF**E***********K        DISK                        S01194S01435
     F/COPY WNCPYSRC,HUT110_017                                                               HUT110
     FMUSER   IF  E           K        DISK
      *                                                                   CFT009
     FOTPAYXL0IF  E           K        DISK                               CFT009
      *                                                                   CFT009
     F*FT0510P2O***E********************PRINTER                           S01194
     FFT0510AUO   E                    PRINTER      KINFDS SPOOL2         S01194
     F*FT0510P1O***E********************PRINTER                           S01117
     F/COPY WNCPYSRC,FT0510F001
     FFT0510P1O   E                    PRINTER      KINFDS SPOOL1     UC  S01117
     FFTPCHGL0IF  E           K        DISK                               CFT009
     C*                                                                   055293
     C** Core hook for externalisation.                                   S01408
     C/COPY WNCPYSRC,FT0510FPG                                            S01408
     C*                                                                   S01408
     E                    CPY@    1   1 80
     E************        WARN    1   2 35                          050920S01435
     E                    WA1        15  1               UGFRMT SR.ARRY
     E                    WA2        20  1               UGFRMT SR.ARRY
     E                    ZYDY    4   4  4 0             ZDATE1/2 SR.ARRAY
     E                    ZMDY   13  13  3 0             ZDATE1/2 SR.ARRAY
     E                    ZMNM   12  12  3               ZDATE2 SR. ARRAY
     E*                                                                   S01408
     E/COPY WNCPYSRC,FT0510EEP1                                           S01408
     E                    IUL         7132                                                    CER001
      *                                                                                       CER001
      ** IBLC Extended informations array                                                     CER001
      *                                                                                       CER001
     E*                                                                   S01408
     E/COPY ZSRSRC,ZSEDITZ1                                               CEU006
     E/COPY ZSRSRC,ZEDITZ1                                                CFT009
      *                                                                   CEU006
     E                    DESC    1   5 30                                CFT009
     E/EJECT
     I*  DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
     ICPYR@#      DS
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
     I*
     I**  DATA AREA LDA - USED IN THE EVENT OF DATABASE ERRORS
     I*
     IDLDA        DS                            256
     I**************************************134 138 DBFILE                S01194
     I**************************************139 167 DBKEY                 S01194
     I**************************************168 175 DBPGM                 S01194
     I**************************************176 177 DBASE                 S01194
     I                                      134 141 DBFILE                S01194
     I                                      142 170 DBKEY                 S01194
     I                                      171 180 DBPGM                 S01194
     I                                      181 183 DBASE                 S01194
      **********                                                          S01435
      ********** Standardise to FT0515                                    S01435
      **********                                                          S01435
     I**********                                                    S01117S01435
     I***Data*structure for Ordering Customer field                 S01117S01435
     I*P1ORC1****  DS                            35                 S01117S01435
     I**********                             13  15 ORC1BR          S01117S01435
     I**********                                                    S01117S01435
     I***Data*structure for Destination field                       S01117S01435
     I*P1DST1****  DS                            35                 S01117S01435
     I**********                             16  18 DST1BR          S01117S01435
     I**********                                                    S01117S01435
      *                                                                   S01435
      ** Program data structure                                           S01435
     IDSPGM     ESDSY2PGDSP                                               S01435
      *                                                                                       CFT032
      ** Data Structure for Nostro Details                                                    CFT032
     ISDNOST    E DSSDNOSTPD                                                                  CFT032
     I              QQACCD                          WQACCD                                    CFT032
      *                                                                                       CFT032
      ** Data Structure for Customer Details                                                  CFT032
     ISDCUST    E DSSDCUSTPD                                                                  CFT032
     I              QQDFAC                          WQDFAC                                    CFT032
      *                                                                                       CFT032
      ** Data Structure for Counterparty Nostros                                              CFT032
     ISDCNST    E DSSDCNSTPD                                                                  CFT032
      *                                                                                       CFT032
      ** Data Structure for Counterparty Nostros                                              CFT032
     IMEBICD    E DSMEBICDPD                                                                  CFT032
      *                                                                                       CFT032
      **  Data Structure for Bank Details Access Program                                      CFT032
     ISDBANK    E DSSDBANKPD                                                                  CFT032
      *                                                                                       CFT032
     IWCDET       DS                             24                                           CFT032
     I                                        1   6 WDCNUM                                    CFT032
     I                                        7   9 WDCCY                                     CFT032
     I                                       10  190WDACOD                                    CFT032
     I                                       20  210WDACSQ                                    CFT032
     I                                       22  24 WDBRCA                                    CFT032
      *                                                                                       CFT032
     IWACCN       DS                            573                                           CFT032
     I                                        2   7 WWCNUM                                    CFT032
     I                                        8  10 WWCCY                                     CFT032
     I                                       11  140QQACOD                                    CFT032
     I                                       15  160WWACSQ                                    CFT032
     I                                       23  25 WWBRCA                                    CFT032
     I                                      554 5630WWACOD                                    CFT032
      *                                                                   S01435
      *****************************************************************   S01435
      *  Data Structures for addresses.                                   S01435
      *                                                                   S01435
      ** OUT data structures (printout)                                   S01435
      *                                                                   S01435
      ** Receivers correspondent                                          S01435
     IP1RCDS      DS                                                      S01435
     I                                        1  35 P1RCO1                S01435
     I                                       36  70 P1RCO2                S01435
     I                                       71 105 P1RCO3                S01435
     I                                      106 140 P1RCO4                S01435
     I                                      141 175 P1RCO5                S01435
      *                                                                   S01435
      ** Ordering Customer                                                S01435
     IP1ORDS      DS                                                      S01435
     I                                        1  35 P1ORC1                S01435
     I                                       36  70 P1ORC2                S01435
     I                                       71 105 P1ORC3                S01435
     I                                      106 140 P1ORC4                S01435
     I                                      141 175 P1ORC5                S01435
      *                                                                   S01435
      ** Receiving Bank                                                   S01435
     IP1DSDS      DS                                                      S01435
     I                                        1  35 P1DST1                S01435
     I                                       36  70 P1DST2                S01435
     I                                       71 105 P1DST3                S01435
     I                                      106 140 P1DST4                S01435
     I                                      141 175 P1DST5                S01435
      *                                                                   S01435
      ** Account with Bank                                                S01435
     IP1ACDS      DS                                                      S01435
     I                                        1  35 P1ACB1                S01435
     I                                       36  70 P1ACB2                S01435
     I                                       71 105 P1ACB3                S01435
     I                                      106 140 P1ACB4                S01435
     I                                      141 175 P1ACB5                S01435
      *                                                                   S01435
      ** Beneficiary Customer                                             S01435
     IP1BNDS      DS                                                      S01435
     I                                        1  35 P1BNC1                S01435
     I                                       36  70 P1BNC2                S01435
     I                                       71 105 P1BNC3                S01435
     I                                      106 140 P1BNC4                S01435
     I                                      141 175 P1BNC5                S01435
      *                                                                   S01435
      ** Senders correspondent                                            S01435
     IP1SNDS      DS                                                      S01435
     I                                        1  35 P1SNC1                S01435
     I                                       36  70 P1SNC2                S01435
     I                                       71 105 P1SNC3                S01435
     I                                      106 140 P1SNC4                S01435
     I                                      141 175 P1SNC5                S01435
      *                                                                   S01435
      ** Ordering Bank                                                    S01435
     IP1OBDS      DS                                                      S01435
     I                                        1  35 P1ORB1                S01435
     I                                       36  70 P1ORB2                S01435
     I                                       71 105 P1ORB3                S01435
     I                                      106 140 P1ORB4                S01435
     I                                      141 175 P1ORB5                S01435
      *                                                                   S01435
      ** Intermediary Bank                                                S01435
     IP1INDS      DS                                                      S01435
     I                                        1  35 P1INB1                S01435
     I                                       36  70 P1INB2                S01435
     I                                       71 105 P1INB3                S01435
     I                                      106 140 P1INB4                S01435
     I                                      141 175 P1INB5                S01435
      *                                                                   S01435
      *                                                                   S01435
      ** IN data structures (file)                                        S01435
      *                                                                   S01435
      ** Receivers correspondent                                          S01435
     IRCINDS      DS                                                      S01435
     I                                        1  35 RCO1                  S01435
     I                                       36  70 RCO2                  S01435
     I                                       71 105 RCO3                  S01435
     I                                      106 140 RCO4                  S01435
     I                                      141 175 RCO5                  S01435
      *                                                                   S01435
      ** Ordering Customer                                                S01435
     IORINDS      DS                            175                       S01435
     I                                        1  35 ORC1                  S01435
     I                                       36  70 ORC2                  S01435
     I                                       71 105 ORC3                  S01435
     I                                      106 140 ORC4                  S01435
     I                                      141 175 ORC5                                      CFT032
      *                                                                   S01435
      ** Receiving Bank                                                   S01435
     IDSINDS      DS                            175                       S01435
     I                                        1  35 DST1                  S01435
     I                                       36  70 DST2                  S01435
     I                                       71 105 DST3                  S01435
     I                                      106 140 DST4                  S01435
      *                                                                   S01435
      ** Account with Bank                                                S01435
     IACINDS      DS                                                      S01435
     I                                        1  35 ACB1                  S01435
     I                                       36  70 ACB2                  S01435
     I                                       71 105 ACB3                  S01435
     I                                      106 140 ACB4                  S01435
     I                                      141 175 ACB5                  S01435
      *                                                                   S01435
      ** Beneficiary Customer                                             S01435
     IBNINDS      DS                                                      S01435
     I                                        1  35 BNC1                  S01435
     I                                       36  70 BNC2                  S01435
     I                                       71 105 BNC3                  S01435
     I                                      106 140 BNC4                  S01435
     I                                      141 175 BNC5                  S01435
      *                                                                   S01435
      ** Intermediary Bank                                                S01435
     IININDS      DS                                                      S01435
     I                                        1  35 INB1                  S01435
     I                                       36  70 INB2                  S01435
     I                                       71 105 INB3                  S01435
     I                                      106 140 INB4                  S01435
     I                                      141 175 INB5                  S01435
      *                                                                   S01435
      ** Split name into components.                                      S01435
     IXNAMDS      DS                            175                       S01435
     I**********                              1  12 XACCT                              S01435 CGL029
     I**********                             13  15 XBRCA                              S01435 CGL029
     I                                        1  18 XACCT                                     CGL029
     I                                       19  21 XBRCA                                     CGL029
      *                                                                   S01435
      **            address lines 2 - 5.                                  S01435
     I                                       36 175 XADDS                 S01435
      *                                                                   S01435
      ** to define XTYPE.                                                 S01435
     IXTYPE       DS                              1                       S01435
      *                                                                   S01435
      *****************************************************************   S01435
     I** INFDS for P1 printer file .                                      S01117
     ISPOOL1      DS                                                      S01117
     I                                       83  92 SFILE1                S01117
     I                                    B 123 1240SFNUM1                S01117
     I                                    B 188 1890OFLOW1                                  MD034618
     I                                    B 367 3680CURLN1                                  MD034618
     I*                                                                   S01194
     I** INFDS for AU printer file                                        S01194
     ISPOOL2      DS                                                      S01194
     I                                       83  92 SFILE2                S01194
     I                                    B 123 1240SFNUM2                S01194
     I*                                                                   S01194
     ISDGELR    E DSSDGELRPD                                              S01194
     I*External data structure for General Ledger Details                 S01194
     I*                                                                   S01194
     ISDFTFR    E DSSDFTFRPD                                              S01435
      *                                                                   S01435
      * Funds Transfer Details *                                          S01435
      *                                                                   S01435
     ISCSARD    E DSSCSARDPD                                              S01494
     I** External data structure for SAR file details                     S01494
     IDSFDY     E DSDSFDY                                                 S01194
     I*1st DS for access program , short data structure                   S01194
     I*                                                                   S01194
     IDSSDY     E DSDSSDY                                                 CFT014
     I* 2ND DS for access program , long data structure                   CFT014
     ISDCURR    E DSSDCURRPD                                              CFT014
     I*External Data structure for currencies file                        CFT014
      *                                                                                      BUG7985
     ISDBRCH    E DSSDBRCHPD                                                                 BUG7985
      ** Midas SD Branch Codes                                                               BUG7985
      *                                                                                      BUG7985
      **  Data Structure for Additional Cust Details Access Program                           CSW207
     ISDNAHO    E DSSDNAHOPD                                                                  CSW207
      *                                                                                       CSW207
      /EJECT                                                              S01435
     IW8FT        DS                            128                       S01435
      *                                                                   S01435
      * Address data structure                                            S01435
      *                                                                   S01435
      * Currency                                                          S01435
     I                                        1   3 W8CCY                 S01435
      * Settlement Type                                                   S01435
     I                                        4   5 W8STMT                S01435
      * Mandatory Text - convert BIC identifiers                          S01435
     I                                        6   6 W8MTXT                S01435
      * Message Tag                                                       S01435
     I                                        7  11 W8MTAG                S01435
      * Construct of data in field                                        S01435
     I                                       12  12 W8TYPE                S01435
      * Number of Lines available                                         S01435
     I                                       13  140W8NLIN                S01435
      * Network and Message Type                                          S01435
     I                                       15  20 W8NWRK                S01435
     I                                       21  23 W8MTPY                S01435
      * Calling Program                                                   S01435
     I                                       24  33 W8CPGM                S01435
      * Action *PRINT/*ENQ/*MSG GEN                                       S01435
     I                                       34  41 W8ACT                 S01435
      * Critical reporting - Database error if 'Y'                        S01435
      * If no BIC directory and BIC entered no error                      S01435
     I                                       42  42 W8CRIT                S01435
      * Force Midas Address - where possible                              S01435
     I                                       43  43 W8MADD                S01435
      * If Retail get first address from account                          S01435
     I                                       44  44 W8RTAD                S01435
      * Alternative Address                                               S01435
     I                                       45  45 W8ALTN                S01435
      * Address type selected in W0MSG                                    S01435
     I                                       46  46 W8ADTP                S01435
      *                                                                   S01435
     IDSMTR       DS                                                      S01435
      *                                                                   S01435
      *  Define fields for message transalation                           S01435
      *                                                                   S01435
     I                                        1 132 #MSDTA                S01435
     I                                       15  30 #MPREF                S01435
     I                                    P   1   20#MPART                S01435
     I                                      133 264 #MSTX1                S01435
     I#MSTX2      DS                                                      S01435
     I                                        1 256 #MSTXA                S01435
     I                                      257 512 #MSTXB                S01435
     I*                                                                   S01408
     I/COPY WNCPYSRC,FT0510IIP1                                           S01408
      ** FT OUTGOING PAYMENTS EXTENSION FILE                                                  CSW209
     IOTPAYX    E DSOTPAYXPD                                                                  CSW209
      *                                                                                       CSW209
      ** Ordering Customer (Cover)                                                            CSW209
     I                                      8761050 WPCOC1                                    CSW209
      ** Ordering Institution (Cover)                                                         CSW209
     I                                     10521226 WPCOB1                                    CSW209
      ** Intermediary Institution (Cover)                                                     CSW209
     I                                     12281402 WPCIB1                                    CSW209
      ** Account with Institution (Cover)                                                     CSW209
     I                                     14041578 WPCAB1                                    CSW209
      ** Beneficiary Customer (Cover)                                                         CSW209
     I                                     15801754 WPCBC1                                    CSW209
      ** Remittance Information (Cover)                                                       CSW209
     I                                     17551894 WPCDP1                                    CSW209
      ** Sender to Receiver Information (Cover B)                                             CSW209
     I                                     18952104 WPCBB1                                    CSW209
      ** Instructed Currency (Cover)                                                          CSW209
     I                                     21052107 WPCICY                                    CSW209
      ** Instructed Amount (Cover)                                                            CSW209
     I                                     210821210WPCIAM                                    CSW209
      ** Sender to Receiver Information (Cover A)                                             CSW209
     I                                     21222331 WPOCB1                                    CSW209
      *                                                                                       CSW209
     ISDMMOD    E DSSDMMODPD                                                                  CER001
      *                                                                                       CER001
      ** Dummy record format for access to Midas modules details                              CER001
      *                                                                                       CER001
     IILLINE      DS                            396                                           CER001
      *                                                                                       CER001
      ** Extended informations from IBLC 2002                                                 CER001
      *                                                                                       CER001
     I                                        1 132 ILLIN1                                    CER001
     I                                      133 264 ILLIN2                                    CER001
     I                                      265 396 ILLIN3                                    CER001
     I*                                                                   S01408
      *                                                                   CEU006
     I/COPY ZSRSRC,ZSEDITZ2                                               CEU006
     I/EJECT
     C                     MOVEACPY@      BIS@   80
     C*****************************************************************
     C*                 AA-MAINLINE-PROCESSING                        *
     C*                                                               *
     C*  FUNCTION : TO CONTROL THE PROCESSING OF EACH RECORD READ VIA *
     C*             THE LOGIC CYCLE.                                  *
     C*                                                               *
     C*  CALLS :    CAINIT                                            *
     C*             CCDETL                                            *
     C*             CELAST                                            *
     C*             GLZADD                                            *
     C*                                                               *
     C*  CALLED BY: NONE                                              *
     C*                                                               *
     C*****************************************************************
     C*
     C** SAVE FIELDS FROM INPUT FILES WHICH MAY BE OVERWRITTEN BY OTHER
     C** FILE ACCESSES
     C*
     C                     MOVELRECI      OTRECI
     C                     Z-ADDLCD       OTLCD
     C                     MOVELCHTP      OTCHTP
     C*
     C** PERFORM INITIAL PROCESSING IF FIRST CYCLE **
     C*
     C           *IN20     IFEQ '0'
     C                     EXSR CAINIT
     C                     END
     C*                                                                   S01117
     C* SETON LR IF CHANGE OF BRANCH AND @PLEV='B'                        S01117
     C*                                                                   S01117
     C           @PLEV     IFEQ 'B'                                       S01117
     C           @PENT     ANDNE'ALL'                                     S01117
     C           *IN14     IFEQ '0'                                       S01117
     C           BRCA      ANDNE@PENT                                     S01117
     C           *IN14     OREQ '1'                                       S01117
     C           ORBR      ANDNE@PENT                                     S01117
     C                     SETON                       LR                 S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C/COPY WNCPYSRC,FT0510C001
     C*
     C** FOR DETAIL RECORDS :
     C** WRITE A PAGE ON THE DETAIL REPORT IF REPORT TYPE IS 'LIST'
     C** AND THE PAYMENT IS NOT DELETED OR MATURED                        082130
     C** OR REPORT TYPE IS 'AUDIT LIST' & LAST CHANGE DATE IS EQUAL
     C** TO THE SYSTEM DATE
     C** ...AND IF THE TRANSACTION IS FOR OUTGOING PAYMENTS, SKIP         S01494
     C**    REPORTING OF PAYMENT TYPE 'RP'                                S01494
     C*
     C***********OTRECI****IFNE 'Z'                                       S01117
     C           *INLR     IFNE '1'                                       S01117
     C*                                                                   S01494
     C           *IN22     IFEQ '0'                                       S01494
     C           PYTP      ANDNE'RP'                                      S01494
     C           *IN22     OREQ '1'                                       S01494
     C*                                                                   S01494
     C           PARM1     IFNE 'A'                         -NOT AUDIT
     C           OTRECI    IFNE 'C'                                       C1
     C           OTRECI    ANDNE'M'                                       C1
     C           OTCHTP    ANDNE'D'                                       082130
     C                     EXSR CCDETL                       LIST.
     C                     END                                            C1
     C                     ELSE
     C           OTLCD     IFEQ RUND                        -AUDIT LIST
     C                     EXSR CCDETL
     C                     END
     C                     END
     C                     END
     C                     END                                            S01494
     C/COPY WNCPYSRC,FT0510C002
     C*
     C** ACCUMULATE VALUES FOR CONTROL CHECK USING SYSTEM SUBROUTINE
     C** GLZADD
     C*
     C***********OTRECI****IFNE 'Z'                                       S01117
     C           *INLR     IFNE '1'                                       S01117
     C*********************ADD  1         P2CLNO                          S01194
     C                     ADD  1         AUCLNO                          S01194
     C                     MOVE SMAM      ZZAMT
     C                     EXSR GLZADD
     C                     END
     C*
     C** PERFORM CONTROL REPORT CHECKS IF TRAILER RECORD
     C*
     C***********OTRECI****IFEQ 'Z'                                       S01117
     C*********************EXSR CELAST                                    S01117
     CLRN20                EXSR CAINIT                                    S01117
     CLR                   EXSR CELAST                                    S01117
     C*********************END                                            S01117
     C*
     C*          *****     ***
     C           AAEND     TAG
     C*          *****     ***
     C** END OF MAINLINE PROCESSING
     C*
     C/EJECT
     C           CAINIT    BEGSR
     C*          ******    *****
     C*
     C*****************************************************************
     C*                 CA-INITIAL-PROCESSING                         *
     C*                                                               *
     C*  FUNCTION : TO PERFORM PROCESSING ONLY REQUIRED ONCE,ON FIRST *
     C*             CYCLE OF PROGRAM.                                 *
     C*                                                               *
     C*  CALLS :    UATBCN                                            *
     C*             UEABRT                                            *
     C**************ZSYSTM                                            *   S01117
     C*             SYSTEM                                            *   S01117
     C*                                                               *
     C*  CALLED BY: AAMAIN                                            *
     C*                                                               *
     C*****************************************************************
     C*
     C** DECLARE ENTRY PARAMETER - REPORT TYPE
     C*
     C           *ENTRY    PLIST
     C                     PARM           @PSEQ   5                       S01117
     C                     PARM           @PLEV   1                       S01117
     C                     PARM           @PENT   3                       S01117
     C                     PARM           PARM1   1
     C                     PARM           WRNTP   7
      *                                                                                       CFT032
      ** Parameter list for AONOSTR0                                                          CFT032
      *                                                                                       CFT032
     C           #ANOST    PLIST                                                              CFT032
     C                     PARM *BLANK    @RTCD                                               CFT032
     C                     PARM '*KEY   ' @OPTN                                               CFT032
     C                     PARM *BLANK    @KEYA   6                                           CFT032
     C                     PARM           @KEYB   3                                           CFT032
     C                     PARM *BLANK    @KEYC  10                                           CFT032
     C                     PARM *BLANK    @KEYD   2                                           CFT032
     C                     PARM           @KEYE   2                                           CFT032
     C                     PARM *BLANKS   @KEYG   3                                           CFT032
     C                     PARM *BLANKS   @KEYH  10                                           CFT032
     C                     PARM *BLANKS   @KEYI   1                                           CFT032
     C           SDNOST    PARM SDNOST    DSFDY                                               CFT032
      *                                                                                       CFT032
      ** Parameter list for AOACCTR0                                                          CFT032
      *                                                                                       CFT032
     C           #AACCT    PLIST                                                              CFT032
     C                     PARM *BLANKS   @RTCD                                               CFT032
     C                     PARM '*KEY'    @OPTN                                               CFT032
     C                     PARM           @RETL  10                                           CFT032
     C                     PARM           @CNNM   6                                           CFT032
     C                     PARM           @CUCD   3                                           CFT032
     C                     PARM           @ACCD  10                                           CFT032
     C                     PARM           @ACSQ   2                                           CFT032
     C                     PARM           @BRCD   3                                           CFT032
     C           WACCN     PARM WACCN     DSSDY                                               CFT032
      *                                                                                       CFT032
      ** Call Access Program for Bank Details                                                 CFT032
      *                                                                                       CFT032
     C                     CALL 'AOBANKR0'                                                    CFT032
     C                     PARM *BLANKS   @RTCD                                               CFT032
     C                     PARM '*FIRST ' @OPTN                                               CFT032
     C           SDBANK    PARM SDBANK    DSFDY                                               CFT032
      *                                                                                       CFT032
      ** Handle Database Error                                                                CFT032
      *                                                                                       CFT032
     C           @RTCD     IFNE *BLANK                                                        CFT032
     C                     MOVEL'SDBANKPD'WDBFIL                                              CFT032
     C                     MOVEL'*FIRST ' WDBKEY                                              CFT032
     C                     MOVEL'29'      WDBASE                                              CFT032
     C                     EXSR UEABRT                                                        CFT032
     C                     ENDIF                                                              CFT032
     C*
     C** SETUP REPORT HEADING
     C*
     C           PARM1     IFEQ 'A'
     C                     MOVEL'AUDIT'   P1HEAD
     C                     MOVE 'LIST'    P1HEAD
     C                     MOVEL'~~~~~'   P1DASH
     C                     MOVE '~~~~~'   P1DASH
     C                     ELSE
     C                     MOVEL'LIST'    P1HEAD
     C                     MOVEL'~~~~'    P1DASH
     C                     END
     C*                                                                   S01494
     C** Set on indicator if regular payment                              S01494
     C*                                                                   S01494
     C                     SELEC                                          S01494
     C           WRNTP     WHEQ 'FTM2511'                                 S01494
     C                     MOVE '0'       *IN22                           S01494
     C           WRNTP     WHEQ 'FTM2512'                                 S01494
     C           WRNTP     OREQ 'FTM2515'                                 S01494
     C                     MOVE '1'       *IN22                           S01494
     C           WRNTP     WHEQ 'FTM2516'                                 S01494
     C                     MOVE '1'       *IN14                           S01494
     C                     MOVE '1'       *IN22                           S01494
     C                     ENDSL                                          S01494
     C*
     C** DECLARE SIMILAR FIELDS
     C*
     C           *LIKE     DEFN DBFILE    WDBFIL
     C           *LIKE     DEFN DBKEY     WDBKEY
     C           *LIKE     DEFN DBASE     WDBASE
     C*
     C           *LIKE     DEFN RECI      OTRECI
     C           *LIKE     DEFN LCD       OTLCD
     C           *LIKE     DEFN CHTP      OTCHTP
     C*
     C***CALL*ZSYSTM*TO*ACCESS*I.C.D.R.*1*ON*TABLE*FILE*                  S01117
     C** CALL SYSTEM TO ACCESS I.C.D.R. 1 ON TABLE FILE                   S01117
     C*
     C*********************EXSR ZSYSTM                                    S01117
     C                     EXSR SYSTEM                                    S01117
     C*
     C** CHECK IF DATABASE ERROR OCCURRED
     C*
     C           *IN99     IFEQ '1'
     C                     MOVEL'TABLE'   WDBFIL
     C                     MOVELZTABKY    WDBKEY
     C                     MOVEL'01'      WDBASE
     C                     EXSR UEABRT                     *ABORT PGM*
     C                     END
     C*
     C** SETUP REPORT TITLES & RUN-DATES
     C*
     C                     MOVELTITL      P1TITL
     C*********************MOVELTITL      P2TITL                          S01194
     C                     MOVELTITL      AUTITL                          S01194
     C                     MOVELRUNA      P1DATE
     C*********************MOVELRUNA      P2DATE                          S01194
     C                     MOVELRUNA      AUDATE                          S01194
     C*
     C**********           MOVE *BLANKS   BLNK10 10                                           CGL029
     C**********           MOVE *BLANKS   BLNK2   2                                           CGL029
     C                     MOVE *BLANKS   BLNK10 16                                           CGL029
     C                     MOVE *BLANKS   BLNK2   8                                           CGL029
     C*
     C** CALL UATBCN TO ACCESS I.C.D.R. 2 ON TABLE FILE
     C*
     C                     MOVEL*BLANKS   ZTABKY
     C                     MOVEL'01'      ZTABKY
     C                     MOVE '11'      ZTABKY
     C                     EXSR UATBCN
     C*
     C** CHECK IF DATABASE ERROR OCCURRED
     C*
     C           *IN89     IFEQ '1'
     C                     MOVEL'TABLE'   WDBFIL
     C                     MOVELZTABKY    WDBKEY
     C                     MOVEL'02'      WDBASE
     C                     EXSR UEABRT                     *ABORT PGM*
     C                     END
     C*                                                                   S01117
     C** SETON MULTIBRANCHING INDICATOR                                   S01117
     C*                                                                   S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C                     SETON                     10                   S01117
     C                     END                                            S01117
     C*
     C** Call to General Ledger access pgm                                S01194
     C*                                                                   S01194
     C**********           CALL 'AOGELRR0'                                             S01194 CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C********** SDGELR    PARM SDGELR    DSFDY                                        S01194 CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     MOVEL'SDGELRPD'WDBFIL           ***************S01194
     C                     MOVEL@OPTN     WDBKEY           * DB ERROR 20 *S01194
     C                     MOVEL'020'     WDBASE           ***************S01194
     C                     EXSR UEABRT                                    S01194
     C                     ELSE                                           S01194
      *
     C           BKOBRU    IFEQ 'Y'                                       S01194
     C                     MOVE '1'       *IN15                           S01194
     C                     END                                            S01194
      *                                                                   S01414
      *  Check if Profit Centres are used and set screen attributes       S01414
      *                                                                   S01414
     C           BKPRCU    IFEQ 'Y'                                       S01414
     C                     MOVE '1'       *IN70                           S01414
     C                     END                                            S01414
      *                                                                   S01414
     C                     END                                            S01194
      *                                                                   S01435
      ** Read SDFTFRPD                                                    S01435
      *                                                                   S01435
     C                     CALL 'AOFTFRR0'             90                 S01435
     C                     PARM *BLANKS   P@RTCD  7        B:Return code  S01435
     C                     PARM '*FIRST ' P@OPTN  7        I:Option       S01435
     C           SDFTFR    PARM SDFTFR    DSFDY                           S01435
      *                                                                   S01435
      *  If return with an error (LR seton in called program) then        S01435
      *  process for database error.                                      S01435
      *                                                                   S01435
     C           *IN90     IFEQ '1'                                       S01435
     C           P@RTCD    OREQ '*ERROR*'                                 S01435
     C                     MOVEL'SDFTFRPD'WDBFIL           ***************S01435
     C                     MOVELP@OPTN    WDBKEY           * DB ERROR 16 *S01435
     C                     MOVEL'50'      WDBASE           ***************S01435
     C                     EXSR UEABRT                                    S01435
     C                     END                                            S01435
      *                                                                   S01435
      * Get message text for Account with Bank field                      S01435
      *                                                                   S01435
     C                     CALL 'MEC1150'              9090               S01435
     C                     PARM 'FTM2350 '#MSGID  7                       S01435
     C                     PARM 'FTUSRMSG'#MSGF  10                       S01435
     C                     PARM           #MSDTA                          S01435
     C                     PARM *BLANKS   #MSTX1                          S01435
     C                     PARM *BLANKS   #MSTX2                          S01435
      *                                                                   S01435
     C                     MOVEL#MSTX1    #IMSG  35                       S01435
     C*                                                                   S01194
     C** CALL UATBCN TO ACCESS CURRENCY RECORD FOR BASE CURRENCY
     C*
     C                     MOVEL*BLANKS   ZTABKY
     C                     MOVEL'20'      ZTABKY
     C                     MOVELBCCY      WA4     4
     C                     MOVE '1'       WA4
     C                     MOVE WA4       ZTABKY
     C                     EXSR UATBCN
     C*
     C** CHECK IF DATABASE ERROR OCCURRED
     C*
     C           *IN89     IFEQ '1'
     C                     MOVEL'TABLE'   WDBFIL
     C                     MOVELZTABKY    WDBKEY
     C                     MOVEL'03'      WDBASE
     C                     EXSR UEABRT                     *ABORT PGM*
     C                     END
     C*
     C** STORE NUMBER OF DECIMAL PLACES FOR BASE CURRENCY
     C*
     C                     Z-ADDCDP       SVBCDP  10
      *                                                                   S01435
      ** Call UATBCN to Access local currency record                      S01435
      *                                                                   S01435
     C                     MOVEL*BLANKS   ZTABKY                          S01435
     C                     MOVEL'20'      ZTABKY                          S01435
     C                     MOVELLOCY      WA4                             S01435
     C                     MOVE '1'       WA4                             S01435
     C                     MOVE WA4       ZTABKY                          S01435
     C                     EXSR UATBCN                                    S01435
      *                                                                   S01435
      ** Check if database error occurred                                 S01435
      *                                                                   S01435
     C           *IN89     IFEQ '1'                                       S01435
     C                     MOVEL'TABLE'   WDBFIL                          S01435
     C                     MOVELZTABKY    WDBKEY                          S01435
     C                     MOVEL'51'      WDBASE                          S01435
     C                     EXSR UEABRT                     *ABORT PGM*    S01435
     C                     END                                            S01435
      *                                                                   S01435
      ** Store number of decimal places for base currency                 S01435
      *                                                                   S01435
     C                     Z-ADDCDP       SVLCDP  10                      S01435
     C*                                                                   S01494
     C** Access SAR details file to determine if S01494 is switched ON    S01494
     C*                                                                   S01494
     C                     MOVE '0'       *IN23                           S01494
     C                     CALL 'AOSARDR0'                                S01494
     C                     PARM *BLANKS   @RTCD   7                       S01494
     C                     PARM '*VERIFY' @OPTN   7                       S01494
     C                     PARM 'S01494'  @SARD   6                       S01494
     C           SCSARD    PARM SCSARD    DSFDY                           S01494
     C*                                                                   S01494
     C** If core feature is switched ON, set a variable field to          S01494
     C** condition the rest of the processing                             S01494
     C*                                                                   S01494
     C           @RTCD     IFEQ *BLANKS                                   S01494
     C                     MOVE '1'       *IN23                           S01494
     C                     ELSE                                           S01494
     C*                                                                   S01494
     C** else, database error (return code other than *NRF)               S01494
     C*                                                                   S01494
     C           @RTCD     IFNE '*NRF   '                                 S01494
     C                     MOVEL'SCSARDPD'WDBFIL                          S01494
     C                     MOVEL'*VERIFY' WDBKEY                          S01494
     C                     MOVEL'40'      WDBASE                          S01494
     C                     EXSR UEABRT                     *ABORT PGM*    S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C*                                                                   S01499
     C** Access SAR details file to determine if S01499 is switched ON    S01499
     C*                                                                   S01499
     C                     MOVE '0'       *IN24                           S01499
     C                     CALL 'AOSARDR0'                                S01499
     C                     PARM *BLANKS   @RTCD   7                       S01499
     C                     PARM '*VERIFY' @OPTN   7                       S01499
     C                     PARM 'S01499'  @SARD   6                       S01499
     C           SCSARD    PARM SCSARD    DSFDY                           S01499
     C*                                                                   S01499
     C** If core feature is switched ON, set a variable field to          S01499
     C** condition the rest of the processing                             S01499
     C*                                                                   S01499
     C           @RTCD     IFEQ *BLANKS                                   S01499
     C                     MOVE '1'       *IN24                           S01499
     C                     ELSE                                           S01499
     C*                                                                   S01499
     C** else, database error (return code other than *NRF)               S01499
     C*                                                                   S01499
     C           @RTCD     IFNE '*NRF   '                                 S01499
     C                     MOVEL'SCSARDPD'WDBFIL                          S01499
     C                     MOVEL'*VERIFY' WDBKEY                          S01499
     C                     MOVEL'41'      WDBASE                          S01499
     C                     EXSR UEABRT                     *ABORT PGM*    S01499
     C                     END                                            S01499
     C                     END                                            S01499
      * Access SAR details to determine if IBAN validation is             CFT004
      * switched on (CFT004)                                              CFT004
     C                     CALL 'AOSARDR0'                                CFT004
     C                     PARM *BLANKS   @RTCD                           CFT004
     C                     PARM '*VERIFY' @OPTN                           CFT004
     C                     PARM 'CFT004'  @SARD   6                       CFT004
     C           SCSARD    PARM SCSARD    DSFDY                           CFT004
     C*                                                                   CFT004
     C** If core feature is switched ON, set a variable field to          CFT004
     C** condition the rest of the processing                             CFT004
     C*                                                                   CFT004
     C           @RTCD     IFEQ *BLANKS                                   CFT004
     C                     MOVE 'Y'       CFT004  1                       CFT004
     C                     ELSE                                           CFT004
     C*                                                                   CFT004
     C** else, database error (return code other than *NRF)               CFT004
     C*                                                                   CFT004
     C           @RTCD     IFNE '*NRF   '                                 CFT004
     C                     MOVEL'SCSARDPD'WDBFIL           ************   CFT004
     C                     MOVEL'*VERIFY' WDBKEY           * DBERR 42 *   CFT004
     C                     MOVE '42'      WDBASE           ************   CFT004
     C                     EXSR UEABRT                                    CFT004
     C                     END                                            CFT004
     C                     END                                            CFT004
      *                                                                   CFT009
      ** Access SAR details file to determine if CFT009 is switched ON    CFT009
      *                                                                   CFT009
     C                     MOVE '0'       *IN32                           CFT009
     C                     MOVE ' '       CFT009  1                       CFT009
     C                     CALL 'AOSARDR0'                                CFT009
     C                     PARM *BLANKS   @RTCD   7                       CFT009
     C                     PARM '*VERIFY' @OPTN   7                       CFT009
     C                     PARM 'CFT009'  @SARD   6                       CFT009
     C           SCSARD    PARM SCSARD    DSFDY                           CFT009
     C*                                                                   CFT009
     C** If core feature is switched ON, set a variable to                CFT009
     C** condition the rest of the processing                             CFT009
     C*                                                                   CFT009
     C           @RTCD     IFEQ *BLANKS                                   CFT009
     C                     MOVE '1'       *IN32                           CFT009
     C                     MOVE 'Y'       CFT009                          CFT009
     C                     ELSE                                           CFT009
     C*                                                                   CFT009
     C** else, database error (return code other than *NRF)               CFT009
     C*                                                                   CFT009
     C           @RTCD     IFNE '*NRF   '                                 CFT009
     C                     MOVEL'SCSARDPD'WDBFIL                          CFT009
     C                     MOVEL'*VERIFY' WDBKEY                          CFT009
     C                     MOVEL'04'      WDBASE                          CFT009
     C                     EXSR UEABRT                     *ABORT PGM*    CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT014
      ** Access SAR details file to determine if CFT014 is switched ON    CFT014
      *                                                                   CFT014
     C                     MOVE *BLANK    CFT014  1                       CFT014
     C                     CALL 'AOSARDR0'                                CFT014
     C                     PARM *BLANKS   @RTCD                           CFT014
     C                     PARM '*VERIFY' @OPTN                           CFT014
     C                     PARM 'CFT014'  @SARD                           CFT014
     C           SCSARD    PARM SCSARD    DSFDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFEQ *BLANKS                                   CFT014
     C                     MOVE 'Y'       CFT014                          CFT014
     C                     MOVE *ON       *IN77                           CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE '*NRF   '                                 CFT014
     C                     MOVEL'SCSARDPD'WDBFIL                          CFT014
     C                     MOVEL'CFT014'  WDBKEY                          CFT014
     C                     MOVEL'20'      WDBASE                          CFT014
     C                     EXSR UEABRT                                    CFT014
     C                     ELSE                                           CFT014
     C                     MOVE 'N'       CFT014                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** If switchable feature CFT014 is installed, open OTPAYXL2.        CFT014
      *                                                                   CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
     C           CFT009    OREQ 'Y'                                       CFT009
     C                     OPEN OTPAYXL2                                  CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Access SAR details file to determine if CEU006 is switched ON    CFT014
      *                                                                   CFT014
     C                     MOVE *BLANK    CEU006  1                       CFT014
     C                     CALL 'AOSARDR0'                                CFT014
     C                     PARM *BLANKS   @RTCD                           CFT014
     C                     PARM '*VERIFY' @OPTN                           CFT014
     C                     PARM 'CEU006'  @SARD                           CFT014
     C           SCSARD    PARM SCSARD    DSFDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFEQ *BLANKS                                   CFT014
     C                     MOVE 'Y'       CEU006                          CFT014
     C                     MOVE *ON       *IN88                           CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE '*NRF   '                                 CFT014
     C                     MOVEL'SCSARDPD'WDBFIL                          CFT014
     C                     MOVEL'CEU006'  WDBKEY                          CFT014
     C                     MOVEL'021'     WDBASE                          CFT014
     C                     EXSR UEABRT                                    CFT014
     C                     ELSE                                           CFT014
     C                     MOVE 'N'       CEU006                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C/COPY WNCPYSRC,FT0510C006
      *                                                                                       CFT157
     C                     MOVE 'N'       CFT157  1                                           CFT157
     C                     CALL 'AOSARDR0'                                                    CFT157
     C                     PARM *BLANKS   @RTCD                                               CFT157
     C                     PARM '*VERIFY' @OPTN                                               CFT157
     C                     PARM 'CFT157'  @SARD                                               CFT157
     C           SCSARD    PARM SCSARD    DSFDY                                               CFT157
     C*                                                                                       CFT157
     C** If feature is switched ON, set a variable field to                                   CFT157
     C** condition the rest of the processing                                                 CFT157
     C*                                                                                       CFT157
     C           @RTCD     IFEQ *BLANKS                                                       CFT157
     C                     MOVE 'Y'       CFT157                                              CFT157
     C                     ELSE                                                               CFT157
     C*                                                                                       CFT157
     C** else, database error (return code other than *NRF)                                   CFT157
     C*                                                                                       CFT157
     C           @RTCD     IFNE '*NRF   '                                                     CFT157
     C                     MOVEL'SCSARDPD'WDBFIL                                              CFT157
     C                     MOVEL'*VERIFY' WDBKEY                                              CFT157
     C                     MOVEL'40'      WDBASE                                              CFT157
     C                     EXSR UEABRT                     *ABORT PGM*                        CFT157
     C                     END                                                                CFT157
     C                     END                                                                CFT157
      *                                                                                       CER001
      ** check whether feature ULX043 is installed                                            CER001
      *                                                                                       CER001
     C                     MOVE 'N'       ULX043  1                                           CER001
      *                                                                                       CER001
     C                     CALL 'AOSARDR0'                                                    CER001
     C                     PARM *BLANKS   @RTCD                                               CER001
     C                     PARM '*VERIFY' @OPTN                                               CER001
     C                     PARM 'ULX043'  @SARD                                               CER001
     C           SCSARD    PARM SCSARD    DSFDY                                               CER001
      *                                                                                       CER001
     C           @RTCD     IFEQ *BLANKS                                                       CER001
     C                     MOVE 'Y'       ULX043                                              CER001
     C                     MOVE '1'       *IN79                                               CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
      *                                                                   CFT009
      ** Access SAR details file to determine if CFT010 is switched ON    CFT009
      *                                                                   CFT009
     C                     MOVE '0'       *IN33                           CFT009
     C                     MOVE ' '       CFT010  1                       CFT009
     C                     CALL 'AOSARDR0'                                CFT009
     C                     PARM *BLANKS   @RTCD   7                       CFT009
     C                     PARM '*VERIFY' @OPTN   7                       CFT009
     C                     PARM 'CFT010'  @SARD   6                       CFT009
     C           SCSARD    PARM SCSARD    DSFDY                           CFT009
     C*                                                                   CFT009
     C** If core feature is switched ON, set a variable to                CFT009
     C** condition the rest of the processing                             CFT009
     C*                                                                   CFT009
     C           @RTCD     IFEQ *BLANKS                                   CFT009
     C                     MOVE '1'       *IN33                           CFT009
     C                     MOVE 'Y'       CFT010                          CFT009
     C                     ELSE                                           CFT009
     C*                                                                   CFT009
     C** else, database error (return code other than *NRF)               CFT009
     C*                                                                   CFT009
     C           @RTCD     IFNE '*NRF   '                                 CFT009
     C                     MOVEL'SCSARDPD'WDBFIL                          CFT009
     C                     MOVEL'*VERIFY' WDBKEY                          CFT009
     C                     MOVEL'05'      WDBASE                          CFT009
     C                     EXSR UEABRT                     *ABORT PGM*    CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C/COPY WNCPYSRC,HUT110_018                                                               HUT110
      ** Check if SWIFT Changes 2003 (CSW203) is installed                                    CSW203
      *                                                                                       CSW203
     C                     CALL 'SWIF2003'                                                    CSW203
     C                     PARM *BLANKS   PRTCD   7                                           CSW203
      *                                                                                       CSW203
     C           PRTCD     IFEQ 'CSW2003'                                                     CSW203
     C                     MOVE 'Y'       CSW203  1                                           CSW203
     C                     MOVE *ON       *IN78                                               CSW203
     C                     ELSE                                                               CSW203
     C                     MOVE 'N'       CSW203                                              CSW203
     C                     MOVE *OFF      *IN78                                               CSW203
     C                     ENDIF                                                              CSW203
      *                                                                                       CSW207
      ** Check if SWIFT Changes 2007 (CSW207) is installed                                    CSW207
      *                                                                                       CSW207
     C                     CALL 'SWIF2007'                                                    CSW207
     C                     PARM *BLANKS   PRTCD   7                                           CSW207
      *                                                                                       CSW207
     C           PRTCD     IFEQ 'CSW2007'                                                     CSW207
     C                     MOVE 'Y'       CSW207  1                                           CSW207
     C                     ELSE                                                               CSW207
     C                     MOVE 'N'       CSW207                                              CSW207
     C                     ENDIF                                                              CSW207
      *                                                                                       CSW209
      ** Check if SWIFT Changes 2009 (CSW209) is installed                                    CSW209
      *                                                                                       CSW209
     C                     CALL 'SWIF2009'                                                    CSW209
     C                     PARM *BLANKS   PRTCD   7                                           CSW209
      *                                                                                       CSW209
     C           PRTCD     IFEQ 'CSW2009'                                                     CSW209
     C                     MOVE 'Y'       CSW209  1                                           CSW209
     C                     ELSE                                                               CSW209
     C                     MOVE 'N'       CSW209                                              CSW209
     C                     ENDIF                                                              CSW209
     C*                                                                   S01117
     C** SETON SYSTEM LEVEL INDICATOR                                     S01117
     C*                                                                   S01117
     C           @PLEV     IFEQ 'S'                                       S01117
     C                     SETON                     11                   S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C** SETON DIRECT COB INDICATOR                                       S01117
     C*                                                                   S01117
     C           PARM1     IFEQ 'A'                                       S01117
     C                     SETON                     12                   S01117
     C                     ELSE                                           S01117
     C           PARM1     IFEQ 'O'                                       S01117
     C                     SETON                     14                   S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0510CCP1                                           S01408
     C                     CALL 'AOMMODR0'                                                    CER001
     C                     PARM '*MSG    '@RTCD   7                                           CER001
     C                     PARM '*FIRST  '@OPTN   7                                           CER001
     C           SDMMOD    PARM SDMMOD    DSFDY                                               CER001
     C           @RTCD     IFNE *BLANKS                                                       CER001
     C                     MOVE 'N'       BGNWST                                              CER001
     C                     ENDIF                                                              CER001
     C*                                                                   S01408
     C*
     C** SETON INDICATOR TO SHOW THAT INITIAL PROCESSING HAS BEEN DONE
     C*
     C                     SETON                     20
     C/COPY WNCPYSRC,FT0510C008
      *                                                                   CFT009
      * If CFT009 active, do not show transfer commission tariff          CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
     C                     SETON                         57               CFT009
     C                     ELSE                                           CFT009
     C                     SETOF                         57               CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Check if 'CER031' is switched 'ON'                                                   CER030
      *                                                                                       CER030
     C                     CALL 'AOSARDR0'                                                    CER030
     C                     PARM *BLANKS   PRTCD                                               CER030
     C                     PARM '*VERIFY' POPTN                                               CER030
     C                     PARM 'CER031'  PSARD   6                                           CER030
     C           SCSARD    PARM SCSARD    DSFDY                                               CER030
      *                                                                                       CER030
     C           PRTCD     IFEQ *BLANKS                                                       CER030
     C                     MOVE 'Y'       CER031  1                                           CER030
     C                     MOVE *ON       *IN34                                               CER030
     C                     ELSE                                                               CER030
      *                                                                                       CER030
      ** else, database error (return code other than *NRF)                                   CER030
      *                                                                                       CER030
     C           PRTCD     IFNE '*NRF   '                                                     CER030
     C                     MOVEL'SCSARDPD'WDBFIL                                              CER030
     C                     MOVEL'*VERIFY' WDBKEY                                              CER030
     C                     MOVEL'06'      WDBASE                                              CER030
     C                     EXSR UEABRT                                                        CER030
     C                     ELSE                                                               CER030
     C                     MOVE 'N'       CER031                                              CER030
     C                     MOVE *OFF      *IN34                                               CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      ** Check if 'CER030' is switched 'ON'                                                   CER030
      *                                                                                       CER030
     C                     MOVE *OFF      *IN35                                               CER030
     C                     CALL 'AOSARDR0'                                                    CER030
     C                     PARM *BLANKS   PRTCD                                               CER030
     C                     PARM '*VERIFY' POPTN                                               CER030
     C                     PARM 'CER030'  PSARD                                               CER030
     C           SCSARD    PARM SCSARD    DSFDY                                               CER030
      *                                                                                       CER030
     C           PRTCD     IFEQ *BLANKS                                                       CER030
     C                     MOVE 'Y'       CER030  1                                           CER030
     C                     MOVE *ON       *IN35                                               CER030
     C                     ELSE                                                               CER030
      *                                                                                       CER030
      ** else, database error (return code other than *NRF)                                   CER030
      *                                                                                       CER030
     C           PRTCD     IFNE '*NRF   '                                                     CER030
     C                     MOVEL'SCSARDPD'WDBFIL                                              CER030
     C                     MOVEL'*VERIFY' WDBKEY                                              CER030
     C                     MOVEL'07'      WDBASE                                              CER030
     C                     EXSR UEABRT                                                        CER030
     C                     ELSE                                                               CER030
     C                     MOVE 'N'       CER030                                              CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      ** Check if 'CFT003' is switched 'ON'                                                   CER030
      *                                                                                       CER030
     C                     CALL 'AOSARDR0'                                                    CER030
     C                     PARM *BLANKS   PRTCD                                               CER030
     C                     PARM '*VERIFY' POPTN                                               CER030
     C                     PARM 'CFT003'  PSARD                                               CER030
     C           SCSARD    PARM SCSARD    DSFDY                                               CER030
      *                                                                                       CER030
     C           PRTCD     IFEQ *BLANKS                                                       CER030
     C                     MOVE 'Y'       CFT003  1                                           CER030
     C                     ELSE                                                               CER030
      *                                                                                       CER030
      ** else, database error (return code other than *NRF)                                   CER030
      *                                                                                       CER030
     C           PRTCD     IFNE '*NRF   '                                                     CER030
     C                     MOVEL'SCSARDPD'WDBFIL                                              CER030
     C                     MOVEL'*VERIFY' WDBKEY                                              CER030
     C                     MOVEL'08'      WDBASE                                              CER030
     C                     EXSR UEABRT                                                        CER030
     C                     ELSE                                                               CER030
     C                     MOVE 'N'       CFT003                                              CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           CFT003    IFEQ 'Y'                                                           CER030
     C           CER031    ANDEQ'Y'                                                           CER030
      *                                                                                       CER030
     C                     MOVE *ON       *IN36                                               CER030
     C                     ELSE                                                               CER030
     C                     MOVE *OFF      *IN36                                               CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      ** Check if 'CGL013' is switched 'ON'                                                   CER030
      *                                                                                       CER030
     C                     CALL 'AOSARDR0'                                                    CER030
     C                     PARM *BLANKS   PRTCD                                               CER030
     C                     PARM '*VERIFY' POPTN                                               CER030
     C                     PARM 'CGL013'  PSARD                                               CER030
     C           SCSARD    PARM SCSARD    DSFDY                                               CER030
      *                                                                                       CER030
     C           PRTCD     IFEQ *BLANKS                                                       CER030
     C                     MOVE 'Y'       CGL013  1                                           CER030
     C                     MOVE *ON       *IN35                                               CER030
     C                     ELSE                                                               CER030
      *                                                                                       CER030
      ** else, database error (return code other than *NRF)                                   CER030
      *                                                                                       CER030
     C           PRTCD     IFNE '*NRF   '                                                     CER030
     C                     MOVEL'SCSARDPD'WDBFIL                                              CER030
     C                     MOVEL'*VERIFY' WDBKEY                                              CER030
     C                     MOVEL'12'      WDBASE                                              CER030
     C                     EXSR UEABRT                                                        CER030
     C                     ELSE                                                               CER030
     C                     MOVE 'N'       CGL013                                              CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
     C*
      *                                                                                       CFT120
      ** Check if 'CFT120' is switched 'ON'                                                   CFT120
      *                                                                                       CFT120
     C                     CALL 'AOSARDR0'                                                    CFT120
     C                     PARM *BLANKS   PRTCD                                               CFT120
     C                     PARM '*VERIFY' POPTN                                               CFT120
     C                     PARM 'CFT120'  PSARD                                               CFT120
     C           SCSARD    PARM SCSARD    DSFDY                                               CFT120
      *                                                                                       CFT120
     C           PRTCD     IFEQ *BLANKS                                                       CFT120
     C                     MOVE 'Y'       CFT120  1                                           CFT120
     C                     MOVE *ON       *IN59                                               CFT120
     C                     ELSE                                                               CFT120
      *                                                                                       CFT120
      ** else, database error (return code other than *NRF)                                   CFT120
      *                                                                                       CFT120
     C           PRTCD     IFNE '*NRF   '                                                     CFT120
     C                     MOVEL'SCSARDPD'WDBFIL                                              CFT120
     C                     MOVEL'*VERIFY' WDBKEY                                              CFT120
     C                     MOVEL'13'      WDBASE                                              CFT120
     C                     EXSR UEABRT                                                        CFT120
     C                     ELSE                                                               CFT120
     C                     MOVE 'N'       CFT120                                              CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
     C                     ENDIF                                                              CFT120
     C*          *****     *****
     C           CAEND     ENDSR
     C*          *****     *****
     C/EJECT
     C           CCDETL    BEGSR
     C*          ******    *****
     C*
     C*****************************************************************
     C*                 CC-DETAIL-PROCESSING                          *
     C*                                                               *
     C*  FUNCTION : TO PRODUCE A PAGE ON THE DETAIL REPORT BASED ON   *
     C*             DATA FROM INPUT RECORD.                           *
     C*                                                               *
     C*  CALLS :    UATBCN                                            *
     C*             UCCLCN                                            *
     C*             UEABRT                                            *
     C*             UGFRMT                                            *
     C*             ZDATE2                                            *
     C*             CHOPF                                             *
     C*                                                               *
     C*  CALLED BY: AAMAIN                                            *
     C*                                                               *
     C*****************************************************************
      *                                                                   CFT014
      ** Access OTPAYXL2 if switchable feature CFT014 is installed.       CFT014
      *                                                                   CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
     C********** CFT009    OREQ 'Y'                                                  CFT009 BUG23869
     C********** CFT009    ANDEQ'Y'                                               BUG23869 BUG23832A
  -  C           CFT009    OREQ 'Y'                                                        BUG23832A
      *                                                                   CFT014
     C           PREF      CHAINOTPAYXL2             90                   CFT014
      *                                                                   CFT014
      ** If record does not exist and switchable feature CFT014           CFT014
      ** is installed, do error routine.                                  CFT014
      *                                                                   CFT014
     C           *IN90     IFEQ '1'                                       CFT014
     C                     MOVEL'OTPAYXL2'WDBFIL                          CFT014
     C                     MOVELPREF      WDBKEY                          CFT014
     C                     MOVEL'022'     WDBASE                          CFT014
     C                     EXSR UEABRT                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
     C*
     C** SETUP STATUS OF RECORD
     C*
     C                     MOVEL*BLANKS   SSUSR                                               CFT157
     C                     MOVEL*BLANKS   SSAUS                                               CFT157
     C           PARM1     IFNE 'A'
     C                     MOVE *BLANK    P1STTS
 -   C                     ELSE
     C           OTCHTP    IFEQ 'I'
     C                     MOVEL'* INSERT'P1STTS
     C                     MOVE 'ED *'    P1STTS
     C                     ELSE
     C           OTCHTP    IFEQ 'A'
     C                     MOVEL'* AMENDE'P1STTS
     C                     MOVE 'D * '    P1STTS
     C                     ELSE
     C                     MOVEL'* DELETE'P1STTS
     C                     MOVE 'D * '    P1STTS
     C                     END
     C                     END
     C                     END
     C/COPY WNCPYSRC,FT0510C011
      *                                                                                       CFT157
     C           CFT157    IFEQ 'Y'                                                           CFT157
     C           PARM1     ANDEQ'A'                                                           CFT157
     C           OTCHTP    ANDEQ'S'                                                           CFT157
     C                     MOVE *BLANKS   P1STTS                                              CFT157
     C                     MOVEL'* STOPPE'P1STTS                                              CFT157
     C                     MOVE 'D * '    P1STTS                                              CFT157
     C                     MOVELSUSR      SSUSR                                               CFT157
     C                     MOVELSAUS      SSAUS                                               CFT157
     C                     END                                                                CFT157
      *                                                                   055293
      * Set Up Ordering Institution Details                               055293
      *                                                                   055293
     C                     MOVEL*BLANKS   P1OBDS                          S01435
     C                     MOVEL*BLANKS   P1ORBK                          S01435
     C           OPORB1    IFNE *BLANKS                                   S01435
      *                                                                   S01435
      * If SWIFT type A translate else leave as on message                S01435
      *                                                                   S01435
     C                     MOVEL#IMSG     P1ORBK                          S01435
     C           OPORBT    IFNE 'S'                                       S01435
     C                     MOVELOPORB1    P1ORB1                          055293
     C                     MOVELOPORB2    P1ORB2                          055293
     C                     MOVELOPORB3    P1ORB3                          055293
     C                     MOVELOPORB4    P1ORB4                          055293
     C                     MOVELOPORB5    P1ORB5                          055293
     C                     ELSE                                           S01435
     C                     MOVEL'ORBT'    XCALL                           S01435
     C                     MOVELOPORBT    XTYPE                           S01435
     C                     MOVEL*BLANKS   XNAMDS                          S01435
     C                     MOVELOPORB1    ##001   1                       S01435
     C           ##001     IFEQ '/'                                       S01435
     C                     MOVELOPORB2    XNAMDS                          S01435
     C                     ELSE                                           S01435
     C                     MOVELOPORB1    XNAMDS                          S01435
     C                     END                                            S01435
     C                     EXSR GETADD                                    S01435
     C                     MOVELXNAMDS    P1OBDS                          S01435
     C                     END                                            S01435
     C                     END                                            S01435
      *                                                                   S01435
      * Translate input account with bank                                 S01435
      *                                                                   S01435
     C           ORBT      IFNE *BLANKS                                   S01435
     C                     MOVEL'ORBT'    XCALL                           S01435
     C                     MOVELORBT      XTYPE                           S01435
     C                     MOVELSMCY      XCCY                            S01435
     C                     MOVEL*BLANKS   XNAMDS                          S01435
     C                     MOVELORBK      XNAMDS                          S01435
     C                     MOVELORBB      XBRCA                           S01435
     C/COPY WNCPYSRC,FT0510C012
     C                     EXSR GETADD                                    S01435
     C           OPORB1    IFEQ *BLANKS                                   S01435
     C                     MOVELXADDS     P1OBDS                          S01435
     C                     END                                            S01435
     C                     MOVELXNAMDS    P1ORBK                          S01435
     C                     END                                            S01435
      *                                                                   S01435
      ** Sender's Correspondent                                           S01435
      *                                                                   S01435
     C                     MOVEL'SNCT'    XCALL                           S01435
     C                     MOVELPCCY      XCCY                            S01435
     C                     MOVELSNCT      XTYPE                           S01435
     C                     MOVEL*BLANKS   XNAMDS                          S01435
     C                     MOVELSNCO      XNAMDS                          S01435
     C                     EXSR GETADD                                    S01435
     C                     MOVELXNAMDS    P1SNCO                          S01435
     C                     MOVELXADDS     P1SNDS                          S01435
      *                                                                   S01435
      ** INTERMEDIARY BANK                                                S01435
      *                                                                   S01435
     C                     MOVEL'INBT'    XCALL   4                       S01435
     C                     MOVELINBT      XTYPE                           S01435
     C                     MOVELININDS    XNAMDS                          S01435
     C                     EXSR GETADD                                    S01435
     C                     MOVELXNAMDS    P1INDS                          S01435
      *                                                                   S01435
      ** RECEIVER'S CORRESPONDENT                                         S01435
      *                                                                   S01435
     C                     MOVE 'RCRT'    XCALL   4                       S01435
     C                     MOVELRCRT      XTYPE                           S01435
     C                     MOVELRCINDS    XNAMDS                          S01435
     C                     EXSR GETADD                                    S01435
     C                     MOVELXNAMDS    P1RCDS                          S01435
      *                                                                   S01435
      ** ORDERING CUSTOMER                                                S01435
      *                                                                   S01435
     C                     MOVE 'ORCT'    XCALL   4                       S01435
     C                     MOVELORCT      XTYPE                           S01435
     C                     MOVELSMCY      XCCY                            068172
     C                     MOVELORINDS    XNAMDS                          S01435
     C                     EXSR GETADD                                    S01435
     C                     MOVELXNAMDS    P1ORDS                          S01435
      *                                                                   S01435
      ** Destination                                                      S01435
      *                                                                   S01435
     C                     MOVE 'DSTT'    XCALL   4                       S01435
     C                     MOVELDSTT      XTYPE                           S01435
     C                     MOVELPCCY      XCCY                            068172
     C                     MOVELDSINDS    XNAMDS                          S01435
     C                     EXSR GETADD                                    S01435
     C                     MOVELXNAMDS    P1DSDS                          S01435
      *                                                                   S01435
      ** ACCOUNT WITH BANK                                                S01435
      *                                                                   S01435
     C                     MOVE 'ACBT'    XCALL   4                       S01435
     C                     MOVELACBT      XTYPE                           S01435
     C                     MOVELACINDS    XNAMDS                          S01435
     C                     EXSR GETADD                                    S01435
     C                     MOVELXNAMDS    P1ACDS                          S01435
      *                                                                   S01435
      ** BENEFICIARY CUSTOMER                                             S01435
      *                                                                   S01435
     C                     MOVE 'BNCT'    XCALL   4                       S01435
     C                     MOVELBNCT      XTYPE                           S01435
     C                     MOVELBNINDS    XNAMDS                          S01435
     C                     EXSR GETADD                                    S01435
     C                     MOVELXNAMDS    P1BNDS                          S01435
      *                                                                   S01435
     C                     MOVE *BLANKS   XCALL   4                       S01435
     C************                                                        S01435
     C***SETUP*ADDRESS FIELDS,ACESSING CLINT AS APPROPRIATE               S01435
     C************                                                        S01435
     C***RECEIVER'S CORRESPONDENT                                         S01435
     C************                                                        S01435
     C***********RCRT **** IFNE 'C'                                 E16477S01435
     C***********RCRT      IFNE 'S'                                 E16477S01435
     C************         MOVELRCO1      P1RCO1                          S01435
     C************         MOVELRCO2      P1RCO2                          S01435
     C************         MOVELRCO3      P1RCO3                          S01435
     C************         MOVELRCO4      P1RCO4                          S01435
     C************         MOVELRCO5      P1RCO5                          S01435
     C************         ELSE                                           S01435
     C************                                                  E16477S01435
     C***EXTRACT*CUSTOMER*NUMBER*BY*CHAINING*MSADR*           E16477S01194S01435
     C***EXTRACT*CUSTOMER NUMBER BY CHAINING SDCUSTL7               S01194S01435
     C***ON*SWIFT*ADDRESS.  THUS CHAIN CLINT TO                     E16477S01435
     C***OBTAIN*A*FULL ADDRESS.                                     E16477S01435
     C************                                                  E16477S01435
     C************         MOVELRCO1      SWIFKY 12                 E16477S01435
     C***********SWIFKY****CHAINMSADR                89       E16477S01194S01435
     C***********SWIFKY    CHAINSDCUSTL7             89             S01194S01435
     C**N89******RECI      COMP 'D'                  8989                 S01435
     C************                                                  E16477S01435
     C************IN89     IFEQ '1'                           E16477050920S01435
     C************         MOVEL'SDCUSTPD'WDBFIL              S01194050920S01435
     C*********************MOVEL'MSADR'   WDBFIL           ***S01194050920S01435
     C************         MOVELSWIFKY    WDBKEY           *BAE16477050920S01435
     C************         MOVEL'04'      WDBASE           * 0E16477050920S01435
     C************         EXSR UEABRT                     ***E16477050920S01435
     C************         END                                E16477050920S01435
     C************IN89     IFEQ '1'                                 050920S01435
     C************         MOVELSWIFKY    P1RCO1                    050920S01435
     C************         MOVELWARN,1    P1RCO2                    050920S01435
     C************         MOVELWARN,2    P1RCO3                    050920S01435
     C************         MOVEL*BLANKS   P1RCO4                          050920
     C************         MOVEL*BLANKS   P1RCO5                          050920
     C************         ELSE                                           050920
     C************                                                        E16477
     C****************     MOVELRCO1      WCLNUM                          E16477
     C*********************MOVELCNUM      WCLNUM                    E16477S01194
     C************         MOVELBBCUST    WCLNUM                          S01194
     C************         MOVEL'B'       WCLRCT                          S01435
     C************         EXSR UCCLCN                                    S01435
     C************                                                        S01435
     C************IN89     IFEQ '1'                                       S01435
     C************         MOVEL'CLINT'   WDBFIL                          S01435
     C************         MOVELWCLNUM    WA7     7                       S01435
     C************         MOVE WCLRCT    WA7                             S01435
     C************         MOVELWA7       WDBKEY                          S01435
     C******************   MOVEL'04'      WDBASE                          E16477
     C************         MOVEL'05'      WDBASE                          E16477
     C************         EXSR UEABRT                     *ABORT PGM*    S01435
     C************         END                                            S01435
     C************                                                        S01435
     C***********STMT      IFNE 08                                        E16477
     C************         MOVEL*BLANK    RCO1                            E16477
     C*********************MOVELCNUM      RCO1                      E16477S01194
     C************         MOVELBBCUST    RCO1                            S01194
     C************         END                                            E16477
     C************                                                        E16477
     C************         MOVELRCO1      P1RCO1                          S01435
     C************         MOVELCNA1      P1RCO2                          S01435
     C************         MOVELCNA2      P1RCO3                          S01435
     C************         MOVELCNA3      P1RCO4                          S01435
     C************         MOVELCNA4      P1RCO5                          S01435
     C************         END                                            050920
     C************         END                                            S01435
     C************                                                        S01435
     C***ORDERING*CUSTOMER                                                S01435
     C************                                                        S01435
     C***********ORCT      IFNE 'C'                                       S01435
     C************         MOVELORC1      P1ORC1                          S01435
     C************         MOVELORC2      P1ORC2                          S01435
     C************         MOVELORC3      P1ORC3                          S01435
     C************         MOVELORC4      P1ORC4                          S01435
     C************         MOVEL*BLANKS   P1ORC5                          S01435
     C************                                                        S01117
     C***********MBIN      IFEQ 'N'                                       S01117
     C***********ORCT      ANDEQ'P'                                       S01117
     C************         MOVE *BLANKS   ORC1BR                          S01117
     C************         END                                            S01117
     C************                                                        S01117
     C************         ELSE                                           S01435
     C************                                                        E16477
     C***IF*SETTLEMENT METHOD IS SWIFT, CHAIN CLINT                       E16477
     C***ON*SWIFT*ADDRESS TO OBTAIN THE SWIFT ADDRESS.                    E16477
     C************                                                        E16477
     C***********STMT      IFEQ 08                                        E16477
     C************         MOVELORC1      WCLNUM                          E16477
     C************         MOVEL'A'       WCLRCT                          E16477
     C************         EXSR UCCLCN                                    E16477
     C************                                                        E16477
     C************IN89     IFEQ '1'                                       E16477
     C************         MOVEL'CLINT'   WDBFIL           *************  E16477
     C************         MOVELWCLNUM    WA7              * DATA BASE *  E16477
     C************         MOVE WCLRCT    WA7              * ERROR 06  *  E16477
     C************         MOVELWA7       WDBKEY           *************  E16477
     C************         MOVEL'06'      WDBASE                          E16477
     C************         EXSR UEABRT                     *ABORT PGM*    E16477
     C************         END                                            E16477
     C************                                                        E16477
     C************         MOVELCSID      ORC1                            E16477
     C************         MOVEL'R'       WCLRCT                          E16477
     C************         ELSE                                           E16477
     C************         MOVELORC1      WCLNUM                          S01435
     C************         MOVEL'B'       WCLRCT                          S01435
     C************         END                                            E16477
     C************         EXSR UCCLCN                                    S01435
     C************                                                        S01435
     C************IN89     IFEQ '1'                                       S01435
     C************         MOVEL'CLINT'   WDBFIL                          S01435
     C************         MOVELWCLNUM    WA7                             S01435
     C************         MOVE WCLRCT    WA7                             S01435
     C************         MOVELWA7       WDBKEY                          S01435
     C******************   MOVEL'05'      WDBASE                          E16477
     C************         MOVEL'07'      WDBASE                          E16477
     C************         EXSR UEABRT                     *ABORT PGM*    S01435
     C************         END                                            S01435
     C************                                                        S01435
     C************         MOVELORC1      P1ORC1                          S01435
     C************         MOVELCNA1      P1ORC2                          S01435
     C************         MOVELCNA2      P1ORC3                          S01435
     C************         MOVELCNA3      P1ORC4                          S01435
     C************         MOVELCNA4      P1ORC5                          S01435
     C************         END                                            S01435
     C************                                                        S01435
     C***RECEIVING BANK                                                   S01435
     C************                                                        S01435
     C***********DSTT      IFNE 'C'                                       S01435
     C************         MOVELDST1      P1DST1                          S01435
     C************         MOVELDST2      P1DST2                          S01435
     C************         MOVELDST3      P1DST3                          S01435
     C************         MOVELDST4      P1DST4                          S01435
     C************         MOVEL*BLANKS   P1DST5                          S01435
     C************                                                        S01117
     C***********MBIN      IFEQ 'N'                                       S01117
     C***********DSTT      ANDEQ'G'                                       S01117
     C************         MOVE *BLANKS   DST1BR                          S01117
     C************         END                                            S01117
     C************                                                        S01117
     C************         ELSE                                           S01435
     C************                                                        E16477
     C***IF*SETTLEMENT METHOD IS SWIFT, CHAIN CLINT ON CUSTOMER           E16477
     C***NUMBER*TO OBTAIN THE SWIFT ADDRESS.                              E16477
     C************                                                        E16477
     C***********STMT      IFEQ 08                                        E16477
     C************         MOVELDST1      WCLNUM                          E16477
     C************         MOVEL'A'       WCLRCT                          E16477
     C************         EXSR UCCLCN                                    E16477
     C************                                                        E16477
     C************IN89     IFEQ '1'                                       E16477
     C************         MOVEL'CLINT'   WDBFIL           *************  E16477
     C************         MOVELWCLNUM    WA7              * DATA BASE *  E16477
     C************         MOVE WCLRCT    WA7              * ERROR 08  *  E16477
     C************         MOVELWA7       WDBKEY           *************  E16477
     C************         MOVEL'08'      WDBASE                          E16477
     C************         EXSR UEABRT                     *ABORT PGM*    E16477
     C************         END                                            E16477
     C************                                                        E16477
     C************         MOVELCSID      DST1                            E16477
     C************         MOVEL'R'       WCLRCT                          E16477
     C************         ELSE                                           E16477
     C************         MOVELDST1      WCLNUM                          S01435
     C************         MOVEL'B'       WCLRCT                          S01435
     C************         END                                            E16477
     C************         EXSR UCCLCN                                    S01435
     C************                                                        S01435
     C************IN89     IFEQ '1'                                       S01435
     C************         MOVEL'CLINT'   WDBFIL                          S01435
     C************         MOVELWCLNUM    WA7                             S01435
     C************         MOVE WCLRCT    WA7                             S01435
     C************         MOVELWA7       WDBKEY                          S01435
     C******************   MOVEL'06'      WDBASE                          E16477
     C************         MOVEL'09'      WDBASE                          E16477
     C************         EXSR UEABRT                     *ABORT PGM*    S01435
     C************         END                                            S01435
     C************                                                        S01435
     C************         MOVELDST1      P1DST1                          S01435
     C************         MOVELCNA1      P1DST2                          S01435
     C************         MOVELCNA2      P1DST3                          S01435
     C************         MOVELCNA3      P1DST4                          S01435
     C************         MOVELCNA4      P1DST5                          S01435
     C************         END                                            S01435
     C************                                                        S01435
     C***ACCOUNT*WITH BANK                                                S01435
     C************                                                        S01435
     C***********ACBT **** IFNE 'C'                                       E16477
     C***********ACBT      IFNE 'S'                                       E16477
     C************         MOVELACB1      P1ACB1                          S01435
     C************         MOVELACB2      P1ACB2                          S01435
     C************         MOVELACB3      P1ACB3                          S01435
     C************         MOVELACB4      P1ACB4                          S01435
     C************         MOVELACB5      P1ACB5                          S01435
     C************         ELSE                                           S01435
     C************                                                        E16477
     C***EXTRACT*CUSTOMER*NUMBER*BY*CHAINING*MSADR*                 E16477S01194
     C***EXTRACT*CUSTOMER NUMBER BY CHAINING SDCUSTL7                     S01194
     C***ON*SWIFT*ADDRESS.  THUS CHAIN CLINT TO                           E16477
     C***OBTAIN*A*FULL ADDRESS.                                           E16477
     C************                                                        E16477
     C************         MOVELACB1      SWIFKY                          E16477
     C***********SWIFKY****CHAINMSADR                89             E16477S01194
     C***********SWIFKY    CHAINSDCUSTL7             89                   S01194
     C**N89******RECI      COMP 'D'                  8989                 E16477
     C************                                                        E16477
     C************IN89     IFEQ '1'                                 E16477050920
     C************         MOVEL'SDCUSTPD'WDBFIL                    S01194050920
     C*********************MOVEL'MSADR'   WDBFIL           *************77S01194
     C************         MOVELSWIFKY    WDBKEY           * DATA B E16477050920
     C************         MOVEL'10'      WDBASE           * ERROR  E16477050920
     C************         EXSR UEABRT                     *********E16477050920
     C************         END                                      E16477050920
     C************IN89     IFEQ '1'                                       050920
     C************         MOVELSWIFKY    P1ACB1                    050920S01435
     C************         MOVE WARN,1    P1ACB2                    050920S01435
     C************         MOVE WARN,2    P1ACB3                    050920S01435
     C************         MOVEL*BLANKS   P1ACB4                    050920S01435
     C************         MOVEL*BLANKS   P1ACB5                    050920S01435
     C************         ELSE                                     050920S01435
     C************                                                  E16477S01435
     C****************     MOVELACB1      WCLNUM                    E16477S01435
     C*********************MOVELCNUM      WCLNUM              E16477S01194S01435
     C************         MOVELBBCUST    WCLNUM                    S01194S01435
     C************         MOVEL'B'       WCLRCT                          S01435
     C************         EXSR UCCLCN                                    S01435
     C************                                                        S01435
     C************IN89     IFEQ '1'                                       S01435
     C************         MOVEL'CLINT'   WDBFIL                          S01435
     C************         MOVELWCLNUM    WA7                             S01435
     C************         MOVE WCLRCT    WA7                             S01435
     C************         MOVELWA7       WDBKEY                          S01435
     C******************   MOVEL'07'      WDBASE                    E16477S01435
     C************         MOVEL'11'      WDBASE                    E16477S01435
     C************         EXSR UEABRT                     *ABORT PGM*    S01435
     C************         END                                            S01435
     C************                                                        S01435
     C***********STMT      IFNE 08                                  E16477S01435
     C************         MOVEL*BLANK    ACB1                      E16477S01435
     C*********************MOVELCNUM      ACB1                E16477S01194S01435
     C************         MOVELBBCUST    ACB1                      S01194S01435
     C************         END                                      E16477S01435
     C************                                                  E16477S01435
     C************         MOVELACB1      P1ACB1                          S01435
     C************         MOVELCNA1      P1ACB2                          S01435
     C************         MOVELCNA2      P1ACB3                          S01435
     C************         MOVELCNA3      P1ACB4                          S01435
     C************         MOVELCNA4      P1ACB5                          S01435
     C************         END                                     050920 S01435
     C************         END                                            S01435
     C************                                                        S01435
     C***BENEFICIARY CUSTOMER                                             S01435
     C************                                                        S01435
     C***********BNCT      IFNE 'C'                                       S01435
     C************         MOVELBNC1      P1BNC1                          S01435
     C************         MOVELBNC2      P1BNC2                          S01435
     C************         MOVELBNC3      P1BNC3                          S01435
     C************         MOVELBNC4      P1BNC4                          S01435
     C************         MOVELBNC5      P1BNC5                          S01435
     C************         ELSE                                           S01435
     C************                                                  E16477S01435
     C***IF*SETTLEMENT METHOD IS SWIFT, CHAIN CLINT ON CUSTOMER     E16477S01435
     C***NUMBER*TO OBTAIN THE SWIFT ADDRESS.                        E16477S01435
     C************                                                  E16477S01435
     C***********STMT      IFEQ 08                                  E16477S01435
     C************         MOVELBNC1      WCLNUM                    E16477S01435
     C************         MOVEL'A'       WCLRCT                    E16477S01435
     C************         EXSR UCCLCN                              E16477S01435
     C************                                                  E16477S01435
     C************IN89     IFEQ '1'                                 E16477S01435
     C************         MOVEL'CLINT'   WDBFIL           *******  E16477S01435
     C************         MOVELWCLNUM    WA7              * DATA   E16477S01435
     C************         MOVE WCLRCT    WA7              * ERROR  E16477S01435
     C************         MOVELWA7       WDBKEY           *******  E16477S01435
     C************         MOVEL'12'      WDBASE                    E16477S01435
     C************         EXSR UEABRT                     *ABOR    E16477S01435
     C************         END                                      E16477S01435
     C************                                                  E16477S01435
     C************         MOVELCSID      BNC1                      E16477S01435
     C************         MOVEL'R'       WCLRCT                    E16477S01435
     C************         ELSE                                     E16477S01435
     C************         MOVELBNC1      WCLNUM                          S01435
     C************         MOVEL'B'       WCLRCT                          S01435
     C************         END                                     E16477 S01435
     C************         EXSR UCCLCN                                    S01435
     C************                                                        S01435
     C************IN89     IFEQ '1'                                       S01435
     C************         MOVEL'CLINT'   WDBFIL                          S01435
     C************         MOVELWCLNUM    WA7                             S01435
     C************         MOVE WCLRCT    WA7                             S01435
     C************         MOVELWA7       WDBKEY                          S01435
     C******************   MOVEL'08'      WDBASE                    E16477S01435
     C************         MOVEL'13'      WDBASE                    E16477S01435
     C************         EXSR UEABRT                     *ABORT PGM*    S01435
     C************         END                                            S01435
     C************                                                        S01435
     C************         MOVELBNC1      P1BNC1                          S01435
     C************         MOVELCNA1      P1BNC2                          S01435
     C************         MOVELCNA2      P1BNC3                          S01435
     C************         MOVELCNA3      P1BNC4                          S01435
     C************         MOVELCNA4      P1BNC5                          S01435
     C************         END                                            S01435
     C************                                                  E16477S01435
     C***INTERMEDIARY BANK                                          E16477S01435
     C************                                                  E16477S01435
     C***********INBT      IFNE 'S'                                 E16477S01435
     C************         MOVELINB1      P1INB1                    E16477S01435
     C************         MOVELINB2      P1INB2                    E16477S01435
     C************         MOVELINB3      P1INB3                    E16477S01435
     C************         MOVELINB4      P1INB4                    E16477S01435
     C************         MOVELINB5      P1INB5                    E16477S01435
     C************         ELSE                                     E16477S01435
     C************                                                  E16477S01435
     C***EXTRACT*CUSTOMER*NUMBER*BY*CHAINING*MSADR*           E16477S01194S01435
     C***EXTRACT*CUSTOMER NUMBER BY CHAINING SDCUSTL7               S01194S01435
     C***ON*SWIFT*ADDRESS.  THUS CHAIN CLINT TO                     E16477S01435
     C***OBTAIN*A*FULL ADDRESS.                                     E16477S01435
     C************                                                  E16477S01435
     C************         MOVELINB1      SWIFKY                    E16477S01435
     C***********SWIFKY****CHAINMSADR                89      E16477S01194 S01435
     C***********SWIFKY    CHAINSDCUSTL7             89            S01194 S01435
     C**N89******RECI      COMP 'D'                  8989          E16477 S01435
     C************                                                 E16477 S01435
     C************IN89     IFEQ '1'                          E16477050920 S01435
     C************         MOVEL'SDCUSTPD'WDBFIL             S01194050920 S01435
     C*********************MOVEL'MSADR'   WDBFIL           **S01194050920 S01435
     C************         MOVELSWIFKY    WDBKEY           * E16477050920 S01435
     C************         MOVEL'14'      WDBASE           * E16477050920 S01435
     C************         EXSR UEABRT                     **E16477050920 S01435
     C************         END                               E16477050920 S01435
     C************IN89     IFEQ '1'                                 050920S01435
     C************         MOVELSWIFKY    P1INB1                    050920S01435
     C************         MOVE WARN,1    P1INB2                    050920S01435
     C************         MOVE WARN,2    P1INB3                    050920S01435
     C************         MOVEL*BLANKS   P1INB4                    050920S01435
     C************         MOVEL*BLANKS   P1INB5                    050920S01435
     C************         ELSE                                     050920S01435
     C************                                                  E16477S01435
     C*********************MOVELCNUM      WCLNUM              E16477S01194S01435
     C************         MOVELBBCUST    WCLNUM                    S01194S01435
     C************         MOVEL'B'       WCLRCT                    E16477S01435
     C************         EXSR UCCLCN                              E16477S01435
     C************                                                  E16477S01435
     C************IN89     IFEQ '1'                                 E16477S01435
     C************         MOVEL'CLINT'   WDBFIL           ******** E16477S01435
     C************         MOVELWCLNUM    WA7              * DATA B E16477S01435
     C************         MOVE WCLRCT    WA7              * ERROR  E16477S01435
     C************         MOVELWA7       WDBKEY           ******** E16477S01435
     C************         MOVEL'15'      WDBASE                    E16477S01435
     C************         EXSR UEABRT                     *ABORT P E16477S01435
     C************         END                                      E16477S01435
     C************                                                  E16477S01435
     C***********STMT      IFNE 08                                  E16477S01435
     C************         MOVEL*BLANK    INB1                      E16477S01435
     C*********************MOVELCNUM      INB1                E16477S01194S01435
     C************         MOVELBBCUST    INB1                      S01194S01435
     C************         END                                      E16477S01435
     C************                                                  E16477S01435
     C************         MOVELINB1      P1INB1                    E16477S01435
     C************         MOVELCNA1      P1INB2                    E16477S01435
     C************         MOVELCNA2      P1INB3                    E16477S01435
     C************         MOVELCNA3      P1INB4                    E16477S01435
     C************         MOVELCNA4      P1INB5                    E16477S01435
     C************         END                                      050920S01435
     C************         END                                      E16477S01435
     C           CFT120    IFEQ 'Y'                                                           CFT120
      *                                                                                       CFT120
      ** Access currency record for charges to the dr of currency                             CFT120
      *                                                                                       CFT120
     C           OPCDRC    IFNE *BLANKS                                                       CFT120
     C                     MOVEL*BLANKS   ZTABKY                                              CFT120
     C                     MOVEL'20'      ZTABKY                                              CFT120
     C                     MOVELOPCDRC    WA4                                                 CFT120
     C                     MOVE '1'       WA4                                                 CFT120
     C                     MOVE WA4       ZTABKY                                              CFT120
     C                     EXSR UATBCN                                                        CFT120
      *                                                                                       CFT120
      ** Check if database error occured                                                      CFT120
      *                                                                                       CFT120
     C           *IN89     IFEQ '1'                                                           CFT120
     C                     MOVEL'TABLE'   WDBFIL                                              CFT120
     C                     MOVELZTABKY    WDBKEY                                              CFT120
     C                     MOVEL'62'      WDBASE                                              CFT120
     C                     EXSR UEABRT                                                        CFT120
     C                     ELSE                                                               CFT120
      *                                                                                       CFT120
      ** Store number of decimal places for CDRC currency                                     CFT120
      *                                                                                       CFT120
     C                     Z-ADDCDP       SVCCDP  10                                          CFT120
     C                     ENDIF                                                              CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
      ** Access currency record for fixed charge currency (ICD)                               CFT120
      *                                                                                       CFT120
     C           BTCHCY    IFEQ 'F'                                                           CFT120
     C           FCHCCY    ANDNE*BLANKS                                                       CFT120
     C                     MOVEL*BLANKS   ZTABKY                                              CFT120
     C                     MOVEL'20'      ZTABKY                                              CFT120
     C                     MOVELFCHCCY    WA4                                                 CFT120
     C                     MOVE '1'       WA4                                                 CFT120
     C                     MOVE WA4       ZTABKY                                              CFT120
     C                     EXSR UATBCN                                                        CFT120
      *                                                                                       CFT120
      ** Check if database error occured                                                      CFT120
      *                                                                                       CFT120
     C           *IN89     IFEQ '1'                                                           CFT120
     C                     MOVEL'TABLE'   WDBFIL                                              CFT120
     C                     MOVELZTABKY    WDBKEY                                              CFT120
     C                     MOVEL'63'      WDBASE                                              CFT120
     C                     EXSR UEABRT                                                        CFT120
     C                     ELSE                                                               CFT120
      *                                                                                       CFT120
      ** Store number of decimal places for CDRC currency                                     CFT120
      *                                                                                       CFT120
     C                     Z-ADDCDP       SVFCDP  10                                          CFT120
     C                     ENDIF                                                              CFT120
     C                     ENDIF                                                              CFT120
     C                     ENDIF                                                              CFT120
     C*
     C** FORMAT SETTLE & PAY AMOUNTS
     C*
     C** CALL UATBCN TO ACCESS CURRENCY RECORD FOR SETTLE CURRENCY
     C*
     C                     MOVEL*BLANKS   ZTABKY
     C                     MOVEL'20'      ZTABKY
     C                     MOVELSMCY      WA4
     C                     MOVE '1'       WA4
     C                     MOVE WA4       ZTABKY
     C                     EXSR UATBCN
     C*
     C** CHECK IF DATABASE ERROR OCCURRED
     C*
     C           *IN89     IFEQ '1'
     C                     MOVEL'TABLE'   WDBFIL
     C                     MOVELZTABKY    WDBKEY
     C******************   MOVEL'09'      WDBASE                          E16477
     C                     MOVEL'16'      WDBASE                          E16477
     C                     EXSR UEABRT                     *ABORT PGM*
     C                     END
     C*
     C** STORE NUMBER OF DECIMAL PLACES FOR SETTLE CURRENCY
     C*
     C                     Z-ADDCDP       SVSCDP  10
     C*
     C** FORMAT SETTLE AMOUNT
     C*
     C                     MOVEL*BLANKS   WFDIN  15
     C                     MOVE SMAM      WFDIN
     C                     Z-ADDSVSCDP    WDEC    10
     C           13        SUB  SVSCDP    WDIG    20
     C                     EXSR UGFRMT
     C                     MOVE WFDOUT    P1SMAM
     C*
     C** CALL UATBCN TO ACCESS CURRENCY RECORD FOR PAY CURRENCY
     C*
     C                     MOVEL*BLANKS   ZTABKY
     C                     MOVEL'20'      ZTABKY
     C                     MOVELPCCY      WA4
     C                     MOVE '1'       WA4
     C                     MOVE WA4       ZTABKY
     C                     EXSR UATBCN
     C*
     C** CHECK IF DATABASE ERROR OCCURRED
     C*
     C           *IN89     IFEQ '1'
     C                     MOVEL'TABLE'   WDBFIL
     C                     MOVELZTABKY    WDBKEY
     C******************   MOVEL'10'      WDBASE                          E16477
     C                     MOVEL'17'      WDBASE                          E16477
     C                     EXSR UEABRT                     *ABORT PGM*
     C                     END
     C*
     C** STORE NUMBER OF DECIMAL PLACES FOR PAY CURRENCY
     C*
     C                     Z-ADDCDP       SVPCDP  10
     C*
     C** FORMAT PAY AMOUNT
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE PYAM      WFDIN
     C                     Z-ADDSVPCDP    WDEC
     C           13        SUB  SVPCDP    WDIG
     C                     EXSR UGFRMT
     C                     MOVE WFDOUT    P1PYAM
      *                                                                   CEU006
      **  Format Notified Delivery Amount.                                CEU006
      *                                                                   CEU006
     C                     MOVEA'00'      *IN,55                          CEU006
      *                                                                   CEU006
     C           NDAM      IFNE 0                          B*1            CEU006
     C                     MOVE '1'       *IN55                           CEU006
      *                                                                   CEU006
      **  Call SR/UATBCN to access currency record for Notified           CEU006
      **  Delivery Currency.                                              CEU006
      *                                                                   CEU006
     C                     MOVEL*BLANKS   ZTABKY                          CEU006
     C                     MOVEL'20'      ZTABKY                          CEU006
     C                     MOVELNDCY      WA4                             CEU006
     C                     MOVE '1'       WA4                             CEU006
     C                     MOVE WA4       ZTABKY                          CEU006
     C                     EXSR UATBCN                                    CEU006
      *                                                                   CEU006
      **  Check if database error occurred.                               CEU006
      *                                                                   CEU006
     C           *IN89     IFEQ '1'                        B*2            CEU006
     C                     MOVEL'TABLE'   WDBFIL                          CEU006
     C                     MOVELZTABKY    WDBKEY                          CEU006
     C                     MOVEL'053'     WDBASE                          CEU006
     C                     EXSR UEABRT                     *ABORT PGM*    CEU006
     C                     ENDIF                           E*2            CEU006
      *                                                                   CEU006
     C                     Z-ADDNDAM      ZFLD15                          CEU006
     C                     Z-ADDCDP       ZDECS                           CEU006
     C                     MOVE 'J'       ZECODE                          CEU006
     C                     EXSR ZSEDIT                                    CEU006
     C                     MOVE ZOUT21    WFLD18 18                       CEU006
     C                     MOVE WFLD18    RNDAMT                          CEU006
     C                     MOVE NDCY      RNDCCY                          CEU006
     C                     ENDIF                           E*1            CEU006
      *                                                                   CEU006
      **  Format Pay Delivery Amount.                                     CEU006
      *                                                                   CEU006
     C***********PDAM      IFNE 0                          B*1     CEU006 CFT014
      *                                                                   CFT014
     C           CEU006    IFEQ 'Y'                                       CFT014
     C           CFT014    OREQ 'Y'                                       CFT014
      *                                                                   CFT014
     C                     MOVE '1'       *IN56                           CEU006
      *                                                                   CFT014
     C           PDAM      IFEQ 0                                         CFT014
     C                     MOVE *BLANKS   RPDAMT                          CFT014
     C                     MOVE *BLANKS   RPDCCY                          CFT014
     C                     ELSE                                           CFT014
      *                                                                   CEU006
      **  Call SR/UATBCN to access currency record for Pay                CEU006
      **  Delivery Currency.                                              CEU006
      *                                                                   CEU006
     C                     MOVEL*BLANKS   ZTABKY                          CEU006
     C                     MOVEL'20'      ZTABKY                          CEU006
     C                     MOVELPDCY      WA4                             CEU006
     C                     MOVE '1'       WA4                             CEU006
     C                     MOVE WA4       ZTABKY                          CEU006
     C                     EXSR UATBCN                                    CEU006
      *                                                                   CEU006
      **  Check if database error occurred                                CEU006
      *                                                                   CEU006
     C           *IN89     IFEQ '1'                        B*2            CEU006
     C                     MOVEL'TABLE'   WDBFIL                          CEU006
     C                     MOVELZTABKY    WDBKEY                          CEU006
     C                     MOVEL'054'     WDBASE                          CEU006
     C                     EXSR UEABRT                     *ABORT PGM*    CEU006
     C                     ENDIF                           E*2            CEU006
      *                                                                   CEU006
     C                     Z-ADDPDAM      ZFLD15                          CEU006
     C                     Z-ADDCDP       ZDECS                           CEU006
     C                     MOVE 'J'       ZECODE                          CEU006
     C                     EXSR ZSEDIT                                    CEU006
     C                     MOVE ZOUT21    WFLD18                          CEU006
     C                     MOVE WFLD18    RPDAMT                          CEU006
     C                     MOVE PDCY      RPDCCY                          CEU006
     C                     ENDIF                           E*1            CEU006
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
     C*
     C** FORMAT OTHER AMOUNTS & CURRENCIES
     C** IF CHARGES TO DEBIT A/C FIELD IS NON-ZERO USE BASE CURRENCY;
     C** OTHERWISE IF PAY PLUS CHARGES INDICATOR IS 'Y' USE SETTLE CCY;
     C** OTHERWISE USE PAY CURRENCY
     C*
     C***********CDRO      IFNE *ZERO                                                         CSD027
     C           CDRO      IFNE *BLANKS                                                       CSD027
      *                                                                                       CFT120
     C                     MOVELBCCY      WCCY    3
     C                     Z-ADDSVBCDP    WDEC
     C           OPCDRC    IFNE *BLANKS                                                       CFT120
     C           CFT120    ANDEQ'Y'                                                           CFT120
     C                     MOVE OPCDRC    WCCY                                                CFT120
     C                     Z-ADDSVCCDP    WDEC                                                CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
     C/COPY WNCPYSRC,FT0510C003
     C                     ELSE
     C           ADDC      IFEQ 'A'
     C                     MOVELSMCY      WCCY
     C                     Z-ADDSVSCDP    WDEC
     C                     ELSE
     C                     MOVELPCCY      WCCY
     C                     Z-ADDSVPCDP    WDEC
     C                     END
     C                     END
     C*
     C           11        SUB  WDEC      WDIG
      *                                                                   CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
      *                                                                   CFT014
     C           OPOEXR    IFNE 0                                         CFT014
     C                     Z-ADDOPOEXR    P1OEXR                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVELOPBOCD    P1BOCD                          CFT014
     C                     MOVELOPTTCD    P1TTCD                          CFT014
     C                     MOVELOPTRI1    P1TRI1                          CFT014
     C                     MOVELOPTRI2    P1TRI2                          CFT014
     C                     MOVELOPTRI3    P1TRI3                          CFT014
     C                     MOVELOPTRI4    P1TRI4                          CFT014
     C                     MOVELOPTRI5    P1TRI5                          CFT014
     C                     MOVELOPICD1    P1ICD1                          CFT014
     C                     MOVELOPICD2    P1ICD2                          CFT014
     C                     MOVELOPICD3    P1ICD3                          CFT014
     C                     MOVELOPICD4    P1ICD4                          CFT014
     C                     MOVELOPICD5    P1ICD5                          CFT014
     C                     MOVELOPRRP1    P1RRP1                          CFT014
     C                     MOVELOPRRP2    P1RRP2                          CFT014
     C                     MOVELOPRRP3    P1RRP3                          CFT014
      *                                                                   CFT014
      ** Format Receiver's Charges                                        CFT014
      *                                                                   CFT014
     C           OPRCRM    IFEQ 0                                         CFT014
     C                     MOVE *BLANKS   P1RCRM                          CFT014
     C                     MOVE *BLANKS   P1RCRY                          CFT014
     C                     ELSE                                           CFT014
     C                     MOVEL*BLANKS   WFDIN                           CFT014
     C                     MOVE OPRCRM    WFDIN                           CFT014
     C                     EXSR UGFRMT                                    CFT014
     C                     MOVE WFDOUT    P1RCRM                          CFT014
     C                     MOVE PCCY      P1RCRY                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Format Sender's Charges                                          CFT014
      *                                                                   CFT014
     C           OPSCC1    IFEQ *BLANKS                                   CFT014
     C                     MOVE *BLANKS   P1SCH1                          CFT014
     C                     MOVE *BLANKS   P1SCY1                          CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C                     CALL 'AOCURRR0'                                CFT014
     C                     PARM '*DBERR ' @RTCD   7                       CFT014
     C                     PARM '*KEY   ' @OPTN   7                       CFT014
     C                     PARM OPSCC1    @CCY    3                       CFT014
     C           SDCURR    PARM SDCURR    DSSDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C           *LOCK     IN   DLDA                                      CFT014
     C                     MOVEL'SDCURRPD'DBFILE                          CFT014
     C                     MOVEL'*VERIFY' DBKEY                           CFT014
     C                     MOVEL'72'      DBASE                           CFT014
     C                     OUT  DLDA                                      CFT014
     C                     SETON                     U7U8LR               CFT014
     C                     EXSR UEABRT                                    CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C                     MOVE A6NBDP    WNBDP1  10                      CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     Z-ADDWNBDP1    WDEC    10                      CFT014
     C           11        SUB  WDEC      WDIG    20                      CFT014
     C                     MOVEL*BLANKS   WFDIN                           CFT014
     C                     MOVE OPSCH1    WFDIN                           CFT014
     C                     EXSR UGFRMT                                    CFT014
     C                     MOVE WFDOUT    P1SCH1                          CFT014
     C                     MOVE OPSCC1    P1SCY1                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           OPSCC2    IFEQ *BLANKS                                   CFT014
     C                     MOVE *BLANKS   P1SCH2                          CFT014
     C                     MOVE *BLANKS   P1SCY2                          CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C                     CALL 'AOCURRR0'                                CFT014
     C                     PARM '*DBERR ' @RTCD   7                       CFT014
     C                     PARM '*KEY   ' @OPTN   7                       CFT014
     C                     PARM OPSCC2    @CCY    3                       CFT014
     C           SDCURR    PARM SDCURR    DSSDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C           *LOCK     IN   DLDA                                      CFT014
     C                     MOVEL'SDCURRPD'DBFILE                          CFT014
     C                     MOVEL'*VERIFY' DBKEY                           CFT014
     C                     MOVEL'73'      DBASE                           CFT014
     C                     OUT  DLDA                                      CFT014
     C                     SETON                     U7U8LR               CFT014
     C                     EXSR UEABRT                                    CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C                     MOVE A6NBDP    WNBDP2  10                      CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     Z-ADDWNBDP2    WDEC                            CFT014
     C           11        SUB  WDEC      WDIG                            CFT014
     C                     MOVEL*BLANKS   WFDIN                           CFT014
     C                     MOVE OPSCH2    WFDIN                           CFT014
     C                     EXSR UGFRMT                                    CFT014
     C                     MOVE WFDOUT    P1SCH2                          CFT014
     C                     MOVE OPSCC2    P1SCY2                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           OPSCC3    IFEQ *BLANKS                                   CFT014
     C                     MOVE *BLANKS   P1SCH3                          CFT014
     C                     MOVE *BLANKS   P1SCY3                          CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C                     CALL 'AOCURRR0'                                CFT014
     C                     PARM '*DBERR ' @RTCD   7                       CFT014
     C                     PARM '*KEY   ' @OPTN   7                       CFT014
     C                     PARM OPSCC3    @CCY    3                       CFT014
     C           SDCURR    PARM SDCURR    DSSDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C           *LOCK     IN   DLDA                                      CFT014
     C                     MOVEL'SDCURRPD'DBFILE                          CFT014
     C                     MOVEL'*VERIFY' DBKEY                           CFT014
     C                     MOVEL'74'      DBASE                           CFT014
     C                     OUT  DLDA                                      CFT014
     C                     SETON                     U7U8LR               CFT014
     C                     EXSR UEABRT                                    CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C                     MOVE A6NBDP    WNBDP3  10                      CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     Z-ADDWNBDP3    WDEC                            CFT014
     C           11        SUB  WDEC      WDIG                            CFT014
     C                     MOVEL*BLANKS   WFDIN                           CFT014
     C                     MOVE OPSCH3    WFDIN                           CFT014
     C                     EXSR UGFRMT                                    CFT014
     C                     MOVE WFDOUT    P1SCH3                          CFT014
     C                     MOVE OPSCC3    P1SCY3                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           OPSCC4    IFEQ *BLANKS                                   CFT014
     C                     MOVE *BLANKS   P1SCH4                          CFT014
     C                     MOVE *BLANKS   P1SCY4                          CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C                     CALL 'AOCURRR0'                                CFT014
     C                     PARM '*DBERR ' @RTCD   7                       CFT014
     C                     PARM '*KEY   ' @OPTN   7                       CFT014
     C                     PARM OPSCC4    @CCY    3                       CFT014
     C           SDCURR    PARM SDCURR    DSSDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C           *LOCK     IN   DLDA                                      CFT014
     C                     MOVEL'SDCURRPD'DBFILE                          CFT014
     C                     MOVEL'*VERIFY' DBKEY                           CFT014
     C                     MOVEL'75'      DBASE                           CFT014
     C                     OUT  DLDA                                      CFT014
     C                     SETON                     U7U8LR               CFT014
     C                     EXSR UEABRT                                    CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C                     MOVE A6NBDP    WNBDP4  10                      CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     Z-ADDWNBDP4    WDEC                            CFT014
     C           11        SUB  WDEC      WDIG                            CFT014
     C                     MOVEL*BLANKS   WFDIN                           CFT014
     C                     MOVE OPSCH4    WFDIN                           CFT014
     C                     EXSR UGFRMT                                    CFT014
     C                     MOVE WFDOUT    P1SCH4                          CFT014
     C                     MOVE OPSCC4    P1SCY4                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           OPSCC5    IFEQ *BLANKS                                   CFT014
     C                     MOVE *BLANKS   P1SCH5                          CFT014
     C                     MOVE *BLANKS   P1SCY5                          CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C                     CALL 'AOCURRR0'                                CFT014
     C                     PARM '*DBERR ' @RTCD   7                       CFT014
     C                     PARM '*KEY   ' @OPTN   7                       CFT014
     C                     PARM OPSCC5    @CCY    3                       CFT014
     C           SDCURR    PARM SDCURR    DSSDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C           *LOCK     IN   DLDA                                      CFT014
     C                     MOVEL'SDCURRPD'DBFILE                          CFT014
     C                     MOVEL'*VERIFY' DBKEY                           CFT014
     C                     MOVEL'75'      DBASE                           CFT014
     C                     OUT  DLDA                                      CFT014
     C                     SETON                     U7U8LR               CFT014
     C                     EXSR UEABRT                                    CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C                     MOVE A6NBDP    WNBDP5  10                      CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     Z-ADDWNBDP5    WDEC                            CFT014
     C           11        SUB  WDEC      WDIG                            CFT014
     C                     MOVEL*BLANKS   WFDIN                           CFT014
     C                     MOVE OPSCH5    WFDIN                           CFT014
     C                     EXSR UGFRMT                                    CFT014
     C                     MOVE WFDOUT    P1SCH5                          CFT014
     C                     MOVE OPSCC5    P1SCY5                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** If all Sender's Charges are zeros and Details of                 CFT014
      ** Charges is 'BEN', print first amount as zero and                 CFT014
      ** Pay Currency.                                                    CFT014
      *                                                                   CFT014
     C*          OPSCH1    IFEQ 0                                         CFT014
     C*          OPSCH2    ANDEQ0                                         CFT014
     C*          OPSCH3    ANDEQ0                                         CFT014
     C*          OPSCH4    ANDEQ0                                         CFT014
     C*          OPSCH5    ANDEQ0                                         CFT014
     C*          DTCH      ANDEQ'BEN'                                     CFT014
     C*                    MOVEL*BLANKS   WFDIN                           CFT014
     C*                    MOVE OPSCH1    WFDIN                           CFT014
     C*                    EXSR UGFRMT                                    CFT014
     C*                    MOVE WFDOUT    P1SCH1                          CFT014
     C*                    MOVE PCCY      P1SCY1                          CFT014
     C*                    ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
     C*
     C** SETUP CURRENCY NAMES
     C*
     C                     MOVELWCCY      P1TRCY
     C                     MOVELWCCY      P1TXCY
     C                     MOVELWCCY      P1CQCY
     C                     MOVELWCCY      P1SPCY
     C                     MOVELWCCY      P1CSCY
     C                     MOVELWCCY      P1MSCY
     C*                                                                   S01499
     C** Set up ccy for V.A.T. if S01499 feature is active                S01499
     C*                                                                   S01499
     C           *IN24     IFEQ '1'                                       S01499
     C                     MOVELWCCY      P1VTCY                          S01499
     C                     END                                            S01499
     C*                                                                   S01494
     C** Set up ccy for FX/Change only if S01494 feature is active        S01494
     C*                                                                   S01494
     C           *IN23     IFEQ '1'                                       S01494
     C                     MOVELWCCY      P1CHCY                          S01494
     C                     END                                            S01494
     C*
     C** FORMAT TRANSFER COMMISSION AMOUNT
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE TRCM      WFDIN
     C                     EXSR UGFRMT
     C                     MOVE WFDOUT    P1TRCM
     C*
     C** FORMAT TELEX CHARGE AMOUNT
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE TXCH      WFDIN
     C                     EXSR UGFRMT
     C                     MOVE WFDOUT    P1TXCH
     C*
     C** FORMAT CHEQUE CHARGE AMOUNT
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CQCH      WFDIN
     C                     EXSR UGFRMT
     C                     MOVE WFDOUT    P1CQCH
     C*
     C** FORMAT SWIFT PR CHARGE AMOUNT
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE SPCH      WFDIN
     C                     EXSR UGFRMT
     C                     MOVE WFDOUT    P1SPCH
     C*
     C** FORMAT COSTS ABROAD CHARGE AMOUNT
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CSTA      WFDIN
     C                     EXSR UGFRMT
     C                     MOVE WFDOUT    P1CSTA
     C*
     C** FORMAT MISCELLANEOUS CHARGE AMOUNT
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE MSCH      WFDIN
     C                     EXSR UGFRMT
     C                     MOVE WFDOUT    P1MSCH
     C*                                                                   S01499
     C** Format the V.A.T. amount if S01499 is active                     S01499
     C*                                                                   S01499
     C           *IN24     IFEQ '1'                                       S01499
     C                     MOVE *BLANKS   WFDIN                           S01499
     C                     MOVE OPVATT    WFDIN                           S01499
     C                     EXSR UGFRMT                                    S01499
     C                     MOVE WFDOUT    P1VATT                          S01499
     C                     END                                            S01499
     C*                                                                   S01494
     C** Format the FX/Change Commission amount if S01494 is active       S01494
     C*                                                                   S01494
     C           *IN23     IFEQ '1'                                       S01494
     C                     MOVE *BLANKS   WFDIN                           S01494
     C                     MOVE OPCHCM    WFDIN                           S01494
     C                     EXSR UGFRMT                                    S01494
     C                     MOVE WFDOUT    P1CHCM                          S01494
     C                     END                                            S01494
      *                                                                   134117
      ** Compute and Settle/Pay amount if charges to debit a/c            134117
      ** field is zero. If ADDC equal to 'A' deduct charges from          134117
      ** settle amount. Otherwise, deduct charges from pay amount.        134117
      *                                                                   134117
     C                     MOVEA'00'      *IN,25                          134117
     C                     Z-ADD*ZERO     SMCH   130                      134117
     C                     Z-ADD*ZERO     PYCH   130                      134117
      *                                                                   134117
     C***********CDRO      IFEQ *ZERO                                                  134117 CSD027
     C           CDRO      IFEQ *BLANKS                                                       CSD027
      *                                                                   134117
     C                     Z-ADDTRCM      CHRGS  130                      134117
     C                     ADD  TXCH      CHRGS                           134117
     C                     ADD  CQCH      CHRGS                           134117
     C                     ADD  SPCH      CHRGS                           134117
     C                     ADD  CSTA      CHRGS                           134117
     C                     ADD  MSCH      CHRGS                           134117
      *                                                                   134117
      * If CFT009 active, add new charges                                 CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
     C                     ADD  SWSCHG    CHRGS                           CFT009
     C                     ADD  MISC01    CHRGS                           CFT009
     C                     ADD  MISC02    CHRGS                           CFT009
     C                     ADD  MISC03    CHRGS                           CFT009
     C                     ADD  MISC04    CHRGS                           CFT009
     C                     ADD  MISC05    CHRGS                           CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           CHRGS     IFNE *ZERO                                     134117
     C           ADDC      IFEQ 'A'                                       134117
     C                     MOVE '1'       *IN25                           134117
     C           SMAM      ADD  CHRGS     SMCH   130                      134117
     C                     MOVEL*BLANKS   WFDIN                           134117
     C                     MOVE SMCH      WFDIN                           134117
     C                     EXSR UGFRMT                                    134117
     C                     MOVE WFDOUT    P1SMCH                          134117
     C                     MOVE SMCY      P1SMCC                          134117
      *                                                                   134117
     C                     ELSE                                           134117
     C                     MOVE '1'       *IN26                           134117
     C           PYAM      SUB  CHRGS     PYCH   130                      134117
     C                     MOVEL*BLANKS   WFDIN                           134117
     C                     MOVE PYCH      WFDIN                           134117
     C                     EXSR UGFRMT                                    134117
     C                     MOVE WFDOUT    P1PYCH                          134117
     C                     MOVE PCCY      P1PCCC                          134117
     C                     END                                            134117
     C                     END                                            134117
      *                                                                   134117
     C                     END                                            134117
     C*
     C** FORMAT DATE FIELDS USING SYSTEM ROUTINE ZDATE2
     C*
     C** SETTLE VALUE DATE
     C*
     C                     Z-ADDSLDT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVELZADATE    P1SLDT
     C*
     C** PAY VALUE DATE
     C*
     C                     Z-ADDPVDT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVELZADATE    P1PYDT
     C*
     C** FINAL DATE
     C*
     C                     Z-ADDFDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVELZADATE    P1FDAT
     C*
     C                     Z-ADDNPDT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVELZADATE    P1NPDT
     C*
     C** SET UP USER FIELDS FROM MUSERDD,IF AUDIT
     C*
     C                     SETOF                     50
     C           PARM1     IFEQ 'A'
     C*
     C                     SETON                     50
     C           INUSR1    IFNE *BLANKS
     C                     MOVE INUSR1    USRP
     C                     EXSR UCMUSE
     C                     MOVE USER1     SIUSR1 25
     C                     ELSE                                           E23052
     C                     MOVE *BLANKS   SIUSR1                          E23052
     C                     END
      *
     C           INUSR2    IFNE *BLANKS
     C                     MOVE INUSR2    USRP
     C                     EXSR UCMUSE
     C                     MOVE USER1     SIUSR2 25
     C                     ELSE                                           E23052
     C                     MOVE *BLANKS   SIUSR2                          E23052
     C                     END
      *
     C           AUP1      IFNE *BLANKS
     C                     MOVE AUP1      USRP
     C                     EXSR UCMUSE
     C                     MOVE USER1     SAUP1  25
     C                     ELSE                                           E23052
     C                     MOVE *BLANKS   SAUP1                           E23052
     C                     END
      *
     C           AUP2      IFNE *BLANKS
     C                     MOVE AUP2      USRP
     C                     EXSR UCMUSE
     C                     MOVE USER1     SAUP2  25
     C                     ELSE                                           E23052
     C                     MOVE *BLANKS   SAUP2                           E23052
     C                     END
      *
     C                     END
     C*                                                                   S01499
     C** Set up the V.A.T. flags of all charges if S01499 is active       S01499
     C*                                                                   S01499
     C           *IN24     IFEQ '1'                                       S01499
     C                     MOVE OPVAT1    P1TRVF                          S01499
     C                     MOVE OPVAT2    P1TXVF                          S01499
     C                     MOVE OPVAT3    P1CQVF                          S01499
     C                     MOVE OPVAT4    P1CSVF                          S01499
     C                     MOVE OPVAT5    P1SPVF                          S01499
     C                     MOVE OPVAT6    P1MSVF                          S01499
     C                     MOVE OPVAT7    P1CHVF                          S01499
     C                     END                                            S01499
     C*
     C** SETUP REMAINING REPORT FIELDS
     C*
     C                     MOVELPREF      P1PREF
     C                     MOVELPYTP      P1PYTP
     C                     MOVELPYST      P1PYST
     C                     MOVELSMCY      P1SMCY
     C                     Z-ADDRATE      P1RATE
     C                     MOVELPCCY      P1PCCY
     C                     MOVELBBI1      P1BBI1
     C                     MOVELBBI2      P1BBI2
     C                     MOVELBBI3      P1BBI3
     C                     MOVELBBI4      P1BBI4
     C                     MOVELBBI5      P1BBI5
     C                     MOVELBBI6      P1BBI6
     C                     MOVELDTP1      P1DTP1
     C                     MOVELDTP2      P1DTP2
     C                     MOVELDTP3      P1DTP3
     C                     MOVELDTP4      P1DTP4
     C                     MOVELSTMT      P1STTP
     C/COPY WNCPYSRC,FT0510C009
     C           DNBC      IFEQ *ZERO
     C/COPY WNCPYSRC,FT0510C010
     C                     MOVE *BLANKS   P1DNBC
     C                     ELSE
     C                     MOVELDNBC      P1DNBC
     C                     END
     C                     MOVELSNMT      P1SNMT
     C                     MOVELADDC      P1ADDC
     C                     MOVELRPAY      P1RPAY
     C                     MOVELPAYF      P1PAYF
     C                     MOVELDYIM      P1DYIM
     C                     MOVELDTCH      P1DTCH
     C                     MOVELTRCT      P1TRCT
     C*********************MOVELSWPC      P1SWPC                          S01117
     C           SWPC      IFEQ 1                          B001           S01117
     C                     MOVE 'U'       P1SWPC                          S01117
     C                     ELSE                            X001           S01117
     C           SWPC      IFEQ 2                          B002           S01117
     C                     MOVE 'N'       P1SWPC                          S01117
     C                     END                             E002           S01117
     C                     END                             E001           S01117
     C*                                                                   E32872
     C** OUPUT OVERRIDE IF 'Y'                                            E32872
     C*                                                                   E32872
     C                     MOVE *BLANKS   P1OVRD                          E32872
     C           OVRD      IFEQ 'Y'                                       E32872
     C                     MOVE 'YES'     P1OVRD                          E32872
     C                     ELSE                                           E32872
     C                     MOVE 'NO '     P1OVRD                          E32872
     C                     END                                            E32872
      *                                                                   E25232
     C           OXPREF    IFNE *BLANKS                                   E25232
     C                     SETON                     51                   E25232
     C                     ELSE                                           E25232
     C                     SETOF                     51                   E25232
     C                     END                                            E25232
      *                                                                   E25232
     ****The following lines were added to transfer data to printer****
     C                     MOVE RLPR      P1RLPR
     C           CHAP      IFEQ *ZERO
     C                     MOVE *BLANKS   P1CHAP
     C                     ELSE
     C                     MOVELCHAP      P1CHAP
     C                     END
     C*                                                                   E21463
     C** MT100 customer                                                   E21463
     C*                                                                   E21463
     C           ODMT      IFEQ *BLANK                     B001           E21463
     C           ODMT      OREQ *ZERO                                     E21463
     C                     MOVE *BLANK    P1ODMT                          E21463
     C                     MOVE *BLANK    P1ODMC                          E21463
     C                     ELSE                            X001           E21463
      *                                                                                       CFT032
     C                     MOVE 'Y'       W9CUST                                              CFT032
     C                     SELEC                                                              CFT032
      *                                                                                       CFT032
      ** Full Nostro                                                                          CFT032
      *                                                                                       CFT032
     C           ODMTT     WHEQ 'F'                                                           CFT032
     C           3         SUBSTODMT:1    @KEYB                                               CFT032
     C           2         SUBSTODMT:4    @KEYE                                               CFT032
     C                     CALL 'AONOSTR0'#ANOST                                              CFT032
     C           @RTCD     IFNE *BLANKS                                                       CFT032
     C           *LOCK     IN   DLDA                                                          CFT032
     C                     MOVEL'26'      WDBASE                                              CFT032
     C                     MOVELODMT      WDBKEY                                              CFT032
     C                     MOVEL'SDNOSTPD'WDBFIL                                              CFT032
     C                     OUT  DLDA                                                          CFT032
     C                     EXSR UEABRT                                                        CFT032
     C                     ENDIF                                                              CFT032
     C                     MOVELA7CUST    WCLNUM                                              CFT032
      *                                                                                       CFT032
      ** IBAN                                                                                 CFT032
      *                                                                                       CFT032
     C           ODMTT     WHEQ 'I'                                                           CFT032
     C                     MOVELODMT      P@IBN  34                                           CFT032
     C                     MOVE *BLANKS   DSSDY                                               CFT032
     C                     CALL 'AOIBANR4'                                                    CFT032
     C                     PARM           @RTCD                                               CFT032
     C                     PARM '*KEY   ' @OPTN                                               CFT032
     C                     PARM           P@IBN                                               CFT032
     C           WACCN     PARM           DSSDY                                               CFT032
     C           @RTCD     IFNE *BLANKS                                                       CFT032
     C           *LOCK     IN   DLDA                                                          CFT032
     C                     MOVEL'27'      WDBASE                                              CFT032
     C                     MOVELP@IBN     WDBKEY                                              CFT032
     C                     MOVEL'ACCNTL6' WDBFIL                                              CFT032
     C                     OUT  DLDA                                                          CFT032
     C                     EXSR UEABRT                                                        CFT032
     C                     ENDIF                                                              CFT032
     C                     MOVELWWCNUM    WCLNUM                                              CFT032
      *                                                                                       CFT032
      ** GL Account                                                                           CFT032
      *                                                                                       CFT032
     C           ODMTT     WHEQ 'G'                                                           CFT032
     C           24        SUBSTODMT:1    WCDET                                               CFT032
     C                     MOVEL*BLANKS   @RETL  10                                           CFT032
     C                     MOVELWDCNUM    @CNNM   6                                           CFT032
     C                     MOVELWDCCY     @CUCD   3                                           CFT032
     C                     MOVELWDACOD    @ACCD                                               CFT032
     C                     MOVELWDACSQ    @ACSQ                                               CFT032
     C           MBIN      IFEQ 'Y'                                                           CFT032
     C                     MOVE WDBRCA    @BRCD                                               CFT032
     C                     ELSE                                                               CFT032
     C                     MOVE BJSBRC    @BRCD                                               CFT032
     C                     ENDIF                                                              CFT032
     C                     CALL 'AOACCTR0'#AACCT                                              CFT032
     C           @RTCD     IFNE *BLANKS                                                       CFT032
     C           *LOCK     IN   DLDA                                                          CFT032
     C                     MOVEL'28'      WDBASE                                              CFT032
     C                     MOVELWCDET     WDBKEY                                              CFT032
     C                     MOVEL'ACCNTAB' WDBFIL                                              CFT032
     C                     OUT  DLDA                                                          CFT032
     C                     EXSR UEABRT                                                        CFT032
     C                     ENDIF                                                              CFT032
     C                     MOVELWWCNUM    WCLNUM                                              CFT032
      *                                                                                       CFT032
      ** SWIFT                                                                                CFT032
      *                                                                                       CFT032
     C           ODMTT     WHEQ 'S'                                                           CFT032
     C           8         SUBSTODMT:1    W9BICC  8                                           CFT032
     C           3         SUBSTODMT:9    W9BICB  3                                           CFT032
      *                                                                                       CFT032
     C                     CALL 'ME1400'               9090                                   CFT032
     C                     PARM *BLANKS   W9RTN   7                                           CFT032
     C                     PARM           W9BICC                                              CFT032
     C                     PARM           W9BICB                                              CFT032
     C                     PARM           SDCUST                                              CFT032
     C                     PARM           SDCNST                                              CFT032
     C                     PARM           MEBICD                                              CFT032
     C                     PARM *BLANKS   W9CUST  1                                           CFT032
     C                     PARM *BLANKS   W9CNST  1                                           CFT032
     C                     PARM *BLANKS   W9BICD  1                                           CFT032
     C           W9CUST    IFNE 'Y'                                                           CFT032
     C           W9BICD    ANDNE'Y'                                                           CFT032
     C           *LOCK     IN   DLDA                                                          CFT032
     C                     MOVEL'34'      WDBASE                                              CFT032
     C                     MOVEL'*CALL   'WDBKEY                                              CFT032
     C                     MOVEL'ME1400 ' WDBFIL                                              CFT032
     C                     OUT  DLDA                                                          CFT032
     C                     EXSR UEABRT                                                        CFT032
     C                     ELSE                                                               CFT032
     C                     MOVE BBCUST    WCLNUM                                              CFT032
     C                     ENDIF                                                              CFT032
      *                                                                                       CFT032
      ** Customer                                                                             CFT032
      *                                                                                       CFT032
     C           ODMTT     WHEQ 'C'                                                           CFT032
     C                     MOVELODMT      WCLNUM                          E21463
      *                                                                                       CSW207
      ** Non Account Holder Reference                                                         CSW207
      *                                                                                       CSW207
     C           ODMTT     WHEQ 'O'                                                           CSW207
     C           CSW207    ANDEQ'Y'                                                           CSW207
     C                     CALL 'AONAHOR0'                                                    CSW207
     C                     PARM *BLANKS   @RTCD   7                                           CSW207
     C                     PARM '*KEY   ' @OPTN   7                                           CSW207
     C                     PARM ODMT      @NAHO  10                                           CSW207
     C           SDNAHO    PARM SDNAHO    DSSDY                                               CSW207
     C           @RTCD     IFNE *BLANKS                                                       CSW207
     C           *LOCK     IN   DLDA                                                          CSW207
     C                     MOVEL'35'      WDBASE                                              CSW207
     C                     MOVELODMT      WDBKEY                                              CSW207
     C                     MOVEL'SDNAHOPD'WDBFIL                                              CSW207
     C                     OUT  DLDA                                                          CSW207
     C                     EXSR UEABRT                                                        CSW207
     C                     ELSE                                                               CSW207
     C                     MOVEL'N'       W9CUST                                              CSW207
     C                     ENDIF                                                              CSW207
      *                                                                                     BUG15232
      ** Retail account                                                                     BUG15232
      *                                                                                     BUG15232
     C           ODMTT     WHEQ 'R'                                                         BUG15232
     C                     MOVELODMT      @STR   35                                         BUG15232
     C                     CALL 'AOACCTV1'                                                  BUG15232
     C                     PARM *BLANKS   @RTCD                                             BUG15232
     C                     PARM *BLANKS   @OPTN                                             BUG15232
     C                     PARM           @STR                                              BUG15232
     C           WACCN     PARM *BLANKS   DSSDY                                             BUG15232
     C           @RTCD     IFNE *BLANKS                                                     BUG15232
     C           *LOCK     IN   DLDA                                                        BUG15232
     C                     MOVEL'36'      WDBASE                                            BUG15232
     C                     MOVEL@STR      WDBKEY                                            BUG15232
     C                     MOVEL'ACCNTAB' WDBFIL                                            BUG15232
     C                     OUT  DLDA                                                        BUG15232
     C                     EXSR UEABRT                                                      BUG15232
     C                     ENDIF                                                            BUG15232
     C                     MOVELWWCNUM    WCLNUM                                            BUG15232
      *                                                                                     BUG15232
     C                     ENDSL                                                              CFT032
      *                                                                                       CFT032
     C           W9CUST    IFEQ 'Y'                                                           CFT032
     C                     MOVEL'B'       WCLRCT                          E21463
     C                     EXSR UCCLCN                                    E21463
     C*                                                                   E21463
     C           *IN89     IFEQ '1'                        B002           E21463
     C                     MOVEL'CLINT'   WDBFIL                          E21463
     C                     MOVELWCLNUM    WA7              *************  E21463
     C                     MOVE WCLRCT    WA7              * DATA BASE *  E21463
     C                     MOVELWA7       WDBKEY           * ERROR 19  *  E21463
     C                     MOVEL'19'      WDBASE           *************  E21463
     C                     EXSR UEABRT                     *ABORT PGM*    E21463
     C                     END                             E002           E21463
     C                     ENDIF                                                              CFT032
     C*                                                                   E21463
     C                     MOVELWA7       WA7     7                       S01435
     C                     MOVELODMT      P1ODMT                          E21463
     C           W9CUST    IFEQ 'Y'                                                           CFT032
     C                     MOVELCNA1      P1ODMC                          E21463
     C                     ELSE                                                               CFT032
     C                     MOVELBDINS1    P1ODMC                                              CFT032
     C                     ENDIF                                                              CFT032
     C           W9CUST    IFEQ 'N'                                                           CSW207
     C           CSW207    ANDEQ'Y'                                                           CSW207
     C           ODMTT     ANDEQ'O'                                                           CSW207
     C                     MOVELNHCNA1    P1ODMC                                              CSW207
     C                     ENDIF                                                              CSW207
     C                     END                             E001           E21463
     C/COPY WNCPYSRC,FT0510C007
     C*                                                                   E21463
     C***************      MOVELINB1      P1INB1                          E16477
     C***************      MOVELINB2      P1INB2                          E16477
     C***************      MOVELINB3      P1INB3                          E16477
     C***************      MOVELINB4      P1INB4                          E16477
     C***************      MOVELINB5      P1INB5                          E16477
     ******************************************************************
      *                                                                   S01435
      * Format Entered Currency                                           S01435
      *                                                                   S01435
     C                     SELEC                                          S01435
      *                                                                   S01435
     C***********CDRO      WHNE *ZERO                                                  S01435 CSD027
     C           CDRO      WHNE *BLANKS                                                       CSD027
     C           BTCHCY    OREQ 'B'                                       074815
     C           CFT120    ANDNE'Y'                                                           CFT120
     C                     MOVELBCCY      WCCY                            S01435
     C                     Z-ADDSVBCDP    WDEC                            S01435
     C           OPCDRC    IFNE *BLANKS                                                       CFT120
     C           CFT120    ANDEQ'Y'                                                           CFT120
     C                     MOVELOPCDRC    WCCY                                                CFT120
     C                     Z-ADDSVCCDP    WDEC                                                CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
     C           BTCHCY    WHEQ 'B'                                                           CFT120
     C           CFT120    ANDEQ'Y'                                                           CFT120
     C                     MOVELBCCY      WCCY                                                CFT120
     C                     Z-ADDSVBCDP    WDEC                                                CFT120
     C           BTCHCY    WHEQ 'F'                                                           CFT120
     C           CFT120    ANDEQ'Y'                                                           CFT120
     C                     MOVELFCHCCY    WCCY                                                CFT120
     C                     Z-ADDSVFCDP    WDEC                                                CFT120
      *                                                                                       CFT120
     C/COPY WNCPYSRC,FT0510C004
      *                                                                   S01435
     C           BTCHCY    WHEQ 'L'                                       S01435
     C                     MOVELLOCY      WCCY                            S01435
     C                     Z-ADDSVLCDP    WDEC                            S01435
      *                                                                   S01435
     C           BTCHCY    WHEQ 'C'                                       S01435
     C           ADDC      ANDEQ'A'                                       S01435
     C                     MOVELSMCY      WCCY                            S01435
     C                     Z-ADDSVSCDP    WDEC                            S01435
      *                                                                   S01435
     C                     OTHER                                          S01435
     C                     MOVELPCCY      WCCY                            S01435
     C                     Z-ADDSVPCDP    WDEC                            S01435
     C                     ENDSL                                          S01435
      *                                                                   S01435
     C                     MOVELWCCY      P1TREC                          S01435
     C                     MOVELWCCY      P1TXEC                          S01435
     C                     MOVELWCCY      P1CQEC                          S01435
     C                     MOVELWCCY      P1CSEC                          S01435
     C                     MOVELWCCY      P1SPEC                          S01435
     C                     MOVELWCCY      P1MSEC                          S01435
     C*                                                                   S01499
     C** Set up ccy for V.A.T. only if S01499 is active                   S01499
     C*                                                                   S01499
     C           *IN24     IFEQ '1'                                       S01499
     C                     MOVELWCCY      P1VTEC                          S01499
     C                     END                                            S01499
     C*                                                                   S01494
     C** Set up ccy for FX/Change only if S01494 is active                S01494
     C*                                                                   S01494
     C           *IN23     IFEQ '1'                                       S01494
     C                     MOVELWCCY      P1CHEC                          S01494
     C                     END                                            S01494
      *                                                                   S01435
      *  Format Entered Amounts                                           S01435
      *                                                                   S01435
     C           11        SUB  WDEC      WDIG                            S01435
      *                                                                   S01435
      ** Format Transfer Commission Amount                                S01435
      *                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE DUMA1     WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P1TREA                          S01435
      *                                                                   S01435
      ** Format Telex Charge Amount                                       S01435
      *                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE DUMA2     WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P1TXEA                          S01435
      *                                                                   S01435
      ** Format Cheque Charge Amount                                      S01435
      *                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE DUMA3     WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P1CQEA                          S01435
     C*                                                                   S01435
     C** Format Telephone Charge Amount                                   S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE DUMA4     WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P1CSEA                          S01435
     C*                                                                   S01435
     C** Format Advice Charge Amount                                      S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE DUMA5     WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P1SPEA                          S01435
     C*                                                                   S01435
     C** Format Miscellaneous Charge Amount                               S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE DUMA6     WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P1MSEA                          S01435
     C*                                                                   S01499
     C** Format the V.A.T. Commission amount if S01499 is active          S01499
     C*                                                                   S01499
     C           *IN24     IFEQ '1'                                       S01499
     C                     MOVE *BLANKS   WFDIN                           S01499
     C                     MOVE OPDUM8    WFDIN                           S01499
     C                     EXSR UGFRMT                                    S01499
     C                     MOVE WFDOUT    P1VAEA                          S01499
     C                     END                                            S01499
     C*                                                                   S01494
     C** Format the FX/Change Commission amount if S01494 is active       S01494
     C*                                                                   S01494
     C           *IN23     IFEQ '1'                                       S01494
     C                     MOVE *BLANKS   WFDIN                           S01494
     C                     MOVE OPDUM7    WFDIN                           S01494
     C                     EXSR UGFRMT                                    S01494
     C                     MOVE WFDOUT    P1CHEA                          S01494
     C                     END                                            S01494
      *                                                                   S01435
      * Edit charges to the debit of field                                S01435
      *                                                                   S01435
     C                     MOVE CDRT      PRMTYP  1        ( CDRO )
     C**********           MOVE *ZEROS    PRMFLD 12                                           CGL029
     C***********          MOVE *ZEROS    PRMFLD 18                                    CGL029 CSD027
     C                     MOVE *BLANKS   PRMFLD 18                                           CSD027
     C                     MOVELCDRO      PRMFLD
     C           MBIN      IFEQ 'Y'                                       S01117
     C           CDRT      IFEQ 'P'                                       S01117
     C                     MOVELCDBR      P1CDBR                          S01117
     C                     ELSE                                           S01117
     C                     MOVE *BLANKS   P1CDBR                          S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C                     EXSR CHOPF
     C                     MOVELPRMFLD    P1CDRO
      *                                                                                       CFT120
     C           CFT120    IFEQ 'Y'                                                           CFT120
     C           OPCDRC    IFNE *BLANKS                                                       CFT120
     C                     MOVELOPCDRC    P1CDRC                                              CFT120
     C                     ELSE                                                               CFT120
     C                     MOVE *BLANKS   P1CDRC                                              CFT120
     C                     ENDIF                                                              CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
     C/COPY WNCPYSRC,FT0510C005
      *                                                                   CFT009
      ** Set up fields for remaining report - second page - if CFT009 is  CFT009
      ** on                                                               CFT009
      *                                                                   CFT009
      ** SETUP CURRENCY NAMES                                             CFT009
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
      *                                                                   CFT009
     C           PREF      CHAINOTPAYXL0             89                   CFT009
     C           *IN89     IFEQ '0'                                       CFT009
     C           RECI      COMP 'D'                  8989  ON , DELETED   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** DB ERROR IF NO RECORD FOUND.                                     CFT009
      *                                                                   CFT009
     C           *IN89     IFEQ '1'                                       CFT009
     C                     MOVEL'OTPAYX'  WDBFIL           ***************CFT009
     C                     MOVELPREF      WDBKEY           * DB ERROR 10 *CFT009
     C                     MOVEL'10'      WDBASE           ***************CFT009
     C                     EXSR UEABRT                                    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     SELEC                                          CFT009
     C***********CDRO      WHNE *ZEROS                                                 CFT009 CSD027
     C           CDRO      WHNE *BLANKS                                                       CSD027
      *                                                                                       CFT120
     C                     MOVELBCCY      WCCY                            CFT009
     C           OPCDRC    IFNE *BLANKS                                                       CFT120
     C           CFT120    ANDEQ'Y'                                                           CFT120
     C                     MOVELOPCDRC    WCCY                                                CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
     C           ADDC      WHEQ 'A'                                       CFT009
     C                     MOVELSMCY      WCCY                            CFT009
     C                     OTHER                                          CFT009
     C                     MOVELPCCY      WCCY                            CFT009
     C                     ENDSL                                          CFT009
      *                                                                   CFT009
      ** Retrieve currency details (CHARGE)                               CFT009
      *                                                                   CFT009
     C           OPCHGC    IFNE *BLANKS                                                       247652
     C                     MOVE OPCHGC    @CURR                                               247652
     C                     ELSE                                                               247652
     C                     SELEC                                                              247652
     C           CDRO      WHNE *BLANKS                                                       247652
      *                                                                                       CFT120
     C                     MOVE BCCY      @CURR                                               247652
     C           OPCDRC    IFNE *BLANKS                                                       CFT120
     C           CFT120    ANDEQ'Y'                                                           CFT120
     C                     MOVE OPCDRC    @CURR                                               CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
     C           BTCHCY    WHEQ 'B'                                                           247652
     C                     MOVE BCCY      @CURR                                               247652
     C           BTCHCY    WHEQ 'L'                                                           247652
     C                     MOVELLOCY      @CURR                                               247652
     C           BTCHCY    WHEQ 'F'                                                           247652
     C                     MOVELFCHCCY    @CURR                                               247652
     C           BTCHCY    WHEQ 'C'                                                           247652
     C           ADDC      ANDEQ'A'                                                           247652
     C                     MOVELSMCY      @CURR                                               247652
     C                     OTHER                                                              247652
     C                     MOVELPCCY      @CURR                                               247652
     C                     ENDSL                                                              247652
     C                     ENDIF                                                              247652
      *                                                                   CFT009
     C********** OPCHGC    IFNE *BLANKS                                           BUG12944 BUG12944A
     C                     CALL 'AOCURRR0'                                CFT009
     C                     PARM *BLANKS   @RTCD                           CFT009
     C                     PARM '*KEY   ' @OPTN                           CFT009
     C******************   PARM OPCHGC    @CURR   3                       CFT009              247652
     C                     PARM           @CURR   3                                           247652
     C           SDCURR    PARM SDCURR    DSSDY                           CFT009
      *                                                                   CFT009
     C           @RTCD     IFNE *BLANKS                                   CFT009
     C                     MOVEL'SDCURRPD'WDBFIL           ***************CFT009
     C***********          MOVELWCCY      WDBKEY      *******DB ERROR 09 *CFT009              247652
     C                     MOVEL@CURR     WDBKEY           * DB ERROR 09 *CFT009              247652
     C                     MOVEL'09'      WDBASE           ***************CFT009
     C                     EXSR UEABRT                                    CFT009
     C                     ENDIF                                          CFT009
     C**********           ENDIF                                                  BUG12944 BUG12944A
      *                                                                   CFT009
     C                     Z-ADDA6NBDP    CCDCP   10                      CFT009
      *                                                                   CFT009
      ** Retrieve currency details (LEVIED)                               CFT009
      *                                                                   CFT009
     C                     CALL 'AOCURRR0'                                CFT009
     C                     PARM *BLANKS   @RTCD                           CFT009
     C                     PARM '*KEY   ' @OPTN                           CFT009
     C                     PARM WCCY      @CURR   3                       CFT009
     C           SDCURR    PARM SDCURR    DSSDY                           CFT009
      *                                                                   CFT009
     C           @RTCD     IFNE *BLANKS                                   CFT009
     C                     MOVEL'SDCURRPD'WDBFIL           ***************CFT009
     C                     MOVELWCCY      WDBKEY           * DB ERROR 11 *CFT009
     C                     MOVEL'11'      WDBASE           ***************CFT009
     C                     EXSR UEABRT                                    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     Z-ADDA6NBDP    WNDP    10                      CFT009
     C                     Z-ADDWNDP      ZADEC                           CFT009
     C                     Z-ADDWNDP      LCDCP   10                      CFT009
      *                                                                   CFT009
      ** Levied Currency                                                  CFT009
      *                                                                   CFT009
     C                     MOVELWCCY      P2TXCY                          CFT009
     C                     MOVELWCCY      P2CQCY                          CFT009
     C                     MOVELWCCY      P2CSCY                          CFT009
     C                     MOVELWCCY      P2STCY                          CFT009
     C                     MOVELWCCY      P2SWCY                          CFT009
     C                     MOVELWCCY      P2MSCY                          CFT009
     C                     MOVELWCCY      P2M1CY                          CFT009
     C                     MOVELWCCY      P2M2CY                          CFT009
     C                     MOVELWCCY      P2M3CY                          CFT009
     C                     MOVELWCCY      P2M4CY                          CFT009
     C                     MOVELWCCY      P2M5CY                          CFT009
     C                     MOVELWCCY      P2TRCY                          CFT009
     C                     MOVELWCCY      P2FXCY                          CFT009
      *                                                                   CFT009
      ** Move charge currency in.                                         CFT009
      *                                                                   CFT009
     C           CFT120    IFEQ 'Y'                                                           CFT120
     C           OPCHGC    IFEQ *BLANKS                                                       CFT120
     C                     MOVE @CURR     OPCHGC                                              CFT120
     C                     ENDIF                                                              CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
     C                     MOVELOPCHGC    P2TXCC                          CFT009
     C                     MOVELOPCHGC    P2CQCC                          CFT009
     C                     MOVELOPCHGC    P2CSCC                          CFT009
     C                     MOVELOPCHGC    P2STCC                          CFT009
     C                     MOVELOPCHGC    P2SWCC                          CFT009
     C                     MOVELOPCHGC    P2MSCC                          CFT009
     C                     MOVELOPCHGC    P2M1CC                          CFT009
     C                     MOVELOPCHGC    P2M2CC                          CFT009
     C                     MOVELOPCHGC    P2M3CC                          CFT009
     C                     MOVELOPCHGC    P2M4CC                          CFT009
     C                     MOVELOPCHGC    P2M5CC                          CFT009
     C                     MOVELOPCHGC    P2TRCC                          CFT009
     C                     MOVELOPCHGC    P2FXCC                          CFT009
      *                                                                   CFT009
      ** Move spread set code in                                          CFT009
      *                                                                   CFT009
     C                     MOVE FXSRSC    P2FXSR                          CFT009
      *                                                                   CFT009
      ** Move Payment Date Offset in                                      CFT009
      *                                                                   CFT009
     C                     MOVE OTPDOF    P2PDOF                          CFT009
      *                                                                   CFT009
      ** FORMAT TELEX CHARGE AMOUNT : Levied                              CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE TXCH      ZFIELD                          CFT009
     C                     Z-ADDLCDCP     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2TXCH                          CFT009
      *                                                                   CFT009
      ** TELEX CHARGE AMOUNT CHARGE CURRENCY                              CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE DUMA2     ZFIELD                          CFT009
     C                     Z-ADDCCDCP     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2TXCA                          CFT009
      *                                                                   CFT009
      ** FORMAT CHEQUE CHARGE AMOUNT : Levied                             CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE CQCH      ZFIELD                          CFT009
     C                     Z-ADDLCDCP     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2CQCH                          CFT009
      *                                                                   CFT009
      ** CHEQUE CHARGE AMOUNT CHARGE CURRENCY                             CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE DUMA3     ZFIELD                          CFT009
     C                     Z-ADDCCDCP     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2CQCA                          CFT009
      *                                                                   CFT009
      ** FORMAT COSTS ABROAD AMOUNT : Levied                              CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE CSTA      ZFIELD                          CFT009
     C                     Z-ADDLCDCP     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2CSTA                          CFT009
      *                                                                   CFT009
      ** COSTS ABROAD AMOUNT CHARGE CURRENCY                              CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE DUMA4     ZFIELD                          CFT009
     C                     Z-ADDCCDCP     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2CSCA                          CFT009
      *                                                                   CFT009
      ** FORMAT SWIFT STANDARD CHARGE AMOUNT : Levied                     CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE SWSCHG    ZFIELD                          CFT009
     C                     Z-ADDLCDCP     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2STSC                          CFT009
      *                                                                   CFT009
      ** SWIFT STANDARD CHARGE CHARGE CURRENCY                            CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE SWSCCC    ZFIELD                          CFT009
     C                     Z-ADDCCDCP     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2STCA                          CFT009
      *                                                                   CFT009
      ** FORMAT SWIFT PRIORITY CHARGE AMOUNT : Levied                     CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE SPCH      ZFIELD                          CFT009
     C                     Z-ADDLCDCP     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2SWSC                          CFT009
      *                                                                   CFT009
      ** SWIFT STANDARD CHARGE CHARGE CURRENCY                            CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE DUMA5     ZFIELD                          CFT009
     C                     Z-ADDCCDCP     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2SWCA                          CFT009
      *                                                                   CFT009
      ** FORMAT MISCELLANEOUS CHARGE AMOUNT : Levied                      CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE MSCH      ZFIELD                          CFT009
     C                     Z-ADDLCDCP     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2MSCH                          CFT009
      *                                                                   CFT009
      ** MISCELLANEOUS CHARGE CHARGE CURRENCY                             CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE DUMA6     ZFIELD                          CFT009
     C                     Z-ADDCCDCP     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2MSCA                          CFT009
      *                                                                   CFT009
      ** FORMAT MISCELLANEOUS CHARGE AMOUNT 1 : Levied                    CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE MISC01    ZFIELD                          CFT009
     C                     Z-ADDLCDCP     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2M1CH                          CFT009
      *                                                                   CFT009
      ** Format Misc Charge Description 1                                 CFT009
      *                                                                   CFT009
     C           MSCHC1    IFEQ *BLANKS                                   CFT009
     C                     MOVEADESC,1    P2M1DS                          CFT009
     C                     ELSE                                           CFT009
     C           MSCHC1    CHAINFTPCHGL0             97                   CFT009
     C                     MOVELCHDESC    P2M1DS                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** MISCELLANEOUS CHARGE1 CHARGE CURRENCY                            CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE MISCC1    ZFIELD                          CFT009
     C                     Z-ADDCCDCP     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2M1CA                          CFT009
      *                                                                   CFT009
      ** FORMAT MISCELLANEOUS CHARGE AMOUNT 2 : Levied                    CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE MISC02    ZFIELD                          CFT009
     C                     Z-ADDLCDCP     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2M2CH                          CFT009
      *                                                                   CFT009
      ** Format Misc Charge Description 2                                 CFT009
      *                                                                   CFT009
     C           MSCHC2    IFEQ *BLANKS                                   CFT009
     C                     MOVEADESC,2    P2M2DS                          CFT009
     C                     ELSE                                           CFT009
     C           MSCHC2    CHAINFTPCHGL0             97                   CFT009
     C                     MOVELCHDESC    P2M2DS                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** MISCELLANEOUS CHARGE2 CHARGE CURRENCY                            CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE MISCC2    ZFIELD                          CFT009
     C                     Z-ADDCCDCP     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2M2CA                          CFT009
      *                                                                   CFT009
      ** FORMAT MISCELLANEOUS CHARGE AMOUNT 3 : Levied                    CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE MISC03    ZFIELD                          CFT009
     C                     Z-ADDLCDCP     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2M3CH                          CFT009
      *                                                                   CFT009
      ** Format Misc Charge Description 3                                 CFT009
      *                                                                   CFT009
     C           MSCHC3    IFEQ *BLANKS                                   CFT009
     C                     MOVEADESC,3    P2M3DS                          CFT009
     C                     ELSE                                           CFT009
     C           MSCHC3    CHAINFTPCHGL0             97                   CFT009
     C                     MOVELCHDESC    P2M3DS                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** MISCELLANEOUS CHARGE3 CHARGE CURRENCY                            CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE MISCC3    ZFIELD                          CFT009
     C                     Z-ADDCCDCP     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2M3CA                          CFT009
      *                                                                   CFT009
      ** FORMAT MISCELLANEOUS CHARGE AMOUNT 4 : Levied                    CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE MISC04    ZFIELD                          CFT009
     C                     Z-ADDLCDCP     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2M4CH                          CFT009
      *                                                                   CFT009
      ** Format Misc Charge Description 4                                 CFT009
      *                                                                   CFT009
     C           MSCHC4    IFEQ *BLANKS                                   CFT009
     C                     MOVEADESC,4    P2M4DS                          CFT009
     C                     ELSE                                           CFT009
     C           MSCHC4    CHAINFTPCHGL0             97                   CFT009
     C                     MOVELCHDESC    P2M4DS                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** MISCELLANEOUS CHARGE4 CHARGE CURRENCY                            CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE MISCC4    ZFIELD                          CFT009
     C                     Z-ADDCCDCP     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2M4CA                          CFT009
      *                                                                   CFT009
      ** FORMAT MISCELLANEOUS CHARGE AMOUNT 5 : Levied                    CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE MISC05    ZFIELD                          CFT009
     C                     Z-ADDLCDCP     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2M5CH                          CFT009
      *                                                                   CFT009
      ** Format Misc Charge Description 5                                 CFT009
      *                                                                   CFT009
     C           MSCHC5    IFEQ *BLANKS                                   CFT009
     C                     MOVEADESC,5    P2M5DS                          CFT009
     C                     ELSE                                           CFT009
     C           MSCHC5    CHAINFTPCHGL0             97                   CFT009
     C                     MOVELCHDESC    P2M5DS                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** MISCELLANEOUS CHARGE5 CHARGE CURRENCY                            CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE MISCC5    ZFIELD                          CFT009
     C                     Z-ADDCCDCP     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2M5CA                          CFT009
      *                                                                   CFT009
      **  FORMAT TRANSFER COMMISSION AMOUNT : Levied                      CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE TRCM      ZFIELD                          CFT009
     C                     Z-ADDLCDCP     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2TRCH                          CFT009
      *                                                                   CFT009
      ** TRANSFER COMMISSION CHARGE CURRENCY                              CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE DUMA1     ZFIELD                          CFT009
     C                     Z-ADDCCDCP     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2TRCA                          CFT009
      *                                                                   CFT009
      ** Format the FX/Change Commission amount : Levied                  CFT009
      *                                                                   CFT009
     C           *IN23     IFEQ *ON                                       CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE OPCHCM    ZFIELD                          CFT009
     C                     Z-ADDLCDCP     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2FXCH                          CFT009
      *                                                                   CFT009
      ** FX/CHANGE COMMISSION CHARGE CURRENCY                             CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE OPDUM7    ZFIELD                          CFT009
     C                     Z-ADDCCDCP     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2FXCA                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** MOVE CHARGE CODES IN                                             CFT009
      *                                                                   CFT009
     C                     MOVE TLXCDE    P2TXCD                          CFT009
     C                     MOVE CHQCHC    P2CQCD                          CFT009
     C                     MOVE CACHCD    P2CSCD                          CFT009
     C                     MOVE SSTCCD    P2STCD                          CFT009
     C                     MOVE SPRCCD    P2SWCD                          CFT009
     C                     MOVE MSCHC     P2MSCD                          CFT009
     C                     MOVE MSCHC1    P2M1CD                          CFT009
     C                     MOVE MSCHC2    P2M2CD                          CFT009
     C                     MOVE MSCHC3    P2M3CD                          CFT009
     C                     MOVE MSCHC4    P2M4CD                          CFT009
     C                     MOVE MSCHC5    P2M5CD                          CFT009
     C                     MOVE TFCCCD    P2TRCD                          CFT009
     C                     MOVE FXCACC    P2FXCD                          CFT009
      *                                                                   CFT009
      ** Set up the V.A.T. flags of all charges if CFT010 is active       CFT009
      *                                                                   CFT009
     C           CFT010    IFEQ 'Y'                                       CFT009
     C                     MOVE OPVAT2    P2INV2                          CFT009
     C                     MOVE OPVAT3    P2INV3                          CFT009
     C                     MOVE OPVAT4    P2INV4                          CFT009
     C                     MOVE VTSWSC    P2STVI                          CFT009
     C                     MOVE OPVAT5    P2SWVI                          CFT009
     C                     MOVE OPVAT6    P2INV6                          CFT009
     C                     MOVE VMIC1     P2IVM1                          CFT009
     C                     MOVE VMIC2     P2IVM2                          CFT009
     C                     MOVE VMIC3     P2IVM3                          CFT009
     C                     MOVE VMIC4     P2IVM4                          CFT009
     C                     MOVE VMIC5     P2IVM5                          CFT009
     C                     MOVE OPVAT1    P2INV1                          CFT009
     C                     MOVE OPVAT7    P2INV7                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** CALCULATE GRAND TOTALS CHARGES AND FORMAT                        CFT009
      *                                                                   CFT009
     C           TXCH      ADD  CQCH      WTLAM  140                      CFT009
     C                     ADD  CSTA      WTLAM                           CFT009
     C                     ADD  SWSCHG    WTLAM                           CFT009
     C                     ADD  SPCH      WTLAM                           CFT009
     C                     ADD  MSCH      WTLAM                           CFT009
     C                     ADD  MISC01    WTLAM                           CFT009
     C                     ADD  MISC02    WTLAM                           CFT009
     C                     ADD  MISC03    WTLAM                           CFT009
     C                     ADD  MISC04    WTLAM                           CFT009
     C                     ADD  MISC05    WTLAM                           CFT009
     C                     ADD  TRCM      WTLAM                           CFT009
     C           *IN23     IFEQ *ON                                       CFT009
     C                     ADD  OPCHCM    WTLAM                           CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** FORMAT GRAND TOTAL AMOUNT : Levied                               CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE WTLAM     ZFIELD                          CFT009
     C                     Z-ADDLCDCP     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2TLAM                          CFT009
      *                                                                   CFT009
      ** FORMAT GRAND TOTAL VAT                                           CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE OPVATT    ZFIELD                          CFT009
     C                     Z-ADDLCDCP     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2TLVT                          CFT009
      *                                                                   CFT009
      ** FORMAT GRAND TOTAL VAT : CHARGES CURRENCY                        CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE OPDUM8    ZFIELD                          CFT009
     C                     Z-ADDCCDCP     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2TLVC                          CFT009
      *                                                                   CFT009
      *                                                                   CFT009
      ** FORMAT GRAND TOTAL CHARGE                                        CFT009
      *                                                                   CFT009
     C           DUMA2     ADD  DUMA3     WTLCG  140                      CFT009
     C                     ADD  DUMA4     WTLCG                           CFT009
     C                     ADD  SWSCCC    WTLCG                           CFT009
     C                     ADD  DUMA5     WTLCG                           CFT009
     C                     ADD  DUMA6     WTLCG                           CFT009
     C                     ADD  MISCC1    WTLCG                           CFT009
     C                     ADD  MISCC2    WTLCG                           CFT009
     C                     ADD  MISCC3    WTLCG                           CFT009
     C                     ADD  MISCC4    WTLCG                           CFT009
     C                     ADD  MISCC5    WTLCG                           CFT009
     C                     ADD  DUMA1     WTLCG                           CFT009
     C           *IN23     IFEQ *ON                                       CFT009
     C                     ADD  OPDUM7    WTLCG                           CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE WTLCG     ZFIELD                          CFT009
     C                     Z-ADDCCDCP     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2TLCG                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** RESET DECIMAL PLACES TO THAT OF LEVIED CURRENCY                  CFT009
      *                                                                   CFT009
     C                     Z-ADDWNDP      ZADEC                           CFT009
     C/COPY WNCPYSRC,HUT110_019                                                               HUT110
      *                                                                                       CSW209
      **  Cover Message Information for Incoming Payments                                     CSW209
      *                                                                                       CSW209
     C           CSW209    IFEQ 'Y'                                                           CSW209
      *                                                                                       CSW209
     C                     MOVELOPNWRK    P3NWRK                                              CSW209
     C                     MOVELOPMTPY    P3MTPY                                              CSW209
     C                     MOVELOPVALF    P3VALF                                              CSW209
     C                     MOVELOPOMVF    P3OMVF                                              CSW209
     C                     MOVELOPOCVF    P3OCVF                                              CSW209
     C                     MOVELOPOCB1    P3OCB1                                              CSW209
     C                     MOVELOPOCB2    P3OCB2                                              CSW209
     C                     MOVELOPOCB3    P3OCB3                                              CSW209
     C                     MOVELOPOCB4    P3OCB4                                              CSW209
     C                     MOVELOPOCB5    P3OCB5                                              CSW209
     C                     MOVELOPOCB6    P3OCB6                                              CSW209
      *                                                                                       CSW209
     C                     MOVELOPCOC1    P4COC1                                              CSW209
     C                     MOVELOPCOC2    P4COC2                                              CSW209
     C                     MOVELOPCOC3    P4COC3                                              CSW209
     C                     MOVELOPCOC4    P4COC4                                              CSW209
     C                     MOVELOPCOC5    P4COC5                                              CSW209
     C                     MOVELOPCOB1    P4COB1                                              CSW209
     C                     MOVELOPCOB2    P4COB2                                              CSW209
     C                     MOVELOPCOB3    P4COB3                                              CSW209
     C                     MOVELOPCOB4    P4COB4                                              CSW209
     C                     MOVELOPCOB5    P4COB5                                              CSW209
     C                     MOVELOPCIB1    P4CIB1                                              CSW209
     C                     MOVELOPCIB2    P4CIB2                                              CSW209
     C                     MOVELOPCIB3    P4CIB3                                              CSW209
     C                     MOVELOPCIB4    P4CIB4                                              CSW209
     C                     MOVELOPCIB5    P4CIB5                                              CSW209
     C                     MOVELOPCAB1    P4CAB1                                              CSW209
     C                     MOVELOPCAB2    P4CAB2                                              CSW209
     C                     MOVELOPCAB3    P4CAB3                                              CSW209
     C                     MOVELOPCAB4    P4CAB4                                              CSW209
     C                     MOVELOPCAB5    P4CAB5                                              CSW209
     C                     MOVELOPCBC1    P4CBC1                                              CSW209
     C                     MOVELOPCBC2    P4CBC2                                              CSW209
     C                     MOVELOPCBC3    P4CBC3                                              CSW209
     C                     MOVELOPCBC4    P4CBC4                                              CSW209
     C                     MOVELOPCBC5    P4CBC5                                              CSW209
     C                     MOVELOPCICY    P4CICY                                              CSW209
     C                     MOVEL*BLANKS   P4CIAM                                              CSW209
      *                                                                                       CSW209
      ** Access AOCURR0 to get the currency's decimal places                                  CSW209
      *                                                                                       CSW209
     C           OPCICY    IFNE *BLANKS                                                       CSW209
      *                                                                                       CSW209
     C                     CALL 'AOCURRR0'                                                    CSW209
     C                     PARM *BLANKS   @RTCD                                               CSW209
     C                     PARM '*KEY   ' @OPTN                                               CSW209
     C                     PARM           OPCICY                                              CSW209
     C           SDCURR    PARM SDCURR    DSSDY                                               CSW209
     C           @RTCD     IFNE *BLANKS                                                       CSW209
     C                     MOVEL'55'      WDBASE                                              CSW209
     C                     MOVELOPCICY    WDBKEY                                              CSW209
     C                     MOVEL'SDCURRPD'WDBFIL                                              CSW209
     C                     EXSR UEABRT                                                        CSW209
     C                     ENDIF                                                              CSW209
     C                     Z-ADDA6NBDP    W4CIAM  10                                          CSW209
      *                                                                                       CSW209
      ** Format Instructed Amount                                                             CSW209
      *                                                                                       CSW209
     C                     MOVEL*BLANKS   WFDIN                                               CSW209
     C                     MOVE OPCIAM    WFDIN                                               CSW209
     C                     Z-ADDW4CIAM    WDEC                                                CSW209
     C           13        SUB  W4CIAM    WDIG                                                CSW209
     C                     EXSR UGFRMT                                                        CSW209
     C                     MOVE WFDOUT    P4CIAM                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     MOVELOPCBB1    P4CBB1                                              CSW209
     C                     MOVELOPCBB2    P4CBB2                                              CSW209
     C                     MOVELOPCBB3    P4CBB3                                              CSW209
     C                     MOVELOPCBB4    P4CBB4                                              CSW209
     C                     MOVELOPCBB5    P4CBB5                                              CSW209
     C                     MOVELOPCBB6    P4CBB6                                              CSW209
     C                     MOVELOPCDP1    P4CDP1                                              CSW209
     C                     MOVELOPCDP2    P4CDP2                                              CSW209
     C                     MOVELOPCDP3    P4CDP3                                              CSW209
     C                     MOVELOPCDP4    P4CDP4                                              CSW209
     C                     ENDIF                                                              CSW209
     C*                                                                   S01117
     C* IF @PENT NE 'ALL'                                                 S01117
     C* CALL ROUTINE FOR ZSFILE ONCE ONLY IF BRANCH NE 'ALL'              S01117
     C*                                                                   S01117
     C           @PENT     IFNE 'ALL'                                     S01117
     C           *IN21     ANDEQ'0'                                       S01117
     C                     EXSR ZSFLP1                                    S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C* IF CHANGE OF BRANCH DETECTED                                      S01117
     C*                                                                   S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C*                                                                   S01117
     C           *IN14     IFEQ '0'                                       S01117
     C           BRCA      ANDNESBRA                                      S01117
     C           *IN14     OREQ '1'                                       S01117
     C           ORBR      ANDNESBRA                                      S01117
     C*                                                                   S01117
     C* @PENT IFEQ 'ALL' AND CHANGE OF BRANCH,                            S01117
     C* WRITE END OF REPORT FOR BRANCH, CLOSE AND OPEN PRINTER FILE       S01117
     C*                                                                   S01117
     C           @PENT     IFEQ 'ALL'                                     S01117
     C*                                                                   S01117
     C           *IN21     IFEQ '1'                                       S01117
     C                     WRITEP1EOR                                     S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     EXSR ZSFLP1                                    S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C* IF BRANCH CHANGED AND NOT COB, MOVE BRCA/ORBR INTO WORKFIELD      S01117
     C* which is used to determine when the branch has changed            055293
     C*                                                                   S01117
     C           *IN14     IFEQ '0'                                       S01117
     C                     MOVE BRCA      SBRA                            S01117
     C                     ELSE                                           S01117
     C                     MOVE ORBR      SBRA                            S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C*********************EXSR TABTR                              S01117 055293
     C                     END                                            S01117
     C*                                                                   S01117
     C**SET*UP*OTHER*BRANCH*FIELD*ON*DETAIL*REPORT.************    S01117 055293
     C********************                                         S01117 055293
     C********** *IN14**** IFEQ '0'                                S01117 055293
     C********** *IN15**** ANDEQ'1'                                S01117 055293
     C******************** MOVE ORBR      SBRO    3                S01117 055293
     C******************** EXSR TABTR2                             S01117 055293
     C******************** ELSE                                    S01117 055293
     C******************** MOVE BRCA      SBRO                     S01117 055293
     C******************** EXSR TABTR2                             S01117 055293
     C******************** END                                     S01117 055293
     C*                                                                   055293
     C* Set up Booking Branch fields for report                           055293
     C*                                                                   055293
     C                     MOVELBRCA      SBRO    3                       055293
     C                     EXSR TABTR2                                    055293
     C                     MOVELBRCA      PBBR                            055293
     C                     MOVELPBRNO     PBBRN                           055293
     C*                                                                   055293
     C* Set up Originating Branch fields for report ONLY if used          055293
     C*                                                                   055293
     C           *IN15     IFEQ '1'                                       055293
     C                     MOVELORBR      SBRO    3                       055293
     C                     EXSR TABTR2                                    055293
     C                     MOVELORBR      POBR                            055293
     C                     MOVELPBRNO     POBRN                           055293
     C                     END                                            055293
     C*                                                                   055293
     C                     END                                            S01117
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0510CCP2                                           S01408
     C*                                                                   S01408
      *                                                                                       CER001
      ** Call PGM IL0457 to access Extension FTOPX1PD                                         CER001
      *                                                                                       CER001
     C                     MOVE 'N'       DOLX43  1        FLAG                               CER001
     C           BGNWST    IFEQ 'Y'                        Lux Returns                        CER001
     C           ULX043    ANDEQ'Y'                        IBLC 2002                          CER001
      *                                                                                       CER001
     C                     CALL 'IL0457'                                                      CER001
     C                     PARM PREF      PPREF  15                                           CER001
     C                     PARM *BLANKS   ILLINE                                              CER001
      *                                                                                       CER001
      ** Set up IBLC lines array                                                              CER001
      *                                                                                       CER001
     C                     MOVEAILLINE    IUL                                                 CER001
      *                                                                                       CER001
     C           ILLINE    IFNE *BLANKS                                                       CER001
     C                     MOVE 'Y'       DOLX43           Print                              CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
     C                     ENDIF                           Lux/IBLC 2002                      CER001
      *                                                                                       CER001
     C*                                                                   S01117
     C** OUTPUT PAGE TO REPORT
     C*
     C                     WRITEP1HD
     C*                                                                   055293
     C* Print branch fields only if multibranching                        055293
     C*                                                                   055293
     C           MBIN      IFEQ 'Y'                                       055293
     C*                                                                   055293
     C           *IN14     IFEQ '0'                                       055293
     C                     WRITEP1BBR                      Booking        055293
     C                     ELSE                                           055293
     C                     WRITEP1OBR                      Originating    055293
     C                     END                                            055293
     C*                                                                   055293
     C                     END                                            055293
     C*                                                                   055293
     C** Core hook for externalisation.                                   S01408
     C/COPY WNCPYSRC,FT0510CPLH                                           S01408
     C*                                                                   S01408
     C*
     C                     WRITEP2HD                                      055293
     C*                                                                   055293
     C                     WRITEP1DETL
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
     C                     WRITEP1HD                                      CFT009
      *                                                                   CFT009
      ** Print branch fields only if multibranching                       CFT009
      *                                                                   CFT009
     C           MBIN      IFEQ 'Y'                                       CFT009
      *                                                                   CFT009
     C           *IN14     IFEQ '0'                                       CFT009
     C                     WRITEP1BBR                      Booking        CFT009
     C                     ELSE                                           CFT009
     C                     WRITEP1OBR                      Originating    CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     WRITEP2DETL                                    CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                                       CER030
      ** Transaction type                                                                     CER030
      *                                                                                       CER030
     C           CER030    IFEQ 'Y'                                                           CER030
     C           CGL013    OREQ 'Y'                                                           CER030
     C                     MOVE OPRTTY    P2RTTY                                              CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      ** Extended Narrative for Debit                                                         CER030
      *                                                                                       CER030
     C           CER031    IFEQ 'Y'                                                           CER030
     C                     MOVE OPEXT1    P2EXT1                                              CER030
     C                     MOVE OPEXT2    P2EXT2                                              CER030
     C                     MOVE OPEXT3    P2EXT3                                              CER030
     C                     MOVE OPEXT4    P2EXT4                                              CER030
     C                     MOVE OPEXT5    P2EXT5                                              CER030
     C                     MOVE OPEXT6    P2EXT6                                              CER030
      *                                                                                       CER030
      ** Extended Narrative for Credit                                                        CER030
      *                                                                                       CER030
     C           CFT003    IFEQ 'Y'                                                           CER030
     C                     MOVE OPEXC1    P2EXC1                                              CER030
     C                     MOVE OPEXC2    P2EXC2                                              CER030
     C                     MOVE OPEXC3    P2EXC3                                              CER030
     C                     MOVE OPEXC4    P2EXC4                                              CER030
     C                     MOVE OPEXC5    P2EXC5                                              CER030
     C                     MOVE OPEXC6    P2EXC6                                              CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           CGL013    IFEQ 'Y'                                                           CER030
     C           CER030    OREQ 'Y'                                                           CER030
     C           CER031    OREQ 'Y'                                                           CER030
     C                     WRITEP1HD                                                          CER030
     C                     WRITEP2EXTNAR                                                      CER030
     C                     ENDIF                                                              CER030
      *                                                                   CFT009
     C           CSW209    IFEQ 'Y'                                                           CSW209
     C/COPY WNCPYSRC,HUT110_020                                                               HUT110
      *                                                                                     MD034618
      ** Check if space available on FT0510P1                                               MD034618
      ** If not enough lines then force a new page                                          MD034618
     C                     Z-ADD11        @DETL   30                                        MD034618
     C           OFLOW1    SUB  CURLN1    REM     20                                        MD034618
     C           REM       IFLT @DETL                                                       MD034618
     C                     WRITEP1HD                                                        MD034618
      *                                                                                     MD034618
      ** Print branch fields only if multibranching                                         MD034618
      *                                                                                     MD034618
     C           MBIN      IFEQ 'Y'                                                         MD034618
      *                                                                                     MD034618
     C           *IN14     IFEQ '0'                                                         MD034618
     C                     WRITEP1BBR                      BOOKING                          MD034618
     C                     ELSE                                                             MD034618
     C                     WRITEP1OBR                      ORIGINATING                      MD034618
     C                     ENDIF                                                            MD034618
     C                     ENDIF                                                            MD034618
     C                     ENDIF                                                            MD034618
     C                     WRITEP3DETL                                                        CSW209
      *                                                                                       CSW209
      ** Print cover-related fields                                                           CSW209
      *                                                                                       CSW209
     C           OPOMVF    IFEQ 'COV'                                                         CSW209
     C           OPOCVF    OREQ 'COV'                                                       BUG25102
     C           WPCOC1    IFNE *BLANKS                                                       CSW209
     C           WPCOB1    ORNE *BLANKS                                                       CSW209
     C           WPCIB1    ORNE *BLANKS                                                       CSW209
     C           WPCAB1    ORNE *BLANKS                                                       CSW209
     C           WPCBC1    ORNE *BLANKS                                                       CSW209
     C           WPCDP1    ORNE *BLANKS                                                       CSW209
     C           WPCBB1    ORNE *BLANKS                                                       CSW209
     C           WPCICY    ORNE *BLANKS                                                       CSW209
     C           WPCIAM    ORNE *ZEROS                                                        CSW209
     C                     WRITEP1HD                                                          CSW209
     C                     WRITEP4DETL                                                        CSW209
     C                     ENDIF                                                              CSW209
     C                     ENDIF                                                              CSW209
     C                     ENDIF                                                              CSW209
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0510CCP3                                           S01408
      *                                                                                       CER001
      ** If something to Print for IBLC 2002                                                  CER001
      *                                                                                       CER001
     C           DOLX43    IFEQ 'Y'                                                           CER001
     C                     WRITEZZEXBLK                                                       CER001
      *                                                                                       CER001
     C                     DO   3         UL      10                                          CER001
     C           IUL,UL    IFNE *BLANKS                                                       CER001
     C                     MOVELIUL,UL    RRLINE                                              CER001
     C                     WRITEZZEXIBLC                                                      CER001
     C                     ENDIF                                                              CER001
     C                     ENDDO                                                              CER001
      *                                                                                       CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
     C*                                                                   S01408
     C                     MOVE '1'       *IN21            OUTPUT, YES
     C*
     C*          *****     *****
     C           CCEND     ENDSR
     C*          *****     *****
      /EJECT                                                              S01435
      *****************************************************************   S01435
      **                                                                  S01435
      **    Get name for Type.                                            S01435
      **                                                                  S01435
      **    CALLED FROM:  anywhere                                        S01435
      **    CALLS:                                                        S01435
      **                                                                  S01435
      **                                                                  S01435
     C           GETADD    BEGSR                                          S01435
      *                                                                   S01435
      *                                                                   S01435
      *  Set up general parameters                                        S01435
      *                                                                   S01435
     C           *LIKE     DEFN BCCY      XCCY                            S01435
      *                                                                   S01435
     C                     CLEARW8FT                                      S01435
     C                     MOVEL*BLANKS   W8STMT                          S01435
     C                     MOVELXCCY      W8CCY                           S01435
     C                     MOVEL##PGM     W8CPGM                          S01435
     C                     MOVEL'*PRINT'  W8ACT                           S01435
     C                     Z-ADD5         W8NLIN                          S01435
      **********                                                                       S01435 235937
      ***If*an*audit then data is critical                                             S01435 235937
      **********                                                                       S01435 235937
     C********** PARM1     IFEQ 'A'                                                    S01435 235937
     C********** OTRECI    ANDEQ'D'                                                    070846 235937
     C**********           MOVEL'Y'       W8CRIT                                       S01435 235937
     C**********           END                                                         S01435 235937
      *                                                                   CFT004
     C           CFT004    IFEQ 'Y'                                       CFT004
     C           XTYPE     ANDEQ'I'                                       CFT004
     C                     MOVE *BLANKS   W8CRIT                          CFT004
     C                     ENDIF                                          CFT004
      *                                                                   S01435
      *  Set up parameters                                                S01435
      *                                                                   S01435
     C                     MOVELXTYPE     W8TYPE                          S01435
     C                     MOVEL*BLANKS   W8LINS                          S01435
     C                     MOVELXNAMDS    W8LINS                          S01435
      *                                                                   S01435
      * Call expansion program                                            S01435
      *                                                                   S01435
     C                     CALL 'FT0315'               8989               S01435
     C                     PARM           W8RTN   7                       S01435
     C                     PARM           W8FT                            S01435
     C                     PARM           W8LINS256                       S01435
     C                     PARM           W8RPT 256                       S01435
     C                     PARM           W8MSG 256                       S01435
     C                     PARM           W8SCR 256                       S01435
      *                                                                   S01435
      ** Check if database error occurred                                 S01435
      *                                                                   S01435
     C           *IN89     IFEQ '1'                                       S01435
     C           W8RTN     ORNE *BLANKS                                   S01435
     C                     MOVEL'FT0315'  WDBFIL                          S01435
     C                     MOVEL'*CALL'   WDBKEY                          S01435
     C                     MOVEL'52'      WDBASE                          S01435
     C                     EXSR UEABRT                     *ABORT PGM*    S01435
     C                     END                                            S01435
      *                                                                   S01435
     C           CFT004    IFEQ 'Y'                                       CFT004
     C           W8TYPE    ANDEQ'I'                                       CFT004
     C                     MOVELW8MSG     XNAMDS                          CFT004
     C                     ELSE                                           CFT004
     C                     MOVELW8RPT     XNAMDS                          S01435
     C                     ENDIF                                          CFT004
      *                                                                   S01435
     C                     ENDSR                                          S01435
     C/EJECT
     C           CHOPF     BEGSR
     C*          ******    *****
     C*
     C*****************************************************************
     C*                 CHOP FIELD PROCESSING                         *
     C*                                                               *
     C*  FUNCTION : TO EDIT  SNCO, ORBK, CDRO  FOR OUTPUT.            *
     C*             IF PRMFLD IS ZERO THEN OUTPUT BLANKS.             *
     C*             IF PRMTYP IS 'N',OUTPUT FIRST TWO CHARS.          *
     C*             IF PRMTYP ID 'R',OUTPUT FIRST TEN CHARS.          *
     C*                                                               *
     C*  CALLS :    NONE                                              *
     C*                                                               *
     C*  CALLED BY: CCDETL                                            *
     C*                                                               *
     C*****************************************************************
     C*
     C           PRMFLD    IFEQ *ZEROS
     C                     MOVE *BLANKS   PRMFLD
     C                     ELSE
     C*
     C           PRMTYP    IFEQ 'N'
     C                     MOVE BLNK10    PRMFLD
     C                     ELSE
     C*
     C           PRMTYP    IFEQ 'R'
     C                     MOVE BLNK2     PRMFLD
     C*
     C                     END
     C                     END
     C                     END
     C*
     C*                    *****
     C                     ENDSR
     C*                    *****
     C/EJECT
     C           CELAST    BEGSR
     C*          ******    *****
     C*
     C*****************************************************************
     C*                 CE-LAST-RECORD-PROCESSING                     *
     C*                                                               *
     C*  FUNCTION : TO PERFORM CONTROL CHECKS WHEN THE TRAILER        *
     C*             RECORD IS READ.                                   *
     C*                                                               *
     C*  CALLS :    NONE                                              *
     C*                                                               *
     C*  CALLED BY: AAMAIN                                            *
     C*                                                               *
     C*****************************************************************
     C*                                                                   S01117
     C* ACCESS OTPAYZZ- TRAILER FOR OUTGOING PAYMENTS                     S01117
     C*                                                                   S01117
     C                     READ OTPAYZZ                  89               S01117
     C*                                                                   S01117
     C           *IN89     IFEQ '1'                                       S01117
     C                     MOVEL'OTPAYZZ' WDBFIL           ***************S01117
     C                     MOVEL*BLANKS   WDBKEY           * DB ERROR 21 *S01117
     C                     MOVEL'021'     WDBASE           ***************S01117
     C                     EXSR UEABRT                                    S01117
     C                     END                                            S01117
     C*
     C** CHECK CONTROL TOTALS
     C*
     C*********************Z-ADDNORE1     P2NORE                          S01194
     C*********************Z-ADDHRWN      P2HRWN                          S01194
     C*********************Z-ADDHRDC      P2HRDC                          S01194
     C*********************Z-ADDZZTOTI    P2CLWN                          S01194
     C*********************Z-ADDZZTOTD    P2CLDC                          S01194
     C           *IN22     IFEQ '0'                                       S01494
     C                     Z-ADDNORE1     AUNORE                          S01194
     C                     Z-ADDHRWN      AUHRWN                          S01194
     C                     Z-ADDHRDC      AUHRDC                          S01194
     C                     END                                            S01494
     C                     Z-ADDZZTOTI    AUCLWN                          S01194
     C                     Z-ADDZZTOTD    AUCLDC                          S01194
     C*
     C/COPY WNCPYSRC,FT0510C014
     C           @PLEV     IFEQ 'S'                                       S01117
     C***********P2NORE****IFNE P2CLNO                                    S01194
     C***********P2HRWN****ORNE P2CLWN                                    S01194
     C***********P2HRDC****ORNE P2CLDC                                    S01194
     C           *IN22     IFEQ '0'                                       S01494
     C           AUNORE    IFNE AUCLNO                                    S01194
     C           AUHRWN    ORNE AUCLWN                                    S01194
     C           AUHRDC    ORNE AUCLDC                                    S01194
     C                     SETON                     U8
     C                     MOVEL'*** DIFF'WA16   16
     C                     MOVE 'ERENCE *'WA16
     C*********************MOVELWA16      P2DIFF                          S01194
     C*********************MOVE '**'      P2DIFF                          S01194
     C                     MOVELWA16      AUDIFF                          S01194
     C                     MOVE '**'      AUDIFF                          S01194
     C                     END
     C                     END                                            S01494
     C                     END                                            S01117
     C/COPY WNCPYSRC,FT0510C015
     C*
     C                     Z-ADD0         PAGE                            S01117
     C           *IN21     IFEQ '0'                        NO DETAIL
     C           @PLEV     IFNE 'S'                                       S01117
     C           *IN10     IFEQ '1'                                       S01117
     C                     MOVEL@PENT     SBRA                            S01117
     C                     EXSR TABTR                                     S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C*********************WRITEP1HD                       ON THE         S01194
     C*********************WRITEP1NODT                     REPORT         S01194
     C                     WRITEAUHEAD                                    S01194
     C                     WRITEAUNODT                                    S01194
     C                     WRITEAUEOR                                     S01194
     C*********************END                                            S01117
     C                     ELSE                                           S01117
     C*
     C** OUTPUT CONTROL REPORT
     C*
     C*********************WRITEP2HEAD                                    S01117
     C*********************WRITEP2CNTL                                    S01117
     C*********************WRITEP2EOR                                     S01117
     C           @PENT     IFEQ 'ALL'                                     S01117
     C                     MOVE @PENT     SBRA                            S01117
     C                     MOVE *BLANKS   PBRNM                           S01117
     C                     END                                            S01117
     C                     WRITEAUHEAD                                    S01117
     C                     WRITEAUCNTL                                    S01117
     C                     WRITEAUEOR                                     S01117
     C                     END                                            S01117
     C*
     C** OUTPUT END-OF-REPORT MESSAGE TO DETAIL REPORT
     C*
     C           *IN21     IFEQ '1'                                       S01117
     C                     WRITEP1EOR
     C                     END                                            S01117
     C*
     C** TERMINATE PROGRAM
     C*
     C                     SETON                     LR
     C*
     C*          *****     *****
     C           CEEND     ENDSR
     C*          *****     *****
     C/EJECT
     C           UATBCN    BEGSR
     C*          ******    *****
     C*
     C*****************************************************************
     C*                 UA-CHAIN-TABLE-FILE                           *
     C*                                                               *
     C*  FUNCTION : TO ATTEMPT TO ACCESS A REQUESTED RECORD FROM THE  *
     C*             TABLE FILE.                                       *
     C*                                                               *
     C*  CALLS :    NONE                                              *
     C*                                                               *
     C*  CALLED BY: AAMAIN                                            *
     C*             ECINST                                            *
     C*                                                               *
     C*****************************************************************
     C*
     C           ZTABKY    CHAINTABFP                89
     C*
     C  N89      RECI      COMP 'D'                  8989
     C*
     C*          *****     *****
     C           UAEND     ENDSR
     C*          *****     *****
     C/EJECT
     C           UCCLCN    BEGSR
     C*          ******    *****
     C*
     C*****************************************************************
     C*                 UC-CHAIN-PAYMENT-CHARGES-FILE                 *
     C*                                                               *
     C*  FUNCTION : TO ATTEMPT TO ACCESS THE RECORD FROM THE PAYMENT  *
     C*             CHARGES FILE.                                     *
     C*                                                               *
     C*  CALLS :    NONE                                              *
     C*                                                               *
     C*  CALLED BY: CADETL                                            *
     C*             EEAMND                                            *
     C*                                                               *
     C*****************************************************************
     C*
     C           WCLRCT    IFEQ 'R'                                       E16477
     C                     READ CLINT                    89               E16477
     C*                                                                   E16477
     C                     ELSE                                           E16477
     C*                                                                   E16477
     C           WCLKEY    KLIST
     C**********           KFLD           WCLNUM  60                                          CSD027
     C                     KFLD           WCLNUM  6                                           CSD027
     C                     KFLD           WCLRCT  1
     C*
     C           WCLKEY    CHAINCLINT                89
     C*
     C                     END                                            E16477
     C  N89      RECI      COMP 'D'                  8989
     C*
     C*          *****     *****
     C           UCEND     ENDSR
     C*          *****     *****
     C/EJECT
     C           UEABRT    BEGSR
     C*          ******    *****
     C*
     C*****************************************************************
     C*                 UE-ABORT-PROGRAM                              *
     C*                                                               *
     C*  FUNCTION : TO ABORT THE PROGRAM IN THE EVENT OF A DATABASE   *
     C*             ERROR. ALSO TO SETUP THE RELEVANT FIELDS IN THE   *
     C*             DATA AREA LDA FOR THIS ERROR.                     *
     C*                                                               *
     C*  CALLS :    NONE                                              *
     C*                                                               *
     C*  CALLED BY: AAMAIN                                            *
     C*             ECINST                                            *
     C*             EEAMND                                            *
     C*                                                               *
     C*****************************************************************
     C*
     C** UPDATE DATA AREA LDA
     C*
     C           *NAMVAR   DEFN LDA       DLDA
     C           *LOCK     IN   DLDA
     C                     MOVEL'FT0510'  DBPGM
     C                     MOVELWDBFIL    DBFILE
     C                     MOVELWDBKEY    DBKEY
     C                     MOVELWDBASE    DBASE
     C                     OUT  DLDA
     C*
     C** SETON INDICATORS TO INDICATE DATABASE ERRORS
     C*
     C                     SETON                     U7U8LR
     C*
     C** REPORT DATABASE ERROR
     C*
     C                     Z-ADD0         PAGE                            S01194
     C*********************WRITEP2HEAD                                    S01194
     C                     WRITEAUHEAD                                    S01194
     C*
     C*********************MOVELWDBASE    P2DBAS                          S01194
     C*********************MOVELWDBFIL    P2DBFL                          S01194
     C*********************MOVELWDBKEY    P2DBKY                          S01194
     C                     MOVELWDBASE    AUDBAS                          S01194
     C                     MOVELWDBFIL    AUDBFL                          S01194
     C                     MOVELWDBKEY    AUDBKY                          S01194
     C*
     C*********************WRITEP2DBER                                    S01194
     C                     WRITEAUDBER                                    S01194
     C*
     C** PRODUCE PROGRAM DUMP
     C*
     C                     DUMP
     C*
     C** END PROGRAM
     C*
     C                     RETRN
     C*
     C*          *****     *****
     C           UEEND     ENDSR
     C*          *****     *****
     C/EJECT
     C           UGFRMT    BEGSR
     C*          ******    *****
     C*
     C*****************************************************************
     C*             UG-FORMAT-FIELD-FOR-OUTPUT-TO-REPORT              *
     C*                                                               *
     C*  FUNCTION : TO FORMAT A NUMERIC FIELD FROM THE PAYMENT        *
     C*             CHARGES FILE FOR OUTPUT TO THE DETAIL SCREEN.     *
     C*             IT REMOVES LEADING ZEROES & INSERTS A DECIMAL     *
     C*             POINT IN THE APPROPRIATE POSITION.                *
     C*                                                               *
     C*  CALLS :    NONE                                              *
     C*                                                               *
     C*  CALLED BY: CADETL                                            *
     C*                                                               *
     C*****************************************************************
     C*
     C                     MOVEAWFDIN     WA1,1
     C*
     C** REPLACE LEADING ZEROES (IF LEFT OF DECIMAL POINT) WITH SPACES
     C*
     C                     SETOF                     89
     C           15        SUB  WDIG      I       30        -START
     C                     SUB  WDEC      I                  POS.
     C*
     C           14        SUB  WDEC      I1      30
     C*
     C           *IN89     DOUEQ'1'
     C                     ADD  1         I
     C           I         IFGT 15                          -CHECK FOR
     C                     SETON                     89      ARRAY END
     C                     ELSE
     C           WA1,I     IFNE '0'                         -CHECK FOR
     C                     SETON                     89      NON-ZERO
     C                     ELSE                              DIGIT.
     C           I         IFLE I1
     C                     MOVEL' '       WA1,I
     C                     END
     C                     END
     C                     END
     C                     END
     C*
     C** MOVE DIGITS TO RIGHT OF DECIMAL POINT(IF ANY) TO OUTPUT ARRAY
     C** & INSERT A DECIMAL POINT
     C*
     C                     MOVEL*BLANKS   WA2
     C*
     C           16        SUB  WDEC      I
     C           21        SUB  WDEC      I1
     C*
     C           I         IFLE 15
     C                     MOVEAWA1,I     WA2,I1
     C                     SUB  1         I1
     C                     MOVEL'.'       WA2,I1
     C                     END
     C*
     C** INSERT A COMMA AFTER EVERY 3 DIGITS TO LEFT OF DECIMAL POINT
     C*
     C                     SUB  1         I
     C                     SUB  1         I1
     C                     Z-ADD*ZERO     I2      30
     C*
     C           WA1,I     DOUEQ' '
     C           I         OREQ *ZERO
     C*
     C           I2        IFEQ 3
     C                     MOVEL','       WA2,I1
     C                     SUB  1         I1
     C                     Z-ADD*ZERO     I2
     C                     END
     C*
     C                     MOVE WA1,I     WA2,I1
     C                     SUB  1         I
     C                     SUB  1         I1
     C                     ADD  1         I2
     C                     END
     C*
     C                     MOVEAWA2,1     WFDOUT 20
     C*
     C*          *****     *****
     C           UGEND     ENDSR
     C*          *****     *****
     C/EJECT
     C           UCMUSE    BEGSR
     C*          ******    *****
     C*
     C*****************************************************************
     C*                 UC-CHAIN-USER-FILE                            *
     C*                                                               *
     C*  FUNCTION : TO ATTEMPT TO ACCESS THE RECORD FROM THE USER     *
     C*             FILE.                                             *
     C*                                                               *
     C*  CALLS :    NONE                                              *
     C*                                                               *
     C*  CALLED BY: CADETL                                            *
     C*                                                               *
     C*****************************************************************
     C*
     C           USRP      CHAINMUSERDDF             89
     C*
     C  N89      RECI      COMP 'D'                  8989
      *
     C** Remove DBERROR processing as user may not exist after a migration084523
     C*                                                                   084523
     C******     *IN89     IFEQ '1'                        ************** 084523
     C******               MOVEL'MUSER'   WDBFIL           * DATA BASE  * 084523
     C******************   MOVELUSRP ***  WDBKEY  *******  *  ERR*R 11  * E16477
     C******************   MOVEL'11' ***  WDBASE  *******  ************** E16477
     C******               MOVELUSRP      WDBKEY    *  ERROR 18  * E16477 084523
     C******               MOVEL'18'      WDBASE    ************** E16477 084523
     C******               EXSR UEABRT                                    084523
     C******               END                                            084523
     C*
     C*                    *****
     C                     ENDSR
     C*                    *****
     C/EJECT
     C           TABTR     BEGSR                                          S01117
     C*          ******    *****                                          S01117
     C*                                                                   S01117
     C*****************************************************************   S01117
     C*             TABLETR CHAIN TO RETRIEVE BRANCH NAME             *   S01117
     C*                                                               *   S01117
     C*  FUNCTION : TO ACCESS BRANCH NAME BRNM FROM TABLETR           *   S01117
     C*                                                               *   S01117
     C*  CALLS :    NONE                                              *   S01117
     C*                                                               *   S01117
     C*  CALLED BY: MAIN SUBROUTINE                                   *   S01117
     C*                                                               *   S01117
     C*****************************************************************   S01117
     C*                                                                   S01117
     C**  SET UP KEY AND ACCESS INST. CONTROL REC BRANCH CODE (TABLETR)   S01117
     C*                                                                   S01117
     C**********           MOVE *BLANKS   ZTABKY                          S01117             BUG7985
     C**********           MOVEL'10    '  ZTABKY                          S01117             BUG7985
     C**********           MOVE SBRA      ZTABKY                          S01117             BUG7985
     C           SBRA      IFNE 'ALL'                                     S01117
     C*                                                                   S01117
     C********** ZTABKY    CHAINTABLETRF             89                   S01117             BUG7985
     C********** *IN89     IFNE '1'                                       S01117             BUG7985
     C********** RECI      COMP 'D'                  8989  ON , DELETED   S01117             BUG7985
     C**********           END                                            S01117             BUG7985
      *                                                                                      BUG7985
     C                     CALL 'AOBRCHR1'                                                   BUG7985
     C                     PARM *BLANKS   PRTCD   7                                          BUG7985
     C                     PARM '*KEY   ' POPTN   7                                          BUG7985
     C                     PARM SBRA      PBRCH   3                                          BUG7985
     C           SDBRCH    PARM SDBRCH    DSSDY                                              BUG7985
     C*                                                                   S01117
     C** DB ERROR IF NO RECORD FOUND.                                     S01117
     C*                                                                   S01117
     C           PRTCD     IFNE *BLANKS                                                      BUG7985
     C********** *IN89     IFEQ '1'                                       S01117             BUG7985
     C**********           MOVEL'TABLE'   WDBFIL           ***************S01117             BUG7985
     C**********           MOVELZTABKY    WDBKEY           * DB ERROR 22 *S01117             BUG7985
     C                     MOVEL'SDBRCHPD'WDBFIL                                             BUG7985
     C                     MOVELSBRA      WDBKEY                                             BUG7985
     C                     MOVEL'022'     WDBASE           ***************S01117
     C                     EXSR UEABRT                                    S01117
     C                     ELSE                                           S01117
     C**********           MOVELBRNM      PBRNM                           S01117             BUG7985
     C                     MOVELA8BRNM    PBRNM                           S01117             BUG7985
     C                     END                                            S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C*                    *****                                          S01117
     C                     ENDSR                                          S01117
     C*                    *****                                          S01117
     C/EJECT                                                              S01117
     C           TABTR2    BEGSR                                          S01117
     C*          ******    *****                                          S01117
     C*                                                                   S01117
     C*****************************************************************   S01117
     C*             TABLETR CHAIN TO RETRIEVE BRANCH NAME             *   S01117
     C*                                                               *   S01117
     C*  FUNCTION : TO ACCESS BRANCH NAME BRNM FROM TABLETR           *   S01117
     C*             FOR OTHER BRANCH FIELD ON DETAIL RECORD           *   S01117
     C*                                                               *   S01117
     C*  CALLS :    NONE                                              *   S01117
     C*                                                               *   S01117
     C*  CALLED BY: MAIN SUBROUTINE                                   *   S01117
     C*                                                               *   S01117
     C*****************************************************************   S01117
     C*                                                                   S01117
     C**  SET UP KEY AND ACCESS INST. CONTROL REC BRANCH CODE (TABLETR)   S01117
     C*                                                                   S01117
     C**********           MOVE *BLANKS   ZTABKY                          S01117             BUG7985
     C**********           MOVEL'10    '  ZTABKY                          S01117             BUG7985
     C**********           MOVE SBRO      ZTABKY                          S01117             BUG7985
     C*                                                                   S01117
     C********** ZTABKY    CHAINTABLETRF             89                   S01117             BUG7985
     C********** *IN89     IFNE '1'                                       S01117             BUG7985
     C********** RECI      COMP 'D'                  8989  ON , DELETED   S01117             BUG7985
     C**********           END                                            S01117             BUG7985
      *                                                                                      BUG7985
     C                     CALL 'AOBRCHR1'                                                   BUG7985
     C                     PARM *BLANKS   PRTCD   7                                          BUG7985
     C                     PARM '*KEY   ' POPTN   7                                          BUG7985
     C                     PARM SBRO      PBRCH   3                                          BUG7985
     C           SDBRCH    PARM SDBRCH    DSSDY                                              BUG7985
     C*                                                                   S01117
     C** DB ERROR IF NO RECORD FOUND.                                     S01117
     C*                                                                   S01117
     C           PRTCD     IFNE *BLANKS                                                      BUG7985
     C********** *IN89     IFEQ '1'                                       S01117             BUG7985
     C**********           MOVEL'TABLE'   WDBFIL           ***************S01117             BUG7985
     C**********           MOVELZTABKY    WDBKEY           * DB ERROR 23 *S01117             BUG7985
     C                     MOVEL'SDBRCHPD'WDBFIL           ***************S01117             BUG7985
     C                     MOVELSBRO      WDBKEY           * DB ERROR 23 *S01117             BUG7985
     C                     MOVEL'023'     WDBASE           ***************S01117
     C                     EXSR UEABRT                                    S01117
     C                     ELSE                                           S01117
     C*********************MOVELBRNM      PBRNO                    S01117 055293
     C**********           MOVELBRNM      PBRNO  30                S01117 055293             BUG7985
     C                     MOVELA8BRNM    PBRNO  30                S01117 055293             BUG7985
     C                     END                                            S01117
     C*                                                                   S01117
     C*                    *****                                          S01117
     C                     ENDSR                                          S01117
     C*                    *****                                          S01117
     C/EJECT                                                              S01117
     C           ZSFLP1    BEGSR                                          S01117
     C*          ******    *****                                          S01117
     C*                                                                   S01117
     C*****************************************************************   S01117
     C*            ZSFILE PROCESSING FOR P1 FILE                      *   S01117
     C*                                                               *   S01117
     C* FUNCTION:  TO CLOSE AND OPEN P1 PRINTER FILE AND CALL ZSFILE  *   S01117
     C*                                                               *   S01117
     C* CALLED BY : MAIN SUBROUTINE                                   *   S01117
     C*                                                               *   S01117
     C*****************************************************************   S01117
     C*                                                                   S01117
     C** SETUP SPOOL FILE DETAILS                                         S01117
     C*                                                                   S01117
     C           *IN11     IFEQ '0'                        NOT SYSTEM     S01117
     C           *IN14     IFEQ '0'                                       S01117
     C                     MOVE BRCA      ZENT             BOOKING        S01117
     C                     ELSE                                           S01117
     C                     MOVE ORBR      ZENT             ORIGINATING    S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C** CLOSE AND OPEN PRINTER FILE                                      S01117
     C*                                                                   S01117
     C                     CLOSEFT0510P1                                  S01117
     C                     OPEN FT0510P1                                  S01117
     C                     Z-ADD0         PAGE                            S01117
     C*                                                                   S01117
     C** CALL'ZSFILE' TO LOG SPOOL FILE DETAILS                           S01117
     C*                                                                   S01117
     C           *IN22     IFEQ '0'                                       S01494
     C                     MOVELSFILE1    ZSFLNA                          S01117
     C                     ELSE                                           S01494
     C                     MOVEL'FT0511P1'ZSFLNA                          S01494
     C                     END                                            S01494
     C                     Z-ADDSFNUM1    ZSSLNO                          S01117
     C*                                                                   S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           @PSEQ   5                       S01117
     C                     PARM           ZENT    3                       S01117
     C                     PARM           ZSFLNA 10                       S01117
     C                     PARM           ZSSLNO  60                      S01117
     C                     PARM *BLANKS   ZERR    1                       S01117
     C*                                                                   S01117
     C** DB ERROR IF ZERR IS NOT BLANK                                    S01117
     C*                                                                   S01117
     C           ZERR      IFNE *BLANK                                    S01117
     C                     SETON                     U7U8LR               S01117
     C           *LOCK     IN   DLDA                                      S01194
     C                     MOVEL'FT0510'  DBPGM                           S01194
     C           *IN22     IFEQ '0'                                       S01494
     C                     MOVEL'FT510P1' DBKEY            ***************S01194
     C                     ELSE                                           S01494
     C                     MOVEL'FT511P1' DBKEY                           S01494
     C                     END                             ***************S01494
     C                     MOVEL'ZSFILE'  DBFILE           * DB ERROR 24 *S01194
     C                     MOVEL'024'     DBASE            ***************S01194
     C                     OUT  DLDA                                      S01194
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C*                    *****                                          S01117
     C                     ENDSR                                          S01117
     C*                    *****                                          S01117
     C/EJECT                                                              S01117
0758 C**
0759 C**
0760 C********************************************************************
0761 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
0762 C*   IND '99' IS SET BY AN OVERFLOW ERROR
0763 C*
0764 C           GLZADD    BEGSR                           *** GLZADD ****
0765 C*
0766 C                     Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
0767 C   91                GOTO ZZAEND                     AMT = 0.BYPASS
0768 C*
0769 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
0770 C                     Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
0771 C                     MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
0772 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
0773 C*
0774 C                     EXSR GLZSUM
0775 C           ZZAEND    ENDSR                           ** ZZAEND TAG *
     C/EJECT
0776 C*
0777 C********************************************************************
0778 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
0779 C*                        GLZADD, GLZSUB, GLZCMP.
0780 C*          PARAMETERS PASSED -
0781 C*                     I/P ZZAMTI ZZAMTD
0782 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
0783 C*
0784 C           GLZSUM    BEGSR                           *** GLZSUM ****
0785 C*
0786 C                     Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
0787 C                     Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
0788 C                     SETOF                     919293
0789 C                     SETOF                     949599
0790 C*
0791 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
0792 C           ZZAMTI    COMP 0                      9293
0793 C   93      ZZAMTD    COMP 0                      9293
0794 C   93                GOTO ZZSEND                     ZERO BYPASS
0795 C*
0796 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
0797 C           ZZTOTI    COMP 0                      9193
0798 C   93      ZZTOTD    COMP 0                      9193
0799 C*
0800 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
0801 C   93                Z-ADDZZAMTI    ZZTOTI
0802 C   93                Z-ADDZZAMTD    ZZTOTD
0803 C   93                GOTO ZZSEND                     ZERO BYPASS
0804 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
0805 C   91N92
0806 CORN91 92             GOTO ZZOFPS
0807 C*
0808 C           ZZAMTD    ADD  ZZTOTD    ZZWK2   40
0809 C           ZZWK2     COMP 999                  93    '93' = CARRY
0810 C  N93      ZZWK2     COMP -999                   93    INTO INTEGER.
0811 C*
0812 C   93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
0813 C      93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
0814 C   93      ZZTOTI    ADD  ZZWK3     ZZWK3
0815 C  N93      ZZTOTI    ADD  ZZAMTI    ZZWK3
0816 C*
0817 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
0818 C  N92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
0819 C   92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
0820 C  N99                Z-ADDZZWK2     ZZTOTD
0821 C  N99                Z-ADDZZWK3     ZZTOTI
0822 C*
0823 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
0824 C   99                Z-ADD0         ZZAMT  153
0825 C                     GOTO ZZSEND
0826 C*
0827 C* THE 'SIGNS' ARE DIFFERENT
0828 C           ZZOFPS    TAG                             ** ZZOFPS TAG**
0829 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
0830 C*
0831 C   92                Z-SUBZZAMTI    ZZAMTI 150
0832 C   92                Z-SUBZZAMTD    ZZAMTD  30
0833 C*
0834 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
0835 C*
0836 C   91                Z-SUBZZTOTI    ZZTOTI
0837 C   91                Z-SUBZZTOTD    ZZTOTD
0838 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
0839 C*
0840 C           ZZTOTI    COMP ZZAMTI               93  95
0841 C   95      ZZTOTD    COMP ZZAMTD               93  95
0842 C*
0843 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
0844 C   95                Z-ADD0         ZZTOTI
0845 C   95                Z-ADD0         ZZTOTD
0846 C   95                GOTO ZZSEND
0847 C*
0848 C* IF ZZTOT GT. ZZAMT.
0849 C   93      ZZAMTD    COMP ZZTOTD               94
0850 C   93 94   ZZTOTI    SUB  1         ZZTOTI
0851 C   93 94   ZZTOTD    ADD  1000      ZZWK2
0852 C   93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
0853 C   93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
0854 C   93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
0855 C*
0856 C*
0857 C* IF ZZAMT GT. ZZTOT.
0858 C  N93      ZZTOTD    COMP ZZAMTD               94
0859 C  N93 94   ZZAMTI    SUB  1         ZZWK3  150
0860 C  N93 94   ZZAMTD    ADD  1000      ZZWK2
0861 C  N93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
0862 C  N93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
0863 C  N93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
0864 C  N93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
0865 C*
0866 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
0867 C                     SETOF                     94
0868 C   93 91
0869 CORN93 92             SETON                     94
0870 C   94                Z-SUBZZTOTI    ZZTOTI
0871 C   94                Z-SUBZZTOTD    ZZTOTD
0872 C**
0873 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
0874 C   92                Z-SUBZZAMTI    ZZAMTI
0875 C   92                Z-SUBZZAMTD    ZZAMTD
0876 C           ZZSEND    TAG                             ** ZZSEND TAG *
0877 C**
0878 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
0879 C                     SETOF                     96
0880 C           ZZTOTD    COMP 0                        91
0881 C   91      ZZTOTI    COMP 0                      96
0882 C   96                MOVE '.000-'   ZZNEGD  5
0883 C                     ENDSR                             ** ENDSR **
     C/EJECT
0669 C**
0670 C**
0671 C********************************************************************
0672 C**
0673 C**   ZDATE2 SR. TO CONVERT A DAY NUMBER TO DATE FORMATS.
0674 C**
0675 C**   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.
0676 C**
0677 C           ZDATE2    BEGSR                           *** ZDATE2 ***
0678 C**
0679 C**   CLEAR DATE FIELDS.
0680 C                     Z-ADD0         ZDATE   60
0681 C                     MOVEL'       ' ZADATE  7
0682 C**
0683 C**   CALCULATION TO DEFINE INPUT DAY NUMBER.
0684 C                     Z-ADDZDAYNO    ZDAYNO  50
0685 C**
0686 C**   DETERMINE YEAR NUMBER.
0687 C**
0688 C**   ADJUST DAY NUMBER IN CASE LAST DAY OF YEAR.
0689 C           ZDAYNO    SUB  1         ZDAYN1  50   99
0690 C   99                GOTO ZDEND2
0691 C**
0692 C**   CALCULATE NUMBER OF 4 YEAR SPANS SINCE 31/12/1971.
0693 C           ZDAYN1    DIV  1461      ZLYR    20
0694 C                     MVR            ZDAYN1           SAVE REMAINING
0695 C**                                                   DAYS
0696 C**   CALCULATE NUMBER OF REMAINING YEARS.
0697 C                     Z-ADD1         ZWRK2   20
0698 C           ZDTAG1    TAG                             ** ZDTAG1 TAG *
0699 C           ZDAYN1    COMP ZYDY,ZWRK2             90
0700 C  N90      ZWRK2     ADD  1         ZWRK2
0701 C  N90                GOTO ZDTAG1
0702 C           ZWRK2     SUB  1         ZWRK2          91LEAP YR, 91 ON
0703 C**
0704 C**   DECREMENT DAY NO. BY DAYS IN REMAINING YEARS.
0705 C  N91      ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1
0706 C**
0707 C**   CALCULATE ACTUAL YEAR NUMBER.
0708 C           ZLYR      MULT 4         ZWRK3   30
0709 C           ZWRK3     ADD  72        ZWRK3            BASE IS 1972
0710 C                     Z-ADDZWRK3     ZYEAR   20
0711 C           ZYEAR     ADD  ZWRK2     ZYEAR            YEAR
0712 C**
0713 C**   DETERMINE MONTH NUMBER.
0714 C**
0715 C**   ADJUST DAY NO. IN CASE LAST DAY OF LEAP YEAR FEBRUARY.
0716 C                     SETOF                     9293
0717 C   91      ZDAYN1    COMP 59                     9293
0718 C   91N92   ZDAYN1    SUB  1         ZDAYN1
0719 C**
0720 C**   CALCULATE MONTH NUMBER.
0721 C                     Z-ADD2         ZWRK2
0722 C           ZDTAG2    TAG                             ** ZDTAG2 TAG *
0723 C           ZDAYN1    COMP ZMDY,ZWRK2             94
0724 C  N94      ZWRK2     ADD  1         ZWRK2
0725 C  N94                GOTO ZDTAG2
0726 C           ZWRK2     SUB  1         ZWRK2
0727 C**
0728 C                     Z-ADDZWRK2     ZMTH    20       MONTH
0729 C**
0730 C**   DETERMINE DAY OF MONTH.
0731 C**
0732 C**   ADD BACK LAST DAY OF YEAR ADJUSTMENT.
0733 C           ZDAYN1    ADD  1         ZDAYN1
0734 C**
0735 C**   CALCULATE DAY OF MONTH.
0736 C           ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY
0737 C**
0738 C**   ADD BACK LEAP YEAR 29TH FEBUARY ADJUSTMENT, IF REQUIRED.
0739 C   93      ZDAY      ADD  1         ZDAY
0740 C**
0741 C**   FORMAT DATE, DDMMYY OR MMDDYY.
0742 C  N98                MOVELZDAY      ZWRK4   40
0743 C   98                MOVE ZDAY      ZWRK4
0744 C  N98                MOVE ZMTH      ZWRK4
0745 C   98                MOVELZMTH      ZWRK4
0746 C                     MOVELZWRK4     ZDATE
0747 C                     MOVE ZYEAR     ZDATE
0748 C**
0749 C**   FORMAT ALPHA DATE, DDMMMYY.
0750 C           ZDAY      COMP 10                     95
0751 C                     MOVELZDAY      ZWRK5   5
0752 C   95                MOVEL' '       ZWRK5
0753 C                     MOVE ZMNM,ZMTH ZWRK5
0754 C                     MOVELZWRK5     ZADATE
0755 C                     MOVE ZYEAR     ZADATE
0756 C**
0757 C           ZDEND2    ENDSR                           * ZDEND2 ENDSR*
     C/EJECT
     C**
     C********************************************************************
1385 C**
1487 C**
1488 C*****ZSYSTM*SR.*TO*CHAIN*TO*THE*INSTALLATION*CONTROL*DATA*RECORD.*  S01117
1488 C**   SYSTEM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.   S01117
1489 C**
1490 C***********ZSYSTM****BEGSR                           *** ZSYSTEM ***S01117
     C           SYSTEM    BEGSR                            *** SYSTEM ***S01117
     C*                                                                   S01117
     C** CALL ZSFILE TO LOG SPOOL FILE DETAILS                            S01117
     C*                                                                   S01117
     C           *IN22     IFEQ '0'                                       S01494
     C                     MOVELSFILE2    ZSFLAU                          S01494
     C                     ELSE                                           S01494
     C                     MOVEL'FT0511AU'ZSFLAU                          S01494
     C                     END                                            S01494
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           @PSEQ   5                       S01117
     C                     PARM *BLANKS   ZENTAU  3                       S01117
     C***********          PARM SFILE2    ZSFLAU 10                S01117 S01494
     C                     PARM           ZSFLAU 10                       S01494
     C                     PARM SFNUM2    ZSNOAU  60                      S01117
     C                     PARM *BLANKS   ZERR    1                       S01117
     C*                                                                   S01117
     C** ABORT PROGRAM IF ZERR IS NOT BLANK                               S01117
     C*                                                                   S01117
     C           ZERR      IFNE *BLANK                                    S01117
     C                     SETON                     U7U8LR               S01117
     C           *LOCK     IN   DLDA                                      S01117
     C                     MOVEL'FT0510'  DBPGM                           S01117
     C           *IN22     IFEQ '0'                                       S01494
     C                     MOVEL'FT510AU' DBKEY            ***************S01117
     C                     ELSE                                           S01494
     C                     MOVEL'FT511AU' DBKEY                           S01494
     C                     END                             ***************S01494
     C                     MOVEL'ZSFILE'  DBFILE           * DB ERROR 25 *S01117
     C                     MOVEL'025'     DBASE            ***************S01117
     C                     OUT  DLDA                                      S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
1491 C**
1492 C**   SET UP KEY FOR INSTALLATION CONTROL RECORD.
1493 C                     MOVEL'01      'ZTABKY 12
1494 C                     MOVE '  10'    ZTABKY
1495 C**
1496 C           ZTABKY    CHAINTABFP                99    ON NOT THERE
1497 C  N99      RECI      COMP 'D'                  9999  ON, IS DELETED
1498 C**
1499 C**   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.
1500 C           DATF      COMP 'M'                      98MMDDYY, 98 ON
1501 C**
1502 C                     ENDSR
1503 C**
      /EJECT                                                              CEU006
     C/COPY ZSRSRC,ZSEDITZ3                                               CEU006
      *                                                                   CFT009
     C/COPY ZSRSRC,ZEDITZ2                                                CFT009
      *                                                                   CEU006
     O* WARN - WARNING MESSAGES WHEN SWIFT IDENTIFICATOR IS NOT ON F050920S01435
      * WARNING, customer SWIFT ID                                        S01435
      * not found on customer master file
     C/EJECT
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
**  DESC
Miscellaneous Charge 1                                                    CFT009
Miscellaneous Charge 2                                                    CFT009
Miscellaneous Charge 3                                                    CFT009
Miscellaneous Charge 4                                                    CFT009
Miscellaneous Charge 5                                                    CFT009
