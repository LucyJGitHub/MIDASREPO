     H        1
     F*****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas FT Outgoing payments unauthorised report')       *
     F*****************************************************************
     F*                                                               *
     F*  Midas - Funds Transfer Module                                *
     F*                                                               *
     F*  FT0515 - Outgoing Payments Reporting                         *
     F*                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. CSD103             Date 10Aug20               *
      *  Prev Amend No. MD046248           Date 27Oct17               *
      *                 CFT120             Date 28Sep12               *
      *                 CER059             Date 19Jul10               *
      *                 BUG24029           Date 20May09               *
      *                 CER054             Date 07Apr09               *
      *                 BUG22580           Date 02Feb09               *
      *                 CER048             Date 19May08               *
      *                 CER047             Date 19May08               *
      *                 CER030             Date 09Jul08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 BUG25654           Date 19Aug09               *
      *                 BUG25468           Date 13Aug09               *
      *                 CSW209             Date 01Apr09               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 BUG16368           Date 27Feb08               *
      *                 BUG14166           Date 18Jun07               *
      *                 CSW207             Date 12Jun07               *
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 BUG12945A          Date 20Dec06               *
      *                 BUG12945           Date 19Dec06               *
      *                 CFT032             Date 11Sep06               *
      *                 CSD031             Date 10Apr06               *
      *                 BUG433             Date 05Dec05               *
      *                 CDL049             Date 07Jul06               *
      *                 CSD027             Date 09Dec05               *
      *                 CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 TDA035             Date 02Apr04               *
      *                 CGL029             Date 01Sep03               *
      *                 CSW203             Date 26May03               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CFT009             Date 01Jun00               *
      * Midas DBA 3.04 -----------------------------------------------*
      *                 CFT014             Date 25May00               *
      * Midas DBA 3.03 -----------------------------------------------*
      *                 165420             Date 20Apr00               *
      * Midas DBA 3.02 -----------------------------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CEU006             Date 01Apr98               *
      *                 109965             Date 05Apr97               *
      *                 101565             Date 10Jul96               *
     F*                 074815             DATE 19JUL94               *
     F*                 S01499             DATE 06JUN94               *
     F*                 S01494             DATE 25MAY94               *
     F*                 S01435             DATE 08SEP93               *
     F*                 055293             DATE 17MAY93               *
     F*                 S01414             DATE 29MAR93               *
     F*                 S01117             DATE 23/10/90              *
     F*                 S01194             DATE 23/10/90              *
     F*                 S01195             DATE 23/10/90              *
     F*                                                               *
     F*---------------------------------------------------------------*
      *                                                               *
      *  CSD103 - LIBOR Deregulation - Common Layer/Standing Data     *
      *  MD046248 - Finastra Rebranding                               *
      *  CFT120 - FT IN/OP - Charges to DR of Account Currency        *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  BUG24029 - COB Error RE3662 Database Error                   *
      *  CER054 - German Features - Church Tax (Recompile)            *
      *  BUG22580 - Fields incorrectly labeled and lengths            *
      *           (Recompile)                                         *
      *  CER048 - German Features - Taxes (Recompile)                 *
      *  CER047 - German Features LF037-00 Reporting §24c KWG         *
      *           (Recompile)                                         *
      *  CER030 - Multicash German Feature                            *
      *  BUG25654 - Initialise P1RLPR for every record reported       *
      *  BUG25468 - Applied fix BUG25471.                             *
      *  BUG25471 - Related Reference number value is missing.        *
     F*  CSW209 - SWIFT 2009 Changes                                  *
      *  BUG16368 - Payment reference fields are all blank.           *
      *  BUG14166 - Incorrect length for P1ODMT (Recompile)           *
      *  CSW207 - SWIFT 2007 Changes                                  *
      *  BUG12945A - FTC0515 00001 Failed                             *
      *  BUG12945 - FTC0515 00001 Failed                              *
      *  CFT032 - Account line in field 50X in MT103                  *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  BUG433 - Recompiled due to change in FTPCHGPD                *
      *  CDL049 - Addition of a Reference Rate field (recompile)      *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  TDA035 - RTS Signon changes for MidasPlus. (Recompile)       *
      *  CGL029 - Increase Account Code to 10 digits (Recompile)      *
      *  CSW203 - SWIFT 2003 Standards Update                         *
      *  CFT009 - FT Fees and Charge Development.                     *
      *  CFT014 - Straight-through Processing Phase 2 MT103           *
      *           Messages Generation for FT.                         *
      *  165420 - Prevent RCF from error when no spool file produced. *
      *  CEU006 - EMU FT Payments and Settlement.                     *
     F*  109965 - A new line was added in the Outgoing Payments Non-  *
     F*           Authorised Items List which shows whether charges   *
     F*           are to be deducted or added depending on the ADD/   *
     F*           DEDUCT indicator.                                   *
     F*  101565 - This report shows outgoimg payments when run in     *
     F*           Regular Payments mode - add a line to only select   *
     F*           payment type 'RP' in regular peyment mode.          *
     F*  074815 - Charge currency is sometimes incorrect              *
     F*           Fixed during development of S01494.                 *
     F*  S01499 - BLI V.A.T Processing                                *
     F*  S01494 - BLI Funds Transfer Enhancements                     *
     F*         - Move correct spool file name before                 *
     F*           calling ZSfILE  (TEMP05)                            *
     F*  S01435 - Incoming Message Management.                        *
     F*  055293 - Include Ordering Institution information            *
     F*  S01414 - Book Code and Profit Centre Incorporation.          *
     F*  S01117 - MULTI BRANCHING INCORPORATION , RCF PROCESSING      *
     F*  S01194 - DATABASE HANDLING                                   *
     F*  S01195 - HOLIDAYS PROCESSING                                 *
     F*                                                               *
     F*****************************************************************
     F* ID F  C  H  L    FUNCTION OF INDICATORS
     F*
     F*       20      FIRST CYCLE PROCESSING HAS BEEN DONE
     F*       21      THERE HAS BEEN OUTPUT
     F*       22      MULTI BRANCHING INDICATOR                           S01117
     F*       23      ORIGINATING BRANCH USED INDICATOR                   S01117
     F*       24      CHANGE OF BRANCH INDICATOR                          S01117
     F*       25      SYSTEM LEVEL INDICATOR                              S01117
     F*       26      ORIGINATING/BOOKING BRANCH INDICATOR (ON IF ORIG BR)S01117
     F*       27      REGULAR PAYMENTS PROCESSING                         S01494
     F*       28      CORE FEATURE S01494 IS SWITCHED ON                  S01494
     F*       29      CORE FEATURE S01499 IS SWITCHED ON                  S01499
     F*       30      CORE FEATURE CFT009 IS SWITCHED ON                  CFT009
     F*       34      SWIFT 2009 Feature is switched on                                       CSW209
      *  55    - Notified Delivery Amount is not zero.                    CEU006
      *  56    - Pay Delivery Amount is not zero.                         CEU006
     F*       70      Profit Centres In Use Flag                          S01414
      *       77      Switchable feature CFT014 is installed.             CFT014
      *       88      Switchable feature CEU006 is installed.             CFT014
     F*       89      GENERAL WORK INDICATOR
     F********98******ZSYSTM,*DATE*FORMAT*MMDDYY*IF*ON.*                  S01117
     F********99******ZSYSTM,*INSTALLATION*CONTROL*DATA*RECORD*NOT*FOUND.*S01117
     F*       98      SYSTEM, DATE FORMAT MMDDYY IF ON.                   S01117
     F*       99      SYSTEM, INSTALLATION CONTROL DATA RECORD NOT FOUND. S01117
     F**
     F*     U7 & U8   DATABASE ERROR, REQUIRED RECORDS NOT FOUND.
     F*     U8 ONLY   FILE CONTROL ERROR
     F*****************************************************************
     F/EJECT
     F*NOTPY***IP**E***********K********DISK                              S01117
     FNOTPYBB IP  E           K        DISK                               S01117
     F                                              KINFSR FILESR
     FOTPAYXL0IF  E           K        DISK                               CFT009
     F                                              KINFSR FILESR         CFT009
     FFTPCHGL0IF  E           K        DISK                               CFT009
     F                                              KINFSR FILESR         CFT009
     FOTPAYXL2IF  E           K        DISK                           UC  CFT014
      * Outgoing Payments Details Extension retrieval index               CFT014
      *                                                                   CFT014
     FTABFP   IF  E           K        DISK
     F                                              KINFSR FILESR
     F            TABTB20F                          KIGNORE
     F            TABTG20F                          KIGNORE
     F************TABLETJF                          KIGNORE               S01195
     F            TABLETPF                          KIGNORE
     F*CLINT***IF  E           K        DISK                              S01435
     F*********                                     KINFSR FILESR         S01435
     F*********   CLINTCAF                          KIGNORE               S01435
     F*********   CLINTCBF                          KIGNORE               S01435
     F*ACNUMA**IF  E           K        DISK                              S01435
     F*********                                     KINFSR FILESR         S01435
     F*********   ACCNTABF                          KRENAMEACNUMAR        S01435
      *
     FMUSER   IF  E           K        DISK                               S01435
     F*FT0515P2O***E********************PRINTER                           S01117
     FFT0515AUO   E                    PRINTER      KINFDS SPOOLU         S01117
     F                                              KINFSR FILESR         S01117
     F*FT0515P1O***E********************PRINTER                           S01117
     FFT0515P1O   E                    PRINTER      KINFDS SPOOL1     UC  S01117
     F                                              KINFSR FILESR         S01117
     F/COPY WNCPYSRC,FT0515F001
     E                    CPY@    1   1 80
     E                    WA1        15  1               UGFRMT SR.ARRY
     E                    WA2        20  1               UGFRMT SR.ARRY
     E                    ZYDY    4   4  4 0             ZDATE1/2 SR.ARRAY
     E                    ZMDY   13  13  3 0             ZDATE1/2 SR.ARRAY
     E                    ZMNM   12  12  3               ZDATE2 SR. ARRAY
      *                                                                   CEU006
     E                    DESC    1  13 30                                CFT009
     E/COPY ZSRSRC,ZSEDITZ1                                               CEU006
     E/EJECT
     I*                                                                   S01117
     I** RENAME OF OTPAYDDF FORMAT IN NOTPYBB TO AVOID CORRUPTION         S01117
     I** FROM ACNUMA                                                      S01117
     I*                                                                   S01117
     IOTPAYDDF                                                            S01117
     I              BRCA                            BRCH                  S01117
      **************                                                      S01435
     I**************                                                S01414S01435
     I**Rename*of*ACNUMA Profit Centre to avoid overwriting         S01414S01435
     I**************                                                S01117S01435
     I*ACNUMAR******                                                S01117S01435
     I**************PRFC                            ACPRFC          S01414S01435
     I**************                                                S01414S01435
      *
      **  DATA AREA LDA - USED IN THE EVENT OF DATABASE ERRORS
      *
     I*  DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
     ICPYR@#      DS
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
     ILDA         DS                            256
     I**************************************134 138 DBFILE                S01194
     I**************************************139 167 DBKEY                 S01194
     I**************************************168 175 DBPGM                 S01194
     I**************************************176 177 DBASE                 S01194
     I                                      134 141 DBFILE                S01194
     I                                      142 170 DBKEY                 S01194
     I                                      171 180 DBPGM                 S01194
     I                                      181 183 DBASE                 S01194
      *
      *     DATA AREA FOR PROGRAM STATUS DISK AREA
     IPSDS       SDS
     I                                      244 253 WID
     I                                      254 263 USRID
     I                                     *PROGRAM @PGM
     I                                      201 208 @FILE
     ISDCURR    E DSSDCURRPD                                              CFT014
     I*External Data structure for currencies file                        CFT014
      *
      *****************************************************************
      *  Data Structures for addresses.
      *
      ** OUT data structures (printout)
      *
      ** Receivers correspondent
     IP1RCDS      DS
     I                                        1  35 P1RCO1
     I                                       36  70 P1RCO2
     I                                       71 105 P1RCO3
     I                                      106 140 P1RCO4
     I                                      141 175 P1RCO5
      *
      ** Ordering Customer
     IP1ORDS      DS
     I                                        1  35 P1ORC1
     I                                       36  70 P1ORC2
     I                                       71 105 P1ORC3
     I                                      106 140 P1ORC4
     I                                      141 175 P1ORC5
      *
      ** Receiving Bank
     IP1DSDS      DS
     I                                        1  35 P1DST1
     I                                       36  70 P1DST2
     I                                       71 105 P1DST3
     I                                      106 140 P1DST4
     I                                      141 175 P1DST5
      *
      ** Account with Bank
     IP1ACDS      DS
     I                                        1  35 P1ACB1
     I                                       36  70 P1ACB2
     I                                       71 105 P1ACB3
     I                                      106 140 P1ACB4
     I                                      141 175 P1ACB5
      *
      ** Beneficiary Customer
     IP1BNDS      DS
     I                                        1  35 P1BNC1
     I                                       36  70 P1BNC2
     I                                       71 105 P1BNC3
     I                                      106 140 P1BNC4
     I                                      141 175 P1BNC5
      *                                                                   S01435
      ** Senders correspondent                                            S01435
     IP1SNDS      DS                                                      S01435
     I                                        1  35 P1SNC1                S01435
     I                                       36  70 P1SNC2                S01435
     I                                       71 105 P1SNC3                S01435
     I                                      106 140 P1SNC4                S01435
     I                                      141 175 P1SNC5                S01435
      *                                                                   S01435
      ** Ordering Bank                                                    S01435
     IP1OBDS      DS                                                      S01435
     I                                        1  35 P1ORB1                S01435
     I                                       36  70 P1ORB2                S01435
     I                                       71 105 P1ORB3                S01435
     I                                      106 140 P1ORB4                S01435
     I                                      141 175 P1ORB5                S01435
      *                                                                   S01435
      ** Intermediary Bank                                                S01435
     IP1INDS      DS                                                      S01435
     I                                        1  35 P1INB1                S01435
     I                                       36  70 P1INB2                S01435
     I                                       71 105 P1INB3                S01435
     I                                      106 140 P1INB4                S01435
     I                                      141 175 P1INB5                S01435
      *
      *
      ** IN data structures (file)
      *
      ** Receivers correspondent
     IRCINDS      DS
     I                                        1  35 RCO1
     I                                       36  70 RCO2
     I                                       71 105 RCO3
     I                                      106 140 RCO4
     I                                      141 175 RCO5
      *
      ** Ordering Customer
     IORINDS      DS                            175
     I                                        1  35 ORC1
     I                                       36  70 ORC2
     I                                       71 105 ORC3
     I                                      106 140 ORC4
     I                                      141 175 ORC5                                      CFT032
      *
      ** Receiving Bank
     IDSINDS      DS                            175
     I                                        1  35 DST1
     I                                       36  70 DST2
     I                                       71 105 DST3
     I                                      106 140 DST4
      *
      ** Account with Bank
     IACINDS      DS
     I                                        1  35 ACB1
     I                                       36  70 ACB2
     I                                       71 105 ACB3
     I                                      106 140 ACB4
     I                                      141 175 ACB5
      *
      ** Beneficiary Customer
     IBNINDS      DS
     I                                        1  35 BNC1
     I                                       36  70 BNC2
     I                                       71 105 BNC3
     I                                      106 140 BNC4
     I                                      141 175 BNC5
      *                                                                   S01435
      ** Intermediary Bank                                                S01435
     IININDS      DS                                                      S01435
     I                                        1  35 INB1                  S01435
     I                                       36  70 INB2                  S01435
     I                                       71 105 INB3                  S01435
     I                                      106 140 INB4                  S01435
     I                                      141 175 INB5                  S01435
      *****************************************************************
      *  Data Structure for GETADD.
      *
      *
      ** Client name & address
     ICLINTD      DS
     I                                        1  35 CNA1
     I                                       36  70 CNA2
     I                                       71 105 CNA3
     I                                      106 140 CNA4
      *
      ** Split name into components.
     IXNAMDS      DS                            175
     I                                        1  35 DS1T35
     I                                        1  100DS1T10
     I                                        1   60DS1T6
     I                                        1   5 DS1T5
     I**********                              1  12 XACCT                              S01435 CGL029
     I**********                             13  15 XBRCA                              S01435 CGL029
     I                                        1  18 XACCT                                     CGL029
     I                                       19  21 XBRCA                                     CGL029
      *
      **            address lines 2 - 5.
     I                                       36 175 XADDS
      *
      ** to define XTYPE.
     IXTYPE       DS                              1
      *****************************************************************
      *
      ** Table key (using CCY,Nostro).
     IKYTABL      DS                             12
     I                                        1   2 CONS70
      *
     I** INFDS for P1 file .                                              S01117
     ISPOOL1      DS                                                      S01117
     I                                       83  90 SFIL1                 S01117
     I                                    B 123 1240SFNUM1                S01117
     I** INFDS for AU file                                                S01117
     ISPOOLU      DS                                                      S01117
     I                                       83  90 SFILU                 S01117
     I                                    B 123 1240SFNUMU                S01117
      ** FT Cover Message Fields Information                                                  CSW209
     IOTPAYX    E DSOTPAYXPD                                                                  CSW209
      **                                                                                      CSW209
      ** Ordering Customer (Cover)                                                            CSW209
     I                                      8761050 WPCOC1                                    CSW209
      ** Ordering Institution (Cover)                                                         CSW209
     I                                     10521226 WPCOB1                                    CSW209
      ** Intermediary Institution (Cover)                                                     CSW209
     I                                     12281402 WPCIB1                                    CSW209
      ** Account with Institution (Cover)                                                     CSW209
     I                                     14041578 WPCAB1                                    CSW209
      ** Beneficiary Customer (Cover)                                                         CSW209
     I                                     15801754 WPCBC1                                    CSW209
      ** Remittance Information (Cover)                                                       CSW209
     I                                     17551894 WPCDP1                                    CSW209
      ** Sender to Receiver Information (Cover B)                                             CSW209
     I                                     18952104 WPCBB1                                    CSW209
      ** Instructed Currency (Cover)                                                          CSW209
     I                                     21052107 WPCICY                                    CSW209
      ** Instructed Amount (Cover)                                                            CSW209
     I                                     210821210WPCIAM                                    CSW209
      ** Sender to Receiver Information (Cover A)                                             CSW209
     I                                     21222331 WPOCB1                                    CSW209
      *                                                                                       CSW209
     I*                                                                   S01117
     IDSSDY     E DSDSSDY                                                 S01435
     I*                                                                                     BUG24029
     IDSLDY     E DSDSLDY                                                                   BUG24029
     I*                                                                   S01435
     IDSFDY     E DSDSFDY                                                 S01194
     I*                                                                   S01194
     ISDGELR    E DSSDGELRPD                                              S01194
     ISDBRCH    E DSSDBRCHPD                                              S01194
     ISDFTFR    E DSSDFTFRPD                                              S01435
      *                                                                   S01435
      * Funds Transfer Details *                                          S01435
      *                                                                   S01435
     ISDCUST    E DSSDCUSTPD                                              S01435
     I              QQDFAC                          QQDFC1                                    CGL029
      *                                                                   S01435
      * Customer Details       *                                          S01435
      *                                                                   S01435
     ISCSARD    E DSSCSARDPD                                              S01494
     I** External data structure for SAR file details                     S01494
      /EJECT                                                              S01435
     IW8FT        DS                            128                       S01435
      *                                                                   S01435
      * Address data structure                                            S01435
      *                                                                   S01435
      * Currency                                                          S01435
     I                                        1   3 W8CCY                 S01435
      * Settlement Type                                                   S01435
     I                                        4   5 W8STMT                S01435
      * Mandatory Text - convert BIC identifiers                          S01435
     I                                        6   6 W8MTXT                S01435
      * Message Tag                                                       S01435
     I                                        7  11 W8MTAG                S01435
      * Construct of data in field                                        S01435
     I                                       12  12 W8TYPE                S01435
      * Number of Lines available                                         S01435
     I                                       13  140W8NLIN                S01435
      * Network and Message Type                                          S01435
     I                                       15  20 W8NWRK                S01435
     I                                       21  23 W8MTPY                S01435
      * Calling Program                                                   S01435
     I                                       24  33 W8CPGM                S01435
      * Action *PRINT/*ENQ/*MSG GEN                                       S01435
     I                                       34  41 W8ACT                 S01435
      * Critical reporting - Database error if 'Y'                        S01435
      * If no BIC directory and BIC entered no error                      S01435
     I                                       42  42 W8CRIT                S01435
      * Force Midas Address - where possible                              S01435
     I                                       43  43 W8MADD                S01435
      * If Retail get first address from account                          S01435
     I                                       44  44 W8RTAD                S01435
      * Alternative Address                                               S01435
     I                                       45  45 W8ALTN                S01435
      * Address type selected in W0MSG                                    S01435
     I                                       46  46 W8ADTP                S01435
      *                                                                   S01435
     IDSMTR       DS                                                      S01435
      *                                                                   S01435
      *  Define fields for message transalation                           S01435
      *                                                                   S01435
     I                                        1 132 #MSDTA                S01435
     I                                       15  30 #MPREF                S01435
     I                                    P   1   20#MPART                S01435
     I                                      133 264 #MSTX1                S01435
     I#MSTX2      DS                                                      S01435
     I                                        1 256 #MSTXA                S01435
     I                                      257 512 #MSTXB                S01435
     I/COPY WNCPYSRC,FT0515I001
      *                                                                   CEU006
     I/COPY ZSRSRC,ZSEDITZ2                                               CEU006
      *                                                                                       CFT032
      ** Data Structure for Nostro Details                                                    CFT032
     ISDNOST    E DSSDNOSTPD                                                                  CFT032
     I              QQACCD                          WQACCD                                    CFT032
      *                                                                                       CFT032
      ** Data Structure for Counterparty Nostros                                              CFT032
     ISDCNST    E DSSDCNSTPD                                                                  CFT032
      *                                                                                       CFT032
      ** Data Structure for Counterparty Nostros                                              CFT032
     IMEBICD    E DSMEBICDPD                                                                  CFT032
      *                                                                                       CFT032
      **  Data Structure for Bank Details Access Program                                      CFT032
     ISDBANK    E DSSDBANKPD                                                                  CFT032
      *                                                                                       CFT032
      **  Data Structure for Additional Cust Details Access Program                           CSW207
     ISDNAHO    E DSSDNAHOPD                                                                  CSW207
      *                                                                                       CSW207
     IWCDET       DS                             24                                           CFT032
     I                                        1   6 WDCNUM                                    CFT032
     I                                        7   9 WDCCY                                     CFT032
     I                                       10  190WDACOD                                    CFT032
     I                                       20  210WDACSQ                                    CFT032
     I                                       22  24 WDBRCA                                    CFT032
      *                                                                                       CFT032
     IWACCN       DS                            573                                           CFT032
     I                                        2   7 WWCNUM                                    CFT032
     I                                        8  10 WWCCY                                     CFT032
     I                                       11  140QQACOD                                    CFT032
     I                                       15  160WWACSQ                                    CFT032
     I                                       23  25 WWBRCA                                    CFT032
     I                                      554 5630WWACOD                                    CFT032
      *
      *****************************************************************
      /EJECT
     C                     MOVEACPY@      BIS@   80
     C           *LIKE     DEFN DBKEY     @KEY
     C           *LIKE     DEFN DBASE     @ASE
      *****************************************************************
      *                 AA-MAINLINE-PROCESSING                        *
      *                                                               *
      *  FUNCTION : TO CONTROL THE PROCESSING OF EACH RECORD READ VIA *
      *             THE LOGIC CYCLE.                                  *
      *                                                               *
      *  CALLS :    CAINIT                                            *
      *             CCDETL                                            *
      *             CELAST                                            *
      *             GLZADD                                            *
      *                                                               *
      *  CALLED BY: NONE                                              *
      *                                                               *
      *****************************************************************
      *
      ** SAVE FIELDS FROM INPUT FILES WHICH MAY BE OVERWRITTEN BY OTHER
      ** FILE ACCESSES
      *
     C                     MOVELRECI      OTRECI
     C                     Z-ADDLCD       OTLCD
     C                     MOVELCHTP      OTCHTP
      *
      ** PERFORM INITIAL PROCESSING IF FIRST CYCLE **
      *
     C           *IN20     IFEQ '0'
     C                     EXSR CAINIT
     C                     END
     C*                                                                   S01117
     C           *IN26     IFEQ '1'                                       S01117
     C                     MOVE ORBR      BRANCH  3                       S01117
     C                     ELSE                                           S01117
     C                     MOVE BRCH      BRANCH                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C**   If multi branched....                                          S01117
     C**   Check branch code is valid...if so,set up 1st branch fields    S01117
     C*                                                                   S01117
     C           *IN22     IFEQ '1'                        B001           S01117
     C**********           CALL 'AOBRCHR0'                                S01194              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM BRANCH    @BRCD   3                       S01194
     C********** SDBRCH    PARM SDBRCH    DSFDY                           S01194              CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANKS                    B002           S01194
     C                     MOVELBRANCH    WDBKEY           ***************S01194
     C                     MOVEL'SDBRCHPD'WDBFIL           * DB ERROR 10 *S01194
     C                     MOVEL'010'     WDBASE           ***************S01194
     C                     EXSR UEABRT                                    S01194
     C                     ELSE                                           S01194
     C                     MOVE BRANCH    P1BRC1                          S01117
     C                     MOVE A8BRNM    P1BRNM                          S01117
     C*                                                                   S01117
     C*                                                                   S01117
     C** Set up 2nd branch fields with originating branch                 S01117
     C*                                                                   S01117
     C           *IN26     IFEQ '0'                        B003           S01117
     C           *IN23     IFEQ '1'                        B004           S01117
     C                     MOVE ORBR      KBRCH   3                       S01117
     C                     EXSR AOBRC2                                    S01117
     C                     MOVE KBRCH     P1BRC2                          S01117
     C                     MOVE A8BRNM    P1BNM2                          S01117
     C                     END                             E004           S01117
     C*                                                                   S01117
     C** Else , set up with booking branch                                S01117
     C*                                                                   S01117
     C                     ELSE                                           S01117
     C                     MOVE BRCH      KBRCH                           S01117
     C                     EXSR AOBRC2                                    S01117
     C                     MOVE KBRCH     P1BRC2                          S01117
     C                     MOVE A8BRNM    P1BNM2                          S01117
     C                     END                             E003           S01117
     C*                                                                   S01117
     C                     END                             E002           S01117
     C                     END                             E001           S01117
     C*                                                                   S01117
     C*                                                                   S01117
     C** If single branch report requested and branch reading has         S01117
     C** changed to another,terminate program.                            S01117
     C*                                                                   S01117
     C           @RLEV     IFEQ 'B'                                       S01117
     C           @RENT     ANDNE'ALL'                                     S01117
     C           BRANCH    ANDNE@RENT                                     S01117
     C                     SETON                     24                   S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C           *IN24     IFEQ '0'                                B01    S01117
     C           STBRCA    IFEQ *BLANKS                                   S01117
     C           @RLEV     OREQ 'B'                                       S01117
     C           STBRCA    ANDNEBRANCH                                    S01117
     C           @RENT     ANDEQ'ALL'                                     S01117
     C*                                                                   S01117
     C** Set up entity for call to ZSFILE                                 S01117
     C*                                                                   S01117
     C           @RLEV     IFEQ 'S'                                       S01117
     C                     MOVE *BLANKS   ZSENT   3                       S01117
     C                     ELSE                                           S01117
     C           @RLEV     IFEQ 'B'                                       S01117
     C           @RENT     ANDEQ'ALL'                                     S01117
     C                     MOVE BRANCH    ZSENT                           S01117
     C                     ELSE                                           S01117
     C                     MOVE @RENT     ZSENT                           S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C**  If @RENT is 'ALL' and a change of branch is detected,           S01117
     C**  write end of report for branch.                                 S01117
     C*                                                                   S01117
     C           BRANCH    IFNE STBRCA                                    S01117
     C           @RENT     ANDEQ'ALL'                                     S01117
     C           *IN21     ANDEQ'1'                                       S01117
     C                     WRITEP1EOR                                     S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C** Generate new spool file                                          S01117
     C*                                                                   S01117
     C                     CLOSEFT0515P1                                  S01117
     C                     OPEN FT0515P1                                  S01117
     C                     Z-ADD0         PAGE                            S01117
     C*                                                                   S01494
     C           *IN27     IFEQ '0'                                       S01494
     C                     MOVELSFIL1     SFILP                           S01494
     C                     ELSE                                           S01494
     C                     MOVEL'FT0516P1'SFILP                           S01494
     C                     END                                            S01494
     C*                                                                   S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           @RSEQ                           S01117
     C                     PARM           ZSENT                           S01117
     C***********          PARM SFIL1     SFILP  10                S01117 S01494
     C                     PARM           SFILP  10                       S01494
     C                     PARM SFNUM1    SPLNO   60                      S01117
     C                     PARM *BLANKS   ZERR    1                       S01117
     C*                                                                   S01117
     C           ZERR      IFNE *BLANKS                                   S01117
     C                     SETON                     U7U8LR               S01117
     C           *LOCK     IN   LDA                                       S01194
     C                     MOVEL'FT0515'  DBPGM                           S01194
     C           *IN27     IFEQ '0'                                       S01494
     C                     MOVEL'FT515AU' DBKEY            ***************S01194
     C                     ELSE                                           S01494
     C                     MOVEL'FT516AU' DBKEY                           S01494
     C                     END                             ***************S01494
     C                     MOVEL'ZSFILE'  DBFILE           * DB ERROR 11 *S01194
     C                     MOVEL'011'     DBASE            ***************S01194
     C                     OUT  LDA                                       S01194
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C** Move new branch to store value                                   S01117
     C*                                                                   S01117
     C                     MOVE BRANCH    STBRCA  3                       S01117
     C                     END                                            S01117
     C*                                                                   S01117
      *
      ** FOR DETAIL RECORDS :
      ** WRITE A PAGE ON THE DETAIL REPORT IF REPORT TYPE IS 'LIST'
      ** OR REPORT TYPE IS 'AUDIT LIST' & LAST CHANGE DATE IS EQUAL
      ** TO THE SYSTEM DATE
      ** ... AND IF THE TRANSACTION IS FOR OUTGOING PAYMENTS, SKIP        S01494
      **     REPORTING OF PAYMENTS WITH TYPE 'RP'                         S01494
      *
     C           *IN27     IFEQ '0'                                       S01494
     C           PYTP      ANDNE'RP'                                      S01494
     C           *IN27     OREQ '1'                                       S01494
     C           PYTP      ANDEQ'RP'                                      101565
     C           PARM1     IFNE 'A'                         -NOT AUDIT
     C                     EXSR CCDETL                       LIST.
     C                     ELSE
     C           OTLCD     IFEQ RUND                        -AUDIT LIST
     C                     EXSR CCDETL
     C                     END
     C                     END
     C                     END                                            S01494
      *
      ** If CFT009 is on print charges in new record format               CFT009
     C           *IN30     IFEQ *ON                                       CFT009
      *                                                                   CFT009
      ** Access Extension File if CFT009 is on                            CFT009
      *                                                                   CFT009
     C           PREF      CHAINOTPAYXL0             89                   CFT009
      *                                                                   CFT009
     C                     EXSR CHARGE                                    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** ACCUMULATE VALUES FOR CONTROL CHECK USING SYSTEM SUBROUTINE
      ** GLZADD
      *
     C*********************ADD  1         P2CLNO                          S01117
     C                     ADD  1         AUCLNO                          S01117
     C                     MOVE SMAM      ZZAMT
     C                     EXSR GLZADD
     C*                                                                   S01117
     C                     END                             E01            S01117
     C*                                                                   S01117
     C           *IN24     IFEQ '1'                                       S01117
     C                     SETON                     LR                   S01117
     C                     END                                            S01117
      *
      ** PERFORM CONTROL REPORT CHECKS IF TRAILER RECORD
      *
     CLR                   EXSR CELAST
      *
      ** END OF MAINLINE PROCESSING
      *
     C/EJECT
     C           CAINIT    BEGSR
      *          ******    *****
      *
      *****************************************************************
      *                 CA-INITIAL-PROCESSING                         *
      *                                                               *
      *  FUNCTION : TO PERFORM PROCESSING ONLY REQUIRED ONCE,ON FIRST *
      *             CYCLE OF PROGRAM.                                 *
      *                                                               *
      *  CALLS :    UATBCN                                            *
      *             UEABRT                                            *
      **************ZSYSTM                                            *   S01117
      *             SYSTEM                                            *   S01117
      *                                                               *
      *  CALLED BY: AAMAIN                                            *
      *                                                               *
      *****************************************************************
      *
      ** DECLARE ENTRY PARAMETER - REPORT TYPE
      *
     C           *ENTRY    PLIST
     C                     PARM           PARM1   1
     C                     PARM           @RSEQ   5                       S01117
     C                     PARM           @RLEV   1                       S01117
     C                     PARM           @RENT   3                       S01117
     C                     PARM           WRNTP   7                       S01494
      *                                                                                       CFT032
      ** Parameter list for AONOSTR0                                                          CFT032
      *                                                                                       CFT032
     C           #ANOST    PLIST                                                              CFT032
     C                     PARM *BLANK    @RTCD                                               CFT032
     C                     PARM '*KEY   ' @OPTN                                               CFT032
     C                     PARM *BLANK    @KEYA   6                                           CFT032
     C                     PARM           @KEYB   3                                           CFT032
     C                     PARM *BLANK    @KEYC  10                                           CFT032
     C                     PARM *BLANK    @KEYD   2                                           CFT032
     C                     PARM           @KEYE   2                                           CFT032
     C                     PARM *BLANKS   @KEYG   3                                           CFT032
     C                     PARM *BLANKS   @KEYH  10                                           CFT032
     C                     PARM *BLANKS   @KEYI   1                                           CFT032
     C           SDNOST    PARM SDNOST    DSFDY                                               CFT032
      *                                                                                       CFT032
      ** Parameter list for AOACCTR0                                                          CFT032
      *                                                                                       CFT032
     C           #AACCT    PLIST                                                              CFT032
     C                     PARM *BLANKS   @RTCD                                               CFT032
     C                     PARM '*KEY'    @OPTN                                               CFT032
     C                     PARM           @RETL  10                                           CFT032
     C                     PARM           @CNNM   6                                           CFT032
     C                     PARM           @CUCD   3                                           CFT032
     C                     PARM           @ACCD  10                                           CFT032
     C                     PARM           @ACSQ   2                                           CFT032
     C                     PARM           @BRC    3                                           CFT032
     C           WACCN     PARM WACCN     DSSDY                                               CFT032
      *                                                                                       CFT032
      ** Call Access Program for Bank Details                                                 CFT032
      *                                                                                       CFT032
     C                     CALL 'AOBANKR0'                                                    CFT032
     C                     PARM *BLANKS   @RTCD                                               CFT032
     C                     PARM '*FIRST ' @OPTN                                               CFT032
     C           SDBANK    PARM SDBANK    DSFDY                                               CFT032
      *                                                                                       CFT032
      ** Handle Database Error                                                                CFT032
      *                                                                                       CFT032
     C           @RTCD     IFNE *BLANK                                                        CFT032
     C                     MOVEL'SDBANKPD'WDBFIL                                              CFT032
     C                     MOVEL'*FIRST ' WDBKEY                                              CFT032
     C                     MOVEL'29'      WDBASE                                              CFT032
     C                     EXSR UEABRT                                                        CFT032
     C                     ENDIF                                                              CFT032
     C*                                                                   S01117
     C** Set on indicator to display originating branch                   S01117
     C*                                                                   S01117
     C           PARM1     IFEQ 'O'                                       S01117
     C                     SETON                     26                   S01117
     C                     END                                            S01117
     C*                                                                   S01494
     C** Set on indicator if regular payment                              S01494
     C*                                                                   S01494
     C                     SELEC                                          S01494
     C           WRNTP     WHEQ 'FTM2513'                                 S01494
     C                     MOVE '0'       *IN27                           S01494
     C           WRNTP     WHEQ 'FTM2514'                                 S01494
     C           WRNTP     OREQ 'FTM2517'                                 S01494
     C                     MOVE '1'       *IN27                           S01494
     C           WRNTP     WHEQ 'FTM2518'                                 S01494
     C                     MOVE '1'       *IN26                           S01494
     C                     MOVE '1'       *IN27                           S01494
     C                     ENDSL                                          S01494
      *
      **    Initialize constants .
     C                     MOVE '70'      CONS70
      *
      *
      ** SETUP REPORT HEADING
      *
     C           PARM1     IFEQ 'A'
     C                     MOVEL'AUDIT'   P1HEAD
     C                     MOVE 'LIST'    P1HEAD
     C                     MOVEL'~~~~~'   P1DASH
     C                     MOVE '~~~~~'   P1DASH
     C                     ELSE
     C                     MOVEL'LIST'    P1HEAD
     C                     MOVEL'~~~~'    P1DASH
     C                     END
      *
      ** DECLARE SIMILAR FIELDS
      *
     C           *LIKE     DEFN DBFILE    WDBFIL
     C           *LIKE     DEFN DBKEY     WDBKEY
     C           *LIKE     DEFN DBASE     WDBASE
      *
     C           *LIKE     DEFN RECI      OTRECI
     C           *LIKE     DEFN LCD       OTLCD
     C           *LIKE     DEFN CHTP      OTCHTP
      *
      ***CALL*ZSYSTM*TO*ACCESS*I.C.D.R.*1*ON*TABLE*FILE*                  S01117
      ** CALL SYSTEM TO ACCESS I.C.D.R. 1 ON TABLE FILE                   S01117
      *
     C*********************EXSR ZSYSTM                                    S01117
     C                     EXSR SYSTEM                                    S01117
      *
      ** CHECK IF DATABASE ERROR OCCURRED
      *
     C           *IN99     IFEQ '1'
     C                     MOVEL'TABLE'   WDBFIL
     C                     MOVELZTABKY    WDBKEY
     C                     MOVEL'01'      WDBASE
     C                     EXSR UEABRT                     *ABORT PGM*
     C                     END
      *
      ** SETUP REPORT TITLES & RUN-DATES
      *
     C                     MOVELTITL      P1TITL
     C*********************MOVELTITL      P2TITL                          S01117
     C                     MOVELTITL      AUTITL                          S01117
     C                     MOVELRUNA      P1DATE
     C*********************MOVELRUNA      P2DATE                          S01117
     C                     MOVELRUNA      AUDATE                          S01117
      *
     C**********           MOVE *BLANKS   BLNK10 10                                           CGL029
     C**********           MOVE *BLANKS   BLNK2   2                                           CGL029
     C                     MOVE *BLANKS   BLNK10 16                                           CGL029
     C                     MOVE *BLANKS   BLNK2   8                                           CGL029
      *
      ** CALL UATBCN TO ACCESS I.C.D.R. 2 ON TABLE FILE
      *
     C                     MOVEL*BLANKS   ZTABKY
     C                     MOVEL'01'      ZTABKY
     C                     MOVE '11'      ZTABKY
     C                     EXSR UATBCN
      *
      ** CHECK IF DATABASE ERROR OCCURRED
      *
     C           *IN89     IFEQ '1'
     C                     MOVEL'TABLE'   WDBFIL
     C                     MOVELZTABKY    WDBKEY
     C                     MOVEL'02'      WDBASE
     C                     EXSR UEABRT                     *ABORT PGM*
     C                     END
     C*                                                                   S01414
     C* Move the conditional IF so that AOGELRR0 is always called.        S01414
     C*                                                                   S01414
     C***If*multi*branched*Set*on*indicator for branch fields       S01117S01414
     C********************                                          S01117S01414
     C***********MBIN***** IFEQ 'Y'                        B001     S01117S01414
     C******************** SETON                     22             S01117S01414
     C*                                                                   S01117
     C**  Access SDGELRPD for originating branch used flag                S01117
     C**                  and Profit Centres In Use Flag                  S01414
     C*                                                                   S01117
     C**********           CALL 'AOGELRR0'                                S01194              CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM '*MSG  '  P@RTCD  7                       S01194
     C                     PARM '*FIRST'  P@OPTN  7                       S01194
     C********** SDGELR    PARM SDGELR    DSFDY                           S01194              CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     MOVEL'SDGELRPD'WDBFIL           ***************S01194
     C                     MOVELP@OPTN    WDBKEY           * DB ERROR 12 *S01194
     C                     MOVEL'12'      WDBASE           ***************S01194
     C                     EXSR UEABRT                                    S01194
     C                     END                                            S01194
     C*                                                             S01117S01414
     C**  If multi branched set on 22 to display branch fields      S01117S01414
     C*                                                             S01117S01414
     C           MBIN      IFEQ 'Y'                                 S01117S01414
     C                     SETON                     22             S01117S01414
     C*                                                                   S01194
     C**  If Originating Branch Used flag is on,set on                    S01194
     C**  indicator 23                                                    S01194
     C*                                                                   S01194
     C           BKOBRU    IFEQ 'Y'                                       S01194
     C                     SETON                     23                   S01194
     C                     END                                            S01194
     C                     END                             E001           S01117
      *                                                                   S01414
      *  Check if Profit Centres are used and set screen attributes       S01414
      *                                                                   S01414
     C           BKPRCU    IFEQ 'Y'                                       S01414
     C                     MOVE '1'       *IN70                           S01414
     C                     END                                            S01414
      *                                                                   S01435
      ** Read SDFTFRPD                                                    S01435
      *                                                                   S01435
     C                     CALL 'AOFTFRR0'             90                 S01435
     C                     PARM *BLANKS   P@RTCD  7        B:Return code  S01435
     C                     PARM '*FIRST ' P@OPTN  7        I:Option       S01435
     C           SDFTFR    PARM SDFTFR    DSFDY                           S01435
      *                                                                   S01435
      *  If return with an error (LR seton in called program) then        S01435
      *  process for database error.                                      S01435
      *                                                                   S01435
     C           *IN90     IFEQ '1'                                       S01435
     C           P@RTCD    OREQ '*ERROR*'                                 S01435
     C                     MOVEL'SDFTFRPD'WDBFIL           ***************S01435
     C                     MOVELP@OPTN    WDBKEY           * DB ERROR 16 *S01435
     C                     MOVEL'50'      WDBASE           ***************S01435
     C                     EXSR UEABRT                                    S01435
     C                     END                                            S01435
      *                                                                   S01435
      * Get message text for Account with Bank field                      S01435
      *                                                                   S01435
     C                     CALL 'MEC1150'              9090               S01435
     C                     PARM 'FTM2350 '#MSGID  7                       S01435
     C                     PARM 'FTUSRMSG'#MSGF  10                       S01435
     C                     PARM           #MSDTA                          S01435
     C                     PARM *BLANKS   #MSTX1                          S01435
     C                     PARM *BLANKS   #MSTX2                          S01435
      *                                                                   S01435
     C                     MOVEL#MSTX1    #IMSG  35                       S01435
      *
      ** CALL UATBCN TO ACCESS CURRENCY RECORD FOR BASE CURRENCY
      *
     C                     MOVEL*BLANKS   ZTABKY
     C                     MOVEL'20'      ZTABKY
     C                     MOVELBCCY      WA4     4
     C                     MOVE '1'       WA4
     C                     MOVE WA4       ZTABKY
     C                     EXSR UATBCN
      *
      ** CHECK IF DATABASE ERROR OCCURRED
      *
     C           *IN89     IFEQ '1'
     C                     MOVEL'TABLE'   WDBFIL
     C                     MOVELZTABKY    WDBKEY
     C                     MOVEL'03'      WDBASE
     C                     EXSR UEABRT                     *ABORT PGM*
     C                     END
      *
      ** STORE NUMBER OF DECIMAL PLACES FOR BASE CURRENCY
      *
     C                     Z-ADDCDP       SVBCDP  10
      *                                                                   S01435
      ** Call UATBCN to Access local currency record                      S01435
      *                                                                   S01435
     C                     MOVEL*BLANKS   ZTABKY                          S01435
     C                     MOVEL'20'      ZTABKY                          S01435
     C                     MOVELLOCY      WA4                             S01435
     C                     MOVE '1'       WA4                             S01435
     C                     MOVE WA4       ZTABKY                          S01435
     C                     EXSR UATBCN                                    S01435
      *                                                                   S01435
      ** Check if database error occurred                                 S01435
      *                                                                   S01435
     C           *IN89     IFEQ '1'                                       S01435
     C                     MOVEL'TABLE'   WDBFIL                          S01435
     C                     MOVELZTABKY    WDBKEY                          S01435
     C                     MOVEL'51'      WDBASE                          S01435
     C                     EXSR UEABRT                     *ABORT PGM*    S01435
     C                     END                                            S01435
      *                                                                   S01435
      ** Store number of decimal places for base currency                 S01435
      *                                                                   S01435
     C                     Z-ADDCDP       SVLCDP  10                      S01435
     C*                                                                   S01494
     C** Access SAR details file to determine if S01494 is switched ON    S01494
     C*                                                                   S01494
     C                     MOVE '0'       *IN28                           S01494
     C                     CALL 'AOSARDR0'                                S01494
     C                     PARM *BLANKS   @RTCD   7                       S01494
     C                     PARM '*VERIFY' @OPTN   7                       S01494
     C                     PARM 'S01494'  @SARD   6                       S01494
     C           SCSARD    PARM SCSARD    DSFDY                           S01494
     C*                                                                   S01494
     C** If core feature is switched ON, set a variable field to          S01494
     C** condition the rest of the processing                             S01494
     C*                                                                   S01494
     C           @RTCD     IFEQ *BLANKS                                   S01494
     C                     MOVE '1'       *IN28                           S01494
     C                     ELSE                                           S01494
     C*                                                                   S01494
     C** else, database error (return code other than *NRF)               S01494
     C*                                                                   S01494
     C           @RTCD     IFNE '*NRF   '                                 S01494
     C                     MOVEL'SCSARDPD'WDBFIL                          S01494
     C                     MOVEL'*VERIFY' WDBKEY                          S01494
     C                     MOVEL'40'      WDBASE                          S01494
     C                     EXSR UEABRT                     *ABORT PGM*    S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C*                                                                   S01499
     C** Access SAR details file to determine if S01499 is switched ON    S01499
     C*                                                                   S01499
     C                     MOVE '0'       *IN29                           S01499
     C                     CALL 'AOSARDR0'                                S01499
     C                     PARM *BLANKS   @RTCD   7                       S01499
     C                     PARM '*VERIFY' @OPTN   7                       S01499
     C                     PARM 'S01499'  @SARD   6                       S01499
     C           SCSARD    PARM SCSARD    DSFDY                           S01499
     C*                                                                   S01499
     C** If core feature is switched ON, set a variable field to          S01499
     C** condition the rest of the processing                             S01499
     C*                                                                   S01499
     C           @RTCD     IFEQ *BLANKS                                   S01499
     C                     MOVE '1'       *IN29                           S01499
     C                     ELSE                                           S01499
     C*                                                                   S01499
     C** else, database error (return code other than *NRF)               S01499
     C*                                                                   S01499
     C           @RTCD     IFNE '*NRF   '                                 S01499
     C                     MOVEL'SCSARDPD'WDBFIL                          S01499
     C                     MOVEL'*VERIFY' WDBKEY                          S01499
     C                     MOVEL'41'      WDBASE                          S01499
     C                     EXSR UEABRT                     *ABORT PGM*    S01499
     C                     END                                            S01499
     C                     END                                            S01499
     C*                                                                   CFT009
     C** Access SAR details file to determine if CFT009 is switched ON    CFT009
     C*                                                                   CFT009
     C                     MOVE '0'       *IN30                           CFT009
     C                     CALL 'AOSARDR0'                                CFT009
     C                     PARM *BLANKS   @RTCD                           CFT009
     C                     PARM '*VERIFY' @OPTN                           CFT009
     C                     PARM 'CFT009'  @SARD                           CFT009
     C           SCSARD    PARM SCSARD    DSFDY                           CFT009
     C*                                                                   CFT009
     C** If core feature is switched ON, set a variable field to          CFT009
     C** condition the rest of the processing                             CFT009
     C*                                                                   CFT009
     C           @RTCD     IFEQ *BLANKS                                   CFT009
     C                     MOVE '1'       *IN30                           CFT009
     C                     MOVE 'Y'       CFT009  1                       CFT009
     C                     ELSE                                           CFT009
     C*                                                                   CFT009
     C** else, database error (return code other than *NRF)               CFT009
     C*                                                                   CFT009
     C           @RTCD     IFNE '*NRF   '                                 CFT009
     C                     MOVEL'SCSARDPD'WDBFIL                          CFT009
     C                     MOVEL'*VERIFY' WDBKEY                          CFT009
     C                     MOVEL'42'      WDBASE                          CFT009
     C                     EXSR UEABRT                     *ABORT PGM*    CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT014
      ** Access SAR details file to determine if CFT014 is switched ON    CFT014
      *                                                                   CFT014
     C                     MOVE *BLANK    CFT014  1                       CFT014
     C                     CALL 'AOSARDR0'                                CFT014
     C                     PARM *BLANKS   @RTCD                           CFT014
     C                     PARM '*VERIFY' @OPTN                           CFT014
     C                     PARM 'CFT014'  @SARD                           CFT014
     C           SCSARD    PARM SCSARD    DSFDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFEQ *BLANKS                                   CFT014
     C                     MOVE 'Y'       CFT014                          CFT014
     C                     MOVE *ON       *IN77                           CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE '*NRF   '                                 CFT014
     C                     MOVEL'SCSARDPD'WDBFIL                          CFT014
     C                     MOVEL'CFT014'  WDBKEY                          CFT014
     C                     MOVEL'20'      WDBASE                          CFT014
     C                     EXSR UEABRT                                    CFT014
     C                     ELSE                                           CFT014
     C                     MOVE 'N'       CFT014                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** If switchable feature CFT014 is installed, open OTPAYXL2.        CFT014
      *                                                                   CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
     C           CFT009    OREQ 'Y'                                       CFT009
     C                     OPEN OTPAYXL2                                  CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Access SAR details file to determine if CEU006 is switched ON    CFT014
      *                                                                   CFT014
     C                     MOVE *BLANK    CEU006  1                       CFT014
     C                     CALL 'AOSARDR0'                                CFT014
     C                     PARM *BLANKS   @RTCD                           CFT014
     C                     PARM '*VERIFY' @OPTN                           CFT014
     C                     PARM 'CEU006'  @SARD                           CFT014
     C           SCSARD    PARM SCSARD    DSFDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFEQ *BLANKS                                   CFT014
     C                     MOVE 'Y'       CEU006                          CFT014
     C                     MOVE *ON       *IN88                           CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE '*NRF   '                                 CFT014
     C                     MOVEL'SCSARDPD'WDBFIL                          CFT014
     C                     MOVEL'CEU006'  WDBKEY                          CFT014
     C                     MOVEL'021'     WDBASE                          CFT014
     C                     EXSR UEABRT                                    CFT014
     C                     ELSE                                           CFT014
     C                     MOVE 'N'       CEU006                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                                       CSW203
      ** Check if SWIFT Changes 2003 (CSW203) is installed                                    CSW203
      *                                                                                       CSW203
     C                     CALL 'SWIF2003'                                                    CSW203
     C                     PARM *BLANKS   PRTCD   7                                           CSW203
      *                                                                                       CSW203
     C           PRTCD     IFEQ 'CSW2003'                                                     CSW203
     C                     MOVE 'Y'       CSW203  1                                           CSW203
     C                     MOVE *ON       *IN78                                               CSW203
     C                     ELSE                                                               CSW203
     C                     MOVE 'N'       CSW203                                              CSW203
     C                     MOVE *OFF      *IN78                                               CSW203
     C                     ENDIF                                                              CSW203
      *                                                                                       CSW207
      ** Check if SWIFT Changes 2007 (CSW207) is installed                                    CSW207
      *                                                                                       CSW207
     C                     CALL 'SWIF2007'                                                    CSW207
     C                     PARM *BLANKS   PRTCD   7                                           CSW207
      *                                                                                       CSW207
     C           PRTCD     IFEQ 'CSW2007'                                                     CSW207
     C                     MOVE 'Y'       CSW207  1                                           CSW207
     C                     ELSE                                                               CSW207
     C                     MOVE 'N'       CSW207                                              CSW207
     C                     ENDIF                                                              CSW207
      ** Check if SWIFT Changes 2009 (CSW209) is installed                                    CSW209
      *                                                                                       CSW209
     C                     CALL 'SWIF2009'                                                    CSW209
     C                     PARM *BLANKS   PRTCD                                               CSW209
      *                                                                                       CSW209
     C           PRTCD     IFEQ 'CSW2009'                                                     CSW209
     C                     MOVE 'Y'       CSW209  1                                           CSW209
     C                     MOVEL*ON       *IN34                                               CSW209
     C                     ELSE                                                               CSW209
     C                     MOVE 'N'       CSW209                                              CSW209
     C                     MOVEL*OFF      *IN34                                               CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C*                                                                   S01117
     C** SETON SYSTEM LEVEL INDICATOR                                     S01117
     C*                                                                   S01117
     C           @RLEV     IFEQ 'S'                                       S01117
     C                     SETON                     25                   S01117
     C                     END                                            S01117
      *
      ** SETON INDICATOR TO SHOW THAT INITIAL PROCESSING HAS BEEN DONE
      *
     C                     SETON                     20
      *
     C/COPY WNCPYSRC,FT0515C004
      *                                                                                       CER030
      ** Check if 'CER031' is switched 'ON'                                                   CER030
      *                                                                                       CER030
     C                     CALL 'AOSARDR0'                                                    CER030
     C                     PARM *BLANKS   PRTCD   7                                           CER030
     C                     PARM '*VERIFY' POPTN   7                                           CER030
     C                     PARM 'CER031'  PSARD   6                                           CER030
     C           SCSARD    PARM SCSARD    DSFDY                                               CER030
      *                                                                                       CER030
     C           PRTCD     IFEQ *BLANKS                                                       CER030
     C                     MOVE 'Y'       CER031  1                                           CER030
     C                     MOVE *ON       *IN32                                               CER030
     C                     ELSE                                                               CER030
      *                                                                                       CER030
     C           PRTCD     IFNE '*NRF   '                                                     CER030
     C                     MOVEL'SCSARDPD'WDBFIL                                              CER030
     C                     MOVEL'CER031'  WDBKEY                                              CER030
     C                     MOVEL'030'     WDBASE                                              CER030
     C                     EXSR UEABRT                                                        CER030
     C                     ELSE                                                               CER030
     C                     MOVE 'N'       CER031                                              CER030
     C                     MOVE *OFF      *IN32                                               CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      ** Check if 'CGL013' is switched 'ON'                                                   CER030
      *                                                                                       CER030
     C                     MOVE *OFF      *IN31                                               CER030
     C                     CALL 'AOSARDR0'                                                    CER030
     C                     PARM *BLANKS   PRTCD                                               CER030
     C                     PARM '*VERIFY' POPTN                                               CER030
     C                     PARM 'CGL013'  PSARD                                               CER030
     C           SCSARD    PARM SCSARD    DSFDY                                               CER030
      *                                                                                       CER030
     C           PRTCD     IFEQ *BLANKS                                                       CER030
     C                     MOVE 'Y'       CGL013  1                                           CER030
     C                     MOVE *ON       *IN31                                               CER030
     C                     ELSE                                                               CER030
      *                                                                                       CER030
     C           PRTCD     IFNE '*NRF   '                                                     CER030
     C                     MOVEL'SCSARDPD'WDBFIL                                              CER030
     C                     MOVEL'CGL013'  WDBKEY                                              CER030
     C                     MOVEL'023'     WDBASE                                              CER030
     C                     EXSR UEABRT                                                        CER030
     C                     ELSE                                                               CER030
     C                     MOVE 'N'       CGL013                                              CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      ** Check if 'CER030' is switched 'ON'                                                   CER030
      *                                                                                       CER030
     C                     CALL 'AOSARDR0'                                                    CER030
     C                     PARM *BLANKS   PRTCD                                               CER030
     C                     PARM '*VERIFY' POPTN                                               CER030
     C                     PARM 'CER030'  PSARD                                               CER030
     C           SCSARD    PARM SCSARD    DSFDY                                               CER030
      *                                                                                       CER030
     C           PRTCD     IFEQ *BLANKS                                                       CER030
     C                     MOVE 'Y'       CER030  1                                           CER030
     C                     MOVE *ON       *IN31                                               CER030
     C                     ELSE                                                               CER030
      *                                                                                       CER030
     C           PRTCD     IFNE '*NRF   '                                                     CER030
     C                     MOVEL'SCSARDPD'WDBFIL                                              CER030
     C                     MOVEL'CER030'  WDBKEY                                              CER030
     C                     MOVEL'024'     WDBASE                                              CER030
     C                     EXSR UEABRT                                                        CER030
     C                     ELSE                                                               CER030
     C                     MOVE 'N'       CER030                                              CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      ** Check if 'CFT003' is switched 'ON'                                                   CER030
      *                                                                                       CER030
     C                     MOVE 'N'       CFT003                                              CER030
     C                     MOVE *OFF      *IN33                                               CER030
      *                                                                                       CER030
     C                     CALL 'AOSARDR0'                                                    CER030
     C                     PARM *BLANKS   PRTCD                                               CER030
     C                     PARM '*VERIFY' POPTN                                               CER030
     C                     PARM 'CFT003'  PSARD                                               CER030
     C           SCSARD    PARM SCSARD    DSFDY                                               CER030
      *                                                                                       CER030
     C           PRTCD     IFEQ *BLANKS                                                       CER030
     C                     MOVE 'Y'       CFT003  1                                           CER030
     C                     ELSE                                                               CER030
      *                                                                                       CER030
     C           PRTCD     IFNE '*NRF   '                                                     CER030
     C                     MOVEL'SCSARDPD'WDBFIL                                              CER030
     C                     MOVEL'CFT003'  WDBKEY                                              CER030
     C                     MOVEL'025'     WDBASE                                              CER030
     C                     EXSR UEABRT                                                        CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           CER031    IFEQ 'Y'                                                           CER030
     C           CFT003    ANDEQ'Y'                                                           CER030
     C                     MOVE *ON       *IN33                                               CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      *                                                                                       CFT120
      ** Check if 'CFT120' is switched 'ON'                                                   CFT120
      *                                                                                       CFT120
     C                     MOVE 'N'       CFT120                                              CFT120
     C                     MOVE *OFF      *IN59                                               CFT120
      *                                                                                       CFT120
     C                     CALL 'AOSARDR0'                                                    CFT120
     C                     PARM *BLANKS   PRTCD                                               CFT120
     C                     PARM '*VERIFY' POPTN                                               CFT120
     C                     PARM 'CFT120'  PSARD                                               CFT120
     C           SCSARD    PARM SCSARD    DSFDY                                               CFT120
      *                                                                                       CFT120
     C           PRTCD     IFEQ *BLANKS                                                       CFT120
     C                     MOVE 'Y'       CFT120  1                                           CFT120
     C                     MOVE *ON       *IN59                                               CFT120
     C                     ELSE                                                               CFT120
      *                                                                                       CFT120
     C           PRTCD     IFNE '*NRF   '                                                     CFT120
     C                     MOVEL'SCSARDPD'WDBFIL                                              CFT120
     C                     MOVEL'CFT120'  WDBKEY                                              CFT120
     C                     MOVEL'026'     WDBASE                                              CFT120
     C                     EXSR UEABRT                                                        CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
     C                     ENDSR
      /EJECT
      *****************************************************************
      **
      **    Get name for Type.
      **
      **    CALLED FROM:  anywhere
      **    CALLS:
      **
      **
     C           GETADD    BEGSR
      ************                                                        S01435
      ************  Translation now performed through standard pgm        S01435
      ************                                                        S01435
      ************                                                        S01435
      ***Type*A=*Address leave as on file ..                              S01435
      ************                                                        S01435
      ***Type*blank ...                                                   S01435
      ************...  set to blanks.                                     S01435
     C***********XTYPE     IFEQ ' '                                       S01435
     C************         MOVE *BLANKS   XNAMDS                          S01435
     C************         END                                            S01435
      ************                                                        S01435
      ***Type*F=*Full Nostro                                              S01435
     C***********XTYPE     IFEQ 'F'                                       S01435
      ***Get*account key from Table using 5 chars.                        S01435
     C************         MOVE '05'      @ASE                            S01435
     C************         MOVE DS1T5     KYTABL                          S01435
     C***********KYTABL    CHAINTABLETLF             99                   S01435
      ************                                                        S01435
      ***DB*Error*if no record found or "deleted".                        S01435
     C************IN99     IFEQ '1'                                       S01435
     C***********RECI      ORNE 'D'                                       S01435
     C************         MOVEL'TABFP'   @FILE                           S01435
     C************         MOVELKYTABL    @KEY                            S01435
     C************         EXSR *PSSR                                     S01435
     C************         END                                            S01435
      ************                                                        S01435
     C************         MOVE '06'      @ASE                            S01435
     C***********CNUM      CHAINCLINTCCF             99                   S01435
      ************                                                        S01435
      ***DB*Error*if no record found or "deleted".                        S01435
     C************IN99     IFEQ '1'                                       S01435
     C***********RECI      ORNE 'D'                                       S01435
     C************         MOVEL'CLINT'   @FILE                           S01435
     C************         MOVELCNUM      @KEY                            S01435
     C************         EXSR *PSSR                                     S01435
     C************         END                                            S01435
      ************                                                        S01435
     C************         MOVELCLINTD    XADDS                           S01435
     C************         END                                            S01435
      ************                                                        S01435
      ***Type*R=*Retail .                                                 S01435
     C***********XTYPE     IFEQ 'R'                                       S01435
      ***Get*account key from ACNUMA using 10 chars.                      S01435
     C************         MOVE '07'      @ASE                            S01435
     C***********DS1T10    CHAINACNUMA               99                   S01435
      ************                                                        S01435
      ***DB*Error*if no record found.                                     S01435
     C************IN99     IFEQ '1'                                       S01435
     C***********RECI      ORNE 'D'                                       S01435
     C************         MOVEL'ACCNT'   @FILE                           S01435
     C************         MOVELDS1T10    @KEY                            S01435
     C************         EXSR *PSSR                                     S01435
     C************         END                                            S01435
      ************                                                        S01435
     C************         MOVE '08'      @ASE                            S01435
     C***********CNUM      CHAINCLINTCCF             99                   S01435
      ************                                                        S01435
      ***DB*Error*if no record found or "deleted".                        S01435
     C************IN99     IFEQ '1'                                       S01435
     C***********RECI      ORNE 'D'                                       S01435
     C************         MOVEL'CLINT'   @FILE                           S01435
     C************         MOVELCNUM      @KEY                            S01435
     C************         EXSR *PSSR                                     S01435
     C************         END                                            S01435
      ************                                                        S01435
     C************         MOVELCLINTD    XADDS                           S01435
     C************         END                                            S01435
      ************                                                        S01435
      ***If*Full(G) Customer(C) or Partial(P)..                           S01435
      *******...get name from Client file.                                S01435
     C***********XTYPE     IFEQ 'P'                                       S01435
     C***********XTYPE     OREQ 'G'                                       S01435
     C***********XTYPE     OREQ 'C'                                       S01435
     C************         MOVE '09'      @ASE                            S01435
     C***********DS1T6     CHAINCLINTCCF             99                   S01435
      ************                                                        S01435
      ***DB*Error*if no record found or "deleted".                        S01435
     C************IN99     IFEQ '1'                                       S01435
     C***********RECI      ORNE 'D'                                       S01435
     C************         MOVEL'CLINT'   @FILE                           S01435
     C************         MOVELDS1T6     @KEY                            S01435
     C************         EXSR *PSSR                                     S01435
     C************         END                                            S01435
      ************                                                        S01435
     C************         MOVELCLINTD    XADDS                           S01435
     C************         END                                            S01435
      *                                                                   S01435
      *                                                                   S01435
      *  Set up general parameters                                        S01435
      *                                                                   S01435
     C           *LIKE     DEFN BCCY      XCCY                            S01435
      *                                                                   S01435
     C                     CLEARW8FT                                      S01435
     C                     MOVEL*BLANKS   W8STMT                          S01435
     C                     MOVELXCCY      W8CCY                           S01435
     C                     MOVEL@PGM      W8CPGM                          S01435
     C                     MOVEL'*PRINT'  W8ACT                           S01435
     C                     Z-ADD5         W8NLIN                          S01435
      *                                                                   S01435
      *  Receivers Correspomdent                                          S01435
      *                                                                   S01435
     C                     MOVELXTYPE     W8TYPE                          S01435
     C                     MOVEL*BLANKS   W8LINS                          S01435
     C                     MOVELXNAMDS    W8LINS                          S01435
      *                                                                   S01435
      * Call expansion program                                            S01435
      *                                                                   S01435
     C                     CALL 'FT0315'               8989               S01435
     C                     PARM           W8RTN   7                       S01435
     C                     PARM           W8FT                            S01435
     C                     PARM           W8LINS256                       S01435
     C                     PARM           W8RPT 256                       S01435
     C                     PARM           W8MSG 256                       S01435
     C                     PARM           W8SCR 256                       S01435
      *                                                                   S01435
      ** Check if database error occurred                                 S01435
      *                                                                   S01435
     C           *IN89     IFEQ '1'                                       S01435
     C           W8RTN     ORNE *BLANKS                                   S01435
     C                     MOVEL'FT0315'  WDBFIL                          S01435
     C                     MOVEL'*CALL'   WDBKEY                          S01435
     C                     MOVEL'52'      WDBASE                          S01435
     C                     EXSR UEABRT                     *ABORT PGM*    S01435
     C                     END                                            S01435
      *                                                                   S01435
     C                     MOVELW8RPT     XNAMDS                          S01435
      *                                                                   S01435
      *
     C                     ENDSR
     C/EJECT
     C           CCDETL    BEGSR
      *          ******    *****
      *
      *****************************************************************
      *                 CC-DETAIL-PROCESSING                          *
      *                                                               *
      *  FUNCTION : TO PRODUCE A PAGE ON THE DETAIL REPORT BASED ON   *
      *             DATA FROM INPUT RECORD.                           *
      *                                                               *
      *  CALLS :    UATBCN                                            *
      *             UEABRT                                            *
      *             UGFRMT                                            *
      *             ZDATE2                                            *
      *             CHOPF                                             *
      *                                                               *
      *  CALLED BY: AAMAIN                                            *
      *                                                               *
      *****************************************************************
      *                                                                   CFT014
      ** Access OTPAYXL2 if switchable feature CFT014 is installed.       CFT014
      *                                                                   CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
      *                                                                   CFT014
     C           PREF      CHAINOTPAYXL2             90                   CFT014
      *                                                                   CFT014
      ** If record does not exist and switchable feature CFT014           CFT014
      ** is installed, do error routine.                                  CFT014
      *                                                                   CFT014
     C           *IN90     IFEQ '1'                                       CFT014
     C                     MOVEL'OTPAYXL2'WDBFIL                          CFT014
     C                     MOVELPREF      WDBKEY                          CFT014
     C                     MOVEL'022'     WDBASE                          CFT014
     C                     EXSR UEABRT                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *
      ** SETUP STATUS OF RECORD
      *
     C           OTCHTP    IFEQ 'I'
     C                     MOVEL'* INSERT'P1STTS
     C                     MOVE 'ED *'    P1STTS
     C                     ELSE
     C           OTCHTP    IFEQ 'A'
     C                     MOVEL'* AMENDE'P1STTS
     C                     MOVE 'D * '    P1STTS
     C                     ELSE
     C                     MOVEL'* DELETE'P1STTS
     C                     MOVE 'D * '    P1STTS
     C                     END
     C                     END
      ** SETUP ADDRESS FIELDS,ACESSING CLINT AS APPROPRIATE
      *                                                                   055293
      * Set Up Ordering Institution Details                               055293
      *                                                                   055293
     C                     MOVEL*BLANKS   P1OBDS                          S01435
     C                     MOVEL*BLANKS   P1ORBK                          S01435
     C           OPORB1    IFNE *BLANKS                                   S01435
      *                                                                   S01435
      * If SWIFT type A translate else leave as on message                S01435
      *                                                                   S01435
     C                     MOVEL#IMSG     P1ORBK                          S01435
     C           OPORBT    IFNE 'S'                                       S01435
     C                     MOVELOPORB1    P1ORB1                          055293
     C                     MOVELOPORB2    P1ORB2                          055293
     C                     MOVELOPORB3    P1ORB3                          055293
     C                     MOVELOPORB4    P1ORB4                          055293
     C                     MOVELOPORB5    P1ORB5                          055293
     C                     ELSE                                           S01435
     C                     MOVEL'ORBT'    XCALL                           S01435
     C                     MOVELOPORBT    XTYPE                           S01435
     C                     MOVEL*BLANKS   XNAMDS                          S01435
     C                     MOVELOPORB1    ##001   1                       S01435
     C           ##001     IFEQ '/'                                       S01435
     C                     MOVELOPORB2    XNAMDS                          S01435
     C                     ELSE                                           S01435
     C                     MOVELOPORB1    XNAMDS                          S01435
     C                     END                                            S01435
     C                     EXSR GETADD                                    S01435
     C                     MOVELXNAMDS    P1OBDS                          S01435
     C                     END                                            S01435
     C                     END                                            S01435
      *                                                                   S01435
      * Translate input account with bank                                 S01435
      *                                                                   S01435
     C           ORBT      IFNE *BLANKS                                   S01435
     C                     MOVEL'ORBT'    XCALL                           S01435
     C                     MOVELORBT      XTYPE                           S01435
     C                     MOVELSMCY      XCCY                            S01435
     C                     MOVEL*BLANKS   XNAMDS                          S01435
     C                     MOVELORBK      XNAMDS                          S01435
     C                     MOVELORBB      XBRCA                           S01435
     C/COPY WNCPYSRC,FT0515C008
     C                     EXSR GETADD                                    S01435
     C           OPORB1    IFEQ *BLANKS                                   S01435
     C                     MOVELXADDS     P1OBDS                          S01435
     C                     END                                            S01435
     C                     MOVELXNAMDS    P1ORBK                          S01435
     C                     END                                            S01435
      *                                                                   S01435
      ** INTERMEDIARY BANK                                                S01435
      *                                                                   S01435
     C                     MOVEL'INBT'    XCALL   4                       S01435
     C                     MOVELINBT      XTYPE                           S01435
     C                     MOVELININDS    XNAMDS                          S01435
     C                     EXSR GETADD                                    S01435
     C                     MOVELXNAMDS    P1INDS                          S01435
      *
      ** RECEIVER'S CORRESPONDENT
      *
     C                     MOVE 'RCRT'    XCALL   4
     C                     MOVELRCRT      XTYPE
     C                     MOVELRCINDS    XNAMDS
     C                     EXSR GETADD
     C                     MOVELXNAMDS    P1RCDS
      *
      ** ORDERING CUSTOMER
      *
     C                     MOVE 'ORCT'    XCALL   4
     C                     MOVELSMCY      XCCY                            S01435
     C                     MOVELORCT      XTYPE
     C                     MOVELORINDS    XNAMDS
     C                     EXSR GETADD
     C                     MOVELXNAMDS    P1ORDS
      **********                                                          S01435
     C**********                                                    S01117S01435
     C***If*non*multi branched and ordering customer is partial accoS01117S01435
     C***prevent branch from being written to printer file          S01117S01435
     C**********                                                    S01117S01435
     C********** MBIN      IFEQ 'N'                                 S01117S01435
     C********** ORCT      ANDEQ'P'                                 S01117S01435
     C**********           MOVELORC1      WORC   12                 S01117S01435
     C**********           MOVE *BLANKS   P1ORC1                    S01117S01435
     C**********           MOVELWORC      P1ORC1                    S01117S01435
     C**********           END                                      S01117S01435
     C**********                                                    S01117S01435
      *
      ***RECEIVING*BANK**                                                 S01435
      ** Destination                                                      S01435
      *
     C                     MOVE 'DSTT'    XCALL   4
     C                     MOVELDSTT      XTYPE
     C                     MOVELDSINDS    XNAMDS
     C                     EXSR GETADD
     C                     MOVELXNAMDS    P1DSDS
      **********                                                          S01435
     C**********                                                    S01117S01435
     C***If*non*multi branched and receiving bank is full account   S01117S01435
     C***prevent branch from being written to printer file          S01117S01435
     C**********                                                    S01117S01435
     C********** MBIN      IFEQ 'N'                                 S01117S01435
     C********** DSTT      ANDEQ'G'                                 S01117S01435
     C**********           MOVELDST1      WDEST  15                 S01117S01435
     C**********           MOVE *BLANKS   P1DST1                    S01117S01435
     C**********           MOVELWDEST     P1DST1                    S01117S01435
     C**********           END                                      S01117S01435
     C**********                                                    S01117S01435
      *
      ** ACCOUNT WITH BANK
      *
     C                     MOVE 'ACBT'    XCALL   4
     C                     MOVELACBT      XTYPE
     C                     MOVELACINDS    XNAMDS
     C                     EXSR GETADD
     C                     MOVELXNAMDS    P1ACDS
      *
      ** BENEFICIARY CUSTOMER
      *
     C                     MOVE 'BNCT'    XCALL   4
     C                     MOVELBNCT      XTYPE
     C                     MOVELBNINDS    XNAMDS
     C                     EXSR GETADD
     C                     MOVELXNAMDS    P1BNDS
      *
     C                     MOVE *BLANKS   XCALL   4
      *                                                                                       CFT120
      ** Access currency record for charges to the DR of currency                             CFT120
      *                                                                                       CFT120
     C           CFT120    IFEQ 'Y'                                                           CFT120
     C           OPCDRC    IFNE *BLANKS                                                       CFT120
     C                     MOVEL*BLANKS   ZTABKY                                              CFT120
     C                     MOVEL'20'      ZTABKY                                              CFT120
     C                     MOVELOPCDRC    WA4                                                 CFT120
     C                     MOVE '1'       WA4                                                 CFT120
     C                     MOVE WA4       ZTABKY                                              CFT120
     C                     EXSR UATBCN                                                        CFT120
      *                                                                                       CFT120
      ** Check if database error occured                                                      CFT120
      *                                                                                       CFT120
     C           *IN89     IFEQ '1'                                                           CFT120
     C                     MOVEL'TABLE'   WDBFIL                                              CFT120
     C                     MOVELZTABKY    WDBKEY                                              CFT120
     C                     MOVEL'62'      WDBASE                                              CFT120
     C                     EXSR UEABRT                                                        CFT120
     C                     ELSE                                                               CFT120
      *                                                                                       CFT120
      ** Store number of decimal places for CDRC Currency                                     CFT120
      *                                                                                       CFT120
     C                     Z-ADDCDP       SVCCDP  10                                          CFT120
     C                     ENDIF                                                              CFT120
     C                     ENDIF                                                              CFT120
     C                     ENDIF                                                              CFT120
      *
      ** FORMAT PAY & SETTLE AMOUNTS
      *
      ** CALL UATBCN TO ACCESS CURRENCY RECORD FOR SETTLE CURRENCY
      *
     C                     MOVEL*BLANKS   ZTABKY
     C                     MOVEL'20'      ZTABKY
     C                     MOVELSMCY      WA4
     C                     MOVE '1'       WA4
     C                     MOVE WA4       ZTABKY
     C                     EXSR UATBCN
      *
      ** CHECK IF DATABASE ERROR OCCURRED
      *
     C           *IN89     IFEQ '1'
     C                     MOVEL'TABLE'   WDBFIL
     C                     MOVELZTABKY    WDBKEY
     C                     MOVEL'09'      WDBASE
     C                     EXSR UEABRT                     *ABORT PGM*
     C                     END
      *
      ** STORE NUMBER OF DECIMAL PLACES FOR SETTLE CURRENCY
      *
     C                     Z-ADDCDP       SVSCDP  10
      *
      ** FORMAT SETTLE AMOUNT
      *
     C                     MOVEL*BLANKS   WFDIN  15
     C                     MOVE SMAM      WFDIN
     C                     Z-ADDSVSCDP    WDEC    10
     C           13        SUB  SVSCDP    WDIG    20
     C                     EXSR UGFRMT
     C                     MOVE WFDOUT    P1SMAM
      *
      ** CALL UATBCN TO ACCESS CURRENCY RECORD FOR PAY CURRENCY
      *
     C                     MOVEL*BLANKS   ZTABKY
     C                     MOVEL'20'      ZTABKY
     C                     MOVELPCCY      WA4
     C                     MOVE '1'       WA4
     C                     MOVE WA4       ZTABKY
     C                     EXSR UATBCN
      *
      ** CHECK IF DATABASE ERROR OCCURRED
      *
     C           *IN89     IFEQ '1'
     C                     MOVEL'TABLE'   WDBFIL
     C                     MOVELZTABKY    WDBKEY
     C                     MOVEL'10'      WDBASE
     C                     EXSR UEABRT                     *ABORT PGM*
     C                     END
      *
      ** STORE NUMBER OF DECIMAL PLACES FOR PAY CURRENCY
      *
     C                     Z-ADDCDP       SVPCDP  10
      *
      ** FORMAT PAY AMOUNT
      *
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE PYAM      WFDIN
     C                     Z-ADDSVPCDP    WDEC
     C           13        SUB  SVPCDP    WDIG
     C                     EXSR UGFRMT
     C                     MOVE WFDOUT    P1PYAM
      *                                                                   CEU006
      **  Format Notified Delivery Amount.                                CEU006
      *                                                                   CEU006
     C                     MOVEA'00'      *IN,55                          CEU006
      *                                                                   CEU006
     C           NDAM      IFNE 0                          B*1            CEU006
     C                     MOVE '1'       *IN55                           CEU006
      *                                                                   CEU006
      **  Call SR/UATBCN to access currency record for Notified           CEU006
      **  Delivery Currency.                                              CEU006
      *                                                                   CEU006
     C                     MOVEL*BLANKS   ZTABKY                          CEU006
     C                     MOVEL'20'      ZTABKY                          CEU006
     C                     MOVELNDCY      WA4                             CEU006
     C                     MOVE '1'       WA4                             CEU006
     C                     MOVE WA4       ZTABKY                          CEU006
     C                     EXSR UATBCN                                    CEU006
      *                                                                   CEU006
      **  Check if database error occurred.                               CEU006
      *                                                                   CEU006
     C           *IN89     IFEQ '1'                        B*2            CEU006
     C                     MOVEL'TABLE'   WDBFIL                          CEU006
     C                     MOVELZTABKY    WDBKEY                          CEU006
     C                     MOVEL'070'     WDBASE                          CEU006
     C                     EXSR UEABRT                     *ABORT PGM*    CEU006
     C                     ENDIF                           E*2            CEU006
      *                                                                   CEU006
     C                     Z-ADDNDAM      ZFLD15                          CEU006
     C                     Z-ADDCDP       ZDECS                           CEU006
     C                     MOVE 'J'       ZECODE                          CEU006
     C                     EXSR ZSEDIT                                    CEU006
     C                     MOVE ZOUT21    WFLD18 18                       CEU006
     C                     MOVE WFLD18    RNDAMT                          CEU006
     C                     MOVE NDCY      RNDCCY                          CEU006
     C                     ENDIF                           E*1            CEU006
      *                                                                   CEU006
      **  Format Pay Delivery Amount.                                     CEU006
      *                                                                   CEU006
     C***********PDAM      IFNE 0                          B*1     CEU006 CFT014
      *                                                                   CFT014
     C           CEU006    IFEQ 'Y'                                       CFT014
     C           CFT014    OREQ 'Y'                                       CFT014
      *                                                                   CFT014
     C                     MOVE '1'       *IN56                           CEU006
      *                                                                   CFT014
     C           PDAM      IFEQ 0                                         CFT014
     C                     MOVE *BLANKS   RPDAMT                          CFT014
     C                     MOVE *BLANKS   RPDCCY                          CFT014
     C                     ELSE                                           CFT014
      *                                                                   CEU006
      **  Call SR/UATBCN to access currency record for Pay                CEU006
      **  Delivery Currency.                                              CEU006
      *                                                                   CEU006
     C                     MOVEL*BLANKS   ZTABKY                          CEU006
     C                     MOVEL'20'      ZTABKY                          CEU006
     C                     MOVELPDCY      WA4                             CEU006
     C                     MOVE '1'       WA4                             CEU006
     C                     MOVE WA4       ZTABKY                          CEU006
     C                     EXSR UATBCN                                    CEU006
      *                                                                   CEU006
      **  Check if database error occurred                                CEU006
      *                                                                   CEU006
     C           *IN89     IFEQ '1'                        B*2            CEU006
     C                     MOVEL'TABLE'   WDBFIL                          CEU006
     C                     MOVELZTABKY    WDBKEY                          CEU006
     C                     MOVEL'071'     WDBASE                          CEU006
     C                     EXSR UEABRT                     *ABORT PGM*    CEU006
     C                     ENDIF                           E*2            CEU006
      *                                                                   CEU006
     C                     Z-ADDPDAM      ZFLD15                          CEU006
     C                     Z-ADDCDP       ZDECS                           CEU006
     C                     MOVE 'J'       ZECODE                          CEU006
     C                     EXSR ZSEDIT                                    CEU006
     C                     MOVE ZOUT21    WFLD18                          CEU006
     C                     MOVE WFLD18    RPDAMT                          CEU006
     C                     MOVE PDCY      RPDCCY                          CEU006
     C                     ENDIF                           E*1            CEU006
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *
      ** FORMAT OTHER AMOUNTS & CURRENCIES
      ** IF CHARGES TO DEBIT A/C FIELD IS NON-ZERO USE BASE CURRENCY;
      ** OTHERWISE IF PAY PLUS CHARGES INDICATOR IS 'Y' USE SETTLE CCY;
      ** OTHERWISE USE PAY CURRENCY
      *
     C***********CDRO      IFNE *ZERO                                                         CSD027
     C           CDRO      IFNE *BLANKS                                                       CSD027
      *                                                                                       CFT120
     C                     MOVELBCCY      WCCY    3
     C                     Z-ADDSVBCDP    WDEC
     C           OPCDRC    IFNE *BLANKS                                                       CFT120
     C           CFT120    ANDEQ'Y'                                                           CFT120
     C                     MOVE OPCDRC    WCCY                                                CFT120
     C                     Z-ADDSVCCDP    WDEC                                                CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
     C/COPY WNCPYSRC,FT0515C001
     C                     ELSE
     C           ADDC      IFEQ 'A'
     C                     MOVELSMCY      WCCY
     C                     Z-ADDSVSCDP    WDEC
     C                     ELSE
     C                     MOVELPCCY      WCCY
     C                     Z-ADDSVPCDP    WDEC
     C                     END
     C                     END
      *
     C           11        SUB  WDEC      WDIG
      *
      ** If CFT009 is not installed...                                    CFT009
     C           *IN30     IFEQ *OFF                                      CFT009
      *                                                                   CFT009
      ** SETUP CURRENCY NAMES
      *
     C                     MOVELWCCY      P1TRCY
     C                     MOVELWCCY      P1TXCY
     C                     MOVELWCCY      P1CQCY
     C                     MOVELWCCY      P1SPCY
     C                     MOVELWCCY      P1CSCY
     C                     MOVELWCCY      P1MSCY
     C*                                                                   S01494
     C** Set up ccy for FX/Change only if S01494 feature is active        S01494
     C*                                                                   S01494
     C           *IN28     IFEQ '1'                                       S01494
     C                     MOVELWCCY      P1CHCY                          S01494
     C                     END                                            S01494
     C*                                                                   S01499
     C** Set up ccy for V.A.T. if S01499 feature is active                S01499
     C*                                                                   S01499
     C           *IN29     IFEQ '1'                                       S01499
     C                     MOVELWCCY      P1VTCY                          S01499
     C                     END                                            S01499
      *
      ** FORMAT TRANSFER COMMISSION AMOUNT
      *
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE TRCM      WFDIN
     C                     EXSR UGFRMT
     C                     MOVE WFDOUT    P1TRCM
      *
      ** FORMAT TELEX CHARGE AMOUNT
      *
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE TXCH      WFDIN
     C                     EXSR UGFRMT
     C                     MOVE WFDOUT    P1TXCH
      *
      ** FORMAT CHEQUE CHARGE AMOUNT
      *
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CQCH      WFDIN
     C                     EXSR UGFRMT
     C                     MOVE WFDOUT    P1CQCH
      *
      ** FORMAT SWIFT PR CHARGE AMOUNT
      *
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE SPCH      WFDIN
     C                     EXSR UGFRMT
     C                     MOVE WFDOUT    P1SPCH
      *
      ** FORMAT COSTS ABROAD CHARGE AMOUNT
      *
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CSTA      WFDIN
     C                     EXSR UGFRMT
     C                     MOVE WFDOUT    P1CSTA
      *
      ** FORMAT MISCELLANEOUS CHARGE AMOUNT
      *
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE MSCH      WFDIN
     C                     EXSR UGFRMT
     C                     MOVE WFDOUT    P1MSCH
     C*                                                                   109965
     C** Compute and Settle/Pay amount if charges to debit a/c            109965
     C** field is zero.  If ADDC equal to 'A' deduct charges from         109965
     C** settle amount.  Otherwise, deduct charges from pay amount.       109965
     C*                                                                   109965
     C                     MOVEA'00'      *IN,22                          109965
     C                     Z-ADD*ZERO     SMCH   130                      109965
     C                     Z-ADD*ZERO     PYCH   130                      109965
     C***********CDRO      IFEQ *ZERO                                                  109965 CSD027
     C           CDRO      IFEQ *BLANKS                                                       CSD027
     C                     Z-ADDTRCM      CHRGS  130                      109965
     C                     ADD  TXCH      CHRGS                           109965
     C                     ADD  CQCH      CHRGS                           109965
     C                     ADD  SPCH      CHRGS                           109965
     C                     ADD  CSTA      CHRGS                           109965
     C                     ADD  MSCH      CHRGS                           109965
     C           CHRGS     IFNE *ZERO                                     109965
     C           ADDC      IFEQ 'A'                                       109965
     C                     MOVE '1'       *IN22                           109965
     C           SMAM      ADD  CHRGS     SMCH   130                      109965
     C                     MOVEL*BLANKS   WFDIN                           109965
     C                     MOVE SMCH      WFDIN                           109965
     C                     EXSR UGFRMT                                    109965
     C                     MOVE WFDOUT    P1SMCH                          109965
     C                     MOVE SMCY      P1SMCC                          109965
     C                     ELSE                                           109965
     C                     MOVE '1'       *IN23                           109965
     C           PYAM      SUB  CHRGS     PYCH   130                      109965
     C                     MOVEL*BLANKS   WFDIN                           109965
     C                     MOVE PYCH      WFDIN                           109965
     C                     EXSR UGFRMT                                    109965
     C                     MOVE WFDOUT    P1PYCH                          109965
     C                     MOVE PCCY      P1PCCC                          109965
     C                     END                                            109965
     C                     END                                            109965
     C                     END                                            109965
     C*                                                                   S01494
     C** Format the FX/Change Commission amount if S01494 is active       S01494
     C*                                                                   S01494
     C           *IN28     IFEQ '1'                                       S01494
     C                     MOVE *BLANKS   WFDIN                           S01494
     C                     MOVE OPCHCM    WFDIN                           S01494
     C                     EXSR UGFRMT                                    S01494
     C                     MOVE WFDOUT    P1CHCM                          S01494
     C                     END                                            S01494
     C*                                                                   S01499
     C** Format the V.A.T. amount if S01499 is active                     S01499
     C*                                                                   S01499
     C           *IN29     IFEQ '1'                                       S01499
     C                     MOVE *BLANKS   WFDIN                           S01499
     C                     MOVE OPVATT    WFDIN                           S01499
     C                     EXSR UGFRMT                                    S01499
     C                     MOVE WFDOUT    P1VATT                          S01499
     C                     END                                            S01499
      *
      ** ...Else CFT009 is On - calculate total charges in payment/       CFT009
      **    settlement currency as decided above.                         CFT009
     C                     ELSE                                           CFT009
      *                                                                   CFT009
     C                     MOVEA'00'      *IN,22                          CFT009
     C                     Z-ADD*ZEROS    T@CHAT                          CFT009
     C                     Z-ADD*ZEROS    T@CHVT                          CFT009
     C                     Z-ADD*ZEROS    T@CHTT                          CFT009
     C                     Z-ADD*ZEROS    TTLCHG                          CFT009
      *                                                                   CFT009
     C***********CDRO      IFEQ *ZERO                                                  CFT009 CSD027
     C           CDRO      IFEQ *BLANKS                                                       CSD027
      *                                                                   CFT009
     C           T@CHTT    IFNE *ZEROS                                    CFT009
     C           ADDC      IFEQ 'A'                                       CFT009
     C                     MOVE *ON       *IN22                           CFT009
     C           SMAM      ADD  T@CHTT    SMCH   130                      CFT009
     C                     MOVEL*BLANKS   WFDIN                           CFT009
     C                     MOVE SMCH      WFDIN                           CFT009
     C                     EXSR UGFRMT                                    CFT009
     C                     MOVE WFDOUT    P1SMCH                          CFT009
     C                     MOVE SMCY      P1SMCC                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVE *ON       *IN23                           CFT009
     C           PYAM      SUB  T@CHTT    PYCH   130                      CFT009
     C                     MOVEL*BLANKS   WFDIN                           CFT009
     C                     MOVE PYCH      WFDIN                           CFT009
     C                     EXSR UGFRMT                                    CFT009
     C                     MOVE WFDOUT    P1PYCH                          CFT009
     C                     MOVE PCCY      P1PCCC                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                    (End of 'If *IN30 = *Off')                     CFT009
      *                                                                   CFT009
      ** FORMAT DATE FIELDS USING SYSTEM ROUTINE ZDATE2
      *
      ** SETTLE VALUE DATE
      *
     C                     Z-ADDSLDT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVELZADATE    P1SLDT
      *
      ** PAY VALUE DATE
      *
     C                     Z-ADDPVDT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVELZADATE    P1PYDT
      *
      ** FINAL DATE
      *
     C                     Z-ADDFDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVELZADATE    P1FDAT
      *
     C                     Z-ADDNPDT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVELZADATE    P1NPDT
      *
      ** SETUP REMAINING REPORT FIELDS
      *
     C                     MOVELPREF      P1PREF
     C                     MOVELPYTP      P1PYTP
     C                     MOVELPYST      P1PYST
     C                     MOVELSMCY      P1SMCY
     C                     Z-ADDRATE      P1RATE
     C                     MOVELPCCY      P1PCCY
     C                     MOVELBBI1      P1BBI1
     C                     MOVELBBI2      P1BBI2
     C                     MOVELBBI3      P1BBI3
     C                     MOVELBBI4      P1BBI4
     C                     MOVELBBI5      P1BBI5
     C                     MOVELBBI6      P1BBI6
     C                     MOVELDTP1      P1DTP1
     C                     MOVELDTP2      P1DTP2
     C                     MOVELDTP3      P1DTP3
     C                     MOVELDTP4      P1DTP4
     C                     MOVELSTMT      P1STTP
     C/COPY WNCPYSRC,FT0515C005
     C           DNBC      IFNE *ZERO                                     S01435
     C/COPY WNCPYSRC,FT0515C006
     C                     MOVELDNBC      P1DNBC
     C                     ELSE                                           S01435
     C                     MOVEL*BLANKS   P1DNBC                          S01435
     C                     END                                            S01435
     C                     MOVELSNMT      P1SNMT
     C                     MOVELADDC      P1ADDC
     C                     MOVELRPAY      P1RPAY
     C                     MOVELPAYF      P1PAYF
     C                     MOVELDYIM      P1DYIM
     C                     MOVELDTCH      P1DTCH
     C                     MOVELTRCT      P1TRCT
     C*********************MOVELSWPC      P1SWPC                          S01117
     C           SWPC      IFEQ 1                          B001           S01117
     C                     MOVE 'U'       P1SWPC                          S01117
     C                     ELSE                            X001           S01117
     C           SWPC      IFEQ 2                          B002           S01117
     C                     MOVE 'N'       P1SWPC                          S01117
     C                     END                             E002           S01117
     C                     END                             E001           S01117
      *
      ** EDIT  SNCO, ORBK AND CDRO  FOR OUTPUT
      *
      **********                                                          S01435
     C**********           MOVE SNCT      PRMTYP  1        ( SNCO )       S01435
     C**********           MOVE *ZEROS    PRMFLD 12                       S01435
     C**********           MOVELSNCO      PRMFLD                          S01435
     C**********           EXSR CHOPF                                     S01435
     C**********           MOVELPRMFLD    P1SNCO                          S01435
      *                                                                   S01435
      * Translate input Sender's Correspondent                            S01435
      *                                                                   S01435
     C                     MOVEL'SNCT'    XCALL                           S01435
     C                     MOVELSNCT      XTYPE                           S01435
     C                     MOVELPCCY      XCCY                            S01435
     C                     MOVEL*BLANKS   XNAMDS                          S01435
     C                     MOVELSNCO      XNAMDS                          S01435
     C                     EXSR GETADD                                    S01435
     C                     MOVELXNAMDS    P1SNCO                          S01435
     C                     MOVELXADDS     P1SNDS                          S01435
      *
      **********                                                          S01435
     C**********           MOVE ORBT      PRMTYP           ( ORBK )       S01435
     C**********           MOVE *ZEROS    PRMFLD                          S01435
     C**********           MOVELORBK      PRMFLD                          S01435
     C**********           EXSR CHOPF                                     S01435
     C**********           MOVELORBB      P1ORBB                    S01117S01435
     C**********           MOVELPRMFLD    P1ORBK                          S01435
      *
     C**********           MOVE CDRT      PRMTYP           ( CDRO )       S01435
     C**********           MOVE *ZEROS    PRMFLD                          S01435
     C                     MOVE CDRT      PRMTYP  1        ( CDRO )       S01435
     C**********           MOVE *ZEROS    PRMFLD 12                                    S01435 CGL029
     C***********          MOVE *ZEROS    PRMFLD 18                                    CGL029 CSD027
     C                     MOVE *BLANKS   PRMFLD 18                                           CSD027
     C                     MOVELCDRO      PRMFLD
     C                     EXSR CHOPF
     C                     MOVELCDBR      P1CDBR                          S01117
     C                     MOVELPRMFLD    P1CDRO
      *                                                                                       CFT120
     C           CFT120    IFEQ 'Y'                                                           CFT120
     C           OPCDRC    IFNE *BLANKS                                                       CFT120
     C                     MOVELOPCDRC    P1CDRC                                              CFT120
     C                     ELSE                                                               CFT120
     C                     MOVE *BLANKS   P1CDRC                                              CFT120
     C                     ENDIF                                                              CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
     C/COPY WNCPYSRC,FT0515C002
      *                                                                   S01435
      * Format input users and first authorisation is available           S01435
      *                                                                   S01435
     C           INUSR1    IFNE *BLANKS                                   S01435
     C                     MOVE INUSR1    USRP                            S01435
     C                     EXSR UCMUSE                                    S01435
     C                     MOVE USER1     SIUSR1 25                       S01435
     C*                                                                   S01435
     C                     ELSE                                           S01435
     C*                                                                   S01435
     C** CLEAR OUTPUT FIELD                                               S01435
     C                     MOVE *BLANKS   SIUSR1                          S01435
     C*                                                                   S01435
     C                     END                                            S01435
      *                                                                   S01435
     C           INUSR2    IFNE *BLANKS                                   S01435
     C                     MOVE INUSR2    USRP                            S01435
     C                     EXSR UCMUSE                                    S01435
     C                     MOVE USER1     SIUSR2 25                       S01435
     C*                                                                   S01435
     C                     ELSE                                           S01435
     C*                                                                   S01435
     C** CLEAR OUTPUT FIELD                                               S01435
     C                     MOVE *BLANKS   SIUSR2                          S01435
     C*                                                                   S01435
     C                     END                                            S01435
      *                                                                   S01435
     C           AUP1      IFNE *BLANKS                                   S01435
     C                     MOVE AUP1      USRP                            S01435
     C                     EXSR UCMUSE                                    S01435
     C                     MOVE USER1     SAUP1  25                       S01435
     C*                                                                   S01435
     C                     ELSE                                           S01435
     C*                                                                   S01435
     C** CLEAR OUTPUT FIELD                                               S01435
     C                     MOVE *BLANKS   SAUP1                           S01435
     C*                                                                   S01435
     C                     END                                            S01435
      *                                                                   S01435
      * Format Override indicator                                         S01435
      *                                                                   S01435
     C                     MOVE *BLANKS   P1OVRD                          S01435
     C           OVRD      IFEQ 'Y'                                       S01435
     C                     MOVE 'YES'     P1OVRD                          S01435
     C                     ELSE                                           S01435
     C                     MOVE 'NO '     P1OVRD                          S01435
     C                     END                                            S01435
      *                                                                   S01435
      * Format Entered Currency                                           S01435
      *                                                                   S01435
     C                     SELEC                                          S01435
      *                                                                   S01435
     C***********CDRO      WHNE *ZERO                                                  S01435 CSD027
     C           CDRO      WHNE *BLANKS                                                       CSD027
     C           BTCHCY    OREQ 'B'                                       074815
     C           CFT120    ANDNE'Y'                                                           CFT120
     C                     MOVELBCCY      WCCY                            S01435
     C                     Z-ADDSVBCDP    WDEC                            S01435
     C           OPCDRC    IFNE *BLANKS                                                       CFT120
     C           CFT120    ANDEQ'Y'                                                           CFT120
     C                     MOVELOPCDRC    WCCY                                                CFT120
     C                     Z-ADDSVCCDP    WDEC                                                CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
     C           BTCHCY    WHEQ 'B'                                                           CFT120
     C           CFT120    ANDEQ'Y'                                                           CFT120
     C                     MOVELBCCY      WCCY                                                CFT120
     C                     Z-ADDSVBCDP    WDEC                                                CFT120
      *                                                                                       CFT120
     C/COPY WNCPYSRC,FT0515C003
      *                                                                   S01435
     C           BTCHCY    WHEQ 'L'                                       S01435
     C                     MOVELLOCY      WCCY                            S01435
     C                     Z-ADDSVLCDP    WDEC                            S01435
      *                                                                   S01435
     C           BTCHCY    WHEQ 'C'                                       S01435
     C           ADDC      ANDEQ'A'                                       S01435
     C                     MOVELSMCY      WCCY                            S01435
     C                     Z-ADDSVSCDP    WDEC                            S01435
      *                                                                   S01435
     C                     OTHER                                          S01435
     C                     MOVELPCCY      WCCY                            S01435
     C                     Z-ADDSVPCDP    WDEC                            S01435
     C                     ENDSL                                          S01435
      *                                                                   S01435
     C                     MOVELWCCY      P1TREC                          S01435
     C                     MOVELWCCY      P1TXEC                          S01435
     C                     MOVELWCCY      P1CQEC                          S01435
     C                     MOVELWCCY      P1CSEC                          S01435
     C                     MOVELWCCY      P1SPEC                          S01435
     C                     MOVELWCCY      P1MSEC                          S01435
     C*                                                                   S01494
     C** Set up ccy for FX/Change only if S01494 is active                S01494
     C*                                                                   S01494
     C           *IN28     IFEQ '1'                                       S01494
     C                     MOVELWCCY      P1CHEC                          S01494
     C                     END                                            S01494
     C*                                                                   S01499
     C** Set up ccy for V.A.T. only if S01499 is active                   S01499
     C*                                                                   S01499
     C           *IN29     IFEQ '1'                                       S01499
     C                     MOVELWCCY      P1VTEC                          S01499
     C                     END                                            S01499
      *                                                                   S01435
      *  Format Entered Amounts                                           S01435
      *                                                                   S01435
     C           11        SUB  WDEC      WDIG                            S01435
      *                                                                   S01435
     C                     MOVEL*BLANKS   P1RLPR                                            BUG25654
     C           *IN30     IFEQ *OFF                                      CFT009
      *                                                                   CFT009
      ** Format Transfer Commission Amount                                S01435
      *                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE DUMA1     WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P1TREA                          S01435
      *                                                                   S01435
      ** Format Telex Charge Amount                                       S01435
      *                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE DUMA2     WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P1TXEA                          S01435
      *                                                                   S01435
      ** Format Cheque Charge Amount                                      S01435
      *                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE DUMA3     WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P1CQEA                          S01435
     C*                                                                   S01435
     C** Format Telephone Charge Amount                                   S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE DUMA4     WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P1CSEA                          S01435
     C*                                                                   S01435
     C** Format Advice Charge Amount                                      S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE DUMA5     WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P1SPEA                          S01435
     C*                                                                   S01435
     C** Format Miscellaneous Charge Amount                               S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE DUMA6     WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P1MSEA                          S01435
     C*                                                                   S01494
     C** Format the FX/Change Commission amount if S01494 is active       S01494
     C*                                                                   S01494
     C           *IN28     IFEQ '1'                                       S01494
     C                     MOVE *BLANKS   WFDIN                           S01494
     C                     MOVE OPDUM7    WFDIN                           S01494
     C                     EXSR UGFRMT                                    S01494
     C                     MOVE WFDOUT    P1CHEA                          S01494
     C                     END                                            S01494
     C*                                                                   S01499
     C** Format the V.A.T. Commission amount if S01499 is active          S01499
     C*                                                                   S01499
     C           *IN29     IFEQ '1'                                       S01499
     C                     MOVE *BLANKS   WFDIN                           S01499
     C                     MOVE OPDUM8    WFDIN                           S01499
     C                     EXSR UGFRMT                                    S01499
     C                     MOVE WFDOUT    P1VAEA                          S01499
     C                     END                                            S01499
      *                                                                   S01435
     C                     MOVE RLPR      P1RLPR                          S01435
     C           CHAP      IFEQ *ZERO                                     S01435
     C                     MOVE *BLANKS   P1CHAP                          S01435
     C                     ELSE                                           S01435
     C                     MOVELCHAP      P1CHAP                          S01435
     C                     END                                            S01435
     C*                                                                   S01499
     C** Set up the V.A.T. flags of all charges if S01499 is active       S01499
     C*                                                                   S01499
     C           *IN29     IFEQ '1'                                       S01499
     C                     MOVE OPVAT1    P1TRVF                          S01499
     C                     MOVE OPVAT2    P1TXVF                          S01499
     C                     MOVE OPVAT3    P1CQVF                          S01499
     C                     MOVE OPVAT4    P1CSVF                          S01499
     C                     MOVE OPVAT5    P1SPVF                          S01499
     C                     MOVE OPVAT6    P1MSVF                          S01499
     C                     MOVE OPVAT7    P1CHVF                          S01499
     C                     END                                            S01499
     C*                                                                   S01435
     C                     ENDIF                                          CFT009
      *                    (End of 'If *IN30 = *Off')                     CFT009
      *                                                                                     BUG25471
     C           CSW209    IFEQ 'Y'                                                         BUG25471
     C           P1RLPR    IFEQ *BLANKS                                                     BUG25471
     C                     MOVE RLPR      P1RLPR                                            BUG25471
     C                     ENDIF                                                            BUG25471
     C                     ENDIF                                                            BUG25471
      *                                                                   CFT009
     C** MT100 customer                                                   S01435
     C*                                                                   S01435
     C           ODMT      IFEQ *BLANK                     B001           S01435
     C           ODMT      OREQ *ZERO                                     S01435
     C                     MOVE *BLANK    P1ODMT                          S01435
     C                     MOVE *BLANK    P1ODMC                          S01435
     C                     ELSE                            X001           S01435
      *                                                                                       CFT032
     C                     MOVE 'Y'       W9CUST                                              CFT032
     C                     SELEC                                                              CFT032
      *                                                                                       CFT032
      ** Full Nostro                                                                          CFT032
      *                                                                                       CFT032
     C           ODMTT     WHEQ 'F'                                                           CFT032
     C           3         SUBSTODMT:1    @KEYB                                               CFT032
     C           2         SUBSTODMT:4    @KEYE                                               CFT032
     C                     CALL 'AONOSTR0'#ANOST                                              CFT032
     C           @RTCD     IFNE *BLANKS                                                       CFT032
     C           *LOCK     IN   LDA                                                           CFT032
     C                     MOVEL'26'      WDBASE                                              CFT032
     C                     MOVELODMT      WDBKEY                                              CFT032
     C                     MOVEL'SDNOSTPD'WDBFIL                                              CFT032
     C                     OUT  LDA                                                           CFT032
     C                     EXSR UEABRT                                                        CFT032
     C                     ENDIF                                                              CFT032
     C                     MOVELA7CUST    @CSNM                                               CFT032
      *                                                                                       CFT032
      ** IBAN                                                                                 CFT032
      *                                                                                       CFT032
     C           ODMTT     WHEQ 'I'                                                           CFT032
     C                     MOVELODMT      P@IBN  34                                           CFT032
     C                     MOVE *BLANKS   DSSDY                                               CFT032
     C                     CALL 'AOIBANR4'                                                    CFT032
     C                     PARM           @RTCD                                               CFT032
     C                     PARM '*KEY   ' @OPTN                                               CFT032
     C                     PARM           P@IBN                                               CFT032
     C           WACCN     PARM           DSSDY                                               CFT032
     C           @RTCD     IFNE *BLANKS                                                       CFT032
     C           *LOCK     IN   LDA                                                           CFT032
     C                     MOVEL'27'      WDBASE                                              CFT032
     C                     MOVELP@IBN     WDBKEY                                              CFT032
     C                     MOVEL'ACCNTL6' WDBFIL                                              CFT032
     C                     OUT  LDA                                                           CFT032
     C                     EXSR UEABRT                                                        CFT032
     C                     ENDIF                                                              CFT032
     C                     MOVELWWCNUM    @CSNM                                               CFT032
      *                                                                                       CFT032
      ** GL Account                                                                           CFT032
      *                                                                                       CFT032
     C           ODMTT     WHEQ 'G'                                                           CFT032
     C           24        SUBSTODMT:1    WCDET                                               CFT032
     C                     MOVEL*BLANKS   @RETL  10                                           CFT032
     C                     MOVELWDCNUM    @CNNM   6                                           CFT032
     C                     MOVELWDCCY     @CUCD   3                                           CFT032
     C                     MOVELWDACOD    @ACCD                                               CFT032
     C                     MOVELWDACSQ    @ACSQ                                               CFT032
     C           MBIN      IFEQ 'Y'                                                           CFT032
     C                     MOVE WDBRCA    @BRC                                                CFT032
     C                     ELSE                                                               CFT032
     C                     MOVE BJSBRC    @BRC                                                CFT032
     C                     ENDIF                                                              CFT032
     C                     CALL 'AOACCTR0'#AACCT                                              CFT032
     C           @RTCD     IFNE *BLANKS                                                       CFT032
     C           *LOCK     IN   LDA                                                           CFT032
     C                     MOVEL'28'      WDBASE                                              CFT032
     C                     MOVELWCDET     WDBKEY                                              CFT032
     C                     MOVEL'ACCNTAB' WDBFIL                                              CFT032
     C                     OUT  LDA                                                           CFT032
     C                     EXSR UEABRT                                                        CFT032
     C                     ENDIF                                                              CFT032
     C                     MOVELWWCNUM    @CSNM                                               CFT032
      *                                                                                       CFT032
      ** SWIFT                                                                                CFT032
      *                                                                                       CFT032
     C           ODMTT     WHEQ 'S'                                                           CFT032
     C           8         SUBSTODMT:1    W9BICC  8                                           CFT032
     C           3         SUBSTODMT:9    W9BICB  3                                           CFT032
      *                                                                                       CFT032
     C                     CALL 'ME1400'               9090                                   CFT032
     C                     PARM *BLANKS   W9RTN   7                                           CFT032
     C                     PARM           W9BICC                                              CFT032
     C                     PARM           W9BICB                                              CFT032
     C                     PARM           SDCUST                                              CFT032
     C                     PARM           SDCNST                                              CFT032
     C                     PARM           MEBICD                                              CFT032
     C                     PARM *BLANKS   W9CUST  1                                           CFT032
     C                     PARM *BLANKS   W9CNST  1                                           CFT032
     C                     PARM *BLANKS   W9BICD  1                                           CFT032
     C           W9CUST    IFNE 'Y'                                                           CFT032
     C           W9BICD    ANDNE'Y'                                                           CFT032
     C           *LOCK     IN   LDA                                                           CFT032
     C                     MOVEL'34'      WDBASE                                              CFT032
     C                     MOVEL'*CALL   'WDBKEY                                              CFT032
     C                     MOVEL'ME1400 ' WDBFIL                                              CFT032
     C                     OUT  LDA                                                           CFT032
     C                     EXSR UEABRT                                                        CFT032
     C                     ELSE                                                               CFT032
     C           W9CUST    IFEQ 'Y'                                                           CFT032
     C                     MOVE BBCUST    @CSNM                                               CFT032
     C                     ELSE                                                               CFT032
     C                     MOVELBDINS1    BBCNA1                                              CFT032
     C                     ENDIF                                                              CFT032
     C                     ENDIF                                                              CFT032
      *                                                                                       CFT032
      ** Customer                                                                             CFT032
      *                                                                                       CFT032
     C           ODMTT     WHEQ 'C'                                                           CFT032
     C                     MOVELODMT      @CSNM                           S01435
      *                                                                                       CSW207
      ** Non Account Holder Reference                                                         CSW207
      *                                                                                       CSW207
     C           ODMTT     WHEQ 'O'                                                           CSW207
     C           CSW207    ANDEQ'Y'                                                           CSW207
     C                     CALL 'AONAHOR0'                                                    CSW207
     C                     PARM *BLANKS   @RTCD   7                                           CSW207
     C                     PARM '*KEY   ' @OPTN   7                                           CSW207
     C                     PARM ODMT      @NAHO  10                                           CSW207
     C********** SDNAHO    PARM SDNAHO    DSSDY                                      CSW207 BUG24029
     C           SDNAHO    PARM SDNAHO    DSLDY                                             BUG24029
     C           @RTCD     IFNE *BLANKS                                                       CSW207
     C           *LOCK     IN   LDA                                                           CSW207
     C                     MOVEL'35'      WDBASE                                              CSW207
     C                     MOVELODMT      WDBKEY                                              CSW207
     C                     MOVEL'SDNAHOPD'WDBFIL                                              CSW207
     C                     OUT  LDA                                                           CSW207
     C                     EXSR UEABRT                                                        CSW207
     C                     ELSE                                                               CSW207
     C                     MOVEL'N'       W9CUST                                              CSW207
     C                     ENDIF                                                              CSW207
     C                     ENDSL                                                              CFT032
      *                                                                                       CFT032
     C           W9CUST    IFEQ 'Y'                                                           CFT032
      *                                                                   S01435
     C                     CALL 'AOCUSTR0'             8989               S01435
     C                     PARM *BLANKS   @RTCD   7                       S01435
     C                     PARM '*KEY   ' @OPTN   7                       S01435
     C                     PARM           @CSNM  10                       S01435
     C                     PARM *BLANKS   @KYST   7                       S01435
     C           SDCUST    PARM *BLANKS   DSSDY                           S01435
     C*                                                                   S01435
     C           *IN89     IFEQ '1'                        B002           S01435
      *                                                    *************  S01435
     C                     MOVEL'SDCUSTPD'WDBFIL           * DATA BASE *  S01435
     C                     MOVEL@CSNM     WDBKEY           * ERROR 69  *  S01435
     C                     MOVEL'69'      WDBASE           *************  S01435
     C                     EXSR UEABRT                     *ABORT PGM*    S01435
     C                     END                             E002           S01435
     C*                                                                   S01435
     C                     MOVELODMT      P1ODMT                          S01435
     C                     MOVELBBCNA1    P1ODMC                          S01435
     C*                                                                                       CSW207
     C           W9CUST    IFEQ 'N'                                                           CSW207
     C           CSW207    ANDEQ'Y'                                                           CSW207
     C                     MOVELODMT      P1ODMT                                              CSW207
     C                     MOVELNHCNA1    P1ODMC                                              CSW207
     C                     ENDIF                                                              CSW207
     C                     END                             E001           S01435
     C                     ENDIF                                                              CFT032
      *                                                                   CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
      *                                                                   CFT014
     C           OPOEXR    IFNE 0                                         CFT014
     C                     Z-ADDOPOEXR    P1OEXR                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVELOPBOCD    P1BOCD                          CFT014
     C                     MOVELOPTTCD    P1TTCD                          CFT014
     C                     MOVELOPTRI1    P1TRI1                          CFT014
     C                     MOVELOPTRI2    P1TRI2                          CFT014
     C                     MOVELOPTRI3    P1TRI3                          CFT014
     C                     MOVELOPTRI4    P1TRI4                          CFT014
     C                     MOVELOPTRI5    P1TRI5                          CFT014
     C                     MOVELOPICD1    P1ICD1                          CFT014
     C                     MOVELOPICD2    P1ICD2                          CFT014
     C                     MOVELOPICD3    P1ICD3                          CFT014
     C                     MOVELOPICD4    P1ICD4                          CFT014
     C                     MOVELOPICD5    P1ICD5                          CFT014
     C                     MOVELOPRRP1    P1RRP1                          CFT014
     C                     MOVELOPRRP2    P1RRP2                          CFT014
     C                     MOVELOPRRP3    P1RRP3                          CFT014
      *                                                                   CFT014
      ** Format Receiver's Charges                                        CFT014
      *                                                                   CFT014
     C           OPRCRM    IFEQ 0                                         CFT014
     C                     MOVE *BLANKS   P1RCRM                          CFT014
     C                     MOVE *BLANKS   P1RCRY                          CFT014
     C                     ELSE                                           CFT014
     C                     MOVEL*BLANKS   WFDIN                           CFT014
     C                     MOVE OPRCRM    WFDIN                           CFT014
     C                     EXSR UGFRMT                                    CFT014
     C                     MOVE WFDOUT    P1RCRM                          CFT014
     C                     MOVE PCCY      P1RCRY                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Format Sender's Charges                                          CFT014
      *                                                                   CFT014
     C           OPSCC1    IFEQ *BLANKS                                   CFT014
     C                     MOVE *BLANKS   P1SCH1                          CFT014
     C                     MOVE *BLANKS   P1SCY1                          CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C                     CALL 'AOCURRR0'                                CFT014
     C                     PARM '*DBERR ' @RTCD   7                       CFT014
     C                     PARM '*KEY   ' @OPTN   7                       CFT014
     C                     PARM OPSCC1    @CCY    3                       CFT014
     C           SDCURR    PARM SDCURR    DSSDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C                     MOVEL'SDCURRPD'WDBFIL                          CFT014
     C                     MOVEL'*VERIFY' WDBKEY                          CFT014
     C                     MOVEL'72'      WDBASE                          CFT014
     C                     SETON                     U7U8LR               CFT014
     C                     EXSR UEABRT                                    CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C                     MOVE A6NBDP    WNBDP1  10                      CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     Z-ADDWNBDP1    WDEC    10                      CFT014
     C           11        SUB  WDEC      WDIG    20                      CFT014
     C                     MOVEL*BLANKS   WFDIN                           CFT014
     C                     MOVE OPSCH1    WFDIN                           CFT014
     C                     EXSR UGFRMT                                    CFT014
     C                     MOVE WFDOUT    P1SCH1                          CFT014
     C                     MOVE OPSCC1    P1SCY1                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           OPSCC2    IFEQ *BLANKS                                   CFT014
     C                     MOVE *BLANKS   P1SCH2                          CFT014
     C                     MOVE *BLANKS   P1SCY2                          CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C                     CALL 'AOCURRR0'                                CFT014
     C                     PARM '*DBERR ' @RTCD   7                       CFT014
     C                     PARM '*KEY   ' @OPTN   7                       CFT014
     C                     PARM OPSCC2    @CCY    3                       CFT014
     C           SDCURR    PARM SDCURR    DSSDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C                     MOVEL'SDCURRPD'WDBFIL                          CFT014
     C                     MOVEL'*VERIFY' WDBKEY                          CFT014
     C                     MOVEL'73'      WDBASE                          CFT014
     C                     SETON                     U7U8LR               CFT014
     C                     EXSR UEABRT                                    CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C                     MOVE A6NBDP    WNBDP2  10                      CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     Z-ADDWNBDP2    WDEC                            CFT014
     C           11        SUB  WDEC      WDIG                            CFT014
     C                     MOVEL*BLANKS   WFDIN                           CFT014
     C                     MOVE OPSCH2    WFDIN                           CFT014
     C                     EXSR UGFRMT                                    CFT014
     C                     MOVE WFDOUT    P1SCH2                          CFT014
     C                     MOVE OPSCC2    P1SCY2                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           OPSCC3    IFEQ *BLANKS                                   CFT014
     C                     MOVE *BLANKS   P1SCH3                          CFT014
     C                     MOVE *BLANKS   P1SCY3                          CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C                     CALL 'AOCURRR0'                                CFT014
     C                     PARM '*DBERR ' @RTCD   7                       CFT014
     C                     PARM '*KEY   ' @OPTN   7                       CFT014
     C                     PARM OPSCC3    @CCY    3                       CFT014
     C           SDCURR    PARM SDCURR    DSSDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C                     MOVEL'SDCURRPD'WDBFIL                          CFT014
     C                     MOVEL'*VERIFY' WDBKEY                          CFT014
     C                     MOVEL'74'      WDBASE                          CFT014
     C                     SETON                     U7U8LR               CFT014
     C                     EXSR UEABRT                                    CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C                     MOVE A6NBDP    WNBDP3  10                      CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     Z-ADDWNBDP3    WDEC                            CFT014
     C           11        SUB  WDEC      WDIG                            CFT014
     C                     MOVEL*BLANKS   WFDIN                           CFT014
     C                     MOVE OPSCH3    WFDIN                           CFT014
     C                     EXSR UGFRMT                                    CFT014
     C                     MOVE WFDOUT    P1SCH3                          CFT014
     C                     MOVE OPSCC3    P1SCY3                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           OPSCC4    IFEQ *BLANKS                                   CFT014
     C                     MOVE *BLANKS   P1SCH4                          CFT014
     C                     MOVE *BLANKS   P1SCY4                          CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C                     CALL 'AOCURRR0'                                CFT014
     C                     PARM '*DBERR ' @RTCD   7                       CFT014
     C                     PARM '*KEY   ' @OPTN   7                       CFT014
     C                     PARM OPSCC4    @CCY    3                       CFT014
     C           SDCURR    PARM SDCURR    DSSDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C                     MOVEL'SDCURRPD'WDBFIL                          CFT014
     C                     MOVEL'*VERIFY' WDBKEY                          CFT014
     C                     MOVEL'75'      WDBASE                          CFT014
     C                     SETON                     U7U8LR               CFT014
     C                     EXSR UEABRT                                    CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C                     MOVE A6NBDP    WNBDP4  10                      CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     Z-ADDWNBDP4    WDEC                            CFT014
     C           11        SUB  WDEC      WDIG                            CFT014
     C                     MOVEL*BLANKS   WFDIN                           CFT014
     C                     MOVE OPSCH4    WFDIN                           CFT014
     C                     EXSR UGFRMT                                    CFT014
     C                     MOVE WFDOUT    P1SCH4                          CFT014
     C                     MOVE OPSCC4    P1SCY4                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           OPSCC5    IFEQ *BLANKS                                   CFT014
     C                     MOVE *BLANKS   P1SCH5                          CFT014
     C                     MOVE *BLANKS   P1SCY5                          CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C                     CALL 'AOCURRR0'                                CFT014
     C                     PARM '*DBERR ' @RTCD   7                       CFT014
     C                     PARM '*KEY   ' @OPTN   7                       CFT014
     C                     PARM OPSCC5    @CCY    3                       CFT014
     C           SDCURR    PARM SDCURR    DSSDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C                     MOVEL'SDCURRPD'WDBFIL                          CFT014
     C                     MOVEL'*VERIFY' WDBKEY                          CFT014
     C                     MOVEL'75'      WDBASE                          CFT014
     C                     SETON                     U7U8LR               CFT014
     C                     EXSR UEABRT                                    CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C                     MOVE A6NBDP    WNBDP5  10                      CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     Z-ADDWNBDP5    WDEC                            CFT014
     C           11        SUB  WDEC      WDIG                            CFT014
     C                     MOVEL*BLANKS   WFDIN                           CFT014
     C                     MOVE OPSCH5    WFDIN                           CFT014
     C                     EXSR UGFRMT                                    CFT014
     C                     MOVE WFDOUT    P1SCH5                          CFT014
     C                     MOVE OPSCC5    P1SCY5                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *
      ** FX Spread Set                                                    CFT009
     C           *IN30     IFEQ *ON                                       CFT009
     C                     MOVELFXSRSC    P1FXSP                          CFT009
     C                     MOVELOTPDOF    P1PDOF                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** OUTPUT PAGE TO REPORT
      *
     C/COPY WNCPYSRC,FT0515C007
     C                     WRITEP1HD
     C                     WRITEP1DETL
      *                                                                                       CER030
      ** Transaction type                                                                     CER030
      *                                                                                       CER030
     C           CER030    IFEQ 'Y'                                                           CER030
     C           CGL013    OREQ 'Y'                                                           CER030
     C                     MOVE OPRTTY    P1RTTY                                              CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      ** Extended Narrative for Debit                                                         CER030
      *                                                                                       CER030
     C           CER031    IFEQ 'Y'                                                           CER030
     C                     MOVE OPEXT1    P1EXT1                                              CER030
     C                     MOVE OPEXT2    P1EXT2                                              CER030
     C                     MOVE OPEXT3    P1EXT3                                              CER030
     C                     MOVE OPEXT4    P1EXT4                                              CER030
     C                     MOVE OPEXT5    P1EXT5                                              CER030
     C                     MOVE OPEXT6    P1EXT6                                              CER030
      *                                                                                       CER030
      ** Extended Narrative for Credit                                                        CER030
      *                                                                                       CER030
     C           CFT003    IFEQ 'Y'                                                           CER030
     C                     MOVE OPEXC1    P1EXC1                                              CER030
     C                     MOVE OPEXC2    P1EXC2                                              CER030
     C                     MOVE OPEXC3    P1EXC3                                              CER030
     C                     MOVE OPEXC4    P1EXC4                                              CER030
     C                     MOVE OPEXC5    P1EXC5                                              CER030
     C                     MOVE OPEXC6    P1EXC6                                              CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           CER030    IFEQ 'Y'                                                           CER030
     C           CER031    OREQ 'Y'                                                           CER030
     C           CGL013    OREQ 'Y'                                                           CER030
      *                                                                                       CER030
     C                     WRITEP1EXNR                                                        CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     MOVE '1'       *IN21            OUTPUT, YES
      *
     C                     ENDSR
      /EJECT                                                              S01435
     C           CHARGE    BEGSR                                          CFT009
     C*          ******    *****                                          CFT009
     C*                                                                   CFT009
     C*****************************************************************   CFT009
     C*                                                               *   CFT009
     C*  FUNCTION : TO OUTPUT CHARGE DETAILS WHEN CFT009 IS ON.       *   CFT009
     C*                                                               *   CFT009
     C*  CALLS :    GETCHG                                            *   CFT009
     C*                                                               *   CFT009
     C*  CALLED BY: Main processing                                   *   CFT009
     C*                                                               *   CFT009
     C*****************************************************************   CFT009
      *                                                                   CFT009
      ** Begin new page                                                   CFT009
      ** Get Payment Reference                                                              BUG16368
     C                     MOVELPREF      P1PREF                                            BUG16368
      ** Check if CFT009 is swithced ON                                                     BUG16368
      ** FX Spread Set                                                                      BUG16368
     C           *IN30     IFEQ *ON                                                         BUG16368
     C                     MOVELFXSRSC    P1FXSP                                            BUG16368
     C                     MOVELOTPDOF    P1PDOF                                            BUG16368
     C                     ENDIF                                                            BUG16368
      *                                                                                     BUG16368
     C                     WRITEP1CHHD                                    CFT009
      *                                                                   CFT009
     C                     Z-ADD*ZEROS    T@CHAT 110                      CFT009
     C                     Z-ADD*ZEROS    T@CHVT 110                      CFT009
     C                     Z-ADD*ZEROS    T@CHTT 110                      CFT009
     C                     Z-ADD*ZEROS    TTLCHG                          CFT009
      *                                                                   CFT009
     C********** OPCHGC    IFNE *BLANKS                                           BUG12945 BUG12945A
      ** Setup Charges Currency and find decimal places                   CFT009
     C                     CALL 'AOCURRR0'                                CFT009
     C                     PARM *BLANKS   @RTCD                           CFT009
     C                     PARM '*KEY   ' @OPTN                           CFT009
     C                     PARM OPCHGC    @CYCD   3                       CFT009
     C           SDCURR    PARM SDCURR    DSSDY                           CFT009
      *                                                                   CFT009
      * Database error if invalid currency                                CFT009
     C           @RTCD     IFNE *BLANKS                                   CFT009
     C                     MOVELOPCHGC    WDBKEY           ***************CFT009
     C                     MOVEL'SDCURRPD'WDBFIL           * DB ERROR 13 *CFT009
     C                     MOVEL'013'     WDBASE           ***************CFT009
     C                     EXSR UEABRT                                    CFT009
     C                     ELSE                                           CFT009
     C                     MOVELOPCHGC    P1CHCC                          CFT009
     C                     ENDIF                                          CFT009
     C**********           ENDIF                                                  BUG12945 BUG12945A
      *                                                                   CFT009
      ** Save charge currency decimal places                              CFT009
     C           *LIKE     DEFN A6NBDP    SVCCDC                          CFT009
     C                     Z-ADDA6NBDP    SVCCDC                          CFT009
      *                                                                   CFT009
      ** Get LEVIED  currency decimal places                              CFT009
     C                     SELEC                                          CFT009
     C***********CDRO      WHNE *ZEROS                                                 CFT009 CSD027
     C           CDRO      WHNE *BLANKS                                                       CSD027
      *                                                                                       CFT120
     C                     MOVELBCCY      WCCY                            CFT009
     C           OPCDRC    IFNE *BLANKS                                                       CFT120
     C           CFT120    ANDEQ'Y'                                                           CFT120
     C                     MOVELOPCDRC    WCCY                                                CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
     C           ADDC      WHEQ 'A'                                       CFT009
     C                     MOVELSMCY      WCCY                            CFT009
     C                     OTHER                                          CFT009
     C                     MOVELPCCY      WCCY                            CFT009
     C                     ENDSL                                          CFT009
      *                                                                   CFT009
     C                     CALL 'AOCURRR0'                                CFT009
     C                     PARM *BLANKS   @RTCD                           CFT009
     C                     PARM '*KEY   ' @OPTN                           CFT009
     C                     PARM WCCY      @CYCD   3                       CFT009
     C           SDCURR    PARM SDCURR    DSSDY                           CFT009
      *                                                                   CFT009
      * Database error if invalid currency                                CFT009
     C           @RTCD     IFNE *BLANKS                                   CFT009
     C                     MOVELWCCY      WDBKEY           ***************CFT009
     C                     MOVEL'SDCURRPD'WDBFIL           * DB ERROR 14 *CFT009
     C                     MOVEL'014'     WDBASE           ***************CFT009
     C                     EXSR UEABRT                                    CFT009
     C                     ELSE                                           CFT009
     C                     MOVELWCCY      P1CHCY                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Save payment ccy decimal places                                  CFT009
     C           *LIKE     DEFN A6NBDP    SVPYDC                          CFT009
     C                     Z-ADDA6NBDP    SVPYDC                          CFT009
      *                                                                   CFT009
      ** Setup Telex Charge if applicable                                 CFT009
     C                     MOVELTLXCDE    P1CHCD                          CFT009
      *                                                                   CFT009
     C                     MOVEADESC,1    P1CHGE                          CFT009
      *                                                                   CFT009
      ** (format Amount in levied currency)                               CFT009
     C                     MOVEL*BLANKS   WFDIN                           CFT009
     C                     MOVE TXCH      WFDIN                           CFT009
     C                     ADD  TXCH      T@CHAT                          CFT009
     C                     Z-ADDSVPYDC    WDEC                            CFT009
     C           11        SUB  SVPYDC    WDIG                            CFT009
     C                     EXSR UGFRMT                                    CFT009
     C                     MOVE WFDOUT    P1CHAM                          CFT009
      *                                                                   CFT009
      ** (format VAT Amount if VAT Flag is 'Y')                           CFT009
     C                     MOVELOPVAT2    P1CHV                           CFT009
      *                                                                   CFT009
      ** Format amount in charge currency                                 CFT009
     C                     MOVEL*BLANKS   WFDIN                           CFT009
     C                     MOVE DUMA2     WFDIN                           CFT009
     C                     ADD  DUMA2     TTLCHG 130                      CFT009
     C                     Z-ADDSVCCDC    WDEC                            CFT009
     C           11        SUB  SVCCDC    WDIG                            CFT009
     C                     EXSR UGFRMT                                    CFT009
     C                     MOVE WFDOUT    P1CHCA                          CFT009
      *                                                                   CFT009
      ** (write the Telex Charge record)                                  CFT009
     C                     WRITEP1CHGS                                    CFT009
      *                                                                   CFT009
      ** Setup Cheque Charge if applicable                                CFT009
     C                     MOVELCHQCHC    P1CHCD                          CFT009
      *                                                                   CFT009
     C                     MOVEADESC,2    P1CHGE                          CFT009
      *                                                                   CFT009
      ** (format Amount in levied currency)                               CFT009
     C                     MOVEL*BLANKS   WFDIN                           CFT009
     C                     MOVE CQCH      WFDIN                           CFT009
     C                     ADD  CQCH      T@CHAT                          CFT009
     C                     Z-ADDSVPYDC    WDEC                            CFT009
     C           11        SUB  SVPYDC    WDIG                            CFT009
     C                     EXSR UGFRMT                                    CFT009
     C                     MOVE WFDOUT    P1CHAM                          CFT009
      *                                                                   CFT009
      ** (format VAT Amount if VAT Flag is 'Y')                           CFT009
     C                     MOVELOPVAT3    P1CHV                           CFT009
      *                                                                   CFT009
      ** Format amount in charge currency                                 CFT009
     C                     MOVEL*BLANKS   WFDIN                           CFT009
     C                     MOVE DUMA3     WFDIN                           CFT009
     C                     ADD  DUMA3     TTLCHG 130                      CFT009
     C                     Z-ADDSVCCDC    WDEC                            CFT009
     C           11        SUB  SVCCDC    WDIG                            CFT009
     C                     EXSR UGFRMT                                    CFT009
     C                     MOVE WFDOUT    P1CHCA                          CFT009
      *                                                                   CFT009
      ** (write the Cheque Charge record)                                 CFT009
     C                     WRITEP1CHGS                                    CFT009
      *                                                                   CFT009
      ** Setup Costs Abroad if applicable                                 CFT009
     C                     MOVELCACHCD    P1CHCD                          CFT009
      *                                                                   CFT009
     C                     MOVEADESC,3    P1CHGE                          CFT009
      *                                                                   CFT009
      ** (format Amount in levied currency)                               CFT009
     C                     MOVEL*BLANKS   WFDIN                           CFT009
     C                     MOVE CSTA      WFDIN                           CFT009
     C                     ADD  CSTA      T@CHAT                          CFT009
     C                     Z-ADDSVPYDC    WDEC                            CFT009
     C           11        SUB  SVPYDC    WDIG                            CFT009
     C                     EXSR UGFRMT                                    CFT009
     C                     MOVE WFDOUT    P1CHAM                          CFT009
      *                                                                   CFT009
      ** (format VAT Amount if VAT Flag is 'Y')                           CFT009
     C                     MOVELOPVAT4    P1CHV                           CFT009
      *                                                                   CFT009
      ** Format amount in charge currency                                 CFT009
     C                     MOVEL*BLANKS   WFDIN                           CFT009
     C                     MOVE DUMA4     WFDIN                           CFT009
     C                     ADD  DUMA4     TTLCHG 130                      CFT009
     C                     Z-ADDSVCCDC    WDEC                            CFT009
     C           11        SUB  SVCCDC    WDIG                            CFT009
     C                     EXSR UGFRMT                                    CFT009
     C                     MOVE WFDOUT    P1CHCA                          CFT009
      *                                                                   CFT009
      ** (write the Cost Abroad record)                                   CFT009
     C                     WRITEP1CHGS                                    CFT009
      *                                                                   CFT009
      ** Setup Transfer Commission if applicable                          CFT009
     C                     MOVELTFCCCD    P1CHCD                          CFT009
      *                                                                   CFT009
     C                     MOVEADESC,4    P1CHGE                          CFT009
      *                                                                   CFT009
      ** (format Amount in levied currency)                               CFT009
     C                     MOVEL*BLANKS   WFDIN                           CFT009
     C                     MOVE TRCM      WFDIN                           CFT009
     C                     ADD  TRCM      T@CHAT                          CFT009
     C                     Z-ADDSVPYDC    WDEC                            CFT009
     C           11        SUB  SVPYDC    WDIG                            CFT009
     C                     EXSR UGFRMT                                    CFT009
     C                     MOVE WFDOUT    P1CHAM                          CFT009
      *                                                                   CFT009
      ** (format VAT Amount if VAT Flag is 'Y')                           CFT009
     C                     MOVELOPVAT1    P1CHV                           CFT009
      *                                                                   CFT009
      ** Format amount in charge currency                                 CFT009
     C                     MOVEL*BLANKS   WFDIN                           CFT009
     C                     MOVE DUMA1     WFDIN                           CFT009
     C                     ADD  DUMA1     TTLCHG 130                      CFT009
     C                     Z-ADDSVCCDC    WDEC                            CFT009
     C           11        SUB  SVCCDC    WDIG                            CFT009
     C                     EXSR UGFRMT                                    CFT009
     C                     MOVE WFDOUT    P1CHCA                          CFT009
      *                                                                   CFT009
      ** (write the Transfer Commission record)                           CFT009
     C                     WRITEP1CHGS                                    CFT009
      *                                                                   CFT009
      ** Setup SWIFT Priority Charge if applicable                        CFT009
     C                     MOVELSPRCCD    P1CHCD                          CFT009
      *                                                                   CFT009
     C                     MOVEADESC,5    P1CHGE                          CFT009
      *                                                                   CFT009
      ** (format Amount in levied currency)                               CFT009
     C                     MOVEL*BLANKS   WFDIN                           CFT009
     C                     MOVE SPCH      WFDIN                           CFT009
     C                     ADD  SPCH      T@CHAT                          CFT009
     C                     Z-ADDSVPYDC    WDEC                            CFT009
     C           11        SUB  SVPYDC    WDIG                            CFT009
     C                     EXSR UGFRMT                                    CFT009
     C                     MOVE WFDOUT    P1CHAM                          CFT009
      *                                                                   CFT009
      ** (format VAT Amount if VAT Flag is 'Y')                           CFT009
     C                     MOVELOPVAT5    P1CHV                           CFT009
      *                                                                   CFT009
      ** Format amount in charge currency                                 CFT009
     C                     MOVEL*BLANKS   WFDIN                           CFT009
     C                     MOVE DUMA5     WFDIN                           CFT009
     C                     ADD  DUMA5     TTLCHG 130                      CFT009
     C                     Z-ADDSVCCDC    WDEC                            CFT009
     C           11        SUB  SVCCDC    WDIG                            CFT009
     C                     EXSR UGFRMT                                    CFT009
     C                     MOVE WFDOUT    P1CHCA                          CFT009
      *                                                                   CFT009
      ** (write the SWIFT Priority Charge record)                         CFT009
     C                     WRITEP1CHGS                                    CFT009
      *                                                                   CFT009
      ** Setup SWIFT Standard Charge if applicable                        CFT009
     C                     MOVELSSTCCD    P1CHCD                          CFT009
      *                                                                   CFT009
     C                     MOVEADESC,6    P1CHGE                          CFT009
      *                                                                   CFT009
      ** (format Amount in levied currency)                               CFT009
     C                     MOVEL*BLANKS   WFDIN                           CFT009
     C                     MOVE SWSCHG    WFDIN                           CFT009
     C                     ADD  SWSCHG    T@CHAT                          CFT009
     C                     Z-ADDSVPYDC    WDEC                            CFT009
     C           11        SUB  SVPYDC    WDIG                            CFT009
     C                     EXSR UGFRMT                                    CFT009
     C                     MOVE WFDOUT    P1CHAM                          CFT009
      *                                                                   CFT009
      ** (format VAT Amount if VAT Flag is 'Y')                           CFT009
     C                     MOVELVTSWSC    P1CHV                           CFT009
      *                                                                   CFT009
      ** Format amount in charge currency                                 CFT009
     C                     MOVEL*BLANKS   WFDIN                           CFT009
     C                     MOVE SWSCCC    WFDIN                           CFT009
     C                     ADD  SWSCCC    TTLCHG 130                      CFT009
     C                     Z-ADDSVCCDC    WDEC                            CFT009
     C           11        SUB  SVCCDC    WDIG                            CFT009
     C                     EXSR UGFRMT                                    CFT009
     C                     MOVE WFDOUT    P1CHCA                          CFT009
      *                                                                   CFT009
      ** (write the SWIFT Standard Charge record)                         CFT009
     C                     WRITEP1CHGS                                    CFT009
      *                                                                   CFT009
      ** Setup FX/Change Charge if applicable                             CFT009
     C                     MOVELFXCACC    P1CHCD                          CFT009
      *                                                                   CFT009
     C                     MOVEADESC,7    P1CHGE                          CFT009
      *                                                                   CFT009
      ** (format Amount in levied currency)                               CFT009
     C                     MOVEL*BLANKS   WFDIN                           CFT009
     C                     MOVE OPCHCM    WFDIN                           CFT009
     C                     ADD  OPCHCM    T@CHAT                          CFT009
     C                     Z-ADDSVPYDC    WDEC                            CFT009
     C           11        SUB  SVPYDC    WDIG                            CFT009
     C                     EXSR UGFRMT                                    CFT009
     C                     MOVE WFDOUT    P1CHAM                          CFT009
      *                                                                   CFT009
      ** (format VAT Amount if VAT Flag is 'Y')                           CFT009
     C                     MOVELOPVAT7    P1CHV                           CFT009
      *                                                                   CFT009
      ** Format amount in charge currency                                 CFT009
     C                     MOVEL*BLANKS   WFDIN                           CFT009
     C                     MOVE OPDUM7    WFDIN                           CFT009
     C                     ADD  OPDUM7    TTLCHG 130                      CFT009
     C                     Z-ADDSVCCDC    WDEC                            CFT009
     C           11        SUB  SVCCDC    WDIG                            CFT009
     C                     EXSR UGFRMT                                    CFT009
     C                     MOVE WFDOUT    P1CHCA                          CFT009
      *                                                                   CFT009
      ** (write the FX/Change Charge record)                              CFT009
     C                     WRITEP1CHGS                                    CFT009
      *                                                                   CFT009
      ** Setup Miscellaneous Charge if applicable                         CFT009
     C                     MOVELMSCHC     P1CHCD                          CFT009
      *                                                                   CFT009
     C                     MOVEADESC,8    P1CHGE                          CFT009
      *                                                                   CFT009
      ** (format Amount in levied currency)                               CFT009
     C                     MOVEL*BLANKS   WFDIN                           CFT009
     C                     MOVE MSCH      WFDIN                           CFT009
     C                     ADD  MSCH      T@CHAT                          CFT009
     C                     Z-ADDSVPYDC    WDEC                            CFT009
     C           11        SUB  SVPYDC    WDIG                            CFT009
     C                     EXSR UGFRMT                                    CFT009
     C                     MOVE WFDOUT    P1CHAM                          CFT009
      *                                                                   CFT009
      ** (format VAT Amount if VAT Flag is 'Y')                           CFT009
     C                     MOVELOPVAT6    P1CHV                           CFT009
      *                                                                   CFT009
      ** Format amount in charge currency                                 CFT009
     C                     MOVEL*BLANKS   WFDIN                           CFT009
     C                     MOVE DUMA6     WFDIN                           CFT009
     C                     ADD  DUMA6     TTLCHG 130                      CFT009
     C                     Z-ADDSVCCDC    WDEC                            CFT009
     C           11        SUB  SVCCDC    WDIG                            CFT009
     C                     EXSR UGFRMT                                    CFT009
     C                     MOVE WFDOUT    P1CHCA                          CFT009
      *                                                                   CFT009
      ** (write the Miscellaneous Charge record)                          CFT009
     C                     WRITEP1CHGS                                    CFT009
      *                                                                   CFT009
      ** Setup 'Miscellaneous Charge 1' if applicable                     CFT009
     C                     MOVELMSCHC1    P1CHCD                          CFT009
     C                     MOVE *BLANKS   CHDESC                          CFT009
     C           MSCHC1    IFNE *BLANKS                                   CFT009
     C           MSCHC1    CHAINFTPCHGL0             89                   CFT009
     C                     ENDIF                                          CFT009
     C           CHDESC    IFNE *BLANKS                                   CFT009
     C                     MOVE CHDESC    P1CHGE                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVEADESC,9    P1CHGE                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** (format Amount in levied currency)                               CFT009
     C                     MOVEL*BLANKS   WFDIN                           CFT009
     C                     MOVE MISC01    WFDIN                           CFT009
     C                     ADD  MISC01    T@CHAT                          CFT009
     C                     Z-ADDSVPYDC    WDEC                            CFT009
     C           11        SUB  SVPYDC    WDIG                            CFT009
     C                     EXSR UGFRMT                                    CFT009
     C                     MOVE WFDOUT    P1CHAM                          CFT009
      *                                                                   CFT009
      ** (format VAT Amount if VAT Flag is 'Y')                           CFT009
     C                     MOVELVMIC1     P1CHV                           CFT009
      *                                                                   CFT009
      ** Format amount in charge currency                                 CFT009
     C                     MOVEL*BLANKS   WFDIN                           CFT009
     C                     MOVE MISCC1    WFDIN                           CFT009
     C                     ADD  MISCC1    TTLCHG 130                      CFT009
     C                     Z-ADDSVCCDC    WDEC                            CFT009
     C           11        SUB  SVCCDC    WDIG                            CFT009
     C                     EXSR UGFRMT                                    CFT009
     C                     MOVE WFDOUT    P1CHCA                          CFT009
      *                                                                   CFT009
      ** (write the Miscellaneous Charge 1 record)                        CFT009
     C                     WRITEP1CHGS                                    CFT009
      *                                                                   CFT009
      ** Setup 'Miscellaneous Charge 2' if applicable                     CFT009
     C                     MOVELMSCHC2    P1CHCD                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   CHDESC                          CFT009
     C           MSCHC2    IFNE *BLANKS                                   CFT009
     C           MSCHC2    CHAINFTPCHGL0             89                   CFT009
     C                     ENDIF                                          CFT009
     C           CHDESC    IFNE *BLANKS                                   CFT009
     C                     MOVE CHDESC    P1CHGE                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVEADESC,10   P1CHGE                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** (format Amount in levied currency)                               CFT009
     C                     MOVEL*BLANKS   WFDIN                           CFT009
     C                     MOVE MISC02    WFDIN                           CFT009
     C                     ADD  MISC02    T@CHAT                          CFT009
     C                     Z-ADDSVPYDC    WDEC                            CFT009
     C           11        SUB  SVPYDC    WDIG                            CFT009
     C                     EXSR UGFRMT                                    CFT009
     C                     MOVE WFDOUT    P1CHAM                          CFT009
      *                                                                   CFT009
      ** (format VAT Amount if VAT Flag is 'Y')                           CFT009
     C                     MOVELVMIC2     P1CHV                           CFT009
      *                                                                   CFT009
      ** Format amount in charge currency                                 CFT009
     C                     MOVEL*BLANKS   WFDIN                           CFT009
     C                     MOVE MISCC2    WFDIN                           CFT009
     C                     ADD  MISCC2    TTLCHG 130                      CFT009
     C                     Z-ADDSVCCDC    WDEC                            CFT009
     C           11        SUB  SVCCDC    WDIG                            CFT009
     C                     EXSR UGFRMT                                    CFT009
     C                     MOVE WFDOUT    P1CHCA                          CFT009
      *                                                                   CFT009
      ** (write the Miscellaneous Charge 2 record)                        CFT009
     C                     WRITEP1CHGS                                    CFT009
      *                                                                   CFT009
      ** Setup 'Miscellaneous Charge 3' if applicable                     CFT009
     C                     MOVELMSCHC3    P1CHCD                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   CHDESC                          CFT009
     C           MSCHC3    IFNE *BLANKS                                   CFT009
     C           MSCHC3    CHAINFTPCHGL0             89                   CFT009
     C                     ENDIF                                          CFT009
     C           CHDESC    IFNE *BLANKS                                   CFT009
     C                     MOVE CHDESC    P1CHGE                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVEADESC,11   P1CHGE                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** (format Amount in levied currency)                               CFT009
     C                     MOVEL*BLANKS   WFDIN                           CFT009
     C                     MOVE MISC03    WFDIN                           CFT009
     C                     ADD  MISC03    T@CHAT                          CFT009
     C                     Z-ADDSVPYDC    WDEC                            CFT009
     C           11        SUB  SVPYDC    WDIG                            CFT009
     C                     EXSR UGFRMT                                    CFT009
     C                     MOVE WFDOUT    P1CHAM                          CFT009
      *                                                                   CFT009
      ** (format VAT Amount if VAT Flag is 'Y')                           CFT009
     C                     MOVELVMIC3     P1CHV                           CFT009
      *                                                                   CFT009
      ** Format amount in charge currency                                 CFT009
     C                     MOVEL*BLANKS   WFDIN                           CFT009
     C                     MOVE MISCC3    WFDIN                           CFT009
     C                     ADD  MISCC3    TTLCHG 130                      CFT009
     C                     Z-ADDSVCCDC    WDEC                            CFT009
     C           11        SUB  SVCCDC    WDIG                            CFT009
     C                     EXSR UGFRMT                                    CFT009
     C                     MOVE WFDOUT    P1CHCA                          CFT009
      *                                                                   CFT009
      ** (write the Miscellaneous Charge 3 record)                        CFT009
     C                     WRITEP1CHGS                                    CFT009
      *                                                                   CFT009
      ** Setup 'Miscellaneous Charge 4' if applicable                     CFT009
     C                     MOVELMSCHC4    P1CHCD                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   CHDESC                          CFT009
     C           MSCHC4    IFNE *BLANKS                                   CFT009
     C           MSCHC4    CHAINFTPCHGL0             89                   CFT009
     C                     ENDIF                                          CFT009
     C           CHDESC    IFNE *BLANKS                                   CFT009
     C                     MOVE CHDESC    P1CHGE                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVEADESC,12   P1CHGE                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** (format Amount in levied currency)                               CFT009
     C                     MOVEL*BLANKS   WFDIN                           CFT009
     C                     MOVE MISC04    WFDIN                           CFT009
     C                     ADD  MISC04    T@CHAT                          CFT009
     C                     Z-ADDSVPYDC    WDEC                            CFT009
     C           11        SUB  SVPYDC    WDIG                            CFT009
     C                     EXSR UGFRMT                                    CFT009
     C                     MOVE WFDOUT    P1CHAM                          CFT009
      *                                                                   CFT009
      ** (format VAT Amount if VAT Flag is 'Y')                           CFT009
     C                     MOVELVMIC4     P1CHV                           CFT009
      *                                                                   CFT009
      ** Format amount in charge currency                                 CFT009
     C                     MOVEL*BLANKS   WFDIN                           CFT009
     C                     MOVE MISCC4    WFDIN                           CFT009
     C                     ADD  MISCC4    TTLCHG 130                      CFT009
     C                     Z-ADDSVCCDC    WDEC                            CFT009
     C           11        SUB  SVCCDC    WDIG                            CFT009
     C                     EXSR UGFRMT                                    CFT009
     C                     MOVE WFDOUT    P1CHCA                          CFT009
      *                                                                   CFT009
      ** (write the Miscellaneous Charge 4 record)                        CFT009
     C                     WRITEP1CHGS                                    CFT009
      *                                                                   CFT009
      ** Setup 'Miscellaneous Charge 5' if applicable                     CFT009
     C                     MOVELMSCHC5    P1CHCD                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   CHDESC                          CFT009
     C           MSCHC5    IFNE *BLANKS                                   CFT009
     C           MSCHC5    CHAINFTPCHGL0             89                   CFT009
     C                     ENDIF                                          CFT009
     C           CHDESC    IFNE *BLANKS                                   CFT009
     C                     MOVE CHDESC    P1CHGE                          CFT009
     C                     ELSE                                           CFT009
     C                     MOVEADESC,13   P1CHGE                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** (format Amount in levied currency)                               CFT009
     C                     MOVEL*BLANKS   WFDIN                           CFT009
     C                     MOVE MISC05    WFDIN                           CFT009
     C                     ADD  MISC05    T@CHAT                          CFT009
     C                     Z-ADDSVPYDC    WDEC                            CFT009
     C           11        SUB  SVPYDC    WDIG                            CFT009
     C                     EXSR UGFRMT                                    CFT009
     C                     MOVE WFDOUT    P1CHAM                          CFT009
      *                                                                   CFT009
      ** (format VAT Amount if VAT Flag is 'Y')                           CFT009
     C                     MOVELVMIC5     P1CHV                           CFT009
      *                                                                   CFT009
      ** Format amount in charge currency                                 CFT009
     C                     MOVEL*BLANKS   WFDIN                           CFT009
     C                     MOVE MISCC5    WFDIN                           CFT009
     C                     ADD  MISCC5    TTLCHG 130                      CFT009
     C                     Z-ADDSVCCDC    WDEC                            CFT009
     C           11        SUB  SVCCDC    WDIG                            CFT009
     C                     EXSR UGFRMT                                    CFT009
     C                     MOVE WFDOUT    P1CHCA                          CFT009
      *                                                                   CFT009
      ** (write the Miscellaneous Charge 5 record)                        CFT009
     C                     WRITEP1CHGS                                    CFT009
      *                                                                   CFT009
      ** Output totals                                                    CFT009
      * levied currency                                                   CFT009
     C                     MOVEL*BLANKS   WFDIN                           CFT009
     C                     MOVE T@CHAT    WFDIN                           CFT009
     C                     Z-ADDSVPYDC    WDEC                            CFT009
     C           11        SUB  SVPYDC    WDIG                            CFT009
     C                     EXSR UGFRMT                                    CFT009
     C                     MOVE *BLANKS   P1CHAT                          CFT009
     C                     MOVE WFDOUT    P1CHAT                          CFT009
      *                                                                   CFT009
      *                                                                   CFT009
      * charge currency                                                   CFT009
     C                     MOVEL*BLANKS   WFDIN                           CFT009
     C                     MOVE TTLCHG    WFDIN                           CFT009
     C                     Z-ADDSVCCDC    WDEC                            CFT009
     C           11        SUB  SVCCDC    WDIG                            CFT009
     C                     EXSR UGFRMT                                    CFT009
     C                     MOVE *BLANKS   P1CHTT                          CFT009
     C                     MOVE WFDOUT    P1CHTT                          CFT009
      *                                                                   CFT009
      * Total VAT (Levied Currency)                                       CFT009
      *                                                                   CFT009
     C                     MOVEL*BLANKS   WFDIN                           CFT009
     C                     MOVE OPVATT    WFDIN                           CFT009
     C                     Z-ADDSVPYDC    WDEC                            CFT009
     C           11        SUB  SVPYDC    WDIG                            CFT009
     C                     EXSR UGFRMT                                    CFT009
     C                     MOVE *BLANKS   TVATCC                          CFT009
     C                     MOVE WFDOUT    TVATCC                          CFT009
      *                                                                   CFT009
      * Total VAT (Charge Currency)                                       CFT009
     C                     MOVEL*BLANKS   WFDIN                           CFT009
     C                     MOVE OPDUM8    WFDIN                           CFT009
     C                     Z-ADDSVCCDC    WDEC                            CFT009
     C           11        SUB  SVCCDC    WDIG                            CFT009
     C                     EXSR UGFRMT                                    CFT009
     C                     MOVE *BLANKS   TVATLC                          CFT009
     C                     MOVE WFDOUT    TVATLC                          CFT009
      *                                                                   CFT009
     C                     WRITEP1TOTS                                    CFT009
      *                                                                   CFT009
     C           CSW209    IFEQ 'Y'                                                           CSW209
      *                                                                                       CSW209
     C                     MOVELOPNWRK    P1NWRK                                              CSW209
     C                     MOVELOPMTPY    P1MTPY                                              CSW209
     C                     MOVELOPVALF    P1VALF                                              CSW209
     C                     MOVELOPOMVF    P1OMVF                                              CSW209
     C                     MOVELOPOCVF    P1OCVF                                              CSW209
      ** Sender to Receiver Information (Cover A)                                             CSW209
     C                     MOVELOPOCB1    P1OCB1                                              CSW209
     C                     MOVELOPOCB2    P1OCB2                                              CSW209
     C                     MOVELOPOCB3    P1OCB3                                              CSW209
     C                     MOVELOPOCB4    P1OCB4                                              CSW209
     C                     MOVELOPOCB5    P1OCB5                                              CSW209
     C                     MOVELOPOCB6    P1OCB6                                              CSW209
      *                                                                                       CSW209
     C                     WRITEP1NTWK                                                        CSW209
      *                                                                                       CSW209
     C           OPOMVF    IFEQ 'COV'                                                         CSW209
     C           WPCOC1    IFNE *BLANKS                                                       CSW209
     C           WPCOB1    ORNE *BLANKS                                                       CSW209
     C           WPCIB1    ORNE *BLANKS                                                       CSW209
     C           WPCAB1    ORNE *BLANKS                                                       CSW209
     C           WPCBC1    ORNE *BLANKS                                                       CSW209
     C           WPCDP1    ORNE *BLANKS                                                       CSW209
     C           WPCICY    ORNE *BLANKS                                                       CSW209
     C           WPCIAM    ORNE *ZEROS                                                        CSW209
     C           WPCBB1    ORNE *BLANKS                                                       CSW209
      *                                                                                       CSW209
      **  Cover Message Information for Outgoing Payments                                     CSW209
      *                                                                                       CSW209
      ** Ordering Customer (Cover)                                                            CSW209
     C                     MOVELOPCOC1    P1COC1                                              CSW209
     C                     MOVELOPCOC2    P1COC2                                              CSW209
     C                     MOVELOPCOC3    P1COC3                                              CSW209
     C                     MOVELOPCOC4    P1COC4                                              CSW209
     C                     MOVELOPCOC5    P1COC5                                              CSW209
      ** Ordering Institution (Cover)                                                         CSW209
     C                     MOVELOPCOB1    P1COB1                                              CSW209
     C                     MOVELOPCOB2    P1COB2                                              CSW209
     C                     MOVELOPCOB3    P1COB3                                              CSW209
     C                     MOVELOPCOB4    P1COB4                                              CSW209
     C                     MOVELOPCOB5    P1COB5                                              CSW209
      ** Intermediary Institution (Cover)                                                     CSW209
     C                     MOVELOPCIB1    P1CIB1                                              CSW209
     C                     MOVELOPCIB2    P1CIB2                                              CSW209
     C                     MOVELOPCIB3    P1CIB3                                              CSW209
     C                     MOVELOPCIB4    P1CIB4                                              CSW209
     C                     MOVELOPCIB5    P1CIB5                                              CSW209
      ** Account With Institution (Cover)                                                     CSW209
     C                     MOVELOPCAB1    P1CAB1                                              CSW209
     C                     MOVELOPCAB2    P1CAB2                                              CSW209
     C                     MOVELOPCAB3    P1CAB3                                              CSW209
     C                     MOVELOPCAB4    P1CAB4                                              CSW209
     C                     MOVELOPCAB5    P1CAB5                                              CSW209
      ** Beneficiary Customer                                                                 CSW209
     C                     MOVELOPCBC1    P1CBC1                                              CSW209
     C                     MOVELOPCBC2    P1CBC2                                              CSW209
     C                     MOVELOPCBC3    P1CBC3                                              CSW209
     C                     MOVELOPCBC4    P1CBC4                                              CSW209
     C                     MOVELOPCBC5    P1CBC5                                              CSW209
      ** Instructed Currency (Cover)                                                          CSW209
     C                     MOVELOPCICY    P1CICY                                              CSW209
      ** Instructed Amount (Cover)                                                            CSW209
     C                     MOVEL*BLANKS   P1CIAM                                              CSW209
      *                                                                                       CSW209
      ** Access AOCURRR0 to get the currency's decimal places                                 CSW209
      *                                                                                       CSW209
     C           OPCICY    IFNE *BLANKS                                                       CSW209
      *                                                                                       CSW209
     C                     CALL 'AOCURRR0'                                                    CSW209
     C                     PARM *BLANKS   @RTCD                                               CSW209
     C                     PARM '*KEY   ' @OPTN                                               CSW209
     C                     PARM           OPCICY                                              CSW209
     C           SDCURR    PARM SDCURR    DSSDY                                               CSW209
      *                                                                                       CSW209
     C           @RTCD     IFNE *BLANKS                                                       CSW209
     C                     MOVEL'SDCURRPD'WDBFIL                                              CSW209
     C                     MOVELOPCICY    WDBKEY                                              CSW209
     C                     MOVEL'31'      WDBASE                                              CSW209
     C                     SETON                     U7U8LR                                   CSW209
     C                     EXSR UEABRT                                                        CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     Z-ADDA6NBDP    W4CIAM  10                                          CSW209
      *                                                                                       CSW209
      ** Format Instructed Currency Amount                                                    CSW209
      *                                                                                       CSW209
     C                     MOVEL*BLANKS   WFDIN                                               CSW209
     C                     MOVE OPCIAM    WFDIN                                               CSW209
     C                     Z-ADDW4CIAM    WDEC                                                CSW209
     C           13        SUB  W4CIAM    WDIG                                                CSW209
     C                     EXSR UGFRMT                                                        CSW209
     C                     MOVE WFDOUT    P1CIAM                                              CSW209
     C                     ENDIF                                                              CSW209
      ** Sender to Receiver Information (Cover B)                                             CSW209
     C                     MOVELOPCBB1    P1CBB1                                              CSW209
     C                     MOVELOPCBB2    P1CBB2                                              CSW209
     C                     MOVELOPCBB3    P1CBB3                                              CSW209
     C                     MOVELOPCBB4    P1CBB4                                              CSW209
     C                     MOVELOPCBB5    P1CBB5                                              CSW209
     C                     MOVELOPCBB6    P1CBB6                                              CSW209
      ** Remittance Information (Cover)                                                       CSW209
     C                     MOVELOPCDP1    P1CDP1                                              CSW209
     C                     MOVELOPCDP2    P1CDP2                                              CSW209
     C                     MOVELOPCDP3    P1CDP3                                              CSW209
     C                     MOVELOPCDP4    P1CDP4                                              CSW209
      *                                                                                       CSW209
     C                     ADD  1         PAGE                                                CSW209
     C                     WRITEP1COVM                                                        CSW209
     C                     ENDIF                                                              CSW209
     C                     ENDIF                                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C*                    *****                                          CFT009
     C                     ENDSR                                          CFT009
     C*                    *****                                          CFT009
      /EJECT                                                              CFT009
     C           GETCHG    BEGSR                                          CFT009
     C*          ******    *****                                          CFT009
     C*                                                                   CFT009
     C*****************************************************************   CFT009
     C*                                                               *   CFT009
     C*  FUNCTION : TO OBTAIN CHARGE DETAILS FROM PF/FTPCHGPD (This   *   CFT009
     C*             subroutine is only called if CFT009 is on).       *   CFT009
     C*                                                               *   CFT009
     C*  CALLS :    NONE                                              *   CFT009
     C*                                                               *   CFT009
     C*  CALLED BY: CCDETL                                            *   CFT009
     C*                                                               *   CFT009
     C*****************************************************************   CFT009
     C*                                                                   CFT009
     C           P1CHCD    CHAINFTPCHGL0             89                   CFT009
      *                                                                   CFT009
     C           *IN89     IFEQ *ON                                       CFT009
     C                     MOVELP1CHCD    WDBKEY           ***************CFT009
     C                     MOVEL'FTPCHGPD'WDBFIL           * DB ERROR 15 *CFT009
     C                     MOVEL'015'     WDBASE           ***************CFT009
     C                     EXSR UEABRT                                    CFT009
     C                     ELSE                                           CFT009
     C                     MOVELCHDESC    P1CHGE                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C*                    *****                                          CFT009
     C                     ENDSR                                          CFT009
     C*                    *****                                          CFT009
      /EJECT                                                              CFT009
     C           UCMUSE    BEGSR                                          S01435
     C*          ******    *****                                          S01435
     C*                                                                   S01435
     C*****************************************************************   S01435
     C*                 UC-CHAIN-USER-FILE                            *   S01435
     C*                                                               *   S01435
     C*  FUNCTION : TO ATTEMPT TO ACCESS THE RECORD FROM THE USER     *   S01435
     C*             FILE.                                             *   S01435
     C*                                                               *   S01435
     C*  CALLS :    NONE                                              *   S01435
     C*                                                               *   S01435
     C*  CALLED BY: CCDETL                                            *   S01435
     C*                                                               *   S01435
     C*****************************************************************   S01435
     C*                                                                   S01435
     C           USRP      CHAINMUSERDDF             89                   S01435
     C*                                                                   S01435
     C  N89      RECI      COMP 'D'                  8989                 S01435
      *                                                                   S01435
     C           *IN89     IFEQ '1'                                       S01435
     C                     MOVELUSRP      USER1                           S01435
     C                     END                                            S01435
     C*                                                                   S01435
     C*                    *****                                          S01435
     C                     ENDSR                                          S01435
     C*                    *****                                          S01435
      /EJECT
     C           CHOPF     BEGSR
      *          ******    *****
      *
      *****************************************************************
      *                 CHOP FIELD PROCESSING                         *
      *                                                               *
      *  FUNCTION : TO EDIT  SNCO, ORBK, CDRO  FOR OUTPUT.            *
      *             IF PRMFLD IS ZERO THEN OUTPUT BLANKS.             *
      *             IF PRMTYP IS 'N',OUTPUT FIRST TWO CHARS.          *
      *             IF PRMTYP ID 'R',OUTPUT FIRST TEN CHARS.          *
      *                                                               *
      *  CALLS :    NONE                                              *
      *                                                               *
      *  CALLED BY: CCDETL                                            *
      *                                                               *
      *****************************************************************
      *
     C           PRMFLD    IFEQ *ZEROS
     C                     MOVE *BLANKS   PRMFLD
     C                     ELSE
      *
     C           PRMTYP    IFEQ 'N'
     C                     MOVE BLNK10    PRMFLD
     C                     ELSE
      *
     C           PRMTYP    IFEQ 'R'
     C                     MOVE BLNK2     PRMFLD
      *
     C                     END
     C                     END
     C                     END
      *
      *                    *****
     C                     ENDSR
      *                    *****
     C/EJECT
     C           CELAST    BEGSR
      *          ******    *****
      *
      *****************************************************************
      *                 CE-LAST-RECORD-PROCESSING                     *
      *                                                               *
      *  FUNCTION : TO PERFORM CONTROL CHECKS WHEN THE TRAILER        *
      *             RECORD IS READ.                                   *
      *                                                               *
      *  CALLS :    NONE                                              *
      *                                                               *
      *  CALLED BY: AAMAIN                                            *
      *                                                               *
      *****************************************************************
      *
      ** PERFORM INITIAL PROCESSING IF FIRST CYCLE **
      *
     C           *IN20     IFEQ '0'
     C                     EXSR CAINIT
     C                     END
     C*                                                                   S01117
     C** Set up SBRA                                                      S01117
     C*                                                                   S01117
     C           @RLEV     IFNE 'S'                                       S01117
     C           *IN22     ANDEQ'1'                                       S01117
     C           @RENT     ANDNE'ALL'                                     S01117
     C                     MOVEL@RENT     KBRCH                           S01117
     C                     MOVE @RENT     SBRA                            S01117
     C                     EXSR AOBRC2                                    S01117
     C                     MOVE A8BRNM    PBRNM                           S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C** Move 'ALL' into SBRA                                             S01117
     C*                                                                   S01117
     C           @RENT     IFEQ 'ALL'                                     S01117
     C                     MOVE @RENT     SBRA                            S01117
     C                     MOVE *BLANKS   PBRNM                           S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C** If records exist for branch but have been cancelled              S01117
     C** set up branch field for audit report                             S01117
     C*                                                                   S01117
     C           SBRA      IFEQ *BLANKS                                   S01117
     C           *IN22     ANDEQ'1'                                       S01117
     C           @RLEV     ANDNE'S'                                       S01117
     C                     MOVEL@RENT     KBRCH                           S01117
     C                     MOVE @RENT     SBRA                            S01117
     C                     EXSR AOBRC2                                    S01117
     C                     MOVE A8BRNM    PBRNM                           S01117
     C                     END                                            S01117
      *
     C*********************Z-ADDZZTOTI    P2CLWN                          S01117
     C                     Z-ADDZZTOTI    AUCLWN                          S01117
     C*********************Z-ADDZZTOTD    P2CLDC                          S01117
     C                     Z-ADDZZTOTD    AUCLDC                          S01117
      *
      *
     C*                                                                   S01117
     C           *IN21     IFEQ '0'                        NO DETAIL
     C*********************WRITEP1HD                       ON THE         S01117
     C*********************WRITEP1NODT                     REPORT         S01117
     C*********************END                                            S01117
     C                     WRITEAUHEAD                                    S01117
     C                     WRITEAUNODT                                    S01117
     C                     WRITEAUEOR                                     S01117
     C                     ELSE                                           S01117
      *
      ** OUTPUT CONTROL REPORT
      *
     C*********************WRITEP2HEAD                                    S01117
     C*********************WRITEP2CNTL                                    S01117
     C*********************WRITEP2EOR                                     S01117
     C                     WRITEAUHEAD                                    S01117
     C                     WRITEAUCNTL                                    S01117
     C                     WRITEAUEOR                                     S01117
     C                     END                                            S01117
      *
      ** OUTPUT END-OF-REPORT MESSAGE TO DETAIL REPORT
      *
     C           *IN21     IFEQ '1'                                       S01117
     C                     WRITEP1EOR
     C                     END                                            S01117
      *
      ** TERMINATE PROGRAM
      *
     C                     SETON                     LR
      *
     C                     ENDSR
      /EJECT                                                              S01117
      *          ******    *****                                          S01117
     C           AOBRC2    BEGSR                                          S01117
      *          ******    *****                                          S01117
      *                                                                   S01117
      *****************************************************************   S01117
      *                 READ SDBRCHPD-FILE                            *   S01117
      *                                                               *   S01117
      *  FUNCTION : TO ACCESS A REQUESTED RECORD FROM THE BRANCH FILE *   S01117
      *                                                               *   S01117
      *  CALLS :    NONE                                              *   S01117
      *                                                               *   S01117
      *  CALLED BY:                                                   *   S01117
      *                                                               *   S01117
      *****************************************************************   S01117
     C**********           CALL 'AOBRCHR0'                                S01117              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM KBRCH     @BRCD   3                       S01117
     C********** SDBRCH    PARM SDBRCH    DSFDY                           S01117              CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C*                                                                   S01117
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     MOVELKBRCH     WDBKEY           ***************S01194
     C                     MOVEL'SDBRCHPD'WDBFIL           * DB ERROR 12 *S01194
     C                     MOVEL'010'     WDBASE           ***************S01194
     C                     EXSR UEABRT                                    S01194
     C                     END                                            S01194
     C*                                                                   S01117
     C                     ENDSR                                          S01117
      /EJECT
      *          ******    *****
     C           UATBCN    BEGSR
      *          ******    *****
      *
      *****************************************************************
      *                 UA-CHAIN-TABLE-FILE                           *
      *                                                               *
      *  FUNCTION : TO ATTEMPT TO ACCESS A REQUESTED RECORD FROM THE  *
      *             TABLE FILE.                                       *
      *                                                               *
      *  CALLS :    NONE                                              *
      *                                                               *
      *  CALLED BY: AAMAIN                                            *
      *             ECINST                                            *
      *                                                               *
      *****************************************************************
      *
     C           ZTABKY    CHAINTABFP                89
      *
     C  N89      RECI      COMP 'D'                  8989
      *
      *          *****     *****
     C           UAEND     ENDSR
      *          *****     *****
     C/EJECT
     C           UEABRT    BEGSR
      *          ******    *****
      *
      *****************************************************************
      *                 UE-ABORT-PROGRAM                              *
      *                                                               *
      *  FUNCTION : TO ABORT THE PROGRAM IN THE EVENT OF A DATABASE   *
      *             ERROR. ALSO TO SETUP THE RELEVANT FIELDS IN THE   *
      *             DATA AREA LDA FOR THIS ERROR.                     *
      *                                                               *
      *  CALLS :    NONE                                              *
      *                                                               *
      *  CALLED BY: AAMAIN                                            *
      *             ECINST                                            *
      *             EEAMND                                            *
      *                                                               *
      *****************************************************************
      *
      ** UPDATE DATA AREA LDA
      *
     C           *NAMVAR   DEFN           LDA
     C           *LOCK     IN   LDA
     C                     MOVEL'FT0515'  DBPGM
     C                     MOVELWDBFIL    DBFILE
     C                     MOVELWDBKEY    DBKEY
     C                     MOVELWDBASE    DBASE
     C                     OUT  LDA
      *
      ** SETON INDICATORS TO INDICATE DATABASE ERRORS
      *
     C                     SETON                     U7U8LR
      *
      ** REPORT DATABASE ERROR
      *
     C*********************WRITEP2HEAD                                    S01117
     C                     WRITEAUHEAD                                    S01117
      *
     C*********************WRITEP2DBER                                    S01194
     C                     WRITEAUDBER                                    S01194
      *
      ** PRODUCE PROGRAM DUMP
      *
     C                     DUMP
      *
      ** END PROGRAM
      *
     C                     RETRN
      *
      *          *****     *****
     C           UEEND     ENDSR
      *          *****     *****
     C/EJECT
     C           UGFRMT    BEGSR
      *          ******    *****
      *
      *****************************************************************
      *             UG-FORMAT-FIELD-FOR-OUTPUT-TO-REPORT              *
      *                                                               *
      *  FUNCTION : TO FORMAT A NUMERIC FIELD FROM THE PAYMENT        *
      *             CHARGES FILE FOR OUTPUT TO THE DETAIL SCREEN.     *
      *             IT REMOVES LEADING ZEROES & INSERTS A DECIMAL     *
      *             POINT IN THE APPROPRIATE POSITION.                *
      *                                                               *
      *  CALLS :    NONE                                              *
      *                                                               *
      *  CALLED BY: CADETL                                            *
      *                                                               *
      *****************************************************************
      *
     C                     MOVEAWFDIN     WA1,1
      *
      ** REPLACE LEADING ZEROES (IF LEFT OF DECIMAL POINT) WITH SPACES
      *
     C                     SETOF                     89
     C           15        SUB  WDIG      I       30        -START
     C                     SUB  WDEC      I                  POS.
      *
     C           14        SUB  WDEC      I1      30
      *
     C           *IN89     DOUEQ'1'
     C                     ADD  1         I
     C           I         IFGT 15                          -CHECK FOR
     C                     SETON                     89      ARRAY END
     C                     ELSE
     C           WA1,I     IFNE '0'                         -CHECK FOR
     C                     SETON                     89      NON-ZERO
     C                     ELSE                              DIGIT.
     C           I         IFLE I1
     C                     MOVEL' '       WA1,I
     C                     END
     C                     END
     C                     END
     C                     END
      *
      ** MOVE DIGITS TO RIGHT OF DECIMAL POINT(IF ANY) TO OUTPUT ARRAY
      ** & INSERT A DECIMAL POINT
      *
     C                     MOVEL*BLANKS   WA2
      *
     C           16        SUB  WDEC      I
     C           21        SUB  WDEC      I1
      *
     C           I         IFLE 15
     C                     MOVEAWA1,I     WA2,I1
     C                     SUB  1         I1
     C                     MOVEL'.'       WA2,I1
     C                     END
      *
      ** INSERT A COMMA AFTER EVERY 3 DIGITS TO LEFT OF DECIMAL POINT
      *
     C                     SUB  1         I
     C                     SUB  1         I1
     C                     Z-ADD*ZERO     I2      30
      *
     C           WA1,I     DOUEQ' '
     C           I         OREQ *ZERO
      *
     C           I2        IFEQ 3
     C                     MOVEL','       WA2,I1
     C                     SUB  1         I1
     C                     Z-ADD*ZERO     I2
     C                     END
      *
     C                     MOVE WA1,I     WA2,I1
     C                     SUB  1         I
     C                     SUB  1         I1
     C                     ADD  1         I2
     C                     END
      *
     C                     MOVEAWA2,1     WFDOUT 20
      *
      *          *****     *****
     C           UGEND     ENDSR
      *          *****     *****
     C/EJECT
      **
      **
      ********************************************************************
      * SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
      *   IND '99' IS SET BY AN OVERFLOW ERROR
      *
     C           GLZADD    BEGSR                           *** GLZADD ****
      *
     C                     Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
     C   91                GOTO ZZAEND                     AMT = 0.BYPASS
      *
      * SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
     C                     Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
     C                     MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
      * BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
      *
     C                     EXSR GLZSUM
     C           ZZAEND    ENDSR                           ** ZZAEND TAG *
     C/EJECT
      *
      ********************************************************************
      * SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
      *                        GLZADD, GLZSUB, GLZCMP.
      *          PARAMETERS PASSED -
      *                     I/P ZZAMTI ZZAMTD
      *                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
      *
     C           GLZSUM    BEGSR                           *** GLZSUM ****
      *
     C                     Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
     C                     Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
     C                     SETOF                     919293
     C                     SETOF                     949599
      *
      *    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
     C           ZZAMTI    COMP 0                      9293
     C   93      ZZAMTD    COMP 0                      9293
     C   93                GOTO ZZSEND                     ZERO BYPASS
      *
      *    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
     C           ZZTOTI    COMP 0                      9193
     C   93      ZZTOTD    COMP 0                      9193
      *
      *    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
     C   93                Z-ADDZZAMTI    ZZTOTI
     C   93                Z-ADDZZAMTD    ZZTOTD
     C   93                GOTO ZZSEND                     ZERO BYPASS
      *    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
     C   91N92
     CORN91 92             GOTO ZZOFPS
      *
     C           ZZAMTD    ADD  ZZTOTD    ZZWK2   40
     C           ZZWK2     COMP 999                  93    '93' = CARRY
     C  N93      ZZWK2     COMP -999                   93    INTO INTEGER.
      *
     C   93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
     C      93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
     C   93      ZZTOTI    ADD  ZZWK3     ZZWK3
     C  N93      ZZTOTI    ADD  ZZAMTI    ZZWK3
      *
      * IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
     C  N92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
     C   92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
     C  N99                Z-ADDZZWK2     ZZTOTD
     C  N99                Z-ADDZZWK3     ZZTOTI
      *
      * IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
     C   99                Z-ADD0         ZZAMT  153
     C                     GOTO ZZSEND
      *
      * THE 'SIGNS' ARE DIFFERENT
     C           ZZOFPS    TAG                             ** ZZOFPS TAG**
      * IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
      *
     C   92                Z-SUBZZAMTI    ZZAMTI 150
     C   92                Z-SUBZZAMTD    ZZAMTD  30
      *
      * IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
      *
     C   91                Z-SUBZZTOTI    ZZTOTI
     C   91                Z-SUBZZTOTD    ZZTOTD
      * BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
      *
     C           ZZTOTI    COMP ZZAMTI               93  95
     C   95      ZZTOTD    COMP ZZAMTD               93  95
      *
      * IF ZZTOT EQ. ZZAMT RETURN ZERO.
     C   95                Z-ADD0         ZZTOTI
     C   95                Z-ADD0         ZZTOTD
     C   95                GOTO ZZSEND
      *
      * IF ZZTOT GT. ZZAMT.
     C   93      ZZAMTD    COMP ZZTOTD               94
     C   93 94   ZZTOTI    SUB  1         ZZTOTI
     C   93 94   ZZTOTD    ADD  1000      ZZWK2
     C   93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
     C   93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
     C   93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
      *
      *
      * IF ZZAMT GT. ZZTOT.
     C  N93      ZZTOTD    COMP ZZAMTD               94
     C  N93 94   ZZAMTI    SUB  1         ZZWK3  150
     C  N93 94   ZZAMTD    ADD  1000      ZZWK2
     C  N93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
     C  N93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
     C  N93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
     C  N93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
      *
      * REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
     C                     SETOF                     94
     C   93 91
     CORN93 92             SETON                     94
     C   94                Z-SUBZZTOTI    ZZTOTI
     C   94                Z-SUBZZTOTD    ZZTOTD
      **
      **   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
     C   92                Z-SUBZZAMTI    ZZAMTI
     C   92                Z-SUBZZAMTD    ZZAMTD
     C           ZZSEND    TAG                             ** ZZSEND TAG *
      **
      **   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
     C                     SETOF                     96
     C           ZZTOTD    COMP 0                        91
     C   91      ZZTOTI    COMP 0                      96
     C   96                MOVE '.000-'   ZZNEGD  5
     C                     ENDSR                             ** ENDSR **
     C/EJECT
      **
      **
      ********************************************************************
      **
      **   ZDATE2 SR. TO CONVERT A DAY NUMBER TO DATE FORMATS.
      **
      **   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.
      **
     C           ZDATE2    BEGSR                           *** ZDATE2 ***
      **
      **   CLEAR DATE FIELDS.
     C                     Z-ADD0         ZDATE   60
     C                     MOVEL'       ' ZADATE  7
      **
      **   CALCULATION TO DEFINE INPUT DAY NUMBER.
     C                     Z-ADDZDAYNO    ZDAYNO  50
      **
      **   DETERMINE YEAR NUMBER.
      **
      **   ADJUST DAY NUMBER IN CASE LAST DAY OF YEAR.
     C           ZDAYNO    SUB  1         ZDAYN1  50   99
     C   99                GOTO ZDEND2
      **
      **   CALCULATE NUMBER OF 4 YEAR SPANS SINCE 31/12/1971.
     C           ZDAYN1    DIV  1461      ZLYR    20
     C                     MVR            ZDAYN1           SAVE REMAINING
      **                                                   DAYS
      **   CALCULATE NUMBER OF REMAINING YEARS.
     C                     Z-ADD1         ZWRK2   20
     C           ZDTAG1    TAG                             ** ZDTAG1 TAG *
     C           ZDAYN1    COMP ZYDY,ZWRK2             90
     C  N90      ZWRK2     ADD  1         ZWRK2
     C  N90                GOTO ZDTAG1
     C           ZWRK2     SUB  1         ZWRK2          91LEAP YR, 91 ON
      **
      **   DECREMENT DAY NO. BY DAYS IN REMAINING YEARS.
     C  N91      ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1
      **
      **   CALCULATE ACTUAL YEAR NUMBER.
     C           ZLYR      MULT 4         ZWRK3   30
     C           ZWRK3     ADD  72        ZWRK3            BASE IS 1972
     C                     Z-ADDZWRK3     ZYEAR   20
     C           ZYEAR     ADD  ZWRK2     ZYEAR            YEAR
      **
      **   DETERMINE MONTH NUMBER.
      **
      **   ADJUST DAY NO. IN CASE LAST DAY OF LEAP YEAR FEBRUARY.
     C                     SETOF                     9293
     C   91      ZDAYN1    COMP 59                     9293
     C   91N92   ZDAYN1    SUB  1         ZDAYN1
      **
      **   CALCULATE MONTH NUMBER.
     C                     Z-ADD2         ZWRK2
     C           ZDTAG2    TAG                             ** ZDTAG2 TAG *
     C           ZDAYN1    COMP ZMDY,ZWRK2             94
     C  N94      ZWRK2     ADD  1         ZWRK2
     C  N94                GOTO ZDTAG2
     C           ZWRK2     SUB  1         ZWRK2
      **
     C                     Z-ADDZWRK2     ZMTH    20       MONTH
      **
      **   DETERMINE DAY OF MONTH.
      **
      **   ADD BACK LAST DAY OF YEAR ADJUSTMENT.
     C           ZDAYN1    ADD  1         ZDAYN1
      **
      **   CALCULATE DAY OF MONTH.
     C           ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY
      **
      **   ADD BACK LEAP YEAR 29TH FEBUARY ADJUSTMENT, IF REQUIRED.
     C   93      ZDAY      ADD  1         ZDAY
      **
      **   FORMAT DATE, DDMMYY OR MMDDYY.
     C  N98                MOVELZDAY      ZWRK4   40
     C   98                MOVE ZDAY      ZWRK4
     C  N98                MOVE ZMTH      ZWRK4
     C   98                MOVELZMTH      ZWRK4
     C                     MOVELZWRK4     ZDATE
     C                     MOVE ZYEAR     ZDATE
      **
      **   FORMAT ALPHA DATE, DDMMMYY.
     C           ZDAY      COMP 10                     95
     C                     MOVELZDAY      ZWRK5   5
     C   95                MOVEL' '       ZWRK5
     C                     MOVE ZMNM,ZMTH ZWRK5
     C                     MOVELZWRK5     ZADATE
     C                     MOVE ZYEAR     ZADATE
      **
     C           ZDEND2    ENDSR                           * ZDEND2 ENDSR*
     C/EJECT
      **
      ********************************************************************
      **
      **
      *****ZSYSTM*SR.*TO*CHAIN*TO*THE*INSTALLATION*CONTROL*DATA*RECORD.*  S01117
      **   SYSTEM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.   S01117
      **
     C***********ZSYSTM    BEGSR                           *** ZSYSTEM ***S01117
     C           SYSTEM    BEGSR                           *** SYSTEM  ***S01117
     C*                                                                   S01117
     C** CALL ZSFILE TO LOG SPOOL FILE DETAILS                            S01117
     C*                                                                   S01117
     C                     Z-ADD1         PPAGE                           S01117
     C*                                                                   S01494
     C           *IN27     IFEQ '0'                                       S01494
     C                     MOVELSFILU     SFILP                           S01494
     C                     ELSE                                           S01494
     C***********          MOVEL'FT0516P1'SFILP                    S01494 165420
     C                     MOVEL'FT0516AU'SFILP                           165420
     C                     END                                            S01494
     C*                                                                   S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           @RSEQ                           S01117
     C                     PARM *BLANKS   ZSENT                           S01117
     C***********          PARM SFILU     SFILP                    S01117 S01494
     C                     PARM           SFILP                           S01494
     C                     PARM SFNUMU    SPLNO                           S01117
     C                     PARM *BLANKS   ZERR                            S01117
     C*                                                                   S01117
     C           ZERR      IFNE *BLANKS                                   S01117
     C                     SETON                     U7U8LR               S01117
     C           *LOCK     IN   LDA                                       S01117
     C                     MOVEL'FT0515'  DBPGM                           S01117
     C           *IN27     IFEQ '0'                                       S01494
     C                     MOVEL'FT515AU' DBKEY            ***************S01117
     C                     ELSE                                           S01494
     C                     MOVEL'FT516AU' DBKEY                           S01494
     C                     END                             ***************S01494
     C                     MOVEL'ZSFILE'  DBFILE           * DB ERROR 12 *S01117
     C                     MOVEL'012'     DBASE            ***************S01117
     C                     OUT  LDA                                       S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
      **
      **   SET UP KEY FOR INSTALLATION CONTROL RECORD.
     C                     MOVEL'01      'ZTABKY 12
     C                     MOVE '  10'    ZTABKY
      **
     C           ZTABKY    CHAINTABFP                99    ON NOT THERE
     C  N99      RECI      COMP 'D'                  9999  ON, IS DELETED
      **
      **   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.
     C           DATF      COMP 'M'                      98MMDDYY, 98 ON
      **
     C                     ENDSR
      /EJECT
      *****************************************************************
      **
      **
      **    FILE ERROR HANDLING
      **
      **    CALLED FROM:  anywhere
      **    CALLS:        *PSSR
      **
     C           FILESR    BEGSR                                       ***
     C                     SETON                         U8
     C                     MOVEL@FILE     @FILE
     C                     EXSR *PSSR
      **
     C                     ENDSR
      *****************************************************************
      **
      **
      **    DEFAULT ERROR HANDLING
      **
      **    CALLED FROM:  anywhere,FILESR
      **    CALLS:        returns.
      **
     C           *PSSR     BEGSR                                       ***
     C           WERROR    IFNE 'Y'
     C                     MOVE 'Y'       WERROR  1
     C                     DUMP
     C        NU8          SETON                       U7U8
     C           *LOCK     IN   LDA
     C                     MOVEL@PGM      DBPGM
     C                     MOVEL@KEY      DBKEY
     C                     MOVEL@FILE     DBFILE
     C                     MOVEL@ASE      DBASE
     C                     OUT  LDA
      *
      ** Print message on report.
     C                     WRITEAUHEAD                                    S01194
     C*********************WRITEP2DBER                                    S01194
     C                     WRITEAUDBER                                    S01194
     C                     END
      *
     C                     SETON                         LR
     C                     RETRN
      **
     C                     ENDSR
      **
      /EJECT                                                              CEU006
     C/COPY ZSRSRC,ZSEDITZ3                                               CEU006
      *                                                                   CEU006
     C/EJECT
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
**  DESC                                                                  CFT009
Telex Charge                                                              CFT009
Cheque Charge                                                             CFT009
Costs Abroad                                                              CFT009
Transfer Commission                                                       CFT009
Swift Priority Charge                                                     CFT009
Swift Standard Charge                                                     CFT009
FX/Change Commission Charge                                               CFT009
Miscellaneous Charge                                                      CFT009
Miscellaneous Charge 1                                                    CFT009
Miscellaneous Charge 2                                                    CFT009
Miscellaneous Charge 3                                                    CFT009
Miscellaneous Charge 4                                                    CFT009
Miscellaneous Charge 5                                                    CFT009
