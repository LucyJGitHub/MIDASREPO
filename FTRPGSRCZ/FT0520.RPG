     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas FT Incoming payments audit and report')          *
     F*****************************************************************
     F*                                                               *
     F*  Midas - Funds Transfer Module                                *
     F*                                                               *
     F*  FT0520 - Incoming Payments Reporting                         *
     F*                                                               *
      *  (c) Finastra International Limited 2001                      *
     F*                                                               *
      *  Last Amend No. MD061867           Date 24Oct23               *
      *  Prev Amend No. MD054954           Date 15Jan20               *
      *                 MD046248           Date 27Oct17               *
      *                 CFT157             Date 29Aug14               *
      *                 CFT120             Date 28Sep12               *
      *                 CER059             Date 19Jul10               *
      *                 BUG24261           Date 10Jun09               *
      *                 BUG23891           Date 05May09               *
      *                 BUG23869           Date 30Apr09               *
      *                 CER030             Date 09Jul08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 CSW209             Date 01Apr09               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 255028             Date 19Jun08               *
      *                 235937             Date 27Nov06               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CRE026             Date 24May06               *
      *                 CFT032             Date 11Sep06               *
      *                 BUG433             Date 05Dec05               *
      *                 CDL049             Date 07Jul06               *
      *                 CSD027             Date 09Dec05               *
      *                 BUG7985            Date 07Jul05               *
      *                 CER001             Date 25Apr05               *
      *                 TDA035             Date 02Apr04               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CFT009             Date 01Jun00               *
      * Midas DBA 3.04 -----------------------------------------------*
      *                 CFT014             Date 25May00               *
      * Midas DBA 3.03 -----------------------------------------------*
      *                 CAP136             Date 15Nov99               *
      *                 175479             DATE 08Feb00               *
      * Midas DBA 3.02 -----------------------------------------------*
     F*                 143852             DATE 13Oct99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
     F*                 135573             Date 26Apr98               *
      *                 CEU006             Date 01Apr98               *
      *                 122060             Date 05Nov97               *
      *                 073730             Date 22May96               *
     F*                 070846             Date 21May96               *
     F*                 094929             DATE 27OCT95               *
     F*                 S01408             DATE 04SEP95               *  *
     F*                 084523             DATE 10MAR95               *
     F*                 082130             DATE 09FEB95               *
     F*                 074815             DATE 19JUL94               *
     F*                 S01499             DATE 06JUN94               *
     F*                 S01494             DATE 25MAY94               *
     F*                 068172             DATE 18DEC93               *
     F*                 S01435             DATE 08SEP93               *
     F*                 S01408             DATE 24JUN93               *
     F*                 055293             DATE 17MAY93               *
     F*                 S01414             DATE 29MAR93               *
     F*                 E32921             DATE 21JUN91               *
     F*                 E32843             DATE 25APR91               *
     F*                 E32847             DATE 25APR91               *
     F*                 S01117             DATE 08OCT90               *
     F*                 S01194             DATE 08OCT90               *
     F*                 E23051             DATE 03AUG90               *
     F*                                                               *
     F*---------------------------------------------------------------*
     F*                                                               *
      *  MD061867 - Component FTC0520  00001 failed.                  *
      *           - Check printer overflow before printing P2NWRK.    *
      *  MD054954 - Changed indicator used in checking for CER031 to  *
      *             prevent conflict with the checking of CSW209      *
      *  MD046248 - Finastra Rebranding                               *
      *  CFT157 - Stop FT Transaction after Authorisation.            *
      *  CFT120 - FT IN/OP - Charges to DR of Account Currency        *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  BUG24261 - Transaction Type Code is not displayed in the     *
      *             report                                            *
      *  BUG23891 - Transaction Type incorrectly spelled in the       *
      *             report (Recompile)                                *
      *  BUG23869 - Dump in FT0510P1 and FT0520P1                     *
      *  CER030 - Multicash German Feature                            *
      *  CSW209 - SWIFT 2009 Changes                                  *
      *  255028 - DBASE16 if ext file INCHGC charge ccy blank         *
      *  235937 - Suppress database error in FT0315 for all fields    *
      *           that contain a SWIFT BIC ID which cannot be found   *
      *           in the BIC directory.                               *
      *  CRE026 - Consumer Banking (Recompile)                      *
      *  CFT032 - Account Line in Field 50X in MT103                  *
      *  BUG433 - Recompiled due to change in FTPCHGPD                *
      *  CDL049 - Addition of a Reference Rate field (recompile)      *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  BUG7985- Several components failed due to accessing TABLETR  *
      *  CER001 - LUX Upgrade to MidasPlus                            *
      *  TDA035 - RTS Signon changes for MidasPlus. (Recompile)       *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CFT009 - FT Fees and Charge Development                      *
      *  CFT014 - Straight-through Processing Phase 2 MT103           *
      *           Messages Generation for FT.                         *
      *  CAP136 - Conversion of FT Incoming Payment inputs into       *
      *           modular structure to use as APIs.                   *
      *           Recompiled over changed PF/INPAYDD.                 *
     A*  175479 - Recompiled over changes in INPAYDD                  *
     F*  143852 - Found two records for all requests. (Apply 137206). *
     F*           Report not being distributed by RCF.  Record P1     *
     F*           spooled file first to ensure entity is passed.      *
     F*  135573 - Applied existing fix SC#103145:-                    *
     F*           Report not distributed correctly as 'Sequence'      *
     F*           parameter is not passed to ZSFILE correctly.        *
      *  CEU006 - EMU FT Payments and Settlement.                     *
     F*  122060 - Drafts Issuance.                                    *
     F*  073730 - Prevent program ending abnormally if a Swift i.d.   *
     F*           is used in the Receivers Correspondent but is not   *
     F*           in the BIC directory.                               *
     F*  070846 - Suppress database error in FT0315 for deleted recs  *
     F*  094929 - Incoming payment audit list showed wrong charge     *
     F*           information                                         *
     F*  S01408 - Addition of hooks FT0520CCP1                        *  *
     F*                             FT0520CCP2                        *  *
     F*                             FT0520EEP1                        *  *
     F*                             FT0520IIP1                        *  *
     F*  084523 - NO DBERROR IF RECORD NOT FOUND FOR USER             *
     F*                                                               *
     F*  082130 - DO NOT INCLUDE DELETED PAYMENTS IN LIST MODE        *
     F*  074815 - Charge currency is sometimes incorrect              *
     F*           Fixed during development of S01494.                 *
     F*  S01499 - BLI V.A.T Processing                                *
     F*  S01494 - BLI Funds Transfer Enhancements                     *
     F*  068172 - ADD 1 LINE TO SET XCCY TO SMCY BEFOR THE CALL TO    *
     F*           FT0315 FOR ORDERING CUSTOMER.  MOVE BACK PCCY TO    *
     F*           XCCY RIGHT AFTER THE CALL TO FT0315.                *
     F*  S01435 - Incoming Message Management.                        *
     F*  S01408 - Core hook FT0520CPLH added                          *
     F*           Core hook FT0520FPG added                           *
     F*  055293 - Include account with institution details            *
     F*  S01414 - Book Code and Profit Centre Incorporation.          *
     F*  E32921 - Change OPIN = 'Y' or ' ' to 'YES' or 'NO '          *
     F*  E32843 - INCLUDE OVERRIDE FIELD                              *
     F*  E32847 - INCLUDE OUTGOING PAYMENT GENERATION                 *
     F*  S01117 - RELEASE 10 MULTIBRANCHING CHANGES                   *
     F*  S01194 - STANDING DATA CHANGES                               *
     F*  E23051 - OUTPUT FIELDS OF INPUT USERS AND AUTHORISERS        *
     F*           NOT RESET                                           *
     F*                                                               *
     F*****************************************************************
     F* ID F  C  H  L    FUNCTION OF INDICATORS
     F*
     F*       10      MULTIBRANCHING INDICATOR                            S01117
     F*       11      SYSTEM LEVEL INDICATOR                              S01117
     F*       12      DIRECT COB INDICATOR                                S01117
     F*       14      ORIGINATING/BOOKING BRANCH INDICATOR (ON IF ORIG BR)S01117
     F*       20      FIRST CYCLE PROCESSING HAS BEEN DONE
     F*       21      THERE HAS BEEN OUTPUT
     F*       30      CORE FEATURE S01494 IS SWITCHED ON                  S01494
     F*       31      CORE FEATURE S01499 IS SWITCHED ON                  S01499
     F*       50      AUDIT REPORT INDICATOR FOR REPORT
      *  55    - Notified Delivery Amount is not zero.                    CEU006
     F*       70      Profit Centres In Use Flag                          S01414
      *       77      Switchable feature CFT014 is installed.             CFT014
      *       88      Switchable feature CEU006 is installed.             CFT014
     F*       89      GENERAL WORK INDICATOR
     F********98******ZSYSTM,*DATE*FORMAT*MMDDYY*IF*ON.*                  S01117
     F********99******ZSYSTM,*INSTALLATION*CONTROL*DATA*RECORD*NOT*FOUND.*S01117
     F*       98      SYSTEM, DATE FORMAT MMDDYY IF ON.                   S01117
     F*       99      SYSTEM, INSTALLATION CONTROL DATA RECORD NOT FOUND. S01117
     F**
     F*     U7 & U8   DATABASE ERROR, REQUIRED RECORDS NOT FOUND.
     F*     U8 ONLY   FILE CONTROL ERROR
     F*****************************************************************
     F/EJECT
     F*INPAY***IP**E***********K********DISK                              S01117
     FINPAYBB IP  E           K        DISK                               S01117
     F*INPAYZZ*IS**E********************DISK                              S01117
     FINPAYZZ IF  E                    DISK                               S01117
     FINPAYXL2IF  E           K        DISK                           UC  CFT014
      * Incoming Payments Details Extension retrieval index               CFT014
      *                                                                   CFT014
     FTABFP   IF  E           K        DISK
     F            TABTB20F                          KIGNORE
     F            TABTG20F                          KIGNORE
     F************TABLETJF*************             KIGNORE               S01117
     F            TABLETLF                          KIGNORE
     F            TABLETPF                          KIGNORE
     F            TABLETHF                          KIGNORE               S01117
     F            TABTE10F                          KIGNORE               S01117
     F            TABTG40F                          KIGNORE               S01117
     F            TABLET5F                          KIGNORE               S01117
     FCLINT   IF  E           K        DISK
     F            CLINTCAF                          KIGNORE
     F            CLINTCBF                          KIGNORE
     F            CLINTSEF                          KIGNORE               S01117
     F            CLINTC1F                          KIGNORE               S01117
     FMUSER   IF  E           K        DISK
      *                                                                   CFT009
     FINPAYXL0IF  E           K        DISK                               CFT009
      *                                                                   CFT009
     F*FT0520P2O***E********************PRINTER                           S01117
     FFT0520AUO   E                    PRINTER      KINFDS SPOOL2         S01117
     F*FT0520P1O***E********************PRINTER                           S01117
     F/COPY WNCPYSRC,FT0520F001
     FFT0520P1O   E                    PRINTER      KINFDS SPOOL1     UC  S01117
     FFTPCHGL0IF  E           K        DISK                               CFT009
     C*                                                                   055293
     C** Core hook for externalisation.                                   S01408
     C/COPY WNCPYSRC,FT0520FPG                                            S01408
     C*                                                                   S01408
     E                    CPY@    1   1 80
     E                    WA1        15  1               UGFRMT SR.ARRY
     E                    WA2        20  1               UGFRMT SR.ARRY
     E                    ZYDY    4   4  4 0             ZDATE1/2 SR.ARRAY
     E                    ZMDY   13  13  3 0             ZDATE1/2 SR.ARRAY
     E                    ZMNM   12  12  3               ZDATE2 SR. ARRAY
     E*                                                                   S01408
     E                    DESC    1   5 30                                CFT009
     E/COPY WNCPYSRC,FT0520EEP1                                           S01408
      *                                                                                       CER001
      ** IBLC Extended informations array                                                     CER001
      *                                                                                       CER001
     E                    IUL         7132                                                    CER001
      *                                                                   CEU006
     E/COPY ZSRSRC,ZSEDITZ1                                               CEU006
     E/COPY ZSRSRC,ZEDITZ1                                                CFT009
     E*                                                                   S01408
     E/EJECT
     I*  DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
     ICPYR@#      DS
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
     I*
     I**  DATA AREA LDA - USED IN THE EVENT OF DATABASE ERRORS
     I*
     IDLDA        DS                            256
     I**************************************134 138 DBFILE                S01194
     I**************************************139 167 DBKEY                 S01194
     I**************************************168 175 DBPGM                 S01194
     I**************************************176 177 DBASE                 S01194
     I                                      134 141 DBFILE                S01194
     I                                      142 170 DBKEY                 S01194
     I                                      171 180 DBPGM                 S01194
     I                                      181 183 DBASE                 S01194
      **********                                                          S01435
      ********** Standardise to FT0525                                    S01435
      **********                                                          S01435
     I**********                                                    S01117S01435
     I***Data*structure for Sender field                            S01117S01435
     I*P1SND1****  DS                             35                S01117S01435
     I**********                             16  18 SND1BR          S01117S01435
     I**********                                                    S01117S01435
     I***Data*structure for Beneficiary Customer field              S01117S01435
     I*P1BNC1****  DS                             35                S01117S01435
     I**********                             13  15 BNC1BR          S01117S01435
      *                                                                   S01435
      ** Program data structure                                           S01435
     IDSPGM     ESDSY2PGDSP                                               S01435
      *                                                                   S01435
      *****************************************************************   S01435
      *  Data Structures for addresses.                                   S01435
      *                                                                   S01435
      ** OUT data structures (printout)                                   S01435
      *                                                                   S01435
      ** Senders .                                                        S01435
     IP1SDDS      DS                                                      S01435
     I                                        1  35 P1SND1                S01435
     I                                       36  70 P1SND2                S01435
     I                                       71 105 P1SND3                S01435
     I                                      106 140 P1SND4                S01435
     I                                      141 175 P1SND5                S01435
      *                                                                   CFT014
      ** Receiver's Correspondent                                         CFT014
      *                                                                   CFT014
     IRECODS      DS                                                      CFT014
     I                                        1  35 INRCO1                CFT014
     I                                       36  70 INRCO2                CFT014
     I                                       71 105 INRCO3                CFT014
     I                                      106 140 INRCO4                CFT014
     I                                      141 175 INRCO5                CFT014
      *                                                                   S01435
      ** Senders correspondent                                            S01435
     IP1SNDS      DS                                                      S01435
     I                                        1  35 P1SNC1                S01435
     I                                       36  70 P1SNC2                S01435
     I                                       71 105 P1SNC3                S01435
     I                                      106 140 P1SNC4                S01435
     I                                      141 175 P1SNC5                S01435
      *                                                                   S01435
      ** Ordering Customer                                                S01435
     IORCDS       DS                                                      S01435
     I                                        1  35 P1ORC1                S01435
     I                                       36  70 P1ORC2                S01435
     I                                       71 105 P1ORC3                S01435
     I                                      106 140 P1ORC4                S01435
     I                                      141 175 P1ORC5                S01435
      *                                                                   S01435
      ** Intermediary Bank                                                S01435
     IP1INDS      DS                                                      S01435
     I                                        1  35 P1INB1                S01435
     I                                       36  70 P1INB2                S01435
     I                                       71 105 P1INB3                S01435
     I                                      106 140 P1INB4                S01435
     I                                      141 175 P1INB5                S01435
      *                                                                   S01435
      ** Ordering Bank                                                    S01435
     IORBDS       DS                                                      S01435
     I                                        1  35 P1ORB1                S01435
     I                                       36  70 P1ORB2                S01435
     I                                       71 105 P1ORB3                S01435
     I                                      106 140 P1ORB4                S01435
     I                                      141 175 P1ORB5                S01435
      *                                                                   S01435
      ** Beneficiary Customer                                             S01435
     IP1BNDS      DS                                                      S01435
     I                                        1  35 P1BNC1                S01435
     I                                       36  70 P1BNC2                S01435
     I                                       71 105 P1BNC3                S01435
     I                                      106 140 P1BNC4                S01435
     I                                      141 175 P1BNC5                S01435
      *                                                                   S01435
      ** Account with Bank                                                S01435
     IP1ACDS      DS                                                      S01435
     I                                        1  35 P1ACB1                S01435
     I                                       36  70 P1ACB2                S01435
     I                                       71 105 P1ACB3                S01435
     I                                      106 140 P1ACB4                S01435
     I                                      141 175 P1ACB5                S01435
      *                                                                   S01435
      ** Receiver's Correspondent                                         S01435
     IP1RCDS      DS                                                      S01435
     I                                        1  35 P1RCO1                S01435
     I                                       36  70 P1RCO2                S01435
     I                                       71 105 P1RCO3                S01435
     I                                      106 140 P1RCO4                S01435
     I                                      141 175 P1RCO5                S01435
      *                                                                   S01435
      *                                                                   S01435
      ** IN data structures (file)                                        S01435
      *                                                                   S01435
      ** Senders .                                                        S01435
     ISDINDS      DS                                                      S01435
     I                                        1  35 SND1                  S01435
     I                                       36  70 SND2                  S01435
     I                                       71 105 SND3                  S01435
     I                                      106 140 SND4                  S01435
     I                                      141 175 SND5                  S01435
      *                                                                   S01435
      ** Senders correspondent                                            S01435
     ISNINDS      DS                                                      S01435
     I                                        1  35 SNC1                  S01435
     I                                       36  70 SNC2                  S01435
     I                                       71 105 SNC3                  S01435
     I                                      106 140 SNC4                  S01435
     I                                      141 175 SNC5                  S01435
      *                                                                   S01435
      ** Ordering Customer                                                S01435
     IORCDSI      DS                            175                       S01435
     I                                        1  35 ORC1                  S01435
     I                                       36  70 ORC2                  S01435
     I                                       71 105 ORC3                  S01435
     I                                      106 140 ORC4                  S01435
     I                                      141 175 ORC5                                      CFT032
      *                                                                   S01435
      *                                                                   S01435
      ** Intermediary Bank                                                S01435
     IININDS      DS                                                      S01435
     I                                        1  35 INB1                  S01435
     I                                       36  70 INB2                  S01435
     I                                       71 105 INB3                  S01435
     I                                      106 140 INB4                  S01435
     I                                      141 175 INB5                  S01435
      *                                                                   S01435
      ** Ordering Bank                                                    S01435
     IORBDSI      DS                                                      S01435
     I                                        1  35 ORB1                  S01435
     I                                       36  70 ORB2                  S01435
     I                                       71 105 ORB3                  S01435
     I                                      106 140 ORB4                  S01435
     I                                      141 175 ORB5                  S01435
      *                                                                   S01435
      ** Beneficiary Customer                                             S01435
     IBNINDS      DS                                                      S01435
     I                                        1  35 BNC1                  S01435
     I                                       36  70 BNC2                  S01435
     I                                       71 105 BNC3                  S01435
     I                                      106 140 BNC4                  S01435
     I                                      141 175 BNC5                  S01435
      *                                                                                       CSW209
      ** Ordering Customer Cover                                                              CSW209
      *                                                                                       CSW209
     IPNCOCC      DS                                                                          CSW209
     I                                        1  35 PNCOC1                                    CSW209
     I                                       36  70 PNCOC2                                    CSW209
     I                                       71 105 PNCOC3                                    CSW209
     I                                      106 140 PNCOC4                                    CSW209
     I                                      141 175 PNCOC5                                    CSW209
      *                                                                                       CSW209
      ** Ordering Institution Cover                                                           CSW209
      *                                                                                       CSW209
     IPNCOBC      DS                                                                          CSW209
     I                                        1  35 PNCOB1                                    CSW209
     I                                       36  70 PNCOB2                                    CSW209
     I                                       71 105 PNCOB3                                    CSW209
     I                                      106 140 PNCOB4                                    CSW209
     I                                      141 175 PNCOB5                                    CSW209
      *                                                                                       CSW209
      ** Intermediary Institution Cover                                                       CSW209
      *                                                                                       CSW209
     IPNCIBC      DS                                                                          CSW209
     I                                        1  35 PNCIB1                                    CSW209
     I                                       36  70 PNCIB2                                    CSW209
     I                                       71 105 PNCIB3                                    CSW209
     I                                      106 140 PNCIB4                                    CSW209
     I                                      141 175 PNCIB5                                    CSW209
      *                                                                                       CSW209
      ** Account with Institution Cover                                                       CSW209
      *                                                                                       CSW209
     IPNCABC      DS                                                                          CSW209
     I                                        1  35 PNCAB1                                    CSW209
     I                                       36  70 PNCAB2                                    CSW209
     I                                       71 105 PNCAB3                                    CSW209
     I                                      106 140 PNCAB4                                    CSW209
     I                                      141 175 PNCAB5                                    CSW209
      *                                                                                       CSW209
      ** Beneficiary Cover                                                                    CSW209
      *                                                                                       CSW209
     IPNCBCC      DS                                                                          CSW209
     I                                        1  35 PNCBC1                                    CSW209
     I                                       36  70 PNCBC2                                    CSW209
     I                                       71 105 PNCBC3                                    CSW209
     I                                      106 140 PNCBC4                                    CSW209
     I                                      141 175 PNCBC5                                    CSW209
      *                                                                                       CSW209
      ** Sender to Receiver Info Cover 1                                                      CSW209
      *                                                                                       CSW209
     IPNCBBC      DS                                                                          CSW209
     I                                        1  35 PNCBB1                                    CSW209
     I                                       36  70 PNCBB2                                    CSW209
     I                                       71 105 PNCBB3                                    CSW209
     I                                      106 140 PNCBB4                                    CSW209
     I                                      141 175 PNCBB5                                    CSW209
     I                                      176 210 PNCBB6                                    CSW209
      *                                                                                       CSW209
      ** Remittance Information Cover                                                         CSW209
      *                                                                                       CSW209
     IPNCDPC      DS                                                                          CSW209
     I                                        1  35 PNCDP1                                    CSW209
     I                                       36  70 PNCDP2                                    CSW209
     I                                       71 105 PNCDP3                                    CSW209
     I                                      106 140 PNCDP4                                    CSW209
      *                                                                   S01435
      ** Split name into components.                                      S01435
     IXNAMDS      DS                            175                       S01435
     I**********                              1  12 XACCT                              S01435 CGL029
     I**********                             13  15 XBRCA                              S01435 CGL029
     I                                        1  18 XACCT                                     CGL029
     I                                       19  21 XBRCA                                     CGL029
      *                                                                   S01435
      **            address lines 2 - 5.                                  S01435
     I                                       36 175 XADDS                 S01435
      *                                                                   S01435
      ** to define XTYPE.                                                 S01435
     IXTYPE       DS                              1                       S01435
      *                                                                   S01435
      *****************************************************************   S01435
     I*                                                                   S01117
     I** INFDS for P1 printer file .                                      S01117
     ISPOOL1      DS                                                      S01117
     I                                       83  92 SFILE1                S01117
     I                                    B 123 1240SFNUM1                S01117
     I                                    B 152 1530SFLIN                                   MD061867
     I                                    B 188 1890OFLLN                                   MD061867
     I                                    B 367 3680PRTLN                                   MD061867
     I*                                                                   S01194
     I** INFDS for AU printer file                                        S01194
     ISPOOL2      DS                                                      S01194
     I                                       83  92 SFILE2                S01194
     I                                    B 123 1240SFNUM2                S01194
     I*                                                                   S01194
     ISDFTFR    E DSSDFTFRPD                                              S01435
      *                                                                   S01435
      * Funds Transfer Details *                                          S01435
      *                                                                   S01435
     ISDGELR    E DSSDGELRPD                                              S01194
     I*External data structure for General Ledger Details                 S01194
     I*                                                                   S01194
     ISCSARD    E DSSCSARDPD                                              S01494
     I*External data structure for SAR file details                       S01494
     I*                                                                   S01494
     ISDCURR    E DSSDCURRPD                                              CFT014
     I*External Data structure for currencies file                        CFT014
     I*                                                                   S01194
     IDSFDY     E DSDSFDY                                                 S01194
     I*1st DS for access program , short data structure                   S01194
     I*                                                                   S01194
     IDSSDY     E DSDSSDY                                                 CFT014
     I* 2ND DS for access program , long data structure                   CFT014
     I*                                                                   CFT014
     ISDBRCH    E DSSDBRCHPD                                                                 BUG7985
      ** Midas SD Branch Codes                                                               BUG7985
      *                                                                                      BUG7985
      /EJECT                                                              S01435
     IW8FT        DS                            128                       S01435
      *                                                                   S01435
      * Address data structure                                            S01435
      *                                                                   S01435
      * Currency                                                          S01435
     I                                        1   3 W8CCY                 S01435
      * Settlement Type                                                   S01435
     I                                        4   5 W8STMT                S01435
      * Mandatory Text - convert BIC identifiers                          S01435
     I                                        6   6 W8MTXT                S01435
      * Message Tag                                                       S01435
     I                                        7  11 W8MTAG                S01435
      * Construct of data in field                                        S01435
     I                                       12  12 W8TYPE                S01435
      * Number of Lines available                                         S01435
     I                                       13  140W8NLIN                S01435
      * Network and Message Type                                          S01435
     I                                       15  20 W8NWRK                S01435
     I                                       21  23 W8MTPY                S01435
      * Calling Program                                                   S01435
     I                                       24  33 W8CPGM                S01435
      * Action *PRINT/*ENQ/*MSG GEN                                       S01435
     I                                       34  41 W8ACT                 S01435
      * Critical reporting - Database error if 'Y'                        S01435
      * If no BIC directory and BIC entered no error                      S01435
     I                                       42  42 W8CRIT                S01435
      * Force Midas Address - where possible                              S01435
     I                                       43  43 W8MADD                S01435
      * If Retail get first address from account                          S01435
     I                                       44  44 W8RTAD                S01435
      * Alternative Address                                               S01435
     I                                       45  45 W8ALTN                S01435
      * Address type selected in W0MSG                                    S01435
     I                                       46  46 W8ADTP                S01435
      *                                                                   S01435
     IDSMTR       DS                                                      S01435
      *                                                                   S01435
      *  Define fields for message transalation                           S01435
      *                                                                   S01435
     I                                        1 132 #MSDTA                S01435
     I                                       15  30 #MPREF                S01435
     I                                    P   1   20#MPART                S01435
     I                                      133 264 #MSTX1                S01435
     I#MSTX2      DS                                                      S01435
     I                                        1 256 #MSTXA                S01435
     I                                      257 512 #MSTXB                S01435
     I*                                                                   S01408
     I/COPY WNCPYSRC,FT0520IIP1                                           S01408
     ISDMMOD    E DSSDMMODPD                                                                  CER001
      *                                                                                       CER001
      ** DUMMY RECORD FORMATS FOR ACCESS TO MIDAS MODULES DETAILS                             CER001
      *                                                                                       CER001
     IILLINE      DS                            396                                           CER001
      *                                                                                       CER001
      ** Extended informations from IBLC 95                                                   CER001
      *                                                                                       CER001
     I                                        1 132 ILLIN1                                    CER001
     I                                      133 264 ILLIN2                                    CER001
     I                                      265 396 ILLIN3                                    CER001
      *                                                                   CEU006
     I/COPY ZSRSRC,ZSEDITZ2                                               CEU006
     I*                                                                   S01408
     I/EJECT
     C                     MOVEACPY@      BIS@   80
     C*****************************************************************
     C*                 AA-MAINLINE-PROCESSING                        *
     C*                                                               *
     C*  FUNCTION : TO CONTROL THE PROCESSING OF EACH RECORD READ VIA *
     C*             THE LOGIC CYCLE.                                  *
     C*                                                               *
     C*  CALLS :    CAINIT                                            *
     C*             CCDETL                                            *
     C*             CELAST                                            *
     C*             GLZADD                                            *
     C*                                                               *
     C*  CALLED BY: NONE                                              *
     C*                                                               *
     C*****************************************************************
     C*
     C** SAVE FIELDS FROM INPUT FILES WHICH MAY BE OVERWRITTEN BY OTHER
     C** FILE ACCESSES
     C*
     C                     MOVELRECI      OTRECI
     C                     Z-ADDLCD       OTLCD
     C                     MOVELCHTP      OTCHTP
     C*
     C** PERFORM INITIAL PROCESSING IF FIRST CYCLE **
     C*
     C           *IN20     IFEQ '0'
     C                     EXSR CAINIT
     C                     END
     C*                                                                   S01117
     C* SETON LR IF CHANGE OF BRANCH , @PLEV='B' AND @PENT NOT 'ALL'      S01117
     C*                                                                   S01117
     C           @PLEV     IFEQ 'B'                                       S01117
     C           @PENT     ANDNE'ALL'                                     S01117
     C           *IN14     IFEQ '0'                                       S01117
     C           BRCA      ANDNE@PENT                                     S01117
     C           *IN14     OREQ '1'                                       S01117
     C           ORBR      ANDNE@PENT                                     S01117
     C                     SETON                       LR                 S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C*
     C** FOR DETAIL RECORDS :
     C** WRITE A PAGE ON THE DETAIL REPORT IF REPORT TYPE IS 'LIST'
     C** AND THE PAYMENT IS NOT DELETED OR MATURED                        082130
     C** OR REPORT TYPE IS 'AUDIT LIST' & LAST CHANGE DATE IS EQUAL
     C** TO THE SYSTEM DATE
     C*
     C***********OTRECI    IFNE 'Z'                                       S01117
     C           *INLR     IFNE '1'                                       S01117
     C           PARM1     IFNE 'A'                         -NOT AUDIT
     C* IGNORE DELETED AND MATURED RECORDS
     C           OTRECI    IFNE 'C'
     C           OTRECI    ANDNE'M'
     C           OTCHTP    ANDNE'D'                                       082130
     C                     EXSR CCDETL                       LIST.
     C                     END
     C                     ELSE
     C           OTLCD     IFEQ RUND                        -AUDIT LIST
     C                     EXSR CCDETL
     C                     END
     C                     END
     C                     END
     C*
     C** ACCUMULATE VALUES FOR CONTROL CHECK USING SYSTEM SUBROUTINE
     C** GLZADD
     C*
     C***********OTRECI    IFNE 'Z'                                       S01117
     C           *INLR     IFNE '1'                                       S01117
     C*********************ADD  1         P2CLNO                          S01194
     C                     ADD  1         AUCLNO                          S01194
     C                     MOVE SMAM      ZZAMT
     C                     EXSR GLZADD
     C                     END
     C*
     C** PERFORM CONTROL REPORT CHECKS IF TRAILER RECORD
     C*
     C***********OTRECI    IFEQ 'Z'                                       S01117
     C*********************EXSR CELAST                                    S01117
     CLRN20                EXSR CAINIT                                    S01117
     CLR                   EXSR CELAST                                    S01117
     C*********************END                                            S01117
     C** Call SYSTM2 to create Audit Report File                          143852
     CLR                   EXSR SYSTM2                                    143852
     C*
     C*          *****     ***
     C           AAEND     TAG
     C*          *****     ***
     C** END OF MAINLINE PROCESSING
     C*
     C/EJECT
     C           CAINIT    BEGSR
     C*          ******    *****
     C*
     C*****************************************************************
     C*                 CA-INITIAL-PROCESSING                         *
     C*                                                               *
     C*  FUNCTION : TO PERFORM PROCESSING ONLY REQUIRED ONCE,ON FIRST *
     C*             CYCLE OF PROGRAM.                                 *
     C*                                                               *
     C*  CALLS :    UATBCN                                            *
     C*             UEABRT                                            *
     C**************ZSYSTM                                            *   S01117
     C*             SYSTEM                                            *   S01117
     C*                                                               *
     C*  CALLED BY: AAMAIN                                            *
     C*                                                               *
     C*****************************************************************
     C*
     C** DECLARE ENTRY PARAMETER - REPORT TYPE
     C*
     C           *ENTRY    PLIST
     C***********          PARM           @PSEQ   5                S01117 143852
     C           PSEQ      PARM           @PSEQ   5                       143852
     C                     PARM           @PLEV   1                       S01117
     C                     PARM           @PENT   3                       S01117
     C                     PARM           PARM1   1
     C*
     C** SETUP REPORT HEADING
     C*
     C           PARM1     IFEQ 'A'
     C                     MOVEL'AUDIT'   P1HEAD
     C                     MOVE 'LIST'    P1HEAD
     C                     MOVEL'~~~~~'   P1DASH
     C                     MOVE '~~~~~'   P1DASH
     C                     ELSE
     C                     MOVEL'LIST'    P1HEAD
     C                     MOVEL'~~~~'    P1DASH
     C                     END
     C*
     C** DECLARE SIMILAR FIELDS
     C*
     C           *LIKE     DEFN DBFILE    WDBFIL
     C           *LIKE     DEFN DBKEY     WDBKEY
     C           *LIKE     DEFN DBASE     WDBASE
     C*
     C           *LIKE     DEFN RECI      OTRECI
     C           *LIKE     DEFN LCD       OTLCD
     C           *LIKE     DEFN CHTP      OTCHTP
     C*
     C***CALL*ZSYSTM*TO*ACCESS*I.C.D.R.*1*ON*TABLE*FILE*                  S01117
     C** CALL SYSTEM TO ACCESS I.C.D.R. 1 ON TABLE FILE                   S01117
     C*
     C*********************EXSR ZSYSTM                                    S01117
     C                     EXSR SYSTEM                                    S01117
     C*
     C** CHECK IF DATABASE ERROR OCCURRED
     C*
     C           *IN99     IFEQ '1'
     C                     MOVEL'TABLE'   WDBFIL
     C                     MOVELZTABKY    WDBKEY
     C                     MOVEL'01'      WDBASE
     C                     EXSR UEABRT                     *ABORT PGM*
     C                     END
     C*
     C** SETUP REPORT TITLES & RUN-DATES
     C*
     C                     MOVELTITL      P1TITL
     C*********************MOVELTITL      P2TITL                          S01194
     C                     MOVELTITL      AUTITL                          S01194
     C                     MOVELRUNA      P1DATE
     C*********************MOVELRUNA      P2DATE                          S01194
     C                     MOVELRUNA      AUDATE                          S01194
     C*
     C**********           MOVE *BLANKS   BLNK10 10                                           CGL029
     C**********           MOVE *BLANKS   BLNK2   2                                           CGL029
     C                     MOVE *BLANKS   BLNK10 16                                           CGL029
     C                     MOVE *BLANKS   BLNK2   8                                           CGL029
     C*
     C** CALL UATBCN TO ACCESS I.C.D.R. 2 ON TABLE FILE
     C*
     C                     MOVEL*BLANKS   ZTABKY
     C                     MOVEL'01'      ZTABKY
     C                     MOVE '11'      ZTABKY
     C                     EXSR UATBCN
     C*
     C** CHECK IF DATABASE ERROR OCCURRED
     C*
     C           *IN89     IFEQ '1'
     C                     MOVEL'TABLE'   WDBFIL
     C                     MOVELZTABKY    WDBKEY
     C                     MOVEL'02'      WDBASE
     C                     EXSR UEABRT                     *ABORT PGM*
     C                     END
     C*                                                                   S01414
     C* Move the conditional IF so that AOGELRR0 is always called.        S01414
     C*                                                             S01117S01414
     C***SETON*MULTIBRANCHING*INDICATOR**********                   S01117S01414
     C*                                                             S01117S01414
     C***********MBIN******IFEQ 'Y'                        B001     S01117S01414
     C*********************SETON                     10             S01117S01414
     C*                                                                   S01117
     C** Call to General Ledger access pgm                                S01194
     C*                                                                   S01194
     C**********           CALL 'AOGELRR0'                                S01194              CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C********** SDGELR    PARM SDGELR    DSFDY                           S01194              CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     MOVEL'SDGELRPD'WDBFIL           ***************S01194
     C                     MOVEL@OPTN     WDBKEY           * DB ERROR 15 *S01194
     C                     MOVEL'15'      WDBASE           ***************S01194
     C                     EXSR UEABRT                                    S01194
     C                     ELSE                                           S01194
     C*                                                             S01117S01414
     C**  If multi branched set on 10 to display branch fields      S01117S01414
     C*                                                             S01117S01414
     C           MBIN      IFEQ 'Y'                                 S01117S01414
     C                     SETON                     10             S01117S01414
     C*                                                             S01117S01414
     C           BKOBRU    IFEQ 'Y'                                       S01194
     C                     MOVE '1'       *IN15                           S01194
     C                     END                                            S01194
     C                     END                                            S01194
      *
     C                     END                             E001           S01117
      *                                                                   S01414
      *  Check if Profit Centres are used and set screen attributes       S01414
      *                                                                   S01414
     C           BKPRCU    IFEQ 'Y'                                       S01414
     C                     MOVE '1'       *IN70                           S01414
     C                     END                                            S01414
      *                                                                   S01435
      ** Read SDFTFRPD                                                    S01435
      *                                                                   S01435
     C                     CALL 'AOFTFRR0'             90                 S01435
     C                     PARM *BLANKS   P@RTCD  7        B:Return code  S01435
     C                     PARM '*FIRST ' P@OPTN  7        I:Option       S01435
     C           SDFTFR    PARM SDFTFR    DSFDY                           S01435
      *                                                                   S01435
      *  If return with an error (LR seton in called program) then        S01435
      *  process for database error.                                      S01435
      *                                                                   S01435
     C           *IN90     IFEQ '1'                                       S01435
     C           P@RTCD    OREQ '*ERROR*'                                 S01435
     C                     MOVEL'SDFTFRPD'WDBFIL           ***************S01435
     C                     MOVELP@OPTN    WDBKEY           * DB ERROR 16 *S01435
     C                     MOVEL'50'      WDBASE           ***************S01435
     C                     EXSR UEABRT                                    S01435
     C                     END                                            S01435
      *                                                                   S01435
      * Get message text for Account with Bank field                      S01435
      *                                                                   S01435
     C                     CALL 'MEC1150'              9090               S01435
     C                     PARM 'FTM2350 '#MSGID  7                       S01435
     C                     PARM 'FTUSRMSG'#MSGF  10                       S01435
     C                     PARM           #MSDTA                          S01435
     C                     PARM *BLANKS   #MSTX1                          S01435
     C                     PARM *BLANKS   #MSTX2                          S01435
      *                                                                   S01435
     C                     MOVEL#MSTX1    #IMSG  35                       S01435
     C*
     C** CALL UATBCN TO ACCESS CURRENCY RECORD FOR BASE CURRENCY
     C*
     C                     MOVEL*BLANKS   ZTABKY
     C                     MOVEL'20'      ZTABKY
     C                     MOVELBCCY      WA4     4
     C                     MOVE '1'       WA4
     C                     MOVE WA4       ZTABKY
     C                     EXSR UATBCN
     C*
     C** CHECK IF DATABASE ERROR OCCURRED
     C*
     C           *IN89     IFEQ '1'
     C                     MOVEL'TABLE'   WDBFIL
     C                     MOVELZTABKY    WDBKEY
     C                     MOVEL'03'      WDBASE
     C                     EXSR UEABRT                     *ABORT PGM*
     C                     END
     C*
     C** STORE NUMBER OF DECIMAL PLACES FOR BASE CURRENCY
     C*
     C                     Z-ADDCDP       SVBCDP  10
      *                                                                   S01435
      ** Call UATBCN to Access local currency record                      S01435
      *                                                                   S01435
     C                     MOVEL*BLANKS   ZTABKY                          S01435
     C                     MOVEL'20'      ZTABKY                          S01435
     C                     MOVELLOCY      WA4                             S01435
     C                     MOVE '1'       WA4                             S01435
     C                     MOVE WA4       ZTABKY                          S01435
     C                     EXSR UATBCN                                    S01435
      *                                                                   S01435
      ** Check if database error occurred                                 S01435
      *                                                                   S01435
     C           *IN89     IFEQ '1'                                       S01435
     C                     MOVEL'TABLE'   WDBFIL                          S01435
     C                     MOVELZTABKY    WDBKEY                          S01435
     C                     MOVEL'51'      WDBASE                          S01435
     C                     EXSR UEABRT                     *ABORT PGM*    S01435
     C                     END                                            S01435
      *                                                                   S01435
      ** Store number of decimal places for base currency                 S01435
      *                                                                   S01435
     C                     Z-ADDCDP       SVLCDP  10                      S01435
     C*                                                                   S01494
     C** Access SAR details file to determine if S01494 is switched ON    S01494
     C*                                                                   S01494
     C                     MOVE '0'       *IN30                           S01494
     C                     CALL 'AOSARDR0'                                S01494
     C                     PARM *BLANKS   @RTCD   7                       S01494
     C                     PARM '*VERIFY' @OPTN   7                       S01494
     C                     PARM 'S01494'  @SARD   6                       S01494
     C           SCSARD    PARM SCSARD    DSFDY                           S01494
     C*                                                                   S01494
     C** If core feature is switched ON, set a variable to                S01494
     C** condition the rest of the processing                             S01494
     C*                                                                   S01494
     C           @RTCD     IFEQ *BLANKS                                   S01494
     C                     MOVE '1'       *IN30                           S01494
     C                     ELSE                                           S01494
     C*                                                                   S01494
     C** else, database error (return code other than *NRF)               S01494
     C*                                                                   S01494
     C           @RTCD     IFNE '*NRF   '                                 S01494
     C                     MOVEL'SCSARDPD'WDBFIL                          S01494
     C                     MOVEL'*VERIFY' WDBKEY                          S01494
     C                     MOVEL'40'      WDBASE                          S01494
     C                     EXSR UEABRT                     *ABORT PGM*    S01494
     C                     END                                            S01494
     C                     END                                            S01494
     C*                                                                   S01499
     C** Access SAR details file to determine if S01499 is switched ON    S01499
     C*                                                                   S01499
     C                     MOVE '0'       *IN31                           S01499
     C                     CALL 'AOSARDR0'                                S01499
     C                     PARM *BLANKS   @RTCD   7                       S01499
     C                     PARM '*VERIFY' @OPTN   7                       S01499
     C                     PARM 'S01499'  @SARD   6                       S01499
     C           SCSARD    PARM SCSARD    DSFDY                           S01499
     C*                                                                   S01499
     C** If core feature is switched ON, set a variable to                S01499
     C** condition the rest of the processing                             S01499
     C*                                                                   S01499
     C           @RTCD     IFEQ *BLANKS                                   S01499
     C                     MOVE '1'       *IN31                           S01499
     C                     ELSE                                           S01499
     C*                                                                   S01499
     C** else, database error (return code other than *NRF)               S01499
     C*                                                                   S01499
     C           @RTCD     IFNE '*NRF   '                                 S01499
     C                     MOVEL'SCSARDPD'WDBFIL                          S01499
     C                     MOVEL'*VERIFY' WDBKEY                          S01499
     C                     MOVEL'41'      WDBASE                          S01499
     C                     EXSR UEABRT                     *ABORT PGM*    S01499
     C                     END                                            S01499
     C                     END                                            S01499
      *                                                                   CFT009
      ** Access SAR details file to determine if CFT009 is switched ON    CFT009
      *                                                                   CFT009
     C                     MOVE '0'       *IN32                           CFT009
     C                     MOVE ' '       CFT009  1                       CFT009
     C                     CALL 'AOSARDR0'                                CFT009
     C                     PARM *BLANKS   @RTCD   7                       CFT009
     C                     PARM '*VERIFY' @OPTN   7                       CFT009
     C                     PARM 'CFT009'  @SARD   6                       CFT009
     C           SCSARD    PARM SCSARD    DSFDY                           CFT009
     C*                                                                   CFT009
     C** If core feature is switched ON, set a variable to                CFT009
     C** condition the rest of the processing                             CFT009
     C*                                                                   CFT009
     C           @RTCD     IFEQ *BLANKS                                   CFT009
     C                     MOVE '1'       *IN32                           CFT009
     C                     MOVE 'Y'       CFT009                          CFT009
     C                     ELSE                                           CFT009
     C*                                                                   CFT009
     C** else, database error (return code other than *NRF)               CFT009
     C*                                                                   CFT009
     C           @RTCD     IFNE '*NRF   '                                 CFT009
     C                     MOVEL'SCSARDPD'WDBFIL                          CFT009
     C                     MOVEL'*VERIFY' WDBKEY                          CFT009
     C                     MOVEL'04'      WDBASE                          CFT009
     C                     EXSR UEABRT                     *ABORT PGM*    CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Access SAR details file to determine if CFT010 is switched ON    CFT009
      *                                                                   CFT009
     C                     MOVE '0'       *IN33                           CFT009
     C                     MOVE ' '       CFT010  1                       CFT009
     C                     CALL 'AOSARDR0'                                CFT009
     C                     PARM *BLANKS   @RTCD   7                       CFT009
     C                     PARM '*VERIFY' @OPTN   7                       CFT009
     C                     PARM 'CFT010'  @SARD   6                       CFT009
     C           SCSARD    PARM SCSARD    DSFDY                           CFT009
     C*                                                                   CFT009
     C** If core feature is switched ON, set a variable to                CFT009
     C** condition the rest of the processing                             CFT009
     C*                                                                   CFT009
     C           @RTCD     IFEQ *BLANKS                                   CFT009
     C                     MOVE '1'       *IN33                           CFT009
     C                     MOVE 'Y'       CFT010                          CFT009
     C                     ELSE                                           CFT009
     C*                                                                   CFT009
     C** else, database error (return code other than *NRF)               CFT009
     C*                                                                   CFT009
     C           @RTCD     IFNE '*NRF   '                                 CFT009
     C                     MOVEL'SCSARDPD'WDBFIL                          CFT009
     C                     MOVEL'*VERIFY' WDBKEY                          CFT009
     C                     MOVEL'05'      WDBASE                          CFT009
     C                     EXSR UEABRT                     *ABORT PGM*    CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT014
      ** Access SAR details file to determine if CFT014 is switched ON    CFT014
      *                                                                   CFT014
     C                     MOVE *BLANK    CFT014  1                       CFT014
     C                     CALL 'AOSARDR0'                                CFT014
     C                     PARM *BLANKS   @RTCD                           CFT014
     C                     PARM '*VERIFY' @OPTN                           CFT014
     C                     PARM 'CFT014'  @SARD                           CFT014
     C           SCSARD    PARM SCSARD    DSFDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFEQ *BLANKS                                   CFT014
     C                     MOVE 'Y'       CFT014                          CFT014
     C                     MOVE *ON       *IN77                           CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE '*NRF   '                                 CFT014
     C                     MOVEL'SCSARDPD'WDBFIL                          CFT014
     C                     MOVEL'CFT014'  WDBKEY                          CFT014
     C                     MOVEL'20'      WDBASE                          CFT014
     C                     EXSR UEABRT                                    CFT014
     C                     ELSE                                           CFT014
     C                     MOVE 'N'       CFT014                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** If switchable feature CFT014 is installed, open INPAYXL2.        CFT014
      *                                                                   CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
     C                     OPEN INPAYXL2                                  CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Access SAR details file to determine if CEU006 is switched ON    CFT014
      *                                                                   CFT014
     C                     MOVE *BLANK    CEU006  1                       CFT014
     C                     CALL 'AOSARDR0'                                CFT014
     C                     PARM *BLANKS   @RTCD                           CFT014
     C                     PARM '*VERIFY' @OPTN                           CFT014
     C                     PARM 'CEU006'  @SARD                           CFT014
     C           SCSARD    PARM SCSARD    DSFDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFEQ *BLANKS                                   CFT014
     C                     MOVE 'Y'       CEU006                          CFT014
     C                     MOVE *ON       *IN88                           CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE '*NRF   '                                 CFT014
     C                     MOVEL'SCSARDPD'WDBFIL                          CFT014
     C                     MOVEL'CEU006'  WDBKEY                          CFT014
     C                     MOVEL'021'     WDBASE                          CFT014
     C                     EXSR UEABRT                                    CFT014
     C                     ELSE                                           CFT014
     C                     MOVE 'N'       CEU006                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Check if CSW209 feature is ON                                                        CSW209
      *                                                                                       CSW209
     C                     MOVE 'N'       CSW209  1                                           CSW209
     C                     CALL 'SWIF2009'                                                    CSW209
     C                     PARM *BLANKS   @RTCD                                               CSW209
      *                                                                                       CSW209
     C           @RTCD     IFEQ 'CSW2009'                                                     CSW209
     C                     MOVE 'Y'       CSW209                                              CSW209
     C                     SETON                     34                                       CSW209
     C                     ELSE                                                               CSW209
     C                     SETOF                     34                                       CSW209
     C                     ENDIF                                                              CSW209
      *
     C/COPY WNCPYSRC,FT0520C004
      *                                                                                       CFT157
     C                     MOVE 'N'       CFT157  1                                           CFT157
     C                     CALL 'AOSARDR0'                                                    CFT157
     C                     PARM *BLANKS   @RTCD                                               CFT157
     C                     PARM '*VERIFY' @OPTN                                               CFT157
     C                     PARM 'CFT157'  @SARD                                               CFT157
     C           SCSARD    PARM SCSARD    DSFDY                                               CFT157
     C*                                                                                       CFT157
     C** If feature is switched ON, set a variable field to                                   CFT157
     C** condition the rest of the processing                                                 CFT157
     C*                                                                                       CFT157
     C           @RTCD     IFEQ *BLANKS                                                       CFT157
     C                     MOVE 'Y'       CFT157                                              CFT157
     C                     ELSE                                                               CFT157
     C*                                                                                       CFT157
     C** else, database error (return code other than *NRF)                                   CFT157
     C*                                                                                       CFT157
     C           @RTCD     IFNE '*NRF   '                                                     CFT157
     C                     MOVEL'SCSARDPD'WDBFIL                                              CFT157
     C                     MOVEL'*VERIFY' WDBKEY                                              CFT157
     C                     MOVEL'40'      WDBASE                                              CFT157
     C                     EXSR UEABRT                     *ABORT PGM*                        CFT157
     C                     END                                                                CFT157
     C                     END                                                                CFT157
      *                                                                                       CER001
      ** check whether feature ULX043 is installed                                            CER001
      *                                                                                       CER001
     C                     MOVE 'N'       ULX043  1                                           CER001
     C                     CALL 'AOSARDR0'                                                    CER001
     C                     PARM *BLANKS   @RTCD                                               CER001
     C                     PARM '*VERIFY' @OPTN                                               CER001
     C                     PARM 'ULX043'  @SARD                                               CER001
      *                                                                                       CER001
     C           @RTCD     IFEQ *BLANKS                                                       CER001
     C                     MOVE 'Y'       ULX043                                              CER001
     C                     ELSE                                                               CER001
      *                                                                                       CER001
     C           @RTCD     IFNE '*NRF   '                                                     CER001
     C                     MOVEL'SCSARDPD'WDBFIL                                              CER001
     C                     MOVEL'ULX043'  WDBKEY                                              CER001
     C                     MOVEL'054'     WDBASE                                              CER001
     C                     EXSR UEABRT                                                        CER001
     C                     ENDIF                                                              CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER030
      ** Check if 'CER031' is switched 'ON'                                                   CER030
      *                                                                                       CER030
     C                     MOVE 'N'       CER031  1                                           CER030
     C**********           MOVE *OFF      *IN34                                      CER030 MD054954
     C                     MOVE *OFF      *IN36                                             MD054954
      *                                                                                       CER030
     C                     CALL 'AOSARDR0'                                                    CER030
     C                     PARM *BLANKS   PRTCD                                               CER030
     C                     PARM '*VERIFY' POPTN                                               CER030
     C                     PARM 'CER031'  PSARD   6                                           CER030
     C           SCSARD    PARM SCSARD    DSFDY                                               CER030
      *                                                                                       CER030
     C           PRTCD     IFEQ *BLANKS                                                       CER030
     C                     MOVE 'Y'       CER031                                              CER030
     C**********           MOVE *ON       *IN34                                      CER030 MD054954
     C                     MOVE *ON       *IN36                                             MD054954
     C                     ELSE                                                               CER030
      *                                                                                       CER030
      ** else, database error (return code other than *NRF)                                   CER030
      *                                                                                       CER030
     C           PRTCD     IFNE '*NRF   '                                                     CER030
     C                     MOVEL'SCSARDPD'WDBFIL                                              CER030
     C                     MOVEL'*VERIFY' WDBKEY                                              CER030
     C                     MOVEL'55'      WDBASE                                              CER030
     C                     EXSR UEABRT                                                        CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      ** Check if 'CER030' is switched 'ON'                                                   CER030
      *                                                                                       CER030
     C                     MOVE 'N'       CER030  1                                           CER030
     C                     MOVE *OFF      *IN35                                               CER030
      *                                                                                       CER030
     C                     CALL 'AOSARDR0'                                                    CER030
     C                     PARM *BLANKS   PRTCD                                               CER030
     C                     PARM '*VERIFY' POPTN                                               CER030
     C                     PARM 'CER030'  PSARD                                               CER030
     C           SCSARD    PARM SCSARD    DSFDY                                               CER030
      *                                                                                       CER030
     C           PRTCD     IFEQ *BLANKS                                                       CER030
     C                     MOVE 'Y'       CER030                                              CER030
     C                     MOVE *ON       *IN35                                               CER030
     C                     ELSE                                                               CER030
      *                                                                                       CER030
      ** else, database error (return code other than *NRF)                                   CER030
      *                                                                                       CER030
     C           PRTCD     IFNE '*NRF   '                                                     CER030
     C                     MOVEL'SCSARDPD'WDBFIL                                              CER030
     C                     MOVEL'*VERIFY' WDBKEY                                              CER030
     C                     MOVEL'56'      WDBASE                                              CER030
     C                     EXSR UEABRT                                                        CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      ** Check if 'CGL013' is switched 'ON'                                                   CER030
      *                                                                                       CER030
     C                     MOVE 'N'       CGL013  1                                           CER030
      *                                                                                       CER030
     C                     CALL 'AOSARDR0'                                                    CER030
     C                     PARM *BLANKS   PRTCD                                               CER030
     C                     PARM '*VERIFY' POPTN                                               CER030
     C                     PARM 'CGL013'  PSARD                                               CER030
     C           SCSARD    PARM SCSARD    DSFDY                                               CER030
      *                                                                                       CER030
     C           PRTCD     IFEQ *BLANKS                                                       CER030
     C                     MOVE 'Y'       CGL013                                              CER030
     C                     MOVE *ON       *IN35                                               CER030
     C                     ELSE                                                               CER030
      *                                                                                       CER030
      ** else, database error (return code other than *NRF)                                   CER030
      *                                                                                       CER030
     C           PRTCD     IFNE '*NRF   '                                                     CER030
     C                     MOVEL'SCSARDPD'WDBFIL                                              CER030
     C                     MOVEL'*VERIFY' WDBKEY                                              CER030
     C                     MOVEL'57'      WDBASE                                              CER030
     C                     EXSR UEABRT                                                        CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CFT120
      ** Check if 'CFT120' is switched 'ON'                                                   CFT120
      *                                                                                       CFT120
     C                     MOVE 'N'       CFT120  1                                           CFT120
      *                                                                                       CFT120
     C                     CALL 'AOSARDR0'                                                    CFT120
     C                     PARM *BLANKS   PRTCD                                               CFT120
     C                     PARM '*VERIFY' POPTN                                               CFT120
     C                     PARM 'CFT120'  PSARD                                               CFT120
     C           SCSARD    PARM SCSARD    DSFDY                                               CFT120
      *                                                                                       CFT120
     C           PRTCD     IFEQ *BLANKS                                                       CFT120
     C                     MOVE 'Y'       CFT120                                              CFT120
     C                     MOVE *ON       *IN59                                               CFT120
     C                     ELSE                                                               CFT120
      *                                                                                       CFT120
      ** else, database error (return code other than *NRF)                                   CFT120
      *                                                                                       CFT120
     C           PRTCD     IFNE '*NRF   '                                                     CFT120
     C                     MOVEL'SCSARDPD'WDBFIL                                              CFT120
     C                     MOVEL'*VERIFY' WDBKEY                                              CFT120
     C                     MOVEL'58'      WDBASE                                              CFT120
     C                     EXSR UEABRT                                                        CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
     C                     ENDIF                                                              CFT120
     C*                                                                   S01117
     C** SETON SYSTEM LEVEL INDICATOR                                     S01117
     C*                                                                   S01117
     C           @PLEV     IFEQ 'S'                                       S01117
     C                     SETON                     11                   S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C** SETON DIRECT COB INDICATOR                                       S01117
     C*                                                                   S01117
     C           PARM1     IFEQ 'A'                                       S01117
     C                     SETON                     12                   S01117
     C                     ELSE                                           S01117
     C           PARM1     IFEQ 'O'                                       S01117
     C                     SETON                     14                   S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0520CCP1                                           S01408
     C*                                                                   S01408
      *                                                                                       CER001
      ** CALL ACCESS PROGRAM FOR MIDAS MODULES DETAILS                                        CER001
      *                                                                                       CER001
     C                     CALL 'AOMMODR0'                                                    CER001
     C                     PARM '*MSG    '@RTCD   7                                           CER001
     C                     PARM '*FIRST  '@OPTN   7                                           CER001
     C           SDMMOD    PARM SDMMOD    DSFDY                                               CER001
     C*                                                                                       CER001
     C           @RTCD     IFNE *BLANKS                                                       CER001
     C                     MOVE 'N'       BGNWST                                              CER001
     C                     ENDIF                                                              CER001
     C*
     C** SETON INDICATOR TO SHOW THAT INITIAL PROCESSING HAS BEEN DONE
     C*
     C                     SETON                     20
     C*
     C/COPY WNCPYSRC,FT0520C005
     C*          *****     *****
     C           CAEND     ENDSR
     C*          *****     *****
     C/EJECT
     C           CCDETL    BEGSR
     C*          ******    *****
     C*
     C*****************************************************************
     C*                 CC-DETAIL-PROCESSING                          *
     C*                                                               *
     C*  FUNCTION : TO PRODUCE A PAGE ON THE DETAIL REPORT BASED ON   *
     C*             DATA FROM INPUT RECORD.                           *
     C*                                                               *
     C*  CALLS :    UATBCN                                            *
     C*             UCCLCN                                            *
     C*             UEABRT                                            *
     C*             UGFRMT                                            *
     C*             CHOPF                                             *
     C*             ZDATE2                                            *
     C*                                                               *
     C*  CALLED BY: AAMAIN                                            *
     C*                                                               *
     C*****************************************************************
      *                                                                   CFT014
      ** Access INPAYXL2 if switchable feature CFT014 is installed.       CFT014
      *                                                                   CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
     C********** CFT009    ANDEQ'Y'                                                BUG23869 BUG24261
      *                                                                   CFT014
     C           PREF      CHAININPAYXL2             90                   CFT014
      *                                                                   CFT014
      ** If record does not exist and switchable feature CFT014           CFT014
      ** is installed, do error routine.                                  CFT014
      *                                                                   CFT014
     C           *IN90     IFEQ '1'                                       CFT014
     C                     MOVEL'INPAYXL2'WDBFIL                          CFT014
     C                     MOVELPREF      WDBKEY                          CFT014
     C                     MOVEL'022'     WDBASE                          CFT014
     C                     EXSR UEABRT                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
     C*
     C** SETUP STATUS OF RECORD
     C*
     C                     MOVEL*BLANKS   SSUSR                                               CFT157
     C                     MOVEL*BLANKS   SSAUS                                               CFT157
     C           PARM1     IFNE 'A'
     C                     MOVE *BLANK    P1STTS
     C                     ELSE
     C           OTCHTP    IFEQ 'I'
     C                     MOVEL'* INSERT'P1STTS
     C                     MOVE 'ED *'    P1STTS
     C                     ELSE
     C           OTCHTP    IFEQ 'A'
     C                     MOVEL'* AMENDE'P1STTS
     C                     MOVE 'D * '    P1STTS
     C                     ELSE
     C                     MOVEL'* DELETE'P1STTS
     C                     MOVE 'D * '    P1STTS
     C                     END
     C                     END
     C                     END
     C/COPY WNCPYSRC,FTH00434
      *                                                                                       CFT157
     C           CFT157    IFEQ 'Y'                                                           CFT157
     C           PARM1     ANDEQ'A'                                                           CFT157
     C           OTCHTP    ANDEQ'S'                                                           CFT157
     C                     MOVE *BLANKS   P1STTS                                              CFT157
     C                     MOVEL'* STOPPE'P1STTS                                              CFT157
     C                     MOVE 'D * '    P1STTS                                              CFT157
     C                     MOVELSUSR      SSUSR                                               CFT157
     C                     MOVELSAUS      SSAUS                                               CFT157
     C                     END                                                                CFT157
      *                                                                   055293
      * Clear Receiver's Correspondent and Account with bank prt flds     055293
      *                                                                   055293
     C                     MOVEL*BLANKS   P1ACBK                          055293
     C                     MOVEL*BLANKS   P1ACDS                          055293
     C                     MOVEL*BLANKS   P1RCDS                          055293
     C***********          MOVEL*BLANKS   P1RCCO                   055293 CFT014
      *                                                                   055293
      * Set up Account with Institution Details                           055293
      *                                                                   055293
     C           INACB1    IFNE *BLANKS                                   S01435
      *                                                                   S01435
      * If SWIFT type A translate else leave as on message                S01435
      *                                                                   S01435
     C                     MOVEL#IMSG     P1ACBK                          S01435
     C           INACBT    IFNE 'S'                                       S01435
     C                     MOVELINACB1    P1ACB1                          055293
     C                     MOVELINACB2    P1ACB2                          055293
     C                     MOVELINACB3    P1ACB3                          055293
     C                     MOVELINACB4    P1ACB4                          055293
     C                     MOVELINACB5    P1ACB5                          055293
     C                     ELSE                                           S01435
     C                     MOVEL'ACBT'    XCALL                           S01435
     C                     MOVELINACBT    XTYPE                           S01435
     C                     MOVEL*BLANKS   XNAMDS                          S01435
     C                     MOVELINACB1    ##001   1                       S01435
     C           ##001     IFEQ '/'                                       S01435
     C                     MOVELINACB2    XNAMDS                          S01435
     C                     ELSE                                           S01435
     C                     MOVELINACB1    XNAMDS                          S01435
     C                     END                                            S01435
     C                     EXSR GETADD                                    S01435
     C                     MOVELXNAMDS    P1ACDS                          S01435
     C                     END                                            S01435
     C                     END                                            S01435
      *                                                                   055293
      * Translate input account with bank                                 055293
      *                                                                   055293
     C           ACBT      IFNE *BLANKS                                   S01435
     C                     MOVEL'ACBT'    XCALL                           S01435
     C                     MOVELACBT      XTYPE                           S01435
     C                     MOVELPCCY      XCCY                            S01435
     C                     MOVEL*BLANKS   XNAMDS                          S01435
     C                     MOVELACBK      XNAMDS                          S01435
     C                     MOVE ACBB      XBRCA                           S01435
     C                     EXSR GETADD                                    S01435
     C           INACB1    IFEQ *BLANKS                                   S01435
     C                     MOVELXADDS     P1ACDS                          S01435
     C                     END                                            S01435
     C                     MOVELXNAMDS    P1ACBK                          S01435
     C                     END                                            S01435
      *                                                                   055293
      * Set up Receivers Correspondant Details                            055293
      *                                                                   055293
     C***********INRCO1    IFNE *BLANKS                            S01435 CFT014
      *                                                                   S01435
      * If SWIFT type A translate else leave as on message                S01435
      *                                                                   S01435
     C***********          MOVEL#IMSG     P1RCCO                   S01435 CFT014
     C***********INRCRT    IFNE 'S'                                S01435 CFT014
     C***********          MOVELINRCO1    P1RCO1                   055293 CFT014
     C***********          MOVELINRCO2    P1RCO2                   055293 CFT014
     C***********          MOVELINRCO3    P1RCO3                   055293 CFT014
     C***********          MOVELINRCO4    P1RCO4                   055293 CFT014
     C***********          MOVELINRCO5    P1RCO5                   055293 CFT014
     C***********          ELSE                                    S01435 CFT014
     C***********          MOVEL'RCRT'    XCALL                     S01435073730
     C***********          MOVEL'MRCR'    XCALL                    073730 CFT014
     C***********          MOVELINRCRT    XTYPE                    S01435 CFT014
     C***********          MOVEL*BLANKS   XNAMDS                   S01435 CFT014
     C***********          MOVELINRCO1    ##001   1                S01435 CFT014
     C***********##001     IFEQ '/'                                S01435 CFT014
     C***********          MOVELINRCO2    XNAMDS                   S01435 CFT014
     C***********          ELSE                                    S01435 CFT014
     C***********          MOVELINRCO1    XNAMDS                   S01435 CFT014
     C***********          END                                     S01435 CFT014
     C***********          EXSR GETADD                             S01435 CFT014
     C***********          MOVELXNAMDS    P1RCDS                   S01435 CFT014
     C***********          END                                     S01435 CFT014
     C***********          END                                     S01435 CFT014
      *                                                                   055293
      * Translate as no message info                                      055293
      *                                                                   055293
     C***********RCRT      IFNE *BLANKS                            S01435 CFT014
     C***********          MOVEL'RCRT'    XCALL                    S01435 CFT014
     C***********          MOVELRCRT      XTYPE                    S01435 CFT014
     C***********          MOVELSMCY      XCCY                     S01435 CFT014
     C***********          MOVEL*BLANKS   XNAMDS                   S01435 CFT014
     C***********          MOVELRCCO      XNAMDS                   S01435 CFT014
     C***********          EXSR GETADD                             S01435 CFT014
     C***********INRCO1    IFEQ *BLANKS                            S01435 CFT014
     C***********          MOVELXADDS     P1RCDS                   S01435 CFT014
     C***********          END                                     S01435 CFT014
     C***********          MOVELXNAMDS    P1RCCO                   S01435 CFT014
     C***********          END                                     S01435 CFT014
     C*                                                                   S01435
     C** SENDER                                                           S01435
     C*                                                                   S01435
     C                     MOVEL'SNTP'    XCALL   4                       S01435
     C                     MOVELSNTP      XTYPE                           S01435
     C                     MOVELSMCY      XCCY                            CFT014
     C                     MOVELSDINDS    XNAMDS                          S01435
     C                     EXSR GETADD                                    S01435
     C                     MOVELXNAMDS    P1SDDS                          S01435
      *                                                                   CFT014
      ** Format of Receiver's Correspondent                               CFT014
      *                                                                   CFT014
     C                     MOVEL'RCRT'    XCALL                           CFT014
     C                     MOVELINRCRT    XTYPE                           CFT014
     C                     MOVELRECODS    XNAMDS                          CFT014
     C                     EXSR GETADD                                    CFT014
     C                     MOVELXNAMDS    P1RCDS                          CFT014
      *                                                                   S01435
     C*                                                                   S01435
     C** INTERMEDIARY BANK                                                S01435
     C*                                                                   S01435
     C                     MOVEL'INBT'    XCALL   4                       S01435
     C                     MOVELINBT      XTYPE                           S01435
     C                     MOVELININDS    XNAMDS                          S01435
     C                     EXSR GETADD                                    S01435
     C                     MOVELXNAMDS    P1INDS                          S01435
      *                                                                   S01435
     C*                                                                   S01435
     C*                                                                   S01435
     C** SENDER'S CORRESPONDENT                                           S01435
     C*                                                                   S01435
     C                     MOVEL'SNCT'    XCALL   4                       S01435
     C                     MOVELSNCT      XTYPE                           S01435
     C                     MOVELSNINDS    XNAMDS                          S01435
     C                     EXSR GETADD                                    S01435
     C                     MOVELXNAMDS    P1SNDS                          S01435
      *                                                                   S01435
     C*                                                                   S01435
     C** ORDERING BANK                                                    S01435
     C*                                                                   S01435
     C                     MOVEL'ORBT'    XCALL   4                       S01435
     C                     MOVELORBT      XTYPE                           S01435
     C                     MOVELORBDSI    XNAMDS                          S01435
     C                     EXSR GETADD                                    S01435
     C                     MOVELXNAMDS    ORBDS                           S01435
      *                                                                   S01435
     C*                                                                   S01435
     C** BENEFICIARY CUSTOMER                                             S01435
     C*                                                                   S01435
     C                     MOVEL'BNCT'    XCALL   4                       S01435
     C                     MOVELBNCT      XTYPE                           S01435
     C                     MOVELPCCY      XCCY                            068172
     C                     MOVELBNINDS    XNAMDS                          S01435
     C                     EXSR GETADD                                    S01435
     C                     MOVELXNAMDS    P1BNDS                          S01435
     C*                                                                   S01435
     C** ORDERING CUSTOMER                                                S01435
     C*                                                                   S01435
     C                     MOVEL'ORCT'    XCALL   4                       S01435
     C                     MOVELORCT      XTYPE                           S01435
     C                     MOVELORCDSI    XNAMDS                          S01435
     C                     EXSR GETADD                                    S01435
     C                     MOVELXNAMDS    ORCDS                           S01435
      *                                                                   S01435
     C                     MOVE *BLANKS   XCALL   4                       S01435
      *                                                                   S01435
     C************                                                        S01435
     C***SETUP*ADDRESS FIELDS,ACESSING CLINT AS APPROPRIATE               S01435
     C************                                                        S01435
     C***SENDER***                                                        S01435
     C************                                                        S01435
     C***********SNTP      IFNE 'C'                                       S01435
     C************         MOVELSND1      P1SND1                          S01435
     C************         MOVELSND2      P1SND2                          S01435
     C************         MOVELSND3      P1SND3                          S01435
     C************         MOVELSND4      P1SND4                          S01435
     C************         MOVEL*BLANKS   P1SND5                          S01435
     C************                                                  S01117S01435
     C***********MBIN      IFEQ 'N'                                 S01117S01435
     C***********SNTP      ANDEQ'G'                                 S01117S01435
     C************         MOVEL*BLANKS   SND1BR                    S01117S01435
     C************         END                                      S01117S01435
     C************                                                  S01117S01435
     C************         ELSE                                           S01435
     C************         MOVELSND1      WCLNUM                          S01435
     C************         MOVEL'B'       WCLRCT                          S01435
     C************         EXSR UCCLCN                                    S01435
     C************                                                        S01435
     C************IN89     IFEQ '1'                                       S01435
     C************         MOVEL'CLINT'   WDBFIL                          S01435
     C************         MOVELWCLNUM    WA7     7                       S01435
     C************         MOVE WCLRCT    WA7                             S01435
     C************         MOVELWA7       WDBKEY                          S01435
     C************         MOVEL'04'      WDBASE                          S01435
     C************         EXSR UEABRT                     *ABORT PGM*    S01435
     C************         END                                            S01435
     C************                                                        S01435
     C************         MOVELSND1      P1SND1                          S01435
     C************         MOVELCNA1      P1SND2                          S01435
     C************         MOVELCNA2      P1SND3                          S01435
     C************         MOVELCNA3      P1SND4                          S01435
     C************         MOVELCNA4      P1SND5                          S01435
     C************         END                                            S01435
     C************                                                        S01435
     C***INTERMEDIARY BANK                                                S01435
     C************                                                        S01435
     C***********INBT      IFNE 'C'                                       S01435
     C************         MOVELINB1      P1INB1                          S01435
     C************         MOVELINB2      P1INB2                          S01435
     C************         MOVELINB3      P1INB3                          S01435
     C************         MOVELINB4      P1INB4                          S01435
     C************         MOVELINB5      P1INB5                          S01435
     C************         ELSE                                           S01435
     C************         MOVELINB1      WCLNUM                          S01435
     C************         MOVEL'B'       WCLRCT                          S01435
     C************         EXSR UCCLCN                                    S01435
     C************                                                        S01435
     C************IN89     IFEQ '1'                                       S01435
     C************         MOVEL'CLINT'   WDBFIL                          S01435
     C************         MOVELWCLNUM    WA7                             S01435
     C************         MOVE WCLRCT    WA7                             S01435
     C************         MOVELWA7       WDBKEY                          S01435
     C************         MOVEL'05'      WDBASE                          S01435
     C************         EXSR UEABRT                     *ABORT PGM*    S01435
     C************         END                                            S01435
     C************                                                        S01435
     C************         MOVELINB1      P1INB1                          S01435
     C************         MOVELCNA1      P1INB2                          S01435
     C************         MOVELCNA2      P1INB3                          S01435
     C************         MOVELCNA3      P1INB4                          S01435
     C************         MOVELCNA4      P1INB5                          S01435
     C************         END                                            S01435
     C************                                                        S01435
     C***SENDER'S*CORRESPONDENT                                           S01435
     C************                                                        S01435
     C***********SNCT      IFNE 'C'                                       S01435
     C************         MOVELSNC1      P1SNC1                          S01435
     C************         MOVELSNC2      P1SNC2                          S01435
     C************         MOVELSNC3      P1SNC3                          S01435
     C************         MOVELSNC4      P1SNC4                          S01435
     C************         MOVELSNC5      P1SNC5                          S01435
     C************         ELSE                                           S01435
     C************         MOVELSNC1      WCLNUM                          S01435
     C************         MOVEL'B'       WCLRCT                          S01435
     C************         EXSR UCCLCN                                    S01435
     C************                                                        S01435
     C************IN89     IFEQ '1'                                       S01435
     C************         MOVEL'CLINT'   WDBFIL                          S01435
     C************         MOVELWCLNUM    WA7                             S01435
     C************         MOVE WCLRCT    WA7                             S01435
     C************         MOVELWA7       WDBKEY                          S01435
     C************         MOVEL'06'      WDBASE                          S01435
     C************         EXSR UEABRT                     *ABORT PGM*    S01435
     C************         END                                            S01435
     C************                                                        S01435
     C************         MOVELSNC1      P1SNC1                          S01435
     C************         MOVELCNA1      P1SNC2                          S01435
     C************         MOVELCNA2      P1SNC3                          S01435
     C************         MOVELCNA3      P1SNC4                          S01435
     C************         MOVELCNA4      P1SNC5                          S01435
     C************         END                                            S01435
     C************                                                        S01435
     C***ORDERING*BANK                                                    S01435
     C************                                                        S01435
     C************         MOVELORB1      P1ORB1                          S01435
     C************         MOVELORB2      P1ORB2                          S01435
     C************         MOVELORB3      P1ORB3                          S01435
     C************         MOVELORB4      P1ORB4                          S01435
     C************         MOVELORB5      P1ORB5                          S01435
     C************                                                        S01435
     C***BENEFICIARY CUSTOMER                                             S01435
     C************                                                        S01435
     C***********BNCT      IFNE 'C'                                       S01435
     C************         MOVELBNC1      P1BNC1                          S01435
     C************         MOVELBNC2      P1BNC2                          S01435
     C************         MOVELBNC3      P1BNC3                          S01435
     C************         MOVELBNC4      P1BNC4                          S01435
     C************         MOVELBNC5      P1BNC5                          S01435
     C************                                                  S01117S01435
     C***********MBIN      IFEQ 'N'                                 S01117S01435
     C***********BNCT      ANDEQ'P'                                 S01117S01435
     C************         MOVEL*BLANKS   BNC1BR                    S01117S01435
     C************         END                                      S01117S01435
     C************                                                  S01117S01435
     C************         ELSE                                           S01435
     C************         MOVELBNC1      WCLNUM                          S01435
     C************         MOVEL'B'       WCLRCT                          S01435
     C************         EXSR UCCLCN                                    S01435
     C************                                                        S01435
     C************IN89     IFEQ '1'                                       S01435
     C************         MOVEL'CLINT'   WDBFIL                          S01435
     C************         MOVELWCLNUM    WA7                             S01435
     C************         MOVE WCLRCT    WA7                             S01435
     C************         MOVELWA7       WDBKEY                          S01435
     C************         MOVEL'08'      WDBASE                          S01435
     C************         EXSR UEABRT                     *ABORT PGM*    S01435
     C************         END                                            S01435
     C************                                                        S01435
     C************         MOVELBNC1      P1BNC1                          S01435
     C************         MOVELCNA1      P1BNC2                          S01435
     C************         MOVELCNA2      P1BNC3                          S01435
     C************         MOVELCNA3      P1BNC4                          S01435
     C************         MOVELCNA4      P1BNC5                          S01435
     C************         END                                            S01435
     C************                                                        S01435
     C***ORDERING*CUSTOMER                                                S01435
     C************                                                        S01435
     C***********ORCT      IFNE 'C'                                       S01435
     C************         MOVELORC1      P1ORC1                          S01435
     C************         MOVELORC2      P1ORC2                          S01435
     C************         MOVELORC3      P1ORC3                          S01435
     C************         MOVELORC4      P1ORC4                          S01435
     C************         MOVEL*BLANKS   P1ORC5                          S01435
     C************         ELSE                                           S01435
     C************         MOVELORC1      WCLNUM                          S01435
     C************         MOVEL'B'       WCLRCT                          S01435
     C************         EXSR UCCLCN                                    S01435
     C************                                                        S01435
     C************IN89     IFEQ '1'                                       S01435
     C************         MOVEL'CLINT'   WDBFIL                          S01435
     C************         MOVELWCLNUM    WA7                             S01435
     C************         MOVE WCLRCT    WA7                             S01435
     C************         MOVELWA7       WDBKEY                          S01435
     C************         MOVEL'09'      WDBASE                          S01435
     C************         EXSR UEABRT                     *ABORT PGM*    S01435
     C************         END                                            S01435
     C************                                                        S01435
     C************         MOVELORC1      P1ORC1                          S01435
     C************         MOVELCNA1      P1ORC2                          S01435
     C************         MOVELCNA2      P1ORC3                          S01435
     C************         MOVELCNA3      P1ORC4                          S01435
     C************         MOVELCNA4      P1ORC5                          S01435
     C************         END                                            S01435
      *                                                                                       CFT120
      ** Access currency record for chances to the DR of currency                             CFT120
      *                                                                                       CFT120
     C           CFT120    IFEQ 'Y'                                                           CFT120
     C           INCDRC    IFNE *BLANKS                                                       CFT120
     C                     MOVEL*BLANKS   ZTABKY                                              CFT120
     C                     MOVEL'20'      ZTABKY                                              CFT120
     C                     MOVELINCDRC    WA4                                                 CFT120
     C                     MOVE '1'       WA4                                                 CFT120
     C                     MOVE WA4       ZTABKY                                              CFT120
     C                     EXSR UATBCN                                                        CFT120
      *                                                                                       CFT120
      ** Check if database error occured                                                      CFT120
      *                                                                                       CFT120
     C           *IN89     IFEQ '1'                                                           CFT120
     C                     MOVEL'TABLE'   WDBFIL                                              CFT120
     C                     MOVELZTABKY    WDBKEY                                              CFT120
     C                     MOVEL'62'      WDBASE                                              CFT120
     C                     EXSR UEABRT                                                        CFT120
     C                     ELSE                                                               CFT120
      *                                                                                       CFT120
      ** Store number of decimal places for CDRC currency                                     CFT120
      *                                                                                       CFT120
     C                     Z-ADDCDP       SVCCDP  10                                          CFT120
     C                     ENDIF                                                              CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
      ** Access currency record for fixed charge currency (ICD)                               CFT120
      *                                                                                       CFT120
     C           BTCHCY    IFEQ 'F'                                                           CFT120
     C           FCHCCY    ANDNE*BLANKS                                                       CFT120
     C                     MOVEL*BLANKS   ZTABKY                                              CFT120
     C                     MOVEL'20'      ZTABKY                                              CFT120
     C                     MOVELFCHCCY    WA4                                                 CFT120
     C                     MOVE '1'       WA4                                                 CFT120
     C                     MOVE WA4       ZTABKY                                              CFT120
     C                     EXSR UATBCN                                                        CFT120
      *                                                                                       CFT120
      ** Check if database error occured                                                      CFT120
      *                                                                                       CFT120
     C           *IN89     IFEQ '1'                                                           CFT120
     C                     MOVEL'TABLE'   WDBFIL                                              CFT120
     C                     MOVELZTABKY    WDBKEY                                              CFT120
     C                     MOVEL'63'      WDBASE                                              CFT120
     C                     EXSR UEABRT                                                        CFT120
     C                     ELSE                                                               CFT120
      *                                                                                       CFT120
      ** Store number of decimal places for CDRC Currency                                     CFT120
      *                                                                                       CFT120
     C                     Z-ADDCDP       SVFCDP  10                                          CFT120
     C                     ENDIF                                                              CFT120
     C                     ENDIF                                                              CFT120
     C                     ENDIF                                                              CFT120
     C*
     C** FORMAT PAY & SETTLE AMOUNTS
     C*
     C** CALL UATBCN TO ACCESS CURRENCY RECORD FOR SETTLE CURRENCY
     C*
     C                     MOVEL*BLANKS   ZTABKY
     C                     MOVEL'20'      ZTABKY
     C                     MOVELSMCY      WA4
     C                     MOVE '1'       WA4
     C                     MOVE WA4       ZTABKY
     C                     EXSR UATBCN
     C*
     C** CHECK IF DATABASE ERROR OCCURRED
     C*
     C           *IN89     IFEQ '1'
     C                     MOVEL'TABLE'   WDBFIL
     C                     MOVELZTABKY    WDBKEY
     C                     MOVEL'10'      WDBASE
     C                     EXSR UEABRT                     *ABORT PGM*
     C                     END
     C*
     C** STORE NUMBER OF DECIMAL PLACES FOR SETTLE CURRENCY
     C*
     C                     Z-ADDCDP       SVSCDP  10
     C*
     C** FORMAT SETTLE AMOUNT
     C*
     C                     MOVEL*BLANKS   WFDIN  15
     C                     MOVE SMAM      WFDIN
     C                     Z-ADDSVSCDP    WDEC    10
     C           13        SUB  SVSCDP    WDIG    20
     C                     EXSR UGFRMT
     C                     MOVE WFDOUT    P1SMAM
     C*
     C** CALL UATBCN TO ACCESS CURRENCY RECORD FOR PAY CURRENCY
     C*
     C                     MOVEL*BLANKS   ZTABKY
     C                     MOVEL'20'      ZTABKY
     C                     MOVELPCCY      WA4
     C                     MOVE '1'       WA4
     C                     MOVE WA4       ZTABKY
     C                     EXSR UATBCN
     C*
     C** CHECK IF DATABASE ERROR OCCURRED
     C*
     C           *IN89     IFEQ '1'
     C                     MOVEL'TABLE'   WDBFIL
     C                     MOVELZTABKY    WDBKEY
     C                     MOVEL'11'      WDBASE
     C                     EXSR UEABRT                     *ABORT PGM*
     C                     END
     C*
     C** STORE NUMBER OF DECIMAL PLACES FOR PAY CURRENCY
     C*
     C                     Z-ADDCDP       SVPCDP  10
     C*
     C** FORMAT PAY AMOUNT
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE PYAM      WFDIN
     C                     Z-ADDSVPCDP    WDEC
     C           13        SUB  SVPCDP    WDIG
     C                     EXSR UGFRMT
     C                     MOVE WFDOUT    P1PYAM
      *                                                                   CEU006
      **  Format Notified Delivery Amount.                                CEU006
      *                                                                   CEU006
     C***********NDAM      IFEQ 0                          B*1     CEU006 CFT014
     C***********          MOVE '0'       *IN55                    CEU006 CFT014
     C***********          ELSE                            X*1     CEU006 CFT014
     C***********          MOVE '1'       *IN55                    CEU006 CFT014
      *                                                                   CFT014
     C           CEU006    IFEQ 'Y'                                       CFT014
     C           CFT014    OREQ 'Y'                                       CFT014
      *                                                                   CFT014
     C                     MOVE *ON       *IN55                           CFT014
      *                                                                   CFT014
     C           NDAM      IFEQ 0                                         CFT014
      *                                                                   CFT014
     C                     MOVE *BLANKS   RNDAMT                          CFT014
     C                     MOVE *BLANKS   RNDCCY                          CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CEU006
      **  Call SR/UATBCN to access currency record for Notified           CEU006
      **  Delivery Currency.                                              CEU006
      *                                                                   CEU006
     C                     MOVEL*BLANKS   ZTABKY                          CEU006
     C                     MOVEL'20'      ZTABKY                          CEU006
     C                     MOVELNDCY      WA4                             CEU006
     C                     MOVE '1'       WA4                             CEU006
     C                     MOVE WA4       ZTABKY                          CEU006
     C                     EXSR UATBCN                                    CEU006
      *                                                                   CEU006
      **  Check if database error occurred.                               CEU006
      *                                                                   CEU006
     C           *IN89     IFEQ '1'                        B*2            CEU006
     C                     MOVEL'TABLE'   WDBFIL                          CEU006
     C                     MOVELZTABKY    WDBKEY                          CEU006
     C                     MOVEL'053'     WDBASE                          CEU006
     C                     EXSR UEABRT                     *ABORT PGM*    CEU006
     C                     ENDIF                           E*2            CEU006
      *                                                                   CEU006
     C                     Z-ADDNDAM      ZFLD15                          CEU006
     C                     Z-ADDCDP       ZDECS                           CEU006
     C                     MOVE 'J'       ZECODE                          CEU006
     C                     EXSR ZSEDIT                                    CEU006
     C                     MOVE ZOUT21    WFLD18 18                       CEU006
     C                     MOVE WFLD18    RNDAMT                          CEU006
     C                     MOVE NDCY      RNDCCY                          CEU006
     C                     ENDIF                           E*1            CEU006
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C*
     C** FORMAT OTHER AMOUNTS & CURRENCIES
     C** IF CHARGES TO DEBIT A/C FIELD IS NON-ZERO USE BASE CURRENCY;
     C** OTHERWISE IF PAY PLUS CHARGES INDICATOR IS 'Y' USE SETTLE CCY;
     C** OTHERWISE USE PAY CURRENCY
     C*
     C***********CDRO      IFNE *ZERO                                                         CSD027
     C           CDRO      IFNE *BLANKS                                                       CSD027
     C                     MOVELBCCY      WCCY    3
     C                     Z-ADDSVBCDP    WDEC
     C           INCDRC    IFNE *BLANKS                                                       CFT120
     C           CFT120    ANDEQ'Y'                                                           CFT120
     C                     MOVE INCDRC    WCCY                                                CFT120
     C                     Z-ADDSVCCDP    WDEC                                                CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
     C/COPY WNCPYSRC,FT0520C001
     C                     ELSE
     C           ADDC      IFEQ 'A'
     C                     MOVELSMCY      WCCY
     C                     Z-ADDSVSCDP    WDEC
      *                                                                   122060
     C           SND1      IFEQ 'CASHIER'                                 122060
     C           PCCY      ANDEQBCCY                                      122060
     C                     MOVELPCCY      WCCY                            122060
     C                     Z-ADDSVPCDP    WDEC                            122050
     C                     ENDIF                                          122060
      *                                                                   122060
     C                     ELSE
     C                     MOVELPCCY      WCCY
     C                     Z-ADDSVPCDP    WDEC
     C                     END
     C                     END
     C*
     C           11        SUB  WDEC      WDIG
     C*
     C** SETUP CURRENCY NAMES
     C*
     C                     MOVELWCCY      P1TRCY
     C                     MOVELWCCY      P1TXCY
     C                     MOVELWCCY      P1CQCY
     C                     MOVELWCCY      P1TLCY
     C                     MOVELWCCY      P1ADCY
     C                     MOVELWCCY      P1MSCY
     C*                                                                   S01499
     C** Set up ccy for V.A.T. if S01499 feature is active                S01499
     C*                                                                   S01499
     C           *IN31     IFEQ '1'                                       S01499
     C                     MOVELWCCY      P1VTCY                          S01499
     C                     END                                            S01499
     C*                                                                   S01494
     C** Set up ccy for FX/Change if S01494 feature is active             S01494
     C*                                                                   S01494
     C           *IN30     IFEQ '1'                                       S01494
     C                     MOVELWCCY      P1CHCY                          S01494
     C                     END                                            S01494
     C*
     C** FORMAT TRANSFER COMMISSION AMOUNT
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE TRCM      WFDIN
     C                     EXSR UGFRMT
     C                     MOVE WFDOUT    P1TRCM
     C*
     C** FORMAT TELEX CHARGE AMOUNT
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE TXCH      WFDIN
     C                     EXSR UGFRMT
     C                     MOVE WFDOUT    P1TXCH
     C*
     C** FORMAT CHEQUE CHARGE AMOUNT
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CQCH      WFDIN
     C                     EXSR UGFRMT
     C                     MOVE WFDOUT    P1CQCH
     C*
     C** FORMAT TELEPHONE CHARGE AMOUNT
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE TLCH      WFDIN
     C                     EXSR UGFRMT
     C                     MOVE WFDOUT    P1TLCH
     C*
     C** FORMAT ADVICE CHARGE AMOUNT
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE ADCH      WFDIN
     C                     EXSR UGFRMT
     C                     MOVE WFDOUT    P1ADCH
     C*
     C** FORMAT MISCELLANEOUS CHARGE AMOUNT
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE MSCH      WFDIN
     C                     EXSR UGFRMT
     C                     MOVE WFDOUT    P1MSCH
     C*                                                                   S01499
     C** Format the V.A.T. amount if S01499 is active                     S01499
     C*                                                                   S01499
     C           *IN31     IFEQ '1'                                       S01499
     C                     MOVE *BLANKS   WFDIN                           S01499
     C                     MOVE INVATT    WFDIN                           S01499
     C                     EXSR UGFRMT                                    S01499
     C                     MOVE WFDOUT    P1VATT                          S01499
     C                     END                                            S01499
     C*                                                                   S01494
     C** Format the FX/Change Commission amount if S01494 is active       S01494
     C*                                                                   S01494
     C           *IN30     IFEQ '1'                                       S01494
     C                     MOVE *BLANKS   WFDIN                           S01494
     C                     MOVE INCHCM    WFDIN                           S01494
     C                     EXSR UGFRMT                                    S01494
     C                     MOVE WFDOUT    P1CHCM                          S01494
     C                     END                                            S01494
      *                                                                   CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
      *                                                                   CFT014
     C           INOEXR    IFNE 0                                         CFT014
     C                     Z-ADDINOEXR    P1OEXR                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVELINTRIB    P1TRIB                          CFT014
     C                     MOVELINBOCD    P1BOCD                          CFT014
     C                     MOVELINTTCD    P1TTCD                          CFT014
     C                     MOVELINICD1    P1ICD1                          CFT014
     C                     MOVELINICD2    P1ICD2                          CFT014
     C                     MOVELINICD3    P1ICD3                          CFT014
     C                     MOVELINICD4    P1ICD4                          CFT014
     C                     MOVELINICD5    P1ICD5                          CFT014
     C                     MOVELINRRP1    P1RRP1                          CFT014
     C                     MOVELINRRP2    P1RRP2                          CFT014
     C                     MOVELINRRP3    P1RRP3                          CFT014
      *                                                                   CFT014
      ** Format Receiver's Charges                                        CFT014
      *                                                                   CFT014
     C           INRCRM    IFEQ 0                                         CFT014
     C                     MOVE *BLANKS   P1RCRM                          CFT014
     C                     MOVE *BLANKS   P1RCRY                          CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C                     CALL 'AOCURRR0'                                CFT014
     C                     PARM '*DBERR ' @RTCD   7                       CFT014
     C                     PARM '*KEY   ' @OPTN   7                       CFT014
     C                     PARM SMCY      @CCY    3                       CFT014
     C           SDCURR    PARM SDCURR    DSSDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C           *LOCK     IN   DLDA                                      CFT014
     C                     MOVEL'SDCURRPD'DBFILE                          CFT014
     C                     MOVEL'*VERIFY' DBKEY                           CFT014
     C                     MOVEL'70'      DBASE                           CFT014
     C                     OUT  DLDA                                      CFT014
     C                     SETON                     U7U8LR               CFT014
     C                     EXSR UEABRT                                    CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C                     MOVE A6NBDP    WSNBDP  10                      CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     Z-ADDWSNBDP    WDEC    10                      CFT014
     C           11        SUB  WDEC      WDIG    20                      CFT014
     C                     MOVEL*BLANKS   WFDIN                           CFT014
     C                     MOVE INRCRM    WFDIN                           CFT014
     C                     EXSR UGFRMT                                    CFT014
     C                     MOVE WFDOUT    P1RCRM                          CFT014
     C                     MOVE SMCY      P1RCRY                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Format Sender's Charges                                          CFT014
      *                                                                   CFT014
     C           INSCY1    IFEQ *BLANKS                                   CFT014
     C                     MOVE *BLANKS   P1SCH1                          CFT014
     C                     MOVE *BLANKS   P1SCY1                          CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C                     CALL 'AOCURRR0'                                CFT014
     C                     PARM '*DBERR ' @RTCD   7                       CFT014
     C                     PARM '*KEY   ' @OPTN   7                       CFT014
     C                     PARM INSCY1    @CCY    3                       CFT014
     C           SDCURR    PARM SDCURR    DSSDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C           *LOCK     IN   DLDA                                      CFT014
     C                     MOVEL'SDCURRPD'DBFILE                          CFT014
     C                     MOVEL'*VERIFY' DBKEY                           CFT014
     C                     MOVEL'72'      DBASE                           CFT014
     C                     OUT  DLDA                                      CFT014
     C                     SETON                     U7U8LR               CFT014
     C                     EXSR UEABRT                                    CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C                     MOVE A6NBDP    WNBDP1  10                      CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     Z-ADDWNBDP1    WDEC    10                      CFT014
     C           11        SUB  WDEC      WDIG    20                      CFT014
     C                     MOVEL*BLANKS   WFDIN                           CFT014
     C                     MOVE INSCH1    WFDIN                           CFT014
     C                     EXSR UGFRMT                                    CFT014
     C                     MOVE WFDOUT    P1SCH1                          CFT014
     C                     MOVE INSCY1    P1SCY1                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           INSCY2    IFEQ *BLANKS                                   CFT014
     C                     MOVE *BLANKS   P1SCH2                          CFT014
     C                     MOVE *BLANKS   P1SCY2                          CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C                     CALL 'AOCURRR0'                                CFT014
     C                     PARM '*DBERR ' @RTCD   7                       CFT014
     C                     PARM '*KEY   ' @OPTN   7                       CFT014
     C                     PARM INSCY2    @CCY    3                       CFT014
     C           SDCURR    PARM SDCURR    DSSDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C           *LOCK     IN   DLDA                                      CFT014
     C                     MOVEL'SDCURRPD'DBFILE                          CFT014
     C                     MOVEL'*VERIFY' DBKEY                           CFT014
     C                     MOVEL'73'      DBASE                           CFT014
     C                     OUT  DLDA                                      CFT014
     C                     SETON                     U7U8LR               CFT014
     C                     EXSR UEABRT                                    CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C                     MOVE A6NBDP    WNBDP2  10                      CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     Z-ADDWNBDP2    WDEC                            CFT014
     C           11        SUB  WDEC      WDIG                            CFT014
     C                     MOVEL*BLANKS   WFDIN                           CFT014
     C                     MOVE INSCH2    WFDIN                           CFT014
     C                     EXSR UGFRMT                                    CFT014
     C                     MOVE WFDOUT    P1SCH2                          CFT014
     C                     MOVE INSCY2    P1SCY2                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           INSCY3    IFEQ *BLANKS                                   CFT014
     C                     MOVE *BLANKS   P1SCH3                          CFT014
     C                     MOVE *BLANKS   P1SCY3                          CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C                     CALL 'AOCURRR0'                                CFT014
     C                     PARM '*DBERR ' @RTCD   7                       CFT014
     C                     PARM '*KEY   ' @OPTN   7                       CFT014
     C                     PARM INSCY3    @CCY    3                       CFT014
     C           SDCURR    PARM SDCURR    DSSDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C           *LOCK     IN   DLDA                                      CFT014
     C                     MOVEL'SDCURRPD'DBFILE                          CFT014
     C                     MOVEL'*VERIFY' DBKEY                           CFT014
     C                     MOVEL'74'      DBASE                           CFT014
     C                     OUT  DLDA                                      CFT014
     C                     SETON                     U7U8LR               CFT014
     C                     EXSR UEABRT                                    CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C                     MOVE A6NBDP    WNBDP3  10                      CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     Z-ADDWNBDP3    WDEC                            CFT014
     C           11        SUB  WDEC      WDIG                            CFT014
     C                     MOVEL*BLANKS   WFDIN                           CFT014
     C                     MOVE INSCH3    WFDIN                           CFT014
     C                     EXSR UGFRMT                                    CFT014
     C                     MOVE WFDOUT    P1SCH3                          CFT014
     C                     MOVE INSCY3    P1SCY3                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           INSCY4    IFEQ *BLANKS                                   CFT014
     C                     MOVE *BLANKS   P1SCH4                          CFT014
     C                     MOVE *BLANKS   P1SCY4                          CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C                     CALL 'AOCURRR0'                                CFT014
     C                     PARM '*DBERR ' @RTCD   7                       CFT014
     C                     PARM '*KEY   ' @OPTN   7                       CFT014
     C                     PARM INSCY4    @CCY    3                       CFT014
     C           SDCURR    PARM SDCURR    DSSDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C           *LOCK     IN   DLDA                                      CFT014
     C                     MOVEL'SDCURRPD'DBFILE                          CFT014
     C                     MOVEL'*VERIFY' DBKEY                           CFT014
     C                     MOVEL'75'      DBASE                           CFT014
     C                     OUT  DLDA                                      CFT014
     C                     SETON                     U7U8LR               CFT014
     C                     EXSR UEABRT                                    CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C                     MOVE A6NBDP    WNBDP4  10                      CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     Z-ADDWNBDP4    WDEC                            CFT014
     C           11        SUB  WDEC      WDIG                            CFT014
     C                     MOVEL*BLANKS   WFDIN                           CFT014
     C                     MOVE INSCH4    WFDIN                           CFT014
     C                     EXSR UGFRMT                                    CFT014
     C                     MOVE WFDOUT    P1SCH4                          CFT014
     C                     MOVE INSCY4    P1SCY4                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           INSCY5    IFEQ *BLANKS                                   CFT014
     C                     MOVE *BLANKS   P1SCH5                          CFT014
     C                     MOVE *BLANKS   P1SCY5                          CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C                     CALL 'AOCURRR0'                                CFT014
     C                     PARM '*DBERR ' @RTCD   7                       CFT014
     C                     PARM '*KEY   ' @OPTN   7                       CFT014
     C                     PARM INSCY5    @CCY    3                       CFT014
     C           SDCURR    PARM SDCURR    DSSDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C           *LOCK     IN   DLDA                                      CFT014
     C                     MOVEL'SDCURRPD'DBFILE                          CFT014
     C                     MOVEL'*VERIFY' DBKEY                           CFT014
     C                     MOVEL'75'      DBASE                           CFT014
     C                     OUT  DLDA                                      CFT014
     C                     SETON                     U7U8LR               CFT014
     C                     EXSR UEABRT                                    CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C                     MOVE A6NBDP    WNBDP5  10                      CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     Z-ADDWNBDP5    WDEC                            CFT014
     C           11        SUB  WDEC      WDIG                            CFT014
     C                     MOVEL*BLANKS   WFDIN                           CFT014
     C                     MOVE INSCH5    WFDIN                           CFT014
     C                     EXSR UGFRMT                                    CFT014
     C                     MOVE WFDOUT    P1SCH5                          CFT014
     C                     MOVE INSCY5    P1SCY5                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
     C*
     C** FORMAT DATE FIELDS USING SYSTEM ROUTINE ZDATE2
     C*
     C** SETTLE VALUE DATE
     C*
     C                     Z-ADDSLDT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVELZADATE    P1SLDT
     C*
     C** PAY VALUE DATE
     C*
     C                     Z-ADDPVDT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVELZADATE    P1PYDT
     C*
     C** SET UP USER FIELDS FROM MUSERDD,IF AUDIT REPORT
     C*
     C                     SETOF                     50
     C           PARM1     IFEQ 'A'
     C*
     C                     SETON                     50
     C*
     C           INUSR1    IFNE *BLANKS
     C                     MOVE INUSR1    USRP
     C                     EXSR UCMUSE
     C                     MOVE USER1     SIUSR1 25
     C*
     C                     ELSE                                           E23051
     C*                                                                   E23051
     C** CLEAR OUTPUT FIELD                                               E23051
     C                     MOVE *BLANKS   SIUSR1                          E23051
     C*                                                                   E23051
     C                     END
      *
     C           INUSR2    IFNE *BLANKS
     C                     MOVE INUSR2    USRP
     C                     EXSR UCMUSE
     C                     MOVE USER1     SIUSR2 25
     C*
     C                     ELSE                                           E23051
     C*                                                                   E23051
     C** CLEAR OUTPUT FIELD                                               E23051
     C                     MOVE *BLANKS   SIUSR2                          E23051
     C*                                                                   E23051
     C                     END
      *
     C           AUP1      IFNE *BLANKS
     C                     MOVE AUP1      USRP
     C                     EXSR UCMUSE
     C                     MOVE USER1     SAUP1  25
     C*
     C                     ELSE                                           E23051
     C*                                                                   E23051
     C** CLEAR OUTPUT FIELD                                               E23051
     C                     MOVE *BLANKS   SAUP1                           E23051
     C*                                                                   E23051
     C                     END
      *
     C           AUP2      IFNE *BLANKS
     C                     MOVE AUP2      USRP
     C                     EXSR UCMUSE
     C                     MOVE USER1     SAUP2  25
     C*
     C                     ELSE                                           E23051
     C*                                                                   E23051
     C** CLEAR OUTPUT FIELD                                               E23051
     C                     MOVE *BLANKS   SAUP2                           E23051
     C*                                                                   E23051
     C                     END
      *
     C                     END
     C*
     C** SETUP REMAINING REPORT FIELDS
     C*
     C                     MOVELPREF      P1PREF
     C                     MOVELRLPR      P1RLPR
     C                     MOVELPYTP      P1PYTP
     C                     MOVELPYST      P1PYST
     C                     MOVELSMCY      P1SMCY
     C                     Z-ADDRATE      P1RATE
     C                     MOVELPCCY      P1PCCY
     C                     MOVELBBI1      P1BBI1
     C                     MOVELBBI2      P1BBI2
     C                     MOVELBBI3      P1BBI3
     C                     MOVELBBI4      P1BBI4
     C                     MOVELBBI5      P1BBI5
     C                     MOVELBBI6      P1BBI6
     C                     MOVELDTP1      P1DTP1
     C                     MOVELDTP2      P1DTP2
     C                     MOVELDTP3      P1DTP3
     C                     MOVELDTP4      P1DTP4
     C/COPY WNCPYSRC,FT0520C007
     C           DNBC      IFEQ *ZERO
     C/COPY WNCPYSRC,FT0520C008
     C                     MOVE *BLANKS   P1DNBC
     C                     ELSE
     C                     MOVELDNBC      P1DNBC
     C                     END
     C                     MOVELADDC      P1ADDC
     C                     MOVELDTCH      P1DTCH
     C                     MOVELTRCT      P1TRCT
     C*********************MOVELSWPC      P1SWPC                          S01117
     C           SWPC      IFEQ 1                          B001           S01117
     C                     MOVE 'U'       P1SWPC                          S01117
     C                     ELSE                            X001           S01117
     C           SWPC      IFEQ 2                          B002           S01117
     C                     MOVE 'N'       P1SWPC                          S01117
     C                     END                             E002           S01117
     C                     END                             E001           S01117
     C************                                                  E32843S01435
     C***OUPUT*OVERRIDE IF 'Y'                                      E32843S01435
     C************                                                  E32843S01435
     C************         MOVE *BLANKS   P1OVRD                    E32843S01435
     C***********OVRD      IFEQ 'Y'                                 E32843S01435
     C************         MOVE 'Y'       P1OVRD                    E32843S01435
     C************         END                                      E32843S01435
      ************                                                        S01435
      *                                                                   S01435
      * Format Override indicator                                         S01435
      *                                                                   S01435
     C                     MOVE *BLANKS   P1OVRD                          S01435
     C           OVRD      IFEQ 'Y'                                       S01435
     C                     MOVE 'YES'     P1OVRD                          S01435
     C                     ELSE                                           S01435
     C                     MOVE 'NO '     P1OVRD                          S01435
     C                     END                                            S01435
      *                                                                   S01435
      * Format Entered Currency                                           S01435
      *                                                                   S01435
     C                     SELEC                                          S01435
      *                                                                   S01435
     C***********CDRO      WHNE *ZERO                                                  S01435 CSD027
     C           CDRO      WHNE *BLANKS                                                       CSD027
     C           BTCHCY    OREQ 'B'                                       074815
     C           CFT120    ANDNE'Y'                                                           CFT120
     C                     MOVELBCCY      WCCY                            S01435
     C                     Z-ADDSVBCDP    WDEC                            S01435
     C           INCDRC    IFNE *BLANKS                                                       CFT120
      *                                                                                       CFT120
     C           CFT120    ANDEQ'Y'                                                           CFT120
     C                     MOVELINCDRC    WCCY                                                CFT120
     C                     Z-ADDSVCCDP    WDEC                                                CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
     C           BTCHCY    WHEQ 'B'                                                           CFT120
     C           CFT120    ANDEQ'Y'                                                           CFT120
     C                     MOVELBCCY      WCCY                                                CFT120
     C                     Z-ADDSVBCDP    WDEC                                                CFT120
     C           BTCHCY    WHEQ 'F'                                                           CFT120
     C           CFT120    ANDEQ'Y'                                                           CFT120
     C                     MOVELFCHCCY    WCCY                                                CFT120
     C                     Z-ADDSVFCDP    WDEC                                                CFT120
      *                                                                                       CFT120
     C/COPY WNCPYSRC,FT0520C002
      *                                                                   S01435
     C           BTCHCY    WHEQ 'L'                                       S01435
     C                     MOVELLOCY      WCCY                            S01435
     C                     Z-ADDSVLCDP    WDEC                            S01435
      *                                                                   S01435
     C           BTCHCY    WHEQ 'C'                                       S01435
     C           ADDC      ANDEQ'A'                                       S01435
     C                     MOVELSMCY      WCCY                            S01435
     C                     Z-ADDSVSCDP    WDEC                            S01435
      *                                                                   S01435
     C                     OTHER                                          S01435
     C                     MOVELPCCY      WCCY                            S01435
     C                     Z-ADDSVPCDP    WDEC                            S01435
     C                     ENDSL                                          S01435
      *                                                                   S01435
     C                     MOVELWCCY      P1TREC                          S01435
     C                     MOVELWCCY      P1TXEC                          S01435
     C                     MOVELWCCY      P1CQEC                          S01435
     C                     MOVELWCCY      P1TLEC                          S01435
     C                     MOVELWCCY      P1ADEC                          S01435
     C                     MOVELWCCY      P1MSEC                          S01435
     C*                                                                   S01499
     C** Set up ccy for V.A.T. only if S01499 feature is active           S01499
     C*                                                                   S01499
     C           *IN31     IFEQ '1'                                       S01499
     C                     MOVELWCCY      P1VTEC                          S01499
     C                     END                                            S01499
     C*                                                                   S01494
     C** Set up ccy for FX/Change only if S01494 feature is active        S01494
     C*                                                                   S01494
     C           *IN30     IFEQ '1'                                       S01494
     C                     MOVELWCCY      P1CHEC                          S01494
     C                     END                                            S01494
      *                                                                   S01435
      *  Format Entered Amounts                                           S01435
      *                                                                   S01435
     C           11        SUB  WDEC      WDIG                            S01435
      *                                                                   S01435
      ** Format Transfer Commission Amount                                S01435
      *                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE DUMA1     WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P1TREA                          S01435
      *                                                                   S01435
      ** Format Telex Charge Amount                                       S01435
      *                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE DUMA2     WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P1TXEA                          S01435
      *                                                                   S01435
      ** Format Cheque Charge Amount                                      S01435
      *                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE DUMA3     WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P1CQEA                          S01435
     C*                                                                   S01435
     C** Format Telephone Charge Amount                                   S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C***********          MOVE DUMA4     WFDIN                    S01435 094929
     C                     MOVE DUMA5     WFDIN                           094929
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P1TLEA                          S01435
     C*                                                                   S01435
     C** Format Advice Charge Amount                                      S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C***********          MOVE DUMA5     WFDIN                    S01435 094929
     C                     MOVE DUMA4     WFDIN                           094929
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P1ADEA                          S01435
     C*                                                                   S01435
     C** Format Miscellaneous Charge Amount                               S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE DUMA6     WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P1MSEA                          S01435
     C*                                                                   S01499
     C** Format the V.A.T. amount if S01499 is active                     S01499
     C*                                                                   S01499
     C           *IN31     IFEQ '1'                                       S01499
     C                     MOVE *BLANKS   WFDIN                           S01499
     C                     MOVE INDUM8    WFDIN                           S01499
     C                     EXSR UGFRMT                                    S01499
     C                     MOVE WFDOUT    P1VAEA                          S01499
     C                     END                                            S01499
     C*                                                                   S01494
     C** Format the FX/Change Commission amount if S01494 is active       S01494
     C*                                                                   S01494
     C           *IN30     IFEQ '1'                                       S01494
     C                     MOVE *BLANKS   WFDIN                           S01494
     C                     MOVE INDUM7    WFDIN                           S01494
     C                     EXSR UGFRMT                                    S01494
     C                     MOVE WFDOUT    P1CHEA                          S01494
     C                     END                                            S01494
     C*                                                                   S01499
     C** Set up the V.A.T. flags of all charges if S01499 is active       S01499
     C*                                                                   S01499
     C           *IN31     IFEQ '1'                                       S01499
     C                     MOVE INVAT1    P1TRVF                          S01499
     C                     MOVE INVAT2    P1TXVF                          S01499
     C                     MOVE INVAT3    P1CQVF                          S01499
     C                     MOVE INVAT4    P1ADVF                          S01499
     C                     MOVE INVAT5    P1TLVF                          S01499
     C                     MOVE INVAT6    P1MSVF                          S01499
     C                     MOVE INVAT7    P1CHVF                          S01499
     C                     END                                            S01499
     C*                                                                   E32847
     C** OUPUT OUTGOING PAYMENT TO BE GENERATED IF 'Y'                    E32847
     C*                                                                   E32847
     C                     MOVE *BLANKS   P1OPIN                          E32847
     C           OPIN      IFEQ 'Y'                                       E32847
     C******************** MOVE 'Y'       P1OPIN                    E32847E32921
     C                     MOVEL'YES'     P1OPIN                          E32921
     C                     ELSE                                           E32847
     C******************** MOVEL' '       P1OPIN                    E32847E32921
     C                     MOVEL'NO '     P1OPIN                          E32921
     C                     END                                            E32847
     C*
     C** EDIT  RCCO, ACBK AND CDRO  FOR OUTPUT
     C*
      **********                                                          S01435
     C**********           MOVE RCRT      PRMTYP  1        ( RCCO )       S01435
     C**********           MOVE *ZEROS    PRMFLD 12                       S01435
     C**********           MOVELRCCO      PRMFLD                          S01435
     C**********           EXSR CHOPF                                     S01435
     C**********           MOVELPRMFLD    P1RCCO                          S01435
     C**********                                                          S01435
     C**********           MOVELACBK      P1ACBK                          S01435
     C**********           MOVELACBB      P1ACBB                    S01117S01435
     C**********           MOVELCDRT      PRMTYP           ( CDRO ) S01117S01435
     C**********           MOVEL*ZEROS    PRMFLD                    S01117S01435
     C                     MOVE CDRT      PRMTYP  1        ( CDRO )       S01435
     C**********           MOVE *ZEROS    PRMFLD 12                                    S01435 CGL029
     C***********          MOVE *ZEROS    PRMFLD 18                                    CGL029 CSD027
     C                     MOVE *BLANKS   PRMFLD 18                                           CSD027
     C                     MOVELCDRO      PRMFLD
     C                     EXSR CHOPF
     C                     MOVELPRMFLD    P1CDRO
     C/COPY WNCPYSRC,FT0520C003
      *                                                                                       CFT120
     C           CFT120    IFEQ 'Y'                                                           CFT120
     C           INCDRC    IFNE *BLANKS                                                       CFT120
     C                     MOVELINCDRC    P1CDRC                                              CFT120
     C                     ELSE                                                               CFT120
     C                     MOVE *BLANKS   P1CDRC                                              CFT120
     C                     ENDIF                                                              CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
     C                     MOVELCDBR      P1CDBR                          S01117
     C/COPY WNCPYSRC,FT0520C006
      *                                                                   CFT009
      ** Set up fields for remaining report - second page - if CFT009 is  CFT009
      ** on                                                               CFT009
      *                                                                   CFT009
      ** SETUP CURRENCY NAMES                                             CFT009
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
      *                                                                   CFT009
     C           PREF      CHAININPAYXL0             89                   CFT009
     C           *IN89     IFEQ '0'                                       CFT009
     C           RECI      COMP 'D'                  8989  ON , DELETED   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** DB ERROR IF NO RECORD FOUND.                                     CFT009
      *                                                                   CFT009
     C           *IN89     IFEQ '1'                                       CFT009
     C                     MOVEL'INPAYX'  WDBFIL           ***************CFT009
     C                     MOVELPREF      WDBKEY           * DB ERROR 08 *CFT009
     C                     MOVEL'08'      WDBASE           ***************CFT009
     C                     EXSR UEABRT                                    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     SELEC                                          CFT009
     C***********CDRO      WHNE *ZEROS                                                 CFT009 CSD027
     C           CDRO      WHNE *BLANKS                                                       CSD027
      *                                                                                       CFT120
     C                     MOVELBCCY      WCCY    3                       CFT009
     C                     Z-ADDSVBCDP    WDEC                            CFT009
     C           INCDRC    IFNE *BLANKS                                                       CFT120
     C           CFT120    ANDEQ'Y'                                                           CFT120
     C                     MOVELINCDRC    WCCY                                                CFT120
     C                     Z-ADDSVCCDP    WDEC                                                CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
     C           ADDC      WHEQ 'A'                                       CFT009
     C                     MOVELSMCY      WCCY                            CFT009
     C                     Z-ADDSVSCDP    WDEC                            CFT009
     C                     OTHER                                          CFT009
     C                     Z-ADDSVPCDP    WDEC                            CFT009
     C                     MOVELPCCY      WCCY                            CFT009
     C                     ENDSL                                          CFT009
      *                                                                   CFT009
      ** Retrieve currency details (charge)                               CFT009
      *                                                                   CFT009
     C           INCHGC    IFNE *BLANKS                                                       255028
     C                     MOVE INCHGC    @CURR                                               255028
     C                     ELSE                                                               255028
     C                     SELEC                                                              255028
     C           CDRO      WHNE *BLANKS                                                       255028
     C                     MOVE BCCY      @CURR                                               255028
     C           INCDRC    IFNE *BLANKS                                                       CFT120
     C           CFT120    ANDEQ'Y'                                                           CFT120
     C                     MOVE INCDRC    @CURR                                               CFT120
     C                     ENDIF                                                              CFT120
     C           BTCHCY    WHEQ 'B'                                                           255028
     C                     MOVE BCCY      @CURR                                               255028
     C           BTCHCY    WHEQ 'L'                                                           255028
     C                     MOVELLOCY      @CURR                                               255028
     C           BTCHCY    WHEQ 'F'                                                           255028
     C                     MOVELFCHCCY    @CURR                                               255028
     C           BTCHCY    WHEQ 'C'                                                           255028
     C           ADDC      ANDEQ'A'                                                           255028
     C                     MOVELSMCY      @CURR                                               255028
     C                     OTHER                                                              255028
     C                     MOVELPCCY      @CURR                                               255028
     C                     ENDSL                                                              255028
     C                     ENDIF                                                              255028
      *                                                                                       255028
     C                     CALL 'AOCURRR0'                                CFT009
     C                     PARM *BLANKS   @RTCD                           CFT009
     C                     PARM '*KEY   ' @OPTN                           CFT009
     C**********           PARM INCHGC    @CURR   3                       CFT009              255028
     C                     PARM           @CURR   3                                           255028
     C           SDCURR    PARM SDCURR    DSSDY                           CFT009
      *                                                                   CFT009
     C           @RTCD     IFNE *BLANKS                                   CFT009
     C                     MOVEL'SDCURRPD'WDBFIL           ***************CFT009
     C**********           MOVELWCCY      WDBKEY           * DB ERROR 16 *CFT009              255028
     C                     MOVEL@CURR     WDBKEY                                              255028
     C                     MOVEL'16'      WDBASE           ***************CFT009
     C                     EXSR UEABRT                                    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     Z-ADDA6NBDP    CHDP    10                      CFT009
      *                                                                   CFT009
      ** Retrieve currency details (levied)                               CFT009
      *                                                                   CFT009
     C                     CALL 'AOCURRR0'                                CFT009
     C                     PARM *BLANKS   @RTCD                           CFT009
     C                     PARM '*KEY   ' @OPTN                           CFT009
     C                     PARM WCCY      @CURR   3                       CFT009
     C           SDCURR    PARM SDCURR    DSSDY                           CFT009
      *                                                                   CFT009
     C           @RTCD     IFNE *BLANKS                                   CFT009
     C                     MOVEL'SDCURRPD'WDBFIL           ***************CFT009
     C                     MOVELWCCY      WDBKEY           * DB ERROR 09 *CFT009
     C                     MOVEL'09'      WDBASE           ***************CFT009
     C                     EXSR UEABRT                                    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     Z-ADDA6NBDP    WNDP    10                      CFT009
     C                     Z-ADDWNDP      ZADEC                           CFT009
      *                                                                   CFT009
      *                                                                   CFT009
     C                     MOVELWCCY      P2TXCY                          CFT009
     C                     MOVELWCCY      P2CQCY                          CFT009
     C                     MOVELWCCY      P2MSCY                          CFT009
     C                     MOVELWCCY      P2M1CY                          CFT009
     C                     MOVELWCCY      P2M2CY                          CFT009
     C                     MOVELWCCY      P2M3CY                          CFT009
     C                     MOVELWCCY      P2M4CY                          CFT009
     C                     MOVELWCCY      P2M5CY                          CFT009
     C                     MOVELWCCY      P2TRCY                          CFT009
     C                     MOVELWCCY      P2FXCY                          CFT009
     C                     MOVELWCCY      P2ADCY                          CFT009
     C                     MOVELWCCY      P2TLCY                          CFT009
      *                                                                   CFT009
      ** Move charge currency                                             CFT009
      *                                                                   CFT009
     C           CFT120    IFEQ 'Y'                                                           CFT120
     C           INCHGC    IFEQ *BLANKS                                                       CFT120
     C                     MOVE @CURR     INCHGC                                              CFT120
     C                     ENDIF                                                              CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
     C                     MOVELINCHGC    P2TXCC                          CFT009
     C                     MOVELINCHGC    P2CQCC                          CFT009
     C                     MOVELINCHGC    P2MSCC                          CFT009
     C                     MOVELINCHGC    P2M1CC                          CFT009
     C                     MOVELINCHGC    P2M2CC                          CFT009
     C                     MOVELINCHGC    P2M3CC                          CFT009
     C                     MOVELINCHGC    P2M4CC                          CFT009
     C                     MOVELINCHGC    P2M5CC                          CFT009
     C                     MOVELINCHGC    P2TRCC                          CFT009
     C                     MOVELINCHGC    P2FXCC                          CFT009
     C                     MOVELINCHGC    P2ADCC                          CFT009
     C                     MOVELINCHGC    P2TLCC                          CFT009
      *                                                                   CFT009
      ** Move spread set code in                                          CFT009
      *                                                                   CFT009
     C                     MOVE FXSPSC    P2FXSP                          CFT009
     C                     MOVE INPDOF    P2PDOF                          CFT009
      *                                                                   CFT009
      ** FORMAT TELEX CHARGE AMOUNT (levied)                              CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE TXCH      ZFIELD                          CFT009
     C                     Z-ADDWNDP      ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2TXCH                          CFT009
      *                                                                   CFT009
      ** FORMAT TELEX CHARGE AMOUNT CHARGES CURRENCY                      CFT009
      *                                                                   CFT009
     C                     Z-ADDDUMA2     WTLCG  150                      CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE DUMA2     ZFIELD                          CFT009
     C                     Z-ADDCHDP      ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2TXCA                          CFT009
      *                                                                   CFT009
      ** FORMAT CHEQUE CHARGE AMOUNT (levied)                             CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE CQCH      ZFIELD                          CFT009
     C                     Z-ADDWNDP      ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2CQCH                          CFT009
      *                                                                   CFT009
      ** FORMAT CHEQUE CHARGE AMOUNT CHARGES CURRENCY                     CFT009
      *                                                                   CFT009
     C                     ADD  DUMA3     WTLCG                           CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE DUMA3     ZFIELD                          CFT009
     C                     Z-ADDCHDP      ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2CQCA                          CFT009
      *                                                                   CFT009
      ** FORMAT MISCELLANEOUS CHARGE AMOUNT (levied)                      CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE MSCH      ZFIELD                          CFT009
     C                     Z-ADDWNDP      ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2MSCH                          CFT009
      *                                                                   CFT009
      ** FORMAT MISC CHARGE AMOUNT CHARGES CURRENCY                       CFT009
      *                                                                   CFT009
     C                     ADD  DUMA6     WTLCG                           CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE DUMA6     ZFIELD                          CFT009
     C                     Z-ADDCHDP      ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2MSCA                          CFT009
      *                                                                   CFT009
      ** Format Misc Charge Description 1                                 CFT009
      *                                                                   CFT009
     C           MSCH1     IFEQ *BLANKS                                   CFT009
     C                     MOVEADESC,1    P2M1DS                          CFT009
     C                     ELSE                                           CFT009
     C           MSCH1     CHAINFTPCHGL0             97                   CFT009
     C                     MOVELCHDESC    P2M1DS                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** FORMAT MISCELLANEOUS CHARGE AMOUNT 1 (levied)                    CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE MSC01     ZFIELD                          CFT009
     C                     Z-ADDWNDP      ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2M1CH                          CFT009
      *                                                                   CFT009
      ** FORMAT MISC1 CHARGE AMOUNT CHARGES CURRENCY                      CFT009
      *                                                                   CFT009
     C                     ADD  CMSC01    WTLCG                           CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE CMSC01    ZFIELD                          CFT009
     C                     Z-ADDCHDP      ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2M1CA                          CFT009
      *                                                                   CFT009
      ** Format Misc Charge Description 2                                 CFT009
      *                                                                   CFT009
     C           MSCH2     IFEQ *BLANKS                                   CFT009
     C                     MOVEADESC,2    P2M2DS                          CFT009
     C                     ELSE                                           CFT009
     C           MSCH2     CHAINFTPCHGL0             97                   CFT009
     C                     MOVELCHDESC    P2M2DS                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** FORMAT MISCELLANEOUS CHARGE AMOUNT 2 (levied)                    CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE MSC02     ZFIELD                          CFT009
     C                     Z-ADDWNDP      ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2M2CH                          CFT009
      *                                                                   CFT009
      ** FORMAT MISC2 CHARGE AMOUNT CHARGES CURRENCY                      CFT009
      *                                                                   CFT009
     C                     ADD  CMSC02    WTLCG                           CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE CMSC02    ZFIELD                          CFT009
     C                     Z-ADDCHDP      ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2M2CA                          CFT009
      *                                                                   CFT009
      ** Format Misc Charge Description 3                                 CFT009
      *                                                                   CFT009
     C           MSCH3     IFEQ *BLANKS                                   CFT009
     C                     MOVEADESC,3    P2M3DS                          CFT009
     C                     ELSE                                           CFT009
     C           MSCH3     CHAINFTPCHGL0             97                   CFT009
     C                     MOVELCHDESC    P2M3DS                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** FORMAT MISCELLANEOUS CHARGE AMOUNT 3 (levied)                    CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE MSC03     ZFIELD                          CFT009
     C                     Z-ADDWNDP      ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2M3CH                          CFT009
      *                                                                   CFT009
      ** FORMAT MISC3 CHARGE AMOUNT CHARGES CURRENCY                      CFT009
      *                                                                   CFT009
     C                     ADD  CMSC03    WTLCG                           CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE CMSC03    ZFIELD                          CFT009
     C                     Z-ADDCHDP      ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2M3CA                          CFT009
      *                                                                   CFT009
      ** Format Misc Charge Description 4                                 CFT009
      *                                                                   CFT009
     C           MSCH4     IFEQ *BLANKS                                   CFT009
     C                     MOVEADESC,4    P2M4DS                          CFT009
     C                     ELSE                                           CFT009
     C           MSCH4     CHAINFTPCHGL0             97                   CFT009
     C                     MOVELCHDESC    P2M4DS                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** FORMAT MISCELLANEOUS CHARGE AMOUNT 4 (levied)                    CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE MSC04     ZFIELD                          CFT009
     C                     Z-ADDWNDP      ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2M4CH                          CFT009
      *                                                                   CFT009
      ** FORMAT MISC4 CHARGE AMOUNT CHARGES CURRENCY                      CFT009
      *                                                                   CFT009
     C                     ADD  CMSC04    WTLCG                           CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE CMSC04    ZFIELD                          CFT009
     C                     Z-ADDCHDP      ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2M4CA                          CFT009
      *                                                                   CFT009
      ** Format Misc Charge Description 5                                 CFT009
      *                                                                   CFT009
     C           MSCH5     IFEQ *BLANKS                                   CFT009
     C                     MOVEADESC,5    P2M5DS                          CFT009
     C                     ELSE                                           CFT009
     C           MSCH5     CHAINFTPCHGL0             97                   CFT009
     C                     MOVELCHDESC    P2M5DS                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** FORMAT MISCELLANEOUS CHARGE AMOUNT 5 (levied)                    CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE MSC05     ZFIELD                          CFT009
     C                     Z-ADDWNDP      ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2M5CH                          CFT009
      *                                                                   CFT009
      ** FORMAT MISC5 CHARGE AMOUNT CHARGES CURRENCY                      CFT009
      *                                                                   CFT009
     C                     ADD  CMSC05    WTLCG                           CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE CMSC05    ZFIELD                          CFT009
     C                     Z-ADDCHDP      ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2M5CA                          CFT009
      *                                                                   CFT009
      **  FORMAT TRANSFER COMMISSION AMOUNT (levied)                      CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE TRCM      ZFIELD                          CFT009
     C                     Z-ADDWNDP      ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2TRCH                          CFT009
      *                                                                   CFT009
      ** FORMAT TRANSFER COMMISSION CHARGES CURRENCY                      CFT009
      *                                                                   CFT009
     C                     ADD  DUMA1     WTLCG                           CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE DUMA1     ZFIELD                          CFT009
     C                     Z-ADDCHDP      ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2TRCA                          CFT009
      *                                                                   CFT009
      ** Format the FX/Change Commission amount (levied)                  CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE INCHCM    ZFIELD                          CFT009
     C                     Z-ADDWNDP      ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2FXCH                          CFT009
      *                                                                   CFT009
      ** FORMAT FX/CHANGE COMMISSION CHARGES CURRENCY                     CFT009
      *                                                                   CFT009
     C           *IN30     IFEQ *ON                                       CFT009
     C                     ADD  INDUM7    WTLCG                           CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE INDUM7    ZFIELD                          CFT009
     C                     Z-ADDCHDP      ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2FXCA                          CFT009
      *                                                                   CFT009
      ** FORMAT ADVICE CHARGE AMOUNT (levied)                             CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE ADCH      ZFIELD                          CFT009
     C                     Z-ADDWNDP      ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2ADCH                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** FORMAT ADVICE CHARGE CURRENCY                                    CFT009
      *                                                                   CFT009
     C                     ADD  DUMA4     WTLCG                           CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE DUMA4     ZFIELD                          CFT009
     C                     Z-ADDCHDP      ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2ADCA                          CFT009
      *                                                                   CFT009
      ** FORMAT TELEPHONE CHARGE AMOUNT (levied)                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE TLCH      ZFIELD                          CFT009
     C                     Z-ADDWNDP      ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2TLCH                          CFT009
      *                                                                   CFT009
      ** FORMAT TELEPHONE CHARGES IN CHARGE CURRENCY                      CFT009
      *                                                                   CFT009
     C                     ADD  DUMA5     WTLCG                           CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE DUMA5     ZFIELD                          CFT009
     C                     Z-ADDCHDP      ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2TLCA                          CFT009
      *                                                                   CFT009
      ** MOVE CHARGE CODES IN                                             CFT009
      *                                                                   CFT009
     C                     MOVE TLCODE    P2TXCD                          CFT009
     C                     MOVE CHCHCD    P2CQCD                          CFT009
     C                     MOVE MISCH     P2MSCD                          CFT009
     C                     MOVE MSCH1     P2M1CD                          CFT009
     C                     MOVE MSCH2     P2M2CD                          CFT009
     C                     MOVE MSCH3     P2M3CD                          CFT009
     C                     MOVE MSCH4     P2M4CD                          CFT009
     C                     MOVE MSCH5     P2M5CD                          CFT009
     C                     MOVE TFCCCO    P2TRCD                          CFT009
     C                     MOVE FXCHEC    P2FXCD                          CFT009
     C                     MOVE ADCHCD    P2ADCD                          CFT009
     C                     MOVE TLCHCD    P2TLCD                          CFT009
      *                                                                   CFT009
      ** Set up the V.A.T. flags of all charges if CFT010 is active       CFT009
      *                                                                   CFT009
     C           CFT010    IFEQ 'Y'                                       CFT009
     C                     MOVE INVAT2    P2INV2                          CFT009
     C                     MOVE INVAT3    P2INV3                          CFT009
     C                     MOVE INVAT6    P2INV6                          CFT009
     C                     MOVE VTMIC1    P2IVM1                          CFT009
     C                     MOVE VTMIC2    P2IVM2                          CFT009
     C                     MOVE VTMIC3    P2IVM3                          CFT009
     C                     MOVE VTMIC4    P2IVM4                          CFT009
     C                     MOVE VTMIC5    P2IVM5                          CFT009
     C                     MOVE INVAT1    P2INV1                          CFT009
     C                     MOVE INVAT7    P2INV7                          CFT009
     C                     MOVE INVAT4    P2INV4                          CFT009
     C                     MOVE INVAT5    P2INV5                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** CALCULATE GRAND TOTALS CHARGES AND FORMAT                        CFT009
      *                                                                   CFT009
     C           TXCH      ADD  CQCH      WTLAM  140                      CFT009
     C                     ADD  MSCH      WTLAM                           CFT009
     C                     ADD  MSC01     WTLAM                           CFT009
     C                     ADD  MSC02     WTLAM                           CFT009
     C                     ADD  MSC03     WTLAM                           CFT009
     C                     ADD  MSC04     WTLAM                           CFT009
     C                     ADD  MSC05     WTLAM                           CFT009
     C                     ADD  TRCM      WTLAM                           CFT009
     C           *IN30     IFEQ *ON                                       CFT009
     C                     ADD  INCHCM    WTLAM                           CFT009
     C                     ENDIF                                          CFT009
     C                     ADD  ADCH      WTLAM                           CFT009
     C                     ADD  TLCH      WTLAM                           CFT009
      *                                                                   CFT009
      ** FORMAT GRAND TOTAL AMOUNT (LEVIED)                               CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE WTLAM     ZFIELD                          CFT009
     C                     Z-ADDWNDP      ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2TLAM                          CFT009
      *                                                                   CFT009
      ** FORMAT GRAND TOTAL CHARGE                                        CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE WTLCG     ZFIELD                          CFT009
     C                     Z-ADDCHDP      ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2TLCG                          CFT009
      *                                                                   CFT009
      ** FORMAT TOTAL VAT (LEVIED CURRENCY)                               CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE INVATT    ZFIELD                          CFT009
     C                     Z-ADDWNDP      ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2TLVT                          CFT009
      *                                                                   CFT009
      ** FORMAT TOTAL VAT (CHARGE CURRENCY)                               CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE INDUM8    ZFIELD                          CFT009
     C                     Z-ADDCHDP      ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2TLVC                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Reset decimal places to that of levied currency                  CFT009
      *                                                                   CFT009
     C                     Z-ADDWNDP      ZADEC                           CFT009
      *                                                                   CFT009
      ** Output Cover Message Details (CSW209)                                                CSW209
      *                                                                                       CSW209
     C           CSW209    IFEQ 'Y'                                                           CSW209
      *                                                                                       CSW209
     C                     MOVELINNWRK    PNNWRK                                              CSW209
     C                     MOVELINMTPY    PNMTPE                                              CSW209
     C                     MOVELINVALF    PNVALF                                              CSW209
      *                                                                                       CSW209
     C                     MOVE *BLANKS   PNCAMT                                              CSW209
     C           INCICY    IFNE *BLANKS                                                       CSW209
      *                                                                                       CSW209
      ** Get Input Currency decimal places.                                                   CSW209
      *                                                                                       CSW209
     C                     CALL 'AOCURRR0'                                                    CSW209
     C                     PARM *BLANK    @RTCD                                               CSW209
     C                     PARM '*KEY   ' @OPTN                                               CSW209
     C                     PARM INCICY    PCURR   3                                           CSW209
     C           SDCURR    PARM SDCURR    DSSDY                                               CSW209
      *                                                                                       CSW209
     C           @RTCD     IFNE *BLANKS                                                       CSW209
     C           *LOCK     IN   DLDA                                                          CSW209
     C                     MOVEL'SDCURRPD'DBFILE                                              CSW209
     C                     MOVEL'*VERIFY' DBKEY                                               CSW209
     C                     MOVEL'42'      DBASE                                               CSW209
     C                     OUT  DLDA                                                          CSW209
     C                     SETON                     U7U8LR                                   CSW209
     C                     EXSR UEABRT                     *ABORT PGM*                        CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
      ** Format amount for screen output                                                      CSW209
      *                                                                                       CSW209
     C                     Z-ADDA6NBDP    PFMDEC  10                                          CSW209
     C                     Z-ADDPFMDEC    ZADEC                                               CSW209
     C                     MOVE *BLANKS   ZFIELD                                              CSW209
     C                     MOVE INCIAM    ZFIELD                                              CSW209
     C                     EXSR ZEDIT                                                         CSW209
     C                     MOVE ZFIELD    PNCAMT                                              CSW209
      *                                                                                       CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     MOVELINCICY    PNCICY                                              CSW209
      *                                                                                       CSW209
     C                     MOVELINCOC1    PNCOC1                                              CSW209
     C                     MOVELINCOC2    PNCOC2                                              CSW209
     C                     MOVELINCOC3    PNCOC3                                              CSW209
     C                     MOVELINCOC4    PNCOC4                                              CSW209
     C                     MOVELINCOC5    PNCOC5                                              CSW209
      *                                                                                       CSW209
     C                     MOVELINCOB1    PNCOB1                                              CSW209
     C                     MOVELINCOB2    PNCOB2                                              CSW209
     C                     MOVELINCOB3    PNCOB3                                              CSW209
     C                     MOVELINCOB4    PNCOB4                                              CSW209
     C                     MOVELINCOB5    PNCOB5                                              CSW209
      *                                                                                       CSW209
     C                     MOVELINCIB1    PNCIB1                                              CSW209
     C                     MOVELINCIB2    PNCIB2                                              CSW209
     C                     MOVELINCIB3    PNCIB3                                              CSW209
     C                     MOVELINCIB4    PNCIB4                                              CSW209
     C                     MOVELINCIB5    PNCIB5                                              CSW209
      *                                                                                       CSW209
     C                     MOVELINCAB1    PNCAB1                                              CSW209
     C                     MOVELINCAB2    PNCAB2                                              CSW209
     C                     MOVELINCAB3    PNCAB3                                              CSW209
     C                     MOVELINCAB4    PNCAB4                                              CSW209
     C                     MOVELINCAB5    PNCAB5                                              CSW209
      *                                                                                       CSW209
     C                     MOVELINCBC1    PNCBC1                                              CSW209
     C                     MOVELINCBC2    PNCBC2                                              CSW209
     C                     MOVELINCBC3    PNCBC3                                              CSW209
     C                     MOVELINCBC4    PNCBC4                                              CSW209
     C                     MOVELINCBC5    PNCBC5                                              CSW209
      *                                                                                       CSW209
     C                     MOVELINCBB1    PNCBB1                                              CSW209
     C                     MOVELINCBB2    PNCBB2                                              CSW209
     C                     MOVELINCBB3    PNCBB3                                              CSW209
     C                     MOVELINCBB4    PNCBB4                                              CSW209
     C                     MOVELINCBB5    PNCBB5                                              CSW209
     C                     MOVELINCBB6    PNCBB6                                              CSW209
      *                                                                                       CSW209
     C                     MOVELINCDP1    PNCDP1                                              CSW209
     C                     MOVELINCDP2    PNCDP2                                              CSW209
     C                     MOVELINCDP3    PNCDP3                                              CSW209
     C                     MOVELINCDP4    PNCDP4                                              CSW209
      *                                                                                       CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C*                                                                   S01117
     C* IF @PENT NE 'ALL'                                                 S01117
     C* CALL ROUTINE FOR ZSFILE ONCE ONLY IF BRANCH NE 'ALL'              S01117
     C*                                                                   S01117
     C           @PENT     IFNE 'ALL'                                     S01117
     C           *IN21     ANDEQ'0'                                       S01117
     C                     EXSR ZSFLP1                                    S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C* IF CHANGE OF BRANCH DETECTED                                      S01117
     C*                                                                   S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C           *IN14     IFEQ '0'                                       S01117
     C           BRCA      ANDNESBRA                                      S01117
     C           *IN14     OREQ '1'                                       S01117
     C           ORBR      ANDNESBRA                                      S01117
     C*                                                                   S01117
     C* @PENT IFEQ 'ALL' AND CHANGE OF BRANCH,                            S01117
     C* WRITE FORMAT ENDING REPORT, CLOSE AND OPEN PRINTER FILE           S01117
     C*                                                                   S01117
     C           @PENT     IFEQ 'ALL'                                     S01117
     C           *IN21     IFEQ '1'                                       S01117
     C                     WRITEP1EOR                                     S01117
     C                     END                                            S01117
     C                     EXSR ZSFLP1                                    S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C* IF BRANCH CHANGED , MOVE BRCA/ORBR INTO WORKFIELD                 S01117
     C*                                                                   S01117
     C           *IN14     IFEQ '0'                                       S01117
     C                     MOVE BRCA      SBRA                            S01117
     C                     ELSE                                           S01117
     C                     MOVE ORBR      SBRA                            S01117
     C                     END                                            S01117
     C                     EXSR TABTR                                     S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C* SET UP OTHER BRANCH FIELD ON DETAIL REPORT.                       S01117
     C*                                                                   S01117
     C           *IN14     IFEQ '0'                                       S01117
     C           *IN15     ANDEQ'1'                                       S01117
     C                     MOVE ORBR      SBRO    3                       S01117
     C                     EXSR TABTR2                                    S01117
     C                     ELSE                                           S01117
     C                     MOVE BRCA      SBRO                            S01117
     C                     EXSR TABTR2                                    S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C*                                                                   055293
     C** Core hook for externalisation.                                   S01408
     C/COPY WNCPYSRC,FT0520CPLH                                           S01408
     C*                                                                   S01408
     C           ULX043    IFEQ 'Y'                                                           CER001
      *                                                                                       CER001
      ** Call PGM IL0458 to access Extension FTIPX1PD                                         CER001
      *                                                                                       CER001
     C                     MOVE 'N'       DOLX43  1        FLAG                               CER001
     C           BGNWST    IFEQ 'Y'                        Lux Returns                        CER001
     C           ULX043    ANDEQ'Y'                        IBLC 2002                          CER001
      *                                                                                       CER001
     C                     CALL 'IL0458'                                                      CER001
     C                     PARM PREF      PPREF  15                                           CER001
     C                     PARM *BLANKS   ILLINE                                              CER001
     C                     PARM *BLANK    PFAIL   1                                           CER001
      *                                                                                       CER001
      ** Set up IBLC lines array                                                              CER001
      *                                                                                       CER001
     C           PFAIL     IFEQ '0'                        no probl.                          CER001
     C                     MOVEAILLINE    IUL                                                 CER001
     C                     MOVE 'Y'       DOLX43           Print                              CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
     C                     ENDIF                                                              CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
     C*
     C** OUTPUT PAGE TO REPORT
     C*
     C                     WRITEP1HD
     C                     WRITEP1DETL
     C           ULX043    IFEQ 'Y'                                                           CER001
     C                     WRITEZZEXBLNK                                                      CER001
     C                     WRITEZZEXIBLC                                                      CER001
     C                     ENDIF                                                              CER001
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
     C                     WRITEP2HD                                      CFT009
     C                     WRITEP2DETL                                    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Print Cover message Information                                                      CSW209
      *                                                                                       CSW209
     C           CSW209    IFEQ 'Y'                                                           CSW209
      *                                                                                       CSW209
     C                     EXSR CHKOF2                                                      MD061867
     C                     WRITEP2NWRK                                                        CSW209
      *                                                                                       CSW209
     C           INVALF    IFEQ 'COV'                                                         CSW209
     C           PNCOCC    IFNE *BLANKS                                                       CSW209
     C           PNCOBC    ORNE *BLANKS                                                       CSW209
     C           PNCIBC    ORNE *BLANKS                                                       CSW209
     C           PNCABC    ORNE *BLANKS                                                       CSW209
     C           PNCBCC    ORNE *BLANKS                                                       CSW209
     C           PNCBBC    ORNE *BLANKS                                                       CSW209
     C           PNCDPC    ORNE *BLANKS                                                       CSW209
     C           PNCAMT    ORNE *BLANKS                                                       CSW209
     C           PNCICY    ORNE *BLANKS                                                       CSW209
     C                     WRITEP3HD                                                          CSW209
     C                     WRITEP3DETL                                                        CSW209
     C                     ENDIF                                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C           CGL013    IFEQ 'Y'                                                           CER030
     C           CER030    OREQ 'Y'                                                           CER030
     C                     MOVE IRTTY     P2RTTY                                              CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           CER031    IFEQ 'Y'                                                           CER030
     C                     MOVE IEXT1     P2EXT1                                              CER030
     C                     MOVE IEXT2     P2EXT2                                              CER030
     C                     MOVE IEXT3     P2EXT3                                              CER030
     C                     MOVE IEXT4     P2EXT4                                              CER030
     C                     MOVE IEXT5     P2EXT5                                              CER030
     C                     MOVE IEXT6     P2EXT6                                              CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           CGL013    IFEQ 'Y'                                                           CER030
     C           CER030    OREQ 'Y'                                                           CER030
     C           CER031    OREQ 'Y'                                                           CER030
     C                     WRITEP2HD                                                          CER030
     C                     WRITEP1EXNR                                                        CER030
     C                     ENDIF                                                              CER030
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0520CCP2                                           S01408
     C*                                                                   S01408
     C           ULX043    IFEQ 'Y'                                                           CER001
      *                                                                                       CER001
      ** If something to Print for IBLC 2002                                                  CER001
      *                                                                                       CER001
     C           DOLX43    IFEQ 'Y'                                                           CER001
     C                     WRITEZZEXBLNK                   blank Line                         CER001
      *                                                                                       CER001
     C                     DO   3         UL      10       max 3 lines                        CER001
     C           IUL,UL    IFNE *BLANKS                    write details                      CER001
     C                     MOVELIUL,UL    RRLINE                                              CER001
     C                     WRITEZZEXIBLC                                                      CER001
     C                     ENDIF                                                              CER001
     C                     ENDDO                                                              CER001
      *                                                                                       CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
     C                     ENDIF                                                              CER001
     C                     MOVE '1'       *IN21            'OUTPUT, YES
     C*
     C*          *****     *****
     C           CCEND     ENDSR
     C*          *****     *****
      /EJECT                                                              S01435
      *****************************************************************   S01435
      **                                                                  S01435
      **    Get name for Type.                                            S01435
      **                                                                  S01435
      **    CALLED FROM:  anywhere                                        S01435
      **    CALLS:                                                        S01435
      **                                                                  S01435
      **                                                                  S01435
     C           GETADD    BEGSR                                          S01435
      *                                                                   S01435
      *                                                                   S01435
      *  Set up general parameters                                        S01435
      *                                                                   S01435
     C           *LIKE     DEFN BCCY      XCCY                            S01435
      *                                                                   S01435
     C                     CLEARW8FT                                      S01435
     C                     MOVEL*BLANKS   W8STMT                          S01435
     C                     MOVELXCCY      W8CCY                           S01435
     C                     MOVEL##PGM     W8CPGM                          S01435
     C                     MOVEL'*PRINT'  W8ACT                           S01435
     C                     Z-ADD5         W8NLIN                          S01435
      **********                                                                       S01435 235937
      ***If*an*audit then data is critical                                             S01435 235937
      **********                                                                       S01435 235937
     C********** PARM1     IFEQ 'A'                                                    S01435 235937
     C********** OTRECI    ANDEQ'D'                                                    070846 235937
     C********** XCALL     ANDNE'MRCR'                                                 073730 235937
     C**********           MOVEL'Y'       W8CRIT                                       S01435 235937
     C**********           END                                                         S01435 235937
      *                                                                   S01435
      *  Set up Paramters                                                 S01435
      *                                                                   S01435
     C                     MOVELXTYPE     W8TYPE                          S01435
     C                     MOVEL*BLANKS   W8LINS                          S01435
     C                     MOVELXNAMDS    W8LINS                          S01435
      *                                                                   S01435
      * Call expansion program                                            S01435
      *                                                                   S01435
     C                     CALL 'FT0315'               8989               S01435
     C                     PARM           W8RTN   7                       S01435
     C                     PARM           W8FT                            S01435
     C                     PARM           W8LINS256                       S01435
     C                     PARM           W8RPT 256                       S01435
     C                     PARM           W8MSG 256                       S01435
     C                     PARM           W8SCR 256                       S01435
      *                                                                   S01435
      ** Check if database error occurred                                 S01435
      *                                                                   S01435
     C           *IN89     IFEQ '1'                                       S01435
     C           W8RTN     ORNE *BLANKS                                   S01435
     C                     MOVEL'FT0315'  WDBFIL                          S01435
     C                     MOVEL'*CALL'   WDBKEY                          S01435
     C                     MOVEL'52'      WDBASE                          S01435
     C                     EXSR UEABRT                     *ABORT PGM*    S01435
     C                     END                                            S01435
      *                                                                   S01435
     C                     MOVELW8RPT     XNAMDS                          S01435
      *                                                                   S01435
     C                     ENDSR                                          S01435
     C/EJECT
     C           CHOPF     BEGSR
     C*          ******    *****
     C*
     C*****************************************************************
     C*                 CHOP FIELD PROCESSING                         *
     C*                                                               *
     C***FUNCTION*:*TO*EDIT**RCCO,*ACBK,*CDRO**FOR*OUTPUT.*           *
     C*  FUNCTION : TO EDIT  RCCO, CDRO  FOR OUTPUT.                  *
     C*             IF PRMFLD IS ZERO THEN OUTPUT BLANKS.             *
     C*             IF PRMTYP IS 'N',OUTPUT FIRST TWO CHARS.          *
     C*             IF PRMTYP ID 'R',OUTPUT FIRST TEN CHARS.          *
     C*                                                               *
     C*  CALLS :    NONE                                              *
     C*                                                               *
     C*  CALLED BY: CCDETL                                            *
     C*                                                               *
     C*****************************************************************
     C*
     C           PRMFLD    IFEQ *ZEROS
     C                     MOVE *BLANKS   PRMFLD
     C                     ELSE
     C*
     C           PRMTYP    IFEQ 'N'
     C                     MOVE BLNK10    PRMFLD
     C                     ELSE
     C*
     C           PRMTYP    IFEQ 'R'
     C                     MOVE BLNK2     PRMFLD
     C*
     C                     END
     C                     END
     C                     END
     C*
     C*                    *****
     C                     ENDSR
     C*                    *****
     C/EJECT
     C           CELAST    BEGSR
     C*          ******    *****
     C*
     C*****************************************************************
     C*                 CE-LAST-RECORD-PROCESSING                     *
     C*                                                               *
     C*  FUNCTION : TO PERFORM CONTROL CHECKS WHEN THE TRAILER        *
     C*             RECORD IS READ.                                   *
     C*                                                               *
     C*  CALLS :    NONE                                              *
     C*                                                               *
     C*  CALLED BY: AAMAIN                                            *
     C*                                                               *
     C*****************************************************************
     C*                                                                   S01117
     C* ACCESS INPAYZZ- TRAILER FOR INCOMING PAYMENTS                     S01117
     C*                                                                   S01117
     C                     READ INPAYZZ                  89               S01117
     C*                                                                   S01117
     C           *IN89     IFEQ '1'                                       S01117
     C                     MOVEL'INPAYZZ' WDBFIL           ***************S01117
     C                     MOVEL*BLANKS   WDBKEY           * DB ERROR 07 *S01117
     C                     MOVEL'07'      WDBASE           ***************S01117
     C                     EXSR UEABRT                                    S01117
     C                     END                                            S01117
     C*
     C** CHECK CONTROL TOTALS
     C*
     C*********************Z-ADDNORE1     P2NORE                          S01194
     C*********************Z-ADDHRWN      P2HRWN                          S01194
     C*********************Z-ADDHRDC      P2HRDC                          S01194
     C*********************Z-ADDZZTOTI    P2CLWN                          S01194
     C*********************Z-ADDZZTOTD    P2CLDC                          S01194
     C                     Z-ADDNORE1     AUNORE                          S01194
     C                     Z-ADDHRWN      AUHRWN                          S01194
     C                     Z-ADDHRDC      AUHRDC                          S01194
     C                     Z-ADDZZTOTI    AUCLWN                          S01194
     C                     Z-ADDZZTOTD    AUCLDC                          S01194
     C*
     C           @PLEV     IFEQ 'S'                                       S01117
     C***********P2NORE****IFNE P2CLNO                                    S01194
     C***********P2HRWN****ORNE P2CLWN                                    S01194
     C***********P2HRDC****ORNE P2CLDC                                    S01194
     C           AUNORE    IFNE AUCLNO                                    S01194
     C           AUHRWN    ORNE AUCLWN                                    S01194
     C           AUHRDC    ORNE AUCLDC                                    S01194
     C                     SETON                     U8
     C                     MOVEL'*** DIFF'WA16   16
     C                     MOVE 'ERENCE *'WA16
     C*********************MOVELWA16      P2DIFF                          S01194
     C*********************MOVE '**'      P2DIFF                          S01194
     C                     MOVELWA16      AUDIFF                          S01194
     C                     MOVE '**'      AUDIFF                          S01194
     C                     END
     C                     END                                            S01117
     C*
     C                     Z-ADD0         PAGE                            S01117
     C           *IN21     IFEQ '0'                        NO DETAIL
     C           *IN10     IFEQ '1'                                       S01117
     C           @PLEV     IFNE 'S'                                       S01117
     C                     MOVEL@PENT     SBRA                            S01117
     C                     EXSR TABTR                                     S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C*********************WRITEP1HD                       ON THE         S01117
     C*********************WRITEP1NODT                     REPORT         S01117
     C                     WRITEAUHEAD                                    S01117
     C                     WRITEAUNODT                                    S01117
     C                     WRITEAUEOR                                     S01117
     C*********************END                                            S01117
     C                     ELSE                                           S01117
     C*---------------------------------------------------------------
     C*
     C** OUTPUT CONTROL REPORT
     C*
     C*********************WRITEP2HEAD                                    S01117
     C*********************WRITEP2CNTL                                    S01117
     C*********************WRITEP2EOR                                     S01117
     C           @PENT     IFEQ 'ALL'                                     S01117
     C                     MOVE @PENT     SBRA                            S01117
     C                     MOVE *BLANKS   PBRNM                           S01117
     C                     END                                            S01117
     C                     WRITEAUHEAD                                    S01117
     C                     WRITEAUCNTL                                    S01117
     C                     WRITEAUEOR                                     S01117
     C                     END                                            S01117
     C*
     C** OUTPUT END-OF-REPORT MESSAGE TO DETAIL REPORT
     C*
     C           *IN21     IFEQ '1'                                       S01117
     C                     WRITEP1EOR
     C                     END                                            S01117
     C*
     C** TERMINATE PROGRAM
     C*
     C                     SETON                     LR
     C*
     C*          *****     *****
     C           CEEND     ENDSR
     C*          *****     *****
     C/EJECT
     C           UATBCN    BEGSR
     C*          ******    *****
     C*
     C*****************************************************************
     C*                 UA-CHAIN-TABLE-FILE                           *
     C*                                                               *
     C*  FUNCTION : TO ATTEMPT TO ACCESS A REQUESTED RECORD FROM THE  *
     C*             TABLE FILE.                                       *
     C*                                                               *
     C*  CALLS :    NONE                                              *
     C*                                                               *
     C*  CALLED BY: AAMAIN                                            *
     C*             ECINST                                            *
     C*                                                               *
     C*****************************************************************
     C*
     C           ZTABKY    CHAINTABFP                89
     C*
     C  N89      RECI      COMP 'D'                  8989
     C*
     C*          *****     *****
     C           UAEND     ENDSR
     C*          *****     *****
     C/EJECT
     C           UCMUSE    BEGSR
     C*          ******    *****
     C*
     C*****************************************************************
     C*                 UC-CHAIN-USER-FILE                            *
     C*                                                               *
     C*  FUNCTION : TO ATTEMPT TO ACCESS THE RECORD FROM THE USER     *
     C*             FILE.                                             *
     C*                                                               *
     C*  CALLS :    NONE                                              *
     C*                                                               *
     C*  CALLED BY: CADETL                                            *
     C*                                                               *
     C*****************************************************************
     C*
     C           USRP      CHAINMUSERDDF             89
     C*
     C  N89      RECI      COMP 'D'                  8989
      *
     C** Remove DBERROR processing as user may not exist after a migration084523
     C*                                                                   084523
     C******     *IN89     IFEQ '1'                        ************** 084523
     C******               MOVEL'MUSER'   WDBFIL           * DATA BASE  * 084523
     C******               MOVELUSRP      WDBKEY           *  ERROR 12  * 084523
     C******               MOVEL'12'      WDBASE           ************** 084523
     C******               EXSR UEABRT                     *ABORT PGM*    084523
     C******               END                                            084523
     C*
     C*                    *****
     C                     ENDSR
     C*                    *****
     C/EJECT
     C           UCCLCN    BEGSR
     C*          ******    *****
     C*
     C*****************************************************************
     C*                 UC-CHAIN-PAYMENT-CHARGES-FILE                 *
     C*                                                               *
     C*  FUNCTION : TO ATTEMPT TO ACCESS THE RECORD FROM THE PAYMENT  *
     C*             CHARGES FILE.                                     *
     C*                                                               *
     C*  CALLS :    NONE                                              *
     C*                                                               *
     C*  CALLED BY: CADETL                                            *
     C*             EEAMND                                            *
     C*                                                               *
     C*****************************************************************
     C*
     C           WCLKEY    KLIST
     C**********           KFLD           WCLNUM  60                                          CSD027
     C                     KFLD           WCLNUM  6                                           CSD027
     C                     KFLD           WCLRCT  1
     C*
     C           WCLKEY    CHAINCLINT                89
     C*
     C  N89      RECI      COMP 'D'                  8989
     C*
     C*          *****     *****
     C           UCEND     ENDSR
     C*          *****     *****
     C/EJECT
     C           UEABRT    BEGSR
     C*          ******    *****
     C*
     C*****************************************************************
     C*                 UE-ABORT-PROGRAM                              *
     C*                                                               *
     C*  FUNCTION : TO ABORT THE PROGRAM IN THE EVENT OF A DATABASE   *
     C*             ERROR. ALSO TO SETUP THE RELEVANT FIELDS IN THE   *
     C*             DATA AREA LDA FOR THIS ERROR.                     *
     C*                                                               *
     C*  CALLS :    NONE                                              *
     C*                                                               *
     C*  CALLED BY: AAMAIN                                            *
     C*             ECINST                                            *
     C*             EEAMND                                            *
     C*             UCMUSE                                            *
     C*                                                               *
     C*****************************************************************
     C*
     C** UPDATE DATA AREA LDA
     C*
     C           *NAMVAR   DEFN LDA       DLDA
     C           *LOCK     IN   DLDA
     C                     MOVEL'FT0520'  DBPGM
     C                     MOVELWDBFIL    DBFILE
     C                     MOVELWDBKEY    DBKEY
     C                     MOVELWDBASE    DBASE
     C                     OUT  DLDA
     C*
     C** SETON INDICATORS TO INDICATE DATABASE ERRORS
     C*
     C                     SETON                     U7U8LR
     C*
     C** REPORT DATABASE ERROR
     C*
     C                     Z-ADD0         PAGE                            S01194
     C           *IN10     IFEQ '1'                                       S01117
     C                     MOVE @PENT     SBRA                            S01117
     C           @PENT     IFEQ 'ALL'                                     S01117
     C                     MOVE *BLANKS   PBRNM                           S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C*********************WRITEP2HEAD                                    S01194
     C                     WRITEAUHEAD                                    S01194
     C*
     C*********************MOVELWDBASE    P2DBAS                          S01194
     C*********************MOVELWDBFIL    P2DBFL                          S01194
     C*********************MOVELWDBKEY    P2DBKY                          S01194
     C                     MOVELWDBASE    AUDBAS                          S01194
     C                     MOVELWDBFIL    AUDBFL                          S01194
     C                     MOVELWDBKEY    AUDBKY                          S01194
     C*
     C*********************WRITEP2DBER                                    S01194
     C                     WRITEAUDBER                                    S01194
     C*
     C** PRODUCE PROGRAM DUMP
     C*
     C                     DUMP
     C*
     C** END PROGRAM
     C*
     C                     RETRN
     C*
     C*          *****     *****
     C           UEEND     ENDSR
     C*          *****     *****
     C/EJECT
     C           UGFRMT    BEGSR
     C*          ******    *****
     C*
     C*****************************************************************
     C*             UG-FORMAT-FIELD-FOR-OUTPUT-TO-REPORT              *
     C*                                                               *
     C*  FUNCTION : TO FORMAT A NUMERIC FIELD FROM THE PAYMENT        *
     C*             CHARGES FILE FOR OUTPUT TO THE DETAIL SCREEN.     *
     C*             IT REMOVES LEADING ZEROES & INSERTS A DECIMAL     *
     C*             POINT IN THE APPROPRIATE POSITION.                *
     C*                                                               *
     C*  CALLS :    NONE                                              *
     C*                                                               *
     C*  CALLED BY: CADETL                                            *
     C*                                                               *
     C*****************************************************************
     C*
     C                     MOVEAWFDIN     WA1,1
     C*
     C** REPLACE LEADING ZEROES (IF LEFT OF DECIMAL POINT) WITH SPACES
     C*
     C                     SETOF                     89
     C           15        SUB  WDIG      I       30        -START
     C                     SUB  WDEC      I                  POS.
     C*
     C           14        SUB  WDEC      I1      30
     C*
     C           *IN89     DOUEQ'1'
     C                     ADD  1         I
     C           I         IFGT 15                          -CHECK FOR
     C                     SETON                     89      ARRAY END
     C                     ELSE
     C           WA1,I     IFNE '0'                         -CHECK FOR
     C                     SETON                     89      NON-ZERO
     C                     ELSE                              DIGIT.
     C           I         IFLE I1
     C                     MOVEL' '       WA1,I
     C                     END
     C                     END
     C                     END
     C                     END
     C*
     C** MOVE DIGITS TO RIGHT OF DECIMAL POINT(IF ANY) TO OUTPUT ARRAY
     C** & INSERT A DECIMAL POINT
     C*
     C                     MOVEL*BLANKS   WA2
     C*
     C           16        SUB  WDEC      I
     C           21        SUB  WDEC      I1
     C*
     C           I         IFLE 15
     C                     MOVEAWA1,I     WA2,I1
     C                     SUB  1         I1
     C                     MOVEL'.'       WA2,I1
     C                     END
     C*
     C** INSERT A COMMA AFTER EVERY 3 DIGITS TO LEFT OF DECIMAL POINT
     C*
     C                     SUB  1         I
     C                     SUB  1         I1
     C                     Z-ADD*ZERO     I2      30
     C*
     C           WA1,I     DOUEQ' '
     C           I         OREQ *ZERO
     C*
     C           I2        IFEQ 3
     C                     MOVEL','       WA2,I1
     C                     SUB  1         I1
     C                     Z-ADD*ZERO     I2
     C                     END
     C*
     C                     MOVE WA1,I     WA2,I1
     C                     SUB  1         I
     C                     SUB  1         I1
     C                     ADD  1         I2
     C                     END
     C*
     C                     MOVEAWA2,1     WFDOUT 20
     C*
     C*          *****     *****
     C           UGEND     ENDSR
     C*          *****     *****
     C           TABTR     BEGSR                                          S01117
     C*          ******    *****                                          S01117
     C*                                                                   S01117
     C*****************************************************************   S01117
     C*             TABLETR CHAIN TO RETRIEVE BRANCH NAME             *   S01117
     C*                                                               *   S01117
     C*  FUNCTION : TO ACCESS BRANCH NAME BRNM FROM TABLETR           *   S01117
     C*                                                               *   S01117
     C*  CALLS :    NONE                                              *   S01117
     C*                                                               *   S01117
     C*  CALLED BY: MAIN SUBROUTINE                                   *   S01117
     C*                                                               *   S01117
     C*****************************************************************   S01117
     C*                                                                   S01117
     C**  SET UP KEY AND ACCESS INST. CONTROL REC BRANCH CODE (TABLETR)   S01117
     C*                                                                   S01117
     C**********           MOVE *BLANKS   ZTABKY                                      S01117 BUG7985
     C**********           MOVEL'10    '  ZTABKY                                      S01117 BUG7985
     C**********           MOVE SBRA      ZTABKY                                      S01117 BUG7985
     C           SBRA      IFNE 'ALL'                                     S01117
     C*                                                                   S01117
     C********** ZTABKY    CHAINTABLETRF             89                               S01117 BUG7985
     C********** *IN89     IFEQ '0'                                                   S01117 BUG7985
     C********** RECI      COMP 'D'                  8989  ON , DELETED               S01117 BUG7985
     C**********           END                                                        S01117 BUG7985
      *                                                                                      BUG7985
     C                     CALL 'AOBRCHR1'                                                   BUG7985
     C                     PARM *BLANKS   PRTCD   7                                          BUG7985
     C                     PARM '*KEY   ' POPTN   7                                          BUG7985
     C                     PARM SBRA      PBRCH   3                                          BUG7985
     C           SDBRCH    PARM SDBRCH    DSSDY                                              BUG7985
     C*                                                                   S01117
     C** DB ERROR IF NO RECORD FOUND.                                     S01117
     C*                                                                   S01117
     C           PRTCD     IFNE *BLANKS                                                      BUG7985
     C********** *IN89     IFEQ '1'                                                   S01117 BUG7985
     C**********           MOVEL'TABLE'   WDBFIL           ***************            S01117 BUG7985
     C**********           MOVELZTABKY    WDBKEY           * DB ERROR 13 *            S01117 BUG7985
     C                     MOVEL'SDBRCHPD'WDBFIL
     C                     MOVELSBRA      WDBKEY
     C                     MOVEL'13'      WDBASE           ***************S01117
     C                     EXSR UEABRT                                    S01117
     C                     ELSE                                           S01117
     C**********           MOVELBRNM      PBRNM                                       S01117 BUG7985
     C                     MOVELA8BRNM    PBRNM                                              BUG7985
     C                     END                                            S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C*                    *****                                          S01117
     C                     ENDSR                                          S01117
     C*                    *****                                          S01117
     C/EJECT                                                              S01117
     C           TABTR2    BEGSR                                          S01117
     C*          ******    *****                                          S01117
     C*                                                                   S01117
     C*****************************************************************   S01117
     C*             TABLETR CHAIN TO RETRIEVE BRANCH NAME             *   S01117
     C*                                                               *   S01117
     C*  FUNCTION : TO ACCESS BRANCH NAME BRNM FROM TABLETR           *   S01117
     C*             FOR OTHER BRANCH FIELD ON DETAIL RECORD           *   S01117
     C*                                                               *   S01117
     C*  CALLS :    NONE                                              *   S01117
     C*                                                               *   S01117
     C*  CALLED BY: MAIN SUBROUTINE                                   *   S01117
     C*                                                               *   S01117
     C*****************************************************************   S01117
     C*                                                                   S01117
     C**  SET UP KEY AND ACCESS INST. CONTROL REC BRANCH CODE (TABLETR)   S01117
     C*                                                                   S01117
     C**********           MOVE *BLANKS   ZTABKY                                      S01117 BUG7985
     C**********           MOVEL'10    '  ZTABKY                                      S01117 BUG7985
     C**********           MOVE SBRO      ZTABKY                                      S01117 BUG7985
     C*                                                                   S01117
     C********** ZTABKY    CHAINTABLETRF             89                               S01117 BUG7985
     C********** *IN89     IFEQ '0'                                                   S01117 BUG7985
     C********** RECI      COMP 'D'                  8989  ON , DELETED               S01117 BUG7985
     C**********           END                                                        S01117 BUG7985
      *                                                                                      BUG7985
     C                     CALL 'AOBRCHR1'                                                   BUG7985
     C                     PARM *BLANKS   PRTCD   7                                          BUG7985
     C                     PARM '*KEY   ' POPTN   7                                          BUG7985
     C                     PARM SBRO      PBRCH   3                                          BUG7985
     C           SDBRCH    PARM SDBRCH    DSSDY                                              BUG7985
     C*                                                                   S01117
     C** DB ERROR IF NO RECORD FOUND.                                     S01117
     C*                                                                   S01117
     C           PRTCD     IFNE *BLANKS                                                      BUG7985
     C********** *IN89     IFEQ '1'                                                   S01117 BUG7985
     C**********           MOVEL'TABLE'   WDBFIL           ***************            S01117 BUG7985
     C**********           MOVELZTABKY    WDBKEY           * DB ERROR 14 *            S01117 BUG7985
     C                     MOVEL'SDBRCHPD'WDBFIL                                             BUG7985
     C                     MOVELSBRO      WDBKEY                                             BUG7985
     C                     MOVEL'14'      WDBASE           ***************S01117
     C                     EXSR UEABRT                                    S01117
     C                     ELSE                                           S01117
     C**********           MOVELBRNM      PBRNO                                       S01117 BUG7985
     C                     MOVELA8BRNM    PBRNO                                              BUG7985
     C                     END                                            S01117
     C*                                                                   S01117
     C*                    *****                                          S01117
     C                     ENDSR                                          S01117
     C*                    *****                                          S01117
     C/EJECT                                                              S01117
     C           ZSFLP1    BEGSR                                          S01117
     C*          ******    *****                                          S01117
     C*                                                                   S01117
     C*****************************************************************   S01117
     C*            ZSFILE PROCESSING FOR P1 FILE                      *   S01117
     C*                                                               *   S01117
     C* FUNCTION:  TO CLOSE AND OPEN P1 PRINTER FILE AND CALL ZSFILE  *   S01117
     C*                                                               *   S01117
     C* CALLED BY : MAIN SUBROUTINE                                   *   S01117
     C*                                                               *   S01117
     C*****************************************************************   S01117
     C*                                                                   S01117
     C** SETUP SPOOL FILE DETAILS                                         S01117
     C*                                                                   S01117
     C           *IN11     IFEQ '0'                        NOT SYSTEM     S01117
     C           *IN14     IFEQ '0'                                       S01117
     C                     MOVE BRCA      ZENT             BOOKING        S01117
     C                     ELSE                                           S01117
     C                     MOVE ORBR      ZENT             ORIGINATING    S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C** CLOSE AND OPEN PRINTER FILE                                      S01117
     C*                                                                   S01117
     C                     CLOSEFT0520P1                                  S01117
     C                     OPEN FT0520P1                                  S01117
     C                     Z-ADD0         PAGE                            S01117
     C*                                                                   S01117
     C** CALL'ZSFILE' TO LOG SPOOL FILE DETAILS                           S01117
     C*                                                                   S01117
     C                     MOVELSFILE1    ZSFLNA                          S01117
     C                     Z-ADDSFNUM1    ZSSLNO                          S01117
     C*                                                                   S01117
     C                     CALL 'ZSFILE'                                  S01117
     C***********          PARM           PSEQ    5                S01117 135573
     C                     PARM           @PSEQ   5                       135573
     C                     PARM           ZENT    3                       S01117
     C                     PARM           ZSFLNA 10                       S01117
     C                     PARM           ZSSLNO  60                      S01117
     C                     PARM *BLANKS   ZERR    1                       S01117
     C*                                                                   S01117
     C** ABORT PROGRAM IF ZERR IS NOT BLANK                               S01117
     C*                                                                   S01117
     C           ZERR      IFNE *BLANK                                    S01117
     C                     SETON                     U7U8                 S01117
     C           *LOCK     IN   DLDA                                      S01194
     C                     MOVEL'FT0520'  DBPGM                           S01194
     C                     MOVEL'FT520P1' DBKEY            ***************S01194
     C                     MOVEL'ZSFILE'  DBFILE           * DB ERROR 17 *S01194
     C                     MOVEL'017'     DBASE            ***************S01194
     C                     OUT  DLDA                                      S01194
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C*                    *****                                          S01117
     C                     ENDSR                                          S01117
     C*                    *****                                          S01117
     C/EJECT
     C**
     C**
     C********************************************************************
     C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
     C*   IND '99' IS SET BY AN OVERFLOW ERROR
     C*
     C           GLZADD    BEGSR                           *** GLZADD ****
     C*
     C                     Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
     C   91                GOTO ZZAEND                     AMT = 0.BYPASS
     C*
     C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
     C                     Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
     C                     MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
     C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
     C*
     C                     EXSR GLZSUM
     C           ZZAEND    ENDSR                           ** ZZAEND TAG *
     C/EJECT
     C*
     C********************************************************************
     C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
     C*                        GLZADD, GLZSUB, GLZCMP.
     C*          PARAMETERS PASSED -
     C*                     I/P ZZAMTI ZZAMTD
     C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
     C*
     C           GLZSUM    BEGSR                           *** GLZSUM ****
     C*
     C                     Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
     C                     Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
     C                     SETOF                     919293
     C                     SETOF                     949599
     C*
     C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
     C           ZZAMTI    COMP 0                      9293
     C   93      ZZAMTD    COMP 0                      9293
     C   93                GOTO ZZSEND                     ZERO BYPASS
     C*
     C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
     C           ZZTOTI    COMP 0                      9193
     C   93      ZZTOTD    COMP 0                      9193
     C*
     C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
     C   93                Z-ADDZZAMTI    ZZTOTI
     C   93                Z-ADDZZAMTD    ZZTOTD
     C   93                GOTO ZZSEND                     ZERO BYPASS
     C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
     C   91N92
     CORN91 92             GOTO ZZOFPS
     C*
     C           ZZAMTD    ADD  ZZTOTD    ZZWK2   40
     C           ZZWK2     COMP 999                  93    '93' = CARRY
     C  N93      ZZWK2     COMP -999                   93    INTO INTEGER.
     C*
     C   93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
     C      93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
     C   93      ZZTOTI    ADD  ZZWK3     ZZWK3
     C  N93      ZZTOTI    ADD  ZZAMTI    ZZWK3
     C*
     C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
     C  N92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
     C   92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
     C  N99                Z-ADDZZWK2     ZZTOTD
     C  N99                Z-ADDZZWK3     ZZTOTI
     C*
     C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
     C   99                Z-ADD0         ZZAMT  153
     C                     GOTO ZZSEND
     C*
     C* THE 'SIGNS' ARE DIFFERENT
     C           ZZOFPS    TAG                             ** ZZOFPS TAG**
     C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
     C*
     C   92                Z-SUBZZAMTI    ZZAMTI 150
     C   92                Z-SUBZZAMTD    ZZAMTD  30
     C*
     C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
     C*
     C   91                Z-SUBZZTOTI    ZZTOTI
     C   91                Z-SUBZZTOTD    ZZTOTD
     C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
     C*
     C           ZZTOTI    COMP ZZAMTI               93  95
     C   95      ZZTOTD    COMP ZZAMTD               93  95
     C*
     C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
     C   95                Z-ADD0         ZZTOTI
     C   95                Z-ADD0         ZZTOTD
     C   95                GOTO ZZSEND
     C*
     C* IF ZZTOT GT. ZZAMT.
     C   93      ZZAMTD    COMP ZZTOTD               94
     C   93 94   ZZTOTI    SUB  1         ZZTOTI
     C   93 94   ZZTOTD    ADD  1000      ZZWK2
     C   93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
     C   93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
     C   93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
     C*
     C*
     C* IF ZZAMT GT. ZZTOT.
     C  N93      ZZTOTD    COMP ZZAMTD               94
     C  N93 94   ZZAMTI    SUB  1         ZZWK3  150
     C  N93 94   ZZAMTD    ADD  1000      ZZWK2
     C  N93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
     C  N93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
     C  N93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
     C  N93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
     C*
     C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
     C                     SETOF                     94
     C   93 91
     CORN93 92             SETON                     94
     C   94                Z-SUBZZTOTI    ZZTOTI
     C   94                Z-SUBZZTOTD    ZZTOTD
     C**
     C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
     C   92                Z-SUBZZAMTI    ZZAMTI
     C   92                Z-SUBZZAMTD    ZZAMTD
     C           ZZSEND    TAG                             ** ZZSEND TAG *
     C**
     C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
     C                     SETOF                     96
     C           ZZTOTD    COMP 0                        91
     C   91      ZZTOTI    COMP 0                      96
     C   96                MOVE '.000-'   ZZNEGD  5
     C                     ENDSR                             ** ENDSR **
     C/EJECT
     C**
     C**
     C********************************************************************
     C**
     C**   ZDATE2 SR. TO CONVERT A DAY NUMBER TO DATE FORMATS.
     C**
     C**   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.
     C**
     C           ZDATE2    BEGSR                           *** ZDATE2 ***
     C**
     C**   CLEAR DATE FIELDS.
     C                     Z-ADD0         ZDATE   60
     C                     MOVEL'       ' ZADATE  7
     C**
     C**   CALCULATION TO DEFINE INPUT DAY NUMBER.
     C                     Z-ADDZDAYNO    ZDAYNO  50
     C**
     C**   DETERMINE YEAR NUMBER.
     C**
     C**   ADJUST DAY NUMBER IN CASE LAST DAY OF YEAR.
     C           ZDAYNO    SUB  1         ZDAYN1  50   99
     C   99                GOTO ZDEND2
     C**
     C**   CALCULATE NUMBER OF 4 YEAR SPANS SINCE 31/12/1971.
     C           ZDAYN1    DIV  1461      ZLYR    20
     C                     MVR            ZDAYN1           SAVE REMAINING
     C**                                                   DAYS
     C**   CALCULATE NUMBER OF REMAINING YEARS.
     C                     Z-ADD1         ZWRK2   20
     C           ZDTAG1    TAG                             ** ZDTAG1 TAG *
     C           ZDAYN1    COMP ZYDY,ZWRK2             90
     C  N90      ZWRK2     ADD  1         ZWRK2
     C  N90                GOTO ZDTAG1
     C           ZWRK2     SUB  1         ZWRK2          91LEAP YR, 91 ON
     C**
     C**   DECREMENT DAY NO. BY DAYS IN REMAINING YEARS.
     C  N91      ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1
     C**
     C**   CALCULATE ACTUAL YEAR NUMBER.
     C           ZLYR      MULT 4         ZWRK3   30
     C           ZWRK3     ADD  72        ZWRK3            BASE IS 1972
     C                     Z-ADDZWRK3     ZYEAR   20
     C           ZYEAR     ADD  ZWRK2     ZYEAR            YEAR
     C**
     C**   DETERMINE MONTH NUMBER.
     C**
     C**   ADJUST DAY NO. IN CASE LAST DAY OF LEAP YEAR FEBRUARY.
     C                     SETOF                     9293
     C   91      ZDAYN1    COMP 59                     9293
     C   91N92   ZDAYN1    SUB  1         ZDAYN1
     C**
     C**   CALCULATE MONTH NUMBER.
     C                     Z-ADD2         ZWRK2
     C           ZDTAG2    TAG                             ** ZDTAG2 TAG *
     C           ZDAYN1    COMP ZMDY,ZWRK2             94
     C  N94      ZWRK2     ADD  1         ZWRK2
     C  N94                GOTO ZDTAG2
     C           ZWRK2     SUB  1         ZWRK2
     C**
     C                     Z-ADDZWRK2     ZMTH    20       MONTH
     C**
     C**   DETERMINE DAY OF MONTH.
     C**
     C**   ADD BACK LAST DAY OF YEAR ADJUSTMENT.
     C           ZDAYN1    ADD  1         ZDAYN1
     C**
     C**   CALCULATE DAY OF MONTH.
     C           ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY
     C**
     C**   ADD BACK LEAP YEAR 29TH FEBUARY ADJUSTMENT, IF REQUIRED.
     C   93      ZDAY      ADD  1         ZDAY
     C**
     C**   FORMAT DATE, DDMMYY OR MMDDYY.
     C  N98                MOVELZDAY      ZWRK4   40
     C   98                MOVE ZDAY      ZWRK4
     C  N98                MOVE ZMTH      ZWRK4
     C   98                MOVELZMTH      ZWRK4
     C                     MOVELZWRK4     ZDATE
     C                     MOVE ZYEAR     ZDATE
     C**
     C**   FORMAT ALPHA DATE, DDMMMYY.
     C           ZDAY      COMP 10                     95
     C                     MOVELZDAY      ZWRK5   5
     C   95                MOVEL' '       ZWRK5
     C                     MOVE ZMNM,ZMTH ZWRK5
     C                     MOVELZWRK5     ZADATE
     C                     MOVE ZYEAR     ZADATE
     C**
     C           ZDEND2    ENDSR                           * ZDEND2 ENDSR*
     C/EJECT
     C**
     C********************************************************************
     C**
     C**
     C*****ZSYSTM*SR.*TO*CHAIN*TO*THE*INSTALLATION*CONTROL*DATA*RECORD.*  S01117
     C**   SYSTEM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.   S01117
     C**
     C***********ZSYSTM    BEGSR                           *** ZSYSTEM ***S01117
     C           SYSTEM    BEGSR                           *** SYSTEM  ***S01117
     C*                                                                   S01117
     C***CALL*ZSFILE*TO*LOG*SPOOL*FILE*DETAILS                     S01117 143852
     C***********                                                  S01117 143852
     C***********          CALL 'ZSFILE'                           S01117 143852
     C***********          PARM           PSEQ    5                S01117 143852
     C***********          PARM *BLANKS   ZENTAU  3                S01117 143852
     C***********          PARM SFILE2    ZSFLAU 10                S01117 143852
     C***********          PARM SFNUM2    ZSNOAU  60               S01117 143852
     C***********          PARM *BLANKS   ZERR    1                S01117 143852
     C***********                                                  S01117 143852
     C***ABORT*PROGRAM*IF*ZERR*IS*NOT*BLANK                        S01117 143852
     C***********                                                  S01117 143852
     C***********ZERR      IFNE *BLANK                             S01117 143852
     C***********          SETON                     U7U8          S01117 143852
     C************LOCK     IN   DLDA                               S01117 143852
     C***********          MOVEL'FT0520'  DBPGM                    S01117 143852
     C***********          MOVEL'FT520AU' DBKEY            ********S01117 143852
     C***********          MOVEL'ZSFILE'  DBFILE           * DB ERRS01117 143852
     C***********          MOVEL'016'     DBASE            ********S01117 143852
     C***********          OUT  DLDA                               S01117 143852
     C***********          RETRN                                   S01117 143852
     C***********          END                                     S01117 143852
     C**
     C**   SET UP KEY FOR INSTALLATION CONTROL RECORD.
     C                     MOVEL'01      'ZTABKY 12
     C                     MOVE '  10'    ZTABKY
     C**
     C           ZTABKY    CHAINTABFP                99    ON NOT THERE
     C  N99      RECI      COMP 'D'                  9999  ON, IS DELETED
     C**
     C**   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.
     C           DATF      COMP 'M'                      98MMDDYY, 98 ON
     C**
     C                     ENDSR
     C*                                                                   143852
     C** Ensure total spooled file is recorded by RCF                     143852
     C*                                                                   143852
     C           SYSTM2    BEGSR                                          143852
     C*                                                                   143852
     C** Call ZSFILE to log spooled  file details                         143852
     C*                                                                   143852
     C                     CALL 'ZSFILE'                                  143852
     C                     PARM           PSEQ    5                       143852
     C                     PARM *BLANKS   ZENTAU  3                       143852
     C                     PARM SFILE2    ZSFLAU 10                       143852
     C                     PARM SFNUM2    ZSNOAU  60                      143852
     C                     PARM *BLANKS   ZERR    1                       143852
     C*                                                                   143852
     C** Abort program if ZERR is not blank                               143852
     C*                                                                   143852
     C           ZERR      IFNE *BLANK                                    143852
     C                     SETON                     U7U8                 143852
     C           *LOCK     IN   DLDA                                      143852
     C                     MOVEL'FT0520'  DBPGM                           143852
     C                     MOVEL'FT520AU' DBKEY            ***************143852
     C                     MOVEL'ZSFILE'  DBFILE           * DB ERROR 16 *143852
     C                     MOVEL'016'     DBASE            ***************143852
     C                     OUT  DLDA                                      143852
     C                     RETRN                                          143852
     C                     END                                            143852
     C                     ENDSR                                          143852
     C/EJECT                                                                                MD061867
      *****************************************************************                     MD061867
      ** CHECK PRINTER OVERFLOW FOR P2HD                                                    MD061867
      **                                                                                    MD061867
      *****************************************************************                     MD061867
     C           CHKOF2    BEGSR                                                            MD061867
     C                     Z-ADD11        RQDLN   20                                        MD061867
     C           OFLLN     SUB  PRTLN     REMLN   20                                        MD061867
     C           REMLN     IFLT RQDLN                                                       MD061867
     C                     MOVE '1'       *IN87                                             MD061867
     C                     ELSE                                                             MD061867
     C                     MOVE '0'       *IN87                                             MD061867
     C                     ENDIF                                                            MD061867
      *                                                                                     MD061867
     C           *IN87     IFEQ '1'                                                         MD061867
     C                     WRITEP2HD                                                        MD061867
     C                     MOVE '0'       *IN87                                             MD061867
     C                     ENDIF                                                            MD061867
     C                     ENDSR                                                            MD061867
     C**
      /EJECT                                                              CEU006
     C/COPY ZSRSRC,ZSEDITZ3                                               CEU006
      *                                                                   CEU006
     C/COPY ZSRSRC,ZEDITZ2                                                CFT009
      *                                                                   CFT009
     C/EJECT
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
**  DESC
Miscellaneous Charge 1                                                    CFT009
Miscellaneous Charge 2                                                    CFT009
Miscellaneous Charge 3                                                    CFT009
Miscellaneous Charge 4                                                    CFT009
Miscellaneous Charge 5                                                    CFT009
