     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas FT Cheque printing input cycle')                 *
      *****************************************************************
      *                                                               *
      *  Midas - FUNDS TRANSFER MODULE                                *
      *                                                               *
      *  FT0580 - INPUT CYCLE CHEQUE PRINTING.                        *
      *                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. CSD103             Date 10Aug20               *
      *  Prev Amend No. MD046248           Date 27Oct17               *
      *                 CFT120             Date 28Sep12               *
      *                 AR787620           Date 10Jun11               *
      *                 CRE075             Date 06Dec10               *
      *                 CER059             Date 19Jul10               *
      *                 CER047             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 CSW207             Date 08Jun07               *
      * Midas Plus 1.4 Base ------------------------------------------*
      *                 GBO018             Date 14Aug06               *
      *                 GBO007             Date 14Aug06               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CFT032             Date 11Sep06               *
      *                 CSD031             Date 10Apr06               *
      *                 CDL049             Date 07Jul06               *
      *                 BUG10907           Date 29May06
      *                 CSD027             Date 09Dec05               *
      *                 CFT118             Date 24Aug04               *
      *                 CSC022             Date 24Aug04               *
      *                 CLE025             Date 20Oct03               *
      *                 221761             Date 01Apr04               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4.01 -------------------------------------------*
      *                 CCG015             Date 25Jun01               *
      *                 195352             Date 31Oct01               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CFT009             Date 01JUN00               *
      * Midas DBA 3.04 -----------------------------------------------*
      *                 185107             Date 17Oct00               *
      *                 184060             Date 22Sep00               *
      * Midas DBA 3.03 -----------------------------------------------*
      *                 CFT006             Date 22Nov99               *
      * Midas DBA 3.02 -----------------------------------------------*
      *                 CFT004             DATE 26Aug99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 125745             DATE 04OCT98               *
      *                 CEU006             DATE 29May98               *
      *                 120189             DATE 05Feb98               *
      *                 S01408             DATE 23JUN95               *
      *                 S01522             DATE 18JAN95               *
      *       AMEND NO. S01435             DATE 08SEP93               *
      *       AMEND NO. S01414             DATE 29MAR93               *
      *       AMEND NO. E37520             DATE 24MAR92               *   E37520
      *       AMEND NO. E29917             DATE 02MAY91               *   E29917
      *       AMEND NO. S01117             DATE 17APR91               *   S01117
      *       AMEND NO. S01194             DATE 17APR91               *   S01194
      *       AMEND NO. E21457             DATE 12MAY90               *   E21457
      *       AMEND NO. E21142             DATE 19FEB90               *   E21142
      *       AMEND NO. S01199             DATE 17/08/89              *   S01199
      *                                                               *
      *****************************************************************
      *                                                               *
      *  CSD103 - LIBOR Deregulation - Common Layer/Standing Data     *
      *  MD046248 - Finastra Rebranding                               *
      *  CFT120 - FT IN/OP - Charges to DR of Account Currency        *
      *           (Recompile)                                         *
      *  AR787620 - Hooks Incorporation                               *
      *             WNCPYSRC,FTH00112                                 *
      *             WNCPYSRC,FTH00113                                 *
      *             WNCPYSRC,FTH00114                                 *
      *             WNCPYSRC,FTH00115                                 *
      *  CRE075 - Effective Date for Retail Accounts (Recompile)      *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER047 - German Features LF037-00 Reporting §24c KWG         *
      *           (Recompile)                                         *
      *  CSW207 - SWIFT 2007 Changes                                  *
      *  GBO018 - Demand Drafts Printing                              *
      *         - Added core hooks: FT0580F004, FT0580F005,           *
      *           FT0580C064, FT0580C065, FT0580C066, FT0580C067,     *
      *           FT0580C068, FT0580C069, FT0580C070.                 *
      *  GBO007 - Print the full beneficiary name as entered on the   *
      *           first two 35-character beneficiary account lines.   *
      *           FT0580 stationery not to be via Correspondence      *
      *           Manager.                                            *
      *         - Added core hooks: FT0580C063, FT0580X002.           *
      *  CFT032 - Account line in field 50X in MT103                  *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CDL049 - Addition of a Reference Rate field (recompile)      *
      *  BUG10907-Incorrect use of *IN50                              *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CFT118 - Core changes for GBO018.                            *
      *           Demand Drafts Printing - Upgrade to Midasplus       *
      *         - Added hook: FT0580C081/                             *
      *         - Added hook: FT0580C082/                             *
      *         - Added hook: FT0580C083/                             *
      *         - Added hook: FT0580C084/                             *
      *         - Added hook: FT0580C085                              *
      *         - Added hook: FT0580C086                              *
      *         - Added hook: FT0580C087                              *
      *         - Added hook: FT0580C088                              *
      *         - Added hook: FT0580C089                              *
      *         - Added hook: FT0580C090                              *
      *         - Added hook: FT0580C091                              *
      *         - Added hook: FT0580C092                              *
      *         - Added hook: FT0580C093                              *
      *         - Added hook: FT0580C094                              *
      *         - Added hook: FT0580C095                              *
      *         - Added hook: FT0580C096                              *
      *         - Added hook: FT0580C097                              *
      *         - Added hook: FT0580C098                              *
      *         - Added hook: FT0580C099                              *
      *         - Added hook: FT0580C100                              *
      *         - Added hook: FT0580C101 (NOT USED)                   *
      *         - Added hook: FT0580C102                              *
      *         - Added hook: FT0580C103                              *
      *         - Amended hook: FT0580C063                            *
      *  CSC022 - Commitment Control Changes for MidasPlus            *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  221761 - Recompiled due to change made in PF/FT101HPD.       *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CCG015 - Correspondence Manager Phase 1                      *
      *  195352 - Incoming payments enquiry array index error.        *
      *  CFT009 - FT Fees and Charge Development-Recompiled           *
      *  185107 - Mapping of details from swift message - Recompile   *
      *  184060 - No transaction type code in detail screen -Recompile*
      *  CFT006 - Funds Transfer addition of MT101 and MT102 messages *
      *  CFT004 - International Bank Account Number                   *
      *           New Account Type 'I' (IBAN)                         *
      *  125745 - First screen incorrectly output resulting in        *
      *           incorrect validation.                               *
      *  CEU006 - EMU Funds Transfer Enhancements (Recompile Only)    *
      *  120189 - Prompt immediate production of Cheques              *
      *  S01408 - Addition of core hooks FT0580EEPG.                  *
      *                                  FT0580IIPG.                  *
      *                                  FT0580IIP1.                  *
      *                                  FT0580CCPG.                  *
      *                                  FT0580CCP1.                  *
      *                                  FT0580CCP2.                  *
      *                                  FT0580CCP3.                  *
      *                                  FT0580CCP4.                  *
      *  S01522 - User Defined Correspondence.                        *
      *  S01435 - Incoming Message Management.                        *
      *  S01414 - Book Code and Profit Centre Incorporation.          *
      *           Rename of profit centre field on ACCNTABF           *
      *  E37520 - VALIDATION SHOULD NOT ALLOW BLANK CHEQUE NUMBER     *   E37520
      *  E29917 -  IF DRAFTS SELECTED FOR REPRINT HAVE SAME ADDRESS   *   E29917
      *            AS PREVIOUS PRINT,PROGRAM ATTEMPTS TO WRITE TO     *   E29917
      *            CLOSED PRINTER FILE.                               *   E29917
      *  S01117 -  RELEASE 10 MULTIBRANCHING CHANGES                  *   S01117
      *  S01194 -  STANDING DATA CHANGES                              *   S01194
      *  E21457  - VALIDATION SHOULD NOT ALLOW ZERO CHEQUE NUMBERS    *   E21457
      *  E21142  -  ON AS400, PROGRAM SHOULD USE QCMDEXC, NOT         *
      *             QCAEXEC.                                          *
      *  S01199  - HELP SYSTEM.                                       *   S01199
      *                                                               *
      *****************************************************************
      *
      *  FUNCTION OF INDICATORS
      *
      *  01   F3 EXIT PROGRAM
      *  11   HELP
      *  17   INVALID BRANCH CODE                                         S01117
      *  18   INVALID BRANCH TYPE                                         S01117
      *  19   NONAUTHORISATION INDICATOR                                  S01117
      *  20   INVALID LINE-UP FLAG
      *  21   INVALID PRINT CHEQUES FLAG
      *  22   INVALID CHEQUE TYPE
      *  23   INVALID CHEQUE NUMBER
      *  24   INVALID SUCCESSFUL CHEQUE PRINT FLAG
      *  25   CHEQUES HAVE BEEN PRINTED
      *  26   PRINT FILE P1 OPEN
      *  27   LINE-UP
      *  28   CQDUE HAS BEEN READ BEFORE
      *  29   ON TO LINE 2 OF AMOUNT IN WORDS
      *  30   CURRENCY HAS NO DECIMAL PLACES
      *  31   CURRENCY HAS 1 DECIMAL PLACE
      *  32   CURRENCY HAS 2 DECIMAL PLACES
      *  33   CURRENCY HAS 3 DECIMAL PLACES
      ***34***END*OF*FILE*CQDUE*                                          S01117
      ***34***END OF FILE CQDUEBB/CQDUEOB                           S01117CFT006
      *  34   END OF FILE CQDUEBB/CQDUEOB/FT101HJ0/FT101HJ1/FT102HJ0      CFT006
      *       FT102HJ1                                                    CFT006
      *  35   ON TO LINE 3 OF AMOUNT IN WORDS
      *  36   END OF FILE CQDUECB/CQDUECO                                 S01117
      *  37   USER DEFINED CORRESPONDENCE INSTALLED                       S01522
      *  50   MULTIBRANCHING INDICATOR                                    S01117
      *  51   ORIGINATING BRANCH USED INDICATOR                           S01117
      *  52   ORIGINATING BRANCH/USER VALI.                               S01117
      *  53   SCREEN BRANCH 'ALL' INDICATOR                               S01117
      *  54   SCREEN BRANCH B/O INDICATOR, ON IF 'O' ENTERD               S01117
      *  63   SCAN FOR '/'                                                CFT006
      *  68   END OF FILE FT101HJ0                                        CFT006
      *  69   END OF FILE FT102HJ0                                        CFT006
      *  70   END OF FILE FT101HJ1                                        CFT006
      *  71   END OF FILE FT102HJ1                                        CFT006
      *  72   CFT006/CFT008 ON                                            CFT006
      *  73   SUBROUTINE RFTCQ HAS BEEN EXECUTED                          CFT006
      *  74   SUBROUTINE CCTCQ HAS BEEN EXECUTED                          CFT006
      *  75   CHAIN FT101DL0                                              CFT006
      *  76   CHAIN FT102DL0                                              CFT006
      *  88   FATAL ERROR EXIT PROGRAM
      *  89   ERROR IN VALIDATION
      *  90-99  IN STANDARD SUROUTINES
      *
     F***FT0580DFCF**E****                WORKSTN                                             CFT118
     FFT0580DFCF  E                    WORKSTN                        UC                      CFT118
     FOTPAY   UF  E           K        DISK
     F                                              KCOMIT
     FCQPAC   UF  E           K        DISK
     F            CQPADDDF                          KIGNORE
     F                                              KCOMIT
     FCQREGZZ UF  E                    DISK
     F                                              KCOMIT
     FFT101DL0UF  E           K        DISK                               CFT006
     F                                              KCOMIT                CFT006
     FFT102DL0UF  E           K        DISK                               CFT006
     F                                              KCOMIT                CFT006
     FCQREGDD O   E           K        DISK
     F                                              KCOMIT
     F*CQDUE***IF**E***********K        DISK                              S01117
     FCQDUEBB IF  E           K        DISK                               S01117
     F            OTPAYDDF                          KRENAMEOUTPAYF
     F            CQPACDDF                          KRENAMECQPACF
     FCQDUEOB IF  E           K        DISK                               S01117
     F            OTPAYDDF                          KRENAMEOTTPAYF        S01117
     F            CQPACDDF                          KRENAMECQPACCF        S01117
     FCQDUECB IF  E           K        DISK                               S01117
     F            OTPAYDDF                          KRENAMEOCBPAYF        S01117
     F            CQPACDDF                          KRENAMECCBACF         S01117
     FCQDUECO IF  E           K        DISK                               S01117
     F            OTPAYDDF                          KRENAMEOCOPAYF        S01117
     F            CQPACDDF                          KRENAMECCOACCF        S01117
     FCLINT   IF  E           K        DISK
     F            CLINTCAF                          KIGNORE
     F/COPY WNCPYSRC,FT0580F004
     F            CLINTCBF                          KIGNORE
     F/COPY WNCPYSRC,FT0580F005
     F            CLINTC1F                          KIGNORE
     FACNUMA  IF  E           K        DISK
     F            ACCNTABF                          KRENAMEACNUMAF
     FTABFP   IF  E           K        DISK
     F            TABTB20F                          KIGNORE
     F            TABTG20F                          KIGNORE
     F************TABLETJF                          KIGNORE               S01117
     F            TABLETPF                          KIGNORE
     F            TABLET5F                          KIGNORE
     F            TABLETHF                          KIGNORE
     FFT101HJ0IF  E           K        DISK                               CFT006
     FFT101HJ1IF  E           K        DISK                               CFT006
     FFT102HJ0IF  E           K        DISK                               CFT006
     FFT102HJ1IF  E           K        DISK                               CFT006
     F/COPY WNCPYSRC,FT0580F002
     FFT0580P1O   E                    PRINTER                        UC
     F*FT0580P2O***E********************PRINTER                        UC S01194
     F/COPY WNCPYSRC,FT0580F001
     FFT0580AUO   E                    PRINTER                        UC  S01194
     F/COPY WNCPYSRC,FT0580F003
     E                    CPY@    1   1 80
     E*
     E*   TABLES
     E*
     E                    PRM         3 12               CL COMMAND
     E                    PRX         4 12               CL COMMAND
     E                    NN      1  10  5               NUMBER NAME
     E                    DG     10  10  1 0             DIGITS IN NUMB
     E                    MM     12  12  3               MONTHS
     E*                                                                   S01408
     E/COPY WNCPYSRC,FT0580EEPG                                           S01408
     E*                                                                   S01408
     E                    NM         13  1               SPLIT NUMBER
     E/COPY WNCPYSRC,FT0580E001
     E                    NM1        35  1               LINE 1 AMOUNT
     E                    NM2        35  1               LINE 2 AMOUNT
     E                    NM3        35  1               LINE 3 AMOUNT
     E                    NB          5  1               NUMBER NAME
     E                    ERCD       38  4               ERROR CODES
     E                    ZA1        16  1               ZALIGN SR. ARRAY
     E                    ZA2        16  1               ZALIGN SR. ARRAY
     E                    FLDQ       10  1               FOR TEST FOR ?   S01194
     E                    ZYDY    4   4  4 0             ZDATE1/2 SR.ARRAYCFT006
     E                    ZMDY   13  13  3 0             ZDATE1/2 SR.ARRAYCFT006
     E                    ZMNM   12  12  3               ZDATE2 SR. ARRAY CFT006
      **                                                                                      CSC022
      ** Array to hold commitment jobs name                                                   CSC022
      **                                                                                      CSC022
     E                    WCMT       10 10                                                    CSC022
      **                                                                                      CSC022
     I** RENAME OF TABLETL AND ACCNUMA BOOKING BRANCH FIELD TO AVOID      S01117
     I** CORRUPTION FROM OTPAYDD AND CQPACDD                              S01117
     I*                                                                   S01117
     ITABLETLF                                                            S01117
     I              BRCA                            BRCH                  S01117
     I*                                                                   S01117
     I*                                                                   S01414
     I* Rename of Profit Centre to avoid overwriting                      S01414
     I*                                                                   S01414
     IACNUMAF                                                             S01117
     I              BRCA                            BRCH                  S01117
     I              PRFC                            ACPRFC                S01414
     I*                                                                   S01117
     I* Rename of FT101DL0 to avoid overwriting                           CFT006
     I*                                                                   CFT006
     IFT101DD0                                                            CFT006
     I              RFTID                           DRFTID                CFT006
     I              TRNSID                          DTRNID                CFT006
     I              TOCUS1                          DOCUS1                CFT006
     I              TOCUS2                          DOCUS2                CFT006
     I              TOCUS3                          DOCUS3                CFT006
     I              TOCUS4                          DOCUS4                CFT006
     I              TOCUS5                          DOCUS5                CFT006
     I              TRNCCY                          DTRCCY                CFT006
     I              DCUSTP                          DDCSTP                CFT006
     I              TBNA35                          DTBNA                 CFT006
     I              TBNB35                          DTBNB                 CFT006
     I              TBNC35                          DTBNC                 CFT006
     I              TBND35                          DTBND                 CFT006
     I              TBNE35                          DTBNE                 CFT006
     I              PAYCCY                          DPYCCY                CFT006
     I              BENTTP                          DBENTP                CFT006
     I              TACA35                          DTACA                 CFT006
     I              TACB35                          DTACB                 CFT006
     I              TACC35                          DTACC                 CFT006
     I              TACD35                          DTACD                 CFT006
     I              TACE35                          DTACE                 CFT006
     I              AWITTP                          DAWITP                CFT006
     I              PAYAMT                          DPYAMT                CFT006
     I              TRNAMT                          DTRAMT                CFT006
     I              TRMA35                          DTRMA                 CFT006
     I              TRMB35                          DTRMB                 CFT006
     I              TRMC35                          DTRMC                 CFT006
     I              TRMD35                          DTRMD                 CFT006
     I              CQIN                            DCQIN                 CFT006
     I              CHQNUM                          DCHQNM                CFT006
     I              INSCA4                          DINSCA                CFT006
     I              INSCB4                          DINSCB                CFT006
     I              INSCC4                          DINSCC                CFT006
     I              INSCD4                          DINSCD                CFT006
     I              INSCE4                          DINSCE                CFT006
     I              INUSER                          DINUSR                CFT006
     I*                                                                   CFT006
     I* Rename of FT102DL0 to avoid overwriting                           CFT006
     I*                                                                   CFT006
     IFT102DD0                                                            CFT006
     I              CCTID                           CCCTID                CFT006
     I              TRNSID                          CTRNID                CFT006
     I              ORDCU1                          CORDC1                CFT006
     I              ORDCU2                          CORDC2                CFT006
     I              ORDCU3                          CORDC3                CFT006
     I              ORDCU4                          CORDC4                CFT006
     I              CCTCCY                          CCCTCY                CFT006
     I              CUSTTD                          CCSTTD                CFT006
     I              BENF1                           CBENF1                CFT006
     I              BENF2                           CBENF2                CFT006
     I              BENF3                           CBENF3                CFT006
     I              BENF4                           CBENF4                CFT006
     I              BENF5                           CBENF5                CFT006
     I              PAYCCY                          CPYCCY                CFT006
     I              BENTTD                          CBENTD                CFT006
     I              ACCI35                          CACI35                CFT006
     I              AWITP                           CAWITP                CFT006
     I              PAYAMT                          CPYAMT                CFT006
     I              REMI1                           CREMI1                CFT006
     I              REMI2                           CREMI2                CFT006
     I              REMI3                           CREMI3                CFT006
     I              REMI4                           CREMI4                CFT006
     I              CQIN                            CCQIN                 CFT006
     I              CHQNUM                          CCHQNM                CFT006
     I              INUSER                          CINUSR                CFT006
     I*                                                                   CFT006
     I*  Data Structure for AOIBANR4                                      CFT004
     I*                                                                   CFT004
     IP@ACCN    E DSACCNTAB                                               CFT004
     I              BRCA                            BRCI                  CFT004
     I              CNUM                            CNUMI                 CFT004
     I              PRFC                            PRFCI                 CFT004
     I              LCD                             LCDI                  CFT004
     I/COPY WNCPYSRC,FT0580I006
     I*
     I*     DATA AREA TO SET UP KEY FOR LF/CQDUECB/CQDUECO                S01117
     I*  DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
     ICPYR@#      DS
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
     I*
     I*     DATA AREA FOR PROGRAM STATUS DISK AREA
     I*
     IPSDS       SDS
     I                                      244 253 WID
     I                                      254 263 USRID                 S01117
     I*
     I*     DATA AREA DATA STRUCTURE FOR HANDLING DB ERRORS
     I*
     IDLDA        DS                            256
     I**************************************134 138 DBFILE                S01194
     I**************************************139 167 DBKEY                 S01194
     I**************************************168 175 DBPGM                 S01194
     I**************************************176 1770DBASE                 S01194
     I                                      134 141 DBFILE                S01194
     I                                      142 170 DBKEY                 S01194
     I                                      171 180 DBPGM                 S01194
     I                                      181 1830DBASE                 S01194
     I*
     I*     DATA AREA FOR REDEFINING ERCD TO SPLIT
     I*
     I            DS
     I                                        1 152 ERCD
     I                                        1  76 ERR1
     I                                       77 152 ERR2
     I*
     I*     DATA AREA FOR REDEFINING ORDERING CUST ADDRESS
     I*
     I            DS
     I                                        1 175 ORCA
     I                                        1  35 ORCA1
     I/COPY WNCPYSRC,FT0580I002
     I                                       36  70 ORCA2
     I                                       71 105 ORCA3
     I                                      106 140 ORCA4
     I                                      141 175 ORCA5
     I*
     I*     DATA AREA FOR REDEFINING BENIFICIARY CUST ADDRESS
     I*
     I            DS
     I                                        1 175 BNCA
     I                                        1  35 BNCA1
     I                                       36  70 BNCA2
     I                                       71 105 BNCA3
     I                                      106 140 BNCA4
     I                                      141 175 BNCA5
     I                                        1  35 BNCA1B
     I                                       36  70 BNCA2B
     I                                       71 105 BNCA3B
     I                                      106 140 BNCA4B
     I                                      141 175 BNCA5B
     I*
     I*     DATA AREA FOR REDEFINING RECEIVING BANK ADDRESS
     I*
     I            DS
     I                                        1 175 RCBA
     I                                        1  35 RCBA1
     I/COPY WNCPYSRC,FT0580I003
     I                                       36  70 RCBA2
     I                                       71 105 RCBA3
     I                                      106 140 RCBA4
     I                                      141 175 RCBA5
     I*
     I*     DATA AREA FOR REDEFINING INPUT ADDRESS
     I*
     I            DS
     I                                        1 175 INAD
     I**********                              1   60ICNM                                      CSD027
     I                                        1   6 ICNM                                      CSD027
     I                                        1  100INRT
     I                                        1  35 INAD1
     I                                       36  70 INAD2
     I                                       71 105 INAD3
     I                                      106 140 INAD4
     I                                      141 175 INAD5
     I*
     I*     DATA AREA FOR REDEFINING SENDERS CORRESP ADDRESS
     I*
     I            DS
     I                                        1 175 SNCA
     I                                        1  35 SNCA1
     I                                       36  70 SNCA2
     I                                       71 105 SNCA3
     I                                      106 140 SNCA4
     I                                      141 175 SNCA5
     I*
     I*     DATA AREA FOR REDEFINING SENDERS COR/BANK ADDRESS
     I*
     I            DS
     I                                        1 175 SNBKA
     I                                        1  35 SNBK1
     I                                       36  70 SNBK2
     I                                       71 105 SNBK3
     I                                      106 140 SNBK4
     I                                      141 175 SNBK5
     I*
     I*     DATA AREA FOR REDEFINING REMITTING BANK ADDRESS
     I*
     I            DS
     I                                        1 175 RBKA
     I                                        1  35 RBKA1
     I                                       36  70 RBKA2
     I                                       71 105 RBKA3
     I                                      106 140 RBKA4
     I                                      141 175 RBKA5
     I                                        1  35 RBKA1B
     I                                       36  70 RBKA2B
     I                                       71 105 RBKA3B
     I                                      106 140 RBKA4B
     I                                      141 175 RBKA5B
     I*
     I*     DATA AREA FOR REDEFINING PAYEE ADDRESS
     I*
     I            DS
     I                                        1 175 PAYEE
     I                                        1  35 PYE1
     I                                       36  70 PYE2
     I                                       71 105 PYE3
     I                                      106 140 PYE4
     I                                      141 175 PYE5
     I*
     I*     DATA AREA FOR REDEFINING DRAWER ADDRESS
     I*
     I            DS
     I                                        1 175 DRAWER
     I                                        1  35 DRW1
     I                                       36  70 DRW2
     I                                       71 105 DRW3
     I                                      106 140 DRW4
     I                                      141 175 DRW5
     I*
     I*     DATA AREA FOR REDEFINING OUTPUT ADDRESS
     I*
     I            DS
     I                                        1 175 ADDRS
     I                                        1  35 ADDR1
     I                                       36  70 ADDR2
     I                                       71 105 ADDR3
     I                                      106 140 ADDR4
     I                                      141 175 ADDR5
     I*
     I*     DATA AREA FOR REDEFINING CURRENCY/NOSTRO CODE
     I*
     I            DS
     I                                        1   5 CURR
     I                                        4   50CURRN
     I*
     I*     DATA AREA FOR AMOUNT IN WORDS LINES
     I*
     I            DS
     I                                        1 105 AMTN
     I                                        1  35 NM1
     I                                       36  70 NM2
     I                                       71 105 NM3
     I                                        1  35 NM1A
     I                                       36  70 NM2A
     I                                       71 105 NM3A
     I*
     I*     DATA AREA FOR AMOUNT WITH DIFF DECIMAL PLACES
     I*
     I            DS
     I                                    P   1   70CQAM
     I                                    P   1   71CQAM1
     I                                    P   1   72CQAM2
     I                                    P   1   73CQAM3
     I/COPY WNCPYSRC,FT0580I004
     I*
     I*     DATA AREA FOR IN DATE FOR DATE SR.
     I*
     I            DS
     I                                        1   6 INDAT
     I                                        1   20IDD
     I                                        3   40IMM
     I                                        5   60IYY
     I*
     I*     DATA AREA FOR OUT DATE FOR DATE SR.
     I*
     I            DS
     I                                        1   7 OTDAT
     I                                        1   20ODD
     I                                        3   5 OMM
     I                                        6   70OYY
     I*
     I*     DATA AREA TO REDEFINE PAYMENT REF FOR PRINT FILE.
     I*
     I            DS
     I                                        1  15 PREF
     I                                        1  15 PREFA
     I/COPY WNCPYSRC,FT0580I005
     I*
     I*     DATA AREA TO REDEFINE CLIENT FILE KEY FOR DBERR
     I*
     ICLTKEY      DS
     I**********                              1   60CNUM                                      CSD027
     I                                        1   6 CNUM                                      CSD027
     I                                        7   7 RCDT
     I*
     I*     DATA STRUCTURE FOR COMMITMENT BOUNDARY IDENTIFIERS
     I*
     I            DS
     I                                        1   50TRANS
     I                                        6   7 MODULE
     I                                        8  15 PROG
     I                                       16  18 WID1
     I                                       19  240TIM
     I                                       25  25 ACTION
     I                                       26  35 USRID1
     I                                       51  60 WID2
     I                                       61  61 LNID
     I                                       62  62 PNID
     I                                       63  63 CQTP
     I                                       64  72 CQNMB
     I                                        1  72 COMBOU
     I/COPY WNCPYSRC,FT0580I001
     I*                                                                   S01194
     IZMUSER      DS                             17                       S01194
     I*DATAARA DATA STRUCTURE ACCESSING SYSTEM LEVEL AUTHORITY INDICATOR  S01194
     I                                       17  17 @AUIN                 S01194
     I*                                                                   S01408
     I/COPY WNCPYSRC,FT0580IIPG                                           S01408
     I*                                                                   S01408
     I** Data area for redefining GL account (OLD)                        CFT006
     I*                                                                   CFT006
     I            DS                                                      CFT006
     I                                        1  18 OGLACT                CFT006
     I                                        1   6 OGLCNM                CFT006
     I                                        7   9 OGLCCY                CFT006
     I                                       10  13 OGLACD                CFT006
     I                                       14  15 OGLSEQ                CFT006
     I                                       16  18 OGLBRH                CFT006
     I*                                                                   CFT006
     I** Data area for redefining GL account (NEW)                        CFT006
     I*                                                                   CFT006
     I            DS                                                      CFT006
     I                                        1  18 NGLACT                CFT006
     I                                        1   3 NGLBRH                CFT006
     I                                        4   9 NGLCNM                CFT006
     I                                       10  12 NGLCCY                CFT006
     I                                       13  16 NGLACD                CFT006
     I                                       17  18 NGLSEQ                CFT006
     I*                                                                   S01194
     ISDBRCH    E DSSDBRCHPD                                              S01194
     I*EXTERNAL DATA STRUCTURE FOR BRANCH CODES                           S01194
     I*                                                                   S01194
     ISDGELR    E DSSDGELRPD                                              S01194
     I*EXTERNAL DATA STRUCTURE FOR GENERAL LEDGER DETAILS                 S01194
     I*                                                                   S01194
     IDSFDY     E DSDSFDY                                                 S01194
     I*1ST DS FOR ACCESS PROGRAM , SHORT DATA STRUCTURE                   S01194
     I*                                                                   S01408
     IDSSDY     E DSDSSDY                                                 CFT004
     I* DS FOR ACCESS PROGRAM , LONG DATA STRUCTURE                       CFT004
     I*                                                                   CFT004
     I/COPY WNCPYSRC,FT0580IIP1                                           S01408
     I*                                                                   S01408
     IMMODDS    E DSSDMMODPD                                              S01522
     I*                                                                   S01522
     I* Modules Data Structure *                                          S01522
     I*                                                                   S01522
     ISCSARD    E DSSCSARDPD                                              CFT006
      * External data structure for SAR file details                      CFT006
      *                                                                   CFT006
     I*                                                                   S01522
     I*     DATA STRUCTURE AS PARAMETER TO USER DEFINED CORRESPONDENCE    S01522
     I*                                                                   S01522
     ISCCMT       DS                            256                                           CSC022
     I                                        1   30WCMTNO                                    CSC022
     I                                        4 103 WCJOBS                                    CSC022
      ** Commitment Control dataarea                                                          CSC022
      **                                                                                      CSC022
     IDSPARM      DS                                                      S01522
      *                                                                   S01522
      ** Print Item Type                                                  S01522
     I                                        1  10 ##PTYP                S01522
      *                                                                   S01522
      ** Print Item Sub-Type                                              S01522
     I                                       11  20 ##PSTP                S01522
      *                                                                   S01522
      ** File containing document data                                    S01522
     I                                       21  27 ##FILE                S01522
      *                                                                   S01522
      ** Branch                                                           S01522
     I                                       28  30 ##BRCA                S01522
      *                                                                   S01522
      ** Payment type                                                     S01522
     I                                       31  32 ##PYTP                S01522
      *                                                                   S01522
      ** Payment Reference                                                S01522
     I                                       33  47 ##PREF                S01522
      *                                                                   S01522
      ** Commit (YES/NO )                                                 S01522
     I I            'YES'                    48  50 W0CMT                 S01522
      *                                                                   S01522
      ** Update files (YES/NO )                                           S01522
     I I            'YES'                    51  53 W0UPF                 S01522
      *                                                                   S01522
      ** Item suppressed                                                  S01522
     I I            'NO '                    54  56 ##ISUP                S01522
      *                                                                   S01522
      ** Cheque Number                                                    S01522
     I                                       57  650##CQNM                S01522
      *                                                                   S01522
      ** Number of cheques 'extracted'                                    S01522
     I                                       66  700##RECU                S01522
     IDSMTR       DS                                                      S01522
      *                                                                   S01522
      *  Define fields for message transalation                           S01522
      *                                                                   S01522
     I                                        1 132 #MSDTA                S01522
     I                                      133 264 #MSTX1                S01522
     I#MSTX2      DS                                                      S01522
     I                                        1 256 #MSTXA                S01522
     I                                      257 512 #MSTXB                S01522
      *                                                                   S01522
     I*-------------------------------------------------------------------S01522
     I* Named constants                                                   S01522
     I              'FT_CHEQUE '          C         #TEXT1                S01522
     I              'FT_DRAFT  '          C         #TEXT2                S01522
     I              'OUT_PAY   '          C         #TEXT3                S01522
     I              'CHQ_TO_PAY'          C         #TEXT4                S01522
     I              'RFT_PAY   '          C         #TEXT5                CFT006
     I              'CCT_PAY   '          C         #TEXT6                CFT006
     C                     MOVEACPY@      BIS@   80
     C/EJECT
     C************************************************************
     C* MAIN SECTION
     C* PERFORMS SUBROUTINES - HELP X2
     C*                        VALONE
     C*                        LINUP
     C*                        PRINT
     C*                        VALTWO
     C*                        UPDATE
     C*                        FINAL
     C*
     C/COPY WNCPYSRC,FT0580C081                                                               CFT118
     C           *ENTRY    PLIST                                          S01117
     C                     PARM           PARM1  10                       S01117
     C/COPY WNCPYSRC,FT0580C082                                                               CFT118
     C*                                                                   S01117
     C                     MOVE '0'       *IN
     C                     MOVE *BLANK    @DRAW
     C* PERFORM INITIAL SUBROUTINE
     C                     EXSR INITL
     C/COPY WNCPYSRC,FT0580C083                                                               CFT118
      *                                                                                       CFT118
      ** OPEN DISPLAY FILE                                                                    CFT118
     C                     OPEN FT0580DF                                                      CFT118
     C*                                                                   S01522
     C* IF USER DEFINED CORRESPONDENCE INSTALLED                          S01522
     C           *IN37     IFEQ *ON                                       S01522
     C                     EXFMTFT580DF3                                  S01522
     C           *IN01     IFEQ *ON                                       S01522
     C                     SETON                     LR                   S01522
     C                     RETRN                                          S01522
     C                     ENDIF                                          S01522
     C                     ENDIF                                          S01522
     C* SCREEN 1
     C                     MOVE '0'       *IN58
     C************         EXFMTFT580DF1                                  S01522
     C                     EXFMTFT580DF1                                  125745
     C/COPY WNCPYSRC,FT0580C084                                                               CFT118
     C* IF F3 IS PRESSED NO FUTHER PROCESSING IS DONE
     C           *IN01     DOWNE'1'                        B001
     C                     SETOF                     77                   S01117
     C** 11                EXSR HELP                       HELP PRESSED   S01199
     C**N11                DO                              B002           S01199
     C                     DO                              B002           S01199
     C                     EXSR VALONE                     VALIDATION
     C**N89****************DO                              B003           S01117
     C           *IN89     IFEQ '0'                                       S01117
     C           *IN77     ANDEQ'0'                                       S01117
     C           LNID      IFEQ 'Y'                        B004
     C                     EXSR LINUP                      LINE-UP
     C                     ELSE                            X004
     C           PNID      IFEQ 'Y'                        B005
     C                     EXSR PRINT                      PRINT
     C           *IN37     IFEQ *ON                                       S01522
     C                     EXSR MRGEXT                                    CCG015
     C                     CALL 'CG8720'                                  S01522
     C                     PARM 'CGD1772' #STSID  7                       S01522
     C                     PARM           MSGDTA132                       S01522
     C                     ENDIF                                          S01522
     C/COPY WNCPYSRC,FT0580C102                                                               CFT118
     C* SCREEN TWO UNTIL NO ERRORS AND HELP NOT PRESSED
     C           *IN89     DOUEQ'0'                        B006
     C**         *IN11     ANDEQ'0'                                       S01199
     C  N89                MOVE ' '       CQSC             CLEAR
     C                     EXFMTFT580DF2                   SCREEN 2
     C           *IN01     IFEQ '1'
     C   58 67             EXSR RNMBCK
     C   25                EXSR FINAL
     C                     SETON                     LR
     C                     RETRN
     C                     END
     C** 11                EXSR HELP                       HELP           S01199
     C**N11                EXSR VALTWO                     VALIDATION     S01199
     C                     EXSR VALTWO                     VALIDATION     S01199
     C* IF CHEQUE PRINTING SUCCESSFUL UPDATE FILES
     C**N11N89N58CQSC      CASEQ'Y'       UPDATE           B007           S01199
     C     N89N58CQSC      CASEQ'Y'       UPDATE           B007           S01199
     C                     END                             E007
     C**N11N89 58CQSC      CASEQ'Y'       @UPDAT           B007           S01199
     C     N89 58CQSC      CASEQ'Y'       @UPDAT           B007           S01199
     C                     END                             E007
     C                     END                             E006
     C/COPY WNCPYSRC,FT0580C103                                                               CFT118
     C                     END                             E005
     C                     END                             E004
     C                     END                             E003
     C                     END                             E002
     **
     C   58 67             DO
     C                     EXSR RNMBCK
     C   62                EXSR RMVOVR
     C                     END
     **
     C/COPY WNCPYSRC,FT0580C099                                                               CFT118
     **
     C* CLEAR FIELDS
     C**N89****************MOVE ' '       LNID                            S01117
     C**N89****************MOVE ' '       PNID                            S01117
     C**N89****************MOVE ' '       CQTP                            S01117
     C**N89****************MOVE *BLANK    CQNMB                           S01117
     C           *IN89     IFEQ '0'                        B002           S01117
     C           *IN77     ANDEQ'0'                                       S01117
     C                     MOVE '   '     SBRCA                           S01117
     C                     MOVE 'B'       STYPE                           S01117
     C                     MOVE ' '       LNID                            S01117
     C                     MOVE ' '       PNID                            S01117
     C                     MOVE ' '       CQTP                            S01117
     C                     MOVE *BLANK    CQNMB                           S01117
     C                     END                             E002           S01117
     C                     MOVE '0'       *IN58
     C                     MOVE '0'       *IN67
     C                     MOVE '1'       *IN60
     C           *IN77     IFEQ '1'                        B002           S01117
     C                     MOVEA*BLANK    ERCD                            S01117
     C                     SETOF                     171819               S01117
     C                     SETOF                     202122               S01117
     C                     SETOF                     2389                 S01117
     C                     END                             E002           S01117
     C                     EXFMTFT580DF1                   SCREEN 1
     C/COPY WNCPYSRC,FT0580C100                                                               CFT118
     C                     MOVE '0'       *IN60
     C                     END                             E001
     C* IF CHEQUES HAVE BEEN PRINTED SUCCESSFULLY PRINT RUN CONTROLS
     C   25                EXSR FINAL
     C                     SETON                     LR
     C*
     C************************************************************
     C* END OF MAIN SECTION
     C************************************************************
     C/EJECT
     C************************************************************
     C* KLISTS
     C*                                                                   S01117
     C* KLIST FOR CQDUECB/CQDUECO                                         S01117
     C*                                                                   S01117
     C           VALKEY    KLIST                                          S01117
     C                     KFLD           VALST   20                      S01117
     C                     KFLD           VALBR   3                       S01117
     C*                                                                   S01117
     C*
     C* KLIST FOR CQPACDD
     C*
     C           CKEY      KLIST
     C                     KFLD           PREF             PAYMENT REF
     C                     KFLD           CQSQ             CHEQUE SEQ
     C*
     C* KLIST FOR CLINT
     C*
     C           CLKEY     KLIST
     C                     KFLD           CNUM             CLIENT NUMB
     C                     KFLD           RCDT             RECORD TYPE
     C/COPY WNCPYSRC,FT0580C012
     C*
     C************************************************************
     C* END OF KLISTS
     C************************************************************
     C/EJECT
     C************************************************************
     C* INITL SR.
     C*
     C**READS*ICD*RECORDS*FOR*INTERNAL*CUSTOMER*NUMBER*ETC.*              S01117
     C* READS ICD RECORDS.                                                S01117
     C*
     C* PERFORMED FROM MAIN SECTION
     C*
     C           INITL     BEGSR
     C           *NAMVAR   DEFN LDA       DLDA
     C* SETUP FIELDS FOR COMBOU
     C                     MOVE 'FT'      MODULE
     C                     MOVE 'A'       ACTION
     C                     MOVELWID       WID1
     C                     MOVE WID       WID2
     C                     MOVE 'FT0580'  PROG
     C* READ TABTB10 RECORD FOR RUN DATE ETC
     C                     MOVE *BLANK    KEY
     C                     MOVEL'01'      KEY
     C                     MOVE '10'      KEY
     C           KEY       CHAINTABTB10F             88
     C  N88      RECI      COMP 'D'                  8888
     C   88                DO                              B001
     C           *LOCK     IN   *NAMVAR
     C                     MOVE 'FT0580  'DBPGM            ***************
     C*********************MOVE 'TABLE'   DBFILE           * DB ERROR 01 *S01194
     C                     MOVEL'TABTB10 'DBFILE           ***************S01194
     C                     Z-ADD1         DBASE            ***************
     C                     MOVE *BLANK    DBKEY
     C                     MOVELKEY       DBKEY
     C                     OUT  *NAMVAR
     C                     SETON                     U7U8LR
     C*********************OPEN FT0580P2                                  S01194
     C*********************WRITEFT580P2F                                  S01194
     C*********************CLOSEFT0580P2                                  S01194
     C                     OPEN FT0580AU                                  S01194
     C                     WRITEFT580AUF                                  S01194
     C                     CLOSEFT0580AU                                  S01194
     C                     DUMP
     C                     RETRN
     C                     END                             E001
     C** SETUP RUNDATE                                                    S01194
     C*                                                                   S01194
     C                     MOVE RUNA      SRUNA                           S01194
     C**READ*TABTB11*RECORD*FOR*DEFAULT*BRANCH*                           S01117
     C* READ TABTB11 RECORD FOR MULTIBRANCHING INDICATOR                  S01117
     C                     MOVE *BLANK    KEY
     C                     MOVEL'01'      KEY
     C                     MOVE '11'      KEY
     C           KEY       CHAINTABTB11F             88
     C  N88      RECI      COMP 'D'                  8888
     C   88                DO                              B001
     C           *LOCK     IN   *NAMVAR
     C                     MOVE 'FT0580  'DBPGM            ***************
     C*********************MOVE 'TABLE'   DBFILE           * DB ERROR 20 *S01194
     C                     MOVEL'TABTB11 'DBFILE           ***************S01194
     C                     Z-ADD20        DBASE            ***************
     C                     MOVE *BLANK    DBKEY
     C                     MOVELKEY       DBKEY
     C                     OUT  *NAMVAR
     C                     SETON                     U7U8LR
     C*********************OPEN FT0580P2                                  S01194
     C*********************WRITEFT580P2F                                  S01194
     C*********************CLOSEFT0580P2                                  S01194
     C                     OPEN FT0580AU                                  S01194
     C                     WRITEFT580AUF                                  S01194
     C                     CLOSEFT0580AU                                  S01194
     C                     DUMP
     C                     RETRN
     C                     END                             E001
     C*                                                                   S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C                     SETON                     50                   S01117
     C*                                                                   S01117
     C* ACCESS SDGELRPD FOR ORIGINATING BRANCH USED FLAG AND              S01194
     C* ORIGINATING BRANCH/USER VALI.INDICATORS.                          S01194
     C*                                                                   S01194
     C**********           CALL 'AOGELRR0'                                S01194              CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM '*DBERR ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C********** SDGELR    PARM SDGELR    DSFDY                           S01194              CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
     C*                                                                   S01194
     C           BKOBRU    IFEQ 'Y'                                       S01194
     C                     SETON                     51                   S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C           BKOBUV    IFEQ 'Y'                                       S01194
     C                     SETON                     52                   S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C                     END                                            S01117
     C*                                                                   S01117
     C* DEFAULT SCREEN BRANCH TYPE TO VALUE 'B'                           S01117
     C*                                                                   S01117
     C                     MOVE 'B'       STYPE                           S01117
     C*                                                                   S01117
     C**READ*TABLETR*FOR*INTERNAL*CUSTOMER*NUMBER*                        S01117
     C*********************MOVEL'10'      KEY                             S01117
     C*********************MOVE FTDB      KEY                             S01117
     C***********KEY*******CHAINTABLETRF             88                   S01117
     C**N88******RECI******COMP 'D'                  8888                 S01117
     C***88****************DO                              B001           S01117
     C************LOCK*****IN   *NAMVAR                                   S01117
     C*********************MOVE 'FT0580  'DBPGM            ***************S01117
     C*********************MOVE 'TABLE'   DBFILE           * DB ERROR 02 *S01117
     C*********************Z-ADD2         DBASE            ***************S01117
     C*********************MOVE *BLANK    DBKEY                           S01117
     C*********************MOVELKEY       DBKEY                           S01117
     C*********************OUT  *NAMVAR                                   S01117
     C*********************SETON                     U7U8LR               S01117
     C*********************OPEN FT0580P2                                  S01117
     C*********************WRITEFT580P2F                                  S01117
     C*********************CLOSEFT0580P2                                  S01117
     C*********************DUMP                                           S01117
     C*********************RETRN                                          S01117
     C*********************END                             E001           S01117
     C*********************                                               S01117
     C****OBTAIN*BRANCH*INTERNAL*CUSTOMER*NUMBER'S*NAME*&*ADDRESS*        S01117
     C*********************                                               S01117
     C*********************Z-ADDBICN      CNUM                            S01117
     C*********************MOVE 'B'       RCDT                            S01117
     C*********************                                               S01117
     C***********CLKEY*****CHAINCLINTCCF             88                   S01117
     C**N88******RECI******COMP 'D'                  8888                 S01117
     C************IN88*****IFEQ '1'                        B001           S01117
     C************LOCK*****IN   *NAMVAR                                   S01117
     C*********************MOVE 'FT0580  'DBPGM            ***************S01117
     C*********************MOVE 'CLINT'   DBFILE           * DB ERROR 19 *S01117
     C*********************Z-ADD19        DBASE            ***************S01117
     C*********************MOVE *BLANK    DBKEY                           S01117
     C*********************MOVELCLTKEY    DBKEY                           S01117
     C*********************OUT  *NAMVAR                                   S01117
     C*********************SETON                     U7U8LR               S01117
     C*********************OPEN FT0580P2                                  S01117
     C*********************WRITEFT580P2F                                  S01117
     C*********************CLOSEFT0580P2                                  S01117
     C*********************DUMP                                           S01117
     C*********************RETRN                                          S01117
     C*********************END                             E001           S01117
     C*********************                                               S01117
     C****STORE*NAME*AND*ADDRESS*                                         S01117
     C*********************                                               S01117
     C*********************MOVE CNA1      BICNA1                          S01117
     C*********************MOVE CNA2      BICNA2                          S01117
     C*********************MOVE CNA3      BICNA3                          S01117
     C*********************MOVE CNA4      BICNA4                          S01117
     C*
      *                                                                   S01522
      ** Check to see if User Defined Correspondance is installed.        S01522
     C                     CALL 'AOMMODR0'             9090               S01522
     C                     PARM *BLANKS   P@RTCD  7        B:Return code  S01522
     C                     PARM '*FIRST ' P@OPTN  7        I:Option       S01522
     C           MMODDS    PARM *BLANKS   DSFDY            O:Module Flg   S01522
      *                                                                   S01522
      *  If return with an error (LR seton in called program) then        S01522
      *  process for database error.                                      S01522
      *                                                                   S01522
     C           *IN90     IFEQ '1'                                       S01522
     C           P@RTCD    OREQ '*ERROR*'                                 S01522
     C           *LOCK     IN   *NAMVAR                                   S01522
     C                     MOVE 'FT0580  'DBPGM            ***************S01522
     C                     MOVEL'AOMMODR0'DBFILE           * DB ERROR 19  S01522
     C                     Z-ADD19        DBASE            ***************S01522
     C                     OUT  *NAMVAR                                   S01522
     C                     SETON                     U7U8LR               S01522
     C                     END                                            S01522
      *                                                                   S01522
     C           BGN1ST    IFEQ 'Y'                                       S01522
     C                     SETON                     37                   S01522
      *                                                                   S01522
      *  Retrieve initial 'UDC' screen text if installed.                 S01522
      *                                                                   S01522
     C                     CALL 'CGC1000'              9090               S01522
     C                     PARM 'CGD1770' #MSGID  7                       S01522
     C                     PARM 'CGUSRMSG'#MSGF  10                       S01522
     C                     PARM           #MSDTA                          S01522
     C                     PARM *BLANKS   #MSTX1                          S01522
     C                     PARM *BLANKS   #MSTX2                          S01522
      *                                                                   S01522
     C                     MOVEL#MSTX1    F3TEXT                          S01522
     C                     ENDIF                                          S01522
      *** Check if CFT004 is switched on                                  CFT004
      *                                                                   CFT004
     C                     CALL 'AOSARDR0'                                CFT004
     C                     PARM '       ' @RTCD   7                       CFT004
     C                     PARM '*VERIFY' @OPTN                           CFT004
     C                     PARM 'CFT004'  @SARD   6                       CFT004
      *                                                                   CFT004
     C           @RTCD     IFEQ *BLANK                                    CFT004
     C                     MOVE 'Y'       CFT004  1                       CFT004
     C                     ELSE                                           CFT004
     C                     MOVE 'N'       CFT004                          CFT004
     C                     ENDIF                                          CFT004
     C/COPY WNCPYSRC,FT0580C001
      *                                                                   CFT006
      ** Access SAR details file to determine if CFT006 is switched ON    CFT006
      *                                                                   CFT006
     C                     CALL 'AOSARDR0'                                CFT006
     C                     PARM *BLANKS   @RTCD   7                       CFT006
     C                     PARM '*VERIFY' @OPTN   7                       CFT006
     C                     PARM 'CFT006'  @SARD   6                       CFT006
     C           SCSARD    PARM SCSARD    DSFDY                           CFT006
      *                                                                   CFT006
      ** If CFT006 is switched ON                                         CFT006
      *                                                                   CFT006
     C           @RTCD     IFEQ *BLANKS                                   CFT006
     C                     MOVE 'Y'       CFT006  1                       CFT006
     C                     ELSE                                           CFT006
     C                     MOVE 'N'       CFT006                          CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      ** Access SAR details file to determine if CFT008 is switched ON    CFT006
      *                                                                   CFT006
     C                     CALL 'AOSARDR0'                                CFT006
     C                     PARM *BLANKS   @RTCD   7                       CFT006
     C                     PARM '*VERIFY' @OPTN   7                       CFT006
     C                     PARM 'CFT008'  @SARD   6                       CFT006
     C           SCSARD    PARM SCSARD    DSFDY                           CFT006
      *                                                                   CFT006
      ** If CFT008 is switched ON                                         CFT006
      *                                                                   CFT006
     C           @RTCD     IFEQ *BLANKS                                   CFT006
     C                     MOVE 'Y'       CFT008  1                       CFT006
     C                     ELSE                                           CFT006
     C                     MOVE 'N'       CFT008                          CFT006
     C                     ENDIF                                          CFT006
      *                                                                   S01522
     C           CFT006    IFEQ 'Y'                                       CFT006
     C           CFT008    OREQ 'Y'                                       CFT006
     C                     MOVE *ON       *IN72                           CFT006
     C                     ELSE                                           CFT006
     C                     MOVE *OFF      *IN72                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   S01522
      *                                                                   CCG015
      ** Access SAR details file to determine if CCG015 is switched ON    CCG015
      *                                                                   CCG015
     C                     CALL 'AOSARDR0'                                CCG015
     C                     PARM *BLANKS   @RTCD   7                       CCG015
     C                     PARM '*VERIFY' @OPTN   7                       CCG015
     C                     PARM 'CCG015'  @SARD   6                       CCG015
     C           SCSARD    PARM SCSARD    DSFDY                           CCG015
      *                                                                   CCG015
      ** If CCG015 is switched ON                                         CCG015
      *                                                                   CCG015
     C           @RTCD     IFEQ *BLANKS                                   CCG015
     C                     MOVE 'Y'       CCG015  1                       CCG015
     C                     ELSE                                           CCG015
     C                     MOVE 'N'       CCG015                          CCG015
     C                     ENDIF                                          CCG015
      **                                                                                      CSC022
      ** Initialize CSC022 and Skip Commit/Rollback flags                                     CSC022
      **                                                                                      CSC022
     C                     MOVE 'N'       CSC022  1                                           CSC022
     C                     MOVE 'N'       WCRSKP  1                                           CSC022
      **                                                                                      CSC022
      ** Access SAR details file to determine if CSC022 switchable feature                    CSC022
      ** is switched on                                                                       CSC022
      **                                                                                      CSC022
     C                     CALL 'AOSARDR0'                                                    CSC022
     C                     PARM *BLANKS   @RTCD                                               CSC022
     C                     PARM '*VERIFY' @OPTN                                               CSC022
     C                     PARM 'CSC022'  @SARD                                               CSC022
     C           SCSARD    PARM SCSARD    DSFDY                                               CSC022
      **                                                                                      CSC022
     C           @RTCD     IFEQ *BLANKS                                                       CSC022
     C                     MOVE 'Y'       CSC022                                              CSC022
      **                                                                                      CSC022
      ** Get Jobs currently running i batch mode using SCCMRJOB dataarea                      CSC022
      **                                                                                      CSC022
     C           *NAMVAR   DEFN SCCMTJOB  SCCMT                                               CSC022
     C                     IN   SCCMT                                                         CSC022
      **                                                                                      CSC022
     C           WCMTNO    IFGT 0                                                             CSC022
      ** Move committed jobs to arrary for checking                                           CSC022
     C                     MOVEAWCJOBS    WCMT                                                CSC022
      ** Verify if job running exists in array                                                CSC022
     C********** WID       LOKUPWCMT                     50                          CSC022 BUG10907
     C********** *IN50     IFEQ *ON                                                  CSC022 BUG10907
     C           WID       LOKUPWCMT                     49                                 BUG10907
     C           *IN49     IFEQ *ON                                                         BUG10907
     C                     MOVE 'Y'       WCRSKP                                              CSC022
     C                     ENDIF                                                              CSC022
     C                     ENDIF                                                              CSC022
      **                                                                                      CSC022
     C                     ELSE                                                               CSC022
      ** Execute *PSSR if CSC022 is not found or Database error                               CSC022
     C           @RTCD     IFNE '*NRF'                                                        CSC022
     C           *LOCK     IN   *NAMVAR                                                       CSC022
     C                     MOVEL'CSC022'  DBKEY                                               CSC022
     C                     MOVEL'FT0580'  DBPGM                                               CSC022
     C                     MOVEL'SCSARDPD'DBFILE                                              CSC022
     C                     Z-ADD2         DBASE                                               CSC022
     C                     OUT  *NAMVAR                                                       CSC022
     C                     SETON                     U7U8LR                                   CSC022
     C                     DUMP                                                               CSC022
     C                     RETRN                                                              CSC022
     C                     ENDIF                                                              CSC022
      **                                                                                      CSC022
     C                     ENDIF                                                              CSC022
      **                                                                                      CSC022
      *                                                                   CCG015
     C                     CALL 'SWIF2007'                                                    CSW207
     C                     PARM *BLANKS   @RTCD                                               CSW207
      *                                                                                       CSW207
     C           @RTCD     IFEQ 'CSW2007'                                                     CSW207
     C                     MOVEL'Y'       CSW207  1                                           CSW207
     C                     ELSE                                                               CSW207
     C                     MOVEL'N'       CSW207                                              CSW207
     C                     ENDIF                                                              CSW207
      *                                                                                       CSW207
     C/COPY WNCPYSRC,FT0580C063
     C                     ENDSR
     C*
     C************************************************************
     C* END OF INITIAL SUBROUTINE
     C************************************************************
     C/EJECT
     C************************************************************
     C* VALONE SR.
     C*
     C* VALIDATE SCREEN 1
     C*
     C* PERFORMED FROM MAIN SECTION
     C*
     C* PERFORMS SUBROUTINE - ZALIGN
     C*
     C           VALONE    BEGSR
     C* CLEAR ERROR CODES AND RESET ERROR CODE SUBSCRIPT Z
     C* SETOF ERROR INDICATORS 20-23 AND 89
     C                     MOVEA*BLANK    ERCD
     C                     SETOF                     171819               S01117
     C                     Z-ADD1         Z       30
     C                     MOVEA'0000'    *IN,20
     C                     SETOF                     89
     C*                                                                   S01117
     C* IF MULTIBRANCHING INDICATOR ACTIVE AND LINE-UP INDICATOR IS       S01117
     C*  NOT ENTERED                                                      S01117
     C           *IN50     IFEQ '1'                        B001           S01117
     C           LNID      ANDEQ*BLANKS                                   S01117
     C*                                                                   S01117
     C* BRANCH CODE OR QUESTION MARK '?' MUST BE ENTERED                  S01117
     C           SBRCA     IFEQ *BLANKS                    B002           S01117
     C                     SETON                     1789                 S01117
     C                     MOVEA' 001'    ERCD,Z                          S01117
     C                     ADD  1         Z                               S01117
     C                     END                             E002           S01117
     C* IF 'ALL' ENTERED: SCREEN BRANCH TYPE MUST BE 'B',                 S01117
     C* VALIDATE THAT USER HAS SYSTEM LEVEL AUTHORITY ON ZMUSER DTAARA    S01117
     C           SBRCA     IFEQ 'ALL'                      B002           S01117
     C           STYPE     IFNE 'B'                                       S01117
     C                     SETON                     1889                 S01117
     C                     MOVEA' 002'    ERCD,Z                          S01117
     C                     ADD  1         Z                               S01117
     C                     END                             E002           S01117
     C                     SETON                     53                   S01117
     C           *NAMVAR   DEFN           ZMUSER                          S01117
     C                     IN   ZMUSER                                    S01117
     C           @AUIN     IFNE 'Y'                        B003           S01117
     C                     SETON                     1989                 S01117
     C                     MOVEA' 003'    ERCD,Z                          S01117
     C                     ADD  1         Z                               S01117
     C                     END                             E003           S01117
     C                     END                             E002           S01117
     C* SCREEN BRANCH TYPE MUST BE 'B' OR 'O'                             S01117
     C           STYPE     IFNE 'B'                        B002           S01117
     C           STYPE     ANDNE'O'                                       S01117
     C                     SETON                     1889                 S01117
     C                     MOVEA' 005'    ERCD,Z                          S01117
     C                     ADD  1         Z                               S01117
     C                     END                             E002           S01117
     C** VALIDATE BRANCH ENTRY                                            S01117
     C           SBRCA     IFNE *BLANKS                    B002           S01117
     C           SBRCA     ANDNE'ALL'                                     S01117
     C                     MOVE *BLANKS   @RTCD                           S01117
     C*                                                                   S01117
     C** ? PROCESSING                                                     S01117
     C                     MOVEA*BLANKS   FLDQ                            S01117
     C                     MOVEASBRCA     FLDQ                            S01117
     C           '?'       LOKUPFLDQ                     77               S01117
     C**                                                                  S01117
     C**********           CALL 'AOBRCHR0'                                S01194              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM *BLANKS   @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM SBRCA     @BRCD   3                       S01194
     C********** SDBRCH    PARM SDBRCH    DSFDY                           S01194              CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C*                                                                   S01117
     C           @RTCD     IFEQ '*NOSEL '                  B003           S01117
     C                     MOVE *BLANKS   SBRCA                           S01117
     C                     ELSE                            X003           S01117
     C           @RTCD     IFEQ *BLANKS                    B004           S01117
     C                     MOVE A8BRCD    SBRCA                           S01117
     C*                                                                   S01117
     C* IF BRANCH TYPE = 'B' SELECTED, VALIDATE THAT USER IS AUTHORISED   S01117
     C* TO A BOOKING BRANCH                                               S01117
     C           STYPE     IFEQ 'B'                        B005           S01117
     C*                                                                   S01117
     C                     CALL 'ZVBBU'                                   S01117
     C                     PARM SBRCA     ZBRCDX  3                       S01117
     C                     PARM 0         ERR     10                      S01117
     C*                                                                   S01117
     C           ERR       IFEQ 1                          B006           S01117
     C                     SETON                     1989                 S01117
     C                     MOVEA' 307'    ERCD,Z                          S01117
     C                     ADD  1         Z                               S01117
     C                     END                             E006           S01117
     C*                                                                   S01117
     C           ERR       IFEQ 2                          B006           S01117
     C                     SETON                     1989                 S01117
     C                     MOVEA' 308'    ERCD,Z                          S01117
     C                     ADD  1         Z                               S01117
     C                     END                             E006           S01117
     C*                                                                   S01117
     C* IF BRANCH TYPE = 'O' SELECTED, VALIDATE THAT USER IS AUTHORISED   S01117
     C* TO A ORIGINATING BRANCH                                           S01117
     C                     ELSE                            X005           S01117
     C           STYPE     IFEQ 'O'                        B006           S01117
     C                     SETON                     54                   S01117
     C           BKOBUV    IFEQ 'Y'                        B007           S01117
     C*                                                                   S01117
     C                     CALL 'ZVOBU'                                   S01117
     C                     PARM SBRCA     ZOBRX   3                       S01117
     C                     PARM 0         ERR                             S01117
     C*                                                                   S01117
     C           ERR       IFEQ 1                          B008           S01117
     C                     SETON                     1989                 S01117
     C                     MOVEA' 305'    ERCD,Z                          S01117
     C                     ADD  1         Z                               S01117
     C                     END                             E008           S01117
     C*                                                                   S01117
     C           ERR       IFEQ 2                          B008           S01117
     C                     SETON                     1989                 S01117
     C                     MOVEA' 306'    ERCD,Z                          S01117
     C                     ADD  1         Z                               S01117
     C                     END                             E008           S01117
     C*                                                                   S01117
     C                     END                             E007           S01117
     C                     END                             E006           S01117
     C                     END                             E005           S01117
     C*                                                                   S01117
     C                     ELSE                            X004           S01117
     C                     SETON                     1789                 S01117
     C                     MOVEA' 004'    ERCD,Z                          S01117
     C                     ADD  1         Z                               S01117
     C                     END                             E004           S01117
     C                     END                             E003           S01117
     C*                                                                   S01117
     C                     END                             E002           S01117
     C*                                                                   S01117
     C                     END                             E001           S01117
     C*                                                                   S01117
     C* LINE-UP INDICATOR MUST BE 'Y' OR BLANK
     C           LNID      IFNE 'Y'                        B001
     C           LNID      ANDNE' '
     C                     SETON                     2089  NOT Y OR
     C*********************MOVEA' 309'    ERCD,Z           BLANK          S01117
     C                     MOVEA' 006'    ERCD,Z           BLANK          S01117
     C                     ADD  1         Z
     C                     END                             E001
     C* IF LINE-UP BLANK PRINT IND IS MANDATORY
     C           PNID      IFEQ ' '                        B001
     C           LNID      IFEQ ' '                        B002
     C                     SETON                     2189
     C*********************MOVEA' 310'    ERCD,Z                          S01117
     C                     MOVEA' 007'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     END                             E002
     C                     ELSE                            X001
     C* IF LINE-UP ENTERED PRINT IND NOT ALLOWED
     C           LNID      IFNE ' '                        B002
     C                     SETON                     2189
     C*********************MOVEA' 310'    ERCD,Z                          S01117
     C                     MOVEA' 007'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     END                             E002
     C* IF PRINT IND ENTERED MUST BE 'Y'
     C           PNID      IFNE 'Y'                        B002
     C                     SETON                     2189
     C*********************MOVEA' 311'    ERCD,Z                          S01117
     C                     MOVEA' 008'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     END                             E002
     C                     END                             E001
     C           PNID      IFEQ ' '                        B001
     C* IF PRINT IND BLANK CHEQUE TYPE NOT ALLOWED
     C           CQTP      IFNE ' '                        B002
     C                     SETON                     2289
     C*********************MOVEA' 312'    ERCD,Z                          S01117
     C                     MOVEA' 009'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     END                             E002
     C* IF PRINT IND BLANK CHEQUE NUMBER NOT ALLOWED
     C           CQNMB     IFNE *BLANK                     B002
     C                     SETON                     2389
     C*********************MOVEA' 314'    ERCD,Z                          S01117
     C                     MOVEA' 011'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     END                             E002
     C                     ELSE                            X001
     C* IF PRINT IND ENTERED CHEQUE TYPE MUST EQUAL 'A' OR 'O'
     C           CQTP      IFNE 'D'                        B002
     C           CQTP      ANDNE'O'
     C                     SETON                     2289
     C*********************MOVEA' 313'    ERCD,Z                          S01117
     C                     MOVEA' 010'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     END                             E002
      *                                                                   E21457
      **  CHEQUE NUMBER SHOULD NOT BE ZERO                                E21457
      *                                                                   E21457
     C           CQNMB     IFEQ *ZEROS                                    E21457
     C           CQNMB     OREQ *BLANK                                    E37520
     C                     SETON                     2389                 E21457
     C*********************MOVEA' 320'    ERCD,Z                    E21457S01117
     C                     MOVEA' 013'    ERCD,Z                          S01117
     C                     ADD  1         Z                               E21457
     C                     ELSE                                           E21457
      *                                                                   E21457
     C* IF PRINT IND ENTERED CHEQUE NUMBER MUST BE VALID NUMERIC
     C                     MOVE *BLANK    ZFIELD
     C                     MOVE CQNMB     ZFIELD
     C                     Z-ADD9         ZADIG
     C                     Z-ADD0         ZADEC
     C                     EXSR ZALIGN
     C           *IN99     IFEQ '1'                        B002
     C                     SETON                     2389
     C*********************MOVEA' 315'    ERCD,Z                          S01117
     C                     MOVEA' 012'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     ELSE                            X002
     C                     MOVE ZFIELD    CQNUM   90
     C                     END                             E002
     C                     END                                            E21457
     C                     END                             E001
     C*                                                                   S01117
     C* IF NO ERROR DURING VALIDATION AND LINE-UP INDICATOR IS NOT        S01117
     C* ENTERED , CHECK WHETHER RECORD EXIST FOR THIS SELECTION.          S01117
     C* IF NO RECORDS DISPLAY WARNING W01.                                S01117
     C*                                                                   S01117
     C           *IN89     IFEQ '0'                        B001           S01117
     C           LNID      ANDEQ*BLANKS                                   S01117
     C*                                                                   S01117
     C*  SET KEY TO READ FROM THE FILE DEPENDENT                          S01117
     C*  ON MBIN INDICATOR AND SCREEN SELECTION                           S01117
     C*                                                                   S01117
     C           *IN50     IFEQ '1'                        B002           S01117
     C           SBRCA     ANDNE'ALL'                                     S01117
     C                     MOVELSBRCA     VALBR                           S01117
     C                     END                             E002           S01117
     C           CQTP      IFEQ 'D'                        B002           S01117
     C                     MOVE '13'      VALST                           S01117
     C                     ELSE                            X002           S01117
     C           CQTP      IFEQ 'O'                        B003           S01117
     C                     MOVE '12'      VALST                           S01117
     C                     END                             E003           S01117
     C                     END                             E002           S01117
     C*                                                                   S01117
     C* SELECT FILE TO BE READ DEPENDENT ON MBIN INDICATOR, SCREEN        S01117
     C* BRANCH(SBRCA) AND BRANCH TYPE(STYPE)                              S01117
     C* IF NO RECORDS FOR THE SELECTION DISPLAY MESSAGE ON THE SCREEN     S01117
     C*                                                                   S01117
     C                     SETOF                     36                   S01117
     C*                                                                   S01117
     C* IF SELECTION BY BOOKING BRANCH AND SINGLE BRANCH ENTERED          S01117
     C*                                                                   S01117
     C           *IN50     IFEQ '1'                        B002           S01117
     C           SBRCA     ANDNE'ALL'                                     S01117
     C           STYPE     IFEQ 'B'                        B003           S01117
     C           VALKEY    SETLLCQDUECB                                   S01117
     C           VALKEY    READECQDUECB                  36               S01117
      *                                                                   CFT006
     C           VALBR     SETLLFT101HJ0                                  CFT006
     C                     READ FT101HJ0                 68               CFT006
      *                                                                   CFT006
     C           *IN68     IFEQ *OFF                                      CFT006
     C           VALBR     IFNE BRCA                                      CFT006
     C                     MOVE *ON       *IN68                           CFT006
     C                     ENDIF                                          CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C           VALBR     SETLLFT102HJ0                                  CFT006
     C                     READ FT102HJ0                 69               CFT006
      *                                                                   CFT006
     C           *IN69     IFEQ *OFF                                      CFT006
     C           VALBR     IFNE BRCA                                      CFT006
     C                     MOVE *ON       *IN69                           CFT006
     C                     ENDIF                                          CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C           *IN36     IFEQ '1'                        B004           S01117
     C           *IN68     ANDEQ*ON                                       CFT006
     C           *IN69     ANDEQ*ON                                       CFT006
     C* IF NOT FIRST TIME THROUGH WITH THIS SELECTION, ALLOW ENTRY        S01117
     C           SBRCA     IFEQ SBRCH                      B005           S01117
     C           STYPE     ANDEQBRTYPE                                    S01117
     C           CQTP      ANDEQCQTYPE                                    S01117
     C                     SETOF                     181922               S01117
     C                     SETOF                     89                   S01117
     C                     ELSE                            X005           S01117
     C                     MOVE SBRCA     SBRCH   3                       S01117
     C                     MOVE STYPE     BRTYPE  1                       S01117
     C                     MOVE CQTP      CQTYPE  1                       S01117
     C                     SETON                     181922               S01117
     C                     SETON                     89                   S01117
     C                     MOVEA' W01'    ERCD,Z                          S01117
     C                     ADD  1         Z                               S01117
     C                     END                             E005           S01117
     C                     END                             E004           S01117
     C                     ELSE                            X003           S01117
     C*                                                                   S01117
     C* IF SELECTION BY ORIGINATING BRANCH AND SINGLE BRANCH ENTERED      S01117
     C*                                                                   S01117
     C           VALKEY    SETLLCQDUECO                                   S01117
     C           VALKEY    READECQDUECO                  36               S01117
      *                                                                   CFT006
     C           VALBR     SETLLFT101HJ1                                  CFT006
     C                     READ FT101HJ1                 70               CFT006
      *                                                                   CFT006
     C           *IN70     IFEQ *OFF                                      CFT006
     C           VALBR     IFNE ORBR                                      CFT006
     C                     MOVE *ON       *IN70                           CFT006
     C                     ENDIF                                          CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C           VALBR     SETLLFT102HJ1                                  CFT006
     C                     READ FT102HJ1                 71               CFT006
      *                                                                   CFT006
     C           *IN71     IFEQ *OFF                                      CFT006
     C           VALBR     IFNE ORBR                                      CFT006
     C                     MOVE *ON       *IN71                           CFT006
     C                     ENDIF                                          CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C           *IN36     IFEQ '1'                        B004           S01117
     C           *IN70     ANDEQ*ON                                       CFT006
     C           *IN71     ANDEQ*ON                                       CFT006
     C* IF NOT FIRST TIME THROUGH WITH THIS SELECTION, ALLOW ENTRY        S01117
     C           SBRCA     IFEQ SBRCH                      B005           S01117
     C           STYPE     ANDEQBRTYPE                                    S01117
     C           CQTP      ANDEQCQTYPE                                    S01117
     C                     SETOF                     181922               S01117
     C                     SETOF                     89                   S01117
     C                     ELSE                            X005           S01117
     C                     MOVE SBRCA     SBRCH                           S01117
     C                     MOVE STYPE     BRTYPE                          S01117
     C                     MOVE CQTP      CQTYPE                          S01117
     C                     SETON                     181922               S01117
     C                     SETON                     89                   S01117
     C                     MOVEA' W01'    ERCD,Z                          S01117
     C                     ADD  1         Z                               S01117
     C                     END                             E005           S01117
     C                     END                             E004           S01117
     C                     END                             E003           S01117
     C                     ELSE                            X002           S01117
     C*                                                                   S01117
     C* IF SELECTION 'ALL' OR MBIN = N                                    S01117
     C*                                                                   S01117
     C           *IN50     IFEQ '0'                        B003           S01117
     C           SBRCA     OREQ 'ALL'                                     S01117
     C           VALST     SETLLCQDUECB                                   S01117
     C           VALST     READECQDUECB                  36               S01117
      *                                                                   CFT006
     C           *LOVAL    SETLLFT101HJ0                                  CFT006
     C                     READ FT101HJ0                 68               CFT006
      *                                                                   CFT006
     C           *LOVAL    SETLLFT102HJ0                                  CFT006
     C                     READ FT102HJ0                 69               CFT006
      *                                                                   CFT006
     C           *IN36     IFEQ '1'                        B004           S01117
     C           *IN68     ANDEQ*ON                                       CFT006
     C           *IN69     ANDEQ*ON                                       CFT006
     C* IF NOT FIRST TIME THROUGH WITH THIS SELECTION, ALLOW ENTRY        S01117
     C           SBRCA     IFEQ SBRCH                      B005           S01117
     C           CQTP      ANDEQCQTYPE                                    S01117
     C                     SETOF                     192289               S01117
     C                     ELSE                            X005           S01117
     C                     MOVE SBRCA     SBRCH                           S01117
     C                     MOVE CQTP      CQTYPE                          S01117
     C                     MOVEA' W01'    ERCD,Z                          S01117
     C                     ADD  1         Z                               S01117
     C                     SETON                     192289               S01117
     C                     END                             E005           S01117
     C                     END                             E004           S01117
     C                     END                             E003           S01117
     C                     END                             E002           S01117
     C*                                                                   S01117
     C                     END                             E001           S01117
     C*                                                                   S01117
     C                     ENDSR
     C*
     C************************************************************
     C* END OF SCREEN 1 VALIDATION
     C************************************************************
     C/EJECT
     C************************************************************
     C* LINUP SR.
     C*
     C* CHEQUE PRE-PRINTED LINEUP
     C* OPENS PRINT FILE BEFORE AND CLOSES AFTER
     C*
     C* PERFORMED FROM MAIN SECTION
     C*
     C           LINUP     BEGSR
     C  N26                DO                              B001
     C/COPY WNCPYSRC,FT0580C013
     C                     OPEN FT0580P1
     C/COPY WNCPYSRC,FT0580C005
     C                     SETON                     26
     C                     END                             E001
     C* MOVE STARS TO ALL FIELDS
     C                     SETON                     27
     **
     C           *LIKE     DEFN ORCA      XORCA
     C           *LIKE     DEFN BNCA      XBNCA
     C           *LIKE     DEFN RCBA      XRCBA
     C           *LIKE     DEFN PDTE      XPDTE
     C           *LIKE     DEFN PREF      XPREF
     C           *LIKE     DEFN CCY       XCCY
     C           *LIKE     DEFN CCNM      XCCNM
     C           *LIKE     DEFN AMTN      XAMTN
     C           *LIKE     DEFN OTDAT     XOTDAT
     C           *LIKE     DEFN DTP1      XDTP1
     C           *LIKE     DEFN DTP2      XDTP2
     C           *LIKE     DEFN DTP3      XDTP3
     C           *LIKE     DEFN DTP4      XDTP4
     C/COPY WNCPYSRC,FT0580C006
     **
     **  SAVE THE CONTENTS OF THE FEILDS BEFORE MOVING '*'
     C                     MOVE ORCA      XORCA
     C                     MOVE BNCA      XBNCA
     C                     MOVE RCBA      XRCBA
     C                     MOVE PDTE      XPDTE
     C                     MOVE PREF      XPREF
     C                     MOVE CCY       XCCY
     C                     MOVE CCNM      XCCNM
     C                     MOVE AMTN      XAMTN
     C                     MOVE OTDAT     XOTDAT
     C                     MOVE DTP1      XDTP1
     C                     MOVE DTP2      XDTP2
     C                     MOVE DTP3      XDTP3
     C                     MOVE DTP4      XDTP4
     C/COPY WNCPYSRC,FT0580C007
     **  MOVE '*' TO THE FEILDS FOR ALIGNMENT
     C                     MOVE *ALL'*'   ORCA
     C                     MOVE *ALL'*'   BNCA
     C                     MOVE *ALL'*'   RCBA
     C                     MOVE *ALL'*'   PDTE
     C                     MOVE *ALL'*'   PREF
     C                     MOVE *ALL'*'   CCY
     C                     MOVE *ALL'*'   CCNM
     C                     MOVE *ALL'*'   AMTN
     C                     MOVE *ALL'*'   OTDAT
     C                     MOVE *ALL'*'   DTP1
     C                     MOVE *ALL'*'   DTP2
     C                     MOVE *ALL'*'   DTP3
     C                     MOVE *ALL'*'   DTP4
     C                     MOVEA'0000'    *IN,30
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0580CCPG                                           S01408
     C*                                                                   S01408
     C                     WRITEFT580PF1               88
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0580CCP1                                           S01408
     C*                                                                   S01408
     C* IF WRITE FAILS
     C   88                DO                              B001
     C           *LOCK     IN   *NAMVAR
     C                     MOVE 'FT0580  'DBPGM            ***************
     C*********************MOVE 'PRINT'   DBFILE           * DB ERROR 03 *S01194
     C                     MOVEL'PRINT'   DBFILE           ***************S01194
     C                     Z-ADD3         DBASE            ***************
     C                     MOVE *BLANK    DBKEY
     C                     MOVEL'1'       DBKEY
     C                     OUT  *NAMVAR
     C                     SETON                     U7U8LR
     C*********************OPEN FT0580P2                                  S01194
     C*********************WRITEFT580P2F                                  S01194
     C*********************CLOSEFT0580P2                                  S01194
     C                     OPEN FT0580AU                                  S01194
     C                     WRITEFT580AUF                                  S01194
     C                     CLOSEFT0580AU                                  S01194
     C                     DUMP
     C                     RETRN
     C                     END                             E001
     C                     SETOF                     27
     ** RESTORE THE SAVED CONTENTS
     C                     MOVE XORCA     ORCA
     C                     MOVE XBNCA     BNCA
     C                     MOVE XRCBA     RCBA
     C                     MOVE XPDTE     PDTE
     C                     MOVE XPREF     PREF
     C                     MOVE XCCY      CCY
     C                     MOVE XCCNM     CCNM
     C                     MOVE XAMTN     AMTN
     C                     MOVE XOTDAT    OTDAT
     C                     MOVE XDTP1     DTP1
     C                     MOVE XDTP2     DTP2
     C                     MOVE XDTP3     DTP3
     C                     MOVE XDTP4     DTP4
     C/COPY WNCPYSRC,FT0580C008
     **
     C   26                DO                              B001
     C/COPY WNCPYSRC,FT0580C014
     C                     CLOSEFT0580P1
     C/COPY WNCPYSRC,FT0580C009
     C                     SETOF                     26
     C                     END                             E001
     C                     ENDSR
     C*
     C************************************************************
     C* END OF LINEUP SUBROUTINE
     C************************************************************
     C/EJECT
     C************************************************************
     C* PRINT SR.
     C*
     C* PRINT CHEQUES
     C*
     C* PERFORMED FROM MAIN SECTION
     C*
     C* PERFORMS SUBROUTINES - PYCQ
     C*                        OTCQ
     C*                        RFTCQ                                      CFT006
     C*                        CCTCQ                                      CFT006
     C*
     C           PRINT     BEGSR
     C* SET FILE SO READ FROM START OR START OF A DRAWEE
     C           FRKEY     KLIST
     C                     KFLD           FRBRCH  3                       S01117
     C                     KFLD           FRPYTP
     C                     KFLD           FRPREF
     **
     C* STORE END KEY FOR A DRAWEE
     C           TOKEY     KLIST
     C                     KFLD           TOBRCH  3                       S01117
     C                     KFLD           TOPYTP
     C                     KFLD           TOPREF
     **
     C           *LIKE     DEFN PYTP      FRPYTP
     C           *LIKE     DEFN PREF      FRPREF
     C           *LIKE     DEFN PYTP      TOPYTP
     C           *LIKE     DEFN PREF      TOPREF
     ****FIRST*TIME*SET*FROM*KEY*TO**LOVAL*TO*READ*FROM*START*            S01117
     ****FIRST*TIME*SET*TO***KEY*TO**HIVAL*TO*READ*UPTO*EOF.*             S01117
     C*  SET FROM KEY AND TO KEY LISTS TO READ FROM/UPTO DEPENDENT        S01117
     C*  ON MBIN INDICATOR AND SCREEN BRANCH SELECTION                    S01117
     C           *IN50     IFEQ '1'                        B001           S01117
     C           SBRCA     ANDNE'ALL'                                     S01117
     C                     MOVE SBRCA     FRBRCH                          S01117
     C                     ELSE                            X001           S01117
     C           *IN50     IFEQ '0'                        B002           S01117
     C           SBRCA     OREQ 'ALL'                                     S01117
     C                     MOVE *LOVAL    FRBRCH                          S01117
     C                     END                             E002           S01117
     C                     END                             E001           S01117
     C                     MOVE *LOVAL    FRPYTP
     C                     MOVE *LOVAL    FRPREF
     C/COPY WNCPYSRC,FT0580C070
     C           *IN50     IFEQ '1'                        B001           S01117
     C           SBRCA     ANDNE'ALL'                                     S01117
     C                     MOVE SBRCA     TOBRCH                          S01117
     C                     ELSE                            X001           S01117
     C           *IN50     IFEQ '0'                        B002           S01117
     C           SBRCA     OREQ 'ALL'                                     S01117
     C                     MOVE *HIVAL    TOBRCH                          S01117
     C                     END                             E002           S01117
     C                     END                             E001           S01117
     C                     MOVE *HIVAL    TOPYTP
     C                     MOVE *HIVAL    TOPREF
     **
     **
     C***********FRKEY*****SETLLCQDUE                                     S01117
     C                     SETOF                     34
     C*********************READ CQDUE                    34               S01117
     C*                                                                   S01117
     C* SELECT FILE TO BE READ DEPENDENT ON MBIN INDICATOR, SCREEN        S01117
     C* BRANCH AND BRANCH TYPE                                            S01117
     C*                                                                   S01117
     C/COPY WNCPYSRC,FT0580C085                                                               CFT118
     C           *IN50     IFEQ '1'                        B001           S01117
     C           SBRCA     ANDNE'ALL'                                     S01117
     C           STYPE     IFEQ 'B'                        B002           S01117
     C           FRKEY     SETLLCQDUEBB                                   S01117
     C/COPY WNCPYSRC,FT0580C086                                                               CFT118
     C                     READ CQDUEBB                  34               S01117
     C/COPY WNCPYSRC,FT0580C087                                                               CFT118
     C           SBRCA     IFNE BRCA                       B003           S01117
     C                     SETON                     34                   S01117
     C                     END                             E003           S01117
     C                     ELSE                            X002           S01117
     C           FRKEY     SETLLCQDUEOB                                   S01117
     C                     READ CQDUEOB                  34               S01117
     C           SBRCA     IFNE ORBR                       B003           S01117
     C                     SETON                     34                   S01117
     C                     END                             E003           S01117
     C                     END                             E002           S01117
     C                     ELSE                            X001           S01117
     C           *IN50     IFEQ '0'                        B002           S01117
     C           SBRCA     OREQ 'ALL'                                     S01117
     C           FRKEY     SETLLCQDUEBB                                   S01117
     C                     READ CQDUEBB                  34               S01117
     C                     MOVE BRCA      FRBRCH                          S01117
     C                     END                             E002           S01117
     C                     END                             E001           S01117
     C                     MOVE PYTP      FRPYTP
     C                     MOVE PREF      FRPREF
     C* DO UNTIL END OF FILE
     C           *IN34     DOWNE'1'                        B001
     C           STMT      IFEQ 12                         B002
     C           CQTP      ANDEQ'O'
     C/COPY WNCPYSRC,FT0580C015
     C* IF PAYMENT TYPE IS 'CP' MUST BE A CQPACDD RECORD
     C           PYTP      IFEQ 'CP'                       B003
     C                     EXSR PYCQ
     C                     ELSE                            X003
     C                     EXSR OTCQ
     C                     END                             E003
     C                     ELSE                            X002
     C           STMT      IFEQ 13                         B003
     C           CQTP      ANDEQ'D'
     C/COPY WNCPYSRC,FT0580C016
     C           PYTP      IFEQ 'CP'                       B004
     C                     EXSR PYCQ
     C                     ELSE                            X004
     C                     EXSR OTCQ
     C                     END                             E004
     C                     END                             E003
     C                     END                             E002
     C           SBRCA     IFNE SBRCA1                                    S01117
     C           STYPE     ORNE STYPE1                                    S01117
     C                     SETOF                     28                   S01117
     C                     END                                            S01117
     C* IF FIRST PASS OF FILE ACCUMULATE TOTALS
     C  N28                DO                              B002
     C                     MOVE VAL       VALUE  133
     C                     Z-ADDCQINVI    ZZTOTI
     C                     Z-ADDCQINVD    ZZTOTD
     C                     Z-ADDVALUE     ZZAMT
     C                     EXSR GLZADD
     C                     Z-ADDZZTOTI    CQINVI
     C                     Z-ADDZZTOTD    CQINVD
     C           *IN54     IFEQ '0'                        B003           S01117
     C                     ADD  1         CQINN
     C                     ELSE                            X003           S01117
     C           *IN54     IFEQ '1'                        B004           S01117
     C                     ADD  1         CQINNO                          S01117
     C                     END                             E004           S01117
     C                     END                             E003           S01117
     C                     END                             E002
     C                     MOVE SBRCA     SBRCA1  3                       S01117
     C                     MOVE STYPE     STYPE1  1                       S01117
     C*********************READ CQDUE                    34               S01117
     C*                                                                   S01117
     C* IF MBIN = Y AND SELECTION NOT 'ALL', IF BRANCH HAS CHANGED        S01117
     C* SETON *IN34 TO STOP ACCESSING FURTHER RECORDS FROM THE FILE       S01117
     C*                                                                   S01117
     C           STYPE     IFEQ 'B'                        B002           S01117
     C                     READ CQDUEBB                  34               S01117
     C           *IN50     IFEQ '1'                        B003           S01117
     C           SBRCA     ANDNE'ALL'                                     S01117
     C           SBRCA     ANDNEBRCA                                      S01117
     C                     SETON                     34                   S01117
     C                     END                             E003           S01117
     C/COPY WNCPYSRC,FT0580C088                                                               CFT118
     C                     ELSE                            X002           S01117
     C                     READ CQDUEOB                  34               S01117
     C           *IN51     IFEQ '1'                        B003           S01117
     C           SBRCA     ANDNE'ALL'                                     S01117
     C           SBRCA     ANDNEORBR                                      S01117
     C                     SETON                     34                   S01117
     C                     END                             E003           S01117
     C                     END                             E002           S01117
     C                     END                             E001
      *                                                                   CFT006
     C           CFT006    IFEQ 'Y'                                       CFT006
      *                                                                   CFT006
     C*  SET FROM KEY AND TO KEY LISTS TO READ FROM/UPTO DEPENDENT        CFT006
     C*  ON MBIN INDICATOR AND SCREEN BRANCH SELECTION                    CFT006
      *                                                                   CFT006
     C                     MOVE *BLANKS   SBRCA1                          CFT006
     C                     MOVE *BLANKS   STYPE1                          CFT006
      *                                                                   CFT006
     C           *IN50     IFEQ *ON                                       CFT006
     C           SBRCA     ANDNE'ALL'                                     CFT006
     C                     MOVE SBRCA     FRBRCH                          CFT006
     C                     MOVE SBRCA     TOBRCH                          CFT006
     C                     ELSE                                           CFT006
      *                                                                   CFT006
     C           *IN50     IFEQ *OFF                                      CFT006
     C           SBRCA     OREQ 'ALL'                                     CFT006
     C                     MOVE *LOVAL    FRBRCH                          CFT006
     C                     MOVE *HIVAL    TOBRCH                          CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ENDIF                                          CFT006
     C                     MOVE *LOVAL    FRPYTP                          CFT006
     C                     MOVE *LOVAL    FRPREF                          CFT006
     C                     MOVE *HIVAL    TOPYTP                          CFT006
     C                     MOVE *HIVAL    TOPREF                          CFT006
     C*                                                                   CFT006
     C                     MOVE *OFF      *IN34                           CFT006
     C*                                                                   CFT006
     C* SELECT FILE TO BE READ DEPENDENT ON MBIN INDICATOR, SCREEN        CFT006
     C* BRANCH AND BRANCH TYPE                                            CFT006
     C*                                                                   CFT006
     C           *IN50     IFEQ *ON                                       CFT006
     C           SBRCA     ANDNE'ALL'                                     CFT006
      *                                                                   CFT006
     C           STYPE     IFEQ 'B'                                       CFT006
      *                                                                   CFT006
     C           FRKEY     SETLLFT101HJ0                                  CFT006
     C                     READ FT101HJ0                 34               CFT006
      *                                                                   CFT006
     C           SBRCA     IFNE BRCA                                      CFT006
     C                     MOVE *ON       *IN34                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ELSE                                           CFT006
     C           FRKEY     SETLLFT101HJ1                                  CFT006
     C                     READ FT101HJ1                 34               CFT006
      *                                                                   CFT006
     C           SBRCA     IFNE ORBR                                      CFT006
     C                     MOVE *ON       *IN34                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ENDIF                                          CFT006
     C                     ELSE                                           CFT006
      *                                                                   CFT006
     C           *IN50     IFEQ *OFF                                      CFT006
     C           SBRCA     OREQ 'ALL'                                     CFT006
     C           FRKEY     SETLLFT101HJ0                                  CFT006
     C                     READ FT101HJ0                 34               CFT006
     C                     MOVE BRCA      FRBRCH                          CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     MOVE PYTP      FRPYTP                          CFT006
     C                     MOVE RFTID     FRPREF                          CFT006
      *                                                                   CFT006
     C* DO UNTIL END OF FILE                                              CFT006
      *                                                                   CFT006
     C           *IN34     DOWEQ*OFF                                      CFT006
     C                     EXSR RFTCQ                                     CFT006
      *                                                                   CFT006
     C           SBRCA     IFNE SBRCA1                                    CFT006
     C           STYPE     ORNE STYPE1                                    CFT006
     C                     MOVE *OFF      *IN28                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C* IF FIRST PASS OF FILE ACCUMULATE TOTALS                           CFT006
      *                                                                   CFT006
     C           *IN28     IFEQ *OFF                                      CFT006
     C                     MOVE VAL       VALUE  133                      CFT006
     C                     Z-ADDCQINVI    ZZTOTI                          CFT006
     C                     Z-ADDCQINVD    ZZTOTD                          CFT006
     C                     Z-ADDVALUE     ZZAMT                           CFT006
     C                     EXSR GLZADD                                    CFT006
     C                     Z-ADDZZTOTI    CQINVI                          CFT006
     C                     Z-ADDZZTOTD    CQINVD                          CFT006
      *                                                                   CFT006
     C           *IN54     IFEQ *OFF                                      CFT006
     C                     ADD  1         CQRCIN                          CFT006
     C                     ELSE                                           CFT006
     C           *IN54     IFEQ *ON                                       CFT006
     C                     ADD  1         CQRCIO                          CFT006
     C                     ENDIF                                          CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     MOVE SBRCA     SBRCA1  3                       CFT006
     C                     MOVE STYPE     STYPE1  1                       CFT006
     C*                                                                   CFT006
     C* IF MBIN = Y AND SELECTION NOT 'ALL', IF BRANCH HAS CHANGED        CFT006
     C* SETON *IN34 TO STOP ACCESSING FURTHER RECORDS FROM THE FILE       CFT006
     C*                                                                   CFT006
     C           STYPE     IFEQ 'B'                                       CFT006
     C                     READ FT101HJ0                 34               CFT006
      *                                                                   CFT006
     C           *IN50     IFEQ *ON                                       CFT006
     C           SBRCA     ANDNE'ALL'                                     CFT006
     C           SBRCA     ANDNEBRCA                                      CFT006
     C                     MOVE *ON       *IN34                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ELSE                                           CFT006
      *                                                                   CFT006
     C                     READ FT101HJ1                 34               CFT006
      *                                                                   CFT006
     C           *IN51     IFEQ *ON                                       CFT006
     C           SBRCA     ANDNE'ALL'                                     CFT006
     C           SBRCA     ANDNEORBR                                      CFT006
     C                     MOVE *ON       *IN34                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ENDIF                                          CFT006
     C                     ENDDO                                          CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C*  SET FROM KEY AND TO KEY LISTS TO READ FROM/UPTO DEPENDENT        CFT006
     C*  ON MBIN INDICATOR AND SCREEN BRANCH SELECTION                    CFT006
      *                                                                   CFT006
     C           CFT008    IFEQ 'Y'                                       CFT006
     C                     MOVE *BLANKS   SBRCA1                          CFT006
     C                     MOVE *BLANKS   STYPE1                          CFT006
      *                                                                   CFT006
     C           *IN50     IFEQ *ON                                       CFT006
     C           SBRCA     ANDNE'ALL'                                     CFT006
     C                     MOVE SBRCA     FRBRCH                          CFT006
     C                     MOVE SBRCA     TOBRCH                          CFT006
     C                     ELSE                                           CFT006
      *                                                                   CFT006
     C           *IN50     IFEQ *OFF                                      CFT006
     C           SBRCA     OREQ 'ALL'                                     CFT006
     C                     MOVE *LOVAL    FRBRCH                          CFT006
     C                     MOVE *HIVAL    TOBRCH                          CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     MOVE *LOVAL    FRPYTP                          CFT006
     C                     MOVE *LOVAL    FRPREF                          CFT006
     C                     MOVE *HIVAL    TOPYTP                          CFT006
     C                     MOVE *HIVAL    TOPREF                          CFT006
     C*                                                                   CFT006
     C                     MOVE *OFF      *IN34                           CFT006
     C*                                                                   CFT006
     C* SELECT FILE TO BE READ DEPENDENT ON MBIN INDICATOR, SCREEN        CFT006
     C* BRANCH AND BRANCH TYPE                                            CFT006
     C*                                                                   CFT006
     C           *IN50     IFEQ *ON                                       CFT006
     C           SBRCA     ANDNE'ALL'                                     CFT006
      *                                                                   CFT006
     C           STYPE     IFEQ 'B'                                       CFT006
      *                                                                   CFT006
     C           FRKEY     SETLLFT102HJ0                                  CFT006
     C                     READ FT102HJ0                 34               CFT006
      *                                                                   CFT006
     C           SBRCA     IFNE BRCA                                      CFT006
     C                     MOVE *ON       *IN34                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ELSE                                           CFT006
      *                                                                   CFT006
     C           FRKEY     SETLLFT102HJ1                                  CFT006
     C                     READ FT102HJ1                 34               CFT006
      *                                                                   CFT006
     C           SBRCA     IFNE ORBR                                      CFT006
     C                     MOVE *ON       *IN34                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ELSE                                           CFT006
      *                                                                   CFT006
     C           *IN50     IFEQ *OFF                                      CFT006
     C           SBRCA     OREQ 'ALL'                                     CFT006
     C           FRKEY     SETLLFT102HJ0                                  CFT006
     C                     READ FT102HJ0                 34               CFT006
     C                     MOVE BRCA      FRBRCH                          CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     MOVE CCTTYP    FRPYTP                          CFT006
     C                     MOVE CCTID     FRPREF                          CFT006
      *                                                                   CFT006
     C* DO UNTIL END OF FILE                                              CFT006
      *                                                                   CFT006
     C           *IN34     DOWEQ*OFF                                      CFT006
     C                     EXSR CCTCQ                                     CFT006
      *                                                                   CFT006
     C           SBRCA     IFNE SBRCA1                                    CFT006
     C           STYPE     ORNE STYPE1                                    CFT006
     C                     MOVE *OFF      *IN28                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C* IF FIRST PASS OF FILE ACCUMULATE TOTALS                           CFT006
      *                                                                   CFT006
     C           *IN28     IFEQ *OFF                                      CFT006
     C                     MOVE VAL       VALUE  133                      CFT006
     C                     Z-ADDCQINVI    ZZTOTI                          CFT006
     C                     Z-ADDCQINVD    ZZTOTD                          CFT006
     C                     Z-ADDVALUE     ZZAMT                           CFT006
     C                     EXSR GLZADD                                    CFT006
     C                     Z-ADDZZTOTI    CQINVI                          CFT006
     C                     Z-ADDZZTOTD    CQINVD                          CFT006
      *                                                                   CFT006
     C           *IN54     IFEQ *OFF                                      CFT006
     C                     ADD  1         CQRCIN                          CFT006
     C                     ELSE                                           CFT006
     C           *IN54     IFEQ *ON                                       CFT006
     C                     ADD  1         CQRCIO                          CFT006
     C                     ENDIF                                          CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     MOVE SBRCA     SBRCA1  3                       CFT006
     C                     MOVE STYPE     STYPE1  1                       CFT006
     C*                                                                   CFT006
     C* IF MBIN = Y AND SELECTION NOT 'ALL', IF BRANCH HAS CHANGED        CFT006
     C* SETON *IN34 TO STOP ACCESSING FURTHER RECORDS FROM THE FILE       CFT006
     C*                                                                   CFT006
     C           STYPE     IFEQ 'B'                                       CFT006
     C                     READ FT102HJ0                 34               CFT006
      *                                                                   CFT006
     C           *IN50     IFEQ *ON                                       CFT006
     C           SBRCA     ANDNE'ALL'                                     CFT006
     C           SBRCA     ANDNEBRCA                                      CFT006
     C                     MOVE *ON       *IN34                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ELSE                                           CFT006
     C                     READ FT102HJ1                 34               CFT006
      *                                                                   CFT006
     C           *IN51     IFEQ *ON                                       CFT006
     C           SBRCA     ANDNE'ALL'                                     CFT006
     C           SBRCA     ANDNEORBR                                      CFT006
     C                     MOVE *ON       *IN34                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ENDIF                                          CFT006
     C                     ENDDO                                          CFT006
     C                     ENDIF                                          CFT006
     C*                                                                   E29917
     C* IF NO RECORDS FOR  THE SELECTION, BLANK @DRAW FIELD               E29917
     C*                                                                   E29917
     C           *IN34     IFEQ '1'                                       E29917
     C                     MOVE *BLANKS   @DRAW                           E29917
     C                     END                                            E29917
     C* IF PRINT FILE OPENED CLOSE
     C   26                DO                              B001
     C/COPY WNCPYSRC,FT0580C017
     C                     CLOSEFT0580P1
     C/COPY WNCPYSRC,FT0580C018
     C                     SETOF                     26
     C                     END                             E001
     C/COPY WNCPYSRC,FT0580C010
     C* SETON INDICATOR TO SAY FILE HAS BEEN READ THOUGH ONCE
     C  N28                SETON                     28
     C                     MOVE *HIVAL    TOBRCH                          S01117
     C                     MOVE *HIVAL    TOPYTP
     C                     MOVE *HIVAL    TOPREF
     C                     ENDSR
     C*
     C************************************************************
     C* END OF CHEQUE PRINTING SUBROUTINE
     C************************************************************
     C/EJECT
     C************************************************************
     C* VALTWO SR.
     C*
     C* VALIDATES SCREEN TWO
     C*
     C* PERFORMED FROM MAIN SECTION
     C*
     C           VALTWO    BEGSR
     C* CLEAR ERROR CODES SET SUBCRIPT (Z) TO 1 AND SETOF INDICATORS
     C                     MOVEA*BLANK    ERCD
     C                     SETOF                     2489
     C                     Z-ADD1         Z
     C* CHEQUE SUCCESSFUL FIELD IS MANDATORY
     C           CQSC      IFEQ ' '                        B001
     C                     SETON                     2489
     C*********************MOVEA' 316'    ERCD,Z                          S01117
     C                     MOVEA' 014'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     ELSE                            X001
     C* CHQUE SUCCESSFUL MUST BE 'Y' OR 'N'
     C           CQSC      IFNE 'Y'                        B002
     C           CQSC      ANDNE'N'
     C                     SETON                     2489
     C*********************MOVEA' 317'    ERCD,Z                          S01117
     C                     MOVEA' 015'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     END                             E002
     C                     END                             E001
     C                     ENDSR
     C*
     C************************************************************
     C* END OF SCREEN TWO VALIDATION
     C************************************************************
     C/EJECT
     C************************************************************
     C* UPDATE SR.
     C*
     C* WHEN PRINT SUCCESSFUL UPDATES REGISTER AND FILE
     C*
     C* PERFORMED FROM MAIN SECTION
     C*
     C* PERFORMS SUBROUTINES - PYUP
     C*                        OTUP
     C*                        RFTUP                                      CFT006
     C*                        CCTUP                                      CFT006
     C*
     C           UPDATE    BEGSR
     C*                                                                   S01117
     C* SET FILE TO READ FROM - DEPENDENT ON MBIN AND SCREEN SELECTION    S01117
     C           UPKEY     KLIST                                          S01117
     C                     KFLD           UPBRCH  3                       S01117
     C                     KFLD           UPPYTP                          S01117
     C                     KFLD           UPPREF                          S01117
     C*                                                                   S01117
     C           *LIKE     DEFN PYTP      UPPYTP                          S01117
     C           *LIKE     DEFN PREF      UPPREF                          S01117
     C*                                                                   S01117
     C           *IN50     IFEQ '1'                        B001           S01117
     C           SBRCA     ANDNE'ALL'                                     S01117
     C                     MOVE SBRCA     UPBRCH                          S01117
     C                     ELSE                            X001           S01117
     C           *IN50     IFEQ '0'                        B002           S01117
     C           SBRCA     OREQ 'ALL'                                     S01117
     C                     MOVE *LOVAL    UPBRCH                          S01117
     C                     END                             E002           S01117
     C                     END                             E001           S01117
     C                     MOVE *LOVAL    UPPYTP                          S01117
     C                     MOVE *LOVAL    UPPREF                          S01117
     C**SET*FILE*TO*READ*FROM*THE*START*                                  S01117
     C************LOVAL****SETLLCQDUE                                     S01117
     C                     SETOF                     34
     C*********************READ CQDUE                    34               S01117
     C*                                                                   S01117
     C* SELECT FILE TO BE READ DEPENDENT ON MBIN INDICATOR, SCREEN        S01117
     C* BRANCH AND BRANCH TYPE                                            S01117
     C*                                                                   S01117
     C/COPY WNCPYSRC,FT0580C089                                                               CFT118
     C           *IN50     IFEQ '1'                        B001           S01117
     C           SBRCA     ANDNE'ALL'                                     S01117
     C           STYPE     IFEQ 'B'                        B002           S01117
     C           UPKEY     SETLLCQDUEBB                                   S01117
     C/COPY WNCPYSRC,FT0580C090                                                               CFT118
     C                     READ CQDUEBB                  34               S01117
     C/COPY WNCPYSRC,FT0580C091                                                               CFT118
     C           SBRCA     IFNE BRCA                       B003           S01117
     C                     SETON                     34                   S01117
     C                     END                             E003           S01117
     C                     ELSE                            X002           S01117
     C           UPKEY     SETLLCQDUEOB                                   S01117
     C                     READ CQDUEOB                  34               S01117
     C           SBRCA     IFNE ORBR                       B003           S01117
     C                     SETON                     34                   S01117
     C                     END                             E003           S01117
     C                     END                             E002           S01117
     C                     ELSE                            X001           S01117
     C           *IN50     IFEQ '0'                        B002           S01117
     C           SBRCA     OREQ 'ALL'                                     S01117
     C           UPKEY     SETLLCQDUEBB                                   S01117
     C                     READ CQDUEBB                  34               S01117
     C                     END                             E002           S01117
     C                     END                             E001           S01117
     C* DO UNTIL END OF FILE
     C           *IN34     DOWNE'1'                        B001
     C* ONLY UPDATE FILE IF CQIN IS 'P', CHEQUE HAS PRINTED
     C* AND IS THE LOT JUST PRINTED SUCCESSFULLY
     C           CQIN      IFEQ 'P'                        B002
     C           STMT      IFEQ 12                         B003
     C           CQTP      ANDEQ'O'
     C* IF PAYMENT TYPE IS 'CP' MUST BE A CQPACDD RECORD
     C           PYTP      IFEQ 'CP'                       B004
     C                     EXSR PYUP
     C                     ELSE                            X004
     C                     EXSR OTUP
     C                     END                             E004
     C                     ELSE                            X003
     C           STMT      IFEQ 13                         B004
     C           CQTP      ANDEQ'D'
     C           PYTP      IFEQ 'CP'                       B005
     C                     EXSR PYUP
     C                     ELSE                            X005
     C                     EXSR OTUP
     C                     END                             E005
     C                     END                             E004
     C                     END                             E003
     C                     END                             E002
     C*********************READ CQDUE                    34               S01117
     C*                                                                   S01117
     C* IF MBIN = Y AND SELECTION NOT 'ALL', IF BRANCH HAS CHANGED        S01117
     C* SETON *IN34 TO STOP ACCESSING FURTHER RECORDS FROM THE FILE       S01117
     C*                                                                   S01117
     C           STYPE     IFEQ 'B'                        B002           S01117
     C                     READ CQDUEBB                  34               S01117
     C           *IN50     IFEQ '1'                        B003           S01117
     C           SBRCA     ANDNE'ALL'                                     S01117
     C           SBRCA     ANDNEBRCA                                      S01117
     C                     SETON                     34                   S01117
     C                     END                             E003           S01117
     C/COPY WNCPYSRC,FT0580C092                                                               CFT118
     C                     ELSE                            X002           S01117
     C                     READ CQDUEOB                  34               S01117
     C           *IN51     IFEQ '1'                        B003           S01117
     C           SBRCA     ANDNE'ALL'                                     S01117
     C           SBRCA     ANDNEORBR                                      S01117
     C                     SETON                     34                   S01117
     C                     END                             E003           S01117
     C                     END                             E002           S01117
     C                     END                             E001
     C*                                                                   CFT006
     C           CFT006    IFEQ 'Y'                                       CFT006
     C*                                                                   CFT006
     C           *IN50     IFEQ *ON                                       CFT006
     C           SBRCA     ANDNE'ALL'                                     CFT006
     C                     MOVE SBRCA     UPBRCH                          CFT006
     C                     ELSE                                           CFT006
      *                                                                   CFT006
     C           *IN50     IFEQ *OFF                                      CFT006
     C           SBRCA     OREQ 'ALL'                                     CFT006
     C                     MOVE *LOVAL    UPBRCH                          CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     MOVE *LOVAL    UPPYTP                          CFT006
     C                     MOVE *LOVAL    UPPREF                          CFT006
     C                     MOVE *OFF      *IN34                           CFT006
     C*                                                                   CFT006
     C* SELECT FILE TO BE READ DEPENDENT ON MBIN INDICATOR, SCREEN        CFT006
     C* BRANCH AND BRANCH TYPE                                            CFT006
     C*                                                                   CFT006
     C           *IN50     IFEQ *ON                                       CFT006
     C           SBRCA     ANDNE'ALL'                                     CFT006
      *                                                                   CFT006
     C           STYPE     IFEQ 'B'                                       CFT006
      *                                                                   CFT006
     C           UPKEY     SETLLFT101HJ0                                  CFT006
     C                     READ FT101HJ0                 34               CFT006
      *                                                                   CFT006
     C           SBRCA     IFNE BRCA                                      CFT006
     C                     MOVE *ON       *IN34                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ELSE                                           CFT006
      *                                                                   CFT006
     C           UPKEY     SETLLFT101HJ1                                  CFT006
     C                     READ FT101HJ1                 34               CFT006
      *                                                                   CFT006
     C           SBRCA     IFNE ORBR                                      CFT006
     C                     MOVE *ON       *IN34                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ELSE                                           CFT006
      *                                                                   CFT006
     C           *IN50     IFEQ *OFF                                      CFT006
     C           SBRCA     OREQ 'ALL'                                     CFT006
      *                                                                   CFT006
     C           UPKEY     SETLLFT101HJ0                                  CFT006
     C                     READ FT101HJ0                 34               CFT006
      *                                                                   CFT006
     C                     ENDIF                                          CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C* DO UNTIL END OF FILE                                              CFT006
      *                                                                   CFT006
     C           *IN34     DOWEQ*OFF                                      CFT006
      *                                                                   CFT006
     C* ONLY UPDATE FILE IF CQIN IS 'P', CHEQUE HAS PRINTED               CFT006
     C* AND IS THE LOT JUST PRINTED SUCCESSFULLY                          CFT006
      *                                                                   CFT006
     C           CQIN      IFEQ 'P'                                       CFT006
     C                     EXSR RFTUP                                     CFT006
     C                     ENDIF                                          CFT006
     C*                                                                   CFT006
     C* IF MBIN = Y AND SELECTION NOT 'ALL', IF BRANCH HAS CHANGED        CFT006
     C* SETON *IN34 TO STOP ACCESSING FURTHER RECORDS FROM THE FILE       CFT006
     C*                                                                   CFT006
     C           STYPE     IFEQ 'B'                                       CFT006
     C                     READ FT101HJ0                 34               CFT006
      *                                                                   CFT006
     C           *IN50     IFEQ *ON                                       CFT006
     C           SBRCA     ANDNE'ALL'                                     CFT006
     C           SBRCA     ANDNEBRCA                                      CFT006
     C                     MOVE *ON       *IN34                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ELSE                                           CFT006
     C                     READ FT101HJ1                 34               CFT006
      *                                                                   CFT006
     C           *IN51     IFEQ *ON                                       CFT006
     C           SBRCA     ANDNE'ALL'                                     CFT006
     C           SBRCA     ANDNEORBR                                      CFT006
     C                     MOVE *ON       *IN34                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ENDIF                                          CFT006
     C                     ENDDO                                          CFT006
     C                     ENDIF                                          CFT006
     C*                                                                   CFT006
     C           CFT008    IFEQ 'Y'                                       CFT006
     C           *IN50     IFEQ *ON                                       CFT006
     C           SBRCA     ANDNE'ALL'                                     CFT006
     C                     MOVE SBRCA     UPBRCH                          CFT006
     C                     ELSE                                           CFT006
      *                                                                   CFT006
     C           *IN50     IFEQ *OFF                                      CFT006
     C           SBRCA     OREQ 'ALL'                                     CFT006
     C                     MOVE *LOVAL    UPBRCH                          CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     MOVE *LOVAL    UPPYTP                          CFT006
     C                     MOVE *LOVAL    UPPREF                          CFT006
     C                     MOVE *OFF      *IN34                           CFT006
     C*                                                                   CFT006
     C* SELECT FILE TO BE READ DEPENDENT ON MBIN INDICATOR, SCREEN        CFT006
     C* BRANCH AND BRANCH TYPE                                            CFT006
     C*                                                                   CFT006
     C           *IN50     IFEQ *ON                                       CFT006
     C           SBRCA     ANDNE'ALL'                                     CFT006
      *                                                                   CFT006
     C           STYPE     IFEQ 'B'                                       CFT006
      *                                                                   CFT006
     C           UPKEY     SETLLFT102HJ0                                  CFT006
     C                     READ FT102HJ0                 34               CFT006
      *                                                                   CFT006
     C           SBRCA     IFNE BRCA                                      CFT006
     C                     MOVE *ON       *IN34                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ELSE                                           CFT006
      *                                                                   CFT006
     C           UPKEY     SETLLFT102HJ1                                  CFT006
     C                     READ FT102HJ1                 34               CFT006
      *                                                                   CFT006
     C           SBRCA     IFNE ORBR                                      CFT006
     C                     MOVE *ON       *IN34                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ENDIF                                          CFT006
     C                     ELSE                                           CFT006
      *                                                                   CFT006
     C           *IN50     IFEQ *OFF                                      CFT006
     C           SBRCA     OREQ 'ALL'                                     CFT006
     C           UPKEY     SETLLFT102HJ0                                  CFT006
     C                     READ FT102HJ0                 34               CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C* DO UNTIL END OF FILE                                              CFT006
      *                                                                   CFT006
     C           *IN34     DOWEQ*OFF                                      CFT006
      *                                                                   CFT006
     C* ONLY UPDATE FILE IF CQIN IS 'P', CHEQUE HAS PRINTED               CFT006
     C* AND IS THE LOT JUST PRINTED SUCCESSFULLY                          CFT006
      *                                                                   CFT006
     C           CQIN      IFEQ 'P'                                       CFT006
     C                     EXSR CCTUP                                     CFT006
     C                     ENDIF                                          CFT006
     C*                                                                   CFT006
     C* IF MBIN = Y AND SELECTION NOT 'ALL', IF BRANCH HAS CHANGED        CFT006
     C* SETON *IN34 TO STOP ACCESSING FURTHER RECORDS FROM THE FILE       CFT006
     C*                                                                   CFT006
     C           STYPE     IFEQ 'B'                                       CFT006
     C                     READ FT102HJ0                 34               CFT006
      *                                                                   CFT006
     C           *IN50     IFEQ *ON                                       CFT006
     C           SBRCA     ANDNE'ALL'                                     CFT006
     C           SBRCA     ANDNEBRCA                                      CFT006
     C                     MOVE *ON       *IN34                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ELSE                                           CFT006
     C                     READ FT102HJ1                 34               CFT006
      *                                                                   CFT006
     C           *IN51     IFEQ *ON                                       CFT006
     C           SBRCA     ANDNE'ALL'                                     CFT006
     C           SBRCA     ANDNEORBR                                      CFT006
     C                     MOVE *ON       *IN34                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ENDIF                                          CFT006
     C                     ENDDO                                          CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ENDSR
     C*
     C************************************************************
     C* END OF UPDATE SUBROUTINE
     C************************************************************
     C/EJECT
     C************************************************************
     C************************************************************
     C/EJECT
     C************************************************************
     C* UPDATE SR.
     C*
     C* WHEN PRINT SUCCESSFUL UPDATES REGISTER AND FILE
     C* THIS ROUTINE IS DONE ONLY WHEN CHEQUE TYPE IS 'D'.
     C* PERFORMED FROM MAIN SECTION & SRNEW
     C*
     C* PERFORMS SUBROUTINES - PYUP
     C*                        OTUP
     C*                        RFTUP                                      CFT006
     C*                        CCTUP                                      CFT006
     C*
     C           @UPDAT    BEGSR
     C* SET FILE TO READ FROM THE START
     C*********************MOVE *BLANK    TOOKEY 17                       S01117
     C*********************MOVELTOPYTP    TOOKEY                          S01117
     C*********************MOVE TOPREF    TOOKEY                          S01117
     C                     MOVE *BLANK    TOOKEY 20                       S01117
     C                     MOVELTOBRCH    TOOKEY                          S01117
     C                     MOVELTOPYTP    TOOKE1 17                       S01117
     C                     MOVE TOPREF    TOOKE1                          S01117
     C                     MOVE TOOKE1    TOOKEY                          S01117
     C***********FRKEY*****SETLLCQDUE                                     S01117
     C                     SETOF                     34
     C***********FRKEY*****READECQDUE                    34               S01117
     C*                                                                   S01117
     C* SELECT FILE TO BE READ DEPENDENT ON MBIN INDICATOR, SCREEN        S01117
     C* BRANCH AND BRANCH TYPE                                            S01117
     C*                                                                   S01117
     C/COPY WNCPYSRC,FT0580C093                                                               CFT118
     C           *IN50     IFEQ '1'                        B001           S01117
     C           SBRCA     ANDNE'ALL'                                     S01117
     C           STYPE     IFEQ 'B'                        B002           S01117
     C           FRKEY     SETLLCQDUEBB                                   S01117
     C/COPY WNCPYSRC,FT0580C094                                                               CFT118
     C                     READ CQDUEBB                  34               S01117
     C/COPY WNCPYSRC,FT0580C095                                                               CFT118
     C           SBRCA     IFNE BRCA                       B003           S01117
     C                     SETON                     34                   S01117
     C                     END                             E003           S01117
     C                     ELSE                            X002           S01117
     C           FRKEY     SETLLCQDUEOB                                   S01117
     C                     READ CQDUEOB                  34               S01117
     C           SBRCA     IFNE ORBR                       B003           S01117
     C                     SETON                     34                   S01117
     C                     END                             E003           S01117
     C                     END                             E002           S01117
     C                     ELSE                            X001           S01117
     C           *IN50     IFEQ '0'                        B002           S01117
     C           SBRCA     OREQ 'ALL'                                     S01117
     C           FRKEY     SETLLCQDUEBB                                   S01117
     C                     READ CQDUEBB                  34               S01117
     C                     END                             E002           S01117
     C                     END                             E001           S01117
     C*                                                                   S01117
     C*********************MOVE *BLANK    CURKEY 17                       S01117
     C*********************MOVELPYTP      CURKEY                          S01117
     C*********************MOVE PREF      CURKEY                          S01117
     C                     MOVE *BLANK    CURKEY 20                       S01117
     C           *IN50     IFEQ '1'                        B001           S01117
     C           SBRCA     ANDNE'ALL'                                     S01117
     C                     MOVELSBRCA     CURKEY                          S01117
     C                     ELSE                            X001           S01117
     C           *IN50     IFEQ '0'                        B002           S01117
     C           SBRCA     OREQ 'ALL'                                     S01117
     C                     MOVELBRCA      CURKEY                          S01117
     C                     END                             E002           S01117
     C                     END                             E001           S01117
     C                     MOVELPYTP      CURKE1 17                       S01117
     C                     MOVE PREF      CURKE1                          S01117
     C                     MOVE CURKE1    CURKEY                          S01117
     **
     C* DO UNTIL END OF FILE
     C           *IN34     DOWNE'1'                        B001
     C           CURKEY    ANDLTTOOKEY                     B001
     C* ONLY UPDATE FILE IF CQIN IS 'P', CHEQUE HAS PRINTED
     C* AND IS THE LOT JUST PRINTED SUCCESSFULLY
     C           CQIN      IFEQ 'P'                        B002
     C           STMT      IFEQ 12                         B003
     C           CQTP      ANDEQ'O'
     C* IF PAYMENT TYPE IS 'CP' MUST BE A CQPACDD RECORD
     C           PYTP      IFEQ 'CP'                       B004
     C                     EXSR PYUP
     C                     ELSE                            X004
     C                     EXSR OTUP
     C                     END                             E004
     C                     ELSE                            X003
     C           STMT      IFEQ 13                         B004
     C           CQTP      ANDEQ'D'
     C           PYTP      IFEQ 'CP'                       B005
     C                     EXSR PYUP
     C                     ELSE                            X005
     C                     EXSR OTUP
     C                     END                             E005
     C                     END                             E004
     C                     END                             E003
     C                     END                             E002
     C*********************READ CQDUE                    34               S01117
     C*                                                                   S01117
     C* IF MBIN = Y AND SELECTION NOT 'ALL', IF BRANCH HAS CHANGED        S01117
     C* SETON *IN34 TO STOP ACCESSING FURTHER RECORDS FROM THE FILE       S01117
     C*                                                                   S01117
     C           STYPE     IFEQ 'B'                        B002           S01117
     C                     READ CQDUEBB                  34               S01117
     C           *IN50     IFEQ '1'                        B003           S01117
     C           SBRCA     ANDNE'ALL'                                     S01117
     C           SBRCA     ANDNEBRCA                                      S01117
     C                     SETON                     34                   S01117
     C                     END                             E003           S01117
     C/COPY WNCPYSRC,FT0580C096                                                               CFT118
     C                     ELSE                            X002           S01117
     C                     READ CQDUEOB                  34               S01117
     C           *IN51     IFEQ '1'                        B003           S01117
     C           SBRCA     ANDNE'ALL'                                     S01117
     C           SBRCA     ANDNEORBR                                      S01117
     C                     SETON                     34                   S01117
     C                     END                             E003           S01117
     C                     END                             E002           S01117
     C                     MOVE *BLANK    CURKEY
     C*********************MOVELPYTP      CURKEY                          S01117
     C*********************MOVE PREF      CURKEY                          S01117
     C           *IN50     IFEQ '1'                        B001           S01117
     C           SBRCA     ANDNE'ALL'                                     S01117
     C                     MOVELSBRCA     CURKEY                          S01117
     C                     ELSE                            X001           S01117
     C           *IN50     IFEQ '0'                        B002           S01117
     C           SBRCA     OREQ 'ALL'                                     S01117
     C                     MOVELBRCA      CURKEY                          S01117
     C                     END                             E002           S01117
     C                     END                             E001           S01117
     C                     MOVELPYTP      CURKE1 17                       S01117
     C                     MOVE PREF      CURKE1                          S01117
     C                     MOVE CURKE1    CURKEY                          S01117
     C                     END                             E001
     C*                                                                   CFT006
     C           CFT006    IFEQ 'Y'                                       CFT006
     C*                                                                   CFT006
     C                     MOVE *OFF      *IN34                           CFT006
     C*                                                                   CFT006
     C* SELECT FILE TO BE READ DEPENDENT ON MBIN INDICATOR, SCREEN        CFT006
     C* BRANCH AND BRANCH TYPE                                            CFT006
     C*                                                                   CFT006
     C           *IN50     IFEQ *ON                                       CFT006
     C           SBRCA     ANDNE'ALL'                                     CFT006
      *                                                                   CFT006
     C           STYPE     IFEQ 'B'                                       CFT006
      *                                                                   CFT006
     C           FRKEY     SETLLFT101HJ0                                  CFT006
     C                     READ FT101HJ0                 34               CFT006
      *                                                                   CFT006
     C           SBRCA     IFNE BRCA                                      CFT006
     C                     MOVE *ON       *IN34                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ELSE                                           CFT006
      *                                                                   CFT006
     C           FRKEY     SETLLFT101HJ1                                  CFT006
     C                     READ FT101HJ1                 34               CFT006
      *                                                                   CFT006
     C           SBRCA     IFNE ORBR                                      CFT006
     C                     MOVE *ON       *IN34                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ENDIF                                          CFT006
     C                     ELSE                                           CFT006
      *                                                                   CFT006
     C           *IN50     IFEQ *OFF                                      CFT006
     C           SBRCA     OREQ 'ALL'                                     CFT006
     C           FRKEY     SETLLFT101HJ0                                  CFT006
     C                     READ FT101HJ0                 34               CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ENDIF                                          CFT006
     C*                                                                   CFT006
     C                     MOVE *BLANK    CURKEY 20                       CFT006
      *                                                                   CFT006
     C           *IN50     IFEQ *ON                                       CFT006
     C           SBRCA     ANDNE'ALL'                                     CFT006
     C                     MOVELSBRCA     CURKEY                          CFT006
     C                     ELSE                                           CFT006
      *                                                                   CFT006
     C           *IN50     IFEQ *OFF                                      CFT006
     C           SBRCA     OREQ 'ALL'                                     CFT006
     C                     MOVELBRCA      CURKEY                          CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     MOVELPYTP      CURKE1 17                       CFT006
     C                     MOVE RFTID     CURKE1                          CFT006
     C                     MOVE CURKE1    CURKEY                          CFT006
     **                                                                   CFT006
     C* DO UNTIL END OF FILE                                              CFT006
      *                                                                   CFT006
     C           *IN34     DOWEQ*OFF                                      CFT006
     C           CURKEY    ANDLTTOOKEY                                    CFT006
      *                                                                   CFT006
     C* ONLY UPDATE FILE IF CQIN IS 'P', CHEQUE HAS PRINTED               CFT006
     C* AND IS THE LOT JUST PRINTED SUCCESSFULLY                          CFT006
      *                                                                   CFT006
     C           CQIN      IFEQ 'P'                                       CFT006
     C                     EXSR RFTUP                                     CFT006
     C                     ENDIF                                          CFT006
     C*                                                                   CFT006
     C* IF MBIN = Y AND SELECTION NOT 'ALL', IF BRANCH HAS CHANGED        CFT006
     C* SETON *IN34 TO STOP ACCESSING FURTHER RECORDS FROM THE FILE       CFT006
     C*                                                                   CFT006
     C           STYPE     IFEQ 'B'                                       CFT006
     C                     READ FT101HJ0                 34               CFT006
      *                                                                   CFT006
     C           *IN50     IFEQ *ON                                       CFT006
     C           SBRCA     ANDNE'ALL'                                     CFT006
     C           SBRCA     ANDNEBRCA                                      CFT006
     C                     MOVE *ON       *IN34                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ELSE                                           CFT006
     C                     READ FT101HJ1                 34               CFT006
      *                                                                   CFT006
     C           *IN51     IFEQ *ON                                       CFT006
     C           SBRCA     ANDNE'ALL'                                     CFT006
     C           SBRCA     ANDNEORBR                                      CFT006
     C                     MOVE *ON       *IN34                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     MOVE *BLANK    CURKEY                          CFT006
      *                                                                   CFT006
     C           *IN50     IFEQ *ON                                       CFT006
     C           SBRCA     ANDNE'ALL'                                     CFT006
     C                     MOVELSBRCA     CURKEY                          CFT006
     C                     ELSE                                           CFT006
      *                                                                   CFT006
     C           *IN50     IFEQ *OFF                                      CFT006
     C           SBRCA     OREQ 'ALL'                                     CFT006
     C                     MOVELBRCA      CURKEY                          CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     MOVELPYTP      CURKE1 17                       CFT006
     C                     MOVE RFTID     CURKE1                          CFT006
     C                     MOVE CURKE1    CURKEY                          CFT006
      *                                                                   CFT006
     C                     ENDDO                                          CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C           CFT008    IFEQ 'Y'                                       CFT006
     C*                                                                   CFT006
     C                     MOVE *OFF      *IN34                           CFT006
     C*                                                                   CFT006
     C* SELECT FILE TO BE READ DEPENDENT ON MBIN INDICATOR, SCREEN        CFT006
     C* BRANCH AND BRANCH TYPE                                            CFT006
     C*                                                                   CFT006
     C           *IN50     IFEQ *ON                                       CFT006
     C           SBRCA     ANDNE'ALL'                                     CFT006
      *                                                                   CFT006
     C           STYPE     IFEQ 'B'                                       CFT006
     C           FRKEY     SETLLFT102HJ0                                  CFT006
     C                     READ FT102HJ0                 34               CFT006
      *                                                                   CFT006
     C           SBRCA     IFNE BRCA                                      CFT006
     C                     MOVE *ON       *IN34                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ELSE                                           CFT006
     C           FRKEY     SETLLFT102HJ1                                  CFT006
     C                     READ FT102HJ1                 34               CFT006
      *                                                                   CFT006
     C           SBRCA     IFNE ORBR                                      CFT006
     C                     MOVE *ON       *IN34                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ELSE                                           CFT006
      *                                                                   CFT006
     C           *IN50     IFEQ *OFF                                      CFT006
     C           SBRCA     OREQ 'ALL'                                     CFT006
     C           FRKEY     SETLLFT102HJ0                                  CFT006
     C                     READ FT102HJ0                 34               CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ENDIF                                          CFT006
     C*                                                                   CFT006
     C                     MOVE *BLANK    CURKEY 20                       CFT006
      *                                                                   CFT006
     C           *IN50     IFEQ *ON                                       CFT006
     C           SBRCA     ANDNE'ALL'                                     CFT006
     C                     MOVELSBRCA     CURKEY                          CFT006
     C                     ELSE                                           CFT006
      *                                                                   CFT006
     C           *IN50     IFEQ *OFF                                      CFT006
     C           SBRCA     OREQ 'ALL'                                     CFT006
     C                     MOVELBRCA      CURKEY                          CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     MOVELCCTTYP    CURKE1 17                       CFT006
     C                     MOVE CCTID     CURKE1                          CFT006
     C                     MOVE CURKE1    CURKEY                          CFT006
     **                                                                   CFT006
     C* DO UNTIL END OF FILE                                              CFT006
      *                                                                   CFT006
     C           *IN34     DOWEQ*OFF                                      CFT006
     C           CURKEY    ANDLTTOOKEY                                    CFT006
      *                                                                   CFT006
     C* ONLY UPDATE FILE IF CQIN IS 'P', CHEQUE HAS PRINTED               CFT006
     C* AND IS THE LOT JUST PRINTED SUCCESSFULLY                          CFT006
      *                                                                   CFT006
     C           CQIN      IFEQ 'P'                                       CFT006
     C                     EXSR CCTUP                                     CFT006
     C                     ENDIF                                          CFT006
     C*                                                                   CFT006
     C* IF MBIN = Y AND SELECTION NOT 'ALL', IF BRANCH HAS CHANGED        CFT006
     C* SETON *IN34 TO STOP ACCESSING FURTHER RECORDS FROM THE FILE       CFT006
     C*                                                                   CFT006
     C           STYPE     IFEQ 'B'                                       CFT006
     C                     READ FT102HJ0                 34               CFT006
      *                                                                   CFT006
     C           *IN50     IFEQ *ON                                       CFT006
     C           SBRCA     ANDNE'ALL'                                     CFT006
     C           SBRCA     ANDNEBRCA                                      CFT006
     C                     MOVE *ON       *IN34                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ELSE                                           CFT006
     C                     READ FT102HJ1                 34               CFT006
      *                                                                   CFT006
     C           *IN51     IFEQ *ON                                       CFT006
     C           SBRCA     ANDNE'ALL'                                     CFT006
     C           SBRCA     ANDNEORBR                                      CFT006
     C                     MOVE *ON       *IN34                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ENDIF                                          CFT006
     C                     MOVE *BLANK    CURKEY                          CFT006
      *                                                                   CFT006
     C           *IN50     IFEQ *ON                                       CFT006
     C           SBRCA     ANDNE'ALL'                                     CFT006
     C                     MOVELSBRCA     CURKEY                          CFT006
     C                     ELSE                                           CFT006
      *                                                                   CFT006
     C           *IN50     IFEQ *OFF                                      CFT006
     C           SBRCA     OREQ 'ALL'                                     CFT006
     C                     MOVELBRCA      CURKEY                          CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     MOVELCCTTYP    CURKE1 17                       CFT006
     C                     MOVE CCTID     CURKE1                          CFT006
     C                     MOVE CURKE1    CURKEY                          CFT006
      *                                                                   CFT006
     C                     ENDDO                                          CFT006
     C                     ENDIF                                          CFT006
     C                     ENDSR
     C*
     C************************************************************
     C* END OF UPDATE SUBROUTINE
     C************************************************************
     C* FINAL SR.
     C*
     C* IF CHEQUES HAVE BEEN PRINTED PRINTS RUN CONTROLS
     C*
     C* PERFORMED FROM MAIN SECTION
     C*
     C           FINAL     BEGSR
     C*********************OPEN FT0580P2                                  S01117
     C                     OPEN FT0580AU                                  S01117
     C                     Z-ADDCQRGN     CQPTN
     C*********************WRITEFT580P2F               88                 S01117
     C                     WRITEFT580AUF               88                 S01117
     C* IF WRITE FAILS
     C   88                DO                              B001
     C           *LOCK     IN   *NAMVAR
     C                     MOVE 'FT0580  'DBPGM            ***************
     C*********************MOVE 'PRINT'   DBFILE           * DB ERROR 04 *S01194
     C                     MOVEL'PRINT'   DBFILE           ***************S01194
     C                     Z-ADD4         DBASE            ***************
     C                     MOVE *BLANK    DBKEY
     C                     MOVEL'2'       DBKEY
     C                     OUT  *NAMVAR
     C                     SETON                     U7U8LR
     C                     DUMP
     C                     RETRN
     C                     END                             E001
     C*********************CLOSEFT0580P2                                  S01117
     C                     CLOSEFT0580AU                                  S01117
     C                     ENDSR
     C*
     C************************************************************
     C* END OF FINAL SUBROUTINE
     C************************************************************
     C/EJECT
     C************************************************************
     C* OTCQ SR.
     C*
     C* PRINTS CHEQUES FOR OUTGOING PAYMENTS
     C*
     C* PERFORMED FROM       - PRINT
     C*
     C* PERFORMS SUBROUTINES - ADRES
     C*                        NUMBER
     C*                        DATE
     C*
     C           OTCQ      BEGSR
      *                                                                   S01522
      ** If not User Defined Correspondence.                              S01522
     C           *IN37     IFEQ *OFF                                      S01522
      *                                                                   S01522
     C* IF PRINT FILE NOT OPEN OPEN
     C           CQTP      IFEQ 'O'
     C  N26                DO                              B001
     C/COPY WNCPYSRC,FT0580C019
     C                     OPEN FT0580P1
     C/COPY WNCPYSRC,FT0580C020
     C                     SETON                     26
     C                     END                             E001
     C/COPY WNCPYSRC,FT0580C011
     C                     END
     C* GET ORDERING CUSTOMER NAME AND ADDRESS
     C                     SETON                     59
     C                     MOVE *OFF      *IN73                           CFT006
     C                     MOVE *OFF      *IN74                           CFT006
      *                                                                                       CFT032
     C           1         SUBSTORC1:1    WSLSH   1                                           CFT032
     C           WSLSH     IFEQ '/'                                                           CFT032
     C                     SELEC                                                              CFT032
     C           ORCT      WHEQ 'P'                                                           CFT032
     C           ORCT      OREQ 'R'                                                           CFT032
     C           34        SUBSTORC1:2    WORC   34                                           CFT032
     C                     MOVELWORC      INAD1                                               CFT032
     C                     MOVE ORC2      INAD2                                               CFT032
     C                     MOVE ORC3      INAD3                                               CFT032
     C                     MOVE ORC4      INAD4                                               CFT032
     C                     MOVE ORC5      INAD5                                               CFT032
     C           ORCT      WHEQ 'A'                                                           CFT032
     C                     MOVE ORC2      INAD1                                               CFT032
     C                     MOVE ORC3      INAD2                                               CFT032
     C                     MOVE ORC4      INAD3                                               CFT032
     C                     MOVE ORC5      INAD4                                               CFT032
     C                     MOVE *BLANKS   INAD5                                               CFT032
     C                     ENDSL                                                              CFT032
      *                                                                                       CFT032
     C                     ELSE                                                               CFT032
     C           ORCT      IFEQ 'I'                                                           CFT032
     C                     MOVELORC1      WORC                                                CFT032
     C           '/'       CAT  WORC      INAD1                                               CFT032
     C                     ELSE                                                               CFT032
     C                     MOVE ORC1      INAD1
     C                     ENDIF                                                              CFT032
     C                     MOVE ORC2      INAD2
     C                     MOVE ORC3      INAD3
     C                     MOVE ORC4      INAD4
     C**********           MOVE *BLANK    INAD5                                               CFT032
     C                     MOVE ORC5      INAD5                                               CFT032
     C                     ENDIF                                                              CFT032
      *                                                                                       CFT032
     C                     MOVE SMCY      ADCCY   3
     C                     MOVE ORCT      ATYPE   1
     C                     EXSR ADRES
     C                     MOVE ADDRS     ORCA
     C/COPY WNCPYSRC,FT0580C021
     C* GET BENEFICIARY CUSTOMER NAME AND ADDRESS
     C                     MOVE BNC1      INAD1
     C                     MOVE BNC2      INAD2
     C                     MOVE BNC3      INAD3
     C                     MOVE BNC4      INAD4
     C                     MOVE BNC5      INAD5
     C                     MOVE PCCY      ADCCY
     C                     MOVE BNCT      ATYPE
     C                     EXSR ADRES
     C                     MOVE ADDRS     BNCA
     C/COPY WNCPYSRC,FT0580C022
     C* GET RECEIVING BANK'S NAME AND ADDRESS
     C                     MOVE DST1      INAD1
     C                     MOVE DST2      INAD2
     C                     MOVE DST3      INAD3
     C                     MOVE DST4      INAD4
     C                     MOVE *BLANK    INAD5
     C                     MOVE PCCY      ADCCY
     C                     MOVE DSTT      ATYPE
     C/COPY WNCPYSRC,FT0580C064
     C                     EXSR ADRES
     C/COPY WNCPYSRC,FT0580C065
     C                     MOVE ADDRS     RCBA
     C           CQTP      IFEQ 'D'
     **
     C           @DRAW     IFNE RCBA
     C           *IN50     IFEQ '0'                                       S01117
     C           SBRCA     OREQ 'ALL'                                     S01117
     C                     MOVE BRCA      TOBRCH                          S01117
     C                     END                                            S01117
     C                     MOVE PREF      TOPREF
     C                     MOVE PYTP      TOPYTP
     C                     MOVE RCBA      @DRAW 175
     C                     EXSR SRNEW
     C           *IN50     IFEQ '0'                                       S01117
     C           SBRCA     OREQ 'ALL'                                     S01117
     C                     MOVE TOBRCH    FRBRCH                          S01117
     C                     END                                            S01117
     C                     MOVE TOPREF    FRPREF
     C                     MOVE TOPYTP    FRPYTP
     C                     END
     **
     C                     END
     C/COPY WNCPYSRC,FT0580C023
     C* IF ADD/DEDUCT IS NOT 'A' AND DEBIT ACCOUNT BLANK
     C* SUBTRACT CHARGES FROM PAY AMOUNT
     C           ADDC      IFNE 'A'                        B001
     C***********CDRO      ANDEQ0                                                             CSD027
     C           CDRO      ANDEQ*BLANKS                                                       CSD027
     C                     SUB  TRCM      PYAM
     C                     SUB  TXCH      PYAM
     C                     SUB  CQCH      PYAM
     C                     SUB  CSTA      PYAM
     C                     SUB  SPCH      PYAM
     C                     SUB  MSCH      PYAM
     C/COPY WNCPYSRC,FT0580C024
     C                     END                             E001
     C/COPY WNCPYSRC,FT0580C025
     C                     Z-ADDPYAM      CQAM
     C/COPY WNCPYSRC,FT0580C026
     C* COVERT CHEQUE AMOUNT TO WORDS AND SET DECIMAL PLACES
     C                     SETOF                     2935
     C                     EXSR NUMBER
     C* FORMAT DATE
     C/COPY WNCPYSRC,FT0580C027
     C                     MOVE PVDTD1    INDAT
     C                     EXSR DATE
     C                     MOVE PCCY      CCY
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0580CCP2                                           S01408
     C*                                                                   S01408
     C                     WRITEFT580PF1               88
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0580CCP3                                           S01408
     C*                                                                   S01408
     C* IF WRITE FAILS
     C   88                DO                              B001
     C           *LOCK     IN   *NAMVAR
     C                     MOVE 'FT0580  'DBPGM            ***************
     C*********************MOVE 'PRINT'   DBFILE           * DB ERROR 05 *S01194
     C                     MOVEL'PRINT'   DBFILE           ***************S01194
     C                     Z-ADD5         DBASE            ***************
     C                     MOVE *BLANK    DBKEY
     C                     MOVEL'1'       DBKEY
     C                     OUT  *NAMVAR
     C                     SETON                     U7U8LR
     C*********************OPEN FT0580P2                                  S01194
     C*********************WRITEFT580P2F                                  S01194
     C*********************CLOSEFT0580P2                                  S01194
     C                     OPEN FT0580AU                                  S01194
     C                     WRITEFT580AUF                                  S01194
     C                     CLOSEFT0580AU                                  S01194
     C                     DUMP
     C                     RETRN
     C                     END                             E001
     C* CHAIN TO OTPAYDD FOR UPDATE
     C           PREF      CHAINOTPAYDDF             88
     C   88                DO                              B001
     C           *LOCK     IN   *NAMVAR
     C                     MOVE 'FT0580  'DBPGM            ***************
     C*********************MOVE 'OTPAY'   DBFILE           * DB ERROR 06 *S01194
     C                     MOVEL'OTPAY'   DBFILE           ***************S01194
     C                     Z-ADD6         DBASE            ***************
     C                     MOVE *BLANK    DBKEY
     C                     MOVELPREF      DBKEY
     C                     OUT  *NAMVAR
     C                     SETON                     U7U8LR
     C*********************OPEN FT0580P2                                  S01194
     C*********************WRITEFT580P2F                                  S01194
     C*********************CLOSEFT0580P2                                  S01194
     C                     OPEN FT0580AU                                  S01194
     C                     WRITEFT580AUF                                  S01194
     C                     CLOSEFT0580AU                                  S01194
     C                     DUMP
     C                     RETRN
     C                     END                             E001
      *                                                                   S01522
     C                     ELSE                            UDC            S01522
      *                                                                   S01522
      ** Print type/Print Sub-Type                                        S01522
     C           PYTP      IFEQ 'CP'                       CQPACDD        S01522
      *                                                                   S01522
     C                     SELEC                           *SL            S01522
     C           STMT      WHEQ 12                                        S01522
     C                     MOVEL#TEXT1    ##PTYP                          S01522
     C                     MOVEL#TEXT4    ##PSTP                          S01522
     C           STMT      WHEQ 13                                        S01522
     C                     MOVEL#TEXT2    ##PTYP                          S01522
     C                     MOVEL#TEXT4    ##PSTP                          S01522
     C                     ENDSL                                          S01522
      *                                                                   S01522
     C                     ELSE                            OTPAYDD        S01522
      *                                                                   S01522
     C                     SELEC                           *SL            S01522
     C           STMT      WHEQ 12                                        S01522
     C                     MOVEL#TEXT1    ##PTYP                          S01522
     C                     MOVEL#TEXT3    ##PSTP                          S01522
     C           STMT      WHEQ 13                                        S01522
     C                     MOVEL#TEXT2    ##PTYP                          S01522
     C                     MOVEL#TEXT3    ##PSTP                          S01522
     C                     ENDSL                                          S01522
      *                                                                   S01522
     C                     ENDIF                                          S01522
      *                                                                   S01522
      ** File containing Document Data                                    S01522
     C           STYPE     IFEQ 'B'                                       S01522
     C                     MOVEL'CQDUEBB' ##FILE                          S01522
     C                     ELSE                                           S01522
     C                     MOVEL'CQDUEOB' ##FILE                          S01522
     C                     ENDIF                                          S01522
      *                                                                   S01522
      ** Branch                                                           S01522
     C                     MOVELBRCA      ##BRCA                          S01522
      *                                                                   S01522
      ** Payment Type                                                     S01522
     C                     MOVELPYTP      ##PYTP                          S01522
      *                                                                   S01522
      ** Payment Reference                                                S01522
     C                     MOVELPREF      ##PREF                          S01522
      *                                                                   S01522
      ** Cheque number                                                    S01522
     C                     Z-ADDCQNM      ##CQNM                          S01522
      *                                                                   S01522
      ** Call User Defined Extract Driver.                                S01522
     C                     CALL 'CG4990'                                  S01522
     C                     PARM           W0RTN   7                       S01522
     C                     PARM           DSPARM                          S01522
      *                                                                   S01522
     C           W0RTN     IFNE *BLANKS                                   S01522
     C           *LOCK     IN   *NAMVAR                                   S01522
     C                     MOVE 'FT0580  'DBPGM            ***************S01522
     C                     MOVEL'CG4990  'DBFILE           * DB ERROR 21  S01522
     C                     Z-ADD22        DBASE            ***************S01522
     C                     MOVE *BLANK    DBKEY                           S01522
     C                     MOVEL'OTCQ'    DBKEY                           S01522
     C                     OUT  *NAMVAR                                   S01522
     C                     SETON                     U7U8LR               S01522
     C                     OPEN FT0580AU                                  S01522
     C                     WRITEFT580AUF                                  S01522
     C                     CLOSEFT0580AU                                  S01522
     C                     DUMP                                           S01522
     C                     RETRN                                          S01522
     C                     ENDIF                                          S01522
      *                                                                   S01522
      ** CHAIN to OTPAYDDF for later update.                              S01522
     C           PREF      CHAINOTPAYDDF             88                   S01522
     C                     MOVE *BLANKS   MSGDTA                          S01522
     C                     MOVEL##RECU    MSGDTA                          S01522
      *                                                                   S01522
     C                     ENDIF                                          S01522
     C* MOVE 'P' TO CHEQUE INDICATOR
     C                     MOVE 'P'       CQIN
     C* UPDATE FILE
     C                     UPDATOTPAYDDF
     C                     TIME           TIM              FOR COMIT
     C                     MOVE TIM       TRANS            FOR COMIT
     C/COPY WNCPYSRC,FT0580C101                                                               CFT118
      **                                                                                      CSC022
      ** Execute commit if SAR CSC022 is not enrolled or                                      CSC022
      **   job is not currently running in batch mode                                         CSC022
      **                                                                                      CSC022
     C           CSC022    IFEQ 'N'                                                           CSC022
     C           CSC022    OREQ 'Y'                                                           CSC022
     C           WCRSKP    ANDEQ'N'                                                           CSC022
     C           COMBOU    COMIT
     C                     ENDIF                                                              CSC022
      *                                                                   120189
      * Prompt for immediates if UDC installed                            120189
      *                                                                   120189
     C           *IN37     IFEQ *ON                                       120189
     C                     CALL 'CGC5217'                                 120189
     C                     PARM *BLANKS   U#RTN   7                       120189
     C                     ENDIF                                          120189
      *                                                                   120189
     C* MOVE AMOUNT TO FIELD FOR HASH TOTALING
     C           ADDC      IFNE 'A'                        B001
     C***********CDRO      ANDEQ0                                                             CSD027
     C           CDRO      ANDEQ*BLANKS                                                       CSD027
     C                     SUB  TRCM      PYAM
     C                     SUB  TXCH      PYAM
     C                     SUB  CQCH      PYAM
     C                     SUB  CSTA      PYAM
     C                     SUB  SPCH      PYAM
     C                     SUB  MSCH      PYAM
     C                     END                             E001
     C                     Z-ADDPYAM      VAL
     C                     ENDSR
     C*
     C************************************************************
     C* END OF OTGOING PAYMENTS CHEQUE PRINT SUBROUTINE
     C************************************************************
     C************************************************************
     C/EJECT
     C************************************************************
     ** RETREIVES ORDERING & BENEFICIARY CUSTOMER & RECEIVING BANK
     C           @OTCQ     BEGSR
     C* GET ORDERING CUSTOMER NAME AND ADDRESS
     C           1         SUBSTORC1:1    WSLSH   1                                           CFT032
     C           WSLSH     IFEQ '/'                                                           CFT032
     C                     SELEC                                                              CFT032
     C           ORCT      WHEQ 'P'                                                           CFT032
     C           ORCT      OREQ 'R'                                                           CFT032
     C           34        SUBSTORC1:2    WORC   34                                           CFT032
     C                     MOVELWORC      INAD1                                               CFT032
     C                     MOVE ORC2      INAD2                                               CFT032
     C                     MOVE ORC3      INAD3                                               CFT032
     C                     MOVE ORC4      INAD4                                               CFT032
     C                     MOVE ORC5      INAD5                                               CFT032
     C           ORCT      WHEQ 'A'                                                           CFT032
     C                     MOVE ORC2      INAD1                                               CFT032
     C                     MOVE ORC3      INAD2                                               CFT032
     C                     MOVE ORC4      INAD3                                               CFT032
     C                     MOVE ORC5      INAD4                                               CFT032
     C                     MOVE *BLANKS   INAD5                                               CFT032
     C                     ENDSL                                                              CFT032
      *                                                                                       CFT032
     C                     ELSE                                                               CFT032
     C           ORCT      IFEQ 'I'                                                           CFT032
     C                     MOVELORC1      WORC                                                CFT032
     C           '/'       CAT  WORC      INAD1                                               CFT032
     C                     ELSE                                                               CFT032
     C                     MOVE ORC1      INAD1
     C                     ENDIF                                                              CFT032
     C                     MOVE ORC2      INAD2
     C                     MOVE ORC3      INAD3
     C                     MOVE ORC4      INAD4
     C**********           MOVE *BLANK    INAD5                                               CFT032
     C                     MOVE ORC5      INAD5                                               CFT032
     C                     ENDIF                                                              CFT032
      *                                                                                       CFT032
     C                     MOVE SMCY      ADCCY   3
     C                     MOVE ORCT      ATYPE   1
     C                     EXSR ADRES
     C                     MOVE ADDRS     ORCA
     C* GET BENEFICIARY CUSTOMER NAME AND ADDRESS
     C                     MOVE BNC1      INAD1
     C                     MOVE BNC2      INAD2
     C                     MOVE BNC3      INAD3
     C                     MOVE BNC4      INAD4
     C                     MOVE BNC5      INAD5
     C                     MOVE PCCY      ADCCY
     C                     MOVE BNCT      ATYPE
     C                     EXSR ADRES
     C                     MOVE ADDRS     BNCA
     C* GET RECEIVING BANK'S NAME AND ADDRESS
     C                     MOVE DST1      INAD1
     C                     MOVE DST2      INAD2
     C                     MOVE DST3      INAD3
     C                     MOVE DST4      INAD4
     C                     MOVE *BLANK    INAD5
     C                     MOVE PCCY      ADCCY
     C                     MOVE DSTT      ATYPE
     C/COPY WNCPYSRC,FT0580C066
     C                     EXSR ADRES
     C/COPY WNCPYSRC,FT0580C067
     C                     MOVE ADDRS     RCBA
     C                     ENDSR
     C************************************************************
     C* END OF SUBROUTINE
     C************************************************************
     **
     C************************************************************
     C/EJECT
     C************************************************************
     C* PYCQ SR.
     C*
     C* PRINTS CHEQUES FOR CHEQUES FOR PAYMENT FILE
     C*
     C* PERFORMED FROM       - PRINT
     C*
     C* PERFORMS SUBROUTINES - ADRES
     C*                        NUMBER
     C*                        DATE
     C*
     C           PYCQ      BEGSR
      *                                                                   S01522
      ** If not User Defined Correspondence.                              S01522
     C           *IN37     IFEQ *OFF                                      S01522
      *                                                                   S01522
     C* IF PRINT FILE NOT OPEN OPEN
     C           CQTP      IFEQ 'O'
     C  N26                DO                              B001
     C/COPY WNCPYSRC,FT0580C028
     C                     OPEN FT0580P1
     C/COPY WNCPYSRC,FT0580C029
     C                     SETON                     26
     C                     END                             E001
     C                     END
     C                     SETOF                     59
     C                     MOVE *OFF      *IN73                           CFT006
     C                     MOVE *OFF      *IN74                           CFT006
     C*                                                                   S01117
     C* READ TABLETR FOR INTERNAL CUSTOMER NUMBER                         S01117
     C*                                                                   S01117
     C                     MOVE *BLANK    KEY                             S01117
     C                     MOVEL'10'      KEY                             S01117
     C                     MOVE BRCA      KEY                             S01117
     C           KEY       CHAINTABLETRF             88                   S01117
     C           *IN88     IFEQ '0'                                       S01117
     C           RECI      COMP 'D'                  8888                 S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C           *IN88     IFEQ '1'                        B001           S01117
     C           *LOCK     IN   *NAMVAR                                   S01117
     C                     MOVE 'FT0580  'DBPGM            ***************S01117
     C                     MOVEL'TABLETR' DBFILE           * DB ERROR 02 *S01117
     C                     Z-ADD2         DBASE            ***************S01117
     C                     MOVE *BLANK    DBKEY                           S01117
     C                     MOVELKEY       DBKEY                           S01117
     C                     OUT  *NAMVAR                                   S01117
     C                     SETON                     U7U8LR               S01117
     C                     OPEN FT0580AU                                  S01117
     C                     WRITEFT580AUF                                  S01117
     C                     CLOSEFT0580AU                                  S01117
     C                     DUMP                                           S01117
     C                     RETRN                                          S01117
     C                     END                             E001           S01117
     C*                                                                   S01117
     C                     MOVE *BLANK    ICNM                            S01117
     C**********           Z-ADDBICN      ICNM                                         S01117 CSD027
     C                     MOVE BICN      ICNM                                                CSD027
     C                     MOVE 'C'       ATYPE                           S01117
     C                     EXSR ADRES                                     S01117
     C*                                                                   S01117
     C* STORE NAME AND ADDRESS                                            S01117
     C*                                                                   S01117
     C                     MOVE ADDR1     BICNA1                          S01117
     C                     MOVE ADDR2     BICNA2                          S01117
     C                     MOVE ADDR3     BICNA3                          S01117
     C                     MOVE ADDR4     BICNA4                          S01117
     C*                                                                   S01117
     C* FIND SENDER'S CORRESPONDENT NAME AND ADDRESS
     C                     MOVE *BLANK    INAD
     C                     MOVELSNCO      INAD
     C                     MOVE SNCT      ATYPE
     C                     MOVE PCCY      ADCCY
     C                     EXSR ADRES
     C                     MOVE ADDRS     SNCA
     C* FIND REMITTING BANK'S NAME AND ADDRESS
     C                     MOVE RBK1      INAD1
     C                     MOVE RBK2      INAD2
     C                     MOVE RBK3      INAD3
     C                     MOVE RBK4      INAD4
     C                     MOVE *BLANK    INAD5
     C                     MOVE RBKT      ATYPE
     C                     MOVE PCCY      ADCCY
     C                     EXSR ADRES
     C                     MOVE ADDRS     RBKA
     C* IF SENDER'S CORRESPONDENT BLANK
     C           SNCA      IFEQ *BLANK                     B001
     C                     MOVE RBKA      SNBKA
     C                     MOVE RBKT      ATYPE
     C                     ELSE                            X001
     C                     MOVE SNCA      SNBKA
     C                     MOVE SNCT      ATYPE
     C                     END                             E001
     **
     **
     C           CQTP      IFEQ 'D'
     **
     C           @DRAW     IFNE SNBKA
     C           *IN50     IFEQ '0'                                       S01117
     C           SBRCA     OREQ 'ALL'                                     S01117
     C                     MOVE BRCA      TOBRCH                          S01117
     C                     END                                            S01117
     C                     MOVE PREF      TOPREF
     C                     MOVE PYTP      TOPYTP
     C                     MOVE SNBKA     @DRAW
     C                     EXSR SRNEW
     C           *IN50     IFEQ '0'                                       S01117
     C           SBRCA     OREQ 'ALL'                                     S01117
     C                     MOVE TOBRCH    FRBRCH                          S01117
     C                     END                                            S01117
     C                     MOVE TOPREF    FRPREF
     C                     MOVE TOPYTP    FRPYTP
     C                     END
     **
     C                     END
     **
     **
     C* CONVERT AMOUNT TO WORDS AND SET DECIMAL PLACES
     C                     Z-ADDPRRM      CQAM
     C                     SETOF                     2935
     C                     EXSR NUMBER
     C* FORMAT DATE
     C                     MOVE PVDTD1    INDAT
     C                     EXSR DATE
     C                     MOVE PCCY      CCY
     C/COPY WNCPYSRC,FT0580C003
     C                     WRITEFT580PF2               88
     C/COPY WNCPYSRC,FT0580C004
     C* IF WRITE FAILS
     C   88                DO                              B001
     C           *LOCK     IN   *NAMVAR
     C                     MOVE 'FT0580  'DBPGM            ***************
     C*********************MOVE 'PRINT'   DBFILE           * DB ERROR 07 *S01194
     C                     MOVEL'PRINT'   DBFILE           ***************S01194
     C                     Z-ADD7         DBASE            ***************
     C                     MOVE *BLANK    DBKEY
     C                     MOVEL'I'       DBKEY
     C                     OUT  *NAMVAR
     C                     SETON                     U7U8LR
     C*********************OPEN FT0580P2                                  S01194
     C*********************WRITEFT580P2F                                  S01194
     C*********************CLOSEFT0580P2                                  S01194
     C                     OPEN FT0580AU                                  S01194
     C                     WRITEFT580AUF                                  S01194
     C                     CLOSEFT0580AU                                  S01194
     C                     DUMP
     C                     RETRN
     C                     END                             E001
     C* CHAIN TO CQPACDD FOR UPDATE
     C           CKEY      CHAINCQPACDDF             88
     C   88                DO                              B001
     C           *LOCK     IN   *NAMVAR
     C                     MOVE 'FT0580'  DBPGM            ***************
     C*********************MOVE 'CQPAC'   DBFILE           * DB ERROR 08 *S01194
     C                     MOVEL'CQPAC'   DBFILE           ***************S01194
     C                     Z-ADD8         DBASE            ***************
     C                     MOVE *BLANK    DBKEY
     C                     MOVELPREF      DBKEY
     C                     OUT  *NAMVAR
     C                     SETON                     U7U8LR
     C*********************OPEN FT0580P2                                  S01194
     C*********************WRITEFT580P2F                                  S01194
     C*********************CLOSEFT0580P2                                  S01194
     C                     OPEN FT0580AU                                  S01194
     C                     WRITEFT580AUF                                  S01194
     C                     CLOSEFT0580AU                                  S01194
     C                     DUMP
     C                     RETRN
     C                     END                             E001
      *                                                                   S01522
     C                     ELSE                            UDC            S01522
      *                                                                   S01522
      ** Print type/Print Sub-Type                                        S01522
     C           PYTP      IFEQ 'CP'                       CQPACDD        S01522
      *                                                                   S01522
     C                     SELEC                           *SL            S01522
     C           STMT      WHEQ 12                                        S01522
     C                     MOVEL#TEXT1    ##PTYP                          S01522
     C                     MOVEL#TEXT4    ##PSTP                          S01522
     C           STMT      WHEQ 13                                        S01522
     C                     MOVEL#TEXT2    ##PTYP                          S01522
     C                     MOVEL#TEXT4    ##PSTP                          S01522
     C                     ENDSL                                          S01522
      *                                                                   S01522
     C                     ELSE                            OTPAYDD        S01522
      *                                                                   S01522
     C                     SELEC                           *SL            S01522
     C           STMT      WHEQ 12                                        S01522
     C                     MOVEL#TEXT1    ##PTYP                          S01522
     C                     MOVEL#TEXT3    ##PSTP                          S01522
     C           STMT      WHEQ 13                                        S01522
     C                     MOVEL#TEXT2    ##PTYP                          S01522
     C                     MOVEL#TEXT3    ##PSTP                          S01522
     C                     ENDSL                                          S01522
      *                                                                   S01522
     C                     ENDIF                                          S01522
      *                                                                   S01522
      ** File containing Document Data                                    S01522
     C           STYPE     IFEQ 'B'                                       S01522
     C                     MOVEL'CQDUEBB' ##FILE                          S01522
     C                     ELSE                                           S01522
     C                     MOVEL'CQDUEOB' ##FILE                          S01522
     C                     ENDIF                                          S01522
      *                                                                   S01522
      ** Branch                                                           S01522
     C                     MOVELBRCA      ##BRCA                          S01522
      *                                                                   S01522
      ** Payment Type                                                     S01522
     C                     MOVELPYTP      ##PYTP                          S01522
      *                                                                   S01522
      ** Payment Reference                                                S01522
     C                     MOVELPREF      ##PREF                          S01522
      *                                                                   S01522
      ** Cheque number                                                    S01522
     C                     Z-ADDCQNM      ##CQNM                          S01522
      *                                                                   S01522
      ** Call User Defined Extract Driver.                                S01522
     C                     CALL 'CG4990'                                  S01522
     C                     PARM           W0RTN   7                       S01522
     C                     PARM           DSPARM                          S01522
      *                                                                   S01522
     C           W0RTN     IFNE *BLANKS                                   S01522
     C           *LOCK     IN   *NAMVAR                                   S01522
     C                     MOVE 'FT0580  'DBPGM            ***************S01522
     C                     MOVEL'CG4990  'DBFILE           * DB ERROR 21  S01522
     C                     Z-ADD21        DBASE            ***************S01522
     C                     MOVE *BLANK    DBKEY                           S01522
     C                     MOVEL'PYCQ'    DBKEY                           S01522
     C                     OUT  *NAMVAR                                   S01522
     C                     SETON                     U7U8LR               S01522
     C                     OPEN FT0580AU                                  S01522
     C                     WRITEFT580AUF                                  S01522
     C                     CLOSEFT0580AU                                  S01522
     C                     DUMP                                           S01522
     C                     RETRN                                          S01522
     C                     ENDIF                                          S01522
      *                                                                   S01522
      * CHAIN to CQPACDD for update                                       S01522
     C           CKEY      CHAINCQPACDDF             88                   S01522
     C                     MOVE *BLANKS   MSGDTA                          S01522
     C                     MOVEL##RECU    MSGDTA                          S01522
      *                                                                   S01522
     C                     ENDIF                                          S01522
     C* MOVE 'P' TO CHEQUE INDICATOR
     C                     MOVE 'P'       CQIN
     C* UPDATE
     C                     UPDATCQPACDDF
     C                     TIME           TIM              FOR COMIT
     C                     MOVE TIM       TRANS            FOR COMIT
      **                                                                                      CSC022
      ** Execute commit if SAR CSC022 is not enrolled or                                      CSC022
      **   job is not currently running in batch mode                                         CSC022
      **                                                                                      CSC022
     C           CSC022    IFEQ 'N'                                                           CSC022
     C           CSC022    OREQ 'Y'                                                           CSC022
     C           WCRSKP    ANDEQ'N'                                                           CSC022
     C           COMBOU    COMIT
     C                     ENDIF                                                              CSC022
      *                                                                   120189
      * Prompt for immediates if UDC installed                            120189
      *                                                                   120189
     C           *IN37     IFEQ *ON                                       120189
     C                     CALL 'CGC5217'                                 120189
     C                     PARM *BLANKS   U#RTN   7                       120189
     C                     ENDIF                                          120189
      *                                                                   120189
     C                     Z-ADDPRRM      VAL    130
     C                     ENDSR
     C*
     C************************************************************
     C* END OF CHEQUES FOR PAYMENT CHEQUE PRINT SUBROUTINE
     C************************************************************
     C************************************************************
     C/EJECT
     C************************************************************
     ** RETREIVE SENDERS CORRESPONDENT OR REMITTING BANKS NAME & ADDRES
     C           @PYCQ     BEGSR
     C* FIND SENDER'S CORRESPONDENT NAME AND ADDRESS
     C                     MOVE *BLANK    INAD
     C                     MOVELSNCO      INAD
     C                     MOVE SNCT      ATYPE
     C                     MOVE PCCY      ADCCY
     C                     EXSR ADRES
     C                     MOVE ADDRS     SNCA
     C* FIND REMITTING BANK'S NAME AND ADDRESS
     C                     MOVE RBK1      INAD1
     C                     MOVE RBK2      INAD2
     C                     MOVE RBK3      INAD3
     C                     MOVE RBK4      INAD4
     C                     MOVE *BLANK    INAD5
     C                     MOVE RBKT      ATYPE
     C                     MOVE PCCY      ADCCY
     C                     EXSR ADRES
     C                     MOVE ADDRS     RBKA
     C* IF SENDER'S CORRESPONDENT BLANK
     C           SNCA      IFEQ *BLANK                     B001
     C                     MOVE RBKA      SNBKA
     C                     MOVE RBKT      ATYPE
     C                     ELSE                            X001
     C                     MOVE SNCA      SNBKA
     C                     MOVE SNCT      ATYPE
     C                     END                             E001
     C                     ENDSR
     C************************************************************
     C* END OF SUBROUTINE
     C************************************************************
     C/EJECT                                                              CFT006
     C************************************************************        CFT006
     C* RFTCQ SR.                                                         CFT006
     C*                                                                   CFT006
     C* PRINTS CHEQUES FOR RFT                                            CFT006
     C*                                                                   CFT006
     C* PERFORMED FROM       - PRINT                                      CFT006
     C*                                                                   CFT006
     C* PERFORMS SUBROUTINES - ADRES                                      CFT006
     C*                        NUMBER                                     CFT006
     C*                        DATE                                       CFT006
     C*                                                                   CFT006
     C           RFTCQ     BEGSR                                          CFT006
      *                                                                   CFT006
      ** If not User Defined Correspondence.                              CFT006
      *                                                                   CFT006
     C           *IN37     IFEQ *OFF                                      CFT006
      *                                                                   CFT006
     C* IF PRINT FILE NOT OPEN OPEN                                       CFT006
      *                                                                   CFT006
     C           *IN26     IFEQ *OFF                                      CFT006
     C/COPY WNCPYSRC,FT0580C057
     C                     OPEN FT0580P1                                  CFT006
     C/COPY WNCPYSRC,FT0580C058
     C                     MOVE *ON       *IN26                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C* GET ORDERING CUSTOMER NAME AND ADDRESS                            CFT006
      *                                                                   CFT006
     C                     MOVE *ON       *IN73                           CFT006
     C                     MOVE *OFF      *IN74                           CFT006
      *                                                                   CFT006
     C           HOCUS1    IFEQ *BLANKS                                   CFT006
     C           '/'       SCAN TOCUS1                   63               CFT006
      *                                                                   CFT006
     C           *IN63     IFEQ *ON                                       CFT006
     C                     SUBSTTOCUS1:2  INAD1     P                     CFT006
     C                     ELSE                                           CFT006
     C                     MOVE TOCUS1    INAD1                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     MOVE TOCUS2    INAD2                           CFT006
     C                     MOVE TOCUS3    INAD3                           CFT006
     C                     MOVE TOCUS4    INAD4                           CFT006
     C                     MOVE TOCUS5    INAD5                           CFT006
      *                                                                   CFT006
     C           PYTP      IFEQ 'RO'                                      CFT006
     C                     MOVE TRNCCY    ADCCY   3                       CFT006
     C                     ELSE                                           CFT006
     C                     MOVE PAYCCY    ADCCY                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     MOVE DCUSTP    ATYPE   1                       CFT006
      *                                                                   CFT006
     C                     ELSE                                           CFT006
     C           '/'       SCAN HOCUS1                   63               CFT006
      *                                                                   CFT006
     C           *IN63     IFEQ *ON                                       CFT006
     C                     SUBSTHOCUS1:2  INAD1     P                     CFT006
     C                     ELSE                                           CFT006
     C                     MOVE HOCUS1    INAD1                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     MOVE HOCUS2    INAD2                           CFT006
     C                     MOVE HOCUS3    INAD3                           CFT006
     C                     MOVE HOCUS4    INAD4                           CFT006
     C                     MOVE HOCUS5    INAD5                           CFT006
      *                                                                   CFT006
     C           PYTP      IFEQ 'RO'                                      CFT006
     C                     MOVE TRNCCY    ADCCY                           CFT006
     C                     ELSE                                           CFT006
     C                     MOVE PAYCCY    ADCCY                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     MOVE CUSTTP    ATYPE   1                       CFT006
      *                                                                   CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C           DCUSTP    IFEQ 'G'                                       CFT006
     C           CUSTTP    OREQ 'G'                                       CFT006
     C                     MOVELINAD1     NGLACT                          CFT006
     C                     MOVE NGLBRH    OGLBRH                          CFT006
     C                     MOVE NGLCNM    OGLCNM                          CFT006
     C                     MOVE NGLACD    OGLACD                          CFT006
     C                     MOVE NGLCCY    OGLCCY                          CFT006
     C                     MOVE NGLSEQ    OGLSEQ                          CFT006
     C                     MOVELOGLACT    INAD1                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     EXSR ADRES                                     CFT006
      *                                                                   CFT006
     C           ADDRS     IFEQ *BLANKS                                   CFT006
     C                     MOVE INAD1     ORCA1                           CFT006
     C                     MOVE INAD2     ORCA2                           CFT006
     C                     MOVE INAD3     ORCA3                           CFT006
     C                     MOVE INAD4     ORCA4                           CFT006
     C                     MOVE INAD5     ORCA5                           CFT006
     C                     ELSE                                           CFT006
     C                     MOVE ADDRS     ORCA                            CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C* GET BENEFICIARY CUSTOMER NAME AND ADDRESS                         CFT006
      *                                                                   CFT006
     C           '/'       SCAN TBNA35                   63               CFT006
      *                                                                   CFT006
     C           *IN63     IFEQ *ON                                       CFT006
     C                     SUBSTTBNA35:2  INAD1     P                     CFT006
     C                     ELSE                                           CFT006
     C                     MOVE TBNA35    INAD1                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     MOVE TBNB35    INAD2                           CFT006
     C                     MOVE TBNC35    INAD3                           CFT006
     C                     MOVE TBND35    INAD4                           CFT006
     C                     MOVE TBNE35    INAD5                           CFT006
      *                                                                   CFT006
     C           PYTP      IFEQ 'RO'                                      CFT006
     C                     MOVE TRNCCY    ADCCY                           CFT006
     C                     ELSE                                           CFT006
     C                     MOVE PAYCCY    ADCCY                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     MOVE BENTTP    ATYPE                           CFT006
      *                                                                   CFT006
     C           BENTTP    IFEQ 'G'                                       CFT006
     C                     MOVELINAD1     NGLACT                          CFT006
     C                     MOVE NGLBRH    OGLBRH                          CFT006
     C                     MOVE NGLCNM    OGLCNM                          CFT006
     C                     MOVE NGLACD    OGLACD                          CFT006
     C                     MOVE NGLCCY    OGLCCY                          CFT006
     C                     MOVE NGLSEQ    OGLSEQ                          CFT006
     C                     MOVELOGLACT    INAD1                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     EXSR ADRES                                     CFT006
      *                                                                   CFT006
     C           ADDRS     IFEQ *BLANKS                                   CFT006
     C                     MOVE INAD1     BNCA1                           CFT006
     C                     MOVE TBNB35    BNCA2                           CFT006
     C                     MOVE TBNC35    BNCA3                           CFT006
     C                     MOVE TBND35    BNCA4                           CFT006
     C                     MOVE TBNE35    BNCA5                           CFT006
     C                     ELSE                                           CFT006
     C                     MOVE ADDRS     BNCA                            CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C* GET RECEIVING BANK'S NAME AND ADDRESS                             CFT006
      *                                                                   CFT006
     C           '/'       SCAN TACA35                   63               CFT006
      *                                                                   CFT006
     C           *IN63     IFEQ *ON                                       CFT006
     C           '/'       SCAN TACA35:2                 63               CFT006
      *                                                                   CFT006
     C           *IN63     IFEQ *ON                                       CFT006
     C                     MOVE TACA35    INAD1                           CFT006
     C                     ELSE                                           CFT006
     C                     SUBSTTACA35:2  INAD1     P                     CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ELSE                                           CFT006
     C                     MOVE TACA35    INAD1                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     MOVE TACB35    INAD2                           CFT006
     C                     MOVE TACC35    INAD3                           CFT006
     C                     MOVE TACD35    INAD4                           CFT006
     C                     MOVE TACE35    INAD5                           CFT006
      *                                                                   CFT006
     C           PYTP      IFEQ 'RO'                                      CFT006
     C                     MOVE TRNCCY    ADCCY                           CFT006
     C                     ELSE                                           CFT006
     C                     MOVE PAYCCY    ADCCY                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     MOVE AWITTP    ATYPE                           CFT006
      *                                                                   CFT006
     C           AWITTP    IFEQ 'G'                                       CFT006
     C                     MOVELINAD1     NGLACT                          CFT006
     C                     MOVE NGLBRH    OGLBRH                          CFT006
     C                     MOVE NGLCNM    OGLCNM                          CFT006
     C                     MOVE NGLACD    OGLACD                          CFT006
     C                     MOVE NGLCCY    OGLCCY                          CFT006
     C                     MOVE NGLSEQ    OGLSEQ                          CFT006
     C                     MOVELOGLACT    INAD1                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     EXSR ADRES                                     CFT006
     C                     MOVE ADDRS     RCBA                            CFT006
      *                                                                   CFT006
     C           CQTP      IFEQ 'D'                                       CFT006
     **                                                                   CFT006
     C           @DRAW     IFNE RCBA                                      CFT006
      *                                                                   CFT006
     C           *IN50     IFEQ *OFF                                      CFT006
     C           SBRCA     OREQ 'ALL'                                     CFT006
     C                     MOVE BRCA      TOBRCH                          CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     MOVE RFTID     TOPREF                          CFT006
     C                     MOVE PYTP      TOPYTP                          CFT006
     C                     MOVE RCBA      @DRAW 175                       CFT006
      *                                                                   CFT006
     C                     EXSR SRNEW                                     CFT006
      *                                                                   CFT006
     C           *IN50     IFEQ *OFF                                      CFT006
     C           SBRCA     OREQ 'ALL'                                     CFT006
     C                     MOVE TOBRCH    FRBRCH                          CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     MOVE TOPREF    FRPREF                          CFT006
     C                     MOVE TOPYTP    FRPYTP                          CFT006
     C                     ENDIF                                          CFT006
     **                                                                   CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C           PYTP      IFEQ 'RO'                                      CFT006
     C                     Z-ADDTRNAMT    CQAM                            CFT006
     C                     ELSE                                           CFT006
     C                     Z-ADDPAYAMT    CQAM                            CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C* CONVERT CHEQUE AMOUNT TO WORDS AND SET DECIMAL PLACES             CFT006
      *                                                                   CFT006
     C                     MOVE *OFF      *IN29                           CFT006
     C                     MOVE *OFF      *IN35                           CFT006
     C                     EXSR NUMBER                                    CFT006
      *                                                                   CFT006
     C* FORMAT DATE                                                       CFT006
      *                                                                   CFT006
     C                     Z-ADDDBTVDT    ZDAYNO                          CFT006
     C                     EXSR ZDATE2                                    CFT006
     C                     MOVE ZADATE    OTDAT                           CFT006
      *                                                                   CFT006
     C           PYTP      IFEQ 'RO'                                      CFT006
     C                     MOVE TRNCCY    CCY                             CFT006
     C                     ELSE                                           CFT006
     C                     MOVE PAYCCY    CCY                             CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     MOVE RFTID     PREF                            CFT006
     C                     MOVE TRMA35    DTP1                            CFT006
     C                     MOVE TRMB35    DTP2                            CFT006
     C                     MOVE TRMC35    DTP3                            CFT006
     C                     MOVE TRMD35    DTP4                            CFT006
     C*                                                                   CFT006
     C/COPY WNCPYSRC,FTH00112
     C                     WRITEFT580PF1               88                 CFT006
     C/COPY WNCPYSRC,FTH00113
     C*                                                                   CFT006
     C* IF WRITE FAILS                                                    CFT006
      *                                                                   CFT006
     C           *IN88     IFEQ *ON                                       CFT006
     C           *LOCK     IN   *NAMVAR                                   CFT006
     C                     MOVE 'FT0580  'DBPGM            ***************CFT006
     C                     MOVEL'PRINT'   DBFILE           * DB ERROR 23 *CFT006
     C                     Z-ADD23        DBASE            ***************CFT006
     C                     MOVE *BLANK    DBKEY                           CFT006
     C                     MOVEL'1'       DBKEY                           CFT006
     C                     OUT  *NAMVAR                                   CFT006
     C                     SETON                     U7U8LR               CFT006
     C                     OPEN FT0580AU                                  CFT006
     C                     WRITEFT580AUF                                  CFT006
     C                     CLOSEFT0580AU                                  CFT006
     C                     DUMP                                           CFT006
     C                     RETRN                                          CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C* CHAIN TO FT101DL0 FOR UPDATE                                      CFT006
      *                                                                   CFT006
     C           RFTK      KLIST                                          CFT006
     C                     KFLD           RFTID                           CFT006
     C                     KFLD           TRNSID                          CFT006
      *                                                                   CFT006
     C           RFTK      CHAINFT101DD0             75                   CFT006
      *                                                                   CFT006
     C           *IN75     IFEQ *ON                                       CFT006
     C           *LOCK     IN   *NAMVAR                                   CFT006
     C                     MOVE 'FT0580  'DBPGM            ***************CFT006
     C                     MOVEL'FT101DL0'DBFILE           * DB ERROR 24 *CFT006
     C                     Z-ADD24        DBASE            ***************CFT006
     C                     MOVE *BLANK    DBKEY                           CFT006
     C                     MOVELRFTID     DBKEY                           CFT006
     C                     OUT  *NAMVAR                                   CFT006
     C                     SETON                     U7U8LR               CFT006
     C                     OPEN FT0580AU                                  CFT006
     C                     WRITEFT580AUF                                  CFT006
     C                     CLOSEFT0580AU                                  CFT006
     C                     DUMP                                           CFT006
     C                     RETRN                                          CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ELSE                                           CFT006
      *                                                                   CFT006
      ** Print type/Print Sub-Type                                        CFT006
      *                                                                   CFT006
     C                     MOVEL#TEXT1    ##PTYP                          CFT006
     C                     MOVEL#TEXT5    ##PSTP                          CFT006
      *                                                                   CFT006
      ** File containing Document Data                                    CFT006
      *                                                                   CFT006
     C           STYPE     IFEQ 'B'                                       CFT006
     C                     MOVEL'@101HJ0' ##FILE                          CFT006
     C                     ELSE                                           CFT006
     C                     MOVEL'@101HJ1' ##FILE                          CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      ** Branch                                                           CFT006
      *                                                                   CFT006
     C                     MOVELBRCA      ##BRCA                          CFT006
      *                                                                   CFT006
      ** Payment Type                                                     CFT006
      *                                                                   CFT006
     C                     MOVELPYTP      ##PYTP                          CFT006
      *                                                                   CFT006
      ** Payment Reference                                                CFT006
      *                                                                   CFT006
     C                     MOVELRFTID     ##PREF                          CFT006
      *                                                                   CFT006
      ** Cheque number                                                    CFT006
      *                                                                   CFT006
     C                     Z-ADDCQNM      ##CQNM                          CFT006
      *                                                                   CFT006
      ** Call User Defined Extract Driver.                                CFT006
      *                                                                   CFT006
     C                     CALL 'CG4990'                                  CFT006
     C                     PARM           W0RTN   7                       CFT006
     C                     PARM           DSPARM                          CFT006
      *                                                                   CFT006
     C           W0RTN     IFNE *BLANKS                                   CFT006
     C           *LOCK     IN   *NAMVAR                                   CFT006
     C                     MOVE 'FT0580  'DBPGM            ***************CFT006
     C                     MOVEL'CG4990  'DBFILE           * DB ERROR 25  CFT006
     C                     Z-ADD25        DBASE            ***************CFT006
     C                     MOVE *BLANK    DBKEY                           CFT006
     C                     MOVEL'RFTCQ'   DBKEY                           CFT006
     C                     OUT  *NAMVAR                                   CFT006
     C                     SETON                     U7U8LR               CFT006
     C                     OPEN FT0580AU                                  CFT006
     C                     WRITEFT580AUF                                  CFT006
     C                     CLOSEFT0580AU                                  CFT006
     C                     DUMP                                           CFT006
     C                     RETRN                                          CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      ** CHAIN to FT101DL0 for later update.                              CFT006
      *                                                                   CFT006
     C           RFTK      CHAINFT101DD0             75                   CFT006
      *                                                                   CFT006
     C                     MOVE *BLANKS   MSGDTA                          CFT006
     C                     MOVEL##RECU    MSGDTA                          CFT006
      *                                                                   CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C* MOVE 'P' TO CHEQUE INDICATOR                                      CFT006
      *                                                                   CFT006
     C                     MOVE 'P'       DCQIN                           CFT006
      *                                                                   CFT006
     C* UPDATE FILE                                                       CFT006
      *                                                                   CFT006
     C                     UPDATFT101DD0                                  CFT006
      *                                                                   CFT006
     C                     TIME           TIM              FOR COMIT      CFT006
     C                     MOVE TIM       TRANS            FOR COMIT      CFT006
      **                                                                                      CSC022
      ** Execute commit if SAR CSC022 is not enrolled or                                      CSC022
      **   job is not currently running in batch mode                                         CSC022
      **                                                                                      CSC022
     C           CSC022    IFEQ 'N'                                                           CSC022
     C           CSC022    OREQ 'Y'                                                           CSC022
     C           WCRSKP    ANDEQ'N'                                                           CSC022
     C           COMBOU    COMIT                                          CFT006
     C                     ENDIF                                                              CSC022
      *                                                                   CFT006
      * Prompt for immediates if UDC installed                            CFT006
      *                                                                   CFT006
     C           *IN37     IFEQ *ON                                       CFT006
     C                     CALL 'CGC5217'                                 CFT006
     C                     PARM *BLANKS   U#RTN   7                       CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C* MOVE AMOUNT TO FIELD FOR HASH TOTALING                            CFT006
      *                                                                   CFT006
     C           PYTP      IFEQ 'RO'                                      CFT006
     C                     Z-ADDTRNAMT    VAL                             CFT006
     C                     ELSE                                           CFT006
     C                     Z-ADDPAYAMT    VAL                             CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ENDSR                                          CFT006
     C*                                                                   CFT006
     C************************************************************        CFT006
     C* END OF RFT CHEQUE PRINT SUBROUTINE                                CFT006
     C************************************************************        CFT006
     C************************************************************        CFT006
     C/EJECT                                                              CFT006
     C************************************************************        CFT006
     ** RETREIVES ORDERING & BENEFICIARY CUSTOMER & RECEIVING BANK        CFT006
     C           @RFTCQ    BEGSR                                          CFT006
      *                                                                   CFT006
     C* GET ORDERING CUSTOMER NAME AND ADDRESS                            CFT006
      *                                                                   CFT006
     C           HOCUS1    IFEQ *BLANKS                                   CFT006
     C           '/'       SCAN TOCUS1                   63               CFT006
      *                                                                   CFT006
     C           *IN63     IFEQ *ON                                       CFT006
     C                     SUBSTTOCUS1:2  INAD1     P                     CFT006
     C                     ELSE                                           CFT006
     C                     MOVE TOCUS1    INAD1                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     MOVE TOCUS2    INAD2                           CFT006
     C                     MOVE TOCUS3    INAD3                           CFT006
     C                     MOVE TOCUS4    INAD4                           CFT006
     C                     MOVE TOCUS5    INAD5                           CFT006
      *                                                                   CFT006
     C           PYTP      IFEQ 'RO'                                      CFT006
     C                     MOVE TRNCCY    ADCCY                           CFT006
     C                     ELSE                                           CFT006
     C                     MOVE PAYCCY    ADCCY                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     MOVE DCUSTP    ATYPE   1                       CFT006
      *                                                                   CFT006
     C                     ELSE                                           CFT006
     C           '/'       SCAN HOCUS1                   63               CFT006
      *                                                                   CFT006
     C           *IN63     IFEQ *ON                                       CFT006
     C                     SUBSTHOCUS1:2  INAD1     P                     CFT006
     C                     ELSE                                           CFT006
     C                     MOVE HOCUS1    INAD1                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     MOVE HOCUS2    INAD2                           CFT006
     C                     MOVE HOCUS3    INAD3                           CFT006
     C                     MOVE HOCUS4    INAD4                           CFT006
     C                     MOVE HOCUS5    INAD5                           CFT006
      *                                                                   CFT006
     C           PYTP      IFEQ 'RO'                                      CFT006
     C                     MOVE TRNCCY    ADCCY                           CFT006
     C                     ELSE                                           CFT006
     C                     MOVE PAYCCY    ADCCY                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     MOVE CUSTTP    ATYPE   1                       CFT006
      *                                                                   CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C           DCUSTP    IFEQ 'G'                                       CFT006
     C           CUSTTP    OREQ 'G'                                       CFT006
     C                     MOVELINAD1     NGLACT                          CFT006
     C                     MOVE NGLBRH    OGLBRH                          CFT006
     C                     MOVE NGLCNM    OGLCNM                          CFT006
     C                     MOVE NGLACD    OGLACD                          CFT006
     C                     MOVE NGLCCY    OGLCCY                          CFT006
     C                     MOVE NGLSEQ    OGLSEQ                          CFT006
     C                     MOVELOGLACT    INAD1                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     EXSR ADRES                                     CFT006
      *                                                                   CFT006
     C           ADDRS     IFEQ *BLANKS                                   CFT006
     C                     MOVE INAD1     ORCA1                           CFT006
     C                     MOVE INAD2     ORCA2                           CFT006
     C                     MOVE INAD3     ORCA3                           CFT006
     C                     MOVE INAD4     ORCA4                           CFT006
     C                     MOVE INAD5     ORCA5                           CFT006
     C                     ELSE                                           CFT006
     C                     MOVE ADDRS     ORCA                            CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C* GET BENEFICIARY CUSTOMER NAME AND ADDRESS                         CFT006
      *                                                                   CFT006
     C           '/'       SCAN TBNA35                   63               CFT006
      *                                                                   CFT006
     C           *IN63     IFEQ *ON                                       CFT006
     C                     SUBSTTBNA35:2  INAD1     P                     CFT006
     C                     ELSE                                           CFT006
     C                     MOVE TBNA35    INAD1                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     MOVE TBNB35    INAD2                           CFT006
     C                     MOVE TBNC35    INAD3                           CFT006
     C                     MOVE TBND35    INAD4                           CFT006
     C                     MOVE TBNE35    INAD5                           CFT006
      *                                                                   CFT006
     C           PYTP      IFEQ 'RO'                                      CFT006
     C                     MOVE TRNCCY    ADCCY                           CFT006
     C                     ELSE                                           CFT006
     C                     MOVE PAYCCY    ADCCY                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     MOVE BENTTP    ATYPE                           CFT006
      *                                                                   CFT006
     C           BENTTP    IFEQ 'G'                                       CFT006
     C                     MOVELINAD1     NGLACT                          CFT006
     C                     MOVE NGLBRH    OGLBRH                          CFT006
     C                     MOVE NGLCNM    OGLCNM                          CFT006
     C                     MOVE NGLACD    OGLACD                          CFT006
     C                     MOVE NGLCCY    OGLCCY                          CFT006
     C                     MOVE NGLSEQ    OGLSEQ                          CFT006
     C                     MOVELOGLACT    INAD1                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     EXSR ADRES                                     CFT006
      *                                                                   CFT006
     C           ADDRS     IFEQ *BLANKS                                   CFT006
     C                     MOVE INAD1     BNCA1                           CFT006
     C                     MOVE TBNB35    BNCA2                           CFT006
     C                     MOVE TBNC35    BNCA3                           CFT006
     C                     MOVE TBND35    BNCA4                           CFT006
     C                     MOVE TBNE35    BNCA5                           CFT006
     C                     ELSE                                           CFT006
     C                     MOVE ADDRS     BNCA                            CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C* GET RECEIVING BANK'S NAME AND ADDRESS                             CFT006
      *                                                                   CFT006
     C           '/'       SCAN TACA35                   63               CFT006
      *                                                                   CFT006
     C           *IN63     IFEQ *ON                                       CFT006
     C           '/'       SCAN TACA35:2                 63               CFT006
      *                                                                   CFT006
     C           *IN63     IFEQ *ON                                       CFT006
     C                     MOVE TACA35    INAD1                           CFT006
     C                     ELSE                                           CFT006
     C                     SUBSTTACA35:2  INAD1     P                     CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ELSE                                           CFT006
     C                     MOVE TACA35    INAD1                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     MOVE TACB35    INAD2                           CFT006
     C                     MOVE TACC35    INAD3                           CFT006
     C                     MOVE TACD35    INAD4                           CFT006
     C                     MOVE TACE35    INAD5                           CFT006
      *                                                                   CFT006
     C           PYTP      IFEQ 'RO'                                      CFT006
     C                     MOVE TRNCCY    ADCCY                           CFT006
     C                     ELSE                                           CFT006
     C                     MOVE PAYCCY    ADCCY                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     MOVE AWITTP    ATYPE                           CFT006
      *                                                                   CFT006
     C           AWITTP    IFEQ 'G'                                       CFT006
     C                     MOVELINAD1     NGLACT                          CFT006
     C                     MOVE NGLBRH    OGLBRH                          CFT006
     C                     MOVE NGLCNM    OGLCNM                          CFT006
     C                     MOVE NGLACD    OGLACD                          CFT006
     C                     MOVE NGLCCY    OGLCCY                          CFT006
     C                     MOVE NGLSEQ    OGLSEQ                          CFT006
     C                     MOVELOGLACT    INAD1                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     EXSR ADRES                                     CFT006
     C                     MOVE ADDRS     RCBA                            CFT006
     C                     ENDSR                                          CFT006
     C************************************************************        CFT006
     C* END OF SUBROUTINE                                                 CFT006
     C************************************************************        CFT006
     C/EJECT                                                              CFT006
     C************************************************************        CFT006
     C* CCTCQ SR.                                                         CFT006
     C*                                                                   CFT006
     C* PRINTS CHEQUES FOR CCT                                            CFT006
     C*                                                                   CFT006
     C* PERFORMED FROM       - PRINT                                      CFT006
     C*                                                                   CFT006
     C* PERFORMS SUBROUTINES - ADRES                                      CFT006
     C*                        NUMBER                                     CFT006
     C*                        DATE                                       CFT006
     C*                                                                   CFT006
     C           CCTCQ     BEGSR                                          CFT006
      *                                                                   CFT006
      ** If not User Defined Correspondence.                              CFT006
      *                                                                   CFT006
     C           *IN37     IFEQ *OFF                                      CFT006
      *                                                                   CFT006
     C* IF PRINT FILE NOT OPEN OPEN                                       CFT006
      *                                                                   CFT006
     C           *IN26     IFEQ *OFF                                      CFT006
     C/COPY WNCPYSRC,FT0580C059
     C                     OPEN FT0580P1                                  CFT006
     C/COPY WNCPYSRC,FT0580C060
     C                     MOVE *ON       *IN26                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C* GET ORDERING CUSTOMER NAME AND ADDRESS                            CFT006
      *                                                                   CFT006
     C                     MOVE *OFF      *IN73                           CFT006
     C                     MOVE *ON       *IN74                           CFT006
      *                                                                   CFT006
     C           TOCUS1    IFEQ *BLANKS                                   CFT006
     C           '/'       SCAN ORDCU1                   63               CFT006
      *                                                                   CFT006
     C           *IN63     IFEQ *ON                                       CFT006
     C                     SUBSTORDCU1:2  INAD1     P                     CFT006
     C                     ELSE                                           CFT006
     C                     MOVE ORDCU1    INAD1                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     MOVE ORDCU2    INAD2                           CFT006
     C                     MOVE ORDCU3    INAD3                           CFT006
     C                     MOVE ORDCU4    INAD4                           CFT006
     C                     MOVE *BLANKS   INAD5                           CFT006
     C           CSW207    IFEQ 'Y'                                                           CSW207
     C                     MOVE ORDCU5    INAD5                                               CSW207
     C                     ENDIF                                                              CSW207
     C                     MOVE CCTCCY    ADCCY   3                       CFT006
      *                                                                   CFT006
     C                     MOVE CUSTTD    ATYPE   1                       CFT006
      *                                                                   CFT006
     C                     ELSE                                           CFT006
     C           '/'       SCAN TOCUS1                   63               CFT006
      *                                                                   CFT006
     C           *IN63     IFEQ *ON                                       CFT006
     C                     SUBSTTOCUS1:2  INAD1     P                     CFT006
     C                     ELSE                                           CFT006
     C                     MOVE TOCUS1    INAD1                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     MOVE TOCUS2    INAD2                           CFT006
     C                     MOVE TOCUS3    INAD3                           CFT006
     C                     MOVE TOCUS4    INAD4                           CFT006
     C                     MOVE *BLANKS   INAD5                           CFT006
     C           CSW207    IFEQ 'Y'                                                           CSW207
     C                     MOVE TOCUS5    INAD5                                               CSW207
     C                     ENDIF                                                              CSW207
     C                     MOVE CCTCCY    ADCCY   3                       CFT006
      *                                                                   CFT006
     C                     MOVE CUSTTH    ATYPE   1                       CFT006
      *                                                                   CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C           CUSTTD    IFEQ 'G'                                       CFT006
     C           CUSTTH    OREQ 'G'                                       CFT006
     C                     MOVELINAD1     NGLACT                          CFT006
     C                     MOVE NGLBRH    OGLBRH                          CFT006
     C                     MOVE NGLCNM    OGLCNM                          CFT006
     C                     MOVE NGLACD    OGLACD                          CFT006
     C                     MOVE NGLCCY    OGLCCY                          CFT006
     C                     MOVE NGLSEQ    OGLSEQ                          CFT006
     C                     MOVELOGLACT    INAD1                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     EXSR ADRES                                     CFT006
      *                                                                   CFT006
     C           ADDRS     IFEQ *BLANKS                                   CFT006
     C                     MOVE INAD1     ORCA1                           CFT006
     C                     MOVE INAD2     ORCA2                           CFT006
     C                     MOVE INAD3     ORCA3                           CFT006
     C                     MOVE INAD4     ORCA4                           CFT006
     C                     MOVE INAD5     ORCA5                           CFT006
     C                     ELSE                                           CFT006
     C                     MOVE ADDRS     ORCA                            CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C* GET BENEFICIARY CUSTOMER NAME AND ADDRESS                         CFT006
      *                                                                   CFT006
     C                     MOVE BENF2     BNCA1                           CFT006
     C                     MOVE BENF3     BNCA2                           CFT006
     C                     MOVE BENF4     BNCA3                           CFT006
     C                     MOVE BENF5     BNCA4                           CFT006
     C                     MOVE *BLANKS   BNCA5                           CFT006
      *                                                                   CFT006
     C* GET RECEIVING BANK'S NAME AND ADDRESS                             CFT006
      *                                                                   CFT006
     C           '/'       SCAN ACCI35                   63               CFT006
      *                                                                   CFT006
     C           *IN63     IFEQ *ON                                       CFT006
     C           '/'       SCAN ACCI35:2                 63               CFT006
      *                                                                   CFT006
     C           *IN63     IFEQ *ON                                       CFT006
     C                     MOVE ACCI35    INAD1                           CFT006
     C                     ELSE                                           CFT006
     C                     SUBSTACCI35:2  INAD1     P                     CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ELSE                                           CFT006
     C                     MOVE ACCI35    INAD1                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     MOVE *BLANKS   INAD2                           CFT006
     C                     MOVE *BLANKS   INAD3                           CFT006
     C                     MOVE *BLANKS   INAD4                           CFT006
     C                     MOVE *BLANKS   INAD5                           CFT006
     C                     MOVE PAYCCY    ADCCY                           CFT006
      *                                                                   CFT006
     C                     MOVE AWITP     ATYPE                           CFT006
      *                                                                   CFT006
     C           AWITP     IFEQ 'G'                                       CFT006
     C                     MOVELINAD1     NGLACT                          CFT006
     C                     MOVE NGLBRH    OGLBRH                          CFT006
     C                     MOVE NGLCNM    OGLCNM                          CFT006
     C                     MOVE NGLACD    OGLACD                          CFT006
     C                     MOVE NGLCCY    OGLCCY                          CFT006
     C                     MOVE NGLSEQ    OGLSEQ                          CFT006
     C                     MOVELOGLACT    INAD1                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     EXSR ADRES                                     CFT006
     C                     MOVE ADDRS     RCBA                            CFT006
      *                                                                   CFT006
     C           CQTP      IFEQ 'D'                                       CFT006
     **                                                                   CFT006
     C           @DRAW     IFNE RCBA                                      CFT006
      *                                                                   CFT006
     C           *IN50     IFEQ *OFF                                      CFT006
     C           SBRCA     OREQ 'ALL'                                     CFT006
     C                     MOVE BRCA      TOBRCH                          CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     MOVE CCTID     TOPREF                          CFT006
     C                     MOVE CCTTYP    TOPYTP                          CFT006
     C                     MOVE RCBA      @DRAW 175                       CFT006
      *                                                                   CFT006
     C                     EXSR SRNEW                                     CFT006
      *                                                                   CFT006
     C           *IN50     IFEQ *OFF                                      CFT006
     C           SBRCA     OREQ 'ALL'                                     CFT006
     C                     MOVE TOBRCH    FRBRCH                          CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     MOVE TOPREF    FRPREF                          CFT006
     C                     MOVE TOPYTP    FRPYTP                          CFT006
     C                     ENDIF                                          CFT006
     **                                                                   CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     Z-ADDPAYAMT    CQAM                            CFT006
      *                                                                   CFT006
     C* CONVERT CHEQUE AMOUNT TO WORDS AND SET DECIMAL PLACES             CFT006
      *                                                                   CFT006
     C                     MOVE *OFF      *IN29                           CFT006
     C                     MOVE *OFF      *IN35                           CFT006
     C                     EXSR NUMBER                                    CFT006
      *                                                                   CFT006
     C* FORMAT DATE                                                       CFT006
      *                                                                   CFT006
     C                     Z-ADDDBTVDT    ZDAYNO                          CFT006
     C                     EXSR ZDATE2                                    CFT006
     C                     MOVE ZADATE    OTDAT                           CFT006
     C                     MOVE PAYCCY    CCY                             CFT006
     C                     MOVE CCTID     PREF                            CFT006
     C                     MOVE REMI1     DTP1                            CFT006
     C                     MOVE REMI2     DTP2                            CFT006
     C                     MOVE REMI3     DTP3                            CFT006
     C                     MOVE REMI4     DTP4                            CFT006
     C*                                                                   CFT006
     C/COPY WNCPYSRC,FTH00114
     C                     WRITEFT580PF1               88                 CFT006
     C/COPY WNCPYSRC,FTH00115
     C*                                                                   CFT006
     C* IF WRITE FAILS                                                    CFT006
      *                                                                   CFT006
     C           *IN88     IFEQ *ON                                       CFT006
     C           *LOCK     IN   *NAMVAR                                   CFT006
     C                     MOVE 'FT0580  'DBPGM            ***************CFT006
     C                     MOVEL'PRINT'   DBFILE           * DB ERROR 26 *CFT006
     C                     Z-ADD26        DBASE            ***************CFT006
     C                     MOVE *BLANK    DBKEY                           CFT006
     C                     MOVEL'1'       DBKEY                           CFT006
     C                     OUT  *NAMVAR                                   CFT006
     C                     SETON                     U7U8LR               CFT006
     C                     OPEN FT0580AU                                  CFT006
     C                     WRITEFT580AUF                                  CFT006
     C                     CLOSEFT0580AU                                  CFT006
     C                     DUMP                                           CFT006
     C                     RETRN                                          CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C* CHAIN TO FT102DL0 FOR UPDATE                                      CFT006
      *                                                                   CFT006
     C           CCTK      KLIST                                          CFT006
     C                     KFLD           CCTID                           CFT006
     C                     KFLD           TRNSID                          CFT006
      *                                                                   CFT006
     C           CCTK      CHAINFT102DD0             76                   CFT006
      *                                                                   CFT006
     C           *IN76     IFEQ *ON                                       CFT006
     C           *LOCK     IN   *NAMVAR                                   CFT006
     C                     MOVE 'FT0580  'DBPGM            ***************CFT006
     C                     MOVEL'FT102DL0'DBFILE           * DB ERROR 27 *CFT006
     C                     Z-ADD27        DBASE            ***************CFT006
     C                     MOVE *BLANK    DBKEY                           CFT006
     C                     MOVELCCTID     DBKEY                           CFT006
     C                     OUT  *NAMVAR                                   CFT006
     C                     SETON                     U7U8LR               CFT006
     C                     OPEN FT0580AU                                  CFT006
     C                     WRITEFT580AUF                                  CFT006
     C                     CLOSEFT0580AU                                  CFT006
     C                     DUMP                                           CFT006
     C                     RETRN                                          CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ELSE                                           CFT006
      *                                                                   CFT006
      ** Print type/Print Sub-Type                                        CFT006
      *                                                                   CFT006
     C                     MOVEL#TEXT1    ##PTYP                          CFT006
     C                     MOVEL#TEXT6    ##PSTP                          CFT006
      *                                                                   CFT006
      ** File containing Document Data                                    CFT006
      *                                                                   CFT006
     C           STYPE     IFEQ 'B'                                       CFT006
     C                     MOVEL'@102HJ0' ##FILE                          CFT006
     C                     ELSE                                           CFT006
     C                     MOVEL'@102HJ1' ##FILE                          CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      ** Branch                                                           CFT006
      *                                                                   CFT006
     C                     MOVELBRCA      ##BRCA                          CFT006
      *                                                                   CFT006
      ** Payment Type                                                     CFT006
      *                                                                   CFT006
     C                     MOVELCCTTYP    ##PYTP                          CFT006
      *                                                                   CFT006
      ** Payment Reference                                                CFT006
      *                                                                   CFT006
     C                     MOVELCCTID     ##PREF                          CFT006
      *                                                                   CFT006
      ** Cheque number                                                    CFT006
      *                                                                   CFT006
     C                     Z-ADDCQNM      ##CQNM                          CFT006
      *                                                                   CFT006
      ** Call User Defined Extract Driver.                                CFT006
      *                                                                   CFT006
     C                     CALL 'CG4990'                                  CFT006
     C                     PARM           W0RTN   7                       CFT006
     C                     PARM           DSPARM                          CFT006
      *                                                                   CFT006
     C           W0RTN     IFNE *BLANKS                                   CFT006
     C           *LOCK     IN   *NAMVAR                                   CFT006
     C                     MOVE 'FT0580  'DBPGM            ***************CFT006
     C                     MOVEL'CG4990  'DBFILE           * DB ERROR 28  CFT006
     C                     Z-ADD28        DBASE            ***************CFT006
     C                     MOVE *BLANK    DBKEY                           CFT006
     C                     MOVEL'CCTCQ'   DBKEY                           CFT006
     C                     OUT  *NAMVAR                                   CFT006
     C                     SETON                     U7U8LR               CFT006
     C                     OPEN FT0580AU                                  CFT006
     C                     WRITEFT580AUF                                  CFT006
     C                     CLOSEFT0580AU                                  CFT006
     C                     DUMP                                           CFT006
     C                     RETRN                                          CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      ** CHAIN to FT102DL0 for later update.                              CFT006
      *                                                                   CFT006
     C           CCTK      CHAINFT102DL0             76                   CFT006
      *                                                                   CFT006
     C                     MOVE *BLANKS   MSGDTA                          CFT006
     C                     MOVEL##RECU    MSGDTA                          CFT006
      *                                                                   CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C* MOVE 'P' TO CHEQUE INDICATOR                                      CFT006
      *                                                                   CFT006
     C                     MOVE 'P'       CCQIN                           CFT006
      *                                                                   CFT006
     C* UPDATE FILE                                                       CFT006
      *                                                                   CFT006
     C                     UPDATFT102DD0                                  CFT006
     C                     TIME           TIM              FOR COMIT      CFT006
     C                     MOVE TIM       TRANS            FOR COMIT      CFT006
      **                                                                                      CSC022
      ** Execute commit if SAR CSC022 is not enrolled or                                      CSC022
      **   job is not currently running in batch mode                                         CSC022
      **                                                                                      CSC022
     C           CSC022    IFEQ 'N'                                                           CSC022
     C           CSC022    OREQ 'Y'                                                           CSC022
     C           WCRSKP    ANDEQ'N'                                                           CSC022
     C           COMBOU    COMIT                                          CFT006
     C                     ENDIF                                                              CSC022
      *                                                                   CFT006
      * Prompt for immediates if UDC installed                            CFT006
      *                                                                   CFT006
     C           *IN37     IFEQ *ON                                       CFT006
     C                     CALL 'CGC5217'                                 CFT006
     C                     PARM *BLANKS   U#RTN   7                       CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C* MOVE AMOUNT TO FIELD FOR HASH TOTALING                            CFT006
      *                                                                   CFT006
     C                     Z-ADDPAYAMT    VAL                             CFT006
      *                                                                   CFT006
     C                     ENDSR                                          CFT006
     C*                                                                   CFT006
     C************************************************************        CFT006
     C* END OF CCT CHEQUE PRINT SUBROUTINE                                CFT006
     C************************************************************        CFT006
     C************************************************************        CFT006
     C/EJECT                                                              CFT006
     C************************************************************        CFT006
     ** RETREIVES ORDERING & BENEFICIARY CUSTOMER & RECEIVING BANK        CFT006
     C           @CCTCQ    BEGSR                                          CFT006
      *                                                                   CFT006
     C* GET ORDERING CUSTOMER NAME AND ADDRESS                            CFT006
      *                                                                   CFT006
     C           TOCUS1    IFEQ *BLANKS                                   CFT006
     C           '/'       SCAN ORDCU1                   63               CFT006
      *                                                                   CFT006
     C           *IN63     IFEQ *ON                                       CFT006
     C                     SUBSTORDCU1:2  INAD1     P                     CFT006
     C                     ELSE                                           CFT006
     C                     MOVE ORDCU1    INAD1                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     MOVE ORDCU2    INAD2                           CFT006
     C                     MOVE ORDCU3    INAD3                           CFT006
     C                     MOVE ORDCU4    INAD4                           CFT006
     C                     MOVE *BLANKS   INAD5                           CFT006
     C                     MOVE CCTCCY    ADCCY   3                       CFT006
      *                                                                   CFT006
     C                     MOVE CUSTTD    ATYPE   1                       CFT006
      *                                                                   CFT006
     C                     ELSE                                           CFT006
     C           '/'       SCAN TOCUS1                   63               CFT006
      *                                                                   CFT006
     C           *IN63     IFEQ *ON                                       CFT006
     C                     SUBSTTOCUS1:2  INAD1     P                     CFT006
     C                     ELSE                                           CFT006
     C                     MOVE TOCUS1    INAD1                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     MOVE TOCUS2    INAD2                           CFT006
     C                     MOVE TOCUS3    INAD3                           CFT006
     C                     MOVE TOCUS4    INAD4                           CFT006
     C                     MOVE *BLANKS   INAD5                           CFT006
     C                     MOVE CCTCCY    ADCCY   3                       CFT006
      *                                                                   CFT006
     C                     MOVE CUSTTH    ATYPE   1                       CFT006
      *                                                                   CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C           CUSTTD    IFEQ 'G'                                       CFT006
     C           CUSTTH    OREQ 'G'                                       CFT006
     C                     MOVELINAD1     NGLACT                          CFT006
     C                     MOVE NGLBRH    OGLBRH                          CFT006
     C                     MOVE NGLCNM    OGLCNM                          CFT006
     C                     MOVE NGLACD    OGLACD                          CFT006
     C                     MOVE NGLCCY    OGLCCY                          CFT006
     C                     MOVE NGLSEQ    OGLSEQ                          CFT006
     C                     MOVELOGLACT    INAD1                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     EXSR ADRES                                     CFT006
     C                     MOVE ADDRS     ORCA                            CFT006
      *                                                                   CFT006
     C* GET BENEFICIARY CUSTOMER NAME AND ADDRESS                         CFT006
      *                                                                   CFT006
     C           '/'       SCAN BENF1                    63               CFT006
      *                                                                   CFT006
     C           *IN63     IFEQ *ON                                       CFT006
     C                     SUBSTBENF1:2   INAD1     P                     CFT006
     C                     ELSE                                           CFT006
     C                     MOVE BENF1     INAD1                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     MOVE BENF2     INAD2                           CFT006
     C                     MOVE BENF3     INAD3                           CFT006
     C                     MOVE BENF4     INAD4                           CFT006
     C                     MOVE BENF5     INAD5                           CFT006
     C                     MOVE PAYCCY    ADCCY                           CFT006
      *                                                                   CFT006
     C                     MOVE BENTTD    ATYPE                           CFT006
      *                                                                   CFT006
     C           BENTTD    IFEQ 'G'                                       CFT006
     C                     MOVELINAD1     NGLACT                          CFT006
     C                     MOVE NGLBRH    OGLBRH                          CFT006
     C                     MOVE NGLCNM    OGLCNM                          CFT006
     C                     MOVE NGLACD    OGLACD                          CFT006
     C                     MOVE NGLCCY    OGLCCY                          CFT006
     C                     MOVE NGLSEQ    OGLSEQ                          CFT006
     C                     MOVELOGLACT    INAD1                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     EXSR ADRES                                     CFT006
     C                     MOVE ADDRS     BNCA                            CFT006
      *                                                                   CFT006
     C* GET RECEIVING BANK'S NAME AND ADDRESS                             CFT006
      *                                                                   CFT006
     C           '/'       SCAN ACCI35                   63               CFT006
      *                                                                   CFT006
     C           *IN63     IFEQ *ON                                       CFT006
     C           '/'       SCAN ACCI35:2                 63               CFT006
      *                                                                   CFT006
     C           *IN63     IFEQ *ON                                       CFT006
     C                     MOVE ACCI35    INAD1                           CFT006
     C                     ELSE                                           CFT006
     C                     SUBSTACCI35:2  INAD1     P                     CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ELSE                                           CFT006
     C                     MOVE ACCI35    INAD1                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     MOVE *BLANKS   INAD2                           CFT006
     C                     MOVE *BLANKS   INAD3                           CFT006
     C                     MOVE *BLANKS   INAD4                           CFT006
     C                     MOVE *BLANKS   INAD5                           CFT006
     C                     MOVE PAYCCY    ADCCY                           CFT006
      *                                                                   CFT006
     C                     MOVE AWITP     ATYPE                           CFT006
      *                                                                   CFT006
     C           AWITP     IFEQ 'G'                                       CFT006
     C                     MOVELINAD1     NGLACT                          CFT006
     C                     MOVE NGLBRH    OGLBRH                          CFT006
     C                     MOVE NGLCNM    OGLCNM                          CFT006
     C                     MOVE NGLACD    OGLACD                          CFT006
     C                     MOVE NGLCCY    OGLCCY                          CFT006
     C                     MOVE NGLSEQ    OGLSEQ                          CFT006
     C                     MOVELOGLACT    INAD1                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     EXSR ADRES                                     CFT006
     C                     MOVE ADDRS     RCBA                            CFT006
     C                     ENDSR                                          CFT006
     C************************************************************        CFT006
     C* END OF SUBROUTINE                                                 CFT006
     C************************************************************        CFT006
     C************************************************************
     C/EJECT
     C************************************************************
     C* OTUP SR.
     C*
     C* UPDATES FILES FOR OTGOING PAYMENTS CHEQUES HAVING BEEN
     C* PRINTED SUCCESSFULLY.
     C*
     C* PERFORMED FROM       - UPDATE
     C*
     C* PERFORMS SUBROUTINES - ADRES
     C*                        GLZADD
     C*                        CURRY
     C*
     C           OTUP      BEGSR
     C* SETON CHEQUES PRINTED SUCCESSFULLY FLAG
     C  N25                SETON                     25
     C* CHAIN TO OTPAYDD FOR UPDATE
     C           PREF      CHAINOTPAYDDF             88
     C   88                DO                              B001
     C           *LOCK     IN   *NAMVAR
     C                     MOVE 'FT0580  'DBPGM            ***************
     C*********************MOVE 'OTPAY'   DBFILE           * DB ERROR 09 *S01194
     C                     MOVEL'OTPAY'   DBFILE           ***************S01194
     C                     Z-ADD9         DBASE            ***************
     C                     MOVE *BLANK    DBKEY
     C                     MOVELPREF      DBKEY
     C                     OUT  *NAMVAR
     C                     SETON                     U7U8LR
     C*********************OPEN FT0580P2                                  S01194
     C*********************WRITEFT580P2F                                  S01194
     C*********************CLOSEFT0580P2                                  S01194
     C                     OPEN FT0580AU                                  S01194
     C                     WRITEFT580AUF                                  S01194
     C                     CLOSEFT0580AU                                  S01194
     C                     DUMP
     C                     RETRN
     C                     END                             E001
     C* MOVE 'Y' TO CHEQUE INDICATOR
     C                     MOVE 'Y'       CQIN
     C* UPDATE
     C                     UPDATOTPAYDDF
     C* FIND BENEFICIARY CUSTOMER FOR CHEQUE REGISTER
     C                     MOVE BNC1      INAD1
     C                     MOVE BNC2      INAD2
     C                     MOVE BNC3      INAD3
     C                     MOVE BNC4      INAD4
     C                     MOVE *BLANK    INAD5
     C                     MOVE BNCT      ATYPE
     C                     MOVE PCCY      ADCCY
     C                     EXSR ADRES
     C                     MOVE ADDRS     PAYEE
     C* FIND DETINATION FOR CHEQUE REGISTER
     C                     MOVE DST1      INAD1
     C                     MOVE DST2      INAD2
     C                     MOVE DST3      INAD3
     C                     MOVE DST4      INAD4
     C                     MOVE *BLANK    INAD5
     C                     MOVE DSTT      ATYPE
     C                     MOVE PCCY      ADCCY
     C/COPY WNCPYSRC,FT0580C068
     C                     EXSR ADRES
     C/COPY WNCPYSRC,FT0580C069
     C                     MOVE ADDRS     DRAWER
     C           ADDC      IFNE 'A'                        B001
     C***********CDRO      ANDEQ0                                                             CSD027
     C           CDRO      ANDEQ*BLANKS                                                       CSD027
     C                     SUB  TRCM      PYAM
     C                     SUB  TXCH      PYAM
     C                     SUB  CQCH      PYAM
     C                     SUB  CSTA      PYAM
     C                     SUB  SPCH      PYAM
     C                     SUB  MSCH      PYAM
     C                     END                             E001
     C                     Z-ADDPYAM      CQAM
     C                     MOVE PCCY      CQCY
     C                     Z-ADDRUND      PDTE
     C                     Z-ADDPVDT      CQDT    50
     C* IF SETTLEMENT TYPE EQUALS 13 OR CUSTOMER EQUAL INTERNAL
     C* CUSTOMER NUMBER SET CLEARED FLAG TO 'Y'
     C           STMT      IFEQ 13                         B001
     C           BICN      OREQ INNUM
     C                     MOVE 'Y'       CLER
     C                     ELSE                            X001
     C                     MOVE ' '       CLER
     C                     END                             E001
     C                     Z-ADDCQNUM     CQNM
     C                     ADD  1         CQNUM
     C                     Z-ADDRUND      LCD
     C                     MOVE 'I'       CHTP
     C                     TIME           LCHT
     C* WRITE CHEQUE REGISTER
     C                     WRITECQREGDDF               88
     C   88                DO                              B001
     C           *LOCK     IN   *NAMVAR
     C                     MOVE 'FT0580  'DBPGM            ***************
     C*********************MOVE 'CQREG'   DBFILE           * DB ERROR 10 *S01194
     C                     MOVEL'CQREGDD' DBFILE           ***************S01194
     C                     Z-ADD10        DBASE            ***************
     C                     MOVE *BLANK    DBKEY
     C                     MOVELPREF      DBKEY
     C                     OUT  *NAMVAR
     C                     SETON                     U7U8LR
     C*********************OPEN FT0580P2                                  S01194
     C*********************WRITEFT580P2F                                  S01194
     C*********************CLOSEFT0580P2                                  S01194
     C                     OPEN FT0580AU                                  S01194
     C                     WRITEFT580AUF                                  S01194
     C                     CLOSEFT0580AU                                  S01194
     C                     DUMP
     C                     RETRN
     C                     END                             E001
     C* READ CHEQUE REGISTER TRAILER FOR UPDATE
     C           1         CHAINCQREGZZF             88
     C   88                DO                              B001
     C           *LOCK     IN   *NAMVAR
     C                     MOVE 'FT0580  'DBPGM            ***************
     C*********************MOVE 'CQREG'   DBFILE           * DB ERROR 11 *S01194
     C                     MOVEL'CQREGZZ' DBFILE           ***************S01194
     C                     Z-ADD11        DBASE            ***************
     C                     MOVE *BLANK    DBKEY
     C                     MOVEL'1'       DBKEY
     C                     OUT  *NAMVAR
     C                     SETON                     U7U8LR
     C*********************OPEN FT0580P2                                  S01194
     C*********************WRITEFT580P2F                                  S01194
     C*********************CLOSEFT0580P2                                  S01194
     C                     OPEN FT0580AU                                  S01194
     C                     WRITEFT580AUF                                  S01194
     C                     CLOSEFT0580AU                                  S01194
     C                     DUMP
     C                     RETRN
     C                     END                             E001
     C/COPY WNCPYSRC,FT0580C046
     C* HASH TOTALING
     C                     Z-ADDHRWN      ZZTOTI
     C                     Z-ADDHRDC      ZZTOTD
     C                     ADD  1         NORE1
     C                     MOVE PYAM      ZZAMT
     C                     EXSR GLZADD
     C                     Z-ADDZZTOTI    HRWN
     C                     Z-ADDZZTOTD    HRDC
     C                     UPDATCQREGZZF
     C                     TIME           TIM              FOR COMIT
     C                     MOVE TIM       TRANS            FOR COMIT
      **                                                                                      CSC022
      ** Execute commit if SAR CSC022 is not enrolled or                                      CSC022
      **   job is not currently running in batch mode                                         CSC022
      **                                                                                      CSC022
     C           CSC022    IFEQ 'N'                                                           CSC022
     C           CSC022    OREQ 'Y'                                                           CSC022
     C           WCRSKP    ANDEQ'N'                                                           CSC022
     C           COMBOU    COMIT
     C                     ENDIF                                                              CSC022
     C                     Z-ADDCQRGVI    ZZTOTI
     C                     Z-ADDCQRGVD    ZZTOTD
     C                     MOVE PYAM      ZZAMT
     C                     EXSR GLZADD
     C                     Z-ADDZZTOTI    CQRGVI
     C                     Z-ADDZZTOTD    CQRGVD
     C                     ADD  1         CQRGN
     C                     ENDSR
     C*
     C************************************************************
     C* END OF SUBROUTINE TO UPDATE FILES FOR OUTGOING
     C************************************************************
     C/EJECT
     C************************************************************
     C* PYUP SR.
     C*
     C* UPDATES FILES FOR CHEQUES TO BE PAID CHEQUES HAVING
     C* BEEN SUCCESSFULLY PRINTED.
     C*
     C* PERFORMED FROM       - UPDATE
     C*
     C* PERFORMS SUBROUTINES - ADRES
     C*                        GLZADD
     C*                        CURRY
     C*
     C           PYUP      BEGSR
     C* SET FLAG FOR CHEQUES HAVING BEEN PRINTED SUCCESSFULLY
     C  N25                SETON                     25
     C* CHAIN TO CQPACDD RECORD FOR UPDATE
     C           CKEY      CHAINCQPACDDF             88
     C   88                DO                              B001
     C           *LOCK     IN   *NAMVAR
     C                     MOVE 'FT0580  'DBPGM            ***************
     C*********************MOVE 'CQPAC'   DBFILE           * DB ERROR 12 *S01194
     C                     MOVEL'CQPAC'   DBFILE           ***************S01194
     C                     Z-ADD12        DBASE            ***************
     C                     MOVE *BLANK    DBKEY
     C                     MOVELPREF      DBKEY
     C                     OUT  *NAMVAR
     C                     SETON                     U7U8LR
     C*********************OPEN FT0580P2                                  S01194
     C*********************WRITEFT580P2F                                  S01194
     C*********************CLOSEFT0580P2                                  S01194
     C                     OPEN FT0580AU                                  S01194
     C                     WRITEFT580AUF                                  S01194
     C                     CLOSEFT0580AU                                  S01194
     C                     DUMP
     C                     RETRN
     C                     END                             E001
     C                     MOVE 'Y'       CQIN
     C                     UPDATCQPACDDF
     C* FIND REMITTING BANK'S NAME AND ADDRESS FOR CHEQUE REGISTER
     C                     MOVE RBK1      INAD1
     C                     MOVE RBK2      INAD2
     C                     MOVE RBK3      INAD3
     C                     MOVE RBK4      INAD4
     C                     MOVE *BLANK    INAD5
     C                     MOVE RBKT      ATYPE
     C                     MOVE PCCY      ADCCY
     C                     EXSR ADRES
     C                     MOVE ADDRS     PAYEE
     C* FIND SENDER'S CORRESP NAME AND ADDRESS FOR CHEQUE REGISTER
     C                     MOVE *BLANK    INAD
     C                     MOVELSNCO      INAD
     C                     MOVE SNCT      ATYPE
     C                     MOVE PCCY      ADCCY
     C                     EXSR ADRES
     C                     MOVE ADDRS     DRAWER
     C                     Z-ADDPRRM      CQAM
     C                     MOVE PCCY      CQCY
     C                     Z-ADDRUND      PDTE
     C                     Z-ADDPVDT      CQDT
     C* IF SETTLEMENT TYPE IS 13 OR CUSTOMER NUMBER EQUALS INTERNAL
     C* CUSTOMER NUMBER MOVE 'Y' TO CLEARED INDICATOR
     C           STMT      IFEQ 13                         B001
     C           BICN      OREQ SNCO
     C                     MOVE 'Y'       CLER
     C                     ELSE                            X001
     C                     MOVE ' '       CLER
     C                     END                             E001
     C                     Z-ADDCQNUM     CQNM
     C                     ADD  1         CQNUM
     C                     Z-ADDRUND      LCD
     C                     MOVE 'I'       CHTP
     C                     TIME           LCHT
     C* WRITE CHEQUE REGISTER
     C                     WRITECQREGDDF               88
     C   88                DO                              B001
     C           *LOCK     IN   *NAMVAR
     C                     MOVE 'FT0580  'DBPGM            ***************
     C*********************MOVE 'CQREG'   DBFILE           * DB ERROR 13 *S01194
     C                     MOVEL'CQREGDD' DBFILE           ***************S01194
     C                     Z-ADD13        DBASE            ***************
     C                     MOVE *BLANK    DBKEY
     C                     MOVELPREF      DBKEY
     C                     OUT  *NAMVAR
     C                     SETON                     U7U8LR
     C*********************OPEN FT0580P2                                  S01194
     C*********************WRITEFT580P2F                                  S01194
     C*********************CLOSEFT0580P2                                  S01194
     C                     OPEN FT0580AU                                  S01194
     C                     WRITEFT580AUF                                  S01194
     C                     CLOSEFT0580AU                                  S01194
     C                     DUMP
     C                     RETRN
     C                     END                             E001
     C* CHAIN TO CHEQUE REGISTER TRAILER FOR UPDATE
     C           1         CHAINCQREGZZF             88
     C   88                DO                              B001
     C           *LOCK     IN   *NAMVAR
     C                     MOVE 'FT0580  'DBPGM            ***************
     C*********************MOVE 'CQREG'   DBFILE           * DB ERROR 14 *S01194
     C                     MOVE 'CQREGZZ' DBFILE           ***************S01194
     C                     Z-ADD14        DBASE            ***************
     C                     MOVE *BLANK    DBKEY
     C                     MOVELPREF      DBKEY
     C                     OUT  *NAMVAR
     C                     SETON                     U7U8LR
     C*********************OPEN FT0580P2                                  S01194
     C*********************WRITEFT580P2F                                  S01194
     C*********************CLOSEFT0580P2                                  S01194
     C                     OPEN FT0580AU                                  S01194
     C                     WRITEFT580AUF                                  S01194
     C                     CLOSEFT0580AU                                  S01194
     C                     DUMP
     C                     RETRN
     C                     END                             E001
     C/COPY WNCPYSRC,FT0580C047
     C* HASH TOTALING
     C                     Z-ADDHRWN      ZZTOTI
     C                     Z-ADDHRDC      ZZTOTD
     C                     ADD  1         NORE1
     C                     MOVE PRRM      ZZAMT
     C                     EXSR GLZADD
     C                     Z-ADDZZTOTI    HRWN
     C                     Z-ADDZZTOTD    HRDC
     C                     UPDATCQREGZZF
     C                     TIME           TIM              FOR COMIT
     C                     MOVE TIM       TRANS            FOR COMIT
      **                                                                                      CSC022
      ** Execute commit if SAR CSC022 is not enrolled or                                      CSC022
      **   job is not currently running in batch mode                                         CSC022
      **                                                                                      CSC022
     C           CSC022    IFEQ 'N'                                                           CSC022
     C           CSC022    OREQ 'Y'                                                           CSC022
     C           WCRSKP    ANDEQ'N'                                                           CSC022
     C           COMBOU    COMIT
     C                     ENDIF                                                              CSC022
     C                     Z-ADDCQRGVI    ZZTOTI
     C                     Z-ADDCQRGVD    ZZTOTD
     C                     MOVE PRRM      ZZAMT
     C                     EXSR GLZADD
     C                     Z-ADDZZTOTI    CQRGVI
     C                     Z-ADDZZTOTD    CQRGVD
     C                     ADD  1         CQRGN
     C                     ENDSR
     C*
     C************************************************************
     C* END OF CHEQUES TO BE PAID UPDATE SUBROUTINE
     C************************************************************
     C************************************************************        CFT006
     C/EJECT                                                              CFT006
     C************************************************************        CFT006
     C* RFTUP SR.                                                         CFT006
     C*                                                                   CFT006
     C* UPDATES FILES FOR RFT, CHEQUES HAVING BEEN PRINTED SUCCESSFULLY   CFT006
     C*                                                                   CFT006
     C* PERFORMED FROM       - UPDATE                                     CFT006
     C*                                                                   CFT006
     C* PERFORMS SUBROUTINES - ADRES                                      CFT006
     C*                        GLZADD                                     CFT006
     C*                        CURRY                                      CFT006
     C*                                                                   CFT006
     C           RFTUP     BEGSR                                          CFT006
      *                                                                   CFT006
     C* SETON CHEQUES PRINTED SUCCESSFULLY FLAG                           CFT006
      *                                                                   CFT006
     C           *IN25     IFEQ *OFF                                      CFT006
     C                     MOVE *ON       *IN25                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C* CHAIN TO FT101DL0 FOR UPDATE                                      CFT006
      *                                                                   CFT006
     C           RFTK      CHAINFT101DD0             75                   CFT006
      *                                                                   CFT006
     C           *IN75     IFEQ *ON                                       CFT006
     C           *LOCK     IN   *NAMVAR                                   CFT006
     C                     MOVE 'FT0580  'DBPGM            ***************CFT006
     C                     MOVEL'FT101DL0'DBFILE           * DB ERROR 30 *CFT006
     C                     Z-ADD30        DBASE            ***************CFT006
     C                     MOVE *BLANK    DBKEY                           CFT006
     C                     MOVELRFTID     DBKEY                           CFT006
     C                     OUT  *NAMVAR                                   CFT006
     C                     SETON                     U7U8LR               CFT006
     C                     OPEN FT0580AU                                  CFT006
     C                     WRITEFT580AUF                                  CFT006
     C                     CLOSEFT0580AU                                  CFT006
     C                     DUMP                                           CFT006
     C                     RETRN                                          CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C* MOVE 'Y' TO CHEQUE INDICATOR                                      CFT006
      *                                                                   CFT006
     C                     MOVE 'Y'       DCQIN                           CFT006
     C                     Z-ADDCQNUM     DCHQNM                          CFT006
      *                                                                   CFT006
     C* UPDATE                                                            CFT006
      *                                                                   CFT006
     C                     UPDATFT101DD0                                  CFT006
      *                                                                   CFT006
     C* FIND BENEFICIARY CUSTOMER FOR CHEQUE REGISTER                     CFT006
      *                                                                   CFT006
     C           '/'       SCAN TBNA35                   63               CFT006
      *                                                                   CFT006
     C           *IN63     IFEQ *ON                                       CFT006
     C                     SUBSTTBNA35:2  INAD1     P                     CFT006
     C                     ELSE                                           CFT006
     C                     MOVE TBNA35    INAD1                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     MOVE TBNB35    INAD2                           CFT006
     C                     MOVE TBNC35    INAD3                           CFT006
     C                     MOVE TBND35    INAD4                           CFT006
     C                     MOVE TBNE35    INAD5                           CFT006
      *                                                                   CFT006
     C                     MOVE BENTTP    ATYPE                           CFT006
      *                                                                   CFT006
     C           PYTP      IFEQ 'RO'                                      CFT006
     C                     MOVE TRNCCY    ADCCY                           CFT006
     C                     ELSE                                           CFT006
     C                     MOVE PAYCCY    ADCCY                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C           BENTTP    IFEQ 'G'                                       CFT006
     C                     MOVELINAD1     NGLACT                          CFT006
     C                     MOVE NGLBRH    OGLBRH                          CFT006
     C                     MOVE NGLCNM    OGLCNM                          CFT006
     C                     MOVE NGLACD    OGLACD                          CFT006
     C                     MOVE NGLCCY    OGLCCY                          CFT006
     C                     MOVE NGLSEQ    OGLSEQ                          CFT006
     C                     MOVELOGLACT    INAD1                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     EXSR ADRES                                     CFT006
      *                                                                   CFT006
     C           ADDRS     IFEQ *BLANKS                                   CFT006
     C                     MOVE INAD1     PYE1                            CFT006
     C                     MOVE TBNB35    PYE2                            CFT006
     C                     MOVE TBNC35    PYE3                            CFT006
     C                     MOVE TBND35    PYE4                            CFT006
     C                     MOVE TBNE35    PYE5                            CFT006
     C                     MOVE ADDRS     PAYEE                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C* FIND DESTINATION FOR CHEQUE REGISTER                              CFT006
      *                                                                   CFT006
     C           '/'       SCAN TACA35                   63               CFT006
      *                                                                   CFT006
     C           *IN63     IFEQ *ON                                       CFT006
     C           '/'       SCAN TACA35:2                 63               CFT006
      *                                                                   CFT006
     C           *IN63     IFEQ *ON                                       CFT006
     C                     MOVE TACA35    INAD1                           CFT006
     C                     ELSE                                           CFT006
     C                     SUBSTTACA35:2  INAD1     P                     CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ELSE                                           CFT006
     C                     MOVE TACA35    INAD1                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     MOVE TACB35    INAD2                           CFT006
     C                     MOVE TACC35    INAD3                           CFT006
     C                     MOVE TACD35    INAD4                           CFT006
     C                     MOVE TACE35    INAD5                           CFT006
      *                                                                   CFT006
     C                     MOVE AWITTP    ATYPE                           CFT006
      *                                                                   CFT006
     C           PYTP      IFEQ 'RO'                                      CFT006
     C                     MOVE TRNCCY    ADCCY                           CFT006
     C                     ELSE                                           CFT006
     C                     MOVE PAYCCY    ADCCY                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C           AWITTP    IFEQ 'G'                                       CFT006
     C                     MOVELINAD1     NGLACT                          CFT006
     C                     MOVE NGLBRH    OGLBRH                          CFT006
     C                     MOVE NGLCNM    OGLCNM                          CFT006
     C                     MOVE NGLACD    OGLACD                          CFT006
     C                     MOVE NGLCCY    OGLCCY                          CFT006
     C                     MOVE NGLSEQ    OGLSEQ                          CFT006
     C                     MOVELOGLACT    INAD1                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     EXSR ADRES                                     CFT006
     C                     MOVE ADDRS     DRAWER                          CFT006
      *                                                                   CFT006
     C           PYTP      IFEQ 'RO'                                      CFT006
     C                     Z-ADDTRNAMT    CQAM                            CFT006
     C                     MOVE TRNCCY    CQCY                            CFT006
     C                     ELSE                                           CFT006
     C                     Z-ADDPAYAMT    CQAM                            CFT006
     C                     MOVE PAYCCY    CQCY                            CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     Z-ADDRUND      PDTE                            CFT006
     C                     Z-ADDCRDVDT    CQDT    50                      CFT006
     C                     Z-ADDCQNUM     CQNM                            CFT006
     C                     ADD  1         CQNUM                           CFT006
     C                     Z-ADDRUND      LCD                             CFT006
     C                     MOVE 'I'       CHTP                            CFT006
     C                     TIME           LCHT                            CFT006
      *                                                                   CFT006
     C* WRITE CHEQUE REGISTER                                             CFT006
      *                                                                   CFT006
     C                     WRITECQREGDDF               88                 CFT006
      *                                                                   CFT006
     C           *IN88     IFEQ *ON                                       CFT006
     C           *LOCK     IN   *NAMVAR                                   CFT006
     C                     MOVE 'FT0580  'DBPGM            ***************CFT006
     C                     MOVEL'CQREGDD' DBFILE           * DB ERROR 31 *CFT006
     C                     Z-ADD31        DBASE            ***************CFT006
     C                     MOVE *BLANK    DBKEY                           CFT006
     C                     MOVELRFTID     DBKEY                           CFT006
     C                     OUT  *NAMVAR                                   CFT006
     C                     SETON                     U7U8LR               CFT006
     C                     OPEN FT0580AU                                  CFT006
     C                     WRITEFT580AUF                                  CFT006
     C                     CLOSEFT0580AU                                  CFT006
     C                     DUMP                                           CFT006
     C                     RETRN                                          CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C* READ CHEQUE REGISTER TRAILER FOR UPDATE                           CFT006
      *                                                                   CFT006
     C           1         CHAINCQREGZZF             88                   CFT006
      *                                                                   CFT006
     C           *IN88     IFEQ *ON                                       CFT006
     C           *LOCK     IN   *NAMVAR                                   CFT006
     C                     MOVE 'FT0580  'DBPGM            ***************CFT006
     C                     MOVEL'CQREGZZ' DBFILE           * DB ERROR 32 *CFT006
     C                     Z-ADD32        DBASE            ***************CFT006
     C                     MOVE *BLANK    DBKEY                           CFT006
     C                     MOVEL'1'       DBKEY                           CFT006
     C                     OUT  *NAMVAR                                   CFT006
     C                     SETON                     U7U8LR               CFT006
     C                     OPEN FT0580AU                                  CFT006
     C                     WRITEFT580AUF                                  CFT006
     C                     CLOSEFT0580AU                                  CFT006
     C                     DUMP                                           CFT006
     C                     RETRN                                          CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C* HASH TOTALING                                                     CFT006
      *                                                                   CFT006
     C                     Z-ADDHRWN      ZZTOTI                          CFT006
     C                     Z-ADDHRDC      ZZTOTD                          CFT006
     C                     ADD  1         NORE1                           CFT006
      *                                                                   CFT006
     C           PYTP      IFEQ 'RO'                                      CFT006
     C                     MOVE TRNAMT    ZZAMT                           CFT006
     C                     ELSE                                           CFT006
     C                     MOVE PAYAMT    ZZAMT                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     EXSR GLZADD                                    CFT006
     C                     Z-ADDZZTOTI    HRWN                            CFT006
     C                     Z-ADDZZTOTD    HRDC                            CFT006
     C                     UPDATCQREGZZF                                  CFT006
     C                     TIME           TIM              FOR COMIT      CFT006
     C                     MOVE TIM       TRANS            FOR COMIT      CFT006
      **                                                                                      CSC022
      ** Execute commit if SAR CSC022 is not enrolled or                                      CSC022
      **   job is not currently running in batch mode                                         CSC022
      **                                                                                      CSC022
     C           CSC022    IFEQ 'N'                                                           CSC022
     C           CSC022    OREQ 'Y'                                                           CSC022
     C           WCRSKP    ANDEQ'N'                                                           CSC022
     C           COMBOU    COMIT                                          CFT006
     C                     ENDIF                                                              CSC022
     C                     Z-ADDCQRGVI    ZZTOTI                          CFT006
     C                     Z-ADDCQRGVD    ZZTOTD                          CFT006
      *                                                                   CFT006
     C           PYTP      IFEQ 'RO'                                      CFT006
     C                     MOVE TRNAMT    ZZAMT                           CFT006
     C                     ELSE                                           CFT006
     C                     MOVE PAYAMT    ZZAMT                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     EXSR GLZADD                                    CFT006
     C                     Z-ADDZZTOTI    CQRGVI                          CFT006
     C                     Z-ADDZZTOTD    CQRGVD                          CFT006
     C                     ADD  1         CQRGN                           CFT006
      *                                                                   CFT006
     C                     ENDSR                                          CFT006
     C*                                                                   CFT006
     C************************************************************        CFT006
     C* END OF SUBROUTINE TO UPDATE FILES FOR RFT                         CFT006
     C************************************************************        CFT006
     C************************************************************        CFT006
     C/EJECT                                                              CFT006
     C************************************************************        CFT006
     C* CCTUP SR.                                                         CFT006
     C*                                                                   CFT006
     C* UPDATES FILES FOR CCT, CHEQUES HAVING BEEN PRINTED SUCCESSFULLY   CFT006
     C*                                                                   CFT006
     C* PERFORMED FROM       - UPDATE                                     CFT006
     C*                                                                   CFT006
     C* PERFORMS SUBROUTINES - ADRES                                      CFT006
     C*                        GLZADD                                     CFT006
     C*                        CURRY                                      CFT006
     C*                                                                   CFT006
     C           CCTUP     BEGSR                                          CFT006
      *                                                                   CFT006
     C* SETON CHEQUES PRINTED SUCCESSFULLY FLAG                           CFT006
      *                                                                   CFT006
     C           *IN25     IFEQ *OFF                                      CFT006
     C                     MOVE *ON       *IN25                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C* CHAIN TO FT102DL0 FOR UPDATE                                      CFT006
      *                                                                   CFT006
     C           CCTK      CHAINFT102DD0             76                   CFT006
      *                                                                   CFT006
     C           *IN76     IFEQ *ON                                       CFT006
     C           *LOCK     IN   *NAMVAR                                   CFT006
     C                     MOVE 'FT0580  'DBPGM            ***************CFT006
     C                     MOVEL'FT102DL0'DBFILE           * DB ERROR 33 *CFT006
     C                     Z-ADD33        DBASE            ***************CFT006
     C                     MOVE *BLANK    DBKEY                           CFT006
     C                     MOVELCCTID     DBKEY                           CFT006
     C                     OUT  *NAMVAR                                   CFT006
     C                     SETON                     U7U8LR               CFT006
     C                     OPEN FT0580AU                                  CFT006
     C                     WRITEFT580AUF                                  CFT006
     C                     CLOSEFT0580AU                                  CFT006
     C                     DUMP                                           CFT006
     C                     RETRN                                          CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C* MOVE 'Y' TO CHEQUE INDICATOR                                      CFT006
      *                                                                   CFT006
     C                     MOVE 'Y'       CCQIN                           CFT006
     C                     Z-ADDCQNUM     CCHQNM                          CFT006
      *                                                                   CFT006
     C* UPDATE                                                            CFT006
      *                                                                   CFT006
     C                     UPDATFT102DD0                                  CFT006
      *                                                                   CFT006
     C* FIND BENEFICIARY CUSTOMER FOR CHEQUE REGISTER                     CFT006
      *                                                                   CFT006
     C                     MOVE BENF2     PYE1                            CFT006
     C                     MOVE BENF3     PYE2                            CFT006
     C                     MOVE BENF4     PYE3                            CFT006
     C                     MOVE BENF5     PYE4                            CFT006
     C                     MOVE *BLANKS   PYE5                            CFT006
      *                                                                   CFT006
     C* FIND DESTINATION FOR CHEQUE REGISTER                              CFT006
      *                                                                   CFT006
     C           '/'       SCAN ACCI35                   63               CFT006
      *                                                                   CFT006
     C           *IN63     IFEQ *ON                                       CFT006
     C           '/'       SCAN ACCI35:2                 63               CFT006
      *                                                                   CFT006
     C           *IN63     IFEQ *ON                                       CFT006
     C                     MOVE ACCI35    INAD1                           CFT006
     C                     ELSE                                           CFT006
     C                     SUBSTACCI35:2  INAD1     P                     CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ELSE                                           CFT006
     C                     MOVE ACCI35    INAD1                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     MOVE *BLANKS   INAD2                           CFT006
     C                     MOVE *BLANKS   INAD3                           CFT006
     C                     MOVE *BLANKS   INAD4                           CFT006
     C                     MOVE *BLANKS   INAD5                           CFT006
      *                                                                   CFT006
     C                     MOVE AWITP     ATYPE                           CFT006
      *                                                                   CFT006
     C                     MOVE PAYCCY    ADCCY                           CFT006
      *                                                                   CFT006
     C           AWITP     IFEQ 'G'                                       CFT006
     C                     MOVELINAD1     NGLACT                          CFT006
     C                     MOVE NGLBRH    OGLBRH                          CFT006
     C                     MOVE NGLCNM    OGLCNM                          CFT006
     C                     MOVE NGLACD    OGLACD                          CFT006
     C                     MOVE NGLCCY    OGLCCY                          CFT006
     C                     MOVE NGLSEQ    OGLSEQ                          CFT006
     C                     MOVELOGLACT    INAD1                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     EXSR ADRES                                     CFT006
     C                     MOVE ADDRS     DRAWER                          CFT006
     C                     Z-ADDPAYAMT    CQAM                            CFT006
     C                     MOVE PAYCCY    CQCY                            CFT006
     C                     Z-ADDRUND      PDTE                            CFT006
     C                     Z-ADDCRDVDT    CQDT    50                      CFT006
     C                     Z-ADDCQNUM     CQNM                            CFT006
     C                     ADD  1         CQNUM                           CFT006
     C                     Z-ADDRUND      LCD                             CFT006
     C                     MOVE 'I'       CHTP                            CFT006
     C                     TIME           LCHT                            CFT006
      *                                                                   CFT006
     C* WRITE CHEQUE REGISTER                                             CFT006
      *                                                                   CFT006
     C                     WRITECQREGDDF               88                 CFT006
      *                                                                   CFT006
     C           *IN88     IFEQ *ON                                       CFT006
     C           *LOCK     IN   *NAMVAR                                   CFT006
     C                     MOVE 'FT0580  'DBPGM            ***************CFT006
     C                     MOVEL'CQREGDD' DBFILE           * DB ERROR 34 *CFT006
     C                     Z-ADD34        DBASE            ***************CFT006
     C                     MOVE *BLANK    DBKEY                           CFT006
     C                     MOVELCCTID     DBKEY                           CFT006
     C                     OUT  *NAMVAR                                   CFT006
     C                     SETON                     U7U8LR               CFT006
     C                     OPEN FT0580AU                                  CFT006
     C                     WRITEFT580AUF                                  CFT006
     C                     CLOSEFT0580AU                                  CFT006
     C                     DUMP                                           CFT006
     C                     RETRN                                          CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C* READ CHEQUE REGISTER TRAILER FOR UPDATE                           CFT006
      *                                                                   CFT006
     C           1         CHAINCQREGZZF             88                   CFT006
      *                                                                   CFT006
     C           *IN88     IFEQ *ON                                       CFT006
     C           *LOCK     IN   *NAMVAR                                   CFT006
     C                     MOVE 'FT0580  'DBPGM            ***************CFT006
     C                     MOVEL'CQREGZZ' DBFILE           * DB ERROR 35 *CFT006
     C                     Z-ADD35        DBASE            ***************CFT006
     C                     MOVE *BLANK    DBKEY                           CFT006
     C                     MOVEL'1'       DBKEY                           CFT006
     C                     OUT  *NAMVAR                                   CFT006
     C                     SETON                     U7U8LR               CFT006
     C                     OPEN FT0580AU                                  CFT006
     C                     WRITEFT580AUF                                  CFT006
     C                     CLOSEFT0580AU                                  CFT006
     C                     DUMP                                           CFT006
     C                     RETRN                                          CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C* HASH TOTALING                                                     CFT006
      *                                                                   CFT006
     C                     Z-ADDHRWN      ZZTOTI                          CFT006
     C                     Z-ADDHRDC      ZZTOTD                          CFT006
     C                     ADD  1         NORE1                           CFT006
     C                     MOVE PAYAMT    ZZAMT                           CFT006
     C                     EXSR GLZADD                                    CFT006
     C                     Z-ADDZZTOTI    HRWN                            CFT006
     C                     Z-ADDZZTOTD    HRDC                            CFT006
     C                     UPDATCQREGZZF                                  CFT006
     C                     TIME           TIM              FOR COMIT      CFT006
     C                     MOVE TIM       TRANS            FOR COMIT      CFT006
      **                                                                                      CSC022
      ** Execute commit if SAR CSC022 is not enrolled or                                      CSC022
      **   job is not currently running in batch mode                                         CSC022
      **                                                                                      CSC022
     C           CSC022    IFEQ 'N'                                                           CSC022
     C           CSC022    OREQ 'Y'                                                           CSC022
     C           WCRSKP    ANDEQ'N'                                                           CSC022
     C           COMBOU    COMIT                                          CFT006
     C                     ENDIF                                                              CSC022
     C                     Z-ADDCQRGVI    ZZTOTI                          CFT006
     C                     Z-ADDCQRGVD    ZZTOTD                          CFT006
     C                     MOVE PAYAMT    ZZAMT                           CFT006
     C                     EXSR GLZADD                                    CFT006
     C                     Z-ADDZZTOTI    CQRGVI                          CFT006
     C                     Z-ADDZZTOTD    CQRGVD                          CFT006
     C                     ADD  1         CQRGN                           CFT006
      *                                                                   CFT006
     C                     ENDSR                                          CFT006
     C*                                                                   CFT006
     C************************************************************        CFT006
     C* END OF SUBROUTINE TO UPDATE FILES FOR CCT                         CFT006
     C************************************************************        CFT006
     C/EJECT
     C************************************************************
     C* ADRES SR.
     C*
     C* GET AN ADDRESS DEPENDING ON TYPE ETC
     C*
     C* PERFORMED FROM       - OTCQ
     C*                        PYCQ
     C*                        OTUP
     C*                        CQUP
     C*
     C           ADRES     BEGSR
     C**
     C* IF THE TYPE IS BLANK, THE PARTY IS OPTIONAL AND HAS NOT BEEN
     C*   ENTERED.  SET THE N & A TO BLANK AND RETURN TO CALLING SR.
     C**
     C           ATYPE     IFEQ ' '                        B001
     C**********           Z-ADD0         INNUM   60                                          CSD027
     C                     MOVE *BLANKS   INNUM   6                                           CSD027
     C                     MOVE *BLANKS   ADDRS 175
     C                     GOTO ADDEND
     C                     END                             E001
     C**
     C* IF FULL ADDRESS OR SWIFT ADDRESS LEAVE AS IS
     C**
     C           ATYPE     IFEQ 'A'                        B001
     C           ATYPE     OREQ 'S'
     C**********           Z-ADD0         INNUM   60                                          CSD027
     C                     MOVE *BLANKS   INNUM   6                                           CSD027
     C                     MOVE INAD      ADDRS 175
     C                     GOTO ADDEND
     C                     END                             E001
     C**
     C* IF FULL NOSTRO(F) OR NOSTRO NUMBER(N) FIND CUSTOMER
     C**
     C           ATYPE     IFEQ 'F'                        B001
     C           ATYPE     OREQ 'N'
     C**
     C* IF FULL NOSTRO(F)
     C**
     C           ATYPE     IFEQ 'F'                        B002
     C                     MOVELINAD1     CURR
     C                     ELSE                            X002
     C**
     C* ELSE NOSTRO NUMBER(N)
     C**
     C                     MOVELADCCY     CURR
     C                     MOVELINAD1     CURRN
     C                     END                             E002
     C**
     C* READ TABLETL FOR CUSTOMER NUMBER
     C**
     C                     MOVE *BLANK    KEY
     C                     MOVEL'70'      KEY
     C                     MOVE CURR      KEY
     C           KEY       CHAINTABLETLF             88
     C  N88      RECI      COMP 'D'                  8888
     C   88                DO                              B002
     C           *LOCK     IN   *NAMVAR
     C                     MOVE 'FT0580  'DBPGM            ***************
     C*********************MOVE 'TABLE'   DBFILE           * DB ERROR 15 *S01194
     C                     MOVEL'TABLETL' DBFILE           ***************S01194
     C                     Z-ADD15        DBASE            ***************
     C                     MOVE *BLANK    DBKEY
     C                     MOVELKEY       DBKEY
     C                     OUT  *NAMVAR
     C                     SETON                     U7U8LR
     C*********************OPEN FT0580P2                                  S01194
     C*********************WRITEFT580P2F                                  S01194
     C*********************CLOSEFT0580P2                                  S01194
     C                     OPEN FT0580AU                                  S01194
     C                     WRITEFT580AUF                                  S01194
     C                     CLOSEFT0580AU                                  S01194
     C                     DUMP
     C                     RETRN
     C                     END                             E002
     C                     ELSE                            X001
     C* IF RETAIL NUMBER(R) READ ACNUMA FOR CUSTOMER NUMBER
     C           ATYPE     IFEQ 'R'                        B002
     C                     Z-ADDINRT      ACNO
     C           ACNO      CHAINACNUMAF              88
     C  N88      RECI      COMP 'D'                  8888
     C   88                DO                              B003
     C           *LOCK     IN   *NAMVAR
     C                     MOVE 'FT0580  'DBPGM            ***************
     C*********************MOVE 'ACNUM'   DBFILE           * DB ERROR 16 *S01194
     C                     MOVEL'ACNUMA'  DBFILE           ***************S01194
     C                     Z-ADD16        DBASE            ***************
     C                     MOVE *BLANK    DBKEY
     C                     MOVELACNO      DBKEY
     C                     OUT  *NAMVAR
     C                     SETON                     U7U8LR
     C*********************OPEN FT0580P2                                  S01194
     C*********************WRITEFT580P2F                                  S01194
     C*********************CLOSEFT0580P2                                  S01194
     C                     OPEN FT0580AU                                  S01194
     C                     WRITEFT580AUF                                  S01194
     C                     CLOSEFT0580AU                                  S01194
     C                     DUMP
     C                     RETRN
     C                     END                             E003
     C                     ELSE                            X002
     C**                                                                  CFT004
     C* If International Bank Account Number                              CFT004
     C**                                                                  CFT004
     C           CFT004    IFEQ 'Y'                        B003           CFT004
     C           ATYPE     ANDEQ'I'                                       CFT004
     C           34        SUBSTINAD1:2   P@IBN  34                       CFT004
     C                     MOVE *BLANKS   DSSDY                           CFT004
     C                     CALL 'AOIBANR4'                                CFT004
     C                     PARM *BLANKS   @RTCD                           CFT004
     C                     PARM '*KEY   ' @OPTN   7                       CFT004
     C                     PARM           P@IBN                           CFT004
     C           P@ACCN    PARM           DSSDY                           CFT004
      * If IBAN number is not a live Account, format it with blanks       CFT004
     C           @RTCD     IFNE *BLANKS                                   CFT004
     C                     CALL 'AOIBANR3'                                CFT004
     C                     PARM *BLANKS   @RTCD                           CFT004
     C                     PARM P@IBN     P@IBNI 47                       CFT004
     C                     PARM           P@IBNW 47                       CFT004
     C                     PARM           P@IBNN 34                       CFT004
     C           @RTCD     IFNE *BLANKS                                   CFT004
     C**********           Z-ADD0         INNUM                                        CFT004 CSD027
     C                     MOVE *BLANKS   INNUM                                               CSD027
     C                     MOVE *BLANKS   ADDRS                           CFT004
     C                     MOVELP@IBN     ADDRS                           CFT004
     C                     GOTO ADDEND                                    CFT004
     C                     ELSE                                           CFT004
     C**********           Z-ADD0         INNUM                                        CFT004 CSD027
     C                     MOVE *BLANKS   INNUM                                               CSD027
     C                     MOVE *BLANKS   ADDRS                           CFT004
     C                     MOVELP@IBNW    ADDRS                           CFT004
     C                     GOTO ADDEND                                    CFT004
     C                     ENDIF                                          CFT004
     C                     ENDIF                                          CFT004
     C**********           Z-ADDCNUMI     CNUM                                         CFT004 CSD027
     C                     MOVE CNUMI     CNUM                                                CSD027
     C                     ELSE                            X003           CFT004
     C* ELSE CUSTOMER NUMBER IS AT START OF INAD
     C**********           Z-ADDICNM      CNUM                                                CSD027
     C                     MOVE ICNM      CNUM                                                CSD027
     C                     ENDIF                           E003           CFT004
     C                     END                             E002
     C                     END                             E001
     C**
     C* READ CLINTCC FOR NAME AND ADDRESS
     C**
     C                     MOVE 'B'       RCDT
     C           CLKEY     CHAINCLINTCCF             88
     C  N88      RECI      COMP 'D'                  8888
     C   88                DO                              B001
     C           *LOCK     IN   *NAMVAR
     C                     MOVE 'FT0580  'DBPGM            ***************
     C*********************MOVE 'CLINT'   DBFILE           * DB ERROR 17 *S01194
     C                     MOVEL'CLINT'   DBFILE           ***************S01194
     C                     Z-ADD17        DBASE            ***************
     C                     MOVE *BLANK    DBKEY
     C                     MOVELCNUM      DBKEY
     C                     OUT  *NAMVAR
     C                     SETON                     U7U8LR
     C*********************OPEN FT0580P2                                  S01194
     C*********************WRITEFT580P2F                                  S01194
     C*********************CLOSEFT0580P2                                  S01194
     C                     OPEN FT0580AU                                  S01194
     C                     WRITEFT580AUF                                  S01194
     C                     CLOSEFT0580AU                                  S01194
     C                     DUMP
     C                     RETRN
     C                     END                             E001
     C**********           Z-ADDCNUM      INNUM                                               CSD027
     C                     MOVE CNUM      INNUM                                               CSD027
     C**
     C* FORMAT NAME AND ADDRESS
     C**
     C                     MOVE CNA1      ADDR1
     C                     MOVE CNA2      ADDR2
     C                     MOVE CNA3      ADDR3
     C                     MOVE CNA4      ADDR4
     C                     MOVE *BLANK    ADDR5
     C**
     C           ADDEND    ENDSR                           TAG** ADDEND
     C*
     C************************************************************
     C* END OF ADDRESS SUBROUTINE
     C************************************************************
     C/EJECT
     C************************************************************
     C* NUMBER SR.
     C*
     C* FIND DECIMAL PLACES FOR CURRENCY
     C* CONVERT NUMBER TO WORDS
     C*
     C* PERFORMED FROM       - OTCQ
     C*                        PYCQ
     C*
     C* PERFORMS SUBROUTINE  - CURRY
     C*
     C* SUBSCRIPTS USED
     C*            L    -    ARRAY NB
     C*            M    -    ARRAY NM
     C*            Q    -    ARRAY *IN, INDICATORS
     C*            V    -    ARRAY DG AND NN
     C*            W    -    ARRAY NM
     C*            X    -    ARRAY NM
     C*            Y    -    ARRAY NM1, NM2, NM3, AMOUNTS FIELDS
     C*
     C           NUMBER    BEGSR
     C* CLEAR AMOUNT LINES TWO AND THREE
     C                     MOVEA*BLANK    NM2
     C                     MOVEA*BLANK    NM3
     C/COPY WNCPYSRC,FT0580C030
     C* READ CURRENCY RECORD
     C                     EXSR CURRY
     C/COPY WNCPYSRC,FT0580C031
     C           13        SUB  CDP       DP      30
     C                     MOVE CQAM      AMOUNT 13
     C/COPY WNCPYSRC,FT0580C048
     C                     MOVEAAMOUNT    NM
     C                     Z-ADD1         M       30
     C* LOOP TO SUPPRESS LEADING ZEROS
     C           M         DOUEQDP                         B001
     C           NM,M      IFEQ ' '                        B002
     C           NM,M      OREQ '0'
     C                     MOVE ' '       NM,M
     C                     ADD  1         M
     C                     ELSE                            X002
     C                     Z-ADDDP        M
     C                     END                             E002
     C                     END                             E001
     C* SET IN INDS 30,31,32,33 DEPENDING ON NUMBER OF DECIMAL PLACES
     C                     MOVEA'0000'    *IN,30
     C           30        ADD  CDP       Q       30
     C                     MOVEA'1'       *IN,Q
     C* MOVE STARS TO AMOUNT LINE 1
     C                     MOVEA*ALL'*'   NM1
     C* MOVE DECIMALS TO LINE 1 AND SET SUBSCRIPTS
     C           CDP       IFEQ 3                          B001
     C                     MOVEA'/1000'   NM1,31
     C/COPY WNCPYSRC,FT0580C049
     C                     MOVE NM,13     NM1,30
     C                     MOVE NM,12     NM1,29
     C                     MOVE NM,11     NM1,28
     C                     Z-ADD26        Y       30
     C                     Z-ADD11        X       30
     C/COPY WNCPYSRC,FT0580C050
     C                     ELSE                            X001
     C           CDP       IFEQ 2                          B002
     C                     MOVEA'/100'    NM1,32
     C/COPY WNCPYSRC,FT0580C051
     C                     MOVE NM,13     NM1,31
     C                     MOVE NM,12     NM1,30
     C                     Z-ADD28        Y
     C                     Z-ADD12        X
     C/COPY WNCPYSRC,FT0580C052
     C                     ELSE                            X002
     C           CDP       IFEQ 1                          B003
     C                     MOVEA'/10'     NM1,33
     C/COPY WNCPYSRC,FT0580C053
     C                     MOVE NM,13     NM1,32
     C                     Z-ADD30        Y
     C                     Z-ADD13        X
     C/COPY WNCPYSRC,FT0580C054
     C                     ELSE                            X003
     C                     Z-ADD35        Y
     C/COPY WNCPYSRC,FT0580C055
     C                     Z-ADD14        X
     C/COPY WNCPYSRC,FT0580C056
     C                     END                             E003
     C                     END                             E002
     C                     END                             E001
     C* MOVE NUMBER S IN WORDS TO FIELDS
     C* UNTIL SUBSCRIPT = 1 OR UNTIL DIGIT IS BLANK
     C           X         DOUEQ1                          B001
     C           NM,W      OREQ ' '
     C                     SUB  1         X
     C                     Z-ADD0         V       30
     C                     MOVE NM,X      V
     C           V         IFLT 0                          B002
     C           0         SUB  V         V
     C                     END                             E002
     C                     ADD  1         V
     C* IF WORD WOULD OVERLAP LINE GO TO NEXT LINE
     C           DG,V      IFGT Y                          B002
     C           *IN29     IFNE '1'                        B003
     C                     MOVEA*ALL'*'   NM2
     C                     SETON                     29
     C                     ELSE                            X003
     C                     MOVEA*ALL'*'   NM3
     C                     SETON                     35
     C                     SETOF                     29
     C                     END                             E003
     C                     Z-ADD35        Y
     C                     END                             E002
     C* MOVE LETTERS OF WORD ONE AT A TIME
     C* ARRAY HAS BEEN SET UP WITH WORDS BACK TO FRONT
     C                     Z-ADD1         L       30
     C                     MOVEANN,V      NB
     C           L         DOUGTDG,V                       B002
     C  N29N35             MOVE NB,L      NM1,Y            LINE 1
     C   29                MOVE NB,L      NM2,Y            LINE 2
     C   35                MOVE NB,L      NM3,Y            LINE 3
     C                     SUB  1         Y
     C                     ADD  1         L
     C                     END                             E002
     C                     SUB  1         Y
     C           X         SUB  1         W       30
     C                     END                             E001
     C                     ENDSR
     C*
     C************************************************************
     C* END OF NUMBERS SUBROUTINE
     C************************************************************
     C/EJECT
     C************************************************************
     C* DATE SR.
     C*
     C* CONVERT DDMMYY TO DDMMMYY
     C*
     C* PERFORMED FROM       - OTCQ
     C*                        PYCQ
     C*
     C           DATE      BEGSR
      *                                                                   195352
      *  Check for the date format as there will be different in          195352
      *  date formatting.                                                 195352
      *                                                                   195352
     C           DATF      IFEQ 'D'                        DDMMYY         195352
     C                     Z-ADDIDD       ODD              DAYS
     C                     Z-ADDIYY       OYY              YEAR
     C           IMM       IFGT 0
     C           IMM       ANDLT13
     C                     MOVEAMM,IMM    OMM              MONTH
     C                     END
     C                     ELSE                            MMDDYY         195352
     C                     Z-ADDIMM       ODD              DAYS           195352
     C                     Z-ADDIYY       OYY              YEAR           195352
     C           IDD       IFGT 0                                         195352
     C           IDD       ANDLT13                                        195352
     C                     MOVEAMM,IDD    OMM              MONTH          195352
     C                     END                                            195352
     C                     END                                            195352
     C                     ENDSR
     C*
     C************************************************************
     C* END OF DATE CONVERSION SUBROUTINE
     C************************************************************
     C/EJECT
     C************************************************************
     C* CURRY SR.
     C*
     C* READS TABTG10 FOR CURRENCY RECORD
     C*
     C* PERFORMED FROM       - OTUP
     C*                        PYUP
     C*                        NUMBER
     C*
     C           CURRY     BEGSR
     C                     MOVE *BLANK    KEY
     C                     MOVEL'20'      KEY
     C/COPY WNCPYSRC,FT0580C032
     C*********************MOVELPCCY      LGCY    4                       CFT006
     C                     MOVELADCCY     LGCY    4                       CFT006
     C                     MOVE '1'       LGCY
     C/COPY WNCPYSRC,FT0580C045
     C                     MOVE LGCY      KEY
     C           KEY       CHAINTABTG10F             88
     C  N88      RECI      COMP 'D'                  8888
     C   88                DO                              B001
     C           *LOCK     IN   *NAMVAR
     C                     MOVE 'FT0580  'DBPGM            ***************
     C*********************MOVE 'TABLE'   DBFILE           * DB ERROR 18 *S01194
     C                     MOVE 'TABTG10' DBFILE           ***************S01194
     C                     Z-ADD18        DBASE            ***************
     C                     MOVE *BLANK    DBKEY
     C                     MOVELKEY       DBKEY
     C                     OUT  *NAMVAR
     C                     SETON                     U7U8LR
     C*********************OPEN FT0580P2                                  S01194
     C*********************WRITEFT580P2F                                  S01194
     C*********************CLOSEFT0580P2                                  S01194
     C                     OPEN FT0580AU                                  S01194
     C                     WRITEFT580AUF                                  S01194
     C                     CLOSEFT0580AU                                  S01194
     C                     DUMP
     C                     RETRN
     C                     END                             E001
     C/COPY WNCPYSRC,FT0580C002
     C                     ENDSR
     C*
     C************************************************************
     C* END OF CURRENCY SUBROUTINE
     C************************************************************
     C/EJECT
     C************************************************************
     C* HELP SR.                                                          S01199
     C*                                                                   S01199
     C* CALLS HELP PROGRAM                                                S01199
     C*                                                                   S01199
     C* PERFORMED FROM MAIN SECTION                                       S01199
     C*                                                                   S01199
     C**         HELP      BEGSR                                          S01199
     C**                   MOVEAERCD      HERCD 160                       S01199
     C**                   CALL 'MHELP'                                   S01199
     C**                   PARM 'FT0000'  HBPGM   6                       S01199
     C**                   PARM           HERCD                           S01199
     C**                   SETOF                     01                   S01199
     C**                   ENDSR                                          S01199
     C*                                                                   S01199
     C************************************************************        S01199
     C* END OF HELP SUBROUTINE                                            S01199
     C************************************************************
     C/EJECT
     C********************************************************************
     C**
     C**   ZALIGN0SR. TO VALIDATE AND RIGHT-ALIGN NUMERIC FIELDS.
     C**
     C           ZALIGN    BEGSR                           *** ZALIGN ***
     C**
     C                     SETOF                     929399
     C**
     C**   SAVE INPUT FIELD IN ARRAY, ZA1.
     C                     MOVEAZFIELD    ZA1
     C**
     C**   CALCULATION TO DEFINE NUMBER STRUCTURE CONTROL FIELDS.
     C                     Z-ADDZADIG     ZADIG   20
     C                     Z-ADDZADEC     ZADEC   10
     C**
     C**   CALCULATIONS TO DEFINE/CLEAR FIELDS.
     C                     MOVE ' '       ZA2
     C                     MOVEAZA2       ZFIELD 16
     C                     Z-ADD0         ZX      20
     C                     Z-ADD0         ZY      20
     C**
     C**   ENSURE REQUIRED STRUCTURE OF FIELD IS VALID.
     C           ZADIG     ADD  ZADEC     ZZ      20
     C           ZZ        COMP 15                   99
     C   99                GOTO ZAEND
     C**
     C**   LOOP TO FIND DECIMAL POINT, BLANKS AND CHARACTERS.
     C           ZATAG1    TAG                             ** ZATAG1 TAG *
     C           ZX        ADD  1         ZX
     C**
     C**   CHECK FOR DECIMAL POINT. ERROR IF SECOND DECIMAL POINT.
     C           ZA1,ZX    COMP '.'                      90
     C   90 93             SETON                     99
     C   99                GOTO ZAEND
     C**
     C**
     C**   CHECK FOR 'M' CONSTANT. ERROR IF NOT LAST CHARACTER ENTERED
     C           ZA1,ZX    COMP 'M'                      96
     C   96                DO                              B001
     C           ZX        COMP 15                   99  99
     C   99                GOTO ZAEND
     C           ZX        ADD  1         ZX
     C           ZA1,ZX    COMP ' '                  9999
     C   99                GOTO ZAEND
     C           ZX        SUB  1         ZX
     C           ZX        COMP 9                    99
     C   99                GOTO ZAEND
     C                     END                             E001
     C**
     C**   CHECK FOR 'T' CONSTANT. ERROR IF NOT LAST CHARACTER ENTERED
     C           ZA1,ZX    COMP 'T'                      97
     C   97                DO                              B001
     C           ZX        COMP 15                   99  99
     C   99                GOTO ZAEND
     C           ZX        ADD  1         ZX
     C           ZA1,ZX    COMP ' '                  9999
     C   99                GOTO ZAEND
     C           ZX        SUB  1         ZX
     C           ZX        COMP 12                   99
     C   99                GOTO ZAEND
     C                     END                             E001
     C**
     C**   CLEAR ALPHAMERIC CONSTANT FROM ZA1
     C   96
     COR 97                MOVE ' '       ZA1,ZX
     C**
     C**   CHECK FOR BLANKS. BYPASS FOR FIRST BLANK AFTER A DIGIT.
     C           ZA1,ZX    COMP ' '                      91
     C   91 92             GOTO ZATAG2
     C**
     C**   CHECK FOR NUMERIC, IF NOT '.' OR ' '.
     C  N90N91   ZA1,ZX    COMP '0'                    99
     C  N90N91N99ZA1,ZX    COMP '9'                  99
     C   99                GOTO ZAEND                      NOT NUMERIC
     C**
     C**   STORE DIGITS IN ARRAY AND HOW MANY.
     C**   ZY, TOTAL OF DIGITS IN THE INPUT FIELD.
     C**   ZZ, TOTAL OF DIGITS TO THE LEFT OF DECIMAL POINT.
     C  N90N91   ZY        ADD  1         ZY         92
     C  N90N91             MOVE ZA1,ZX    ZA2,ZY
     C   90                Z-ADDZY        ZZ         93  93
     C**
     C           ZX        COMP 16                     94  CHECK IF ALL
     C   94                GOTO ZATAG1
     C**
     C           ZATAG2    TAG                             ** ZATAG2 TAG *
     C**
     C**   IF 'M' SPECIFIED, MULTIPLY ZA1 BY 1 MILLION
     C   96      ZZ        ADD  6         ZZ
     C**
     C**   IF 'T' SPECIFIED, MULTIPLY ZA1 BY 1 THOUSAND
     C   97      ZZ        ADD  3         ZZ
     C**
     C**   FILL IN ZEROS IN ANY BLANKS LEFT OF DECIMAL POINT
     C   96 93
     COR 97 93   ZZ        DOWGTZY                         B001
     C           ZY        ADD  1         ZY
     C                     MOVE '0'       ZA2,ZY
     C                     END                             E001
     C**
     C**   IF CONSTANT SPECIFIED WITH NO DECIMAL POINT ZEROISE BLANKS
     C   96N93             DO   6                          B001
     C           ZY        ADD  1         ZY
     C                     MOVE '0'       ZA2,ZY
     C                     END                             E001
     C**
     C   97N93             DO   3                          B001
     C           ZY        ADD  1         ZY
     C                     MOVE '0'       ZA2,ZY
     C                     END                             E001
     C**
     C**   IF NO DECIMAL POINT FOUND, SET TOTAL FIELD ZZ.
     C  N93                Z-ADDZY        ZZ
     C**
     C**   CHECK FOR EMBEDDED BLANKS.
     C   91 92             MOVEAZA1,ZX    ZFIELD
     C   91 92   ZFIELD    COMP ' '                  9999
     C   99                GOTO ZAEND                      EMBEDDED BLANK
     C**
     C**   ENSURE THAT NUMBER OF DIGITS ENTERED EITHER SIDE
     C**   OF DECIMAL POINT ARE NOT MORE THAN ALLOWED.
     C           ZZ        COMP ZADIG                99
     C           ZY        SUB  ZZ        ZX
     C  N99      ZADEC     SUB  ZX        ZX           9995
     C   99                GOTO ZAEND
     C   95                GOTO ZATAG4                     NO TRAILING
     C**                                                   BLANKS.
     C**   FILL THE TRAILING BLANKS WITH ZEROS.
     C           ZY        ADD  ZX        ZZ
     C           ZATAG3    TAG                             ** ZATAG3 TAG *
     C           ZY        ADD  1         ZY
     C                     MOVE '0'       ZA2,ZY
     C           ZY        COMP ZZ                     94
     C   94                GOTO ZATAG3
     C**
     C**   RIGHT-ALIGN THE VALUE BY MOVING BACK TO ARRAY, ZA1.
     C           ZATAG4    TAG                             ** ZATAG4 TAG *
     C                     MOVE '0'       ZA1
     C                     Z-ADD16        ZX
     C           ZATAG5    TAG                             ** ZATAG5 TAG *
     C           ZY        COMP 0                        94
     C   94                GOTO ZATAG6
     C                     MOVE ZA2,ZY    ZA1,ZX
     C           ZY        SUB  1         ZY
     C           ZX        SUB  1         ZX
     C                     GOTO ZATAG5
     C           ZATAG6    TAG                             ** ZATAG6 TAG *
     C**
     C**   MOVE VALIDATED AND RIGHT-ALIGNED NUMBER BACK INTO ZFIELD.
     C                     MOVEAZA1       ZFIELD
     C**
     C                     SETOF                     9697
     C**
     C           ZAEND     ENDSR                           * ZAEND ENDSR *
     C**
     C**
     C********************************************************************
     C/EJECT
     C********************************************************************
     C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
     C*   IND '99' IS SET BY AN OVERFLOW ERROR
     C*
     C           GLZADD    BEGSR                           *** GLZADD ****
     C*
     C                     Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
     C   91                GOTO ZZAEND                     AMT = 0.BYPASS
     C*
     C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
     C                     Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
     C                     MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
     C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
     C*
     C                     EXSR GLZSUM
     C           ZZAEND    ENDSR                           ** ZZAEND TAG *
     C*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
     C*                        GLZADD, GLZSUB, GLZCMP.
     C*          PARAMETERS PASSED -
     C*                     I/P ZZAMTI ZZAMTD
     C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
     C*
     C           GLZSUM    BEGSR                           *** GLZSUM ****
     C*
     C                     Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
     C                     Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
     C                     SETOF                     919293
     C                     SETOF                     949599
     C*
     C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
     C           ZZAMTI    COMP 0                      9293
     C   93      ZZAMTD    COMP 0                      9293
     C   93                GOTO ZZSEND                     ZERO BYPASS
     C*
     C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
     C           ZZTOTI    COMP 0                      9193
     C   93      ZZTOTD    COMP 0                      9193
     C*
     C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
     C   93                Z-ADDZZAMTI    ZZTOTI
     C   93                Z-ADDZZAMTD    ZZTOTD
     C   93                GOTO ZZSEND                     ZERO BYPASS
     C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
     C   91N92
     CORN91 92             GOTO ZZOFPS
     C*
     C           ZZAMTD    ADD  ZZTOTD    ZZWK2   40
     C           ZZWK2     COMP 999                  93    '93' = CARRY
     C  N93      ZZWK2     COMP -999                   93    INTO INTEGER.
     C*
     C   93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
     C      93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
     C   93      ZZTOTI    ADD  ZZWK3     ZZWK3
     C  N93      ZZTOTI    ADD  ZZAMTI    ZZWK3
     C*
     C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
     C  N92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
     C   92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
     C  N99                Z-ADDZZWK2     ZZTOTD
     C  N99                Z-ADDZZWK3     ZZTOTI
     C*
     C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
     C   99                Z-ADD0         ZZAMT  153
     C                     GOTO ZZSEND
     C*
     C* THE 'SIGNS' ARE DIFFERENT
     C           ZZOFPS    TAG                             ** ZZOFPS TAG**
     C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
     C*
     C   92                Z-SUBZZAMTI    ZZAMTI 150
     C   92                Z-SUBZZAMTD    ZZAMTD  30
     C*
     C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
     C*
     C   91                Z-SUBZZTOTI    ZZTOTI
     C   91                Z-SUBZZTOTD    ZZTOTD
     C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
     C*
     C           ZZTOTI    COMP ZZAMTI               93  95
     C   95      ZZTOTD    COMP ZZAMTD               93  95
     C*
     C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
     C   95                Z-ADD0         ZZTOTI
     C   95                Z-ADD0         ZZTOTD
     C   95                GOTO ZZSEND
     C*
     C* IF ZZTOT GT. ZZAMT.
     C   93      ZZAMTD    COMP ZZTOTD               94
     C   93 94   ZZTOTI    SUB  1         ZZTOTI
     C   93 94   ZZTOTD    ADD  1000      ZZWK2
     C   93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
     C   93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
     C   93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
     C*
     C*
     C* IF ZZAMT GT. ZZTOT.
     C  N93      ZZTOTD    COMP ZZAMTD               94
     C  N93 94   ZZAMTI    SUB  1         ZZWK3  150
     C  N93 94   ZZAMTD    ADD  1000      ZZWK2
     C  N93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
     C  N93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
     C  N93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
     C  N93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
     C*
     C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
     C                     SETOF                     94
     C   93 91
     CORN93 92             SETON                     94
     C   94                Z-SUBZZTOTI    ZZTOTI
     C   94                Z-SUBZZTOTD    ZZTOTD
     C**
     C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
     C   92                Z-SUBZZAMTI    ZZAMTI
     C   92                Z-SUBZZAMTD    ZZAMTD
     C           ZZSEND    TAG                             ** ZZSEND TAG *
     C**
     C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
     C                     SETOF                     96
     C           ZZTOTD    COMP 0                        91
     C   91      ZZTOTI    COMP 0                      96
     C   96                MOVE '.000-'   ZZNEGD  5
     C                     ENDSR                             ** ENDSR **
     C********************************************************************
     ** END OF SUBROUTINE
     C********************************************************************
     C********************************************************************
     C/EJECT
     C********************************************************************
     ** THIS IS PERFORMED ONLY IF CHEQUE TYPE IS 'D'
     C           SRNEW     BEGSR
     **   PROMPT FOR UPDATE.
     C           *IN67     IFEQ '1'
     C           *IN89     DOUEQ'0'                        B006
     C           *IN11     ANDEQ'0'
     C  N89                MOVE ' '       CQSC             CLEAR
     C                     EXFMTFT580DF2                   SCREEN 2
     C           *IN01     IFEQ '1'
     C                     EXSR RNMBCK
     C   25                EXSR FINAL
     C                     SETON                     LR
     C                     RETRN
     C                     END
     C** 11                EXSR HELP                       HELP           S01199
     C**N11                EXSR VALTWO                     VALIDATION     S01199
     C                     EXSR VALTWO                     VALIDATION     S01199
     C* IF CHEQUE PRINTING SUCCESSFUL UPDATE FILES
     C  N11N89 58CQSC      CASEQ'Y'       @UPDAT           B007
     C                     END                             E007
     C***59****************EXSR @OTCQ                                     CFT006
     C**N59****************EXSR @PYCQ                                     CFT006
      *                                                                   CFT006
     C           *IN59     IFEQ *ON                                       CFT006
     C           *IN73     ANDEQ*OFF                                      CFT006
     C           *IN74     ANDEQ*OFF                                      CFT006
     C                     EXSR @OTCQ                                     CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C           *IN59     IFEQ *OFF                                      CFT006
     C           *IN73     ANDEQ*OFF                                      CFT006
     C           *IN74     ANDEQ*OFF                                      CFT006
     C                     EXSR @PYCQ                                     CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C           CFT006    IFEQ 'Y'                                       CFT006
     C           *IN73     ANDEQ*ON                                       CFT006
     C                     EXSR @RFTCQ                                    CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C           CFT008    IFEQ 'Y'                                       CFT006
     C           *IN74     ANDEQ*ON                                       CFT006
     C                     EXSR @CCTCQ                                    CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     END                             E006
     C                     END                             E006
     C**
     C**
     C           ATYPE     CABEQ' '       NEWEND
     C**
     C**
     C**
     C   67                EXSR RNMBCK
     C**
     C                     MOVE '1'       *IN58
     ** PROMT FOR CHEQUE NUMBER & NEXT DRAWEE
     **          *IN67     IFEQ '1'
     C           *IN89     DOUEQ'0'                        B006
     C           *IN11     ANDEQ'0'
     C           NEWTAG    TAG
     C                     MOVELADDR1     ADDRX
     C  N89                MOVE ' '       LNID
     C/COPY WNCPYSRC,FT0580C097                                                               CFT118
     C  N89                MOVE *BLANK    CQNMB
     C                     EXFMTFT580DF1                   SCREEN 2
     C/COPY WNCPYSRC,FT0580C098                                                               CFT118
     **  F3 TO EXIT.
     C           *IN01     IFEQ '1'
     C   25                EXSR FINAL
     C                     SETON                     LR
     C                     RETRN
     C                     END
     **  EXECUTE HELP
     C** 11                EXSR HELP                       HELP           S01199
     C**N11                EXSR @VALON                     VALIDATION     S01199
     C                     EXSR @VALON                     VALIDATION     S01199
     C* IF CHEQUE PRINTING SUCCESSFUL UPDATE FILES
     C                     END                             E006
     **  PRINT ALIGNMENT
     C           LNID      IFEQ 'Y'                        B004
     C   62                EXSR RMVOVR                     LINE-UP
     C                     EXSR LINUP
     C                     GOTO NEWTAG
     C                     END                             E006
     **
     **                    END                             E006
     **
     C                     EXSR RNMOVR
     **
     C  N67                MOVE '1'       *IN67
     C           NEWEND    ENDSR                           TAG** ADDEND
     C*
     C************************************************************
     C* END OF ADDRESS SUBROUTINE
     C************************************************************
     C********************************************************************
     C/EJECT
     C********************************************************************
     ** RENAME BACK PRINTER FILE TO ORIGINAL NAME
     C           RNMBCK    BEGSR
     C   26                DO                              B001
     C/COPY WNCPYSRC,FT0580C033
     C                     CLOSEFT0580P1
     C/COPY WNCPYSRC,FT0580C034
     C                     SETOF                     26
     C                     END                             E001
     **
     C                     MOVE *BLANK    PRX
     C                     MOVEA'RNMOBJ ' PRX,1
     C                     MOVEAPRTFIL    PRX,2
     C                     MOVEA'*FILE'   PRX,3
     C/COPY WNCPYSRC,FT0580C035
     C                     MOVEA'FT0580P1'PRX,4
     C/COPY WNCPYSRC,FT0580C036
     C                     MOVE *BLANK    PARAX
     C                     MOVEAPRX       PARAX  48
     C                     Z-ADD48        PRMLEN
     **
     C**************       CALL 'QCAEXEC'                                 E21142
     C                     CALL 'QCMDEXC'                                 E21142
     C                     PARM           PARAX
     C                     PARM           PRMLEN 155
     C                     ENDSR
     C********************************************************************
     ** END OF SUBROUTINE
     C********************************************************************
     **
     C********************************************************************
     C/EJECT
     C********************************************************************
     ** RENAME ORIGINAL PRINTER FILE TO THE NEWLY FORMATTED NAME AND
     ** OVERIDE OLD NAME TO NEW NAME.
     C           RNMOVR    BEGSR
      *                                                                CFT006
      * CLOSE PRINTER FILE IF OPEN                                     CFT006
     C           *IN26     IFEQ *ON                                    CFT006
     C/COPY WNCPYSRC,FT0580C061
     C                     CLOSEFT0580P1                               CFT006
     C/COPY WNCPYSRC,FT0580C062
     C                     SETOF                         26            CFT006
     C                     ENDIF                                       CFT006
      *                                                                CFT006
     **  FORMAT PRINTER FILE DEPENDING ON PARTY TYPE.
     C                     MOVE *BLANK    PRTFIL 10
     C                     MOVEL'DRAF'    PRTFIL
     C                     MOVE *BLANK    PRTFL1 06
     C                     MOVE *BLANK    PRTFL2 05
     C                     MOVE *BLANK    PRTFL3 03
     C                     MOVE *BLANK    PRTFL4 02
     C           ATYPE     IFEQ 'F'
     C                     MOVELINAD1     PRTFL2
     C                     MOVELPRTFL2    PRTFL1
     C                     MOVE PRTFL1    PRTFIL
     C                     ELSE
     C           ATYPE     IFEQ 'N'
     C                     MOVE ADCCY     PRTFL3
     C                     MOVELINAD1     PRTFL4
     C                     MOVELPRTFL3    PRTFL2
     C                     MOVE PRTFL4    PRTFL2
     C                     MOVELPRTFL2    PRTFL1
     C                     MOVE PRTFL1    PRTFIL
     C                     ELSE
     C                     MOVELINAD1     PRTFL1
     C                     MOVE PRTFL1    PRTFIL
     C                     END
     C                     END
     C                     MOVE *BLANK    PRX
     C                     MOVEA'RNMOBJ ' PRX,1
     C/COPY WNCPYSRC,FT0580C037
     C                     MOVEA'FT0580P1'PRX,2
     C/COPY WNCPYSRC,FT0580C038
     C                     MOVEA'*FILE'   PRX,3
     C                     MOVEAPRTFIL    PRX,4
     C                     MOVE *BLANK    PARAX
     C                     MOVEAPRX       PARAX  48
     C                     Z-ADD48        PRMLEN
     ** RENAME ORIGINAL TO NEW NAME
     C**************       CALL 'QCAEXEC'                                 E21142
     C                     CALL 'QCMDEXC'                                 E21142
     C                     PARM           PARAX
     C                     PARM           PRMLEN 155
     **
     C                     MOVE *BLANK    PRM
     C                     MOVEA'OVRPRTF' PRM,1
     C/COPY WNCPYSRC,FT0580C039
     C                     MOVEA'FT0580P1'PRM,2
     C/COPY WNCPYSRC,FT0580C040
     C                     MOVEAPRTFIL    PRM,3
     C                     MOVE *BLANK    PARAM
     C*********************MOVEAPRM       PARAM  34                       S01117
     C                     MOVEAPRM       PARAM  52                       S01117
     C                     MOVEL'OUTQ('   WFLD15 15                       S01117
     C                     MOVE PARM1     WFLD15                          S01117
     C                     MOVELWFLD15    WFLD16 16                       S01117
     C                     MOVE ')'       WFLD16                          S01117
     C                     MOVE WFLD16    PARAM                           S01117
     C*********************Z-ADD34        PRMLEN                          S01117
     C                     Z-ADD52        PRMLEN                          S01117
     **  OVERIDE ORIGINAL TO NEW NAME
     C**************       CALL 'QCAEXEC'                                 E21142
     C                     CALL 'QCMDEXC'                                 E21142
     C                     PARM           PARAM
     C                     PARM           PRMLEN 155
     C                     MOVE '1'       *IN62
     **
     C  N26                DO                              B001
     C/COPY WNCPYSRC,FT0580C041
     C                     OPEN FT0580P1
     C/COPY WNCPYSRC,FT0580C042
     C                     SETON                     26
     C                     END                             E001
     C                     ENDSR
     C************************************************************
     C/EJECT
     C************************************************************
     C           RMVOVR    BEGSR
     **
     **
     C                     MOVE *BLANK    PRM
     C                     MOVEL'DLTOVR  'PRM,1
     C/COPY WNCPYSRC,FT0580C043
     C                     MOVEL'FT0580P1'PRM,2
     C/COPY WNCPYSRC,FT0580C044
     C                     MOVEAPRM       PARAM
     C                     Z-ADD24        PRMLEN
     **
     **  DELETE OVERIDE PRINTER FILE FT0580P1
     C**************       CALL 'QCAEXEC '                                E21142
     C                     CALL 'QCMDEXC '                                E21142
     C                     PARM           PARAM
     C                     PARM           PRMLEN
     C                     MOVE '0'       *IN62
     C                     ENDSR
     C************************************************************
     ** END OF SUBROUTINE
     C************************************************************
     C/EJECT
     C************************************************************
     C* VALONE SR.
     C*
     C* VALIDATE SCREEN 1
     C*
     C* PERFORMED FROM SRNEW ONLY.
     C*
     C* PERFORMS SUBROUTINE - ZALIGN
     C*
     C           @VALON    BEGSR
     C* CLEAR ERROR CODES AND RESET ERROR CODE SUBSCRIPT Z
     C* SETOF ERROR INDICATORS 20-23 AND 89
     C                     MOVEA*BLANK    ERCD
     C                     Z-ADD1         Z       30
     C                     SETOF                     171819               S01117
     C                     MOVEA'0000'    *IN,20
     C                     SETOF                     89
     C* LINE-UP INDICATOR MUST BE 'Y' OR BLANK
     C           LNID      IFNE 'Y'                        B001
     C           LNID      ANDNE' '
     C                     SETON                     2089  NOT Y OR
     C*********************MOVEA' 309'    ERCD,Z           BLANK          S01117
     C                     MOVEA' 006'    ERCD,Z           BLANK          S01117
     C                     ADD  1         Z
     C                     END                             E001
     C* IF PRINT IND BLANK CHEQUE NUMBER NOT ALLOWED
     C           CQNMB     IFNE *BLANK                     B002
     C           LNID      ANDNE*BLANK
     C                     SETON                     2389
     C*********************MOVEA' 314'    ERCD,Z                          S01117
     C                     MOVEA' 011'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     END                             E002
     C* IF PRINT IND ENTERED CHEQUE NUMBER MUST BE VALID NUMERIC
     C           LNID      IFEQ *BLANK
      *                                                                   E21457
      **  CHEQUE NUMBER SHOULD NOT BE ZERO                                E21457
      *                                                                   E21457
     C           CQNMB     IFEQ *ZEROS                                    E21457
     C           CQNMB     OREQ *BLANK                                    E37520
     C                     SETON                     2389                 E21457
     C*********************MOVEA' 320'    ERCD,Z                    E21457S01117
     C                     MOVEA' 013'    ERCD,Z                          S01117
     C                     ADD  1         Z                               E21457
     C                     ELSE                                           E21457
      *                                                                   E21457
     C                     MOVE *BLANK    ZFIELD
     C                     MOVE CQNMB     ZFIELD
     C                     Z-ADD9         ZADIG
     C                     Z-ADD0         ZADEC
     C                     EXSR ZALIGN
     C           *IN99     IFEQ '1'                        B002
     C                     SETON                     2389
     C*********************MOVEA' 315'    ERCD,Z                          S01117
     C                     MOVEA' 012'    ERCD,Z                          S01117
     C                     ADD  1         Z
     C                     ELSE                            X002
     C                     MOVE ZFIELD    CQNUM   90
     C                     END                             E002
     C                     END                                            E21457
     **
     C                     END                             E001
     C                     ENDSR
     C*
     C************************************************************
     C* END OF SCREEN 1 VALIDATION
     C************************************************************
     C************************************************************        CCG015
     C* Merge Extraction Files                                   *        CCG015
     C************************************************************        CCG015
     C           MRGEXT    BEGSR                                          CCG015
      *                                                                   CCG015
     C           CCG015    IFNE 'Y'                                       CCG015
     C                     GOTO EMGEXT                                    CCG015
     C                     ENDIF                                          CCG015
      *                                                                   CCG015
     C                     CALL 'CGC3606'              90                 CCG015
     C                     PARM           P@RTN  10                       CCG015
     C           P@RTN     IFEQ '*ERROR'                                  CCG015
     C           *IN90     OREQ '1'                                       CCG015
     C           *LOCK     IN   *NAMVAR                                   CCG015
     C                     MOVE 'FT0580  'DBPGM            ***************CCG015
     C                     MOVEL'CGC3606 'DBFILE           * DB ERROR 37  CCG015
     C                     Z-ADD37        DBASE            ***************CCG015
     C                     MOVE *BLANK    DBKEY                           CCG015
     C                     MOVEL'*CALL'   DBKEY                           CCG015
     C                     OUT  *NAMVAR                                   CCG015
     C                     SETON                     U7U8LR               CCG015
     C                     OPEN FT0580AU                                  CCG015
     C                     WRITEFT580AUF                                  CCG015
     C                     CLOSEFT0580AU                                  CCG015
     C                     DUMP                                           CCG015
     C                     RETRN                                          CCG015
     C                     ENDIF                                          CCG015
      *                                                                   CCG015
     C           EMGEXT    ENDSR                                          CCG015
     **
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0580CCP4                                           S01408
     C*                                                                   S01408
     C/COPY ZSRSRC,ZDATE2Z2                                               CFT006
     **
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
     X/COPY WNCPYSRC,FT0580X001
**   NN   - NUMBERS IN WORDS IN REVERSE
OREZ
ENO
OWT
EERHT
RUOF
EVIF
XIS
NEVES
THGIE
ENIN
**   DG   - NUMBER OF LETTERS IN NUMBER
4335443554
**   MM   - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
     X/COPY WNCPYSRC,FT0580X002
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
