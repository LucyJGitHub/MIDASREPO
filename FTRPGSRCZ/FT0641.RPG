     H        1   D                       F
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas FT Customer transfers (non-input cycle)')        *
      *****************************************************************
      *                                                               *
      *  Midas - Funds Transfer Module                                *
      *                                                               *
      *  FT0641 - Customer Transfers                                  *
      *                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. MD055960A          Date 08Jul20               *
      *  Prev Amend No. MD055960           Date 09Jun20               *
      *                 ERZ248             Date 18Nov19               *
      *                 CER050             Date 16Jun19               *
      *                 CSW218             Date 19Mar18               *
      *                 MD048075           Date 09Nov17               *
      *                 MD046248           Date 27Oct17               *
      *                 MD045920           Date 04Jul17               *
      *                 MD046436           Date 04Jul17               *
      *                 252874             Date 25Jan17               *
      *                 CSW215             Date 06Apr15               *
      *                 MD033624           Date 14Apr15               *
      *                 AR945367A          Date 13Mar15               *
      *                 MD023383           Date 12Nov13               *
      *                 MD021993           Date 13Sep13               *
      *                 CSW213             Date 03Jun13               *
      *                 MD021101           Date 01Jul13               *
      *                 AR972805           Date 27Feb13               *
      *                 260987A            Date 06Feb13               *
      *                 AR891217           Date 25Jan13               *
      *                 CFT120             Date 28Sep12               *
      *                 263187             Date 28Sep12               *
      *                 AR818552           Date 28Sep12               *
      *                 CFT124             Date 28Sep12               *
      *                 CFT039             Date 28Sep12               *
      *                 CMS006             Date 28Sep12               *
      *                 AR787620           Date 10Jun11               *
      *                 CRE075             Date 06Dec10               *
      *                 263776             Date 04Feb10               *
      *                 223191             Date 24Aug05               *
      *                 CER059             Date 19Jul10               *
      *                 BUG24029           Date 20May09               *
      *                 CER054             Date 07Apr09               *
      *                 BUG22580           Date 02Feb09               *
      *                 CER048             Date 19May08               *
      *                 CER047             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 BUG26018           Date 16Sep09               *
      *                 BUG24937           Date 17Jul09               *
      *                 252903A            Date 16Jul09               *
      *                 BUG24436           Date 18Jun09               *
      *                 CSW209             Date 01Apr09               *
      *                 257632             Date 14Nov08               *
      *                 257491             Date 13Nov08               *
      *                 257347             Date 29Oct08               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 BUG21272           Date 07Oct08               *
      *                 246371             Date 09Jun07               *
      *                 BUG15155A          Date 31Oct07               *
      *                 BUG15183           Date 19Oct07               *
      *                 BUG15201           Date 30Oct07               *
      *                 BUG15045           Date 19Oct07               *
      *                 BUG15044           Date 18Oct07               *
      *                 BUG15037           Date 17Oct07               *
      *                 250804A            Date 09Oct07               *
      *                 250804             Date 08Oct07               *
      *                 250600             Date 29Aug07               *
      *                 BUG14926           Date 01Oct07               *
      *                 BUG14915           Date 25Sep07               *
      *                 BUG14891           Date 21Sep07               *
      *                 BUG14771A          Date 18Aug07               *
      *                 BUG14771           Date 12Aug07               *
      *                 BUG14755           Date 05Aug07               *
      *                 CSW207A            Date 25Jul07               *
      *                 CSW207             Date 15Jun07               *
      *                 BUG14042           Date 24May07               *
      *                 246488             Date 19Mar07               *
      *                 BUG13528           Date 06Mar07               *
      *                 BUG13289           Date 17Feb07               *
      *                 BUG13274           Date 09Feb07               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 242289             Date 22Sep06               *
      *                 CFT032             Date 11Sep06               *
      *                 CSW206             Date 03Jul06               *
      *                 CSD031             Date 10Apr06               *
      *                 CFT023             Date 03Feb06               *
      *                 CDL049             Date 07Jul06               *
      *                 240676             Date 30Jun06               *
      *                 225715             Date 06Jun06               *
      *                 222559             Date 02May06               *
      *                 220913             Date 02May06               *
      *                 204225             Date 02May06               *
      *                 CSD027             Date 09Dec05               *
      * Midas Release 4.01.03 ----------------------------------------*
      *                 CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 BUG4695            Date 03Nov04               *
      *                 CLE025             Date 20Oct03               *
      *                 CGL029             Date 01Sep03               *
      *                 222385             Date 23Oct03               *
      *                 219242             Date 01Jul03               *
      *                 219241             Date 01Jul03               *
      *                 CSW203             Date 26May03               *
      *                 CSD015             Date 14Oct02               *
      * Midas Release 4.01.03 ----------------------------------------*
      *                 210858             Date 17Oct02               *
      * Midas Release 4.01.01 ----------------------------------------*
      *                 208890             Date 22Aug02               *
      *                 CSW202             Date 20May02               *
      * Midas Release 4.01 -------------------------------------------*
      *                 CSW025             Date 26Mar02               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 138077             Date 20Jun01               *
      *                 CSW201             Date 02May01               *
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CFT009             Date 01Jun00               *
      *                 189269             Date 26Jan01               *
      * Midas DBA 3.04 -----------------------------------------------*
      *                 CFT014             Date 25May00               *
      * Midas DBA 3.03 -----------------------------------------------*
      * Midas DBA 3.02 -----------------------------------------------*
      *                 CSW020             Date 10Jan00               *
      *                 CFT004             Date 27Aug99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 164663             DATE 25AUG99               *
      *                 151235             DATE 21DEC98               *
      *                 149197             DATE 08DEC98               *
      *                 CEU006             DATE 06APR98               *
      *                 113352             DATE 29JAN97               *
      *                 096267             DATE 19Feb98               *
      *                 S01408             DATE 18NOV96               *
      *                 CSW096             DATE 03JUN96               *
      *                 S01408             DATE 11JAN96               *
      *                 087873             DATE 01JUN95               *
      *                 088545             DATE 21JUN95               *
      *                 S01499             DATE 06JUN94               *
      *                 S01494             DATE 25MAY94               *
      *                 068367             DATE 18MAR94               *
      *                 068242             DATE 16MAR94               *
      *                 068230             DATE 23JAN94               *
      *                 064393             DATE 08DEC93               *
      *                 S01435             DATE 08SEP93               *
      *                 058476             DATE 20JUL93               *
      *                 055293             DATE 17MAY93               *
      *                 S01414             DATE 29MAR93               *
      *                 E32481             DATE 29JUL91               *
      *                 S01310             DATE 11JUL91               *
      *                 E25148             DATE 24MAY91               *
      *                 E32546             DATE 19APR91               *
      *                 S01194             DATE 05SEP90               *
      *                 S01117             DATE 05SEP90               *
      *                 E22406             DATE 05JUL90               *
      *                 E20980             DATE 08JUN90               *
      *                 E21465             DATE 16MAY90               *
      *                 E21462             DATE 14MAY90               *
      *                 E21471             DATE 04MAY90               *
      *                 E21467             DATE 27MAR90               *
      *                 E21286             DATE 01MAR90               *
      *                 S01177             DATE 22/11/89              *
      *                                                               *
      *---------------------------------------------------------------*
      *                                                               *
      *  M055960A - UETR is changed in through payment (ERZ248)       *
      *           Amend Hook ERZ248_004, ERZ248_005, ERZ248_006       *
      *  MD055960 - UETR is changed in through payment (ERZ248)       *
      *           Amend Hook ERZ248_004, ERZ248_005                   *
      *  ERZ248 - SWIFT UETR via OPAY API                             *
      *           Add hooks ERZ242_004->006                           *
      *           Amended hooks FT0641C062, FT0641F001                *
      *  CER050 - Annualised Percentage Rate (Recompile)              *
      *  CSW218 - SWIFT Changes 2018                                  *
      *  MD048075 - Field 50A instead of 50F in MT103 with CSW024 on  *
      *           - Add system value FTAllowFld50F to allow the use   *
      *             of tag 50F.                                       *
      *  MD046248 - Finastra Rebranding                               *
      *  MD045920 - Ordering Customer account number is missing from  *
      *             FT SWIFT payment.                                 *
      *  MD046436 - Reversal of 252874 (Applied for MD-43714)         *
      *  252874 - Tag :50K: not including the account line            *
      *           Applied for MD-43714.                               *
      *  CSW215 - SWIFT Changes 2015                                  *
      *  MD033624 - Error during Compilation due to conflict in field *
      *             definition. Renamed fields from OTPAYDD           *
      *  AR945367A - Tag 50K of MT103 messages is showing Retail and  *
      *              IBAN Account Identifiers. SR/SROUFM will only be *
      *              processed if CFT032 is *ON. (Child: AR945369)    *
      *            - Applied for MD-15968                             *
      *  MD023383 - STP is generated when IBAN is invalid             *
      *  MD021993 - No STP string output for MT103                    *
      *  CSW213 - SWIFT Changes 2013                                  *
      *  MD021101 - BankFusion Funds Transfer: Field 50F              *
      *  AR972805 - Remove equate translation as done externally.     *
      *             (Child: AR972806)                                 *
      *  260987A - Destination not always displayed on the report.    *
      *            Fields omitted on write to MGOREFPD. Wrong Sender  *
      *            address when network is Paper.                     *
      *  AR891217 - I/O error detected in MGOMSGPD during COB         *
      *             (Child: AR891218) Applied for AR1082072.          *
      *  CFT120 - FT IN/OP - Charges to DR of Account Currency        *
      *           (Recompile)                                         *
      *  263187 - Include 50K in MT202COV for Ordering Customer Type  *
      *           Address.                                            *
      *  AR818552 - Incorrect Town Name in Field 50F. Initialize      *
      *             fields used in ERZ155. (Child: AR818556)          *
      *  CFT124 - Ordering Customer of MT103 50K - 'Account' Formats  *
      *  CFT039 - SWIFT Mapping of Field Ordering Bank                *
      *  CMS006 - MT103 Field 53B change                              *
      *  AR787620 - Hooks Incorporation                               *
      *             WNCPYSRC,FTH00011                                 *
      *             WNCPYSRC,FTH00009                                 *
      *  CRE075 - Effective Date for Retail Accounts (Recompile)      *
      *  263776 - Match parameters of FT0641 and AOACCTV1.            *
      *  223191 - Invalid Test to determine 103+ if account with bank *
      *           entered with 8 characters or with Account/Clearing  *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  BUG24029 - COB Error RE3662 Database Error                   *
      *  CER054 - German Features - Church Tax (Recompile)            *
      *  BUG22580 - Fields incorrectly labeled and lengths            *
      *           (Recompile)                                         *
      *  CER048 - German Features - Taxes (Recompile)                 *
      *  CER047 - German Features LF037-00 Reporting §24c KWG         *
      *           (Recompile)                                         *
      *  BUG26018 - COV tab fields are populated eventhough MT202     *
      *             field is set to N                                 *
      *  BUG24937 - In MT202COV 50K is generated instead of 50F       *
      *  252903A - Country location for ordering customer is not moved*
      *           to WLOCN field.                                     *
      *  BUG24436 - Missing MT202COV fields in the generated MT202COV *
      *  CSW209 - SWIFT 2009 Changes                                  *
      *  257632 - Field IBAN is presented twice.                      *
      *  257491 - Resolved invalid country code before call to        *
      *           AOOUFMR0.                                           *
      *  257347 - MT103 generation. Include Customer Number in tag    *
      *           50K of MT103 message if Customer Number is entered  *
      *           in the Ordering Customer field.                     *
      *  BUG21272 - MT103 message tag 50 lower case 'w' replaced with *
      *             '?'                                               *
      *  246371 - Save value of RECI in case it is changed during     *
      *           initial processing and ignore matured records       *
      *  BUG15155A - Ordering Customer field displayed in MT103 is    *
      *             Incorrect                                         *
      *  BUG15183 - Incorrect country retrieved in OFMM               *
      *  BUG15201 - Encounter Database Errors (Recompile)             *
      *  BUG15045 - Missing Ordering Customer field in MT103          *
      *  BUG15044 - Changes in Payment Reference                      *
      *  BUG15037 - DB error in AOCUSTR0. Take correct customer number*
      *  250804A - Some more fixes for CFT032/CSW207                  *
      *  250804 - Some more fixes for CFT032/CSW207                   *
      *  250600 - Refine CFT032 to work as described in FS.           *
      *  BUG14926 - Parameter mismatch in program AOIBANR3            *
      *  BUG14915 - Error in using Corporate BEI field                *
      *  BUG14891 - Missing Ordering Customer field in MT103          *
      *  BUG14771A - Amended the input function and the message       *
      *              generation for CFT032                            *
      *  BUG14771 - Amended the input function and the message        *
      *             generation for CFT032                             *
      *  BUG14755 - MT 101 generated is 50H for retail number under   *
      *             ordering customer                                 *
      *  CSW207A - Calls AONAHOR0 when MT103 account field contains   *
      *            non-account holder reference value.                *
      *  CSW207 - Swift 2007 Changes                                  *
      *  BUG14042 - CFT032 errors ; applied fix 13798                 *
      *  246488 - I/O error in FT0640 DBASE 46.  Applied fix 244230.  *
      *           Recompile over changed P1 splf                      *
      *  BUG13528 -  Additional Fixes                                 *
      *  BUG13289 - Ordering Customer Field 50K Not formatted         *
      *             when free format                                  *
      *  BUG13274 - DBerror in FT0641 at 46                           *
      *  242289 - Use full PREF in TRNO in Message if Switched ON.    *
      *  CFT032 - Account line in field 50X in MT103                  *
      *  CSW206 - SWIFT 2006 Standard Changes                         *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CFT023 - Upgrade of LBV071 to Midas Plus.                    *
      *           MT103 field 50 changes                              *
      *  CDL049 - Addition of a Reference Rate field (recompile)      *
      *  240676 - Fix 220913 do not use 10 digit account code         *
      *  225715 - Field 36 is not supressed even if Instructed        *
      *           Currency is equal to Payment Currency.  With CSW202,*
      *           this error only occurs if Midas currency differs    *
      *           from Swift Currency Code.                           *
      *  222559 - Include account number in MT103 50A.                *
      *  220913 - Include customer or account number in MT103 50K.    *
      *  204225 - Format for field 50 is wrong on SWIFT MT103. If     *
      *           Ordering Customer is CROSSMAR and MT3xx Corporate   *
      *           BEI is not blank, tag 50A with BEI code should be   *
      *           used. If Ordering Customer is CROSSMAR and MT3xx    *
      *           Corporate BEI is blank, tag 50K with customer's     *
      *           name and address should be used.                    *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      * BUG4695 - Suppress field 36 if instructed currency is equal   *
      *           to pay currency.                                    *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  222385 - SWIFT msgs are Watch List checked regardless of     *
      *           configuration file setting                          *
      *  219242 - Not possible to create MT103+ payment msg from      *
      *           non-FT transaction (Recompile)                      *
      *  219241 - Defaulting of "Details of Charges" assign a         *
      *           system value (Recompile)                            *
      *  CSW203 - SWIFT 2003 Standards Update                         *
      *  CSD015 - Midas Compliance Watch - Watch List Checking        *
      *  210858 - W59A always N if sender/destination not transparent *
      *  208890 - Various Core Fixes in SWIFT                         *
      *  CSW202 - SWIFT 2002 Standards Update                         *
      *  CSW025 - Midas Message Manager                               *
      *           - Pass original change type                         *
      *  138077 - Add extension file MGOEXTPD to store customer no.   *
      *           of field with SWIFT address.                        *
      *         - Allow messages to have expansion even if it starts  *
      *           with "/".                                           *
      *  CSW201 - SWIFT 2001 Standards Update                         *
      *  CFT009 - FT Fees and Charge Development                      *
      *  189269 - MT103 not produced if Destination is type SWIFT     *
      *           but not an existing customer in the system.         *
      *  CFT014 - Straight-through Processing Phase 2 MT103           *
      *           Messages Generation for FT.                         *
      *  CSW020 - SWIFT Decimal Places                                *
      *           Adjust the amount if the Swift decimal places       *
      *           differs from the currency decimal places            *
      *  CFT004 - International Bank Account Number                   *
      *           New Account Type 'I' (IBAN)                         *
      *  164663 - Extension of fix 141572 to setup CINDV (Century     *
      *           indicator for Value Date) for Y2K display problem.  *
      *  151235 - Extend fix 149197 to cater for /CHGS/ swiftcode.    *
      *           Format field 72:/CHGS/xxxxxxx, swiftcode line with a*
      *           final '/'.                                          *
      *  149197 - Format field 72:/OCMT/xxxnnnn, swiftcode line with a*
      *           final '/'.                                          *
      *  CEU006 - EMU Settlement Details. Include /OCMT/ on Bank      *
      *           to Bank Info where necessary                        *
      *     113352 - Set-up CIND (Century Flag) to correct year 2000  *
      *              display problem.                                 *
      *     096267 - Field 50 and 59 must contain a complete adress   *
      *              and not BIC code.                                *
      *     S01408 - Addition of core hook FT0641CCP4                 *
      *              Addition of core hook FT0641CCP3                 *
      *              Addition of core hook FT0641CCP2                 *
      *              Addition of core hook FT0641CCP1                 *
      *  CSW096 - SWIFT changes 1996                                  *
      *     S01408 - Core hook FT0641OOP1 added                       *
      *     087873 - Further to fix 064393; some SWIFT messages had   *
      *              our customer name in Network Sender field        *
      *              rather than our Swift ID.                        *
      *     088545 - If there is no message status default for that   *
      *              message type for the involved customer,          *
      *              default the message status with the ICD.         *
      *     S01499 - BLI V.A.T. Processing                            *
      *     S01494 - BLI Funds Transfer Enhancements                  *
      *     068367 - Ensure Priority and Delivery Notification fields *
      *              are a valid combination.                         *
      *     068242 - Remove COMIT on MG files                         *
      *     068230 - Allow SWIFT address in Destination               *
      *     064393 - GET SENDERS TID FROM BRANCH NOT CUSTOMER.        *
      *     S01435 - Incoming Message Management.                     *
      *     058476 - Amounts incorrectly formatted on S.W.I.F.T.      *
      *              Field FLD32 not cleared correctly.               *
      *     055293 - Include Ordering Institution information         *
      *              in field 52 if ORBT not a Retail or a Nostro.    *
      *     S01414 - Book Code and Profit Centre Incorporation.       *
      *              Rename of profit centre field on ACCNTABF        *
      *     E32481 - REMOVAL OF CALL TO FTC0648.                      *
      *     S01310 - SWIFT RATIONALISATION.                           *
      *     E25148 - PRODUCING MT100 INSTEAD OF TELEX IF DESTINATION  *
      *              IS FULL NAME AND ADDRESS AND SETTLE IS 08        *
      *     E32546 - Senders correspondent uses the settle currency   *
      *              for outgoing payments when it should use the     *
      *              pay currency                                     *
      *     S01194 - NEW DATABASE ERROR HANDLING                      *
      *     S01117 - REPORT CONTROL FACILITY                          *
      *     S01117 - FUNDS TRANSFER DEFAULT BRANCH REMOVAL AND        *
      *              CHANGE OF INTERBRANCH ENTRIES                    *
      *     E22406 - TERMINAL IDENTIFICATION REMOVAL.                 *
      *     E20980 - OUTPUT THE INTERMEDIARY BANK TO MSMSOPF.         *
      *     E21465 - DISPLAY THE ORDERING CUSTOMER AND THE            *
      *              INTERMEDIARY BANK ON TELEX PAYMENTS.             *
      *     E21462 - FOR TELEX PAYMENTS, MESSAGES ARE SENT TO         *
      *              THE DESTINATION ADDRESS, EVEN IF THE             *
      *              DESTINATION IS A FULL NAME AND ADDRESS.          *
      *     E21471 - CHAPS CODE OUTPUT TO MT100.                      *
      *     E21467 - SETTLEMENT TYPE CHAPS SHOULD GO THROUGH SWIFT.   *
      *     E21286 - OUTPUT FILE CONTROLS TO FTFCTL INSTEAD OF        *
      *              MSFCTL.                                          *
      *              (THIS IS THE RE-APPLICATION OF E17216 WHICH WAS  *
      *              OVERWRITTEN)                                     *
      *     S01177 - CHANGES FOR EXTENDED SETTLEMENTS                 *
      *****************************************************************
      *                                                               *
     FPRFP1   IP  E           K        DISK
     F*CLINT***IF**E           K        DISK                              S01310
     F************CLINTCAF                          KIGNORE               S01310
     F************CLINTC1F                          KIGNORE               S01310
     FACNUMA  IF  E           K        DISK
     FOTPAYXL2IF  E           K        DISK                           UC  CFT014
     F***OTPAYXL0IF  E           K        DISK                                         CFT009 CSW209
     FOTPAYXL0UF  E           K        DISK                                                   CSW209
     F/COPY WNCPYSRC,FT0641F003
     F*MSIXOPF*O***E                    DISK                      A       S01310
     F*MSMSOPF*O***E           K        DISK                      A       S01310
     FMEINDTL0IF  E           K        DISK                                                   CSW218
     FMGOEXTPDO   E                    DISK                               138077
     FMGOREFPDO   E                    DISK                               S01310
     F*************                                 KCOMIT          S01310068242
     FMGOMSGPDO   E                    DISK                               S01310
     F*************                                 KCOMIT          S01310068242
     F*
     F*FT0641P3O***E********************PRINTER                           S01117
     F*FT0641P1O***E********************PRINTER                           S01117
     F*FT0641P2O***E********************PRINTER                           S01117
     FFT0641AUO   E                    PRINTER      KINFDS SPOOLU         S01117
     F***FT0641P1O   E                    PRINTER      KINFDS SPOOL1                 S01117 BUG13274
     FFT0641P1O   E             25     PRINTER      KINFDS SPOOL1                           BUG13274
     FFT0641P2O   E                    PRINTER      KINFDS SPOOL2         S01117
     F/COPY WNCPYSRC,FT0641F002
     F***SDBRCHL5IF  E           K        DISK                                       E22406 BUG13528
     FSDBRCHL1IF  E           K        DISK                                                 BUG13528
     FTABFP   IF  E           K        DISK
     F            TABTB20F                          KIGNORE
     F            TABTG20F                          KIGNORE
     F            TABLETHF                          KIGNORE
     F            TABLETPF                          KIGNORE
     F************TABLETJF                          KIGNORE               S01117
     F            TABLET5F                          KIGNORE
     F            TABTE10F                          KIGNORE
     FMEISOCL1IF  E           K        DISK         KINFSR *PSSR                              CSW202
     F/COPY WNCPYSRC,FT0641F001
      ** Generic Swift exceptions                                                             CFT023
     FFTGSWXPDIF  E           K        DISK                                                   CFT023
     FACCNTL1 IF  E           K        DISK                                                   CMS006
     F            ACCNTABF                          KRENAMEACCNTL1R                           CMS006
      *                                                                                       CFT124
      ** Additional Customer Details                                                          CFT124
      *                                                                                       CFT124
     FSDACUSL0IF  E           K        DISK                                                   CFT124
      *
     F/EJECT
      *
      ****************************************************************
      * ID F  C  H  L    FUNCTION OF INDICATORS                      *
      ****************************************************************
      * 01              RECORD READ FROM OTPAYDD                     *
      *                                                              *
      *       10        UNSUCCESSFUL CHAIN TO TABFP.                 *
      *       11        UNSUCESSFUL CHAIN TO ACNUMA                  *
      ********12********UNSUCESSFUL CHAIN TO CLINT                   *    S01310
      *       15         LOKUP operation searching array (GNR)       *    S01310
      *       16         LOKUP operation searching array (GNR)       *    S01310
      *       17         LOKUP operation searching array (GNR)       *    S01310
      *       20        CALL OF SR01 FOR DESTINATION OF MESSAGE      *
      ********26********DONT UPDATE MFSCTL FOR MT210 TELEX MESSAGE   *    S01310
      *       26        Output Original Exchg Rate if value          *    CFT014
      *                 was entered                                  *    CFT014
      *       27        Conditions the format of printing Tag 59     *    CFT014
      *       28        Work indicator                               *    CFT014
      *       29        Prints Block 3 Data in FT0640P1 for MT103+   *    CFT014
      *                 message                                      *    CFT014
      *       40        FIRST CYCLE COMPLETED.                       *
      ********41********UNSUCESSFUL WRITE MSIXOPFF                   *    S01310
      ********42********UNSUCESSFUL WRITE MSMSOPFF                   *    S01310
      *       41        UNSUCESSFUL WRITE MGOREFPD                   *    S01310
      *       42        UNSUCESSFUL WRITE MGOMSGPD                   *    S01310
      *       50        MULTIBRANCH INDICATOR ACTIVE                 *    S01117
      *       51        UNSUCCESSFUL CHAIN TO OTPAYXL0               *    CFT009
      *       52        Unsuccessful chain to MEISOCL1               *                        CSW202
      *       53        Look up array                                *                        CSW202
      *       70        Unsuccessful Chain SDACUSL0                  *                        CFT124
      *                                                              *
      *       U7        ) DATA BASE                                  *
      *       U8        ) ERROR.                                     *
      *             LR  LAST RECORD (TERMINATE PROGRAM).             *
      *                                                              *
      *  N.B:- 90-99    STANDARD SUBROUTINE INDICATORS.              *
      ****************************************************************
      *
     F/EJECT
     E                    CPY@    1   1 80
     E*
     E                    MTH    12  12  3               MONTH  SR. ARRAY
     E                    AMT        13  1               AMOUNT ARRAY
     E                    AM         14  1               EDITED AMOUNT ARR
     E                    FAMT       15  1               LEFT ADJ AMNT ARR
     E                    ADDR        6 35               NAME/ADDRESS  ARR
     E                    @WRK       50  1               work array       S01310
     E                    @HLD       15  1               Set up fld 20.   S01310
     E                    GNR        15  3               msg gen released.S01310
     E                    @STR       24  1               String formatting149197
     E                    WA1        50  1                                CFT014
     E                    TABA    1  11  4   TABB   10   Codewords        CFT014
     E                    ALPH   26  26  1                                                    CSW202
     E                    NUMC   10  10  1                                                    CSW202
     E/COPY WNCPYSRC,FT0641E001
      *
     E**********          SVAL    1   1 20                                           242289 MD048075
     E                    SVAL    1   2 20                                                  MD048075
     E/EJECT
     I*
     I*CLINTCBF****70                                                     S01310
     I**************SWTX                            SWTXRN                S01310
     I*                                                                   S01414
     I* Rename of ACCNTABF Profit Centre to avoid overwriting             S01414
     I*                                                                   S01414
     IACCNTABF                                                            S01117
     I              PRFC                            ACPRFC                S01414
     I*                                                                   S01414
     IOTPAYDDF    01
     I/COPY WNCPYSRC,FT0641I004
     I*                                                                   S01117
     ISPOOLU      DS                                                      S01117
     I* FILE INFORMATION DATA STRUCTURE                                   S01117
     I                                       83  92 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
     ISPOOL1      DS                                                      S01117
     I* FILE INFORMATION DATA STRUCTURE                                   S01117
     I                                       83  92 SFILE1                S01117
     I                                    B 123 1240SFNUM1                S01117
     ISPOOL2      DS                                                      S01117
     I* FILE INFORMATION DATA STRUCTURE                                   S01117
     I                                       83  92 SFILE2                S01117
     I                                    B 123 1240SFNUM2                S01117
     I/COPY WNCPYSRC,FT0641I002
     I*                                                                   S01117
     IRUNDAT      DS                             13                       S01117
     I* DATA STRUCTURE TO RETRIEVE MULTIBRANCH INDICATOR                  S01117
     I                                       13  13 MBIN                  S01117
     IEXTN        DS                         45                           138077
     I                                        1   20MPSN                  138077
     I                                        3   7 MTG                   138077
     I                                        8  15 MCSI                  138077
      *                                                                   138077
      **  Multiple occurrence data structure for extension file           138077
      *                                                                   138077
     I            DS                                                      138077
     I                                        1   5 @MTG                  138077
     I                                        2   2 FLDTYP                138077
     I                                        4   4 FLDTAG                138077
      *                                                                   138077
      **  Field tag data structure                                        138077
      *                                                                   138077
     I*
     I/COPY WNCPYSRC,FT0641I005
      ***************************************************************     S01310
      *  NOTE:                                                      *     S01310
      *  The following data structures were originally used as the  *     S01310
      *  method of writing out the swift message to PF/MSMSOPF.     *     S01310
      *  As this method of output has been replaced by a multiple   *     S01310
      *  occurence data structure only the definitions of the       *     S01310
      *  relevant fields has been retained.                         *     S01310
      *  The multiple occurence data structure is used to store up  *     S01310
      *  the records that make up the SWIFT message before writing  *     S01310
      *  the whole message to file.                                 *     S01310
      *  To store the records of the message , you must first       *     S01310
      *  access an OCUR record, then obtain the Message Tag and     *     S01310
      *  Message Field data values for this OCUR record. Continue   *     S01310
      *  this process until the SWIFT message is complete.          *     S01310
      ***************************************************************     S01310
     I            DS
     I********************************************************
     I*    DATA STRUCTURE TO BUILD CUSTOMER TRANSFERS        *
     I*    RECORD OUTGOING SWIFT MESSAGE TYPE MT100-1        *
     I********************************************************
     I                                        1 256 MT1001
     I************                            1   1 M1HEAD                S01310
     I************                            2   3 M1CRL1                S01310
     I                                        4  15 M1OTID
     I************                           16  16 M1SP1                 S01310
     I************                           17  21 M1ISNO                S01310
     I************                           22  23 M1CRL2                S01310
     I                                       24  26 M1MSGT
     I************                           27  27 M1SP2                 S01310
     I************                           28  29 M1MSGP                S01117
     I************                           30  31 M1CRL3                S01310
     I                                       32  43 M1RADD
     I************                           44  45 M1CRL4                S01310
     I************                           68  71 M1TG20                S01310
     I************                           72  87 M1TREF                S01310
     I************                           88  89 M1CRL6                S01310
     I************                           90  94 M1TG32                S01310
     I                                       95 100 M1VDAT
     I                                      101 103 M1RCCY
     I                                      104 118 M1AMNT
     I************                          119 120 M1CRL7                S01310
     I************                          121 124 M1TG50                S01310
     I                                      125 159 M1ORC1
     I************                          160 161 M1CRL8                S01310
     I                                      162 196 M1ORC2
     I************                          197 198 M1CRL9                S01310
     I                                      199 233 M1ORC3
     I************                          234 235 M1CRLA                S01310
     I************                          257 257 MXMIND                S01310
     I************                          258 272 MXTREF                S01310
     I                                      273 273 MXDFLG
     I*
     I            DS
     I********************************************************
     I*     DATA STRUCTURE TO BUILD CUSTOMER TRANSFERS       *
     I*     RECORD OUTGOING SWIFT MESSAGE TYPE MT100-2       *
     I********************************************************
     I                                        1 256 MT1002
     I                                        1  35 M2ORC4
     I************                           36  37 M2CRL1                S01310
     I************                           38  40 M2TG52                S01310
     I                                       41  41 M2OBTG
     I************                           42  42 M2CLN                 S01310
     I                                       43  79 M2OBK1
     I************                           80  81 M2CRL2                S01310
     I                                       82 116 M2OBK2
     I************                          117 118 M2CRL3                S01310
     I                                      119 153 M2OBK3
     I************                          154 155 M2CRL4                S01310
     I                                      156 190 M2OBK4
     I************                          191 192 M2CRL5                S01310
     I                                      193 227 M2OBK5
     I************                          228 229 M2CRL6                S01310
     I*
     I            DS
     I********************************************************
     I*     DATA STRUCTURE TO BUILD CUSTOMER TRANSFERS       *
     I*     RECORD OUTGOING SWIFT MESSAGE TYPE MT100-3       *
     I********************************************************
     I                                        1 256 MT1003
     I************                            1   3 M3TG53                S01310
     I                                        4   4 M3SCTT
     I************                            5   5 M3CLNA                S01310
     I                                        6  42 M3SCR1
     I************                           43  44 M3CRL1                S01310
     I                                       45  79 M3SCR2
     I************                           80  81 M3CRL2                S01310
     I                                       82 116 M3SCR3
     I************                          117 118 M3CRL3                S01310
     I                                      119 153 M3SCR4
     I************                          154 155 M3CRL4                S01310
     I                                      156 190 M3SCR5
     I************                          191 192 M3CRL5                S01310
     I************                          193 195 M3TG54                S01310
     I                                      196 196 M3RCTT
     I************                          197 197 M3CLNB                S01310
     I                                      198 234 M3RCR1
     I************                          235 236 M3CRL6                S01310
     I*
     I            DS
     I*
     I********************************************************
     I**    DATA STRUCTURE TO BUILD CUSTOMER TRANSFERS       *
     I**    RECORD OUTGOING SWIFT MESSAGE TYPE MT100-4       *
     I********************************************************
     I                                        1 256 MT1004
     I                                        1  35 M4RCR2
     I************                           36  37 M4CRL1                S01310
     I                                       38  72 M4RCR3
     I************                           73  74 M4CRL2                S01310
     I                                       75 109 M4RCR4
     I************                          110 111 M4CRL3                S01310
     I                                      112 146 M4RCR5
     I************                          147 148 M4CRL4                S01310
     I**************************************168 170 M4TG57
     I**************************************171 171 M4ABTT                S01177
     I**************************************172 172 M4CLN                 S01177
     I**************************************173 209 M4AWB1                S01177
     I**************************************210 211 M4CRL5                S01177
     I**************************************212 246 M4AWB2                S01177
     I**************************************247 248 M4CRL6                S01177
     I**
     I                                      149 151 M4TG56                E20980
     I                                      152 152 M4AB56                E20980
     I************                          153 153 M4CLN1          E20980S01310
     I                                      154 190 M4INB1                E20980
     I************                          191 192 M4CRLV          E20980S01310
     I                                      193 227 M4INB2                E20980
     I************                          228 229 M4CRLW          E20980S01310
     I            DS
     I********************************************************
     I**   DATA STRUCTURE TO BUILD CUSTOMER TRANSFERS        *
     I**   RECORD OUTGOING SWIFT MESSAGE TYPE MT100-5        *
     I********************************************************
     I                                        1 256 MT1005
     I**************************************  1  35 M5AWB3                S01177
     I************************************** 36  37 M5CRL1                S01177
     I************************************** 38  72 M5AWB4                S01177
     I************************************** 73  74 M5CRL2                S01177
     I************************************** 75 109 M5AWB5                S01177
     I**************************************110 111 M5CRL3                S01177
     I**************************************112 115 M5TG59                S01177
     I**************************************116 150 M5BBK1                S01177
     I**************************************151 152 M5CRL4                S01177
     I**************************************153 187 M5BBK2                S01177
     I**************************************188 189 M5CRL5                S01177
     I**************************************190 224 M5BBK3                S01177
     I**************************************225 226 M5CRL6                S01177
     I                                        1  35 M4INB3                E20980
     I************                           36  37 M4CRLX          E20980S01310
     I                                       38  72 M4INB4                E20980
     I************                           73  74 M4CRLY          E20980S01310
     I                                       75 109 M4INB5                E20980
     I************                          110 111 M4CRLZ          E20980S01310
     I************                          112 114 M4TG57          S01177S01310
     I                                      115 115 M4ABTT                S01177
     I************                          116 116 M4CLN           S01177S01310
     I                                      117 153 M4AWB1                S01177
     I************                          154 155 M4CRL5          S01177S01310
     I                                      156 190 M4AWB2                S01177
     I************                          191 192 M4CRL6          S01177S01310
     I                                      193 227 M5AWB3                S01177
     I************                          228 229 M5CRL1          S01177S01310
     I**
     I            DS
     I********************************************************
     I**   DATA STRUCTURE TO BUILD CUSTOMER TRANSFERS        *
     I**   RECORD OUTGOING SWIFT MESSAGE TYPE MT100-6        *
     I********************************************************
     I                                        1 256 MT1006
     I**************************************  1  35 M6BBK4                S01177
     I************************************** 36  37 M6CRL1                S01177
     I************************************** 38  72 M6BBK5                S01177
     I************************************** 73  74 M6CRL2                S01177
     I************************************** 75  78 M6TG70                S01177
     I************************************** 79 113 M6DTP1                S01177
     I**************************************114 115 M6CRL3                S01177
     I**************************************116 150 M6DTP2                S01177
     I**************************************151 152 M6CRL4                S01177
     I**************************************153 187 M6DTP3                S01177
     I**************************************188 189 M6CRL5                S01177
     I**************************************190 224 M6DTP4                S01177
     I**************************************225 226 M6CRL6                S01177
     I**************************************227 231 M6TG71                S01177
     I**************************************232 234 M6DTCH                S01177
     I**************************************235 236 M6CRL7                S01177
     I                                        1  35 M5AWB4                S01177
     I************                           36  37 M5CRL2          S01177S01310
     I                                       38  72 M5AWB5                S01177
     I************                           73  74 M5CRL3          S01177S01310
     I************                           75  78 M5TG59          S01177S01310
     I                                       79 113 M5BBK1                S01177
     I************                          114 115 M5CRL4          S01177S01310
     I                                      116 150 M5BBK2                S01177
     I************                          151 152 M5CRL5          S01177S01310
     I                                      153 187 M5BBK3                S01177
     I************                          188 189 M5CRL6          S01177S01310
     I                                      190 224 M6BBK4                S01177
     I************                          225 226 M6CRL1          S01177S01310
     I**
     I            DS
     I********************************************************
     I**   DATA STRUCTURE TO BUILD CUSTOMER TRANSFERS        *
     I**   RECORD OUTGOING SWIFT MESSAGE TYPE MT100-7        *
     I********************************************************
     I                                        1 256 MT1007
     I**************************************  1   4 M7TG72                S01177
     I**************************************  5  39 M7BTB1                S01177
     I************************************** 40  41 M7CRL1                S01177
     I************************************** 42  76 M7BTB2                S01177
     I************************************** 77  78 M7CRL2                S01177
     I************************************** 79 113 M7BTB3                S01177
     I**************************************114 115 M7CRL3                S01177
     I**************************************116 150 M7BTB4                S01177
     I**************************************151 152 M7CRL4                S01177
     I**************************************153 187 M7BTB5                S01177
     I**************************************188 189 M7CRL5                S01177
     I**************************************190 224 M7BTB6                S01177
     I**************************************225 226 M7CRL6                S01177
     I**************************************227 227 M7HYPH                S01177
     I**************************************228 228 M7ETX                 S01177
     I                                        1  35 M6BBK5                S01177
     I************                           36  37 M6CRL2          S01177S01310
     I************                           38  41 M6TG70          S01177S01310
     I                                       42  76 M6DTP1                S01177
     I************                           77  78 M6CRL3          S01177S01310
     I                                       79 113 M6DTP2                S01177
     I************                          114 115 M6CRL4          S01177S01310
     I                                      116 150 M6DTP3                S01177
     I************                          151 152 M6CRL5          S01177S01310
     I                                      153 187 M6DTP4                S01177
     I************                          188 189 M6CRL6          S01177S01310
     I************                          190 194 M6TG71          S01177S01310
     I                                      195 197 M6DTCH                S01177
     I************                          198 199 M6CRL7          S01177S01310
     I************                          200 203 M7TG72          S01177S01310
     I                                      204 238 M7BTB1                S01177
     I************                          239 240 M7CRL1          S01177S01310
     I**                                                                  S01177
     I            DS                                                      S01177
     I********************************************************            S01177
     I**   DATA STRUCTURE TO BUILD CUSTOMER TRANSFERS        *            S01177
     I**   RECORD OUTGOING SWIFT MESSAGE TYPE MT100-8        *            S01177
     I********************************************************            S01177
     I                                        1 256 MT1008                S01177
     I                                        1  35 M7BTB2                S01177
     I************                           36  37 M7CRL2          S01177S01310
     I                                       38  72 M7BTB3                S01177
     I************                           73  74 M7CRL3          S01177S01310
     I                                       75 109 M7BTB4                S01177
     I************                          110 111 M7CRL4          S01177S01310
     I                                      112 146 M7BTB5                S01177
     I************                          147 148 M7CRL5          S01177S01310
     I                                      149 183 M7BTB6                S01177
     I************                          184 185 M7CRL6          S01177S01310
     I************                          186 186 M7HYPH          S01177S01310
     I                                      187 187 M7ETX                 S01177
      *                                                                   CSW096
     IP@IN        DS                            256                       CSW096
     I                                        1   3 I@SNBR                CSW096
     I                                        4   9 I@DSCN                CSW096
     I                                       10  12 I@MTPY                CSW096
     I                                       13  140I@SETT                CSW096
     I                                       15  15 I@CONC                CSW096
     I                                       16  16 I@FTCS                CSW096
     I                                       17  18 I@MMOD                CSW096
      ** Data structure for input parameter                               CSW096
      *                                                                   CSW096
     IP@OUT       DS                            256                       CSW096
     I**********                              1   60O@CNSN                             CSW096 CSD027
     I                                        1   6 O@CNSN                                    CSD027
     I                                        7  18 O@SWSN                CSW096
     I                                       19  38 O@NWSN                CSW096
     I                                       39  49 O@SWDS                CSW096
     I                                       46  46 W@96CN                CSW096
     I                                       47  49 W@BIC                 CSW096
     I                                       50  69 O@NWDS                CSW096
     I                                       70  75 O@NWRK                CSW096
     I                                       76  76 O@MGSG                CSW096
     I                                       77  80 O@MGST                CSW096
     I                                       81  81 O@PAIN                CSW096
     I                                       82  87 O@PCNB                CSW096
     I                                       88  90 O@SPRS                CSW096
      ** Data structure for output parameter                              CSW096
      *                                                                   CSW096
     I**
     I            DS
     I***
     I**********************************************
     I*       DATA STRUCTURE TO SAVE FIELDS FROM   *
     I*        INSTALLATION CONTROL DATA AREA.     *
     I**********************************************
     I*
     I****************************************1   30SDFBR                 S01117
     I                                        4  15 SCSID
     I                                       12  12 CSID9
     I                                       13  13 CSID10
     I                                       14  14 CSID11
     I                                       15  15 CSID12
     I*
     I*
     I**********************************************
     I*   DATA STRUCTURE TO HANDLE THE CONVERSION  *
     I*   OF DATE FORMAT YYMMDD TO DDMMMYY.        *
     I**********************************************
     I            DS
     I                                        1   60SDATE
     I                                        1   2 SYY
     I                                        3   40SMM
     I                                        5   6 SDD
     I            DS
     I                                        1   7 WDATE
     I                                        1   2 WDD
     I                                        3   5 WMM
     I                                        6   7 WYY
     I*
     I**********************************************
     I*   DATA STRUCTURE TO MANIPULATE AMOUNT      *
     I**********************************************
     I            DS
     I                                        1  130WAMNT
     I                                        1  13 RAMNT
     I* FOR EDITING ON THE REPORT
     I                                        1  130P2AMT0
     I                                        1  130P2AMT1
     I                                        1  130P2AMT2
     I                                        1  130P2AMT3
     I**********************************************
     I*   DATA STRUCTURE TO ELIMINATE BLANK LINES  *
     I**********************************************
     IOFSPT       DS                            210
     I                                        1  35 OFSPT1
     I                                       36  70 OFSPT2
     I                                       71 105 OFSPT3
     I                                      106 140 OFSPT4
     I                                      141 175 OFSPT5
     I                                      176 210 OFSPT6
     I*
     I**********************************************
     I*       DATA STRUCTURE USED IN THE EVENT     *
     I*                    OF DATABASE ERRORS.     *
     I**********************************************
     I*
     IDLDA        DS                            256
     I**************************************134 138 DBFILE                S01194
     I**************************************139 167 DBKEY                 S01194
     I**************************************168 175 DBPGM                 S01194
     I**************************************176 177 DBASE                 S01194
     I                                      134 141 DBFILE                S01194
     I                                      142 170 DBKEY                 S01194
     I                                      171 180 DBPGM                 S01194
     I                                      181 1830DBASE                 S01194
     I*
     I**********************************************
     I****DATA*STRUCTURE*USED*IN*UPDATING*OTHER*****                      S01310
     I****MESSAGES*COUNT*IN*DATA*AREA*MSFCTL*.******                      E21286
     I****MESSAGES*COUNT*IN*DATA*AREA*FTFCTL*.******                E21286S01310
     I**********************************************
     I************                                                        S01310
     I*DFCTL****** DS                            256                      S01310
     I************                        P  91  930DFOMC                 S01310
     I************                        P  94  960DFOTL                 S01310
     I*
     I**********************************************
     I*       DATA STRUCTURE - PROGRAM STATUS      *
     I**********************************************
     I*
     IPSDS       SDS
     I                                        1  10 ##PGM                 S01435
     I                                      254 263 USRID
     I*
     I************                                                        S01310
     I*********************************************                       S01310
     I********DATA STRUCTURE TO CONTAIN           *                       S01310
     I************ HEX FIELDS                     *                       S01310
     I*********************************************                       S01310
     I************                                                        S01310
     I************DS                                                      S01310
     I************                        B   1   20B0D                   S01310
     I************                            2   2 X0D                   S01310
     I************                        B   3   40B25                   S01310
     I************                            4   4 X25                   S01310
     I************                        B   5   60B01                   S01310
     I************                            6   6 X01                   S01310
     I************                        B   7   80B03                   S01310
     I************                            8   8 X03                   S01310
     I************                            9  10 X0D25                 S01310
      *                                                                   S01310
     I                                        1  12 CSID                  S01310
     I                                        9  11 @BIC                  S01310
      **  Data structure to test for BIC code                             S01310
      *                                                                   S01310
     IMULT        DS                         95                           S01310
     I                                        1   5 MTAG                  S01310
     I                                        6  55 MFLD                  S01310
      **  Multiple occurrence data structure for message                  S01310
      *                                                                   S01310
     I@MTAG       DS                          5                           S01310
     I                                        1   1 COLON1                S01310
     I                                        2   3 FLDNO                 S01310
     I                                        4   4 TAG                   S01310
     I                                        5   5 COLON2                S01310
      **  Data structure constructing message field tag                   S01310
      *                                                                   S01310
     IFLD32       DS                         24                           S01310
     I**********                              1   6 DATE                             S01310 MD033624
     I                                        1   6 FDATE                                   MD033624
     I                                        7   9 CCY32                 S01310
     I                                       10  24 AMNT32                S01310
      **  Data structure containing codeword for field 32.                S01310
      *                                                                   S01310
     I**  Data structure to split the full nostro number                  S01117
     I*                                                                   S01117
     IDST1        DS                             35                       S01117
     I/COPY WNCPYSRC,FT0641I006
     I                                        4   5 NOSTN                 S01117
      *
     IWORKDS      DS                             25                                           CMS006
     I                                        1   1 WORK0                                     CMS006
     I                                        2   4 WORK1                                     CMS006
     I                                        5  10 WORK2                                     CMS006
     I                                       11  13 WORK3                                     CMS006
     I                                       14  23 WORK4                                     CMS006
     I                                       24  25 WORK5                                     CMS006
     I*
     I*  DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
     ICPYR@#      DS
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
     I*
      * Field :72: data structure - Original Currency & Amount            CEU006
     IOCMT        DS                             35                       CEU006
     I I            '/OCMT/'                  1   6 O#CDWD                CEU006
     I                                        7   9 O#CCY                 CEU006
     I                                       10  24 O#AMNT                CEU006
     I                                        1  24 O#OCMT                149197
      *                                                                   CEU006
      * Field :72: data structure - Charges                               CEU006
     ICHGS        DS                             35                       CEU006
     I I            '/CHGS/'                  1   6 C#CDWD                CEU006
     I                                        7   9 C#CCY                 CEU006
     I                                       10  24 C#AMNT                CEU006
     I                                        1  24 C#CHGS                151235
      *                                                                   CFT014
      ** Fields introduced for MT103                                      CFT014
     IMT1009      DS                                                      CFT014
     I                                        1   4 M9BOCD                CFT014
     I                                        5  39 M9ICD1                CFT014
     I                                       40  74 M9ICD2                CFT014
     I                                       75 109 M9ICD3                CFT014
     I                                      110 144 M9ICD4                CFT014
     I                                      145 179 M9ICD5                CFT014
     I                                      180 182 M9TTCD                CFT014
     I                                      183 185 M9PDCY                CFT014
     I                                      186 200 M9PDAM                CFT014
     I                                      201 212 M9OEXR                CFT014
     I                                      213 213 M9OCTG                CFT014
     I                                      214 214 M9TRTG                CFT014
     I                                      215 249 M9TRI1                CFT014
     I                                      250 284 M9TRI2                CFT014
     I                                      285 319 M9TRI3                CFT014
     I                                      320 354 M9TRI4                CFT014
     I                                      355 389 M9TRI5                CFT014
     I                                      390 390 M9BNTG                CFT014
     I                                      391 393 M9PCCY                CFT014
     I                                      394 408 M9SCH1                CFT014
     I                                      409 423 M9SCH2                CFT014
     I                                      424 438 M9SCH3                CFT014
     I                                      439 453 M9SCH4                CFT014
     I                                      454 468 M9SCH5                CFT014
     I                                      469 483 M9RCRM                CFT014
     I                                      484 518 M9RRP1                CFT014
     I                                      519 553 M9RRP2                CFT014
     I                                      554 588 M9RRP3                CFT014
      *                                                                   CFT014
      ** Bank to Bank Info DS to be passed to ME1730                      CFT014
     I            DS                                                      CFT014
     I                                        1 256 WBBI                  CFT014
     I                                        1  35 BBI1                  CFT014
     I                                       36  70 BBI2                  CFT014
     I                                       71 105 BBI3                  CFT014
     I                                      106 140 BBI4                  CFT014
     I                                      141 175 BBI5                  CFT014
     I                                      176 210 BBI6                  CFT014
      *                                                                   CFT014
      ** Receiver's Correspondent DS to be passed to ME1730               CFT014
     I            DS                                                      CFT014
     I                                        1 256 WRCCO                 CFT014
     I                                        1  35 RCO1                  CFT014
     I                                       36  70 RCO2                  CFT014
     I                                       71 105 RCO3                  CFT014
     I                                      106 140 RCO4                  CFT014
     I                                      141 175 RCO5                  CFT014
      *                                                                                       220913
      ** Ordering Customer (Partial Account)                                                  220913
     I            DS                                                                          220913
     I                                        1  35 ZORC1                                     220913
     I                                        1   6 ZCNUM                                     220913
     I**************                          7  10 ZACOD                              220913 240676
     I**************                         11  12 ZACSQ                              220913 240676
     I**************                         13  15 ZBRCA                              220913 240676
     I                                        7  16 ZACOD                                     240676
     I                                       17  18 ZACSQ                                     240676
     I                                       19  21 ZBRCA                                     240676
      *                                                                   S01310
     I/COPY WNCPYSRC,FT0641I003
      *                                                                   CFT014
     ISDBANK    E DSSDBANKPD                                              CFT014
      ** Data structure for Bank ICD                                      CFT014
      *                                                                   CFT014
     ISDCUST    E DSSDCUSTPD                                              S01310
      **  External Data structure for customer details.                   S01310
      *                                                                   S01310
     ISDMMOD    E DSSDMMODPD                                              S01310
      **  External Data structure for module ICD file.                    S01310
      *                                                                   S01310
     ISDMGME    E DSSDMGMEPD                                              S01310
      **  Data structure for MESSAGE MANAGEMENT file                      S01310
      *                                                                   S01310
     ISDCURR    E DSSDCURRPD                                              S01117
      **  Data structure for CURRENCIES file                              S01117
      *                                                                   S01117
     ISDCNST    E DSSDCNSTPD                                              S01435
      *                                                                   S01435
      *  Calling parameter data structure for ME1400                      S01435
      *                                                                   CFT014
     ISDNOST    E DSSDNOSTPD                                                                  CFT032
     I              QQACCD                          XXACCD                                    CFT032
      *                                                                                       CFT032
      ** Calling parameter data structure for Nostro file                                     CFT032
      *                                                                                      CSW207A
     ISDNAHO    E DSSDNAHOPD                                                                 CSW207A
      ** External Data structure for non-account holders                                     CSW207A
      *                                                                                       CFT032
     IMEOUFM    E DSMEOUFMPD                                                                  CFT032
      *                                                                                       CFT032
      ** Calling parameter data structure for MEOUFMPD File                                   CFT032
      *                                                                                       CFT032
     IOACCNT    E DSACCNTAB                                                                   CFT032
     I              PRFC                            @APRFC                                    CFT124
     I              LCD                             XXLCD                                     CFT032
      *                                                                                       CFT032
      ** Calling parameter data structure for MEOUFMPD File                                   CFT032
      *                                                                                       CFT032
     ISDGELR    E DSSDGELRPD                                              CFT014
      ** Data structure for GL ICD                                        CFT014
      *                                                                   S01435
     IMEBICD    E DSMEBICDPD                                              S01435
      *                                                                   S01435
      *  Calling parameter data structure for ME1400                      S01435
      *                                                                                       CSW202
     IMEBEIS    E DSMEBEISPD                                                                  CSW202
      ** Data Structure for Business Entity Identifier file                                   CSW202
      *                                                                   S01435
     ISDCTRY    E DSSDCTRYPD                                                                  257491
      *                                                                                       257491
      ** Country Codes Data Structure                                                         257491
      *                                                                                       257491
      /EJECT                                                              S01435
     IW8FT        DS                            128                       S01435
      *                                                                   S01435
      * Address data structure                                            S01435
      *                                                                   S01435
      * Currency                                                          S01435
     I                                        1   3 W8CCY                 S01435
      * Settlement Type                                                   S01435
     I                                        4   5 W8STMT                S01435
      * Mandatory Text - convert BIC identifiers                          S01435
     I                                        6   6 W8MTXT                S01435
      * Message Tag                                                       S01435
     I                                        7  11 W8MTAG                S01435
      * Construct of data in field                                        S01435
     I                                       12  12 W8TYPE                S01435
      * Number of Lines available                                         S01435
     I                                       13  140W8NLIN                S01435
      * Network and Message Type                                          S01435
     I                                       15  20 W8NWRK                S01435
     I                                       21  23 W8MTPY                S01435
      * Calling Program                                                   S01435
     I                                       24  33 W8CPGM                S01435
      * Action *PRINT/*ENQ/*MSG GEN                                       S01435
     I                                       34  41 W8ACT                 S01435
      * Critical reporting - Database error if 'Y'                        S01435
      * If no BIC directory and BIC entered no error                      S01435
     I                                       42  42 W8CRIT                S01435
      * Force Midas Address - where possible                              S01435
     I                                       43  43 W8MADD                S01435
      * If Retail get first address from account                          S01435
     I                                       44  44 W8RTAD                S01435
      * Alternative Address                                               S01435
     I                                       45  45 W8ALTN                S01435
      * Address type selected in W0MSG                                    S01435
     I                                       46  46 W8ADTP                S01435
      *                                                                   S01435
     C/COPY FTCPYSRC,SFTADDRI                                             S01435
      *                                                                   S01435
      * Address data structure                                            S01435
      *                                                                   S01435
     IDSFDY     E DSDSFDY                                                 S01310
      **  Short data structure for access programs                        S01310
      *                                                                   S01310
     IDSSDY     E DSDSSDY                                                 S01310
      **  Long data structure for access programs                         S01310
      *                                                                                       CSD015
     IDSLDY     E DSDSLDY                                                                     204225
      ** Third data structure for access programs                                             204225
      *                                                                                       204225
     IWLFDS     E DSSDWLTOPD                                                                  CSD015
      ** DS For Watch List Transaction Details File                                           CSD015
      *                                                                                       CSD015
     IPSTRNG      DS                           9999                                           CSD015
      ** DS For Search String                                                                 CSD015
      *                                                                   CEU006
     ISDWLCC    E DSSDWLCCPD                                                                  222385
      ** Watch list checking details                                                          222385
      *                                                                                       222385
      * External data structure - SAR details                             CEU006
     ISCSARD    E DSSCSARDPD                                              CEU006
     I/COPY WNCPYSRC,FTH00503
      *                                                                                       CSW207
      ** DATA STRUCTURE FOR WDSACT                                                            CSW207
      *                                                                                       CSW207
     I            DS                                                                          CSW207
     I                                        1  24 WDSACT                                    CSW207
     I                                        1   3 WDSBRC                                    CSW207
     I                                        4   9 WDSCNM                                    CSW207
     I                                       10  12 WDSCCY                                    CSW207
     I                                       13  22 WDSACD                                    CSW207
     I                                       23  24 WDSACS                                    CSW207
     IDSACC       DS                             24                                           CFT124
     I                                        1   3 @@BRCA                                    CFT124
     I                                        4   9 @@CNUM                                    CFT124
     I                                       10  12 @@CCY                                     CFT124
     I                                       13  220@@ACOD                                    CFT124
     I                                       23  240@@ACSQ                                    CFT124
      *                                                                                       CFT124
      ** DS to hold GL Account Reference (BRCA CNUM CCY ACOD ACSQ)                            CFT124
      *                                                                                       CFT124
     IDS@ORC      DS                             21                                           CFT124
     I                                        1   6 @ORCNU                                    CFT124
     I                                        7  16 @ORACD                                    CFT124
     I                                       17  18 @ORACS                                    CFT124
     I                                       19  21 @ORBRC                                    CFT124
      *                                                                                       CFT124
      ** DS to hold Ordering Customer when Partial Account                                    CFT124
      *                                                                                       CFT124
     I              'MT10350KIBAN'        C         SVIBAN                                    CFT124
     I              'MT10350KRetailNumber'C         SVRENO                                    CFT124
     I              'MT10350KGLAccountRef'C         SVGLRF                                    CFT124
     I              'MT10350KAccountName' C         SVACNM                                    CFT124
     I              'MT10350KCustAddr'    C         SVCADD                                    CFT124
     I              'MT10350K_7_TaxC'     C         SVCTAX                                    CFT124
     I              'MT202COV50x_AcFmt'   C         SVAFMT                                    CFT124
      *                                                                                       CFT124
      ** Define system values for CFT124                                                      CFT124
      *                                                                                       CFT124
      *                                                                                       CFT032
      ** Action Constant for AOOUFMR0                                                         CFT032
      *                                                                                       CFT032
     I**********    'ACCOUNTLINE'         C         CACNT1                           CFT032 BUG13289
     I              'ACOUNTLINE'          C         CACNT1                                  BUG13289
     I              'ACOUNTIBAN'          C         CACNT2                                  BUG14771
      *                                                                                       CFT124
      ** Constant for numerics checking                                                       CFT124
      *                                                                                       CFT124
     I              '0123456789'          C         NUMBS                                     CFT124
      *                                                                                       CFT032
      ** Midas MG Get UUID program                                                            CSW218
      *                                                                                       CSW218
     I              'MGC001802'           C         UIDPGM                                    CSW218
      *                                                                                       CSW218
     I/COPY WNCPYSRC,FT0641I001
      *                                                                   CFT014
     I/COPY FTCPYSRC,FT0010I001                                           CFT014
      *                                                                   CFT014
      *                                                                   S01310
     I/EJECT
     C                     MOVEACPY@      BIS@   80
     C           *LIKE     DEFN OPPARM    IPPARM
     C******************************
     C*****KEY*LIST*****PARAMETERS *                                      S01310
     C******************************
     C***********CUSKEY****KLIST                                          S01310
     C*********************KFLD           KCUSNO                          S01310
     C*********************KFLD           KEYA                            S01310
     C*
     C/COPY WNCPYSRC,FT0641C070
     C*
     C******************************
     C*    INPUT OUTPUT PARAMETERS *
     C******************************
     C           *ENTRY    PLIST
     C                     PARM           IPPARM
     C                     PARM           OPPARM
     C                     PARM           RSEQ                            S01117
      *                                                                                       CFT032
      ** Parameter List for calling AOOUFMR0                                                  CFT032
      *                                                                                       CFT032
     C           PLOUFM    PLIST                                                              CFT032
     C                     PARM *BLANKS   @RTRN   7                                           CFT032
     C                     PARM '*KEY   ' @OPTN                                               CFT032
     C                     PARM           @NTWRK  6                                           CFT032
     C                     PARM           @MSGTP  3                                           CFT032
     C                     PARM           @MSGTG  5                                           CFT032
     C**********           PARM           BRCA                                       CFT032 BUG14042
     C**********           PARM           @CNTLC  2                                  CFT032 BUG14042
     C                     PARM           BRCA4A  4                                         BUG14042
     C                     PARM           CTRY4A  4                                         BUG14042
     C**********           PARM           V#PCCY  3                                  CFT032 BUG14771
     C                     PARM           WCCY    3                                         BUG14771
     C                     PARM           @NOSTN  2                                           CFT032
     C                     PARM           @ACTNF 10                                           CFT032
     C           MEOUFM    PARM *BLANKS   DSFDY                                               CFT032
     C/COPY WNCPYSRC,FTH00291
     C*
     C***********************
     C*    FIRST CYCLE.     *
     C***********************
     C*
     C  N40                EXSR FIRST
      *                                                                                       CSW203
     C           CSW203    IFEQ 'Y'                                                           CSW203
     C           CFT014    ANDNE'Y'                                                           CSW203
     C                     EXSR SRDGEN                                                        CSW203
     C                     ENDIF                                                              CSW203
     C*
     C****************************
     C*    DETAIL PROCESSING.    *
     C****************************
     C*
     C/EJECT
     C*
     C*************************************************
     C*    RECORD READ FROM OTPAYDD VIA LOGICAL PRPF1 *
     C*************************************************
     C/COPY WNCPYSRC,FT0641C059
      *                                                                   CFT014
     C                     MOVELCHTP      @CHG    1                                           CSW025
      *                                                                                       CSW025
      ** Only process live PRFP1 records                                                      246371
      *                                                                                       246371
     C           RECI      IFEQ 'D'                                                           246371
      *                                                                                       246371
      ** Access Outgoing Payments extension file.                         CFT014
      *                                                                   CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
     C           PREF      CHAINOTPAYXL2             28                   CFT014
     C           *IN28     IFEQ *ON                                       CFT014
     C           *IN28     OREQ *OFF                                      CFT014
     C           OPRECI    ANDNE'D'                                       CFT014
     C                     MOVE '036'     DBERR#                          CFT014
     C                     MOVELPREF      DBERKY                          CFT014
     C                     MOVEL'OTPAYXL2'DBFNAM                          CFT014
     C                     EXSR DBERR                                     CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   S01310
      ** Initialise non-constant fields                                   S01310
      *                                                                   S01310
     C                     EXSR INTF                                      S01310
     C*
     C                     EXSR BRANCH                                    S01117
     C/COPY WNCPYSRC,FT0641C002
     C*  KEEP TALLY OF NUMBER OF RECORDS READ FROM LF/PRFP1
     C*********************ADD  1         P3NO1                           S01117
     C                     ADD  1         AUNO1                           S01117
     C*                  *==========*
     C*
     C** SETOF *IN25 (NON UPDATE OF MFSCTL FOR MT210 TELEXES)
     C*
     C*********************SETOF                     26                   S01310
     C/COPY WNCPYSRC,FT0641C034
      *                                                                                       CSW218
      ** Field :121: - UETR (Unique End-to-end Transaction Reference)                         CSW218
      *                                                                                       CSW218
     C           CSW218    IFEQ 'Y'                                                           CSW218
      *                                                                                       CSW218
      ** Check if transaction is generated by Incoming message                                CSW218
      *                                                                                       CSW218
     C                     MOVEL*BLANKS   PUUID                                               CSW218
     C                     MOVEL'121:'    WTAG12                                              CSW218
     C/COPY WNCPYSRC,ERZ248_004                                                               ERZ248
     C           OPMSGR    IFNE 0                                                             CSW218
     C           KYINCM    CHAINMEINDTL0             98                                       CSW218
     C           *IN98     IFEQ *OFF                                                          CSW218
     C                     MOVELDTMFLD    PUUID                                               CSW218
     C                     ENDIF                                                              CSW218
     C                     ENDIF                                                              CSW218
     C/COPY WNCPYSRC,ERZ248_005                                                               ERZ248
      *                                                                                       CSW218
     C           PUUID     IFEQ *BLANKS                                                       CSW218
     C                     CALL UIDPGM                                                        CSW218
     C                     PARM *BLANKS   PUUID  50                                           CSW218
     C                     ENDIF                                                              CSW218
     C                     Z-ADD1         Q                                                   CSW218
     C           Q         OCUR MULT                                                          CSW218
     C                     MOVEL':121:'   MTAG                                                CSW218
     C                     MOVELPUUID     MFLD                                                CSW218
      *                                                                                       CSW218
     C/COPY WNCPYSRC,ERZ248_006                                                               ERZ248
     C                     ENDIF                                                              CSW218
      *                                                                   S01310
      ** Field 20. - Transaction Reference Number.                        S01310
      *                                                                   S01310
     C           CSW218    IFEQ 'Y'                                                           CSW218
     C                     ADD  1         Q                                                   CSW218
     C                     ELSE                                                               CSW218
     C                     Z-ADD1         Q                               S01310
     C                     ENDIF                                                              CSW218
     C/COPY WNCPYSRC,FT0641C035
     C           Q         OCUR MULT                                      S01310
     C                     MOVEA*BLANKS   @WRK                            S01310
      *                                                                   S01310
     C                     MOVEL':20:'    MTAG                            S01310
     C                     MOVEA'FT'      @WRK                            S01310
     C                     MOVEAPREF      @HLD                            S01310
     C           FULLRF    IFEQ 'Y'                                                           242289
     C**********           MOVEA@HLD,1    @WRK,3                                     242289 BUG15044
     C                     MOVEA@HLD,1    @WRK,1                                            BUG15044
     C                     ELSE                                                               242289
     C                     MOVEA@HLD,2    @WRK,3                          S01310
     C                     ENDIF                                                              242289
     C                     MOVEA@WRK      MFLD                            S01310
      *                                                                   S01310
      ** Save the transaction Reference Number.                           S01310
      *                                                                   S01310
     C                     MOVELMFLD      TRNA   16                       S01310
      *                                                                   S01310
      ***Field*32A*-*Value*Date,Currency*Code*and*Amount.********* S01310 CFT014
      ************************************************************ S01310 CFT014
     C***********          ADD  1         Q                        S01310 CFT014
     C***********Q         OCUR MULT                               S01310 CFT014
      ************************************************************ 058476 CFT014
      ***Clear*data*structure*to*prevent*old*data*being*output.*** 058476 CFT014
      ************************************************************ 058476 CFT014
     C***********          MOVEL*BLANKS   FLD32                    058476 CFT014
      ************************************************************ 058476 CFT014
     C***********          MOVEL':32A:'   MTAG                     S01310 CFT014
      **Value*Date.*********************************************** S01310 CFT014
     C***********          MOVE PVDTD3    DATE    6                S01310 CFT014
      **Currency.************************************************* S01310 CFT014
     C*********************MOVE PCCY      CCY32                     S01310S01117
     C***FORMAT*THE*AMOUNT**************************************** S01310 CFT014
     C***********          EXSR SR06                               S01310 CFT014
     C***********          MOVE M1RCCY    CCY32                    S01117 CFT014
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0641CCP1                                           S01408
     C*                                                                   S01408
     C***********          MOVEASAM       FAMT                     S01310 CFT014
     C***********          Z-ADD1         S       30               S01310 CFT014
     C***********FAMT,S    DOWEQ' '                                S01310 CFT014
     C***********          ADD  1         S                        S01310 CFT014
     C***********          END                                     S01310 CFT014
     C***********          MOVEAFAMT,S    AMNT32                   S01310 CFT014
      *                                                                   S01310
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0641CCP2                                           S01408
     C*                                                                   S01408
     C***********          MOVELFLD32     MFLD                     S01310 CFT014
      *                                                                   CEU006
      * Reset /OCMT/ AND /CHGS/ fields                                    CEU006
     C                     MOVE *BLANKS   O#CCY                           CEU006
     C                     MOVE *BLANKS   O#AMNT                          CEU006
     C                     MOVE *BLANKS   C#CCY                           CEU006
     C                     MOVE *BLANKS   C#AMNT                          CEU006
      *                                                                   CFT014
      ** Sum up the charges into work field used for tag :72: calcs.      CFT014
      *                                                                   CFT014
     C           TXCH      ADD  CQCH      W#CHGS 130                      CFT014
     C                     ADD  CSTA      W#CHGS                          CFT014
     C                     ADD  SPCH      W#CHGS                          CFT014
     C                     ADD  MSCH      W#CHGS                          CFT014
     C                     ADD  TRCM      W#CHGS                          CFT014
      *                                                                   CFT009
      ** If CFT009 is on, new charges are added                           CFT009
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
     C                     EXSR NEWCHG                                    CFT009
     C                     ADD  NCHGS     W#CHGS                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           S01494    IFEQ 'Y'                                       CFT014
     C                     ADD  OPCHCM    W#CHGS                          CFT014
     C                     ENDIF                                          CFT014
     C           S01499    IFEQ 'Y'                                       CFT014
     C                     ADD  OPVATT    W#CHGS                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Get equivalent amount of Charges in Pay Ccy.                     CFT014
      *                                                                   CFT014
     C                     Z-ADD*ZERO     WWCHG  130                      CFT014
      *                                                                   CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
     C           W#CHGS    ANDNE*ZERO                                     CFT014
      *                                                                   CFT014
      ** Determine Charges Currency.                                      CFT014
      *                                                                   CFT014
     C                     SELEC                                          CFT014
     C           CDRT      WHNE *BLANKS                                   CFT014
     C                     MOVELBJCYCD    WCCCY   3                       CFT014
     C           ADDC      WHEQ 'A'                                       CFT014
     C                     MOVELSMCY      WCCCY                           CFT014
     C                     OTHER                                          CFT014
     C                     MOVELPCCY      WCCCY                           CFT014
     C                     ENDSL                                          CFT014
      *                                                                   CFT014
     C           WCCCY     IFNE PCCY                                      CFT014
      *                                                                   CFT014
     C                     CLEARP#0010                                    CFT014
     C                     MOVELWCCCY     P#FRCY                          CFT014
     C                     Z-ADDW#CHGS    P#FRAM                          CFT014
     C                     MOVELPCCY      P#TOCY                          CFT014
     C                     Z-ADD*ZEROS    P#TOAM                          CFT014
     C                     CALL 'FT0010'                                  CFT014
     C                     PARM           P#0010                          CFT014
      *                                                                   CFT014
     C           P#RTCD    IFEQ '*ERROR*'                                 CFT014
     C                     MOVE '049'     DBERR#                          CFT014
     C                     MOVEL'*CALL'   DBERKY                          CFT014
     C                     MOVEL'FT0010'  DBFNAM                          CFT014
     C                     EXSR DBERR                                     CFT014
     C                     ELSE                                           CFT014
     C                     Z-ADDP#TOAM    WWCHG                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
     C                     Z-ADDW#CHGS    WWCHG                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CEU006
      * Set up Original Currency/Amount and Charges fields for            CEU006
      * field :72: if EMU Settlement on and Pay Delivery Amount           CEU006
      * entered                                                           CEU006
     C           CEU006    IFEQ 'Y'                                       CEU006
     C           PDAM      ANDNE0                                         CEU006
      *                                                                   CFT014
      ** Instructed Ccy details                                           CFT014
      *                                                                   CFT014
     C                     CALL 'AOCURRR0'                                CFT014
     C                     PARM *BLANKS   PRTCD                           CFT014
     C                     PARM '*KEY   ' POPTN                           CFT014
     C                     PARM PDCY      PWCCY   3                       CFT014
     C           SDCURR    PARM SDCURR    DSSDY                           CFT014
     C           PRTCD     IFEQ *BLANKS                                   CFT014
     C                     MOVE A6INCY    WINCY1  1                       CFT014
     C                     Z-ADDA6TPSD    WTPSD1  50                      CFT014
     C                     ELSE                                           CFT014
     C                     MOVE '037'     DBERR#                          CFT014
     C                     MOVELPDCY      DBERKY                          CFT014
     C                     MOVEL'SDCURRPD'DBFNAM                          CFT014
     C                     EXSR DBERR                                     CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Pay Ccy details                                                  CFT014
      *                                                                   CFT014
     C                     CALL 'AOCURRR0'                                CFT014
     C                     PARM *BLANKS   PRTCD                           CFT014
     C                     PARM '*KEY   ' POPTN                           CFT014
     C                     PARM PCCY      PWCCY                           CFT014
     C           SDCURR    PARM SDCURR    DSSDY                           CFT014
     C           PRTCD     IFEQ *BLANKS                                   CFT014
     C                     MOVE A6INCY    WINCY2  1                       CFT014
     C                     Z-ADDA6TPSD    WTPSD2  50                      CFT014
     C                     MOVE A6SWCY    WCCYS                           CFT014
     C                     Z-ADDA6NBDP    WCDP                            CFT014
     C                     ELSE                                           CFT014
     C                     MOVE '038'     DBERR#                          CFT014
     C                     MOVELPCCY      DBERKY                          CFT014
     C                     MOVEL'SDCURRPD'DBFNAM                          CFT014
     C                     EXSR DBERR                                     CFT014
     C                     ENDIF                                          CFT014
      ** If Instructed Currency is an 'In' Currency                       CFT014
      **    and Pay Currency is Euro                                      CFT014
      **    and 'In' Currency start date <= Pay Value date                CFT014
      ** Or Instructed Currency is Euro                                   CFT014
      **    and Pay Currency is an 'In' Currency                          CFT014
      **    and 'In' Currency start date <= Pay Value date                CFT014
      *                                                                   CFT014
     C           WINCY1    IFEQ 'Y'                                       CFT014
     C           PCCY      ANDEQBKEURO                                    CFT014
     C           WTPSD1    ANDLEPVDT                                      CFT014
     C           WINCY2    OREQ 'Y'                                       CFT014
     C           PDCY      ANDEQBKEURO                                    CFT014
     C           WTPSD2    ANDLEPVDT                                      CFT014
     C                     EXSR ERI                                       CEU006
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CEU006
      *                                                                   S01310
      ** Destination Customer.                                            S01310
      *                                                                   S01310
     C*
     C           DSTT      IFEQ 'F'
     C           DSTT      OREQ 'R'
     C           DSTT      OREQ 'C'
     C           DSTT      OREQ 'G'
     C           DSTT      OREQ 'A'                                       E25148
     C           DSTT      OREQ 'S'                                       068230
     C           STMT      OREQ 1                                         E21462
     C*
     C** SETUP PARAMETERS  AND EXECUTE SR01 TO
     C** DETERMINE SWIFT ADDRESS OF RECEIVING BANK
     C*
     C                     MOVELDSTT      ISPTP   1
     C                     MOVELDST1      ISPTY1 35
     C                     MOVE DST2      ISPTY2 35
     C                     MOVE DST3      ISPTY3 35
     C                     MOVE DST4      ISPTY4 35
     C/COPY WNCPYSRC,FT0641C042
     C                     MOVE *BLANKS   ISPTY5 35
     C                     MOVE PCCY      ISCCY   3
     C                     MOVE 'A'       IVTAG1  1
     C                     MOVE ' '       IVTAG2  1
      *                                                                                      260987A
     C           DSTT      IFEQ 'A'                                                          260987A
     C                     MOVE 'D'       IVTAG3  1                                          260987A
     C                     ELSE                                                              260987A
     C                     MOVE ' '       IVTAG3  1
     C                     ENDIF                                                             260987A
      *                                                                                      260987A
     C*                  *======*
     C                     ELSE
     C*                  *======*
     C** SETUP PARAMETERS  AND EXECUTE SR01 TO
     C** DETERMINE SWIFT ADDRESS OF SENDERS CORRESPONDENT
     C/COPY WNCPYSRC,FT0641C054
     C*
     C                     MOVELSNCT      ISPTP   1
     C                     MOVE *BLANKS   ISPTY1 35
     C                     MOVELSNCO      ISPTY1 35
     C                     MOVE *BLANKS   ISPTY2 35
     C                     MOVE *BLANKS   ISPTY3 35
     C                     MOVE *BLANKS   ISPTY4 35
     C                     MOVE *BLANKS   ISPTY5 35
     C                     MOVE PCCY      ISCCY   3
     C                     MOVE 'A'       IVTAG1  1
     C                     MOVE ' '       IVTAG2  1
     C                     MOVE ' '       IVTAG3  1
     C/COPY WNCPYSRC,FT0641C058
     C*
     C                     END
     C*                  *=====*
     C*
     C* SETON INDICATOR FOR SUBSEQUENT BLOCK OF SWFT CALL FOR
     C* DETAIL FIELD ADDRESSES(RATHER THAN DESTINATION ADDRESS)
     C*
     C                     SETON                     20
     C*
     C                     EXSR SR01
     C*
     C                     SETOF                     20
     C*
     C*********PARAMETERS*OFSPT1*SHOULD*BE*MOVED*TO********************                      260987A
     C*********FIELD*RECIPIENT*ADDRESS*OF*SWIFT*DATA*STRUCTURE*********                      260987A
     C*********SAVE*IT*AS*IT*WILL*BE*USED*IN*SUBROUTINE*10*&*4.********                      260987A
     C**********           MOVELOFSPT1    RECADD 12                                          260987A
      *                                                                                      260987A
      ** Output same destination to printout as MGOREFPD.                                    260987A
      *                                                                                      260987A
     C                     MOVELNWDS      RECADD 12                                          260987A
      *                                                                   S01310
      ** Move the new fields into the old field  names to ensure          S01310
      ** program continuity.                                              S01310
      *                                                                   S01310
     C                     MOVELBBCUST    CUSTNO                          S01310
     C                     MOVELBBCRTN    CTWN                            S01310
     C                     MOVELBBCRNM    CRNM                            S01310
     C* ****** SAVE CUSTOMER FIELDS TO BE USED IN SUBROUTINE 8.****
     C**********           MOVE CUSTNO    SCUSNO  60                                          CSD027
     C                     MOVE CUSTNO    SCUSNO  6                                           CSD027
     C                     MOVE CTWN      SCTWN  10
     C                     MOVE CRNM      SCRNM  20
     C                     MOVE SWTX      SWTWRK  1
     C*
     C***USE*SWIFT*OR*TELEX*ADDRESS*FOR*SENDERS*TID*DEPENDING*ON*THE***                      260987A
     C***ROUTING*INDICATOR*********************************************                      260987A
     C********** SWTX      IFEQ 'T'                                                          260987A
     C**********           MOVE MXOTLX    MXOTID 12                                          260987A
     C*********************SETON                     26                   S01310
     C**********           ELSE                                                              260987A
     C**********           MOVE MXOSFT    MXOTID                                             260987A
     C**********           END                                                               260987A
      *                                                                   CFT014
     C           WMT103    IFEQ 'Y'                                       CFT014
      *                                                                   CFT014
      ** Field 23B - Bank Operation Code                                  CFT014
      *                                                                   CFT014
     C                     ADD  1         Q                               CFT014
     C           Q         OCUR MULT                                      CFT014
     C                     MOVEL':23B:'   MTAG                            CFT014
     C/COPY WNCPYSRC,FT0641C060
     C                     MOVELOPBOCD    MFLD                            CFT014
     C                     MOVELOPBOCD    M9BOCD                          CFT014
     C/COPY WNCPYSRC,FT0641C061
      *                                                                   CFT014
      ** Field 23E - Instruction Code                                     CFT014
      ** - Precede each line with ':23E' tag.                             CFT014
      *                                                                   CFT014
     C                     MOVEL':23E:'   P1ICD1                          CFT014
     C           OPICD1    IFNE *BLANKS                                   CFT014
     C                     MOVELOPICD1    WOPICD    P                                         CSW206
     C           WOPICD    IFNE 'BONL'                                                        CSW206
     C           CSW206    ORNE 'Y'                                                           CSW206
     C                     ADD  1         Q                               CFT014
     C           Q         OCUR MULT                                      CFT014
     C                     MOVEL':23E:'   MTAG                            CFT014
     C                     MOVELOPICD1    MFLD                            CFT014
     C                     MOVELOPICD1    M9ICD1                          CFT014
     C                     MOVE OPICD1    P1ICD1                          CFT014
     C                     MOVELOPICD1    WCHR35                          CFT014
     C                     EXSR SRW23E                                    CFT014
     C                     MOVE WOK       W23E                            CFT014
     C                     ENDIF                                                              CSW206
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           OPICD2    IFNE *BLANKS                                   CFT014
     C                     MOVELOPICD2    WOPICD    P                                         CSW206
     C           WOPICD    IFNE 'BONL'                                                        CSW206
     C           CSW206    ORNE 'Y'                                                           CSW206
     C                     ADD  1         Q                               CFT014
     C           Q         OCUR MULT                                      CFT014
     C                     MOVEL':23E:'   MTAG                            CFT014
     C                     MOVEL':23E:'   P1ICD2                          CFT014
     C                     MOVELOPICD2    MFLD                            CFT014
     C                     MOVELOPICD2    M9ICD2                          CFT014
     C                     MOVE OPICD2    P1ICD2                          CFT014
      *                                                                   CFT014
      ** If there's no validation error yet, continue checking the        CFT014
      ** succeeding 23E lines.                                            CFT014
      *                                                                   CFT014
     C           W23E      IFEQ 'Y'                                       CFT014
     C                     MOVELOPICD2    WCHR35                          CFT014
     C                     EXSR SRW23E                                    CFT014
     C                     MOVE WOK       W23E                            CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                                              CSW206
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           OPICD3    IFNE *BLANKS                                   CFT014
     C                     MOVELOPICD3    WOPICD    P                                         CSW206
     C           WOPICD    IFNE 'BONL'                                                        CSW206
     C           CSW206    ORNE 'Y'                                                           CSW206
     C                     ADD  1         Q                               CFT014
     C           Q         OCUR MULT                                      CFT014
     C                     MOVEL':23E:'   MTAG                            CFT014
     C                     MOVEL':23E:'   P1ICD3                          CFT014
     C                     MOVELOPICD3    MFLD                            CFT014
     C                     MOVELOPICD3    M9ICD3                          CFT014
     C                     MOVE OPICD3    P1ICD3                          CFT014
     C           W23E      IFEQ 'Y'                                       CFT014
     C                     MOVELOPICD3    WCHR35                          CFT014
     C                     EXSR SRW23E                                    CFT014
     C                     MOVE WOK       W23E                            CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                                              CSW206
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           OPICD4    IFNE *BLANKS                                   CFT014
     C                     MOVELOPICD4    WOPICD    P                                         CSW206
     C           WOPICD    IFNE 'BONL'                                                        CSW206
     C           CSW206    ORNE 'Y'                                                           CSW206
     C                     ADD  1         Q                               CFT014
     C           Q         OCUR MULT                                      CFT014
     C                     MOVEL':23E:'   MTAG                            CFT014
     C                     MOVEL':23E:'   P1ICD4                          CFT014
     C                     MOVELOPICD4    MFLD                            CFT014
     C                     MOVELOPICD4    M9ICD4                          CFT014
     C                     MOVE OPICD4    P1ICD4                          CFT014
     C           W23E      IFEQ 'Y'                                       CFT014
     C                     MOVELOPICD4    WCHR35                          CFT014
     C                     EXSR SRW23E                                    CFT014
     C                     MOVE WOK       W23E                            CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                                              CSW206
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           OPICD5    IFNE *BLANKS                                   CFT014
     C                     MOVELOPICD5    WOPICD    P                                         CSW206
     C           WOPICD    IFNE 'BONL'                                                        CSW206
     C           CSW206    ORNE 'Y'                                                           CSW206
     C                     ADD  1         Q                               CFT014
     C           Q         OCUR MULT                                      CFT014
     C                     MOVEL':23E:'   MTAG                            CFT014
     C                     MOVEL':23E:'   P1ICD5                          CFT014
     C                     MOVELOPICD5    MFLD                            CFT014
     C                     MOVELOPICD5    M9ICD5                          CFT014
     C                     MOVE OPICD5    P1ICD5                          CFT014
     C           W23E      IFEQ 'Y'                                       CFT014
     C                     MOVELOPICD5    WCHR35                          CFT014
     C                     EXSR SRW23E                                    CFT014
     C                     MOVE WOK       W23E                            CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                                              CSW206
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Check if there are Bank-to-Bank info that need to be included    CFT014
      ** in the Instruction Code info.                                    CFT014
      *                                                                   CFT014
     C                     MOVE BBI1      WCHR35                          CFT014
     C                     MOVE *BLANK    WCHR01                          CFT014
     C                     EXSR SRCHK1                                    CFT014
     C                     MOVELWCHR35    WBBI1                           CFT014
     C           WOK       IFEQ 'Y'                                       CFT014
     C                     ADD  1         Q                               CFT014
     C           Q         OCUR MULT                                      CFT014
     C                     MOVEL':23E:'   MTAG                            CFT014
     C                     MOVELWOC35     MFLD                            CFT014
     C                     MOVE WOC35     WCHR35                          CFT014
     C                     EXSR SRICD1                                    CFT014
     C           W23E      IFEQ 'Y'                                       CFT014
     C                     MOVELWOC35     WCHR35                          CFT014
     C                     EXSR SRW23E                                    CFT014
     C                     MOVE WOK       W23E                            CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVE BBI2      WCHR35                          CFT014
     C                     MOVELWBBI1     WCHR01                          CFT014
     C                     EXSR SRCHK1                                    CFT014
     C                     MOVELWCHR35    WBBI2                           CFT014
     C           WOK       IFEQ 'Y'                                       CFT014
     C                     ADD  1         Q                               CFT014
     C           Q         OCUR MULT                                      CFT014
     C                     MOVEL':23E:'   MTAG                            CFT014
     C                     MOVELWOC35     MFLD                            CFT014
     C                     MOVE WOC35     WCHR35                          CFT014
     C                     EXSR SRICD1                                    CFT014
     C           W23E      IFEQ 'Y'                                       CFT014
     C                     MOVELWOC35     WCHR35                          CFT014
     C                     EXSR SRW23E                                    CFT014
     C                     MOVE WOK       W23E                            CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVE BBI3      WCHR35                          CFT014
     C                     MOVELWBBI2     WCHR01                          CFT014
     C                     EXSR SRCHK1                                    CFT014
     C                     MOVELWCHR35    WBBI3                           CFT014
     C           WOK       IFEQ 'Y'                                       CFT014
     C                     ADD  1         Q                               CFT014
     C           Q         OCUR MULT                                      CFT014
     C                     MOVEL':23E:'   MTAG                            CFT014
     C                     MOVELWOC35     MFLD                            CFT014
     C                     MOVE WOC35     WCHR35                          CFT014
     C                     EXSR SRICD1                                    CFT014
     C           W23E      IFEQ 'Y'                                       CFT014
     C                     MOVELWOC35     WCHR35                          CFT014
     C                     EXSR SRW23E                                    CFT014
     C                     MOVE WOK       W23E                            CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVE BBI4      WCHR35                          CFT014
     C                     MOVELWBBI3     WCHR01                          CFT014
     C                     EXSR SRCHK1                                    CFT014
     C                     MOVELWCHR35    WBBI4                           CFT014
     C           WOK       IFEQ 'Y'                                       CFT014
     C                     ADD  1         Q                               CFT014
     C           Q         OCUR MULT                                      CFT014
     C                     MOVEL':23E:'   MTAG                            CFT014
     C                     MOVELWOC35     MFLD                            CFT014
     C                     MOVE WOC35     WCHR35                          CFT014
     C                     EXSR SRICD1                                    CFT014
     C           W23E      IFEQ 'Y'                                       CFT014
     C                     MOVELWOC35     WCHR35                          CFT014
     C                     EXSR SRW23E                                    CFT014
     C                     MOVE WOK       W23E                            CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVE BBI5      WCHR35                          CFT014
     C                     MOVELWBBI4     WCHR01                          CFT014
     C                     EXSR SRCHK1                                    CFT014
     C                     MOVELWCHR35    WBBI5                           CFT014
     C           WOK       IFEQ 'Y'                                       CFT014
     C                     ADD  1         Q                               CFT014
     C           Q         OCUR MULT                                      CFT014
     C                     MOVEL':23E:'   MTAG                            CFT014
     C                     MOVELWOC35     MFLD                            CFT014
     C                     MOVE WOC35     WCHR35                          CFT014
     C                     EXSR SRICD1                                    CFT014
     C           W23E      IFEQ 'Y'                                       CFT014
     C                     MOVELWOC35     WCHR35                          CFT014
     C                     EXSR SRW23E                                    CFT014
     C                     MOVE WOK       W23E                            CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVE BBI6      WCHR35                          CFT014
     C                     MOVELWBBI5     WCHR01                          CFT014
     C                     EXSR SRCHK1                                    CFT014
     C                     MOVELWCHR35    WBBI6                           CFT014
     C           WOK       IFEQ 'Y'                                       CFT014
     C                     ADD  1         Q                               CFT014
     C           Q         OCUR MULT                                      CFT014
     C                     MOVEL':23E:'   MTAG                            CFT014
     C                     MOVELWOC35     MFLD                            CFT014
     C                     MOVE WOC35     WCHR35                          CFT014
     C                     EXSR SRICD1                                    CFT014
     C           W23E      IFEQ 'Y'                                       CFT014
     C                     MOVELWOC35     WCHR35                          CFT014
     C                     EXSR SRW23E                                    CFT014
     C                     MOVE WOK       W23E                            CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Field 26T - Transaction Type Code                                CFT014
      *                                                                   CFT014
     C           OPTTCD    IFNE *BLANKS                                   CFT014
     C                     ADD  1         Q                               CFT014
     C           Q         OCUR MULT                                      CFT014
     C                     MOVEL':26T:'   MTAG                            CFT014
     C                     MOVELOPTTCD    MFLD                            CFT014
     C                     MOVELOPTTCD    M9TTCD                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Field 32A - Value Date, Currency and Amount                      CFT014
      *                                                                   CFT014
     C                     ADD  1         Q                               CFT014
     C           Q         OCUR MULT                                      CFT014
     C                     MOVEL*BLANKS   FLD32                           CFT014
     C                     MOVEL':32A:'   MTAG                            CFT014
      *                                                                   CFT014
      ** Value Date                                                       CFT014
      *                                                                   CFT014
     C**********           MOVE PVDTD3    DATE    6                                  CFT014 MD033624
     C                     MOVE PVDTD3    FDATE                                             MD033624
      *                                                                   CFT014
      ** Amount                                                           CFT014
      *                                                                   CFT014
     C                     EXSR SR06                                      CFT014
     C                     MOVEASAM       FAMT                            CFT014
     C                     Z-ADD1         S       30                      CFT014
     C           FAMT,S    DOWEQ' '                                       CFT014
     C                     ADD  1         S                               CFT014
     C                     ENDDO                                          CFT014
     C                     MOVEAFAMT,S    AMNT32                          CFT014
      *                                                                   CFT014
      ** Currency                                                         CFT014
      *                                                                   CFT014
     C                     MOVE M1RCCY    CCY32                           CFT014
      *                                                                   CFT014
     C                     MOVELFLD32     MFLD                            CFT014
      *                                                                   CFT014
     C           WMT103    IFEQ 'Y'                                       CFT014
      *                                                                   CFT014
      ** Field 33B - Instructed Currency/Amount                           CFT014
      *                                                                   CFT014
     C           PDCY      IFNE *BLANKS                                   CFT014
     C                     ADD  1         Q                               CFT014
     C           Q         OCUR MULT                                      CFT014
     C                     MOVEL':33B:'   MTAG                            CFT014
     C                     MOVE PDCY      WICCY                           CFT014
     C                     Z-ADDPDAM      WIAMNT                          CFT014
     C                     EXSR SRFAMT                                    CFT014
     C                     MOVEA*BLANKS   WA1                             CFT014
     C                     MOVEAWOCCYS    WA1                             CFT014
     C                     MOVEAWOAMNT    WA1,4                           CFT014
     C                     MOVEAWA1       MFLD                            CFT014
     C                     MOVEAWA1       R33B                            CFT014
     C                     CALL 'ZSEDIT'                                  CFT014
     C                     PARM PDAM      PAMNT  150                      CFT014
     C                     PARM WODECS    PDECS   10                      CFT014
     C                     PARM 'J'       PCODE   1                       CFT014
     C                     PARM *BLANKS   POUT21 21                       CFT014
     C                     MOVELPOUT21    WCHR20 20                       CFT014
     C                     MOVE WCHR20    P2PDAM                          CFT014
     C                     MOVELPDCY      P2PDCY                          CFT014
     C                     MOVELWOCCYS    M9PDCY                          CFT014
     C                     MOVELWOAMNT    M9PDAM                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                                       CSW202
      ** Suppress Exchange rate if Instructed Currency is equal to                            CSW202
      ** currency code M1RCCY                                                                 CSW202
      *                                                                                       CSW202
     C                     MOVE 'N'       WBYPAS  1                                           CSW202
     C           CSW202    IFEQ 'Y'                                                           CSW202
     C           PDCY      ANDEQM1RCCY                                                        CSW202
     C           PDCY      ANDNE*BLANKS                                                       CSW202
     C           CSW202    OREQ 'Y'                                                           CSW202
     C           PDCY      ANDEQ*BLANKS                                                       CSW202
      *                                                                                      BUG4695
     C           M9PDCY    OREQ M1RCCY                                                       BUG4695
     C           M9PDCY    ANDNE*BLANKS                                                      BUG4695
     C           CSW202    ANDEQ'Y'                                                           225715
     C           PDCY      OREQ *BLANKS                                                      BUG4695
     C           CSW202    ANDEQ'Y'                                                           225715
      *                                                                                      BUG4695
     C                     MOVE 'Y'       WBYPAS                                              CSW202
     C                     ENDIF                                                              CSW202
      *                                                                   CFT014
      ** Field 36 - Exchange Rate                                         CFT014
      *                                                                   CFT014
     C           OPOEXR    IFNE 0                                         CFT014
     C           WBYPAS    ANDEQ'N'                                                           CSW202
     C                     ADD  1         Q                               CFT014
     C           Q         OCUR MULT                                      CFT014
     C                     MOVEL':36:'    MTAG                            CFT014
     C                     Z-ADDOPOEXR    WIPRIC                          CFT014
     C                     EXSR SR1190                                    CFT014
     C                     MOVELWSPRIC    MFLD                            CFT014
     C                     MOVELWSPRIC    M9OEXR                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
     C           WMT103    ANDNE'Y'                                       CFT014
      *                                                                   CFT014
      ** Search for the Charges info on the Bank to Bank info field.      CFT014
      ** If not found, allow output of Charges info.                      CFT014
      *                                                                   CFT014
     C           '/CHGS'   SCAN BBI1                     28               CFT014
      *                                                                   CFT014
      ** If not found, continue scanning up to BBI6.                      CFT014
      *                                                                   CFT014
     C           *IN28     IFEQ *OFF                                      CFT014
     C           BBI2      ANDNE*BLANKS                                   CFT014
     C           '/CHGS'   SCAN BBI2                     28               CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           *IN28     IFEQ *OFF                                      CFT014
     C           BBI3      ANDNE*BLANKS                                   CFT014
     C           '/CHGS'   SCAN BBI3                     28               CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           *IN28     IFEQ *OFF                                      CFT014
     C           BBI4      ANDNE*BLANKS                                   CFT014
     C           '/CHGS'   SCAN BBI4                     28               CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           *IN28     IFEQ *OFF                                      CFT014
     C           BBI5      ANDNE*BLANKS                                   CFT014
     C           '/CHGS'   SCAN BBI5                     28               CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           *IN28     IFEQ *OFF                                      CFT014
     C           BBI6      ANDNE*BLANKS                                   CFT014
     C           '/CHGS'   SCAN BBI6                     28               CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** '/CHGS' is not found in BBI1-BBI6.                               CFT014
      *                                                                   CFT014
     C           *IN28     IFEQ *OFF                                      CFT014
     C                     MOVE 'Y'       WOCHGS                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           O#CCY     IFNE *BLANKS                                   CFT014
     C           C#CCY     ANDNE*BLANKS                                   CFT014
     C                     MOVE *BLANK    WOCHGS                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Process Third Reimbursement Institution for MT100.               CFT014
      *                                                                   CFT014
     C           OPTRIT    IFEQ 'C'                                       CFT014
     C           OPTRIT    OREQ 'S'                                       CFT014
     C                     MOVELOPTRIT    ISPTP                           CFT014
     C                     MOVELOPTRI1    ISPTY1                          CFT014
     C                     MOVELOPTRI2    ISPTY2                          CFT014
     C                     MOVELOPTRI3    ISPTY3                          CFT014
     C                     MOVELOPTRI4    ISPTY4                          CFT014
     C                     MOVELOPTRI5    ISPTY5                          CFT014
     C                     MOVEL*BLANKS   ISCCY                           CFT014
     C                     MOVEL'A'       IVTAG1                          CFT014
     C                     MOVEL*BLANK    IVTAG2                          CFT014
     C                     MOVEL*BLANK    IVTAG3                          CFT014
     C                     EXSR SR01                                      CFT014
     C                     MOVELOFSPT1    WOTRI1                          CFT014
     C                     MOVELOFSPT2    WOTRI2                          CFT014
     C                     MOVELOFSPT3    WOTRI3                          CFT014
     C                     MOVELOFSPT4    WOTRI4                          CFT014
     C                     MOVELOFSPT5    WOTRI5                          CFT014
     C                     MOVE OSTAG     WOTRTG                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                                      260987A
      ** Sender's address on printout to be same as output to MGOREFPD.                      260987A
      *                                                                                      260987A
     C                     MOVELNWSN      MXOTID 12                                          260987A
      *                                                                   CFT014
     C/COPY WNCPYSRC,FT0641C049
     C*
     C***IF*THE*SWIFT*USER*FLAG = 'N' FROM SUBROUTINE SR01                S01310
     C***THEN*THE*MESSAGE*MUST BE SENT VIA TELEX                          S01310
      *                                                                   S01310
      ** If the swift user flag = 'N' from subroutine SR01                S01310
      ** then the message is a paper message and is printed out.          S01310
      ** A record is still written to PF/MGOMSGPD and PF/MGOREFPD.        S01310
      *                                                                   S01310
     C*
     C           OSUFLG    IFEQ 'N'
     C*                                                                   S01117
     C* IF MULTIBRANCHING INDICATOR ACTIVE, MOVE BOOKING BRANCH AND       S01117
     C* BRANCH NAME TO THE RELATIVE FIELDS SET UP WITHIN THE PRINTER FILE S01117
     C*                                                                   S01117
     C           *IN50     IFEQ '1'                                       S01117
     C                     MOVE BRCAA     P2BRCA                          S01117
     C                     MOVELBRNM      P2BRNM                          S01117
     C                     END                                            S01117
     C* ****** FORMAT RECEIVING BANK FROM DESTINATION FIELDS ******
     C                     MOVELDSTT      ISPTP
     C                     MOVELPCCY      ISCCY                           S01435
     C                     MOVELDST1      ISPTY1
     C                     MOVE DST2      ISPTY2
     C                     MOVE DST3      ISPTY3
     C                     MOVE DST4      ISPTY4
     C                     MOVE *BLANKS   ISPTY5
     C                     EXSR SR05
     C* ****** DESTINATION FIELD PRINT LINE                  ******
     C                     MOVELOFSPT1    P2DST1
     C                     MOVELOFSPT2    P2DST2
     C                     MOVELOFSPT3    P2DST3
     C                     MOVELOFSPT4    P2DST4
     C                     MOVELOFSPT5    P2DST5
     C*
     C* ****** FORMAT SENDERS CORRESPONDENT                  ******
     C                     MOVELSNCT      ISPTP
     C                     MOVELPCCY      ISCCY                           S01435
     C                     MOVE *BLANKS   ISPTY1
     C                     MOVELSNCO      ISPTY1
     C                     MOVE *BLANKS   ISPTY2
     C                     MOVE *BLANKS   ISPTY3
     C                     MOVE *BLANKS   ISPTY4
     C                     MOVE *BLANKS   ISPTY5
     C                     EXSR SR05
     C* ****** MOVE FORMATTED SENDERS CORRESPONDENCE INTO    ******
     C* ****** PRINT LINE                                    ******
     C                     MOVELOFSPT1    P2SNC1
     C                     MOVELOFSPT2    P2SNC2
     C                     MOVELOFSPT3    P2SNC3
     C                     MOVELOFSPT4    P2SNC4
     C                     MOVELOFSPT5    P2SNC5
     C* ****** FORMAT RECEIVERS CORRESPONDENT                ******
     C                     MOVELRCRT      ISPTP
     C                     MOVELPCCY      ISCCY                           S01435
     C                     MOVELRCO1      ISPTY1
     C                     MOVELRCO2      ISPTY2
     C                     MOVELRCO3      ISPTY3
     C                     MOVELRCO4      ISPTY4
     C                     MOVELRCO5      ISPTY5
     C                     EXSR SR05
     C* ****** MOVE FORMATTED RECEIVERS CORRESPONDENCE INTO  ******
     C* ****** PRINT LINE                                    ******
     C                     MOVELOFSPT1    P2RCR1
     C                     MOVELOFSPT2    P2RCR2
     C                     MOVELOFSPT3    P2RCR3
     C                     MOVELOFSPT4    P2RCR4
     C                     MOVELOFSPT5    P2RCR5
     C*
     C* ****** FORMAT ACCOUNT WITH BANK                      ******
     C                     MOVELACBT      ISPTP
     C                     MOVELPCCY      ISCCY                           S01435
     C                     MOVELACB1      ISPTY1
     C                     MOVELACB2      ISPTY2
     C                     MOVELACB3      ISPTY3
     C                     MOVELACB4      ISPTY4
     C                     MOVELACB5      ISPTY5
     C                     EXSR SR05
     C* ****** MOVE FORMATTED ACCOUNT WITH BANK FIELDS       ******
     C* ****** INTO PRINT LINE                               ******
     C                     MOVELOFSPT1    P2AWB1
     C                     MOVELOFSPT2    P2AWB2
     C                     MOVELOFSPT3    P2AWB3
     C                     MOVELOFSPT4    P2AWB4
     C                     MOVELOFSPT5    P2AWB5
     C*
     C* ****** FORMAT BENEFICIARY CUSTOMER                   ******
     C                     MOVELBNCT      ISPTP
     C                     MOVELPCCY      ISCCY                           S01435
     C                     MOVELBNC1      ISPTY1
     C                     MOVELBNC2      ISPTY2
     C                     MOVELBNC3      ISPTY3
     C                     MOVELBNC4      ISPTY4
     C                     MOVELBNC5      ISPTY5
     C                     EXSR SR05
     C*
     C*********_____________________________________________              E32481
     C*********IF*MT202*FIELD ON SCREEN IS 'Y' SEND AN MT202              E32481
     C*********---------------------------------------------              E32481
     C*********************                                               E32481
     C***********SNMT******IFEQ 'Y'                                       E32481
     C*********************CALL 'FTC0648'                                 E32481
     C*********************PARM           PREF                            E32481
     C*********************PARM           RSEQ                      S01117E32481
     C*********************END                                            E32481
     C*
     C*
     C* ****** MOVE FORMATTED BENEFICIARY CUSTOMER FIELDS    ******
     C* ****** INTO PRINT LINE                               ******
     C                     MOVELOFSPT1    P2BC1
     C                     MOVELOFSPT2    P2BC2
     C                     MOVELOFSPT3    P2BC3
     C                     MOVELOFSPT4    P2BC4
     C                     MOVELOFSPT5    P2BC5
     C*                                                                ***
     C* ** FORMAT BANK TO BANK INFORMATIONS                            ***
      *                                                                   CFT014
     C           WMT103    IFNE 'Y'                                       CFT014
      *                                                                   CFT014
     C                     MOVE BBI1      P2BTB1                       ***
     C                     MOVE BBI2      P2BTB2                       ***
     C                     MOVE BBI3      P2BTB3                       ***
     C                     MOVE BBI4      P2BTB4                       ***
     C                     MOVE BBI5      P2BTB5                       ***
     C                     MOVE BBI6      P2BTB6                       ***
      *                                                                   CFT014
      ** Details of Charges is 'BEN' and '/CHGS' is not found in          CFT014
      ** BBI1-6 and '/CHGS' is not due to be output by EMU changes.       CFT014
      *                                                                   CFT014
     C           DTCH      IFEQ 'BEN'                                     CFT014
     C           WOCHGS    ANDEQ'Y'                                       CFT014
      *                                                                   CFT014
     C                     MOVE PCCY      WICCY                           CFT014
     C                     Z-ADDWWCHG     WIAMNT                          CFT014
     C                     EXSR SRFAMT                                    CFT014
      *                                                                   CFT014
     C                     MOVE P2BTB5    P2BTB6                          CFT014
     C                     MOVE P2BTB4    P2BTB5                          CFT014
     C                     MOVE P2BTB3    P2BTB4                          CFT014
     C                     MOVE P2BTB2    P2BTB3                          CFT014
     C                     MOVE P2BTB1    P2BTB2                          CFT014
      *                                                                   CFT014
     C                     MOVEA*BLANKS   WA1                             CFT014
     C                     MOVEA'/CHGS/'  WA1                             CFT014
     C                     MOVEAWOCCYS    WA1,7                           CFT014
     C                     MOVEAWOAMNT    WA1,10                          CFT014
     C* Put a closing '/' at the end of the amount                        CFT014
     C                     Z-ADD1         @N      20                      CFT014
     C           ' '       LOKUPWA1,@N                   61               CFT014
     C                     MOVEA'/'       WA1,@N                          CFT014
     C                     MOVEAWA1       P2BTB1                          CFT014
      *                                                                   CFT014
      ** /OCMT/ information is present.                                   CFT014
      *                                                                   CFT014
     C           O#CCY     IFNE *BLANKS                                   CFT014
     C                     MOVE P2BTB5    P2BTB6                          CFT014
     C                     MOVE P2BTB4    P2BTB5                          CFT014
     C                     MOVE P2BTB3    P2BTB4                          CFT014
     C                     MOVE P2BTB2    P2BTB3                          CFT014
     C                     MOVE OCMT      P2BTB2                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CEU006
      * If /OCMT/ information is present, the Bank To Bank lines          CEU006
      * must be shifted down to accomodate it                             CEU006
     C           O#CCY     IFNE *BLANKS                                   CEU006
     C                     MOVE P2BTB5    P2BTB6                          CEU006
     C                     MOVE P2BTB4    P2BTB5                          CEU006
     C                     MOVE P2BTB3    P2BTB4                          CEU006
     C                     MOVE P2BTB2    P2BTB3                          CEU006
     C                     MOVE P2BTB1    P2BTB2                          CEU006
     C                     MOVE OCMT      P2BTB1                          CEU006
      *                                                                   CEU006
      * likewise for /CHGS/ (goes below /OCMT/)                           CEU006
     C           C#CCY     IFNE *BLANKS                                   CEU006
     C                     MOVE P2BTB5    P2BTB6                          CEU006
     C                     MOVE P2BTB4    P2BTB5                          CEU006
     C                     MOVE P2BTB3    P2BTB4                          CEU006
     C                     MOVE P2BTB2    P2BTB3                          CEU006
     C                     MOVE CHGS      P2BTB2                          CEU006
     C                     ENDIF                                          CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
      *                                                                   CFT014
      ** Third Reimbursement Institution                                  CFT014
      *                                                                   CFT014
     C           WOTRTG    IFEQ 'A'                                       CFT014
     C                     MOVE *BLANKS   WCHR40 40                       CFT014
     C                     MOVEL'/RCB/'   WCHR40                          CFT014
     C                     MOVELOPTRI1    ##001                           CFT014
     C           ##001     IFEQ '/'                                       CFT014
     C                     MOVE WOTRI2    WCHR40                          CFT014
     C                     ELSE                                           CFT014
     C                     MOVE WOTRI1    WCHR40                          CFT014
     C                     ENDIF                                          CFT014
     C                     MOVELWCHR40    WCHR35                          CFT014
     C                     EXSR SRBTB2                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Output Instruction Code info on the next available line, if      CFT014
      ** there's any.  It is possible that not all of the info will be    CFT014
      ** accomodated.                                                     CFT014
      *                                                                   CFT014
     C           P2BTB6    IFEQ *BLANKS                                   CFT014
      *                                                                   CFT014
     C                     MOVELOPICD1    WCHR04                          CFT014
     C                     MOVE OPICD1    WCHR31 31                       CFT014
     C                     EXSR SRICBB                                    CFT014
     C           WOK       IFEQ 'Y'                                       CFT014
     C                     EXSR SRBTB2                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVELOPICD2    WCHR04                          CFT014
     C                     MOVE OPICD2    WCHR31                          CFT014
     C                     EXSR SRICBB                                    CFT014
     C           WOK       IFEQ 'Y'                                       CFT014
     C                     EXSR SRBTB2                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVELOPICD3    WCHR04                          CFT014
     C                     MOVE OPICD3    WCHR31                          CFT014
     C                     EXSR SRICBB                                    CFT014
     C           WOK       IFEQ 'Y'                                       CFT014
     C                     EXSR SRBTB2                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVELOPICD4    WCHR04                          CFT014
     C                     MOVE OPICD4    WCHR31                          CFT014
     C                     EXSR SRICBB                                    CFT014
     C           WOK       IFEQ 'Y'                                       CFT014
     C                     EXSR SRBTB2                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVELOPICD5    WCHR04                          CFT014
     C                     MOVE OPICD5    WCHR31                          CFT014
     C                     EXSR SRICBB                                    CFT014
     C           WOK       IFEQ 'Y'                                       CFT014
     C                     EXSR SRBTB2                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C/COPY WNCPYSRC,FT0641C005
     C*                                                                   E21465
     C* ****** FORMAT ORDERING CUSTOMER                      ******       E21465
     C                     MOVELORCT      ISPTP                           E21465
     C                     MOVELSMCY      ISCCY                           S01435
     C                     MOVELORC1      ISPTY1                          E21465
     C                     MOVELORC2      ISPTY2                          E21465
     C                     MOVELORC3      ISPTY3                          E21465
     C                     MOVELORC4      ISPTY4                          E21465
     C                     MOVELORC5      ISPTY5                                            BUG14771
     C**********           MOVEL*BLANK    ISPTY5                          E21465            BUG14771
      *                                                                                       CFT032
     C**********           EXSR SROUFM                                                 CFT032 250600
     C**********           MOVE ORC1      ADCHK1                                     CFT032 BUG15037
     C                     MOVELORC1      ADCHK1                                            BUG15037
     C           ADSLSH    IFEQ '/'                                                           CFT032
     C           ORCT      ANDEQ'P'                                                           CFT032
     C           ADSLSH    OREQ '/'                                                           CFT032
     C           ORCT      ANDEQ'I'                                                           CFT032
     C           ADSLSH    OREQ '/'                                                           CFT032
     C           ORCT      ANDEQ'R'                                                           CFT032
     C                     SUBSTORC1:2    ISPTY1                                              CFT032
     C                     ENDIF                                                              CFT032
      *                                                                                       CFT032
     C           ADSLSH    IFEQ '/'                                                           CFT032
     C           ORCT      ANDEQ'A'                                                           CFT032
     C           ADSLSH    OREQ '/'                                                           CFT032
     C           ORCT      ANDEQ'S'                                                           CFT032
     C           ADSLSH    OREQ '/'                                                           CFT032
     C           ORCT      ANDEQ'C'                                                           CFT032
     C                     MOVE ORC2      ISPTY1                                              CFT032
     C                     MOVE ORC3      ISPTY2                                              CFT032
     C                     MOVE ORC4      ISPTY3                                              CFT032
     C                     MOVE ORC5      ISPTY4                                              CFT032
     C                     ENDIF                                                              CFT032
      *                                                                                       CFT032
     C                     EXSR SR05                                      E21465
     C* ****** MOVE FORMATTED ACCOUNT WITH BANK FIELDS       ******       E21465
     C* ****** INTO PRINT LINE                               ******       E21465
      *                                                                                     BUG14771
     C           WMT103    IFEQ 'Y'                                                         BUG14771
     C********** CFT032    ANDEQ'Y'                                               BUG14771 BUG14771A
      *                                                                                     BUG14771
     C                     MOVEL':50K:'   @MSGTG                                            BUG14771
      *                                                                                     BUG14771
     C                     MOVE *BLANKS   ##ACLN 35                                         BUG14771
      *                                                                                     BUG14771
     C                     MOVELORCT      WENTTP                                            BUG14771
     C/COPY WNCPYSRC,FTH00574
     C                     MOVELORC1      WACCT                                             BUG14771
     C/COPY WNCPYSRC,FTH00575
     C                     MOVELSMCY      WCCY                                              BUG14771
     C                     MOVEL*BLANKS   WBRCA                                             BUG14771
      *                                                                                     BUG14771
     C                     MOVELOFSPT1    W@CNA1 35                                         BUG14771
     C                     MOVELOFSPT2    W@CNA2 35                                         BUG14771
     C                     MOVELOFSPT3    W@CNA3 35                                         BUG14771
     C                     MOVELOFSPT4    W@CNA4 35                                         BUG14771
     C                     MOVELOFSPT5    W@CNA5 35                                         BUG14771
      *                                                                                     BUG14771
     C********** CFT032    IFEQ 'Y'                                               AR945367A MD045920
     C                     EXSR SROUFM                                                      BUG14771
     C**********           ENDIF                                                  AR945367A MD045920
      *                                                                                     BUG14771
     C                     MOVELW@CNA1    OFSPT1                                            BUG14771
     C                     MOVELW@CNA2    OFSPT2                                            BUG14771
     C                     MOVELW@CNA3    OFSPT3                                            BUG14771
     C                     MOVELW@CNA4    OFSPT4                                            BUG14771
     C                     MOVELW@CNA5    OFSPT5                                            BUG14771
      ***Insert*Customer/account*number*reference                                    252874 MD046436
     C********** CFT032    IFEQ 'N'                                                  252874 MD046436
     C**********           EXSR SRICAR                                               252874 MD046436
     C**********           ENDIF                                                     252874 MD046436
     C                     ENDIF                                                            BUG14771
      *                                                                                     BUG14771
      *                                                                                       CFT032
     C********** ##ACLN    IFNE *BLANKS                                              CFT032 BUG14771
     C**********           MOVEL##ACLN    P2ORC1                                     CFT032 BUG14771
     C**********           MOVELOFSPT1    P2ORC2                                     CFT032 BUG14771
     C**********           MOVELOFSPT2    P2ORC3                                     CFT032 BUG14771
     C**********           MOVELOFSPT3    P2ORC4                                     CFT032 BUG14771
     C**********           MOVELOFSPT4    P2ORC5                                     CFT032 BUG14771
     C**********           ELSE                                                      CFT032 BUG14771
     C                     MOVELOFSPT1    P2ORC1                          E21465
     C                     MOVELOFSPT2    P2ORC2                          E21465
     C                     MOVELOFSPT3    P2ORC3                          E21465
     C                     MOVELOFSPT4    P2ORC4                          E21465
     C                     MOVELOFSPT5    P2ORC5                          E21465
     C**********           ENDIF                                                     CFT032 BUG14771
     C/COPY WNCPYSRC,FT0641C006
     C*                                                                   E21465
     C* ****** FORMAT INTERMEDIARY BANK                      ******       E21465
     C                     MOVELINBT      ISPTP                           E21465
     C                     MOVELPCCY      ISCCY                           S01435
     C                     MOVELINB1      ISPTY1                          E21465
     C                     MOVELINB2      ISPTY2                          E21465
     C                     MOVELINB3      ISPTY3                          E21465
     C                     MOVELINB4      ISPTY4                          E21465
     C                     MOVELINB5      ISPTY5                          E21465
     C                     EXSR SR05                                      E21465
     C* ****** MOVE FORMATTED ACCOUNT WITH BANK FIELDS       ******       E21465
     C* ****** INTO PRINT LINE                               ******       E21465
     C                     MOVELOFSPT1    P2INB1                          E21465
     C                     MOVELOFSPT2    P2INB2                          E21465
     C                     MOVELOFSPT3    P2INB3                          E21465
     C                     MOVELOFSPT4    P2INB4                          E21465
     C                     MOVELOFSPT5    P2INB5                          E21465
      *                                                                   CFT014
      ** Condition display of Original Exchg Rate.                        CFT014
      *                                                                   CFT014
     C           OPOEXR    IFEQ 0                                         CFT014
     C                     MOVE *OFF      *IN26                           CFT014
     C                     ELSE                                           CFT014
     C                     MOVE *ON       *IN26                           CFT014
     C                     Z-ADD0         P2OEXR                          CFT014
     C                     MOVE OPOEXR    P2OEXR                          CFT014
     C                     ENDIF                                          CFT014
     C*
     C* ****** DETERMINE AMOUNT      ****
     C                     EXSR SR06
      *                                                                   CFT014
      ** Do printing of TELEX report here for MT100.                      CFT014
      *                                                                   CFT014
     C                     MOVE 'Y'       WTLX                            CFT014
     C           WMT103    IFNE 'Y'                                       CFT014
     C                     EXSR SRP2                       PRT TELX REPORT
     C                     ENDIF                                          CFT014
     C/COPY WNCPYSRC,FT0641C033
     C*********************ELSE                            SWFT USER FLG=YS01310
     C                     END                                            S01310
     C*
      *                                                                   S01310
      ** To write a record to PF/MGOMSGPD and PF/MGOREFPD for every       S01310
      ** message processed.                                               S01310
      *                                                                   S01310
     C*  INTIALISE AND PRESET FIELDS IN DATA STRUCTURE
     C*  FOR SWIFT MESSAGES TYPE RECORDS
     C                     EXSR SR10
     C*
      *                                                                   S01310
      ** Field 50 - Ordering Customer.                                    S01310
     C/COPY WNCPYSRC,FT0641C007
      *                                                                   S01310
     C*  SETUP PARAMETERS AND EXECUTE SR01 TO
     C*  FORMAT THE ORDERING CUSTOMER
     C*LUX41
      *                                                                   S01310
      ** ODMT is the MT100 Ordering Customer (6A).                        S01310
      *                                                                   S01310
     C           ODMT      IFNE *BLANK
     C           ODMT      ANDNE'0'
     C*********************MOVELODMT      KCUSNO                          S01310
     C*********************MOVE 'A'       KEYA                            S01310
     C*********************                                               S01310
     C***********CUSKEY****CHAINCLINTCBF             12    ON, DELETED    S01310
     C************IN12*****IFEQ '1'                         ))))))))))))))S01310
     C*********************MOVE 'CLINT'   DBFNAM  5         )))  DATA  )))S01310
     C*********************MOVEL'      A' DBERKY            )))  BASE  )))S01310
     C*********************MOVELKCUSNO    DBERKY            )))  BASE  )))S01310
     C*********************MOVE '20'      DBERR#  2         ))) ERROR  )))S01310
     C*********************EXSR DBERR                       )))   20   )))S01310
     C*********************END                              ))))))))))))))S01310
     C*********************                                               S01310
     C********** ODMTT     IFEQ 'O'                                                  CSW207A CSW207A
      *                                                                                      CSW207A
      ***Access*SDNAHOPD*using*MT103*Account*value                                    CSW207A 250600
      **********                                                                      CSW207A 250600
     C**********           MOVELODMT      @KEY1                                       CSW207A 250600
     C**********           CALL 'AONAHOR0'                                            CSW207A 250600
     C**********           PARM *BLANKS   @RTCD                                       CSW207A 250600
     C**********           PARM '*KEY'    @OPTN                                       CSW207A 250600
     C**********           PARM           @KEY1                                       CSW207A 250600
     C********** SDNAHO    PARM SDNAHO    DSSDY                                       CSW207A 250600
      **********                                                                      CSW207A 250600
      ***Record*not*found*-*Error                                                     CSW207A 250600
      **********                                                                      CSW207A 250600
     C********** @RTCD     IFNE *BLANKS                                              CSW207A CSW207A
     C********** @RTCD     IFEQ *BLANKS                                               CSW207A 250600
     C**********           MOVEL'O'       ODMTT                                       CSW207A 250600
     C**********           MOVELODMT      PNAHO                                       CSW207A 250600
     C**********           MOVE '19'      DBERR#             * * * * * * *           CSW207A CSW207A
     C**********           MOVEL@KEY1     DBERKY             * DBERR 019 *           CSW207A CSW207A
     C**********           MOVEL'SDNAHOPD'DBFNAM             * * * * * * *           CSW207A CSW207A
     C**********           EXSR DBERR                                                CSW207A CSW207A
     C**********           ENDIF                                                     CSW207A CSW207A
     C**********           MOVE *BLANKS   CSID                                        CSW207A 250600
     C**********           MOVE NHCNA1    CNA1                                        CSW207A 250600
     C**********           MOVE NHCNA2    CNA2                                        CSW207A 250600
     C**********           MOVE NHCNA3    CNA3                                        CSW207A 250600
     C**********           MOVE NHCNA4    CNA4                                        CSW207A 250600
     C**********           ELSE                                                       CSW207A 250600
     C**********           MOVEL*BLANKS   PNAHO                                       CSW207A 250600
     C**********           MOVEL*BLANKS   PACCTP                                      CSW207A 250600
      *                                                                   S01310
      **  Access SDCUSTPD using ordering customer.                        S01310
      *                                                                   S01310
     C**********           MOVE *BLANKS   @KEY1                           S01310              250600
     C**********           MOVELODMT      @KEY1                           S01310              250600
     C**********           CALL 'AOCUSTR0'                                S01310              250600
     C**********           PARM *BLANK    @RTCD   7                       S01310              250600
     C**********           PARM '*KEY   ' @OPTN   7                       S01310              250600
     C**********           PARM           @KEY1  10                       S01310              250600
     C**********           PARM *BLANKS   @KYST   7                       S01310              250600
     C********** SDCUST    PARM SDCUST    DSSDY                           S01310              250600
      *                                                                   S01310
      ** Customer record not found - Error                                S01310
      *                                                                   S01310
     C********** @RTCD     IFNE *BLANKS                                   S01310              250600
     C********** CSW207    ANDNE'Y'                                                   CSW207A 250600
     C**********           MOVE '20'      DBERR#             * * * * * * *S01310              250600
     C**********           MOVEL@KEY1     DBERKY             * DBERR 020 *S01310              250600
     C**********           MOVEL'SDCUSTPD'DBFNAM             * * * * * * *S01310              250600
     C**********           EXSR DBERR                                     S01310              250600
     C**********           END                                            S01310              250600
     C/COPY WNCPYSRC,FT0641C016
      *                                                                   S01310
      ** Move the new field names to the old for pgm continuity.          S01310
      *                                                                   S01310
     C********** @RTCD     IFEQ *BLANKS                                               CSW207A 250600
     C**********           MOVELBBCSID    CSID                            S01310              250600
     C**********           MOVELBBCNA1    CNA1   35                       S01310              250600
     C**********           MOVELBBCNA2    CNA2   35                       S01310              250600
     C**********           MOVELBBCNA3    CNA3   35                       S01310              250600
     C**********           MOVELBBCNA4    CNA4   35                       S01310              250600
     C**********           ENDIF                                                      CSW207A 250600
     C**********           ENDIF                                                      CSW207A 250600
      *                                                                   S01310
     C********** CSID      IFNE *BLANK                                    096267
     C**********           MOVEL'S'       ISPTP                           096267
     C**********           MOVELCSID      ISPTY1                          096267
     C**********           MOVE *BLANKS   ISPTY2                          096267
     C**********           MOVE *BLANKS   ISPTY3                          096267
     C**********           MOVE *BLANKS   ISPTY4                          096267
     C**********           MOVE *BLANKS   ISPTY5                          096267
     C**********           MOVE SMCY      ISCCY   3        CURRENCY       096267
     C**********           MOVE 'A'       IVTAG1  1        TAG IND 1      096267
     C**********           MOVE ' '       IVTAG2  1        TAG IND 2      096267
     C**********           MOVE ' '       IVTAG3  1        TAG IND 3      096267
     C**********                                                          096267
     C**********           EXSR SR01                                      096267
     C*********************END                                            S01310
     C*
     C***********CSID******IFEQ *BLANK                                    S01310
     C*********************MOVELODMT      KCUSNO                          S01310
     C*********************MOVE 'B'       KEYA                            S01310
     C*********************                                               S01310
     C***********CUSKEY****CHAINCLINTCCF             12                   S01310
     C************IN12*****IFEQ '1'                         ))))))))))))))S01310
     C*********************MOVE 'CLINT'   DBFNAM  5         )))  DATA  )))S01310
     C*********************MOVEL'      B' DBERKY            )))  BASE  )))S01310
     C*********************MOVELKCUSNO    DBERKY            )))  BASE  )))S01310
     C*********************MOVE '21'      DBERR#  2         ))) ERROR  )))S01310
     C*********************EXSR DBERR                       )))   21   )))S01310
     C*********************END                              ))))))))))))))S01310
     C*********************                                               S01310
      *                                                                   S01310
      ** If there is no swift address move the full address to the field. S01310
      *                                                                   S01310
     C**********           ELSE                                    S01310 096267
     C**********           MOVEL'A'       ISPTP                                               250600
     C**********           MOVELCNA1      ISPTY1                                              250600
     C**********           MOVE CNA2      ISPTY2                                              250600
     C**********           MOVE CNA3      ISPTY3                                              250600
     C**********           MOVE CNA4      ISPTY4                                              250600
     C**********           MOVE *BLANKS   ISPTY5                                              250600
     C**********           MOVE SMCY      ISCCY   3        CURRENCY                           250600
     C**********           MOVE ' '       IVTAG1  1        TAG IND 1                          250600
     C********** WMT103    IFEQ 'Y'                                                    CFT014 250600
     C**********           MOVE 'A'       IVTAG1                                       CFT014 250600
     C**********           ENDIF                                                       CFT014 250600
     C**********           MOVE ' '       IVTAG2  1        TAG IND 2                          250600
     C**********           MOVE 'D'       IVTAG3  1        TAG IND 3                          250600
     C*
      *                                                                   S01310
      ** If MT100 Ordering Cust.(ODMT)is blank; use Ordering Cust.(ORC).  S01310
      *                                                                   S01310
     C                     MOVELODMTT     ISPTP            SETTLMT TYPE                       250600
     C                     MOVELODMT      ISPTY1           SETTLMT ADD1                       250600
     C                     MOVEL*BLANKS   ISPTY2           SETTLMT ADD2                       250600
     C                     MOVEL*BLANKS   ISPTY3           SETTLMT ADD3                       250600
     C                     MOVEL*BLANKS   ISPTY4           SETTLMT ADD4                       250600
     C                     MOVE *BLANKS   ISPTY5           SETTLMT ADD5                       250600
     C                     MOVE SMCY      ISCCY   3        CURRENCY                           250600
     C                     MOVE ' '       IVTAG1  1        TAG IND 1                          250600
     C           WMT103    IFEQ 'Y'                                                           250600
     C                     MOVE 'A'       IVTAG1                                              250600
     C                     ENDIF                                                              250600
     C                     MOVE ' '       IVTAG2  1        TAG IND 2                          250600
     C                     MOVE 'D'       IVTAG3  1        TAG IND 3                          250600
     C                     EXSR SR01
     C**********           END                                            096267
     C*
      *                                                                   S01310
      ** If MT100 Ordering Cust.(ODMT)is blank; use Ordering Cust.(ORC).  S01310
      *                                                                   S01310
     C                     ELSE
     C/COPY WNCPYSRC,FT0641C017
     C                     MOVELORCT      ISPTP            SETTLMT TYPE
     C                     MOVELORC1      ISPTY1           SETTLMT ADD1
     C                     MOVE ORC2      ISPTY2           SETTLMT ADD2
     C                     MOVE ORC3      ISPTY3           SETTLMT ADD3
     C                     MOVE ORC4      ISPTY4           SETTLMT ADD4
     C**********           MOVE *BLANKS   ISPTY5           SETTLMT ADD5                     BUG14771
     C                     MOVE ORC5      ISPTY5           SETTLMT ADD5                     BUG14771
     C                     MOVE SMCY      ISCCY   3        CURRENCY
     C                     MOVE ' '       IVTAG1  1        TAG IND 1
     C           WMT103    IFEQ 'Y'                                       CFT014
     C                     MOVE 'A'       IVTAG1                          CFT014
     C                     ENDIF                                          CFT014
     C                     MOVE ' '       IVTAG2  1        TAG IND 2
     C                     MOVE 'D'       IVTAG3  1        TAG IND 3
     C**********           EXSR SR01                                                          250600
      *                                                                                       CFT032
     C           WMT103    IFEQ 'Y'                                                           250600
     C                     MOVELORC1      ADCHK1                                              CFT032
     C           ADSLSH    IFEQ '/'                                                           CFT032
     C           ORCT      IFEQ 'P'                                                           CFT032
     C           ORCT      OREQ 'I'                                                           CFT032
     C           ORCT      OREQ 'R'                                                           CFT032
     C**********           SUBSTORC1:2    ISPTY1                                       CFT032 250600
     C                     SUBSTORC1:2    ISPTY1    P                                         250600
     C                     ENDIF                                                              CFT032
      *                                                                                       CFT032
     C********** ORCT      IFEQ 'A'                                                    CFT032 250600
     C********** ORCT      OREQ 'S'                                                    CFT032 250600
     C********** ORCT      IFEQ 'S'                                                   250600 250804A
     C********** ORCT      OREQ 'C'                                                   CFT032 250804A
     C           ORCT      IFEQ 'C'                                                          250804A
     C                     MOVELORC2      ISPTY1                                              CFT032
     C                     MOVELORC3      ISPTY2                                              CFT032
     C                     MOVELORC4      ISPTY3                                              CFT032
     C                     MOVELORC5      ISPTY4                                              CFT032
     C                     MOVEL*BLANKS   ISPTY5                                              250600
     C                     ENDIF                                                              CFT032
      *                                                                                       CFT032
     C                     ENDIF                                                              CFT032
      *                                                                                       CFT032
     C                     ENDIF                                                              250600
      *                                                                                       250600
     C                     EXSR SR01                                                          250600
     C/COPY WNCPYSRC,FT0641C041
     C                     END
     C/COPY WNCPYSRC,FT0641C008
     C* ****** MOVE FORMATTED ORDERING CUSTOMER FIELDS       ******
     C* ****** INTO DATA STRUCTURES                          ******
     C*------------------------------------------ SWIFT RECORD ONE ----
      *                                                                   S01310
      **  Field 50 - Ordering Customer.                                   S01310
      *                                                                   S01310
     C           WMT103    IFEQ 'Y'                                                         BUG14771
     C********** CFT032    ANDEQ'Y'                                               BUG14771 BUG14771A
      ** If switchable feature CSW024 is switched *ON.                                      BUG14771
      *                                                                                     BUG14771
     C           CSW024    IFEQ 'Y'                                                         BUG14771
     C           FLG50A    ANDEQ'Y'                                                         MD048075
      *                                                                                     BUG14771
      ** Search customer then check if it is CROSSMAR and its BEI is                        BUG14771
      ** not blank.                                                                         BUG14771
      *                                                                                     BUG14771
     C                     MOVELCUSTNO    PKEY1                                             BUG14771
     C                     CALL 'AOCUSTR1'                                                  BUG14771
     C                     PARM *BLANK    PRTCD                                             BUG14771
     C                     PARM '*KEY   ' POPTN                                             BUG14771
     C                     PARM           PKEY1  10                                         BUG14771
     C                     PARM *BLANKS   PKYST   7                                         BUG14771
     C           SDCUST    PARM SDCUST    DSLDY                                             BUG14771
      *                                                                                     BUG14771
     C           PRTCD     IFEQ *BLANKS                                                     BUG14771
     C           BBCORP    ANDEQ'Y'                                                         BUG14771
     C           BBCBEI    ANDNE*BLANKS                                                     BUG14771
     C                     MOVE *BLANKS   OFSPT1                                            BUG14771
     C                     MOVE *BLANKS   OFSPT2                                            BUG14771
     C                     MOVE *BLANKS   OFSPT3                                            BUG14771
     C                     MOVE *BLANKS   OFSPT4                                            BUG14771
     C                     MOVE *BLANKS   OFSPT5                                            BUG14771
     C                     MOVE 'A'       OSTAG                                             BUG14771
     C                     MOVE OSTAG     M9OCTG                                            BUG14771
     C                     MOVELBBCBEI    OFSPT1                                            BUG14771
     C                     ENDIF                                                            BUG14771
     C                     ENDIF                                                            BUG14771
      *                                                                                     BUG14771
      *** Call formatting program                                                             CSW207
      *                                                                                       CSW207
     C           CSW207    IFEQ 'Y'                                                           CSW207
     C           WMT103    ANDEQ'Y'                                                           250600
     C                     EXSR SRFRMT                                                        CSW207
     C                     ENDIF                                                              CSW207
      *                                                                                       CSW207
     C           PRTRN     IFEQ *BLANKS                                                       CSW207
     C           CSW207    ANDEQ'Y'                                                           CSW207
     C           WMT103    ANDEQ'Y'                                                           250600
     C                     MOVE 'F'       OSTAG                                               CSW207
     C                     MOVELPMSGL1    M1ORC1                                              CSW207
     C                     MOVELPMSGL2    M1ORC2                                              CSW207
     C                     MOVELPMSGL3    M1ORC3                                              CSW207
     C                     MOVELPMSGL4    M2ORC4                                              CSW207
     C                     MOVELPMSGL5    M2ORC5                                              CSW207
     C                     ELSE                                                               CSW207
     C           WMT103    IFEQ 'Y'                                                           250600
      ** If switchable feature CSW024 is switched *ON.                                        250600
      *                                                                                       250600
     C           CSW024    IFEQ 'Y'                                                           250600
     C           FLG50A    ANDEQ'Y'                                                         MD048075
      *                                                                                       250600
      ** Search customer then check if it is CROSSMAR and its BEI is                          250600
      ** not blank.                                                                           250600
      *                                                                                       250600
     C                     MOVELCUSTNO    PKEY1                                               250600
     C                     CALL 'AOCUSTR1'                                                    250600
     C                     PARM *BLANK    PRTCD                                               250600
     C                     PARM '*KEY   ' POPTN                                               250600
     C                     PARM           PKEY1  10                                           250600
     C                     PARM *BLANKS   PKYST   7                                           250600
     C           SDCUST    PARM SDCUST    DSLDY                                               250600
      *                                                                                       250600
     C           PRTCD     IFEQ *BLANKS                                                       250600
     C           BBCORP    ANDEQ'Y'                                                           250600
     C           BBCBEI    ANDNE*BLANKS                                                       250600
     C                     MOVE *BLANKS   OFSPT1                                              250600
     C                     MOVE *BLANKS   OFSPT2                                              250600
     C                     MOVE *BLANKS   OFSPT3                                              250600
     C                     MOVE *BLANKS   OFSPT4                                              250600
     C                     MOVE *BLANKS   OFSPT5                                              250600
     C                     MOVE 'A'       OSTAG                                               250600
     C                     MOVE OSTAG     M9OCTG                                              250600
     C                     MOVELBBCBEI    OFSPT1                                              250600
     C                     ENDIF                                                              250600
     C                     ENDIF                                                              250600
     C                     ENDIF                                                              250600
      *                                                                                       CFT032
     C           OSTAG     IFEQ 'A'                                                           CFT032
     C           WMT103    ANDEQ'Y'                                                           CFT032
     C                     MOVEL':50A:'   @MSGTG                                              CFT032
     C                     ELSE                                                               CFT032
     C                     MOVEL':50K:'   @MSGTG                                              CFT032
     C                     ENDIF                                                              CFT032
      *                                                                                       CFT032
     C                     MOVE *BLANKS   ##ACLN 35                                         BUG14771
      *                                                                                     BUG14771
     C           ODMT      IFNE *BLANKS                                                     BUG14771
     C                     MOVELODMTT     WENTTP  1                                         BUG14771
     C                     MOVELODMT      WACCT  35                                         BUG14771
     C                     ELSE                                                             BUG14771
     C                     MOVELORCT      WENTTP                                            BUG14771
     C/COPY WNCPYSRC,FTH00576
     C                     MOVELORC1      WACCT                                             BUG14771
     C/COPY WNCPYSRC,FTH00577
     C                     ENDIF                                                            BUG14771
      *                                                                                     BUG14771
     C                     MOVELSMCY      WCCY                                              BUG14771
     C                     MOVEL*BLANKS   WBRCA                                             BUG14771
      *                                                                                     BUG14771
     C                     MOVELOFSPT1    W@CNA1 35                                         BUG14771
     C                     MOVELOFSPT2    W@CNA2 35                                         BUG14771
     C                     MOVELOFSPT3    W@CNA3 35                                         BUG14771
     C                     MOVELOFSPT4    W@CNA4 35                                         BUG14771
     C                     MOVELOFSPT5    W@CNA5 35                                         BUG14771
      *                                                                                     BUG14771
     C********** CFT032    IFEQ 'Y'                                               AR945367A MD045920
     C                     EXSR SROUFM                                                        CFT032
     C**********           ENDIF                                                  AR945367A MD045920
      *                                                                                     BUG14771
     C                     MOVELW@CNA1    OFSPT1                                            BUG14771
     C                     MOVELW@CNA2    OFSPT2                                            BUG14771
     C                     MOVELW@CNA3    OFSPT3                                            BUG14771
     C                     MOVELW@CNA4    OFSPT4                                            BUG14771
     C                     MOVELW@CNA5    OFSPT5                                            BUG14771
      ***Insert*Customer/account*number*reference                                    252874 MD046436
     C********** CFT032    IFEQ 'N'                                                  252874 MD046436
     C**********           EXSR SRICAR                                               252874 MD046436
     C**********           ENDIF                                                     252874 MD046436
     C                     ENDIF                                                            BUG14771
      *                                                                                       CFT032
     C********** ##ACLN    IFNE *BLANKS                                              CFT032 BUG14771
     C**********           MOVEL##ACLN    M1ORC1                                     CFT032 BUG14771
     C**********           MOVELOFSPT1    M1ORC2                                     CFT032 BUG14771
     C**********           MOVELOFSPT2    M1ORC3                                     CFT032 BUG14771
     C**********           MOVELOFSPT3    M2ORC4                                     CFT032 BUG14771
     C**********           MOVELOFSPT4    M2ORC5                                     CFT032 BUG14771
      **********                                                                     CFT032 BUG14771
     C**********           ELSE                                                      CFT032 BUG14771
      *                                                                                       CFT032
     C**********           MOVELOFSPT1    M1ORC1                                            BUG13528
     C**********           MOVE OFSPT2    M1ORC2                                            BUG13528
     C**********           MOVE OFSPT3    M1ORC3                                            BUG13528
     C**********           MOVE OFSPT4    M2ORC4                                            BUG13528
     C                     MOVELORC1      M1ORC1                                            BUG13528
     C                     MOVELOFSPT1    M1ORC2                                            BUG13528
     C                     MOVELOFSPT2    M1ORC3                                            BUG13528
     C                     MOVELOFSPT3    M2ORC4                                            BUG13528
     C                     MOVELOFSPT4    M2ORC5                                            BUG13528
      *                                                                                       CFT032
     C**********           ENDIF                                                     CFT032 BUG14771
      *                                                                                       CFT032
     C                     ENDIF                                                              CSW207
      *                                                                                       CSW207
     C/COPY WNCPYSRC,FT0641C067
     C*
     C           M1ORC1    IFNE *BLANK
     C           M1ORC2    ORNE *BLANK
     C           M1ORC3    ORNE *BLANK
     C           M2ORC4    ORNE *BLANK
     C           M2ORC5    ORNE *BLANK                                                        CFT032
     C*********************MOVE ':50:'    M1TG50                          S01310
     C*********************MOVE X0D25     M1CRL8                          S01310
      *                                                                   CFT014
     C           WMT103    IFEQ 'Y'                                       CFT014
     C                     ADD  1         Q                               CFT014
     C           Q         OCUR MULT                                      CFT014
     C           OSTAG     IFNE 'A'                                       CFT014
     C           OSTAG     ANDNE'F'                                                           CSW207
     C                     MOVE 'K'       OSTAG                           CFT014
     C                     ENDIF                                                              222559
     C*                                                                                       220913
     C********** CFT032    IFEQ 'N'                                               BUG14771 BUG14771A
     C**********           EXSR SRICAR                                              220913 BUG14771A
     C**********           ENDIF                                                  BUG14771 BUG14771A
     C*                                                                                       220913
     C**********           ENDIF                                                       CFT014 222559
     C                     MOVE OSTAG     M9OCTG                          CFT014
     C                     MOVEL'50'      FLDNO                           CFT014
      **********                                                                    204225 BUG14771A
      ***If*switchable*feature*CSW024*is*switched**ON.                              204225 BUG14771A
      **********                                                                    204225 BUG14771A
     C********** CSW024    IFEQ 'Y'                                                 204225 BUG14771A
     C********** CFT032    ANDEQ'N'                                               BUG14771 BUG14771A
      **********                                                                    204225 BUG14771A
      ***Search*customer*then*check*if*it*is*CROSSMAR*and*its*BEI*is                204225 BUG14771A
      ***not*blank.                                                                 204225 BUG14771A
      **********                                                                    204225 BUG14771A
     C**********           MOVELCUSTNO    PKEY1                                     204225 BUG14771A
     C**********           CALL 'AOCUSTR1'                                          204225 BUG14771A
     C**********           PARM *BLANK    PRTCD                                     204225 BUG14771A
     C**********           PARM '*KEY   ' POPTN                                     204225 BUG14771A
     C**********           PARM           PKEY1  10                                 204225 BUG14771A
     C**********           PARM *BLANKS   PKYST   7                                 204225 BUG14771A
     C********** SDCUST    PARM SDCUST    DSLDY                                     204225 BUG14771A
      **********                                                                    204225 BUG14771A
     C********** PRTCD     IFEQ *BLANKS                                             204225 BUG14771A
     C********** BBCORP    IFEQ 'Y'                                                 204225 BUG14771A
     C********** BBCBEI    IFNE *BLANKS                                             204225 BUG14771A
     C**********           MOVE *BLANKS   OFSPT1                                    204225 BUG14771A
     C**********           MOVE *BLANKS   OFSPT2                                    204225 BUG14771A
     C**********           MOVE *BLANKS   OFSPT3                                    204225 BUG14771A
     C**********           MOVE *BLANKS   OFSPT4                                    204225 BUG14771A
     C**********           MOVE *BLANKS   OFSPT5                                  BUG14771 BUG14771A
     C**********           MOVE 'A'       OSTAG                                     204225 BUG14771A
     C**********           MOVE OSTAG     M9OCTG                                    204225 BUG14771A
     C**********           MOVEL'50'      FLDNO                                     204225 BUG14771A
     C**********           MOVE BBCBEI    OFSPT1                                       204225 222559
     C**********           MOVELBBCBEI    OFSPT1                                    222559 BUG14771A
     C**********                                                                    222559 BUG14771A
     C***Insert*Customer/account*number*reference                                   222559 BUG14771A
     C**********           EXSR SRICAR                                              222559 BUG14771A
     C**********                                                                    222559 BUG14771A
     C**********           ELSE                                                     204225 BUG14771A
     C**********           MOVE 'K'       OSTAG                                     204225 BUG14771A
     C**********           MOVE OSTAG     M9OCTG                                    204225 BUG14771A
     C**********           MOVEL'50'      FLDNO                                     204225 BUG14771A
     C**********           MOVE BBCNA1    OFSPT1                                    204225 BUG14771A
     C**********           MOVE BBCNA2    OFSPT2                                    204225 BUG14771A
     C**********           MOVE BBCNA3    OFSPT3                                    204225 BUG14771A
     C**********           MOVE BBCNA4    OFSPT4                                    204225 BUG14771A
     C**********           MOVE *BLANKS   OFSPT5                                  BUG14771 BUG14771A
     C**********                                                                    220913 BUG14771A
     C***Insert*Customer/account*number*reference                                   220913 BUG14771A
     C**********           EXSR SRICAR                                              220913 BUG14771A
     C**********                                                                    220913 BUG14771A
     C**********           ENDIF                                                    204225 BUG14771A
     C**********           ENDIF                                                    204225 BUG14771A
     C**********           ENDIF                                                    204225 BUG14771A
      **********                                                                    204225 BUG14771A
     C**********           ENDIF                                                    204225 BUG14771A
     C/COPY WNCPYSRC,FT0641C065
      ** If Swift ID present check for exception                                              CFT023
      *                                                                                       CFT023
     C           CFT023    IFEQ 'Y'                                                           CFT023
     C           CSID      IFNE *BLANKS                                                       CFT023
     C                     MOVELBBCSTY    KCSTY                                               CFT023
     C                     MOVELCSID      KCSID                                               CFT023
     C           KYGSWX    CHAINFTGSWXPD             89                                       CFT023
      *                                                                                       CFT023
      ** Swift Exception: put full name and address in Field 50K                              CFT023
      *                                                                                       CFT023
     C           *IN89     IFEQ *OFF                                                          CFT023
     C                     MOVE 'K'       OSTAG                                               CFT023
     C                     MOVE OSTAG     M9OCTG                                              CFT023
     C                     MOVEL'50'      FLDNO                                               CFT023
     C                     MOVE BBCNA1    OFSPT1                                              CFT023
     C                     MOVE BBCNA2    OFSPT2                                              CFT023
     C                     MOVE BBCNA3    OFSPT3                                              CFT023
     C                     MOVE BBCNA4    OFSPT4                                              CFT023
      *                                                                                       CFT023
      ** Include customer or account number                                                   CFT023
      *                                                                                       CFT023
     C                     EXSR SRICAR                                                        CFT023
     C                     ENDIF                                                              CFT023
     C                     ENDIF                                                              CFT023
     C                     ENDIF                                                              CFT023
      *                                                                                       CFT023
     C                     MOVE CUSTNO    BBCUST                                            BUG14771
     C                     EXSR FSWAD                                     CFT014
     C/COPY WNCPYSRC,FT0641C066
      *                                                                   CFT014
     C                     ELSE                                           CFT014
     C           M1ORC1    IFNE *BLANKS                                   S01310
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     MOVEL':50:'    MTAG                            S01310
     C                     MOVELM1ORC1    MFLD                            S01310
     C                     END                                            S01310
     C           M1ORC2    IFNE *BLANKS                                   S01310
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     MOVELM1ORC2    MFLD                            S01310
     C                     END                                            S01310
     C           M1ORC3    IFNE *BLANKS                                   S01310
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     MOVELM1ORC3    MFLD                            S01310
     C                     END                                            S01310
     C           M2ORC4    IFNE *BLANKS                                   S01310
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     MOVELM2ORC4    MFLD                            S01310
     C                     END                                            S01310
     C           M2ORC5    IFNE *BLANKS                                                       CFT032
     C                     ADD  1         Q                                                   CFT032
     C           Q         OCUR MULT                                                          CFT032
     C                     MOVELM2ORC5    MFLD                                                CFT032
     C                     ENDIF                                                              CFT032
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     END
     C*
     C***********M1ORC2****IFNE *BLANK                                    S01310
     C***********M1ORC3****ORNE *BLANK                                    S01310
     C***********M2ORC4****ORNE *BLANK                                    S01310
     C*********************MOVE X0D25     M1CRL9                          S01310
     C*********************END                                            S01310
     C***********M1ORC3****IFNE *BLANK                                    S01310
     C***********M2ORC4****ORNE *BLANK                                    S01310
     C*********************MOVE X0D25     M1CRLA                          S01310
     C*********************END                                            S01310
     C*------------------------------------------ SWIFT RECORD TWO ----   S01310
     C*********************MOVE OFSPT4    M2ORC4                          S01310
     C***********M2ORC4****IFNE *BLANK                                    S01310
     C*********************MOVE X0D25     M2CRL1                          S01310
     C*********************END                                            S01310
     C*
      *                                                                   S01310
      ** Field 52 - Ordering Institution.                                 S01310
      *                                                                   S01310
     C*  SETUP PARAMETERS AND EXECUTE SR01 TO
     C*  FORMAT THE ORDERING BANK
      *
     C/COPY WNCPYSRC,FT0641C011
     C                     MOVELORBT      ISPTP
     C                     MOVE *BLANKS   ISPTY1
     C                     MOVELORBK      ISPTY1
     C                     MOVELORBB      ISBRCA  3                       S01435
     C/COPY WNCPYSRC,FT0641C012
      *                                                                   055293
      * If ORBT is not a Retail or Nostro i.e. overriden then             055293
      * check if Ordering Institution Details from a Swift Msg exist      055293
      *                                                                   055293
      * If a thru payment do not override.                                S01435
      *                                                                   S01435
     C           ORBT      IFNE 'R'                                       055293
     C           ORBT      ANDNE'N'                                       055293
     C           OPMSGR    ORGT 0                                         S01435
     C           WMT103    OREQ 'Y'                                                           CFT039
     C           PYTP      ANDEQ'OP'                                                          CFT039
     C/COPY WNCPYSRC,FT0641C055
      *                                                                   055293
     C           OPORBT    IFNE ' '                                       055293
     C                     MOVEL'Y'       @OTX    1                       055293
     C                     MOVELOPORBT    ISPTP                           055293
     C                     MOVELOPORB1    ISPTY1                          055293
     C                     MOVELOPORB2    ISPTY2                          055293
     C                     MOVELOPORB3    ISPTY3                          055293
     C                     MOVELOPORB4    ISPTY4                          055293
     C                     MOVELOPORB5    ISPTY5                          055293
     C                     END                                            055293
      *                                                                   055293
     C                     END                                            055293
     C/COPY WNCPYSRC,FT0641C069
      *                                                                   055293
      *  If new fields were read then use this data for S.W.I.F.T.        055293
      *                                                                   055293
     C           @OTX      IFNE 'Y'                                       055293
     C                     MOVE *BLANKS   ISPTY2
     C                     MOVE *BLANKS   ISPTY3
     C                     MOVE *BLANKS   ISPTY4
     C                     MOVE *BLANKS   ISPTY5
     C                     END                                            055293
      *                                                                   055293
     C                     MOVEL'N'       @OTX    1                       055293
      *
     C                     MOVE SMCY      ISCCY   3        CURRENCY
     C                     MOVE 'A'       IVTAG1
     C                     MOVE ' '       IVTAG2
     C                     MOVE 'D'       IVTAG3
      *
     C           WMT103    IFEQ 'Y'                                                           CSW201
     C                     MOVE *ON       *IN51                                               CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C                     EXSR SR01
     C                     MOVE *OFF      *IN51                                               CSW201
     C/COPY WNCPYSRC,FT0641C050
     C                     MOVEL*BLANKS   ISBRCA                          S01435
      *
     C* ****** MOVE FORMATTED ORDERING BANK FIELDS INTO DATA STRUCTRE**
      *
     C                     MOVELOFSPT1    M2OBK1
     C                     MOVE OFSPT2    M2OBK2
     C                     MOVE OFSPT3    M2OBK3
     C                     MOVE OFSPT4    M2OBK4
     C                     MOVE OFSPT5    M2OBK5
     C*
     C           M2OBK1    IFNE *BLANK
     C           M2OBK2    ORNE *BLANK
     C           M2OBK3    ORNE *BLANK
     C           M2OBK4    ORNE *BLANK
     C           M2OBK5    ORNE *BLANK
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     MOVE OSTAG     M2OBTG
     C                     MOVE '52'      FLDNO                           S01310
     C*********************MOVE ':52'     M2TG52
     C*********************MOVE ':'       M2CLN                           S01310
     C*********************MOVE X0D25     M2CRL2                          S01310
     C                     EXSR FSWAD                                     S01310
     C/COPY WNCPYSRC,FT0641C020
      *                                                                                       208890
     C           WMT103    IFEQ 'Y'                                                           208890
      *                                                                                       208890
      ** Set to 'Y' if field 52a exists and is used with option 'A'.                          208890
      ** Used to condition MT103+ msg in SR/OMSG.                                             208890
      *                                                                                       208890
     C           TAG       IFNE 'A'                                                           208890
     C                     MOVE 'N'       W52A                                                208890
     C                     ENDIF                                                              208890
      *                                                                                       208890
     C                     ENDIF                                                              208890
     C                     END
     C*
     C***********M2OBK2****IFNE *BLANK                                    S01310
     C***********M2OBK3****ORNE *BLANK                                    S01310
     C***********M2OBK4****ORNE *BLANK                                    S01310
     C***********M2OBK5****ORNE *BLANK                                    S01310
     C*********************MOVE X0D25     M2CRL3                          S01310
     C*********************END                                            S01310
     C***********M2OBK3****IFNE *BLANK                                    S01310
     C***********M2OBK4****ORNE *BLANK                                    S01310
     C***********M2OBK5****ORNE *BLANK                                    S01310
     C*********************MOVE X0D25     M2CRL4                          S01310
     C*********************END                                            S01310
     C***********M2OBK4****IFNE *BLANK                                    S01310
     C***********M2OBK5****ORNE *BLANK                                    S01310
     C*********************MOVE X0D25     M2CRL5                          S01310
     C*********************END                                            S01310
     C***********M2OBK5****IFNE *BLANK                                    S01310
     C*********************MOVE X0D25     M2CRL6                          S01310
     C*********************END                                            S01310
      *                                                                   S01310
      ** Field 53 - Senders correspondant.                                S01310
      *                                                                   S01310
     C*
     C*  SETUP PARAMETERS AND EXECUTE SR01 TO
     C*  FORMAT THE SENDERS CORRESPONDENT
     C/COPY WNCPYSRC,FT0641C018
     C                     MOVELSNCT      ISPTP
     C                     MOVE *BLANKS   ISPTY1
     C                     MOVELSNCO      ISPTY1
     C                     MOVE *BLANKS   ISPTY2
     C                     MOVE *BLANKS   ISPTY3
     C                     MOVE *BLANKS   ISPTY4
     C                     MOVE *BLANKS   ISPTY5
      *                                                                   E32546
      *  E32546  - Senders correspondent uses the settle currency         E32546
      *            for outgoing payments when it should use the           E32546
      *            pay currency                                           E32546
      *                                                                   E32546
     C*****                MOVE SMCY      ISCCY                           E32546
     C                     MOVE PCCY      ISCCY                           E32546
     C                     MOVE 'A'       IVTAG1            TAG IND 1
     C                     MOVE 'B'       IVTAG2            TAG IND 2
     C                     MOVE 'D'       IVTAG3            TAG IND 3
     C/COPY WNCPYSRC,FTH00292
      *                                                                                       CSW201
     C           WMT103    IFEQ 'Y'                                                           CSW201
     C                     MOVE *ON       *IN51                                               CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C                     EXSR SR01
     C                     MOVE *OFF      *IN51                                               CSW201
     C* *** MOVE FORMATTED SENDERS CORRESPONDENT FIELDS INTO DATA STRUCTRE**
     C*------------------------------------------ SWIFT RECORD THREE --
     C/COPY WNCPYSRC,FTH00011
     C                     MOVELOFSPT1    M3SCR1
     C                     MOVELOFSPT2    M3SCR2
     C                     MOVELOFSPT3    M3SCR3
     C                     MOVELOFSPT4    M3SCR4
     C                     MOVELOFSPT5    M3SCR5
     C/COPY WNCPYSRC,FT0641C019
     C*
     C           M3SCR1    IFNE *BLANK
     C           M3SCR2    ORNE *BLANK
     C           M3SCR3    ORNE *BLANK
     C           M3SCR4    ORNE *BLANK
     C           M3SCR5    ORNE *BLANK
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     MOVE OSTAG     M3SCTT
     C                     MOVE '53'      FLDNO                           S01310
     C*********************MOVE ':53'     M3TG53                          S01310
     C*********************MOVE ':'       M3CLNA                          S01310
     C*********************MOVE X0D25     M3CRL1                          S01310
     C                     EXSR FSWAD                                     S01310
      *                                                                   CFT014
     C           WMT103    IFEQ 'Y'                                       CFT014
      *                                                                   CFT014
      ** Flag W53A is one of the flags that conditions MT103+ msg in      CFT014
      ** SR/OMSG.  Set to 'Y' if                                          CFT014
      ** 1. Used with option 'A', and                                     CFT014
      ** 2. Used with option 'B' and first line is an account line        CFT014
      **    as identified by a '/' on the first position.                 CFT014
      *                                                                   CFT014
     C           CMS006    IFEQ 'Y'                                                           CMS006
     C           WORKTG    ANDEQ'/'                                                           CMS006
     C                     MOVE WORKTG    WCHR01  1                                           CMS006
     C                     MOVELMFLD      M3SCR1    P                                         CMS006
     C                     ELSE                                                               CMS006
     C                     MOVELM3SCR1    WCHR01  1                       CFT014
     C                     ENDIF                                                              CMS006
     C           TAG       IFEQ 'A'                                       CFT014
     C           TAG       OREQ 'B'                                       CFT014
     C           WCHR01    ANDEQ'/'                                       CFT014
     C                     MOVE 'Y'       W53A                            CFT014
     C                     ELSE                                           CFT014
     C                     MOVE 'N'       W53A                            CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   S01310
     C                     END
     C/COPY WNCPYSRC,FT0641C040
     C*
     C***********M3SCR2****IFNE *BLANK                                    S01310
     C***********M3SCR3****ORNE *BLANK                                    S01310
     C***********M3SCR4****ORNE *BLANK                                    S01310
     C***********M3SCR5****ORNE *BLANK                                    S01310
     C*********************MOVE X0D25     M3CRL2                          S01310
     C*********************END                                            S01310
     C***********M3SCR3****IFNE *BLANK                                    S01310
     C***********M3SCR4****ORNE *BLANK                                    S01310
     C***********M3SCR5****ORNE *BLANK                                    S01310
     C*********************MOVE X0D25     M3CRL3                          S01310
     C*********************END                                            S01310
     C***********M3SCR4****IFNE *BLANK                                    S01310
     C***********M3SCR5****ORNE *BLANK                                    S01310
     C*********************MOVE X0D25     M3CRL4                          S01310
     C*********************END                                            S01310
     C***********M3SCR5****IFNE *BLANK                                    S01310
     C*********************MOVE X0D25     M3CRL5                          S01310
     C*********************END                                            S01310
     C*
      *                                                                   S01310
      ** Field 54 - Receivers Correspondant.                              S01310
      *                                                                   S01310
     C*  SETUP PARAMETERS AND EXECUTE SR01 TO
     C*  FORMAT THE RECEIVERS CORRESPONDENT
     C                     MOVELRCRT      ISPTP
     C                     MOVELRCO1      ISPTY1
     C                     MOVELRCO2      ISPTY2
     C                     MOVELRCO3      ISPTY3
     C                     MOVELRCO4      ISPTY4
     C                     MOVELRCO5      ISPTY5
     C                     MOVE PCCY      ISCCY
     C                     MOVE 'A'       IVTAG1            TAG IND 1
     C                     MOVE 'B'       IVTAG2            TAG IND 2
     C                     MOVE 'D'       IVTAG3            TAG IND 3
     C/COPY WNCPYSRC,FTH00293
      *                                                                                       CSW201
     C           WMT103    IFEQ 'Y'                                                           CSW201
     C                     MOVE *ON       *IN51                                               CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C                     EXSR SR01
     C                     MOVE *OFF      *IN51                                               CSW201
     C* ** MOVE FORMATTED RECEIVERS CORR. FIELDS INTO DATA STRUCTRE**
     C                     MOVELOFSPT1    M3RCR1
     C                     MOVELOFSPT2    M4RCR2
     C                     MOVELOFSPT3    M4RCR3
     C                     MOVELOFSPT4    M4RCR4
     C                     MOVELOFSPT5    M4RCR5
     C*
     C           M3RCR1    IFNE *BLANK
     C           M4RCR2    ORNE *BLANK
     C           M4RCR3    ORNE *BLANK
     C           M4RCR4    ORNE *BLANK
     C           M4RCR5    ORNE *BLANK
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     MOVE OSTAG     M3RCTT
     C                     MOVE '54'      FLDNO                           S01310
     C*********************MOVE ':54'     M3TG54                          S01310
     C*********************MOVE ':'       M3CLNB                          S01310
     C*********************MOVE X0D25     M3CRL6                          S01310
      *                                                                   S01310
     C                     EXSR FSWAD                                     S01310
      *                                                                   CFT014
     C           WMT103    IFEQ 'Y'                                       CFT014
      *                                                                   CFT014
      ** Set to 'Y' if field 54a exists and is used with option 'A'.      CFT014
      ** Used to condition MT103+ msg in SR/OMSG.                         CFT014
      *                                                                   CFT014
     C           TAG       IFNE 'A'                                       CFT014
     C                     MOVE 'N'       W54A                            CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   S01310
     C                     END
      *                                                                   CFT014
      ** Field 55a - Third Reimbursement Institution                      CFT014
      *                                                                   CFT014
     C           WMT103    IFEQ 'Y'                                       CFT014
      *                                                                   CFT014
     C                     MOVELOPTRIT    ISPTP                           CFT014
     C                     MOVELOPTRI1    ISPTY1                          CFT014
     C                     MOVELOPTRI2    ISPTY2                          CFT014
     C                     MOVELOPTRI3    ISPTY3                          CFT014
     C                     MOVELOPTRI4    ISPTY4                          CFT014
     C                     MOVELOPTRI5    ISPTY5                          CFT014
     C                     MOVEL*BLANKS   ISCCY                           CFT014
     C                     MOVEL'A'       IVTAG1                          CFT014
     C                     MOVEL'B'       IVTAG2                          CFT014
     C                     MOVEL'D'       IVTAG3                          CFT014
     C                     MOVE *ON       *IN51                                               CSW201
     C                     EXSR SR01                                      CFT014
     C                     MOVE *OFF      *IN51                                               CSW201
      *                                                                   CFT014
     C                     MOVELOFSPT1    M9TRI1                          CFT014
     C                     MOVELOFSPT2    M9TRI2                          CFT014
     C                     MOVELOFSPT3    M9TRI3                          CFT014
     C                     MOVELOFSPT4    M9TRI4                          CFT014
     C                     MOVELOFSPT5    M9TRI5                          CFT014
      *                                                                   CFT014
     C           M9TRI1    IFNE *BLANKS                                   CFT014
     C           M9TRI2    ORNE *BLANKS                                   CFT014
     C           M9TRI3    ORNE *BLANKS                                   CFT014
     C           M9TRI4    ORNE *BLANKS                                   CFT014
     C           M9TRI5    ORNE *BLANKS                                   CFT014
      *                                                                   CFT014
     C                     ADD  1         Q                               CFT014
     C           Q         OCUR MULT                                      CFT014
     C                     MOVE OSTAG     M9TRTG                          CFT014
     C                     MOVEL'55'      FLDNO                           CFT014
     C                     EXSR FSWAD                                     CFT014
      *                                                                   CFT014
      ** Set to 'Y' if field 55a exists and is used with option 'A'.      CFT014
      ** Used to condition MT103+ msg in SR/OMSG.                         CFT014
      *                                                                   CFT014
     C           TAG       IFNE 'A'                                       CFT014
     C                     MOVE 'N'       W55A                            CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
      ** Check if Bank-To-Bank info contains /RCB/.                       CFT014
      *                                                                   CFT014
     C                     MOVE *BLANK    WOK                             CFT014
     C                     MOVE *BLANK    WSWFT   1                       CFT014
      *                                                                   CFT014
     C           BBI1      IFNE *BLANK                                    CFT014
     C                     MOVELBBI1      WCHR35                          CFT014
     C                     EXSR SRCHK2                                    CFT014
     C           WOK       IFEQ 'Y'                                       CFT014
     C           W201IN    ANDEQ*BLANK                                                        CSW201
     C                     MOVEL'*'       WBBI1                           CFT014
     C                     MOVE WTAG      M9TRTG                          CFT014
     C                     MOVELWOC35     M9TRI1                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           BBI2      IFNE *BLANK                                    CFT014
     C           WOK       IFEQ 'Y'                                       CFT014
      *                                                                                       CSW201
     C           W201IN    IFEQ *BLANK                                                        CSW201
     C                     MOVELBBI2      WCHR02  2                       CFT014
     C           WCHR02    IFEQ '//'                                      CFT014
     C                     MOVEL'*'       WBBI2                           CFT014
     C           WSWFT     IFEQ 'N'                                       CFT014
     C           33        SUBSTBBI2:3    WCHR35                          CFT014
     C                     EXSR SRTRI1                                    CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                                              CSW201
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
      ** No /RCB/ found yet.                                              CFT014
      *                                                                   CFT014
     C                     MOVELBBI2      WCHR35                          CFT014
     C                     EXSR SRCHK2                                    CFT014
     C           WOK       IFEQ 'Y'                                       CFT014
     C           W201IN    ANDEQ*BLANK                                                        CSW201
     C                     MOVEL'*'       WBBI2                           CFT014
     C                     MOVE WTAG      M9TRTG                          CFT014
     C                     MOVELWOC35     M9TRI1                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           BBI3      IFNE *BLANK                                    CFT014
     C           WOK       IFEQ 'Y'                                       CFT014
      *                                                                                       CSW201
     C           W201IN    IFEQ *BLANK                                                        CSW201
     C                     MOVELBBI3      WCHR02                          CFT014
     C                     MOVELWBBI2     WCHR01                          CFT014
     C           WCHR02    IFEQ '//'                                      CFT014
     C           WCHR01    ANDEQ'*'                                       CFT014
     C                     MOVEL'*'       WBBI3                           CFT014
     C           WSWFT     IFEQ 'N'                                       CFT014
     C           33        SUBSTBBI3:3    WCHR35                          CFT014
     C                     EXSR SRTRI1                                    CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                                              CSW201
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
      ** No /RCB/ found yet.                                              CFT014
      *                                                                   CFT014
     C                     MOVELBBI3      WCHR35                          CFT014
     C                     EXSR SRCHK2                                    CFT014
     C           WOK       IFEQ 'Y'                                       CFT014
     C           W201IN    ANDEQ*BLANK                                                        CSW201
     C                     MOVEL'*'       WBBI3                           CFT014
     C                     MOVE WTAG      M9TRTG                          CFT014
     C                     MOVELWOC35     M9TRI1                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           BBI4      IFNE *BLANK                                    CFT014
     C           WOK       IFEQ 'Y'                                       CFT014
      *                                                                                       CSW201
     C           W201IN    IFEQ *BLANK                                                        CSW201
     C                     MOVELBBI4      WCHR02                          CFT014
     C                     MOVELWBBI3     WCHR01                          CFT014
     C           WCHR02    IFEQ '//'                                      CFT014
     C           WCHR01    ANDEQ'*'                                       CFT014
     C                     MOVEL'*'       WBBI4                           CFT014
     C           WSWFT     IFEQ 'N'                                       CFT014
     C           33        SUBSTBBI4:3    WCHR35                          CFT014
     C                     EXSR SRTRI1                                    CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                                              CSW201
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
      ** No /RCB/ found yet.                                              CFT014
      *                                                                   CFT014
     C                     MOVELBBI4      WCHR35                          CFT014
     C                     EXSR SRCHK2                                    CFT014
     C           WOK       IFEQ 'Y'                                       CFT014
     C           W201IN    ANDEQ*BLANK                                                        CSW201
     C                     MOVEL'*'       WBBI4                           CFT014
     C                     MOVE WTAG      M9TRTG                          CFT014
     C                     MOVELWOC35     M9TRI1                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           BBI5      IFNE *BLANK                                    CFT014
     C           WOK       IFEQ 'Y'                                       CFT014
      *                                                                                       CSW201
     C           W201IN    IFEQ *BLANK                                                        CSW201
     C                     MOVELBBI5      WCHR02                          CFT014
     C                     MOVELWBBI4     WCHR01                          CFT014
     C           WCHR02    IFEQ '//'                                      CFT014
     C           WCHR01    ANDEQ'*'                                       CFT014
     C                     MOVEL'*'       WBBI5                           CFT014
     C           WSWFT     IFEQ 'N'                                       CFT014
     C           33        SUBSTBBI5:3    WCHR35                          CFT014
     C                     EXSR SRTRI1                                    CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                                              CSW201
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
      ** No /RCB/ found yet.                                              CFT014
      *                                                                   CFT014
     C                     MOVELBBI5      WCHR35                          CFT014
     C                     EXSR SRCHK2                                    CFT014
     C           WOK       IFEQ 'Y'                                       CFT014
     C           W201IN    ANDEQ*BLANK                                                        CSW201
     C                     MOVEL'*'       WBBI5                           CFT014
     C                     MOVE WTAG      M9TRTG                          CFT014
     C                     MOVELWOC35     M9TRI1                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           BBI6      IFNE *BLANK                                    CFT014
     C           WOK       IFEQ 'Y'                                       CFT014
      *                                                                                       CSW201
     C           W201IN    IFEQ *BLANK                                                        CSW201
     C                     MOVELBBI6      WCHR02                          CFT014
     C                     MOVELWBBI5     WCHR01                          CFT014
     C           WCHR02    IFEQ '//'                                      CFT014
     C           WCHR01    ANDEQ'*'                                       CFT014
     C                     MOVEL'*'       WBBI6                           CFT014
     C           WSWFT     IFEQ 'N'                                       CFT014
     C           33        SUBSTBBI6:3    WCHR35                          CFT014
     C                     EXSR SRTRI1                                    CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                                              CSW201
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
      ** No /RCB/ found yet.                                              CFT014
      *                                                                   CFT014
     C                     MOVELBBI6      WCHR35                          CFT014
     C                     EXSR SRCHK2                                    CFT014
     C           WOK       IFEQ 'Y'                                       CFT014
     C           W201IN    ANDEQ*BLANK                                                        CSW201
     C                     MOVEL'*'       WBBI6                           CFT014
     C                     MOVE WTAG      M9TRTG                          CFT014
     C                     MOVELWOC35     M9TRI1                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                                       CSW201
      ** If CSW201 is installed and swift id is a BEI, format with                            CSW201
      ** option 'D' using name and address.                                                   CSW201
      *                                                                                       CSW201
     C           WOK       IFEQ 'Y'                                                           CSW201
     C           W201IN    ANDEQ'Y'                                                           CSW201
     C                     MOVELOFSPT1    M9TRI1                                              CSW201
     C                     MOVELOFSPT2    M9TRI2                                              CSW201
     C                     MOVELOFSPT3    M9TRI3                                              CSW201
     C                     MOVELOFSPT4    M9TRI4                                              CSW201
     C                     MOVELOFSPT5    M9TRI5                                              CSW201
     C                     ENDIF                                                              CSW201
      *                                                                   CFT014
      ** Set to 'Y' if field 55a exists and is used with option 'A'.      CFT014
      ** Used to condition MT103+ msg in SR/OMSG.                         CFT014
      *                                                                   CFT014
     C           WOK       IFEQ 'Y'                                       CFT014
     C           WTAG      ANDNE'A'                                       CFT014
     C                     MOVE 'N'       W55A                            CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
     C*
     C*------------------------------------------ SWIFT RECORD FOUR ---
     C***********M4RCR2****IFNE *BLANK                                    S01310
     C***********M4RCR3****ORNE *BLANK                                    S01310
     C***********M4RCR4****ORNE *BLANK                                    S01310
     C***********M4RCR5****ORNE *BLANK                                    S01310
     C*********************MOVE X0D25     M4CRL1                          S01310
     C*********************END                                            S01310
     C***********M4RCR3****IFNE *BLANK                                    S01310
     C***********M4RCR4****ORNE *BLANK                                    S01310
     C***********M4RCR5****ORNE *BLANK                                    S01310
     C*********************MOVE X0D25     M4CRL2                          S01310
     C*********************END                                            S01310
     C***********M4RCR4****IFNE *BLANK                                    S01310
     C***********M4RCR5****ORNE *BLANK                                    S01310
     C*********************MOVE X0D25     M4CRL3                          S01310
     C*********************END                                            S01310
     C***********M4RCR5****IFNE *BLANK                                    S01310
     C*********************MOVE X0D25     M4CRL4                          S01310
     C*********************END                                            S01310
     C*                                                                   E20980
     C** SETUP PARAMETERS AND EXECUTE SR01 TO                             E20980
     C** FORMAT THE INTERMEDIARY BANK                                     E20980
     C*                                                                   E20980
     C                     MOVELINBT      ISPTP                           E20980
     C                     MOVELINB1      ISPTY1                          E20980
     C                     MOVELINB2      ISPTY2                          E20980
     C                     MOVELINB3      ISPTY3                          E20980
     C                     MOVELINB4      ISPTY4                          E20980
     C                     MOVELINB5      ISPTY5                          E20980
     C                     MOVE PCCY      ISCCY                           E20980
     C                     MOVE 'A'       IVTAG1            TAG IND 1     E20980
     C                     MOVE ' '       IVTAG2            TAG IND 2     E20980
     C                     MOVE 'D'       IVTAG3            TAG IND 3     E20980
     C*                                                                   E20980
     C** SET OFF INDICATOR FOR BLOCK OF SWFT CALL FOR DETAIL              E20980
     C** FIELD ADDRESS(RATHER THAN DESTINATION ADDRESS)                   E20980
     C*                                                                   E20980
     C                     SETOF                     20                   E20980
     C*                                                                   E20980
     C           WMT103    IFEQ 'Y'                                                           CSW201
     C                     MOVE *ON       *IN51                                               CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C                     EXSR SR01                                      E20980
     C                     MOVE *OFF      *IN51                                               CSW201
     C/COPY WNCPYSRC,FT0641C043
     C*                                                                   E20980
     C** MOVE FORMATTED INTERMEDIARY BANK FIELDS INTO DATA STRUCTURE      E20980
     C*                                                                   E20980
     C                     MOVELOFSPT1    M4INB1                          E20980
     C                     MOVELOFSPT2    M4INB2                          E20980
     C                     MOVELOFSPT3    M4INB3                          E20980
     C                     MOVELOFSPT4    M4INB4                          E20980
     C                     MOVELOFSPT5    M4INB5                          E20980
     C           M4INB1    IFNE *BLANK                                    E20980
     C           M4INB2    ORNE *BLANK                                    E20980
     C           M4INB3    ORNE *BLANK                                    E20980
     C           M4INB4    ORNE *BLANK                                    E20980
     C           M4INB5    ORNE *BLANK                                    E20980
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     MOVE OSTAG     M4AB56                          E20980
     C                     MOVE '56'      FLDNO                           S01310
     C*********************MOVE ':56'     M4TG56                    E20980S01310
     C*********************MOVE ':'       M4CLN1                    E20980S01310
     C*********************MOVE X0D25     M4CRLV                    E20980S01310
      *                                                                   S01310
     C                     EXSR FSWAD                                     S01310
      *                                                                   CFT014
     C           WMT103    IFEQ 'Y'                                       CFT014
      *                                                                   CFT014
      ** Set to 'Y' if field 56a exists and is used with option 'A'.      CFT014
      ** Used to condition MT103+ msg in SR/OMSG.                         CFT014
      *                                                                   CFT014
     C           TAG       IFNE 'A'                                       CFT014
     C                     MOVE 'N'       W56A                            CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   S01310
     C                     END                                            E20980
     C***********M4INB2****IFNE *BLANK                              E20980S01310
     C***********M4INB3****ORNE *BLANK                              E20980S01310
     C***********M4INB4****ORNE *BLANK                              E20980S01310
     C***********M4INB5****ORNE *BLANK                              E20980S01310
     C*********************MOVE X0D25     M4CRLW                    E20980S01310
     C*********************END                                      E20980S01310
     C***********M4INB3****IFNE *BLANK                              E20980S01310
     C***********M4INB4****ORNE *BLANK                              E20980S01310
     C***********M4INB5****ORNE *BLANK                              E20980S01310
     C*********************MOVE X0D25     M4CRLX                    E20980S01310
     C*********************END                                      E20980S01310
     C***********M4INB4****IFNE *BLANK                              E20980S01310
     C***********M4INB5****ORNE *BLANK                              E20980S01310
     C*********************MOVE X0D25     M4CRLY                    E20980S01310
     C*********************END                                      E20980S01310
     C***********M4INB5****IFNE *BLANK                              E20980S01310
     C*********************MOVE X0D25     M4CRLZ                    E20980S01310
     C*********************END                                      E20980S01310
      *                                                                   S01310
      ** Field 57 - Account with Institution.                             S01310
      *                                                                   S01310
     C*
     C*  SETUP PARAMETERS AND EXECUTE SR01 TO
     C*  FORMAT THE ACCOUNT WITH BANK
     C                     MOVELACBT      ISPTP
     C                     MOVELACB1      ISPTY1
     C                     MOVELACB2      ISPTY2
     C                     MOVELACB3      ISPTY3
     C                     MOVELACB4      ISPTY4
     C                     MOVELACB5      ISPTY5
     C                     MOVE PCCY      ISCCY
     C                     MOVE 'A'       IVTAG1            TAG IND 1
     C                     MOVE 'B'       IVTAG2            TAG IND 2
     C                     MOVE 'D'       IVTAG3            TAG IND 3
      *                                                                                       CSW201
     C           WMT103    IFEQ 'Y'                                                           CSW201
     C                     MOVE *ON       *IN51                                               CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C                     EXSR SR01
     C                     MOVE *OFF      *IN51                                               CSW201
     C*                                                                   E21471
     C** DISPLAY CHAPS CODE.                                              E21471
     C*                                                                   E21471
     C           STMT      IFEQ 10                         B001           E21471
     C           CHAP      ANDNE0                                         E21471
     C           OSTAG     ANDNE'C'                                       CFT014
     C           OSTAG     ANDNE'D'                                       E21471
     C                     MOVE OFSPT4    OFSPT5                          E21471
     C                     MOVE OFSPT3    OFSPT4                          E21471
     C                     MOVE OFSPT2    OFSPT3                          E21471
     C                     MOVELOFSPT1    OFSPT2                          E21471
     C                     MOVE *BLANK    OFSPT1                          E21471
     C                     MOVEL'//SC'    @CHAP  10                       E21471
     C                     MOVE CHAP      @CHAP                           E21471
     C                     MOVEL@CHAP     OFSPT1                          E21471
     C                     END                             E001           E21471
     C/COPY WNCPYSRC,FT0641C044
     C* ** MOVE FORMATTED ACCOUNT WITH BANK FIELDS INTO DATA STRUCTRE**
     C                     MOVELOFSPT1    M4AWB1
     C                     MOVELOFSPT2    M4AWB2
     C                     MOVELOFSPT3    M5AWB3
     C                     MOVELOFSPT4    M5AWB4
     C                     MOVELOFSPT5    M5AWB5
     C*
     C           M4AWB1    IFNE *BLANK
     C           M4AWB2    ORNE *BLANK
     C           M5AWB3    ORNE *BLANK
     C           M5AWB4    ORNE *BLANK
     C           M5AWB5    ORNE *BLANK
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     MOVE OSTAG     M4ABTT
     C                     MOVE '57'      FLDNO                           S01310
     C*********************MOVE ':57'     M4TG57                          S01310
     C*********************MOVE ':'       M4CLN                           S01310
     C*********************MOVE X0D25     M4CRL5                          S01310
      *                                                                   S01310
     C                     EXSR FSWAD                                     S01310
      *                                                                   CFT014
     C           WMT103    IFEQ 'Y'                                       CFT014
      *                                                                   CFT014
      ** Set to 'Y' if field 57a exists and is used with option 'A'.      CFT014
      ** Used to condition MT103+ msg in SR/OMSG.                         CFT014
      *                                                                   CFT014
     C           TAG       IFNE 'A'                                       CFT014
     C                     MOVE 'N'       W57A                            CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   S01310
     C                     END
     C*
     C***********M4AWB2****IFNE *BLANK                                    S01310
     C***********M5AWB3****ORNE *BLANK                                    S01310
     C***********M5AWB4****ORNE *BLANK                                    S01310
     C***********M5AWB5****ORNE *BLANK                                    S01310
     C*********************MOVE X0D25     M4CRL6                          S01310
     C*********************END                                            S01310
     C*------------------------------------------ SWIFT RECORD FIVE ---   S01310
     C***********M5AWB3****IFNE *BLANK                                    S01310
     C***********M5AWB4****ORNE *BLANK                                    S01310
     C***********M5AWB5****ORNE *BLANK                                    S01310
     C*********************MOVE X0D25     M5CRL1                          S01310
     C*********************END                                            S01310
     C***********M5AWB4****IFNE *BLANK                                    S01310
     C***********M5AWB5****ORNE *BLANK                                    S01310
     C*********************MOVE X0D25     M5CRL2                          S01310
     C*********************END                                            S01310
     C***********M5AWB5****IFNE *BLANK                                    S01310
     C*********************MOVE X0D25     M5CRL3                          S01310
     C*********************END                                            S01310
     C*
      *                                                                   S01310
      ** Field :59: -  Beneficiary Customer.                              S01310
      *                                                                   S01310
     C*  SETUP PARAMETERS AND EXECUTE SR01 TO
     C*  FORMAT THE BENEFICIARY  BANK
     C                     MOVELBNCT      ISPTP
     C                     MOVELBNC1      ISPTY1
     C                     MOVELBNC2      ISPTY2
     C                     MOVELBNC3      ISPTY3
     C                     MOVELBNC4      ISPTY4
     C                     MOVELBNC5      ISPTY5
     C                     MOVE PCCY      ISCCY
     C**********           MOVE 'A'       IVTAG1            TAG IND 1     096267
     C           WMT103    IFEQ 'Y'                                       CFT014
     C                     MOVE 'A'       IVTAG1                          CFT014
     C                     ENDIF                                          CFT014
     C                     MOVE ' '       IVTAG2            TAG IND 2
     C                     MOVE 'D'       IVTAG3            TAG IND 3
     C/COPY WNCPYSRC,FT0641C068
     C                     EXSR SR01
     C*
     C*********_____________________________________________              E32481
     C*********IF*MT202*FIELD ON SCREEN IS 'Y' SEND AN MT202              E32481
     C*********---------------------------------------------              E32481
     C***********SNMT******IFEQ 'Y'                                       E32481
     C*********************CALL 'FTC0648'                                 E32481
     C*********************PARM           PREF                            E32481
     C*********************PARM           RSEQ                      S01117E32481
     C*********************END                                            E32481
     C*
     C/COPY WNCPYSRC,FT0641C045
     C*
     C* ** MOVE FORMATTED BENEFICIARY  BANK FIELDS INTO DATA STRUCTRE**
     C                     MOVELOFSPT1    M5BBK1
     C                     MOVELOFSPT2    M5BBK2
     C                     MOVELOFSPT3    M5BBK3
     C                     MOVELOFSPT4    M6BBK4
     C                     MOVELOFSPT5    M6BBK5
     C/COPY WNCPYSRC,FT0641C051
     C*
     C                     MOVE *ON       *IN27                           CFT014
     C           M5BBK1    IFNE *BLANK
     C           M5BBK2    ORNE *BLANK
     C           M5BBK3    ORNE *BLANK
     C           M6BBK4    ORNE *BLANK
     C           M6BBK5    ORNE *BLANK
     C*********************MOVE ':59:'    M5TG59                          S01310
     C*********************MOVE X0D25     M5CRL4                          S01310
      *                                                                                       CSW215
      ** Format Beneficiary with 59F                                                          CSW215
      ** if CSW215 is installed                                                               CSW215
      *                                                                                       CSW215
     C                     MOVEL'N'       WRK59F  1                                           CSW215
      *                                                                                       CSW215
     C           CSW215    IFEQ 'Y'                                                           CSW215
     C           WMT103    ANDEQ'Y'                                                           CSW215
     C                     SUBSTM5BBK1:1  WSLASH  1                                           CSW215
     C                     SUBSTM5BBK1:1  WLINE1  2                                           CSW215
     C                     SUBSTM5BBK2:1  WLINE2  2                                           CSW215
      *                                                                                       CSW215
     C           WSLASH    IFEQ '/'                                                           CSW215
     C           WLINE2    ANDEQ'1/'                                                          CSW215
     C           WLINE1    OREQ '1/'                                                          CSW215
     C                     MOVEL'Y'       WRK59F                                              CSW215
     C                     MOVELM5BBK1    PBENF1                                              CSW215
     C                     MOVELM5BBK2    PBENF2                                              CSW215
     C                     MOVELM5BBK3    PBENF3                                              CSW215
     C                     MOVELM6BBK4    PBENF4                                              CSW215
     C                     MOVELM6BBK5    PBENF5                                              CSW215
     C                     ELSE                                                               CSW215
     C                     EXSR SRFM59                                                        CSW215
     C                     ENDIF                                                              CSW215
      *                                                                                       CSW215
     C           WRK59F    IFEQ 'Y'                                                           CSW215
     C                     ADD  1         Q                                                   CSW215
     C           Q         OCUR MULT                                                          CSW215
     C                     MOVEL':59F:'   MTAG                                                CSW215
     C                     MOVELPBENF1    MFLD                                                CSW215
     C           PBENF2    IFNE *BLANKS                                                       CSW215
     C                     ADD  1         Q                                                   CSW215
     C           Q         OCUR MULT                                                          CSW215
     C                     MOVELPBENF2    MFLD                                                CSW215
     C                     ENDIF                                                              CSW215
     C           PBENF3    IFNE *BLANKS                                                       CSW215
     C                     ADD  1         Q                                                   CSW215
     C           Q         OCUR MULT                                                          CSW215
     C                     MOVELPBENF3    MFLD                                                CSW215
     C                     ENDIF                                                              CSW215
     C           PBENF4    IFNE *BLANKS                                                       CSW215
     C                     ADD  1         Q                                                   CSW215
     C           Q         OCUR MULT                                                          CSW215
     C                     MOVELPBENF4    MFLD                                                CSW215
     C                     ENDIF                                                              CSW215
     C           PBENF5    IFNE *BLANKS                                                       CSW215
     C                     ADD  1         Q                                                   CSW215
     C           Q         OCUR MULT                                                          CSW215
     C                     MOVELPBENF5    MFLD                                                CSW215
     C                     ENDIF                                                              CSW215
     C                     ENDIF                                                              CSW215
     C                     ENDIF                                                              CSW215
      *                                                                                       CSW215
     C           WRK59F    IFEQ 'N'                                                           CSW215
      *                                                                   CFT014
     C           WMT103    IFEQ 'Y'                                       CFT014
      *                                                                   CFT014
      ** Set W59A to 'Y' if first line of Tag 59 is an account line       CFT014
      ** as identified by a '/' on the first position.                    CFT014
      *                                                                   CFT014
     C                     MOVELM5BBK1    WCHR01                          CFT014
     C           WCHR01    IFNE '/'                                       CFT014
     C                     MOVE 'N'       W59A                            CFT014
     C                     ENDIF                                          CFT014
      *                                                                                       CSW202
      ** Swift 2002 changes                                                                   CSW202
      *                                                                                       CSW202
     C           CSW202    IFEQ 'Y'                                                           CSW202
     C           W59A      ANDNE'N'                                                           CSW202
      *                                                                                       CSW202
      ** Determine if Sender field Support Charge Transparency                                CSW202
      *                                                                                       CSW202
     C                     MOVE 'N'       WSCTSN  1                                           CSW202
     C                     MOVE *BLANKS   WFLAG   1                                           CSW202
     C                     MOVE *BLANKS   WRK18  18                                           CSW202
     C           8         SUBSTNWSN:1    WSWID   8                                           CSW202
     C           3         SUBSTNWSN:10   WBRCH   3                                           CSW202
     C           WSWID     CAT  WBRCH     WRK11  11                                           CSW202
     C                     MOVELWRK11     WRK18                                               CSW202
     C                     EXSR SRSCT                                                         CSW202
     C           WKSCHT    IFEQ 'Y'                                                           CSW202
     C                     MOVE 'Y'       WSCTSN                                              CSW202
     C                     ENDIF                                                              CSW202
      *                                                                                       CSW202
      ** Determine if Receiver field Support Charge Transparency                              CSW202
      *                                                                                       CSW202
     C                     MOVE 'N'       WSCTRC  1                                           CSW202
     C                     MOVE *BLANKS   WFLAG                                               CSW202
     C                     MOVE *BLANKS   WRK18                                               CSW202
     C                     MOVELNWDS      WRK18                                               CSW202
     C                     EXSR SRSCT                                                         CSW202
     C           WKSCHT    IFEQ 'Y'                                                           CSW202
     C                     MOVE 'Y'       WSCTRC                                              CSW202
     C                     ENDIF                                                              CSW202
      *                                                                                       CSW202
      ** Determine if Account with Institution field Support Charge                           CSW202
      ** transparency                                                                         CSW202
      *                                                                                       CSW202
     C                     MOVE 'Y'       WSCTAI  1                                           CSW202
     C                     MOVE 'Y'       WFLAG                                               CSW202
     C           W57A      IFEQ 'Y'                                                           CSW202
     C           M4AWB1    ANDNE*BLANKS                                                       CSW202
     C                     MOVELM4AWB1    WCHR01                                              223191
     C                     MOVE *BLANKS   WRK18                                               CSW202
     C           WCHR01    IFNE '/'                                                           223191
     C                     MOVELM4AWB1    WRK18                                               CSW202
     C                     ELSE                                                               223191
     C                     MOVELM4AWB2    WRK18                                               223191
     C                     ENDIF                                                              223191
     C                     EXSR SRSCT                                                         CSW202
     C           WKSCHT    IFNE 'Y'                                                           CSW202
     C                     MOVE 'N'       WSCTAI                                              CSW202
     C                     ENDIF                                                              CSW202
     C                     ENDIF                                                              CSW202
      *                                                                                       CSW202
      ** Check if M5BBK1 is an IBAN account in correct format                                 CSW202
      *                                                                                       CSW202
     C                     MOVE 'N'       WIBANF  1                                           CSW202
     C           CFT004    IFEQ 'Y'                                                           CSW202
     C                     EXSR SRIBAN                                                        CSW202
     C                     ENDIF                                                              CSW202
      *                                                                                       CSW202
     C***********WSCTSN    IFNE 'Y'                                                     CSW202210858
     C***********WSCTRC    ORNE 'Y'                                                     CSW202210858
     C***********WSCTAI    ORNE 'Y'                                                     CSW202210858
     C***********WIBANF    ORNE 'Y'                                                     CSW202210858
     C           WSCTSN    IFEQ 'Y'                                                           210858
     C           WSCTRC    ANDEQ'Y'                                                           210858
     C           WSCTAI    ANDEQ'Y'                                                           210858
     C           WIBANF    IFNE 'Y'                                                           210858
     C                     MOVE 'N'       W59A                                                CSW202
     C                     ENDIF                                                              CSW202
     C                     ENDIF                                                              210858
      *                                                                                       CSW202
     C                     ENDIF                                                              CSW202
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           WMT103    IFEQ 'Y'                                       CFT014
     C           OSTAG     ANDEQ'A'                                       CFT014
     C                     ADD  1         Q                               CFT014
     C           Q         OCUR MULT                                      CFT014
     C                     MOVE OSTAG     M9BNTG                          CFT014
     C                     MOVEL'59'      FLDNO                           CFT014
     C                     EXSR FSWAD                                     CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
     C                     MOVE *OFF      *IN27                           CFT014
     C           M5BBK1    IFNE *BLANKS                                   S01310
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     MOVEL':59:'    MTAG                            S01310
     C                     MOVELM5BBK1    MFLD                            S01310
     C                     END                                            S01310
     C           M5BBK2    IFNE *BLANKS                                   S01310
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     MOVELM5BBK2    MFLD                            S01310
     C                     END                                            S01310
     C           M5BBK3    IFNE *BLANKS                                   S01310
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     MOVELM5BBK3    MFLD                            S01310
     C                     END                                            S01310
     C           M6BBK4    IFNE *BLANKS                                   S01310
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     MOVELM6BBK4    MFLD                            S01310
     C                     END                                            S01310
     C           M6BBK5    IFNE *BLANKS                                   S01310
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     MOVELM6BBK5    MFLD                            S01310
     C                     END                                            S01310
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                                              CSW215
      *                                                                   CFT014
     C/COPY WNCPYSRC,FT0641C021
     C                     END
     C/COPY WNCPYSRC,FT0641C052
     C*
     C***********M5BBK2****IFNE *BLANK                                    S01310
     C***********M5BBK3****ORNE *BLANK                                    S01310
     C***********M6BBK4****ORNE *BLANK                                    S01310
     C***********M6BBK5****ORNE *BLANK                                    S01310
     C*********************MOVE X0D25     M5CRL5                          S01310
     C*********************END                                            S01310
     C***********M5BBK3****IFNE *BLANK                                    S01310
     C***********M6BBK4****ORNE *BLANK                                    S01310
     C***********M6BBK5****ORNE *BLANK                                    S01310
     C*********************MOVE X0D25     M5CRL6                          S01310
     C*********************END                                            S01310
     C*------------------------------------------ SWIFT RECORD SIX ----   S01310
     C***********M6BBK4****IFNE *BLANK                                    S01310
     C***********M6BBK5****ORNE *BLANK                                    S01310
     C*********************MOVE X0D25     M6CRL1                          S01310
     C*********************END                                            S01310
     C***********M6BBK5****IFNE *BLANK                                    S01310
     C*********************MOVE X0D25     M6CRL2                          S01310
     C*********************END                                            S01310
      *                                                                   S01310
      **  Field 70 - Details of Payment.                                  S01310
      *                                                                   S01310
     C*
     C* ** MOVE DETAILS OF PAYMENT INTO DATA STRUCTURE **
     C                     MOVE *BLANKS   OFSPT
     C                     MOVE DTP1      OFSPT1
     C                     MOVE DTP2      OFSPT2
     C                     MOVE DTP3      OFSPT3
     C                     MOVE DTP4      OFSPT4
     C                     EXSR EMBLK
     C                     MOVELOFSPT1    M6DTP1
     C                     MOVELOFSPT2    M6DTP2
     C                     MOVELOFSPT3    M6DTP3
     C                     MOVELOFSPT4    M6DTP4
     C*
     C           M6DTP1    IFNE *BLANK
     C           M6DTP2    ORNE *BLANK
     C           M6DTP3    ORNE *BLANK
     C           M6DTP4    ORNE *BLANK
     C*********************MOVE ':70:'    M6TG70                          S01310
     C*********************MOVE X0D25     M6CRL3                          S01310
     C           M6DTP1    IFNE *BLANKS                                   S01310
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     MOVEL':70:'    MTAG                            S01310
     C                     MOVELM6DTP1    MFLD                            S01310
     C                     END                                            S01310
     C           M6DTP2    IFNE *BLANKS                                   S01310
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     MOVELM6DTP2    MFLD                            S01310
     C                     END                                            S01310
     C           M6DTP3    IFNE *BLANKS                                   S01310
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     MOVELM6DTP3    MFLD                            S01310
     C                     END                                            S01310
     C           M6DTP4    IFNE *BLANKS                                   S01310
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     MOVELM6DTP4    MFLD                            S01310
     C                     END                                            S01310
     C/COPY WNCPYSRC,FT0641C022
     C                     END
     C***********M6DTP2****IFNE *BLANK                                    S01310
     C***********M6DTP3****ORNE *BLANK                                    S01310
     C***********M6DTP4****ORNE *BLANK                                    S01310
     C*********************MOVE X0D25     M6CRL4                          S01310
     C*********************END                                            S01310
     C***********M6DTP3****IFNE *BLANK                                    S01310
     C***********M6DTP4****ORNE *BLANK                                    S01310
     C*********************MOVE X0D25     M6CRL5                          S01310
     C*********************END                                            S01310
     C***********M6DTP4****IFNE *BLANK                                    S01310
     C*********************MOVE X0D25     M6CRL6                          S01310
     C*********************END                                            S01310
     C*
      *                                                                   S01310
      ** Field 71 - Details of charges.                                   S01310
      *                                                                   S01310
     C                     MOVE DTCH      M6DTCH
     C           M6DTCH    IFNE *BLANK
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     MOVEL':71A:'   MTAG                            S01310
     C                     MOVELM6DTCH    MFLD                            S01310
     C*********************MOVE ':71A:'   M6TG71                          S01310
     C*********************MOVE X0D25     M6CRL7                          S01310
     C                     END
      *                                                                   CFT014
     C           WMT103    IFEQ 'Y'                                       CFT014
      *                                                                   CFT014
     C                     MOVE PCCY      M9PCCY                          CFT014
      *                                                                   CFT014
      ** Field 71F - Sender's Charges                                     CFT014
      *                                                                   CFT014
     C                     MOVEL':71F:'   P171F1                          CFT014
     C           OPSCC1    IFNE *BLANKS                                   CFT014
     C                     ADD  1         Q                               CFT014
     C           Q         OCUR MULT                                      CFT014
     C                     MOVEL':71F:'   MTAG                            CFT014
     C                     Z-ADDOPSCH1    WIAMNT                          CFT014
     C                     MOVE OPSCC1    WICCY                           CFT014
     C                     EXSR SRFAMT                                    CFT014
     C                     MOVEA*BLANKS   WA1                             CFT014
     C                     MOVEAWOCCYS    WA1                             CFT014
     C                     MOVEAWOAMNT    WA1,4                           CFT014
     C                     MOVEAWA1       MFLD                            CFT014
     C                     MOVE *BLANKS   WCHR18 18                       CFT014
     C                     MOVEAWA1       WCHR18                          CFT014
     C                     MOVE WCHR18    P171F1                          CFT014
     C                     CALL 'ZSEDIT'                                  CFT014
     C                     PARM OPSCH1    PAMNT                           CFT014
     C                     PARM WODECS    PDECS                           CFT014
     C                     PARM 'J'       PCODE                           CFT014
     C                     PARM *BLANKS   POUT21                          CFT014
     C                     MOVELPOUT21    WCHR20                          CFT014
     C                     MOVE WCHR20    P271F1                          CFT014
     C                     MOVELOPSCC1    P271F1                          CFT014
     C                     MOVELWOAMNT    M9SCH1                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           OPSCC2    IFNE *BLANKS                                   CFT014
     C                     ADD  1         Q                               CFT014
     C           Q         OCUR MULT                                      CFT014
     C                     MOVEL':71F:'   MTAG                            CFT014
     C                     MOVEL':71F:'   P171F2                          CFT014
     C                     Z-ADDOPSCH2    WIAMNT                          CFT014
     C                     MOVE OPSCC2    WICCY                           CFT014
     C                     EXSR SRFAMT                                    CFT014
     C                     MOVEA*BLANKS   WA1                             CFT014
     C                     MOVEAWOCCYS    WA1                             CFT014
     C                     MOVEAWOAMNT    WA1,4                           CFT014
     C                     MOVEAWA1       MFLD                            CFT014
     C                     MOVE *BLANKS   WCHR18                          CFT014
     C                     MOVEAWA1       WCHR18                          CFT014
     C                     MOVE WCHR18    P171F2                          CFT014
     C                     CALL 'ZSEDIT'                                  CFT014
     C                     PARM OPSCH2    PAMNT                           CFT014
     C                     PARM WODECS    PDECS                           CFT014
     C                     PARM 'J'       PCODE                           CFT014
     C                     PARM *BLANKS   POUT21                          CFT014
     C                     MOVELPOUT21    WCHR20                          CFT014
     C                     MOVE WCHR20    P271F2                          CFT014
     C                     MOVELOPSCC2    P271F2                          CFT014
     C                     MOVELWOAMNT    M9SCH2                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           OPSCC3    IFNE *BLANKS                                   CFT014
     C                     ADD  1         Q                               CFT014
     C           Q         OCUR MULT                                      CFT014
     C                     MOVEL':71F:'   MTAG                            CFT014
     C                     MOVEL':71F:'   P171F3                          CFT014
     C                     Z-ADDOPSCH3    WIAMNT                          CFT014
     C                     MOVE OPSCC3    WICCY                           CFT014
     C                     EXSR SRFAMT                                    CFT014
     C                     MOVEA*BLANKS   WA1                             CFT014
     C                     MOVEAWOCCYS    WA1                             CFT014
     C                     MOVEAWOAMNT    WA1,4                           CFT014
     C                     MOVEAWA1       MFLD                            CFT014
     C                     MOVE *BLANKS   WCHR18                          CFT014
     C                     MOVEAWA1       WCHR18                          CFT014
     C                     MOVE WCHR18    P171F3                          CFT014
     C                     CALL 'ZSEDIT'                                  CFT014
     C                     PARM OPSCH3    PAMNT                           CFT014
     C                     PARM WODECS    PDECS                           CFT014
     C                     PARM 'J'       PCODE                           CFT014
     C                     PARM *BLANKS   POUT21                          CFT014
     C                     MOVELPOUT21    WCHR20                          CFT014
     C                     MOVE WCHR20    P271F3                          CFT014
     C                     MOVELOPSCC3    P271F3                          CFT014
     C                     MOVELWOAMNT    M9SCH3                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           OPSCC4    IFNE *BLANKS                                   CFT014
     C                     ADD  1         Q                               CFT014
     C           Q         OCUR MULT                                      CFT014
     C                     MOVEL':71F:'   MTAG                            CFT014
     C                     MOVEL':71F:'   P171F4                          CFT014
     C                     Z-ADDOPSCH4    WIAMNT                          CFT014
     C                     MOVE OPSCC4    WICCY                           CFT014
     C                     EXSR SRFAMT                                    CFT014
     C                     MOVEA*BLANKS   WA1                             CFT014
     C                     MOVEAWOCCYS    WA1                             CFT014
     C                     MOVEAWOAMNT    WA1,4                           CFT014
     C                     MOVEAWA1       MFLD                            CFT014
     C                     MOVE *BLANKS   WCHR18                          CFT014
     C                     MOVEAWA1       WCHR18                          CFT014
     C                     MOVE WCHR18    P171F4                          CFT014
     C                     CALL 'ZSEDIT'                                  CFT014
     C                     PARM OPSCH4    PAMNT                           CFT014
     C                     PARM WODECS    PDECS                           CFT014
     C                     PARM 'J'       PCODE                           CFT014
     C                     PARM *BLANKS   POUT21                          CFT014
     C                     MOVELPOUT21    WCHR20                          CFT014
     C                     MOVE WCHR20    P271F4                          CFT014
     C                     MOVELOPSCC4    P271F4                          CFT014
     C                     MOVELWOAMNT    M9SCH4                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           OPSCC5    IFNE *BLANKS                                   CFT014
     C                     ADD  1         Q                               CFT014
     C           Q         OCUR MULT                                      CFT014
     C                     MOVEL':71F:'   MTAG                            CFT014
     C                     MOVEL':71F:'   P171F5                          CFT014
     C                     Z-ADDOPSCH5    WIAMNT                          CFT014
     C                     MOVE OPSCC5    WICCY                           CFT014
     C                     EXSR SRFAMT                                    CFT014
     C                     MOVEA*BLANKS   WA1                             CFT014
     C                     MOVEAWOCCYS    WA1                             CFT014
     C                     MOVEAWOAMNT    WA1,4                           CFT014
     C                     MOVEAWA1       MFLD                            CFT014
     C                     MOVE *BLANKS   WCHR18                          CFT014
     C                     MOVEAWA1       WCHR18                          CFT014
     C                     MOVE WCHR18    P171F5                          CFT014
     C                     CALL 'ZSEDIT'                                  CFT014
     C                     PARM OPSCH5    PAMNT                           CFT014
     C                     PARM WODECS    PDECS                           CFT014
     C                     PARM 'J'       PCODE                           CFT014
     C                     PARM *BLANKS   POUT21                          CFT014
     C                     MOVELPOUT21    WCHR20                          CFT014
     C                     MOVE WCHR20    P271F5                          CFT014
     C                     MOVELOPSCC5    P271F5                          CFT014
     C                     MOVELWOAMNT    M9SCH5                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Field 71G - Receiver's Charges                                   CFT014
      *                                                                   CFT014
     C           OPRCRM    IFNE 0                                         CFT014
     C                     ADD  1         Q                               CFT014
     C           Q         OCUR MULT                                      CFT014
     C                     MOVEL':71G:'   MTAG                            CFT014
     C                     Z-ADDOPRCRM    WIAMNT                          CFT014
     C                     MOVE PCCY      WICCY                           CFT014
     C                     EXSR SRFAMT                                    CFT014
     C                     MOVEA*BLANKS   WA1                             CFT014
     C                     MOVEAWOCCYS    WA1                             CFT014
     C                     MOVEAWOAMNT    WA1,4                           CFT014
     C                     MOVEAWA1       MFLD                            CFT014
     C                     MOVEAWA1       P1RCRM                          CFT014
     C                     CALL 'ZSEDIT'                                  CFT014
     C                     PARM OPRCRM    PAMNT                           CFT014
     C                     PARM WODECS    PDECS                           CFT014
     C                     PARM 'J'       PCODE                           CFT014
     C                     PARM *BLANKS   POUT21                          CFT014
     C                     MOVELPOUT21    WCHR20                          CFT014
     C                     MOVE WCHR20    P2RCRM                          CFT014
     C                     MOVELPCCY      P2RCRM                          CFT014
     C                     MOVELWOAMNT    M9RCRM                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   S01310
      ** Field 72 - Sender to Receiver Information.                       S01310
      *                                                                   S01310
     C* ** MOVE BANK TO BANK INFOS INTO DATA STRUCTURE **
     C*------------------------------------------ SWIFT RECORD SEVEN --
     C                     MOVE *BLANKS   OFSPT
      *                                                                   CFT014
     C           WMT103    IFEQ 'Y'                                       CFT014
      *                                                                   CFT014
      ** Suppress /CHGS/ and /OCMT/ codewords if present on               CFT014
      ** Bank to Bank info.                                               CFT014
      *                                                                   CFT014
     C                     EXSR SRCHK3                                    CFT014
      *                                                                   CFT014
      ** Omit lines that have been included in the Instruction Code       CFT014
      ** and Third Reimbursement Institution.                             CFT014
      *                                                                   CFT014
     C                     MOVELWBBI1     WCHR01                          CFT014
     C           WCHR01    IFNE '*'                                       CFT014
     C                     MOVE BBI1      WCHR35                          CFT014
     C                     EXSR SRSPT                                     CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVELWBBI2     WCHR01                          CFT014
     C           WCHR01    IFNE '*'                                       CFT014
     C                     MOVE BBI2      WCHR35                          CFT014
     C                     EXSR SRSPT                                     CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVELWBBI3     WCHR01                          CFT014
     C           WCHR01    IFNE '*'                                       CFT014
     C                     MOVE BBI3      WCHR35                          CFT014
     C                     EXSR SRSPT                                     CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVELWBBI4     WCHR01                          CFT014
     C           WCHR01    IFNE '*'                                       CFT014
     C                     MOVE BBI4      WCHR35                          CFT014
     C                     EXSR SRSPT                                     CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVELWBBI5     WCHR01                          CFT014
     C           WCHR01    IFNE '*'                                       CFT014
     C                     MOVE BBI5      WCHR35                          CFT014
     C                     EXSR SRSPT                                     CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVELWBBI6     WCHR01                          CFT014
     C           WCHR01    IFNE '*'                                       CFT014
     C                     MOVE BBI6      WCHR35                          CFT014
     C                     EXSR SRSPT                                     CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C                     MOVE BBI1      OFSPT1
     C                     MOVE BBI2      OFSPT2
     C                     MOVE BBI3      OFSPT3
     C                     MOVE BBI4      OFSPT4
     C                     MOVE BBI5      OFSPT5
     C                     MOVE BBI6      OFSPT6
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     EXSR EMBLK
     C                     MOVELOFSPT1    M7BTB1
     C                     MOVELOFSPT2    M7BTB2
     C                     MOVELOFSPT3    M7BTB3
     C                     MOVELOFSPT4    M7BTB4
     C                     MOVELOFSPT5    M7BTB5
     C                     MOVELOFSPT6    M7BTB6
      *                                                                   CFT014
     C           WMT103    IFNE 'Y'                                       CFT014
      *                                                                   CFT014
      ** Details of Charges is 'BEN' and '/CHGS' is not found in          CFT014
      ** BBI1-6 and '/CHGS' is not due to be output by EMU changes.       CFT014
      *                                                                   CFT014
     C           DTCH      IFEQ 'BEN'                                     CFT014
     C           WOCHGS    ANDEQ'Y'                                       CFT014
      *                                                                   CFT014
     C                     MOVE PCCY      WICCY                           CFT014
     C                     Z-ADDWWCHG     WIAMNT                          CFT014
     C                     EXSR SRFAMT                                    CFT014
      *                                                                   CFT014
     C                     MOVE M7BTB5    M7BTB6                          CFT014
     C                     MOVE M7BTB4    M7BTB5                          CFT014
     C                     MOVE M7BTB3    M7BTB4                          CFT014
     C                     MOVE M7BTB2    M7BTB3                          CFT014
     C                     MOVE M7BTB1    M7BTB2                          CFT014
      *                                                                   CFT014
     C                     MOVEA*BLANKS   WA1                             CFT014
     C                     MOVEA'/CHGS/'  WA1                             CFT014
     C                     MOVEAWOCCYS    WA1,7                           CFT014
     C                     MOVEAWOAMNT    WA1,10                          CFT014
     C* Put a closing '/' at the end of the amount                        CFT014
     C                     Z-ADD1         @N      20                      CFT014
     C           ' '       LOKUPWA1,@N                   61               CFT014
     C                     MOVEA'/'       WA1,@N                          CFT014
     C                     MOVEAWA1       M7BTB1                          CFT014
      *                                                                   CFT014
      ** /OCMT/ information is present.                                   CFT014
      *                                                                   CFT014
     C           O#CCY     IFNE *BLANKS                                   CFT014
     C                     MOVE M7BTB5    M7BTB6                          CFT014
     C                     MOVE M7BTB4    M7BTB5                          CFT014
     C                     MOVE M7BTB3    M7BTB4                          CFT014
     C                     MOVE M7BTB2    M7BTB3                          CFT014
     C                     MOVE OCMT      M7BTB2                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CEU006
      * If /OCMT/ information is present, the Bank To Bank lines          CEU006
      * must be shifted down to accomodate it                             CEU006
     C           O#CCY     IFNE *BLANKS                                   CEU006
     C                     MOVE M7BTB5    M7BTB6                          CEU006
     C                     MOVE M7BTB4    M7BTB5                          CEU006
     C                     MOVE M7BTB3    M7BTB4                          CEU006
     C                     MOVE M7BTB2    M7BTB3                          CEU006
     C                     MOVE M7BTB1    M7BTB2                          CEU006
     C                     MOVE OCMT      M7BTB1                          CEU006
      *                                                                   CEU006
      * likewise for /CHGS/ (goes below /OCMT/)                           CEU006
     C           C#CCY     IFNE *BLANKS                                   CEU006
     C                     MOVE M7BTB5    M7BTB6                          CEU006
     C                     MOVE M7BTB4    M7BTB5                          CEU006
     C                     MOVE M7BTB3    M7BTB4                          CEU006
     C                     MOVE M7BTB2    M7BTB3                          CEU006
     C                     MOVE CHGS      M7BTB2                          CEU006
     C                     ENDIF                                          CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
      *                                                                   CFT014
      ** Output Third Reimbursement Institution info on the next          CFT014
      ** available line.                                                  CFT014
      *                                                                   CFT014
     C           WOTRTG    IFEQ 'A'                                       CFT014
     C                     MOVE *BLANKS   WCHR40                          CFT014
     C                     MOVEL'/RCB/'   WCHR40                          CFT014
     C                     MOVELOPTRI1    ##001                           CFT014
     C           ##001     IFEQ '/'                                       CFT014
     C                     MOVE WOTRI2    WCHR40                          CFT014
     C                     ELSE                                           CFT014
     C                     MOVE WOTRI1    WCHR40                          CFT014
     C                     ENDIF                                          CFT014
     C                     MOVELWCHR40    WCHR35                          CFT014
     C                     EXSR SRBTB1                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Output Instruction Code info on the next available line, if      CFT014
      ** there's any.  It is possible that not all of the info will be    CFT014
      ** accomodated.                                                     CFT014
      *                                                                   CFT014
     C           M7BTB6    IFEQ *BLANKS                                   CFT014
      *                                                                   CFT014
     C                     MOVELOPICD1    WCHR04                          CFT014
     C                     MOVE OPICD1    WCHR31                          CFT014
     C                     EXSR SRICBB                                    CFT014
     C           WOK       IFEQ 'Y'                                       CFT014
     C                     EXSR SRBTB1                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVELOPICD2    WCHR04                          CFT014
     C                     MOVE OPICD2    WCHR31                          CFT014
     C                     EXSR SRICBB                                    CFT014
     C           WOK       IFEQ 'Y'                                       CFT014
     C                     EXSR SRBTB1                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVELOPICD3    WCHR04                          CFT014
     C                     MOVE OPICD3    WCHR31                          CFT014
     C                     EXSR SRICBB                                    CFT014
     C           WOK       IFEQ 'Y'                                       CFT014
     C                     EXSR SRBTB1                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVELOPICD4    WCHR04                          CFT014
     C                     MOVE OPICD4    WCHR31                          CFT014
     C                     EXSR SRICBB                                    CFT014
     C           WOK       IFEQ 'Y'                                       CFT014
     C                     EXSR SRBTB1                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVELOPICD5    WCHR04                          CFT014
     C                     MOVE OPICD5    WCHR31                          CFT014
     C                     EXSR SRICBB                                    CFT014
     C           WOK       IFEQ 'Y'                                       CFT014
     C                     EXSR SRBTB1                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
     C*
     C/COPY WNCPYSRC,FT0641C001
     C           M7BTB1    IFNE *BLANK
     C           M7BTB2    ORNE *BLANK
     C           M7BTB3    ORNE *BLANK
     C           M7BTB4    ORNE *BLANK
     C           M7BTB5    ORNE *BLANK
     C           M7BTB6    ORNE *BLANK
      *                                                                   CFT014
     C           WMT103    IFEQ 'Y'                                       CFT014
     C                     EXSR SR72                                      CFT014
     C                     ENDIF                                          CFT014
      *                                                                   S01310
     C           M7BTB1    IFNE *BLANKS                                   S01310
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     MOVEL':72:'    MTAG                            S01310
     C                     MOVELM7BTB1    MFLD                            S01310
     C                     END                                            S01310
     C*********************MOVE ':72:'    M7TG72                          S01310
     C*********************MOVE X0D25     M7CRL1                          S01310
     C           M7BTB2    IFNE *BLANKS                                   S01310
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     MOVELM7BTB2    MFLD                            S01310
     C                     END                                            S01310
     C           M7BTB3    IFNE *BLANKS                                   S01310
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     MOVELM7BTB3    MFLD                            S01310
     C                     END                                            S01310
     C           M7BTB4    IFNE *BLANKS                                   S01310
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     MOVELM7BTB4    MFLD                            S01310
     C                     END                                            S01310
     C           M7BTB5    IFNE *BLANKS                                   S01310
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     MOVELM7BTB5    MFLD                            S01310
     C                     END                                            S01310
     C           M7BTB6    IFNE *BLANKS                                   S01310
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     MOVELM7BTB6    MFLD                            S01310
     C                     END                                            S01310
     C/COPY WNCPYSRC,FT0641C023
     C                     END
      *                                                                   CFT014
      ** FT0640P2 processing.                                             CFT014
      *                                                                   CFT014
     C           WMT103    IFEQ 'Y'                                       CFT014
      *                                                                   CFT014
      ** Omit lines that have been included in the Instruction Code.      CFT014
      *                                                                   CFT014
     C                     MOVELWBBI1     WCHR01                          CFT014
     C           WCHR01    IFNE '*'                                       CFT014
     C                     MOVE BBI1      WCHR35                          CFT014
     C                     EXSR SRBTB2                                    CFT014
     C                     ENDIF                                          CFT014
     C                     MOVELWBBI2     WCHR01                          CFT014
     C           WCHR01    IFNE '*'                                       CFT014
     C                     MOVE BBI2      WCHR35                          CFT014
     C                     EXSR SRBTB2                                    CFT014
     C                     ENDIF                                          CFT014
     C                     MOVELWBBI3     WCHR01                          CFT014
     C           WCHR01    IFNE '*'                                       CFT014
     C                     MOVE BBI3      WCHR35                          CFT014
     C                     EXSR SRBTB2                                    CFT014
     C                     ENDIF                                          CFT014
     C                     MOVELWBBI4     WCHR01                          CFT014
     C           WCHR01    IFNE '*'                                       CFT014
     C                     MOVE BBI4      WCHR35                          CFT014
     C                     EXSR SRBTB2                                    CFT014
     C                     ENDIF                                          CFT014
     C                     MOVELWBBI5     WCHR01                          CFT014
     C           WCHR01    IFNE '*'                                       CFT014
     C                     MOVE BBI5      WCHR35                          CFT014
     C                     EXSR SRBTB2                                    CFT014
     C                     ENDIF                                          CFT014
     C                     MOVELWBBI6     WCHR01                          CFT014
     C           WCHR01    IFNE '*'                                       CFT014
     C                     MOVE BBI6      WCHR35                          CFT014
     C                     EXSR SRBTB2                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Field 77 - Regulatory Reporting                                  CFT014
      *                                                                   CFT014
     C           WMT103    IFEQ 'Y'                                       CFT014
      *                                                                   CFT014
     C           OPRRP1    IFNE *BLANKS                                   CFT014
     C                     ADD  1         Q                               CFT014
     C           Q         OCUR MULT                                      CFT014
     C                     MOVEL':77B:'   MTAG                            CFT014
     C                     MOVELOPRRP1    MFLD                            CFT014
     C                     MOVELOPRRP1    M9RRP1                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           OPRRP2    IFNE *BLANKS                                   CFT014
     C                     ADD  1         Q                               CFT014
     C           Q         OCUR MULT                                      CFT014
     C                     MOVELOPRRP2    MFLD                            CFT014
     C                     MOVELOPRRP2    M9RRP2                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           OPRRP3    IFNE *BLANKS                                   CFT014
     C                     ADD  1         Q                               CFT014
     C           Q         OCUR MULT                                      CFT014
     C                     MOVELOPRRP3    MFLD                            CFT014
     C                     MOVELOPRRP3    M9RRP3                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
     C***********M7BTB2****IFNE *BLANK                                    S01310
     C***********M7BTB3****ORNE *BLANK                                    S01310
     C***********M7BTB4****ORNE *BLANK                                    S01310
     C***********M7BTB5****ORNE *BLANK                                    S01310
     C***********M7BTB6****ORNE *BLANK                                    S01310
     C*********************MOVE X0D25     M7CRL2                          S01310
     C*********************END                                            S01310
     C***********M7BTB3****IFNE *BLANK                                    S01310
     C***********M7BTB4****ORNE *BLANK                                    S01310
     C***********M7BTB5****ORNE *BLANK                                    S01310
     C***********M7BTB6****ORNE *BLANK                                    S01310
     C*********************MOVE X0D25     M7CRL3                          S01310
     C*********************END                                            S01310
     C***********M7BTB4****IFNE *BLANK                                    S01310
     C***********M7BTB5****ORNE *BLANK                                    S01310
     C***********M7BTB6****ORNE *BLANK                                    S01310
     C*********************MOVE X0D25     M7CRL4                          S01310
     C*********************END                                            S01310
     C***********M7BTB5****IFNE *BLANK                                    S01310
     C***********M7BTB6****ORNE *BLANK                                    S01310
     C*********************MOVE X0D25     M7CRL5                          S01310
     C*********************END                                            S01310
     C***********M7BTB6****IFNE *BLANK                                    S01310
     C*********************MOVE X0D25     M7CRL6                          S01310
     C*********************END                                            S01310
     C*********************                                               S01310
     C*********************                                               S01310
     C***FORMAT*THE*AMOUNT*                                               S01310
     C*********************EXSR SR06                                      S01310
     C*********************MOVEASAM       FAMT                            S01310
     C*********************Z-ADD1         S       30                      S01310
     C***********FAMT,S****DOWEQ' '                                       S01310
     C*********************ADD  1         S                               S01310
     C*********************END                                            S01310
     C*********************MOVEAFAMT,S    M1AMNT                          S01310
     C*********************                                               S01310
     C***OUTPUT*SEVEN*RECORDS TO THE OUTGOING SWIFT MESSAGES              S01310
     C***FILE*(PF/MSMSOPF)*AND ONE RECORD TO (PF/MSIXOPF)                 S01310
     C*********************                                               S01310
     C*********************EXSR SR08                                      S01310
     C/COPY WNCPYSRC,FT0641C031
      *                                                                   S01310
      ** Output correctly generated message to PF/MGOMSGPD and write      S01310
      ** reference record to PF/MGOREFPD.                                 S01310
      *                                                                   S01310
     C                     EXSR OMSG                                      S01310
      *                                                                   CFT014
      ** Do printing of TELEX here if message needs MT103 fields.         CFT014
      *                                                                   CFT014
     C           WMT103    IFEQ 'Y'                                       CFT014
     C           WTLX      ANDEQ'Y'                                       CFT014
     C                     EXSR SRP2                                      CFT014
     C                     ENDIF                                          CFT014
     C*
     C*  OUTPUT AN ENTRY TO THE SWIFT MESSAGE REPORT PRTF/FT0641P1     )))
     C*  INCLUDE NARRATIVE 'RECOVERY' IF ROLLBACK INDICATOR
     C*  HAS BEEN SETON IN SUBROUTINE SR08
     C/COPY WNCPYSRC,FT0641C038
     C                     EXSR SRP1
     C/COPY WNCPYSRC,FT0641C039
     C*
     C                     MOVE 'Y'       OPPARM           MSG PROD FLAG
     C*****INCREMENT*MESSAGES*COUNT*FIELD*IN*DATAAREA*MSFCTL***********   E21286
     C*****INCREMENT*MESSAGES*COUNT*FIELD*IN*DATAAREA*FTFCTL*       E21286S01310
     C**(AS*LONG*AS*MT210*TELEX*MESAGE*HAS*NOT*BEEN*PRODUCED)*            S01310
     C************IN26*****IFEQ '0'                                       S01310
     C*********************EXSR SR11                                      S01310
     C*********************END                                            S01310
     C*                                                                )))
     C*********************END                                            S01310
     C*                                                                )))
     C/COPY WNCPYSRC,FT0641C003
     C/EJECT
     C*
     C                     ENDIF                                                              246371
     C**********************************
     C*    LAST RECORD PROCESSING.     *
     C**********************************
     C*
     C**  OUTPUT A RUN CONTROL REPORT
     CLRN40                EXSR FIRST
     C*LR*******************ADD  1         PAGEP3                         S01117
     CLR                   ADD  1         PAGEAU                          S01117
     C*LR*******************WRITEP3H1                   80                S01117
     CLR                   WRITEHEADAU                 80                 S01117
     CLR 80                DO                               B001
     C*                                                    ))))))))))))))
     C*R*******************MOVE 'FT0641P3'DBFNAM           )))  DATA  ))) S01117
     CLR                   MOVEL'FT0641AU'DBFNAM           )))        ))) S01117
     CLR                   MOVEL'3'       DBERKY           )))  BASE  )))
     C*LR******************MOVE 18        DBERR#           ))) ERROR  ))) S01117
     CLR                   MOVE '18'      DBERR#           )))        ))) S01117
     CLR                   EXSR DBERR                      )))   18   )))
     C*                                                    ))))))))))))))
     CLR                   END                              E001
     CLR                   RETRN
     C*
     C/EJECT                                                                                  CSD015
      *****************************************************************                       CSD015
      *                                                               *                       CSD015
      *  SRWTCH - Watch Processing                                    *                       CSD015
      *                                                               *                       CSD015
      *****************************************************************                       CSD015
      *                                                                                       CSD015
     C           SRWTCH    BEGSR                                                              CSD015
      *                                                                                       CSD015
      ** Re-determine Message Status                                                          CSD015
      *                                                                                       CSD015
     C                     MOVE 'N'       PARLS   1                                           CSD015
     C           MGST      IFEQ 'RSND'                                                        CSD015
     C           NWRK      IFEQ 'SWIFT '                                                      CSD015
     C           NWRK      OREQ 'TELEX '                                                      CSD015
     C           NWRK      OREQ 'STTX  '                                                      CSD015
     C                     MOVE 'CRTD'    MGST                                                CSD015
     C                     MOVE '1'       MGSG                                                CSD015
     C                     MOVE 'Y'       PARLS                                               CSD015
     C                     ENDIF                                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Set-up parameter for Compliance Engine program                                       CSD015
      *                                                                                       CSD015
      ** Initialise file fields                                                               CSD015
      *                                                                                       CSD015
     C                     CLEARWLFDS                                                         CSD015
     C                     Z-ADD*ZERO     W4VDAT                                              CSD015
     C                     Z-ADD*ZERO     W4MDAT                                              CSD015
     C                     Z-ADD*ZERO     W4AMT1                                              CSD015
     C                     Z-ADD*ZERO     W4AMT2                                              CSD015
      *                                                                                       CSD015
      ** Set up parameter for compliance engine program                                       CSD015
      *                                                                                       CSD015
     C                     MOVELTRNO      W4IDEN                                              CSD015
     C                     MOVELMTPY      W4ITEM                                              CSD015
     C                     MOVELBRCAA     W4BRCH                                              CSD015
     C                     MOVEL'MGOREF  'W4FUNT                                              CSD015
     C                     MOVELDECN      W4CNUM                                              CSD015
     C                     Z-ADDRUND      W4DDAT                                              CSD015
     C                     MOVELPARLS     W4ARLS                                              CSD015
      *                                                                                       CSD015
      ** Send transaction to compliance engine program                                        CSD015
      *                                                                                       CSD015
     C                     CALL 'SDWLCLOP'                                                    CSD015
     C                     PARM           WLFDS                                               CSD015
     C                     PARM *BLANKS   PSTRNG                                              CSD015
      *                                                                                       CSD015
     C           EWATCH    ENDSR                                                              CSD015
      *****************************************************************                       CSD015
     C/EJECT                                                              CEU006
     C*****************************************************************   CEU006
     C*   ERI - Format Field :72: ERI information                     *   CEU006
     C*   Called by - main process.                                   *   CEU006
     C*   Calls     -                                                 *   CEU006
     C*****************************************************************   CEU006
     C*                                                                   CEU006
     C           ERI       BEGSR                                          CEU006
     C*                                                                   CSW020
     C** Perform Old Processing if CSW020 is not switched on.             CSW020
     C           CSW020    IFNE 'Y'                                       CSW020
      *                                                                   CEU006
      * Retrieve currency details for Pay Delivery Currency to get        CEU006
      * SWIFT currency code (TABTG10)                                     CEU006
     C                     MOVEL'20'      TABTGK                          CEU006
     C                     MOVELPDCY      TGCCSR                          CEU006
     C                     MOVE '1'       TGCCSR                          CEU006
     C                     MOVE TGCCSR    TABTGK                          CEU006
     C           TABTGK    CHAINTABFP                10                   CEU006
     C*                                                                   CEU006
     C           *IN10     IFEQ '1'                                       CEU006
     C                     MOVEL'TABFP'   DBFNAM            ************  CEU006
     C                     MOVELTABTGK    DBERKY            * DBERR 31 *  CEU006
     C                     MOVE '31'      DBERR#            ************  CEU006
     C                     EXSR DBERR                                     CEU006
     C                     END                                            CEU006
      *                                                                   CEU006
     C                     MOVELCCYS      O#CCY                           CEU006
      *                                                                   CEU006
      * Format Pay Delivery Amount (per SR03)                             CEU006
     C                     MOVE PDAM      APDAM  13                       CEU006
      *                                                                   CEU006
     C*    DETERMINE DECIMAL POSITION (FOR REPORT)                        CEU006
     C           CDP       COMP 2                    33  32               CEU006
     C           CDP       COMP 1                      3031               CEU006
     C*                                                                   CEU006
     C*    DETERMINE DECIMAL POSITION                                     CEU006
     C           14        SUB  CDP       X       20                      CEU006
     C*    IF 0 DECIMAL PLACES DON'T EDIT                                 CEU006
     C           CDP       IFEQ 0                          B001           CEU006
     C                     MOVE *BLANK    AMT                             CEU006
     C                     MOVE *ZEROS    AM                              CEU006
     C                     MOVEAAPDAM     AMT,2                           CEU006
     C                     MOVEAAPDAM     AM,1                            CEU006
     C                     Z-ADD13        W                               CEU006
     C                     MOVE ','       AM,X                            CEU006
     C                     ELSE                            X001           CEU006
     C*    MOVE AMOUNT INTO ARRAY                                         CEU006
     C                     MOVEAAPDAM     AMT,1                           CEU006
     C*    DETERMINE POSITION OF DECIMAL DIGITS IN 2ND ARRAY              CEU006
     C           X         ADD  1         Y       20                      CEU006
     C*    MOVE DECIMAL DIGITS INTO 2ND ARRAY FIELD                       CEU006
     C                     MOVEAAMT,X     AM,Y                            CEU006
     C*    DETERMINE POSITION & MOVE COMMA                                CEU006
     C                     SUB  1         Y                               CEU006
     C                     MOVE ','       AM,Y                            CEU006
     C*    DETERMINE POSITION OF DIGIT B4  COMMA                          CEU006
     C                     SUB  1         Y                               CEU006
     C*    SAVE POSITION OF DIGIT B4  COMMA                               CEU006
     C                     Z-ADDY         W       20                      CEU006
     C*    DETERMINE POSITION OF DIGIT TO BE MOVED B4  COMMA              CEU006
     C                     SUB  1         X                               CEU006
     C                     Z-ADDX         Z       20                      CEU006
     C*    DO OPERATIONS MOVING CHARACTERS ONE AT A TIME                  CEU006
     C*    FROM RIGHT TO LEFT                                             CEU006
     C                     DO   X                                         CEU006
     C                     MOVE AMT,Z     AM,Y                            CEU006
     C                     SUB  1         Z                               CEU006
     C                     SUB  1         Y                               CEU006
     C                     END                                            CEU006
     C                     END                             E001           CEU006
     C*    SET INDEX TO 1                                                 CEU006
     C                     Z-ADD1         Y                               CEU006
     C*    REPLACE LEADING ZEROS WITH BLANK                               CEU006
     C           AM,Y      DOWEQ'0'                                       CEU006
     C           Y         CABEQW         ERITAG                          CEU006
     C                     MOVE ' '       AM,Y                            CEU006
     C                     ADD  1         Y                               CEU006
     C                     END                                            CEU006
     C*  ** SAVE FIELD FROM ARRAY                                         CEU006
     C           ERITAG    TAG                                            CEU006
     C                     MOVEAAM        AMX    14                       CEU006
     C                     MOVE AMX       SAM    15                       CEU006
     C                     MOVEASAM       FAMT                            CEU006
     C                     Z-ADD1         S       30                      CEU006
     C           FAMT,S    DOWEQ' '                                       CEU006
     C                     ADD  1         S                               CEU006
     C                     END                                            CEU006
     C                     MOVEAFAMT,S    O#AMNT                          CEU006
     C*                                                                   CSW020
     C** If CSW020 is switched on perform Swift Decimal Places processing CSW020
     C                     ELSE                                           CSW020
     C*                                                                   CSW020
     C                     CALL 'ZM0040'                                  CSW020
     C                     PARM PDAM      ZAMNT  130                      CSW020
     C                     PARM PDCY      ZCCY    3                       CSW020
     C                     PARM *BLANKS   ZSAMNT 15                       CSW020
     C                     PARM *BLANKS   ZSCCY   3                       CSW020
     C                     PARM *BLANKS   ZERR    1                       CSW020
     C*                                                                   CSW020
     C** Handle Database Error                                            CSW020
     C           ZERR      IFEQ '1'                                       CSW020
     C                     MOVEL'ZM0040  'DBFNAM           ************   CSW020
     C                     MOVELPCCY      DBERKY           * DBERR 34 *   CSW020
     C                     MOVE '34'      DBERR#           ************   CSW020
     C                     EXSR DBERR                                     CSW020
     C*                                                                   CSW020
     C                     ELSE                                           CSW020
     C                     MOVE ZSAMNT    O#AMNT                          CSW020
     C                     MOVE ZSCCY     O#CCY                           CSW020
     C                     ENDIF                                          CSW020
     C*                                                                   CSW020
     C                     ENDIF                                          CSW020
     C*                                                                   CSW020
     C** Place ending '/' for field 72.                                   149197
     C                     MOVEA*BLANKS   @STR                            149197
     C                     Z-ADD1         N       20                      149197
     C                     MOVEAO#OCMT    @STR                            149197
     C           ' '       LOKUP@STR,N                   60               149197
     C                     MOVEA'/'       @STR,N                          149197
     C                     MOVEA@STR      O#OCMT                          149197
     C**                                                                  149197
      *                                                                   CEU006
      * Format /CHGS/ line if:                                            CEU006
      * - Add/Deduct Charges = D and                                      CEU006
      * - Charges to Debit Of = 0 and                                     CEU006
      * - Total Charges <> 0                                              CEU006
     C           ADDC      IFEQ 'D'                                       CEU006
     C***********CDRO      ANDEQ0                                         CEU006              CSD027
     C           CDRO      ANDEQ*BLANKS                                   CEU006              CSD027
     C           W#CHGS    ANDNE0                                         CEU006
     C*                                                                   CSW020
     C** Perform Old Processing if CSW020 is not switched on.             CSW020
     C           CSW020    IFNE 'Y'                                       CSW020
      *                                                                   CEU006
      * Set charges currency to SWIFT currency code of Pay Currency       CEU006
      * (currency and decimal places saved in SR/SR03)                    CEU006
     C                     MOVELWCCYS     C#CCY                           CEU006
      *                                                                   CEU006
      * Reformat charge amount for SWIFT  -                               CEU006
     C                     MOVE W#CHGS    A#CHGS 13                       CEU006
      *                                                                   CEU006
     C*    DETERMINE DECIMAL POSITION (FOR REPORT)                        CEU006
     C           WCDP      COMP 2                    33  32               CEU006
     C           WCDP      COMP 1                      3031               CEU006
     C*                                                                   CEU006
     C*    DETERMINE DECIMAL POSITION                                     CEU006
     C           14        SUB  WCDP      X       20                      CEU006
     C*    IF 0 DECIMAL PLACES DON'T EDIT                                 CEU006
     C           WCDP      IFEQ 0                          B001           CEU006
     C                     MOVE *BLANK    AMT                             CEU006
     C                     MOVE *ZEROS    AM                              CEU006
     C                     MOVEAA#CHGS    AMT,2                           CEU006
     C                     MOVEAA#CHGS    AM,1                            CEU006
     C                     Z-ADD13        W                               CEU006
     C                     MOVE ','       AM,X                            CEU006
     C                     ELSE                            X001           CEU006
     C*    MOVE AMOUNT INTO ARRAY                                         CEU006
     C                     MOVEAA#CHGS    AMT,1                           CEU006
     C*    DETERMINE POSITION OF DECIMAL DIGITS IN 2ND ARRAY              CEU006
     C           X         ADD  1         Y       20                      CEU006
     C*    MOVE DECIMAL DIGITS INTO 2ND ARRAY FIELD                       CEU006
     C                     MOVEAAMT,X     AM,Y                            CEU006
     C*    DETERMINE POSITION & MOVE COMMA                                CEU006
     C                     SUB  1         Y                               CEU006
     C                     MOVE ','       AM,Y                            CEU006
     C*    DETERMINE POSITION OF DIGIT B4  COMMA                          CEU006
     C                     SUB  1         Y                               CEU006
     C*    SAVE POSITION OF DIGIT B4  COMMA                               CEU006
     C                     Z-ADDY         W       20                      CEU006
     C*    DETERMINE POSITION OF DIGIT TO BE MOVED B4  COMMA              CEU006
     C                     SUB  1         X                               CEU006
     C                     Z-ADDX         Z       20                      CEU006
     C*    DO OPERATIONS MOVING CHARACTERS ONE AT A TIME                  CEU006
     C*    FROM RIGHT TO LEFT                                             CEU006
     C                     DO   X                                         CEU006
     C                     MOVE AMT,Z     AM,Y                            CEU006
     C                     SUB  1         Z                               CEU006
     C                     SUB  1         Y                               CEU006
     C                     END                                            CEU006
     C                     END                             E001           CEU006
     C*    SET INDEX TO 1                                                 CEU006
     C                     Z-ADD1         Y                               CEU006
     C*    REPLACE LEADING ZEROS WITH BLANK                               CEU006
     C           AM,Y      DOWEQ'0'                                       CEU006
     C           Y         CABEQW         ERITG2                          CEU006
     C                     MOVE ' '       AM,Y                            CEU006
     C                     ADD  1         Y                               CEU006
     C                     END                                            CEU006
     C*  ** SAVE FIELD FROM ARRAY                                         CEU006
     C           ERITG2    TAG                                            CEU006
     C                     MOVEAAM        AMX    14                       CEU006
     C                     MOVE AMX       SAM    15                       CEU006
     C                     MOVEASAM       FAMT                            CEU006
     C                     Z-ADD1         S       30                      CEU006
     C           FAMT,S    DOWEQ' '                                       CEU006
     C                     ADD  1         S                               CEU006
     C                     END                                            CEU006
     C                     MOVEAFAMT,S    C#AMNT                          CEU006
     C*                                                                   CSW020
     C** If CSW020 is switched on perform Swift Decimal Places processing CSW020
     C                     ELSE                                           CSW020
     C*                                                                   CSW020
     C                     CALL 'ZM0040'                                  CSW020
     C                     PARM W#CHGS    ZAMNT                           CSW020
     C                     PARM PCCY      ZCCY                            CSW020
     C                     PARM *BLANKS   ZSAMNT                          CSW020
     C                     PARM *BLANKS   ZSCCY                           CSW020
     C                     PARM *BLANKS   ZERR                            CSW020
     C*                                                                   CSW020
     C** Handle Database Error                                            CSW020
     C           ZERR      IFEQ '1'                                       CSW020
     C                     MOVEL'ZM0040  'DBFNAM           ************   CSW020
     C                     MOVELPCCY      DBERKY           * DBERR 34 *   CSW020
     C                     MOVE '35'      DBERR#           ************   CSW020
     C                     EXSR DBERR                                     CSW020
     C*                                                                   CSW020
     C                     ELSE                                           CSW020
     C                     MOVE ZSAMNT    C#AMNT                          CSW020
     C                     MOVE ZSCCY     C#CCY                           CSW020
     C                     ENDIF                                          CSW020
     C*                                                                   CSW020
     C                     ENDIF                                          CSW020
     C*                                                                   CSW020
     C** Place ending '/' for field 72.                                   151235
     C                     MOVEA*BLANKS   @STR                            151235
     C                     Z-ADD1         N                               151235
     C                     MOVEAC#CHGS    @STR                            151235
     C           ' '       LOKUP@STR,N                   60               151235
     C                     MOVEA'/'       @STR,N                          151235
     C                     MOVEA@STR      C#CHGS                          151235
     C**                                                                  151235
      *                                                                   CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
     C                     ENDSR                                          CEU006
     C*****************************************************************   CEU006
     C/EJECT
     C*****************************************************************   S01310
     C*   FSWAD - Format SWIFT address                                *   S01310
     C*   Called by - main process.                                   *   S01310
     C*   Calls     -                                                 *   S01310
     C*****************************************************************   S01310
     C*                                                                   S01310
     C           FSWAD     BEGSR                                          S01310
     C*                                                                   S01310
     C**  Address 1                                                       S01310
     C                     MOVELOFSPT1    MFLD                            S01310
     C                     MOVE *BLANK    WORKTG  1                                           CMS006
      *                                                                                       CMS006
     C           CMS006    IFEQ 'Y'                                                           CMS006
     C           FLDNO     ANDEQ'53'                                                          CMS006
     C           SNMT      ANDEQ'N'                                                           CMS006
      *                                                                                       CMS006
     C                     MOVE SNCO      WSNCOC 10                                           CMS006
      *                                                                                       CMS006
      ** Destination field contains a 6-digit Customer Number                                 CMS006
      *                                                                                       CMS006
     C           DSTT      IFEQ 'C'                                                           CMS006
      *                                                                                       CMS006
      ** Nostro entered in Sender's Correspondent                                             CMS006
      *                                                                                       CMS006
     C           SNCT      IFEQ 'N'                                                           CMS006
     C                     MOVELSNCO      P@NONB                                              CMS006
      *                                                                                       CMS006
     C                     CALL 'AONOSTR0'                                                    CMS006
     C                     PARM *BLANKS   @RTCD                                               CMS006
     C                     PARM '*KEY   ' @OPTN                                               CMS006
     C                     PARM *BLANKS   P@CUST  6                                           CMS006
     C                     PARM PCCY      P@CYCD  3                                           CMS006
     C                     PARM *BLANKS   P@ACCD 10                                           CMS006
     C                     PARM *BLANKS   P@ACSN  2                                           CMS006
     C                     PARM           P@NONB  2                                           CMS006
     C                     PARM *BLANKS   P@BRCD  3                                           CMS006
     C                     PARM *BLANKS   P@CSSN 10                                           CMS006
     C                     PARM *BLANKS   P@PNOI  1                                           CMS006
     C           SDNOST    PARM SDNOST    DSFDY                                               CMS006
      *                                                                                       CMS006
     C                     ENDIF                                                              CMS006
      *                                                                                       CMS006
     C                     MOVELDST1      WKDEST  6                                           CMS006
     C           @RTCD     IFEQ *BLANKS                                                       CMS006
     C           SNCT      ANDEQ'N'                                                           CMS006
      *                                                                                       CMS006
      ** Destination Customer = Sender's Correspondent Customer                               CMS006
      *                                                                                       CMS006
     C           A7CUST    ANDEQWKDEST                                                        CMS006
      *                                                                                       CMS006
      ** Sender's Correspondent Customer exists in SDNOSTPD                                   CMS006
      ** Our Receive Account                                                                  CMS006
      *                                                                                       CMS006
     C           A7ORAC    IFNE *BLANKS                                                       CMS006
     C                     MOVEL'/'       WORK26 26 P                                         CMS006
     C                     MOVE A7ORAC    WORK26                                              CMS006
     C                     MOVELWORK26    MFLD      P                                         CMS006
     C                     MOVE '/'       WORKTG                                              CMS006
     C                     ELSE                                                               CMS006
      *                                                                                       CMS006
      ** Full Midas account of Sender's Correspondent                                         CMS006
      *                                                                                       CMS006
     C                     MOVE '/'       WORK0                                               CMS006
     C                     MOVELA7BRCD    WORK1     P                                         CMS006
     C                     MOVELA7CUST    WORK2     P                                         CMS006
     C                     MOVELA7CYCD    WORK3     P                                         CMS006
     C                     MOVELA7ACCD    WORK4     P                                         CMS006
     C                     MOVELA7ACSN    WORK5     P                                         CMS006
      *                                                                                       CMS006
      ** Midas Full Account                                                                   CMS006
      *                                                                                       CMS006
     C                     MOVELWORKDS    MFLD      P                                         CMS006
     C                     MOVE '/'       WORKTG                                              CMS006
     C                     ENDIF                                                              CMS006
      *                                                                                       CMS006
     C                     MOVE 'B'       OSTAG                                               CMS006
     C                     MOVE OSTAG     M3SCTT                                              CMS006
      *                                                                                       CMS006
     C                     ENDIF                                                              CMS006
      *                                                                                       CMS006
      ** Sender's Correspondent is a Retail Account                                           CMS006
      *                                                                                       CMS006
     C           SNCT      IFEQ 'R'                                                           CMS006
     C                     MOVE SNCO      WKSNCO 100                                          CMS006
     C           WKSNCO    CHAINACCNTL1R             07                                       CMS006
      *                                                                                       CMS006
     C           *IN07     IFEQ *OFF                                                          CMS006
     C                     MOVE CNUM      WKCNUM  6                                           CMS006
     C           WKCNUM    IFEQ WKDEST                                                        CMS006
      *                                                                                       CMS006
      ** Sender's Correspondent Customer does not exist in SDNOSTPD                           CMS006
      ** Full Midas account of Sender's Correspondent                                         CMS006
      *                                                                                       CMS006
     C                     MOVE '/'       WORK0                                               CMS006
     C                     MOVELBRCA      WORK1     P                                         CMS006
     C                     MOVELCNUM      WORK2     P                                         CMS006
     C                     MOVELCCY       WORK3     P                                         CMS006
     C                     MOVELACOD      WORK4     P                                         CMS006
     C                     MOVELACSQ      WORK5     P                                         CMS006
      *                                                                                       CMS006
      ** Midas Full Account                                                                   CMS006
      *                                                                                       CMS006
     C                     MOVELWORKDS    MFLD      P                                         CMS006
     C                     MOVE '/'       WORKTG                                              CMS006
      *                                                                                       CMS006
     C                     MOVE 'B'       OSTAG                                               CMS006
     C                     MOVE OSTAG     M3SCTT                                              CMS006
      *                                                                                       CMS006
      *                                                                                       CMS006
     C                     ENDIF                                                              CMS006
     C                     ENDIF                                                              CMS006
     C                     ENDIF                                                              CMS006
      *                                                                                       CMS006
     C                     ENDIF                                                              CMS006
     C                     ENDIF                                                              CMS006
     C*                                                                   S01310
     C**  SWIFT address;  Else full address                               S01310
     C           OSTAG     IFEQ 'A'                                       S01310
     C                     MOVE 'A'       TAG                             S01310
     C                     MOVE @MTAG     MTAG                            S01310
     C**  Address 2                                                       S01435
     C                     MOVE *BLANKS   SAVMTG  5                       138077
     C           OFSPT2    IFNE *BLANKS                                   S01435
     C                     MOVE MTAG      SAVMTG                          138077
     C                     ADD  1         Q                               S01435
     C           Q         OCUR MULT                                      S01435
     C                     MOVELOFSPT2    MFLD                            S01435
     C                     END                                            S01435
     C                     EXSR SEXTN                                     138077
     C                     END                                            S01310
     C*                                                                   S01310
     C           OSTAG     IFEQ 'B'                                       S01310
     C                     MOVE 'B'       TAG                             S01310
     C                     MOVE @MTAG     MTAG                            S01310
     C                     END                                            S01310
      *                                                                   CFT014
     C           OSTAG     IFEQ 'C'                                       CFT014
     C                     MOVE 'C'       TAG                             CFT014
     C                     MOVE @MTAG     MTAG                            CFT014
     C                     ENDIF                                          CFT014
     C*                                                                   S01310
     C           OSTAG     IFEQ 'D'                                       S01310
     C                     MOVE 'D'       TAG                             S01310
     C                     MOVE @MTAG     MTAG                            S01310
     C**  Address 2                                                       S01310
     C           OFSPT2    IFNE *BLANKS                                   S01310
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     MOVELOFSPT2    MFLD                            S01310
     C**  Address 3                                                       S01310
     C           OFSPT3    IFNE *BLANKS                                   S01310
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     MOVELOFSPT3    MFLD                            S01310
     C**  Address 4                                                       S01310
     C           OFSPT4    IFNE *BLANKS                                   S01310
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     MOVELOFSPT4    MFLD                            S01310
     C**  Address 5                                                       S01310
     C           OFSPT5    IFNE *BLANKS                                   S01310
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     MOVELOFSPT5    MFLD                            S01310
     C                     END                             Address 5      S01310
     C                     END                             Address 4      S01310
     C                     END                             Address 3      S01310
     C                     END                             Address 2      S01310
     C                     END                             Address 1      S01310
      *                                                                   CFT014
     C           OSTAG     IFEQ 'K'                                       CFT014
      *                                                                   CFT014
     C                     MOVE 'K'       TAG                             CFT014
     C                     MOVE @MTAG     MTAG                            CFT014
      *                                                                                       CFT124
     C           CFT124    IFEQ 'Y'                                                           CFT124
     C           @MTAG     ANDEQ':50K:'                                                       CFT124
     C           ISPTP     ANDEQ'R'                                                           CFT124
     C           CFT124    OREQ 'Y'                                                           CFT124
     C           @MTAG     ANDEQ':50K:'                                                       CFT124
     C           ISPTP     ANDEQ'P'                                                           CFT124
      *                                                                                       CFT124
      ** Get account details if Partial Account                                               CFT124
      *                                                                                       CFT124
     C           ISPTP     IFEQ 'P'                                                           CFT124
     C                     MOVEL*BLANKS   DS@ORC                                              CFT124
     C                     MOVELISPTY1    DS@ORC                                              CFT124
     C           @ORBRC    IFEQ *BLANKS                                                       CFT124
     C                     MOVELBJSBRC    @ORBRC                                              CFT124
     C                     ENDIF                                                              CFT124
     C                     MOVELISCCY     @ORCCY  3                                           CFT124
     C                     CALL 'AOACCTR0'             9090                                   CFT124
     C                     PARM *BLANKS   @RTCD   7                                           CFT124
     C                     PARM '*KEY   ' @OPTN   7                                           CFT124
     C                     PARM *BLANKS   @RETL  10                                           CFT124
     C                     PARM @ORCNU    @CNUM   6                                           CFT124
     C                     PARM @ORCCY    @CUCD   3                                           CFT124
     C                     PARM @ORACD    @ACOD  10                                           CFT124
     C                     PARM @ORACS    @ACSQ   2                                           CFT124
     C                     PARM @ORBRC    @BRCA   3                                           CFT124
     C           OACCNT    PARM           DSSDY                                               CFT124
      *                                                                                       CFT124
     C           *IN90     IFEQ '1'                                                           CFT124
     C           @RTCD     ORNE *BLANKS                                                       CFT124
     C                     MOVEL'AOACCTR0'DBFNAM           ***************                    CFT124
     C                     MOVELISPTY1    DBERKY           * DB ERROR 56 *                    CFT124
     C                     MOVE '056'     DBERR#           ***************                    CFT124
     C                     EXSR DBERR                                                         CFT124
     C                     ENDIF                                                              CFT124
     C                     ENDIF                                                              CFT124
      *                                                                                       CFT124
     C                     MOVE *BLANKS   @@CNUM                                              CFT124
     C                     MOVE CNUM      @@CNUM                                              CFT124
     C                     MOVELCCY       @@CCY                                               CFT124
     C                     Z-ADDACOD      @@ACOD                                              CFT124
     C                     Z-ADDACSQ      @@ACSQ                                              CFT124
     C                     MOVELBRCA      @@BRCA                                              CFT124
     C                     MOVEL*BLANKS   @@ACNO 10                                           CFT124
     C                     MOVELACNO      @@ACNO                                              CFT124
     C                     MOVELWACCT     @@ACNO                                              CFT124
      *                                                                                       CFT124
     C           W#IBAN    IFEQ 'Y'                                                           CFT124
     C           W#RTNO    OREQ 'Y'                                                           CFT124
     C           W#GLAR    OREQ 'Y'                                                           CFT124
     C           W#ACNM    OREQ 'Y'                                                           CFT124
      *                                                                                       CFT124
s1   C           W#ACNM    IFEQ 'Y'                                                           CFT124
     C           '/'       CAT  ANAM:0    MFLD      P                                         CFT124
     C                     ADD  1         Q                                                   CFT124
x1   C                     ELSE                                                               CFT124
s2   C           W#IBAN    IFEQ 'Y'                                                           CFT124
s3   C           IBAN      IFEQ *BLANKS                                                       CFT124
s4   C           W#RTNO    IFEQ 'Y'                                                           CFT124
     C           ACNO      ANDNE0                                                             CFT124
     C           '/'       CAT  @@ACNO:0  MFLD      P                                         CFT124
     C                     ADD  1         Q                                                   CFT124
x4   C                     ELSE                                                               CFT124
s5   C           W#GLAR    IFEQ 'Y'                                                           CFT124
     C           '/'       CAT  DSACC:0   MFLD      P                                         CFT124
     C                     ADD  1         Q                                                   CFT124
e5   C                     ENDIF                                                              CFT124
e4   C                     ENDIF                                                              CFT124
x3   C                     ELSE                                                               CFT124
     C           '/'       CAT  IBAN:0    MFLD      P                                         CFT124
     C                     ADD  1         Q                                                   CFT124
e3   C                     ENDIF                                                              CFT124
x2   C                     ELSE                                                               CFT124
s3   C           W#RTNO    IFEQ 'Y'                                                           CFT124
s4   C           ACNO      ANDNE0                                                             CFT124
     C           '/'       CAT  @@ACNO:0  MFLD      P                                         CFT124
     C                     ADD  1         Q                                                   CFT124
x4   C                     ELSE                                                               CFT124
s5   C           W#GLAR    IFEQ 'Y'                                                           CFT124
     C           '/'       CAT  DSACC:0   MFLD      P                                         CFT124
     C                     ADD  1         Q                                                   CFT124
e5   C                     ENDIF                                                              CFT124
e3   C                     ENDIF                                                              CFT124
e2   C                     ENDIF                                                              CFT124
e1   C                     ENDIF                                                              CFT124
      *                                                                                       CFT124
     C           Q         OCUR MULT                                                          CFT124
      *                                                                                       CFT124
      ** Set second line to Address 1                                                         CFT124
      *                                                                                       CFT124
     C                     MOVELOFSPT1    MFLD                                                CFT124
      *                                                                                       CFT124
      ** Set Report fields (note 4th line of address not output)                              CFT124
      *                                                                                       CFT124
     C           '/'       CAT  ISPTY1:0  M1ORC1    P                                         CFT124
     C                     MOVELOFSPT1    M1ORC2                                              CFT124
     C                     MOVE OFSPT2    M1ORC3                                              CFT124
     C                     MOVE OFSPT3    M2ORC4                                              CFT124
     C                     ENDIF                                                              CFT124
      *                                                                                       CFT124
     C                     ENDIF                                                              CFT124
      *                                                                   CFT014
      ** Address 2                                                        CFT014
      *                                                                   CFT014
     C           OFSPT2    IFNE *BLANKS                                   CFT014
     C                     ADD  1         Q                               CFT014
     C           Q         OCUR MULT                                      CFT014
     C                     MOVELOFSPT2    MFLD                            CFT014
      *                                                                   CFT014
      ** Address 3                                                        CFT014
      *                                                                   CFT014
     C           OFSPT3    IFNE *BLANKS                                   CFT014
     C                     ADD  1         Q                               CFT014
     C           Q         OCUR MULT                                      CFT014
     C                     MOVELOFSPT3    MFLD                            CFT014
      *                                                                   CFT014
      ** Address 4                                                        CFT014
      *                                                                   CFT014
     C           OFSPT4    IFNE *BLANKS                                   CFT014
     C                     ADD  1         Q                               CFT014
     C           Q         OCUR MULT                                      CFT014
     C                     MOVELOFSPT4    MFLD                            CFT014
      *                                                                   CFT014
      ** Address 5                                                        CFT014
      *                                                                   CFT014
     C           OFSPT5    IFNE *BLANKS                                   CFT014
     C                     ADD  1         Q                               CFT014
     C           Q         OCUR MULT                                      CFT014
     C                     MOVELOFSPT5    MFLD                            CFT014
     C                     ENDIF                           Address 5      CFT014
     C                     ENDIF                           Address 4      CFT014
     C                     ENDIF                           Address 3      CFT014
     C                     ENDIF                           Address 2      CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
     C*                                                                   S01310
     C           OSTAG     IFEQ 'F'                                                           CSW207
     C           CSW207    ANDEQ'Y'                                                           CSW207
      *                                                                                       CSW207
     C                     MOVE 'F'       TAG                                                 CSW207
     C                     MOVE @MTAG     MTAG                                                CSW207
     C                     MOVE MTAG      SAVMTG    P                                       BUG14915
     C                     MOVELPMSGL1    MFLD                                               CSW207A
      * Address 2                                                                             CSW207
     C           PMSGL2    IFNE *BLANKS                                                       CSW207
     C                     ADD  1         Q                                                   CSW207
     C           Q         OCUR MULT                                                          CSW207
     C                     MOVELPMSGL2    MFLD                                                CSW207
      * Address 3                                                                             CSW207
     C           PMSGL3    IFNE *BLANKS                                                       CSW207
     C                     ADD  1         Q                                                   CSW207
     C           Q         OCUR MULT                                                          CSW207
     C                     MOVELPMSGL3    MFLD                                                CSW207
      * Address 4                                                                             CSW207
     C           PMSGL4    IFNE *BLANKS                                                       CSW207
     C                     ADD  1         Q                                                   CSW207
     C           Q         OCUR MULT                                                          CSW207
     C                     MOVELPMSGL4    MFLD                                                CSW207
      * Address 5                                                                             CSW207
     C           PMSGL5    IFNE *BLANKS                                                       CSW207
     C                     ADD  1         Q                                                   CSW207
     C           Q         OCUR MULT                                                          CSW207
     C                     MOVELPMSGL5    MFLD                                                CSW207
     C                     ENDIF                                                              CSW207
     C                     ENDIF                                                              CSW207
     C                     ENDIF                                                              CSW207
     C                     ENDIF                                                              CSW207
     C           PACCTP    IFNE 'A'                                                         BUG15045
     C           PACCTP    ANDNE'S'                                                         BUG15045
     C           PACCTP    ANDNE' '                                                         BUG15045
     C                     EXSR SEXTN                                                       BUG14915
     C                     ENDIF                                                            BUG15045
      *                                                                                       CSW207
     C                     ENDIF                                                              CSW207
      *                                                                                       CSW207
     C                     ENDSR                                          S01310
     C/EJECT                                                              S01310
     C************************************************************
     C* FIRST SR.
     C* FIRST CYCLE PROCESSING
     C*
     C           FIRST     BEGSR
     C/COPY WNCPYSRC,FT0641C053
     C*
      ** Save PRFP1 value of RECI as will be overwritten in initial processing                246371
      *                                                                                       246371
     C                     MOVE RECI      RECIX   1                                           246371
     C           *NAMVAR   DEFN           RUNDAT                          S01117
     C                     IN   RUNDAT                                    S01117
     C*                                                                   S01117
     C* IF MULTIBRANCH INDICATOR IS ACTIVE FROM RUNDAT                    S01117
     C*                                                                   S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C                     MOVE '1'       *IN50                           S01117
     C                     END                                            S01117
     C* MOVE REPORT NAME AND SPOOL FILE NBR TO ZSFILE AND CALL ZSFILE     S01117
     C                     Z-ADDSFNUM1    SPLNO                           S01117
     C                     MOVELSFILE1    SFILP                           S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           RSEQ    5                       S01117
     C                     PARM *BLANKS   RENT    3                       S01117
     C                     PARM           SFILP  10                       S01117
     C                     PARM           SPLNO   60                      S01117
     C                     PARM *BLANKS   ZERR    1                       S01117
     C*                                                                   S01117
     C* IF ERROR PERFORM DATABASE ERROR HANDLING AND EXIT PROGRAM         S01117
     C*                                                                   S01117
     C           ZERR      IFEQ 'Y'                                       S01117
     C                     SETON                     U7U8LR               S01117
     C           *LOCK     IN   DLDA                                      S01117
     C                     MOVEL'FT0641'  DBPGM            ***************S01117
     C                     MOVEL'FT0641P1'DBKEY            ** DBERR  27 **S01117
     C                     MOVEL'ZSFILE'  DBFILE           ***************S01117
     C                     Z-ADD27        DBASE                           S01117
     C                     OUT  DLDA                                      S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C* MOVE REPORT NAME AND SPOOL FILE NBR TO ZSFILE AND CALL ZSFILE     S01117
     C*                                                                   S01117
     C                     Z-ADDSFNUM2    SPLNO                           S01117
     C                     MOVELSFILE2    SFILP                           S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           RSEQ    5                       S01117
     C                     PARM *BLANKS   RENT    3                       S01117
     C                     PARM           SFILP  10                       S01117
     C                     PARM           SPLNO   60                      S01117
     C                     PARM *BLANKS   ZERR    1                       S01117
     C*                                                                   S01117
     C* IF ERROR PERFORM DATABASE ERROR HANDLING AND EXIT PROGRAM         S01117
     C*                                                                   S01117
     C           ZERR      IFEQ 'Y'                                       S01117
     C                     SETON                     U7U8LR               S01117
     C           *LOCK     IN   DLDA                                      S01117
     C                     MOVEL'FT0641'  DBPGM            ***************S01117
     C                     MOVEL'FT0641P2'DBKEY            ** DBERR  23 **S01117
     C                     MOVEL'ZSFILE'  DBFILE           ***************S01117
     C                     Z-ADD23        DBASE                           S01117
     C                     OUT  DLDA                                      S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C* MOVE AUDIT REPORT NAME AND SPOOL FILE NBR TO ZSFILE AND           S01117
     C* CALL ZSFILE                                                       S01117
     C                     Z-ADDSFNUMU    SPLNO                           S01117
     C                     MOVELSFILEU    SFILP                           S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           RSEQ    5                       S01117
     C                     PARM *BLANKS   RENT    3                       S01117
     C                     PARM           SFILP  10                       S01117
     C                     PARM           SPLNO   60                      S01117
     C                     PARM *BLANKS   ZERR    1                       S01117
     C*                                                                   S01117
     C* IF ERROR PERFORM DATABASE ERROR HANDLING AND EXIT PROGRAM         S01117
     C*                                                                   S01117
     C           ZERR      IFEQ 'Y'                                       S01117
     C                     SETON                     U7U8LR               S01117
     C           *LOCK     IN   DLDA                                      S01117
     C                     MOVEL'FT0641'  DBPGM            ***************S01117
     C                     MOVEL'FT0641AU'DBKEY            ** DBERR  24 **S01117
     C                     MOVEL'ZSFILE'  DBFILE           ***************S01117
     C                     Z-ADD24        DBASE                           S01117
     C                     OUT  DLDA                                      S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*    INITIALISE RECORD COUNTERS                                  ***
     C*********************Z-ADD0         P3NO1                           S01117
     C                     Z-ADD0         AUNO1                           S01117
     C*********************Z-ADD0         P3NO2                           S01117
     C*********************Z-ADD0         AUNO2                     S01117S01310
     C*********************Z-ADD0         P3NO3                           S01117
     C*********************Z-ADD0         AUNO3                     S01117S01310
     C                     Z-ADD0         PAGEP1
     C                     Z-ADD0         PAGEP2
     C/COPY WNCPYSRC,FT0641C026
     C*********************Z-ADD0         PAGEP3                          S01117
     C                     Z-ADD0         PAGEAU                          S01117
     C                     TIME           TIME    60
     C*                                                     **************
     C**   SET UP KEY AND ACCESS INSTALLATION CONTROL RECORD (TABTB10F)
     C                     MOVEL'01      'ZTABKY 12
     C                     MOVE '  10'    ZTABKY
     C**
     C           ZTABKY    CHAINTABFP                99    ON NOT THERE
     C  N99      RECI      COMP 'D'                  9999  ON, IS DELETED
     C*
     C           *IN99     IFEQ '1'                         ))))))))))))))
     C*********************MOVE 'TABFP'   DBFNAM  5         )))  DATA  )))S01310
     C                     MOVEL'TABFP'   DBFNAM  8         )))  DATA  )))S01310
     C                     MOVELZTABKY    DBERKY 39         )))  BASE  )))
     C                     MOVE '01'      DBERR#  2         ))) ERROR  )))
     C                     EXSR DBERR                       )))   01   )))
     C                     END                              ))))))))))))))
     C*
1492 C**   INSTALLATION CONTROL RECORD FOUND SO SAVE FIELDS
     C                     MOVE RUNA      SRUNA   7        SAVE ALPHA DATE
     C                     MOVE TITL      STITL  53        SAVE TITLE
     C*
1492 C**   SET UP KEY AND ACCESS INSTALLATION CONTROL RECORD (TABTB11F)
     C*
     C                     MOVE *BLANKS   ZTABKY
     C                     MOVEL'01'      ZTABKY
     C                     MOVE '11'      ZTABKY
     C           ZTABKY    CHAINTABFP                10
     C  N10      RECI      COMP 'D'                  1010
     C*
     C           *IN10     IFEQ '1'                         ))))))))))))))
     C*********************MOVE 'TABFP'   DBFNAM            )))  DATA  )))S01310
     C                     MOVEL'TABFP'   DBFNAM            )))  DATA  )))S01310
     C                     MOVELZTABKY    DBERKY            )))  BASE  )))
     C                     MOVE '02'      DBERR#            ))) ERROR  )))
     C                     EXSR DBERR                       )))   02   )))
     C                     END                              ))))))))))))))
     C*
1492 C**   INST. CONTROL RECORD FOUND SO SAVE CUST. NO. OF HEAD OFFICE
     C**********           Z-ADDHEAD      SHEAD   60       SAVE CUST NO OF                    CSD027
     C                     MOVE HEAD      SHEAD   6        SAVE CUST NO OF                    CSD027
     C*********************Z-ADDFTDB      SDFBR            SAVE BRANCH NUMS01117
     C*
     C****SET*UP*KEY*AND*ACCESS*INST.*CONTROL*REC*BRANCH*CODE*(TABLETR)*  S01117
     C*
     C*********************MOVEL'10    '  ZTABKY                          S01117
     C*********************MOVE SDFBR     ZTABKY                          S01117
     C***********ZTABKY****CHAINTABFP                10                   S01117
     C**N10******RECI******COMP 'D'                  1010  ON , DELETED   S01117
     C*********************                                               S01117
     C************IN10*****IFEQ '1'                         ))))))))))))))S01117
     C*********************MOVE 'TABFP'   DBFNAM            )))  DATA  )))S01117
     C*********************MOVELZTABKY    DBERKY            )))  BASE  )))S01117
     C*********************MOVE '03'      DBERR#            ))) ERROR  )))S01117
     C*********************EXSR DBERR                       )))   03   )))S01117
     C*********************END                              ))))))))))))))S01117
     C***SAVE*BRANCH*INTERNAL*CUSTOMER*NO.*                               S01117
     C*********************MOVE BICN      SBICN   60                      S01117
     C***SET*UP*KEY*TO*ACCESS*CLIENT*FILE.*                               S01117
     C*********************MOVE BICN      KCUSNO  60                      S01117
     C*********************MOVE 'A'       KEYA    1                       S01117
     C*********************                                               S01117
     C***ACCESS*CLIENT*FILE*                                              S01117
     C***********CUSKEY****CHAINCLINTCBF             80                   S01117
     C*********************                                               S01117
     C************IN80*****IFEQ '1'                         ))))))))))))))S01117
     C*********************MOVE 'TABFP'   DBFNAM            )))  DATA  )))S01117
     C*********************MOVEL'      A' DBERKY            )))  BASE  )))S01117
     C*********************MOVELKCUSNO    DBERKY            )))  BASE  )))S01117
     C*********************MOVE '04'      DBERR#            ))) ERROR  )))S01117
     C*********************EXSR DBERR                       )))   04   )))S01117
     C*********************END                              ))))))))))))))S01117
     **********************                                               S01117
     ****IN16*is*seton*if*Bit*'3'*of*CMIN*is*off*                         S01117
     C*********************                                               S01117
     C**************************************
     C*****REMOVE*TERMINAL*ID*             *                              S01117
     C**************************************
     C*********************                                               S01117
     C***MOVE*SWIFT*ADDRESS*IN*DATA*STRUCTURE*                            S01117
     C*********************MOVE CSID      SCSID                           S01117
     C***SAVE***'OUR*TID'*FIELD*IN*WORK*AREA*                             S01117
     C*********************MOVE SCSID     MXOSFT 12                       S01117
     C*********************MOVE TELX      MXOTLX 12                       S01117
     C***ACCESS*TO*SDBRCHL5                                         E22406S01310
     C*********************MOVE BICN      WWBICN  6                 E22406S01310
     C***********WWBICN****CHAINSDBRCHL5             09             E22406S01310
     C**N09******A8TYLC****COMP 'D'                      09         E22406S01310
     C*********************                                         E22406S01310
     C************IN09*****IFEQ '1'                         ))))))))E22406S01310
     C*********************MOVE 'SDBR5'   DBFNAM            )))  DATE22406S01310
     C*********************MOVELA8BICN    DBERKY            )))  BASE22406S01310
     C*********************MOVE '22'      DBERR#            ))) ERROE22406S01310
     C*********************EXSR DBERR                       )))   22E22406S01310
     C*********************END                              ))))))))E22406S01310
     C*********************                                         E22406S01310
     C*********************MOVE A8BTID    SCSID                     E22406S01310
     C*********************MOVE SCSID     MXOSFT 12                 E22406S01310
      *                                                                   CFT014
      ** Retrieve Bank ICD details.                                       CFT014
      *                                                                   CFT014
     C                     CALL 'AOBANKR0'                                CFT014
     C                     PARM *BLANKS   PRTCD   7                       CFT014
     C                     PARM '*FIRST'  POPTN   7                       CFT014
     C           SDBANK    PARM SDBANK    DSFDY                           CFT014
     C           PRTCD     IFNE *BLANKS                                   CFT014
     C                     MOVE '050'     DBERR#                          CFT014
     C                     MOVEL'*FIRST  'DBERKY                          CFT014
     C                     MOVEL'SDBANKPD'DBFNAM                          CFT014
     C                     EXSR DBERR                                     CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Retrieve GL ICD details.                                         CFT014
      *                                                                   CFT014
     C**********           CALL 'AOGELRR0'                                             CFT014 CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM *BLANKS   PRTCD                           CFT014
     C                     PARM '*FIRST'  POPTN                           CFT014
     C********** SDGELR    PARM SDGELR    DSFDY                                        CFT014 CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
     C           PRTCD     IFNE *BLANKS                                   CFT014
     C                     MOVE '039'     DBERR#                          CFT014
     C                     MOVEL'*FIRST  'DBERKY                          CFT014
     C                     MOVEL'SDGELRPD'DBFNAM                          CFT014
     C                     EXSR DBERR                                     CFT014
     C                     ENDIF                                          CFT014
      *                                                                   S01310
      **  Access SDMMODPD for networks available.                         S01310
      *                                                                   S01310
     C                     CALL 'AOMMODR0'                                S01310
     C                     PARM '*MSG   ' @RTCD                           S01310
     C                     PARM '*FIRST ' @OPTN                           S01310
     C           SDMMOD    PARM SDMMOD    DSFDY                           S01310
      *                                                                   S01310
      ** If no record is found on sdmmodpd.                               S01310
      *                                                                   S01310
     C           @RTCD     IFNE *BLANKS                                   S01310
     C                     MOVE '03'      DBERR#             * * * * * * *S01310
     C                     MOVEL'FIRST'   DBERKY             * DBERR 003 *S01310
     C                     MOVEL'SDMMODPD'DBFNAM             * * * * * * *S01310
     C                     EXSR DBERR                                     S01310
     C                     END                                            S01310
      *                                                                   S01310
      **  Access SDMGMEPD for drop SWIFT msg. no. days                    S01310
      *                                                                   S01310
     C                     CALL 'AOMGMER0'                                S01310
     C                     PARM '*MSG   ' @RTCD   7                       S01310
     C                     PARM '*FIRST ' @OPTN   7                       S01310
     C           SDMGME    PARM SDMGME    DSFDY                           S01310
      *                                                                   S01310
      ** If no record is found on SDMGMEPD.                               S01310
      *                                                                   S01310
     C           @RTCD     IFNE *BLANKS                                   S01310
     C                     MOVE '25'      DBERR#             * * * * * * *S01310
     C                     MOVEL'FIRST'   DBERKY             * DBERR 025 *S01310
     C                     MOVEL'SDMGMEPD'DBFNAM             * * * * * * *S01310
     C                     EXSR DBERR                                     S01310
     C                     END                                            S01310
      *                                                                   S01310
      **  Convert history retention date to YYMMDD                        S01310
      *                                                                   S01310
     C           RUND      ADD  ENDSMN    ZMDAY                           S01310
     C                     CALL 'ZM0060'               15                 S01310
     C                     PARM           ZMDAY                           S01310
     C                     PARM           ZMDATE                          S01310
      *                                                                   S01310
      ** If the program ends in error.                                    S01310
      *                                                                   S01310
     C           *IN15     IFEQ '1'                                       S01310
     C                     MOVE '26'      DBERR#             * * * * * * *S01310
     C                     MOVEL'       ' DBERKY             * DBERR 026 *S01310
     C                     MOVEL'ZM0060'  DBFNAM             * * * * * * *S01310
     C                     EXSR DBERR                                     S01310
     C                     END                                            S01310
     C                     MOVE ZMDATE    @HRDT   6                       S01310
      *                                                                   S01310
      **  Initialise constant fields                                      S01310
      *                                                                   S01310
     C                     MOVE *LOVAL    CR      1                       S01310
     C                     BITON'457'     CR                              S01310
     C                     MOVE *LOVAL    LF      1                       S01310
     C                     BITON'257'     LF                              S01310
     C                     MOVELCR        CRLF    2                       S01310
     C                     MOVE LF        CRLF                            S01310
     C                     MOVE ':'       COLON1                          S01310
     C                     MOVE ':'       COLON2                          S01310
      *                                                                   S01310
      **  CRLF Control Character for message data records                 S01310
      *                                                                   S01310
     C                     MOVE CRLF      CTRC                            S01310
      *                                                                   S01310
     C/COPY WNCPYSRC,FT0641C004
     C*  CHECK TYPE OF RUN
     C           IPPARM    IFEQ 'I'
     C                     SETON                     13
     C                     END
     C*  SET MESSAGE PRODUCTION PARAMETER
     C                     MOVE 'N'       OPPARM  1
     C*********************                                               S01310
     C***SET*UP*HEXADECIMAL VALUE OF X'0D25'                              S01310
     C*********************Z-ADD13        B0D                             S01310
     C*********************Z-ADD37        B25                             S01310
     C*********************MOVELX0D       X0D25                           S01310
     C*********************MOVE X25       X0D25                           S01310
      *                                                                   CEU006
      * Access SAR details to determine if EMU Settlement Details         CEU006
      * switched on (CEU006)                                              CEU006
     C                     CALL 'AOSARDR0'                                CEU006
     C                     PARM *BLANKS   @RTCD                           CEU006
     C                     PARM '*VERIFY' @OPTN                           CEU006
     C                     PARM 'CEU006'  @SARD   6                       CEU006
     C           SCSARD    PARM SCSARD    DSFDY                           CEU006
     C*                                                                   CEU006
     C** If core feature is switched ON, set a variable field to          CEU006
     C** condition the rest of the processing                             CEU006
     C*                                                                   CEU006
     C           @RTCD     IFEQ *BLANKS                                   CEU006
     C                     MOVE 'Y'       CEU006  1                       CEU006
     C                     ELSE                                           CEU006
     C*                                                                   CEU006
     C** else, database error (return code other than *NRF)               CEU006
     C*                                                                   CEU006
     C           @RTCD     IFNE '*NRF   '                                 CEU006
     C                     MOVEL'SCSARDPD'DBFNAM           ************   CEU006
     C                     MOVEL'*VERIFY' DBERKY           * DBERR 30 *   CEU006
     C                     MOVE '30'      DBERR#           ************   CEU006
     C                     EXSR DBERR                                     CEU006
     C                     END                                            CEU006
     C                     END                                            CEU006
     C/COPY WNCPYSRC,FT0641C046
      *                                                                   CEU006
      ** Access SAR details to determine if CMS006 is                                         CMS006
      ** switched on                                                                          CMS006
      *                                                                                       CMS006
     C                     CALL 'AOSARDR0'                                                    CMS006
     C                     PARM *BLANKS   @RTCD                                               CMS006
     C                     PARM '*VERIFY '@OPTN                                               CMS006
     C                     PARM 'CMS006'  @SARD                                               CMS006
     C           SCSARD    PARM SCSARD    DSFDY                                               CMS006
      *                                                                                       CMS006
     C           @RTCD     IFEQ *BLANKS                                                       CMS006
     C                     MOVE 'Y'       CMS006  1                                           CMS006
     C                     ELSE                                                               CMS006
     C                     MOVE 'N'       CMS006                                              CMS006
     C                     ENDIF                                                              CMS006
      *                                                                                       CMS006
      * Access SAR details to determine if SWIFT Decimal Places is        CSW020
      * switched on (CSW020)                                              CSW020
     C                     CALL 'AOSARDR0'                                CSW020
     C                     PARM *BLANKS   @RTCD                           CSW020
     C                     PARM '*VERIFY' @OPTN                           CSW020
     C                     PARM 'CSW020'  @SARD   6                       CSW020
     C           SCSARD    PARM SCSARD    DSFDY                           CSW020
     C*                                                                   CSW020
     C** If core feature is switched ON, set a variable field to          CSW020
     C** condition the rest of the processing                             CSW020
     C*                                                                   CSW020
     C           @RTCD     IFEQ *BLANKS                                   CSW020
     C                     MOVE 'Y'       CSW020  1                       CSW020
     C                     ELSE                                           CSW020
     C*                                                                   CSW020
     C** else, database error (return code other than *NRF)               CSW020
     C*                                                                   CSW020
     C           @RTCD     IFNE '*NRF   '                                 CSW020
     C                     MOVEL'SCSARDPD'DBFNAM           ************   CSW020
     C                     MOVEL'*VERIFY' DBERKY           * DBERR 32 *   CSW020
     C                     MOVE '32'      DBERR#           ************   CSW020
     C                     EXSR DBERR                                     CSW020
     C                     END                                            CSW020
     C                     END                                            CSW020
      *                                                                   CFT004
      * Access SAR details to determine if IBAN validation is             CFT004
      * switched on (CFT004)                                              CFT004
     C                     CALL 'AOSARDR0'                                CFT004
     C                     PARM *BLANKS   @RTCD                           CFT004
     C                     PARM '*VERIFY' @OPTN                           CFT004
     C                     PARM 'CFT004'  @SARD   6                       CFT004
     C           SCSARD    PARM SCSARD    DSFDY                           CFT004
     C*                                                                   CFT004
     C** If core feature is switched ON, set a variable field to          CFT004
     C** condition the rest of the processing                             CFT004
     C*                                                                   CFT004
     C           @RTCD     IFEQ *BLANKS                                   CFT004
     C                     MOVE 'Y'       CFT004  1                       CFT004
     C                     ELSE                                           CFT004
     C*                                                                   CFT004
     C** else, database error (return code other than *NRF)               CFT004
     C*                                                                   CFT004
     C           @RTCD     IFNE '*NRF   '                                 CFT004
     C                     MOVEL'SCSARDPD'DBFNAM           ************   CFT004
     C                     MOVEL'*VERIFY' DBERKY           * DBERR 29 *   CFT004
     C                     MOVE '29'      DBERR#           ************   CFT004
     C                     EXSR DBERR                                     CFT004
     C                     END                                            CFT004
     C                     END                                            CFT004
     C*                                                                   CFT004
      *                                                                                     BUG14771
      **Access*SAR*details*to*determine*if*IBAN*validation*is                      BUG14771 MD045920
      **switched*on*(CFT004)                                                       BUG14771 MD045920
     C**********           CALL 'AOSARDR0'                                         BUG14771 MD045920
     C**********           PARM *BLANKS   @RTCD                                    BUG14771 MD045920
     C**********           PARM '*VERIFY' @OPTN                                    BUG14771 MD045920
     C**********           PARM 'CFT032'  @SARD   6                                BUG14771 MD045920
     C********** SCSARD    PARM SCSARD    DSFDY                                    BUG14771 MD045920
     C*                                                                            BUG14771 MD045920
     C** If core feature is switched ON, set a variable field to                   BUG14771 MD045920
     C** condition the rest of the processing                                      BUG14771 MD045920
     C*                                                                            BUG14771 MD045920
     C********** @RTCD     IFEQ *BLANKS                                            BUG14771 MD045920
     C**********           MOVE 'Y'       CFT032  1                                BUG14771 MD045920
     C**********           ELSE                                                    BUG14771 MD045920
     C**********           MOVE 'N'       CFT032                                   BUG14771 MD045920
     C**********           END                                                     BUG14771 MD045920
     C*                                                                                     BUG14771
      *                                                                                       CSW207
      ** Check if SWIFT2007 is installed                                                      CSW207
      *                                                                                       CSW207
     C                     CALL 'SWIF2007'                                                    CSW207
     C                     PARM           @RTCD                                               CSW207
      *                                                                                       CSW207
     C           @RTCD     IFEQ 'CSW2007'                                                     CSW207
     C                     MOVE 'Y'       CSW207  1                                           CSW207
     C                     ELSE                                                               CSW207
     C                     MOVE 'N'       CSW207                                              CSW207
     C                     ENDIF                                                              CSW207
      *                                                                                       CSW207
      ** Check if SWIFT2009 is installed                                                      CSW209
      *                                                                                       CSW209
     C                     CALL 'SWIF2009'                                                    CSW209
     C                     PARM           @RTCD                                               CSW209
      *                                                                                       CSW209
     C           @RTCD     IFEQ 'CSW2009'                                                     CSW209
     C                     MOVE 'Y'       CSW209  1                                           CSW209
     C                     ELSE                                                               CSW209
     C                     MOVE 'N'       CSW209                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     MOVE 'N'       CFT014  1                       CFT014
     C                     CALL 'AOSARDR0'                                CFT014
     C                     PARM *BLANKS   PRTCD                           CFT014
     C                     PARM '*VERIFY' POPTN                           CFT014
     C                     PARM 'CFT014'  PSARD   6                       CFT014
     C           SCSARD    PARM SCSARD    DSFDY                           CFT014
     C           PRTCD     IFEQ *BLANKS                                   CFT014
     C                     MOVE 'Y'       CFT014                          CFT014
     C                     OPEN OTPAYXL2                                  CFT014
     C                     ELSE                                           CFT014
     C           PRTCD     IFNE '*NRF   '                                 CFT014
     C                     MOVE '040'     DBERR#                          CFT014
     C                     MOVEL'CFT014  'DBERKY                          CFT014
     C                     MOVEL'SCSARDPD'DBFNAM                          CFT014
     C                     EXSR DBERR                                     CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     CALL 'AOSARDR0'                                CFT014
     C                     PARM *BLANKS   PRTCD                           CFT014
     C                     PARM '*VERIFY' POPTN                           CFT014
     C                     PARM 'S01494'  PSARD                           CFT014
     C           SCSARD    PARM SCSARD    DSFDY                           CFT014
     C           PRTCD     IFEQ *BLANKS                                   CFT014
     C                     MOVE 'Y'       S01494  1                       CFT014
     C                     ELSE                                           CFT014
     C           PRTCD     IFNE '*NRF   '                                 CFT014
     C                     MOVE '041'     DBERR#                          CFT014
     C                     MOVEL'S01494  'DBERKY                          CFT014
     C                     MOVEL'SCSARDPD'DBFNAM                          CFT014
     C                     EXSR DBERR                                     CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     CALL 'AOSARDR0'                                CFT014
     C                     PARM *BLANKS   PRTCD                           CFT014
     C                     PARM '*VERIFY' POPTN                           CFT014
     C                     PARM 'S01499'  PSARD                           CFT014
     C           SCSARD    PARM SCSARD    DSFDY                           CFT014
     C           PRTCD     IFEQ *BLANKS                                   CFT014
     C                     MOVE 'Y'       S01499  1                       CFT014
     C                     ELSE                                           CFT014
     C           PRTCD     IFNE '*NRF   '                                 CFT014
     C                     MOVE '042'     DBERR#                          CFT014
     C                     MOVEL'S01499  'DBERKY                          CFT014
     C                     MOVEL'SCSARDPD'DBFNAM                          CFT014
     C                     EXSR DBERR                                     CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT009
      * Access SAR details to determine if Fees & Charges is              CFT009
      * switched on (CFT009)                                              CFT009
     C                     CALL 'AOSARDR0'                                CFT009
     C                     PARM *BLANKS   @RTCD                           CFT009
     C                     PARM '*VERIFY' @OPTN                           CFT009
     C                     PARM 'CFT009'  @SARD   6                       CFT009
     C           SCSARD    PARM SCSARD    DSFDY                           CFT009
      *                                                                   CFT009
      ** If core feature is switched ON, set a variable field to          CFT009
      ** condition the rest of the processing                             CFT009
      *                                                                   CFT009
     C           @RTCD     IFEQ *BLANKS                                   CFT009
     C                     MOVE 'Y'       CFT009  1                       CFT009
     C                     ELSE                                           CFT009
      *                                                                   CFT009
      ** else, database error (return code other than *NRF)               CFT009
      *                                                                   CFT009
     C                     MOVE 'N'       CFT009  1                       CFT009
      *                                                                   CFT009
     C           @RTCD     IFNE '*NRF   '                                 CFT009
     C                     MOVEL'SCSARDPD'DBFNAM           ************   CFT009
     C                     MOVEL'*VERIFY' DBERKY           * DBERR 40 *   CFT009
     C                     MOVE '40'      DBERR#           ************   CFT009
     C                     EXSR DBERR                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      * Access SAR details to determine if Fees & Charges with VAT is     CFT009
      * switched on (CFT010)                                              CFT009
     C                     CALL 'AOSARDR0'                                CFT009
     C                     PARM *BLANKS   @RTCD                           CFT009
     C                     PARM '*VERIFY' @OPTN                           CFT009
     C                     PARM 'CFT010'  @SARD   6                       CFT009
     C           SCSARD    PARM SCSARD    DSFDY                           CFT009
      *                                                                   CFT009
      ** If core feature is switched ON, set a variable field to          CFT009
      ** condition the rest of the processing                             CFT009
      *                                                                   CFT009
     C           @RTCD     IFEQ *BLANKS                                   CFT009
     C                     MOVE 'Y'       CFT010  1                       CFT009
     C                     ELSE                                           CFT009
      *                                                                   CFT009
      ** else, database error (return code other than *NRF)               CFT009
      *                                                                   CFT009
     C                     MOVE 'N'       CFT010  1                       CFT009
      *                                                                   CFT009
     C           @RTCD     IFNE '*NRF   '                                 CFT009
     C                     MOVEL'SCSARDPD'DBFNAM           ************   CFT009
     C                     MOVEL'*VERIFY' DBERKY           * DBERR 41 *   CFT009
     C                     MOVE '41'      DBERR#           ************   CFT009
     C                     EXSR DBERR                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                                       CSW201
      ** Check if switchable feature CSW201 is switched on                                    CSW201
      *                                                                                       CSW201
     C                     CALL 'SWIF2001'                                                    CSW201
     C                     PARM           @RTCD                                               CSW201
      *                                                                                       CSW201
     C           @RTCD     IFEQ 'CSW2001'                                                     CSW201
     C                     MOVE 'Y'       CSW201  1                                           CSW201
     C                     ELSE                                                               CSW201
     C                     MOVE 'N'       CSW201                                              CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW202
      ** Check if switchable feature CSW202 is switched on                                    CSW202
      *                                                                                       CSW202
     C                     CALL 'SWIF2002'                                                    CSW202
     C                     PARM *BLANKS   PRTCD                                               CSW202
      *                                                                                       CSW202
     C           PRTCD     IFEQ 'CSW2002'                                                     CSW202
     C                     MOVE 'Y'       CSW202  1                                           CSW202
     C                     ELSE                                                               CSW202
     C                     MOVE 'N'       CSW202                                              CSW202
     C                     ENDIF                                                              CSW202
      *                                                                                       CSW206
      ** Check if switchable feature CSW206 is switched on                                    CSW206
      *                                                                                       CSW206
     C                     CALL 'SWIF2006'                                                    CSW206
     C                     PARM *BLANKS   PRTCD                                               CSW206
      *                                                                                       CSW206
     C           PRTCD     IFEQ 'CSW2006'                                                     CSW206
     C                     MOVE 'Y'       CSW206  1                                           CSW206
     C                     ELSE                                                               CSW206
     C                     MOVE 'N'       CSW206                                              CSW206
     C                     ENDIF                                                              CSW206
      *                                                                                       CSW206
      ** Initialise WOPICD (working variable for instruction codes)                           CSW206
      *                                                                                       CSW206
     C                     MOVE *BLANKS   WOPICD  4                                           CSW206
      *                                                                   CEU006
      ** Access SAR file to determine if Midas Compliance Watch                               CSD015
      ** - Watch List Checking (CSD015) is installed                                          CSD015
      *                                                                                       CSD015
     C                     CALL 'AOSARDR0'                                                    CSD015
     C                     PARM *BLANKS   PRTCD                                               CSD015
     C                     PARM '*VERIFY' POPTN                                               CSD015
     C                     PARM 'CSD015'  PSARD                                               CSD015
     C           SCSARD    PARM SCSARD    DSFDY                                               CSD015
      *                                                                                       CSD015
      ** An NRF (No Record Found) return code is valid.                                       CSD015
      ** Issue database error only for error return codes.                                    CSD015
      *                                                                                       CSD015
     C           PRTCD     IFNE *BLANKS                                                       CSD015
     C           PRTCD     ANDNE'*NRF   '                                                     CSD015
     C                     MOVEL'SCSARDPD'DBFNAM                                              CSD015
     C                     MOVEL'*VERIFY' DBERKY                                              CSD015
     C                     MOVE '052'     DBERR#                                              CSD015
     C                     EXSR DBERR                                                         CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PRTCD     IFEQ *BLANK                                                        CSD015
     C                     MOVEL'Y'       CSD015  1                                           CSD015
      *                                                                                       222385
      ** Access AOWLCCR0 to check if function code MESSGENT is available                      222385
      *                                                                                       222385
     C                     CALL 'AOWLCCR0'                                                    222385
     C                     PARM *BLANKS   PRTCD                                               222385
     C                     PARM '*KEY'    POPTN                                               222385
     C                     PARM 'MESSGENT'PFUNC   8                                           222385
     C           SDWLCC    PARM SDWLCC    DSFDY                                               222385
      *                                                                                       222385
     C           PRTCD     IFNE *BLANKS                                                       222385
     C           PRTCD     ANDNE'*NRF'                                                        222385
     C                     MOVEL'SDWLCCPD'DBFNAM                                              222385
     C                     MOVELPFUNC     DBERKY                                              222385
     C                     MOVEL'32'      DBERR#                                              222385
     C                     EXSR *PSSR                                                         222385
     C                     ENDIF                                                              222385
      *                                                                                       222385
     C                     ELSE                                                               CSD015
     C                     MOVEL'N'       CSD015                                              CSD015
     C                     MOVEL'N'       W1EWLC                                              222385
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Access SAR file to determine if Midas Message                                        CSD015
      ** Manager (CSW025) is installed                                                        CSD015
      *                                                                                       CSD015
     C                     CALL 'AOSARDR0'                                                    CSD015
     C                     PARM *BLANKS   PRTCD                                               CSD015
     C                     PARM '*VERIFY' POPTN                                               CSD015
     C                     PARM 'CSW025'  PSARD                                               CSD015
     C           SCSARD    PARM SCSARD    DSFDY                                               CSD015
      *                                                                                       CSD015
      ** An NRF (No Record Found) return code is valid.                                       CSD015
      ** Issue database error only for error return codes.                                    CSD015
      *                                                                                       CSD015
     C           PRTCD     IFNE *BLANKS                                                       CSD015
     C           PRTCD     ANDNE'*NRF   '                                                     CSD015
     C                     MOVEL'SCSARDPD'DBFNAM                                              CSD015
     C                     MOVEL'CSW025'  DBERKY                                              CSD015
     C                     MOVE '057'     DBERR#                                              CSD015
     C                     EXSR DBERR                                                         CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PRTCD     IFEQ *BLANK                                                        CSD015
     C                     MOVEL'Y'       CSW025  1                                           CSD015
     C                     ELSE                                                               CSD015
     C                     MOVEL'N'       CSW025                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSW203
      ** Check if switchable feature CSW203 is switched on                                    CSW203
      *                                                                                       CSW203
     C                     CALL 'SWIF2003'                                                    CSW203
     C                     PARM *BLANKS   PRTCD                                               CSW203
      *                                                                                       CSW203
     C           PRTCD     IFEQ 'CSW2003'                                                     CSW203
     C                     MOVE 'Y'       CSW203  1                                           CSW203
     C                     ELSE                                                               CSW203
     C                     MOVE 'N'       CSW203                                              CSW203
     C                     ENDIF                                                              CSW203
      *                                                                                       204225
      ** Access SAR file to determine if CSW024 is installed.                                 204225
      *                                                                                       204225
     C                     CALL 'AOSARDR0'                                                    204225
     C                     PARM *BLANKS   PRTCD                                               204225
     C                     PARM '*VERIFY' POPTN                                               204225
     C                     PARM 'CSW024'  PSARD                                               204225
     C           SCSARD    PARM SCSARD    DSFDY                                               204225
      *                                                                                       204225
      ** An NRF (No Record Found) return code is valid.                                       204225
      ** Issue database error only for error return codes.                                    204225
      *                                                                                       204225
     C           PRTCD     IFNE *BLANKS                                                       204225
     C           PRTCD     ANDNE'*NRF   '                                                     204225
     C                     MOVEL'SCSARDPD'DBFNAM           ************                       204225
     C                     MOVEL'CSW024'  DBERKY           * DBERR 65 *                       204225
     C                     MOVE '65'      DBERR#           ************                       204225
     C                     EXSR DBERR                                                         204225
     C                     ENDIF                                                              204225
      *                                                                                       204225
     C           PRTCD     IFEQ *BLANKS                                                       204225
     C                     MOVEL'Y'       CSW024  1                                           204225
     C                     ELSE                                                               204225
     C                     MOVEL'N'       CSW024                                              204225
     C                     ENDIF                                                              204225
      *                                                                                     MD048075
     C                     CALL 'AOSVALR0'                                                  MD048075
     C                     PARM *BLANKS   @RTCD                                             MD048075
     C                     PARM SVAL,2    P@OP01                                            MD048075
     C                     PARM *BLANKS   P@VL01                                            MD048075
     C                     PARM *BLANKS   P@OP02                                            MD048075
     C                     PARM *BLANKS   P@VL02                                            MD048075
     C                     PARM *BLANKS   P@OP03                                            MD048075
     C                     PARM *BLANKS   P@VL03                                            MD048075
     C                     PARM *BLANKS   P@OP04                                            MD048075
     C                     PARM *BLANKS   P@VL04                                            MD048075
     C                     PARM *BLANKS   P@OP05                                            MD048075
     C                     PARM *BLANKS   P@VL05                                            MD048075
     C                     PARM *BLANKS   P@OP06                                            MD048075
     C                     PARM *BLANKS   P@VL06                                            MD048075
     C                     PARM *BLANKS   P@OP07                                            MD048075
     C                     PARM *BLANKS   P@VL07                                            MD048075
     C                     PARM *BLANKS   P@OP08                                            MD048075
     C                     PARM *BLANKS   P@VL08                                            MD048075
     C                     PARM *BLANKS   P@OP09                                            MD048075
     C                     PARM *BLANKS   P@VL09                                            MD048075
     C                     PARM *BLANKS   P@OP10                                            MD048075
     C                     PARM *BLANKS   P@VL10                                            MD048075
      *                                                                                     MD048075
     C           @RTCD     IFNE *BLANKS                                                     MD048075
     C                     MOVE '057'     DBERR#                                            MD048075
     C                     MOVELSVAL,2    DBERKY                                            MD048075
     C                     MOVEL'SDSVALPD'DBFNAM                                            MD048075
     C                     EXSR DBERR                                                       MD048075
     C                     ELSE                                                             MD048075
      ** If FTAllowFld50F = 'Y', allow Tag 50F                                              MD048075
     C                     MOVELP@VL01    ALW50F  1                                         MD048075
     C                     ENDIF                                                            MD048075
      *                                                                                       CSW213
      ** Check if SWIFT Changes 2013 (CSW213) is installed                                    CSW213
      *                                                                                       CSW213
     C                     CALL 'SWIF2013'                                                    CSW213
     C                     PARM *BLANKS   @RTCD                                               CSW213
      *                                                                                       CSW213
     C           @RTCD     IFEQ 'CSW2013'                                                     CSW213
     C                     MOVE 'Y'       CSW213  1                                           CSW213
     C                     ELSE                                                               CSW213
     C                     MOVE 'N'       CSW213                                              CSW213
     C                     ENDIF                                                              CSW213
      *                                                                                       204225
      *                                                                                       CSD015
     C/COPY WNCPYSRC,FT0641C062
      ** Check for switchable feature                                                         CFT023
      *                                                                                       CFT023
     C                     CALL 'AOSARDR0'                                                    CFT023
     C                     PARM *BLANKS   @RTCD                                               CFT023
     C                     PARM '*VERIFY' @OPTN                                               CFT023
     C                     PARM 'CFT023'  @SARD   6                                           CFT023
     C           SCSARD    PARM SCSARD    DSFDY                                               CFT023
      *                                                                                       CFT023
     C           @RTCD     IFEQ *BLANKS                                                       CFT023
     C                     MOVE 'Y'       CFT023  1                                           CFT023
     C                     ELSE                                                               CFT023
     C                     MOVE 'N'       CFT023                                              CFT023
     C                     ENDIF                                                              CFT023
      *                                                                                       CFT023
      ** Key list for FTGSWXPD                                                                CFT023
      *                                                                                       CFT023
     C           KYGSWX    KLIST                                                              CFT023
     C                     KFLD           KCSTY   1                                           CFT023
     C                     KFLD           KCSID   8                                           CFT023
      *                                                                                       CFT023
     C           TAGEND    TAG                              TAG: TAGEND
     C                     SETON                     40     1ST CYCLE DONE
      *                                                                                       CFT032
      ** Access SAR details to see if CFT004 is enabled.                                      CFT032
      *                                                                                       CFT032
     C                     CALL 'AOSARDR0'                                                    CFT032
     C                     PARM *BLANKS   @RTCD                                               CFT032
     C                     PARM '*VERIFY' @OPTN                                               CFT032
     C                     PARM 'CFT004'  @SARD                                               CFT032
     C           SCSARD    PARM SCSARD    DSFDY                                               CFT032
     C           @RTCD     IFNE *BLANKS                                                       CFT032
     C           @RTCD     ANDNE'*NRF   '                                                     CFT032
     C                     MOVEL'CFT004'  DBERKY                                              CFT032
     C                     MOVEL'SCSARDPD'DBFNAM                                              CFT032
     C                     MOVE '71'      DBERR#                                              CFT032
     C                     EXSR DBERR                                                         CFT032
     C                     ENDIF                                                              CFT032
      *                                                                                       CFT032
     C           @RTCD     IFEQ *BLANKS                                                       CFT032
     C                     MOVEL'Y'       CFT004  1                                           CFT032
     C                     ELSE                                                               CFT032
     C                     MOVEL'N'       CFT004                                              CFT032
     C                     ENDIF                                                              CFT032
      *                                                                                       CFT124
      ** Access SAR file to determine if CFT124 is installed                                  CFT124
      *                                                                                       CFT124
     C                     CALL 'AOSARDR0'                                                    CFT124
     C                     PARM *BLANKS   PRTCD                                               CFT124
     C                     PARM '*VERIFY' POPTN                                               CFT124
     C                     PARM 'CFT124'  PSARD                                               CFT124
     C           SCSARD    PARM SCSARD    DSFDY                                               CFT124
      *                                                                                       CFT124
     C           PRTCD     IFNE *BLANKS                                                       CFT124
     C           PRTCD     ANDNE'*NRF   '                                                     CFT124
     C                     MOVEL'SCSARDPD'DBFNAM                                              CFT124
     C                     MOVEL'*VERIFY' DBERKY                                              CFT124
     C                     MOVE '054'     DBERR#                                              CFT124
     C                     EXSR DBERR                                                         CFT124
     C                     ENDIF                                                              CFT124
      *                                                                                       CFT124
     C           PRTCD     IFEQ *BLANKS                                                       CFT124
     C                     MOVE 'Y'       CFT124  1                                           CFT124
     C                     ELSE                                                               CFT124
     C                     MOVE 'N'       CFT124                                              CFT124
     C                     ENDIF                                                              CFT124
      *                                                                                       CFT124
      ** Access MT10350K* system values if CFT124 is installed                                CFT124
      *                                                                                       CFT124
     C           CFT124    IFEQ 'Y'                                                           CFT124
     C                     MOVE *BLANKS   P@OP01                                            MD048075
     C                     MOVELSVIBAN    P@OP01                                              CFT124
     C                     MOVELSVRENO    P@OP02                                              CFT124
     C                     MOVELSVGLRF    P@OP03                                              CFT124
     C                     MOVELSVACNM    P@OP04                                              CFT124
     C                     MOVELSVCADD    P@OP05                                              CFT124
     C                     MOVELSVCTAX    P@OP06                                              CFT124
     C                     MOVELSVAFMT    P@OP07                                              CFT124
      *                                                                                       CFT124
     C                     CALL 'AOSVALR0'                                                    CFT124
     C                     PARM *BLANKS   @RTCD                                               CFT124
     C                     PARM           P@OP01 20                                           CFT124
     C                     PARM           P@VL01200                                           CFT124
     C                     PARM           P@OP02 20                                           CFT124
     C                     PARM           P@VL02200                                           CFT124
     C                     PARM           P@OP03 20                                           CFT124
     C                     PARM           P@VL03200                                           CFT124
     C                     PARM           P@OP04 20                                           CFT124
     C                     PARM           P@VL04200                                           CFT124
     C                     PARM           P@OP05 20                                           CFT124
     C                     PARM           P@VL05200                                           CFT124
     C                     PARM           P@OP06 20                                           CFT124
     C                     PARM           P@VL06200                                           CFT124
     C                     PARM           P@OP07 20                                           CFT124
     C                     PARM           P@VL07200                                           CFT124
     C                     PARM *BLANKS   P@OP08 20                                           CFT124
     C                     PARM *BLANKS   P@VL08200                                           CFT124
     C                     PARM *BLANKS   P@OP09 20                                           CFT124
     C                     PARM *BLANKS   P@VL09200                                           CFT124
     C                     PARM *BLANKS   P@OP10 20                                           CFT124
     C                     PARM *BLANKS   P@VL10200                                           CFT124
      *                                                                                       CFT124
     C           @RTCD     IFNE *BLANKS                                                       CFT124
     C                     MOVE '055'     DBERR#                                              CFT124
     C                     MOVEL'CFT124'  DBERKY                                              CFT124
     C                     MOVEL'SDSVALPD'DBFNAM                                              CFT124
     C                     EXSR DBERR                                                         CFT124
     C                     ELSE                                                               CFT124
     C                     MOVELP@VL01    W#IBAN  1                                           CFT124
     C                     MOVELP@VL02    W#RTNO  1                                           CFT124
     C                     MOVELP@VL03    W#GLAR  1                                           CFT124
     C                     MOVELP@VL04    W#ACNM  1                                           CFT124
     C                     MOVELP@VL05    W#CADD  1                                           CFT124
     C                     MOVELP@VL06    W#CTAX  1                                           CFT124
     C                     MOVELP@VL07    W#AFMT  1                                           CFT124
     C                     ENDIF                                                              CFT124
      *                                                                                       CFT124
     C                     ENDIF                                                              CFT124
      *                                                                                       CFT124
     C/COPY WNCPYSRC,FTH00294
      *                                                                                       CSW215
      ** Check if switchable feature CSW215 is switched on                                    CSW215
      *                                                                                       CSW215
     C                     CALL 'SWIF2015'                                                    CSW215
     C                     PARM *BLANKS   PRTCD                                               CSW215
      *                                                                                       CSW215
     C           PRTCD     IFEQ 'CSW2015'                                                     CSW215
     C                     MOVE 'Y'       CSW215  1                                           CSW215
     C                     ELSE                                                               CSW215
     C                     MOVE 'N'       CSW215                                              CSW215
     C                     ENDIF                                                              CSW215
      *                                                                                       CSW218
      ** Check if switchable feature CSW218 is switched on                                    CSW218
      *                                                                                       CSW218
     C                     CALL 'SWIF2018'                                                    CSW218
     C                     PARM *BLANKS   PRTCD                                               CSW218
      *                                                                                       CSW218
     C           PRTCD     IFEQ 'CSW2018'                                                     CSW218
     C                     MOVEL'Y'       CSW218  1                                           CSW218
     C                     ELSE                                                               CSW218
     C                     MOVEL'N'       CSW218                                              CSW218
     C                     ENDIF                                                              CSW218
      *                                                                                       CSW218
     C           KYINCM    KLIST                                                              CSW218
     C                     KFLD           OPMSGR                                              CSW218
     C                     KFLD           WTAG12  5                                           CSW218
      *                                                                                       CFT032
      ** Restore value of RECI which was overwritten during initial processing                246371
      *                                                                                       246371
     C                     MOVE RECIX     RECI                                                246371
     C/COPY WNCPYSRC,FTH00569
     C                     ENDSR
     C/EJECT                                                              S01117
     C*****************************************************************   S01117
     C*   SUBROUTINE BRANCH                                   *           S01117
     C*     TO VALIDATE EACH BOOKING BRANCH FOR EVERY RECORD  *           S01117
     C*     CALLED BY MAIN PROCESSING                         *           S01117
     C*********************************************************           S01117
     C*                                                                   S01117
     C           BRANCH    BEGSR                                          S01117
     C*   SAVE BOOKING BRANCH (BRCA) READ FROM OTPAYDD FILE               S01117
     C                     MOVE BRCA      BRCAA   3                       S01117
     C*   SET UP KEY AND ACCESS INST. CONTROL REC BRANCH CODE (TABLETR)   S01117
     C*                                                                   S01117
     C**********           MOVEL'10    '  ZTABKY                                     S01117 BUG13528
     C**********           MOVE BRCA      ZTABKY                                     S01117 BUG13528
     C********** ZTABKY    CHAINTABFP                10                              S01117 BUG13528
     C**N10***** RECI      COMP 'D'                  1010  ON , DELETED              S01117 BUG13528
     C**********                                                                     S01117 BUG13528
     C********** *IN10     IFEQ '1'                         ))))))))))))))           S01117 BUG13528
     C*********************MOVE 'TABFP'   DBFNAM            )))  DATS01117           S01310 BUG13528
     C**********           MOVEL'TABFP'   DBFNAM            )))  DATS01117           S01310 BUG13528
     C**********           MOVELZTABKY    DBERKY            )))  BASE  )))           S01117 BUG13528
     C**********           MOVE '03'      DBERR#            ))) ERROR  )))           S01117 BUG13528
     C**********           EXSR DBERR                       )))   03   )))           S01117 BUG13528
     C**********           END                              ))))))))))))))           S01117 BUG13528
     C**********                                                                     S01117 BUG13528
     C*  SAVE BRANCH INTERNAL CUSTOMER NO.                                S01117
     C**********           MOVE BICN      SBICN   60                                   S01117 CSD027
     C**********           MOVE BICN      SBICN   6                                  CSD027 BUG13528
     C***SET*UP*KEY*TO*ACCESS CLIENT FILE.                          S01117S01310
     C*********************MOVE BICN      KCUSNO  60                S01117S01310
     C*********************MOVE 'A'       KEYA    1                 S01117S01310
     C*********************                                         S01117S01310
     C***ACCESS*CLIENT*FILE                                         S01117S01310
     C***********BICN******CHAINCLINTCBF             80             S01117S01310
     C************IN80*****IFEQ '1'                         ))))))))S01117S01310
     C*********************MOVE 'TABFP'   DBFNAM            )))  DATS01117S01310
     C*********************MOVEL'      A' DBERKY            )))  BASS01117S01310
     C*********************MOVELBICN      DBERKY            )))  BASS01110S01310
     C*********************MOVE '04'      DBERR#            ))) ERROS01117S01310
     C*********************EXSR DBERR                       )))   04S01117S01310
     C*********************END                              ))))))))S01117S01310
      *                                                                                     BUG13528
      ** Access SDBRCHPD instead of TABLETR using Branch Code as record key                 BUG13528
      *                                                                                     BUG13528
     C                     MOVELBRCA      WWBRCA  3                                         BUG13528
     C           WWBRCA    CHAINSDBRCHL1             10                                     BUG13528
     C  N10      A8TYLC    COMP 'D'                      10  IF *IN10 IS ON (DELETED)       BUG13528
      *                                                                                     BUG13528
     C           *IN10     IFEQ *ON                                                         BUG13528
     C                     MOVEL'SDBRCHL1'DBFNAM                                            BUG13528
     C                     MOVELWWBRCA    DBERKY                                            BUG13528
     C                     MOVE '22'      DBERR#                                            BUG13528
     C                     EXSR DBERR                                                       BUG13528
     C                     ENDIF                                                            BUG13528
     C                     MOVE A8BICN    SBICN   6                                         BUG13528
     C                     MOVE A8BTID    SNCSID                                            BUG13528
     C                     MOVE A8BTID    SCSID                                             BUG13528
     C                     MOVE SCSID     MXOSFT 12                                         BUG13528
      *                                                                   S01310
      **  Access SDCUSTPD using branch internal customer number           S01310
      *                                                                   S01310
     C                     MOVE *BLANKS   @KEY1                           S01310
     C**********           MOVELBICN      @KEY1                                      S01310 BUG13528
     C                     MOVELA8BICN    @KEY1                                             BUG13528
     C                     CALL 'AOCUSTR0'                                S01310
     C                     PARM '*MSG   ' @RTCD                           S01310
     C                     PARM '*KEY   ' @OPTN                           S01310
     C                     PARM           @KEY1  10                       S01310
     C                     PARM *BLANKS   @KYST   7                       S01310
     C           SDCUST    PARM SDCUST    DSSDY                           S01310
      *                                                                   S01310
      ** Customer record not found - Error                                S01310
      *                                                                   S01310
     C           @RTCD     IFNE *BLANKS                                   S01310
     C********** CSW207    ANDNE'Y'                                                   CSW207A 250600
     C                     MOVE '21'      DBERR#             * * * * * * *S01310
     C                     MOVEL@KEY1     DBERKY             * DBERR 021 *S01310
     C                     MOVEL'SDCUSTPD'DBFNAM             * * * * * * *S01310
     C                     EXSR DBERR                                     S01310
     C                     END                                            S01310
      *                                                                   S01310
      **  Save sender's addresses & parent customer number                S01310
      *                                                                   S01310
     C           @RTCD     IFEQ *BLANKS                                                      CSW207A
     C***********          MOVE BBCSID    SNCSID 12                 S01310064393
     C                     MOVE BBTXA1    STELX  10                       S01310
     C                     MOVE BBSTAD    SSTTX  12                       S01310
     C                     MOVE BBCRNM    SCRNM  20                       S01310
      *                                                                   S01310
      ** Move new field names to old to ensure pgm continuity.            S01310
      *                                                                   S01310
     C                     MOVE BBCSID    CSID   12                       S01310
     C                     MOVELBBTXA1    TELX   12                       S01310
     **                                                                   S01117
     ** *IN16 is seton if Bit '3' of CMIN is off                          S01117
     C*                                                                   S01117
     C**************************************                              S01117
     C*    REMOVE TERMINAL ID              *                              S01117
     C**************************************                              S01117
     C*                                                                   S01117
     C*  SAVE   'OUR TID' FIELD IN WORK AREA                              S01117
     C                     MOVE TELX      MXOTLX 12                       S01117
     C** ACCESS TO SDBRCHL5                                               S01310
     C**********           MOVE BICN      WWBICN  6                                  S01310 BUG13528
     C********** WWBICN    CHAINSDBRCHL5             09                              S01310 BUG13528
     C**N09***** A8TYLC    COMP 'D'                      09                          S01310 BUG13528
     C**********                                                                     S01310 BUG13528
     C********** *IN09     IFEQ '1'                         ))))))))))))))           S01310 BUG13528
     C**********           MOVEL'SDBRCHL5'DBFNAM            )))  DATA  )))           S01310 BUG13528
     C**********           MOVELA8BICN    DBERKY            )))  BASE  )))           S01310 BUG13528
     C**********           MOVE '22'      DBERR#            ))) ERROR  )))           S01310 BUG13528
     C**********           EXSR DBERR                       )))   22   )))           S01310 BUG13528
     C**********           END                              ))))))))))))))           S01310 BUG13528
     C**********                                                                     S01310 BUG13528
     C**********           MOVE A8BTID    SNCSID                                     064393 BUG13528
     C**********           MOVE A8BTID    SCSID                                      S01310 BUG13528
     C**********           MOVE SCSID     MXOSFT 12                                  S01310 BUG13528
     C                     ENDIF                                                             CSW207A
     C                     ENDSR                                          S01117
     C/EJECT
4630 C********************************************************************
     C********************************************************************
     C********************************************************************
     C*     *         SUBROUTINE 01                         ***        ***
     C*     *   TO FORMAT SETTLEMENT PARTY TO SWIFT FORMAT  ***        ***
     C*     *                                               ***        ***
     C*********************************************************        ***
     C           SR01      BEGSR                            ***        ***
      *                                                                                       CFT032
     C           ISPTP     IFEQ 'I'                                                           CFT032
     C           CFT004    ANDEQ'Y'                                                           CFT032
      *                                                                                       CFT032
     C                     MOVELISPTY1    P@IBAN                                              CFT032
     C                     CALL 'AOIBANR4'                                                    CFT032
     C                     PARM *BLANKS   @RTCD                                               CFT032
     C                     PARM '*KEY   ' @OPTN                                               CFT032
     C                     PARM           P@IBAN 34                                           CFT032
     C           OACCNT    PARM           DSSDY                                               CFT032
      *                                                                                       CFT032
     C           @RTCD     IFEQ *BLANKS                                                       CFT032
     C                     MOVELCNUM      CUSTNO                                              CFT032
     C                     ENDIF                                                              CFT032
      *                                                                                       CFT032
     C                     ENDIF                                                              CFT032
      *                                                                                       CFT032
     C*   INITIALISE OUTPUT PARAMETER FIELDS                           ***
     C                     MOVE *BLANKS   OFSPT1 35
     C                     MOVE *BLANKS   OFSPT2 35
     C                     MOVE *BLANKS   OFSPT3 35
     C                     MOVE *BLANKS   OFSPT4 35
     C                     MOVE *BLANKS   OFSPT5 35
     C                     MOVE *BLANKS   OSTAG   1
     C                     MOVE 'N'       OSUFLG  1
     C                     MOVE *BLANKS   CSID                            E21462
      *                                                                                       250600
     C           ISPTP     IFEQ 'O'                                                           250600
      *                                                                                       250600
      ** Access SDNAHOPD                                                                      250600
      *                                                                                       250600
     C                     MOVELISPTY1    @KEY1                                               250600
     C                     CALL 'AONAHOR0'                                                    250600
     C                     PARM *BLANKS   @RTCD                                               250600
     C                     PARM '*KEY'    @OPTN                                               250600
     C                     PARM           @KEY1                                               250600
     C********** SDNAHO    PARM SDNAHO    DSSDY                                      250600 BUG24029
     C           SDNAHO    PARM SDNAHO    DSLDY                                             BUG24029
      *                                                                                       250600
      ** Record not found - Error                                                             250600
      *                                                                                       250600
     C           @RTCD     IFEQ *BLANKS                                                       250600
     C                     MOVELISPTY1    PNAHO                                               250600
     C                     MOVE *BLANKS   CSID                                                250600
     C                     MOVELNHCNA1    BBCNA1                                              250600
     C                     MOVELNHCNA2    BBCNA2                                              250600
     C                     MOVELNHCNA3    BBCNA3                                              250600
     C                     MOVELNHCNA4    BBCNA4                                              250600
     C                     MOVELNHNARN    CRNM                                                250600
     C                     MOVELNHNATW    CTWN                                                250600
     C                     ELSE                                                               250600
     C                     MOVEL*BLANKS   PNAHO                                               250600
     C                     MOVEL*BLANKS   PACCTP                                              250600
     C                     MOVEL*BLANKS   BBCNA1                                              250600
     C                     MOVEL*BLANKS   BBCNA2                                              250600
     C                     MOVEL*BLANKS   BBCNA3                                              250600
     C                     MOVEL*BLANKS   BBCNA4                                              250600
     C                     ENDIF                                                              250600
      *                                                                                       250600
     C                     MOVELBBCNA1    OFSPT1                                              250600
     C                     MOVELBBCNA2    OFSPT2                                              250600
     C                     MOVELBBCNA3    OFSPT3                                              250600
     C                     MOVELBBCNA4    OFSPT4                                              250600
     C                     MOVEL*BLANKS   OFSPT5                                              250600
     C                     MOVE 'D'       OSTAG                                               250600
     C                     EXSR EMBLK                                                         250600
     C                     GOTO SR01N                                                         250600
     C                     ENDIF                                                              250600
      *                                                                                       250600
     C*                                                                ***
     C*   FULL NOSTRO PROCESSING - APPEND THE RECEIVE CURRENCY TO THE  ***
     C*   FIRST SETTLEMENT PARTY FIELD TO ACCESS NOSTRO DET FROM
     C*   PF/TABLETL TO OBTAIN CUST NO.                                ***
     C           ISPTP     IFEQ 'F'
     C                     MOVELISPTY1    TLCCNN  5        BUILD
     C                     MOVEL'70'      TABTLK 12           KEY
     C                     MOVE TLCCNN    TABTLK 12            KEY
     C           TABTLK    CHAINTABFP                10    ON, DELETED
     C           *IN10     IFEQ '1'                         ))))))))))))))
     C*********************MOVE 'TABFP'   DBFNAM  5         )))  DATA  )))S01310
     C                     MOVEL'TABFP'   DBFNAM            )))  DATA  )))S01310
     C                     MOVELTABTLK    DBERKY 39         )))  BASE  )))
     C                     MOVE '06'      DBERR#  2         ))) ERROR  )))
     C                     EXSR DBERR                       )))   06   )))
     C                     END                              ))))))))))))))
     C**********           MOVE CNUM      CUSTNO  60                                          CSD027
     C                     MOVE CNUM      CUSTNO  6                                           CSD027
     C                     END
     C*                                                                ***
     C*   NOSTRO NO. PROCESSING - APPEND THE RECEIVE CURRENCY TO THE   ***
     C*   FIRST 2 CHARS OF THE 1ST SETL PTY FIELD TO ACCESS NOSTRO DET
     C*   FROM PF/TABLETL TO OBTAIN CUST NO.                           ***
     C           ISPTP     IFEQ 'N'
     C                     MOVELISPTY1    TLNN    2        BUILD
     C                     MOVELISCCY     TLCCNN             KEY
     C                     MOVE TLNN      TLCCNN              KEY
     C                     MOVEL'70'      TABTLK                KEY
     C                     MOVE TLCCNN    TABTLK 12              KEY
     C           TABTLK    CHAINTABFP                10    ON, DELETED
     C           *IN10     IFEQ '1'                         ))))))))))))))
     C*********************MOVE 'TABFP'   DBFNAM  5         )))  DATA  )))S01310
     C                     MOVEL'TABFP'   DBFNAM            )))  DATA  )))S01310
     C                     MOVELTABTLK    DBERKY 39         )))  BASE  )))
     C                     MOVE '07'      DBERR#  2         ))) ERROR  )))
     C                     EXSR DBERR                       )))   07   )))
     C                     END                              ))))))))))))))
     C**********           MOVE CNUM      CUSTNO  60                                          CSD027
     C                     MOVE CNUM      CUSTNO  6                                           CSD027
     C                     END
     C*                                                                ***
     C*   RETAIL ACCNT PROCESSING -                                    ***
     C*   USE 1ST 10 CHARS OF THE 1ST SETL PTY FIELD TO ACCESS
     C*   THE ACCOUNT DETAILS FROM LF/ACNUMA TO OBTAIN CUST NO.        ***
     C           ISPTP     IFEQ 'R'
     C                     MOVELISPTY1    ACNUMK 100
     C           ACNUMK    CHAINACNUMA               11    ON, DELETED
     C           *IN11     IFEQ '1'                         ))))))))))))))
     C*********************MOVE 'ACNUM'   DBFNAM  5         )))  DATA  )))S01310
     C                     MOVEL'ACNUMA'  DBFNAM            )))  DATA  )))S01310
     C                     MOVELACNUMK    DBERKY 39         )))  BASE  )))
     C                     MOVE '08'      DBERR#  2         ))) ERROR  )))
     C                     EXSR DBERR                       )))   08   )))
     C                     END                              ))))))))))))))
     C**********           MOVE CNUM      CUSTNO  60                                          CSD027
     C                     MOVE CNUM      CUSTNO  6                                           CSD027
     C                     END
     C*                                                                ***
     C*   FULL ACCOUNT/PARTIAL ACCOUNT/CUSTOMER PROCESSING - CUST NO.  ***
     C*   IS 1ST 6 CHARS OF THE 1ST SETL PTY FIELD.
     C           ISPTP     IFEQ 'G'
     C           ISPTP     OREQ 'P'
     C           ISPTP     OREQ 'C'
      *                                                                   S01435
      * If using account line construct then use second line              S01435
      *                                                                   S01435
     C                     MOVELISPTY1    ##001   1                       S01435
     C           ##001     IFEQ '/'                                       S01435
     C                     MOVELISPTY2    CUSTNO                          S01435
     C                     ELSE                                           S01435
     C                     MOVELISPTY1    CUSTNO
     C                     END                                            S01435
     C                     END
      *                                                                   S01435
      * If SWIFT identifier then use ME1400 to check details              S01435
      *                                                                   S01435
     C           ISPTP     IFEQ 'S'                                       S01435
      *                                                                   S01435
      *  Call Access object to validate identifier                        S01435
      *                                                                   S01435
     C                     MOVELISPTY1    ##001   1                       S01435
     C           ##001     IFEQ '/'                                       S01435
     C                     MOVELISPTY2    W9BICC                          S01435
     C           3         SUBSTISPTY2:9  W9BICB                          S01435
     C                     ELSE                                           S01435
     C                     MOVELISPTY1    W9BICC                          S01435
     C           3         SUBSTISPTY1:9  W9BICB                          S01435
     C                     END                                            S01435
      *                                                                   S01435
     C                     CALL 'ME1400'                                  S01435
     C                     PARM *BLANKS   W9RTN   7                       S01435
     C                     PARM           W9BICC  8                       S01435
     C                     PARM           W9BICB  3                       S01435
     C                     PARM           SDCUST                          S01435
     C                     PARM           SDCNST                          S01435
     C                     PARM           MEBICD                          S01435
     C                     PARM *BLANKS   W9CUST  1                       S01435
     C                     PARM *BLANKS   W9CNST  1                       S01435
     C                     PARM *BLANKS   W9BICD  1                       S01435
      *                                                                   S01435
      * If customer details exist then set up CUSTNO                      S01435
      *                                                                   S01435
     C           W9CUST    IFEQ 'Y'                                       S01435
     C                     MOVELBBCUST    CUSTNO                          S01435
      *                                                                   S01435
     C                     ELSE                                           068230
     C**********           Z-ADD0         CUSTNO                                       068230 CSD027
     C                     MOVE *BLANKS   CUSTNO                                              CSD027
      *                                                                   068230
     C                     END                                            S01435
      *                                                                   S01435
     C                     END                                            S01435
      *                                                                   S01435
     C*                                                                ***
     C*   ACCESS FULL CUSTOMER DETAILS FROM LF/CLINT                   ***
     C           ISPTP     IFEQ 'G'
     C           ISPTP     OREQ 'P'
     C           ISPTP     OREQ 'C'
     C           ISPTP     OREQ 'F'
     C           ISPTP     OREQ 'N'
     C           ISPTP     OREQ 'R'
     C           ISPTP     OREQ 'I'                                                         BUG14771
     C           W9CUST    OREQ 'Y'                                       S01435
     C           ISPTP     ANDEQ'S'                                       S01435
     C***SET*UP*CUSTOMER*KEY                                              S01310
     C*********************MOVELCUSTNO    KCUSNO  60                      S01310
     C*********************MOVE 'A'       KEYA    1                       S01310
     C***********CUSKEY****CHAINCLINTCBF             12    ON, DELETED    S01310
     C************IN12*****IFEQ '1'                         ))))))))))))))S01310
     C*********************MOVE 'CLINT'   DBFNAM  5         )))  DATA  )))S01310
     C*********************MOVEL'      A' DBERKY            )))  BASE  )))S01310
     C*********************MOVELKCUSNO    DBERKY            )))  BASE  )))S01310
     C*********************MOVE '09'      DBERR#  2         ))) ERROR  )))S01310
     C*********************EXSR DBERR                       )))   09   )))S01310
     C*********************END                              ))))))))))))))S01310
      *                                                                   S01310
     C**********           MOVE CUSTNO    CUSTKY  60                                   S01310 CSD027
     C                     MOVE CUSTNO    CUSTKY  6                                           CSD027
      *                                                                   S01310
      **  Access SDCUSTPD using customer number                           S01310
      *                                                                   S01310
     C                     MOVE *BLANKS   @KEY1                           S01310
     C                     MOVELCUSTKY    @KEY1                           S01310
     C                     CALL 'AOCUSTR0'                                S01310
     C                     PARM '*MSG   ' @RTCD                           S01310
     C                     PARM '*KEY   ' @OPTN                           S01310
     C                     PARM           @KEY1  10                       S01310
     C                     PARM *BLANKS   @KYST   7                       S01310
     C           SDCUST    PARM SDCUST    DSSDY                           S01310
      *                                                                   S01310
      ** Customer record not found - Error                                S01310
      *                                                                   S01310
     C           @RTCD     IFNE *BLANKS                                   S01310
     C                     MOVE '09'      DBERR#             * * * * * * *S01310
     C                     MOVEL@KEY1     DBERKY             * DBERR 009 *S01310
     C                     MOVEL'SDCUSTPD'DBFNAM             * * * * * * *S01310
     C                     EXSR DBERR                                     S01310
     C                     END                                            S01310
      *                                                                   S01310
      ** Move old field names to new to retain pgm continuity.            S01310
      *                                                                   S01310
     C**********           MOVELBBPCNB    CPAR    60                                   S01310 CSD027
     C                     MOVELBBPCNB    CPAR    6                                           CSD027
     C                     MOVELBBCRNM    CRNM   20                       S01310
     C                     MOVELBBCRTN    CTWN   10                       S01310
     C                     MOVELBBCSID    CSID                            S01310
      *                                                                                     MD048075
      ** If FTAllowFld50F = Y and Swift Financial Ins = Y, Use tag 50A                      MD048075
      ** If FTAllowFld50F = Y and Swift Financial Ins = N, use tag 50F                      MD048075
      *                                                                                     MD048075
     C                     SELEC                                                            MD048075
     C           ALW50F    WHEQ 'Y'                                                         MD048075
     C           BBSWFI    ANDEQ'Y'                                                         MD048075
     C                     MOVE 'Y'       FLG50A  1                                         MD048075
      *                                                                                     MD048075
     C           ALW50F    WHEQ 'Y'                                                         MD048075
     C           BBSWFI    ANDEQ'N'                                                         MD048075
     C                     MOVE 'N'       FLG50A                                            MD048075
      *                                                                                     MD048075
     C                     OTHER                                                            MD048075
     C                     MOVE 'Y'       FLG50A                                            MD048075
     C                     ENDSL                                                            MD048075
      *                                                                                     MD048075
     C/COPY WNCPYSRC,FT0641C009
     C**********           MOVELBBCNA1    CNA1                                       S01310 BUG14771
     C**********           MOVELBBCNA2    CNA2                                       S01310 BUG14771
     C**********           MOVELBBCNA3    CNA3                                       S01310 BUG14771
     C**********           MOVELBBCNA4    CNA4                                       S01310 BUG14771
     C/COPY WNCPYSRC,FT0641C010
     C*
     C* ACCESS DESTINATION ADDRESS DETAILS VIA SWFT SUBROUTINE
     C* (20 ONLY SET ON FOR DESTINATION)
     C*
     C           *IN20     IFEQ '1'
     C*
     C*********************EXSR SWFT                                      S01310
      ***********                                                  S01310 CSW096
      ***If*the*destination*has*a*default*address*(BBDNW1)*use*it*,S01310 CSW096
      ***else*use*the*priority*network*address.********************S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********BBDNW1    IFNE *BLANKS                            S01310 CSW096
     C***********          EXSR NWAD                               S01310 CSW096
     C***********          ELSE                                    S01310 CSW096
     C***********          EXSR PRAD                               S01310 CSW096
     C***********          END                                     S01310 CSW096
      ***********                                                  S01310 CSW096
      ****Fill*up*the*appropriate*array*information*from*PF/SDCUSTPS01310 CSW096
     C***********          EXSR FILL                               S01310 CSW096
      ***********                                                  S01310 CSW096
      ****If*message*status*blank,*determine*value.****************S01310 CSW096
      ****Is*default*status*for*MT100*messages*released*?**********S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********MGST      IFEQ *BLANKS                            S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********'100'     LOKUPGNR                      15        S01310 CSW096
     C***********'10*'     LOKUPGNR                      16        S01310 CSW096
     C***********'1**'     LOKUPGNR                      17        S01310 CSW096
      ***********                                                  S01310 CSW096
     C************IN15     IFEQ '1'                                S01310 CSW096
     C************IN16     OREQ '1'                                S01310 CSW096
     C************IN17     OREQ '1'                                S01310 CSW096
     C***********          MOVE 'RSND'    MGST                     S01310 CSW096
     C***********          MOVE '2'       MGSG                     S01310 CSW096
     C***********          ELSE                                    S01310 CSW096
      ***********                                                  088545 CSW096
      ****If*there*is*no*default*for*that*type*of*message*for*that*088545 CSW096
      ****customer,*setup*the*message*status*whith*the*ICD*default.088545 CSW096
      ***********                                                  088545 CSW096
     C***********FTCS      IFEQ 'R'                                088545 CSW096
     C***********          MOVE 'RSND'    MGST                     088545 CSW096
     C***********          MOVE '2'       MGSG                     088545 CSW096
     C***********          ELSE                                    088545 CSW096
     C***********          MOVE 'CRTD'    MGST                     S01310 CSW096
     C***********          MOVE '1'       MGSG                     S01310 CSW096
     C***********          END                                     088545 CSW096
     C***********          END                                     S01310 CSW096
     C***********          END                                     S01310 CSW096
      *                                                                   CSW096
     C/COPY WNCPYSRC,FT0641C027
      *                                                                   CFT014
     C                     MOVE *BLANK    WMT103  1                       CFT014
      *                                                                   CFT014
     C                     EXSR SRROUT                                    CSW096
      *                                                                   CFT014
      ** Check if MT103 or MT100.  If MT103, execute SRROUT again to      CFT014
      ** set up details for MT103.                                        CFT014
      *                                                                   CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
     C                     EXSR SRDTMG                                    CFT014
     C           WMT103    IFEQ 'Y'                                       CFT014
     C                     EXSR SRROUT                                    CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C/COPY WNCPYSRC,FT0641C028
      *                                                                   S01310
     C***********CSID******IFEQ *BLANKS                                   S01310
     C*********************MOVE 'N'       OSUFLG                          S01310
     C*********************END                                            S01310
     C                     END
     C                     GOTO SR01A
     C                     END
      *                                                                   S01435
      * If SWIFT identifier and destination of message set up             S01435
      * routing data                                                      S01435
      *                                                                   S01435
     C           ISPTP     IFEQ 'S'                                       S01435
     C           *IN20     ANDEQ'1'                                       S01435
     C                     MOVEL'Y'       OSUFLG                          S01435
     C**********           Z-ADD0         CPAR                                         S01435 CSD027
     C                     MOVE *BLANKS   CPAR                                                CSD027
     C                     MOVELISPTY1    CRNM                            S01435
     C*****************    MOVELSCRNM     NWSN                     S01435 087873
     C                     MOVELSNCSID    NWSN                            087873
     C                     MOVELISPTY1    NWDS                            S01435
     C                     MOVEL'SWIFT'   NWRK                            S01435
     C                     MOVEL*BLANKS   CTWN                            S01435
     C                     MOVELISPTY1    CSID                            S01435
     C*                                                                   088545
     C*  Default the message status whith the ICD.                        088545
     C*                                                                   088545
     C           FTCS      IFEQ 'R'                                       088545
     C                     MOVE 'RSND'    MGST                            088545
     C                     MOVE '2'       MGSG                            088545
     C                     ELSE                                           088545
     C                     MOVE 'CRTD'    MGST                            S01435
     C                     MOVE '1'       MGSG                            S01435
     C                     END                                            088545
     C                     END                                            S01435
     C*                                                                   189269
     C* Routing program not called therefore SRDTMG not performed,        189269
     C* execute here so that type is determined for Destination           189269
     C* type = 'A' and type 'S' but SWIFT ID not in SDCUSTPD.             189269
     C*                                                                   189269
     C           CFT014    IFEQ 'Y'                                       189269
     C           *IN20     ANDEQ'1'                                       189269
     C           ISPTP     IFEQ 'S'                                       189269
     C           ISPTP     OREQ 'A'                                       189269
     C                     MOVELNWSN      O@SWSN                          189269
     C                     MOVELNWDS      O@SWDS                          189269
     C                     EXSR SRDTMG                                    189269
     C                     ENDIF                                          189269
     C                     ENDIF                                          189269
     C/COPY WNCPYSRC,FT0641C015
     C*                                                                ***
     C*   SWIFT ADDRESS AND AT LEAST ONE VALID TAG FIELDS = 'A'        ***
     C           ISPTP     IFEQ 'S'
     C           IVTAG1    ANDEQ'A'
      *                                                                   S01435
      * If using account line construct then use second line              S01435
      *                                                                   S01435
     C                     MOVELISPTY1    ##001                           S01435
     C           ##001     IFEQ '/'                                       S01435
     C                     MOVELISPTY2    SP12                            S01435
     C                     MOVELSP12      SCSID                           S01435
     C                     MOVELISPTY1    OFSPT1                          S01435
     C                     MOVELSCSID     OFSPT2                          S01435
     C                     ELSE                                           S01435
     C                     MOVELISPTY1    SP12   12        1ST 12 CHARS
     C                     MOVELSP12      SCSID            1ST 12 CHARS
     C                     MOVELSCSID     OFSPT1
     C                     END                                            S01435
     C                     MOVE 'A'       OSTAG
     C*********************MOVE 'Y'       OSUFLG                          S01310
     C                     GOTO SR01N
     C                     END
     C*                                                                ***
     C*   SWIFT ADDRESS AND AT LEAST ONE VALID TAG FIELDS = 'D'        ***
     C           ISPTP     IFEQ 'S'
     C           IVTAG3    ANDEQ'D'
      *                                                                   S01435
      * Use FT0315 to format text for D address type                      S01435
      *                                                                   S01435
      *                                                                   S01435
      *  Set up general parameters                                        S01435
      *                                                                   S01435
     C           *LIKE     DEFN BCCY      XCCY                            S01435
      *                                                                   S01435
     C                     CLEARW8FT                                      S01435
     C                     MOVEL*BLANKS   W8STMT                          S01435
     C                     MOVEL##PGM     W8CPGM                          S01435
     C                     MOVEL'*MSG  '  W8ACT                           S01435
     C                     Z-ADD5         W8NLIN                          S01435
     C                     MOVEL'Y'       W8MTXT                          S01435
      *                                                                   S01435
      *  Format data to be translated                                     S01435
      *                                                                   S01435
     C                     MOVELISPTP     W8TYPE                          S01435
     C                     MOVELISCCY     W8CCY                           S01435
     C                     MOVEL*BLANKS   W8LINS                          S01435
     C                     MOVELISPTY1    ADCHK1                          S01435
     C                     MOVELISPTY2    ADCHK2                          S01435
     C                     MOVELISPTY3    ADCHK3                          S01435
     C                     MOVELISPTY4    ADCHK4                          S01435
     C                     MOVELISPTY5    ADCHK5                          S01435
     C           W8TYPE    IFEQ 'P'                                       S01435
     C           ISBRCA    ANDNE*BLANKS                                   S01435
     C                     MOVELISBRCA    ADPBRC                          S01435
     C                     END                                            S01435
     C                     MOVELADDRSS    W8LINS                          S01435
      *                                                                   S01435
      * Call expansion program                                            S01435
      *                                                                   S01435
     C                     CALL 'FT0315'               1111               S01435
     C                     PARM           W8RTN   7                       S01435
     C                     PARM           W8FT                            S01435
     C                     PARM           W8LINS256                       S01435
     C                     PARM           W8RPT 256                       S01435
     C                     PARM           W8MSG 256                       S01435
     C                     PARM           W8SCR 256                       S01435
      *                                                                   S01435
      ** Check if database error occurred                                 S01435
      *                                                                   S01435
     C           *IN11     IFEQ '1'                                       S01435
     C           W8RTN     ORNE *BLANKS                                   S01435
     C********** CSW207    IFEQ 'N'                                                   CSW207A 250600
     C                     MOVE '089'     DBERR#             * * * * * * *S01435
     C                     MOVEL'*CALL'   DBERKY             * DBERR 089 *S01435
     C                     MOVEL'FT0315'  DBFNAM             * * * * * * *S01435
     C                     EXSR DBERR                                     S01435
     C**********           ENDIF                                                      CSW207A 250600
     C                     END                                            S01435
      *                                                                   S01435
     C                     MOVELW8MSG     ADDRSS                          S01435
     C                     MOVELADCHK1    OFSPT1                          S01435
     C                     MOVELADCHK2    OFSPT2                          S01435
     C                     MOVELADCHK3    OFSPT3                          S01435
     C                     MOVELADCHK4    OFSPT4                          S01435
     C                     MOVELADCHK5    OFSPT5                          S01435
      *                                                                   S01435
     C***********          MOVELISPTY1    SP12   12        1ST 12 CHARS   S01435
     C***********          MOVELSP12      OFSPT1           1ST 12 CHARS   S01435
     C                     MOVE 'D'       OSTAG
     C*********************MOVE 'Y'       OSUFLG                          S01310
     C                     GOTO SR01N
     C                     END
     C*                                                                ***
     C*   FULL ADDRESS AND AT LEAST ONE VALID TAG FIELDS = 'D'         ***
     C*   Or IBAN Number                                                  CFT004
     C           ISPTP     IFEQ 'A'
     C           IVTAG3    ANDEQ'D'
     C********** CFT004    OREQ 'Y'                                                  CFT004 BUG14771
     C********** ISPTP     ANDEQ'I'                                                  CFT004 BUG14771
     C                     MOVELISPTY1    OFSPT1
     C                     MOVELISPTY2    OFSPT2
     C                     MOVELISPTY3    OFSPT3
     C                     MOVELISPTY4    OFSPT4
     C                     MOVELISPTY5    OFSPT5
     C                     MOVE 'D'       OSTAG
     C*********************MOVE 'N'       OSUFLG                          S01310
      *                                                                   CFT014
     C                     MOVELISPTY1    WCHR02  2                       CFT014
     C           WMT103    IFEQ 'Y'                                       CFT014
     C           WCHR02    ANDEQ'//'                                      CFT014
     C           ISPTY2    ANDEQ*BLANKS                                   CFT014
     C           ISPTY3    ANDEQ*BLANKS                                   CFT014
     C           ISPTY4    ANDEQ*BLANKS                                   CFT014
     C           ISPTY5    ANDEQ*BLANKS                                   CFT014
     C                     MOVE 'C'       OSTAG                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      *                                                                                      260987A
      ** Ensure fields for MGOREFPD set up correctly (if destination).                       260987A
      *                                                                                      260987A
     C           *IN20     IFEQ '1'                                                          260987A
     C                     MOVEL'PAPER'   NWRK                                               260987A
     C                     MOVELSBICN     NWSN                                               260987A
     C                     MOVELSBICN     SECN                                               260987A
     C                     MOVELISPTY1    NWDS                                               260987A
     C                     MOVEL*BLANKS   BBCUST                                             260987A
     C                     ENDIF                                                             260987A
      *                                                                                      260987A
      ** Default the message status whith the ICD.                                           260987A
      *                                                                                      260987A
     C           FTCS      IFEQ 'R'                                                          260987A
     C                     MOVE 'RSND'    MGST                                               260987A
     C                     MOVE '2'       MGSG                                               260987A
     C                     ELSE                                                              260987A
     C                     MOVE 'CRTD'    MGST                                               260987A
     C                     MOVE '1'       MGSG                                               260987A
     C                     ENDIF                                                             260987A
      *                                                                                      260987A
     C                     GOTO SR01N
     C                     END
     C*
     C           SR01A     TAG
     C* IF TYPE BLANK IGNORE
     C           ISPTP     IFEQ ' '                        B001
     C                     GOTO SR01N
     C                     END                             E001
     C*                                                                ***
     C*   VALID TAG FIELD = 'D' AND THE SWIFT ADDRESS ON LF/CLINT IS   ***
     C*   NON BLANK                                                    ***
     C           IVTAG1    IFEQ 'A'
     C           CSID      ANDNE*BLANK
     C           FLG50A    ANDEQ'Y'                                                         MD048075
      *                                                                   S01435
      * If using account line construct then use second line              S01435
      *                                                                   S01435
     C                     MOVELISPTY1    ##001                           S01435
     C           ##001     IFEQ '/'                                       S01435
     C                     MOVELCSID      SCSID                           S01435
     C                     MOVELISPTY1    OFSPT1                          S01435
     C                     MOVELSCSID     OFSPT2                          S01435
     C                     ELSE                                           S01435
     C                     MOVELCSID      SCSID
     C                     MOVELSCSID     OFSPT1
     C                     END                                            S01435
     C                     MOVE 'A'       OSTAG
     C*********************MOVE 'Y'       OSUFLG                          S01310
     C                     GOTO SR01N
     C                     END
     C*                                                                ***
     C*   VALID TAG FIELD = 'B' AND THE CUSTOMER PARENT NUMBER FROM    ***
     C*  LF/CLINT IS NON ZERO AND EQUAL TO THE CUST. NO. OF HEAD OFFICE***
      *                                                                   S01435
      * If using account line construct then 'B' not allowed              S01435
      *                                                                   S01435
     C                     MOVELISPTY1    ##001                           S01435
     C           IVTAG2    IFEQ 'B'
     C********** CPAR      ANDNE*ZERO                                                         CSD027
     C           CPAR      ANDNE*BLANKS                                                       CSD027
     C           CPAR      ANDEQSHEAD                      SAVE 1ST CYCLE
     C           ##001     ANDNE'/'                                       S01435
     C                     MOVELCTWN      OFSPT1
     C                     MOVE 'B'       OSTAG
     C*********************MOVE 'N'       OSUFLG                          S01310
     C                     GOTO SR01N
     C                     END
     C*                                                                ***
     C*   VALID TAG FIELD = 'D'                                        ***
     C           IVTAG3    IFEQ 'D'
     C*********************                                               S01310
     C*********************MOVE 'B'       KEYA                            S01310
     C***********CUSKEY****CHAINCLINTCCF             12    ON, DELETED    S01310
     C************IN12*****IFEQ '1'                         ))))))))))))))S01310
     C*********************MOVE 'CLINT'   DBFNAM  5         )))  DATA  )))S01310
     C*********************MOVEL'      B' DBERKY            )))  BASE  )))S01310
     C*********************MOVELKCUSNO    DBERKY            )))  BASE  )))S01310
     C*********************MOVE '14'      DBERR#  2         ))) ERROR  )))S01310
     C*********************EXSR DBERR                       )))   14   )))S01310
     C*********************END                              ))))))))))))))S01310
      *                                                                   S01435
      * Replaced by call FT0315                                           S01435
      *                                                                   S01435
      ************                                                        S01435
     C************         MOVELCNA1      OFSPT1                          S01435
     C************         MOVELCNA2      OFSPT2                          S01435
     C************         MOVELCNA3      OFSPT3                          S01435
     C************         MOVELCNA4      OFSPT4                          S01435
     C************         MOVE 'D'       OSTAG                           S01435
     C*********************MOVE 'N'       OSUFLG                          S01310
     C************         END                                            S01435
      *                                                                   S01435
      * Use FT0315 to format text for D address type                      S01435
      *                                                                   S01435
      *                                                                   S01435
      *  Set up general parameters                                        S01435
      *                                                                   S01435
     C                     CLEARW8FT                                      S01435
     C                     MOVEL*BLANKS   W8STMT                          S01435
     C                     MOVEL##PGM     W8CPGM                          S01435
     C                     MOVEL'*MSG  '  W8ACT                           S01435
     C                     Z-ADD5         W8NLIN                          S01435
     C                     MOVEL'Y'       W8MTXT                          S01435
      *                                                                   S01435
      *  Format data to be translated                                     S01435
      *                                                                   S01435
     C                     MOVELISPTP     W8TYPE                          S01435
     C                     MOVELISCCY     W8CCY                           S01435
     C                     MOVEL*BLANKS   W8LINS                          S01435
     C                     MOVELISPTY1    ADCHK1                          S01435
     C                     MOVELISPTY2    ADCHK2                          S01435
     C                     MOVELISPTY3    ADCHK3                          S01435
     C                     MOVELISPTY4    ADCHK4                          S01435
     C                     MOVELISPTY5    ADCHK5                          S01435
     C           W8TYPE    IFEQ 'P'                                       S01435
     C           ISBRCA    ANDNE*BLANKS                                   S01435
     C                     MOVELISBRCA    ADPBRC                          S01435
     C                     END                                            S01435
     C                     MOVELADDRSS    W8LINS                          S01435
      *                                                                   S01435
      * Call expansion program                                            S01435
      *                                                                   S01435
     C                     CALL 'FT0315'               1111               S01435
     C                     PARM           W8RTN   7                       S01435
     C                     PARM           W8FT                            S01435
     C                     PARM           W8LINS256                       S01435
     C                     PARM           W8RPT 256                       S01435
     C                     PARM           W8MSG 256                       S01435
     C                     PARM           W8SCR 256                       S01435
      *                                                                   S01435
      ** Check if database error occurred                                 S01435
      *                                                                   S01435
     C           *IN11     IFEQ '1'                                       S01435
     C           W8RTN     ORNE *BLANKS                                   S01435
     C********** CSW207    IFEQ 'N'                                                   CSW207A 250600
     C                     MOVE '090'     DBERR#             * * * * * * *S01435
     C                     MOVEL'*CALL'   DBERKY             * DBERR 090 *S01435
     C                     MOVEL'FT0315'  DBFNAM             * * * * * * *S01435
     C                     EXSR DBERR                                     S01435
     C**********           ENDIF                                                      CSW207A 250600
     C                     END                                            S01435
      *                                                                   S01435
     C                     MOVELW8MSG     ADDRSS                          S01435
     C                     MOVELADCHK1    OFSPT1                          S01435
     C                     MOVELADCHK2    OFSPT2                          S01435
     C                     MOVELADCHK3    OFSPT3                          S01435
     C                     MOVELADCHK4    OFSPT4                          S01435
     C                     MOVELADCHK5    OFSPT5                          S01435
     C                     MOVE 'D'       OSTAG                           S01435
     C                     END                                            S01435
      *                                                                   S01435
     C*                                                                ***
     C           SR01N     TAG
      *                                                                                       CSW201
      ** If CSW201 is installed, check if swift id is a BEI.                                  CSW201
      ** If yes, format with option 'D'.                                                      CSW201
      *                                                                                       CSW201
     C           CSW201    IFEQ 'Y'                                                           CSW201
     C           OSTAG     ANDEQ'A'                                                           CSW201
     C           *IN51     ANDEQ*ON                                                           CSW201
      *                                                                                       CSW201
     C                     MOVELSCSID     W9BICC                                              CSW201
     C           3         SUBSTSCSID:9   W9BICB                                              CSW201
     C                     EXSR SR1400                                                        CSW201
      *                                                                                       CSW202
     C           CSW202    IFEQ 'Y'                                                           CSW202
     C           W9BICD    ANDEQ'Y'                                                           CSW202
      *                                                                                       CSW202
     C                     CALL 'AOBEISR0'                                                    CSW202
     C                     PARM *BLANKS   PRTCD                                               CSW202
     C                     PARM '*VERIFY' POPTN                                               CSW202
     C                     PARM BDSUBT    PBIC    4                                           CSW202
     C           MEBEIS    PARM MEBEIS    DSFDY                                               CSW202
      *                                                                                       CSW202
     C                     ENDIF                                                              CSW202
      *                                                                                       CSW201
     C           W9RTN     IFEQ *BLANKS                                                       CSW201
     C           W9BICD    ANDEQ'Y'                                                           CSW201
     C           BDSUBT    ANDEQ'BEID'                                                        CSW201
     C           CSW202    ANDEQ'N'                                                           CSW202
      *                                                                                       CSW201
     C           W9RTN     OREQ *BLANKS                                                       CSW201
     C           W9BICD    ANDEQ'Y'                                                           CSW201
     C           BDSUBT    ANDEQ'TRCO'                                                        CSW201
     C           CSW202    ANDEQ'N'                                                           CSW202
      *                                                                                       CSW202
     C           W9BICD    OREQ 'Y'                                                           CSW202
     C           PRTCD     ANDEQ*BLANKS                                                       CSW202
     C           CSW202    ANDEQ'Y'                                                           CSW202
      *                                                                                       CSW201
     C                     MOVEL'D'       OSTAG                                               CSW201
      *                                                                                       CSW201
     C           W9CNST    IFEQ 'Y'                                                           CSW201
      *                                                                                       CSW201
      ** If account line, then start with second line.                                        CSW201
     C           ##001     IFEQ '/'                                                           CSW201
     C                     MOVELISPTY1    OFSPT1                                              CSW201
     C                     MOVELAWCPNM    OFSPT2                                              CSW201
     C                     MOVELAWCNTN    OFSPT3                                              CSW201
     C                     ELSE                                                               CSW201
     C                     MOVELAWCPNM    OFSPT1                                              CSW201
     C                     MOVELAWCNTN    OFSPT2                                              CSW201
     C                     ENDIF                                                              CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C           W9CUST    IFEQ 'Y'                                                           CSW201
      *                                                                                       CSW201
      ** If account line, then start with second line.                                        CSW201
     C           ##001     IFEQ '/'                                                           CSW201
     C                     MOVELISPTY1    OFSPT1                                              CSW201
     C                     MOVELBBCNA1    OFSPT2                                              CSW201
     C                     MOVELBBCNA2    OFSPT3                                              CSW201
     C                     MOVELBBCNA3    OFSPT4                                              CSW201
     C                     MOVELBBCNA4    OFSPT5                                              CSW201
     C                     ELSE                                                               CSW201
     C                     MOVELBBCNA1    OFSPT1                                              CSW201
     C                     MOVELBBCNA2    OFSPT2                                              CSW201
     C                     MOVELBBCNA3    OFSPT3                                              CSW201
     C                     MOVELBBCNA4    OFSPT4                                              CSW201
     C                     ENDIF                                                              CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C                     ENDIF                                                              CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C                     EXSR EMBLK
     C                     ENDSR
     C/EJECT
4630 C********************************************************************
     C********************************************************************
     C********************************************************************
     C*               SUBROUTINE EMBLK                                 ***
     C*                                                                ***
     C*     TO ELIMINATE BLANK LINES ON NAME AND ADDRESS FIELDS        ***
     C*                                                                ***
     C*      CALLED BY: MAIN PROCESSING
     C*                 SR01
     C********************************************************************
     C           EMBLK     BEGSR                                       ***
     C                     MOVEA*BLANKS   ADDR
     C                     Z-ADD1         A       10
     C*
     C           OFSPT1    IFNE *BLANK
     C                     MOVE OFSPT1    ADDR,A
     C                     ADD  1         A
     C                     END
     C*
     C           OFSPT2    IFNE *BLANK
     C                     MOVE OFSPT2    ADDR,A
     C                     ADD  1         A
     C                     END
     C*
     C           OFSPT3    IFNE *BLANK
     C                     MOVE OFSPT3    ADDR,A
     C                     ADD  1         A
     C                     END
     C*
     C           OFSPT4    IFNE *BLANK
     C                     MOVE OFSPT4    ADDR,A
     C                     ADD  1         A
     C                     END
     C*
     C           OFSPT5    IFNE *BLANK
     C                     MOVE OFSPT5    ADDR,A
     C                     ADD  1         A
     C                     END
     C*
     C           OFSPT6    IFNE *BLANK
     C                     MOVE OFSPT6    ADDR,A
     C                     ADD  1         A
     C                     END
     C*
     C                     MOVEAADDR      OFSPT
     C*
     C                     ENDSR
     C/EJECT
4630 C********************************************************************
     C********************************************************************
     C********************************************************************
     C*     *         SUBROUTINE 03                         ***        ***
     C*     *                                               ***        ***
     C*     *     TO FORMAT AMOUNT                          ***        ***
     C*     *                                               ***        ***
     C*********************************************************        ***
     C           SR03      BEGSR                            ***        ***
     C*                                                                   CSW020
     C** Perform Old Processing if CSW020 is not switched on.             CSW020
     C           CSW020    IFNE 'Y'                                       CSW020
     C*                                                                ***
     C*   CHAIN TO TABLETG TO FIND DECIMAL POSITION                    ***
     C                     MOVEL'20'      TABTGK 12
     C                     MOVELPCCY      TGCCSR  4
     C                     MOVE '1'       TGCCSR
     C                     MOVE TGCCSR    TABTGK
     C           TABTGK    CHAINTABFP                10
     C*
     C           *IN10     IFEQ '1'                         ))))))))))))))
     C*********************MOVE 'TABFP'   DBFNAM            )))  DATA  )))S01310
     C                     MOVEL'TABFP'   DBFNAM            )))  DATA  )))S01310
     C                     MOVELTABTGK    DBERKY            )))  BASE  )))
     C                     MOVE '15'      DBERR#            ))) ERROR  )))
     C                     EXSR DBERR                       )))   15   )))
     C                     END                              ))))))))))))))
     C*
     C** USE THE SWIFT CURRENCY FROM TABLE ON THE SWIFT MESSAGES
     C*          =====
     C                     MOVE CCYS      M1RCCY
      *                                                                   CEU006
      * Save SWIFT currency code and decimal places for SR/ERI            CEU006
     C                     MOVELCCYS      WCCYS   3                       CEU006
     C                     Z-ADDCDP       WCDP    10                      CEU006
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0641CCP3                                           S01408
     C*                                                                   S01408
     C*
     C*    DETERMINE DECIMAL POSITION (FOR REPORT)
     C           CDP       COMP 2                    33  32
     C           CDP       COMP 1                      3031
     C*
     C*    DETERMINE DECIMAL POSITION
     C           14        SUB  CDP       X       20
     C*    IF 0 DECIMAL PLACES DON'T EDIT
     C           CDP       IFEQ 0                          B001
     C                     MOVE *BLANK    AMT
     C                     MOVE *ZEROS    AM
     C                     MOVEARAMNT     AMT,2
     C                     MOVEARAMNT     AM,1
     C                     Z-ADD13        W
     C                     MOVE ','       AM,X
     C                     ELSE                            E001
     C*    MOVE AMOUNT INTO ARRAY
     C                     MOVEARAMNT     AMT,1
     C*    DETERMINE POSITION OF DECIMAL DIGITS IN 2ND ARRAY
     C           X         ADD  1         Y       20
     C*    MOVE DECIMAL DIGITS INTO 2ND ARRAY FIELD
     C                     MOVEAAMT,X     AM,Y
     C*    DETERMINE POSITION & MOVE COMMA
     C                     SUB  1         Y
     C                     MOVE ','       AM,Y
     C*    DETERMINE POSITION OF DIGIT B4  COMMA
     C                     SUB  1         Y
     C*    SAVE POSITION OF DIGIT B4  COMMA
     C                     Z-ADDY         W       20
     C*    DETERMINE POSITION OF DIGIT TO BE MOVED B4  COMMA
     C                     SUB  1         X
     C                     Z-ADDX         Z       20
     C*    DO OPERATIONS MOVING CHARACTERS ONE AT A TIME
     C*    FROM RIGHT TO LEFT
     C                     DO   X
     C                     MOVE AMT,Z     AM,Y
     C                     SUB  1         Z
     C                     SUB  1         Y
     C                     END
     C                     END                             E001
     C*    SET INDEX TO 1
     C                     Z-ADD1         Y
     C*    REPLACE LEADING ZEROS WITH BLANK
     C           AM,Y      DOWEQ'0'
     C           Y         CABEQW         SR03A
     C                     MOVE ' '       AM,Y
     C                     ADD  1         Y
     C                     END
     C*  ** SAVE FIELD FROM ARRAY                                      ***
     C           SR03A     TAG
     C                     MOVEAAM        AMX    14
     C                     MOVE AMX       SAM    15
     C*                                                                ***
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0641CCP4                                           S01408
     C*                                                                   S01408
     C                     ELSE                                           CSW020
     C*                                                                   CSW020
     C** If CSW020 is switched on perform decimal places prosessing       CSW020
     C                     CALL 'ZM0040'                                  CSW020
     C                     PARM WAMNT     ZAMNT                           CSW020
     C                     PARM PCCY      ZCCY                            CSW020
     C                     PARM *BLANKS   ZSAMNT                          CSW020
     C                     PARM *BLANKS   ZSCCY                           CSW020
     C                     PARM *BLANKS   ZERR                            CSW020
     C*                                                                   CSW020
     C** Handle Database Error                                            CSW020
     C           ZERR      IFEQ '1'                                       CSW020
     C                     MOVEL'ZM0040  'DBFNAM           ************   CSW020
     C                     MOVELPCCY      DBERKY           * DBERR 33 *   CSW020
     C                     MOVE '33'      DBERR#           ************   CSW020
     C                     EXSR DBERR                                     CSW020
     C*                                                                   CSW020
     C                     ELSE                                           CSW020
     C                     MOVE ZSAMNT    SAM                             CSW020
     C                     MOVE ZSCCY     M1RCCY                          CSW020
     C*                                                                   CSW020
     C**    Access Currency Details                                       CSW020
     C                     CALL 'AOCURRR0'                                CSW020
     C                     PARM '*MSG   ' @RTCD   7                       CSW020
     C                     PARM '*KEY   ' @OPTN   7                       CSW020
     C                     PARM PCCY      @CCY    3                       CSW020
     C           SDCURR    PARM SDCURR    DSSDY                           CSW020
     C*                                                                   CSW020
     C                     MOVE A6CYNM    CCNM                            CSW020
     C           A6NBDP    COMP 2                    33  32               CSW020
     C           A6NBDP    COMP 1                      3031               CSW020
     C                     ENDIF                                          CSW020
     C*                                                                   CSW020
     C                     ENDIF                                          CSW020
     C*                                                                   CSW020
     C                     ENDSR                           END SR03
     C/EJECT
4630 C********************************************************************
     C********************************************************************
     C********************************************************************
     C*     *         SUBROUTINE 05                         ***        ***
     C*     *                                               ***        ***
     C*     *  FORMAT SETTLEMENT PARTY FOR TELEX REPORT     ***        ***
     C*     *                                               ***        ***
     C*     *                                               ***        ***
     C*********************************************************        ***
     C           SR05      BEGSR                            ***        ***
     C*     INTIALISE O/P PARAMETERS FROM THIS SUBROUTINE
     C                     MOVE *BLANKS   OFSPT1 35
     C                     MOVE *BLANKS   OFSPT2 35
     C                     MOVE *BLANKS   OFSPT3 35
     C                     MOVE *BLANKS   OFSPT4 35
     C                     MOVE *BLANKS   OFSPT5 35
      *                                                                   S01435
      * Replaced by call FT0315                                           S01435
      *                                                                   S01435
      ***********                                                         S01435
     C***********                                                      ***S01435
     C*****FULL*NOSTRO - PROCESSING                         **         ***S01435
     C***********ISPTP     IFEQ 'F'                                       S01435
     C*****SETUP*AND ACCESS PF/TABLETL                                 ***S01435
     C***********          MOVELISPTY1    TLCCNN  5        BUILD          S01435
     C***********          MOVEL'70'      TABTLK 12          KEY          S01435
     C***********          MOVE TLCCNN    TABTLK               KEY        S01435
     C***********TABTLK    CHAINTABFP                10                   S01435
     C************IN10     IFEQ '1'                         ))))))))))))))S01435
     C*********************MOVE 'TABFP'   DBFNAM            )))  DATS01310S01435
     C***********          MOVEL'TABFP'   DBFNAM            )))  DATS01310S01435
     C***********          MOVELTABTLK    DBERKY            )))  BASE  )))S01435
     C***********          MOVE '10'      DBERR#            ))) ERROR  )))S01435
     C***********          EXSR DBERR                       )))   10   )))S01435
     C***********          END                              ))))))))))))))S01435
     C***********          MOVE CNUM      CUSTNO                          S01435
     C***********          MOVELTLCCNN    OFSPT1                          S01435
     C***********          GOTO NADD                                      S01435
     C***********          END                                            S01435
     C***********                                                      ***S01435
     C*****NOSTRO NUMBER - PROCESSING                         **       ***S01435
     C***********ISPTP     IFEQ 'N'                                       S01435
     C*****SETUP*AND ACCESS PF/TABLETL                                 ***S01435
     C***********          MOVELISPTY1    TLNN    2        BUILD          S01435
     C***********          MOVELISCCY     TLCCNN             KEY          S01435
     C***********          MOVE TLNN      TLCCNN             KEY          S01435
     C***********          MOVEL'70'      TABTLK 12          KEY          S01435
     C***********          MOVE TLCCNN    TABTLK               KEY        S01435
     C***********TABTLK    CHAINTABFP                10                   S01435
     C************IN10     IFEQ '1'                         ))))))))))))))S01435
     C*********************MOVE 'TABFP'   DBFNAM            )))  DATS01310S01435
     C***********          MOVEL'TABFP'   DBFNAM            )))  DATS01310S01435
     C***********          MOVELTABTLK    DBERKY            )))  BASE  )))S01435
     C***********          MOVE '11'      DBERR#            ))) ERROR  )))S01435
     C***********          EXSR DBERR                       )))   11   )))S01435
     C***********          END                              ))))))))))))))S01435
     C***********          MOVE CNUM      CUSTNO                          S01435
     C***********          MOVELTLNN      OFSPT1                          S01435
     C***********          GOTO NADD                                      S01435
     C***********          END                                            S01435
     C***********                                                      ***S01435
     C*****RETAIL ACCOUNT - PROCESSING                         **      ***S01435
     C***********ISPTP     IFEQ 'R'                                       S01435
     C*****SETUP*AND ACCESS ACCOUNT NUMBER FILE                        ***S01435
     C***********          MOVELISPTY1    ACNUMK                          S01435
     C***********ACNUMK    CHAINACNUMA               11    ON, DELETED    S01435
     C************IN11     IFEQ '1'                         ))))))))))))))S01435
     C*********************MOVE 'ACNUM'   DBFNAM  5         )))  DATS01310S01435
     C***********          MOVEL'ACNUM'   DBFNAM            )))  DATS01310S01435
     C***********          MOVELACNUMK    DBERKY 39         )))  BASE  )))S01435
     C***********          MOVE '12'      DBERR#  2         ))) ERROR  )))S01435
     C***********          EXSR DBERR                       )))   12   )))S01435
     C***********          END                              ))))))))))))))S01435
     C***********          MOVE CNUM      CUSTNO                          S01435
     C***********          MOVELACNUMK    OFSPT1                          S01435
     C***********          GOTO NADD                                      S01435
     C***********          END                                            S01435
     C***********                                                      ***S01435
     C*****FULL/PARTIAL ACCOUNT/CUSTOMER  - PROCESSING                 ***S01435
     C***********ISPTP     IFEQ 'G'                                       S01435
     C***********ISPTP     OREQ 'P'                                       S01435
     C***********ISPTP     OREQ 'C'                                       S01435
     C***********          MOVELISPTY1    CUSTNO                          S01435
     C***********          MOVELISPTY1    OFSPT1                          S01435
     C***********          GOTO NADD                                      S01435
     C***********          END                                            S01435
     C***********                                                      ***S01435
     C*****SETTLEMENT PARTY  - PROCESSING                              ***S01435
     C***********ISPTP     IFEQ 'S'                                       S01435
     C***********ISPTP     OREQ 'A'                                       S01435
     C***********          MOVELISPTY1    OFSPT1                          S01435
     C***********          MOVELISPTY2    OFSPT2                          S01435
     C***********          MOVELISPTY3    OFSPT3                          S01435
     C***********          MOVELISPTY4    OFSPT4                          S01435
     C***********          MOVELISPTY5    OFSPT5                          S01435
     C***********          GOTO SR05N                                     S01435
     C***********          END                                            S01435
     C***********                                                      ***S01435
     C***********NADD      TAG                                            S01435
     C***IF*TYPE*BLANK IGNORE                                             S01435
     C***********ISPTP     IFEQ ' '                        B001           S01435
     C***********          GOTO SR05N                                     S01435
     C***********          END                             E001           S01435
     C***SET*UP*CUSTOMER*KEY                                        S01310S01435
     C*********************MOVELCUSTNO    KCUSNO                    S01310S01435
     C*********************MOVE 'B'       KEYA                      S01310S01435
     C***ACCESS*CLIENT*FILE                                         S01310S01435
     C***********CUSKEY****CHAINCLINTCCF             80             S01310S01435
     C*********************                                         S01310S01435
     C************IN80*****IFEQ '1'                         ))))))))S01310S01435
     C*********************MOVE 'CLINT'   DBFNAM            )))  DATS01310S01435
     C*********************MOVEL'      B' DBERKY            )))  BASS01310S01435
     C*********************MOVELKCUSNO    DBERKY            )))  BASS01310S01435
     C*********************MOVE '16'      DBERR#            ))) ERROS01310S01435
     C*********************EXSR DBERR                       )))   16S01310S01435
     C*********************END                              ))))))))S01310S01435
     C*********************MOVE CNA1      OFSPT2                    S01310S01435
     C*********************MOVE CNA2      OFSPT3                    S01310S01435
     C*********************MOVE CNA3      OFSPT4                    S01310S01435
     C*********************MOVE CNA4      OFSPT5                    S01310S01435
      ***********                                                   S01310S01435
      ***Access*SDCUSTPD with the customer number.                  S01310S01435
      ***********                                                   S01310S01435
     C***********          MOVE *BLANKS   @KEY1                     S01310S01435
     C***********          MOVELCUSTNO    @KEY1                     S01310S01435
     C***********          CALL 'AOCUSTR0'                          S01310S01435
     C***********          PARM '*MSG   ' @RTCD                     S01310S01435
     C***********          PARM '*KEY   ' @OPTN                     S01310S01435
     C***********          PARM           @KEY1  10                 S01310S01435
     C***********          PARM *BLANKS   @KYST   7                 S01310S01435
     C***********SDCUST    PARM SDCUST    DSSDY                     S01310S01435
      ***********                                                   S01310S01435
      ***Customer record not found - Error                          S01310S01435
      ***********                                                   S01310S01435
     C***********@RTCD     IFNE *BLANKS                             S01310S01435
     C***********          MOVE '16'      DBERR#             * * * *S01310S01435
     C***********          MOVEL@KEY1     DBERKY             * DBERRS01310S01435
     C***********          MOVEL'SDCUSTPD'DBFNAM             * * * *S01310S01435
     C***********          EXSR DBERR                               S01310S01435
     C***********          END                                      S01310S01435
     C***********          MOVELBBCNA1    OFSPT2                    S01310S01435
     C***********          MOVELBBCNA2    OFSPT3                    S01310S01435
     C***********          MOVELBBCNA3    OFSPT4                    S01310S01435
     C***********          MOVELBBCNA4    OFSPT5                    S01310S01435
      *                                                                   S01435
      * Use FT0315 to format text for D address type                      S01435
      *                                                                   S01435
      *                                                                   S01435
      *  Set up general parameters                                        S01435
      *                                                                   S01435
     C                     CLEARW8FT                                      S01435
     C                     MOVEL*BLANKS   W8STMT                          S01435
     C                     MOVEL##PGM     W8CPGM                          S01435
     C                     MOVEL'*MSG  '  W8ACT                           S01435
     C                     Z-ADD5         W8NLIN                          S01435
     C                     MOVEL'Y'       W8MTXT                          S01435
      *                                                                   S01435
      *  Format data to be translated                                     S01435
      *                                                                   S01435
     C                     MOVELISPTP     W8TYPE                          S01435
     C                     MOVELISCCY     W8CCY                           S01435
     C                     MOVEL*BLANKS   W8LINS                          S01435
     C                     MOVELISPTY1    ADCHK1                          S01435
     C                     MOVELISPTY2    ADCHK2                          S01435
     C                     MOVELISPTY3    ADCHK3                          S01435
     C                     MOVELISPTY4    ADCHK4                          S01435
     C                     MOVELISPTY5    ADCHK5                          S01435
     C           W8TYPE    IFEQ 'P'                                       S01435
     C           ISBRCA    ANDNE*BLANKS                                   S01435
     C                     MOVELISBRCA    ADPBRC                          S01435
     C                     END                                            S01435
     C                     MOVELADDRSS    W8LINS                          S01435
      *                                                                   S01435
      * Call expansion program                                            S01435
      *                                                                   S01435
     C                     CALL 'FT0315'               1111               S01435
     C                     PARM           W8RTN   7                       S01435
     C                     PARM           W8FT                            S01435
     C                     PARM           W8LINS256                       S01435
     C                     PARM           W8RPT 256                       S01435
     C                     PARM           W8MSG 256                       S01435
     C                     PARM           W8SCR 256                       S01435
      *                                                                   S01435
      ** Check if database error occurred                                 S01435
      *                                                                   S01435
     C           *IN11     IFEQ '1'                                       S01435
     C           W8RTN     ORNE *BLANKS                                   S01435
     C********** CSW207    IFEQ 'N'                                                   CSW207A 250600
     C                     MOVE '090'     DBERR#             * * * * * * *S01435
     C                     MOVEL'*CALL'   DBERKY             * DBERR 090 *S01435
     C                     MOVEL'FT0315'  DBFNAM             * * * * * * *S01435
     C                     EXSR DBERR                                     S01435
     C**********           ENDIF                                                      CSW207A 250600
     C                     END                                            S01435
      *                                                                   S01435
     C           CFT004    IFEQ 'Y'                                       CFT004
     C           W8TYPE    ANDEQ'I'                                       CFT004
     C                     MOVELW8RPT     ADDRSS                          CFT004
     C                     ELSE                                           CFT004
     C                     MOVELW8MSG     ADDRSS                          S01435
     C                     ENDIF                                          CFT004
     C                     MOVELADCHK1    OFSPT1                          S01435
     C                     MOVELADCHK2    OFSPT2                          S01435
     C                     MOVELADCHK3    OFSPT3                          S01435
     C                     MOVELADCHK4    OFSPT4                          S01435
     C                     MOVELADCHK5    OFSPT5                          S01435
      *                                                                   S01435
     C*                                                                ***
     C*                                                                ***
     C           SR05N     ENDSR                           END SR05
     C/EJECT
4630 C********************************************************************
     C********************************************************************
     C********************************************************************
     C*     *         SUBROUTINE 06                                    ***
     C*     *                                               ***        ***
     C*     *   DETERMINE AND FORMAT AMOUNT OUTGOING        ***        ***
     C*     *   PAYMENTS                                    ***        ***
     C*     *                                               ***        ***
     C*********************************************************        ***
     C           SR06      BEGSR                                       ***
      *                                                                   CEU006
      ** Charge calculation is already done in the main processing        CFT014
      ** after Tag :20:.                                                  CFT014
      *                                                                   CFT014
      **Sum*all*charges*into*work*field*used*for*Field*:72:*calcs* CEU006 CFT014
     C***********TXCH      ADD  CQCH      W#CHGS 130               CEU006 CFT014
     C***********          ADD  CSTA      W#CHGS                   CEU006 CFT014
     C***********          ADD  SPCH      W#CHGS                   CEU006 CFT014
     C***********          ADD  MSCH      W#CHGS                   CEU006 CFT014
     C***********          ADD  TRCM      W#CHGS                   CEU006 CFT014
     C***********          ADD  OPCHCM    W#CHGS                   CEU006 CFT014
     C***********          ADD  OPVATT    W#CHGS                   CEU006 CFT014
     C**********                                                       ***CEU006
     C******CHECK 'PAY PLUS CHARGES' IND NOT = 'Y' AND      **         ***CEU006
     C******'CHARGES TO THE DEBIT ACCOUNT' IS BLANK         **         ***CEU006
     C**********                                                       ***CEU006
     C********** ADDC      IFNE 'A'                                       CEU006
     C********** CDRO      ANDEQ*ZERO                                     CEU006
     C********** PYAM      SUB  TXCH      WAMNT  130                      CEU006
     C********** WAMNT     SUB  CQCH      WAMNT                           CEU006
     C********** WAMNT     SUB  CSTA      WAMNT                           CEU006
     C********** WAMNT     SUB  SPCH      WAMNT                           CEU006
     C********** WAMNT     SUB  MSCH      WAMNT                           CEU006
     C********** WAMNT     SUB  TRCM      WAMNT                           CEU006
     C**********                                                    S01494CEU006
     C****FX/Change*Commission**************************************S01494CEU006
     C********** WAMNT     SUB  OPCHCM    WAMNT                     S01494CEU006
     C**********                                                    S01499CEU006
     C****Total*V.A.T.*Amount***************************************S01499CEU006
     C********** WAMNT     SUB  OPVATT    WAMNT                     S01499CEU006
     C**********           END                                         ***CEU006
     C*                                                                ***
     C           ADDC      IFEQ 'A'
     C***********CDRO      ORNE *ZERO                                                         CSD027
     C           CDRO      ORNE *BLANKS                                                       CSD027
     C                     Z-ADDPYAM      WAMNT
     C                     ELSE                                           CEU006
     C           PYAM      SUB  W#CHGS    WAMNT                           CEU006
     C                     END
      *                                                                   CFT014
      ** Add Receiver's Charges Remitted from the extension file.         CFT014
      *                                                                   CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
     C                     ADD  OPRCRM    WAMNT                           CFT014
     C                     ENDIF                                          CFT014
     C*                                                                ***
     C*  ** FORMAT THE AMOUNT USING PROCEDURE SR03                     ***
     C                     EXSR SR03
     C*                                                                ***
     C                     ENDSR                           END SR06
     C/EJECT
4630 C********************************************************************
     C********************************************************************
     C********************************************************************
     C****************SUBROUTINE 08                         ***        ***S01310
     C**********OUTPUT*7*RECORDS TO THE OUTGOING SWIFT                 ***S01310
     C**********MESSAGES*FILE (PF/MSMSOPF).                 ***        ***S01310
     C**********OUTPUT*A*RECORD TO THE SWIFT REFERENCE      ***        ***S01310
     C**********FILE*(PF/MSIXOPF).                          ***        ***S01310
     C*********************************************************        ***S01310
     C***********SR08******BEGSR                                       ***S01310
     C*********************                                            ***S01310
     C****FIELDS*COMMON*TO*RECORDS TO BE OUTPUTTED                     ***S01310
     C*********************MOVE MXMIND    MSMI                         ***S01310
     C*********************MOVELMXTREF    TNRF                         ***S01310
     C*********************MOVE MXDFLG    PTDL                         ***S01310
     C*********************                                            ***S01310
     C****FIRST*RECORD*****                                            ***S01310
     C*********************MOVELMT1001    MDTA                         ***S01310
     C*********************WRITEMSMSOPFF               42  ON, D/B ERROR  S01310
     C************IN42*****CABEQ'1'       WRTERR                          S01310
     C*********************                                            ***S01310
     C****SECOND*RECORD****                                            ***S01310
     C*********************MOVELMT1002    MDTA                         ***S01310
     C*********************WRITEMSMSOPFF               42  ON, D/B ERROR  S01310
     C************IN42*****CABEQ'1'       WRTERR                          S01310
     C*********************                                            ***S01310
     C****THIRD*RECORD*****                                            ***S01310
     C*********************MOVELMT1003    MDTA                         ***S01310
     C*********************WRITEMSMSOPFF               42  ON, D/B ERROR  S01310
     C************IN42*****CABEQ'1'       WRTERR                          S01310
     C*********************                                            ***S01310
     C****FOURTH*RECORD****                                            ***S01310
     C*********************MOVELMT1004    MDTA                         ***S01310
     C*********************WRITEMSMSOPFF               42  ON, D/B ERROR  S01310
     C************IN42*****CABEQ'1'       WRTERR                          S01310
     C*********************                                            ***S01310
     C****FIFTH*RECORD*****                                            ***S01310
     C*********************MOVELMT1005    MDTA                         ***S01310
     C*********************WRITEMSMSOPFF               42  ON, D/B ERROR  S01310
     C************IN42*****CABEQ'1'       WRTERR                          S01310
     C*********************                                            ***S01310
     C****SIXTH*RECORD*****                                            ***S01310
     C*********************MOVELMT1006    MDTA                         ***S01310
     C*********************WRITEMSMSOPFF               42  ON, D/B ERROR  S01310
     C************IN42*****CABEQ'1'       WRTERR                          S01310
     C*********************                                            ***S01310
     C****SEVENTH*RECORD***                                            ***S01310
     C*********************MOVELMT1007    MDTA                         ***S01310
     C*********************WRITEMSMSOPFF               42  ON, D/B ERROR  S01310
     C************IN42*****CABEQ'1'       WRTERR                          S01310
     C*********************                                         S01177S01310
     C****EIGHTH*RECORD****                                         S01177S01310
     C*********************MOVELMT1008    MDTA                      S01177S01310
     C*********************WRITEMSMSOPFF               42  ON, D/B ES01177S01310
     C************IN42*****CABEQ'1'       WRTERR                    S01177S01310
     C*********************ADD  7         P3NO2                     S01177S01310
     C*********************ADD  8         P3NO2                    S01177 S01117
     C*********************ADD  8         AUNO2                     S01117S01310
     C*********************                                            ***S01310
     C***FORMAT*AND*OUTPUT*A RECORD TO THE SWIFT                       ***S01310
     C***REFERENCE*FILE*(PF/MSIXOPF)                                   ***S01310
     C*********************MOVE 'D'       RECI                            S01310
     C*********************MOVE 'P'       MSMI                            S01310
     C*********************MOVE PREF      PREFS  14                       S01310
     C*********************MOVELPREFS     TNRF                            S01310
     C*********************MOVE FTCS      MSTS                            S01310
     C*********************MOVE RUNA      LADT                            S01310
     C*********************TIME           LATM                            S01310
     C*********************MOVE PYTP      TNTP                            S01310
     C*********************MOVE PYST      SBTP                            S01310
     C*********************MOVE '100'     MTPY                            S01310
     C*********************MOVE SWPC      MSGP                            S01310
     C*********************MOVE SCRNM     RPNM                            S01310
     C*********************MOVE SCTWN     RPTN                            S01310
     C*********************TIME           MGTM                            S01310
     C*********************MOVE RUNA      MGDT                            S01310
     C*********************MOVE MXOTID    STID                            S01310
     C*********************MOVE RECADD    DTID                            S01310
     C*********************MOVE SBICN     SECN                            S01310
     C*********************MOVE SCUSNO    DECN                            S01310
     C*********************MOVE SWTWRK    SWTX    1                       S01310
     C***********AUP2******IFNE *BLANK                                    S01310
     C*********************MOVE AUP2      RUSR                            S01310
     C*********************ELSE                                           S01310
     C*********************MOVE AUP1      RUSR                            S01310
     C*********************END                                            S01310
     C*********************MOVE SRUNA     RELD                            S01310
     C*********************MOVE LCHT      RELT                            S01310
     C*********************MOVE M1AMNT    AMTS                            S01310
     C*********************MOVE PVDTD3    SVDT                            S01310
     C*********************MOVELM1RCCY    NSTR                            S01310
     C********************* OVE 'Y'       TSKS                            S01310
     C*********************MOVE BRCAA     BRCA                      S01117S01310
     C**IF*MULTIBRANCH*INDICATOR FROM RUNDAT ACTIVE                 S01117S01310
     C************IN50*****IFEQ '1'                                 S01117S01310
     C***********BRCAA*****IFNE ORBR                                S01117S01310
     C*********************MOVE ORBR      OTHB                      S01117S01310
     C**MOVE*"ORIGINATING*BRANCH" TO 'OTHER BRANCH TYPE'(OTHT)      S01117S01310
     C*********************MOVE ' BRANCH"'FLD1   20                 S01117S01310
     C*********************MOVEL'"ORIGINA'FLD2   12                 S01117S01310
     C*********************MOVE 'TING'    FLD2                      S01117S01310
     C*********************MOVELFLD2      FLD1                      S01117S01310
     C*********************MOVE FLD1      OTHT                      S01117S01310
     C*********************                                         S01117S01310
     C*********************ELSE                                     S01117S01310
     C*********************MOVE *BLANKS   OTHB                      S01117S01310
     C*********************MOVE *BLANKS   OTHT                      S01117S01310
     C*********************END                                      S01117S01310
     C**IF*MULTIBRANCH*INDICATOR FROM RUNDAT NOT ACTIVE             S01117S01310
     C*********************ELSE                                     S01117S01310
     C*********************MOVE *BLANKS   OTHB                      S01117S01310
     C*********************MOVE *BLANKS   OTHT                      S01117S01310
     C*********************END                                      S01117S01310
     C*********************WRITEMSIXOPFF               41  ON, D/B ERROR  S01310
     C************IN41*****IFEQ '1'                         ))))))))))))))S01310
     C*********************MOVE 'MSIXOPFF'DBFNAM            )))  DATA  )))S01310
     C*********************MOVELMXTREF    DBERKY            )))  BASE  )))S01310
     C*********************MOVE '17'      DBERR#            ))) ERROR  )))S01310
     C*********************EXSR DBERR                       )))   17   )))S01310
     C*********************END                              ))))))))))))))S01310
     C*********************                                               S01310
     C**N41****************ADD  1         P3NO3                           S01117
     C**N41****************ADD  1         AUNO3                     S01117S01310
     C*********************GOTO SR08N                                     S01310
     C*********************                                            ***S01310
     C***********WRTERR****TAG                              ))))))))))))))S01310
     C*********************MOVE 'MSMSOPFF'DBFNAM            )))  DATA  )))S01310
     C*********************MOVELMXTREF    DBERKY            )))  BASE  )))S01310
     C*********************MOVE '05'      DBERR#            ))) ERROR  )))S01310
     C*********************EXSR DBERR                       )))   05   )))S01310
     C*********************                                 ))))))))))))))S01310
     C*********************                                            ***S01310
     C***********SR08N*****ENDSR                           END SR08       S01310
     C*/EJECT**************                                               S01310
4630 C********************************************************************
     C/COPY WNCPYSRC,FT0641C037
     C*****************************************************************   S01310
     C*   OMSG - output correctly generated messages                  *   S01310
     C*   Called by - main process                                    *   S01310
     C*   Calls - WREF Write o/p reference to PF/MGOREFPD.            *   S01310
     C*****************************************************************   S01310
      *                                                                   S01310
     C           OMSG      BEGSR                                          S01310
      *                                                                   S01310
      **  Write reference record to PF/MGOREFPD.                          S01310
      *                                                                   S01310
     C                     EXSR WREF                                      S01310
     C/COPY WNCPYSRC,FTH00009
      *                                                                   CFT014
      ** Set off indicator for the printing of Block 3 Data in FT0640P1   CFT014
      ** for M103+ message.                                               CFT014
      *                                                                   CFT014
     C                     MOVE *OFF      *IN29                           CFT014
     C           WMT103    IFEQ 'Y'                                       CFT014
     C           W23E      ANDEQ'Y'                                       CFT014
     C           W52A      ANDEQ'Y'                                                           208890
     C           W53A      ANDEQ'Y'                                       CFT014
     C           W54A      ANDEQ'Y'                                       CFT014
     C           W55A      ANDEQ'Y'                                       CFT014
     C           W56A      ANDEQ'Y'                                       CFT014
     C           W57A      ANDEQ'Y'                                       CFT014
     C           W59A      ANDEQ'Y'                                       CFT014
     C           W72       ANDEQ'Y'                                       CFT014
     C********** WKIBAR    ANDEQ'Y'                                                  CSW213 MD021993
      *                                                                   CFT014
     C                     MOVE *ON       *IN29                           CFT014
     C/COPY WNCPYSRC,FT0641C063
     C                     MOVEL'STP'     BLK3                            CFT014
      *                                                                   CFT014
     C                     ADD  1         Q                               CFT014
     C           Q         OCUR MULT                                      CFT014
     C                     MOVEL':119:'   MTAG                            CFT014
     C                     MOVEL*BLANKS   MFLD                            CFT014
     C                     MOVEL'STP'     MFLD                            CFT014
     C                     WRITEMGOMSGD0               42                 CFT014
     C/COPY WNCPYSRC,FTH00504
     C           *IN42     IFEQ *ON                                       CFT014
     C                     MOVE '042'     DBERR#                          CFT014
     C                     MOVEL*BLANKS   DBERKY                          CFT014
     C                     MOVEL'MGOMSGPD'DBFNAM                          CFT014
     C                     EXSR DBERR                                     CFT014
     C                     ENDIF                                          CFT014
     C                     MOVE *BLANKS   MULT                            CFT014
     C/COPY WNCPYSRC,FT0641C064
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                                       CSW209
      ** access outgoing payments details extension file to                                   CSW209
      ** update cover fields                                                                  CSW209
      *                                                                                       CSW209
     C           CSW209    IFEQ 'Y'                                                           CSW209
     C           PREF      CHAINOTPAYXL0             51                                       CSW209
     C           *IN29     IFEQ *ON                                                           CSW209
     C                     MOVEL'STP'     OPOMVF                                              CSW209
     C                     ELSE                                                               CSW209
     C                     MOVE *BLANKS   OPOMVF                                              CSW209
     C                     ENDIF                                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                   S01310
      **  Write multiple occurrence data structure to MGOMSGPD            S01310
     C                     Z-ADD1         Q       20                      S01310
     C           Q         OCUR MULT                                      S01310
      *                                                                   S01310
     C           Q         DOWLE50                                        S01310
     C           MFLD      ANDNE*BLANKS                                   S01310
     C                     WRITEMGOMSGD0               42                 S01310
     C/COPY WNCPYSRC,FTH00505
      *                                                                   S01310
      **  Error on write to PF/MGOMSGPD (message data file)               S01310
      *                                                                   S01310
     C           *IN42     IFEQ '1'                                       S01310
     C                     MOVE '05'      DBERR#           * * * * * * * *S01310
     C                     MOVEL'       ' DBERKY           *  DBERR 005  *S01310
     C                     MOVEL'MGOMSGPD'DBFNAM           * * * * * * * *S01310
     C                     EXSR DBERR                                     S01310
     C                     END                                            S01310
      *                                                                                     BUG24436
      ** Check if MT202 COV fields needs to be generated                                    BUG24436
      *                                                                                     BUG24436
     C           CSW209    IFEQ 'Y'                                                         BUG24436
     C                     MOVE *OFF      *IN35                                             BUG24436
     C           OPOCVF    IFEQ 'COV'                                                       BUG24436
     C                     MOVE *ON       *IN35                                             BUG24436
      *                                                                                     BUG24436
     C                     ELSE                                                             BUG24436
      *                                                                                     BUG26018
     C           SNMT      IFEQ 'Y'                                                         BUG26018
      *                                                                                     BUG24436
      ** Check if Bilateral Agreement exist                                                 BUG24436
      *                                                                                     BUG24436
     C                     MOVEL*BLANKS   PS2RIN                                            BUG24436
     C                     MOVEL*BLANKS   PSNDCR                                            BUG24436
     C                     MOVEL*BLANKS   PRCVCR                                            BUG24436
     C                     MOVEL*BLANKS   PORBNK                                            BUG24436
      *                                                                                     BUG24436
     C                     MOVELNWSN      WNWSN  11                                         BUG24436
     C                     MOVELORBK      PORBNK                                            BUG24436
     C           BBI1      CAT  BBI2      PS2RIN                                            BUG24436
     C           PS2RIN    CAT  BBI3      PS2RIN                                            BUG24436
     C           PS2RIN    CAT  BBI4      PS2RIN                                            BUG24436
     C           PS2RIN    CAT  BBI5      PS2RIN                                            BUG24436
     C           PS2RIN    CAT  BBI6      PS2RIN                                            BUG24436
     C                     MOVELSNCO      PSNDCR                                            BUG24436
     C           SNCT      IFEQ 'N'                                                         BUG24436
     C                     MOVELSNCO      PSNDN   2                                         BUG24436
     C                     MOVEL*BLANKS   PSNDCR                                            BUG24436
     C                     MOVELPSNDN     PSNDCR                                            BUG24436
     C                     ENDIF                                                            BUG24436
     C           RCO1      CAT  RCO2      PRCVCR                                            BUG24436
     C           PRCVCR    CAT  RCO3      PRCVCR                                            BUG24436
     C           PRCVCR    CAT  RCO4      PRCVCR                                            BUG24436
     C           PRCVCR    CAT  RCO5      PRCVCR                                            BUG24436
      *                                                                                     BUG24436
     C                     CALL 'AOBAGRV0'                                                  BUG24436
     C                     PARM *BLANKS   PRTCD                                             BUG24436
     C                     PARM 'SCT_C202'PBAGR  10                                         BUG24436
     C                     PARM BRCAA     PBRCH   3                                         BUG24436
     C                     PARM NWRK      PNWRK   6                                         BUG24436
     C                     PARM '103'     PMTYP   3                                         BUG24436
     C                     PARM SMCY      PSCUR   3                                         BUG24436
     C                     PARM PCCY      PPCUR   3                                         BUG24436
     C                     PARM WNWSN     PSSWID 11                                         BUG24436
     C                     PARM NWDS      PRSWID 11                                         BUG24436
     C                     PARM *BLANKS   PVALF   8                                         BUG24436
     C                     PARM           PORBNK256                                         BUG24436
     C                     PARM           PS2RIN256                                         BUG24436
     C                     PARM           PSNDCR256                                         BUG24436
     C                     PARM           PRCVCR256                                         BUG24436
      *                                                                                     BUG24436
     C           PRTCD     IFEQ '*CRTCOV'                                                   BUG24436
     C                     MOVE *ON       *IN35                                             BUG24436
     C                     ENDIF                                                            BUG24436
     C                     ENDIF                                                            BUG26018
     C                     ENDIF                                                            BUG24436
     C                     ENDIF                                                            BUG24436
      *                                                                                       CSW209
      ** if outgoing validation flag (cover) is set to 'COV'                                  CSW209
      ** populate corresponding cover fields                                                  CSW209
      *                                                                                       CSW209
     C           CSW209    IFEQ 'Y'                                                           CSW209
     C********** OPOCVF    ANDEQ'COV'                                                CSW209 BUG24436
     C           *IN35     ANDEQ*ON                                                         BUG24436
      *                                                                                       CFT124
      ** If CFT124 is *ON                                                                     CFT124
      *                                                                                       CFT124
     C           CFT124    IFEQ 'Y'                                                           CFT124
      *                                                                                       CFT124
     C                     MOVELORCT      ISPTP                                               CFT124
     C                     MOVELSMCY      ISCCY                                               CFT124
     C                     MOVELORC1      ISPTY1                                              CFT124
      *                                                                                       CFT124
     C                     SELEC                                                              CFT124
     C           MTAG      WHEQ ':50A:'                                                       CFT124
     C           MTAG      OREQ ':50F:'                                                       CFT124
      *                                                                                       CFT124
     C           PMSGL1    IFNE *BLANK                                                        CFT124
     C                     MOVELPMSGL1    OPCOC1                                              CFT124
     C                     MOVELPMSGL2    OPCOC2                                              CFT124
     C                     MOVELPMSGL3    OPCOC3                                              CFT124
     C                     MOVELPMSGL4    OPCOC4                                              CFT124
     C                     MOVELPMSGL5    OPCOC5                                              CFT124
     C                     ELSE                                                               CFT124
     C                     MOVELM1ORC1    OPCOC1                                              CFT124
     C                     MOVELM1ORC2    OPCOC2                                              CFT124
     C                     MOVELM1ORC3    OPCOC3                                              CFT124
     C                     MOVELM2ORC4    OPCOC4                                              CFT124
     C                     MOVELM2ORC5    OPCOC5                                              CFT124
     C                     ENDIF                                                              CFT124
     C                     ENDSL                                                              CFT124
      *                                                                                       CFT124
     C                     SELEC                                                              CFT124
     C           MTAG      WHEQ ':50A:'                                                       CFT124
     C                     MOVEL'S'       OPCOCT                                              CFT124
     C           MTAG      WHEQ ':50F:'                                                       CFT124
     C                     MOVEL'A'       OPCOCT                                              CFT124
     C                     ENDSL                                                              CFT124
      *                                                                                       CFT124
      ** Include 50K in MT202COV for Ordering Customer                                        263187
      ** Type Address                                                                         263187
      *                                                                                       263187
     C           MTAG      IFEQ ':50K:'                                                       263187
     C           ISPTP     ANDEQ'A'                                                           263187
     C           PMSGL1    IFNE *BLANK                                                        263187
     C                     MOVELPMSGL1    OPCOC1                                              263187
     C                     MOVELPMSGL2    OPCOC2                                              263187
     C                     MOVELPMSGL3    OPCOC3                                              263187
     C                     MOVELPMSGL4    OPCOC4                                              263187
     C                     MOVELPMSGL5    OPCOC5                                              263187
     C                     ELSE                                                               263187
     C                     MOVELM1ORC1    OPCOC1                                              263187
     C                     MOVELM1ORC2    OPCOC2                                              263187
     C                     MOVELM1ORC3    OPCOC3                                              263187
     C                     MOVELM2ORC4    OPCOC4                                              263187
     C                     MOVELM2ORC5    OPCOC5                                              263187
     C                     ENDIF                                                              263187
     C                     MOVEL'A'       OPCOCT                                              263187
     C                     ENDIF                                                              263187
      *                                                                                       263187
     C           MTAG      IFEQ ':50K:'                                                       CFT124
     C           ISPTP     ANDEQ'R'                                                           CFT124
     C           MTAG      OREQ ':50K:'                                                       CFT124
     C           ISPTP     ANDEQ'P'                                                           CFT124
      *                                                                                       CFT124
      ** Get account details if Partial Account                                               CFT124
      *                                                                                       CFT124
     C           ISPTP     IFEQ 'P'                                                           CFT124
     C                     MOVEL*BLANKS   DS@ORC                                              CFT124
     C                     MOVELISPTY1    DS@ORC                                              CFT124
     C           @ORBRC    IFEQ *BLANKS                                                       CFT124
     C                     MOVELBJSBRC    @ORBRC                                              CFT124
     C                     ENDIF                                                              CFT124
     C                     MOVELISCCY     @ORCCY                                              CFT124
     C                     CALL 'AOACCTR0'             9090                                   CFT124
     C                     PARM *BLANKS   @RTCD                                               CFT124
     C                     PARM '*KEY   ' @OPTN                                               CFT124
     C                     PARM *BLANKS   @RETL                                               CFT124
     C                     PARM @ORCNU    @CNUM                                               CFT124
     C                     PARM @ORCCY    @CUCD                                               CFT124
     C                     PARM @ORACD    @ACOD                                               CFT124
     C                     PARM @ORACS    @ACSQ                                               CFT124
     C                     PARM @ORBRC    @BRCA                                               CFT124
     C           OACCNT    PARM           DSSDY                                               CFT124
      *                                                                                       CFT124
     C           *IN90     IFEQ '1'                                                           CFT124
     C           @RTCD     ORNE *BLANKS                                                       CFT124
     C                     MOVEL'AOACCTR0'DBFNAM           ***************                    CFT124
     C                     MOVELISPTY1    DBERKY           * DB ERROR 56 *                    CFT124
     C                     MOVE '056'     DBERR#           ***************                    CFT124
     C                     EXSR DBERR                                                         CFT124
     C                     ENDIF                                                              CFT124
     C                     ENDIF                                                              CFT124
      *                                                                                       CFT124
     C                     MOVE *BLANKS   @@CNUM                                              CFT124
     C                     MOVE CNUM      @@CNUM                                              CFT124
     C                     MOVELCCY       @@CCY                                               CFT124
     C                     Z-ADDACOD      @@ACOD                                              CFT124
     C                     Z-ADDACSQ      @@ACSQ                                              CFT124
     C                     MOVELBRCA      @@BRCA                                              CFT124
     C                     MOVEL*BLANKS   @@ACNO                                              CFT124
     C                     MOVELWACCT     @@ACNO                                              CFT124
      *                                                                                       CFT124
     C           W#AFMT    IFEQ 'Y'                                                           CFT124
      *                                                                                       CFT124
     C           W#IBAN    IFEQ 'Y'                                                           CFT124
     C           W#RTNO    OREQ 'Y'                                                           CFT124
     C           W#GLAR    OREQ 'Y'                                                           CFT124
     C           W#ACNM    OREQ 'Y'                                                           CFT124
      *                                                                                       CFT124
s1   C           W#ACNM    IFEQ 'Y'                                                           CFT124
     C           '/'       CAT  ANAM:0    OPCOC1                                              CFT124
x1   C                     ELSE                                                               CFT124
s2   C           W#IBAN    IFEQ 'Y'                                                           CFT124
s3   C           IBAN      IFEQ *BLANKS                                                       CFT124
s4   C           W#RTNO    IFEQ 'Y'                                                           CFT124
     C           ACNO      ANDNE0                                                             CFT124
     C           '/'       CAT  @@ACNO:0  OPCOC1                                              CFT124
x4   C                     ELSE                                                               CFT124
s5   C           W#GLAR    IFEQ 'Y'                                                           CFT124
     C           '/'       CAT  DSACC:0   OPCOC1                                              CFT124
e5   C                     ENDIF                                                              CFT124
e4   C                     ENDIF                                                              CFT124
x3   C                     ELSE                                                               CFT124
     C           '/'       CAT  IBAN:0    OPCOC1                                              CFT124
e3   C                     ENDIF                                                              CFT124
x2   C                     ELSE                                                               CFT124
s3   C           W#RTNO    IFEQ 'Y'                                                           CFT124
     C           ACNO      ANDNE0                                                             CFT124
     C           '/'       CAT  @@ACNO:0  OPCOC1                                              CFT124
x3   C                     ELSE                                                               CFT124
s4   C           W#GLAR    IFEQ 'Y'                                                           CFT124
     C           '/'       CAT  DSACC:0   OPCOC1                                              CFT124
e4   C                     ENDIF                                                              CFT124
e3   C                     ENDIF                                                              CFT124
e2   C                     ENDIF                                                              CFT124
e1   C                     ENDIF                                                              CFT124
      *                                                                                       CFT124
     C                     ENDIF                                                              CFT124
      *                                                                                       CFT124
     C                     MOVEL'A'       OPCOCT                                              CFT124
      *                                                                                       CFT124
      ** Set Report fields                                                                    CFT124
      *                                                                                       CFT124
     C                     MOVELM1ORC2    OPCOC2                                              CFT124
     C                     MOVELM1ORC3    OPCOC3                                              CFT124
     C                     MOVELM2ORC4    OPCOC4                                              CFT124
     C                     ENDIF                                                              CFT124
      *                                                                                       CFT124
     C                     ENDIF                                                              CFT124
      *                                                                                       CFT124
      ** EndIf for CFT124 *On                                                                 CFT124
      *                                                                                       CFT124
     C                     ENDIF                                                              CFT124
      *                                                                                       CFT124
     C           CFT124    IFEQ 'N'                                                           CFT124
      *                                                                                       CFT124
      *                                                                                       CSW209
     C                     SELEC                                                              CSW209
      *                                                                                       CSW209
     C           MTAG      WHEQ ':50A:'                                                       CSW209
     C           MTAG      OREQ ':50K:'                                                       CSW209
     C           MTAG      OREQ ':50F:'                                                       CSW209
      *                                                                                       CSW209
     C           PMSGL1    IFNE *BLANK                                                      BUG24937
     C                     MOVELPMSGL1    OPCOC1                                            BUG24937
     C                     MOVELPMSGL2    OPCOC2                                            BUG24937
     C                     MOVELPMSGL3    OPCOC3                                            BUG24937
     C                     MOVELPMSGL4    OPCOC4                                            BUG24937
     C                     MOVELPMSGL5    OPCOC5                                            BUG24937
     C                     ELSE                                                             BUG24937
     C                     MOVELM1ORC1    OPCOC1                                              CSW209
     C                     MOVELM1ORC2    OPCOC2                                              CSW209
     C                     MOVELM1ORC3    OPCOC3                                              CSW209
     C                     MOVELM2ORC4    OPCOC4                                              CSW209
     C                     MOVELM2ORC5    OPCOC5                                              CSW209
     C                     ENDIF                                                            BUG24937
     C                     ENDSL                                                              CFT124
      *                                                                                       CSW209
     C                     SELEC                                                              CSW209
     C           MTAG      WHEQ ':50A:'                                                       CSW209
     C                     MOVEL'S'       OPCOCT                                              CSW209
     C           MTAG      WHEQ ':50K:'                                                       CSW209
     C           MTAG      OREQ ':50F:'                                                       CSW209
     C                     MOVEL'A'       OPCOCT                                              CSW209
     C                     ENDSL                                                              CSW209
      *                                                                                       CFT124
     C                     ENDIF                                                              CFT124
      *                                                                                       CFT124
     C                     SELEC                                                              CFT124
      *                                                                                       CSW209
     C           MTAG      WHEQ ':52A:'                                                       CSW209
     C                     MOVEL'S'       OPCOBT                                              CSW209
     C                     MOVELM2OBK1    OPCOB1                                              CSW209
     C                     MOVELM2OBK2    OPCOB2                                              CSW209
     C                     MOVELM2OBK3    OPCOB3                                              CSW209
     C                     MOVELM2OBK4    OPCOB4                                              CSW209
     C                     MOVELM2OBK5    OPCOB5                                              CSW209
     C           MTAG      WHEQ ':52D:'                                                       CSW209
     C                     MOVEL'A'       OPCOBT                                              CSW209
     C                     MOVELM2OBK1    OPCOB1                                              CSW209
     C                     MOVELM2OBK2    OPCOB2                                              CSW209
     C                     MOVELM2OBK3    OPCOB3                                              CSW209
     C                     MOVELM2OBK4    OPCOB4                                              CSW209
     C                     MOVELM2OBK5    OPCOB5                                              CSW209
     C           MTAG      WHEQ ':56A:'                                                       CSW209
     C                     MOVEL'S'       OPCIBT                                              CSW209
     C                     MOVELM4INB1    OPCIB1                                              CSW209
     C                     MOVELM4INB2    OPCIB2                                              CSW209
     C                     MOVELM4INB3    OPCIB3                                              CSW209
     C                     MOVELM4INB4    OPCIB4                                              CSW209
     C                     MOVELM4INB5    OPCIB5                                              CSW209
     C           MTAG      WHEQ ':56C:'                                                       CSW209
     C                     MOVEL'Z'       OPCIBT                                              CSW209
     C                     MOVELM4INB1    OPCIB1                                              CSW209
     C                     MOVELM4INB2    OPCIB2                                              CSW209
     C                     MOVELM4INB3    OPCIB3                                              CSW209
     C                     MOVELM4INB4    OPCIB4                                              CSW209
     C                     MOVELM4INB5    OPCIB5                                              CSW209
     C           MTAG      WHEQ ':56D:'                                                       CSW209
     C                     MOVEL'A'       OPCIBT                                              CSW209
     C                     MOVELM4INB1    OPCIB1                                              CSW209
     C                     MOVELM4INB2    OPCIB2                                              CSW209
     C                     MOVELM4INB3    OPCIB3                                              CSW209
     C                     MOVELM4INB4    OPCIB4                                              CSW209
     C                     MOVELM4INB5    OPCIB5                                              CSW209
     C           MTAG      WHEQ ':57A:'                                                       CSW209
     C                     MOVEL'S'       OPCABT                                              CSW209
     C                     MOVELM4AWB1    OPCAB1                                              CSW209
     C                     MOVELM4AWB2    OPCAB2                                              CSW209
     C                     MOVELM5AWB3    OPCAB3                                              CSW209
     C                     MOVELM5AWB4    OPCAB4                                              CSW209
     C                     MOVELM5AWB5    OPCAB5                                              CSW209
     C           MTAG      WHEQ ':57B:'                                                       CSW209
     C                     MOVEL'Y'       OPCABT                                              CSW209
     C                     MOVELM4AWB1    OPCAB1                                              CSW209
     C                     MOVELM4AWB2    OPCAB2                                              CSW209
     C                     MOVELM5AWB3    OPCAB3                                              CSW209
     C                     MOVELM5AWB4    OPCAB4                                              CSW209
     C                     MOVELM5AWB5    OPCAB5                                              CSW209
     C           MTAG      WHEQ ':57C:'                                                       CSW209
     C                     MOVEL'Z'       OPCABT                                              CSW209
     C                     MOVELM4AWB1    OPCAB1                                              CSW209
     C                     MOVELM4AWB2    OPCAB2                                              CSW209
     C                     MOVELM5AWB3    OPCAB3                                              CSW209
     C                     MOVELM5AWB4    OPCAB4                                              CSW209
     C                     MOVELM5AWB5    OPCAB5                                              CSW209
     C           MTAG      WHEQ ':57D:'                                                       CSW209
     C                     MOVEL'A'       OPCABT                                              CSW209
     C                     MOVELM4AWB1    OPCAB1                                              CSW209
     C                     MOVELM4AWB2    OPCAB2                                              CSW209
     C                     MOVELM5AWB3    OPCAB3                                              CSW209
     C                     MOVELM5AWB4    OPCAB4                                              CSW209
     C                     MOVELM5AWB5    OPCAB5                                              CSW209
     C           MTAG      WHEQ ':59A:'                                                       CSW209
     C                     MOVEL'S'       OPCBCT                                              CSW209
     C                     MOVELM5BBK1    OPCBC1                                              CSW209
     C                     MOVELM5BBK2    OPCBC2                                              CSW209
     C                     MOVELM5BBK3    OPCBC3                                              CSW209
     C                     MOVELM6BBK4    OPCBC4                                              CSW209
     C                     MOVELM6BBK5    OPCBC5                                              CSW209
     C           MTAG      WHEQ ':59: '                                                       CSW209
     C                     MOVEL'A'       OPCBCT                                              CSW209
     C                     MOVELM5BBK1    OPCBC1                                              CSW209
     C                     MOVELM5BBK2    OPCBC2                                              CSW209
     C                     MOVELM5BBK3    OPCBC3                                              CSW209
     C                     MOVELM6BBK4    OPCBC4                                              CSW209
     C                     MOVELM6BBK5    OPCBC5                                              CSW209
     C           MTAG      WHEQ ':59F:'                                                       CSW215
     C                     MOVEL'A'       OPCBCT                                              CSW215
     C                     MOVELPBENF1    OPCBC1                                              CSW215
     C                     MOVELPBENF2    OPCBC2                                              CSW215
     C                     MOVELPBENF3    OPCBC3                                              CSW215
     C                     MOVELPBENF4    OPCBC4                                              CSW215
     C                     MOVELPBENF5    OPCBC5                                              CSW215
     C           MTAG      WHEQ ':70: '                                                       CSW209
     C                     MOVELDTP1      OPCDP1                                              CSW209
     C                     MOVELDTP2      OPCDP2                                              CSW209
     C                     MOVELDTP3      OPCDP3                                              CSW209
     C                     MOVELDTP4      OPCDP4                                              CSW209
     C           MTAG      WHEQ ':72: '                                                       CSW209
     C                     MOVELBBI1      OPCBB1                                              CSW209
     C                     MOVELBBI2      OPCBB2                                              CSW209
     C                     MOVELBBI3      OPCBB3                                              CSW209
     C                     MOVELBBI4      OPCBB4                                              CSW209
     C                     MOVELBBI5      OPCBB5                                              CSW209
     C                     MOVELBBI6      OPCBB6                                              CSW209
     C           MTAG      WHEQ ':33B:'                                                       CSW209
     C                     MOVELPDCY      OPCICY                                              CSW209
     C                     Z-ADDPDAM      OPCIAM                                              CSW209
     C                     ENDSL                                                              CSW209
      *                                                                                       CSW209
     C                     ENDIF                                                              CSW209
      *                                                                   S01310
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     END                                            S01310
      *                                                                                       CSW209
     C           CSW209    IFEQ 'Y'                                                           CSW209
     C           *IN51     ANDEQ*OFF                                                          CSW209
     C                     UPDATOTPAYXDF                                                      CSW209
     C                     ENDIF                                                              CSW209
      *                                                                   138077
      **  Write multiple occurrence data structure to MGOEXTPD            138077
      *                                                                   138077
     C                     Z-ADD1         V       20                      138077
     C           V         OCUR EXTN                                      138077
     C           V         DOWLE20                                        138077
     C           MCSI      ANDNE*BLANKS                                   138077
     C                     WRITEMGOEXTD0               43                 138077
      *                                                                   138077
      **  Error on write to PF/MGOEXTPD (message data extension file)     138077
      *                                                                   138077
     C           *IN43     IFEQ '1'                                       138077
     C                     MOVE '043'     DBERR#           * * * * * * * *138077
     C                     MOVEL'        'DBERKY           *  DBERR 043  *138077
     C                     MOVEL'MGOEXTPD'DBFNAM           * * * * * * * *138077
     C                     EXSR DBERR                                     138077
     C                     END                                            138077
     C                     ADD  1         V                               138077
     C           V         OCUR EXTN                                      138077
     C                     ENDDO                                          138077
      *                                                                   S01310
     C/COPY WNCPYSRC,FT0641C024
     C                     ENDSR                                          S01310
     C/EJECT                                                              S01310
     C/COPY WNCPYSRC,FT0641C025
     C*****************************************************************   S01310
     C*   WREF - Write reference record to PF/MGOREFPD                *   S01310
     C*   Called by - OMSG  output message PF/MGOMSGPD                *   S01310
     C*   Calls     -                                                 *   S01310
     C*****************************************************************   S01310
      *                                                                   S01310
     C           WREF      BEGSR                                          S01310
      *                                                                   S01310
     C                     MOVE *BLANKS   SYTM                            S01310
     C                     MOVEL'FT'      MODI                            S01310
     C                     MOVELTRNA      TRNO                            S01310
     C                     MOVE *BLANKS   TRNF                            S01310
     C                     MOVE *BLANKS   TRNM                            S01310
     C                     MOVELPREF      MTRN                            S01310
     C                     MOVE PYTP      TNTP                            S01310
     C                     MOVE PYST      SBTP                            S01310
     C                     MOVE *BLANKS   EVTP                            S01310
     C                     MOVELSBICN     SECN                            S01310
     C                     MOVELSCUSNO    DECN                            S01310
     C/COPY WNCPYSRC,FT0641C047
     C                     MOVELBNC1      NWBN                            S01310
     C/COPY WNCPYSRC,FT0641C048
     C                     MOVE '100'     MTPY                            S01310
     C           WMT103    IFEQ 'Y'                                       CFT014
     C                     MOVE '103'     MTPY                            CFT014
     C                     ENDIF                                          CFT014
     C/COPY WNCPYSRC,FT0641C032
     C*********************MOVELSWPC      MPRY                      S01310S01117
     C*  FORMAT SWIFT PRIORITY CODE                                       S01117
     C*                                                                   S01117
     C           SWPC      IFEQ 1                                         S01117
     C                     MOVE 'U'       MPRY                            S01117
     C                     ELSE                                           S01117
     C           SWPC      IFEQ 2                                         S01117
     C                     MOVE 'N'       MPRY                            S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C                     MOVEL*BLANKS   LSCC                            S01310
     C                     MOVEL*BLANKS   PTST                            S01310
     C                     MOVEL*BLANKS   CARQ                            S01310
     C                     MOVEL*BLANKS   MPDE                            S01310
     C                     MOVEL@HRDT     HRDT                            S01310
     C/COPY WNCPYSRC,FT0641C056
     C                     TIME           MGTM                            S01310
     C                     MOVE RUNA      LADT                            S01310
     C                     MOVE MGTM      LATM                            S01310
      *                                                                   S01310
      **  Convert run date to YYMMDD                                      S01310
      *                                                                   S01310
     C                     CALL 'ZM0060'                                  S01310
     C                     PARM RUND      ZMDAY   50                      S01310
     C                     PARM           ZMDATE  6                       S01310
     C                     MOVE ZMDATE    MGDE                            S01310
      *                                                                   S01310
      ** Set-up Message Generation  Century flag                          113352
      *                                                                   113352
     C                     MOVELMGDE      YY      20                      113352
     C           YY        IFLT 72                                        113352
     C                     MOVE '2'       CIND                            113352
     C                     ELSE                                           113352
     C                     MOVE '1'       CIND                            113352
     C                     ENDIF                                          113352
      *                                                                                       CSD015
      ** If Watch List Checking (CSD015) is applied and                                       CSD015
      ** Midas Message Manager is not applied (CSW025)                                        CSD015
      *                                                                                       CSD015
     C           CSD015    IFEQ 'Y'                                                           CSD015
     C           W1EWLC    ANDEQ'Y'                                                           222385
     C           CSW025    ANDEQ'N'                                                           CSD015
     C                     EXSR SRWTCH                                                        CSD015
     C                     ENDIF                                                              CSD015
      *                                                                   S01310
     C           MGST      IFEQ 'RSND'                                    S01310
     C                     MOVE SRUNA     RELD                            S01310
     C                     MOVE LATM      RELT                            S01310
     C                     END                                            S01310
      *                                                                   S01310
     C           AUP2      IFNE *BLANK                                    S01310
     C                     MOVE AUP2      RUSR                            S01310
     C                     ELSE                                           S01310
     C                     MOVE AUP1      RUSR                            S01310
     C                     END                                            S01310
     C                     MOVEL*BLANKS   RWSN                            S01310
     C                     MOVELM1AMNT    AMTS                            S01310
     C*********************MOVEL*BLANKS   AMTX                      S01310S01117
     C                     MOVELM1AMNT    AMTX                            S01117
     C                     MOVELPVDTD3    SVDT                            S01310
      *                                                                   164663
      ** Setup century indicator CINDV for value date SVDT                164663
      *                                                                   164663
     C           SVDT      IFEQ *BLANK                                    164663
     C                     MOVE *BLANK    CINDV                           164663
     C                     ELSE                                           164663
     C                     MOVELSVDT      YY      20                      164663
     C           YY        IFLT 72                                        164663
     C                     MOVE '2'       CINDV                           164663
     C                     ELSE                                           164663
     C                     MOVE '1'       CINDV                           164663
     C                     ENDIF                                          164663
     C                     ENDIF                                          164663
      *                                                                   164663
     C*********************MOVELM1RCCY    CCY                       S01310S01117
     C                     MOVE PCCY      CCY                             S01117
     C                     MOVEL*BLANKS   NSNO                            S01310
     C           DSTT      IFEQ 'F'                                       S01117
     C                     MOVE NOSTN     NSNO                            S01117
     C                     END                                            S01117
     C                     MOVEL*BLANKS   SACN                            S01310
     C                     MOVEL*BLANKS   AORR                            S01310
     C                     MOVEL*BLANKS   DESI                            S01310
      *                                                                   S01310
      **  Branch details                                                  S01310
      *                                                                   S01310
     C                     MOVE BRCAA     BRCA                            S01310
      * IF MULTIBRANCH INDICATOR FROM RUNDAT ACTIVE                       S01310
     C           *IN50     IFEQ '1'                                       S01310
     C           BRCAA     IFNE ORBR                                      S01310
     C                     MOVE ORBR      ORBR    3                       S01310
     C                     MOVE ORBR      OTHB                            S01310
      * MOVE "ORIGINATING BRANCH" TO 'OTHER BRANCH TYPE'(OTHT)            S01310
     C                     MOVE ' BRANCH"'FLD1   20                       S01310
     C                     MOVEL'"ORIGINA'FLD2   12                       S01310
     C                     MOVE 'TING'    FLD2                            S01310
     C                     MOVELFLD2      FLD1                            S01310
     C                     MOVE FLD1      OTHT                            S01310
      *                                                                   S01310
     C                     ELSE                                           S01310
     C                     MOVE *BLANKS   OTHB                            S01310
     C                     MOVE *BLANKS   OTHT                            S01310
     C                     END                                            S01310
      * IF MULTIBRANCH INDICATOR FROM RUNDAT NOT ACTIVE                   S01310
     C                     ELSE                                           S01310
     C                     MOVE *BLANKS   OTHB                            S01310
     C                     MOVE *BLANKS   OTHT                            S01310
     C                     END                                            S01310
     C                     MOVE *BLANKS   RCBR                            S01310
      *                                                                   S01310
     C                     MOVE *BLANKS   NETI                            S01310
     C*********************MOVE *BLANKS   DELC                      S01310S01117
     C*                                                                   S01117
     C*   READ SDCURRPD FOR DELIVERY NOTIFICATION AND NON-DELIVERY        S01117
     C*     WARNING FLAGS                                                 S01117
     C                     CALL 'AOCURRR0'                                S01117
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM PCCY      @CCY    3                       S01117
     C           SDCURR    PARM SDCURR    DSSDY                           S01117
     C*                                                                   S01117
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     MOVE '27'      DBERR#             *************S01117
     C                     MOVEL@CCY      DBERKY             * DBERR 027 *S01117
     C                     MOVEL'SDCURRPD'DBFNAM             *************S01117
     C                     EXSR DBERR                                     S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C           A6NDWR    IFEQ 'Y'                                       S01117
     C           A6DNOR    ANDEQ'Y'                                       S01117
     C                     MOVE '3'       DELC                            S01117
     C                     END                                            S01117
     C           A6NDWR    IFNE 'Y'                                       S01117
     C           A6DNOR    ANDEQ'Y'                                       S01117
     C                     MOVE '2'       DELC                            S01117
     C                     END                                            S01117
     C           A6NDWR    IFEQ 'Y'                                       S01117
     C           A6DNOR    ANDNE'Y'                                       S01117
     C                     MOVE '1'       DELC                            S01117
     C                     END                                            S01117
     C           A6NDWR    IFNE 'Y'                                       S01117
     C           A6DNOR    ANDNE'Y'                                       S01117
     C***********          MOVE '0'       DELC                      S01117068367
     C                     MOVEL*BLANKS   DELC                            068367
     C                     END                                            S01117
      *                                                                   068367
      * Ensure that message priority and delivery notification are        068367
      * valid combination :                                               068367
      * 1. for MPRY = 'U' DELC must be '1' or '3',                        068367
      * 2. for MPRY = 'N' DELC must be ' ' or '2'.                        068367
      *                                                                   068367
     C           MPRY      IFEQ 'U'                                       068367
     C           DELC      ANDEQ' '                                       068367
     C           MPRY      OREQ 'U'                                       068367
     C           DELC      ANDEQ'2'                                       068367
     C                     MOVEL'1'       DELC                            068367
     C                     END                                            068367
      *                                                                   068367
     C           MPRY      IFEQ 'N'                                       068367
     C           DELC      ANDEQ'1'                                       068367
     C           MPRY      OREQ 'N'                                       068367
     C           DELC      ANDEQ'3'                                       068367
     C                     MOVEL'2'       DELC                            068367
     C                     END                                            068367
     C*                                                                   S01117
     C                     MOVE *BLANKS   DYST                            S01310
     C                     MOVE *BLANKS   RSID                            S01310
     C                     MOVE *BLANKS   MSE1                            S01310
     C                     MOVE *BLANKS   ELIN                            S01310
     C                     MOVE *BLANKS   SSAC                            S01310
     C                     MOVE *BLANKS   MIR                             S01310
     C*********************MOVE *BLANKS   TSKS                      S01310S01117
     C                     MOVE 'Y'       TSKS                            S01117
     C                     MOVE *BLANKS   TSKY                            S01310
     C/COPY WNCPYSRC,FT0641C014
      *                                                                   S01310
     C                     MOVEL@CHG      AORR                                                CSW025
     C/COPY WNCPYSRC,FTH00295
     C                     WRITEMGOREFD0               41                 S01310
      *                                                                   S01310
      **  Error on write to PF/MGOREFPD (message reference file)          S01310
      *                                                                   S01310
     C/COPY WNCPYSRC,FTH00506
     C           *IN41     IFEQ '1'                                       S01310
     C                     MOVE '14'      DBERR#           * * * * * * * *S01310
     C                     MOVEL'       ' DBERKY           *  DBERR 014  *S01310
     C                     MOVEL'MGOREFPD'DBFNAM           * * * * * * * *S01310
     C                     EXSR DBERR                                     S01310
     C                     END                                            S01310
     C/COPY WNCPYSRC,FT0641C036
     C                     ENDSR                                          S01310
      *                                                                   S01310
     C/EJECT                                                              S01310
     C********************************************************************
     C********************************************************************
     C*     *         SUBROUTINE 10                         ***        ***
     C*     *                                               ***        ***
     C*     *  TO INITIALISE FIELDS IN DATA STRUCTURE       ***        ***
     C*     *  FOR FORMATTING SWIFT RECORDS                 ***        ***
     C*     *                                               ***        ***
     C*********************************************************        ***
     C           SR10      BEGSR                                       ***
     C*                                                                ***
     C                     MOVE *BLANKS   MT1001
     C                     MOVE *BLANKS   MT1002
     C                     MOVE *BLANKS   MT1003
     C                     MOVE *BLANKS   MT1004
     C                     MOVE *BLANKS   MT1005
     C                     MOVE *BLANKS   MT1006
     C                     MOVE *BLANKS   MT1007
     C                     MOVE *BLANKS   MT1008                          S01177
     C*    SET 'OUR TID'                                               ***
     C                     MOVE MXOTID    M1OTID
     C*********************Z-ADD1         B01                             S01310
     C*********************MOVE X01       M1HEAD                          S01310
     C*********************MOVE X0D25     M1CRL1                          S01310
     C*********************MOVE X0D25     M1CRL2                          S01310
     C*********************MOVE X0D25     M1CRL3                          S01310
     C*********************MOVE X0D25     M1CRL4                          S01310
     C*********************MOVE X0D25     M1CRL6                          S01310
     C*********************MOVE X0D25     M1CRL7                          S01310
     C*********************MOVE X0D25     M1CRL8                          S01310
     C                     MOVE '100'     M1MSGT
     C           WMT103    IFEQ 'Y'                                       CFT014
     C                     MOVE '103'     M1MSGT                          CFT014
     C                     ENDIF                                          CFT014
     C*********************MOVE SWPC      M1MSGP                          S01117
     C*                                                                   S01117
     C*  FORMAT SWIFT PRIORITY CODE                                       S01117
     C           SWPC      IFEQ 1                                         S01117
     C                     MOVE 'U'       M1MSGP                          S01117
     C                     ELSE                                           S01117
     C           SWPC      IFEQ 2                                         S01117
     C                     MOVE 'N'       M1MSGP                          S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C                     MOVE RECADD    M1RADD
     C*********************MOVE ':20:'    M1TG20                          S01310
     C*********************MOVELPREF      M1TREF                          S01310
     C*********************MOVE ':32A:'   M1TG32                          S01310
     C                     MOVE PVDTD3    M1VDAT
     C                     MOVE CCY32     M1RCCY                          S01310
     C                     MOVE AMNT32    M1AMNT                          S01310
     C*********************MOVE 'P'       MXMIND                          S01310
     C*********************MOVE PREF      PREFS                           S01310
     C*********************MOVELPREFS     MXTREF                          S01310
     C                     MOVE *BLANKS   MXDFLG
     C*********************MOVE '-'       M7HYPH                          S01310
     C*********************Z-ADD3         B03                             S01310
     C*********************MOVE X03       M7ETX                           S01310
     C*                                                                ***
     C                     ENDSR                           END SR10
     C/EJECT
4630 C********************************************************************
     C********************************************************************
     C********************************************************************
     C****************SUBROUTINE*11****************************        ***S01310
     C*********************************************************        ***S01310
     C*********TO*INCREMENT*MESSAGES*COUNT*FIELD*IN************        ***S01310
     C*********DATA AREA MSFCTL*******************************************E21286
     C*********DATA*AREA*FTFCTL********************************   **E21286S01310
     C*********************************************************        ***S01310
     C*********************************************************        ***
     C***********SR11      BEGSR                                       ***S01310
     C***********                                                      ***S01310
     C*****INCREMENT*MESSAGES*COUNT*FIELD*IN*DATAAREA*MSFCTL***********   E21286
     C*****INCREMENT*MESSAGES*COUNT*FIELD*IN*DATAAREA*FTFCTL*       E21286S01310
     C************NAMVAR   DEFN MSFCTL    DFCTL                     E21286S01310
     C************NAMVAR   DEFN FTFCTL    DFCTL                     E21286S01310
     C************LOCK     IN   DFCTL                                     S01310
     C************         ADD  1         DFOMC                           S01310
     C************         ADD  1         DFOTL                           S01310
     C************         OUT  DFCTL                                     S01310
     C************                                                     ***S01310
     C************         ENDSR                           END SR11       S01310
     C/EJECT
4630 C********************************************************************
     C********************************************************************
     C********************************************************************
     C*     *         SUBROUTINE P1                         ***        ***
     C*     *                                               ***        ***
     C*     *   OUTPUT AN ENTRY TO SWIFT MESSAGE            ***        ***
     C*     *   REPORT PRTF/FT0641P1                        ***        ***
     C*     *                                               ***        ***
     C*********************************************************        ***
     C           SRP1      BEGSR                                       ***
     C/COPY WNCPYSRC,FT0641C029
     C                     ADD  1         PAGEP1
      *                                                                   CFT014
     C           WMT103    IFEQ 'Y'                                       CFT014
     C                     WRITEP1H2                   80                 CFT014
     C           *IN80     IFEQ *ON                                       CFT014
     C                     MOVE '046'     DBERR#                          CFT014
     C                     MOVEL*BLANKS   DBERKY                          CFT014
     C                     MOVEL'FT0640P1'DBFNAM                          CFT014
     C                     EXSR DBERR                                     CFT014
     C                     ENDIF                                          CFT014
     C           PAGEP1    ADD  1         PAG2P1                          CFT014
     C                     Z-ADDPAG2P1    PAGEP1                          CFT014
     C                     WRITEP1H3                   80                 CFT014
     C                     ELSE                                           CFT014
     C                     WRITEP1H1                   80
     C                     ENDIF                                          CFT014
     C   80                DO                              B001
     C*                                                    ))))))))))))))
     C*********************MOVE 'FT0641P1'DBFNAM           )))  DATA  ))) S01310
     C                     MOVEL'FT0641P1'DBFNAM           )))  DATA  ))) S01310
     C                     MOVEL'1'       DBERKY           )))  BASE  )))
     C                     MOVE 17        DBERR#           ))) ERROR  )))
     C                     EXSR DBERR                      )))   17   )))
     C*                                                    ))))))))))))))
     C                     END                             E001
     C/COPY WNCPYSRC,FT0641C030
     C*                                                                ***
     C                     ENDSR                           END SRP1
     C/EJECT
4630 C********************************************************************
     C********************************************************************
     C********************************************************************
     C*     *         SUBROUTINE P2                         ***        ***
     C*     *                                               ***        ***
     C*     *  TO HANDLE TELEX REPORT                       ***        ***
     C*     *                                               ***        ***
     C*     *                                               ***        ***
     C*********************************************************        ***
     C           SRP2      BEGSR                                       ***
     C*                                                                ***
     C*  ** CHANGE OF CURRENCY, THEN PRINT ELS SUPPRESS CURRENCY       ***
     C*  ** 'CCNM' IS FROM TABLETG ACESS IN SR03 VIA SR06/SR07         ***
     C           P2CCY     IFNE CCNM
     C                     SETON                     14
     C                     Z-ADD0         MREC    10
     C                     MOVE CCNM      P2CCY
     C                     ELSE
     C                     ADD  1         MREC
     C                     SETOF                     14
     C                     END
     C*
     C           MREC      IFGT 1
     C                     SETON                     14
     C                     Z-ADD0         MREC
     C                     END
     C*                                                                ***
     C*  ** CONVERT RECEIVE VALUE DATE FROM 'YYMMDD' TO 'DDMMMYY'      ***
     C                     MOVE PVDTD3    SDATE
     C                     MOVE MTH,SMM   WMM
     C                     MOVE SDD       WDD
     C                     MOVE SYY       WYY
     C*                                                                ***
     C*  ** CHANGE DATE THEN PRINT ELSE SUPRESS DATE PRINTING          ***
     C           WDATE     IFNE P2VAL
     C                     SETON                     15
     C                     Z-ADD0         DREC    10
     C                     MOVELWDATE     P2VAL
     C                     ELSE
     C                     ADD  1         DREC
     C                     SETOF                     15
     C                     END
     C*                                                                ***
     C           DREC      IFGT 1
     C                     SETON                     15
     C                     Z-ADD0         DREC
     C                     END
     C*                                                                ***
     C                     MOVELPREF      P2REF
     C*                                                                ***
     C*  ** PRINT TELEX MESSAGE                                        ***
     C                     ADD  1         PAGEP2
     C                     WRITEP2H1                   80
     C   80                DO                              B001
     C*                                                    ))))))))))))))
     C*********************MOVE 'FT0641P2'DBFNAM           )))  DATA  ))) S01310
     C                     MOVEL'FT0641P2'DBFNAM           )))  DATA  ))) S01310
     C                     MOVEL'2'       DBERKY           )))  BASE  )))
     C                     MOVE 19        DBERR#           ))) ERROR  )))
     C                     EXSR DBERR                      )))   19   )))
     C*                                                    ))))))))))))))
     C                     END                             E001
      *                                                                   CFT014
     C           WMT103    IFEQ 'Y'                                       CFT014
     C                     WRITEP2H3                                      CFT014
     C           PAGEP2    ADD  1         PAG2P2                          CFT014
     C                     WRITEP2H4                                      CFT014
     C                     Z-ADDPAG2P2    PAGEP2                          CFT014
     C                     ELSE                                           CFT014
     C                     WRITEP2H2                                   ***
     C                     ENDIF                                          CFT014
     C*                                                                ***
     C*                                                                ***
     C*                                                                ***
     C                     ENDSR                           END SRP2
     C/EJECT
     C************************************************************
     C**SWFT*SR.***********                                               S01310
     C**TO*DETERMINE*ROUTE*FOR SWIFT MESSAGE GENERATION                   S01310
     C************************************************************        S01310
     C**SEE*BELOW*FOR*DETAILS OF DECISION                                 S01310
     C***********SWFT******BEGSR                                          S01310
     C****PROCESSING*TO*DETERMINE WHETHER THE MESSAGE                     S01310
     C****DESTINATION*IS*SWIFT, TELEX OR STTX                             S01310
      *****************************************************************   S01310
      ****PRAD*-*determine*settlement*network*address**************S01310 CSW096
      ****Called*by***-*SR01.**************************************S01310 CSW096
      ****Calls*******-********************************************S01310 CSW096
      *************************************************************S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********PRAD      BEGSR                                   S01310 CSW096
      ***********                                                  S01310 CSW096
      ****Set*up*priority*sender,*destination*&*network************S01310 CSW096
      ***********                                                  S01310 CSW096
      ****'S'*=*SWIFT;*'T'*=*TELEX;*'X'*=*STTX*********************S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********                                                         CSW096
     C*******************(1)**(2)**(3)**(4)**(5)**(6)**(7)****************CSW096
     C****-------------------------------------------------***************CSW096
     C****SWIFT*ADDRESS¦  Y ¦  N ¦  N ¦  Y ¦  Y ¦  Y ¦  Y ¦***************CSW096
     C****TELEX*ADDRESS¦  N ¦  Y ¦  N ¦  Y ¦  Y ¦  N ¦  N ¦***************CSW096
     C****STTX*ADDRESS*¦  N ¦  N ¦  Y ¦  N ¦  N ¦  Y ¦  Y ¦***************CSW096
     C****SETT.*TYPE***¦    ¦    ¦    ¦ 01 ¦ 08 ¦ 01 ¦ 08 ¦***************CSW096
     C****-------------------------------------------------***************CSW096
     C****DESTN*=*CSID*¦  X ¦    ¦    ¦    ¦  X ¦    ¦  X ¦***************CSW096
     C****DESTN*=*TELX*¦    ¦  X ¦    ¦  X ¦    ¦    ¦    ¦***************CSW096
     C****DESTN*=*STTX*¦    ¦    ¦  X ¦    ¦    ¦  X ¦    ¦***************CSW096
     C****-------------------------------------------------***************CSW096
     C****MESSAGE ROUTE¦    ¦    ¦    ¦    ¦    ¦    ¦    ¦***************CSW096
     C****CODE*(SWTX)**¦  S ¦  T ¦  X ¦  T ¦  S ¦  X ¦  S ¦***************CSW096
     C***********                                                         CSW096
      ***********                                                  S01310 CSW096
      ***Move*new*field*names*to*old*to*ensure*continuity*of*code.*S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********          MOVELBBCSID    CSID                     S01310 CSW096
     C***********          MOVELBBTXA1    TELX                     S01310 CSW096
     C***********          MOVELBBSTAD    STTX   12                S01310 CSW096
     C***********          MOVELBBCRNM    CRNM                     S01310 CSW096
      ****SWIFT*?**************************************************S01310 CSW096
     C****(1)*************************************************************CSW096
     C***********          MOVE CSID      CSBIC   4                       CSW096
      ***********                                                  S01310 CSW096
     C***********GSFM******IFEQ 'Y'                                       S01310
     C***********BGMSDL    IFEQ 'Y'                                S01310 CSW096
     C***********CSBIC     ANDNE'BIC '                                    CSW096
     C***********CSID      IFNE *BLANKS                                   CSW096
     C***********TELX      ANDEQ*BLANKS                                   CSW096
     C***********STTX      ANDEQ*BLANKS                                   CSW096
     C****(5)*************************************************************CSW096
     C***********CSID      ORNE *BLANKS                                   CSW096
     C***********TELX      ANDNE*BLANKS                                   CSW096
     C***********STTX      ANDEQ*BLANKS                                   CSW096
     C***********STMT      ANDEQ08                                        CSW096
     C****(7)*************************************************************CSW096
     C***********CSID      ORNE *BLANKS                                   CSW096
     C***********TELX      ANDEQ*BLANKS                                   CSW096
     C***********STTX      ANDNE*BLANKS                                   CSW096
     C***********STMT      ANDEQ08                                        CSW096
     C***********                                                  E21467 CSW096
     C***Settlement*type*CHAPS*should*go*through*SWIFT.************E21467 CSW096
     C***********                                                  E21467 CSW096
     C***********CSID      ORNE *BLANKS                            E21467 CSW096
     C***********TELX      ANDNE*BLANKS                            E21467 CSW096
     C***********STTX      ANDEQ*BLANKS                            E21467 CSW096
     C***********STMT      ANDEQ10                                 E21467 CSW096
     C****(7)******************************************************E21467 CSW096
     C***********CSID      ORNE *BLANKS                            E21467 CSW096
     C***********TELX      ANDEQ*BLANKS                            E21467 CSW096
     C***********STTX      ANDNE*BLANKS                            E21467 CSW096
     C***********STMT      ANDEQ10                                 E21467 CSW096
     C***********                                                         CSW096
     C*********************MOVE CSID      CSID   12                       S01310
     C***********          MOVE 'S'       SWTX    1                       CSW096
     C***********          MOVELSNCSID    NWSN                     S01310 CSW096
     C***********          MOVELCSID      NWDS                     S01310 CSW096
     C***********          MOVEL'SWIFT'   NWRK                     S01310 CSW096
     C***********          MOVE 'Y'       OSUFLG                   S01310 CSW096
     C***********          END                                            CSW096
     C***********          END                                     S01310 CSW096
      ***********                                                  S01310 CSW096
      ****Telex****************************************************S01310 CSW096
     C****(2)*************************************************************CSW096
     C***********BGMTMI    IFEQ 'Y'                                S01310 CSW096
     C***********CSID      IFEQ *BLANKS                                   CSW096
     C***********TELX      ANDNE*BLANKS                                   CSW096
     C***********STTX      ANDEQ*BLANKS                                   CSW096
     C****(4)*************************************************************CSW096
     C***********CSID      ORNE *BLANKS                                   CSW096
     C***********TELX      ANDNE*BLANKS                                   CSW096
     C***********STTX      ANDEQ*BLANKS                                   CSW096
     C***********STMT      ANDEQ01                                        CSW096
     C***********                                                         CSW096
     C*********************MOVE TELX      CSID                            S01310
     C***********          MOVE 'T'       SWTX                            CSW096
     C***********          MOVELSTELX     NWSN                     S01310 CSW096
     C***********          MOVELTELX      NWDS                     S01310 CSW096
     C***********          MOVEL'TELEX'   NWRK                     S01310 CSW096
     C***********          MOVE 'Y'       OSUFLG                   S01310 CSW096
     C***********          END                                     S01310 CSW096
     C***********          END                                            CSW096
      ***********                                                  S01310 CSW096
      ****STTX*network*available*?*********************************S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********BGMSDL    IFEQ 'Y'                                S01310 CSW096
     C****(3)*************************************************************CSW096
     C***********CSID      IFEQ *BLANKS                                   CSW096
     C***********TELX      ANDEQ*BLANKS                                   CSW096
     C***********STTX      ANDNE*BLANKS                                   CSW096
     C****(6)*************************************************************CSW096
     C***********CSID      ORNE *BLANKS                                   CSW096
     C***********TELX      ANDEQ*BLANKS                                   CSW096
     C***********STTX      ANDNE*BLANKS                                   CSW096
     C***********STMT      ANDEQ01                                        CSW096
     C***********                                                         CSW096
     C*********************MOVE STTX      CSID                            S01310
     C***********          MOVE 'X'       SWTX                            CSW096
     C***********          MOVELSSTTX     NWSN                     S01310 CSW096
     C***********          MOVELSTTX      NWDS                     S01310 CSW096
     C***********          MOVEL'STTX'    NWRK                     S01310 CSW096
     C***********          MOVE 'Y'       OSUFLG                   S01310 CSW096
     C***********          END                                            CSW096
     C*********************ELSE                                           S01310
     C*********************MOVE *BLANKS   CSID                            S01310
     C*********************MOVE *BLANKS   SWTX                            S01310
     C***********          END                                            CSW096
      ***********                                                  S01310 CSW096
      ***Found*to*be*unroutable.***********************************S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********NWRK      IFEQ *BLANKS                            S01310 CSW096
     C***********NWSN      OREQ *BLANKS                            S01310 CSW096
     C***********          MOVELSCRNM     NWSN                     S01310 CSW096
     C***********          MOVELCRNM      NWDS                     S01310 CSW096
     C***********          MOVEL'UNROUT'  NWRK                     S01310 CSW096
     C***********          MOVE 'CRTD'    MGST                     S01310 CSW096
     C***********          MOVE '1'       MGSG                     S01310 CSW096
     C***********          MOVE 'Y'       OSUFLG                   S01310 CSW096
     C***********          END                                     S01310 CSW096
     C***********                                                         CSW096
     C***********          ENDSR                                          CSW096
     C***********                                                         CSW096
     C***********                                                         CSW096
     C************************************************************
     C**END*OF*SWIFT*TELEX*SUBROUTINE                                     S01310
     C************************************************************
     C*/EJECT****                                                         CSW096
      *************************************************************S01310 CSW096
      ****NWAD*-*determine*default*network*addresses***************S01310 CSW096
      ****Called*by*-*SR01.****************************************S01310 CSW096
      ****Calls*****-**********************************************S01310 CSW096
      *************************************************************S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********NWAD      BEGSR                                   S01310 CSW096
      ***********                                                  S01310 CSW096
      ****Default*is*SWIFT*****************************************S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********BBDNW1    IFEQ 'SWIFT'                            S01310 CSW096
     C***********BBCSID    ANDNE*BLANKS                            S01310 CSW096
     C***********@BIC      ANDNE'BIC'                              S01310 CSW096
     C***********BGMSDL    ANDEQ'Y'                                S01310 CSW096
     C***********          MOVELSNCSID    NWSN                     S01310 CSW096
     C***********          MOVELBBCSID    NWDS                     S01310 CSW096
     C***********          MOVELBBDNW1    NWRK                     S01310 CSW096
     C***********          MOVE 'Y'       OSUFLG                   S01310 CSW096
     C***********          END                                     S01310 CSW096
      ***********                                                  S01310 CSW096
      ****Default*is*TELEX*****************************************S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********BBDNW1    IFEQ 'TELEX'                            S01310 CSW096
     C***********BBTXA1    ANDNE*BLANKS                            S01310 CSW096
     C***********BGMTMI    ANDEQ'Y'                                S01310 CSW096
     C***********          MOVELSTELX     NWSN                     S01310 CSW096
     C***********          MOVELBBTXA1    NWDS                     S01310 CSW096
     C***********          MOVE BBDNW1    NWRK                     S01310 CSW096
     C***********          MOVE 'Y'       OSUFLG                   S01310 CSW096
     C***********          END                                     S01310 CSW096
      ***********                                                  S01310 CSW096
      ****Default*is*STTX******************************************S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********BBDNW1    IFEQ 'STTX'                             S01310 CSW096
     C***********BBSTAD    ANDNE*BLANKS                            S01310 CSW096
     C***********BGMSDL    ANDEQ'Y'                                S01310 CSW096
     C***********          MOVELSSTTX     NWSN                     S01310 CSW096
     C***********          MOVELBBSTAD    NWDS                     S01310 CSW096
     C***********          MOVE BBDNW1    NWRK                     S01310 CSW096
     C***********          MOVE 'Y'       OSUFLG                   S01310 CSW096
     C***********          END                                     S01310 CSW096
      ***********                                                  S01310 CSW096
      ****Default*is*PAPER*****************************************S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********BBDNW1    IFEQ 'PAPER'                            S01310 CSW096
     C***********          MOVELSCRNM     NWSN                     S01310 CSW096
     C***********          MOVELBBCRNM    NWDS                     S01310 CSW096
     C***********          MOVE BBDNW1    NWRK                     S01310 CSW096
     C***********          MOVE 'RSND'    MGST                     S01310 CSW096
     C***********          MOVE '2'       MGSG                     S01310 CSW096
     C***********          MOVE 'N'       OSUFLG                   S01310 CSW096
     C***********          END                                     S01310 CSW096
      ***********                                                  S01310 CSW096
      ****Found*to*be*unroutable***********************************S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********NWRK      IFEQ *BLANKS                            S01310 CSW096
     C***********NWDS      OREQ *BLANKS                            S01310 CSW096
     C***********NWSN      OREQ *BLANKS                            S01310 CSW096
     C***********          MOVELSCRNM     NWSN                     S01310 CSW096
     C***********          MOVELBBCRNM    NWDS                     S01310 CSW096
     C***********          MOVEL'UNROUT'  NWRK                     S01310 CSW096
     C***********          MOVE 'CRTD'    MGST                     S01310 CSW096
     C***********          MOVE '1'       MGSG                     S01310 CSW096
     C***********          MOVE 'Y'       OSUFLG                   S01310 CSW096
     C***********          END                                     S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********          ENDSR                                   S01310 CSW096
     C*/EJECT****                                                  S01310 CSW096
      *************************************************************S01310 CSW096
      ****FILL*-*Fill*up*array**GNR********************************S01310 CSW096
      ****Called*by***-*SR01.**************************************S01310 CSW096
      ****Calls*******-********************************************S01310 CSW096
      *************************************************************S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********FILL      BEGSR                                   S01310 CSW096
      ***********                                                  S01310 CSW096
      ****Is*message*to*be*generated*as*released*?*****************S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********          MOVE BBDS01    GNR,1                    S01310 CSW096
     C***********          MOVE BBDS02    GNR,2                    S01310 CSW096
     C***********          MOVE BBDS03    GNR,3                    S01310 CSW096
     C***********          MOVE BBDS04    GNR,4                    S01310 CSW096
     C***********          MOVE BBDS05    GNR,5                    S01310 CSW096
     C***********          MOVE BBDS06    GNR,6                    S01310 CSW096
     C***********          MOVE BBDS07    GNR,7                    S01310 CSW096
     C***********          MOVE BBDS08    GNR,8                    S01310 CSW096
     C***********          MOVE BBDS09    GNR,9                    S01310 CSW096
     C***********          MOVE BBDS10    GNR,10                   S01310 CSW096
     C***********          MOVE BBDS11    GNR,11                   S01310 CSW096
     C***********          MOVE BBDS12    GNR,12                   S01310 CSW096
     C***********          MOVE BBDS13    GNR,13                   S01310 CSW096
     C***********          MOVE BBDS14    GNR,14                   S01310 CSW096
     C***********          MOVE BBDS15    GNR,15                   S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********          ENDSR                                   S01310 CSW096
     C/EJECT                                                              S01310
      *****************************************************************   CSW096
      *   SRROUT - determine message routing                          *   CSW096
      *   Called by - SR01                                            *   CSW096
      *   Calls -                                                     *   CSW096
      *****************************************************************   CSW096
      *                                                                   CSW096
     C           SRROUT    BEGSR                                          CSW096
      *                                                                   CSW096
     C/COPY WNCPYSRC,FT0641C013
     C                     MOVE BRCA      I@SNBR                          CSW096
     C                     MOVE *BLANKS   I@DSCN                          CSW096
     C                     MOVE CUSTNO    I@DSCN                          CSW096
     C                     MOVE '100'     I@MTPY                          CSW096
     C           WMT103    IFEQ 'Y'                                       CFT014
     C                     MOVE '103'     I@MTPY                          CFT014
     C                     ENDIF                                          CFT014
     C                     MOVE 'N'       I@CONC                          CSW096
     C                     Z-ADDSTMT      I@SETT                          CSW096
     C                     MOVE FTCS      I@FTCS                          CSW096
     C                     MOVE MODI      I@MMOD                          CSW096
      *###################################################################CSW096
      *                                                                  #CSW096
      * Below are two copy sources intended for setting up the custom    #CSW096
      * parameter (P@ZZ) in the call to MG9900.                          #CSW096
      * One (MG9900FTCL) is in ALL MG generation programs and is for use #CSW096
      * when a change is required to all of them.                        #CSW096
      * The other is only in this program.                               #CSW096
     C/COPY WNCPYSRC,MG9900FTCL                                          #CSW096
     C/COPY WNCPYSRC,FT0641ROUT                                          #CSW096
      *                                                                  #CSW096
      *###################################################################CSW096
     C                     CALL 'MG9900'                                  CSW096
     C                     PARM *BLANKS   @RTCD                           CSW096
     C                     PARM           P@IN                            CSW096
     C                     PARM *BLANKS   P@OUT                           CSW096
     C                     PARM           P@ZZ  256                       CSW096
      *                                                                   CSW096
     C           @RTCD     IFNE *BLANKS                                   CSW096
     C                     MOVE '92'      DBERR#             * * * * * * *CSW096
     C                     MOVEL'*CALL'   DBERKY             * DBERR 920 *CSW096
     C                     MOVEL'MG9900  'DBFNAM             * * * * * * *CSW096
     C                     EXSR DBERR                                     CSW096
     C                     ELSE                                           CSW096
     C                     MOVE O@NWRK    NWRK                            CSW096
     C                     MOVE O@NWSN    NWSN                            CSW096
     C                     MOVE O@NWDS    NWDS                            CSW096
     C                     MOVE O@MGSG    MGSG                            CSW096
     C                     MOVE O@MGST    MGST                            CSW096
     C                     MOVE O@PCNB    CPAR                            CSW096
     C                     END                                            CSW096
      *                                                                   CSW096
      ** Set network to PAPER if Precious Metal Ind. of the CCY is 'Y'                        CSW215
      *                                                                                       CSW215
     C           CSW215    IFEQ 'Y'                                                           CSW215
     C                     CALL 'AOCURRR0'                                                    CSW215
     C                     PARM *BLANKS   PRTCD                                               CSW215
     C                     PARM '*KEY   ' POPTN                                               CSW215
     C                     PARM PCCY      PWCCY                                               CSW215
     C           SDCURR    PARM SDCURR    DSSDY                                               CSW215
      *                                                                                       CSW215
     C           PRTCD     IFNE *BLANKS                                                       CSW215
     C                     MOVE '52'      DBERR#                                              CSW215
     C                     MOVELPCCY      DBERKY                                              CSW215
     C                     MOVEL'SDCURRPD'DBFNAM                                              CSW215
     C                     EXSR DBERR                                                         CSW215
     C                     ENDIF                                                              CSW215
      *                                                                                       CSW215
     C           PRTCD     IFEQ *BLANKS                                                       CSW215
     C           NWRK      ANDEQ'SWIFT'                                                       CSW215
     C           A6PMRT    ANDEQ'Y'                                                           CSW215
     C                     MOVEL'PAPER'   NWRK                                                CSW215
     C                     ENDIF                                                              CSW215
      *                                                                                       CSW215
     C                     ENDIF                                                              CSW215
      *                                                                                       CSW215
     C           BBDNW1    IFEQ *BLANKS                                   CSW096
     C           NWRK      IFEQ 'SWIFT'                                   CSW096
     C                     MOVE 'S'       SWTX    1                       CSW096
     C                     END                                            CSW096
     C           NWRK      IFEQ 'TELEX'                                   CSW096
     C                     MOVE 'T'       SWTX                            CSW096
     C                     END                                            CSW096
     C           NWRK      IFEQ 'STTX'                                    CSW096
     C                     MOVE 'X'       SWTX                            CSW096
     C                     END                                            CSW096
     C                     END                                            CSW096
      *                                                                   CSW096
     C           NWRK      IFNE 'PAPER'                                   CSW096
     C                     MOVE 'Y'       OSUFLG                          CSW096
     C                     ELSE                                           CSW096
     C                     MOVE 'N'       OSUFLG                          CSW096
     C                     END                                            CSW096
      *                                                                   CSW096
     C                     ENDSR                                          CSW096
      /EJECT                                                              138077
      *****************************************************************   138077
      *                                                               *   138077
      *   SEXTN - Store customer with SWIFT address to data structure *   138077
      *                                                               *   138077
      *****************************************************************   138077
      *                                                                   138077
     C           SEXTN     BEGSR                                          138077
      *                                                                   138077
     C           SAVMTG    IFNE *BLANKS                                   138077
     C                     MOVE SAVMTG    @MTG                            138077
     C                     ELSE                                           138077
     C                     MOVELMTAG      @MTG                            138077
     C                     ENDIF                                          138077
     C           FLDTYP    IFEQ '5'                                       138077
     C           FLDTAG    ANDEQ'A'                                       138077
     C           FLDTYP    OREQ '5'                                                         BUG14915
     C           FLDTAG    ANDEQ'F'                                                         BUG14915
     C                     ADD  1         V                               138077
     C           V         OCUR EXTN                                      138077
     C                     Z-ADDQ         MPSN                            138077
     C                     MOVEL@MTG      MTG                             138077
     C                     MOVELBBCUST    MCSI                            138077
     C                     ENDIF                                          138077
      *                                                                   138077
     C           SEXT9     ENDSR                                          138077
     C/EJECT                                                              CFT009
      *****************************************************************   CFT009
      *   NEWCHG - Add new charges                                    *   CFT009
      *   Called by - SR06                                            *   CFT009
      *   Calls     -                                                 *   CFT009
      *****************************************************************   CFT009
      *                                                                   CFT009
     C           NEWCHG    BEGSR                                          CFT009
      *                                                                   CFT009
     C           PREF      CHAINOTPAYXL0             51                   CFT009
      *                                                                   CFT009
     C           *IN51     IFEQ *ON                                       CFT009
     C                     MOVEL'OTPAYXL0'DBFNAM            ************  CFT009
     C                     MOVELPREF      DBERKY            * DBERR 42 *  CFT009
     C                     MOVE '42'      DBERR#            ************  CFT009
     C                     EXSR DBERR                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Totals                                                           CFT009
      *                                                                   CFT009
     C           SWSCHG    ADD  MISC01    SUMAMT 130                      CFT009
     C                     ADD  MISC02    SUMAMT                          CFT009
     C                     ADD  MISC03    SUMAMT                          CFT009
     C                     ADD  MISC04    SUMAMT                          CFT009
     C                     ADD  MISC05    SUMAMT                          CFT009
      *                                                                   CFT009
     C                     Z-ADDSUMAMT    NCHGS  130                      CFT009
      *                                                                   CFT009
     C                     ENDSR                                          CFT009
     C/EJECT                                                              CSW096
     C/COPY WNCPYSRC,FTH00296
      *****************************************************************   S01310
      *   INTF - Initalise non-constant fields                        *   S01310
      *   Called by - main process                                    *   S01310
      *   Calls     -                                                 *   S01310
      *****************************************************************   S01310
      *                                                                   S01310
     C           INTF      BEGSR                                          S01310
      *                                                                   S01310
     C                     MOVE *BLANKS   TRNO                            S01310
     C                     MOVE *BLANKS   TRNA                            S01310
     C                     MOVE '      '  NWRK                            S01310
     C**********           Z-ADD0         SECN                                         S01310 CSD027
     C                     MOVE *BLANKS   SECN                                                CSD027
     C                     MOVE *BLANKS   NWSN                            S01310
     C**********           Z-ADD0         DECN                                         S01310 CSD027
     C                     MOVE *BLANKS   DECN                                                CSD027
     C                     MOVE *BLANKS   NWDS                            S01310
     C                     MOVE *BLANKS   MGSG                            S01310
     C                     MOVE *BLANKS   MGST                            S01310
     C                     Z-ADD0         MGTM                            S01310
     C                     Z-ADD0         LATM                            S01310
     C                     MOVE *BLANKS   RELD                            S01310
     C                     Z-ADD0         RELT                            S01310
     C                     MOVE *BLANKS   AMTS                            S01310
     C                     MOVE *BLANKS   SVDT                            S01310
     C                     MOVE *BLANKS   CINDV                           164663
      *                                                                   S01310
     C                     MOVE *BLANKS   SNCSID 12                       S01310
     C                     MOVE *BLANKS   STELX  10                       S01310
     C                     MOVE *BLANKS   SSTTX  12                       S01310
     C                     MOVE *BLANKS   SCRNM  20                       S01310
      *                                                                   S01310
      **  Clear multiple occurrence data structure                        S01310
      *                                                                   S01310
     C                     Z-ADD1         Q       20                      S01310
     C           Q         OCUR MULT                                      S01310
      *                                                                   S01310
     C           Q         DOWLE50                                        S01310
     C           MULT      ANDNE*BLANKS                                   S01310
     C                     MOVE *BLANKS   MULT                            S01310
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     END                                            S01310
      *                                                                   138077
      ** Clear multiple occurrence DS for the extension file.             138077
      *                                                                   138077
     C                     Z-ADD1         V       20                      138077
     C           V         OCUR EXTN                                      138077
     C           V         DOWLE20                                        138077
     C           MCSI      ANDNE*BLANKS                                   138077
     C                     Z-ADD*ZEROS    MPSN                            138077
     C                     MOVE *BLANKS   MTG                             138077
     C                     MOVE *BLANKS   MCSI                            138077
     C                     ADD  1         V                               138077
     C           V         OCUR EXTN                                      138077
     C                     ENDDO                                          138077
     C                     Z-ADD0         V                               138077
      *                                                                   CFT014
      ** Initialise fields introduced for MT103.                          CFT014
      *                                                                   CFT014
     C                     MOVE *BLANKS   MT1009                          CFT014
     C                     MOVE *BLANKS   M9ICD6                          CFT014
     C                     MOVE *BLANKS   M9ICD7                          CFT014
     C                     MOVE *BLANKS   M9ICD8                          CFT014
     C                     MOVE *BLANKS   M9ICD9                          CFT014
     C                     MOVE *BLANKS   M9ICDA                          CFT014
     C                     MOVE *BLANKS   M9ICDB                          CFT014
     C                     MOVE *BLANKS   P171F1                          CFT014
     C                     MOVE *BLANKS   P171F2                          CFT014
     C                     MOVE *BLANKS   P171F3                          CFT014
     C                     MOVE *BLANKS   P171F4                          CFT014
     C                     MOVE *BLANKS   P171F5                          CFT014
     C                     MOVE *BLANKS   P271F1                          CFT014
     C                     MOVE *BLANKS   P271F2                          CFT014
     C                     MOVE *BLANKS   P271F3                          CFT014
     C                     MOVE *BLANKS   P271F4                          CFT014
     C                     MOVE *BLANKS   P271F5                          CFT014
     C                     MOVE *BLANKS   P1ICD1                          CFT014
     C                     MOVE *BLANKS   P1ICD2                          CFT014
     C                     MOVE *BLANKS   P1ICD3                          CFT014
     C                     MOVE *BLANKS   P1ICD4                          CFT014
     C                     MOVE *BLANKS   P1ICD5                          CFT014
     C                     MOVE *BLANKS   P1ICD6                          CFT014
     C                     MOVE *BLANKS   P1ICD7                          CFT014
     C                     MOVE *BLANKS   P1ICD8                          CFT014
     C                     MOVE *BLANKS   P1ICD9                          CFT014
     C                     MOVE *BLANKS   P1ICDA                          CFT014
     C                     MOVE *BLANKS   P1ICDB                          CFT014
     C                     MOVE *BLANKS   P2PDCY                          CFT014
     C                     MOVE *BLANKS   P2PDAM                          CFT014
     C                     MOVE *BLANKS   P2BTB1                          CFT014
     C                     MOVE *BLANKS   P2BTB2                          CFT014
     C                     MOVE *BLANKS   P2BTB3                          CFT014
     C                     MOVE *BLANKS   P2BTB4                          CFT014
     C                     MOVE *BLANKS   P2BTB5                          CFT014
     C                     MOVE *BLANKS   P2BTB6                          CFT014
     C                     MOVE *BLANKS   WOTRI1 35                       CFT014
     C                     MOVE *BLANKS   WOTRI2 35                       CFT014
     C                     MOVE *BLANKS   WOTRI3 35                       CFT014
     C                     MOVE *BLANKS   WOTRI4 35                       CFT014
     C                     MOVE *BLANKS   WOTRI5 35                       CFT014
     C                     MOVE *BLANKS   WBBI1  35                       CFT014
     C                     MOVE *BLANKS   WBBI2  35                       CFT014
     C                     MOVE *BLANKS   WBBI3  35                       CFT014
     C                     MOVE *BLANKS   WBBI4  35                       CFT014
     C                     MOVE *BLANKS   WBBI5  35                       CFT014
     C                     MOVE *BLANKS   WBBI6  35                       CFT014
     C                     MOVE *BLANKS   P1RCRM                          CFT014
     C                     MOVE *BLANKS   P2RCRM                          CFT014
     C                     MOVE 'Y'       W23E    1                       CFT014
     C                     MOVE 'Y'       W52A    1                                           208890
     C                     MOVE 'Y'       W53A    1                       CFT014
     C                     MOVE 'Y'       W54A    1                       CFT014
     C                     MOVE 'Y'       W55A    1                       CFT014
     C                     MOVE 'Y'       W56A    1                       CFT014
     C                     MOVE 'Y'       W57A    1                       CFT014
     C                     MOVE 'Y'       W59A    1                       CFT014
     C                     MOVE 'Y'       W72     1                       CFT014
     C                     MOVE 'N'       WTLX    1                       CFT014
     C                     MOVE *BLANK    WOCHGS  1                       CFT014
     C                     MOVE *BLANK    WOTRTG  1                       CFT014
      *                                                                   S01310
      ** Check if FT MTmsg will use full Reference in Swift Message                           242289
      ** Reference field :20:                                                                 242289
     C                     CALL 'AOSVALR0'                                                    242289
     C                     PARM *BLANKS   W0RTCD  7                                           242289
     C                     PARM SVAL,1    P@OP01 20                                           242289
     C                     PARM *BLANKS   P@VL01200                                           242289
     C                     PARM *BLANKS   P@OP02 20                                           242289
     C                     PARM *BLANKS   P@VL02200                                           242289
     C                     PARM *BLANKS   P@OP03 20                                           242289
     C                     PARM *BLANKS   P@VL03200                                           242289
     C                     PARM *BLANKS   P@OP04 20                                           242289
     C                     PARM *BLANKS   P@VL04200                                           242289
     C                     PARM *BLANKS   P@OP05 20                                           242289
     C                     PARM *BLANKS   P@VL05200                                           242289
     C                     PARM *BLANKS   P@OP06 20                                           242289
     C                     PARM *BLANKS   P@VL06200                                           242289
     C                     PARM *BLANKS   P@OP07 20                                           242289
     C                     PARM *BLANKS   P@VL07200                                           242289
     C                     PARM *BLANKS   P@OP08 20                                           242289
     C                     PARM *BLANKS   P@VL08200                                           242289
     C                     PARM *BLANKS   P@OP09 20                                           242289
     C                     PARM *BLANKS   P@VL09200                                           242289
     C                     PARM *BLANKS   P@OP10 20                                           242289
     C                     PARM *BLANKS   P@VL10200                                           242289
      *                                                                                       242289
      ** If 'Y' Use Full Reference, i.e. FT+PREF as field :20: TRNO                           242289
     C           P@VL01    IFEQ 'Y'                                                           242289
     C                     MOVE 'Y'       FULLRF  1                                           242289
     C                     ELSE                                                               242289
     C                     MOVE 'N'       FULLRF                                              242289
     C                     ENDIF                                                              242289
      *                                                                                       242289
     C                     ENDSR                                          S01310
     C/EJECT                                                              S01310
     C/COPY WNCPYSRC,FT0641C057
     C********************************************************************
     C********************************************************************
     C********************************************************************
     C********************************************************************
     C*    *     SUBROUTINE TO SET UP DATA STRUCTURE   *     *** DBERR ***
     C*    *                FOR DATABASE ERRORS.       *     *** DBERR ***
     C********************************************************** DBERR ***
     C*    ERROR     CAUSE                                   *** DBERR ***
     C*       01     VALID I.C.R.-1 RECORD NOT FOUND.        *** DBERR ***
     C*       02     VALID I.C.R.-2 RECORD NOT FOUND.        *** DBERR ***
     C*       03     VALID CURRENCY RECORD NOT FOUND.        *** DBERR ***
     C*       04     UNSUCCESSFUL CHAIN TO LF/OTPAY.         *** DBERR ***
     C*       05     UNSUCCESSFUL CHAIN TO LF/CQPAC.         *** DBERR ***
     C*       06     UNSUCCESSFUL CHAIN TO LF/NTRAN.         *** DBERR ***
     C********************************************************** DBERR ***
     C           DBERR     BEGSR                             *** DBERR ***
     C*                                                      *************
     C           *NAMVAR   DEFN LDA       DLDA
     C           *LOCK     IN   DLDA
     C                     MOVEL'FT0641'  DBPGM            ) SET UP
     C*********************MOVE DBFNAM    DBFILE           ) DATA BASE    S01117
     C                     MOVELDBFNAM    DBFILE                          S01117
     C                     MOVELDBERKY    DBKEY            ) ERROR
     C                     MOVE *BLANKS   DBASE                           S01310
     C                     MOVE DBERR#    DBASE            ) FIELDS
     C                     OUT  DLDA
     C                     SETON                     U7U8LR
     C                     SETON                     78                   S01117
     C                     Z-ADD1         PAGEAU                          S01117
     C                     WRITEHEADAU                                    S01117
     C                     DUMP
     C                     RETRN
     C*                                                      *************
     C                     ENDSR                             *** DBERR ***
     C/EJECT
      *****************************************************************   CFT014
      *                                                               *   CFT014
      *  SRFAMT - Format amount to SWIFT amount format                *   CFT014
      *                                                               *   CFT014
      *  Called by: Any routine that needs SWIFT amount format        *   CFT014
      *                                                               *   CFT014
      *  Calls    : AOCURRR0, ZM0040, DBERR                           *   CFT014
      *                                                               *   CFT014
      *****************************************************************   CFT014
     C           SRFAMT    BEGSR                                          CFT014
      *                                                                   CFT014
      ** Define input/ouput parameters.                                   CFT014
      *                                                                   CFT014
     C                     MOVE WICCY     WICCY   3                       CFT014
     C                     Z-ADDWIAMNT    WIAMNT 130                      CFT014
     C                     MOVE *BLANKS   WOCCYS  3                       CFT014
     C                     Z-ADD0         WODECS  10                      CFT014
     C                     MOVE *BLANKS   WOAMNT 15                       CFT014
      *                                                                   CFT014
      ** Define other work field.                                         CFT014
      *                                                                   CFT014
     C                     MOVE WIAMNT    WAMTA  13                       CFT014
      *                                                                   CFT014
      ** Access Currency details.                                         CFT014
      *                                                                   CFT014
     C                     CALL 'AOCURRR0'                                CFT014
     C                     PARM *BLANKS   PRTCD                           CFT014
     C                     PARM '*KEY   ' POPTN                           CFT014
     C                     PARM WICCY     PWCCY                           CFT014
     C           SDCURR    PARM SDCURR    DSSDY                           CFT014
      *                                                                   CFT014
     C           PRTCD     IFNE *BLANKS                                   CFT014
     C                     MOVE '044'     DBERR#                          CFT014
     C                     MOVELWICCY     DBERKY                          CFT014
     C                     MOVEL'SDCURRPD'DBFNAM                          CFT014
     C                     EXSR DBERR                                     CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVE A6SWCY    WOCCYS                          CFT014
     C                     Z-ADDA6NBDP    WODECS                          CFT014
      *                                                                   CFT014
      ** Perform old processing if CSW020 is not switched on.             CFT014
      *                                                                   CFT014
     C           CSW020    IFNE 'Y'                                       CFT014
      *                                                                   CFT014
     C           14        SUB  A6NBDP    X       20                      CFT014
      *                                                                   CFT014
      ** If 0 decimal places, don't edit.                                 CFT014
      *                                                                   CFT014
     C           A6NBDP    IFEQ 0                                         CFT014
     C                     MOVE *BLANK    AMT                             CFT014
     C                     MOVE *ZEROS    AM                              CFT014
     C                     MOVEAWAMTA     AMT,2                           CFT014
     C                     MOVEAWAMTA     AM,1                            CFT014
     C                     Z-ADD13        W                               CFT014
     C                     MOVE ','       AM,X                            CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
      ** Move amount into array.                                          CFT014
      *                                                                   CFT014
     C                     MOVEAWAMTA     AMT,1                           CFT014
      *                                                                   CFT014
      ** Determine position of decimal digits in 2nd array.               CFT014
      *                                                                   CFT014
     C           X         ADD  1         Y       20                      CFT014
      *                                                                   CFT014
      ** Move decimal digits into 2nd array field.                        CFT014
      *                                                                   CFT014
     C                     MOVEAAMT,X     AM,Y                            CFT014
      *                                                                   CFT014
      ** Determine position & move comma.                                 CFT014
      *                                                                   CFT014
     C                     SUB  1         Y                               CFT014
     C                     MOVE ','       AM,Y                            CFT014
      *                                                                   CFT014
      ** Determine position of digit before comma.                        CFT014
      *                                                                   CFT014
     C                     SUB  1         Y                               CFT014
      *                                                                   CFT014
      ** Save position of digit before comma.                             CFT014
      *                                                                   CFT014
     C                     Z-ADDY         W       20                      CFT014
      *                                                                   CFT014
      ** Determine position of digit to be moved before comma.            CFT014
      *                                                                   CFT014
     C                     SUB  1         X                               CFT014
     C                     Z-ADDX         Z       20                      CFT014
      *                                                                   CFT014
      ** Move characters one by one from right to left.                   CFT014
      *                                                                   CFT014
     C                     DO   X                                         CFT014
     C                     MOVE AMT,Z     AM,Y                            CFT014
     C                     SUB  1         Z                               CFT014
     C                     SUB  1         Y                               CFT014
     C                     ENDDO                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     Z-ADD1         Y                               CFT014
      *                                                                   CFT014
      ** Replace leading zeros with blank.                                CFT014
      *                                                                   CFT014
     C           AM,Y      DOWEQ'0'                                       CFT014
     C           Y         ANDNEW                                         CFT014
     C                     MOVE ' '       AM,Y                            CFT014
     C                     ADD  1         Y                               CFT014
     C                     ENDDO                                          CFT014
      *                                                                   CFT014
      ** Save field from array.                                           CFT014
      *                                                                   CFT014
     C                     MOVEAAM        AMX    14                       CFT014
     C                     MOVE AMX       WOAMNT                          CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
      ** If CSW020 is switched on, perform decimal places prosessing.     CFT014
      *                                                                   CFT014
     C                     CALL 'ZM0040'                                  CFT014
     C                     PARM WIAMNT    ZAMNT                           CFT014
     C                     PARM WICCY     ZCCY                            CFT014
     C                     PARM *BLANKS   ZSAMNT                          CFT014
     C                     PARM *BLANKS   ZSCCY                           CFT014
     C                     PARM *BLANKS   ZERR                            CFT014
      *                                                                   CFT014
     C           ZERR      IFEQ '1'                                       CFT014
     C                     MOVE '045'     DBERR#                          CFT014
     C                     MOVELWICCY     DBERKY                          CFT014
     C                     MOVEL'ZM0040  'DBFNAM                          CFT014
     C                     EXSR DBERR                                     CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C                     MOVE ZSAMNT    WOAMNT                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Left-justify amount.                                             CFT014
      *                                                                   CFT014
     C                     MOVEA*BLANKS   FAMT                            CFT014
     C                     MOVEAWOAMNT    FAMT                            CFT014
     C                     Z-ADD1         S                               CFT014
     C           FAMT,S    DOWEQ' '                                       CFT014
     C                     ADD  1         S                               CFT014
     C                     ENDDO                                          CFT014
     C                     MOVE *BLANKS   WOAMNT                          CFT014
     C                     MOVEAFAMT,S    WOAMNT                          CFT014
      *                                                                   CFT014
     C                     ENDSR                                          CFT014
      *****************************************************************   CFT014
      /EJECT                                                              CFT014
      *****************************************************************   CFT014
      *                                                               *   CFT014
      *  SR1190 - Formatting Exchange Rate to SWIFT format            *   CFT014
      *                                                               *   CFT014
      *  Called by: Any routine that needs SWIFT rate format.         *   CFT014
      *                                                               *   CFT014
      *  Calls    : ZM1190, DBERR                                     *   CFT014
      *                                                               *   CFT014
      *****************************************************************   CFT014
     C           SR1190    BEGSR                                          CFT014
      *                                                                   CFT014
     C                     MOVE *BLANKS   WSPRIC 16                       CFT014
     C                     MOVE *BLANKS   WOPRIC 21                       CFT014
     C                     Z-ADDWIPRIC    WPRIC  117                      CFT014
      *                                                                   CFT014
     C                     CALL 'ZM1190'               28                 CFT014
     C                     PARM           WIPRIC 158                      CFT014
     C                     PARM           WSPRIC                          CFT014
     C                     PARM           WOPRIC                          CFT014
      *                                                                   CFT014
     C           *IN28     IFEQ '1'                                       CFT014
     C                     MOVE '047'     DBERR#                          CFT014
     C                     MOVE *BLANKS   DBERKY                          CFT014
     C                     MOVEL'ZM1190  'DBFNAM                          CFT014
     C                     EXSR DBERR                                     CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           WPRIC     IFLT 0                                         CFT014
     C           'N'       CAT  WSPRIC:0  WSPRIC                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDSR                                          CFT014
      *****************************************************************   CFT014
      /EJECT                                                              CFT014
      *****************************************************************   CFT014
      *                                                               *   CFT014
      *  SR72 - Condition the flag that also controls the printing    *   CFT014
      *         of M103+ message                                      *   CFT014
      *         Sets on W72 flag if all the conditions for field 72   *   CFT014
      *         are satisfied.                                        *   CFT014
      *                                                               *   CFT014
      *  Called by: Main processing                                   *   CFT014
      *                                                               *   CFT014
      *  Calls    : SR1400                                            *   CFT014
      *                                                               *   CFT014
      *****************************************************************   CFT014
     C           SR72      BEGSR                                          CFT014
      *                                                                   CFT014
     C                     MOVE 'N'       W72                             CFT014
      *                                                                   CFT014
      ** It must not contain the codeword /REJT/, /RETN/, nor the ERI     CFT014
      ** codeword /OCMT/.                                                 CFT014
      *                                                                   CFT014
     C           M7BTB1    IFNE *BLANKS                                   CFT014
     C           '/REJT/'  SCAN M7BTB1                   28               CFT014
     C           *IN28     IFEQ *ON                                       CFT014
     C                     GOTO EX72                                      CFT014
     C                     ENDIF                                          CFT014
     C           '/RETN/'  SCAN M7BTB1                   28               CFT014
     C           *IN28     IFEQ *ON                                       CFT014
     C                     GOTO EX72                                      CFT014
     C                     ENDIF                                          CFT014
     C           '/OCMT/'  SCAN M7BTB1                   28               CFT014
     C           *IN28     IFEQ *ON                                       CFT014
     C                     GOTO EX72                                      CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           M7BTB2    IFNE *BLANKS                                   CFT014
     C           '/REJT/'  SCAN M7BTB2                   28               CFT014
     C           *IN28     IFEQ *ON                                       CFT014
     C                     GOTO EX72                                      CFT014
     C                     ENDIF                                          CFT014
     C           '/RETN/'  SCAN M7BTB2                   28               CFT014
     C           *IN28     IFEQ *ON                                       CFT014
     C                     GOTO EX72                                      CFT014
     C                     ENDIF                                          CFT014
     C           '/OCMT/'  SCAN M7BTB2                   28               CFT014
     C           *IN28     IFEQ *ON                                       CFT014
     C                     GOTO EX72                                      CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           M7BTB3    IFNE *BLANKS                                   CFT014
     C           '/REJT/'  SCAN M7BTB3                   28               CFT014
     C           *IN28     IFEQ *ON                                       CFT014
     C                     GOTO EX72                                      CFT014
     C                     ENDIF                                          CFT014
     C           '/RETN/'  SCAN M7BTB3                   28               CFT014
     C           *IN28     IFEQ *ON                                       CFT014
     C                     GOTO EX72                                      CFT014
     C                     ENDIF                                          CFT014
     C           '/OCMT/'  SCAN M7BTB3                   28               CFT014
     C           *IN28     IFEQ *ON                                       CFT014
     C                     GOTO EX72                                      CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           M7BTB4    IFNE *BLANKS                                   CFT014
     C           '/REJT/'  SCAN M7BTB4                   28               CFT014
     C           *IN28     IFEQ *ON                                       CFT014
     C                     GOTO EX72                                      CFT014
     C                     ENDIF                                          CFT014
     C           '/RETN/'  SCAN M7BTB4                   28               CFT014
     C           *IN28     IFEQ *ON                                       CFT014
     C                     GOTO EX72                                      CFT014
     C                     ENDIF                                          CFT014
     C           '/OCMT/'  SCAN M7BTB4                   28               CFT014
     C           *IN28     IFEQ *ON                                       CFT014
     C                     GOTO EX72                                      CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           M7BTB5    IFNE *BLANKS                                   CFT014
     C           '/REJT/'  SCAN M7BTB5                   28               CFT014
     C           *IN28     IFEQ *ON                                       CFT014
     C                     GOTO EX72                                      CFT014
     C                     ENDIF                                          CFT014
     C           '/RETN/'  SCAN M7BTB5                   28               CFT014
     C           *IN28     IFEQ *ON                                       CFT014
     C                     GOTO EX72                                      CFT014
     C                     ENDIF                                          CFT014
     C           '/OCMT/'  SCAN M7BTB5                   28               CFT014
     C           *IN28     IFEQ *ON                                       CFT014
     C                     GOTO EX72                                      CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           M7BTB6    IFNE *BLANKS                                   CFT014
     C           '/REJT/'  SCAN M7BTB6                   28               CFT014
     C           *IN28     IFEQ *ON                                       CFT014
     C                     GOTO EX72                                      CFT014
     C                     ENDIF                                          CFT014
     C           '/RETN/'  SCAN M7BTB6                   28               CFT014
     C           *IN28     IFEQ *ON                                       CFT014
     C                     GOTO EX72                                      CFT014
     C                     ENDIF                                          CFT014
     C           '/OCMT/'  SCAN M7BTB6                   28               CFT014
     C           *IN28     IFEQ *ON                                       CFT014
     C                     GOTO EX72                                      CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** If field 72 contains /INS/, it should be followed by a SWIFT     CFT014
      ** address.  The SWIFT address will be validated via call to        CFT014
      ** ME1400.  It is a SWIFT address if it is found in Customers       CFT014
      ** file, Counterparty Nostros file, or in BIC Directory.            CFT014
      *                                                                   CFT014
     C           M7BTB1    IFNE *BLANKS                                   CFT014
     C           '/INS/'   SCAN M7BTB1                   28               CFT014
     C           *IN28     IFEQ *ON                                       CFT014
     C                     MOVEA*BLANKS   WA1                             CFT014
     C                     MOVEAM7BTB1    WA1                             CFT014
     C                     MOVEAWA1,6     W9BICC                          CFT014
     C                     MOVEAWA1,14    W9BICB                          CFT014
     C                     EXSR SR1400                                    CFT014
     C           W9CUST    IFNE 'Y'                                       CFT014
     C           W9CNST    ANDNE'Y'                                       CFT014
     C           W9BICD    ANDNE'Y'                                       CFT014
     C                     GOTO EX72                                      CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           M7BTB2    IFNE *BLANKS                                   CFT014
     C           '/INS/'   SCAN M7BTB2                   28               CFT014
     C           *IN28     IFEQ *ON                                       CFT014
     C                     MOVEA*BLANKS   WA1                             CFT014
     C                     MOVEAM7BTB2    WA1                             CFT014
     C                     MOVEAWA1,6     W9BICC                          CFT014
     C                     MOVEAWA1,14    W9BICB                          CFT014
     C                     EXSR SR1400                                    CFT014
     C           W9CUST    IFNE 'Y'                                       CFT014
     C           W9CNST    ANDNE'Y'                                       CFT014
     C           W9BICD    ANDNE'Y'                                       CFT014
     C                     GOTO EX72                                      CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           M7BTB3    IFNE *BLANKS                                   CFT014
     C           '/INS/'   SCAN M7BTB3                   28               CFT014
     C           *IN28     IFEQ *ON                                       CFT014
     C                     MOVEA*BLANKS   WA1                             CFT014
     C                     MOVEAM7BTB3    WA1                             CFT014
     C                     MOVEAWA1,6     W9BICC                          CFT014
     C                     MOVEAWA1,14    W9BICB                          CFT014
     C                     EXSR SR1400                                    CFT014
     C           W9CUST    IFNE 'Y'                                       CFT014
     C           W9CNST    ANDNE'Y'                                       CFT014
     C           W9BICD    ANDNE'Y'                                       CFT014
     C                     GOTO EX72                                      CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           M7BTB4    IFNE *BLANKS                                   CFT014
     C           '/INS/'   SCAN M7BTB4                   28               CFT014
     C           *IN28     IFEQ *ON                                       CFT014
     C                     MOVEA*BLANKS   WA1                             CFT014
     C                     MOVEAM7BTB4    WA1                             CFT014
     C                     MOVEAWA1,6     W9BICC                          CFT014
     C                     MOVEAWA1,14    W9BICB                          CFT014
     C                     EXSR SR1400                                    CFT014
     C           W9CUST    IFNE 'Y'                                       CFT014
     C           W9CNST    ANDNE'Y'                                       CFT014
     C           W9BICD    ANDNE'Y'                                       CFT014
     C                     GOTO EX72                                      CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           M7BTB5    IFNE *BLANKS                                   CFT014
     C           '/INS/'   SCAN M7BTB5                   28               CFT014
     C           *IN28     IFEQ *ON                                       CFT014
     C                     MOVEA*BLANKS   WA1                             CFT014
     C                     MOVEAM7BTB5    WA1                             CFT014
     C                     MOVEAWA1,6     W9BICC                          CFT014
     C                     MOVEAWA1,14    W9BICB                          CFT014
     C                     EXSR SR1400                                    CFT014
     C           W9CUST    IFNE 'Y'                                       CFT014
     C           W9CNST    ANDNE'Y'                                       CFT014
     C           W9BICD    ANDNE'Y'                                       CFT014
     C                     GOTO EX72                                      CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           M7BTB6    IFNE *BLANKS                                   CFT014
     C           '/INS/'   SCAN M7BTB6                   28               CFT014
     C           *IN28     IFEQ *ON                                       CFT014
     C                     MOVEA*BLANKS   WA1                             CFT014
     C                     MOVEAM7BTB6    WA1                             CFT014
     C                     MOVEAWA1,6     W9BICC                          CFT014
     C                     MOVEAWA1,14    W9BICB                          CFT014
     C                     EXSR SR1400                                    CFT014
     C           W9CUST    IFNE 'Y'                                       CFT014
     C           W9CNST    ANDNE'Y'                                       CFT014
     C           W9BICD    ANDNE'Y'                                       CFT014
     C                     GOTO EX72                                      CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVE 'Y'       W72                             CFT014
      *                                                                   CFT014
     C           EX72      ENDSR                                          CFT014
      *****************************************************************   CFT014
      /EJECT                                                              CFT014
      *****************************************************************   CFT014
      *                                                               *   CFT014
      *  SRDTMG - Determine type of message (100 or 103)              *   CFT014
      *                                                               *   CFT014
      *  Called by: SR01                                              *   CFT014
      *                                                               *   CFT014
      *  Calls    : ME1730, DBERR                                     *   CFT014
      *                                                               *   CFT014
      *****************************************************************   CFT014
     C           SRDTMG    BEGSR                                          CFT014
      *                                                                                       CSW203
     C           CSW203    IFEQ 'Y'                                                           CSW203
      *                                                                                       CSW203
     C                     MOVE 'Y'       WMT103                                              CSW203
      *                                                                                       CSW203
     C                     ELSE                                                               CSW203
      *                                                                   CFT014
      ** OTPAYDD/Branch                                                   CFT014
      *                                                                   CFT014
     C                     MOVE BRCAA     WBRCA                           CFT014
      *                                                                   CFT014
      ** Sender's address (O@SWSN) as output from MG9900                  CFT014
      *                                                                   CFT014
     C                     MOVELO@SWSN    WSWSN                           CFT014
      *                                                                   CFT014
      ** Destination's address (O@SWDS) as output from MG9900             CFT014
      *                                                                   CFT014
     C                     MOVELO@SWDS    WSWDS                           CFT014
      *                                                                   CFT014
      ** OTPAYDD/Ordering Bank                                            CFT014
      *                                                                   CFT014
     C                     MOVELORBK      WORBK                           CFT014
      *                                                                   CFT014
      ** OTPAYDD/Sender's Correspondent                                   CFT014
      *                                                                   CFT014
     C                     MOVELSNCO      WSNCO                           CFT014
      *                                                                   CFT014
     C                     CALL 'ME1730'                                  CFT014
      *                                                                   CFT014
      ** Input parameters                                                 CFT014
      *                                                                   CFT014
     C                     PARM           WBRCA   3                       CFT014
     C                     PARM           WSWSN  11                       CFT014
     C                     PARM           WSWDS  11                       CFT014
     C                     PARM           WORBK 256                       CFT014
     C                     PARM           WBBI  256        Bank-Bank info CFT014
     C                     PARM           WSNCO 256        Sndr's corresp.CFT014
     C                     PARM           WRCCO 256        Rcvr's corresp.CFT014
      *                                                                   CFT014
      ** Output parameters                                                CFT014
      *                                                                   CFT014
     C                     PARM *BLANKS   PRTCD                           CFT014
      *                                                                   CFT014
     C                     SELEC                                          CFT014
      *                                                                   CFT014
     C           PRTCD     WHEQ '*ERROR '                                 CFT014
     C                     MOVE '048'     DBERR#                          CFT014
     C                     MOVEL'*CALL   'DBERKY                          CFT014
     C                     MOVEL'ME1730  'DBFNAM                          CFT014
     C                     EXSR DBERR                                     CFT014
      *                                                                   CFT014
     C           PRTCD     WHEQ '*CRT103'                                 CFT014
     C                     MOVE 'Y'       WMT103                          CFT014
      *                                                                   CFT014
     C                     ENDSL                                          CFT014
      *                                                                                       CSW203
     C                     ENDIF                                                              CSW203
      *                                                                   CFT014
     C                     ENDSR                                          CFT014
      *****************************************************************   CFT014
      /EJECT                                                              CFT014
      *****************************************************************   CFT014
      *                                                               *   CFT014
      *  SR1400 - Call to ME1400                                      *   CFT014
      *                                                               *   CFT014
      *  Called by: SR72, SRCHK2                                      *   CFT014
      *                                                               *   CFT014
      *  Calls    : ME1400                                            *   CFT014
      *                                                               *   CFT014
      *****************************************************************   CFT014
     C           SR1400    BEGSR                                          CFT014
      *                                                                   CFT014
     C                     CALL 'ME1400'                                  CFT014
     C                     PARM *BLANKS   W9RTN                           CFT014
     C                     PARM           W9BICC                          CFT014
     C                     PARM           W9BICB                          CFT014
     C                     PARM           SDCUST                          CFT014
     C                     PARM           SDCNST                          CFT014
     C                     PARM           MEBICD                          CFT014
     C                     PARM *BLANKS   W9CUST                          CFT014
     C                     PARM *BLANKS   W9CNST                          CFT014
     C                     PARM *BLANKS   W9BICD                          CFT014
      *                                                                   CFT014
     C                     ENDSR                                          CFT014
      *****************************************************************   CFT014
      /EJECT                                                              CFT014
      *****************************************************************   CFT014
      *                                                               *   CFT014
      *  SRBTB1 - Moves details on the next available line of the     *   CFT014
      *           Bank-to-Bank details (FT0640P1)                     *   CFT014
      *                                                               *   CFT014
      *  Called by: Main processing                                   *   CFT014
      *                                                               *   CFT014
      *  Calls    : None                                              *   CFT014
      *                                                               *   CFT014
      *****************************************************************   CFT014
     C           SRBTB1    BEGSR                                          CFT014
      *                                                                   CFT014
      ** Input parameter                                                  CFT014
      *                                                                   CFT014
     C                     MOVE WCHR35    WCHR35 35                       CFT014
      *                                                                   CFT014
     C           WCHR35    IFNE *BLANKS                                   CFT014
     C           M7BTB6    ANDEQ*BLANKS                                   CFT014
     C                     SELEC                                          CFT014
     C           M7BTB1    WHEQ *BLANKS                                   CFT014
     C                     MOVELWCHR35    M7BTB1                          CFT014
     C           M7BTB2    WHEQ *BLANKS                                   CFT014
     C                     MOVELWCHR35    M7BTB2                          CFT014
     C           M7BTB3    WHEQ *BLANKS                                   CFT014
     C                     MOVELWCHR35    M7BTB3                          CFT014
     C           M7BTB4    WHEQ *BLANKS                                   CFT014
     C                     MOVELWCHR35    M7BTB4                          CFT014
     C           M7BTB5    WHEQ *BLANKS                                   CFT014
     C                     MOVELWCHR35    M7BTB5                          CFT014
     C           M7BTB6    WHEQ *BLANKS                                   CFT014
     C                     MOVELWCHR35    M7BTB6                          CFT014
     C                     ENDSL                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDSR                                          CFT014
      *****************************************************************   CFT014
      /EJECT                                                              CFT014
      *****************************************************************   CFT014
      *                                                               *   CFT014
      *  SRBTB2 - Moves details on the next available line of the     *   CFT014
      *           Bank-to-Bank details (FT0640P2)                     *   CFT014
      *                                                               *   CFT014
      *  Called by: Main processing                                   *   CFT014
      *                                                               *   CFT014
      *  Calls    : None                                              *   CFT014
      *                                                               *   CFT014
      *****************************************************************   CFT014
     C           SRBTB2    BEGSR                                          CFT014
      *                                                                   CFT014
      ** Input parameter                                                  CFT014
      *                                                                   CFT014
     C                     MOVE WCHR35    WCHR35                          CFT014
      *                                                                   CFT014
     C           WCHR35    IFNE *BLANKS                                   CFT014
     C           P2BTB6    ANDEQ*BLANKS                                   CFT014
     C                     SELEC                                          CFT014
     C           P2BTB1    WHEQ *BLANKS                                   CFT014
     C                     MOVELWCHR35    P2BTB1                          CFT014
     C           P2BTB2    WHEQ *BLANKS                                   CFT014
     C                     MOVELWCHR35    P2BTB2                          CFT014
     C           P2BTB3    WHEQ *BLANKS                                   CFT014
     C                     MOVELWCHR35    P2BTB3                          CFT014
     C           P2BTB4    WHEQ *BLANKS                                   CFT014
     C                     MOVELWCHR35    P2BTB4                          CFT014
     C           P2BTB5    WHEQ *BLANKS                                   CFT014
     C                     MOVELWCHR35    P2BTB5                          CFT014
     C           P2BTB6    WHEQ *BLANKS                                   CFT014
     C                     MOVELWCHR35    P2BTB6                          CFT014
     C                     ENDSL                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDSR                                          CFT014
      *****************************************************************   CFT014
      /EJECT                                                              CFT014
      *****************************************************************   CFT014
      *                                                               *   CFT014
      *  SRICD1 - Moves details on the next available line of the     *   CFT014
      *           Instruction Code details                            *   CFT014
      *                                                               *   CFT014
      *  Called by: Main processing                                   *   CFT014
      *                                                               *   CFT014
      *  Calls    : None                                              *   CFT014
      *                                                               *   CFT014
      *****************************************************************   CFT014
     C           SRICD1    BEGSR                                          CFT014
      *                                                                   CFT014
      ** Input parameter                                                  CFT014
      *                                                                   CFT014
     C                     MOVE WCHR35    WCHR35 35                       CFT014
      *                                                                   CFT014
     C           WCHR35    IFNE *BLANKS                                   CFT014
     C                     SELEC                                          CFT014
     C           M9ICD1    WHEQ *BLANKS                                   CFT014
     C                     MOVE WCHR35    M9ICD1                          CFT014
     C                     MOVEL':23E:'   P1ICD1                          CFT014
     C                     MOVE WCHR35    P1ICD1                          CFT014
     C           M9ICD2    WHEQ *BLANKS                                   CFT014
     C                     MOVE WCHR35    M9ICD2                          CFT014
     C                     MOVEL':23E:'   P1ICD2                          CFT014
     C                     MOVE WCHR35    P1ICD2                          CFT014
     C           M9ICD3    WHEQ *BLANKS                                   CFT014
     C                     MOVE WCHR35    M9ICD3                          CFT014
     C                     MOVEL':23E:'   P1ICD3                          CFT014
     C                     MOVE WCHR35    P1ICD3                          CFT014
     C           M9ICD4    WHEQ *BLANKS                                   CFT014
     C                     MOVE WCHR35    M9ICD4                          CFT014
     C                     MOVEL':23E:'   P1ICD4                          CFT014
     C                     MOVE WCHR35    P1ICD4                          CFT014
     C           M9ICD5    WHEQ *BLANKS                                   CFT014
     C                     MOVE WCHR35    M9ICD5                          CFT014
     C                     MOVEL':23E:'   P1ICD5                          CFT014
     C                     MOVE WCHR35    P1ICD5                          CFT014
     C           M9ICD6    WHEQ *BLANKS                                   CFT014
     C                     MOVE WCHR35    M9ICD6                          CFT014
     C                     MOVEL':23E:'   P1ICD6                          CFT014
     C                     MOVE WCHR35    P1ICD6                          CFT014
     C           M9ICD7    WHEQ *BLANKS                                   CFT014
     C                     MOVE WCHR35    M9ICD7                          CFT014
     C                     MOVEL':23E:'   P1ICD7                          CFT014
     C                     MOVE WCHR35    P1ICD7                          CFT014
     C           M9ICD8    WHEQ *BLANKS                                   CFT014
     C                     MOVE WCHR35    M9ICD8                          CFT014
     C                     MOVEL':23E:'   P1ICD8                          CFT014
     C                     MOVE WCHR35    P1ICD8                          CFT014
     C           M9ICD9    WHEQ *BLANKS                                   CFT014
     C                     MOVE WCHR35    M9ICD9                          CFT014
     C                     MOVEL':23E:'   P1ICD9                          CFT014
     C                     MOVE WCHR35    P1ICD9                          CFT014
     C           M9ICDA    WHEQ *BLANKS                                   CFT014
     C                     MOVE WCHR35    M9ICDA                          CFT014
     C                     MOVEL':23E:'   P1ICDA                          CFT014
     C                     MOVE WCHR35    P1ICDA                          CFT014
     C           M9ICDB    WHEQ *BLANKS                                   CFT014
     C                     MOVE WCHR35    M9ICDB                          CFT014
     C                     MOVEL':23E:'   P1ICDB                          CFT014
     C                     MOVE WCHR35    P1ICDB                          CFT014
     C                     ENDSL                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDSR                                          CFT014
      *****************************************************************   CFT014
      /EJECT                                                              CFT014
      *****************************************************************   CFT014
      *                                                               *   CFT014
      *  SRTRI1  - Moves details on the next available line of the    *   CFT014
      *            Third Reimbursement Institution                    *   CFT014
      *                                                               *   CFT014
      *  Called by: Main processing                                   *   CFT014
      *                                                               *   CFT014
      *  Calls    : None                                              *   CFT014
      *                                                               *   CFT014
      *****************************************************************   CFT014
     C           SRTRI1    BEGSR                                          CFT014
      *                                                                   CFT014
      ** Input parameter                                                  CFT014
      *                                                                   CFT014
     C                     MOVE WCHR35    WCHR35 35                       CFT014
      *                                                                   CFT014
     C           WCHR35    IFNE *BLANKS                                   CFT014
     C                     SELEC                                          CFT014
     C           M9TRI1    WHEQ *BLANKS                                   CFT014
     C                     MOVE WCHR35    M9TRI1                          CFT014
     C           M9TRI2    WHEQ *BLANKS                                   CFT014
     C                     MOVE WCHR35    M9TRI2                          CFT014
     C           M9TRI3    WHEQ *BLANKS                                   CFT014
     C                     MOVE WCHR35    M9TRI3                          CFT014
     C           M9TRI4    WHEQ *BLANKS                                   CFT014
     C                     MOVE WCHR35    M9TRI4                          CFT014
     C           M9TRI5    WHEQ *BLANKS                                   CFT014
     C                     MOVE WCHR35    M9TRI5                          CFT014
     C                     ENDSL                                          CFT014
     C                     ADD  1         Q                               CFT014
     C           Q         OCUR MULT                                      CFT014
     C                     MOVELWCHR35    MFLD                            CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDSR                                          CFT014
      *****************************************************************   CFT014
      /EJECT                                                              CFT014
      *****************************************************************   CFT014
      *                                                               *   CFT014
      *  SRSPT - Moves details on the next available OFSPT* field     *   CFT014
      *                                                               *   CFT014
      *  Called by: Main processing                                   *   CFT014
      *                                                               *   CFT014
      *  Calls    : None                                              *   CFT014
      *                                                               *   CFT014
      *****************************************************************   CFT014
     C           SRSPT     BEGSR                                          CFT014
      *                                                                   CFT014
      ** Input parameter                                                  CFT014
      *                                                                   CFT014
     C                     MOVE WCHR35    WCHR35 35                       CFT014
      *                                                                   CFT014
     C           WCHR35    IFNE *BLANKS                                   CFT014
     C                     SELEC                                          CFT014
     C           OFSPT1    WHEQ *BLANKS                                   CFT014
     C                     MOVE WCHR35    OFSPT1                          CFT014
     C           OFSPT2    WHEQ *BLANKS                                   CFT014
     C                     MOVE WCHR35    OFSPT2                          CFT014
     C           OFSPT3    WHEQ *BLANKS                                   CFT014
     C                     MOVE WCHR35    OFSPT3                          CFT014
     C           OFSPT4    WHEQ *BLANKS                                   CFT014
     C                     MOVE WCHR35    OFSPT4                          CFT014
     C           OFSPT5    WHEQ *BLANKS                                   CFT014
     C                     MOVE WCHR35    OFSPT5                          CFT014
     C           OFSPT6    WHEQ *BLANKS                                   CFT014
     C                     MOVE WCHR35    OFSPT6                          CFT014
     C                     ENDSL                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDSR                                          CFT014
      *****************************************************************   CFT014
      /EJECT                                                              CFT014
      *****************************************************************   CFT014
      *                                                               *   CFT014
      *  SRICBB - Checks if an Instruction Code exists on the         *   CFT014
      *           table below and that it's equivalent codeword       *   CFT014
      *           doesn't exist in the Bank-to-Bank info              *   CFT014
      *                                                               *   CFT014
      *  Called by: Main processing                                   *   CFT014
      *                                                               *   CFT014
      *  Calls    : None                                              *   CFT014
      *                                                               *   CFT014
      *****************************************************************   CFT014
     C           SRICBB    BEGSR                                          CFT014
      *                                                                   CFT014
      ** Input parameters                                                 CFT014
      *                                                                   CFT014
     C                     MOVE WCHR04    WCHR04                          CFT014
     C                     MOVE WCHR31    WCHR31                          CFT014
      *                                                                   CFT014
      ** Output parameters                                                CFT014
      *                                                                   CFT014
     C                     MOVE 'N'       WOK     1                       CFT014
     C                     MOVE *BLANKS   WCHR35                          CFT014
      *                                                                   CFT014
     C           WCHR04    IFNE *BLANKS                                   CFT014
      *                                                                   CFT014
     C           WCHR04    LOKUPTABA      TABB           28               CFT014
      *                                                                   CFT014
     C           *IN28     IFEQ *ON                                       CFT014
      *                                                                   CFT014
     C           TABB      SCAN BBI1                     28               CFT014
     C           *IN28     IFEQ *ON                                       CFT014
     C                     GOTO EXICBB                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           TABB      SCAN BBI2                     28               CFT014
     C           *IN28     IFEQ *ON                                       CFT014
     C                     GOTO EXICBB                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           TABB      SCAN BBI3                     28               CFT014
     C           *IN28     IFEQ *ON                                       CFT014
     C                     GOTO EXICBB                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           TABB      SCAN BBI4                     28               CFT014
     C           *IN28     IFEQ *ON                                       CFT014
     C                     GOTO EXICBB                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           TABB      SCAN BBI5                     28               CFT014
     C           *IN28     IFEQ *ON                                       CFT014
     C                     GOTO EXICBB                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           TABB      SCAN BBI6                     28               CFT014
     C           *IN28     IFEQ *ON                                       CFT014
     C                     GOTO EXICBB                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVE 'Y'       WOK                             CFT014
      *                                                                   CFT014
      ** Reformat Instruction Code for output as Bank to Bank             CFT014
      ** details.                                                         CFT014
      *                                                                   CFT014
     C                     MOVELTABB      WCHR35                          CFT014
      *                                                                   CFT014
      ** Add additional info if present.                                  CFT014
      *                                                                   CFT014
     C           WCHR31    IFNE *BLANKS                                   CFT014
     C           '/'       SCAN WCHR35:2  S                               CFT014
     C                     MOVE *BLANK    WA1                             CFT014
     C                     MOVEATABB      WA1                             CFT014
     C                     MOVEAWCHR31    WA1,S                           CFT014
     C                     MOVEAWA1       WCHR35                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           EXICBB    ENDSR                                          CFT014
      *****************************************************************   CFT014
      /EJECT                                                              CFT014
      *****************************************************************   CFT014
      *                                                               *   CFT014
      *  SRCHK1 - Check if a Bank-to-Bank codeword exists on the      *   CFT014
      *           table listed below and if it needs to be included   *   CFT014
      *           in the Instruction Code                             *   CFT014
      *                                                               *   CFT014
      *  Called by: Main processing                                   *   CFT014
      *                                                               *   CFT014
      *  Calls    : None                                              *   CFT014
      *                                                               *   CFT014
      *****************************************************************   CFT014
     C           SRCHK1    BEGSR                                          CFT014
      *                                                                   CFT014
      ** Input parameters                                                 CFT014
      *                                                                   CFT014
     C                     MOVE WCHR35    WCHR35                          CFT014
     C                     MOVE WCHR01    WCHR01                          CFT014
      *                                                                   CFT014
      ** Output parameters                                                CFT014
      *                                                                   CFT014
     C                     MOVE WCHR35    WCHR35                          CFT014
     C                     MOVE *BLANKS   WOC35  35                       CFT014
     C                     MOVE 'N'       WOK                             CFT014
      *                                                                   CFT014
     C           WCHR35    IFNE *BLANKS                                   CFT014
      *                                                                   CFT014
     C                     MOVELWCHR35    WCHR02                          CFT014
     C           WCHR02    IFEQ '//'                                      CFT014
     C           WCHR01    ANDEQ'*'                                       CFT014
     C                     MOVEL'*'       WCHR35                          CFT014
     C                     GOTO EXCHK1                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Retrieve Bank-to-Bank codeword.                                  CFT014
      *                                                                   CFT014
     C           '/'       SCAN WCHR35:2  S                               CFT014
     C           S         IFGT 1                                         CFT014
     C                     MOVE *BLANKS   WCHR10 10                       CFT014
     C           S         SUBSTWCHR35    WCHR10                          CFT014
     C                     ELSE                                           CFT014
     C                     GOTO EXCHK1                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Retrieve equivalent Instruction Code of Bank-to-Bank codeword.   CFT014
      *                                                                   CFT014
     C           WCHR10    LOKUPTABB      TABA           28               CFT014
     C           *IN28     IFEQ *OFF                                      CFT014
     C           TABA      OREQ 'BONL'                                                        CSW206
     C           CSW206    ANDEQ'Y'                                                           CSW206
     C                     GOTO EXCHK1                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVEL'*'       WCHR35                          CFT014
      *                                                                   CFT014
      ** Reformat Bank-to-Bank info into Instruction Code info.           CFT014
      *                                                                   CFT014
     C           35        SUB  S         X                               CFT014
     C                     ADD  1         S                               CFT014
     C           X         SUBSTWCHR35:S  WOC35                           CFT014
     C                     MOVE *BLANK    WA1                             CFT014
     C                     MOVEATABA      WA1                             CFT014
      *                                                                   CFT014
      ** If additional information present, put '/' in between            CFT014
      ** the codeword and the additional information.                     CFT014
      *                                                                   CFT014
     C           WOC35     IFNE *BLANKS                                   CFT014
     C                     MOVEA'/'       WA1,5                           CFT014
     C                     MOVEAWOC35     WA1,6                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVEAWA1       WOC35                           CFT014
      *                                                                   CFT014
      ** Check if the equivalent codeword from the Bank-to-Bank info      CFT014
      ** is not yet included in the Instruction Codes.                    CFT014
      *                                                                   CFT014
     C           WOC35     IFEQ M9ICD1                                    CFT014
     C           WOC35     OREQ M9ICD2                                    CFT014
     C           WOC35     OREQ M9ICD3                                    CFT014
     C           WOC35     OREQ M9ICD4                                    CFT014
     C           WOC35     OREQ M9ICD5                                    CFT014
     C           WOC35     OREQ M9ICD6                                    CFT014
     C           WOC35     OREQ M9ICD7                                    CFT014
     C           WOC35     OREQ M9ICD8                                    CFT014
     C           WOC35     OREQ M9ICD9                                    CFT014
     C           WOC35     OREQ M9ICDA                                    CFT014
     C           WOC35     OREQ M9ICDB                                    CFT014
     C                     GOTO EXCHK1                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVE 'Y'       WOK                             CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           EXCHK1    ENDSR                                          CFT014
      *****************************************************************   CFT014
      /EJECT                                                              CFT014
      *****************************************************************   CFT014
      *                                                               *   CFT014
      *  SRCHK2 - Checks if Bank-to-Bank info contains /RCB/ and if   *   CFT014
      *           true, checks the info following /RCB/               *   CFT014
      *                                                               *   CFT014
      *  Called by: Main processing                                   *   CFT014
      *                                                               *   CFT014
      *  Calls    : SR1400                                            *   CFT014
      *                                                               *   CFT014
      *****************************************************************   CFT014
     C           SRCHK2    BEGSR                                          CFT014
      *                                                                   CFT014
      ** Input parameter                                                  CFT014
      *                                                                   CFT014
     C                     MOVE WCHR35    WCHR35                          CFT014
      *                                                                   CFT014
      ** Output parameter                                                 CFT014
      *                                                                   CFT014
     C                     MOVE *BLANK    WTAG    1                       CFT014
     C                     MOVE *BLANKS   WOC35                           CFT014
     C                     MOVE *BLANK    W201IN  1                                           CSW201
      *                                                                   CFT014
     C                     MOVELWCHR35    WCHR05  5                       CFT014
      *                                                                   CFT014
     C           WCHR05    IFEQ '/RCB/'                                   CFT014
      *                                                                   CFT014
     C           8         SUBSTBBI1:6    W9BICC                          CFT014
     C           3         SUBSTBBI1:14   W9BICB                          CFT014
     C                     EXSR SR1400                                    CFT014
     C           W9CUST    IFEQ 'Y'                                       CFT014
     C           W9CNST    OREQ 'Y'                                       CFT014
     C           W9BICD    OREQ 'Y'                                       CFT014
     C                     MOVE 'Y'       WSWFT                           CFT014
     C                     MOVE 'A'       WTAG                            CFT014
     C           11        SUBSTWCHR35:6  WOC35                           CFT014
      *                                                                                       CSW202
     C           CSW202    IFEQ 'Y'                                                           CSW202
     C           W9BICD    ANDEQ'Y'                                                           CSW202
      *                                                                                       CSW202
     C                     CALL 'AOBEISR0'                                                    CSW202
     C                     PARM *BLANKS   PRTCD                                               CSW202
     C                     PARM '*VERIFY' POPTN                                               CSW202
     C                     PARM BDSUBT    PBIC                                                CSW202
     C           MEBEIS    PARM MEBEIS    DSFDY                                               CSW202
      *                                                                                       CSW202
     C                     ENDIF                                                              CSW202
      *                                                                                       CSW201
      ** If CSW201 is installed, check if BIC entered is BEI.                                 CSW201
      *                                                                                       CSW201
     C           CSW201    IFEQ 'Y'                                                           CSW201
     C           W9BICD    ANDEQ'Y'                                                           CSW201
     C           BDSUBT    ANDEQ'TRCO'                                                        CSW201
     C           CSW202    ANDEQ'N'                                                           CSW202
      *                                                                                       CSW201
     C           CSW201    OREQ 'Y'                                                           CSW201
     C           W9BICD    ANDEQ'Y'                                                           CSW201
     C           BDSUBT    ANDEQ'BEID'                                                        CSW201
     C           CSW202    ANDEQ'N'                                                           CSW202
      *                                                                                       CSW202
     C           W9BICD    OREQ 'Y'                                                           CSW202
     C           PRTCD     ANDEQ*BLANKS                                                       CSW202
     C           CSW202    ANDEQ'Y'                                                           CSW202
      *                                                                                       CSW201
     C                     MOVE 'D'       WTAG                                                CSW201
     C           W9CNST    IFEQ 'Y'                                                           CSW201
     C                     MOVE 'Y'       W201IN                                              CSW201
     C                     MOVELAWCPNM    OFSPT1                                              CSW201
     C                     MOVELAWCNTN    OFSPT2                                              CSW201
     C                     ENDIF                                                              CSW201
     C           W9CUST    IFEQ 'Y'                                                           CSW201
     C                     MOVE 'Y'       W201IN                                              CSW201
     C                     MOVELBBCNA1    OFSPT1                                              CSW201
     C                     MOVELBBCNA2    OFSPT2                                              CSW201
     C                     MOVELBBCNA3    OFSPT3                                              CSW201
     C                     MOVELBBCNA4    OFSPT4                                              CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C                     ELSE                                           CFT014
     C                     MOVE 'N'       WSWFT                           CFT014
     C                     MOVE 'N'       W55A                            CFT014
     C                     MOVE 'D'       WTAG                            CFT014
     C           30        SUBSTWCHR35:6  WOC35                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVE 'Y'       WOK                             CFT014
     C                     ADD  1         Q                               CFT014
     C           Q         OCUR MULT                                      CFT014
     C                     MOVE WTAG      TAG                             CFT014
     C                     MOVE '55'      FLDNO                           CFT014
      *                                                                                       CSW201
     C           W201IN    IFEQ *BLANK                                                        CSW201
     C                     MOVE @MTAG     MTAG                            CFT014
     C                     MOVELWOC35     MFLD                            CFT014
     C                     ELSE                                                               CSW201
      *                                                                                       CSW201
      ** If CSW201 is installed, set up using customer address.                               CSW201
      *                                                                                       CSW201
     C                     MOVE WTAG      OSTAG                                               CSW201
     C                     EXSR FSWAD                                                         CSW201
     C                     ENDIF                                                              CSW201
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDSR                                          CFT014
      *****************************************************************   CFT014
      /EJECT                                                              CFT014
      *****************************************************************   CFT014
      *                                                               *   CFT014
      *  SRCHK3 - Checks if Bank-to-Bank info contains /CHGS/ and     *   CFT014
      *           /OCMT/, and if true, suppress the output            *   CFT014
      *                                                               *   CFT014
      *  Called by: Main processing                                   *   CFT014
      *                                                               *   CFT014
      *  Calls    : None                                              *   CFT014
      *                                                               *   CFT014
      *****************************************************************   CFT014
     C           SRCHK3    BEGSR                                          CFT014
      *                                                                   CFT014
      ** /CHGS/                                                           CFT014
      *                                                                   CFT014
     C           '/CHGS/'  SCAN WBBI1                    28               CFT014
     C           *IN28     IFEQ *ON                                       CFT014
     C                     MOVEL'*'       WBBI1                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           '/CHGS/'  SCAN WBBI2                    28               CFT014
     C           *IN28     IFEQ *ON                                       CFT014
     C                     MOVEL'*'       WBBI2                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           '/CHGS/'  SCAN WBBI3                    28               CFT014
     C           *IN28     IFEQ *ON                                       CFT014
     C                     MOVEL'*'       WBBI3                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           '/CHGS/'  SCAN WBBI4                    28               CFT014
     C           *IN28     IFEQ *ON                                       CFT014
     C                     MOVEL'*'       WBBI4                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           '/CHGS/'  SCAN WBBI5                    28               CFT014
     C           *IN28     IFEQ *ON                                       CFT014
     C                     MOVEL'*'       WBBI5                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           '/CHGS/'  SCAN WBBI6                    28               CFT014
     C           *IN28     IFEQ *ON                                       CFT014
     C                     MOVEL'*'       WBBI6                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** /OCMT/                                                           CFT014
      *                                                                   CFT014
     C           '/OCMT/'  SCAN WBBI1                    28               CFT014
     C           *IN28     IFEQ *ON                                       CFT014
     C                     MOVEL'*'       WBBI1                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           '/OCMT/'  SCAN WBBI2                    28               CFT014
     C           *IN28     IFEQ *ON                                       CFT014
     C                     MOVEL'*'       WBBI2                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           '/OCMT/'  SCAN WBBI3                    28               CFT014
     C           *IN28     IFEQ *ON                                       CFT014
     C                     MOVEL'*'       WBBI3                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           '/OCMT/'  SCAN WBBI4                    28               CFT014
     C           *IN28     IFEQ *ON                                       CFT014
     C                     MOVEL'*'       WBBI4                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           '/OCMT/'  SCAN WBBI5                    28               CFT014
     C           *IN28     IFEQ *ON                                       CFT014
     C                     MOVEL'*'       WBBI5                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           '/OCMT/'  SCAN WBBI6                    28               CFT014
     C           *IN28     IFEQ *ON                                       CFT014
     C                     MOVEL'*'       WBBI6                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDSR                                          CFT014
      *****************************************************************   CFT014
      /EJECT                                                              CFT014
      *****************************************************************   CFT014
      *                                                               *   CFT014
      *  SRW23E - Checks if fld 23E is present and if it only         *   CFT014
      *           contains the codewords CORT, INTC, or SDVA          *   CFT014
      *                                                               *   CFT014
      *  Called by: Main processing                                   *   CFT014
      *                                                               *   CFT014
      *  Calls    : None                                              *   CFT014
      *                                                               *   CFT014
      *****************************************************************   CFT014
     C           SRW23E    BEGSR                                          CFT014
      *                                                                   CFT014
      ** Input parameter                                                  CFT014
      *                                                                   CFT014
     C                     MOVE WCHR35    WCHR35                          CFT014
      *                                                                   CFT014
      ** Output parameter                                                 CFT014
      *                                                                   CFT014
     C                     MOVE 'Y'       WOK     1                       CFT014
      *                                                                   CFT014
     C           WCHR35    IFNE *BLANKS                                   CFT014
     C                     MOVELWCHR35    WCHR04  4                       CFT014
     C           WCHR04    IFNE 'CORT'                                    CFT014
     C           WCHR04    ANDNE'INTC'                                    CFT014
     C           WCHR04    ANDNE'SDVA'                                    CFT014
     C           WCHR04    ANDNE'REPA'                                                        CSW202
     C           WCHR04    OREQ 'REPA'                                                        CSW202
     C           CSW202    ANDEQ'N'                                                           CSW202
     C                     MOVE 'N'       WOK                             CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDSR                                          CFT014
      *****************************************************************   CFT014
      /EJECT                                                              CFT014
      *****************************************************************                       220913
      *                                                               *                       220913
      *  SRICAR - Insert Customer/Account reference                   *                       220913
      *                                                               *                       220913
      *****************************************************************                       220913
     C*                                                                                       220913
     C           SRICAR    BEGSR                                                              220913
     C*                                                                                       220913
     C*  Insert ordering customer or account in the address lines:                            220913
     C           ODMT      IFNE *BLANK                                                        220913
     C           OSTAG     ANDNE'A'                                                           222559
     C           ORCT      OREQ 'C'                                                           220913
     C           OSTAG     ANDNE'A'                                                           222559
     C*                                                                                       220913
     C           ODMT      IFNE *BLANK                                                        220913
     C                     MOVELODMT      WXCUST 35 P                                         220913
     C                     ELSE                                                               220913
     C                     MOVELORC1      WXCUST    P                                         220913
     C                     ENDIF                                                              220913
     C*                                                                                       220913
     C                     SELEC                                                              220913
     C           OFSPT2    WHEQ *BLANK                                                        220913
     C           OFSPT3    ANDEQ*BLANK                                                        220913
     C           OFSPT4    ANDEQ*BLANK                                                        220913
     C                     MOVELWXCUST    OFSPT2                                              220913
     C           OFSPT2    WHEQ *BLANK                                                        220913
     C           OFSPT3    ANDEQ*BLANK                                                        220913
     C           OFSPT4    ANDNE*BLANK                                                        220913
     C                     MOVELOFSPT4    OFSPT2                                              220913
     C                     MOVELWXCUST    OFSPT3                                              220913
     C                     MOVEL*BLANK    OFSPT4                                              220913
     C           OFSPT2    WHEQ *BLANK                                                        220913
     C           OFSPT3    ANDNE*BLANK                                                        220913
     C           OFSPT4    ANDEQ*BLANK                                                        220913
     C                     MOVELOFSPT3    OFSPT2                                              220913
     C                     MOVELWXCUST    OFSPT3    P                                         220913
     C                     MOVEL*BLANK    OFSPT4                                              220913
     C           OFSPT2    WHEQ *BLANK                                                        220913
     C           OFSPT3    ANDNE*BLANK                                                        220913
     C           OFSPT4    ANDNE*BLANK                                                        220913
     C                     MOVELOFSPT3    OFSPT2                                              220913
     C                     MOVELOFSPT4    OFSPT3                                              220913
     C                     MOVELWXCUST    OFSPT4    P                                         220913
     C           OFSPT2    WHNE *BLANK                                                        220913
     C           OFSPT3    ANDEQ*BLANK                                                        220913
     C           OFSPT4    ANDEQ*BLANK                                                        220913
     C                     MOVELWXCUST    OFSPT3                                              220913
     C           OFSPT2    WHNE *BLANK                                                        220913
     C           OFSPT3    ANDEQ*BLANK                                                        220913
     C           OFSPT4    ANDNE*BLANK                                                        220913
     C                     MOVELOFSPT4    OFSPT3                                              220913
     C                     MOVELWXCUST    OFSPT4    P                                         220913
     C                     OTHER                                                              220913
     C                     MOVELWXCUST    OFSPT4    P                                         220913
     C                     ENDSL                                                              220913
     C*                                                                                       220913
     C                     ENDIF                                                              220913
     C*                                                                                       220913
     C           ORCT      IFEQ 'R'                                                           220913
     C           ORCT      OREQ 'P'                                                           220913
     C           ORCT      OREQ 'A'                                                         BUG13289
     C           ADSLSH    ANDEQ'/'                                                         BUG13289
     C*                                                                                       220913
     C           ORCT      IFEQ 'R'                                                           220913
     C           ORCT      OREQ 'A'                                                         BUG13289
     C           ORCT      IFEQ 'R'                                                         BUG13289
     C           '/'       CAT  ORC1:0    WXACCT 35 P                                         220913
     C                     ELSE                                                             BUG13289
     C                     MOVE ORC1      WXACCT    P                                       BUG13289
     C                     ENDIF                                                            BUG13289
     C                     ELSE                                                               220913
     C                     MOVELORC1      ZORC1     P                                         220913
     C           '/'       CAT  ZCNUM:0   WXACCT 35 P                                         220913
     C           WXACCT    CAT  ZACOD:0   WXACCT                                              220913
     C           WXACCT    CAT  ZACSQ:0   WXACCT                                              220913
     C           WXACCT    CAT  ZBRCA:0   WXACCT                                              220913
     C                     ENDIF                                                              220913
     C*                                                                                       220913
     C                     MOVELOFSPT4    OFSPT5                                              220913
     C                     MOVELOFSPT3    OFSPT4                                              220913
     C                     MOVELOFSPT2    OFSPT3                                              220913
     C                     MOVELOFSPT1    OFSPT2                                              220913
     C                     MOVELWXACCT    OFSPT1                                              220913
     C*                                                                                       220913
     C                     ENDIF                                                              220913
     C*                                                                                       220913
      * Insert Customer Number in the first line of tag 50K if                                257347
      * Customer Number is used in the Ordering Customer field                                257347
      *                                                                                       257347
     C           ORCT      IFEQ 'C'                                                           257347
     C           OSTAG     ANDEQ'K'                                                           257347
      *                                                                                       257347
     C                     MOVELORC1      WXCUST 35 P                                         257347
      *                                                                                       257347
     C                     MOVELOFSPT4    OFSPT5                                              257347
     C                     MOVELOFSPT3    OFSPT4                                              257347
     C                     MOVELOFSPT2    OFSPT3                                              257347
     C                     MOVELOFSPT1    OFSPT2                                              257347
     C           '/'       CAT  WXCUST    OFSPT1                                              257347
      *                                                                                       257347
     C                     ENDIF                                                              257347
      *                                                                                       257347
     C                     ENDSR                                                              220913
      *****************************************************************                       220913
     C/EJECT                                                                                  220913
      *****************************************************************                       CSW202
      *                                                               *                       CSW202
      *  SRSCT  - Determine Support Charge Transparency               *                       CSW202
      *                                                               *                       CSW202
      *****************************************************************                       CSW202
     C           SRSCT     BEGSR                                                              CSW202
      *                                                                                       CSW202
      ** Initialize Support Charge Transparency field                                         CSW202
      *                                                                                       CSW202
     C                     MOVE 'N'       WKSCHT  1                                           CSW202
      *                                                                                       CSW202
     C                     CALL 'AOBICDV0'                                                    CSW202
     C                     PARM *BLANKS   PRTCD                                               CSW202
     C                     PARM WRK18     PBICD  18                                           CSW202
     C                     PARM           PTYPE   7                                           CSW202
     C                     PARM           DSSDY                                               CSW202
      *                                                                                       CSW202
      ** If entry is a customer number, retrieve the Customer Swift                           CSW202
      ** ID                                                                                   CSW202
      *                                                                                       CSW202
     C           PTYPE     IFEQ '*NUMBER'                                                     CSW202
     C           WFLAG     ANDEQ'Y'                                                           CSW202
     C           PTYPE     OREQ '*SHNAME'                                                     CSW202
     C           WFLAG     ANDEQ'Y'                                                           CSW202
      *                                                                                       CSW202
     C                     MOVELDSSDY     SDCUST                                              CSW202
     C                     MOVELBBCSID    WRK18                                               CSW202
      *                                                                                       CSW202
     C                     CALL 'AOBICDV0'                                                    CSW202
     C                     PARM *BLANKS   PRTCD                                               CSW202
     C                     PARM WRK18     PBICD  18                                           CSW202
     C                     PARM           PTYPE   7                                           CSW202
     C                     PARM           DSSDY                                               CSW202
      *                                                                                       CSW202
     C                     ENDIF                                                              CSW202
      *                                                                                       CSW202
      ** If entry is a BIC Identifier, check for the country code                             CSW202
      ** of sender/destination                                                                CSW202
      *                                                                                       CSW202
     C           PTYPE     IFEQ '*BIC'                                                        CSW202
     C                     MOVELDSSDY     MEBICD                                              CSW202
     C           2         SUBSTBDBICC:5  WCNTY   2                                           CSW202
      *                                                                                       CSW202
      ** Determine if sender/destination country code exists in ISO                           CSW202
      ** country code file.  If found, check if 'Support Charges                              CSW202
      ** Transparency' flag is 'Y'                                                            CSW202
      *                                                                                       CSW202
     C           WCNTY     CHAINMEISOCL1             52                                       CSW202
      *                                                                                       CSW202
     C           *IN52     IFEQ *OFF                                                          CSW202
     C********** M3SCHT    ANDEQ'Y'                                                    CSW202 CSW213
     C********** CSW213    IFEQ 'Y'                                                  CSW213 MD021993
     C********** M3IBAR    ANDEQ'Y'                                                  CSW213 MD021993
     C**********           MOVE 'Y'       WKIBAR  1                                  CSW213 MD021993
     C**********           ELSE                                                      CSW213 MD021993
     C           M3SCHT    IFEQ 'Y'                                                           CSW213
     C           CSW213    ANDEQ'N'                                                         MD023383
     C           CSW213    OREQ 'Y'                                                         MD021993
     C           M3IBAR    ANDEQ'Y'                                                         MD021993
     C                     MOVE 'Y'       WKSCHT                                              CSW202
     C                     ENDIF                                                              CSW213
     C**********           ENDIF                                                     CSW213 MD021993
     C                     ENDIF                                                              CSW202
     C                     ENDIF                                                              CSW202
      *                                                                                       CSW202
     C                     ENDSR                                                              CSW202
      *****************************************************************                       CSW202
      /EJECT                                                                                  CSW202
      *****************************************************************                       CSW202
      *                                                               *                       CSW202
      *  SRIBAN - Determine if Beneficiary Bank is in valid IBAN      *                       CSW202
      *           format                                              *                       CSW202
      *                                                               *                       CSW202
      *****************************************************************                       CSW202
     C           SRIBAN    BEGSR                                                              CSW202
      *                                                                                       CSW202
     C           34        SUBSTM5BBK1:2  PIBAN                                               CSW202
      *                                                                                       CSW202
     C                     MOVE *BLANKS   P@IBAN 34                                           CSW202
      *                                                                                       CSW202
     C                     CALL 'AOIBANR3'                                                    CSW202
     C                     PARM           PRTCD                                               CSW202
     C                     PARM           PIBAN  47                                           CSW202
     C                     PARM           POWITH 47                                           CSW202
     C           P@IBAN    PARM           PONOBL 34                                           CSW202
      *                                                                                       CSW202
     C           PRTCD     IFEQ *BLANKS                                                       CSW202
      *                                                                                       CSW202
     C           1         SUBSTP@IBAN:1  WTRD1   1                                           CSW202
     C           1         SUBSTP@IBAN:2  WTRD2   1                                           CSW202
     C           1         SUBSTP@IBAN:3  WTRD3   1                                           CSW202
     C           1         SUBSTP@IBAN:4  WTRD4   1                                           CSW202
      *                                                                                       CSW202
     C           WTRD1     LOKUPALPH                     88                                   CSW202
      *                                                                                       CSW202
     C           *IN88     IFEQ *ON                                                           CSW202
     C           WTRD2     LOKUPALPH                     88                                   CSW202
     C                     ENDIF                                                              CSW202
      *                                                                                       CSW202
     C           *IN88     IFEQ *ON                                                           CSW202
     C           WTRD3     LOKUPNUMC                     88                                   CSW202
     C                     ENDIF                                                              CSW202
      *                                                                                       CSW202
     C           *IN88     IFEQ *ON                                                           CSW202
     C           WTRD4     LOKUPNUMC                     88                                   CSW202
     C                     ENDIF                                                              CSW202
      *                                                                                       CSW202
      ** Entry is in valid IBAN format.                                                       CSW202
      *                                                                                       CSW202
     C           *IN88     IFEQ *ON                                                           CSW202
      *                                                                                       CSW202
     C                     CALL 'AOIBANR5'                                                    CSW202
     C                     PARM *BLANKS   PRTCD                                               CSW202
     C                     PARM           P@IBAN                                              CSW202
     C           PRTCD     IFEQ *BLANKS                                                       CSW202
     C                     MOVE 'Y'       WIBANF                                              CSW202
     C                     ENDIF                                                              CSW202
      *                                                                                       CSW202
     C                     ENDIF                                                              CSW202
      *                                                                                       CSW202
     C                     ENDIF                                                              CSW202
      *                                                                                       CSW202
     C                     ENDSR                                                              CSW202
      *****************************************************************                       CSW203
      /EJECT                                                                                  CSW203
      *****************************************************************                       CFT032
      *                                                               *                       CFT032
      *  SROUFM - Retrieve Outgoing Message Field Management          *                       CFT032
      *                                                               *                       CFT032
      *  Called By: SRORC, SRODMT Subroutine                          *                       CFT032
      *                                                               *                       CFT032
      *  Calls: None                                                  *                       CFT032
      *                                                               *                       CFT032
      *****************************************************************                       CFT032
      *                                                                                       CFT032
     C           SROUFM    BEGSR                                                              CFT032
      *                                                                                       CFT032
     C                     MOVEL@MSGTG    @MS     3                                         BUG14771
     C                     MOVELWCCY      I@CCY   3                                         BUG14771
     C                     MOVELWENTTP    I@TYPE  1                                         BUG14771
     C                     MOVELWBRCA     I@BRCA  3                                         BUG14771
     C                     MOVELWACCT     I@ACCT 35                                         BUG14771
     C                     EXSR SRRTAC                                                      BUG14771
     C                     MOVELR@IBAN    W@IBAN 34                                         BUG14771
     C                     MOVELR@ACNO    W@ACNO 10                                         BUG14771
     C                     MOVELR@GLAC    W@GLAC 35                                         BUG14771
     C**********           MOVE *BLANKS   ##ACLN 35                                  CFT032 BUG14771
     C********** ODMT      IFEQ *BLANKS                                              CFT032 BUG13289
     C********** ODMT      IFNE *BLANKS                                            BUG13289 BUG14771
     C**********           MOVELODMTT     WENTTP  1                                  CFT032 BUG14771
     C**********           MOVELODMT      WACCT  35                                  CFT032 BUG14771
     C**********           ELSE                                                      CFT032 BUG14771
     C**********           MOVELORCT      WENTTP                                     CFT032 BUG14771
     C**********           MOVELORC1      WACCT                                      CFT032 BUG14771
     C**********           ENDIF                                                     CFT032 BUG14771
      **********                                                                     CFT032 BUG14771
     C********** ODMT      IFNE *BLANKS                                              CFT032 BUG14771
     C********** ODMTT     ANDEQ'I'                                                  CFT032 BUG13289
     C********** ODMT      ORNE *BLANKS                                              CFT032 BUG13289
     C********** ODMTT     ANDEQ'R'                                                  CFT032 BUG13289
     C********** ODMT      ORNE *BLANKS                                              CFT032 BUG13289
     C********** ODMTT     ANDEQ'G'                                                  CFT032 BUG13289
     C********** ODMT      ORNE *BLANKS                                              CFT032 BUG13289
     C********** ODMTT     ANDEQ'F'                                                  CFT032 BUG13289
     C********** ODMTT     IFEQ 'I'                                                BUG13289 BUG14771
     C********** ODMTT     OREQ 'R'                                                BUG13289 BUG14771
     C********** ODMTT     OREQ 'G'                                                BUG13289 BUG14771
     C********** ODMTT     OREQ 'F'                                                BUG13289 BUG14771
     C**********           MOVEL'/'       ADSLSH                                     CFT032 BUG14771
     C**********           ELSE                                                      CFT032 BUG14771
     C**********           MOVEL' '       ADSLSH                                     CFT032 BUG14771
     C**********           ENDIF                                                   BUG13289 BUG14771
     C**********           ENDIF                                                     CFT032 BUG14771
      *                                                                                       CFT032
      ** Message Tag                                                                          CFT032
      *                                                                                       CFT032
     C**********           MOVE ':50K:'   @MSGTG                                     CFT032 BUG14771
      **********                                                                     CFT032 BUG14771
      ***Network                                                                     CFT032 BUG14771
      **********                                                                     CFT032 BUG14771
     C**********           MOVEL'NWRK'    @NTWRK    P                                CFT032 BUG14771
     C                     MOVELNWRK      @NTWRK    P                                       BUG14771
      *                                                                                       CFT032
      ** Message Type                                                                         CFT032
      *                                                                                       CFT032
     C                     MOVE '103'     @MSGTP                                              CFT032
      *                                                                                       CFT032
      ** Country of Location                                                                  CFT032
      *                                                                                       CFT032
     C                     SELEC                                                              CFT032
     C           DSTT      WHEQ 'A'                                                           CFT032
     C                     MOVE *BLANKS   @CNTLC                                              CFT032
     C           DSTT      WHEQ 'S'                                                           CFT032
     C********** WENTTP    ANDEQ'S'                                                  CFT032 BUG14771
     C********** 2         SUBSTWOCUST:5  @CNTLC                                     CFT032 BUG14771
     C           2         SUBSTDST1:5    @CNTLC                                            BUG14771
     C                     OTHER                                                              CFT032
     C                     EXSR SRCNTL                                                        CFT032
     C                     ENDSL                                                              CFT032
      *                                                                                       CSW215
     C                     MOVEL@CNTLC    PCOUNT                                              CSW215
      *                                                                                       CFT032
      ** Nostro Number                                                                        CFT032
      *                                                                                       CFT032
     C                     MOVE *BLANKS   @NOSTN                                              CFT032
     C                     MOVEL*BLANKS   @NONB                                               CFT032
     C********** SMCY      IFNE *BLANKS                                              CFT032 BUG14771
     C**********           MOVELSMCY      WCCY    3                                  CFT032 BUG14771
     C**********           ELSE                                                      CFT032 BUG14771
     C                     MOVELPCCY      WCCY                                                CFT032
     C**********           ENDIF                                                     CFT032 BUG14771
      *                                                                                       CFT032
     C           SNCO      IFNE *ZEROS                                                      BUG14771
     C                     MOVELSNCT      WENTT2  1                                         BUG14771
     C                     MOVELSNCO      ADDRSS                                            BUG14771
     C                     ELSE                                                             BUG14771
     C                     MOVELDSTT      WENTT2  1                                         BUG14771
     C                     MOVELDST1      ADDRSS                                            BUG14771
     C                     ENDIF                                                            BUG14771
      *                                                                                     BUG14771
     C                     SELEC                                                              CFT032
     C********** WENTTP    WHEQ 'N'                                                  CFT032 BUG14771
     C           WENTT2    WHEQ 'N'                                                         BUG14771
     C                     MOVELADNOSN    @NOSTN                                              CFT032
     C                     MOVELWCCY      @CYCD                                             BUG14771
      *                                                                                       CFT032
     C********** WENTTP    WHEQ 'F'                                                  CFT032 BUG14771
     C           WENTT2    WHEQ 'F'                                                         BUG14771
     C                     MOVELADFNNB    @NOSTN                                              CFT032
     C                     MOVELWCCY      @CYCD                                             BUG14771
      *                                                                                       CFT032
     C********** WENTTP    WHEQ 'P'                                                  CFT032 BUG14771
     C********** BGMBIN    IFEQ 'Y'                                                  CFT032 BUG14771
     C           WENTT2    WHEQ 'P'                                                         BUG14771
     C           BGMBIN    IFEQ 'N'                                                         BUG14771
     C                     MOVELBJSBRC    @BRCD                                               CFT032
     C                     ELSE                                                               CFT032
     C                     MOVELADPBRC    @BRCD                                               CFT032
     C                     ENDIF                                                              CFT032
     C                     MOVELADPCNM    @CUST   6                                           CFT032
     C**********           MOVELADPACD    @ACCD  10                                  CFT032 BUG14771
     C                     MOVELADPACD    @ACCD                                             BUG14771
     C                     MOVELADPASQ    @ACSN   2                                           CFT032
     C                     MOVELWCCY      @CYCD   3                                           CFT032
     C                     EXSR SRNOST                                                        CFT032
     C                     MOVELA7NONB    @NOSTN                                              CFT032
      *                                                                                       CFT032
     C********** WENTTP    WHEQ 'G'                                                  CFT032 BUG14771
     C********** BGMBIN    IFEQ 'Y'                                                  CFT032 BUG14771
     C           WENTT2    WHEQ 'G'                                                         BUG14771
     C           BGMBIN    IFEQ 'N'                                                         BUG14771
     C                     MOVELBJSBRC    @BRCD   3                                           CFT032
     C                     ELSE                                                               CFT032
     C                     MOVELADGBRC    @BRCD                                               CFT032
     C                     ENDIF                                                              CFT032
     C                     MOVELADGCNM    @CUST                                               CFT032
     C                     MOVELADGACD    @ACCD                                               CFT032
     C                     MOVELADGASQ    @ACSN                                               CFT032
     C                     MOVELADGCCY    @CYCD                                               CFT032
     C                     EXSR SRNOST                                                        CFT032
     C                     MOVELA7NONB    @NOSTN                                              CFT032
      *                                                                                       CFT032
     C********** WENTTP    WHEQ 'R'                                                  CFT032 BUG14771
     C           WENTT2    WHEQ 'R'                                                         BUG14771
     C                     MOVELADACNO    ACNO                                                CFT032
     C           ACNO      CHAINACNUMA               90                                       CFT032
     C                     MOVELBRCA      @BRCD                                               CFT032
     C                     MOVELCNUM      @CUST                                               CFT032
     C                     MOVELACOD      @ACCD                                               CFT032
     C                     MOVELACSQ      @ACSN                                               CFT032
     C                     MOVELCCY       @CYCD                                               CFT032
     C                     EXSR SRNOST                                                        CFT032
     C                     MOVELA7NONB    @NOSTN                                              CFT032
      *                                                                                       CFT032
     C********** WENTTP    WHEQ 'I'                                                  CFT032 BUG14771
     C**********           CALL 'AOIBANR3'                                           CFT032 BUG14771
     C**********           PARM *BLANKS   @RTCD                                      CFT032 BUG14771
     C**********           PARM           WOCUST                                     CFT032 BUG14771
     C**********           PARM           POWITH                                     CFT032 BUG14771
     C********** P@IBAN    PARM           PONOBL                                     CFT032 BUG14771
     C********** P@IBAN    PARM           PONOBL                                     CFT032 BUG14771
     C**********           EXSR SRIBAN                                               CFT032 BUG14771
     C**********           MOVELBRCA      @BRCD                                      CFT032 BUG14771
     C**********           MOVELCNUM      @CUST                                      CFT032 BUG14771
     C**********           MOVELACOD      @ACCD                                      CFT032 BUG14771
     C**********           MOVELACSQ      @ACSN                                      CFT032 BUG14771
     C**********           MOVELCCY       @CYCD                                      CFT032 BUG14771
     C**********           EXSR SRNOST                                               CFT032 BUG14771
     C**********           MOVELA7NONB    @NOSTN                                     CFT032 BUG14771
      *                                                                                       CFT032
     C                     ENDSL                                                              CFT032
      *                                                                                       CFT032
      ** Action                                                                               CFT032
      *                                                                                       CFT032
     C                     MOVE CACNT1    @ACTNF                                              CFT032
      *                                                                                       CFT032
      ** Call Access program                                                                  CFT032
      *                                                                                       CFT032
     C                     MOVELBRCA      BRCA4A                                            BUG14042
     C                     CALL 'AOCTRYR0'                                                    257491
     C                     PARM *BLANKS   WRTRN   7                                           257491
     C                     PARM '*KEY   ' WOPTN   7                                           257491
     C                     PARM @CNTLC    WCTCD   2                                           257491
     C           SDCTRY    PARM SDCTRY    DSFDY                                               257491
      *                                                                                       257491
     C           WRTRN     IFNE *BLANKS                                                       257491
     C                     EXSR SRCNTL                                                        257491
     C                     MOVEL@CNTLC    CTRY4A                                              257491
     C                     ELSE                                                               257491
     C                     MOVEL@CNTLC    CTRY4A                                            BUG14042
     C                     ENDIF                                                              257491
      *                                                                                       257491
     C                     CALL 'AOOUFMR0'PLOUFM                                              CFT032
     C           @RTRN     IFEQ *BLANKS                                                     BUG14771
     C           OMFLAG    IFEQ *BLANKS                                                     BUG14771
     C                     MOVE 'O'       @LFLAG                                            BUG14771
     C                     ELSE                                                             BUG14771
     C                     MOVE OMFLAG    @LFLAG  1                                         BUG14771
     C                     ENDIF                                                            BUG14771
     C                     ELSE                                                             BUG14771
     C                     MOVE 'O'       @LFLAG                                            BUG14771
     C                     ENDIF                                                            BUG14771
      *                                                                                     BUG14771
      ** Action IBAN                                                                        BUG14771
      *                                                                                     BUG14771
     C                     MOVE CACNT2    @ACTNF                                            BUG14771
      *                                                                                     BUG14771
      ** Call Access program                                                                BUG14771
      *                                                                                     BUG14771
     C                     CALL 'AOOUFMR0'PLOUFM                                            BUG14771
     C           @RTRN     IFEQ *BLANKS                                                     BUG14771
     C           OMFLAG    IFEQ *BLANKS                                                     BUG14771
     C                     MOVE 'O'       @IFLAG                                            BUG14771
     C                     ELSE                                                             BUG14771
     C                     MOVE OMFLAG    @IFLAG  1                                         BUG14771
     C                     ENDIF                                                            BUG14771
     C                     ELSE                                                             BUG14771
     C                     MOVE 'O'       @IFLAG                                            BUG14771
     C                     ENDIF                                                            BUG14771
      *                                                                                       CFT032
      ** If no error                                                                          CFT032
      *                                                                                       CFT032
     C********** @RTRN     IFEQ *BLANKS                                              CFT032 BUG14771
      **********                                                                     CFT032 BUG14771
     C**********           SELEC                                                     CFT032 BUG14771
     C********** OMAACT    WHEQ *BLANKS                                              CFT032 BUG14042
     C**********           MOVE 'O'       OMAACT                                     CFT032 BUG14042
     C********** OMFLAG    WHEQ *BLANKS                                            BUG14042 BUG14771
     C**********           MOVE 'O'       OMFLAG                                   BUG14042 BUG14771
      **********                                                                     CFT032 BUG14771
     C********** OMAACT    WHEQ 'M'                                                  CFT032 BUG14042
     C********** OMFLAG    WHEQ 'M'                                                BUG14042 BUG14771
     C********** ADSLSH    ANDNE'/'                                                  CFT032 BUG14771
     C********** ODMT      IFEQ 'G'                                                  CFT032 BUG14042
     C********** ODMT      OREQ 'P'                                                  CFT032 BUG14042
     C********** ODMT      OREQ 'R'                                                  CFT032 BUG14042
     C********** ODMT      OREQ 'F'                                                  CFT032 BUG14042
     C********** ODMT      OREQ 'N'                                                  CFT032 BUG14042
     C********** ODMT      OREQ 'I'                                                  CFT032 BUG14042
     C********** ODMTT     IFEQ 'G'                                                BUG14042 BUG14771
     C********** ODMTT     OREQ 'P'                                                BUG14042 BUG14771
     C********** ODMTT     OREQ 'R'                                                BUG14042 BUG14771
     C********** ODMTT     OREQ 'F'                                                BUG14042 BUG14771
     C********** ODMTT     OREQ 'N'                                                BUG14042 BUG14771
     C********** ODMTT     OREQ 'I'                                                BUG14042 BUG14771
     C                     MOVELWACCT     @SLS    1                                         BUG14771
     C           @LFLAG    IFEQ 'O'                                                         BUG14771
     C           @MS       IFEQ ':50'                                                       BUG14771
     C           ODMTT     IFEQ 'G'                                                         BUG14771
     C           ODMTT     OREQ 'P'                                                         BUG14771
     C           ODMTT     OREQ 'I'                                                         BUG14771
     C           ODMTT     OREQ 'F'                                                         BUG14771
     C           ODMTT     OREQ 'N'                                                         BUG14771
     C           ODMTT     OREQ 'R'                                                         BUG14771
     C           @SLS      OREQ '/'                                                         BUG14771
     C                     MOVEL'M'       @LFLAG                                            BUG14771
     C                     ENDIF                                                            BUG14771
     C                     ELSE                                                             BUG14771
     C           @MS       IFEQ ':59'                                                       BUG14771
     C           @SLS      ANDEQ'/'                                                         BUG14771
     C                     MOVEL'M'       @LFLAG                                            BUG14771
     C                     ENDIF                                                            BUG14771
     C                     ENDIF                                                            BUG14771
     C                     ENDIF                                                            BUG14771
      *                                                                                     BUG14771
     C           @IFLAG    IFEQ 'P'                                                         BUG14771
     C                     MOVEL*BLANKS   W@IBAN                                            BUG14771
     C                     ENDIF                                                            BUG14771
      *                                                                                     BUG14771
     C           @IFLAG    IFEQ 'M'                                                         BUG14771
     C                     MOVEL'M'       @LFLAG                                            BUG14771
     C                     ENDIF                                                            BUG14771
      *                                                                                     BUG14771
     C           @LFLAG    IFEQ 'M'                                                         BUG14771
     C           @LFLAG    OREQ 'W'                                                         BUG14771
      *                                                                                     BUG14771
     C                     SELEC                                                            BUG14771
     C           W@IBAN    WHNE *BLANKS                                                     BUG14771
     C           '/'       CAT  W@IBAN    ##ACLN                                            BUG14771
      *                                                                                     BUG14771
     C           W@ACNO    WHNE *BLANKS                                                     BUG14771
     C           '/'       CAT  W@ACNO    ##ACLN                                            BUG14771
      *                                                                                     BUG14771
     C           W@GLAC    WHNE *BLANKS                                                     BUG14771
     C           '/'       CAT  W@GLAC    ##ACLN                                            BUG14771
      *                                                                                     BUG14771
     C           @SLS      WHEQ '/'                                                         BUG14771
     C                     MOVELWACCT     ##ACLN                                            BUG14771
      *                                                                                     BUG14771
     C           WENTTP    WHEQ 'C'                                                         BUG14771
     C           @IFLAG    ANDNE'M'                                                         BUG14771
      *                                                                                    BUG15155A
     C           @MSGTG    IFEQ ':50A:'                                                    BUG15155A
     C           @CUST     ANDEQ*BLANK                                                     BUG15155A
     C                     MOVELWACCT     @CUST                                            BUG15155A
     C                     ENDIF                                                           BUG15155A
      *                                                                                    BUG15155A
     C           '/'       CAT  @CUST     ##ACLN                                            BUG14771
      *                                                                                     BUG14771
      * If at this stage nothing has been formatted, that means that a full address has     BUG14771
      * been entered without '/' in the first line, if the account line is manadatory       BUG14771
      * the account will be retrieved from the Ordering bank but keeping the customer       BUG14771
      * address                                                                             BUG14771
     C           @LFLAG    WHEQ 'M'                                                         BUG14771
      *                                                                                     BUG14771
     C           @MS       IFEQ ':50'                                                       BUG14771
     C                     MOVELSMCY      I@CCY   3                                         BUG14771
     C                     MOVELORBT      I@TYPE  1                                         BUG14771
     C                     MOVELORBB      I@BRCA  3                                         BUG14771
     C                     MOVELORBK      I@ACCT 35                                         BUG14771
     C                     ENDIF                                                            BUG14771
     C                     EXSR SRRTAC                                                      BUG14771
      *                                                                                     BUG14771
     C                     ENDSL                                                            BUG14771
      *                                                                                     BUG14771
     C                     SELEC                                                            BUG14771
     C           R@IBAN    WHNE *BLANKS                                                     BUG14771
     C           '/'       CAT  R@IBAN    ##ACLN                                            BUG14771
      *                                                                                     BUG14771
     C           R@ACNO    WHNE *BLANKS                                                     BUG14771
     C           '/'       CAT  R@ACNO    ##ACLN                                            BUG14771
      *                                                                                     BUG14771
     C           R@GLAC    WHNE *BLANKS                                                     BUG14771
     C           '/'       CAT  R@GLAC    ##ACLN                                            BUG14771
      *                                                                                     BUG14771
     C                     ENDSL                                                            BUG14771
     C                     ENDIF                                                            BUG14771
      **********                                                                     CFT032 BUG14771
      ***If*CFT004*is*on,*use*IBAN                                                   CFT032 BUG14771
      **********                                                                     CFT032 BUG14771
     C********** CFT004    IFEQ 'Y'                                                  CFT032 BUG14771
     C**********           MOVELIBAN      ##ACLN                                     CFT032 BUG14771
     C**********           ELSE                                                      CFT032 BUG14771
      **********                                                                     CFT032 BUG14771
      ***Otherwise,*if*retail*banking,*use*retail*number                             CFT032 BUG14771
      **********                                                                     CFT032 BUG14771
     C********** BGRTBN    IFEQ 'Y'                                                  CFT032 BUG14771
     C**********           MOVELACNO      ##ACLN                                     CFT032 BUG14771
     C**********           ELSE                                                      CFT032 BUG14771
      **********                                                                     CFT032 BUG14771
      ***Otherwise,*format*GL*account                                                CFT032 BUG14771
      *                                                                                       CFT032
     C********** @BRCD     CAT  @CUST:0   ##ACLN                                     CFT032 BUG14771
     C**********           CAT  @CYCD:0   ##ACLN                                     CFT032 BUG14771
     C**********           CAT  @ACCD:0   ##ACLN                                     CFT032 BUG14771
     C**********           CAT  @ACSN:0   ##ACLN                                     CFT032 BUG14771
     C**********           ENDIF                                                     CFT032 BUG14771
     C**********           ENDIF                                                     CFT032 BUG14771
     C**********           ENDIF                                                     CFT032 BUG14771
      **********                                                                     CFT032 BUG14771
     C********** OMAACT    WHEQ 'W'                                                  CFT032 BUG14042
     C********** OMAACT    OREQ 'O'                                                  CFT032 BUG14042
     C********** OMFLAG    WHEQ 'W'                                                BUG14042 BUG14771
     C********** OMFLAG    OREQ 'O'                                                BUG14042 BUG14771
      **********                                                                     CFT032 BUG14771
     C********** ADSLSH    IFNE '/'                                                  CFT032 BUG14771
      **********                                                                     CFT032 BUG14771
      ***If*CFT004*is*on,*use*IBAN                                                   CFT032 BUG14771
      ********                                                                       CFT032 BUG14771
     C********** CFT004    IFEQ 'Y'                                                  CFT032 BUG14771
     C**********           MOVELIBAN      ##ACLN                                     CFT032 BUG14771
     C**********           ELSE                                                      CFT032 BUG14771
      **********                                                                     CFT032 BUG14771
      ***Otherwise,*if*retail*banking,*use*retail*number                             CFT032 BUG14771
      **********                                                                     CFT032 BUG14771
     C********** BGRTBN    IFEQ 'Y'                                                  CFT032 BUG14771
     C**********           MOVELACNO      ##ACLN                                     CFT032 BUG14771
     C**********           ELSE                                                      CFT032 BUG14771
      **********                                                                     CFT032 BUG14771
      ***Otherwise,*format*GL*account                                                CFT032 BUG14771
      **********                                                                     CFT032 BUG14771
     C********** @BRCD     CAT  @CUST:0   ##ACLN                                     CFT032 BUG14771
     C**********           CAT  @CYCD:0   ##ACLN                                     CFT032 BUG14771
     C**********           CAT  @ACCD:0   ##ACLN                                     CFT032 BUG14771
     C**********           CAT  @ACSN:0   ##ACLN                                     CFT032 BUG14771
     C**********           ENDIF                                                     CFT032 BUG14771
     C**********           ENDIF                                                     CFT032 BUG14771
     C**********           ENDIF                                                     CFT032 BUG14771
      **********                                                                     CFT032 BUG14771
     C********** OMAACT    WHEQ 'P'                                                  CFT032 BUG14042
     C********** OMFLAG    WHEQ 'P'                                                BUG14042 BUG14771
     C**********           MOVE *BLANKS   ##ACLN                                     CFT032 BUG14771
      **********                                                                     CFT032 BUG14771
     C**********           ENDSL                                                     CFT032 BUG14771
     C**********           ENDIF                                                   BUG13289 BUG14771
      **********                                                                     CFT032 BUG14771
     C********** ODMT      IFEQ 'A'                                                  CFT032 BUG13289
     C********** WENTTP    IFEQ 'A'                                                BUG13289 BUG14771
     C********** ODMT      OREQ 'C'                                                  CFT032 BUG13289
     C********** WENTTP    OREQ 'C'                                                BUG13289 BUG14771
     C********** ODMT      OREQ 'S'                                                  CFT032 BUG13289
     C********** WENTTP    OREQ 'S'                                                BUG13289 BUG14771
     C**********           SUBSTADCHK1:2  ##ACLN                                     CFT032 BUG14771
     C**********           ENDIF                                                     CFT032 BUG14771
      **********                                                                     CFT032 BUG14771
     C**********           ENDIF                                                     CFT032 BUG13289
      *                                                                                       CFT032
     C                     SELEC                                                            BUG14771
      *                                                                                     BUG14771
     C           ##ACLN    WHNE *BLANKS                                                     BUG14771
     C           @SLS      ANDEQ'/'                                                         BUG14771
     C           WENTTP    ANDEQ'S'                                                          250804A
      *                                                                                      250804A
     C           ##ACLN    ORNE *BLANKS                                                      250804A
     C           @SLS      ANDEQ'/'                                                          250804A
     C           WENTTP    ANDEQ'A'                                                          250804A
     C                     MOVEL##ACLN    W@CNA1                                            BUG14771
     C                     MOVELW@CNA2    W@CNA2                                            BUG14771
     C                     MOVELW@CNA3    W@CNA3                                            BUG14771
     C                     MOVELW@CNA4    W@CNA4                                            BUG14771
     C                     MOVELW@CNA5    W@CNA5                                            BUG14771
      *                                                                                     BUG14771
     C           ##ACLN    WHEQ *BLANKS                                                     BUG14771
     C           @SLS      ANDEQ'/'                                                         BUG14771
     C**********           MOVEL*BLANKS   W@CNA5                                   BUG14771 BUG15045
     C**********           MOVELW@CNA5    W@CNA4                                   BUG14771 BUG15045
     C**********           MOVELW@CNA4    W@CNA3                                   BUG14771 BUG15045
     C**********           MOVELW@CNA3    W@CNA2                                   BUG14771 BUG15045
     C                     MOVELW@CNA2    W@CNA1                                            BUG14771
     C                     MOVELW@CNA3    W@CNA2                                            BUG15045
     C                     MOVELW@CNA4    W@CNA3                                            BUG15045
     C                     MOVELW@CNA5    W@CNA4                                            BUG15045
     C                     MOVEL*BLANKS   W@CNA5                                            BUG15045
      *                                                                                     BUG14771
     C           ##ACLN    WHNE *BLANKS                                                     BUG14771
     C           ##ACLN    ANDNEW@CNA1                                                        257632
     C********** @SLS      ANDNE'/'                                                 BUG14771 250804A
     C                     MOVELW@CNA4    W@CNA5                                            BUG14771
     C                     MOVELW@CNA3    W@CNA4                                            BUG14771
     C                     MOVELW@CNA2    W@CNA3                                            BUG14771
     C                     MOVELW@CNA1    W@CNA2                                            BUG14771
     C                     MOVEL##ACLN    W@CNA1                                            BUG14771
      *                                                                                     BUG14771
     C           ##ACLN    WHEQ *BLANKS                                                     BUG14771
     C           @SLS      ANDNE'/'                                                         BUG14771
     C                     MOVEL*BLANKS   W@CNA5                                            BUG14771
     C                     MOVELW@CNA4    W@CNA4                                            BUG14771
     C                     MOVELW@CNA3    W@CNA3                                            BUG14771
     C                     MOVELW@CNA2    W@CNA2                                            BUG14771
     C                     MOVELW@CNA1    W@CNA1                                            BUG14771
      *                                                                                     BUG14771
     C                     ENDSL                                                            BUG14771
      *                                                                                     BUG14771
     C                     ENDSR                                                              CFT032
     C/EJECT                                                                                  CFT032
      *****************************************************************                       CFT032
      *                                                               *                       CFT032
      *  SRNOST   - Check for full Nostro                             *                       CFT032
      *                                                               *                       CFT032
      *  Called By: SRODMT Subroutine                                 *                       CFT032
      *                                                               *                       CFT032
      *  Calls: None                                                  *                       CFT032
      *                                                               *                       CFT032
      *****************************************************************                       CFT032
      *                                                                                       CFT032
     C           SRNOST    BEGSR                                                              CFT032
      *                                                                                       CFT032
     C                     CALL 'AONOSTR0'             9090                                   CFT032
     C                     PARM *BLANKS   @RTCD                                               CFT032
     C                     PARM '*KEY   ' @OPTN                                               CFT032
     C                     PARM           @CUST                                               CFT032
     C                     PARM           @CYCD   3                                           CFT032
     C                     PARM           @ACCD                                               CFT032
     C                     PARM           @ACSN                                               CFT032
     C                     PARM           @NONB   2                                           CFT032
     C                     PARM           @BRCD                                               CFT032
     C                     PARM           @CSSN  10                                           CFT032
     C                     PARM           @PNOI   1                                           CFT032
     C           SDNOST    PARM *BLANKS   DSFDY                                               CFT032
      *                                                                                       CFT032
      ** If error on call                                                                     CFT032
      *                                                                                       CFT032
     C           *IN90     IFEQ *ON                                                           CFT032
     C                     MOVEL'AONOSTR0'DBFNAM                                              CFT032
     C                     MOVEL'*CALL'   DBERKY                                              CFT032
     C                     MOVE '7'       DBERR#                                              CFT032
     C                     EXSR DBERR                                                         CFT032
     C                     ENDIF                                                              CFT032
      *                                                                                       CFT032
     C                     ENDSR                                                              CFT032
     C/EJECT                                                                                  CFT032
      *****************************************************************                     BUG14771
      *                                                               *                     BUG14771
      *  SRACCT   - Check for Account                                 *                     BUG14771
      *                                                               *                     BUG14771
      *  Called By: SROUFM Subroutine                                 *                     BUG14771
      *                                                               *                     BUG14771
      *  Calls: None                                                  *                     BUG14771
      *                                                               *                     BUG14771
      *****************************************************************                     BUG14771
      *                                                                                     BUG14771
     C           SRACCT    BEGSR                                                            BUG14771
      *                                                                                     BUG14771
     C                     CALL 'AOACCTR0'             9090                                 BUG14771
     C                     PARM *BLANKS   @RTCD                                             BUG14771
     C                     PARM '*KEY   ' @OPTN                                             BUG14771
     C                     PARM           @ACNO  10                                         BUG14771
     C                     PARM           @CUST                                             BUG14771
     C                     PARM           @CYCD                                             BUG14771
     C                     PARM           @ACCD                                             BUG14771
     C                     PARM           @ACSN                                             BUG14771
     C                     PARM           @BRCD                                             BUG14771
     C           OACCNT    PARM *BLANKS   DSSDY                                             BUG14771
      *                                                                                     BUG14771
      ** If error on call                                                                   BUG14771
      *                                                                                     BUG14771
     C           *IN90     IFEQ *ON                                                         BUG14771
     C                     MOVEL'AOACCTR0'DBFNAM                                            BUG14771
     C                     MOVEL'*CALL'   DBERKY                                            BUG14771
     C                     MOVEL'700'     DBERR#                                            BUG14771
     C                     EXSR DBERR                                                       BUG14771
     C                     ENDIF                                                            BUG14771
      *                                                                                     BUG14771
     C                     ENDSR                                                            BUG14771
     C/EJECT                                                                                BUG14771
      *****************************************************************                       CFT032
      *                                                               *                       CFT032
      *  SRCNTL   - Retrieve Country of location                      *                       CFT032
      *                                                               *                       CFT032
      *  Called By: SROUFM Subroutine                                 *                       CFT032
      *                                                               *                       CFT032
      *  Calls: None                                                  *                       CFT032
      *                                                               *                       CFT032
      *****************************************************************                       CFT032
      *                                                                                       CFT032
     C           SRCNTL    BEGSR                                                              CFT032
      *                                                                                       CFT032
     C**********           MOVE *BLANKS   @CNTLC                                     CFT032 BUG14042
     C                     MOVE *BLANKS   @CNTLC  2                                         BUG14042
     C                     MOVE *BLANKS   WOCUST 35                                         BUG14771
      *                                                                                       CFT032
     C********** CSW207    IFEQ 'Y'                                                    CSW207 250600
     C**********           MOVELORC1      WOCUST                                       CSW207 250600
     C**********           ELSE                                                      BUG14891 250600
     C**********           MOVELDST1      WOCUST                                     BUG14891 250600
     C**********           ENDIF                                                       CSW207 250600
      *                                                                                       CSW207
     C                     CALL 'AOACCTV1'                                                    CFT032
     C                     PARM *BLANKS   @RTCD                                               CFT032
     C                     PARM *BLANKS   @TYP    7                                           CFT032
     C**********           PARM           WOCUST 35                                  CFT032 BUG14771
     C**********           PARM           DST1   35                                BUG14771 BUG14891
     C**********           PARM           WOCUST                                     BUG14891 250600
     C                     PARM DST1      WOCUST                                              263776
     C                     PARM           DSSDY                                               CFT032
      *                                                                                       CFT032
     C                     MOVE *BLANKS   PACCTP                                              CSW207
     C********** @RTCD     IFEQ *BLANKS                                              BUG14755 250600
     C                     SELEC                                                              CFT032
     C           @TYP      WHEQ '*RETAIL'                                                     CFT032
     C           @TYP      OREQ '*LEDGER'                                                     CFT032
     C                     MOVELDSSDY     OACCNT                                              CFT032
     C                     MOVELCNUM      WCUST   6                                           CFT032
     C********** @TYP      IFEQ '*LEDGER'                                              CSW207 250600
     C**********           MOVE 'G'       PACCTP                                       CSW207 250600
     C**********           ELSE                                                        CSW207 250600
     C**********           MOVE 'R'       PACCTP                                       CSW207 250600
     C**********           ENDIF                                                       CSW207 250600
     C**********           MOVE BRCA      WDSBRC                                       CSW207 250600
     C**********           MOVE CNUM      WDSCNM                                       CSW207 250600
     C**********           MOVE CCY       WDSCCY                                       CSW207 250600
     C**********           MOVE ACOD      WDSACD                                       CSW207 250600
     C**********           MOVE ACSQ      WDSACS                                       CSW207 250600
     C**********           MOVELWDSACT    PACCD                                        CSW207 250600
     C           @TYP      WHEQ '*NOSTRO'                                                     CFT032
     C                     MOVELDSSDY     SDNOST                                              CFT032
     C                     MOVELA7CUST    WCUST                                               CFT032
     C**********           MOVE 'N'       PACCTP                                       CSW207 250600
     C********** 3         SUBSTORC1:2    PCCY                                         CSW207 250600
     C********** 2         SUBSTORC1:5    @NOSTN                                       CSW207 250600
     C           @TYP      WHEQ '*CUSTNO'                                                     CFT032
     C           @TYP      OREQ '*SHNAME'                                                     CFT032
     C                     MOVELDSSDY     SDCUST                                              CFT032
     C                     MOVELBBCUST    WCUST                                               CFT032
     C********** @TYP      IFEQ '*CUSTNO'                                              CSW207 250600
     C**********           MOVE 'C'       PACCTP                                       CSW207 250600
     C********** 1         SUBSTORC1:1    CHAR    1                                    CSW207 250600
     C********** CHAR      IFEQ '/'                                                    CSW207 250600
     C********** 6         SUBSTORC1:2    @CUST                                        CSW207 250600
     C**********           ELSE                                                        CSW207 250600
     C********** 6         SUBSTORC1:1    @CUST                                        CSW207 250600
     C**********           ENDIF                                                       CSW207 250600
     C**********           ENDIF                                                       CSW207 250600
     C                     ENDSL                                                              CFT032
     C**********           ELSE                                                      BUG14755 250600
     C**********           MOVELISPTY1    WSLASH  1                                  BUG14755 250600
     C********** WSLASH    IFEQ '/'                                                  BUG14755 250600
     C********** 34        SUBSTISPTY1:2  P@IBAN                                     BUG14755 250600
     C**********           ELSE                                                      BUG14755 250600
     C**********           MOVELISPTY1    P@IBAN                                     BUG14755 250600
     C**********           ENDIF                                                     BUG14755 250600
     C**********           CALL 'AOIBANR4'                                           BUG14755 250600
     C**********           PARM *BLANKS   @RTCD                                      BUG14755 250600
     C**********           PARM '*KEY   ' @OPTN                                      BUG14755 250600
     C**********           PARM           P@IBAN                                     BUG14755 250600
     C********** OACCNT    PARM           DSSDY                                      BUG14755 250600
     C********** @RTCD     IFEQ *BLANKS                                              BUG14755 250600
     C**********           MOVE 'I'       PACCTP                                     BUG14755 250600
     C**********           MOVE BRCA      WDSBRC                                     BUG14755 250600
     C**********           MOVE CNUM      WDSCNM                                     BUG14755 250600
     C**********           MOVE CCY       WDSCCY                                     BUG14755 250600
     C**********           MOVE ACOD      WDSACD                                     BUG14755 250600
     C**********           MOVE ACSQ      WDSACS                                     BUG14755 250600
     C**********           MOVELWDSACT    PACCD                                      BUG14755 250600
     C**********           MOVELCNUM      WCUST   6                                  BUG14755 250600
     C**********           ENDIF                                                     BUG14755 250600
     C**********           ENDIF                                                     BUG14755 250600
      *                                                                                       CFT032
     C                     MOVELWCUST     @KEY1     P                                         CFT032
     C                     EXSR SRCUST                                                        CFT032
      *                                                                                       CFT032
     C           @RTCD     IFEQ *BLANKS                                                       CFT032
     C                     MOVELBBCOLC    @CNTLC                                              CFT032
     C                     ENDIF                                                              CFT032
      *                                                                                       CFT032
     C                     ENDSR                                                              CFT032
     C/EJECT                                                                                BUG14771
      *****************************************************************                     BUG14771
      *                                                               *                     BUG14771
      *  SRRTAC   - Retrieve Account and nostro information           *                     BUG14771
      *                                                               *                     BUG14771
      *  Called By: SROUFM Subroutine                                 *                     BUG14771
      *                                                               *                     BUG14771
      *  Calls: None                                                  *                     BUG14771
      *                                                               *                     BUG14771
      *****************************************************************                     BUG14771
      *                                                                                     BUG14771
     C           SRRTAC    BEGSR                                                            BUG14771
      *                                                                                     BUG14771
     C           *LIKE     DEFN BRCA      R@BRCA                                            BUG14771
     C           *LIKE     DEFN BBCUST    R@CUST                                            BUG14771
     C           *LIKE     DEFN CCY       R@CCY                                             BUG14771
     C**********           MOVELR@ACOD    R@ACOD  4                                  BUG14771 250600
      ** to be 10 in Midas Plus                                                             BUG14771
     C********             MOVELR@ACOD    R@ACOD 10                                         BUG14771
     C                     MOVELR@ACOD    R@ACOD 10                                           250600
     C           *LIKE     DEFN ACOD      @ACCD                                             BUG14771
     C                     MOVELR@ACSQ    R@ACSQ  2                                         BUG14771
     C                     MOVELR@ACNO    R@ACNO 10                                         BUG14771
     C           *LIKE     DEFN IBAN      R@IBAN                                            BUG14771
     C           *LIKE     DEFN A7NONB    R@NONB                                            BUG14771
     C           *LIKE     DEFN BBCBEI    R@BEID                                            BUG14771
     C           *LIKE     DEFN BBCSID    R@CSID                                            BUG14771
      *                                                                                     BUG14771
     C                     RESETOACCNT                                                      BUG14771
     C                     RESETSDNOST                                                      BUG14771
     C                     RESETSDCUST                                                      BUG14771
      *                                                                                     BUG14771
     C                     MOVE *BLANKS   R@BRCA                                            BUG14771
     C                     MOVE *BLANKS   R@CUST                                            BUG14771
     C                     MOVE *BLANKS   R@CCY                                             BUG14771
     C                     MOVE *BLANKS   R@ACOD                                            BUG14771
     C                     MOVE *BLANKS   R@ACSQ                                            BUG14771
     C                     MOVE *BLANKS   R@ACNO                                            BUG14771
     C                     MOVE *BLANKS   R@IBAN                                            BUG14771
     C                     MOVE *BLANKS   R@GLAC 34                                         BUG14771
     C                     MOVE *BLANKS   R@NONB                                            BUG14771
     C                     MOVEL*BLANKS   @CNTLC  2                                         BUG14771
     C                     MOVEL*BLANKS   R@CSID                                            BUG14771
     C                     MOVEL*BLANKS   R@BEID                                            BUG14771
      *                                                                                     BUG14771
     C                     MOVELI@CCY     I@CCY   3                                         BUG14771
     C                     MOVELI@TYPE    I@TYPE  1                                         BUG14771
     C                     MOVELI@BRCA    I@BRCA  3                                         BUG14771
     C                     MOVELI@ACCT    I@ACCT 35                                         BUG14771
     C                     MOVELI@ACCT    ADDRSS                                            BUG14771
     C                     MOVELI@ACCT    I@SLS   1                                         BUG14771
      *                                                                                     BUG14771
     C           I@SLS     IFEQ '/'                                                         BUG14771
     C********** 2         SUBSTI@ACCT    ADDRSS    P                               BUG14771 250804A
     C           34        SUBSTI@ACCT:2  ADDRSS    P                                        250804A
     C                     ELSE                                                             BUG14771
     C                     MOVELI@ACCT    ADDRSS                                            BUG14771
     C                     ENDIF                                                            BUG14771
      *                                                                                     BUG14771
     C           ADPBRC    IFEQ *BLANKS                                                     BUG14771
     C                     MOVELI@BRCA    ADPBRC                                            BUG14771
     C                     ENDIF                                                            BUG14771
      *                                                                                     BUG14771
     C                     SELEC                                                            BUG14771
     C           I@TYPE    WHEQ 'N'                                                         BUG14771
     C                     MOVELADNOSN    @NONB                                             BUG14771
     C                     MOVELI@CCY     @CYCD                                             BUG14771
     C                     EXSR SRNOST                                                      BUG14771
     C                     MOVELA7BRCD    @BRCD                                             BUG14771
     C                     MOVELA7CUST    @CUST                                             BUG14771
     C                     MOVELA7ACCD    @ACCD                                             BUG14771
     C                     MOVELA7ACSN    @ACSN                                             BUG14771
     C                     MOVELA7CYCD    @CYCD                                             BUG14771
     C                     MOVEL*BLANKS   @ACNO                                             BUG14771
     C                     EXSR SRACCT                                                      BUG14771
      *                                                                                     BUG14771
     C           I@TYPE    WHEQ 'F'                                                         BUG14771
     C                     MOVELADFNNB    @NONB                                             BUG14771
     C                     MOVELADFCCY    @CYCD                                             BUG14771
     C                     EXSR SRNOST                                                      BUG14771
     C                     MOVELA7BRCD    @BRCD                                             BUG14771
     C                     MOVELA7CUST    @CUST                                             BUG14771
     C                     MOVELA7ACCD    @ACCD                                             BUG14771
     C                     MOVELA7ACSN    @ACSN                                             BUG14771
     C                     MOVELA7CYCD    @CYCD                                             BUG14771
     C                     MOVEL*BLANKS   @ACNO                                             BUG14771
     C                     EXSR SRACCT                                                      BUG14771
      *                                                                                     BUG14771
     C           I@TYPE    WHEQ 'P'                                                         BUG14771
     C           BGMBIN    IFEQ 'N'                                                         BUG14771
     C                     MOVELBJSBRC    @BRCD                                             BUG14771
     C                     ELSE                                                             BUG14771
     C                     MOVELADPBRC    @BRCD                                             BUG14771
     C                     ENDIF                                                            BUG14771
     C                     MOVELADPCNM    @CUST   6                                         BUG14771
     C                     MOVELADPACD    @ACCD                                             BUG14771
     C                     MOVELADPASQ    @ACSN   2                                         BUG14771
     C                     MOVELI@CCY     @CYCD   3                                         BUG14771
     C                     EXSR SRNOST                                                      BUG14771
     C                     MOVEL*BLANKS   @ACNO                                             BUG14771
     C                     EXSR SRACCT                                                      BUG14771
      *                                                                                     BUG14771
     C           I@TYPE    WHEQ 'G'                                                         BUG14771
     C           BGMBIN    IFEQ 'N'                                                         BUG14771
     C                     MOVELBJSBRC    @BRCD   3                                         BUG14771
     C                     ELSE                                                             BUG14771
     C                     MOVELADGBRC    @BRCD                                             BUG14771
     C                     ENDIF                                                            BUG14771
     C                     MOVELADGCNM    @CUST                                             BUG14771
     C                     MOVELADGACD    @ACCD                                             BUG14771
     C                     MOVELADGASQ    @ACSN                                             BUG14771
     C                     MOVELADGCCY    @CYCD                                             BUG14771
     C                     EXSR SRNOST                                                      BUG14771
     C                     MOVEL*BLANKS   @ACNO                                             BUG14771
     C                     EXSR SRACCT                                                      BUG14771
      *                                                                                     BUG14771
     C           I@TYPE    WHEQ 'R'                                                         BUG14771
     C                     MOVELADACNO    ACNO                                              BUG14771
     C           ACNO      CHAINACNUMA               90                                     BUG14771
     C                     MOVELBRCA      @BRCD                                             BUG14771
     C                     MOVELCNUM      @CUST                                             BUG14771
     C                     MOVELACOD      @ACCD                                             BUG14771
     C                     MOVELACSQ      @ACSN                                             BUG14771
     C                     MOVELCCY       @CYCD                                             BUG14771
     C                     EXSR SRNOST                                                      BUG14771
      *                                                                                     BUG14771
     C           I@TYPE    WHEQ 'I'                                                         BUG14771
     C                     MOVELADCHK1    PIBAN                                             BUG14771
     C                     CALL 'AOIBANR3'                                                  BUG14771
     C                     PARM *BLANKS   @RTCD                                             BUG14771
     C                     PARM           PIBAN                                             BUG14771
     C                     PARM           POWITH                                            BUG14771
     C           P@IBAN    PARM           PONOBL                                            BUG14771
     C           @RTCD     IFEQ *BLANKS                                                     BUG14771
     C                     CALL 'AOIBANR4'                                                  BUG14771
     C                     PARM *BLANKS   @RTCD                                             BUG14771
     C                     PARM           @OPTN   7                                         BUG14771
     C                     PARM           P@IBAN                                            BUG14771
     C           OACCNT    PARM *BLANKS   DSSDY                                             BUG14771
      *                                                                                     BUG14771
     C           @RTCD     IFEQ *BLANKS                                                     BUG14771
     C                     MOVELBRCA      @BRCD                                             BUG14771
     C                     MOVELCNUM      @CUST                                             BUG14771
     C                     MOVELACOD      @ACCD                                             BUG14771
     C                     MOVELACSQ      @ACSN                                             BUG14771
     C                     MOVELCCY       @CYCD                                             BUG14771
     C                     EXSR SRNOST                                                      BUG14771
     C                     ENDIF                                                            BUG14771
     C                     ENDIF                                                            BUG14771
      *                                                                                     BUG14771
     C           I@TYPE    WHEQ 'C'                                                         BUG14771
     C                     MOVELADCNUM    CNUM                                              BUG14771
     C           I@TYPE    WHEQ 'S'                                                         BUG14771
     C                     MOVELADSWFT    R@CSID                                            BUG14771
     C                     MOVELADSWFT    R@BEID                                            BUG14771
     C                     ENDSL                                                            BUG14771
      *                                                                                     BUG14771
     C           CFT004    IFEQ 'Y'                                                         BUG14771
     C                     MOVELIBAN      R@IBAN                                            BUG14771
     C                     ELSE                                                             BUG14771
     C                     MOVEL*BLANKS   R@IBAN                                            BUG14771
     C                     ENDIF                                                            BUG14771
      *                                                                                     BUG14771
     C           BGRTBN    IFEQ 'Y'                                                         BUG14771
     C           ACNO      ANDNE0                                                           BUG14771
     C                     MOVELACNO      R@ACNO                                            BUG14771
     C                     ELSE                                                             BUG14771
     C                     MOVEL*BLANKS   R@ACNO                                            BUG14771
     C                     ENDIF                                                            BUG14771
      *                                                                                     BUG14771
     C                     MOVELBRCA      R@BRCA                                            BUG14771
     C                     MOVELCNUM      R@CUST                                            BUG14771
     C                     MOVELCCY       R@CCY                                             BUG14771
     C                     MOVELACOD      R@ACOD                                            BUG14771
     C                     MOVELACSQ      R@ACSQ                                            BUG14771
     C                     MOVELA7NONB    R@NONB                                            BUG14771
      *                                                                                     BUG14771
     C           I@TYPE    IFEQ 'G'                                                           250804
     C           I@TYPE    OREQ 'R'                                                           250804
     C           I@TYPE    OREQ 'I'                                                           250804
     C           I@TYPE    OREQ 'F'                                                           250804
     C           I@TYPE    OREQ 'N'                                                           250804
     C           I@TYPE    OREQ 'P'                                                           250804
     C           R@BRCA    CAT  R@CUST:0  R@GLAC 34                                         BUG14771
     C                     CAT  R@CCY:0   R@GLAC                                            BUG14771
     C                     CAT  R@ACOD:0  R@GLAC                                            BUG14771
     C                     CAT  R@ACSQ:0  R@GLAC                                            BUG14771
     C                     ENDIF                                                              250804
      *                                                                                     BUG14771
     C           R@CUST    IFNE *BLANKS                                                     BUG14771
     C           R@CUST    ANDNE'000000'                                                    BUG14771
      *                                                                                     BUG14771
     C                     MOVELR@CUST    @KEY1     P                                       BUG14771
      *                                                                                     BUG14771
     C                     EXSR SRCUST                                                      BUG14771
      *                                                                                     BUG14771
     C           @RTCD     IFEQ *BLANKS                                                     BUG14771
     C                     MOVELBBCOLC    @CNTLC                                            BUG14771
     C                     MOVELBBCSID    R@CSID                                            BUG14771
     C                     MOVELBBCBEI    R@BEID                                            BUG14771
     C                     ENDIF                                                            BUG14771
      *                                                                                     BUG14771
     C                     ENDIF                                                            BUG14771
      *                                                                                     BUG14771
     C                     ENDSR                                                            BUG14771
     C/EJECT                                                                                  CFT032
      *****************************************************************                       CFT032
      *                                                               *                       CFT032
      *  SRCUST   - Check for Customer                                *                       CFT032
      *                                                               *                       CFT032
      *  Called By: SROUFM, SRCNTL                                    *                       CFT032
      *                                                               *                       CFT032
      *  Calls: None                                                  *                       CFT032
      *                                                               *                       CFT032
      *****************************************************************                       CFT032
      *                                                                                       CFT032
     C           SRCUST    BEGSR                                                              CFT032
      *                                                                                       CFT032
     C**********           CALL 'AOCUSTR0'             9090                          CFT032 BUG14771
     C                     CALL 'AOCUSTR1'             9090                                 BUG14771
     C                     PARM *BLANKS   @RTCD                                               CFT032
     C                     PARM '*KEY   ' @OPTN                                               CFT032
     C                     PARM           @KEY1                                               CFT032
     C                     PARM *BLANKS   @KYST                                               CFT032
     C********** SDCUST    PARM *BLANKS   DSSDY                                      CFT032 BUG14771
     C           SDCUST    PARM *BLANKS   DSLDY                                             BUG14771
      *                                                                                       CFT032
      ** If error on call                                                                     CFT032
      *                                                                                       CFT032
     C           *IN90     IFEQ *ON                                                           CFT032
     C**********           MOVEL'AOCUSTR0'DBFNAM                                     CFT032 BUG14771
     C                     MOVEL'AOCUSTR1'DBFNAM                                            BUG14771
     C                     MOVEL'*CALL'   DBERKY                                              CFT032
     C                     MOVE '9'       DBERR#                                              CFT032
     C                     EXSR DBERR                                                         CFT032
     C                     ENDIF                                                              CFT032
      *                                                                                       CFT032
     C                     ENDSR                                                              CFT032
      *****************************************************************                       CSW203
      *                                                               *                       CSW203
      *   SRDGEN - Terminate program without generating message       *                       CSW203
      *                                                               *                       CSW203
      *****************************************************************                       CSW203
      *                                                                                       CSW203
     C           SRDGEN    BEGSR                                                              CSW203
      *                                                                                       CSW203
     C                     ADD  1         PAGEAU                                              CSW203
     C                     WRITEHEADAU                 80                                     CSW203
      *                                                                                       CSW203
     C           *IN80     IFEQ *ON                                                           CSW203
     C                     MOVEL'FT0641AU'DBFNAM                                              CSW203
     C                     MOVEL'3'       DBERKY                                              CSW203
     C                     MOVE '51'      DBERR#                                              CSW203
     C                     EXSR DBERR                                                         CSW203
     C                     ENDIF                                                              CSW203
      *                                                                                       CSW203
     C                     CLOSEFT0641AU                                                      CSW203
     C                     CLOSEFT0641P1                                                      CSW203
     C                     CLOSEFT0641P2                                                      CSW203
      *                                                                                       CSW203
     C                     MOVEL'1'       *INLR                                             AR891217
     C                     RETRN                                                              CSW203
      *                                                                                       CSW203
     C                     ENDSR                                                              CSW203
      *****************************************************************                       CSW207
      *                                                               *                       CSW207
      *  SRFRMT - Retrieve Outgoing Message :50F: format              *                       CSW207
      *                                                               *                       CSW207
      *  Called By: SRORC, SRODMT Subroutine                          *                       CSW207
      *                                                               *                       CSW207
      *  Calls: None                                                  *                       CSW207
      *                                                               *                       CSW207
      *****************************************************************                       CSW207
     C           SRFRMT    BEGSR                                                              CSW207
      *                                                                                       CSW207
     C           ODMT      IFNE *BLANKS                                                       CSW207
     C                     MOVELODMTT     WENTTP                                              CSW207
     C                     MOVELODMT      WACCT                                               CSW207
     C                     ELSE                                                               CSW207
     C                     MOVELORCT      WENTTP                                              CSW207
     C                     MOVELORC1      WACCT                                               CSW207
     C                     ENDIF                                                              CSW207
     C                     MOVE @CNTLC    WLOCN   2                                         BUG15183
      *                                                                                       CSW207
      *** Country of Location                                                                 CSW207
      *                                                                                       CSW207
     C                     SELEC                                                              CSW207
     C           DSTT      WHEQ 'A'                                                           CSW207
     C                     MOVE *BLANKS   @CNTLC                                              CSW207
     C           DSTT      WHEQ 'S'                                                           CSW207
     C********** WENTTP    ANDEQ'S'                                                    CSW207 250600
     C********** 2         SUBSTWOCUST:5  @CNTLC                                       CSW207 250600
     C           2         SUBSTDST1:5    @CNTLC                                              250600
     C                     OTHER                                                              CSW207
     C                     EXSR SRCNTL                                                        CSW207
     C                     ENDSL                                                              CSW207
      *                                                                                       CSW207
      *** Nostro Number                                                                       CSW207
      *                                                                                       CSW207
     C                     MOVE *BLANKS   @NOSTN                                              CSW207
     C                     MOVE *BLANKS   @NONB                                               CSW207
     C********** SMCY      IFNE *BLANKS                                                CSW207 250600
     C**********           MOVELSMCY      WCCY                                         CSW207 250600
     C**********           ELSE                                                        CSW207 250600
     C                     MOVELPCCY      WCCY                                                CSW207
     C**********           ENDIF                                                       CSW207 250600
      *                                                                                       CSW207
     C           SNCO      IFNE *ZEROS                                                        250600
     C                     MOVELSNCT      WENTT2  1                                           250600
     C                     MOVELSNCO      ADDRSS                                              250600
     C                     ELSE                                                               250600
     C                     MOVELDSTT      WENTT2  1                                           250600
     C                     MOVELDST1      ADDRSS                                              250600
     C                     ENDIF                                                              250600
      *                                                                                       250600
     C                     SELEC                                                              CSW207
     C********** WENTTP    WHEQ 'N'                                                    CSW207 250600
     C           WENTT2    WHEQ 'N'                                                           250600
     C                     MOVELADNOSN    @NOSTN                                              CSW207
     C                     MOVELWCCY      @CYCD                                               250600
      *                                                                                       CSW207
     C********** WENTTP    WHEQ 'F'                                                    CSW207 250600
     C           WENTT2    WHEQ 'F'                                                           250600
     C                     MOVELADFNNB    @NOSTN                                              CSW207
     C                     MOVELWCCY      @CYCD                                               250600
      *                                                                                       CSW207
     C********** WENTTP    WHEQ 'P'                                                    CSW207 250600
     C********** BGMBIN    IFEQ 'Y'                                                    CSW207 250600
     C           WENTT2    WHEQ 'P'                                                           250600
     C           BGMBIN    IFEQ 'N'                                                           250600
     C                     MOVELBJSBRC    @BRCD                                               CSW207
     C                     ELSE                                                               CSW207
     C                     MOVELADPBRC    @BRCD                                               CSW207
     C                     ENDIF                                                              CSW207
      *                                                                                       CSW207
     C                     MOVELADPCNM    @CUST                                               CSW207
     C                     MOVELADPACD    @ACCD                                               CSW207
     C                     MOVELADPASQ    @ACSN                                               CSW207
     C                     MOVELWCCY      @CYCD                                               CSW207
     C                     EXSR SRNOST                                                        CSW207
     C                     MOVELA7NONB    @NOSTN                                              CSW207
      *                                                                                       CSW207
     C********** WENTTP    WHEQ 'G'                                                    CSW207 250600
     C********** BGMBIN    IFEQ 'Y'                                                    CSW207 250600
     C           WENTT2    WHEQ 'G'                                                           250600
     C           BGMBIN    IFEQ 'N'                                                           250600
     C                     MOVELBJSBRC    @BRCD                                               CSW207
     C                     ELSE                                                               CSW207
     C                     MOVELADGBRC    @BRCD                                               CSW207
     C                     ENDIF                                                              CSW207
      *                                                                                       CSW207
     C                     MOVELADGCNM    @CUST                                               CSW207
     C                     MOVELADGACD    @ACCD                                               CSW207
     C                     MOVELADGASQ    @ACSN                                               CSW207
     C                     MOVELADGCCY    @CYCD                                               CSW207
     C                     EXSR SRNOST                                                        CSW207
     C                     MOVELA7NONB    @NOSTN                                              CSW207
      *                                                                                       CSW207
     C********** WENTTP    WHEQ 'R'                                                    CSW207 250600
     C           WENTT2    WHEQ 'R'                                                           250600
     C                     MOVELADACNO    ACNO                                                CSW207
     C           ACNO      CHAINACNUMA               62                                       CSW207
     C                     MOVELBRCA      @BRCD                                               CSW207
     C                     MOVELCNUM      @CUST                                               CSW207
     C                     MOVELACOD      @ACCD                                               CSW207
     C                     MOVELACSQ      @ACSN                                               CSW207
     C                     MOVELCCY       @CYCD                                               CSW207
     C                     EXSR SRNOST                                                        CSW207
     C                     MOVELA7NONB    @NOSTN                                              CSW207
      *                                                                                       CSW207
     C********** WENTTP    WHEQ 'I'                                                    CSW207 250600
     C**********           MOVELWOCUST    PWORC1 47                                  BUG14926 250600
     C**********           CALL 'AOIBANR3'                                             CSW207 250600
     C**********           PARM *BLANKS   @RTCD                                        CSW207 250600
     C**********           PARM           WOCUST                                     CSW207 BUG14926
     C**********           PARM           PWORC1                                     BUG14926 250600
     C**********           PARM           POWITH                                       CSW207 250600
     C********** P@IBAN    PARM           PONOBL                                       CSW207 250600
     C********** P@IBAN    PARM           PONOBL                                     CSW207 BUG14926
     C**********           EXSR SRIBAN                                                 CSW207 250600
     C**********           MOVELBRCA      @BRCD                                        CSW207 250600
     C**********           MOVELCNUM      @CUST                                        CSW207 250600
     C**********           MOVELACOD      @ACCD                                        CSW207 250600
     C**********           MOVELACSQ      @ACSN                                        CSW207 250600
     C**********           MOVELCCY       @CYCD                                        CSW207 250600
     C**********           EXSR SRNOST                                                 CSW207 250600
     C**********           MOVELA7NONB    @NOSTN                                       CSW207 250600
      *                                                                                       CSW207
     C                     ENDSL                                                              CSW207
      *                                                                                       CSW207
      * CHECK IF NON-ACCOUNT HOLDER                                                          CSW207A
     C********** ODMTT     IFEQ 'O'                                                   CSW207A 250600
     C**********           MOVELPACCTP    W#ACTP  1                                   CSW207A 250600
     C**********           MOVEL'O'       PACCTP                                      CSW207A 250600
     C**********           ENDIF                                                      CSW207A 250600
      *                                                                                       250600
     C                     MOVELSMCY      I@CCY   3                                           250600
     C                     MOVELWENTTP    I@TYPE  1                                           250600
     C                     MOVELBRCAA     I@BRCA  3                                           250600
     C                     MOVELWACCT     I@ACCT 35                                           250600
      *                                                                                       250600
     C           WENTTP    IFNE 'O'                                                           250600
     C                     EXSR SRRTAC                                                        250600
     C                     MOVE @CNTLC    WLOCN                                              252903A
     C                     MOVELR@IBAN    W@IBAN 34                                           250600
     C                     MOVELR@ACNO    W@ACNO 10                                           250600
     C                     MOVELR@GLAC    W@GLAC 35                                           250600
     C                     MOVELR@GLAC    PACCD                                               250600
     C                     MOVELR@CUST    @CUST                                               250600
     C                     ELSE                                                               250600
      * SET IN SR01                                                                           250600
     C                     MOVELPNAHO     PNAHO                                               250600
     C                     MOVEL*BLANKS   W@IBAN                                              250600
     C                     MOVEL*BLANKS   W@ACNO                                              250600
     C                     MOVEL*BLANKS   W@GLAC                                              250600
     C                     MOVEL*BLANKS   PACCD                                               250600
     C                     MOVEL*BLANKS   @CUST                                               250600
     C                     ENDIF                                                              250600
      *                                                                                       250600
     C                     MOVELWENTTP    PACCTP                                              250600
     C           ODMT      IFEQ *BLANKS                                                       250600
     C                     MOVELORC1      P@IN1                                               250600
     C                     MOVELORC2      P@IN2                                               250600
     C                     MOVELORC3      P@IN3                                               250600
     C                     MOVELORC4      P@IN4                                               250600
     C                     MOVELORC5      P@IN5                                               250600
     C                     ELSE                                                               250600
     C                     MOVELODMT      P@IN1                                               250600
     C                     MOVEL*BLANKS   P@IN2                                               250600
     C                     MOVEL*BLANKS   P@IN3                                               250600
     C                     MOVEL*BLANKS   P@IN4                                               250600
     C                     MOVEL*BLANKS   P@IN5                                               250600
     C                     ENDIF                                                              250600
      *                                                                                      CSW207A
     C                     CALL 'FT001000'                                                    CSW207
     C                     PARM *BLANKS   PRTRN   7                                           CSW207
     C                     PARM *BLANKS   PMSID   7                                           CSW207
     C                     PARM *BLANK    PERTP   1                                           CSW207
     C                     PARM 'FRMT'    PVTYP   4                                           CSW207
     C**********           PARM ORC1      P@IN1  35                                   CSW207A 250600
     C**********           PARM ORC2      P@IN2  35                                   CSW207A 250600
     C**********           PARM ORC3      P@IN3  35                                   CSW207A 250600
     C**********           PARM ORC4      P@IN4  35                                   CSW207A 250600
     C**********           PARM ORC5      P@IN5  35                                   CSW207A 250600
     C**********           PARM           P@IN1  35                                   CSW207 CSW207A
     C**********           PARM           P@IN2  35                                   CSW207 CSW207A
     C**********           PARM           P@IN3  35                                   CSW207 CSW207A
     C**********           PARM           P@IN4  35                                   CSW207 CSW207A
     C**********           PARM           P@IN5  35                                   CSW207 CSW207A
     C                     PARM           P@IN1  35                                           250600
     C                     PARM           P@IN2  35                                           250600
     C                     PARM           P@IN3  35                                           250600
     C                     PARM           P@IN4  35                                           250600
     C                     PARM           P@IN5  35                                           250600
     C                     PARM           PACCTP  1                                           CSW207
     C                     PARM           PACCD  34                                           CSW207
     C                     PARM           @CUST   6                                           CSW207
     C                     PARM           PNAHO  10                                           CSW207
     C**********           PARM 'SWIFT'   PNTWRK  6                                    CSW207 250600
     C                     PARM NWRK      PNTWRK  6                                           250600
     C                     PARM '103'     PMSGTP  3                                           CSW207
     C                     PARM ':50F:'   PMSTAG  5                                           CSW207
     C**********           PARM           @CNTLC                                     CSW207 BUG15183
     C                     PARM WLOCN     @CNTLC                                            BUG15183
     C**********           PARM           BRCA                                         CSW207 250600
     C                     PARM           BRCAA                                               250600
     C                     PARM           PCCY                                                CSW207
     C                     PARM           @NOSTN  2                                           CSW207
     C**********           PARM           PMODI   2                                    CSW207 250600
     C                     PARM 'FT'      PMODI   2                                           250600
     C                     PARM           PMSGL1 35                                           CSW207
     C                     PARM           PMSGL2 35                                           CSW207
     C                     PARM           PMSGL3 35                                           CSW207
     C                     PARM           PMSGL4 35                                           CSW207
     C                     PARM           PMSGL5 35                                           CSW207
      *                                                                                       CFT124
     C           CFT124    IFEQ 'Y'                                                           CFT124
     C           PRTRN     ANDEQ*BLANKS                                                       CFT124
      *                                                                                       CFT124
      ** In first instance, need to check no code words are entered                           CFT124
      *                                                                                       CFT124
     C           1         SUBSTP@IN1:1   @SLSH1  1                                           CFT124
     C           1         SUBSTP@IN1:5   @SLSH5  1                                           CFT124
     C           @SLSH1    IFEQ '/'                                                           CFT124
     C           @SLSH5    ANDNE'/'                                                           CFT124
      *                                                                                       CFT124
      ** In second instance, need to ensure account is 'R'etail or 'P'artial                  CFT124
      *                                                                                       CFT124
     C           PACCTP    IFEQ 'R'                                                           CFT124
     C           PACCTP    OREQ 'P'                                                           CFT124
      *                                                                                       CFT124
      ** Conditions met - amend message output fields                                         CFT124
      ** Get Additional Customer Details                                                      CFT124
      *                                                                                       CFT124
     C           @CUST     CHAINSDACUSL0             70                                       CFT124
     C           *IN70     IFEQ *ON                                                           CFT124
     C                     CLEAR@ACUSL0                                                       CFT124
     C                     MOVE *BLANKS   TAXCTY  2                                           CFT124
     C                     ELSE                                                               CFT124
      *                                                                                       CFT124
      ** Identify correct Country to Use for TaxID                                            CFT124
      ** (1st non-numeric in pos 11 = 10 long = RU)                                           CFT124
      *                                                                                       CFT124
     C           NUMBS     CHECKE5IDNO    CHKNUM  20                                          CFT124
     C           CHKNUM    IFEQ 11                                                            CFT124
     C                     MOVE 'RU'      TAXCTY                                              CFT124
     C                     ELSE                                                               CFT124
     C                     MOVE BBCOLC    TAXCTY                                              CFT124
     C                     ENDIF                                                              CFT124
     C                     ENDIF                                                              CFT124
      *                                                                                       CFT124
     C**********           MOVE *BLANKS   PMSGL1                                   AR818552 MD021101
     C**********           MOVE *BLANKS   PMSGL2                                   AR818552 MD021101
     C**********           MOVE *BLANKS   PMSGL3                                   AR818552 MD021101
     C**********           MOVE *BLANKS   PMSGL4                                   AR818552 MD021101
     C**********           MOVE *BLANKS   PMSGL5                                   AR818552 MD021101
      *                                                                                     A1818552
     C           W#CADD    IFEQ 'Y'                                                           CFT124
      *                                                                                     MD021101
     C                     MOVE *BLANKS   PMSGL1                                            MD021101
     C                     MOVE *BLANKS   PMSGL2                                            MD021101
     C                     MOVE *BLANKS   PMSGL3                                            MD021101
     C                     MOVE *BLANKS   PMSGL4                                            MD021101
     C                     MOVE *BLANKS   PMSGL5                                            MD021101
      *                                                                                       CFT124
      ** Line 1 - /Account Name                                                               CFT124
      *                                                                                       CFT124
     C           '/'       CAT  ANAM      PMSGL1                                              CFT124
      *                                                                                       CFT124
      ** Line 2 - 1/Customer Name                                                             CFT124
      *                                                                                       CFT124
     C           '1/'      CAT  BBCNA1    PMSGL2                                              CFT124
      *                                                                                       CFT124
      ** Line 3 - 2/Customer Address                                                          CFT124
      *                                                                                       CFT124
     C           '2/'      CAT  BBCNA3    PMSGL3                                              CFT124
      *                                                                                       CFT124
      ** Line 4 - 3/ISO Country Code/City                                                     CFT124
      *                                                                                       CFT124
     C           '3/'      CAT  BBCNCZ    PMSG4A  4                                           CFT124
     C           PMSG4A    CAT  '/'       PMSG4B  5                                           CFT124
     C           PMSG4B    CAT  BBCRTN    PMSGL4                                              CFT124
      *                                                                                       CFT124
     C                     ENDIF                                                              CFT124
      *                                                                                       CFT124
     C           W#CTAX    IFEQ 'Y'                                                           CFT124
      *                                                                                       CFT124
      ** Line 5 - 7/ISO Country Code/Tax ID Number                                            CFT124
      *                                                                                       CFT124
     C           '7/'      CAT  TAXCTY    PMSG5A  4                                           CFT124
     C           PMSG5A    CAT  '/'       PMSG5B  5                                           CFT124
     C           PMSG5B    CAT  E5IDNO    PMSGL5                                              CFT124
      *                                                                                       CFT124
     C                     ENDIF                                                              CFT124
      *                                                                                       CFT124
      ** Move file fields to printer fields                                                   CFT124
      *                                                                                       CFT124
     C                     MOVELPMSGL1    OFSPT1                                              CFT124
     C                     MOVELPMSGL2    OFSPT2                                              CFT124
     C                     MOVELPMSGL3    OFSPT3                                              CFT124
     C                     MOVELPMSGL4    OFSPT4                                              CFT124
     C                     MOVELPMSGL5    OFSPT5                                              CFT124
     C                     ENDIF                                                              CFT124
     C                     ENDIF                                                              CFT124
     C                     ENDIF                                                              CFT124
      *                                                                                       CSW207
      * IF ERROR IN NAHO DISPLAY ORDERING CUSTOMER                                           CSW207A
     C********** ODMTT     IFEQ 'O'                                                   CSW207A 250600
     C********** PRTRN     ANDNE*BLANKS                                               CSW207A 250600
     C**********           MOVELW#ACTP    PACCTP                                      CSW207A 250600
     C**********           MOVEL*BLANKS   PNAHO                                       CSW207A 250600
     C**********           ENDIF                                                      CSW207A 250600
     C                     ENDSR                                                              CSW207
      *                                                                                       CSW207
      *****************************************************************                       CSW215
      /EJECT                                                                                  CSW215
      *****************************************************************                       CSW215
      *                                                               *                       CSW215
      *  SRFM59 - Retrieve Outgoing Message :59F: format              *                       CSW215
      *                                                               *                       CSW215
      *****************************************************************                       CSW215
     C           SRFM59    BEGSR                                                              CSW215
     C                     CALL 'MG001001'                                                    CSW215
     C                     PARM *BLANKS   PRTRN                                               CSW215
     C                     PARM 'FRMT'    PVTYP                                               CSW215
     C                     PARM           BNC1                                                CSW215
     C                     PARM           BNC2                                                CSW215
     C                     PARM           BNC3                                                CSW215
     C                     PARM           BNC4                                                CSW215
     C                     PARM           BNC5                                                CSW215
     C                     PARM NWRK      PNTWRK                                              CSW215
     C                     PARM '103'     PMSGTP                                              CSW215
     C                     PARM ':59F:'   PMSTAG                                              CSW215
     C                     PARM           BRCAA                                               CSW215
     C                     PARM           PCOUNT  2                                           CSW215
     C                     PARM PCCY      PCURRY  3                                           CSW215
     C                     PARM           @NOSTN                                              CSW215
     C                     PARM *BLANKS   PBENF1 35                                           CSW215
     C                     PARM *BLANKS   PBENF2 35                                           CSW215
     C                     PARM *BLANKS   PBENF3 35                                           CSW215
     C                     PARM *BLANKS   PBENF4 35                                           CSW215
     C                     PARM *BLANKS   PBENF5 35                                           CSW215
     C                     PARM *BLANKS   PMSID                                               CSW215
     C                     PARM *BLANK    PERTP                                               CSW215
      *                                                                                       CSW215
     C           PRTRN     IFEQ *BLANKS                                                       CSW215
     C                     MOVEL'Y'       WRK59F                                              CSW215
     C                     ENDIF                                                              CSW215
     C                     ENDSR                                                              CSW215
      *****************************************************************                       CSW202
      /EJECT                                                                                  CSW202
      *****************************************************************                       CSW202
      *                                                               *                       CSW202
      *   *PSSR - error handling                                      *                       CSW202
      *                                                               *                       CSW202
      *****************************************************************                       CSW202
      *                                                                                       CSW202
     C           *PSSR     BEGSR                                                              CSW202
      *                                                                                       CSW202
     C                     MOVE *ON       *INU7                                               CSW202
     C                     MOVE *ON       *INU8                                               CSW202
     C                     MOVE *ON       *INLR                                               CSW202
     C                     DUMP                                                               CSW202
     C                     RETRN                                                              CSW202
      *                                                                                       CSW202
     C                     ENDSR                                                              CSW202
      *****************************************************************                       CSW202
      /EJECT                                                                                  CSW202
     O*
      *                                                                   S01408
     O/COPY WNCPYSRC,FT0641OOP1                                           S01408
      *                                                                   S01408
      ** Amend position 85-88 from 6FA6 to 6F6A                                             BUG21272
      *                                                                                     BUG21272
      ** Replace *EQUATE for MGOMSGPD with a 4040 since it will be done                     AR972805
      ** externally                                                                         AR972805
      *                                                                                     AR972805
******* TRANS. SPEC. PRINT MSGS AS THEY WILL BE AFTER MS0200 (NO INV.CHRS)                  AR972805
******* FT0641P1,MGOMSGPD                                                                   AR972805
******* 4E504B5E7D7F4DC05DD060CD6F5A6F5B6F4A6F6C6F5C6F4C6F7E6F6E6F7C6FE0D57B6F6A   BUG21272 AR972805
******* 6F4F6F5F7D7960A1606D                                                                AR972805
** FTRANS
*EQUATE FT0641P1,MGOMSGPD
*EQUATE 4040
     X/COPY WNCPYSRC,FT0641X001
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
** TABA/TABB - Instruction Code/Bank to Bank Code                         CFT014
BONL/BENONLY/                                                             CFT014
CHQB/CHEQUE/                                                              CFT014
CORT/CORPTRAD/                                                            CFT014
HOLD/HOLD/                                                                CFT014
INTC/INTRACOM/                                                            CFT014
PHON/PHON/                                                                CFT014
PHOB/PHONBEN/                                                             CFT014
PHOI/PHONIBK/                                                             CFT014
TELE/TELE/                                                                CFT014
TELB/TELEBEN/                                                             CFT014
TELI/TELEIBK/                                                             CFT014
**   ALPH  - Array of alphabetic                                                              CSW202
ABCDEFGHIJKLMNOPQRSTUVWXYZ                                                                    CSW202
**   NUMC  - Array of numeric                                                                 CSW202
1234567890                                                                                    CSW202
**   SVAL  -  SYSTEM VALUES ARRAY                                                             242289
UseFullFTRefInMsg                                                                             242289
FTAllowFld50F                                                                               MD048075