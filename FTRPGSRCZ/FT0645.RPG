     H        1   D                       F
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas FT Bank transfers input cycle')                  *
      *****************************************************************
      *                                                               *
      *  Midas - FUNDS TRANSFER MODULE                                *
      *                                                               *
      *  FT0645 - BANK TRANSFERS                                      *
      *                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. HUT110             Date 20Apr20               *
      *  Prev Amend No. MD051787           Date 02Oct18               *
      *                 CSW218             Date 19Mar18               *
      *                 MD046248           Date 27Oct17               *
      *                 CSW215             Date 06Apr15               *
      *                 MD033624           Date 03Jun15               *
      *                 CSW213             Date 03Jun13               *
      *                 238256A            Date 18Apr13               *
      *                 AR972805           Date 27Feb13               *
      *                 238256             Date 21Feb13               *
      *                 260987A            Date 09Nov12               *
      *                 CFT120             Date 28Sep12               *
      *                 AR787620           Date 10Jun11               *
      *                 CRE075             Date 06Dec10               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 BUG24482           Date 22Jun09               *
      *                 BUG24462           Date 19Jun09               *
      *                 CSW209             Date 01Apr09               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 BUG15044A          Date 25Oct07               *
      *                 BUG15201           Date 30Oct07               *
      *                 BUG13217           Date 04Feb07               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CFT032             Date 11Sep06               *
      *                 CSD031             Date 10Apr06               *
      *                 222239             Date 06Jun06               *
      *                 222448             Date 06Jun06               *
      *                 CDL049             Date 07Jul06               *
      *                 CSD027             Date 09Dec05               *
      *                 CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 CSC022             Date 24Feb04               *
      *                 CGL029             Date 01Sep03               *
      *                 222385             Date 23Oct03               *
      *                 221145             Date 08Sep03               *
      *                 219242             Date 01Jul03               *
      *                 219241             Date 01Jul03               *
      *                 CSD015             Date 14Oct02               *
      * Midas Release 4.01.01 ----------------------------------------*
      *                 CSW202             Date 20May02               *
      * Midas Release 4.01 -------------------------------------------*
      *                 CSW025             Date 26Mar02               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 138077             Date 20Jun01               *
      *                 CSW201             Date 02May01               *
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CFT009             Date 01Jun00               *
      * Midas DBA 3.04 -----------------------------------------------*
      *                 185702             Date 31Oct00               *
      *                 CFT014             Date 25May00               *
      * Midas DBA 3.03 -----------------------------------------------*
      *                 180414             Date 19Jul00               *
      * Midas DBA 3.02 -----------------------------------------------*
      *                 CSW020             Date 10Jan00               *
      *                 CFT004             DATE  27Aug99              *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 164663             DATE  25AUG99              *
      *                 151235             DATE  21DEC98              *
      *                 149197             DATE  08DEC98              *
      *                 CEU006             DATE  06APR98              *
      *                 113352             DATE  29JAN97              *
      *                 S01408             DATE  18NOV96              *
      *                 S01408             DATE  01NOV96              *
      *                 S01408             DATE  05SEP96              *
      *                 CSW096             DATE  03SEP96              *
      *                 098103             DATE  01JUL96              *
      *                 S01408             DATE  10JAN96              *
      *                 087873             DATE  01JUN95              *
      *                 088545             DATE  21JUN95              *
      *                 071383             DATE   2AUG94              *
      *                 S01499             DATE  06JUN94              *
      *                 S01494             DATE  25MAY94              *
      *                 068367             DATE  18MAR94              *
      *                 064252             DATE  08DEC93              *
      *                 064393             DATE  08DEC93              *
      *                 S01435             DATE  08SEP93              *
      *                 058745             DATE  27JUL93              *
      *                 058476             DATE  20JUL93              *
      *                 055293             DATE  17MAY93              *
      *                 S01414             DATE  29MAR93              *
      *                 041780             DATE  17FEB93              *
      *                 E32481             DATE  10JUL91              *
      *                 E32480             DATE  10JUL91              *
      *                 S01310             DATE  10JUL91              *
      *                 E25033             DATE  23MAY91              *
      *                 S01194             DATE  06SEP90              *
      *                 S01117             DATE  06SEP90              *
      *                 E22897             DATE  23JUL90              *
      *                 E22406             DATE  05JUL90              *
      *                 E21473             DATE  11MAY90              *
      *                 E21471             DATE  04MAY90              *
      *                 E21467             DATE  27APR90              *
      *                 S01177             DATE  23/11/89             *
      *                                                               *
      *****************************************************************
      *                                                               *
      *  HUT110 - Upgrade of HUT022 to FBM 2.1 SP22                   *
      *           RTGS via SWIFT.  Added the following hooks:         *
      *           HUT110_037   HUT110_038   HUT110_039   HUT110_040   *
      *           HUT110_041   HUT110_042   HUT110_043   HUT110_044   *
      *  MD051787 - Field 33B on MT202 cover generated from FT OPAY   *
      *             incorrectly formatted in Midas and rejected in MMM*
      *  CSW218 - SWIFT Changes 2018                                  *
      *  MD046248 - Finastra Rebranding                               *
      *  CSW215 - SWIFT Changes 2015                                  *
      *  MD033624 - Error during Compilation due to conflict in field *
      *             definition. Renamed fields from OTPAYDD           *
      *  CSW213 - SWIFT Changes 2013 (Recompile)                      *
      *  238256A - Reverse 238256 as it does does not follow SWIFT    *
      *            practice.                                          *
      *         - Applied for AR973773A (Child: AR973911A)            *
      *  AR972805 - Remove equate translation as done externally.     *
      *             (Child: AR972806)                                 *
      *  238256 - If a Retail account is in Receiver's Correspondent  *
      *           then copy to first line of :58: (Beneficiary).      *
      *         - Applied for AR973773 (Child: AR973911)              *
      *  260987A - Destination not always displayed on the report.    *
      *            Fields omitted on write to MGOREFPD. Wrong Sender  *
      *            address when network is Paper.                     *
      *  CFT120 - FT IN/OP - Charges to DR of Account Currency        *
      *           (Recompile)                                         *
      *  AR787620 - Hooks Incorporation                               *
      *             WNCPYSRC,FTH00001                                 *
      *  CRE075 - Effective Date for Retail Accounts (Recompile)      *
      *  BUG24482 - field tag 50K instead of 50A is generated for     *
      *             MT202COV                                          *
      *  BUG24462 - Ordering customer cover value in FTC0645P1 is     *
      *             missing                                           *
      *  CSW209 - SWIFT 2009 Changes                                  *
      *  BUG15044A - Additional coding for swift reference consistent *
      *              with fix 242289 in core.                         *
      *  BUG15201 - Encounter Database Errors (Recompile)             *
      *  BUG13217 - Outward Payments are not being sent to MMM        *
      *  CFT032 - Account line in field 50k in MT103 (recompile)      *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  222239 - FTC0690 terminated abnormally due to duplicate      *
      *           record in MGOREFPD.  Update necessary flags to      *
      *           indicate that a message was already created.        *
      *  222448 - Include the Receiver's Charges in field 32A.        *
      *  CDL049 - Addition of a Reference Rate field (recompile)      *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CSC022 - Commitment Control Changes for MidasPlus            *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  222385 - SWIFT msgs are Watch List checked regardless of     *
      *           configuration file setting                          *
      *  221145 - Compliance Watch WLC: Move compliance check to      *
      *           after COMIT to MGOMSGPD                             *
      *  219242 - Not possible to create MT103+ payment msg from      *
      *           non-FT transaction (Recompile)                      *
      *  219241 - Defaulting of "Details of Charges" assign a         *
      *           system value (Recompile)                            *
      *  CSD015 - Midas Compliance Watch - Watch List Checking        *
      *  CSW202 - SWIFT 2002 Standards Update                         *
      *  CSW025 - Midas Message Manager                               *
      *          -  Pass original change type                         *
      *  138077 - Add extension file MGOEXTPD to store customer no.   *
      *           of field with SWIFT address.                        *
      *         - Allow messages to have expansion even if it starts  *
      *           with "/".                                           *
      *  CSW201 - SWIFT 2001 Standards Update                         *
      *  CFT009 - FT Fees and Charge Development                      *
      *  185702 - Duplicate hook FT0645C026 renamed                   *
      *  CFT014 - Straight-through Processing Phase 2 MT103 Messages  *
      *           Generation for FT                                   *
      *  180414 - The senders correspondent field should not be       *
      *           populated if the account is with the institution    *
      *           sending the SWIFT message. Similar problem to the   *
      *           cover 202 problem (177284) in FT0342.               *
      *  CSW020 - SWIFT Decimal Places                                *
      *           Adjust the amount if the Swift decimal places       *
      *           differs from the currency decimal places            *
      *  CFT004 - International Bank Account Number                   *
      *           New Account Type 'I' (IBAN)                         *
      *  164663 - Extension of fix 141572 to setup CINDV (Century     *
      *           indicator for Value Date) for Y2K display problem.  *
      *  151235 - Extend fix 149197 to cater for /CHGS/ swiftcode.    *
      *           Format field 72:/CHGS/xxxxxxx, swiftcode line with a*
      *           final '/'.                                          *
      *  149197 - Format field 72:/OCMT/xxxnnnn, swiftcode line with a*
      *           final '/'.                                          *
      *  CEU006 - EMU Settlement Details. Include /OCMT/ on Bank      *
      *           to Bank Info where necessary                        *
      *     113352 - Set-up CIND (Century Flag) to correct year 2000  *
      *              display problem.                                 *
      *     S01408 - Addition of Core Hook FT0645CP21                 *
      *              Addition of Core Hook FT0645CP20                 *
      *              Addition of Core Hook FT0645CP19                 *
      *              Addition of Core Hook FT0645CP18                 *
      *     S01408 - Addition of Core Hook FT0645FFP2                 *
      *              Addition of Core Hook FT0645CP17                 *
      *              Addition of Core Hook FT0645CP16                 *
      *              Addition of Core Hook FT0645CP15                 *
      *              Addition of Core Hook FT0645CP14                 *
      *              Addition of Core Hook FT0645CP13                 *
      *              Addition of Core Hook FT0645CP12                 *
      *              Addition of Core Hook FT0645CP11                 *
      *              Addition of Core Hook FT0645CP10                 *
      *              Addition of Core Hook FT0645CCP9                 *
      *              Addition of Core Hook FT0645X001                 *
      *     S01408 - Core hook FT0645CCP8 added                       *
      *            - Core hook FT0645CCP7 added                       *
      *            - Core hook FT0645CCP6 added                       *
      *            - Core hook FT0645CCP5 added                       *
      *            - Core hook FT0645CCP4 added                       *
      *            - Core hook FT0645CCP3 added                       *
      *            - Core hook FT0645CCP2 added                       *
      *            - Core hook FT0645CCP1 added                       *
      *            - Core hook FT0645IIP1 added                       *
      *            - Core hook FT0645FFP1 added                       *
      *     CSW096 - SWIFT changes 1996                               *
      *     098103 - System tried to chain PF/ACNUMA with a negative  *
      *              retail number. Error was caused by 'ISPTY1' not  *
      *              being cleared.                                   *
      *     S01408 - Core hook FT0645OOP1 added                       *
      *     087873 - Further to fix 064393; some SWIFT messages had   *
      *              our customer name in Network Sender field        *
      *              rather than our Swift ID.                        *
      *     088545 - If there is no message status default for that   *
      *              message type for the involved customer,          *
      *              default the message status with the ICD.         *
      *     071383 - Set msg type field MT202 after the message       *
      *              was successfully generated to prevent a          *
      *              second attempt if any part of FTC0630 failed.    *
      *     S01499 - BLI V.A.T. Processing                            *
      *     S01494 - BLI Funds Transfer Enhancements                  *
      *     068367 - Ensure Priority and Delivery Notification fields *
      *              are a valid combination.                         *
      *     064252 - USE MOVEL NOT MOVE FOR FIELD AMTS.               *
      *     064393 - GET SENDERS TID FROM BRANCH NOT CUSTOMER.        *
      *     S01435 - Incoming Message Management.                     *
      *     058745 - Output Related Ref in 21: if not blank           *
      *     058476 - Amounts incorrectly formatted on S.W.I.F.T.      *
      *              Field FLD32 not cleared correctly.               *
      *     055293 - Include Ordering Institution information         *
      *              in field 52 if ORBT not a Retail or a Nostro.    *
      *     S01414 - Book Code and Profit Centre Incorporation.       *
      *              Rename of profit centre field on ACCNTABF        *
      *     041780 - Correctly output Swift Value Date to MSIXOPF     *
      *              (only the above part of the fix needs to be      *
      *               applied because the remainder was covered by    *
      *               the R10 Swift Rationalisation)                  *
      *     E32481 - REMOVAL OF CALL TO FTC0647.                      *
      *              LOGICAL FILE BUILT ONLY OVER PF/OTPAY.           *
      *     E32480 - REMOVAL OF REDUNDANT COMMON REFERENCE CODE.      *
      *     S01310 - SWIFT RATIONALISATION - NEW OUTPUT FILES.        *
      *     E25033 - SHOULD NOT OUTPUT HARD COPY TELEX IF MAIL        *
      *              PAYMENT PLUS COVER MESSAGE                       *
      *     S01194 - NEW DATABASE ERROR HANDLING                      *
      *     S01117 - REPORT CONTROL FACILITY                          *
      *     S01117 - FUNDS TRANSFER DEFAULT BRANCH REMOVAL AND        *
      *              CHANGE OF INTERBRANCH ENTRIES                    *
      *     E22897 - PREVENTION  OF TRUNCATION OF AMOUNTS             *
      *              OF CURRENCIES WITH NO DECIMAL PLACES.            *
      *     E22406 - TERMINAL IDENTIFICATION REMOVAL.                 *
      *     E21473 - MAIL PAYMENT ORDER CHECK.                        *
      *     E21471 - DISPLAY CHAPS CODE ON MT202.                     *
      *     E21467 - SETTLEMENT TYPE CHAPS SHOULD GO THROUGH SWIFT.   *
      *     S01177 - CHANGES FOR EXTENDED SETTLEMENTS                 *
      *                                                               *
      *****************************************************************
      *                                                                   S01408
     F/COPY WNCPYSRC,FT0645FFP1                                           S01408
      *                                                                   S01408
     F*PRFP2***IP**E           K        DISK                              E32481
     F************OTPAYDDF                          KRENAMEDDFOTPAY       E32481
     F************CQPACDDF                          KRENAMEDDFCQPAC       E32481
     FPRFP9   IP  E           K        DISK                               E32481
     F            OTPAYDDF                          KRENAMEDDFOTPAY       E32481
     F*CLINT***IF**E           K        DISK                              S01310
     F************CLINTCAF                          KIGNORE               S01310
     F************CLINTC1F                          KIGNORE               S01310
     FACNUMA  IF  E           K        DISK
     FOTPAYXL0IF  E           K        DISK                               CFT009
     F/COPY WNCPYSRC,HUT110_037                                                               HUT110
     F*
     F/COPY WNCPYSRC,FT0645FFP2                                           S01408
     F*
     FOTPAY   UF  E           K        DISK                               071383
     F            OTPAYDDF                          KRENAMEOTPAYDDR       071383
     F                                              KCOMIT                071383
     FCQPAC   UF  E           K        DISK                               071383
     F            CQPACDDF                          KRENAMECQPACDDR       071383
     F                                              KCOMIT                071383
     F            CQPADDDF                          KIGNORE               071383
     F*MSIXOPF*O***E                    DISK         KCOMIT       A       S01310
     F*MSMSOPF*O***E           K        DISK         KCOMIT       A       S01310
     FMEINDTL0IF  E           K        DISK                                                   CSW218
     FMGOEXTPDO   E                    DISK                               138077
     F                                              KCOMIT                138077
     FMGOREFPDO   E                    DISK                               S01310
     F                                              KCOMIT                S01310
     FMGOMSGPDO   E                    DISK                               S01310
     F                                              KCOMIT                S01310
     FMEISOCL1IF  E           K        DISK                                                   CSW209
     F*
     F*FT0645P3O***E********************PRINTER                           S01117
     F*FT0645P2O***E********************PRINTER                           S01117
     F*FT0645P1O***E********************PRINTER                           S01117
     FFT0645AUO   E                    PRINTER      KINFDS SPOOLU         S01117
     FFT0645P1O   E                    PRINTER      KINFDS SPOOL1         S01117
     FFT0645P2O   E                    PRINTER      KINFDS SPOOL2         S01117
     F/COPY WNCPYSRC,FT0645F002
     F***SDBRCHL5IF  E           K        DISK                               E22406
     FSDBRCHL1IF  E           K        DISK                                                 BUG13217
     FTABFP   IF  E           K        DISK
     F            TABTB20F                          KIGNORE
     F            TABTG20F                          KIGNORE
     F            TABLETHF                          KIGNORE
     F            TABLETPF                          KIGNORE
     F************TABLETJF                          KIGNORE               S01117
     F            TABLET5F                          KIGNORE
     F            TABTE10F                          KIGNORE
     F/COPY WNCPYSRC,FT0645F001
     F*
     F/EJECT
     F*
     F****************************************************************
     F* ID F  C  H  L    FUNCTION OF INDICATORS                      *
     F****************************************************************
     F* 01              RECORD READ FROM OTPAYDD                     *
     F**02**************RECORD READ FROM CQPACDD                     *    E32481
     F*                                                              *
     F*       10        UNSUCCESSFUL CHAIN TO TABFP.                 *
     F*       11        UNSUCESSFUL CHAIN TO ACNUMA                  *
     F********12********UNSUCESSFUL CHAIN TO CLINT                   *    S01310
     F*       13        Unsuccessful CHAIN to MEISOCL0               *                        CSW209
     F*       14        Call to standard pgm ended in error.         *    S01310
     F*       15        LOKUP operation searching array (GNR)        *    S01310
     F*       16        LOKUP operation searching array (GNR)        *    S01310
     F*       17        LOKUP operation searching array (GNR)        *    S01310
     F*       20        CALL OF SR01 FOR DESTINATION OF MESSAGE      *
     F*       25        UNSUCESSFUL CHAIN TO OTPAYXL0                *    CFT009
     F********26********DONT UPDATE MFSCTL FOR MT210 TELEX MESSAGE   *    S01310
     F*       40        FIRST CYCLE COMPLETED.                       *
     F********41********UNSUCESSFUL WRITE MSIXOPFF                   *    S01310
     F********42********UNSUCESSFUL WRITE MSMSOPFF                   *    S01310
     F*       41        UNSUCESSFUL WRITE MGOREFPD.                  *    S01310
     F*       42        UNSUCESSFUL WRITE MGOMSGPD.                  *    S01310
     F*       50        MULTIBRANCH INDICATOR ACTIVE                 *    S01117
     F*                                                              *
     F*       U7        ) DATA BASE                                  *
     F*       U8        ) ERROR.                                     *
     F*             LR  LAST RECORD (TERMINATE PROGRAM).             *
     F*                                                              *
     F*  N.B:- 90-99    STANDARD SUBROUTINE INDICATORS.              *
     F****************************************************************
     F*
     F/EJECT
     E                    CPY@    1   1 80
     E*
     E                    MTH    12  12  3               MONTH  SR. ARRAY
     E/COPY WNCPYSRC,FT0645E002
     E                    AMT        13  1               AMOUNT ARRAY
     E                    AM         14  1               EDITED AMOUNT ARR
     E                    FAMT       15  1               LEFT ADJ AMNT ARR
     E                    ADDR        6 35               NAME/ADDRESS  ARR
     E                    @WRK       50  1               work array       S01310
     E                    @HLD       15  1               Set up fld 20.   S01310
     E                    GNR        15  3               msg gen released.S01310
     E                    @STR       24  1               String formatting149197
     E                    WA1        50  1                                                    CSW209
      **                                                                                      CSC022
      ** Array to hold commitment jobs name                                                   CSC022
      **                                                                                      CSC022
     E                    WCMT       10 10                                                    CSC022
      **                                                                                      CSC022
     E/COPY WNCPYSRC,FT0645E001
      *
     E                    SVAL    1   1 20                                                 BUG15044A
     E/EJECT
     I*
     I*CLINTCBF****70                                                     S01310
     I**************SWTX                            SWTXRN                S01310
     I*                                                                   S01414
     I* Rename of ACCNTABF Profit Centre to avoid overwriting             S01414
     I*                                                                   S01414
     IACCNTABF                                                            S01117
     I              PRFC                            ACPRFC                S01414
     I*                                                                   S01414
     IDDFOTPAY    01
     I*DDFCQPAC****02                                                     E32481
     I*                                                                   S01117
     I/COPY WNCPYSRC,FT0645I001
     ISPOOLU      DS                                                      S01117
     I* FILE INFORMATION DATA STRUCTURE                                   S01117
     I                                       83  92 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
     ISPOOL1      DS                                                      S01117
     I* FILE INFORMATION DATA STRUCTURE                                   S01117
     I                                       83  92 SFILE1                S01117
     I                                    B 123 1240SFNUM1                S01117
     ISPOOL2      DS                                                      S01117
     I* FILE INFORMATION DATA STRUCTURE                                   S01117
     I                                       83  92 SFILE2                S01117
     I                                    B 123 1240SFNUM2                S01117
     I/COPY WNCPYSRC,FT0645I002
     I*                                                                   S01117
     IRUNDAT      DS                             13                       S01117
     I* DATA STRUCTURE TO RETRIEVE MULTIBRANCH INDICATOR                  S01117
     I                                       13  13 MBIN                  S01117
     IEXTN        DS                         45                           138077
     I                                        1   20MPSN                  138077
     I                                        3   7 MTG                   138077
     I                                        8  15 MCSI                  138077
      *                                                                   138077
      **  Multiple occurrence data structure for extension file           138077
      *                                                                   138077
     I            DS                                                      138077
     I                                        1   5 @MTG                  138077
     I                                        2   2 FLDTYP                138077
     I                                        4   4 FLDTAG                138077
      *                                                                   138077
      **  Field tag data structure                                        138077
      *                                                                   138077
     I*
     I/COPY WNCPYSRC,FT0645I004
      ***************************************************************     S01310
      *  NOTE:                                                      *     S01310
      *  The following data structures were originally used as the  *     S01310
      *  method of writing out the swift message to PF/MSMSOPF.     *     S01310
      *  As this method of output has been replaced by a multiple   *     S01310
      *  occurence data structure only the definitions of the       *     S01310
      *  relevant fields has been retained.                         *     S01310
      *  The multiple occurence data structure is used to store up  *     S01310
      *  the records that make up the SWIFT message before writing  *     S01310
      *  the whole message to file.                                 *     S01310
      *  To store the records of the message , you must first       *     S01310
      *  access an OCUR record, then obtain the Message Tag and     *     S01310
      *  Message Field data values for this OCUR record. Continue   *     S01310
      *  this process until the SWIFT message is complete.          *     S01310
      ***************************************************************     S01310
     I            DS
     I********************************************************
     I*       DATA STRUCTURE TO BUILD BANK TRANSFER          *
     I*        RECORDS OUTGOING SWIFT MESSAGE TYPE MT202-1   *
     I********************************************************
     I                                        1 256 MT2021
     I************                            1   1 M1HEAD                S01310
     I************                            2   3 M1CRL1                S01310
     I                                        4  15 M1OTID
     I************                           16  16 M1SP1                 S01310
     I************                           17  21 M1ISNO                S01310
     I************                           22  23 M1CRL2                S01310
     I                                       24  26 M1MSGT
     I************                           27  27 M1SP2                 S01310
     I************                           28  29 M1MSGP                S01117
     I************                           30  31 M1CRL3                S01310
     I                                       32  43 M1RADD
     I************                           44  45 M1CRL4                S01310
     I************                           68  71 M1TG20                S01310
     I************                           72  87 M1TREF                S01310
     I************                           88  89 M1CRL6                S01310
     I************                           90  93 M1TG21                S01310
     I                                       94 109 M1RTRT
     I************                          110 111 M1CRL7                S01310
     I************                          112 116 M1TG32                S01310
     I                                      117 122 M1VDAT
     I                                      123 125 M1RCCY
     I                                      126 140 M1AMNT
     I************                          141 142 M1CRL8                S01310
     I************                          143 145 M1TG52                S01310
     I                                      146 146 M1OBTG
     I************                          147 147 M1HYPH                S01310
     I                                      148 184 M1OBK1
     I************                          185 186 M1CRL9                S01310
     I                                      187 221 M1OBK2
     I************                          222 223 M1CRLA                S01310
     I************                          257 257 MXMIND                S01310
     I************                          258 272 MXTREF                S01310
     I                                      273 273 MXDFLG
     I*
     I            DS
     I********************************************************
     I*       DATA STRUCTURE TO BUILD BANK TRANSFER          *
     I*        RECORDS OUTGOING SWIFT MESSAGE TYPE MT202-2   *
     I********************************************************
     I                                        1 256 MT2022
     I                                        1  35 M2OBK3
     I************                           36  37 M2CRL1                S01310
     I                                       38  72 M2OBK4
     I************                           73  74 M2CRL2                S01310
     I                                       75 109 M2OBK5
     I************                          110 111 M2CRL3                S01310
     I************                          112 114 M2TG53                S01310
     I                                      115 115 M2SCTT
     I************                          116 116 M2COLN                S01310
     I                                      117 153 M2SCR1
     I************                          154 155 M2CRL4                S01310
     I                                      156 190 M2SCR2
     I************                          191 192 M2CRL5                S01310
     I                                      193 227 M2SCR3
     I************                          228 229 M2CRL6                S01310
     I*
     I            DS
     I********************************************************
     I*       DATA STRUCTURE TO BUILD BANK TRANSFER          *
     I*        RECORDS OUTGOING SWIFT MESSAGE TYPE MT202-3   *
     I********************************************************
     I                                        1 256 MT2023
     I                                        1  35 M3SCR4
     I************                           36  37 M3CRL1                S01310
     I                                       38  72 M3SCR5
     I************                           73  74 M3CRL2                S01310
     I************                           75  77 M3TG54                S01310
     I                                       78  78 M3RCTT
     I************                           79  79 M3COLN                S01310
     I                                       80 116 M3RCR1
     I************                          117 118 M3CRL3                S01310
     I                                      119 153 M3RCR2
     I************                          154 155 M3CRL4                S01310
     I                                      156 190 M3RCR3
     I************                          191 192 M3CRL5                S01310
     I                                      193 227 M3RCR4
     I************                          228 229 M3CRL6                S01310
     I*
     I            DS
     I********************************************************
     I*       DATA STRUCTURE TO BUILD BANK TRANSFER          *
     I*        RECORDS OUTGOING SWIFT MESSAGE TYPE MT202-4   *
     I********************************************************
     I                                        1 256 MT2024
     I                                        1  35 M4RCR5
     I************                           36  37 M4CRL1                S01310
     I************                           38  40 M4TG56                S01310
     I                                       41  41 M4IBKT
     I************                           42  42 M4CLN1                S01310
     I                                       43  79 M4IBK1
     I************                           80  81 M4CRL2                S01310
     I                                       82 116 M4IBK2
     I************                          117 118 M4CRL3                S01310
     I                                      119 153 M4IBK3
     I************                          154 155 M4CRL4                S01310
     I                                      156 190 M4IBK4
     I************                          191 192 M4CRL5                S01310
     I                                      193 227 M4IBK5
     I************                          228 229 M4CRL6                S01310
     I*
     I            DS
     I********************************************************
     I*       DATA STRUCTURE TO BUILD BANK TRANSFER          *
     I*        RECORDS OUTGOING SWIFT MESSAGE TYPE MT202-5   *
     I********************************************************
     I                                        1 256 MT2025
     I************                            1   3 M5TG57                S01310
     I                                        4   4 M5ABTT
     I************                            5   5 M5CLN1                S01310
     I                                        6  42 M5AWB1
     I************                           43  44 M5CRL1                S01310
     I                                       45  79 M5AWB2
     I************                           80  81 M5CRL2                S01310
     I                                       82 116 M5AWB3
     I************                          117 118 M5CRL3                S01310
     I                                      119 153 M5AWB4
     I************                          154 155 M5CRL4                S01310
     I                                      156 190 M5AWB5
     I************                          191 192 M5CRL5                S01310
     I************                          193 195 M5TG58                S01310
     I                                      196 196 M5BBTT
     I************                          197 197 M5CLN2                S01310
     I                                      198 234 M5BBK1
     I************                          235 236 M5CRL6                S01310
     I*
     I            DS
     I********************************************************
     I*       DATA STRUCTURE TO BUILD BANK TRANSFER          *
     I*        RECORDS OUTGOING SWIFT MESSAGE TYPE MT202-6   *
     I********************************************************
     I                                        1 256 MT2026
     I                                        1  35 M6BBK2
     I************                           36  37 M6CRL1                S01310
     I                                       38  72 M6BBK3
     I************                           73  74 M6CRL2                S01310
     I                                       75 109 M6BBK4
     I************                          110 111 M6CRL3                S01310
     I                                      112 146 M6BBK5
     I************                          147 148 M6CRL4                S01310
     I**************************************149 152 M6TG72                S01177
     I**************************************153 187 M6BTB1                S01177
     I**************************************188 189 M6CRL5                S01177
     I**************************************190 224 M6BTB2                S01177
     I**************************************225 226 M6CRL6                S01177
     I************                          153 156 M6TG72          S01177S01310
     I                                      157 191 M6BTB1                S01177
     I************                          192 193 M6CRL5          S01177S01310
     I                                      194 228 M6BTB2                S01177
     I************                          229 230 M6CRL6          S01177S01310
     I*
     I            DS
     I********************************************************
     I*       DATA STRUCTURE TO BUILD BANK TRANSFER          *
     I*        RECORDS OUTGOING SWIFT MESSAGE TYPE MT202-7   *
     I********************************************************
     I                                        1 256 MT2027
     I                                        1  35 M7BTB3
     I************                           36  37 M7CRL1                S01310
     I                                       38  72 M7BTB4
     I************                           73  74 M7CRL2                S01310
     I                                       75 109 M7BTB5
     I************                          110 111 M7CRL3                S01310
     I                                      112 146 M7BTB6
     I************                          147 148 M7CRL4                S01310
     I************                          149 149 M7HYPH                S01310
     I************                          150 150 M7ETX                 S01310
      *                                                                   CSW096
     IP@IN        DS                            256                       CSW096
     I                                        1   3 I@SNBR                CSW096
     I                                        4   9 I@DSCN                CSW096
     I                                       10  12 I@MTPY                CSW096
     I                                       13  140I@SETT                CSW096
     I                                       15  15 I@CONC                CSW096
     I                                       16  16 I@FTCS                CSW096
     I                                       17  18 I@MMOD                CSW096
      ** Data structure for input parameter                               CSW096
      *                                                                   CSW096
     IP@OUT       DS                            256                       CSW096
     I**********                              1   60O@CNSN                             CSW096 CSD027
     I                                        1   6 O@CNSN                                    CSD027
     I                                        7  18 O@SWSN                CSW096
     I                                       19  38 O@NWSN                CSW096
     I                                       39  49 O@SWDS                CSW096
     I                                       46  46 W@96CN                CSW096
     I                                       47  49 W@BIC                 CSW096
     I                                       50  69 O@NWDS                CSW096
     I                                       70  75 O@NWRK                CSW096
     I                                       76  76 O@MGSG                CSW096
     I                                       77  80 O@MGST                CSW096
     I                                       81  81 O@PAIN                CSW096
     I                                       82  87 O@PCNB                CSW096
     I                                       88  90 O@SPRS                CSW096
      ** Data structure for output parameter                              CSW096
      *                                                                   CSW096
     I*
     I            DS
     I*
     I**********************************************
     I*       DATA STRUCTURE TO SAVE FIELDS FROM   *
     I*        INSTALLATION CONTROL DATA AREA.     *
     I**********************************************
     I*
     I****************************************1   30SDFBR                 S01117
     I                                        4  15 SCSID
     I                                       12  12 CSID9
     I                                       13  13 CSID10
     I                                       14  14 CSID11
     I                                       15  15 CSID12
     I*
     I*
     I**********************************************
     I*   DATA STRUCTURE TO HANDLE THE CONVERSION  *
     I*   OF DATE FORMAT YYMMDD TO DDMMMYY.        *
     I**********************************************
     I            DS
     I                                        1   60SDATE
     I                                        1   2 SYY
     I                                        3   40SMM
     I                                        5   6 SDD
     I            DS
     I                                        1   7 WDATE
     I                                        1   2 WDD
     I                                        3   5 WMM
     I                                        6   7 WYY
     I*
     I**********************************************
     I*   DATA STRUCTURE TO MANIPULATE AMOUNT      *
     I**********************************************
     I            DS
     I                                        1  130WAMNT
     I                                        1  13 RAMNT
     I* FOR EDITING ON THE REPORT
     I                                        1  130P2AMT0
     I                                        1  130P2AMT1
     I                                        1  130P2AMT2
     I                                        1  130P2AMT3
     I*
      *                                                                   E32480
      ** The following data structures are not used as the common         E32480
      ** reference is not used.                                           E32480
      *                                                                   E32480
     I**********************************************                      E32480
     I****DATA*STRUCTURE TO MANIPULATE RATE EXCHG  *                      E32480
     I**********************************************                      E32480
     I************DS                                                      E32480
     I************                            1  138WRATE                 E32480
     I************                            1   1 R1                    E32480
     I************                            2   2 R2                    E32480
     I************                            3   3 R3                    E32480
     I************                            4   4 R4                    E32480
     I************                            5   5 R5                    E32480
     I************                            6   6 R6                    E32480
     I************                            7   7 R7                    E32480
     I************                            8   8 R8                    E32480
     I************                            9   9 R9                    E32480
     I************                           10  10 R10                   E32480
     I************                           11  11 R11                   E32480
     I************                           12  12 R12                   E32480
     I************                           13  13 R13                   E32480
     I************DS                                                      E32480
     I************                            1   4 SRATE                 E32480
     I************                            1   1 SR1                   E32480
     I************                            2   2 SR2                   E32480
     I************                            3   3 SR3                   E32480
     I************                            4   4 SR4                   E32480
     I************                                                        E32480
     I**********************************************                      E32480
     I****DATA*STRUCTURE FOR COMMON REFERENCE      *                      E32480
     I**********************************************                      E32480
     I************DS                                                      E32480
     I************                            1  16 CR                    E32480
     I************                            1   4 CRBKC1                E32480
     I************                            5   6 CRLC1                 E32480
     I************                            7  10 CRRATE                E32480
     I************                           11  14 CRBKC2                E32480
     I************                           15  16 CRLC2                 E32480
     I*
     I**********************************************
     I*   DATA STRUCTURE TO ELIMINATE BLANK LINES  *
     I**********************************************
     IOFSPT       DS                            210
     I                                        1  35 OFSPT1
     I                                       36  70 OFSPT2
     I                                       71 105 OFSPT3
     I                                      106 140 OFSPT4
     I                                      141 175 OFSPT5
     I                                      176 210 OFSPT6
     I*
     I**********************************************
     I*       DATA STRUCTURE USED IN THE EVENT     *
     I*                    OF DATABASE ERRORS.     *
     I**********************************************
     I*
     IDLDA        DS                            256
     I**************************************134 138 DBFILE                S01194
     I**************************************139 167 DBKEY                 S01194
     I**************************************168 175 DBPGM                 S01194
     I**************************************176 177 DBASE                 S01194
     I                                      134 141 DBFILE                S01194
     I                                      142 170 DBKEY                 S01194
     I                                      171 180 DBPGM                 S01194
     I                                      181 1830DBASE                 S01194
     I*
     I**********************************************
     I****DATA*STRUCTURE*USED*IN*UPDATING*OTHER*   *                      S01310
     I****MESSAGES*COUNT*IN*DATA*AREA*MSFCTL*.*    *                      S01310
     I**********************************************
     I***********                                                         S01310
     I*DFCTL*****  DS                            256                  EFIXS01310
     I***********                         P  91  930DFOMC                 S01310
     I***********                         P  94  960DFOTL             EFIXS01310
     I*
     I**********************************************
     I*       DATA STRUCTURE - PROGRAM STATUS      *
     I**********************************************
     I*
     IPSDS       SDS
     I                                        1  10 ##PGM                 S01435
     I                                      254 263 USRID
     I                                      244 253 WJOBNM                                    CSC022
     I*
     I*********************************************
     I*       DATA STRUCTURE TO PROVIDE TEXT      *
     I*            ON COMIT ENTRY IN JOURNAL.     *
     I*********************************************
     I*
     ICMTTXT      DS                            160
     I                                        1   50NATN
     I                                        6   7 MDID
     I                                        8  15 PGMN
     I                                       16  18 WSIDX
     I                                       19  240MTIME
     I                                       25  25 ACTION
     I                                       26  35 USRIDX
     I                                       56  60 INFO1
     I                                       61  69 INFO2
     I*********************************************                       S01310
     I********DATA STRUCTURE TO CONTAIN           *                       S01310
     I************ HEX FIELDS                     *                       S01310
     I*********************************************                       S01310
     I************                                                        S01310
     I************DS                                                      S01310
     I************                        B   1   20B0D                   S01310
     I************                            2   2 X0D                   S01310
     I************                        B   3   40B25                   S01310
     I************                            4   4 X25                   S01310
     I************                        B   5   60B01                   S01310
     I************                            6   6 X01                   S01310
     I************                        B   7   80B03                   S01310
     I************                            8   8 X03                   S01310
     I************                            9  10 X0D25                 S01310
     I*
     I                                        1  12 CSID                  S01310
     I                                        9  11 @BIC                  S01310
      **  Data structure to test for BIC code                             S01310
      *                                                                   S01310
     IMULT        DS                         95                           S01310
     I                                        1   5 MTAG                  S01310
     I                                        6  55 MFLD                  S01310
      **  Multiple occurrence data structure for message                  S01310
      *                                                                   S01310
     I@MTAG       DS                          5                           S01310
     I                                        1   1 COLON1                S01310
     I                                        2   3 FLDNO                 S01310
     I                                        4   4 TAG                   S01310
     I                                        5   5 COLON2                S01310
      **  Data structure constructing message field tag                   S01310
      *                                                                   S01310
     IFLD32       DS                         24                           S01310
     I**********                              1   6 DATE                             S01310 MD033624
     I                                        1   6 FDATE                                   MD033624
     I                                        7   9 CCY32                 S01310
     I                                       10  24 AMNT32                S01310
      **  Data structure containing codeword for field 32.                S01310
      *                                                                   S01310
     I**  Data structure to split the full nostro number                  S01117
     I*                                                                   S01117
     IDST1        DS                             35                       S01117
     I/COPY WNCPYSRC,FT0645I006
     I                                        4   5 NOSTN                 S01117
     I*  DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
     ICPYR@#      DS
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
      *                                                                   CEU006
      * Field :72: data structure - Original Currency & Amount            CEU006
     IOCMT        DS                             35                       CEU006
     I I            '/OCMT/'                  1   6 O#CDWD                CEU006
     I                                        7   9 O#CCY                 CEU006
     I                                       10  24 O#AMNT                CEU006
     I                                        1  24 O#OCMT                149197
      *                                                                   CEU006
      * Field :72: data structure - Charges                               CEU006
     ICHGS        DS                             35                       CEU006
     I I            '/CHGS/'                  1   6 C#CDWD                CEU006
     I                                        7   9 C#CCY                 CEU006
     I                                       10  24 C#AMNT                CEU006
     I                                        1  24 C#CHGS                151235
     I*
      *                                                                   S01408
     I/COPY WNCPYSRC,FT0645IIP1                                           S01408
      *                                                                   S01408
      *                                                                   S01310
     ISDNOST    E DSSDNOSTPD                                                                  CSW209
      ** Calling parameter data structure for Nostro file                                     CSW209
      *                                                                                       CSW209
     ISDBANK    E DSSDBANKPD                                                                  CSW209
      ** Data Structure for Bank ICD                                                          CSW209
      *                                                                                       CSW209
     ISDCUST    E DSSDCUSTPD                                              S01310
      **  External Data structure for customer details.                   S01310
      *                                                                   S01310
     ISDMMOD    E DSSDMMODPD                                              S01310
      **  External Data structure for module ICD file.                    S01310
      *                                                                   S01310
     ISDMGME    E DSSDMGMEPD                                              S01310
      **  Data structure for MESSAGE MANAGEMENT file                      S01310
      *                                                                   S01310
     ISDCURR    E DSSDCURRPD                                              S01117
      **  Data structure for CURRENCIES file                              S01117
      *                                                                   S01117
     ISDCNST    E DSSDCNSTPD                                              S01435
      *                                                                   S01435
      *  Calling parameter data structure for ME1400                      S01435
      *                                                                   CFT014
     IMEOUFM    E DSMEOUFMPD                                                                  CSW209
      ** Calling parameter data structure for MEOUFMPD file                                   CSW209
      *                                                                                       CSW209
     IOACCNT    E DSACCNTAB                                                                   CSW209
     I              LCD                             XXLCD                                     CSW209
      *                                                                                       CSW209
      ** Calling parameter data structure for ACCNTAB File                                    CSW209
      *                                                                                       CSW209
     ISDGELR    E DSSDGELRPD                                              CFT014
     I              QQACCD                          GEACCD                                    CSW209
      ** Data structure for GL ICD                                        CFT014
      *                                                                   S01435
     IMEBICD    E DSMEBICDPD                                              S01435
      *                                                                   S01435
      *  Calling parameter data structure for ME1400                      S01435
      *                                                                                       CSW202
     IMEBEIS    E DSMEBEISPD                                                                  CSW202
      ** Data structure for BEI master file                                                   CSW202
      *                                                                   S01435
     ISDCTRY    E DSSDCTRYPD                                                                  CSW209
      *                                                                                       CSW209
      ** COUNTRY CODES DATA STRUCTURE                                                         CSW209
      *                                                                                       CSW209
     I/COPY WNCPYSRC,FTH00297
      /EJECT                                                              S01435
     IW8FT        DS                            128                       S01435
      *                                                                   S01435
      * Address data structure                                            S01435
      *                                                                   S01435
      * Currency                                                          S01435
     I                                        1   3 W8CCY                 S01435
      * Settlement Type                                                   S01435
     I                                        4   5 W8STMT                S01435
      * Mandatory Text - convert BIC identifiers                          S01435
     I                                        6   6 W8MTXT                S01435
      * Message Tag                                                       S01435
     I                                        7  11 W8MTAG                S01435
      * Construct of data in field                                        S01435
     I                                       12  12 W8TYPE                S01435
      * Number of Lines available                                         S01435
     I                                       13  140W8NLIN                S01435
      * Network and Message Type                                          S01435
     I                                       15  20 W8NWRK                S01435
     I                                       21  23 W8MTPY                S01435
      * Calling Program                                                   S01435
     I                                       24  33 W8CPGM                S01435
      * Action *PRINT/*ENQ/*MSG GEN                                       S01435
     I                                       34  41 W8ACT                 S01435
      * Critical reporting - Database error if 'Y'                        S01435
      * If no BIC directory and BIC entered no error                      S01435
     I                                       42  42 W8CRIT                S01435
      * Force Midas Address - where possible                              S01435
     I                                       43  43 W8MADD                S01435
      * If Retail get first address from account                          S01435
     I                                       44  44 W8RTAD                S01435
      * Alternative Address                                               S01435
     I                                       45  45 W8ALTN                S01435
      * Address type selected in W0MSG                                    S01435
     I                                       46  46 W8ADTP                S01435
     I/COPY WNCPYSRC,FT0645I003
      *                                                                   S01435
     I/COPY FTCPYSRC,SFTADDRI                                             S01435
      *                                                                   S01435
      * Address data structure                                            S01435
      *                                                                   S01435
     IDSFDY     E DSDSFDY                                                 S01310
      **  Short data structure for access programs                        S01310
      *                                                                   S01310
     IDSSDY     E DSDSSDY                                                 S01310
      **  Long data structure for access programs                         S01310
      *                                                                   S01310
     IDSLDY     E DSDSLDY                                                                     CSW209
      ** Third Data Structure for Access Programs                                             CSW209
      *                                                                                       CSW209
     IWLTDS     E DSSDWLTOPD                                                                  CSD015
      ** DS For Watch List Transaction Details File                                           CSD015
      *                                                                                       CSD015
     IPSTRNG      DS                           9999                                           CSD015
      *                                                                                       CSD015
     ISDWLCC    E DSSDWLCCPD                                                                  222385
      ** Watch list checking details                                                          222385
      *                                                                                       222385
      * External data structure - SAR details                             CEU006
     ISCSARD    E DSSCSARDPD                                              CEU006
     I/COPY WNCPYSRC,FT0645I005
      ** Action Constant for AOOUFMR0                                                         CSW209
      *                                                                                       CSW209
     I              'ACOUNTLINE'          C         CACNT1                                    CSW209
     I              'ACOUNTIBAN'          C         CACNT2                                    CSW209
      *                                                                                       CSW218
      ** Midas MG Get UUID                                                                    CSW218
      *                                                                                       CSW218
     I              'MGC001802'           C         UIDPGM                                    CSW218
      *                                                                   CEU006
      **                                                                                      CSC022
     ISCCMT       DS                            256                                           CSC022
     I                                        1   30WCMTNO                                    CSC022
     I                                        4 103 WCJOBS                                    CSC022
      ** Commitment Control dataarea                                                          CSC022
      **                                                                                      CSC022
     I/COPY WNCPYSRC,HUT110_038                                                               HUT110
     I/EJECT
     C                     MOVEACPY@      BIS@   80
     C           *LIKE     DEFN OPPARM    IPPARM
     C******************************                                      S01310
     C*****KEY*LIST*****PARAMETERS *                                      S01310
     C******************************                                      S01310
     C***********CUSKEY****KLIST                                          S01310
     C*********************KFLD           KCUSNO                          S01310
     C*********************KFLD           KEYA                            S01310
     C*
     C***                                                                 071383
     C***    KLIST FOR KEY TO  - PF/CQPAC                                 071383
     C***                                                                 071383
     C           KCQPAC    KLIST                                          071383
     C                     KFLD           PREF                            071383
     C                     KFLD           WCQSQ   20                      071383
     C*
     C/COPY WNCPYSRC,FT0645C041
     C******************************
     C*    INPUT OUTPUT PARAMETERS *
     C******************************
     C           *ENTRY    PLIST
     C                     PARM           IPPARM
     C                     PARM           OPPARM
     C                     PARM           RSEQ                            S01117
      *                                                                                       CSW209
     C           PLOUFM    PLIST                                                              CSW209
     C                     PARM *BLANKS   @RTRN   7                                           CSW209
     C                     PARM '*KEY   ' @OPTN                                               CSW209
     C                     PARM           @NTWRK  6                                           CSW209
     C                     PARM           @MSGTP  3                                           CSW209
     C                     PARM           @MSGTG  5                                           CSW209
     C                     PARM           BRCA4A  4                                           CSW209
     C                     PARM           CTRY4A  4                                           CSW209
     C                     PARM           WCCY                                                CSW209
     C                     PARM           @NOSTN  2                                           CSW209
     C                     PARM           @ACTNF 10                                           CSW209
     C           MEOUFM    PARM *BLANKS   DSFDY                                               CSW209
     C*
     C***********************
     C*    FIRST CYCLE.     *
     C***********************
     C*
     C  N40                EXSR FIRST
     C*
     C/EJECT
     C*
     C****************************
     C*    DETAIL PROCESSING.    *
     C****************************
     C/COPY WNCPYSRC,FT0645C039
     C*
     C*************************************************
     C*    RECORD READ FROM OYPAYDD VIA LOGICAL PRPF2 *
     C*************************************************
      *                                                                   S01310
     C                     MOVEL'N'       WERROR  1                                           222239
     C                     MOVELCHTP      @CHG    1                                           CSW025
      *                                                                                       CSW025
      ** Initialise non-constant fields                                   S01310
      *                                                                   S01310
     C                     EXSR INTF                                      S01310
     C*
     C                     EXSR BRANCH                                    S01117
     C*  KEEP TALLY OF NUMBER OF RECORDS READ FROM LF/PRFP2
     C*********************ADD  1         P3NO1                           S01117
     C                     ADD  1         AUNO1                           S01117
     C*
     C************         SETOF                     26                   S01310
     C*
     C           *IN01     IFEQ '1'
     C*
     C/COPY WNCPYSRC,FT0645CP17                                           S01408
      *                                                                                       CSW209
      ** Field :119: - Block 3 Data                                                           CSW209
      *                                                                                       CSW209
     C           CSW209    IFEQ 'Y'                                                           CSW209
     C           PREF      CHAINOTPAYXL0             25                                       CSW209
     C           *IN25     IFEQ *ON                                                           CSW209
     C                     MOVEL'OTPAYXL0'DBFNAM                                              CSW209
     C                     MOVELPREF      DBERKY                                              CSW209
     C                     MOVE '40'      DBERR#                                              CSW209
     C                     EXSR DBERR                                                         CSW209
     C                     ELSE                                                               CSW209
     C           OPOMVF    IFEQ 'COV'                                                         CSW209
     C                     SETON                     29                                       CSW209
     C                     MOVEL'COV'     M1BLK3                                              CSW209
     C                     ELSE                                                               CSW209
     C                     SETOF                     29                                       CSW209
     C                     ENDIF                                                              CSW209
     C                     ENDIF                                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW218
      ** Field :121: - UETR (Unique End-to-end Transaction Reference)                         CSW218
      *                                                                                       CSW218
     C                     MOVEL'N'       WCTR    1                                           CSW218
     C           CSW218    IFEQ 'Y'                                                           CSW218
      *                                                                                       CSW218
      ** Check if transaction is generated by Incoming message                                CSW218
      *                                                                                       CSW218
     C                     MOVEL*BLANKS   PUUID                                               CSW218
     C                     MOVEL'121:'    WTAG12                                              CSW218
     C           OPMSGR    IFNE 0                                                             CSW218
     C           KYINCM    CHAINMEINDTL0             98                                       CSW218
     C           *IN98     IFEQ *OFF                                                          CSW218
     C                     MOVELDTMFLD    PUUID                                               CSW218
     C                     ENDIF                                                              CSW218
     C                     ENDIF                                                              CSW218
      *                                                                                       CSW218
     C           PUUID     IFEQ *BLANKS                                                       CSW218
     C                     CALL UIDPGM                                                        CSW218
     C                     PARM *BLANKS   PUUID  50                                           CSW218
     C                     ENDIF                                                              CSW218
      *                                                                                       CSW218
     C                     Z-ADD1         Q                                                   CSW218
     C           Q         OCUR MULT                                                          CSW218
     C                     MOVEL':121:'   MTAG                                                CSW218
     C                     MOVELPUUID     MFLD                                                CSW218
     C                     MOVEL'Y'       WCTR                                                CSW218
      *                                                                                       CSW218
     C                     ENDIF                                                              CSW218
     C*
      *                                                                   S01310
      ** Field :20: - Transaction Reference Number.                       S01310
      *                                                                   S01310
     C           WCTR      IFEQ 'Y'                                                           CSW218
     C                     ADD  1         Q                                                   CSW218
     C                     ELSE                                                               CSW218
     C                     Z-ADD1         Q                               S01310
     C                     ENDIF                                                              CSW218
     C/COPY WNCPYSRC,FT0645C019
     C           Q         OCUR MULT                                      S01310
     C                     MOVEA*BLANKS   @WRK                            S01310
      *                                                                   S01310
     C                     MOVEL':20:'    MTAG                            S01310
     C                     MOVEA'FT'      @WRK                            S01310
     C                     MOVEAPREF      @HLD                            S01310
     C           FULLRF    IFEQ 'Y'                                                        BUG15044A
     C                     MOVEA@HLD,1    @WRK,1                                           BUG15044A
     C                     ELSE                                                            BUG15044A
     C                     MOVEA@HLD,2    @WRK,3                          S01310
     C                     ENDIF                                                           BUG15044A
     C                     MOVEA@WRK      MFLD                            S01310
      *                                                                   S01310
      ** Save the transaction Reference Number.                           S01310
      *                                                                   S01310
     C                     MOVELMFLD      TRNA   16                       S01310
     C/COPY WNCPYSRC,FT0645C005
      *                                                                   S01310
      ** Field :21: - Related Reference.                                  S01310
      *                                                                   S01310
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     MOVEL':21:'    MTAG                            S01310
     C           RLPR      IFEQ *BLANK                                    058745
     C                     MOVEL'NONREF'  MFLD                            S01310
     C                     ELSE                                           058745
     C                     MOVELRLPR      MFLD                            058745
     C                     END                                            058745
      *                                                                   S01310
      ** Field 32A - Value Date,Currency Code and Amount.                 S01310
      *                                                                   S01310
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
      *                                                                   058476
      *  Clear data structure to prevent old data being output.           058476
      *                                                                   058476
     C                     MOVEL*BLANKS   FLD32                           058476
      *                                                                   058476
     C                     MOVEL':32A:'   MTAG                            S01310
      * Value Date.                                                       S01310
     C**********           MOVE PVDTD3    DATE    6                                  S01310 MD033624
     C                     MOVE PVDTD3    FDATE                                             MD033624
      * Currency.                                                         S01310
     C*********************MOVE PCCY      CCY32                     S01310S01117
     C*  FORMAT THE AMOUNT                                                S01310
     C                     EXSR SR06                                      S01310
     C                     MOVE M1RCCY    CCY32                           S01117
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0645CP18                                           S01408
     C*                                                                   S01408
     C                     MOVEASAM       FAMT                            S01310
     C                     Z-ADD1         S       30                      S01310
     C           FAMT,S    DOWEQ' '                                       S01310
     C                     ADD  1         S                               S01310
     C                     END                                            S01310
     C                     MOVEAFAMT,S    AMNT32                          S01310
      *                                                                   S01310
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0645CP19                                           S01408
     C*                                                                   S01408
     C                     MOVELFLD32     MFLD                            S01310
      *                                                                   CEU006
      * Reset /OCMT/ AND /CHGS/ fields                                    CEU006
     C                     MOVE *BLANKS   O#CCY                           CEU006
     C                     MOVE *BLANKS   O#AMNT                          CEU006
     C                     MOVE *BLANKS   C#CCY                           CEU006
     C                     MOVE *BLANKS   C#AMNT                          CEU006
      *                                                                   CEU006
      * Set up Original Currency/Amount and Charges fields for            CEU006
      * field :72: if EMU Settlement on and Pay Delivery Amount           CEU006
      * entered                                                           CEU006
     C           CEU006    IFEQ 'Y'                                       CEU006
     C           PDAM      ANDNE0                                         CEU006
      *                                                                   CFT014
      ** Pay Delivery ccy details                                         CFT014
     C                     CALL 'AOCURRR0'                                CFT014
     C                     PARM *BLANKS   WRTCD                           CFT014
     C                     PARM '*KEY   ' WOPTN                           CFT014
     C                     PARM PDCY      WCCY    3                       CFT014
     C           SDCURR    PARM SDCURR    DSSDY                           CFT014
     C           WRTCD     IFEQ *BLANKS                                   CFT014
     C                     MOVE A6INCY    WINCY1  1                       CFT014
     C                     Z-ADDA6TPSD    WTPSD1  50                      CFT014
     C                     ELSE                                           CFT014
     C                     MOVE '37'      DBERR#           ************   CFT014
     C                     MOVELPDCY      DBERKY           * DBERR037 *   CFT014
     C                     MOVEL'SDCURRPD'DBFNAM           ************   CFT014
     C                     EXSR DBERR                                     CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Pay ccy details                                                  CFT014
     C                     CALL 'AOCURRR0'                                CFT014
     C                     PARM *BLANKS   WRTCD                           CFT014
     C                     PARM '*KEY   ' WOPTN                           CFT014
     C                     PARM PCCY      WCCY                            CFT014
     C           SDCURR    PARM SDCURR    DSSDY                           CFT014
     C           WRTCD     IFEQ *BLANKS                                   CFT014
     C                     MOVE A6INCY    WINCY2  1                       CFT014
     C                     Z-ADDA6TPSD    WTPSD2  50                      CFT014
     C                     ELSE                                           CFT014
     C                     MOVE '38'      DBERR#           ************   CFT014
     C                     MOVELPCCY      DBERKY           * DBERR038 *   CFT014
     C                     MOVEL'SDCURRPD'DBFNAM           ************   CFT014
     C                     EXSR DBERR                                     CFT014
     C                     ENDIF                                          CFT014
      ** If Pay Delivery Currency is an 'In' Currency                     CFT014
      **    and Pay Currency is Euro                                      CFT014
      **    and 'In' Currency start date <= Pay Value date                CFT014
      ** Or Pay Delivery Currency is Euro                                 CFT014
      **    and Pay Currency is an 'In' Currency                          CFT014
      **    and 'In' Currency start date <= Pay Value date                CFT014
      *                                                                   CFT014
     C           WINCY1    IFEQ 'Y'                                       CFT014
     C           PCCY      ANDEQBKEURO                                    CFT014
     C           WTPSD1    ANDLEPVDT                                      CFT014
     C           WINCY2    OREQ 'Y'                                       CFT014
     C           PDCY      ANDEQBKEURO                                    CFT014
     C           WTPSD2    ANDLEPVDT                                      CFT014
     C                     EXSR ERI                                       CEU006
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CEU006
      *                                                                   S01310
     C*
     C** SETUP PARAMETERS  AND EXECUTE SR01 TO
     C** DETERMINE SWIFT ADDRESS OF RECEIVING BANK
     C*
     C/COPY WNCPYSRC,FT0645C031
     C                     MOVELDSTT      ISPTP   1
     C                     MOVELDST1      ISPTY1 35
     C                     MOVE DST2      ISPTY2 35
     C                     MOVE DST3      ISPTY3 35
     C                     MOVE DST4      ISPTY4 35
     C/COPY WNCPYSRC,FT0645C032
     C                     MOVE *BLANKS   ISPTY5 35
     C                     MOVE PCCY      ISCCY   3
     C                     MOVE 'A'       IVTAG1  1
     C                     MOVE ' '       IVTAG2  1
      *                                                                                      260987A
     C           DSTT      IFEQ 'A'                                                          260987A
     C                     MOVE 'D'       IVTAG3  1                                          260987A
     C                     ELSE                                                              260987A
     C                     MOVE ' '       IVTAG3  1
     C                     ENDIF                                                             260987A
      *                                                                                      260987A
     C*
     C* SETON INDICATOR FOR SUBSEQUENT BLOCK OF SWFT CALL FOR
     C* DETAIL FIELD ADDRESSES(RATHER THAN DESTINATION ADDRESS)
     C*
     C                     SETON                     20
     C*
     C                     EXSR SR01
     C*********PARAMETERS*OFSPT1*SHOULD*BE*MOVED*TO********************                      260987A
     C*********FIELD*RECIPIENT*ADDRESS*OF*SWIFT*DATA*STRUCTURE*********                      260987A
     C*********SAVE*IT*AS*IT*WILL*BE*USED*IN*SUBROUTINE*10*&*4.********                      260987A
     C**********           MOVELOFSPT1    RECADD 12                                          260987A
      *                                                                                      260987A
      ** Output same destination to printout as MGOREFPD.                                    260987A
      *                                                                                      260987A
     C                     MOVELNWDS      RECADD 12                                          260987A
      *                                                                   S01310
      ** Move the new fields into the old field  names to ensure          S01310
      ** program continuity.                                              S01310
      *                                                                   S01310
     C                     MOVELBBCUST    CUSTNO                          S01310
     C                     MOVELBBCRTN    CTWN                            S01310
     C                     MOVELBBCRNM    CRNM                            S01310
     C* ****** SAVE CUSTOMER FIELDS TO BE USED IN SUBROUTINE 8.****
     C**********           MOVE CUSTNO    SCUSNO  60                                          CSD027
     C                     MOVE CUSTNO    SCUSNO  6                                           CSD027
     C                     MOVE CTWN      SCTWN  10
     C                     MOVE CRNM      SCRNM  20
     C                     MOVE SWTX      SWTWRK  1
     C*
     C***USE*SWIFT*OR*TELEX*ADDRESS*FOR*SENDERS*TID*DEPENDING*ON*THE***                      260987A
     C***ROUTING*INDICATOR*********************************************                      260987A
     C********** SWTX      IFEQ 'T'                                                          260987A
     C**********           MOVE MXOTLX    MXOTID 12                                          260987A
     C***********          SETON                     26                   S01310
     C**********           ELSE                                                              260987A
     C**********           MOVE MXOSFT    MXOTID                                             260987A
     C**********           END                                                               260987A
      *                                                                                      260987A
      ** Sender's address on printout to be same as output to MGOREFPD.                      260987A
      *                                                                                      260987A
     C                     MOVELNWSN      MXOTID 12                                          260987A
     C/COPY WNCPYSRC,FT0645C033
     C*
     C***IF*THE*SWIFT UNDER FLAG = 'N' FROM SUBROUTINE SR01               S01310
     C***THEN*THE MESSAGE MUST BE SENT VIA TELEX                          S01310
     C*
      *                                                                   S01310
      ** If the swift user flag = 'N' from subroutine SR01                S01310
      ** then the message is a paper message and is printed out.          S01310
      ** A record is still written to PF/MGOMSGPD and PF/MGOREFPD.        S01310
      *                                                                   S01310
     C           OSUFLG    IFEQ 'N'
     C*                                                                   S01117
     C* IF MULTIBRANCHING INDICATOR ACTIVE,MOVE BOOKING BRANCH AND        S01117
     C* BRANCH NAME TO THE RELATIVE FIELDS SET UP WITHIN THE PRINTER FILE S01117
     C*                                                                   S01117
     C           *IN50     IFEQ '1'                                       S01117
     C                     MOVE BRCAA     P2BRCA                          S01117
     C                     MOVELBRNM      P2BRNM                          S01117
     C                     END                                            S01117
     C* ****** FORMAT RECEIVING BANK FROM DESTINATION FIELDS ******
     C                     MOVELDSTT      ISPTP
     C                     MOVELPCCY      ISCCY                           S01435
     C                     MOVELDST1      ISPTY1
     C                     MOVELDST2      ISPTY2
     C                     MOVELDST3      ISPTY3
     C                     MOVELDST4      ISPTY4
     C                     MOVELPCCY      ISCCY
     C*
     C                     EXSR SR05
     C*
     C* ****** MOVE FORMATTED RECEIVING BANK. FIELDS INTO  **
     C* ****** DESTINATION FIELD PRINT LINE                **
     C                     MOVELOFSPT1    P2DST1
     C                     MOVELOFSPT2    P2DST2
     C                     MOVELOFSPT3    P2DST3
     C                     MOVELOFSPT4    P2DST4
     C                     MOVELOFSPT5    P2DST5
     C*
     C* ****** FORMAT RECEIVERS CORRESPONDENT        ******
     C                     MOVELRCRT      ISPTP
     C                     MOVELPCCY      ISCCY                           S01435
     C                     MOVELRCO1      ISPTY1
     C                     MOVELRCO2      ISPTY2
     C                     MOVELRCO3      ISPTY3
     C                     MOVELRCO4      ISPTY4
     C                     MOVELRCO5      ISPTY5
     C                     EXSR SR05
     C* ****** MOVE FORMATTED RECEIVERS CORR. FIELDS INTO PRINT LINE**
     C                     MOVELOFSPT1    P2RCR1
     C                     MOVELOFSPT2    P2RCR2
     C                     MOVELOFSPT3    P2RCR3
     C                     MOVELOFSPT4    P2RCR4
     C                     MOVELOFSPT5    P2RCR5
     C*
     C* ****** FORMAT ACCOUNT WITH BANK              ******
     C                     MOVELACBT      ISPTP
     C                     MOVELPCCY      ISCCY                           S01435
     C                     MOVELACB1      ISPTY1
     C                     MOVELACB2      ISPTY2
     C                     MOVELACB3      ISPTY3
     C                     MOVELACB4      ISPTY4
     C                     MOVELACB5      ISPTY5
     C                     EXSR SR05
     C* ****** MOVE FORMATTED ACCNT WITH BANK FIELDS INTO PRINT LINE**
     C                     MOVELOFSPT1    P2AWB1
     C                     MOVELOFSPT2    P2AWB2
     C                     MOVELOFSPT3    P2AWB3
     C                     MOVELOFSPT4    P2AWB4
     C                     MOVELOFSPT5    P2AWB5
     C*
     C* ****** FORMAT BENEFICIARY CUSTOMER           ******
     C                     MOVELBNCT      ISPTP
     C                     MOVELPCCY      ISCCY                           S01435
      *****************************************************************               238256 238256A
      ***If*Receiver's*Correspondent*does*not*start*with*'/',*not*an***               238256 238256A
      ***account*so*do*not*copy****************************************               238256 238256A
      *****************************************************************               238256 238256A
     C**********           Z-ADD*ZERO     SLSLOC  30                                  238256 238256A
     C********** '/'       CHECKRCO1      SLSLOC                                      238256 238256A
     C********** SLSLOC    IFEQ 1                                                     238256 238256A
     C                     MOVELBNC1      ISPTY1
     C                     MOVELBNC2      ISPTY2
     C                     MOVELBNC3      ISPTY3
     C                     MOVELBNC4      ISPTY4
     C                     MOVELBNC5      ISPTY5
      *****************************************************************               238256 238256A
      ***Else*a*Retail*account*so*copy*to*first*line*of*:58:***********               238256 238256A
      *****************************************************************               238256 238256A
     C**********           ELSE                                                       238256 238256A
     C**********           MOVELRCO1      ISPTY1                                      238256 238256A
     C**********           MOVELBNC1      ISPTY2                                      238256 238256A
     C**********           MOVELBNC2      ISPTY3                                      238256 238256A
     C**********           MOVELBNC3      ISPTY4                                      238256 238256A
     C**********           MOVELBNC4      ISPTY5                                      238256 238256A
     C**********           ENDIF                                                      238256 238256A
     C                     EXSR SR05
     C*
     C*********_____________________________________________              E32481
     C*********IF*MT202*FIELD ON SCREEN IS 'Y' SEND AN MT202              E32481
     C*********---------------------------------------------              E32481
     C*********************                                               E32481
     C***********SNMT******IFEQ 'Y'                                       E32481
     C*********************CALL 'FTC0647'                                 E32481
     C*********************PARM           PREF                            E32481
     C*********************PARM           RSEQ                      S01117E32481
     C*********************END                                            E32481
     C*
     C* ****** MOVE FORMATTED BENEFICIARY CUST FIELDS INTO PRINT LINE**
     C                     MOVELOFSPT1    P2BC1
     C                     MOVELOFSPT2    P2BC2
     C                     MOVELOFSPT3    P2BC3
     C                     MOVELOFSPT4    P2BC4
     C                     MOVELOFSPT5    P2BC5
     C*
     C* ****** DETERMINE AMOUNT      ****
     C                     EXSR SR06
     C                     EXSR SRP2                       PRT TELX REPORT
     C*********************ELSE                            SWFT USER FLG=YS01310
     C                     END                                            S01310
     C*
      *                                                                   S01310
      ** To write a record to PF/MGOMSGPD and PF/MGOREFPD for every       S01310
      ** message processed.                                               S01310
      *                                                                   S01310
     C*  INTIALISE AND PRESET FIELDS IN DATA STRUCTURE
     C*  FOR SWIFT MESSAGES TYPE RECORDS
     C                     EXSR SR10
      *                                                                   S01310
      ** Field :52 : - Ordering Institution.                              S01310
      *                                                                   S01310
     C*
     C*  SETUP PARAMETERS AND EXECUTE SR01 TO
     C*  FORMAT THE ORDERING BANK
     C*
     C*
     C/COPY WNCPYSRC,FT0645CCP9                                           S01408
     C*
     C                     MOVELORBT      ISPTP            SETTLMT TYPE
     C                     MOVE *BLANKS   ISPTY1                          098103
     C                     MOVELORBK      ISPTY1           SETTLMT ADD1
     C                     MOVELORBB      ISBRCA  3                       S01435
     C*
     C/COPY WNCPYSRC,FT0645CP10                                           S01408
     C*
      *                                                                   055293
      * If ORBT is not a Retail or Nostro i.e. overriden then             055293
      * check if Ordering Institution Details from a Swift Msg exist      055293
      *                                                                   055293
      * If a thru payment do not override.                                S01435
      *                                                                   S01435
     C           ORBT      IFNE 'R'                                       055293
     C           ORBT      ANDNE'N'                                       055293
     C           OPMSGR    ORGT 0                                         S01435
     C/COPY WNCPYSRC,FT0645C035
      *                                                                   055293
     C           OPORBT    IFNE ' '                                       055293
     C                     MOVEL'Y'       @OTX    1                       055293
     C                     MOVELOPORBT    ISPTP                           055293
     C                     MOVELOPORB1    ISPTY1                          055293
     C                     MOVELOPORB2    ISPTY2                          055293
     C                     MOVELOPORB3    ISPTY3                          055293
     C                     MOVELOPORB4    ISPTY4                          055293
     C                     MOVELOPORB5    ISPTY5                          055293
     C                     END                                            055293
      *                                                                   055293
     C                     END                                            055293
      *                                                                   055293
      *  If new fields were read then use this data for S.W.I.F.T.        055293
      *                                                                   055293
     C           @OTX      IFNE 'Y'                                       055293
     C                     MOVE *BLANKS   ISPTY2           SETTLMT ADD2
     C                     MOVE *BLANKS   ISPTY3           SETTLMT ADD3
     C                     MOVE *BLANKS   ISPTY4           SETTLMT ADD4
     C                     MOVE *BLANKS   ISPTY5           SETTLMT ADD5
     C                     END                                            055293
      *                                                                   055293
     C                     MOVEL'N'       @OTX    1                       055293
     C*                                                                   055293
     C                     MOVE SMCY      ISCCY   3        CURRENCY
     C                     MOVE 'A'       IVTAG1  1        TAG IND 1
     C                     MOVE ' '       IVTAG2  1        TAG IND 2
     C                     MOVE 'D'       IVTAG3  1        TAG IND 3
     C*
     C* SET OFF INDICATOR FOR BLOCK OF SWFT CALL FOR DETAIL
     C* FIELD ADDRESS(RATHER THAN DESTINATION ADDRESS)
     C*
     C                     SETOF                     20
     C                     MOVE 'Y'       W201IN  1                                           CSW201
     C*
     C                     EXSR SR01
     C                     MOVE 'N'       W201IN                                              CSW201
      *                                                                   S01408
     C/COPY WNCPYSRC,FT0645CCP2                                           S01408
      *                                                                   S01408
     C                     MOVEL*BLANKS   ISBRCA                          S01435
     C*
     C******** MOVE FORMATTED ORDERING BANK FIELDS INTO DATA STRUCTRE**
     C*
     C                     MOVELOFSPT1    M1OBK1
     C                     MOVE OFSPT2    M1OBK2
     C                     MOVE OFSPT3    M2OBK3
     C                     MOVE OFSPT4    M2OBK4
     C                     MOVE OFSPT5    M2OBK5
     C*
     C           M1OBK1    IFNE *BLANK
     C           M1OBK2    ORNE *BLANK                                    EO89
     C           M2OBK3    ORNE *BLANK                                    EO89
     C           M2OBK4    ORNE *BLANK
     C           M2OBK5    ORNE *BLANK
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     MOVE OSTAG     M1OBTG
     C                     MOVEL'52'      FLDNO                           S01310
     C                     EXSR FSWAD                                     S01310
     C/COPY WNCPYSRC,FT0645C006
     C                     END                                            S01310
      *                                                                   S01408
     C/COPY WNCPYSRC,FT0645CCP3                                           S01408
      *                                                                   S01408
     C*********************MOVE ':52'     M1TG52                          S01310
     C*********************MOVE ':'       M1HYPH                          S01310
     C*********************MOVE X0D25     M1CRL9                          S01310
     C*********************END                                            S01310
     C***********M1OBK2****IFNE *BLANK                                    S01310
     C***********M2OBK3****ORNE *BLANK                                    S01310
     C***********M2OBK4****ORNE *BLANK                                    S01310
     C***********M2OBK5****ORNE *BLANK                                    S01310
     C*********************MOVE X0D25     M1CRLA                          S01310
     C*********************END                                            S01310
     C***********M2OBK3****IFNE *BLANK                                    S01310
     C***********M2OBK4****ORNE *BLANK                                    S01310
     C***********M2OBK5****ORNE *BLANK                                    S01310
     C*********************MOVE X0D25     M2CRL1                          S01310
     C*********************END                                            S01310
     C***********M2OBK4****IFNE *BLANK                                    S01310
     C***********M2OBK5****ORNE *BLANK                                    S01310
     C*********************MOVE X0D25     M2CRL2                          S01310
     C*********************END                                            S01310
     C***********M2OBK5****IFNE *BLANK                                    S01310
     C*********************MOVE X0D25     M2CRL3                          S01310
     C*********************END                                            S01310
      *                                                                   S01310
      ** Field :53 : - Senders Correspondant.                             S01310
      *                                                                   S01310
      *                                                                   S01408
     C/COPY WNCPYSRC,FT0645CCP4                                           S01408
      *                                                                   S01408
     C/COPY WNCPYSRC,HUT110_039                                                               HUT110
     C*
     C*  SETUP PARAMETERS AND EXECUTE SR01 TO
     C*  FORMAT THE SENDERS CORRESPONDENT
     C                     MOVELSNCT      ISPTP
     C                     MOVE *BLANKS   ISPTY1                          098103
     C                     MOVELSNCO      ISPTY1
     C                     MOVE *BLANKS   ISPTY2
     C                     MOVE *BLANKS   ISPTY3
     C                     MOVE *BLANKS   ISPTY4
     C                     MOVE *BLANKS   ISPTY5
     C                     MOVE PCCY      ISCCY
     C                     MOVE 'A'       IVTAG1            TAG IND 1
     C                     MOVE 'B'       IVTAG2            TAG IND 2
     C                     MOVE 'D'       IVTAG3            TAG IND 3
     C/COPY WNCPYSRC,FTH00298
     C/COPY WNCPYSRC,FT0645C038
     C*
     C* SET OFF INDICATOR FOR BLOCK OF SWFT CALL FOR DETAIL
     C* FIELD ADDRESS(RATHER THAN DESTINATION ADDRESS)
     C*
     C                     SETOF                     20
     C                     MOVE 'Y'       W201IN                                              CSW201
     C*
     C                     EXSR SR01
     C                     MOVE 'N'       W201IN                                              CSW201
      *                                                                                       CSW201
     C** Check to see if sender's correspondent is yourself.              180414
     C           OSTAG     IFEQ 'A'                                       180414
     C                     MOVELBBCSID    SCADD   6                       180414
     C                     MOVELMXOSFT    SNADD   6                       180414
     C           SCADD     IFEQ SNADD                                     180414
     C** Then sender's correspondent is yourself                          180414
     C                     MOVEL*BLANKS   OFSPT1                          180414
     C                     MOVEL*BLANKS   OFSPT2                          180414
     C                     MOVEL*BLANKS   OFSPT3                          180414
     C                     MOVEL*BLANKS   OFSPT4                          180414
     C                     MOVEL*BLANKS   OFSPT5                          180414
     C                     ENDIF                                          180414
     C                     ENDIF                                          180414
     C*                                                                   180414
     C***** MOVE FORMATTED SENDERS CORRESPONDENT FIELDS INTO DATA STRUCTRE
     C/COPY WNCPYSRC,FT0645C030
     C/COPY WNCPYSRC,HUT110_040                                                               HUT110
     C                     MOVE OSTAG     M2SCTT
     C                     MOVELOFSPT1    M2SCR1
     C                     MOVELOFSPT2    M2SCR2
     C                     MOVELOFSPT3    M2SCR3
     C                     MOVELOFSPT4    M3SCR4
     C                     MOVELOFSPT5    M3SCR5
     C/COPY WNCPYSRC,HUT110_041                                                               HUT110
     C/COPY WNCPYSRC,FT0645C003
     C           M2SCR1    IFNE *BLANK
     C           M2SCR2    ORNE *BLANK
     C           M2SCR3    ORNE *BLANK
     C           M3SCR4    ORNE *BLANK
     C           M3SCR5    ORNE *BLANK
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     MOVE OSTAG     M2SCTT
     C                     MOVEL'53'      FLDNO                           S01310
     C                     EXSR FSWAD                                     S01310
     C                     END                                            S01310
      *                                                                   S01408
     C/COPY WNCPYSRC,FT0645CCP5                                           S01408
     C/COPY WNCPYSRC,HUT110_042                                                               HUT110
      *                                                                   S01408
     C*********************MOVE X0D25     M2CRL4                          S01310
     C*********************MOVE ':53'     M2TG53                          S01310
     C*********************MOVE ':'       M2COLN                          S01310
     C*********************END                                            S01310
     C***********M2SCR2****IFNE *BLANK                                    S01310
     C***********M2SCR3****ORNE *BLANK                                    S01310
     C***********M3SCR4****ORNE *BLANK                                    S01310
     C***********M3SCR5****ORNE *BLANK                                    S01310
     C*********************MOVE X0D25     M2CRL5                          S01310
     C*********************END                                            S01310
     C***********M2SCR3****IFNE *BLANK                                    S01310
     C***********M3SCR4****ORNE *BLANK                                    S01310
     C***********M3SCR5****ORNE *BLANK                                    S01310
     C*********************MOVE X0D25     M2CRL6                          S01310
     C*********************END                                            S01310
     C***********M3SCR4****IFNE *BLANK                                    S01310
     C***********M3SCR5****ORNE *BLANK                                    S01310
     C*********************MOVE X0D25     M3CRL1                          S01310
     C*********************END                                            S01310
     C***********M3SCR5****IFNE *BLANK                                    S01310
     C*********************MOVE X0D25     M3CRL2                          S01310
     C*********************END                                            S01310
      *                                                                   S01310
      ** Field :54 : - Receivers  Correspondant.                          S01310
      *                                                                   S01310
     C*
     C*  SETUP PARAMETERS AND EXECUTE SR01 TO
     C*  FORMAT THE RECEIVERS CORRESPONDENT
     C                     MOVELRCRT      ISPTP
     C                     MOVELRCO1      ISPTY1
     C                     MOVELRCO2      ISPTY2
     C                     MOVELRCO3      ISPTY3
     C                     MOVELRCO4      ISPTY4
     C                     MOVELRCO5      ISPTY5
     C                     MOVE PCCY      ISCCY
     C                     MOVE 'A'       IVTAG1            TAG IND 1
     C                     MOVE 'B'       IVTAG2            TAG IND 2
     C                     MOVE 'D'       IVTAG3            TAG IND 3
     C*
     C* SET OFF INDICATOR FOR BLOCK OF SWFT CALL FOR DETAIL
     C* FIELD ADDRESS(RATHER THAN DESTINATION ADDRESS)
     C*
     C                     SETOF                     20
     C                     MOVE 'Y'       W201IN                                              CSW201
     C*
     C                     EXSR SR01
     C                     MOVE 'N'       W201IN                                              CSW201
      *                                                                                       CSW201
     C* ** MOVE FORMATTED RECEIVERS CORR. FIELDS INTO DATA STRUCTRE**
     C                     MOVELOFSPT1    M3RCR1
     C                     MOVELOFSPT2    M3RCR2
     C                     MOVELOFSPT3    M3RCR3
     C                     MOVELOFSPT4    M3RCR4
     C                     MOVELOFSPT5    M4RCR5
     C           M3RCR1    IFNE *BLANK
     C           M3RCR2    ORNE *BLANK
     C           M3RCR3    ORNE *BLANK
     C           M3RCR4    ORNE *BLANK
     C           M4RCR5    ORNE *BLANK
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     MOVE OSTAG     M3RCTT
     C                     MOVEL'54'      FLDNO                           S01310
     C                     EXSR FSWAD                                     S01310
     C                     END                                            S01310
     C*********************MOVE ':54'     M3TG54                          S01310
     C*********************MOVE ':'       M3COLN                          S01310
     C*********************MOVE X0D25     M3CRL3                          S01310
     C*********************END                                            S01310
     C***********M3RCR2****IFNE *BLANK                                    S01310
     C***********M3RCR3****ORNE *BLANK                                    S01310
     C***********M3RCR4****ORNE *BLANK                                    S01310
     C***********M4RCR5****ORNE *BLANK                                    S01310
     C*********************MOVE X0D25     M3CRL4                          S01310
     C*********************END                                            S01310
     C***********M3RCR3****IFNE *BLANK                                    S01310
     C***********M3RCR4****ORNE *BLANK                                    S01310
     C***********M4RCR5****ORNE *BLANK                                    S01310
     C*********************MOVE X0D25     M3CRL5                          S01310
     C*********************END                                            S01310
     C***********M3RCR4****IFNE *BLANK                                    S01310
     C***********M4RCR5****ORNE *BLANK                                    S01310
     C*********************MOVE X0D25     M3CRL6                          S01310
     C*********************END                                            S01310
     C***********M4RCR5****IFNE *BLANK                                    S01310
     C*********************MOVE X0D25     M4CRL1                          S01310
     C*********************END                                            S01310
      *                                                                   S01310
      ** Field :56 : - Intermediary.                                      S01310
      *                                                                   S01310
     C*
     C*  SETUP PARAMETERS AND EXECUTE SR01 TO
     C*  FORMAT THE INTERMEDIARY BANK
     C                     MOVELINBT      ISPTP
     C                     MOVELINB1      ISPTY1
     C                     MOVELINB2      ISPTY2
     C                     MOVELINB3      ISPTY3
     C                     MOVELINB4      ISPTY4
     C                     MOVELINB5      ISPTY5
     C                     MOVE PCCY      ISCCY
     C                     MOVE 'A'       IVTAG1            TAG IND 1
     C                     MOVE ' '       IVTAG2            TAG IND 2
     C                     MOVE 'D'       IVTAG3            TAG IND 3
     C*
     C* SET OFF INDICATOR FOR BLOCK OF SWFT CALL FOR DETAIL
     C* FIELD ADDRESS(RATHER THAN DESTINATION ADDRESS)
     C*
     C                     SETOF                     20
     C                     MOVE 'Y'       W201IN                                              CSW201
     C*
     C                     EXSR SR01
     C                     MOVE 'N'       W201IN                                              CSW201
      *                                                                                       CSW201
     C/COPY WNCPYSRC,FT0645C021
     C**** MOVE FORMATTED ACCOUNT WITH BANK FIELDS INTO DATA STRUCTRE**
     C                     MOVELOFSPT1    M4IBK1
     C                     MOVELOFSPT2    M4IBK2
     C                     MOVELOFSPT3    M4IBK3
     C                     MOVELOFSPT4    M4IBK4
     C                     MOVELOFSPT5    M4IBK5
     C           M4IBK1    IFNE *BLANK
     C           M4IBK2    ORNE *BLANK
     C           M4IBK3    ORNE *BLANK
     C           M4IBK4    ORNE *BLANK
     C           M4IBK5    ORNE *BLANK
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     MOVE OSTAG     M4IBKT
     C                     MOVEL'56'      FLDNO                           S01310
     C                     EXSR FSWAD                                     S01310
     C/COPY WNCPYSRC,FT0645C007
     C                     END                                            S01310
     C*********************MOVE ':56'     M4TG56                          S01310
     C*********************MOVE ':'       M4CLN1                          S01310
     C*********************MOVE X0D25     M4CRL2                          S01310
     C*********************END                                            S01310
     C***********M4IBK2****IFNE *BLANK                                    S01310
     C***********M4IBK3****ORNE *BLANK                                    S01310
     C***********M4IBK4****ORNE *BLANK                                    S01310
     C***********M4IBK5****ORNE *BLANK                                    S01310
     C*********************MOVE X0D25     M4CRL3                          S01310
     C*********************END                                            S01310
     C***********M4IBK3****IFNE *BLANK                                    S01310
     C***********M4IBK4****ORNE *BLANK                                    S01310
     C***********M4IBK5****ORNE *BLANK                                    S01310
     C*********************MOVE X0D25     M4CRL4                          S01310
     C*********************END                                            S01310
     C***********M4IBK4****IFNE *BLANK                                    S01310
     C***********M4IBK5****ORNE *BLANK                                    S01310
     C*********************MOVE X0D25     M4CRL5                          S01310
     C*********************END                                            S01310
     C***********M4IBK5****IFNE *BLANK                                    S01310
     C*********************MOVE X0D25     M5CRL6                          S01310
     C*********************END                                            S01310
      *                                                                   S01310
      ** Field :57 : - Account with Institution.                          S01310
      *                                                                   S01310
     C*
     C*  SETUP PARAMETERS AND EXECUTE SR01 TO
     C*  FORMAT THE ACCOUNT WITH BANK
     C                     MOVELACBT      ISPTP
     C                     MOVELACB1      ISPTY1
     C                     MOVELACB2      ISPTY2
     C                     MOVELACB3      ISPTY3
     C                     MOVELACB4      ISPTY4
     C                     MOVELACB5      ISPTY5
     C                     MOVE PCCY      ISCCY
     C                     MOVE 'A'       IVTAG1            TAG IND 1
     C                     MOVE 'B'       IVTAG2            TAG IND 2
     C                     MOVE 'D'       IVTAG3            TAG IND 3
     C*
     C* SET OFF INDICATOR FOR BLOCK OF SWFT CALL FOR DETAIL
     C* FIELD ADDRESS(RATHER THAN DESTINATION ADDRESS)
     C*
     C                     SETOF                     20
     C                     MOVE 'Y'       W201IN                                              CSW201
     C*
     C                     EXSR SR01
     C                     MOVE 'N'       W201IN                                              CSW201
      *                                                                                       CSW201
     C/COPY WNCPYSRC,FT0645C022
     C*                                                                   E21471
     C** DISPLAY CHAPS CODE.                                              E21471
     C*                                                                   E21471
     C           STMT      IFEQ 10                         B001           E21471
     C           CHAP      ANDNE0                                         E21471
     C           OSTAG     ANDNE'D'                                       E21471
     C           OFSPT1    ANDNE*BLANK                                    E21471
     C                     MOVE OFSPT4    OFSPT5                          E21471
     C                     MOVE OFSPT3    OFSPT4                          E21471
     C                     MOVE OFSPT2    OFSPT3                          E21471
     C                     MOVELOFSPT1    OFSPT2                          E21471
     C                     MOVE *BLANK    OFSPT1                          E21471
     C                     MOVEL'//SC'    @CHAP  10                       E21471
     C                     MOVE CHAP      @CHAP                           E21471
     C                     MOVEL@CHAP     OFSPT1                          E21471
     C                     END                             E001           E21471
     C/COPY WNCPYSRC,FT0645C029
     C*                                                                   E21471
     C**** MOVE FORMATTED ACCOUNT WITH BANK FIELDS INTO DATA STRUCTRE**
     C                     MOVE OSTAG     M5ABTT
     C                     MOVELOFSPT1    M5AWB1
     C                     MOVELOFSPT2    M5AWB2
     C                     MOVELOFSPT3    M5AWB3
     C                     MOVELOFSPT4    M5AWB4
     C                     MOVELOFSPT5    M5AWB5
     C           M5AWB1    IFNE *BLANK
     C           M5AWB2    ORNE *BLANK
     C           M5AWB3    ORNE *BLANK
     C           M5AWB4    ORNE *BLANK
     C           M5AWB5    ORNE *BLANK
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     MOVE OSTAG     M5ABTT
     C                     MOVEL'57'      FLDNO                           S01310
     C                     EXSR FSWAD                                     S01310
     C                     END                                            S01310
     C*********************MOVE ':57'     M5TG57                          S01310
     C*********************MOVE ':'       M5CLN1                          S01310
     C*********************MOVE X0D25     M5CRL1                          S01310
     C*********************END                                            S01310
     C***********M5AWB2****IFNE *BLANK                                    S01310
     C***********M5AWB3****ORNE *BLANK                                    S01310
     C***********M5AWB4****ORNE *BLANK                                    S01310
     C***********M5AWB5****ORNE *BLANK                                    S01310
     C*********************MOVE X0D25     M5CRL2                          S01310
     C*********************END                                            S01310
     C***********M5AWB3****IFNE *BLANK                                    S01310
     C***********M5AWB4****ORNE *BLANK                                    S01310
     C***********M5AWB5****ORNE *BLANK                                    S01310
     C*********************MOVE X0D25     M5CRL3                          S01310
     C*********************END                                            S01310
     C***********M5AWB4****IFNE *BLANK                                    S01310
     C***********M5AWB5****ORNE *BLANK                                    S01310
     C*********************MOVE X0D25     M5CRL4                          S01310
     C*********************END                                            S01310
     C***********M5AWB5****IFNE *BLANK                                    S01310
     C*********************MOVE X0D25     M5CRL5                          S01310
     C*********************END                                            S01310
      *                                                                   S01310
      ***Check*if*switchable*feature*CSW201*is*switched*on                             CSW201 CSW202
      *                                                                                       CSW201
     C**********           CALL 'SWIF2001'                                             CSW201 CSW202
     C**********           PARM           @RTCD                                        CSW201 CSW202
      *                                                                                       CSW201
     C********** @RTCD     IFEQ 'CSW2001'                                              CSW201 CSW202
     C**********           MOVE 'Y'       CSW201  1                                    CSW201 CSW202
     C**********           ELSE                                                        CSW201 CSW202
     C**********           MOVE 'N'       CSW201                                       CSW201 CSW202
     C**********           ENDIF                                                       CSW201 CSW202
      *                                                                                       CSW201
      ** Field :58 : - Beneficiary Institution.                           S01310
      *                                                                   S01310
     C*
     C*  SETUP PARAMETERS AND EXECUTE SR01 TO
     C*  FORMAT THE BENEFICIARY  BANK
     C                     MOVELBNCT      ISPTP
      *****************************************************************               238256 238256A
      ***If*Receiver's*Correspondent*does*not*start*with*'/',*not*an***               238256 238256A
      ***account*so*do*not*copy****************************************               238256 238256A
      *****************************************************************               238256 238256A
     C********** '/'       CHECKRCO1      SLSLOC                                      238256 238256A
     C********** SLSLOC    IFEQ 1                                                     238256 238256A
     C                     MOVELBNC1      ISPTY1
     C                     MOVELBNC2      ISPTY2
     C                     MOVELBNC3      ISPTY3
     C                     MOVELBNC4      ISPTY4
     C                     MOVELBNC5      ISPTY5
      *****************************************************************               238256 238256A
      ***Else*a*Retail*account*so*copy*to*first*line*of*:58:***********               238256 238256A
      *****************************************************************               238256 238256A
     C**********           ELSE                                                       238256 238256A
     C**********           MOVELRCO1      ISPTY1                                      238256 238256A
     C**********           MOVELBNC1      ISPTY2                                      238256 238256A
     C**********           MOVELBNC2      ISPTY3                                      238256 238256A
     C**********           MOVELBNC3      ISPTY4                                      238256 238256A
     C**********           MOVELBNC4      ISPTY5                                      238256 238256A
     C**********           ENDIF                                                      238256 238256A
      *****************************************************************               238256 238256A
     C                     MOVE PCCY      ISCCY
     C                     MOVE 'A'       IVTAG1            TAG IND 1
     C                     MOVE ' '       IVTAG2            TAG IND 2
     C                     MOVE 'D'       IVTAG3            TAG IND 3
      *                                                                   S01408
     C/COPY WNCPYSRC,FT0645CCP6                                           S01408
      *                                                                   S01408
     C*
     C* SET OFF INDICATOR FOR BLOCK OF SWFT CALL FOR DETAIL
     C* FIELD ADDRESS(RATHER THAN DESTINATION ADDRESS)
     C*
     C                     SETOF                     20
     C                     MOVE 'Y'       W201IN                                              CSW201
     C*
     C                     EXSR SR01
     C                     MOVE 'N'       W201IN                                              CSW201
     C*
     C*********_____________________________________________              E32481
     C*********IF*MT202*FIELD ON SCREEN IS 'Y' SEND AN MT202              E32481
     C*********---------------------------------------------              E32481
     C*********************                                               E32481
     C***********SNMT******IFEQ 'Y'                                       E32481
     C*********************CALL 'FTC0647'                                 E32481
     C*********************PARM           PREF                            E32481
     C*********************PARM           RSEQ                      S01117E32481
     C*********************END                                            E32481
      *                                                                   S01310
      ** Save the beneficiary customer number for output to PF/MGOREFPD.  S01310
      *                                                                   S01310
     C                     MOVELBBCUST    NWBN                            S01310
     C/COPY WNCPYSRC,FT0645C034
     C*                                                                   E21471
     C** DISPLAY CHAPS CODE.                                              E21471
     C*                                                                   E21471
     C           STMT      IFEQ 10                         B001           E21471
     C           CHAP      ANDNE0                                         E21471
     C           OSTAG     ANDNE'D'                                       E21471
     C           OFSPT1    ANDEQ*BLANK                                    E21471
     C                     MOVE OFSPT4    OFSPT5                          E21471
     C                     MOVE OFSPT3    OFSPT4                          E21471
     C                     MOVE OFSPT2    OFSPT3                          E21471
     C                     MOVELOFSPT1    OFSPT2                          E21471
     C                     MOVE *BLANK    OFSPT1                          E21471
     C                     MOVEL'//SC'    @CHAP  10                       E21471
     C                     MOVE CHAP      @CHAP                           E21471
     C                     MOVEL@CHAP     OFSPT1                          E21471
     C                     END                             E001           E21471
     C*
     C* ** MOVE FORMATTED BENEFICIARY  BANK FIELDS INTO DATA STRUCTRE**
     C*
     C/COPY WNCPYSRC,FT0645C028
     C                     MOVELOFSPT1    M5BBK1
     C                     MOVELOFSPT2    M6BBK2
     C                     MOVELOFSPT3    M6BBK3
     C                     MOVELOFSPT4    M6BBK4
     C                     MOVELOFSPT5    M6BBK5
      *                                                                   S01408
     C/COPY WNCPYSRC,FT0645CCP7                                           S01408
      *                                                                   S01408
     C           M5BBK1    IFNE *BLANK
     C           M6BBK2    ORNE *BLANK
     C           M6BBK3    ORNE *BLANK
     C           M6BBK4    ORNE *BLANK
     C           M6BBK5    ORNE *BLANK
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     MOVE OSTAG     M5BBTT
     C                     MOVEL'58'      FLDNO                           S01310
     C                     EXSR FSWAD                                     S01310
     C/COPY WNCPYSRC,FT0645C008
     C                     END                                            S01310
      *                                                                   S01408
     C/COPY WNCPYSRC,FT0645CCP8                                           S01408
      *                                                                   S01408
     C*********************MOVE X0D25     M5CRL6                          S01310
     C*********************MOVE ':58'     M5TG58                          S01310
     C*********************MOVE ':'       M5CLN2                          S01310
     C*********************END                                            S01310
     C***********M6BBK2****IFNE *BLANK                                    S01310
     C***********M6BBK3****ORNE *BLANK                                    S01310
     C***********M6BBK4****ORNE *BLANK                                    S01310
     C***********M6BBK5****ORNE *BLANK                                    S01310
     C*********************MOVE X0D25     M6CRL1                          S01310
     C*********************END                                            S01310
     C***********M6BBK3****IFNE *BLANK                                    S01310
     C***********M6BBK4****ORNE *BLANK                                    S01310
     C***********M6BBK5****ORNE *BLANK                                    S01310
     C*********************MOVE X0D25     M6CRL2                          S01310
     C*********************END                                            S01310
     C***********M6BBK4****IFNE *BLANK                                    S01310
     C***********M6BBK5****ORNE *BLANK                                    S01310
     C*********************MOVE X0D25     M6CRL3                          S01310
     C*********************END                                            S01310
     C***********M6BBK5****IFNE *BLANK                                    S01310
     C*********************MOVE X0D25     M6CRL4                          S01310
     C*********************END                                            S01310
      *                                                                   S01310
      ** Field :72: - Sender to Receiver Information.                     S01310
      *                                                                   S01310
     C*
     C* ** MOVE BANK TO BANK INFOS INTO DATA STRUCTURE **
     C                     MOVE *BLANKS   OFSPT
     C                     MOVE BBI1      OFSPT1
     C                     MOVE BBI2      OFSPT2
     C                     MOVE BBI3      OFSPT3
     C                     MOVE BBI4      OFSPT4
     C                     MOVE BBI5      OFSPT5
     C                     MOVE BBI6      OFSPT6
     C                     EXSR EMBLK
     C                     MOVELOFSPT1    M6BTB1
     C                     MOVELOFSPT2    M6BTB2
     C                     MOVELOFSPT3    M7BTB3
     C                     MOVELOFSPT4    M7BTB4
     C                     MOVELOFSPT5    M7BTB5
     C                     MOVELOFSPT6    M7BTB6
      *                                                                   CEU006
      * If /OCMT/ information is present, the Bank To Bank lines          CEU006
      * must be shifted down to accomodate it                             CEU006
     C           O#CCY     IFNE *BLANKS                                   CEU006
     C                     MOVE M7BTB5    M7BTB6                          CEU006
     C                     MOVE M7BTB4    M7BTB5                          CEU006
     C                     MOVE M7BTB3    M7BTB4                          CEU006
     C                     MOVE M6BTB2    M7BTB3                          CEU006
     C                     MOVE M6BTB1    M6BTB2                          CEU006
     C                     MOVE OCMT      M6BTB1                          CEU006
      *                                                                   CEU006
      * likewise for /CHGS/ (goes below /OCMT/)                           CEU006
     C           C#CCY     IFNE *BLANKS                                   CEU006
     C                     MOVE M7BTB5    M7BTB6                          CEU006
     C                     MOVE M7BTB4    M7BTB5                          CEU006
     C                     MOVE M7BTB3    M7BTB4                          CEU006
     C                     MOVE M6BTB2    M7BTB3                          CEU006
     C                     MOVE CHGS      M6BTB2                          CEU006
     C                     ENDIF                                          CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
     C           M6BTB1    IFNE *BLANK
     C           M6BTB2    ORNE *BLANK
     C           M7BTB3    ORNE *BLANK
     C           M7BTB4    ORNE *BLANK
     C           M7BTB5    ORNE *BLANK
     C           M7BTB6    ORNE *BLANK
     C           M6BTB1    IFNE *BLANKS                                   S01310
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     MOVEL':72:'    MTAG                            S01310
     C                     MOVELM6BTB1    MFLD                            S01310
     C                     END                                            S01310
     C           M6BTB2    IFNE *BLANKS                                   S01310
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     MOVELM6BTB2    MFLD                            S01310
     C                     END                                            S01310
     C           M7BTB3    IFNE *BLANKS                                   S01310
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     MOVELM7BTB3    MFLD                            S01310
     C                     END                                            S01310
     C           M7BTB4    IFNE *BLANKS                                   S01310
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     MOVELM7BTB4    MFLD                            S01310
     C                     END                                            S01310
     C           M7BTB5    IFNE *BLANKS                                   S01310
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     MOVELM7BTB5    MFLD                            S01310
     C                     END                                            S01310
     C           M7BTB6    IFNE *BLANKS                                   S01310
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     MOVELM7BTB6    MFLD                            S01310
     C                     END                                            S01310
     C/COPY WNCPYSRC,FT0645C009
     C                     END                                            S01310
     C*********************MOVE ':72:'    M6TG72                          S01310
     C*********************MOVE X0D25     M6CRL5                          S01310
     C*********************END                                            S01310
     C***********M6BTB2****IFNE *BLANK                                    S01310
     C***********M7BTB3****ORNE *BLANK                                    S01310
     C***********M7BTB4****ORNE *BLANK                                    S01310
     C***********M7BTB5****ORNE *BLANK                                    S01310
     C***********M7BTB6****ORNE *BLANK                                    S01310
     C*********************MOVE X0D25     M6CRL6                          S01310
     C*********************END                                            S01310
     C***********M7BTB3****IFNE *BLANK                                    S01310
     C***********M7BTB4****ORNE *BLANK                                    S01310
     C***********M7BTB5****ORNE *BLANK                                    S01310
     C***********M7BTB6****ORNE *BLANK                                    S01310
     C*********************MOVE X0D25     M7CRL1                          S01310
     C*********************END                                            S01310
     C***********M7BTB4****IFNE *BLANK                                    S01310
     C***********M7BTB5****ORNE *BLANK                                    S01310
     C***********M7BTB6****ORNE *BLANK                                    S01310
     C*********************MOVE X0D25     M7CRL2                          S01310
     C*********************END                                            S01310
     C***********M7BTB5****IFNE *BLANK                                    S01310
     C***********M7BTB6****ORNE *BLANK                                    S01310
     C*********************MOVE X0D25     M7CRL3                          S01310
     C*********************END                                            S01310
     C***********M7BTB6****IFNE *BLANK                                    S01310
     C*********************MOVE X0D25     M7CRL4                          S01310
     C*********************END                                            S01310
      *********************                                               S01310
     C*********************                                               S01310
     C***********RLPR******IFEQ *BLANK                                    S01310
     C*********************MOVELPREF      M1RTRT                          S01310
     C*********************MOVELPREF      M1RREF                          S01310
     C*********************ELSE                                           S01310
     C*********************MOVELRLPR      M1RTRT                          S01310
     C*********************MOVELRLPR      M1RREF                          S01310
     C*********************END                                            S01310
     C***FORMAT*THE*SWIFT*COMMON REFERENCE                                E32480
     C*********************EXSR SR04                                      E32480
     C*********************                                               S01310
     C***FORMAT*THE*AMOUNT*                                               S01310
     C*********************EXSR SR06                                      S01310
     C*********************MOVEASAM       FAMT                            S01310
     C*********************Z-ADD1         S       30                      S01310
     C***********FAMT,S****DOWEQ' '                                       S01310
     C*********************ADD  1         S                               S01310
     C*********************END                                            S01310
     C*********************MOVEAFAMT,S    M1AMNT                          S01310
     C*********************                                               S01310
     C***OUTPUT*SEVEN*RECORDS TO THE OUTGOING SWIFT MESSAGES              S01310
     C***FILE*(PF/MSMSOPF)*AND ONE RECORD TO (PF/MSIXOPF)                 S01310
     C*********************EXSR SR08                                      S01310
     C*********************                                         E21473E32481
     C***NO*OUTPUT*IF*MAIL*PAYMENT*ORDER*WITH*MT202*INDICATOR*ON*IN*E21473E32481
     C***OUTGOING*PAYMENTS.*                                        E21473E32481
     C*********************                                         E21473E32481
     C***********STMT******IFNE 2                          B001     E21473E32481
     C/COPY WNCPYSRC,FT0645C017
      *                                                                                       CSW209
     C           CSW209    IFEQ 'Y'                                                           CSW209
     C           OPOMVF    ANDEQ'COV'                                                         CSW209
      *                                                                                       CSW209
      ** Field :50 - Ordering Customer (Cover)                                                CSW209
      *                                                                                       CSW209
     C*  Setup parameters and execute SR01 to format the Ordering Customer                    CSW209
      *                                                                                       CSW209
     C                     MOVELOPCOCT    ISPTP                                               CSW209
     C                     MOVELOPCOC1    ISPTY1                                              CSW209
     C                     MOVE OPCOC2    ISPTY2                                              CSW209
     C                     MOVE OPCOC3    ISPTY3                                              CSW209
     C                     MOVE OPCOC4    ISPTY4                                              CSW209
     C                     MOVE OPCOC5    ISPTY5                                              CSW209
     C                     MOVE SMCY      ISCCY   3                                           CSW209
     C**********           MOVE ' '       IVTAG1  1                                  CSW209 BUG24482
     C                     MOVE 'A'       IVTAG1  1                                         BUG24482
     C                     MOVE ' '       IVTAG2  1                                           CSW209
      *                                                                                       CSW209
     C                     MOVE 'D'       IVTAG3  1                                           CSW209
     C                     MOVELOPCOC1    ADCHK1                                              CSW209
     C           ADSLSH    IFEQ '/'                                                           CSW209
     C           OPCOCT    IFEQ 'P'                                                           CSW209
     C           OPCOCT    OREQ 'I'                                                           CSW209
     C           OPCOCT    OREQ 'R'                                                           CSW209
     C                     SUBSTOPCOC1:2  ISPTY1    P                                         CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C           OPCOCT    IFEQ 'C'                                                           CSW209
     C                     MOVELOPCOC2    ISPTY1                                              CSW209
     C                     MOVELOPCOC3    ISPTY2                                              CSW209
     C                     MOVELOPCOC4    ISPTY3                                              CSW209
     C                     MOVELOPCOC5    ISPTY4                                              CSW209
     C                     MOVEL*BLANKS   ISPTY5                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     EXSR SR01                                                          CSW209
      *                                                                                       CSW209
      ** Call Formatting Program                                                              CSW209
      *                                                                                       CSW209
     C                     EXSR SRFRMT                                                        CSW209
     C           PRTRN     IFEQ *BLANKS                                                       CSW209
     C                     MOVE 'F'       OSTAG                                               CSW209
     C                     MOVELPMSGL1    M1COC1                                              CSW209
     C                     MOVELPMSGL2    M1COC2                                              CSW209
     C                     MOVELPMSGL3    M1COC3                                              CSW209
     C                     MOVELPMSGL4    M1COC4                                              CSW209
     C                     MOVELPMSGL5    M1COC5                                              CSW209
     C                     ELSE                                                               CSW209
      ** Search customer then check if it is CROSSMAR and its BEI is                          CSW209
      ** not blank.                                                                           CSW209
      *                                                                                       CSW209
     C                     MOVELCUSTNO    PKEY1                                               CSW209
     C                     CALL 'AOCUSTR1'                                                    CSW209
     C                     PARM *BLANK    PRTCD                                               CSW209
     C                     PARM '*KEY   ' POPTN                                               CSW209
     C                     PARM           PKEY1  10                                           CSW209
     C                     PARM *BLANKS   PKYST   7                                           CSW209
     C           SDCUST    PARM SDCUST    DSLDY                                               CSW209
      *                                                                                       CSW209
     C           PRTCD     IFEQ *BLANKS                                                       CSW209
     C           BBCBEI    ANDNE*BLANKS                                                       CSW209
     C                     MOVE *BLANKS   OFSPT1                                              CSW209
     C                     MOVE *BLANKS   OFSPT2                                              CSW209
     C                     MOVE *BLANKS   OFSPT3                                              CSW209
     C                     MOVE *BLANKS   OFSPT4                                              CSW209
     C                     MOVE *BLANKS   OFSPT5                                              CSW209
     C                     MOVE 'A'       OSTAG                                               CSW209
     C                     MOVELBBCBEI    OFSPT1                                              CSW209
     C                     ENDIF                                                              CSW209
     C**********           ENDIF                                                     CSW209 BUG24482
      *                                                                                       CSW209
     C           OSTAG     IFEQ 'A'                                                           CSW209
     C                     MOVEL':50A:'   @MSGTG                                              CSW209
     C                     ELSE                                                               CSW209
     C                     MOVEL':50K:'   @MSGTG                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     MOVE *BLANKS   ##ACLN 35                                           CSW209
      *                                                                                       CSW209
     C           ODMT      IFNE *BLANKS                                                       CSW209
     C                     MOVELODMTT     WENTTP  1                                           CSW209
     C                     MOVELODMT      WACCT  35                                           CSW209
     C                     ELSE                                                               CSW209
     C                     MOVELOPCOCT    WENTTP                                              CSW209
     C                     MOVELOPCOC1    WACCT                                               CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C**********           MOVELOPCOC1    WENTTP                                     CSW209 BUG24462
     C**********           MOVELOPCOCT    WACCT                                      CSW209 BUG24462
     C                     MOVELOPCOCT    WENTTP                                            BUG24462
     C                     MOVELOPCOC1    WACCT                                             BUG24462
     C                     MOVELSMCY      WCCY                                                CSW209
     C                     MOVEL*BLANKS   WBRCA   3                                           CSW209
      *                                                                                       CSW209
     C                     MOVELOFSPT1    M1COC1                                              CSW209
     C                     MOVE OFSPT2    M1COC2                                              CSW209
     C                     MOVE OFSPT3    M1COC3                                              CSW209
     C                     MOVE OFSPT4    M1COC4                                              CSW209
     C                     MOVELOFSPT5    M1COC5                                              CSW209
      *                                                                                       CSW209
     C                     MOVELOFSPT1    W@CNA1 35                                           CSW209
     C                     MOVELOFSPT2    W@CNA2 35                                           CSW209
     C                     MOVELOFSPT3    W@CNA3 35                                           CSW209
     C                     MOVELOFSPT4    W@CNA4 35                                           CSW209
     C                     MOVELOFSPT5    W@CNA5 35                                           CSW209
      *                                                                                       CSW209
     C                     EXSR SROUFM                                                        CSW209
      *                                                                                       CSW209
     C                     MOVELW@CNA1    OFSPT1                                              CSW209
     C                     MOVELW@CNA2    OFSPT2                                              CSW209
     C                     MOVELW@CNA3    OFSPT3                                              CSW209
     C                     MOVELW@CNA4    OFSPT4                                              CSW209
     C                     MOVELW@CNA5    OFSPT5                                              CSW209
      *                                                                                       CSW209
     C                     MOVELOFSPT1    M1COC1                                              CSW209
     C                     MOVE OFSPT2    M1COC2                                              CSW209
     C                     MOVE OFSPT3    M1COC3                                              CSW209
     C                     MOVE OFSPT4    M1COC4                                              CSW209
     C                     MOVELOFSPT5    M1COC5                                              CSW209
     C                     ENDIF                                                            BUG24482
      *                                                                                       CSW209
     C           M1COC1    IFNE *BLANK                                                        CSW209
     C           M1COC2    ORNE *BLANK                                                        CSW209
     C           M1COC3    ORNE *BLANK                                                        CSW209
     C           M1COC4    ORNE *BLANK                                                        CSW209
     C           M1COC5    ORNE *BLANK                                                        CSW209
     C                     ADD  1         Q                                                   CSW209
     C           Q         OCUR MULT                                                          CSW209
     C           OSTAG     IFNE 'A'                                                           CSW209
     C           OSTAG     ANDNE'F'                                                           CSW209
     C                     MOVE 'K'       OSTAG                                               CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     MOVE '50'      FLDNO                                               CSW209
     C                     MOVE CUSTNO    BBCUST                                              CSW209
     C                     MOVELOSTAG     M1COCT                                              CSW209
      *                                                                                       CSW209
     C                     EXSR FSWAD                                                         CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
      ** Field :52 : - Ordering Institution (Cover)                                           CSW209
      *                                                                                       CSW209
     C                     MOVELOPCOBT    ISPTP                                               CSW209
     C                     MOVELOPCOB1    ISPTY1                                              CSW209
     C                     MOVELOPCOB2    ISPTY2                                              CSW209
     C                     MOVELOPCOB3    ISPTY3                                              CSW209
     C                     MOVELOPCOB4    ISPTY4                                              CSW209
     C                     MOVELOPCOB5    ISPTY5                                              CSW209
     C*                                                                                       CSW209
     C                     MOVE SMCY      ISCCY   3                                           CSW209
     C                     MOVE 'A'       IVTAG1  1                                           CSW209
     C                     MOVE ' '       IVTAG2  1                                           CSW209
     C                     MOVE 'D'       IVTAG3  1                                           CSW209
      *                                                                                       CSW209
     C                     MOVE 'Y'       W201IN  1                                           CSW209
      *                                                                                       CSW209
     C                     EXSR SR01                                                          CSW209
     C                     MOVE 'N'       W201IN                                              CSW209
      *                                                                                       CSW209
     C                     MOVELOFSPT1    M1COB1                                              CSW209
     C                     MOVE OFSPT2    M1COB2                                              CSW209
     C                     MOVE OFSPT3    M1COB3                                              CSW209
     C                     MOVE OFSPT4    M1COB4                                              CSW209
     C                     MOVE OFSPT5    M1COB5                                              CSW209
      *                                                                                       CSW209
     C           M1COB1    IFNE *BLANK                                                        CSW209
     C           M1COB2    ORNE *BLANK                                                        CSW209
     C           M1COB3    ORNE *BLANK                                                        CSW209
     C           M1COB4    ORNE *BLANK                                                        CSW209
     C           M1COB5    ORNE *BLANK                                                        CSW209
     C                     ADD  1         Q                                                   CSW209
     C           Q         OCUR MULT                                                          CSW209
     C                     MOVE OSTAG     M1COBT                                              CSW209
     C                     MOVEL'52'      FLDNO                                               CSW209
     C                     EXSR FSWAD                                                         CSW209
     C                     END                                                                CSW209
      *                                                                                       CSW209
      ** Field :56 - Intermediary Institution (Cover)                                         CSW209
      *                                                                                       CSW209
     C                     MOVELOPCIBT    ISPTP                                               CSW209
     C*                    MOVELPCCY      ISCCY                                               CSW209
     C                     MOVELOPCIB1    ISPTY1                                              CSW209
     C                     MOVELOPCIB2    ISPTY2                                              CSW209
     C                     MOVELOPCIB3    ISPTY3                                              CSW209
     C                     MOVELOPCIB4    ISPTY4                                              CSW209
     C                     MOVELOPCIB5    ISPTY5                                              CSW209
     C                     SETOF                     20                                       CSW209
     C                     MOVE 'Y'       W201IN  1                                           CSW209
     C                     EXSR SR01                                                          CSW209
     C                     MOVE 'N'       W201IN                                              CSW209
      *                                                                                       CSW209
      ** Move formatted Intermediary Institution to Print Line                                CSW209
      *                                                                                       CSW209
     C                     MOVELOFSPT1    M1CIB1                                              CSW209
     C                     MOVELOFSPT2    M1CIB2                                              CSW209
     C                     MOVELOFSPT3    M1CIB3                                              CSW209
     C                     MOVELOFSPT4    M1CIB4                                              CSW209
     C                     MOVELOFSPT5    M1CIB5                                              CSW209
      *                                                                                       CSW209
     C           M1CIB1    IFNE *BLANK                                                        CSW209
     C           M1CIB2    ORNE *BLANK                                                        CSW209
     C           M1CIB3    ORNE *BLANK                                                        CSW209
     C           M1CIB4    ORNE *BLANK                                                        CSW209
     C           M1CIB5    ORNE *BLANK                                                        CSW209
     C                     ADD  1         Q                                                   CSW209
     C           Q         OCUR MULT                                                          CSW209
     C                     MOVE OSTAG     M1CIBT                                              CSW209
     C                     MOVEL'56'      FLDNO                                               CSW209
     C                     EXSR FSWAD                                                         CSW209
     C                     END                                                                CSW209
      *                                                                                       CSW209
      ** Field :57 - Account with Institution (Cover)                                         CSW209
      *                                                                                       CSW209
     C                     MOVELOPCABT    ISPTP                                               CSW209
     C                     MOVELOPCAB1    ISPTY1                                              CSW209
     C                     MOVELOPCAB2    ISPTY2                                              CSW209
     C                     MOVELOPCAB3    ISPTY3                                              CSW209
     C                     MOVELOPCAB4    ISPTY4                                              CSW209
     C                     MOVELOPCAB5    ISPTY5                                              CSW209
     C                     MOVE PCCY      ISCCY                                               CSW209
     C                     MOVE 'A'       IVTAG1            TAG IND 1                         CSW209
     C                     MOVE 'B'       IVTAG2            TAG IND 2                         CSW209
     C                     MOVE 'D'       IVTAG3            TAG IND 3                         CSW209
      *                                                                                       CSW209
     C                     MOVE 'Y'       W201IN                                              CSW209
     C                     EXSR SR01                                                          CSW209
     C                     MOVE 'N'       W201IN                                              CSW209
     C                     MOVELOFSPT1    M1CAB1                                              CSW209
     C                     MOVELOFSPT2    M1CAB2                                              CSW209
     C                     MOVELOFSPT3    M1CAB3                                              CSW209
     C                     MOVELOFSPT4    M1CAB4                                              CSW209
     C                     MOVELOFSPT5    M1CAB5                                              CSW209
     C*                                                                                       CSW209
     C           M1CAB1    IFNE *BLANK                                                        CSW209
     C           M1CAB2    ORNE *BLANK                                                        CSW209
     C           M1CAB3    ORNE *BLANK                                                        CSW209
     C           M1CAB4    ORNE *BLANK                                                        CSW209
     C           M1CAB5    ORNE *BLANK                                                        CSW209
     C                     ADD  1         Q                                                   CSW209
     C           Q         OCUR MULT                                                          CSW209
     C                     MOVE OSTAG     M1CABT                                              CSW209
     C                     MOVE '57'      FLDNO                                               CSW209
      *                                                                                       CSW209
     C                     EXSR FSWAD                                                         CSW209
      *                                                                                       CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
      ** Field :59: - Beneficiary Customer (Cover)                                            CSW209
      *                                                                                       CSW209
     C                     MOVELOPCBCT    ISPTP                                               CSW209
     C                     MOVELOPCBC1    ISPTY1                                              CSW209
     C                     MOVELOPCBC2    ISPTY2                                              CSW209
     C                     MOVELOPCBC3    ISPTY3                                              CSW209
     C                     MOVELOPCBC4    ISPTY4                                              CSW209
     C                     MOVELOPCBC5    ISPTY5                                              CSW209
     C                     MOVE PCCY      ISCCY                                               CSW209
     C                     MOVE 'A'       IVTAG1                                              CSW209
     C                     MOVE ' '       IVTAG2                                              CSW209
     C                     MOVE 'D'       IVTAG3                                              CSW209
      *                                                                                       CSW209
     C                     EXSR SR01                                                          CSW209
      *                                                                                       CSW215
      ** Validate 59F Format                                                                  CSW215
      *                                                                                       CSW215
     C                     MOVEL'N'       WRK59F  1                                           CSW215
     C           CSW215    IFEQ 'Y'                                                           CSW215
     C                     SUBSTOPCBC1:1  WSLASH  1                                           CSW215
     C                     SUBSTOPCBC1:1  WLINE1  2                                           CSW215
     C                     SUBSTOPCBC2:1  WLINE2  2                                           CSW215
      *                                                                                       CSW215
     C           WSLASH    IFEQ '/'                                                           CSW215
     C           WLINE2    ANDEQ'1/'                                                          CSW215
     C           WLINE1    OREQ '1/'                                                          CSW215
     C                     MOVEL'Y'       WRK59F                                              CSW215
     C                     MOVELOPCBC1    PBENF1                                              CSW215
     C                     MOVELOPCBC2    PBENF2                                              CSW215
     C                     MOVELOPCBC3    PBENF3                                              CSW215
     C                     MOVELOPCBC4    PBENF4                                              CSW215
     C                     MOVELOPCBC5    PBENF5                                              CSW215
     C                     ELSE                                                               CSW215
     C                     EXSR SRFM59                                                        CSW215
     C                     ENDIF                                                              CSW215
      *                                                                                       CSW215
     C           WRK59F    IFEQ 'Y'                                                           CSW215
      *                                                                                       CSW215
     C           PBENF1    IFNE *BLANKS                                                       CSW215
     C                     ADD  1         Q                                                   CSW215
     C           Q         OCUR MULT                                                          CSW215
     C                     MOVEL':59F:'   MTAG                                                CSW215
     C                     MOVELPBENF1    MFLD                                                CSW215
     C                     ENDIF                                                              CSW215
      *                                                                                       CSW215
     C           PBENF2    IFNE *BLANKS                                                       CSW215
     C                     ADD  1         Q                                                   CSW215
     C           Q         OCUR MULT                                                          CSW215
     C                     MOVELPBENF2    MFLD                                                CSW215
     C                     ENDIF                                                              CSW215
      *                                                                                       CSW215
     C           PBENF3    IFNE *BLANKS                                                       CSW215
     C                     ADD  1         Q                                                   CSW215
     C           Q         OCUR MULT                                                          CSW215
     C                     MOVELPBENF3    MFLD                                                CSW215
     C                     ENDIF                                                              CSW215
      *                                                                                       CSW215
     C           PBENF4    IFNE *BLANKS                                                       CSW215
     C                     ADD  1         Q                                                   CSW215
     C           Q         OCUR MULT                                                          CSW215
     C                     MOVELPBENF4    MFLD                                                CSW215
     C                     ENDIF                                                              CSW215
      *                                                                                       CSW215
     C           PBENF5    IFNE *BLANKS                                                       CSW215
     C                     ADD  1         Q                                                   CSW215
     C           Q         OCUR MULT                                                          CSW215
     C                     MOVELPBENF5    MFLD                                                CSW215
     C                     ENDIF                                                              CSW215
      *                                                                                       CSW215
     C                     ENDIF                                                              CSW215
      *                                                                                       CSW215
     C                     ENDIF                                                              CSW215
      *                                                                                       CSW215
     C           WRK59F    IFEQ 'N'                                                           CSW215
      *                                                                                       CSW209
     C                     MOVELOFSPT1    M1CBC1                                              CSW209
     C                     MOVELOFSPT2    M1CBC2                                              CSW209
     C                     MOVELOFSPT3    M1CBC3                                              CSW209
     C                     MOVELOFSPT4    M1CBC4                                              CSW209
     C                     MOVELOFSPT5    M1CBC5                                              CSW209
     C                     MOVE *ON       *IN27                                               CSW209
      *                                                                                       CSW209
     C           M1CBC1    IFNE *BLANK                                                        CSW209
     C           M1CBC2    ORNE *BLANK                                                        CSW209
     C           M1CBC3    ORNE *BLANK                                                        CSW209
     C           M1CBC4    ORNE *BLANK                                                        CSW209
     C           M1CBC5    ORNE *BLANK                                                        CSW209
      *                                                                                       CSW209
     C           OSTAG     IFEQ 'A'                                                           CSW209
     C                     ADD  1         Q                                                   CSW209
     C           Q         OCUR MULT                                                          CSW209
     C                     MOVE OSTAG     M1CBCT                                              CSW209
     C                     MOVEL'59'      FLDNO                                               CSW209
     C                     EXSR FSWAD                                                         CSW209
      *                                                                                       CSW209
     C                     ELSE                                                               CSW209
     C                     MOVE *OFF      *IN27                                               CSW209
     C           M1CBC1    IFNE *BLANKS                                                       CSW209
     C                     ADD  1         Q                                                   CSW209
     C           Q         OCUR MULT                                                          CSW209
     C                     MOVEL*BLANKS   MTAG                                                CSW209
     C                     MOVEL':59:'    MTAG                                                CSW209
     C                     MOVELM1CBC1    MFLD                                                CSW209
     C                     ENDIF                                                              CSW209
     C           M1CBC2    IFNE *BLANKS                                                       CSW209
     C                     ADD  1         Q                                                   CSW209
     C           Q         OCUR MULT                                                          CSW209
     C                     MOVELM1CBC2    MFLD                                                CSW209
      *                                                                                       CSW209
     C                     ENDIF                                                              CSW209
     C           M1CBC3    IFNE *BLANKS                                                       CSW209
     C                     ADD  1         Q                                                   CSW209
     C           Q         OCUR MULT                                                          CSW209
     C                     MOVELM1CBC3    MFLD                                                CSW209
      *                                                                                       CSW209
     C                     ENDIF                                                              CSW209
     C           M1CBC4    IFNE *BLANKS                                                       CSW209
     C                     ADD  1         Q                                                   CSW209
     C           Q         OCUR MULT                                                          CSW209
     C                     MOVELM1CBC4    MFLD                                                CSW209
      *                                                                                       CSW209
     C                     ENDIF                                                              CSW209
     C           M1CBC5    IFNE *BLANKS                                                       CSW209
     C                     ADD  1         Q                                                   CSW209
     C           Q         OCUR MULT                                                          CSW209
     C                     MOVELM1CBC5    MFLD                                                CSW209
      *                                                                                       CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     ENDIF                                                              CSW209
     C                     ENDIF                                                              CSW209
     C                     ENDIF                                                              CSW215
      *                                                                                       CSW209
      **  Field :70 - Remittance Information (Cover)                                          CSW209
      *                                                                                       CSW209
     C                     MOVE *BLANKS   OFSPT                                               CSW209
     C                     MOVE OPCDP1    OFSPT1                                              CSW209
     C                     MOVE OPCDP2    OFSPT2                                              CSW209
     C                     MOVE OPCDP3    OFSPT3                                              CSW209
     C                     MOVE OPCDP4    OFSPT4                                              CSW209
     C                     EXSR EMBLK                                                         CSW209
     C                     MOVELOFSPT1    M1CDP1                                              CSW209
     C                     MOVELOFSPT2    M1CDP2                                              CSW209
     C                     MOVELOFSPT3    M1CDP3                                              CSW209
     C                     MOVELOFSPT4    M1CDP4                                              CSW209
     C*                                                                                       CSW209
     C           M1CDP1    IFNE *BLANK                                                        CSW209
     C           M1CDP2    ORNE *BLANK                                                        CSW209
     C           M1CDP3    ORNE *BLANK                                                        CSW209
     C           M1CDP4    ORNE *BLANK                                                        CSW209
     C           M1CDP1    IFNE *BLANKS                                                       CSW209
     C                     ADD  1         Q                                                   CSW209
     C           Q         OCUR MULT                                                          CSW209
     C                     MOVEL':70:'    MTAG                                                CSW209
     C                     MOVELM1CDP1    MFLD                                                CSW209
      *                                                                                       CSW209
     C                     ENDIF                                                              CSW209
     C           M1CDP2    IFNE *BLANKS                                                       CSW209
     C                     ADD  1         Q                                                   CSW209
     C           Q         OCUR MULT                                                          CSW209
     C                     MOVELM1CDP2    MFLD                                                CSW209
      *                                                                                       CSW209
     C                     ENDIF                                                              CSW209
     C           M1CDP3    IFNE *BLANKS                                                       CSW209
     C                     ADD  1         Q                                                   CSW209
     C           Q         OCUR MULT                                                          CSW209
     C                     MOVELM1CDP3    MFLD                                                CSW209
      *                                                                                       CSW209
     C                     ENDIF                                                              CSW209
     C           M1CDP4    IFNE *BLANKS                                                       CSW209
     C                     ADD  1         Q                                                   CSW209
     C           Q         OCUR MULT                                                          CSW209
     C                     MOVELM1CDP4    MFLD                                                CSW209
      *                                                                                       CSW209
     C                     ENDIF                                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
      ** Field :72: - Sender to Receiver Information Cover                                    CSW209
      *                                                                                       CSW209
     C                     MOVE *BLANKS   OFSPT                                               CSW209
     C                     MOVE OPCBB1    OFSPT1                                              CSW209
     C                     MOVE OPCBB2    OFSPT2                                              CSW209
     C                     MOVE OPCBB3    OFSPT3                                              CSW209
     C                     MOVE OPCBB4    OFSPT4                                              CSW209
     C                     MOVE OPCBB5    OFSPT5                                              CSW209
     C                     MOVE OPCBB6    OFSPT6                                              CSW209
     C                     EXSR EMBLK                                                         CSW209
     C                     MOVELOFSPT1    M1CBB1                                              CSW209
     C                     MOVELOFSPT2    M1CBB2                                              CSW209
     C                     MOVELOFSPT3    M1CBB3                                              CSW209
     C                     MOVELOFSPT4    M1CBB4                                              CSW209
     C                     MOVELOFSPT5    M1CBB5                                              CSW209
     C                     MOVELOFSPT6    M1CBB6                                              CSW209
      *                                                                                       CSW209
     C           M1CBB1    IFNE *BLANK                                                        CSW209
     C           M1CBB2    ORNE *BLANK                                                        CSW209
     C           M1CBB3    ORNE *BLANK                                                        CSW209
     C           M1CBB4    ORNE *BLANK                                                        CSW209
     C           M1CBB5    ORNE *BLANK                                                        CSW209
     C           M1CBB6    ORNE *BLANK                                                        CSW209
     C           M1CBB1    IFNE *BLANKS                                                       CSW209
     C                     ADD  1         Q                                                   CSW209
     C           Q         OCUR MULT                                                          CSW209
     C                     MOVEL':72:'    MTAG                                                CSW209
     C                     MOVELM1CBB1    MFLD                                                CSW209
     C                     ENDIF                                                              CSW209
     C           M1CBB2    IFNE *BLANKS                                                       CSW209
     C                     ADD  1         Q                                                   CSW209
     C           Q         OCUR MULT                                                          CSW209
     C                     MOVELM1CBB2    MFLD                                                CSW209
     C                     ENDIF                                                              CSW209
     C           M1CBB3    IFNE *BLANKS                                                       CSW209
     C                     ADD  1         Q                                                   CSW209
     C           Q         OCUR MULT                                                          CSW209
     C                     MOVELM1CBB3    MFLD                                                CSW209
     C                     ENDIF                                                              CSW209
     C           M1CBB4    IFNE *BLANKS                                                       CSW209
     C                     ADD  1         Q                                                   CSW209
     C           Q         OCUR MULT                                                          CSW209
     C                     MOVELM1CBB4    MFLD                                                CSW209
     C                     ENDIF                                                              CSW209
     C           M1CBB5    IFNE *BLANKS                                                       CSW209
     C                     ADD  1         Q                                                   CSW209
     C           Q         OCUR MULT                                                          CSW209
     C                     MOVELM1CBB5    MFLD                                                CSW209
     C                     ENDIF                                                              CSW209
     C           M1CBB6    IFNE *BLANKS                                                       CSW209
     C                     ADD  1         Q                                                   CSW209
     C           Q         OCUR MULT                                                          CSW209
     C                     MOVELM1CBB6    MFLD                                                CSW209
     C                     ENDIF                                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
      ** Field 33B - Instructed Currency/Amount                                               CSW209
      *                                                                                       CSW209
     C           OPCICY    IFNE *BLANKS                                                       CSW209
     C                     ADD  1         Q                                                   CSW209
     C           Q         OCUR MULT                                                          CSW209
     C                     MOVEL':33B:'   MTAG                                                CSW209
     C                     MOVE OPCICY    WICCY                                               CSW209
     C                     Z-ADDOPCIAM    WIAMNT                                              CSW209
     C                     EXSR SRFAMT                                                        CSW209
     C                     MOVEA*BLANKS   WA1                                                 CSW209
     C                     MOVEAWOCCYS    WA1                                                 CSW209
     C                     MOVEAWOAMNT    WA1,4                                               CSW209
     C                     MOVEAWA1       MFLD                                                CSW209
     C                     MOVEAWA1       M1R33B                                              CSW209
     C**********           CALL 'ZSEDIT'                                             CSW209 MD051787
     C**********           PARM OPCIAM    PAMNT  150                                 CSW209 MD051787
     C**********           PARM WODECS    PDECS   10                                 CSW209 MD051787
     C**********           PARM 'J'       PCODE   1                                  CSW209 MD051787
     C**********           PARM *BLANKS   POUT21 21                                  CSW209 MD051787
     C**********           MOVELPOUT21    WCHR20 20                                  CSW209 MD051787
     C**********           MOVE WCHR20    M1R33B                                     CSW209 MD051787
     C**********           MOVELOPCICY    M1R33B                                     CSW209 MD051787
     C**********           MOVELM1R33B    MFLD                                       CSW209 MD051787
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     ENDIF                                                              CSW209
      *                                                                   S01310
      ** Output correctly generated message to PF/MGOMSGPD and write      S01310
      ** reference record to PF/MGOREFPD.                                 S01310
      *                                                                   S01310
     C                     EXSR OMSG                                      S01310
      *                                                                                       222239
     C           WERROR    IFEQ 'Y'                                                           222239
     C                     GOTO MAINEN                                                        222239
     C                     ENDIF                                                              222239
     C*
     C*  OUTPUT AN ENTRY TO THE SWIFT MESSAGE REPORT PRTF/FT0645P1     )))
     C*  INCLUDE NARRATIVE 'RECOVERY' IF ROLLBACK INDICATOR
     C*  HAS BEEN SETON IN SUBROUTINE SR08
     C/COPY WNCPYSRC,FT0645C023
     C                     EXSR SRP1
     C/COPY WNCPYSRC,FT0645C024
     C*********************END                             E001     E21473E32481
     C*
     C*  COMIT OR ROLLBACK CHANGES
     C           *IN41     IFEQ '0'
      **                                                                                      CSC022
      ** Execute commit if SAR CSC022 is not enrolled or                                      CSC022
      **   job is not currently running in batch mode                                         CSC022
      **                                                                                      CSC022
     C           CSC022    IFEQ 'N'                                                           CSC022
     C           CSC022    OREQ 'Y'                                                           CSC022
     C           WCRSKP    ANDEQ'N'                                                           CSC022
     C           CMTTXT    COMIT
     C                     ENDIF                                                              CSC022
      *                                                                   221145
      **  Call Compliance Watch:Watch List Checking                       221145
     C           CSD015    IFEQ 'Y'                                       221145
     C           W1EWLC    ANDEQ'Y'                                                           222385
     C           CSW025    ANDEQ'N'                                       221145
     C                     EXSR WLCDQ                                     221145
     C                     ENDIF                                          221145
      *                                                                   221145
     C                     MOVE 'Y'       OPPARM           MSG PROD FLAG
     C*****INCREMENT*MESSAGES*COUNT*FIELD*IN*DATAAREA*MSFCTL*             S01310
     C**(AS*LONG*AS*MT210*TELEX*MESAGE*HAS*NOT*BEEN*PRODUCED)*            S01310
     C************IN26     IFEQ '0'                                       S01310
     C************         EXSR SR11                                      S01310
     C************         END                                            S01310
     C                     ELSE
      **                                                                                      CSC022
      ** Execute rollback if SAR CSC022 is not enrolled or                                    CSC022
      **   job is not currently running in batch mode                                         CSC022
      **                                                                                      CSC022
     C           CSC022    IFEQ 'N'                                                           CSC022
     C                     ROLBK
     C                     ELSE                                                               CSC022
     C           WCRSKP    IFEQ 'N'                                                           CSC022
     C                     ROLBK                                                              CSC022
     C                     ELSE                                                               CSC022
     C                     SETON                     U7U8                                     CSC022
     C                     ENDIF                                                              CSC022
     C                     ENDIF                                                              CSC022
     C                     END
     C/COPY WNCPYSRC,FT0645C042
     C                     END
     C/COPY WNCPYSRC,FT0645C043
     C*********************END                                            S01310
     C*                                                                )))
     C           MAINEN    TAG                                                                222239
     C                     MOVEL'N'       WERROR                                              222239
     C/EJECT
     C*
     C*************************************************                   E32481
     C*****RECORD*READ*FROM CQPACDD VIA LOGICAL PRPF2 *                   E32481
     C*************************************************                   E32481
     C*********************                                               E32481
     C************IN02*****IFEQ '1'                                       E32481
     C*********************                                               E32481
     C*********IF*MT202*FIELD ON SCREEN IS 'Y' SEND AN MT202              E32481
     C*********---------------------------------------------              E32481
     C*********************                                               E32481
     C***********SNMT******IFEQ 'Y'                                       E32481
     C*********************CALL 'FTC0647'                                 E32481
     C*********************PARM           PREF                            E32481
     C*********************PARM           RSEQ                      S01117E32481
     C*********************END                                            E32481
     C*********************END                                            E32481
     C*
     C/EJECT
     C*
     C**********************************
     C*    LAST RECORD PROCESSING.     *
     C**********************************
     C*
     C**  OUTPUT A RUN CONTROL REPORT
     CLRN40                EXSR FIRST
     C*LR*******************ADD  1         PAGEP3                         S01117
     CLR                   ADD  1         PAGEAU                          S01117
     C*LR*******************WRITEP3H1                   80                S01117
     CLR                   WRITEHEADAU                 80                 S01117
     CLR 80                DO                              B001
     C*                                                    ))))))))))))))
     C*R*******************MOVE 'FT0645P3'DBFNAM           )))  DATA  ))) S01117
     CLR                   MOVEL'FT0645AU'DBFNAM           )))        ))) S01117
     CLR                   MOVEL'3'       DBERKY           )))  BASE  )))
     C*LR****************** MOVE 18        DBERR#          ))) ERROR  ))) S01117
     CLR                   MOVE '18'      DBERR#           )))        ))) S01117
     CLR                   EXSR DBERR                      )))   18   )))
     C*                                                    ))))))))))))))
     CLR                   END                             E001
     CLR                   RETRN
     C/EJECT                                                                                  CSD015
      *****************************************************************                       CSD015
      *                                                               *                       CSD015
      *  SRWTCH - Watch Processing                                    *                       CSD015
      *                                                               *                       CSD015
      *****************************************************************                       CSD015
      *                                                                                       CSD015
     C           SRWTCH    BEGSR                                                              CSD015
      *                                                                                       CSD015
      ** Re-determine Message Status                                                          CSD015
      *                                                                                       CSD015
     C                     MOVE 'N'       PARLS   1                                           CSD015
      *                                                                                       CSD015
     C           MGST      IFEQ 'RSND'                                                        CSD015
     C           NWRK      IFEQ 'SWIFT '                                                      CSD015
     C           NWRK      OREQ 'TELEX '                                                      CSD015
     C           NWRK      OREQ 'STTX  '                                                      CSD015
     C                     MOVE 'CRTD'    MGST                                                CSD015
     C                     MOVE '1'       MGSG                                                CSD015
     C                     MOVE 'Y'       PARLS                                               CSD015
     C                     ENDIF                                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Initialise parameters for compliance engine program.                                 CSD015
      *                                                                                       CSD015
     C                     CLEARWLTDS                                                         CSD015
      *                                                                                       CSD015
     C                     Z-ADD*ZERO     W4VDAT                                              CSD015
     C                     Z-ADD*ZERO     W4MDAT                                              CSD015
     C                     Z-ADD*ZERO     W4AMT1                                              CSD015
     C                     Z-ADD*ZERO     W4AMT2                                              CSD015
      *                                                                                       CSD015
      ** Set up parameter for compliance engine program                                       CSD015
      *                                                                                       CSD015
     C                     MOVELTRNO      W4IDEN                                              CSD015
     C                     MOVELMTPY      W4ITEM                                              CSD015
     C                     MOVELBRCAA     W4BRCH                                              CSD015
     C                     MOVEL'MGOREF  'W4FUNT                                              CSD015
     C                     MOVELDECN      W4CNUM                                              CSD015
     C                     Z-ADDRUND      W4DDAT                                              CSD015
     C                     MOVELPARLS     W4ARLS                                              CSD015
      *                                                                                       CSD015
      ***Send*transaction*to*compliance engine program                                 CSD015 221145
      *********************                                                            CSD015 221145
     C*********************CALL 'SDWLCLOP'                                             CSD015 221145
     C*********************PARM           WLTDS                                        CSD015 221145
     C*********************PARM *BLANKS   PSTRNG                                       CSD015 221145
      *                                                                                       CSD015
     C                     ENDSR                                                              CSD015
      *                                                                                       CSD015
      *****************************************************************                       221145
     C/EJECT                                                                                  221145
      *****************************************************************                       221145
      *                                                               *                       221145
      *  WLCDQ - Submit information to Watch List Check Dtaq          *                       221145
      *                                                               *                       221145
      *****************************************************************                       221145
      *                                                                                       221145
     C           WLCDQ     BEGSR                                                              221145
      *                                                                                       221145
      *  Send transaction to compliance engine program                                        221145
      *                                                                                       221145
     C                     CALL 'SDWLCLOP'                                                    221145
     C                     PARM           WLTDS                                               221145
     C                     PARM *BLANKS   PSTRNG                                              221145
      *                                                                                       221145
      *                                                                                       221145
     C                     ENDSR                                                              221145
      *                                                                                       221145
      *****************************************************************                       CSD015
     C/EJECT                                                              CEU006
     C*****************************************************************   CEU006
     C*   ERI - Format Field :72: ERI information                     *   CEU006
     C*   Called by - main process.                                   *   CEU006
     C*   Calls     -                                                 *   CEU006
     C*****************************************************************   CEU006
     C*                                                                   CEU006
     C           ERI       BEGSR                                          CEU006
     C*                                                                   CSW020
     C** Perform Old Processing if CSW020 is not switched on.             CSW020
     C           CSW020    IFNE 'Y'                                       CSW020
      *                                                                   CEU006
      * Retrieve currency details for Pay Delivery Currency to get        CEU006
      * SWIFT currency code (TABTG10)                                     CEU006
     C                     MOVEL'20'      TABTGK                          CEU006
     C                     MOVELPDCY      TGCCSR                          CEU006
     C                     MOVE '1'       TGCCSR                          CEU006
     C                     MOVE TGCCSR    TABTGK                          CEU006
     C           TABTGK    CHAINTABFP                10                   CEU006
     C*                                                                   CEU006
     C           *IN10     IFEQ '1'                                       CEU006
     C                     MOVEL'TABFP'   DBFNAM            ************  CEU006
     C                     MOVELTABTGK    DBERKY            * DBERR 31 *  CEU006
     C                     MOVE '31'      DBERR#            ************  CEU006
     C                     EXSR DBERR                                     CEU006
     C                     END                                            CEU006
      *                                                                   CEU006
     C                     MOVELCCYS      O#CCY                           CEU006
      *                                                                   CEU006
      * Format Pay Delivery Amount (per SR03)                             CEU006
     C                     MOVE PDAM      APDAM  13                       CEU006
      *                                                                   CEU006
     C*    DETERMINE DECIMAL POSITION (FOR REPORT)                        CEU006
     C           CDP       COMP 2                    33  32               CEU006
     C           CDP       COMP 1                      3031               CEU006
     C*                                                                   CEU006
     C*    DETERMINE DECIMAL POSITION                                     CEU006
     C           14        SUB  CDP       X       20                      CEU006
     C*    IF 0 DECIMAL PLACES DON'T EDIT                                 CEU006
     C           CDP       IFEQ 0                          B001           CEU006
     C                     MOVE *BLANK    AMT                             CEU006
     C                     MOVE *ZEROS    AM                              CEU006
     C                     MOVEAAPDAM     AMT,2                           CEU006
     C                     MOVEAAPDAM     AM,1                            CEU006
     C                     Z-ADD13        W                               CEU006
     C                     MOVE ','       AM,X                            CEU006
     C                     ELSE                            X001           CEU006
     C*    MOVE AMOUNT INTO ARRAY                                         CEU006
     C                     MOVEAAPDAM     AMT,1                           CEU006
     C*    DETERMINE POSITION OF DECIMAL DIGITS IN 2ND ARRAY              CEU006
     C           X         ADD  1         Y       20                      CEU006
     C*    MOVE DECIMAL DIGITS INTO 2ND ARRAY FIELD                       CEU006
     C                     MOVEAAMT,X     AM,Y                            CEU006
     C*    DETERMINE POSITION & MOVE COMMA                                CEU006
     C                     SUB  1         Y                               CEU006
     C                     MOVE ','       AM,Y                            CEU006
     C*    DETERMINE POSITION OF DIGIT B4  COMMA                          CEU006
     C                     SUB  1         Y                               CEU006
     C*    SAVE POSITION OF DIGIT B4  COMMA                               CEU006
     C                     Z-ADDY         W       20                      CEU006
     C*    DETERMINE POSITION OF DIGIT TO BE MOVED B4  COMMA              CEU006
     C                     SUB  1         X                               CEU006
     C                     Z-ADDX         Z       20                      CEU006
     C*    DO OPERATIONS MOVING CHARACTERS ONE AT A TIME                  CEU006
     C*    FROM RIGHT TO LEFT                                             CEU006
     C                     DO   X                                         CEU006
     C                     MOVE AMT,Z     AM,Y                            CEU006
     C                     SUB  1         Z                               CEU006
     C                     SUB  1         Y                               CEU006
     C                     END                                            CEU006
     C                     END                             E001           CEU006
     C*    SET INDEX TO 1                                                 CEU006
     C                     Z-ADD1         Y                               CEU006
     C*    REPLACE LEADING ZEROS WITH BLANK                               CEU006
     C           AM,Y      DOWEQ'0'                                       CEU006
     C           Y         CABEQW         ERITAG                          CEU006
     C                     MOVE ' '       AM,Y                            CEU006
     C                     ADD  1         Y                               CEU006
     C                     END                                            CEU006
     C*  ** SAVE FIELD FROM ARRAY                                         CEU006
     C           ERITAG    TAG                                            CEU006
     C                     MOVEAAM        AMX    14                       CEU006
     C                     MOVE AMX       SAM    15                       CEU006
     C                     MOVEASAM       FAMT                            CEU006
     C                     Z-ADD1         S       30                      CEU006
     C           FAMT,S    DOWEQ' '                                       CEU006
     C                     ADD  1         S                               CEU006
     C                     END                                            CEU006
     C                     MOVEAFAMT,S    O#AMNT                          CEU006
     C*                                                                   CSW020
     C** If CSW020 is switched on perform Swift Decimal Places processing CSW020
     C                     ELSE                                           CSW020
     C*                                                                   CSW020
     C                     CALL 'ZM0040'                                  CSW020
     C                     PARM PDAM      ZAMNT  130                      CSW020
     C                     PARM PDCY      ZCCY    3                       CSW020
     C                     PARM *BLANKS   ZSAMNT 15                       CSW020
     C                     PARM *BLANKS   ZSCCY   3                       CSW020
     C                     PARM *BLANKS   ZERR    1                       CSW020
     C*                                                                   CSW020
     C** Handle Database Error                                            CSW020
     C           ZERR      IFEQ '1'                                       CSW020
     C                     MOVEL'ZM0040  'DBFNAM           ************   CSW020
     C                     MOVELPCCY      DBERKY           * DBERR 34 *   CSW020
     C                     MOVE '34'      DBERR#           ************   CSW020
     C                     EXSR DBERR                                     CSW020
     C*                                                                   CSW020
     C                     ELSE                                           CSW020
     C                     MOVE ZSAMNT    O#AMNT                          CSW020
     C                     MOVE ZSCCY     O#CCY                           CSW020
     C                     ENDIF                                          CSW020
     C*                                                                   CSW020
     C                     ENDIF                                          CSW020
     C*                                                                   CSW020
     C** Place ending '/' for field 72.                                   149197
     C                     MOVEA*BLANKS   @STR                            149197
     C                     Z-ADD1         N       20                      149197
     C                     MOVEAO#OCMT    @STR                            149197
     C           ' '       LOKUP@STR,N                   60               149197
     C                     MOVEA'/'       @STR,N                          149197
     C                     MOVEA@STR      O#OCMT                          149197
     C**                                                                  149197
      *                                                                   CEU006
      * Format /CHGS/ line if:                                            CEU006
      * - Add/Deduct Charges = D and                                      CEU006
      * - Charges to Debit Of = 0 and                                     CEU006
      * - Total Charges <> 0                                              CEU006
     C           ADDC      IFEQ 'D'                                       CEU006
     C***********CDRO      ANDEQ0                                                      CEU006 CSD027
     C           CDRO      ANDEQ*BLANKS                                                       CSD027
     C           W#CHGS    ANDNE0                                         CEU006
     C*                                                                   CSW020
     C** Perform Old Processing if CSW020 is not switched on.             CSW020
     C           CSW020    IFNE 'Y'                                       CSW020
      *                                                                   CEU006
      * Set charges currency to SWIFT currency code of Pay Currency       CEU006
      * (currency and decimal places saved in SR/SR03)                    CEU006
     C                     MOVELWCCYS     C#CCY                           CEU006
      *                                                                   CEU006
      * Reformat charge amount for SWIFT  -                               CEU006
     C                     MOVE W#CHGS    A#CHGS 13                       CEU006
      *                                                                   CEU006
     C*    DETERMINE DECIMAL POSITION (FOR REPORT)                        CEU006
     C           WCDP      COMP 2                    33  32               CEU006
     C           WCDP      COMP 1                      3031               CEU006
     C*                                                                   CEU006
     C*    DETERMINE DECIMAL POSITION                                     CEU006
     C           14        SUB  WCDP      X       20                      CEU006
     C*    IF 0 DECIMAL PLACES DON'T EDIT                                 CEU006
     C           WCDP      IFEQ 0                          B001           CEU006
     C                     MOVE *BLANK    AMT                             CEU006
     C                     MOVE *ZEROS    AM                              CEU006
     C                     MOVEAA#CHGS    AMT,2                           CEU006
     C                     MOVEAA#CHGS    AM,1                            CEU006
     C                     Z-ADD13        W                               CEU006
     C                     MOVE ','       AM,X                            CEU006
     C                     ELSE                            X001           CEU006
     C*    MOVE AMOUNT INTO ARRAY                                         CEU006
     C                     MOVEAA#CHGS    AMT,1                           CEU006
     C*    DETERMINE POSITION OF DECIMAL DIGITS IN 2ND ARRAY              CEU006
     C           X         ADD  1         Y       20                      CEU006
     C*    MOVE DECIMAL DIGITS INTO 2ND ARRAY FIELD                       CEU006
     C                     MOVEAAMT,X     AM,Y                            CEU006
     C*    DETERMINE POSITION & MOVE COMMA                                CEU006
     C                     SUB  1         Y                               CEU006
     C                     MOVE ','       AM,Y                            CEU006
     C*    DETERMINE POSITION OF DIGIT B4  COMMA                          CEU006
     C                     SUB  1         Y                               CEU006
     C*    SAVE POSITION OF DIGIT B4  COMMA                               CEU006
     C                     Z-ADDY         W       20                      CEU006
     C*    DETERMINE POSITION OF DIGIT TO BE MOVED B4  COMMA              CEU006
     C                     SUB  1         X                               CEU006
     C                     Z-ADDX         Z       20                      CEU006
     C*    DO OPERATIONS MOVING CHARACTERS ONE AT A TIME                  CEU006
     C*    FROM RIGHT TO LEFT                                             CEU006
     C                     DO   X                                         CEU006
     C                     MOVE AMT,Z     AM,Y                            CEU006
     C                     SUB  1         Z                               CEU006
     C                     SUB  1         Y                               CEU006
     C                     END                                            CEU006
     C                     END                             E001           CEU006
     C*    SET INDEX TO 1                                                 CEU006
     C                     Z-ADD1         Y                               CEU006
     C*    REPLACE LEADING ZEROS WITH BLANK                               CEU006
     C           AM,Y      DOWEQ'0'                                       CEU006
     C           Y         CABEQW         ERITG2                          CEU006
     C                     MOVE ' '       AM,Y                            CEU006
     C                     ADD  1         Y                               CEU006
     C                     END                                            CEU006
     C*  ** SAVE FIELD FROM ARRAY                                         CEU006
     C           ERITG2    TAG                                            CEU006
     C                     MOVEAAM        AMX    14                       CEU006
     C                     MOVE AMX       SAM    15                       CEU006
     C                     MOVEASAM       FAMT                            CEU006
     C                     Z-ADD1         S       30                      CEU006
     C           FAMT,S    DOWEQ' '                                       CEU006
     C                     ADD  1         S                               CEU006
     C                     END                                            CEU006
     C                     MOVEAFAMT,S    C#AMNT                          CEU006
     C*                                                                   CSW020
     C** If CSW020 is switched on perform Swift Decimal Places processing CSW020
     C                     ELSE                                           CSW020
     C*                                                                   CSW020
     C                     CALL 'ZM0040'                                  CSW020
     C                     PARM W#CHGS    ZAMNT                           CSW020
     C                     PARM PCCY      ZCCY                            CSW020
     C                     PARM *BLANKS   ZSAMNT                          CSW020
     C                     PARM *BLANKS   ZSCCY                           CSW020
     C                     PARM *BLANKS   ZERR                            CSW020
     C*                                                                   CSW020
     C** Handle Database Error                                            CSW020
     C           ZERR      IFEQ '1'                                       CSW020
     C                     MOVEL'ZM0040  'DBFNAM           ************   CSW020
     C                     MOVELPCCY      DBERKY           * DBERR 34 *   CSW020
     C                     MOVE '35'      DBERR#           ************   CSW020
     C                     EXSR DBERR                                     CSW020
     C*                                                                   CSW020
     C                     ELSE                                           CSW020
     C                     MOVE ZSAMNT    C#AMNT                          CSW020
     C                     MOVE ZSCCY     C#CCY                           CSW020
     C                     ENDIF                                          CSW020
     C*                                                                   CSW020
     C                     ENDIF                                          CSW020
     C*                                                                   CSW020
     C** Place ending '/' for field 72.                                   151235
     C                     MOVEA*BLANKS   @STR                            151235
     C                     Z-ADD1         N                               151235
     C                     MOVEAC#CHGS    @STR                            151235
     C           ' '       LOKUP@STR,N                   60               151235
     C                     MOVEA'/'       @STR,N                          151235
     C                     MOVEA@STR      C#CHGS                          151235
      *                                                                   CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
     C                     ENDSR                                          CEU006
     C*****************************************************************   CEU006
     C*****************************************************************   S01310
     C*   FSWAD - Format SWIFT address                                *   S01310
     C*   Called by - main process.                                   *   S01310
     C*   Calls     -                                                 *   S01310
     C*****************************************************************   S01310
     C*                                                                   S01310
     C           FSWAD     BEGSR                                          S01310
     C*                                                                   S01310
     C**  Address 1                                                       S01310
     C                     MOVELOFSPT1    MFLD                            S01310
     C*                                                                   S01310
     C**  SWIFT address;  Else full address                               S01310
     C           OSTAG     IFEQ 'A'                                       S01310
     C                     MOVE 'A'       TAG                             S01310
     C                     MOVE @MTAG     MTAG                            S01310
     C**  Address 2                                                       S01435
     C                     MOVE *BLANKS   SAVMTG  5                       138077
     C           OFSPT2    IFNE *BLANKS                                   S01435
     C                     MOVE MTAG      SAVMTG                          138077
     C                     ADD  1         Q                               S01435
     C           Q         OCUR MULT                                      S01435
     C                     MOVELOFSPT2    MFLD                            S01435
     C                     END                                            S01435
     C                     EXSR SEXTN                                     138077
     C                     END                                            S01310
     C*                                                                   S01310
     C           OSTAG     IFEQ 'B'                                       S01310
     C                     MOVE 'B'       TAG                             S01310
     C                     MOVE @MTAG     MTAG                            S01310
     C                     END                                            S01310
     C*                                                                   S01310
     C           OSTAG     IFEQ 'D'                                       S01310
     C                     MOVE 'D'       TAG                             S01310
     C                     MOVE @MTAG     MTAG                            S01310
     C**  Address 2                                                       S01310
     C           OFSPT2    IFNE *BLANKS                                   S01310
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     MOVELOFSPT2    MFLD                            S01310
     C**  Address 3                                                       S01310
     C           OFSPT3    IFNE *BLANKS                                   S01310
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     MOVELOFSPT3    MFLD                            S01310
     C**  Address 4                                                       S01310
     C           OFSPT4    IFNE *BLANKS                                   S01310
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     MOVELOFSPT4    MFLD                            S01310
     C**  Address 5                                                       S01310
     C           OFSPT5    IFNE *BLANKS                                   S01310
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     MOVELOFSPT5    MFLD                            S01310
     C                     END                             Address 5      S01310
     C                     END                             Address 4      S01310
     C                     END                             Address 3      S01310
     C                     END                             Address 2      S01310
     C                     END                             Address 1      S01310
      *                                                                                       CSW209
     C           CSW209    IFEQ 'Y'                                                           CSW209
      *                                                                                       CSW209
     C           OSTAG     IFEQ 'K'                                                           CSW209
      *                                                                                       CSW209
     C                     MOVE 'K'       TAG                                                 CSW209
     C                     MOVE @MTAG     MTAG                                                CSW209
      *                                                                                       CSW209
      ** ADDRESS 2                                                                            CSW209
      *                                                                                       CSW209
     C           OFSPT2    IFNE *BLANKS                                                       CSW209
     C                     ADD  1         Q                                                   CSW209
     C           Q         OCUR MULT                                                          CSW209
     C                     MOVELOFSPT2    MFLD                                                CSW209
      *                                                                                       CSW209
      ** ADDRESS 3                                                                            CSW209
      *                                                                                       CSW209
     C           OFSPT3    IFNE *BLANKS                                                       CSW209
     C                     ADD  1         Q                                                   CSW209
     C           Q         OCUR MULT                                                          CSW209
     C                     MOVELOFSPT3    MFLD                                                CSW209
      *                                                                                       CSW209
      ** Address 4                                                                            CSW209
      *                                                                                       CSW209
     C           OFSPT4    IFNE *BLANKS                                                       CSW209
     C                     ADD  1         Q                                                   CSW209
     C           Q         OCUR MULT                                                          CSW209
     C                     MOVELOFSPT4    MFLD                                                CSW209
      *                                                                                       CSW209
      ** Address 5                                                                            CSW209
      *                                                                                       CSW209
     C           OFSPT5    IFNE *BLANKS                                                       CSW209
     C                     ADD  1         Q                                                   CSW209
     C           Q         OCUR MULT                                                          CSW209
     C                     MOVELOFSPT5    MFLD                                                CSW209
     C                     ENDIF                                                              CSW209
     C                     ENDIF                                                              CSW209
     C                     ENDIF                                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C           OSTAG     IFEQ 'F'                                                           CSW209
      *                                                                                       CSW209
     C                     MOVE 'F'       TAG                                                 CSW209
     C                     MOVE @MTAG     MTAG                                                CSW209
     C                     MOVE MTAG      SAVMTG    P                                         CSW209
     C                     MOVELPMSGL1    MFLD                                                CSW209
      * Address 2                                                                             CSW209
     C           PMSGL2    IFNE *BLANKS                                                       CSW209
     C                     ADD  1         Q                                                   CSW209
     C           Q         OCUR MULT                                                          CSW209
     C                     MOVELPMSGL2    MFLD                                                CSW209
      * Address 3                                                                             CSW209
     C           PMSGL3    IFNE *BLANKS                                                       CSW209
     C                     ADD  1         Q                                                   CSW209
     C           Q         OCUR MULT                                                          CSW209
     C                     MOVELPMSGL3    MFLD                                                CSW209
      * Address 4                                                                             CSW209
     C           PMSGL4    IFNE *BLANKS                                                       CSW209
     C                     ADD  1         Q                                                   CSW209
     C           Q         OCUR MULT                                                          CSW209
     C                     MOVELPMSGL4    MFLD                                                CSW209
      * Address 5                                                                             CSW209
     C           PMSGL5    IFNE *BLANKS                                                       CSW209
     C                     ADD  1         Q                                                   CSW209
     C           Q         OCUR MULT                                                          CSW209
     C                     MOVELPMSGL5    MFLD                                                CSW209
     C                     ENDIF                                                              CSW209
     C                     ENDIF                                                              CSW209
     C                     ENDIF                                                              CSW209
     C                     ENDIF                                                              CSW209
     C           PACCTP    IFNE 'A'                                                           CSW209
     C           PACCTP    ANDNE'S'                                                           CSW209
     C           PACCTP    ANDNE' '                                                           CSW209
     C                     EXSR SEXTN                                                         CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     ENDIF                                                              CSW209
     C                     ENDIF                                                              CSW209
     C*                                                                   S01310
     C                     ENDSR                                          S01310
     C/EJECT                                                              S01310
     C****************************************************************
     C****************************************************************
     C*    FIRST RECORD PROCESSING
     C*    FIRST SR.
     C*
     C           FIRST     BEGSR
     C*                                                                   S01117
      *                                                                   S01408
     C/COPY WNCPYSRC,FT0645CCP1                                           S01408
      *                                                                   S01408
     C           *NAMVAR   DEFN           RUNDAT                          S01117
     C                     IN   RUNDAT                                    S01117
     C*                                                                   S01117
     C* IF MULTIBRANCH INDICATOR IS ACTIVE FROM RUNDAT                    S01117
     C*                                                                   S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C                     MOVE '1'       *IN50                           S01117
     C                     END                                            S01117
     C* MOVE REPORT NAME AND SPOOL FILE NBR TO ZSFILE AND CALL ZSFILE     S01117
     C                     Z-ADDSFNUM1    SPLNO                           S01117
     C                     MOVELSFILE1    SFILP                           S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           RSEQ    5                       S01117
     C                     PARM *BLANKS   RENT    3                       S01117
     C                     PARM           SFILP  10                       S01117
     C                     PARM           SPLNO   60                      S01117
     C                     PARM *BLANKS   ZERR    1                       S01117
     C*                                                                   S01117
     C* IF ERROR PERFORM DATABASE ERROR HANDLING AND EXIT PROGRAM         S01117
     C*                                                                   S01117
     C           ZERR      IFEQ 'Y'                                       S01117
     C           *LOCK     IN   DLDA                                      S01117
     C                     MOVEL'FT0645'  DBPGM            ***************S01117
     C                     MOVEL'FT0645P1'DBKEY            ** DBERR  20 **S01117
     C                     MOVEL'ZSFILE'  DBFILE           ***************S01117
     C                     Z-ADD20        DBASE                           S01117
     C                     OUT  DLDA                                      S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C* MOVE REPORT NAME AND SPOOL FILE NBR TO ZSFILE AND CALL ZSFILE     S01117
     C                     Z-ADDSFNUM2    SPLNO                           S01117
     C                     MOVELSFILE2    SFILP                           S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           RSEQ    5                       S01117
     C                     PARM *BLANKS   RENT    3                       S01117
     C                     PARM           SFILP  10                       S01117
     C                     PARM           SPLNO   60                      S01117
     C                     PARM *BLANKS   ZERR    1                       S01117
     C*                                                                   S01117
     C* IF ERROR PERFORM DATABASE ERROR HANDLING AND EXIT PROGRAM         S01117
     C*                                                                   S01117
     C           ZERR      IFEQ 'Y'                                       S01117
     C           *LOCK     IN   DLDA                                      S01117
     C                     MOVEL'FT0645'  DBPGM            ***************S01117
     C                     MOVEL'FT0645P2'DBKEY            ** DBERR  21 **S01117
     C                     MOVEL'ZSFILE'  DBFILE           ***************S01117
     C                     Z-ADD21        DBASE                           S01117
     C                     OUT  DLDA                                      S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C* MOVE AUDIT REPORT NAME AND SPOOL FILE NBR TO ZSFILE AND           S01117
     C* CALL ZSFILE                                                       S01117
     C                     Z-ADDSFNUMU    SPLNO                           S01117
     C                     MOVELSFILEU    SFILP                           S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           RSEQ    5                       S01117
     C                     PARM *BLANKS   RENT    3                       S01117
     C                     PARM           SFILP  10                       S01117
     C                     PARM           SPLNO   60                      S01117
     C                     PARM *BLANKS   ZERR    1                       S01117
     C*                                                                   S01117
     C* IF ERROR PERFORM DATABASE ERROR HANDLING AND EXIT PROGRAM         S01117
     C*                                                                   S01117
     C           ZERR      IFEQ 'Y'                                       S01117
     C           *LOCK     IN   DLDA                                      S01117
     C                     MOVEL'FT0645'  DBPGM            ***************S01117
     C                     MOVEL'FT0645AU'DBKEY            ** DBERR  27 **S01117
     C                     MOVEL'ZSFILE'  DBFILE           ***************S01117
     C                     Z-ADD27        DBASE                           S01117
     C                     OUT  DLDA                                      S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*    INITIALISE RECORD COUNTERS                                  ***
     C*********************Z-ADD0         P3NO1                           S01117
     C                     Z-ADD0         AUNO1                           S01117
     C*********************Z-ADD0         P3NO2                           S01117
     C*********************Z-ADD0         AUNO2                     S01117S01310
     C*********************Z-ADD0         P3NO3                           S01117
     C*********************Z-ADD0         AUNO3                     S01117S01310
     C                     Z-ADD0         PAGEP1
     C                     Z-ADD0         PAGEP2
     C/COPY WNCPYSRC,FT0645C013
     C*********************Z-ADD0         PAGEP3                          S01117
     C                     Z-ADD0         PAGEAU                          S01117
     C*                                                     **************
     C**   SET UP FIELDS IN DATA STRUCTURE TO PROVIDE TEXT
     C*     ON COMIT ENTRY IN JOURNAL                                  ***
     C                     MOVE 'FT'      MDID
     C                     MOVEL'FT0645'  PGMN
     C                     TIME           MTIME
     C                     Z-ADDMTIME     NATN
     C                     MOVE USRID     USRIDX
     C                     MOVE 'BANK '   INFO1
     C                     MOVE 'TRANSFER'INFO2
     C                     TIME           TIME    60
     C*                                                     **************
     C**   SET UP KEY AND ACCESS INSTALLATION CONTROL RECORD (TABTB10F)
     C                     MOVEL'01      'ZTABKY 12
     C                     MOVE '  10'    ZTABKY
     C**
     C           ZTABKY    CHAINTABFP                99    ON NOT THERE
     C  N99      RECI      COMP 'D'                  9999  ON, IS DELETED
     C*
     C           *IN99     IFEQ '1'                         ))))))))))))))
     C*********************MOVE 'TABFP'   DBFNAM  5         )))  DATA  )))S01310
     C                     MOVEL'TABFP'   DBFNAM  8         )))  DATA  )))S01310
     C                     MOVELZTABKY    DBERKY 39         )))  BASE  )))
     C                     MOVE '01'      DBERR#  2         ))) ERROR  )))
     C                     EXSR DBERR                       )))   01   )))
     C                     END                              ))))))))))))))
     C*
1492 C**   INSTALLATION CONTROL RECORD FOUND SO SAVE FIELDS
     C                     MOVE RUNA      SRUNA   7        SAVE ALPHA DATE
     C                     MOVE TITL      STITL  53        SAVE TITLE
     C*
1492 C**   SET UP KEY AND ACCESS INSTALLATION CONTROL RECORD (TABTB11F)
     C*
     C                     MOVE *BLANKS   ZTABKY
     C                     MOVEL'01'      ZTABKY
     C                     MOVE '11'      ZTABKY
     C           ZTABKY    CHAINTABFP                10
     C  N10      RECI      COMP 'D'                  1010
     C*
     C           *IN10     IFEQ '1'                         ))))))))))))))
     C*********************MOVE 'TABFP'   DBFNAM            )))  DATA  )))S01310
     C                     MOVEL'TABFP'   DBFNAM            )))  DATA  )))S01310
     C                     MOVELZTABKY    DBERKY            )))  BASE  )))
     C                     MOVE '02'      DBERR#            ))) ERROR  )))
     C                     EXSR DBERR                       )))   02   )))
     C                     END                              ))))))))))))))
     C*
1492 C**   INST. CONTROL RECORD FOUND SO SAVE CUST. NO. OF HEAD OFFICE
     C**********           Z-ADDHEAD      SHEAD   60       SAVE CUST NO OF                    CSD027
     C                     MOVE HEAD      SHEAD   6        SAVE CUST NO OF                    CSD027
     C*********************MOVE FTDB      SDFBR            SAVE BRANCH NUMS01117
     C*
     C****SET*UP*KEY*AND*ACCESS*INST.*CONTROL*REC*BRANCH*CODE*(TABLETR)*  S01117
     C*********************                                               S01117
     C*********************MOVEL'10    '  ZTABKY                          S01117
     C*********************MOVE SDFBR     ZTABKY                          S01117
     C***********ZTABKY****CHAINTABFP                10                   S01117
     C**N10******RECI******COMP 'D'                  1010  ON , DELETED   S01117
     C*********************                                               S01117
     C************IN10*****IFEQ '1'                         ))))))))))))))S01117
     C*********************MOVE 'TABFP'   DBFNAM            )))  DATA  )))S01117
     C*********************MOVELZTABKY    DBERKY            )))  BASE  )))S01117
     C*********************MOVE '03'      DBERR#            ))) ERROR  )))S01117
     C*********************EXSR DBERR                       )))   03   )))S01117
     C*********************END                              ))))))))))))))S01117
     C***SAVE*BRANCH*INTERNAL*CUSTOMER*NO.*                               S01117
     C*********************MOVE BICN      SBICN   60                      S01117
     C***SET*UP*KEY*TO*ACCESS*CLIENT*FILE.*                               S01117
     C*********************MOVE BICN      KCUSNO  60                      S01117
     C*********************MOVE 'A'       KEYA    1                       S01117
     C*********************                                               S01117
     C***ACCESS*CLIENT*FILE*                                              S01117
     C***********CUSKEY****CHAINCLINTCBF             80                   S01117
     C*********************                                               S01117
     C************IN80*****IFEQ '1'                         ))))))))))))))S01117
     C*********************MOVE 'TABFP'   DBFNAM            )))  DATA  )))S01117
     C*********************MOVEL'      A' DBERKY            )))  BASE  )))S01117
     C*********************MOVELKCUSNO    DBERKY            )))  BASE  )))S01117
     C*********************MOVE '04'      DBERR#            ))) ERROR  )))S01117
     C*********************EXSR DBERR                       )))   04   )))S01117
     C*********************END                              ))))))))))))))S01117
     C*********************                                               S01117
     C**************************************
     C*****REMOVE*TERMINAL*ID*             *                              S01117
     C**************************************
     C*********************                                               S01117
     C***MOVE*SWIFT*ADDRESS*IN*DATA*STRUCTURE*                            S01117
     C*********************MOVE CSID      SCSID                           S01117
     C***SAVE***'OUR*TID'*FIELD*IN*WORK*AREA*                             S01117
     C*********************MOVE SCSID     MXOSFT 12                       S01117
     C*********************MOVE TELX      MXOTLX 12                       S01117
     C***ACCESS*TO*SDBRCHL5                                         E22406S01310
     C*********************MOVE BICN      WWBICN  6                 E22406S01310
     C***********WWBICN****CHAINSDBRCHL5             09             E22406S01310
     C**N09******A8TYLC****COMP 'D'                      09         E22406S01310
     C*********************                                         E22406S01310
     C************IN09*****IFEQ '1'                         ))))))))E22406S01310
     C*********************MOVE 'SDBR5'   DBFNAM            )))  DATE22406S01310
     C*********************MOVELA8BICN    DBERKY            )))  BASE22406S01310
     C*********************MOVE '22'      DBERR#            ))) ERROE22406S01310
     C*********************EXSR DBERR                       )))   22E22406S01310
     C*********************END                              ))))))))E22406S01310
     C*********************                                         E22406S01310
     C*********************MOVE A8BTID    SCSID                     E22406S01310
     C*********************MOVE SCSID     MXOSFT 12                 E22406S01310
     C**********           CALL 'AOGELRR0'                                             CFT014 CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM *BLANKS   WRTCD   7                       CFT014
     C                     PARM '*FIRST'  WOPTN   7                       CFT014
     C********** SDGELR    PARM SDGELR    DSFDY                                        CFT014 CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
     C           WRTCD     IFNE *BLANKS                                   CFT014
     C                     MOVE '36'      DBERR#           ************   CFT014
     C                     MOVEL'*FIRST  'DBERKY           * DBERR036 *   CFT014
     C                     MOVEL'SDGELRPD'DBFNAM           ************   CFT014
     C                     EXSR DBERR                                     CFT014
     C                     ENDIF                                          CFT014
     C*
      *                                                                   S01310
      **  Access SDMMODPD for networks available.                         S01310
      *                                                                   S01310
     C                     CALL 'AOMMODR0'                                S01310
     C                     PARM '*MSG   ' @RTCD                           S01310
     C                     PARM '*FIRST ' @OPTN                           S01310
     C           SDMMOD    PARM SDMMOD    DSFDY                           S01310
      *                                                                   S01310
      ** If no record is found on sdmmodpd.                               S01310
      *                                                                   S01310
     C           @RTCD     IFNE *BLANKS                                   S01310
     C                     MOVE '03'      DBERR#             * * * * * * *S01310
     C                     MOVEL'FIRST'   DBERKY             * DBERR 003 *S01310
     C                     MOVEL'SDMMODPD'DBFNAM             * * * * * * *S01310
     C                     EXSR DBERR                                     S01310
     C                     END                                            S01310
      *                                                                   S01310
      **  Access SDMGMEPD for drop SWIFT msg. no. days                    S01310
      *                                                                   S01310
     C                     CALL 'AOMGMER0'                                S01310
     C                     PARM '*MSG   ' @RTCD   7                       S01310
     C                     PARM '*FIRST ' @OPTN   7                       S01310
     C           SDMGME    PARM SDMGME    DSFDY                           S01310
      *                                                                   S01310
      ** If no record is found on SDMGMEPD.                               S01310
      *                                                                   S01310
     C           @RTCD     IFNE *BLANKS                                   S01310
     C                     MOVE '25'      DBERR#             * * * * * * *S01310
     C                     MOVEL'FIRST'   DBERKY             * DBERR 025 *S01310
     C                     MOVEL'SDMGMEPD'DBFNAM             * * * * * * *S01310
     C                     EXSR DBERR                                     S01310
     C                     END                                            S01310
      *                                                                   S01310
      **  Convert history retention date to YYMMDD                        S01310
      *                                                                   S01310
     C           RUND      ADD  ENDSMN    ZMDAY                           S01310
     C                     CALL 'ZM0060'               14                 S01310
     C                     PARM           ZMDAY                           S01310
     C                     PARM           ZMDATE                          S01310
      *                                                                   S01310
      ** If the program ends in error.                                    S01310
      *                                                                   S01310
     C           *IN14     IFEQ '1'                                       S01310
     C                     MOVE '26'      DBERR#             * * * * * * *S01310
     C                     MOVEL'       ' DBERKY             * DBERR 026 *S01310
     C                     MOVEL'ZM0060'  DBFNAM             * * * * * * *S01310
     C                     EXSR DBERR                                     S01310
     C                     END                                            S01310
     C                     MOVE ZMDATE    @HRDT   6                       S01310
     C/COPY WNCPYSRC,FT0645C010
      *                                                                   S01310
      **  Initialise constant fields                                      S01310
      *                                                                   S01310
     C                     MOVE *LOVAL    CR      1                       S01310
     C                     BITON'457'     CR                              S01310
     C                     MOVE *LOVAL    LF      1                       S01310
     C                     BITON'257'     LF                              S01310
     C                     MOVELCR        CRLF    2                       S01310
     C                     MOVE LF        CRLF                            S01310
     C                     MOVE ':'       COLON1                          S01310
     C                     MOVE ':'       COLON2                          S01310
      *                                                                   S01310
      **  CRLF Control Character for message data records                 S01310
      *                                                                   S01310
     C                     MOVE CRLF      CTRC                            S01310
     C*  CHECK TYPE OF RUN
     C           IPPARM    IFEQ 'I'
     C                     SETON                     13
     C                     END
     C*  SET MESSAGE PRODUCTION PARAMETER
     C                     MOVE 'N'       OPPARM  1
     C***SET*UP*HEXADECIMAL VALUE OF X'0D25'                              S01310
     C*********************Z-ADD13        B0D                             S01310
     C*********************Z-ADD37        B25                             S01310
     C*********************MOVELX0D       X0D25                           S01310
     C*********************MOVE X25       X0D25                           S01310
      *                                                                   CEU006
      * Access SAR details to determine if EMU Settlement Details         CEU006
      * switched on (CEU006)                                              CEU006
     C                     CALL 'AOSARDR0'                                CEU006
     C                     PARM *BLANKS   @RTCD                           CEU006
     C                     PARM '*VERIFY' @OPTN                           CEU006
     C                     PARM 'CEU006'  @SARD   6                       CEU006
     C           SCSARD    PARM SCSARD    DSFDY                           CEU006
     C*                                                                   CEU006
     C** If core feature is switched ON, set a variable field to          CEU006
     C** condition the rest of the processing                             CEU006
     C*                                                                   CEU006
     C           @RTCD     IFEQ *BLANKS                                   CEU006
     C                     MOVE 'Y'       CEU006  1                       CEU006
     C                     ELSE                                           CEU006
     C*                                                                   CEU006
     C** else, database error (return code other than *NRF)               CEU006
     C*                                                                   CEU006
     C           @RTCD     IFNE '*NRF   '                                 CEU006
     C                     MOVEL'SCSARDPD'DBFNAM           ************   CEU006
     C                     MOVEL'*VERIFY' DBERKY           * DBERR 30 *   CEU006
     C                     MOVE '30'      DBERR#           ************   CEU006
     C                     EXSR DBERR                                     CEU006
     C                     END                                            CEU006
     C                     END                                            CEU006
     C*C*PY*W*C*Y*RC*FT0645C026**********************                     185702
     C/COPY WNCPYSRC,FT0645DUP                                            185702
      * Access SAR details to determine if SWIFT Decimal Places is        CSW020
      * switched on (CSW020)                                              CSW020
     C                     CALL 'AOSARDR0'                                CSW020
     C                     PARM *BLANKS   @RTCD                           CSW020
     C                     PARM '*VERIFY' @OPTN                           CSW020
     C                     PARM 'CSW020'  @SARD   6                       CSW020
     C           SCSARD    PARM SCSARD    DSFDY                           CSW020
     C*                                                                   CSW020
     C** If core feature is switched ON, set a variable field to          CSW020
     C** condition the rest of the processing                             CSW020
     C*                                                                   CSW020
     C           @RTCD     IFEQ *BLANKS                                   CSW020
     C                     MOVE 'Y'       CSW020  1                       CSW020
     C                     ELSE                                           CSW020
     C*                                                                   CSW020
     C** else, database error (return code other than *NRF)               CSW020
     C*                                                                   CSW020
     C           @RTCD     IFNE '*NRF   '                                 CSW020
     C                     MOVEL'SCSARDPD'DBFNAM           ************   CSW020
     C                     MOVEL'*VERIFY' DBERKY           * DBERR 32 *   CSW020
     C                     MOVE '32'      DBERR#           ************   CSW020
     C                     EXSR DBERR                                     CSW020
     C                     END                                            CSW020
     C                     END                                            CSW020
      *                                                                   CSW020
     C/COPY WNCPYSRC,FT0645C040
      *                                                                   CFT004
      * Access SAR details to determine if IBAN validation is             CFT004
      * switched on (CFT004)                                              CFT004
     C                     CALL 'AOSARDR0'                                CFT004
     C                     PARM *BLANKS   @RTCD                           CFT004
     C                     PARM '*VERIFY' @OPTN                           CFT004
     C                     PARM 'CFT004'  @SARD   6                       CFT004
     C           SCSARD    PARM SCSARD    DSFDY                           CFT004
     C*                                                                   CFT004
     C** If core feature is switched ON, set a variable field to          CFT004
     C** condition the rest of the processing                             CFT004
     C*                                                                   CFT004
     C           @RTCD     IFEQ *BLANKS                                   CFT004
     C                     MOVE 'Y'       CFT004  1                       CFT004
     C                     ELSE                                           CFT004
     C*                                                                   CFT004
     C** else, database error (return code other than *NRF)               CFT004
     C*                                                                   CFT004
     C           @RTCD     IFNE '*NRF   '                                 CFT004
     C                     MOVEL'SCSARDPD'DBFNAM           ************   CFT004
     C                     MOVEL'*VERIFY' DBERKY           * DBERR 29 *   CFT004
     C                     MOVE '29'      DBERR#           ************   CFT004
     C                     EXSR DBERR                                     CFT004
     C                     END                                            CFT004
     C                     END                                            CFT004
      *                                                                   CSW020
      * Access SAR details to determine if CFT009 is switched on          CFT009
      *                                                                   CFT009
     C                     CALL 'AOSARDR0'                                CFT009
     C                     PARM *BLANKS   @RTCD                           CFT009
     C                     PARM '*VERIFY' @OPTN                           CFT009
     C                     PARM 'CFT009'  @SARD   6                       CFT009
     C           SCSARD    PARM SCSARD    DSFDY                           CFT009
     C*                                                                   CFT009
     C** If core feature is switched ON, set a variable field to          CFT009
     C** condition the rest of the processing                             CFT009
     C*                                                                   CFT009
     C           @RTCD     IFEQ *BLANKS                                   CFT009
     C                     MOVE 'Y'       CFT009  1                       CFT009
     C                     ELSE                                           CFT009
     C*                                                                   CFT009
     C** else, database error (return code other than *NRF)               CFT009
     C*                                                                   CFT009
     C           @RTCD     IFNE '*NRF   '                                 CFT009
     C                     MOVEL'SCSARDPD'DBFNAM           ************   CFT009
     C                     MOVEL'*VERIFY' DBERKY           * DBERR 30 *   CFT009
     C                     MOVE '30'      DBERR#           ************   CFT009
     C                     EXSR DBERR                                     CFT009
     C                     ENDIF                                          CFT009
     C                     MOVE 'N'       CFT009                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                                       CSW202
      ** Check if SWIFT 2001 is on                                                            CSW202
      *                                                                                       CSW202
     C                     CALL 'SWIF2001'                                                    CSW202
     C                     PARM *BLANKS   PRTCD                                               CSW202
      *                                                                                       CSW202
     C           PRTCD     IFEQ 'CSW2001'                                                     CSW202
     C                     MOVE 'Y'       CSW201  1                                           CSW202
     C                     ELSE                                                               CSW202
     C                     MOVE 'N'       CSW201                                              CSW202
     C                     ENDIF                                                              CSW202
      *                                                                                       CSW202
      ** Check if SWIFT 2002 is on                                                            CSW202
      *                                                                                       CSW202
     C                     CALL 'SWIF2002'                                                    CSW202
     C                     PARM *BLANKS   PRTCD                                               CSW202
      *                                                                                       CSW202
     C           PRTCD     IFEQ 'CSW2002'                                                     CSW202
     C                     MOVE 'Y'       CSW202  1                                           CSW202
     C                     ELSE                                                               CSW202
     C                     MOVE 'N'       CSW202                                              CSW202
     C                     ENDIF                                                              CSW202
      *                                                                                       CSW202
      ** Check if SWIFT 2009 is installed                                                     CSW209
      *                                                                                       CSW209
     C                     CALL 'SWIF2009'                                                    CSW209
     C                     PARM           PRTCD                                               CSW209
     C           PRTCD     IFEQ 'CSW2009'                                                     CSW209
     C                     MOVE 'Y'       CSW209  1                                           CSW209
     C                     ELSE                                                               CSW209
     C                     MOVE 'N'       CSW209                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
      ** Access SAR file to determine if Midas Compliance Watch                               CSD015
      ** - Watch List Checking (CSD015) is installed                                          CSD015
      *                                                                                       CSD015
     C                     CALL 'AOSARDR0'                                                    CSD015
     C                     PARM *BLANKS   PRTCD                                               CSD015
     C                     PARM '*VERIFY' POPTN                                               CSD015
     C                     PARM 'CSD015'  @SARD                                               CSD015
     C           SCSARD    PARM SCSARD    DSFDY                                               CSD015
      *                                                                                       CSD015
      ** An NRF (No Record Found) return code is valid.                                       CSD015
      ** Issue database error only for error return codes.                                    CSD015
      *                                                                                       CSD015
     C           PRTCD     IFNE *BLANKS                                                       CSD015
     C           PRTCD     ANDNE'*NRF   '                                                     CSD015
     C                     MOVEL'SCSARDPD'DBFNAM                                              CSD015
     C                     MOVEL'*VERIFY' DBERKY                                              CSD015
     C                     MOVE '052'     DBERR#                                              CSD015
     C                     EXSR DBERR                                                         CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PRTCD     IFEQ *BLANK                                                        CSD015
     C                     MOVEL'Y'       CSD015  1                                           CSD015
      *                                                                                       222385
      ** Access AOWLCCR0 to check if function code MESSGENT is available                      222385
      *                                                                                       222385
     C                     CALL 'AOWLCCR0'                                                    222385
     C                     PARM *BLANKS   PRTCD                                               222385
     C                     PARM '*KEY'    POPTN                                               222385
     C                     PARM 'MESSGENT'PFUNC   8                                           222385
     C           SDWLCC    PARM SDWLCC    DSFDY                                               222385
      *                                                                                       222385
     C           PRTCD     IFNE *BLANKS                                                       222385
     C           PRTCD     ANDNE'*NRF'                                                        222385
     C                     MOVEL'SDWLCCPD'DBFNAM                                              222385
     C                     MOVELPFUNC     DBERKY                                              222385
     C                     MOVEL'32'      DBERR#                                              222385
     C                     EXSR DBERR                                                         222385
     C                     ENDIF                                                              222385
      *                                                                                       222385
     C                     ELSE                                                               CSD015
     C                     MOVEL'N'       CSD015                                              CSD015
     C                     MOVEL'N'       W1EWLC                                              222385
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Check if switchable feature CSW025 is switched on.                                   CSD015
      *                                                                                       CSD015
     C                     CALL 'AOSARDR0'                                                    CSD015
     C                     PARM *BLANKS   PRTCD                                               CSD015
     C                     PARM '*VERIFY' POPTN                                               CSD015
     C                     PARM 'CSW025'  @SARD                                               CSD015
     C           SCSARD    PARM SCSARD    DSFDY                                               CSD015
      *                                                                                       CSD015
      ** Database error                                                                       CSD015
      *                                                                                       CSD015
     C           PRTCD     IFNE *BLANKS                                                       CSD015
     C           PRTCD     ANDNE'*NRF   '                                                     CSD015
     C                     MOVEL'CSW025'  DBERKY                                              CSD015
     C                     MOVEL'SCSARDPD'DBFNAM                                              CSD015
     C                     MOVE '53'      DBERR#                                              CSD015
     C                     EXSR DBERR                                                         CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PRTCD     IFEQ *BLANKS                                                       CSD015
     C                     MOVEL'Y'       CSW025  1                                           CSD015
     C                     ELSE                                                               CSD015
     C                     MOVEL'N'       CSW025                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      **                                                                                      CSC022
      ** Initialize CSC022 and Skip Commit/Rollback flags                                     CSC022
      **                                                                                      CSC022
     C                     MOVE 'N'       CSC022  1                                           CSC022
     C                     MOVE 'N'       WCRSKP  1                                           CSC022
      **                                                                                      CSC022
      ** Access SAR details file to determine if CSC022 switchable feature                    CSC022
      ** is switched on                                                                       CSC022
      **                                                                                      CSC022
     C                     CALL 'AOSARDR0'                                                    CSC022
     C                     PARM *BLANKS   @RTCD                                               CSC022
     C                     PARM '*VERIFY '@OPTN                                               CSC022
     C                     PARM 'CSC022'  @SARD                                               CSC022
     C           SCSARD    PARM SCSARD    DSFDY                                               CSC022
      **                                                                                      CSC022
     C           @RTCD     IFEQ *BLANKS                                                       CSC022
     C                     MOVE 'Y'       CSC022                                              CSC022
      **                                                                                      CSC022
      ** Get Jobs currently running i batch mode using SCCMRJOB dataarea                      CSC022
      **                                                                                      CSC022
     C           *NAMVAR   DEFN SCCMTJOB  SCCMT                                               CSC022
     C                     IN   SCCMT                                                         CSC022
      **                                                                                      CSC022
     C           WCMTNO    IFGT 0                                                             CSC022
      ** Move committed jobs to arrary for checking                                           CSC022
     C                     MOVEAWCJOBS    WCMT                                                CSC022
      ** Verify if job running exists in array                                                CSC022
     C           WJOBNM    LOKUPWCMT                     50                                   CSC022
     C           *IN50     IFEQ *ON                                                           CSC022
     C                     MOVE 'Y'       WCRSKP                                              CSC022
     C                     ENDIF                                                              CSC022
     C                     ENDIF                                                              CSC022
      **                                                                                      CSC022
     C                     ELSE                                                               CSC022
      ** Execute *PSSR if CSC022 is not found or Database error                               CSC022
     C           @RTCD     IFNE '*NRF'                                                        CSC022
     C                     MOVEL'CSC022'  DBERKY                                              CSC022
     C                     MOVEL'SCSARDPD'DBFNAM                                              CSC022
     C                     MOVE '54'      DBERR#                                              CSC022
     C                     EXSR DBERR                                                         CSC022
     C                     ENDIF                                                              CSC022
      **                                                                                      CSC022
     C                     ENDIF                                                              CSC022
      **                                                                                      CSC022
     C                     MOVE 'N'       CFT014  1                                           222448
      *                                                                                       222448
     C                     CALL 'AOSARDR0'                                                    222448
     C                     PARM *BLANKS   @RTCD                                               222448
     C                     PARM '*VERIFY' @OPTN                                               222448
     C                     PARM 'CFT014'  @SARD                                               222448
     C           SCSARD    PARM SCSARD    DSFDY                                               222448
     C           @RTCD     IFEQ *BLANKS                                                       222448
     C                     MOVE 'Y'       CFT014                                              222448
     C                     ELSE                                                               222448
     C           @RTCD     IFNE '*NRF   '                                                     222448
     C                     MOVEL'SCSARDPD'DBFNAM           ************                       222448
     C                     MOVEL'CFT014  'DBERKY           * DBERR 39 *                       222448
     C                     MOVE '39'      DBERR#           ************                       222448
     C                     EXSR DBERR                                                         222448
     C                     ENDIF                                                              222448
     C                     ENDIF                                                              222448
      *                                                                                       222448
      *                                                                                       CSW215
      ** Check if SWIFT 2015 is installed                                                     CSW215
      *                                                                                       CSW215
     C                     CALL 'SWIF2015'                                                    CSW215
     C                     PARM           PRTCD                                               CSW215
     C           PRTCD     IFEQ 'CSW2015'                                                     CSW215
     C                     MOVE 'Y'       CSW215  1                                           CSW215
     C                     ELSE                                                               CSW215
     C                     MOVE 'N'       CSW215                                              CSW215
     C                     ENDIF                                                              CSW215
      *                                                                                       CSW218
      ** Check if switchable feature CSW218 is switched on                                    CSW218
      *                                                                                       CSW218
     C                     CALL 'SWIF2018'                                                    CSW218
     C                     PARM *BLANKS   PRTCD                                               CSW218
      *                                                                                       CSW218
     C           PRTCD     IFEQ 'CSW2018'                                                     CSW218
     C                     MOVEL'Y'       CSW218  1                                           CSW218
     C                     ELSE                                                               CSW218
     C                     MOVEL'N'       CSW218                                              CSW218
     C                     ENDIF                                                              CSW218
     C           KYINCM    KLIST                                                              CSW218
     C                     KFLD           OPMSGR                                              CSW218
     C                     KFLD           WTAG12  5                                           CSW218
     C*                                                                   CFT009
     C/COPY WNCPYSRC,HUT110_043                                                               HUT110
     C/COPY WNCPYSRC,FT0645C026
      *                                                                   CEU006
     C           TAGEND    TAG                              TAG: TAGEND
     C                     SETON                     40     1ST CYCLE DONE
     C                     ENDSR
     C/EJECT                                                              S01117
     C*****************************************************************   S01117
     C*   SUBROUTINE BRANCH                                   *           S01117
     C*     TO VALIDATE EACH BOOKING BRANCH FOR EVERY RECORD  *           S01117
     C*     CALLED BY MAIN PROCESSING                         *           S01117
     C*********************************************************           S01117
     C*                                                                   S01117
     C           BRANCH    BEGSR                                          S01117
     C*   SAVE BOOKING BRANCH (BRCA) READ FROM OTPAYDD FILE               S01117
     C                     MOVE BRCA      BRCAA   3                       S01117
     C*   SET UP KEY AND ACCESS INST. CONTROL REC BRANCH CODE (TABLETR)   S01117
     C*                                                                   S01117
     C**********           MOVEL'10    '  ZTABKY                                     S01117 BUG13217
     C**********           MOVE BRCA      ZTABKY                                     S01117 BUG13217
     C********** ZTABKY    CHAINTABFP                10                              S01117 BUG13217
     C**N10***** RECI      COMP 'D'                  1010  ON , DELETED              S01117 BUG13217
     C**********                                                                     S01117 BUG13217
     C********** *IN10     IFEQ '1'                         ))))))))))))))           S01117 BUG13217
     C*********************MOVE 'TABFP'   DBFNAM            )))  DATS01117S01310
     C**********           MOVEL'TABFP'   DBFNAM            )))  DATS01117           S01310 BUG13217
     C**********           MOVELZTABKY    DBERKY            )))  BASE  )))           S01117 BUG13217
     C**********           MOVE '03'      DBERR#            ))) ERROR  )))           S01117 BUG13217
     C**********           EXSR DBERR                       )))   03   )))           S01117 BUG13217
     C**********           END                              ))))))))))))))           S01117 BUG13217
     C*                                                                   S01117
     C*  SAVE BRANCH INTERNAL CUSTOMER NO.                                S01117
     C**********           MOVE BICN      SBICN   60                                   S01117 CSD027
     C**********           MOVE BICN      SBICN   6                                  CSD027 BUG13217
     C***SET*UP*KEY*TO*ACCESS CLIENT FILE.                          S01117S01310
     C*********************MOVE BICN      KCUSNO  60                S01117S01310
     C*********************MOVE 'A'       KEYA    1                 S01117S01310
     C*********************                                         S01117S01310
     C***ACCESS*CLIENT*FILE                                         S01117S01310
     C***********BICN******CHAINCLINTCBF             80             S01117S01310
     C************IN80*****IFEQ '1'                         ))))))))S01117S01310
     C*********************MOVE 'TABFP'   DBFNAM            )))  DATS01117S01310
     C*********************MOVEL'      A' DBERKY            )))  BASS01117S01310
     C*********************MOVELBICN      DBERKY            )))  BASS01117S01310
     C*********************MOVE '04'      DBERR#            ))) ERROS01117S01310
     C*********************EXSR DBERR                       )))   04S01117S01310
     C*********************END                              ))))))))S01117S01310
      *                                                                   S01310
      *                                                                                     BUG13217
      ** Access SDBRCHPD instead of TABLETR using Branch Code as record key                 BUG13217
      *                                                                                     BUG13217
     C                     MOVELBRCA      WWBRCA  3                                         BUG13217
     C           WWBRCA    CHAINSDBRCHL1             10                                     BUG13217
     C  N10      A8TYLC    COMP 'D'                      10  IF *IN10 IS ON (DELETED)       BUG13217
      *                                                                                     BUG13217
     C           *IN10     IFEQ *ON                                                         BUG13217
     C                     MOVEL'SDBRCHL1'DBFNAM                                            BUG13217
     C                     MOVELWWBRCA    DBERKY                                            BUG13217
     C                     MOVE '22'      DBERR#                                            BUG13217
     C                     EXSR DBERR                                                       BUG13217
     C                     ENDIF                                                            BUG13217
     C                     MOVE A8BICN    SBICN   6                                         BUG13217
     C                     MOVE A8BTID    SNCSID                                            BUG13217
     C                     MOVE A8BTID    SCSID                                             BUG13217
     C                     MOVE SCSID     MXOSFT 12                                         BUG13217
      *                                                                                     BUG13217
      **  Access SDCUSTPD using branch internal customer number           S01310
      *                                                                   S01310
     C                     MOVE *BLANKS   @KEY1                           S01310
     C**********           MOVELBICN      @KEY1                                      S01310 BUG13217
     C                     MOVELA8BICN    @KEY1                                             BUG13217
     C                     CALL 'AOCUSTR0'                                S01310
     C                     PARM '*MSG   ' @RTCD   7                       S01310
     C                     PARM '*KEY   ' @OPTN   7                       S01310
     C                     PARM           @KEY1  10                       S01310
     C                     PARM *BLANKS   @KYST   7                       S01310
     C           SDCUST    PARM SDCUST    DSSDY                           S01310
      *                                                                   S01310
      ** Customer record not found - Error                                S01310
      *                                                                   S01310
     C           @RTCD     IFNE *BLANKS                                   S01310
     C                     MOVE '004'     DBERR#             * * * * * * *S01310
     C                     MOVEL@KEY1     DBERKY             * DBERR 004 *S01310
     C                     MOVEL'SDCUSTPD'DBFNAM             * * * * * * *S01310
     C                     EXSR DBERR                                     S01310
     C                     END                                            S01310
      *                                                                   S01310
      **  Save sender's addresses & parent customer number                S01310
      *                                                                   S01310
     C***********          MOVE BBCSID    SNCSID 12                 S01310064393
     C                     MOVE BBTXA1    STELX  10                       S01310
     C                     MOVE BBSTAD    SSTTX  12                       S01310
     C                     MOVE BBCRNM    SCRNM  20                       S01310
      *                                                                   S01310
      ** Move new field names to old to ensure pgm continuity.            S01310
      *                                                                   S01310
     C                     MOVE BBCSID    CSID   12                       S01310
     C                     MOVELBBTXA1    TELX   12                       S01310
     C*                                                                   S01117
     C**************************************                              S01117
     C*    REMOVE TERMINAL ID              *                              S01117
     C**************************************                              S01117
     C*                                                                   S01117
     C*  SAVE   'OUR TID' FIELD IN WORK AREA                              S01117
     C                     MOVE TELX      MXOTLX 12                       S01117
     C** ACCESS TO SDBRCHL5                                               S01310
     C**********           MOVE BICN      WWBICN  6                                  S01310 BUG13217
     C********** WWBICN    CHAINSDBRCHL5             09                              S01310 BUG13217
     C**N09***** A8TYLC    COMP 'D'                      09                          S01310 BUG13217
     C**********                                                                     S01310 BUG13217
     C********** *IN09     IFEQ '1'                         ))))))))))))))           S01310 BUG13217
     C**********           MOVEL'SDBRCHL5'DBFNAM            )))  DATA  )))           S01310 BUG13217
     C**********           MOVELA8BICN    DBERKY            )))  BASE  )))           S01310 BUG13217
     C**********           MOVE '22'      DBERR#            ))) ERROR  )))           S01310 BUG13217
     C**********           EXSR DBERR                       )))   22   )))           S01310 BUG13217
     C**********           END                              ))))))))))))))           S01310 BUG13217
     C*                                                                   S01310
     C**********           MOVE A8BTID    SNCSID                                     064393 BUG13217
     C**********           MOVE A8BTID    SCSID                                      S01310 BUG13217
     C**********           MOVE SCSID     MXOSFT 12                                  S01310 BUG13217
     C                     ENDSR                                          S01117
     C/EJECT
4630 C********************************************************************
     C********************************************************************
     C********************************************************************
     C*     *         SUBROUTINE 01                         ***        ***
     C*     *   TO FORMAT SETTLEMENT PARTY TO SWIFT FORMAT  ***        ***
     C*     *                                               ***        ***
     C*********************************************************        ***
     C           SR01      BEGSR                            ***        ***
     C*   INITIALISE OUTPUT PARAMETER FIELDS                           ***
     C                     MOVE *BLANKS   OFSPT1 35
     C                     MOVE *BLANKS   OFSPT2 35
     C                     MOVE *BLANKS   OFSPT3 35
     C                     MOVE *BLANKS   OFSPT4 35
     C                     MOVE *BLANKS   OFSPT5 35
     C                     MOVE *BLANKS   OSTAG   1
     C                     MOVE 'N'       OSUFLG  1
     C*                                                                ***
     C*   FULL NOSTRO PROCESSING - APPEND THE PAY CURRENCY TO THE      ***
     C*   FIRST SETTLEMENT PARTY FIELD TO ACCESS NOSTRO DET FROM
     C*   PF/TABLETL TO OBTAIN CUST NO.                                ***
     C           ISPTP     IFEQ 'F'
     C                     MOVELISPTY1    TLCCNN  5        BUILD
     C                     MOVEL'70'      TABTLK 12           KEY
     C                     MOVE TLCCNN    TABTLK 12            KEY
     C           TABTLK    CHAINTABFP                10    ON, DELETED
     C           *IN10     IFEQ '1'                         ))))))))))))))
     C*********************MOVE 'TABFP'   DBFNAM  5         )))  DATA  )))S01310
     C                     MOVEL'TABFP'   DBFNAM            )))  DATA  )))S01310
     C                     MOVELTABTLK    DBERKY 39         )))  BASE  )))
     C                     MOVE '06'      DBERR#  2         ))) ERROR  )))
     C                     EXSR DBERR                       )))   06   )))
     C                     END                              ))))))))))))))
     C**********           MOVE CNUM      CUSTNO  60                                          CSD027
     C                     MOVE CNUM      CUSTNO  6                                           CSD027
     C                     END
     C*                                                                ***
     C*   NOSTRO NO. PROCESSING - APPEND THE PAY CURRENCY TO THE       ***
     C*   FIRST 2 CHARS OF THE 1ST SETL PTY FIELD TO ACCESS NOSTRO DET
     C*   FROM PF/TABLETL TO OBTAIN CUST NO.                           ***
     C           ISPTP     IFEQ 'N'
     C                     MOVELISPTY1    TLNN    2        BUILD
     C                     MOVELISCCY     TLCCNN             KEY
     C                     MOVE TLNN      TLCCNN              KEY
     C                     MOVEL'70'      TABTLK                KEY
     C                     MOVE TLCCNN    TABTLK 12              KEY
     C           TABTLK    CHAINTABFP                10    ON, DELETED
     C           *IN10     IFEQ '1'                         ))))))))))))))
     C*********************MOVE 'TABFP'   DBFNAM  5         )))  DATA  )))S01310
     C                     MOVEL'TABFP'   DBFNAM            )))  DATA  )))S01310
     C                     MOVELTABTLK    DBERKY 39         )))  BASE  )))
     C                     MOVE '07'      DBERR#  2         ))) ERROR  )))
     C                     EXSR DBERR                       )))   07   )))
     C                     END                              ))))))))))))))
     C**********           MOVE CNUM      CUSTNO  60                                          CSD027
     C                     MOVE CNUM      CUSTNO  6                                           CSD027
     C                     END
     C*                                                                ***
     C*   RETAIL ACCNT PROCESSING -                                    ***
     C*   USE 1ST 10 CHARS OF THE 1ST SETL PTY FIELD TO ACCESS
     C*   THE ACCOUNT DETAILS FROM LF/ACNUMA TO OBTAIN CUST NO.        ***
     C           ISPTP     IFEQ 'R'
     C                     MOVELISPTY1    ACNUMK 100
     C           ACNUMK    CHAINACNUMA               11    ON, DELETED
     C           *IN11     IFEQ '1'                         ))))))))))))))
     C*********************MOVE 'ACNUMA'  DBFNAM  5         )))  DATA  )))S01310
     C                     MOVEL'ACNUMA'  DBFNAM            )))  DATA  )))S01310
     C                     MOVELACNUMK    DBERKY 39         )))  BASE  )))
     C                     MOVE '08'      DBERR#  2         ))) ERROR  )))
     C                     EXSR DBERR                       )))   08   )))
     C                     END                              ))))))))))))))
     C**********           MOVE CNUM      CUSTNO  60                                          CSD027
     C                     MOVE CNUM      CUSTNO  6                                           CSD027
     C                     END
     C*                                                                ***
     C*   FULL ACCOUNT/PARTIAL ACCOUNT/CUSTOMER PROCESSING - CUST NO.  ***
     C*   IS 1ST 6 CHARS OF THE 1ST SETL PTY FIELD.
     C           ISPTP     IFEQ 'G'
     C           ISPTP     OREQ 'P'
     C           ISPTP     OREQ 'C'
      *                                                                   S01435
      * If using account line construct then use second line              S01435
      *                                                                   S01435
     C                     MOVELISPTY1    ##001   1                       S01435
     C           ##001     IFEQ '/'                                       S01435
     C                     MOVELISPTY2    CUSTNO                          S01435
     C                     ELSE                                           S01435
     C                     MOVELISPTY1    CUSTNO
     C                     END                                            S01435
     C                     END
      *                                                                   S01435
      * If SWIFT identifier then use ME1400 to check details              S01435
      *                                                                   S01435
     C           ISPTP     IFEQ 'S'                                       S01435
      *                                                                   S01435
      *  Call Access object to validate identifier                        S01435
      *                                                                   S01435
     C                     MOVELISPTY1    ##001   1                       S01435
     C           ##001     IFEQ '/'                                       S01435
     C                     MOVELISPTY2    W9BICC                          S01435
     C           3         SUBSTISPTY2:9  W9BICB                          S01435
     C                     ELSE                                           S01435
     C                     MOVELISPTY1    W9BICC                          S01435
     C           3         SUBSTISPTY1:9  W9BICB                          S01435
     C                     END                                            S01435
      *                                                                   S01435
     C                     CALL 'ME1400'                                  S01435
     C                     PARM *BLANKS   W9RTN   7                       S01435
     C                     PARM           W9BICC  8                       S01435
     C                     PARM           W9BICB  3                       S01435
     C                     PARM           SDCUST                          S01435
     C                     PARM           SDCNST                          S01435
     C                     PARM           MEBICD                          S01435
     C                     PARM *BLANKS   W9CUST  1                       S01435
     C                     PARM *BLANKS   W9CNST  1                       S01435
     C                     PARM *BLANKS   W9BICD  1                       S01435
      *                                                                   S01435
      * If customer details exist then set up CUSTNO                      S01435
      *                                                                   S01435
     C           W9CUST    IFEQ 'Y'                                       S01435
     C                     MOVELBBCUST    CUSTNO                          S01435
      *                                                                   S01435
     C                     END                                            S01435
      *                                                                   S01435
     C                     END                                            S01435
      *                                                                   S01435
     C*                                                                ***
     C*   ACCESS FULL CUSTOMER DETAILS FROM LF/CLINT                   ***
     C           ISPTP     IFEQ 'G'
     C           ISPTP     OREQ 'P'
     C           ISPTP     OREQ 'C'
     C           ISPTP     OREQ 'F'
     C           ISPTP     OREQ 'N'
     C           ISPTP     OREQ 'R'
     C           W9CUST    OREQ 'Y'                                       S01435
     C           ISPTP     ANDEQ'S'                                       S01435
     C***SET*UP*CUSTOMER*KEY                                              S01310
     C*********************MOVELCUSTNO    KCUSNO  60                      S01310
     C*********************MOVE 'A'       KEYA    1                       S01310
     C***********CUSKEY****CHAINCLINTCBF             12    ON, DELETED    S01310
     C************IN12*****IFEQ '1'                         ))))))))))))))S01310
     C*********************MOVE 'CLINT'   DBFNAM  5         )))  DATA  )))S01310
     C*********************MOVEL'      A' DBERKY            )))  BASE  )))S01310
     C*********************MOVELKCUSNO    DBERKY            )))  BASE  )))S01310
     C*********************MOVE '09'      DBERR#  2         ))) ERROR  )))S01310
     C*********************EXSR DBERR                       )))   09   )))S01310
     C*********************END                              ))))))))))))))S01310
     C*
     C**********           MOVE CUSTNO    CUSTKY  60                                   S01310 CSD027
     C                     MOVE CUSTNO    CUSTKY  6                                           CSD027
      *                                                                   S01310
      *   Access SDCUSTPD using customer number                           S01310
      *                                                                   S01310
     C                     MOVE *BLANKS   @KEY1                           S01310
     C                     MOVELCUSTKY    @KEY1                           S01310
     C                     CALL 'AOCUSTR0'                                S01310
     C                     PARM '*MSG   ' @RTCD                           S01310
     C                     PARM '*KEY   ' @OPTN                           S01310
     C                     PARM           @KEY1  10                       S01310
     C                     PARM *BLANKS   @KYST   7                       S01310
     C           SDCUST    PARM SDCUST    DSSDY                           S01310
      *                                                                   S01310
      ** Customer record not found - Error                                S01310
      *                                                                   S01310
     C           @RTCD     IFNE *BLANKS                                   S01310
     C                     MOVE '009'     DBERR#             * * * * * * *S01310
     C                     MOVEL@KEY1     DBERKY             * DBERR 009 *S01310
     C                     MOVEL'SDCUSTPD'DBFNAM             * * * * * * *S01310
     C                     EXSR DBERR                                     S01310
     C                     END                                            S01310
      *                                                                   S01310
      ** Move old field names to new to retain pgm continuity.            S01310
      *                                                                   S01310
     C**********           MOVELBBPCNB    CPAR    60                                   S01310 CSD027
     C                     MOVELBBPCNB    CPAR    6                                           CSD027
     C                     MOVELBBCRNM    CRNM   20                       S01310
     C                     MOVELBBCRTN    CTWN   10                       S01310
     C                     MOVELBBCSID    CSID                            S01310
     C/COPY WNCPYSRC,FT0645C004
     C* ACCESS DESTINATION ADDRESS DETAILS VIA SWFT SUBROUTINE
     C* (20 ONLY SET ON FOR DESTINATION)
     C*
     C           *IN20     IFEQ '1'
     C*
     C*
     C/COPY WNCPYSRC,FT0645CP16                                           S01408
     C*
     C*********************EXSR SWFT                                      S01310
      ***********                                                  S01310 CSW096
      ***If*the*destination*has*a*default*address*(BBDNW2)*use*it*,S01310 CSW096
      ***else*use*the*priority*network*address.********************S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********BBDNW2    IFNE *BLANKS                            S01310 CSW096
     C***********          EXSR NWAD                               S01310 CSW096
     C***********          ELSE                                    S01310 CSW096
     C***********          EXSR PRAD                               S01310 CSW096
     C***********          END                                     S01310 CSW096
      ***********                                                  S01310 CSW096
      ****Fill*up*the*appropriate*array*information*from*PF/SDCUSTPS01310 CSW096
     C***********          EXSR FILL                               S01310 CSW096
      ***********                                                  S01310 CSW096
      ****If*message*status*blank,*determine*value.****************S01310 CSW096
      ****Is*default*status*for*MT202*messages*released*?**********S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********MGST      IFEQ *BLANKS                            S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********'202'     LOKUPGNR                      15        S01310 CSW096
     C***********'20*'     LOKUPGNR                      16        S01310 CSW096
     C***********'2**'     LOKUPGNR                      17        S01310 CSW096
      ***********                                                  S01310 CSW096
     C************IN15     IFEQ '1'                                S01310 CSW096
     C************IN16     OREQ '1'                                S01310 CSW096
     C************IN17     OREQ '1'                                S01310 CSW096
     C***********          MOVE 'RSND'    MGST                     S01310 CSW096
     C***********          MOVE '2'       MGSG                     S01310 CSW096
     C***********          ELSE                                    S01310 CSW096
      ***********                                                  088545 CSW096
      ****If*there*is*no*default*for*that*type*of*message*for*that*088545 CSW096
      ****customer,*setup*the*message*status*whith*the*ICD*default.088545 CSW096
      ***********                                                  088545 CSW096
     C***********FTCS      IFEQ 'R'                                088545 CSW096
     C***********          MOVE 'RSND'    MGST                     088545 CSW096
     C***********          MOVE '2'       MGSG                     088545 CSW096
     C***********          ELSE                                    088545 CSW096
     C***********          MOVE 'CRTD'    MGST                     S01310 CSW096
     C***********          MOVE '1'       MGSG                     S01310 CSW096
     C***********          END                                     088545 CSW096
     C***********          END                                     S01310 CSW096
     C***********          END                                     S01310 CSW096
      *                                                                   CSW096
     C                     EXSR SRROUT                                    CSW096
     C/COPY WNCPYSRC,FT0645C014
      *                                                                   S01310
     C***********CSID******IFEQ *BLANKS                                   S01310
     C*********************MOVE 'N'       OSUFLG                          S01310
     C*********************END                                            S01310
     C                     END
     C                     GOTO SR01A
     C                     END
      *                                                                   S01435
      * If SWIFT identifier and destination of message set up             S01435
      * routing data                                                      S01435
      *                                                                   S01435
     C           ISPTP     IFEQ 'S'                                       S01435
     C           *IN20     ANDEQ'1'                                       S01435
     C                     MOVEL'Y'       OSUFLG                          S01435
     C**********           Z-ADD0         CPAR                                         S01435 CSD027
     C                     MOVE *BLANKS   CPAR                                                CSD027
     C                     MOVELISPTY1    CRNM                            S01435
     C*****************    MOVELSCRNM     NWSN                     S01435 087873
     C                     MOVELSNCSID    NWSN                            087873
     C                     MOVELISPTY1    NWDS                            S01435
     C                     MOVEL'SWIFT'   NWRK                            S01435
     C                     MOVEL*BLANKS   CTWN                            S01435
     C                     MOVELISPTY1    CSID                            S01435
      *                                                                   088545
      *  Default the message status whith the ICD.                        088545
      *                                                                   088545
     C           FTCS      IFEQ 'R'                                       088545
     C                     MOVE 'RSND'    MGST                            088545
     C                     MOVE '2'       MGSG                            088545
     C                     ELSE                                           088545
     C                     MOVE 'CRTD'    MGST                            S01435
     C                     MOVE '1'       MGSG                            S01435
     C                     END                                            088545
     C                     END                                            S01435
     C/COPY WNCPYSRC,FT0645C002
     C*                                                                ***
     C*   SWIFT ADDRESS AND AT LEAST ONE VALID TAG FIELDS = 'A'        ***
     C           ISPTP     IFEQ 'S'
     C           IVTAG1    ANDEQ'A'
      *                                                                   S01435
      * If using account line construct then use second line              S01435
      *                                                                   S01435
     C                     MOVELISPTY1    ##001                           S01435
     C           ##001     IFEQ '/'                                       S01435
     C                     MOVELISPTY2    SP12                            S01435
     C                     MOVELSP12      SCSID                           S01435
     C                     MOVELISPTY1    OFSPT1                          S01435
     C                     MOVELSCSID     OFSPT2                          S01435
     C                     ELSE                                           S01435
     C                     MOVELISPTY1    SP12   12        1ST 12 CHARS
     C                     MOVELSP12      SCSID            1ST 12 CHARS
     C                     MOVELSCSID     OFSPT1
     C                     END                                            S01435
     C                     MOVE 'A'       OSTAG
     C*********************MOVE 'Y'       OSUFLG                          S01310
     C                     GOTO SR01N
     C                     END
     C*                                                                ***
     C*   SWIFT ADDRESS AND AT LEAST ONE VALID TAG FIELDS = 'D'        ***
     C           ISPTP     IFEQ 'S'
     C           IVTAG3    ANDEQ'D'
      *                                                                   S01435
      * Use FT0315 to format text for D address type                      S01435
      *                                                                   S01435
      *                                                                   S01435
      *  Set up general parameters                                        S01435
      *                                                                   S01435
     C           *LIKE     DEFN BCCY      XCCY                            S01435
      *                                                                   S01435
     C                     CLEARW8FT                                      S01435
     C                     MOVEL*BLANKS   W8STMT                          S01435
     C                     MOVEL##PGM     W8CPGM                          S01435
     C                     MOVEL'*MSG  '  W8ACT                           S01435
     C                     Z-ADD5         W8NLIN                          S01435
     C                     MOVEL'Y'       W8MTXT                          S01435
      *                                                                   S01435
      *  Format data to be translated                                     S01435
      *                                                                   S01435
     C                     MOVELISPTP     W8TYPE                          S01435
     C                     MOVELISCCY     W8CCY                           S01435
     C                     MOVEL*BLANKS   W8LINS                          S01435
     C                     MOVELISPTY1    ADCHK1                          S01435
     C                     MOVELISPTY2    ADCHK2                          S01435
     C                     MOVELISPTY3    ADCHK3                          S01435
     C                     MOVELISPTY4    ADCHK4                          S01435
     C                     MOVELISPTY5    ADCHK5                          S01435
     C           W8TYPE    IFEQ 'P'                                       S01435
     C           ISBRCA    ANDNE*BLANKS                                   S01435
     C                     MOVELISBRCA    ADPBRC                          S01435
     C                     END                                            S01435
     C                     MOVELADDRSS    W8LINS                          S01435
      *                                                                   S01435
      * Call expansion program                                            S01435
      *                                                                   S01435
     C                     CALL 'FT0315'               1111               S01435
     C                     PARM           W8RTN   7                       S01435
     C                     PARM           W8FT                            S01435
     C                     PARM           W8LINS256                       S01435
     C                     PARM           W8RPT 256                       S01435
     C                     PARM           W8MSG 256                       S01435
     C                     PARM           W8SCR 256                       S01435
      *                                                                   S01435
      ** Check if database error occurred                                 S01435
      *                                                                   S01435
     C           *IN11     IFEQ '1'                                       S01435
     C           W8RTN     ORNE *BLANKS                                   S01435
     C                     MOVE '089'     DBERR#             * * * * * * *S01435
     C                     MOVEL'*CALL'   DBERKY             * DBERR 089 *S01435
     C                     MOVEL'FT0315'  DBFNAM             * * * * * * *S01435
     C                     EXSR DBERR                                     S01435
     C                     END                                            S01435
      *                                                                   S01435
     C                     MOVELW8MSG     ADDRSS                          S01435
     C                     MOVELADCHK1    OFSPT1                          S01435
     C                     MOVELADCHK2    OFSPT2                          S01435
     C                     MOVELADCHK3    OFSPT3                          S01435
     C                     MOVELADCHK4    OFSPT4                          S01435
     C                     MOVELADCHK5    OFSPT5                          S01435
      *                                                                   S01435
     C***********          MOVELISPTY1    SP12   12        1ST 12 CHARS   S01435
     C***********          MOVELSP12      OFSPT1           1ST 12 CHARS   S01435
     C                     MOVE 'D'       OSTAG
     C*********************MOVE 'Y'       OSUFLG                          S01310
     C                     GOTO SR01N
     C                     END
     C*                                                                ***
     C*   FULL ADDRESS AND AT LEAST ONE VALID TAG FIELDS = 'D'         ***
     C*   Or IBAN Number                                                  CFT004
     C           ISPTP     IFEQ 'A'
     C           IVTAG3    ANDEQ'D'
     C           CFT004    OREQ 'Y'                                       CFT004
     C           ISPTP     ANDEQ'I'                                       CFT004
     C                     MOVELISPTY1    OFSPT1
     C                     MOVELISPTY2    OFSPT2
     C                     MOVELISPTY3    OFSPT3
     C                     MOVELISPTY4    OFSPT4
     C                     MOVELISPTY5    OFSPT5
     C                     MOVE 'D'       OSTAG
     C*********************MOVE 'N'       OSUFLG                          S01310
      *                                                                                      260987A
      ** Ensure fields for MGOREFPD set up correctly (if destination).                       260987A
      *                                                                                      260987A
     C           *IN20     IFEQ '1'                                                          260987A
     C                     MOVEL'PAPER'   NWRK                                               260987A
     C                     MOVELSBICN     NWSN                                               260987A
     C                     MOVELSBICN     SECN                                               260987A
     C                     MOVELISPTY1    NWDS                                               260987A
     C                     MOVEL*BLANKS   BBCUST                                             260987A
     C                     ENDIF                                                             260987A
      *                                                                                      260987A
      ** Default the message status whith the ICD.                                           260987A
      *                                                                                      260987A
     C           FTCS      IFEQ 'R'                                                          260987A
     C                     MOVE 'RSND'    MGST                                               260987A
     C                     MOVE '2'       MGSG                                               260987A
     C                     ELSE                                                              260987A
     C                     MOVE 'CRTD'    MGST                                               260987A
     C                     MOVE '1'       MGSG                                               260987A
     C                     ENDIF                                                             260987A
      *                                                                                      260987A
     C                     GOTO SR01N
     C                     END
     C*
     C           SR01A     TAG
     C* IF TYPE BLANK IGNORE
     C           ISPTP     IFEQ ' '                        B001
     C                     GOTO SR01N
     C                     END                             E001
     C*                                                                ***
     C*   VALID TAG FIELD = 'D' AND THE SWIFT ADDRESS ON LF/CLINT IS   ***
     C*   NON BLANK                                                    ***
     C           IVTAG1    IFEQ 'A'
     C           CSID      ANDNE*BLANK
      *                                                                   S01435
      * If using account line construct then use second line              S01435
      *                                                                   S01435
     C                     MOVELISPTY1    ##001                           S01435
     C           ##001     IFEQ '/'                                       S01435
     C                     MOVELCSID      SCSID                           S01435
     C                     MOVELISPTY1    OFSPT1                          S01435
     C                     MOVELSCSID     OFSPT2                          S01435
     C                     ELSE                                           S01435
     C                     MOVELCSID      SCSID
     C                     MOVELSCSID     OFSPT1
     C                     END                                            S01435
     C                     MOVE 'A'       OSTAG
     C*********************MOVE 'Y'       OSUFLG                          S01310
     C                     GOTO SR01N
     C                     END
     C*                                                                ***
     C*   VALID TAG FIELD = 'B' AND THE CUSTOMER PARENT NUMBER FROM    ***
     C*  LF/CLINT IS NON ZERO AND EQUAL TO THE CUST. NO. OF HEAD OFFICE***
      *                                                                   S01435
      * If using account line construct then 'B' not allowed              S01435
      *                                                                   S01435
     C                     MOVELISPTY1    ##001                           S01435
     C           IVTAG2    IFEQ 'B'
     C********** CPAR      ANDNE*ZERO                                                         CSD027
     C           CPAR      ANDNE*BLANKS                                                       CSD027
     C           CPAR      ANDEQSHEAD                      SAVE 1ST CYCLE
     C           ##001     ANDNE'/'                                       S01435
     C                     MOVELCTWN      OFSPT1
     C                     MOVE 'B'       OSTAG
     C*********************MOVE 'N'       OSUFLG                          S01310
     C                     GOTO SR01N
     C                     END
     C*                                                                ***
     C*   VALID TAG FIELD = 'D'                                        ***
     C           IVTAG3    IFEQ 'D'
     C*********************                                               S01310
     C*********************MOVE 'B'       KEYA                            S01310
     C***********CUSKEY****CHAINCLINTCCF             12    ON, DELETED    S01310
     C************IN12*****IFEQ '1'                         ))))))))))))))S01310
     C*********************MOVE 'CLINT'   DBFNAM  5         )))  DATA  )))S01310
     C*********************MOVEL'      B' DBERKY            )))  BASE  )))S01310
     C*********************MOVELKCUSNO    DBERKY            )))  BASE  )))S01310
     C*********************MOVE '14'      DBERR#  2         ))) ERROR  )))S01310
     C*********************EXSR DBERR                       )))   14   )))S01310
     C*********************END                              ))))))))))))))S01310
     C*********************MOVELCNA1      OFSPT1                          S01310
     C*********************MOVELCNA2      OFSPT2                          S01310
     C*********************MOVELCNA3      OFSPT3                          S01310
     C*********************MOVELCNA4      OFSPT4                          S01310
      *                                                                   S01435
      * Replaced by call FT0315                                           S01435
      *                                                                   S01435
      ************                                                  S01310S01435
      ************                                                  S01310S01435
      ***Access*SDCUSTPD with the customer number.                  S01310S01435
      ************                                                  S01310S01435
     C************         MOVE *BLANKS   @KEY1                     S01310S01435
     C************         MOVELCUSTNO    @KEY1                     S01310S01435
     C************         CALL 'AOCUSTR0'                          S01310S01435
     C************         PARM '*MSG   ' @RTCD                     S01310S01435
     C************         PARM '*KEY   ' @OPTN                     S01310S01435
     C************         PARM           @KEY1  10                 S01310S01435
     C************         PARM *BLANKS   @KYST   7                 S01310S01435
     C***********SDCUST    PARM SDCUST    DSSDY                     S01310S01435
      ************                                                  S01310S01435
      ***Customer*record not found - Error                          S01310S01435
      ************                                                  S01310S01435
     C***********@RTCD     IFNE *BLANKS                             S01310S01435
     C************         MOVE '014'     DBERR#             * * * *S01310S01435
     C************         MOVEL@KEY1     DBERKY             * DBERRS01310S01435
     C************         MOVEL'SDCUSTPD'DBFNAM             * * * *S01310S01435
     C************         EXSR DBERR                               S01310S01435
     C************         END                                      S01310S01435
     C************         MOVELBBCNA1    OFSPT1                    S01310S01435
     C************         MOVELBBCNA2    OFSPT2                    S01310S01435
     C************         MOVELBBCNA3    OFSPT3                    S01310S01435
     C************         MOVELBBCNA4    OFSPT4                    S01310S01435
     C************         MOVE 'D'       OSTAG                           S01435
     C*********************MOVE 'N'       OSUFLG                    S01310S01435
     C************         END                                            S01435
      *                                                                   S01435
      * Use FT0315 to format text for D address type                      S01435
      *                                                                   S01435
      *                                                                   S01435
      *  Set up general parameters                                        S01435
      *                                                                   S01435
     C                     CLEARW8FT                                      S01435
     C                     MOVEL*BLANKS   W8STMT                          S01435
     C                     MOVEL##PGM     W8CPGM                          S01435
     C                     MOVEL'*MSG  '  W8ACT                           S01435
     C                     Z-ADD5         W8NLIN                          S01435
     C                     MOVEL'Y'       W8MTXT                          S01435
      *                                                                   S01435
      *  Format data to be translated                                     S01435
      *                                                                   S01435
     C                     MOVELISPTP     W8TYPE                          S01435
     C                     MOVELISCCY     W8CCY                           S01435
     C                     MOVEL*BLANKS   W8LINS                          S01435
     C                     MOVELISPTY1    ADCHK1                          S01435
     C                     MOVELISPTY2    ADCHK2                          S01435
     C                     MOVELISPTY3    ADCHK3                          S01435
     C                     MOVELISPTY4    ADCHK4                          S01435
     C                     MOVELISPTY5    ADCHK5                          S01435
     C           W8TYPE    IFEQ 'P'                                       S01435
     C           ISBRCA    ANDNE*BLANKS                                   S01435
     C                     MOVELISBRCA    ADPBRC                          S01435
     C                     END                                            S01435
     C                     MOVELADDRSS    W8LINS                          S01435
      *                                                                   S01435
      * Call expansion program                                            S01435
      *                                                                   S01435
     C                     CALL 'FT0315'               1111               S01435
     C                     PARM           W8RTN   7                       S01435
     C                     PARM           W8FT                            S01435
     C                     PARM           W8LINS256                       S01435
     C                     PARM           W8RPT 256                       S01435
     C                     PARM           W8MSG 256                       S01435
     C                     PARM           W8SCR 256                       S01435
      *                                                                   S01435
      ** Check if database error occurred                                 S01435
      *                                                                   S01435
     C           *IN11     IFEQ '1'                                       S01435
     C           W8RTN     ORNE *BLANKS                                   S01435
     C                     MOVE '090'     DBERR#             * * * * * * *S01435
     C                     MOVEL'*CALL'   DBERKY             * DBERR 090 *S01435
     C                     MOVEL'FT0315'  DBFNAM             * * * * * * *S01435
     C                     EXSR DBERR                                     S01435
     C                     END                                            S01435
      *                                                                   S01435
     C                     MOVELW8MSG     ADDRSS                          S01435
     C                     MOVELADCHK1    OFSPT1                          S01435
     C                     MOVELADCHK2    OFSPT2                          S01435
     C                     MOVELADCHK3    OFSPT3                          S01435
     C                     MOVELADCHK4    OFSPT4                          S01435
     C                     MOVELADCHK5    OFSPT5                          S01435
     C                     MOVE 'D'       OSTAG                           S01435
     C                     END                                            S01435
      *                                                                   S01435
     C*                                                                ***
     C           SR01N     TAG
      *                                                                                       CSW201
      ** Process Swift 2001 standards                                                         CSW201
      *                                                                                       CSW201
     C           CSW201    IFEQ 'Y'                                                           CSW201
     C           W201IN    ANDEQ'Y'                                                           CSW201
     C           OSTAG     ANDEQ'A'                                                           CSW201
     C                     MOVELSCSID     W9BICC                                              CSW201
     C           3         SUBSTSCSID:9   W9BICB                                              CSW201
      *                                                                                       CSW201
     C                     CALL 'ME1400'                                                      CSW201
     C                     PARM *BLANKS   W9RTN                                               CSW201
     C                     PARM           W9BICC                                              CSW201
     C                     PARM           W9BICB                                              CSW201
     C                     PARM           SDCUST                                              CSW201
     C                     PARM           SDCNST                                              CSW201
     C                     PARM           MEBICD                                              CSW201
     C                     PARM *BLANKS   W9CUST                                              CSW201
     C                     PARM *BLANKS   W9CNST                                              CSW201
     C                     PARM *BLANKS   W9BICD                                              CSW201
      *                                                                                       CSW202
      ** If SWIFT 2002 is on, determine if BIC is a BEI via AOBEISR0.                         CSW202
      *                                                                                       CSW202
     C           CSW202    IFEQ 'Y'                                                           CSW202
     C           W9BICD    ANDEQ'Y'                                                           CSW202
     C                     CALL 'AOBEISR0'                                                    CSW202
     C                     PARM *BLANKS   PRTCD   7                                           CSW202
     C                     PARM '*VERIFY' POPTN   7                                           CSW202
     C                     PARM BDSUBT    PBICD   4                                           CSW202
     C           MEBEIS    PARM MEBEIS    DSFDY                                               CSW202
     C                     ENDIF                                                              CSW202
      *                                                                                       CSW201
     C           W9RTN     IFEQ *BLANKS                                                       CSW201
     C           W9BICD    ANDEQ'Y'                                                           CSW201
     C           BDSUBT    ANDEQ'BEID'                                                        CSW201
     C           CSW202    ANDEQ'N'                                                           CSW202
      *                                                                                       CSW201
     C           W9RTN     OREQ *BLANKS                                                       CSW201
     C           W9BICD    ANDEQ'Y'                                                           CSW201
     C           BDSUBT    ANDEQ'TRCO'                                                        CSW201
     C           CSW202    ANDEQ'N'                                                           CSW202
      *                                                                                       CSW202
     C           W9BICD    OREQ 'Y'                                                           CSW202
     C           CSW202    ANDEQ'Y'                                                           CSW202
     C           PRTCD     ANDEQ*BLANKS                                                       CSW202
      *                                                                                       CSW201
     C                     MOVEL'D'       OSTAG                                               CSW201
      *                                                                                       CSW201
     C           W9CNST    IFEQ 'Y'                                                           CSW201
      *                                                                                       CSW201
      ** If account line, then start with second line.                                        CSW201
     C           ##001     IFEQ '/'                                                           CSW201
     C                     MOVELISPTY1    OFSPT1                                              CSW201
     C                     MOVELAWCPNM    OFSPT2                                              CSW201
     C                     MOVELAWCNTN    OFSPT3                                              CSW201
     C                     ELSE                                                               CSW201
     C                     MOVELAWCPNM    OFSPT1                                              CSW201
     C                     MOVELAWCNTN    OFSPT2                                              CSW201
     C                     ENDIF                                                              CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C           W9CUST    IFEQ 'Y'                                                           CSW201
      *                                                                                       CSW201
      ** If account line, then start with second line.                                        CSW201
     C           ##001     IFEQ '/'                                                           CSW201
     C                     MOVELISPTY1    OFSPT1                                              CSW201
     C                     MOVELBBCNA1    OFSPT2                                              CSW201
     C                     MOVELBBCNA2    OFSPT3                                              CSW201
     C                     MOVELBBCNA3    OFSPT4                                              CSW201
     C                     MOVELBBCNA4    OFSPT5                                              CSW201
     C                     ELSE                                                               CSW201
     C                     MOVELBBCNA1    OFSPT1                                              CSW201
     C                     MOVELBBCNA2    OFSPT2                                              CSW201
     C                     MOVELBBCNA3    OFSPT3                                              CSW201
     C                     MOVELBBCNA4    OFSPT4                                              CSW201
     C                     ENDIF                                                              CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C                     ENDIF                                                              CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C                     EXSR EMBLK
     C                     ENDSR
     C/EJECT
     C********************************************************************
     C********************************************************************
     C*               SUBROUTINE EMBLK                                 ***
     C*                                                                ***
     C*     TO ELIMINATE BLANK LINES ON NAME AND ADDRESS FIELDS        ***
     C*                                                                ***
     C*      CALLED BY: MAIN PROCESSING
     C*                 SR01
     C********************************************************************
     C           EMBLK     BEGSR                                       ***
     C                     MOVEA*BLANKS   ADDR
     C                     Z-ADD1         A       10
     C*
     C           OFSPT1    IFNE *BLANK
     C                     MOVE OFSPT1    ADDR,A
     C                     ADD  1         A
     C                     END
     C*
     C           OFSPT2    IFNE *BLANK
     C                     MOVE OFSPT2    ADDR,A
     C                     ADD  1         A
     C                     END
     C*
     C           OFSPT3    IFNE *BLANK
     C                     MOVE OFSPT3    ADDR,A
     C                     ADD  1         A
     C                     END
     C*
     C           OFSPT4    IFNE *BLANK
     C                     MOVE OFSPT4    ADDR,A
     C                     ADD  1         A
     C                     END
     C*
     C           OFSPT5    IFNE *BLANK
     C                     MOVE OFSPT5    ADDR,A
     C                     ADD  1         A
     C                     END
     C*
     C           OFSPT6    IFNE *BLANK
     C                     MOVE OFSPT6    ADDR,A
     C                     ADD  1         A
     C                     END
     C*
     C                     MOVEAADDR      OFSPT
     C*
     C                     ENDSR
     C/EJECT
     C********************************************************************
     C*     *         SUBROUTINE 03                         ***        ***
     C*     *                                               ***        ***
     C*     *     TO FORMAT AMOUNT                          ***        ***
     C*     *                                               ***        ***
     C*********************************************************        ***
     C           SR03      BEGSR                            ***        ***
     C*                                                                   CSW020
     C** Perform Old Processing if CSW020 is not switched on.             CSW020
     C           CSW020    IFNE 'Y'                                       CSW020
     C*                                                                ***
     C*   CHAIN TO TABLETG TO FIND DECIMAL POSITION                    ***
     C                     MOVEL'20'      TABTGK 12
     C                     MOVELPCCY      TGCCSR  4
     C                     MOVE '1'       TGCCSR
     C                     MOVE TGCCSR    TABTGK
     C           TABTGK    CHAINTABFP                10
     C*
     C           *IN10     IFEQ '1'                         ))))))))))))))
     C*********************MOVE 'TABFP'   DBFNAM            )))  DATA  )))S01310
     C                     MOVEL'TABFP'   DBFNAM            )))  DATA  )))S01310
     C                     MOVELTABTGK    DBERKY            )))  BASE  )))
     C                     MOVE '15'      DBERR#            ))) ERROR  )))
     C                     EXSR DBERR                       )))   15   )))
     C                     END                              ))))))))))))))
     C*
     C** USE THE SWIFT CURRENCY FROM TABLE ON THE SWIFT MESSAGES
     C*          =====
     C                     MOVE CCYS      M1RCCY
      *                                                                   CEU006
      * Save SWIFT currency code and decimal places for SR/ERI            CEU006
     C                     MOVELCCYS      WCCYS   3                       CEU006
     C                     Z-ADDCDP       WCDP    10                      CEU006
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0645CP20                                           S01408
     C*                                                                   S01408
     C*
     C*    DETERMINE DECIMAL POSITION (FOR REPORT)
     C           CDP       COMP 2                    33  32
     C           CDP       COMP 1                      3031
     C*
     C*    DETERMINE DECIMAL POSITION
     C           14        SUB  CDP       X       20
     C*    IF 0 DECIMAL PLACES DON'T EDIT
     C           CDP       IFEQ 0                          B001
     C                     MOVE *BLANK    AMT
     C                     MOVE *ZEROS    AM
     C**************       MOVEARAMNT     AMT,2                           E22897
     C                     MOVEARAMNT     AMT,1                           E22897
     C**************       MOVEARAMNT     AM,2                            E22897
     C                     MOVEARAMNT     AM,1                            E22897
     C                     Z-ADD13        W
     C                     MOVE ','       AM,X
     C                     ELSE                            E001
     C*    MOVE AMOUNT INTO ARRAY
     C                     MOVEARAMNT     AMT,1
     C*    DETERMINE POSITION OF DECIMAL DIGITS IN 2ND ARRAY
     C           X         ADD  1         Y       20
     C*    MOVE DECIMAL DIGITS INTO 2ND ARRAY FIELD
     C                     MOVEAAMT,X     AM,Y
     C*    DETERMINE POSITION & MOVE COMMA
     C                     SUB  1         Y
     C                     MOVE ','       AM,Y
     C*    DETERMINE POSITION OF DIGIT B4  COMMA
     C                     SUB  1         Y
     C*    SAVE POSITION OF DIGIT B4  COMMA
     C                     Z-ADDY         W       20
     C*    DETERMINE POSITION OF DIGIT TO BE MOVED B4  COMMA
     C                     SUB  1         X
     C                     Z-ADDX         Z       20
     C*    DO OPERATIONS MOVING CHARACTERS ONE AT A TIME
     C*    FROM RIGHT TO LEFT
     C                     DO   X
     C                     MOVE AMT,Z     AM,Y
     C                     SUB  1         Z
     C                     SUB  1         Y
     C                     END
     C                     END                             E001
     C*    SET INDEX TO 1
     C                     Z-ADD1         Y
     C*    REPLACE LEADING ZEROS WITH BLANK
     C           AM,Y      DOWEQ'0'
     C           Y         CABEQW         SR03A
     C                     MOVE ' '       AM,Y
     C                     ADD  1         Y
     C                     END
     C*  ** SAVE FIELD FROM ARRAY                                      ***
     C           SR03A     TAG
     C                     MOVEAAM        AMX    14
     C                     MOVE AMX       SAM    15
     C*                                                                ***
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0645CP21                                           S01408
     C*                                                                   S01408
     C                     ELSE                                           CSW020
     C*                                                                   CSW020
     C** If CSW020 is switched on perform decimal places prosessing       CSW020
     C                     CALL 'ZM0040'                                  CSW020
     C                     PARM WAMNT     ZAMNT                           CSW020
     C                     PARM PCCY      ZCCY                            CSW020
     C                     PARM *BLANKS   ZSAMNT                          CSW020
     C                     PARM *BLANKS   ZSCCY                           CSW020
     C                     PARM *BLANKS   ZERR                            CSW020
     C*                                                                   CSW020
     C** Handle Database Error                                            CSW020
     C           ZERR      IFEQ '1'                                       CSW020
     C                     MOVEL'ZM0040  'DBFNAM           ************   CSW020
     C                     MOVELPCCY      DBERKY           * DBERR 33 *   CSW020
     C                     MOVE '33'      DBERR#           ************   CSW020
     C                     EXSR DBERR                                     CSW020
     C*                                                                   CSW020
     C                     ELSE                                           CSW020
     C                     MOVE ZSAMNT    SAM                             CSW020
     C                     MOVE ZSCCY     M1RCCY                          CSW020
     C*                                                                   CSW020
     C**    Access Currency Details                                       CSW020
     C                     CALL 'AOCURRR0'                                CSW020
     C                     PARM '*MSG   ' @RTCD   7                       CSW020
     C                     PARM '*KEY   ' @OPTN   7                       CSW020
     C                     PARM PCCY      @CCY    3                       CSW020
     C           SDCURR    PARM SDCURR    DSSDY                           CSW020
     C*                                                                   CSW020
     C                     MOVE A6CYNM    CCNM                            CSW020
     C           A6NBDP    COMP 2                    33  32               CSW020
     C           A6NBDP    COMP 1                      3031               CSW020
     C                     ENDIF                                          CSW020
     C*                                                                   CSW020
     C                     ENDIF                                          CSW020
     C                     ENDSR                           END SR03
     C/EJECT
4630 C********************************************************************
     C********************************************************************E32480
     C********************************************************************E32480
     C****************SUBROUTINE 04                         ***        ***E32480
     C*********************                                 ***        ***E32480
     C*********FORMAT*SWIFT COMMON REFERENCE                ***        ***E32480
     C*********************                                 ***        ***E32480
     C*********************************************************        ***E32480
     C***********SR04******BEGSR                            ***        ***E32480
     C*********************                                            ***E32480
     C******MANIPULATE*EXCHANGE RATE TO DETERMINE 1ST LEAST ***        ***E32480
     C******SIGNIFICANT*NON=ZERO AND EXTRACT THE DIGIT AND  ***        ***E32480
     C******ITS*PRECEEDING*3 DIGITS                         ***        ***E32480
     C*********************                                            ***E32480
     C*********************MOVE RATE      WRATE                           E32480
     C***********R13*******IFNE *ZERO                                     E32480
     C*********************MOVE R10       SR1                             E32480
     C*********************MOVE R11       SR2                             E32480
     C*********************MOVE R12       SR3                             E32480
     C*********************MOVE R13       SR4                             E32480
     C*********************ELSE                                           E32480
     C***********R12*******IFNE *ZERO                                     E32480
     C*********************MOVE R9        SR1                             E32480
     C*********************MOVE R10       SR2                             E32480
     C*********************MOVE R11       SR3                             E32480
     C*********************MOVE R12       SR4                             E32480
     C*********************ELSE                                           E32480
     C***********R11*******IFNE *ZERO                                     E32480
     C*********************MOVE R8        SR1                             E32480
     C*********************MOVE R9        SR2                             E32480
     C*********************MOVE R10       SR3                             E32480
     C*********************MOVE R11       SR4                             E32480
     C*********************ELSE                                           E32480
     C***********R10*******IFNE *ZERO                                     E32480
     C*********************MOVE R7        SR1                             E32480
     C*********************MOVE R8        SR2                             E32480
     C*********************MOVE R9        SR3                             E32480
     C*********************MOVE R10       SR4                             E32480
     C*********************ELSE                                           E32480
     C***********R9********IFNE *ZERO                                     E32480
     C*********************MOVE R6        SR1                             E32480
     C*********************MOVE R7        SR2                             E32480
     C*********************MOVE R8        SR3                             E32480
     C*********************MOVE R9        SR4                             E32480
     C*********************ELSE                                           E32480
     C***********R8********IFNE *ZERO                                     E32480
     C*********************MOVE R5        SR1                             E32480
     C*********************MOVE R6        SR2                             E32480
     C*********************MOVE R7        SR3                             E32480
     C*********************MOVE R8        SR4                             E32480
     C*********************ELSE                                           E32480
     C***********R7********IFNE *ZERO                                     E32480
     C*********************MOVE R4        SR1                             E32480
     C*********************MOVE R5        SR2                             E32480
     C*********************MOVE R6        SR3                             E32480
     C*********************MOVE R7        SR4                             E32480
     C*********************ELSE                                           E32480
     C***********R6********IFNE *ZERO                                     E32480
     C*********************MOVE R3        SR1                             E32480
     C*********************MOVE R4        SR2                             E32480
     C*********************MOVE R5        SR3                             E32480
     C*********************MOVE R6        SR4                             E32480
     C*********************ELSE                                           E32480
     C*********************END                                         ***E32480
     C*********************END                                         ***E32480
     C*********************END                                         ***E32480
     C*********************END                                         ***E32480
     C*********************END                                         ***E32480
     C*********************END                                         ***E32480
     C*********************END                                         ***E32480
     C*********************END                                         ***E32480
     C*********************                                            ***E32480
     C******EXTRACT*BANK*CODE (POS 1-4) FROM SWIFT ADDRESS OF THE ***  ***E32480
     C******BRANCH*INTERNAL CUSTOMER NUMBER PROCESSED IN 1ST CYCLE***  ***E32480
     C*********************MOVELMXOTID    BNKC1   4                       E32480
     C*********************                                            ***E32480
     C******EXTRACT*BANK*CODE (POS 1-4) FROM SWIFT ADDRESS OF THE ***  ***E32480
     C******DESTINATION*CUSTOMER NUMBER PROCESSED IN DETAIL PROCESING*****E32480
     C*********************MOVELRECADD    BNKC2   4                       E32480
     C*********************                                            ***E32480
     C*****EXTRACT*LOCATION CODE FROM SWIFT ADDRESS OF THE BRANCH   ** ***E32480
     C*****INTERNAL*CUST*NUMBER(POS 7-8)                           **  ***E32480
     C*********************MOVELMXOTID    SLC1    8                       E32480
     C*********************MOVE SLC1      LC1     2                       E32480
     C*********************                                            ***E32480
     C*****EXTRACT*LOCATION CODE FROM SWIFT ADDRESS OF THE          ** ***E32480
     C*****DESTINATION*CUST NUMBER(POS 7-8)                          *****E32480
     C*********************MOVELRECADD    SLC2    8                       E32480
     C*********************MOVE SLC2      LC2     2                       E32480
     C*********************                                            ***E32480
     C*******BUILD*COMMON*REFERENCE                                **  ***E32480
     C***********BNKC1*****IFLT BNKC2                                     E32480
     C*********************MOVE BNKC1     CRBKC1                          E32480
     C*********************MOVE LC1       CRLC1                           E32480
     C*********************MOVE BNKC2     CRBKC2                          E32480
     C*********************MOVE LC2       CRLC2                           E32480
     C*********************ELSE                                           E32480
     C*********************MOVE BNKC1     CRBKC2                          E32480
     C*********************MOVE LC1       CRLC2                           E32480
     C*********************MOVE BNKC2     CRBKC1                          E32480
     C*********************MOVE LC2       CRLC1                           E32480
     C*********************END                                            E32480
     C*********************MOVE SRATE     CRRATE                          E32480
     C*********************                                            ***E32480
     C*********************ENDSR                           END SR04       E32480
     C*/EJECT**************                                               E32480
4630 C********************************************************************
     C********************************************************************
     C********************************************************************
     C*     *         SUBROUTINE 05                         ***        ***
     C*     *                                               ***        ***
     C*     *  FORMAT SETTLEMENT PARTY FOR TELEX REPORT     ***        ***
     C*     *                                               ***        ***
     C*     *                                               ***        ***
     C*********************************************************        ***
     C           SR05      BEGSR                            ***        ***
     C*     INTIALISE O/P PARAMETERS FROM THIS SUBROUTINE
     C                     MOVE *BLANKS   OFSPT1 35
     C                     MOVE *BLANKS   OFSPT2 35
     C                     MOVE *BLANKS   OFSPT3 35
     C                     MOVE *BLANKS   OFSPT4 35
     C                     MOVE *BLANKS   OFSPT5 35
      *                                                                   S01435
      * Replaced by call FT0315                                           S01435
      *                                                                   S01435
      ***********                                                         S01435
     C***********                                                      ***S01435
     C*****FULL*NOSTRO - PROCESSING                         **         ***S01435
     C***********ISPTP     IFEQ 'F'                                       S01435
     C*****SETUP*AND ACCESS PF/TABLETL                                 ***S01435
     C***********          MOVELISPTY1    TLCCNN  5        BUILD          S01435
     C***********          MOVEL'70'      TABTLK 12          KEY          S01435
     C***********          MOVE TLCCNN    TABTLK               KEY        S01435
     C***********TABTLK    CHAINTABFP                10                   S01435
     C************IN10     IFEQ '1'                         ))))))))))))))S01435
     C*********************MOVE 'TABFP'   DBFNAM            )))  D))S01310S01435
     C***********          MOVEL'TABFP'   DBFNAM            )))  D))S01310S01435
     C***********          MOVELTABTLK    DBERKY            )))  BASE  )))S01435
     C***********          MOVE '10'      DBERR#            ))) ERROR  )))S01435
     C***********          EXSR DBERR                       )))   10   )))S01435
     C***********          END                              ))))))))))))))S01435
     C***********          MOVE CNUM      CUSTNO                          S01435
     C***********          MOVELTLCCNN    OFSPT1                          S01435
     C***********          GOTO NADD                                      S01435
     C***********          END                                            S01435
     C***********                                                      ***S01435
     C*****NOSTRO NUMBER - PROCESSING                         **       ***S01435
     C***********ISPTP     IFEQ 'N'                                       S01435
     C*****SETUP*AND ACCESS PF/TABLETL                                 ***S01435
     C***********          MOVELISPTY1    TLNN    2        BUILD          S01435
     C***********          MOVELISCCY     TLCCNN             KEY          S01435
     C***********          MOVE TLNN      TLCCNN             KEY          S01435
     C***********          MOVEL'70'      TABTLK 12          KEY          S01435
     C***********          MOVE TLCCNN    TABTLK               KEY        S01435
     C***********TABTLK    CHAINTABFP                10                   S01435
     C************IN10     IFEQ '1'                         ))))))))))))))S01435
     C*********************MOVE 'TABFP'   DBFNAM            )))  D))S01310S01435
     C***********          MOVEL'TABFP'   DBFNAM            )))  D))S01310S01435
     C***********          MOVELTABTLK    DBERKY            )))  BASE  )))S01435
     C***********          MOVE '11'      DBERR#            ))) ERROR  )))S01435
     C***********          EXSR DBERR                       )))   11   )))S01435
     C***********          END                              ))))))))))))))S01435
     C***********          MOVE CNUM      CUSTNO                          S01435
     C***********          MOVELTLNN      OFSPT1                          S01435
     C***********          GOTO NADD                                      S01435
     C***********          END                                            S01435
     C***********                                                      ***S01435
     C*****RETAIL ACCOUNT - PROCESSING                         **      ***S01435
     C***********ISPTP     IFEQ 'R'                                       S01435
     C*****SETUP*AND ACCESS ACCOUNT NUMBER FILE                        ***S01435
     C***********          MOVELISPTY1    ACNUMK                          S01435
     C***********ACNUMK    CHAINACNUMA               11    ON, DELETED    S01435
     C************IN11     IFEQ '1'                         ))))))))))))))S01435
     C*********************MOVE 'ACNUMA'  DBFNAM  5         )))  D))S01310S01435
     C***********          MOVEL'ACNUMA'  DBFNAM            )))  D))S01310S01435
     C***********          MOVELACNUMK    DBERKY 39         )))  BASE  )))S01435
     C***********          MOVE '12'      DBERR#  2         ))) ERROR  )))S01435
     C***********          EXSR DBERR                       )))   12   )))S01435
     C***********          END                              ))))))))))))))S01435
     C***********          MOVE CNUM      CUSTNO                          S01435
     C***********          MOVELACNUMK    OFSPT1                          S01435
     C***********          GOTO NADD                                      S01435
     C***********          END                                            S01435
     C***********                                                      ***S01435
     C*****FULL/PARTIAL ACCOUNT/CUSTOMER  - PROCESSING                 ***S01435
     C***********ISPTP     IFEQ 'G'                                       S01435
     C***********ISPTP     OREQ 'P'                                       S01435
     C***********ISPTP     OREQ 'C'                                       S01435
     C***********          MOVELISPTY1    CUSTNO                          S01435
     C***********          MOVELISPTY1    OFSPT1                          S01435
     C***********          GOTO NADD                                      S01435
     C***********          END                                            S01435
     C***********                                                      ***S01435
     C*****SETTLEMENT PARTY  - PROCESSING                              ***S01435
     C***********ISPTP     IFEQ 'S'                                       S01435
     C***********ISPTP     OREQ 'A'                                       S01435
     C***********          MOVELISPTY1    OFSPT1                          S01435
     C***********          MOVELISPTY2    OFSPT2                          S01435
     C***********          MOVELISPTY3    OFSPT3                          S01435
     C***********          MOVELISPTY4    OFSPT4                          S01435
     C***********          MOVELISPTY5    OFSPT5                          S01435
     C***********          GOTO SR05N                                     S01435
     C***********          END                                            S01435
     C***********                                                      ***S01435
     C***********NADD      TAG                                            S01435
     C***IF*TYPE*BLANK IGNORE                                             S01435
     C***********ISPTP     IFEQ ' '                        B001           S01435
     C***********          GOTO SR05N                                     S01435
     C***********          END                             E001           S01435
     C*********************                                         S01310S01435
     C***SET*UP*CUSTOMER*KEY                                        S01310S01435
     C*********************MOVELCUSTNO    KCUSNO                    S01310S01435
     C*********************MOVE 'B'       KEYA                      S01310S01435
     C***ACCESS*CLIENT*FILE                                         S01310S01435
     C***********CUSKEY****CHAINCLINTCCF             80             S01310S01435
     C*********************                                         S01310S01435
     C************IN80*****IFEQ '1'                         ))))))))S01310S01435
     C*********************MOVE 'CLINT'   DBFNAM            )))  DATS01310S01435
     C*********************MOVEL'      B' DBERKY            )))  BASS01310S01435
     C*********************MOVELKCUSNO    DBERKY            )))  BASS01310S01435
     C*********************MOVE '16'      DBERR#            ))) ERROS01310S01435
     C*********************EXSR DBERR                       )))   16S01310S01435
     C*********************END                              ))))))))S01310S01435
     C*********************MOVE CNA1      OFSPT2                    S01310S01435
     C*********************MOVE CNA2      OFSPT3                    S01310S01435
     C*********************MOVE CNA3      OFSPT4                    S01310S01435
     C*********************MOVE CNA4      OFSPT5                    S01310S01435
     C***********                                                      ***S01435
      ***********                                                   S01310S01435
      ***Access*SDCUSTPD with the customer number.                  S01310S01435
      ***********                                                   S01310S01435
     C***********          MOVE *BLANKS   @KEY1                     S01310S01435
     C***********          MOVELCUSTNO    @KEY1                     S01310S01435
     C***********          CALL 'AOCUSTR0'                          S01310S01435
     C***********          PARM '*MSG   ' @RTCD                     S01310S01435
     C***********          PARM '*KEY   ' @OPTN                     S01310S01435
     C***********          PARM           @KEY1  10                 S01310S01435
     C***********          PARM *BLANKS   @KYST   7                 S01310S01435
     C***********SDCUST    PARM SDCUST    DSSDY                     S01310S01435
      ***********                                                   S01310S01435
      ***Customer record not found - Error                          S01310S01435
      ***********                                                   S01310S01435
     C***********@RTCD     IFNE *BLANKS                             S01310S01435
     C***********          MOVE '016'     DBERR#             * * * *S01310S01435
     C***********          MOVEL@KEY1     DBERKY             * DBERRS01310S01435
     C***********          MOVEL'SDCUSTPD'DBFNAM             * * * *S01310S01435
     C***********          EXSR DBERR                               S01310S01435
     C***********          END                                      S01310S01435
     C***********          MOVELBBCNA1    OFSPT2                    S01310S01435
     C***********          MOVELBBCNA2    OFSPT3                    S01310S01435
     C***********          MOVELBBCNA3    OFSPT4                    S01310S01435
     C***********          MOVELBBCNA4    OFSPT5                    S01310S01435
      *                                                                   S01435
      * Use FT0315 to format text for D address type                      S01435
      *                                                                   S01435
      *                                                                   S01435
      *  Set up general parameters                                        S01435
      *                                                                   S01435
     C                     CLEARW8FT                                      S01435
     C                     MOVEL*BLANKS   W8STMT                          S01435
     C                     MOVEL##PGM     W8CPGM                          S01435
     C                     MOVEL'*MSG  '  W8ACT                           S01435
     C                     Z-ADD5         W8NLIN                          S01435
     C                     MOVEL'Y'       W8MTXT                          S01435
      *                                                                   S01435
      *  Format data to be translated                                     S01435
      *                                                                   S01435
     C                     MOVELISPTP     W8TYPE                          S01435
     C                     MOVELISCCY     W8CCY                           S01435
     C                     MOVEL*BLANKS   W8LINS                          S01435
     C                     MOVELISPTY1    ADCHK1                          S01435
     C                     MOVELISPTY2    ADCHK2                          S01435
     C                     MOVELISPTY3    ADCHK3                          S01435
     C                     MOVELISPTY4    ADCHK4                          S01435
     C                     MOVELISPTY5    ADCHK5                          S01435
     C           W8TYPE    IFEQ 'P'                                       S01435
     C           ISBRCA    ANDNE*BLANKS                                   S01435
     C                     MOVELISBRCA    ADPBRC                          S01435
     C                     END                                            S01435
     C                     MOVELADDRSS    W8LINS                          S01435
      *                                                                   S01435
      * Call expansion program                                            S01435
      *                                                                   S01435
     C                     CALL 'FT0315'               1111               S01435
     C                     PARM           W8RTN   7                       S01435
     C                     PARM           W8FT                            S01435
     C                     PARM           W8LINS256                       S01435
     C                     PARM           W8RPT 256                       S01435
     C                     PARM           W8MSG 256                       S01435
     C                     PARM           W8SCR 256                       S01435
      *                                                                   S01435
      ** Check if database error occurred                                 S01435
      *                                                                   S01435
     C           *IN11     IFEQ '1'                                       S01435
     C           W8RTN     ORNE *BLANKS                                   S01435
     C                     MOVE '090'     DBERR#             * * * * * * *S01435
     C                     MOVEL'*CALL'   DBERKY             * DBERR 090 *S01435
     C                     MOVEL'FT0315'  DBFNAM             * * * * * * *S01435
     C                     EXSR DBERR                                     S01435
     C                     END                                            S01435
      *                                                                   S01435
     C           CFT004    IFEQ 'Y'                                       CFT004
     C           W8TYPE    ANDEQ'I'                                       CFT004
     C                     MOVELW8RPT     ADDRSS                          CFT004
     C                     ELSE                                           CFT004
     C                     MOVELW8MSG     ADDRSS                          S01435
     C                     ENDIF                                          CFT004
     C                     MOVELADCHK1    OFSPT1                          S01435
     C                     MOVELADCHK2    OFSPT2                          S01435
     C                     MOVELADCHK3    OFSPT3                          S01435
     C                     MOVELADCHK4    OFSPT4                          S01435
     C                     MOVELADCHK5    OFSPT5                          S01435
      *                                                                   S01435
     C*                                                                ***
     C           SR05N     ENDSR                           END SR05
     C/EJECT
4630 C********************************************************************
     C********************************************************************
     C********************************************************************
     C*     *         SUBROUTINE 06                                    ***
     C*     *                                               ***        ***
     C*     *   DETERMINE AND FORMAT AMOUNT OUTGOING        ***        ***
     C*     *   PAYMENTS                                    ***        ***
     C*     *                                               ***        ***
     C*********************************************************        ***
     C           SR06      BEGSR                                       ***
      *                                                                   CEU006
      * Sum all charges into work field used for Field :72: calcs         CEU006
     C           TXCH      ADD  CQCH      W#CHGS 130                      CEU006
     C                     ADD  CSTA      W#CHGS                          CEU006
     C                     ADD  SPCH      W#CHGS                          CEU006
     C                     ADD  MSCH      W#CHGS                          CEU006
     C                     ADD  TRCM      W#CHGS                          CEU006
     C                     ADD  OPCHCM    W#CHGS                          CEU006
     C                     ADD  OPVATT    W#CHGS                          CEU006
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
     C           CFT014    OREQ 'Y'                                                           222448
     C           PREF      CHAINOTPAYXL0             25                   CFT009
     C*                                                                   CFT009
     C           *IN25     IFEQ *ON                                       CFT009
     C                     MOVEL'OTPAYXL0'DBFNAM            ************  CFT009
     C                     MOVELPREF      DBERKY            * DBERR 40 *  CFT009
     C                     MOVE '40'      DBERR#            ************  CFT009
     C                     EXSR DBERR                                     CFT009
     C                     ENDIF                                                              222448
     C                     ENDIF                                                              222448
     C**********           ELSE                                                        CFT009 222448
      *                                                                                       222448
     C           CFT009    IFEQ 'Y'                                                           222448
     C                     ADD  MISC01    W#CHGS                          CFT009
     C                     ADD  MISC02    W#CHGS                          CFT009
     C                     ADD  MISC03    W#CHGS                          CFT009
     C                     ADD  MISC04    W#CHGS                          CFT009
     C                     ADD  MISC05    W#CHGS                          CFT009
     C                     ADD  SWSCHG    W#CHGS                          CFT009
     C                     ENDIF                                          CFT009
     C**********           ENDIF                                                       CFT009 222448
     C**********                                                       ***CEU006
     C******CHECK 'PAY PLUS CHARGES' IND NOT = 'Y' AND      **         ***CEU006
     C******'CHARGES TO THE DEBIT ACCOUNT' IS BLANK         **         ***CEU006
     C**********                                                       ***CEU006
     C********** ADDC      IFNE 'A'                                       CEU006
     C********** CDRO      ANDEQ*ZERO                                     CEU006
     C********** PYAM      SUB  TXCH      WAMNT  130                      CEU006
     C********** WAMNT     SUB  CQCH      WAMNT                           CEU006
     C********** WAMNT     SUB  CSTA      WAMNT                           CEU006
     C********** WAMNT     SUB  SPCH      WAMNT                           CEU006
     C********** WAMNT     SUB  MSCH      WAMNT                           CEU006
     C********** WAMNT     SUB  TRCM      WAMNT                           CEU006
     C**********                                                    S01494CEU006
     C****FX/Change*Commission**************************************S01494CEU006
     C********** WAMNT     SUB  OPCHCM    WAMNT                     S01494CEU006
     C**********                                                    S01499CEU006
     C****Total*V.A.T.*Charge***************************************S01499CEU006
     C********** WAMNT     SUB  OPVATT    WAMNT                     S01499CEU006
     C**********           END                                         ***CEU006
     C*                                                                ***
     C           ADDC      IFEQ 'A'
     C***********CDRO      ORNE *ZERO                                                         CSD027
     C           CDRO      ORNE *BLANKS                                                       CSD027
     C                     Z-ADDPYAM      WAMNT
     C                     ELSE                                           CEU006
     C           PYAM      SUB  W#CHGS    WAMNT                           CEU006
     C                     END
      *                                                                                       222448
      ** Add Receiver's Charges Remitted from the extension file.                             222448
      *                                                                                       222448
     C           CFT014    IFEQ 'Y'                                                           222448
     C                     ADD  OPRCRM    WAMNT                                               222448
     C                     ENDIF                                                              222448
     C*                                                                ***
     C*  ** FORMAT THE AMOUNT USING PROCEDURE SR03                     ***
     C                     EXSR SR03
     C*                                                                ***
     C                     ENDSR                           END SR06
     C/EJECT
4630 C********************************************************************
     C********************************************************************
     C********************************************************************
     C*     *         SUBROUTINE 07                         ***        ***
     C*     *                                               ***        ***
     C*     *  DETERMINE AND FORMAT AMOUNT FOR              ***        ***
     C*     *  CHEQUES TO BE PAID                           ***        ***
     C*     *                                               ***        ***
     C*********************************************************        ***
     C*                                                                ***
     C* **AMOUNT = 'PROCEEDS REMITTED' + 'CORRESPONDENTS CHARGES'      ***
     C*                                - 'DEDUCTIONS'                  ***
     C*                                                                ***
     C*                                                                ***
     C* ** FORMAT THE AMOUNT USING SUBROUTINE 03                       ***
     C*                                                                ***
     C/EJECT
4630 C********************************************************************
     C********************************************************************
     C********************************************************************
     C****************SUBROUTINE 08                         ***        ***S01310
     C**********OUTPUT*7*RECORDS TO THE OUTGOING SWIFT      ***        ***S01310
     C**********MESSAGE**FILE (PF/MSMSOPF).                 ***        ***S01310
     C**********OUTPUT*A*RECORD TO THE SWIFT REFERENCE      ***        ***S01310
     C**********FILE*(PF/MSIXOPF).                          ***        ***S01310
     C*********************************************************        ***S01310
     C***********SR08******BEGSR                                       ***S01310
     C*********************                                            ***S01310
     C****FIELDS*COMMON*TO*RECORDS TO BE OUTPUTTED                     ***S01310
     C*********************MOVE MXMIND    MSMI                         ***S01310
     C*********************MOVELMXTREF    TNRF                         ***S01310
     C*********************MOVE MXDFLG    PTDL                         ***S01310
     C*********************                                            ***S01310
     C****FIRST*RECORD*****                                            ***S01310
     C*********************MOVELMT2021    MDTA                         ***S01310
     C*********************WRITEMSMSOPFF               42  ON, D/B ERROR  S01310
     C************IN42*****CABEQ'1'       WRTERR                          S01310
     C*********************                                            ***S01310
     C****SECOND*RECORD****                                            ***S01310
     C*********************MOVELMT2022    MDTA                         ***S01310
     C*********************WRITEMSMSOPFF               42  ON, D/B ERROR  S01310
     C************IN42*****CABEQ'1'       WRTERR                          S01310
     C*********************                                            ***S01310
     C****THIRD*RECORD*****                                            ***S01310
     C*********************MOVELMT2023    MDTA                         ***S01310
     C*********************WRITEMSMSOPFF               42  ON, D/B ERROR  S01310
     C************IN42*****CABEQ'1'       WRTERR                          S01310
     C*********************                                            ***S01310
     C****FOURTH*RECORD****                                            ***S01310
     C*********************MOVELMT2024    MDTA                         ***S01310
     C*********************WRITEMSMSOPFF               42  ON, D/B ERROR  S01310
     C************IN42*****CABEQ'1'       WRTERR                          S01310
     C*********************                                            ***S01310
     C****FIFTH*RECORD*****                                            ***S01310
     C*********************MOVELMT2025    MDTA                         ***S01310
     C*********************WRITEMSMSOPFF               42  ON, D/B ERROR  S01310
     C************IN42*****CABEQ'1'       WRTERR                          S01310
     C*********************                                            ***S01310
     C****SIXTH*RECORD*****                                            ***S01310
     C*********************MOVELMT2026    MDTA                         ***S01310
     C*********************WRITEMSMSOPFF               42  ON, D/B ERROR  S01310
     C************IN42*****CABEQ'1'       WRTERR                          S01310
     C*********************                                            ***S01310
     C****SEVENTH*RECORD***                                            ***S01310
     C*********************MOVELMT2027    MDTA                         ***S01310
     C*********************WRITEMSMSOPFF               42  ON, D/B ERROR  S01310
     C************IN42*****CABEQ'1'       WRTERR                          S01310
     C*********************ADD  7         P3NO2                           S01117
     C*********************ADD  7         AUNO2                     S01117S01310
     C*********************                                            ***S01310
     C*********************                                            ***S01310
     C***FORMAT*AND*OUTPUT*A RECORD TO THE SWIFT                       ***S01310
     C***REFERENCE*FILE*(PF/MSIXOPF)                                   ***S01310
     C*********************MOVE 'D'       RECI                            S01310
     C*********************MOVE 'P'       MSMI                            S01310
     C*********************MOVE PREF      PREFS  14                       S01310
     C*********************MOVELPREFS     TNRF                            S01310
     C*********************MOVE FTCS      MSTS                            S01310
     C*********************MOVE RUNA      LADT                            S01310
     C*********************TIME           LATM                            S01310
     C*********************MOVE PYTP      TNTP                            S01310
     C*********************MOVE PYST      SBTP                            S01310
     C*********************MOVE '202'     MTPY                            S01310
     C*********************MOVE SWPC      MSGP                            S01310
     C*********************MOVE SCRNM     RPNM                            S01310
     C*********************MOVE SCTWN     RPTN                            S01310
     C*********************TIME           MGTM                            S01310
     C*********************MOVE RUNA      MGDT                            S01310
     C*********************MOVE MXOTID    STID                            S01310
     C*********************MOVE RECADD    DTID                            S01310
     C*********************MOVE SBICN     SECN                            S01310
     C*********************MOVE SCUSNO    DECN                            S01310
     C*********************MOVE SWTWRK    SWTX                            S01310
     C***********AUP2******IFNE *BLANK                                    S01310
     C*********************MOVE AUP2      RUSR                            S01310
     C*********************ELSE                                           S01310
     C*********************MOVE AUP1      RUSR                            S01310
     C*********************END                                            S01310
     C*********************MOVE SRUNA     RELD                            S01310
     C*********************MOVE LCHT      RELT                            S01310
     C************IN01*****IFEQ '1'                        OTPAYDD        S01310
     C*********************MOVE M1AMNT    AMTS                            S01310
     C*********************MOVE SLDTD3    SVDT                            S01310
     C***********DSTT******IFEQ 'F'                                       S01310
     C*********************MOVELDST1      NSTR                            S01310
     C*********************END                                            S01310
     C***********DSTT******IFEQ 'C'                                       S01310
     C***********DSTT******OREQ 'A'                                       S01310
     C***********SNCT******IFEQ 'N'                                       S01310
     C*********************MOVELSNCO      XSNCO   2                       S01310
     C*********************MOVE XSNCO     NSTR                            S01310
     C*********************MOVELSMCY      NSTR                            S01310
     C*********************END                                            S01310
     C*********************END                                            S01310
     C*********************ELSE                            CQPACDD        S01310
     C*********************MOVE M1AMNT    AMTS                            S01310
     C*********************MOVE PVDTD3    SVDT                            S01310
     C***********RBKT******IFEQ 'F'                                       S01310
     C*********************MOVELRBK1      NSTR                            S01310
     C*********************END                                            S01310
     C***********RBKT******IFEQ 'C'                                       S01310
     C***********RBKT******OREQ 'A'                                       S01310
     C***********SNCT******IFEQ 'N'                                       S01310
     C*********************MOVELSNCO      XSNCO   2                       S01310
     C*********************MOVE XSNCO     NSTR                            S01310
     C*********************MOVELPCCY      NSTR                            S01310
     C*********************END                                            S01310
     C*********************END                                            S01310
     C*********************END                                            S01310
     C*********************MOVE 'S'       SWTX                            S01310
     C*********************MOVE 'Y'       TSKS                            S01310
     C*********************MOVE BRCAA     BRCA                      S01117S01310
     C**IF*MULTIBRANCH*INDICATOR FROM RUNDAT ACTIVE                 S01117S01310
     C************IN50*****IFEQ '1'                                 S01117S01310
     C***********BRCAA*****IFNE ORBR                                S01117S01310
     C*********************MOVE ORBR      OTHB                      S01117S01310
     C**MOVE*"ORIGINATING*BRANCH" TO 'OTHER BRANCH TYPE'(OTHT)      S01117S01310
     C*********************MOVE ' BRANCH"'FLD1   20                 S01117S01310
     C*********************MOVEL'"ORIGINA'FLD2   12                 S01117S01310
     C*********************MOVE 'TING'    FLD2                      S01117S01310
     C*********************MOVELFLD2      FLD1                      S01117S01310
     C*********************MOVE FLD1      OTHT                      S01117S01310
     C*********************                                         S01117S01310
     C*********************ELSE                                     S01117S01310
     C*********************MOVE *BLANKS   OTHB                      S01117S01310
     C*********************MOVE *BLANKS   OTHT                      S01117S01310
     C*********************END                                      S01117S01310
     C**IF*MULTIBRANCH*INDICATOR FROM RUNDAT NOT ACTIVE             S01117S01310
     C*********************ELSE                                     S01117S01310
     C*********************MOVE *BLANKS   OTHB                      S01117S01310
     C*********************MOVE *BLANKS   OTHT                      S01117S01310
     C*********************END                                      S01117S01310
     C*********************WRITEMSIXOPFF               41  ON, D/B ERROR  S01310
     C**N41****************ADD  1         P3NO3                     S01117S01310
     C**N41****************ADD  1         AUNO3                     S01117S01310
     C*********************GOTO SR08N                                     S01310
     C*********************                                            ***S01310
     C***********WRTERR****TAG                              ))))))))))))))S01310
     C*********************MOVE 'MSMSOPFF'DBFNAM            )))  DATA  )))S01310
     C*********************MOVELMXTREF    DBERKY            )))  BASE  )))S01310
     C*********************MOVE '05'      DBERR#            ))) ERROR  )))S01310
     C*********************EXSR DBERR                       )))   05   )))S01310
     C*********************                                 ))))))))))))))S01310
     C*********************                                            ***S01310
     C***********SR08N*****ENDSR                           END SR08       S01310
     C*/EJECT**************                                               S01310
     C*****************************************************************   S01310
     C*   OMSG - output correctly generated messages                  *   S01310
     C*   Called by - main process                                    *   S01310
     C*   Calls - WREF Write o/p reference to PF/MGOREFPD.            *   S01310
     C*****************************************************************   S01310
     C*                                                                   S01310
     C           OMSG      BEGSR                                          S01310
     C*                                                                   S01310
     C**  Write reference record to PF/MGOREFPD.                          S01310
     C*                                                                   S01310
     C                     EXSR WREF                                      S01310
     C/COPY WNCPYSRC,FTH00001
      *                                                                                       222239
     C           WERROR    IFEQ 'Y'                                                           222239
     C                     GOTO MSGEND                                                        222239
     C                     ENDIF                                                              222239
     C/COPY WNCPYSRC,HUT110_044                                                               HUT110
     C           CSW209    IFEQ 'Y'                                                           CSW209
     C           OPOMVF    ANDEQ'COV'                                                         CSW209
     C                     ADD  1         Q                                                   CSW209
     C           Q         OCUR MULT                                                          CSW209
     C                     MOVEL':119:'   MTAG                                                CSW209
     C                     MOVEL*BLANKS   MFLD                                                CSW209
     C                     MOVEL'COV'     MFLD                                                CSW209
     C                     WRITEMGOMSGD0               42                                     CSW209
     C           *IN42     IFEQ *ON                                                           CSW209
     C                     MOVE '042'     DBERR#                                              CSW209
     C                     MOVEL*BLANKS   DBERKY                                              CSW209
     C                     MOVEL'MGOMSGPD'DBFNAM                                              CSW209
     C                     EXSR DBERR                                                         CSW209
     C                     ENDIF                                                              CSW209
     C                     MOVE *BLANKS   MULT                                                CSW209
     C                     ENDIF                                                              CSW209
     C*                                                                   S01310
     C**  Write multiple occurrence data structure to MGOMSGPD            S01310
     C                     Z-ADD1         Q       20                      S01310
     C           Q         OCUR MULT                                      S01310
     C*                                                                   S01310
     C********** Q         DOWLE42                                        S01310       S01310 CSW209
     C           Q         DOWLE79                                                            CSW209
     C           MFLD      ANDNE*BLANKS                                   S01310
     C                     WRITEMGOMSGD0               42                 S01310
     C*                                                                   S01310
     C**  Error on write to PF/MGOMSGPD (message data file)               S01310
     C*                                                                   S01310
     C           *IN42     IFEQ '1'                                       S01310
     C                     MOVE '012'     DBERR#           * * * * * * * *S01310
     C                     MOVEL'       ' DBERKY           *  DBERR 012  *S01310
     C                     MOVEL'MGOMSGPD'DBFNAM           * * * * * * * *S01310
     C                     EXSR DBERR                                     S01310
     C                     END                                            S01310
     C*                                                                   S01310
     C* UPDATE THE CQPAC/OTPAY RECORD TO SAY MESSAGE GENERATED            071383
     C                     EXSR SR14                                      071383
     C*                                                                   071383
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     END                                            S01310
      *                                                                   138077
      **  Write multiple occurrence data structure to MGOEXTPD            138077
      *                                                                   138077
     C                     Z-ADD1         V       20                      138077
     C           V         OCUR EXTN                                      138077
     C           V         DOWLE20                                        138077
     C           MCSI      ANDNE*BLANKS                                   138077
     C                     WRITEMGOEXTD0               43                 138077
      *                                                                   138077
      **  Error on write to PF/MGOEXTPD (message data extension file)     138077
      *                                                                   138077
     C           *IN43     IFEQ '1'                                       138077
     C                     MOVE '043'     DBERR#           * * * * * * * *138077
     C                     MOVEL'        'DBERKY           *  DBERR 043  *138077
     C                     MOVEL'MGOEXTPD'DBFNAM           * * * * * * * *138077
     C                     EXSR DBERR                                     138077
     C                     END                                            138077
     C                     ADD  1         V                               138077
     C           V         OCUR EXTN                                      138077
     C                     ENDDO                                          138077
     C*                                                                   S01310
     C/COPY WNCPYSRC,FT0645C011
     C           MSGEND    TAG                                                                222239
     C                     ENDSR                                          S01310
     C/EJECT                                                              S01310
     C/COPY WNCPYSRC,FT0645C012
     C*****************************************************************   S01310
     C*   WREF - Write reference record to PF/MGOREFPD                *   S01310
     C*   Called by - OMSG  output message PF/MGOMSGPD                *   S01310
     C*****************************************************************   S01310
     C*                                                                   S01310
     C           WREF      BEGSR                                          S01310
     C*                                                                   S01310
     C                     MOVE *BLANKS   SYTM                            S01310
     C                     MOVEL'FT'      MODI                            S01310
     C                     MOVELTRNA      TRNO                            S01310
     C                     MOVE *BLANKS   TRNF                            S01310
     C                     MOVE *BLANKS   TRNM                            S01310
     C                     MOVELPREF      MTRN                            S01310
     C                     MOVE PYTP      TNTP                            S01310
     C                     MOVE PYST      SBTP                            S01310
     C                     MOVE *BLANKS   EVTP                            S01310
     C                     MOVELSBICN     SECN                            S01310
     C                     MOVELSCUSNO    DECN                            S01310
     C*
     C/COPY WNCPYSRC,FT0645CP13                                           S01408
     C*
     C**********           MOVE '202'     MTPY                                         S01310 CSW209
     C                     EXSR SR205                                                         CSW209
     C                     MOVE M1MTPY    MTPY                                                CSW209
     C*
     C/COPY WNCPYSRC,FT0645CP14                                           S01408
     C*
     C*********************MOVELSWPC      MPRY                      S01310S01117
     C*  FORMAT SWIFT PRIORITY CODE                                       S01117
     C*                                                                   S01117
     C           SWPC      IFEQ 1                                         S01117
     C                     MOVE 'U'       MPRY                            S01117
     C                     ELSE                                           S01117
     C           SWPC      IFEQ 2                                         S01117
     C                     MOVE 'N'       MPRY                            S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C                     MOVEL*BLANKS   LSCC                            S01310
     C                     MOVEL*BLANKS   PTST                            S01310
     C                     MOVEL*BLANKS   CARQ                            S01310
     C                     MOVEL*BLANKS   MPDE                            S01310
     C                     MOVEL@HRDT     HRDT                            S01310
     C/COPY WNCPYSRC,FT0645C036
     C                     TIME           MGTM                            S01310
     C                     MOVE RUNA      LADT                            S01310
     C                     MOVE MGTM      LATM                            S01310
     C/COPY WNCPYSRC,FT0645C018
      *                                                                   S01310
      **  Convert run date to YYMMDD                                      S01310
      *                                                                   S01310
     C                     CALL 'ZM0060'                                  S01310
     C                     PARM RUND      ZMDAY   50                      S01310
     C                     PARM           ZMDATE  6                       S01310
     C                     MOVE ZMDATE    MGDE                            S01310
      *                                                                   S01310
      ** Set-up Message Generation  Century flag                          113352
      *                                                                   113352
     C                     MOVELMGDE      YY      20                      113352
     C           YY        IFLT 72                                        113352
     C                     MOVE '2'       CIND                            113352
     C                     ELSE                                           113352
     C                     MOVE '1'       CIND                            113352
     C                     ENDIF                                          113352
      *                                                                                       CSD015
      ** If Watch List Checking is Applied and CSW025 is off,                                 CSD015
      ** do watch processing.                                                                 CSD015
      *                                                                                       CSD015
     C           CSD015    IFEQ 'Y'                                                           CSD015
     C           W1EWLC    ANDEQ'Y'                                                           222385
     C           CSW025    ANDEQ'N'                                                           CSD015
     C                     EXSR SRWTCH                                                        CSD015
     C                     ENDIF                                                              CSD015
      *                                                                   113352
     C           MGST      IFEQ 'RSND'                                    S01310
     C                     MOVE SRUNA     RELD                            S01310
     C                     MOVE LATM      RELT                            S01310
     C                     END                                            S01310
      *                                                                   S01310
      *                                                                   S01310
     C           AUP2      IFNE *BLANK                                    S01310
     C                     MOVE AUP2      RUSR                            S01310
     C                     ELSE                                           S01310
     C                     MOVE AUP1      RUSR                            S01310
     C                     END                                            S01310
     C***********          MOVE M1AMNT    AMTS                      S01310064252
     C                     MOVELM1AMNT    AMTS                            064252
     C                     MOVELM1AMNT    AMTX                            S01117
     C                     MOVE 'Y'       TSKS                            S01310
     C*********************MOVE SLDTD3    SVDT                      S01310041780
     C                     MOVE PVDTD3    SVDT                            041780
      *                                                                   164663
      ** Setup century indicator CINDV for value date SVDT                164663
      *                                                                   164663
     C           SVDT      IFEQ *BLANK                                    164663
     C                     MOVE *BLANK    CINDV                           164663
     C                     ELSE                                           164663
     C                     MOVELSVDT      YY      20                      164663
     C           YY        IFLT 72                                        164663
     C                     MOVE '2'       CINDV                           164663
     C                     ELSE                                           164663
     C                     MOVE '1'       CINDV                           164663
     C                     ENDIF                                          164663
     C                     ENDIF                                          164663
      *                                                                   164663
     C                     MOVE *BLANKS   NSNO                            S01117
     C           DSTT      IFEQ 'F'                                       S01310
     C*********************MOVELDST1      NSNO                      S01310S01117
     C                     MOVE NOSTN     NSNO                            S01117
     C                     END                                            S01310
     C***********DSTT******IFEQ 'C'                                 S01310S01117
     C***********DSTT******OREQ 'A'                                 S01310S01117
     C***********SNCT******IFEQ 'N'                                 S01310S01117
     C*********************MOVELSNCO      NSNO                      S01310S01117
     C                     MOVE PCCY      CCY                             S01310
     C*********************END                                      S01310S01117
     C*********************END                                      S01310S01117
     C*                                                                   S01310
     C**  Branch details                                                  S01310
     C*                                                                   S01310
     C                     MOVE BRCAA     BRCA                            S01310
     C* IF MULTIBRANCH INDICATOR FROM RUNDAT ACTIVE                       S01310
     C           *IN50     IFEQ '1'                                       S01310
     C           BRCAA     IFNE ORBR                                      S01310
     C                     MOVE ORBR      ORBR    3                       S01310
     C                     MOVE ORBR      OTHB                            S01310
     C* MOVE "ORIGINATING BRANCH" TO 'OTHER BRANCH TYPE'(OTHT)            S01310
     C                     MOVE ' BRANCH"'FLD1   20                       S01310
     C                     MOVEL'"ORIGINA'FLD2   12                       S01310
     C                     MOVE 'TING'    FLD2                            S01310
     C                     MOVELFLD2      FLD1                            S01310
     C                     MOVE FLD1      OTHT                            S01310
      *                                                                   S01310
     C                     ELSE                                           S01310
     C                     MOVE *BLANKS   OTHB                            S01310
     C                     MOVE *BLANKS   OTHT                            S01310
     C                     END                                            S01310
     C* IF MULTIBRANCH INDICATOR FROM RUNDAT NOT ACTIVE                   S01310
     C                     ELSE                                           S01310
     C                     MOVE *BLANKS   OTHB                            S01310
     C                     MOVE *BLANKS   OTHT                            S01310
     C                     END                                            S01310
     C                     MOVE *BLANKS   RCBR                            S01310
     C*                                                                   S01310
     C                     MOVE *BLANKS   NETI                            S01310
     C*********************MOVE *BLANKS   DELC                      S01310S01117
     C*                                                                   S01117
     C*   READ SDCURRPD FOR DELIVERY NOTIFICATION AND NON-DELIVERY        S01117
     C*     WARNING FLAGS                                                 S01117
     C                     CALL 'AOCURRR0'                                S01117
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM PCCY      @CCY    3                       S01117
     C           SDCURR    PARM SDCURR    DSSDY                           S01117
     C*                                                                   S01117
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     MOVE '28'      DBERR#             *************S01117
     C                     MOVEL@CCY      DBERKY             * DBERR 028 *S01117
     C                     MOVEL'SDCURRPD'DBFNAM             *************S01117
     C                     EXSR DBERR                                     S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C           A6NDWR    IFEQ 'Y'                                       S01117
     C           A6DNOR    ANDEQ'Y'                                       S01117
     C                     MOVE '3'       DELC                            S01117
     C                     END                                            S01117
     C           A6NDWR    IFNE 'Y'                                       S01117
     C           A6DNOR    ANDEQ'Y'                                       S01117
     C                     MOVE '2'       DELC                            S01117
     C                     END                                            S01117
     C           A6NDWR    IFEQ 'Y'                                       S01117
     C           A6DNOR    ANDNE'Y'                                       S01117
     C                     MOVE '1'       DELC                            S01117
     C                     END                                            S01117
     C           A6NDWR    IFNE 'Y'                                       S01117
     C           A6DNOR    ANDNE'Y'                                       S01117
     C***********          MOVE '0'       DELC                      S01117068367
     C                     MOVEL*BLANKS   DELC                            068367
     C                     END                                            S01117
      *                                                                   068367
      * Ensure that message priority and delivery notification are        068367
      * valid combination :                                               068367
      * 1. for MPRY = 'U' DELC must be '1' or '3',                        068367
      * 2. for MPRY = 'N' DELC must be ' ' or '2'.                        068367
      *                                                                   068367
     C           MPRY      IFEQ 'U'                                       068367
     C           DELC      ANDEQ' '                                       068367
     C           MPRY      OREQ 'U'                                       068367
     C           DELC      ANDEQ'2'                                       068367
     C                     MOVEL'1'       DELC                            068367
     C                     END                                            068367
      *                                                                   068367
     C           MPRY      IFEQ 'N'                                       068367
     C           DELC      ANDEQ'1'                                       068367
     C           MPRY      OREQ 'N'                                       068367
     C           DELC      ANDEQ'3'                                       068367
     C                     MOVEL'2'       DELC                            068367
     C                     END                                            068367
     C*                                                                   S01117
     C                     MOVE *BLANKS   DYST                            S01310
     C                     MOVE *BLANKS   RSID                            S01310
     C                     MOVE *BLANKS   MSE1                            S01310
     C                     MOVE *BLANKS   ELIN                            S01310
     C                     MOVE *BLANKS   SSAC                            S01310
     C                     MOVE *BLANKS   MIR                             S01310
     C*********************MOVE *BLANKS   TSKS                      S01310S01117
     C                     MOVE *BLANKS   TSKY                            S01310
     C/COPY WNCPYSRC,FT0645C001
      *                                                                   S01310
     C                     MOVEL@CHG      AORR                                                CSW025
     C/COPY WNCPYSRC,FTH00299
     C                     MOVEL'N'       WERROR  1                                           222239
     C                     WRITEMGOREFD0               41                 S01310
      *                                                                   S01310
      **  Error on write to PF/MGOREFPD (message reference file)          S01310
      *                                                                   S01310
     C           *IN41     IFEQ '1'                                       S01310
     C                     MOVEL'Y'       WERROR  1                                           222239
     C**********           MOVE '014'     DBERR#           * * * * * * * *S01310              222239
     C**********           MOVEL'       ' DBERKY           *  DBERR 014  *S01310              222239
     C**********           MOVEL'MGOREFPD'DBFNAM           * * * * * * * *S01310              222239
     C**********           EXSR DBERR                                     S01310              222239
      *                                                                                       222239
      ** Update the CQPAC/OTPAY record to say message generated                               222239
      *                                                                                       222239
     C                     EXSR SR14                                                          222239
     C                     GOTO REFEND                                                        222239
     C                     END                                            S01310
     C/COPY WNCPYSRC,FT0645C020
     C           REFEND    TAG                                                                222239
     C                     ENDSR                                          S01310
      *                                                                   S01310
     C/EJECT                                                              S01310
4630 C********************************************************************
     C********************************************************************
     C********************************************************************
     C*     *         SUBROUTINE 09                         ***        ***
     C*     *   OUTPUT 7 RECORDS TO THE OUTGOING SWIFT      ***        ***
     C*     *   MESSAGES FILE (PF/MSMSOPF).                 ***        ***
     C*     *   OUTPUT A RECORD TO THE SWIFT REFERENCE      ***        ***
     C*     *   FILE (PF/MSIXOPF).                          ***        ***
     C*********************************************************        ***
     C/EJECT
4630 C********************************************************************
     C********************************************************************
     C********************************************************************
     C*     *         SUBROUTINE 10                         ***        ***
     C*     *                                               ***        ***
     C*     *  TO INITIALISE FIELDS IN DATA STRUCTURE       ***        ***
     C*     *  FOR FORMATTING SWIFT RECORDS                 ***        ***
     C*     *                                               ***        ***
     C*********************************************************        ***
     C           SR10      BEGSR                                       ***
     C*                                                                ***
     C                     MOVE *BLANKS   MT2021
     C                     MOVE *BLANKS   MT2022
     C                     MOVE *BLANKS   MT2023
     C                     MOVE *BLANKS   MT2024
     C                     MOVE *BLANKS   MT2025
     C                     MOVE *BLANKS   MT2026
     C                     MOVE *BLANKS   MT2027
     C*    SET 'OUR TID'                                               ***
     C                     MOVE MXOTID    M1OTID
     C*********************Z-ADD1         B01                             S01310
     C*********************MOVE X01       M1HEAD                          S01310
     C*********************MOVE X0D25     M1CRL1                          S01310
     C*********************MOVE X0D25     M1CRL2                          S01310
     C*********************MOVE X0D25     M1CRL3                          S01310
     C*********************MOVE X0D25     M1CRL4                          S01310
     C*********************MOVE X0D25     M1CRL6                          S01310
     C*********************MOVE X0D25     M1CRL7                          S01310
     C*********************MOVE X0D25     M1CRL8                          S01310
     C*
     C/COPY WNCPYSRC,FT0645CP11                                           S01408
     C*
     C**********           MOVE '202'     M1MSGT                                              CSW209
      ** Determine whether MT202 or MT205 will be generated                                   CSW209
     C                     EXSR SR205                                                         CSW209
     C                     MOVE M1MTPY    M1MSGT                                              CSW209
     C*
     C/COPY WNCPYSRC,FT0645CP12                                           S01408
     C*
     C*********************MOVE SWPC      M1MSGP                          S01117
     C*                                                                   S01117
     C*  FORMAT SWIFT PRIORITY CODE                                       S01117
     C           SWPC      IFEQ 1                                         S01117
     C                     MOVE 'U'       M1MSGP                          S01117
     C                     ELSE                                           S01117
     C           SWPC      IFEQ 2                                         S01117
     C                     MOVE 'N'       M1MSGP                          S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C                     MOVE RECADD    M1RADD
     C*********************MOVE ':20:'    M1TG20                          S01310
     C*********************MOVELPREF      M1TREF                          S01310
     C*********************MOVE '1'       M1TREF                          S01310
     C*********************MOVE ':21:'    M1TG21                          S01310
     C                     MOVEL*BLANKS   M1RREF                          058745
     C           RLPR      IFEQ *BLANK                                    058745
     C                     MOVEL'NONREF'  M1RREF                          S01310
     C                     ELSE                                           058745
     C                     MOVELRLPR      M1RREF                          058745
     C                     END                                            058745
     C*********************                                               S01310
     C*********************                                               S01310
     C***DETERMINE*WHETHER*THE RECORD IS FROM OTPAY OR CQPAC, AND         S01310
     C***PROCESS*FIELD*:21: ACCORDINGLY                                   S01310
     C*********************                                               S01310
     C************IN01*****IFEQ '1'                                       S01310
     C***********RLPR******IFEQ *BLANK                                    S01310
     C*********************MOVELPREF      M1RTRT                          S01310
     C*********************MOVELPREF      M1RREF                          S01310
     C*********************ELSE                                           S01310
     C*********************MOVELRLPR      M1RTRT                          S01310
     C*********************MOVELRLPR      M1RREF                          S01310
     C*********************END                                            S01310
     C*********************ELSE                                           S01310
     C*********************                                               S01310
     C************IN02*****IFEQ '1'                                       S01310
     C*********************                                               S01310
     C*********************MOVELPREF      M1RTRT                          S01310
     C*********************MOVELPREF      M1RREF                          S01310
     C*********************                                               S01310
     C*********************END                                            S01310
     C*********************END                                            S01310
     C*
     C*********************MOVE ':32A:'   M1TG32                          S01310
     C                     MOVE PVDTD3    M1VDAT
     C                     MOVE AMNT32    M1AMNT                          S01310
     C                     MOVE CCY32     M1RCCY                          S01310
     C*********************MOVE 'P'       MXMIND                          S01310
     C*********************MOVE PREF      PREFS                           S01310
     C*********************MOVE PREF      PREFS  15                       S01310
     C*********************MOVELPREFS     MXTREF                          S01310
     C*********************MOVELPREF      REF2   15                       S01310
     C                     MOVE *BLANKS   MXDFLG
     C*********************MOVE '-'       M7HYPH                          S01310
     C*********************Z-ADD3         B03                             S01310
     C*********************MOVE X03       M7ETX                           S01310
     C*                                                                ***
     C                     ENDSR                           END SR10
     C/EJECT
4630 C********************************************************************
     C********************************************************************
     C********************************************************************
     C***********     SUBROUTINE 11                         ***        ***S01310
     C***********                                           ***        ***S01310
     C*********TO*INCREMENT*MESSAGES*COUNT*FIELD*IN*        ***        ***S01310
     C*********DATA*AREA*MSFCTL*                            ***        ***S01310
     C***********                                           ***        ***S01310
     C*********************************************************        ***
     C***********SR11      BEGSR                                       ***S01310
     C***********                                                      ***S01310
     C*****INCREMENT*MESSAGES*COUNT*FIELD*IN*DATAAREA*MSFCTL*             S01310
     C************NAMVAR   DEFN MSFCTL    DFCTL                           S01310
     C************LOCK     IN   DFCTL                                     S01310
     C************         ADD  1         DFOMC                           S01310
     C************         ADD  1         DFOTL                       EFIXS01310
     C************         OUT  DFCTL                                     S01310
     C************                                                     ***S01310
     C************         ENDSR                           END SR11       S01310
     C*/EJECT                                                             S01310
4630 C********************************************************************
     C********************************************************************
     C********************************************************************
     C*     *         SUBROUTINE P1                         ***        ***
     C*     *                                               ***        ***
     C*     *   OUTPUT AN ENTRY TO SWIFT MESSAGE            ***        ***
     C*     *   REPORT PRTF/FT0645P1                        ***        ***
     C*     *                                               ***        ***
     C*********************************************************        ***
     C           SRP1      BEGSR                                       ***
     C/COPY WNCPYSRC,FT0645C015
     C                     ADD  1         PAGEP1
     C*
     C/COPY WNCPYSRC,FT0645CP15                                           S01408
     C*
     C                     WRITEP1H1                   80
     C   80                DO                              B001
     C*                                                    ))))))))))))))
     C*********************MOVE 'FT0645P1'DBFNAM           )))  DATA  ))) S01310
     C                     MOVEL'FT0645P1'DBFNAM           )))  DATA  ))) S01310
     C                     MOVEL'1'       DBERKY           )))  BASE  )))
     C                     MOVE 17        DBERR#           ))) ERROR  )))
     C                     EXSR DBERR                      )))   17   )))
     C*                                                    ))))))))))))))
     C                     END                             E001
     C/COPY WNCPYSRC,FT0645C016
     C*                                                                ***
     C                     ENDSR                           END SRP1
     C/EJECT
4630 C********************************************************************
     C********************************************************************
     C********************************************************************
     C*     *         SUBROUTINE P2                         ***        ***
     C*     *                                               ***        ***
     C*     *  TO HANDLE TELEX REPORT                       ***        ***
     C*     *                                               ***        ***
     C*     *                                               ***        ***
     C*********************************************************        ***
     C           SRP2      BEGSR                                       ***
     C*                                                                ***
     C           *IN01     IFEQ '1'
     C                     MOVEL'RECEIVIN'P2LIT1
     C                     MOVE 'G'       P2LIT1
     C                     ELSE
     C                     MOVEL'REMITTIN'P2LIT1
     C                     MOVE 'G'       P2LIT1
     C                     END
     C*                                                                ***
     C*  ** CHANGE OF CURRENCY, THEN PRINT ELS SUPPRESS CURRENCY       ***
     C*  ** 'CCNM' IS FROM TABLETG ACESS IN SR03 VIA SR06/SR07         ***
     C           P2CCY     IFNE CCNM
     C                     SETON                     14
     C                     Z-ADD0         MREC    10
     C                     MOVE CCNM      P2CCY
     C                     ELSE
     C                     ADD  1         MREC
     C                     SETOF                     14
     C                     END
     C*
     C           MREC      IFGT 1
     C                     SETON                     14
     C                     Z-ADD0         MREC
     C                     END
     C*                                                                ***
     C*  ** CONVERT PAY VALUE DATE FROM 'YYMMDD' TO 'DDMMMYY'          ***
     C                     MOVE PVDTD3    SDATE
     C                     MOVE MTH,SMM   WMM
     C                     MOVE SDD       WDD
     C                     MOVE SYY       WYY
     C*                                                                ***
     C*  ** CHANGE DATE THEN PRINT ELSE SUPRESS DATE PRINTING          ***
     C           WDATE     IFNE P2VAL
     C                     SETON                     15
     C                     Z-ADD0         DREC    10
     C                     MOVELWDATE     P2VAL
     C                     ELSE
     C                     ADD  1         DREC
     C                     SETOF                     15
     C                     END
     C*                                                                ***
     C           DREC      IFGT 1
     C                     SETON                     15
     C                     Z-ADD0         DREC
     C                     END
     C*                                                                ***
     C*********************MOVELPREF      P2REF                           S01310
     C                     MOVELTRNA      P2REF                           S01310
     C*                                                                ***
     C* ** FORMAT BANK TO BANK INFORMATIONS                            ***
     C                     MOVE BBI1      P2BTB1                       ***
     C                     MOVE BBI2      P2BTB2                       ***
     C                     MOVE BBI3      P2BTB3                       ***
     C                     MOVE BBI4      P2BTB4                       ***
     C                     MOVE BBI5      P2BTB5                       ***
     C                     MOVE BBI6      P2BTB6                       ***
     C*                                                                ***
     C*  ** PRINT TELEX MESSAGE                                        ***
     C                     ADD  1         PAGEP2
     C*                                                                   E25033
     C** NO OUTPUT IF MAIL PAYMENT ORDER WITH MT202 INDICATOR ON IN       E25033
     C** OUTGOING PAYMENTS.                                               E25033
     C*                                                                   E25033
     C           STMT      IFNE 2                          B001           E25033
     C                     WRITEP2H1                   80
     C   80                DO                              B001
     C*                                                    ))))))))))))))
     C*********************MOVE 'FT0645P2'DBFNAM           )))  DATA  ))) S01310
     C                     MOVEL'FT0645P2'DBFNAM           )))  DATA  ))) S01310
     C                     MOVEL'2'       DBERKY           )))  BASE  )))
     C                     MOVE 19        DBERR#           ))) ERROR  )))
     C                     EXSR DBERR                      )))   19   )))
     C*                                                    ))))))))))))))
     C                     END                             E001
     C                     WRITEP2H2                                   ***
     C                     END                                            E25033
     C*                                                                ***
     C*                                                                ***
     C                     ENDSR                           END SRP2
     C/EJECT
     C************************************************************
     C**SWFT*SR.***********                                               S01310
     C**TO*DETERMINE*ROUTE*FOR SWIFT MESSAGE GENERATION                   S01310
     C************************************************************        S01310
     C**SEE*BELOW*FOR*DETAILS OF DECISION                                 S01310
     C*
     C***********SWFT******BEGSR                                          S01310
     C****PROCESSING*TO*DETERMINE WHETHER THE MESSAGE                     S01310
     C****DESTINATION*IS*SWIFT, TELEX OR STTX                             S01310
      *****************************************************************   S01310
      ****PRAD*-*determine*settlement*network*address**************S01310 CSW096
      ****Called*by*-**********************************************S01310 CSW096
      ****Calls*******-********************************************S01310 CSW096
      *************************************************************S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********PRAD      BEGSR                                   S01310 CSW096
      ***********                                                  S01310 CSW096
      ****Set*up*priority*sender,*destination*&*network************S01310 CSW096
      ***********                                                  S01310 CSW096
      ****'S'*=*SWIFT;*'T'*=*TELEX;*'X'*=*STTX*********************S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********                                                         CSW096
     C*******************(1)**(2)**(3)**(4)**(5)**(6)**(7)****************CSW096
     C****-------------------------------------------------***************CSW096
     C****SWIFT*ADDRESS  Y   N   N   Y   Y   Y   Y ***************CSW096
     C****TELEX*ADDRESS  N   Y   N   Y   Y   N   N ***************CSW096
     C****STTX*ADDRESS*  N   N   Y   N   N   Y   Y ***************CSW096
     C****SETT.*TYPE***             01  08  01  08 ***************CSW096
     C****-------------------------------------------------***************CSW096
     C****DESTN*=*CSID*  X               X       X ***************CSW096
     C****DESTN*=*TELX*      X       X             ***************CSW096
     C****DESTN*=*STTX*          X           X     ***************CSW096
     C****-------------------------------------------------***************CSW096
     C****MESSAGE*ROUTE                            ***************CSW096
     C****CODE*(SWTX)**  S   T   X   T   S   X   S ***************CSW096
     C***********                                                         CSW096
      ***********                                                  S01310 CSW096
      ***Move*new*field*names*to*old*to*ensure*continuity*of*code.*S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********          MOVELBBCSID    CSID                     S01310 CSW096
     C***********          MOVELBBTXA1    TELX                     S01310 CSW096
     C***********          MOVELBBSTAD    STTX   12                S01310 CSW096
     C***********          MOVELBBCRNM    CRNM                     S01310 CSW096
      ****SWIFT*?**************************************************S01310 CSW096
     C****(1)*************************************************************CSW096
     C***********          MOVE CSID      CSBIC   4                S01178 CSW096
     C***********GSFM******IFEQ 'Y'                                       S01310
     C***********BGMSDL    IFEQ 'Y'                                S01310 CSW096
     C***********CSBIC     ANDNE'BIC '                             S01178 CSW096
     C***********CSID      IFNE *BLANKS                                   CSW096
     C***********TELX      ANDEQ*BLANKS                                   CSW096
     C***********STTX      ANDEQ*BLANKS                                   CSW096
     C****(5)*************************************************************CSW096
     C***********CSID      ORNE *BLANKS                                   CSW096
     C***********TELX      ANDNE*BLANKS                                   CSW096
     C***********STTX      ANDEQ*BLANKS                                   CSW096
     C***********STMT      ANDEQ08                                        CSW096
     C****(7)*************************************************************CSW096
     C***********CSID      ORNE *BLANKS                                   CSW096
     C***********TELX      ANDEQ*BLANKS                                   CSW096
     C***********STTX      ANDNE*BLANKS                                   CSW096
     C***********STMT      ANDEQ08                                        CSW096
     C***********                                                         CSW096
     C***Settlement*type*CHAPS*should*go*through*SWIFT.************E21467 CSW096
     C***********                                                  E21467 CSW096
     C***********CSID      ORNE *BLANKS                            E21467 CSW096
     C***********TELX      ANDNE*BLANKS                            E21467 CSW096
     C***********STTX      ANDEQ*BLANKS                            E21467 CSW096
     C***********STMT      ANDEQ10                                 E21467 CSW096
     C****(7)******************************************************E21467 CSW096
     C***********CSID      ORNE *BLANKS                            E21467 CSW096
     C***********TELX      ANDEQ*BLANKS                            E21467 CSW096
     C***********STTX      ANDNE*BLANKS                            E21467 CSW096
     C***********STMT      ANDEQ10                                 E21467 CSW096
      ***********                                                  E21467 CSW096
     C*********************MOVE CSID      CSID   12                       S01310
     C***********          MOVE 'S'       SWTX    1                       CSW096
     C***********          MOVELSNCSID    NWSN                     S01310 CSW096
     C***********          MOVELCSID      NWDS                     S01310 CSW096
     C***********          MOVEL'SWIFT'   NWRK                     S01310 CSW096
     C***********          MOVE 'Y'       OSUFLG                   S01310 CSW096
     C***********          END                                     S01310 CSW096
     C***********          END                                            CSW096
      ***********                                                  S01310 CSW096
      ****Telex****************************************************S01310 CSW096
     C****(2)*************************************************************CSW096
     C***********BGMTMI    IFEQ 'Y'                                S01310 CSW096
     C***********CSID      IFEQ *BLANKS                                   CSW096
     C***********TELX      ANDNE*BLANKS                                   CSW096
     C***********STTX      ANDEQ*BLANKS                                   CSW096
     C****(4)*************************************************************CSW096
     C***********CSID      ORNE *BLANKS                                   CSW096
     C***********TELX      ANDNE*BLANKS                                   CSW096
     C***********STTX      ANDEQ*BLANKS                                   CSW096
     C***********STMT      ANDEQ01                                        CSW096
     C***********                                                         CSW096
     C*********************MOVE TELX      CSID                            S01310
     C***********          MOVE 'T'       SWTX                            CSW096
     C***********          MOVELSTELX     NWSN                     S01310 CSW096
     C***********          MOVELTELX      NWDS                     S01310 CSW096
     C***********          MOVEL'TELEX'   NWRK                     S01310 CSW096
     C***********          MOVE 'Y'       OSUFLG                   S01310 CSW096
     C***********          END                                            CSW096
     C***********          END                                     S01310 CSW096
      ***********                                                  S01310 CSW096
      ****STTX*network*available*?*********************************S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********BGMSDL    IFEQ 'Y'                                S01310 CSW096
     C****(3)*************************************************************CSW096
     C***********CSID      IFEQ *BLANKS                                   CSW096
     C***********TELX      ANDEQ*BLANKS                                   CSW096
     C***********STTX      ANDNE*BLANKS                                   CSW096
     C****(6)*************************************************************CSW096
     C***********CSID      ORNE *BLANKS                                   CSW096
     C***********TELX      ANDEQ*BLANKS                                   CSW096
     C***********STTX      ANDNE*BLANKS                                   CSW096
     C***********STMT      ANDEQ01                                        CSW096
     C***********                                                         CSW096
     C*********************MOVE STTX      CSID
     C***********          MOVE 'X'       SWTX                            CSW096
     C***********          MOVELSSTTX     NWSN                     S01310 CSW096
     C***********          MOVELSTTX      NWDS                     S01310 CSW096
     C***********          MOVEL'STTX'    NWRK                     S01310 CSW096
     C***********          MOVE 'Y'       OSUFLG                   S01310 CSW096
     C***********          END                                            CSW096
     C*********************ELSE                                           S01310
     C*********************MOVE *BLANKS   CSID                            S01310
     C*********************MOVE *BLANKS   SWTX                            S01310
     C***********          END                                            CSW096
      ***********                                                  S01310 CSW096
      ***Found*to*be*unroutable.***********************************S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********NWRK      IFEQ *BLANKS                            S01310 CSW096
     C***********NWSN      OREQ *BLANKS                            S01310 CSW096
     C***********          MOVELSCRNM     NWSN                     S01310 CSW096
     C***********          MOVELCRNM      NWDS                     S01310 CSW096
     C***********          MOVEL'UNROUT'  NWRK                     S01310 CSW096
     C***********          MOVE 'CRTD'    MGST                     S01310 CSW096
     C***********          MOVE '1'       MGSG                     S01310 CSW096
     C***********          MOVE 'Y'       OSUFLG                   S01310 CSW096
     C***********          END                                     S01310 CSW096
     C***********                                                         CSW096
     C***********          ENDSR                                          CSW096
     C***********                                                         CSW096
     C********************************************************************CSW096
     C**END*OF*SWIFT*TELEX*SUBROUTINE*************************************CSW096
     C********************************************************************CSW096
     C*/EJECT****                                                         CSW096
     C********************************************************************CSW096
     C*************************************************************S01310 CSW096
     C****NWAD*-*determine*default*network*addresses***************S01310 CSW096
     C****Called*by*-*SR01.****************************************S01310 CSW096
     C****Calls*****-**********************************************S01310 CSW096
     C*************************************************************S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********NWAD      BEGSR                                   S01310 CSW096
      ***********                                                  S01310 CSW096
      ****Default*is*SWIFT*****************************************S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********BBDNW2    IFEQ 'SWIFT'                            S01310 CSW096
     C***********BBCSID    ANDNE*BLANKS                            S01310 CSW096
     C***********@BIC      ANDNE'BIC'                              S01310 CSW096
     C***********BGMSDL    ANDEQ'Y'                                S01310 CSW096
     C***********          MOVELSNCSID    NWSN                     S01310 CSW096
     C***********          MOVELBBCSID    NWDS                     S01310 CSW096
     C***********          MOVELBBDNW2    NWRK                     S01310 CSW096
     C***********          MOVE 'Y'       OSUFLG                   S01310 CSW096
     C***********          END                                     S01310 CSW096
      ***********                                                  S01310 CSW096
      ****Default*is*TELEX*****************************************S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********BBDNW2    IFEQ 'TELEX'                            S01310 CSW096
     C***********BBTXA1    ANDNE*BLANKS                            S01310 CSW096
     C***********BGMTMI    ANDEQ'Y'                                S01310 CSW096
     C***********          MOVELSTELX     NWSN                     S01310 CSW096
     C***********          MOVELBBTXA1    NWDS                     S01310 CSW096
     C***********          MOVE BBDNW2    NWRK                     S01310 CSW096
     C***********          MOVE 'Y'       OSUFLG                   S01310 CSW096
     C***********          END                                     S01310 CSW096
      ***********                                                  S01310 CSW096
      ****Default*is*STTX******************************************S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********BBDNW2    IFEQ 'STTX'                             S01310 CSW096
     C***********BBSTAD    ANDNE*BLANKS                            S01310 CSW096
     C***********BGMSDL    ANDEQ'Y'                                S01310 CSW096
     C***********          MOVELSSTTX     NWSN                     S01310 CSW096
     C***********          MOVELBBSTAD    NWDS                     S01310 CSW096
     C***********          MOVE BBDNW2    NWRK                     S01310 CSW096
     C***********          MOVE 'Y'       OSUFLG                   S01310 CSW096
     C***********          END                                     S01310 CSW096
      ***********                                                  S01310 CSW096
      ****Default*is*PAPER*****************************************S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********BBDNW2    IFEQ 'PAPER'                            S01310 CSW096
     C***********          MOVELSCRNM     NWSN                     S01310 CSW096
     C***********          MOVELBBCRNM    NWDS                     S01310 CSW096
     C***********          MOVE BBDNW2    NWRK                     S01310 CSW096
     C***********          MOVE 'RSND'    MGST                     S01310 CSW096
     C***********          MOVE '2'       MGSG                     S01310 CSW096
     C***********          MOVE 'N'       OSUFLG                   S01310 CSW096
     C***********          END                                     S01310 CSW096
      ***********                                                  S01310 CSW096
      ****Found*to*be*unroutable***********************************S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********NWRK      IFEQ *BLANKS                            S01310 CSW096
     C***********NWDS      OREQ *BLANKS                            S01310 CSW096
     C***********NWSN      OREQ *BLANKS                            S01310 CSW096
     C***********          MOVELSCRNM     NWSN                     S01310 CSW096
     C***********          MOVELBBCRNM    NWDS                     S01310 CSW096
     C***********          MOVEL'UNROUT'  NWRK                     S01310 CSW096
     C***********          MOVE 'CRTD'    MGST                     S01310 CSW096
     C***********          MOVE '1'       MGSG                     S01310 CSW096
     C***********          MOVE 'Y'       OSUFLG                   S01310 CSW096
     C***********          END                                     S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********          ENDSR                                   S01310 CSW096
     C*/EJECT****                                                  S01310 CSW096
      *************************************************************S01310 CSW096
      ****FILL*-*Fill*up*array**GNR********************************S01310 CSW096
      ****Called*by***-*SR01.**************************************S01310 CSW096
      ****Calls*******-********************************************S01310 CSW096
      *************************************************************S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********FILL      BEGSR                                   S01310 CSW096
      ***********                                                  S01310 CSW096
      ****Is*message*to*be*generated*as*released*?*****************S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********          MOVE BBDS01    GNR,1                    S01310 CSW096
     C***********          MOVE BBDS02    GNR,2                    S01310 CSW096
     C***********          MOVE BBDS03    GNR,3                    S01310 CSW096
     C***********          MOVE BBDS04    GNR,4                    S01310 CSW096
     C***********          MOVE BBDS05    GNR,5                    S01310 CSW096
     C***********          MOVE BBDS06    GNR,6                    S01310 CSW096
     C***********          MOVE BBDS07    GNR,7                    S01310 CSW096
     C***********          MOVE BBDS08    GNR,8                    S01310 CSW096
     C***********          MOVE BBDS09    GNR,9                    S01310 CSW096
     C***********          MOVE BBDS10    GNR,10                   S01310 CSW096
     C***********          MOVE BBDS11    GNR,11                   S01310 CSW096
     C***********          MOVE BBDS12    GNR,12                   S01310 CSW096
     C***********          MOVE BBDS13    GNR,13                   S01310 CSW096
     C***********          MOVE BBDS14    GNR,14                   S01310 CSW096
     C***********          MOVE BBDS15    GNR,15                   S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********          ENDSR                                   S01310 CSW096
     C/EJECT                                                              S01310
      *****************************************************************   CSW096
      *   SRROUT - determine message routing                          *   CSW096
      *   Called by - SR01                                            *   CSW096
      *   Calls -                                                     *   CSW096
      *****************************************************************   CSW096
      *                                                                   CSW096
     C           SRROUT    BEGSR                                          CSW096
      *                                                                   CSW096
     C                     MOVE BRCA      I@SNBR                          CSW096
     C                     MOVE *BLANKS   I@DSCN                          CSW096
     C                     MOVE CUSTNO    I@DSCN                          CSW096
     C                     MOVE '202'     I@MTPY                          CSW096
     C                     MOVE 'N'       I@CONC                          CSW096
     C                     Z-ADDSTMT      I@SETT                          CSW096
     C                     MOVE FTCS      I@FTCS                          CSW096
     C                     MOVE MODI      I@MMOD                          CSW096
      *###################################################################CSW096
      *                                                                  #CSW096
      * Below are two copy sources intended for setting up the custom    #CSW096
      * parameter (P@ZZ) in the call to MG9900.                          #CSW096
      * One (MG9900FTCL) is in ALL MG generation programs and is for use #CSW096
      * when a change is required to all of them.                        #CSW096
      * The other is only in this program.                               #CSW096
     C/COPY WNCPYSRC,MG9900FTCL                                          #CSW096
     C/COPY WNCPYSRC,FT0645ROUT                                          #CSW096
      *                                                                  #CSW096
      *###################################################################CSW096
     C                     CALL 'MG9900'                                  CSW096
     C                     PARM *BLANKS   @RTCD                           CSW096
     C                     PARM           P@IN                            CSW096
     C                     PARM *BLANKS   P@OUT                           CSW096
     C                     PARM           P@ZZ  256                       CSW096
      *                                                                   CSW096
     C           @RTCD     IFNE *BLANKS                                   CSW096
     C                     MOVE '92'      DBERR#             * * * * * * *CSW096
     C                     MOVEL'*CALL'   DBERKY             * DBERR 920 *CSW096
     C                     MOVEL'MG9900  'DBFNAM             * * * * * * *CSW096
     C                     EXSR DBERR                                     CSW096
     C                     ELSE                                           CSW096
     C                     MOVE O@NWRK    NWRK                            CSW096
     C                     MOVE O@NWSN    NWSN                            CSW096
     C                     MOVE O@NWDS    NWDS                            CSW096
     C                     MOVE O@MGSG    MGSG                            CSW096
     C                     MOVE O@MGST    MGST                            CSW096
     C                     MOVE O@PCNB    CPAR                            CSW096
     C                     END                                            CSW096
      *                                                                                       CSW215
      ** Change the Network to 'PAPER' if the Precious Metal Indicator                        CSW215
      ** of the currency is 'Y' and Network is currently set to 'SWIFT'                       CSW215
      *                                                                                       CSW215
     C           CSW215    IFEQ 'Y'                                                           CSW215
     C                     CALL 'AOCURRR0'                                                    CSW215
     C                     PARM *BLANKS   PRTCD                                               CSW215
     C                     PARM '*KEY   ' POPTN                                               CSW215
     C                     PARM PCCY      PWCCY                                               CSW215
     C           SDCURR    PARM SDCURR    DSSDY                                               CSW215
      *                                                                                       CSW215
     C           PRTCD     IFNE *BLANKS                                                       CSW215
     C                     MOVE '035'     DBERR#                                              CSW215
     C                     MOVELPCCY      DBERKY                                              CSW215
     C                     MOVEL'SDCURRPD'DBFNAM                                              CSW215
     C                     EXSR DBERR                                                         CSW215
     C                     ENDIF                                                              CSW215
      *                                                                                       CSW215
     C           PRTCD     IFEQ *BLANKS                                                       CSW215
     C           NWRK      ANDEQ'SWIFT'                                                       CSW215
     C           A6PMRT    ANDEQ'Y'                                                           CSW215
     C                     MOVEL'PAPER'   NWRK                                                CSW215
     C                     ENDIF                                                              CSW215
     C                     ENDIF                                                              CSW215
      *                                                                   CSW096
     C           BBDNW2    IFEQ *BLANKS                                   CSW096
     C           NWRK      IFEQ 'SWIFT'                                   CSW096
     C                     MOVE 'S'       SWTX    1                       CSW096
     C                     END                                            CSW096
     C           NWRK      IFEQ 'TELEX'                                   CSW096
     C                     MOVE 'T'       SWTX                            CSW096
     C                     END                                            CSW096
     C           NWRK      IFEQ 'STTX'                                    CSW096
     C                     MOVE 'X'       SWTX                            CSW096
     C                     END                                            CSW096
     C                     END                                            CSW096
      *                                                                   CSW096
     C           NWRK      IFNE 'PAPER'                                   CSW096
     C                     MOVE 'Y'       OSUFLG                          CSW096
     C                     ELSE                                           CSW096
     C                     MOVE 'N'       OSUFLG                          CSW096
     C                     END                                            CSW096
      *                                                                   CSW096
     C                     ENDSR                                          CSW096
      /EJECT                                                              138077
      *****************************************************************   138077
      *                                                               *   138077
      *   SEXTN - Store customer with SWIFT address to data structure *   138077
      *                                                               *   138077
      *****************************************************************   138077
      *                                                                   138077
     C           SEXTN     BEGSR                                          138077
      *                                                                   138077
     C           SAVMTG    IFNE *BLANKS                                   138077
     C                     MOVE SAVMTG    @MTG                            138077
     C                     ELSE                                           138077
     C                     MOVELMTAG      @MTG                            138077
     C                     ENDIF                                          138077
     C           FLDTYP    IFEQ '5'                                       138077
     C           FLDTAG    ANDEQ'A'                                       138077
     C                     ADD  1         V                               138077
     C           V         OCUR EXTN                                      138077
     C                     Z-ADDQ         MPSN                            138077
     C                     MOVEL@MTG      MTG                             138077
     C                     MOVELBBCUST    MCSI                            138077
     C                     ENDIF                                          138077
      *                                                                   138077
     C           SEXT9     ENDSR                                          138077
     C/EJECT                                                              CSW096
     C/COPY WNCPYSRC,FTH00300
      *****************************************************************   S01310
      *   INTF - Initalise non-constant fields                        *   S01310
      *   Called by - main process                                    *   S01310
      *   Calls     -                                                 *   S01310
      *****************************************************************   S01310
      *                                                                   S01310
     C           INTF      BEGSR                                          S01310
      *                                                                   S01310
     C                     MOVE *BLANKS   TRNO                            S01310
     C                     MOVE *BLANKS   TRNA                            S01310
     C                     MOVE '      '  NWRK                            S01310
     C**********           Z-ADD0         SECN                                         S01310 CSD027
     C                     MOVE *BLANKS   SECN                                                CSD027
     C                     MOVE *BLANKS   NWSN                            S01310
     C**********           Z-ADD0         DECN                                         S01310 CSD027
     C                     MOVE *BLANKS   DECN                                                CSD027
     C                     MOVE *BLANKS   NWDS                            S01310
     C                     MOVE *BLANKS   MGSG                            S01310
     C                     MOVE *BLANKS   MGST                            S01310
     C                     Z-ADD0         MGTM                            S01310
     C                     Z-ADD0         LATM                            S01310
     C                     MOVE *BLANKS   RELD                            S01310
     C                     Z-ADD0         RELT                            S01310
     C                     MOVE *BLANKS   AMTS                            S01310
     C                     MOVE *BLANKS   SVDT                            S01310
     C                     MOVE *BLANKS   CINDV                           164663
      *                                                                   S01310
     C                     MOVE *BLANKS   SNCSID 12                       S01310
     C                     MOVE *BLANKS   STELX  10                       S01310
     C                     MOVE *BLANKS   SSTTX  12                       S01310
     C                     MOVE *BLANKS   SCRNM  20                       S01310
      *                                                                   S01310
      **  Clear multiple occurrence data structure                        S01310
      *                                                                   S01310
     C                     Z-ADD1         Q       20                      S01310
     C           Q         OCUR MULT                                      S01310
      *                                                                   S01310
     C           Q         DOWLE50                                        S01310
     C           MULT      ANDNE*BLANKS                                   S01310
     C                     MOVE *BLANKS   MULT                            S01310
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     END                                            S01310
      *                                                                   138077
      ** Clear multiple occurrence DS for the extension file.             138077
      *                                                                   138077
     C                     Z-ADD1         V       20                      138077
     C           V         OCUR EXTN                                      138077
     C           V         DOWLE20                                        138077
     C           MCSI      ANDNE*BLANKS                                   138077
     C                     Z-ADD*ZEROS    MPSN                            138077
     C                     MOVE *BLANKS   MTG                             138077
     C                     MOVE *BLANKS   MCSI                            138077
     C                     ADD  1         V                               138077
     C           V         OCUR EXTN                                      138077
     C                     ENDDO                                          138077
     C                     Z-ADD0         V                               138077
      *                                                                   S01310
      ** Check if FT MTmsg will use full Reference in Swift Message                        BUG15044A
      ** Reference field :20:                                                              BUG15044A
     C                     CALL 'AOSVALR0'                                                 BUG15044A
     C                     PARM *BLANKS   W0RTCD  7                                        BUG15044A
     C                     PARM SVAL,1    P@OP01 20                                        BUG15044A
     C                     PARM *BLANKS   P@VL01200                                        BUG15044A
     C                     PARM *BLANKS   P@OP02 20                                        BUG15044A
     C                     PARM *BLANKS   P@VL02200                                        BUG15044A
     C                     PARM *BLANKS   P@OP03 20                                        BUG15044A
     C                     PARM *BLANKS   P@VL03200                                        BUG15044A
     C                     PARM *BLANKS   P@OP04 20                                        BUG15044A
     C                     PARM *BLANKS   P@VL04200                                        BUG15044A
     C                     PARM *BLANKS   P@OP05 20                                        BUG15044A
     C                     PARM *BLANKS   P@VL05200                                        BUG15044A
     C                     PARM *BLANKS   P@OP06 20                                        BUG15044A
     C                     PARM *BLANKS   P@VL06200                                        BUG15044A
     C                     PARM *BLANKS   P@OP07 20                                        BUG15044A
     C                     PARM *BLANKS   P@VL07200                                        BUG15044A
     C                     PARM *BLANKS   P@OP08 20                                        BUG15044A
     C                     PARM *BLANKS   P@VL08200                                        BUG15044A
     C                     PARM *BLANKS   P@OP09 20                                        BUG15044A
     C                     PARM *BLANKS   P@VL09200                                        BUG15044A
     C                     PARM *BLANKS   P@OP10 20                                        BUG15044A
     C                     PARM *BLANKS   P@VL10200                                        BUG15044A
      *                                                                                    BUG15044A
      ** If 'Y' Use Full Reference, i.e. FT+PREF as field :20: TRNO                        BUG15044A
     C           P@VL01    IFEQ 'Y'                                                        BUG15044A
     C                     MOVE 'Y'       FULLRF  1                                        BUG15044A
     C                     ELSE                                                            BUG15044A
     C                     MOVE 'N'       FULLRF                                           BUG15044A
     C                     ENDIF                                                           BUG15044A
      *                                                                                    BUG15044A
     C                     ENDSR                                          S01310
     C/EJECT                                                              S01310
     C************************************************************        071383
     C* SR14 SR.                                                          071383
     C* TO UPDATE OTPAY/CQPAC RECORD TO SHOW MESSAGE GENERATED            071383
     C************************************************************        071383
     C*                                                                   071383
     C           SR14      BEGSR                                          071383
     C*                                                                   071383
     C**   UPDATE THE MT202 INDICATOR                                     071383
     C*                                                                   071383
     C           *IN01     IFEQ '1'                                       071383
     C           PREF      CHAINOTPAY                88                   071383
     C*                                                                   071383
     C           *IN88     IFEQ '1'                                       071383
     C                     MOVE 'OTPAY   'DBFNAM              ************071383
     C                     MOVELPREF      DBERKY              * DBERR 13 *071383
     C                     MOVE '13'      DBERR#              ************071383
     C                     EXSR DBERR                                     071383
     C                     END                                            071383
     C*                                                                   071383
     C                     MOVE 'C'       MT202                           071383
     C*                                                                   071383
     C                     EXCPTOTPAYO                                    071383
     C*                                                                   071383
     C* ELSE, IF THE RECORD IS FOR A CHEQUE                               071383
     C*                                                                   071383
     C                     ELSE                                           071383
     C*                                                                   071383
     C           KCQPAC    CHAINCQPAC                88    CHAIN FAIL     071383
     C*                                                                   071383
     C           *IN88     IFEQ '1'                                       071383
     C                     MOVE 'CQPAC   'DBFNAM              ************071383
     C                     MOVELPREF      DBERKY              * DBERR 14 *071383
     C                     MOVE '14'      DBERR#              ************071383
     C                     EXSR DBERR                                     071383
     C                     END                                            071383
     C*                                                                   071383
     C                     MOVE 'C'       MT202                           071383
     C*                                                                   071383
     C                     EXCPTCQPACO                                    071383
     C*                                                                   071383
     C                     END                                            071383
     C                     ENDSR                                          071383
     C*                                                                   071383
     C************************************************************        071383
     C* END OF SR14 SUBROUTINE                                            071383
     C************************************************************        071383
     C/EJECT                                                              071383
     C/COPY WNCPYSRC,FT0645C037
     C********************************************************************
     C********************************************************************
     C********************************************************************
     C*    *     SUBROUTINE TO SET UP DATA STRUCTURE   *     *** DBERR ***
     C*    *                FOR DATABASE ERRORS.       *     *** DBERR ***
     C********************************************************** DBERR ***
     C*    ERROR     CAUSE                                   *** DBERR ***
     C*       01     VALID I.C.R.-1 RECORD NOT FOUND.        *** DBERR ***
     C*       02     VALID I.C.R.-2 RECORD NOT FOUND.        *** DBERR ***
     C*       03     VALID CURRENCY RECORD NOT FOUND.        *** DBERR ***
     C*       04     UNSUCCESSFUL CHAIN TO LF/OTPAY.         *** DBERR ***
     C*       05     UNSUCCESSFUL CHAIN TO LF/CQPAC.         *** DBERR ***
     C*       06     UNSUCCESSFUL CHAIN TO LF/NTRAN.         *** DBERR ***
     C********************************************************** DBERR ***
     C           DBERR     BEGSR                             *** DBERR ***
     C*                                                      *************
     C           *NAMVAR   DEFN LDA       DLDA
     C           *LOCK     IN   DLDA
     C                     MOVEL'FT0645'  DBPGM            ) SET UP
     C*********************MOVE DBFNAM    DBFILE           ) DATA BASE    S01117
     C                     MOVELDBFNAM    DBFILE           ) DATA BASE    S01117
     C                     MOVELDBERKY    DBKEY            ) ERROR
     C                     MOVE *BLANKS   DBASE                           S01310
     C                     MOVE DBERR#    DBASE            ) FIELDS
     C                     OUT  DLDA
     C                     SETON                     78                   S01117
     C                     Z-ADD1         PAGEAU                          S01117
     C                     WRITEHEADAU                                    S01117
     C                     SETON                     U7U8LR
     C                     DUMP
     C                     RETRN
     C*                                                      *************
     C                     ENDSR                             *** DBERR ***
      *****************************************************************                       CSW209
      *                                                               *                       CSW209
      *  SROUFM - Retrieve Outgoing Message Field Management          *                       CSW209
      *                                                               *                       CSW209
      *  Called By: Main                                              *                       CSW209
      *                                                               *                       CSW209
      *  Calls: None                                                  *                       CSW209
      *                                                               *                       CSW209
      *****************************************************************                       CSW209
      *                                                                                       CSW209
     C           SROUFM    BEGSR                                                              CSW209
      *                                                                                       CSW209
     C                     MOVEL@MSGTG    @MS     3                                           CSW209
      *                                                                                       CSW209
     C                     MOVELWCCY      I@CCY   3                                           CSW209
     C                     MOVELWENTTP    I@TYPE  1                                           CSW209
     C                     MOVELWBRCA     I@BRCA  3                                           CSW209
     C                     MOVELWACCT     I@ACCT 35                                           CSW209
     C                     EXSR SRRTAC                                                        CSW209
     C                     MOVELR@IBAN    W@IBAN 34                                           CSW209
     C                     MOVELR@ACNO    W@ACNO 10                                           CSW209
     C                     MOVELR@GLAC    W@GLAC 35                                           CSW209
     C                     MOVELNWRK      @NTWRK    P                                         CSW209
      *                                                                                       CSW209
      ** Message Type                                                                         CSW209
      *                                                                                       CSW209
     C                     MOVE '103'     @MSGTP                                              CSW209
      *                                                                                       CSW209
      ** Country of Location                                                                  CSW209
      *                                                                                       CSW209
     C                     SELEC                                                              CSW209
     C           DSTT      WHEQ 'A'                                                           CSW209
     C                     MOVE *BLANKS   @CNTLC                                              CSW209
     C           DSTT      WHEQ 'S'                                                           CSW209
     C           2         SUBSTDST1:5    @CNTLC                                              CSW209
     C                     OTHER                                                              CSW209
     C                     EXSR SRCNTL                                                        CSW209
     C                     ENDSL                                                              CSW209
      *                                                                                       CSW209
      ** Nostro Number                                                                        CSW209
      *                                                                                       CSW209
     C                     MOVE *BLANKS   @NOSTN                                              CSW209
     C                     MOVEL*BLANKS   @NONB                                               CSW209
     C                     MOVELPCCY      WCCY                                                CSW209
      *                                                                                       CSW209
     C           SNCO      IFNE *BLANKS                                                       CSW209
     C                     MOVELSNCT      WENTT2  1                                           CSW209
     C                     MOVELSNCO      ADDRSS                                              CSW209
     C                     ELSE                                                               CSW209
     C                     MOVELDSTT      WENTT2  1                                           CSW209
     C                     MOVELDST1      ADDRSS                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     SELEC                                                              CSW209
     C           WENTT2    WHEQ 'N'                                                           CSW209
     C                     MOVELADNOSN    @NOSTN                                              CSW209
     C                     MOVELWCCY      @CYCD                                               CSW209
      *                                                                                       CSW209
     C           WENTT2    WHEQ 'F'                                                           CSW209
     C                     MOVELADFNNB    @NOSTN                                              CSW209
     C                     MOVELWCCY      @CYCD                                               CSW209
      *                                                                                       CSW209
     C           WENTT2    WHEQ 'P'                                                           CSW209
     C           BGMBIN    IFEQ 'N'                                                           CSW209
     C                     MOVELBJSBRC    @BRCD                                               CSW209
     C                     ELSE                                                               CSW209
     C                     MOVELADPBRC    @BRCD                                               CSW209
     C                     ENDIF                                                              CSW209
     C                     MOVELADPCNM    @CUST   6                                           CSW209
     C                     MOVELADPACD    @ACCD                                               CSW209
     C                     MOVELADPASQ    @ACSN   2                                           CSW209
     C                     MOVELWCCY      @CYCD   3                                           CSW209
     C                     EXSR SRNOST                                                        CSW209
     C                     MOVELA7NONB    @NOSTN                                              CSW209
      *                                                                                       CSW209
     C           WENTT2    WHEQ 'G'                                                           CSW209
     C           BGMBIN    IFEQ 'N'                                                           CSW209
     C                     MOVELBJSBRC    @BRCD   3                                           CSW209
     C                     ELSE                                                               CSW209
     C                     MOVELADGBRC    @BRCD                                               CSW209
     C                     ENDIF                                                              CSW209
     C                     MOVELADGCNM    @CUST                                               CSW209
     C                     MOVELADGACD    @ACCD                                               CSW209
     C                     MOVELADGASQ    @ACSN                                               CSW209
     C                     MOVELADGCCY    @CYCD                                               CSW209
     C                     EXSR SRNOST                                                        CSW209
     C                     MOVELA7NONB    @NOSTN                                              CSW209
      *                                                                                       CSW209
     C           WENTT2    WHEQ 'R'                                                           CSW209
     C                     MOVELADACNO    ACNO                                                CSW209
     C           ACNO      CHAINACNUMA               90                                       CSW209
     C                     MOVELBRCA      @BRCD                                               CSW209
     C                     MOVELCNUM      @CUST                                               CSW209
     C                     MOVELACOD      @ACCD                                               CSW209
     C                     MOVELACSQ      @ACSN                                               CSW209
     C                     MOVELCCY       @CYCD                                               CSW209
     C                     EXSR SRNOST                                                        CSW209
     C                     MOVELA7NONB    @NOSTN                                              CSW209
      *                                                                                       CSW209
     C                     ENDSL                                                              CSW209
      *                                                                                       CSW209
      ** Action                                                                               CSW209
      *                                                                                       CSW209
     C                     MOVE CACNT1    @ACTNF                                              CSW209
      *                                                                                       CSW209
      ** Call Access program                                                                  CSW209
      *                                                                                       CSW209
     C                     MOVELBRCA      BRCA4A                                              CSW209
     C                     CALL 'AOCTRYR0'                                                    CSW209
     C                     PARM *BLANKS   WRTRN   7                                           CSW209
     C                     PARM '*KEY   ' WOPTN   7                                           CSW209
     C                     PARM @CNTLC    WCTCD   2                                           CSW209
     C           SDCTRY    PARM SDCTRY    DSFDY                                               CSW209
      *                                                                                       CSW209
     C           WRTRN     IFNE *BLANKS                                                       CSW209
     C                     EXSR SRCNTL                                                        CSW209
     C                     MOVEL@CNTLC    CTRY4A                                              CSW209
     C                     ELSE                                                               CSW209
     C                     MOVEL@CNTLC    CTRY4A                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     CALL 'AOOUFMR0'PLOUFM                                              CSW209
     C           @RTRN     IFEQ *BLANKS                                                       CSW209
     C           OMFLAG    IFEQ *BLANKS                                                       CSW209
     C                     MOVE 'O'       @LFLAG                                              CSW209
     C                     ELSE                                                               CSW209
     C                     MOVE OMFLAG    @LFLAG  1                                           CSW209
     C                     ENDIF                                                              CSW209
     C                     ELSE                                                               CSW209
     C                     MOVE 'O'       @LFLAG                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
      ** Action IBAN                                                                          CSW209
      *                                                                                       CSW209
     C                     MOVE CACNT2    @ACTNF                                              CSW209
      *                                                                                       CSW209
      ** Call Access program                                                                  CSW209
      *                                                                                       CSW209
     C                     CALL 'AOOUFMR0'PLOUFM                                              CSW209
     C           @RTRN     IFEQ *BLANKS                                                       CSW209
     C           OMFLAG    IFEQ *BLANKS                                                       CSW209
     C                     MOVE 'O'       @IFLAG                                              CSW209
     C                     ELSE                                                               CSW209
     C                     MOVE OMFLAG    @IFLAG  1                                           CSW209
     C                     ENDIF                                                              CSW209
     C                     ELSE                                                               CSW209
     C                     MOVE 'O'       @IFLAG                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
      ** If no error                                                                          CSW209
      *                                                                                       CSW209
     C                     MOVELWACCT     @SLS    1                                           CSW209
     C           @LFLAG    IFEQ 'O'                                                           CSW209
     C           @MS       IFEQ ':50'                                                         CSW209
     C           ODMTT     IFEQ 'G'                                                           CSW209
     C           ODMTT     OREQ 'P'                                                           CSW209
     C           ODMTT     OREQ 'I'                                                           CSW209
     C           ODMTT     OREQ 'F'                                                           CSW209
     C           ODMTT     OREQ 'N'                                                           CSW209
     C           ODMTT     OREQ 'R'                                                           CSW209
     C           @SLS      OREQ '/'                                                           CSW209
     C                     MOVEL'M'       @LFLAG                                              CSW209
     C                     ENDIF                                                              CSW209
     C                     ELSE                                                               CSW209
     C           @MS       IFEQ ':59'                                                         CSW209
     C           @SLS      ANDEQ'/'                                                           CSW209
     C                     MOVEL'M'       @LFLAG                                              CSW209
     C                     ENDIF                                                              CSW209
     C                     ENDIF                                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C           @IFLAG    IFEQ 'P'                                                           CSW209
     C                     MOVEL*BLANKS   W@IBAN                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C           @IFLAG    IFEQ 'M'                                                           CSW209
     C                     MOVEL'M'       @LFLAG                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C           @LFLAG    IFEQ 'M'                                                           CSW209
     C           @LFLAG    OREQ 'W'                                                           CSW209
      *                                                                                       CSW209
     C                     SELEC                                                              CSW209
     C           W@IBAN    WHNE *BLANKS                                                       CSW209
     C           '/'       CAT  W@IBAN    ##ACLN                                              CSW209
      *                                                                                       CSW209
     C           W@ACNO    WHNE *BLANKS                                                       CSW209
     C           '/'       CAT  W@ACNO    ##ACLN                                              CSW209
      *                                                                                       CSW209
     C           W@GLAC    WHNE *BLANKS                                                       CSW209
     C           '/'       CAT  W@GLAC    ##ACLN                                              CSW209
      *                                                                                       CSW209
     C           @SLS      WHEQ '/'                                                           CSW209
     C                     MOVELWACCT     ##ACLN                                              CSW209
      *                                                                                       CSW209
     C           WENTTP    WHEQ 'C'                                                           CSW209
     C           @IFLAG    ANDNE'M'                                                           CSW209
      *                                                                                       CSW209
     C           @MSGTG    IFEQ ':50A:'                                                       CSW209
     C           @CUST     ANDEQ*BLANK                                                        CSW209
     C                     MOVELWACCT     @CUST                                               CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C           '/'       CAT  @CUST     ##ACLN                                              CSW209
      *                                                                                       CSW209
      * If at this stage nothing has been formatted, that means that a full address has       CSW209
      * been entered without '/' in the first line, if the account line is manadatory         CSW209
      * the account will be retrieved from the Ordering bank but keeping the customer         CSW209
      * address                                                                               CSW209
     C           @LFLAG    WHEQ 'M'                                                           CSW209
      *                                                                                       CSW209
     C           @MS       IFEQ ':50'                                                         CSW209
     C                     MOVELSMCY      I@CCY   3                                           CSW209
     C                     MOVELORBT      I@TYPE  1                                           CSW209
     C                     MOVELORBB      I@BRCA  3                                           CSW209
     C                     MOVELORBK      I@ACCT 35                                           CSW209
     C                     ENDIF                                                              CSW209
     C                     EXSR SRRTAC                                                        CSW209
      *                                                                                       CSW209
     C                     ENDSL                                                              CSW209
      *                                                                                       CSW209
     C                     SELEC                                                              CSW209
     C           R@IBAN    WHNE *BLANKS                                                       CSW209
     C           '/'       CAT  R@IBAN    ##ACLN                                              CSW209
      *                                                                                       CSW209
     C           R@ACNO    WHNE *BLANKS                                                       CSW209
     C           '/'       CAT  R@ACNO    ##ACLN                                              CSW209
      *                                                                                       CSW209
     C           R@GLAC    WHNE *BLANKS                                                       CSW209
     C           '/'       CAT  R@GLAC    ##ACLN                                              CSW209
      *                                                                                       CSW209
     C                     ENDSL                                                              CSW209
     C                     ENDIF                                                              CSW209
     C                     SELEC                                                              CSW209
      *                                                                                       CSW209
     C           ##ACLN    WHNE *BLANKS                                                       CSW209
     C           @SLS      ANDEQ'/'                                                           CSW209
     C           WENTTP    ANDEQ'S'                                                           CSW209
      *                                                                                       CSW209
     C           ##ACLN    ORNE *BLANKS                                                       CSW209
     C           @SLS      ANDEQ'/'                                                           CSW209
     C           WENTTP    ANDEQ'A'                                                           CSW209
     C                     MOVEL##ACLN    W@CNA1                                              CSW209
     C                     MOVELW@CNA2    W@CNA2                                              CSW209
     C                     MOVELW@CNA3    W@CNA3                                              CSW209
     C                     MOVELW@CNA4    W@CNA4                                              CSW209
     C                     MOVELW@CNA5    W@CNA5                                              CSW209
      *                                                                                       CSW209
     C           ##ACLN    WHEQ *BLANKS                                                       CSW209
     C           @SLS      ANDEQ'/'                                                           CSW209
     C                     MOVEL*BLANKS   W@CNA5                                              CSW209
     C                     MOVELW@CNA5    W@CNA4                                              CSW209
     C                     MOVELW@CNA4    W@CNA3                                              CSW209
     C                     MOVELW@CNA3    W@CNA2                                              CSW209
     C                     MOVELW@CNA2    W@CNA1                                              CSW209
      *                                                                                       CSW209
     C           ##ACLN    WHNE *BLANKS                                                       CSW209
     C           ##ACLN    ANDNEW@CNA1                                                        CSW209
     C                     MOVELW@CNA4    W@CNA5                                              CSW209
     C                     MOVELW@CNA3    W@CNA4                                              CSW209
     C                     MOVELW@CNA2    W@CNA3                                              CSW209
     C                     MOVELW@CNA1    W@CNA2                                              CSW209
     C                     MOVEL##ACLN    W@CNA1                                              CSW209
      *                                                                                       CSW209
     C           ##ACLN    WHEQ *BLANKS                                                       CSW209
     C           @SLS      ANDNE'/'                                                           CSW209
     C                     MOVEL*BLANKS   W@CNA5                                              CSW209
     C                     MOVELW@CNA4    W@CNA4                                              CSW209
     C                     MOVELW@CNA3    W@CNA3                                              CSW209
     C                     MOVELW@CNA2    W@CNA2                                              CSW209
     C                     MOVELW@CNA1    W@CNA1                                              CSW209
      *                                                                                       CSW209
     C                     ENDSL                                                              CSW209
      *                                                                                       CSW209
     C                     ENDSR                                                              CSW209
      *                                                                                       CSW209
      /EJECT                                                                                  CSW209
      *****************************************************************                       CSW209
      *                                                               *                       CSW209
      *  SRACCT   - Check for Account                                 *                       CSW209
      *                                                               *                       CSW209
      *  Called By: SRRTAC Subroutine                                 *                       CSW209
      *                                                               *                       CSW209
      *  Calls: None                                                  *                       CSW209
      *                                                               *                       CSW209
      *****************************************************************                       CSW209
      *                                                                                       CSW209
     C           SRACCT    BEGSR                                                              CSW209
      *                                                                                       CSW209
     C                     CALL 'AOACCTR0'             9090                                   CSW209
     C                     PARM *BLANKS   @RTCD                                               CSW209
     C                     PARM '*KEY   ' @OPTN                                               CSW209
     C                     PARM           @ACNO  10                                           CSW209
     C                     PARM           @CUST                                               CSW209
     C                     PARM           @CYCD                                               CSW209
     C                     PARM           @ACCD                                               CSW209
     C                     PARM           @ACSN                                               CSW209
     C                     PARM           @BRCD                                               CSW209
     C           OACCNT    PARM *BLANKS   DSSDY                                               CSW209
      *                                                                                       CSW209
      ** If error on call                                                                     CSW209
      *                                                                                       CSW209
     C           *IN90     IFEQ *ON                                                           CSW209
     C                     MOVEL'AOACCTR0'DBFNAM                                              CSW209
     C                     MOVEL'*CALL'   DBERKY                                              CSW209
     C                     MOVEL'700'     DBERR#                                              CSW209
     C                     EXSR DBERR                                                         CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     ENDSR                                                              CSW209
     C/EJECT                                                                                  CSW209
      *****************************************************************                       CSW209
      *                                                               *                       CSW209
      *  SRCUST   - Check for Customer                                *                       CSW209
      *                                                               *                       CSW209
      *  Called By: SRCNTL, SRRTAC                                    *                       CSW209
      *                                                               *                       CSW209
      *  Calls: None                                                  *                       CSW209
      *                                                               *                       CSW209
      *****************************************************************                       CSW209
      *                                                                                       CSW209
     C           SRCUST    BEGSR                                                              CSW209
      *                                                                                       CSW209
     C                     CALL 'AOCUSTR1'             9090                                   CSW209
     C                     PARM *BLANKS   @RTCD                                               CSW209
     C                     PARM '*KEY   ' @OPTN                                               CSW209
     C                     PARM           @KEY1                                               CSW209
     C                     PARM *BLANKS   @KYST                                               CSW209
     C           SDCUST    PARM *BLANKS   DSLDY                                               CSW209
      *                                                                                       CSW209
      ** If error on call                                                                     CSW209
      *                                                                                       CSW209
     C           *IN90     IFEQ *ON                                                           CSW209
     C                     MOVEL'AOCUSTR1'DBFNAM                                              CSW209
     C                     MOVEL'*CALL'   DBERKY                                              CSW209
     C                     MOVE '9'       DBERR#                                              CSW209
     C                     EXSR DBERR                                                         CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     ENDSR                                                              CSW209
      *****************************************************************                       CSW209
      *                                                               *                       CSW209
      *  SRCNTL   - Retrieve Country of location                      *                       CSW209
      *                                                               *                       CSW209
      *  Called By: SRFRMT, SROUFM                                    *                       CSW209
      *                                                               *                       CSW209
      *  Calls: None                                                  *                       CSW209
      *                                                               *                       CSW209
      *****************************************************************                       CSW209
      *                                                                                       CSW209
     C           SRCNTL    BEGSR                                                              CSW209
      *                                                                                       CSW209
     C                     MOVE *BLANKS   @CNTLC  2                                           CSW209
      *                                                                                       CSW209
     C                     CALL 'AOACCTV1'                                                    CSW209
     C                     PARM *BLANKS   @RTCD                                               CSW209
     C                     PARM *BLANKS   @TYP    7                                           CSW209
     C                     PARM           DST1   35                                           CSW209
     C                     PARM           DSSDY                                               CSW209
      *                                                                                       CSW209
     C                     MOVE *BLANKS   PACCTP                                              CSW209
     C                     SELEC                                                              CSW209
     C           @TYP      WHEQ '*RETAIL'                                                     CSW209
     C           @TYP      OREQ '*LEDGER'                                                     CSW209
     C                     MOVELDSSDY     OACCNT                                              CSW209
     C                     MOVELCNUM      WCUST   6                                           CSW209
     C           @TYP      WHEQ '*NOSTRO'                                                     CSW209
     C                     MOVELDSSDY     SDNOST                                              CSW209
     C                     MOVELA7CUST    WCUST                                               CSW209
     C           @TYP      WHEQ '*CUSTNO'                                                     CSW209
     C           @TYP      OREQ '*SHNAME'                                                     CSW209
     C                     MOVELDSSDY     SDCUST                                              CSW209
     C                     MOVELBBCUST    WCUST                                               CSW209
     C                     ENDSL                                                              CSW209
      *                                                                                       CSW209
     C                     MOVELWCUST     @KEY1     P                                         CSW209
     C                     EXSR SRCUST                                                        CSW209
      *                                                                                       CSW209
     C           @RTCD     IFEQ *BLANKS                                                       CSW209
     C                     MOVELBBCOLC    @CNTLC                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     ENDSR                                                              CSW209
     C/EJECT                                                                                  CSW209
      *****************************************************************                       CSW209
      *                                                               *                       CSW209
      *  SRNOST   - Check for full Nostro                             *                       CSW209
      *                                                               *                       CSW209
      *  Called By: SRRTAC, SRFRMT, SROUFM                            *                       CSW209
      *                                                               *                       CSW209
      *  Calls: None                                                  *                       CSW209
      *                                                               *                       CSW209
      *****************************************************************                       CSW209
      *                                                                                       CSW209
     C           SRNOST    BEGSR                                                              CSW209
      *                                                                                       CSW209
     C                     CALL 'AONOSTR0'             9090                                   CSW209
     C                     PARM *BLANKS   @RTCD                                               CSW209
     C                     PARM '*KEY   ' @OPTN                                               CSW209
     C                     PARM           @CUST                                               CSW209
     C                     PARM           @CYCD   3                                           CSW209
     C                     PARM           @ACCD                                               CSW209
     C                     PARM           @ACSN                                               CSW209
     C                     PARM           @NONB   2                                           CSW209
     C                     PARM           @BRCD                                               CSW209
     C                     PARM           @CSSN  10                                           CSW209
     C                     PARM           @PNOI   1                                           CSW209
     C           SDNOST    PARM *BLANKS   DSFDY                                               CSW209
      *                                                                                       CSW209
      ** If error on call                                                                     CSW209
      *                                                                                       CSW209
     C           *IN90     IFEQ *ON                                                           CSW209
     C                     MOVEL'AONOSTR0'DBFNAM                                              CSW209
     C                     MOVEL'*CALL'   DBERKY                                              CSW209
     C                     MOVE '7'       DBERR#                                              CSW209
     C                     EXSR DBERR                                                         CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     ENDSR                                                              CSW209
     C/EJECT                                                                                  CSW209
      *****************************************************************                       CSW209
      *                                                               *                       CSW209
      *  SRRTAC   - Retrieve Account and nostro information           *                       CSW209
      *                                                               *                       CSW209
      *  Called By: SRFRMT, SROUFM                                    *                       CSW209
      *                                                               *                       CSW209
      *  Calls: None                                                  *                       CSW209
      *                                                               *                       CSW209
      *****************************************************************                       CSW209
      *                                                                                       CSW209
     C           SRRTAC    BEGSR                                                              CSW209
      *                                                                                       CSW209
     C           *LIKE     DEFN BRCA      R@BRCA                                              CSW209
     C           *LIKE     DEFN BBCUST    R@CUST                                              CSW209
     C           *LIKE     DEFN CCY       R@CCY                                               CSW209
     C                     MOVELR@ACOD    R@ACOD  4                                           CSW209
      ** to be 10 in Midas Plus                                                               CSW209
     C           *LIKE     DEFN ACOD      @ACCD                                               CSW209
     C                     MOVELR@ACSQ    R@ACSQ  2                                           CSW209
     C                     MOVELR@ACNO    R@ACNO 10                                           CSW209
     C           *LIKE     DEFN IBAN      R@IBAN                                              CSW209
     C           *LIKE     DEFN A7NONB    R@NONB                                              CSW209
     C           *LIKE     DEFN BBCBEI    R@BEID                                              CSW209
     C           *LIKE     DEFN BBCSID    R@CSID                                              CSW209
      *                                                                                       CSW209
     C                     RESETOACCNT                                                        CSW209
     C                     RESETSDNOST                                                        CSW209
     C                     RESETSDCUST                                                        CSW209
      *                                                                                       CSW209
     C                     MOVE *BLANKS   R@BRCA                                              CSW209
     C                     MOVE *BLANKS   R@CUST                                              CSW209
     C                     MOVE *BLANKS   R@CCY                                               CSW209
     C                     MOVE *BLANKS   R@ACOD                                              CSW209
     C                     MOVE *BLANKS   R@ACSQ                                              CSW209
     C                     MOVE *BLANKS   R@ACNO                                              CSW209
     C                     MOVE *BLANKS   R@IBAN                                              CSW209
     C                     MOVE *BLANKS   R@GLAC 34                                           CSW209
     C                     MOVE *BLANKS   R@NONB                                              CSW209
     C                     MOVEL*BLANKS   @CNTLC  2                                           CSW209
     C                     MOVEL*BLANKS   R@CSID                                              CSW209
     C                     MOVEL*BLANKS   R@BEID                                              CSW209
      *                                                                                       CSW209
     C                     MOVELI@CCY     I@CCY   3                                           CSW209
     C                     MOVELI@TYPE    I@TYPE  1                                           CSW209
     C                     MOVELI@BRCA    I@BRCA  3                                           CSW209
     C                     MOVELI@ACCT    I@ACCT 35                                           CSW209
     C                     MOVELI@ACCT    ADDRSS                                              CSW209
     C                     MOVELI@ACCT    I@SLS   1                                           CSW209
      *                                                                                       CSW209
     C           I@SLS     IFEQ '/'                                                           CSW209
     C           34        SUBSTI@ACCT:2  ADDRSS    P                                         CSW209
     C                     ELSE                                                               CSW209
     C                     MOVELI@ACCT    ADDRSS                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C           ADPBRC    IFEQ *BLANKS                                                       CSW209
     C                     MOVELI@BRCA    ADPBRC                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     SELEC                                                              CSW209
     C           I@TYPE    WHEQ 'N'                                                           CSW209
     C                     MOVELADNOSN    @NONB                                               CSW209
     C                     MOVELI@CCY     @CYCD                                               CSW209
     C                     EXSR SRNOST                                                        CSW209
     C                     MOVELA7BRCD    @BRCD                                               CSW209
     C                     MOVELA7CUST    @CUST                                               CSW209
     C                     MOVELA7ACCD    @ACCD                                               CSW209
     C                     MOVELA7ACSN    @ACSN                                               CSW209
     C                     MOVELA7CYCD    @CYCD                                               CSW209
     C                     MOVEL*BLANKS   @ACNO                                               CSW209
     C                     EXSR SRACCT                                                        CSW209
      *                                                                                       CSW209
     C           I@TYPE    WHEQ 'F'                                                           CSW209
     C                     MOVELADFNNB    @NONB                                               CSW209
     C                     MOVELADFCCY    @CYCD                                               CSW209
     C                     EXSR SRNOST                                                        CSW209
     C                     MOVELA7BRCD    @BRCD                                               CSW209
     C                     MOVELA7CUST    @CUST                                               CSW209
     C                     MOVELA7ACCD    @ACCD                                               CSW209
     C                     MOVELA7ACSN    @ACSN                                               CSW209
     C                     MOVELA7CYCD    @CYCD                                               CSW209
     C                     MOVEL*BLANKS   @ACNO                                               CSW209
     C                     EXSR SRACCT                                                        CSW209
      *                                                                                       CSW209
     C           I@TYPE    WHEQ 'P'                                                           CSW209
     C           BGMBIN    IFEQ 'N'                                                           CSW209
     C                     MOVELBJSBRC    @BRCD                                               CSW209
     C                     ELSE                                                               CSW209
     C                     MOVELADPBRC    @BRCD                                               CSW209
     C                     ENDIF                                                              CSW209
     C                     MOVELADPCNM    @CUST   6                                           CSW209
     C                     MOVELADPACD    @ACCD                                               CSW209
     C                     MOVELADPASQ    @ACSN   2                                           CSW209
     C                     MOVELI@CCY     @CYCD   3                                           CSW209
     C                     EXSR SRNOST                                                        CSW209
     C                     MOVEL*BLANKS   @ACNO                                               CSW209
     C                     EXSR SRACCT                                                        CSW209
      *                                                                                       CSW209
     C           I@TYPE    WHEQ 'G'                                                           CSW209
     C           BGMBIN    IFEQ 'N'                                                           CSW209
     C                     MOVELBJSBRC    @BRCD   3                                           CSW209
     C                     ELSE                                                               CSW209
     C                     MOVELADGBRC    @BRCD                                               CSW209
     C                     ENDIF                                                              CSW209
     C                     MOVELADGCNM    @CUST                                               CSW209
     C                     MOVELADGACD    @ACCD                                               CSW209
     C                     MOVELADGASQ    @ACSN                                               CSW209
     C                     MOVELADGCCY    @CYCD                                               CSW209
     C                     EXSR SRNOST                                                        CSW209
     C                     MOVEL*BLANKS   @ACNO                                               CSW209
     C                     EXSR SRACCT                                                        CSW209
      *                                                                                       CSW209
     C           I@TYPE    WHEQ 'R'                                                           CSW209
     C                     MOVELADACNO    ACNO                                                CSW209
     C           ACNO      CHAINACNUMA               90                                       CSW209
     C                     MOVELBRCA      @BRCD                                               CSW209
     C                     MOVELCNUM      @CUST                                               CSW209
     C                     MOVELACOD      @ACCD                                               CSW209
     C                     MOVELACSQ      @ACSN                                               CSW209
     C                     MOVELCCY       @CYCD                                               CSW209
     C                     EXSR SRNOST                                                        CSW209
      *                                                                                       CSW209
     C           I@TYPE    WHEQ 'I'                                                           CSW209
     C                     MOVELADCHK1    PIBAN                                               CSW209
     C                     CALL 'AOIBANR3'                                                    CSW209
     C                     PARM *BLANKS   @RTCD                                               CSW209
     C                     PARM           PIBAN  47                                           CSW209
     C                     PARM           POWITH 47                                           CSW209
     C           P@IBAN    PARM           PONOBL 34                                           CSW209
     C           @RTCD     IFEQ *BLANKS                                                       CSW209
     C                     CALL 'AOIBANR4'                                                    CSW209
     C                     PARM *BLANKS   @RTCD                                               CSW209
     C                     PARM           @OPTN   7                                           CSW209
     C                     PARM           P@IBAN 34                                           CSW209
     C           OACCNT    PARM *BLANKS   DSSDY                                               CSW209
      *                                                                                       CSW209
     C           @RTCD     IFEQ *BLANKS                                                       CSW209
     C                     MOVELBRCA      @BRCD                                               CSW209
     C                     MOVELCNUM      @CUST                                               CSW209
     C                     MOVELACOD      @ACCD                                               CSW209
     C                     MOVELACSQ      @ACSN                                               CSW209
     C                     MOVELCCY       @CYCD                                               CSW209
     C                     EXSR SRNOST                                                        CSW209
     C                     ENDIF                                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C           I@TYPE    WHEQ 'C'                                                           CSW209
     C                     MOVELADCNUM    CNUM                                                CSW209
     C           I@TYPE    WHEQ 'S'                                                           CSW209
     C                     MOVELADSWFT    R@CSID                                              CSW209
     C                     MOVELADSWFT    R@BEID                                              CSW209
     C                     ENDSL                                                              CSW209
      *                                                                                       CSW209
     C           CFT004    IFEQ 'Y'                                                           CSW209
     C                     MOVELIBAN      R@IBAN                                              CSW209
     C                     ELSE                                                               CSW209
     C                     MOVEL*BLANKS   R@IBAN                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C           BGRTBN    IFEQ 'Y'                                                           CSW209
     C           ACNO      ANDNE0                                                             CSW209
     C                     MOVELACNO      R@ACNO                                              CSW209
     C                     ELSE                                                               CSW209
     C                     MOVEL*BLANKS   R@ACNO                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     MOVELBRCA      R@BRCA                                              CSW209
     C                     MOVELCNUM      R@CUST                                              CSW209
     C                     MOVELCCY       R@CCY                                               CSW209
     C                     MOVELACOD      R@ACOD                                              CSW209
     C                     MOVELACSQ      R@ACSQ                                              CSW209
     C                     MOVELA7NONB    R@NONB                                              CSW209
      *                                                                                       CSW209
     C           I@TYPE    IFEQ 'G'                                                           CSW209
     C           I@TYPE    OREQ 'R'                                                           CSW209
     C           I@TYPE    OREQ 'I'                                                           CSW209
     C           I@TYPE    OREQ 'F'                                                           CSW209
     C           I@TYPE    OREQ 'N'                                                           CSW209
     C           I@TYPE    OREQ 'P'                                                           CSW209
     C           R@BRCA    CAT  R@CUST:0  R@GLAC 34                                           CSW209
     C                     CAT  R@CCY:0   R@GLAC                                              CSW209
     C                     CAT  R@ACOD:0  R@GLAC                                              CSW209
     C                     CAT  R@ACSQ:0  R@GLAC                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C           R@CUST    IFNE *BLANKS                                                       CSW209
     C           R@CUST    ANDNE'000000'                                                      CSW209
      *                                                                                       CSW209
     C                     MOVELR@CUST    @KEY1     P                                         CSW209
      *                                                                                       CSW209
     C                     EXSR SRCUST                                                        CSW209
      *                                                                                       CSW209
     C           @RTCD     IFEQ *BLANKS                                                       CSW209
     C                     MOVELBBCOLC    @CNTLC                                              CSW209
     C                     MOVELBBCSID    R@CSID                                              CSW209
     C                     MOVELBBCBEI    R@BEID                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     ENDSR                                                              CSW209
      *****************************************************************                       CSW209
      *                                                               *                       CSW209
      *  SR205  - Determine MT205 Flag                                *                       CSW209
      *                                                               *                       CSW209
      *  Called By: WREF, SR10                                        *                       CSW209
      *                                                               *                       CSW209
      *  Calls: None                                                  *                       CSW209
      *                                                               *                       CSW209
      *****************************************************************                       CSW209
     C           SR205     BEGSR                                                              CSW209
      *                                                                                       CSW209
     C                     MOVE '202'     M1MTPY                                              CSW209
      *                                                                                       CSW209
     C           CSW209    IFEQ 'Y'                                                           CSW209
      *                                                                                       CSW209
      ** Determine if Sender and Receiver are of different Country                            CSW209
      *                                                                                       CSW209
     C           2         SUBSTMXOTID:5  SNDR    2                                           CSW209
     C           2         SUBSTRECADD:5  RCVR    2                                           CSW209
     C           SNDR      IFEQ RCVR                                                          CSW209
      *                                                                                       CSW209
      ** Determine if sender/destination country code exists in ISO                           CSW209
      ** country code file.  If found, check if 'Support MT205' flag                          CSW209
      ** is 'Y'                                                                               CSW209
      *                                                                                       CSW209
     C           SNDR      CHAINMEISOCL1             52                                       CSW209
      *                                                                                       CSW209
     C           *IN52     IFEQ *OFF                                                          CSW209
     C           M3M205    ANDEQ'Y'                                                           CSW209
     C           RLPR      ANDNE*BLANKS                                                       CSW209
     C           SNCO      ANDEQ*BLANKS                                                       CSW209
     C                     MOVE '205'     M1MTPY                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     ENDIF                                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     ENDSR                                                              CSW209
      *****************************************************************                       CSW209
      /EJECT                                                                                  CSW209
      *****************************************************************                       CSW209
      *                                                               *                       CSW209
      *  SRFRMT - Retrieve Outgoing Message :50F: format              *                       CSW209
      *                                                               *                       CSW209
      *  Called By: MAIN                                              *                       CSW209
      *                                                               *                       CSW209
      *  Calls: None                                                  *                       CSW209
      *                                                               *                       CSW209
      *****************************************************************                       CSW209
     C           SRFRMT    BEGSR                                                              CSW209
      *                                                                                       CSW209
     C           ODMT      IFNE *BLANKS                                                       CSW209
     C                     MOVELODMTT     WENTTP                                              CSW209
     C                     MOVELODMT      WACCT                                               CSW209
     C                     ELSE                                                               CSW209
     C                     MOVELOPCOCT    WENTTP                                              CSW209
     C                     MOVELOPCOC1    WACCT                                               CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
      *** Country of Location                                                                 CSW209
      *                                                                                       CSW209
     C                     SELEC                                                              CSW209
     C           DSTT      WHEQ 'A'                                                           CSW209
     C                     MOVE *BLANKS   @CNTLC                                              CSW209
     C           DSTT      WHEQ 'S'                                                           CSW209
     C           2         SUBSTDST1:5    @CNTLC                                              CSW209
     C                     OTHER                                                              CSW209
     C                     EXSR SRCNTL                                                        CSW209
     C                     ENDSL                                                              CSW209
     C                     MOVE @CNTLC    WLOCN   2                                           CSW209
      *                                                                                       CSW209
      *** Nostro Number                                                                       CSW209
      *                                                                                       CSW209
     C                     MOVE *BLANKS   @NOSTN                                              CSW209
     C                     MOVE *BLANKS   @NONB                                               CSW209
     C                     MOVELPCCY      WCCY                                                CSW209
      *                                                                                       CSW209
     C           SNCO      IFNE *BLANKS                                                       CSW209
     C                     MOVELSNCT      WENTT2  1                                           CSW209
     C                     MOVELSNCO      ADDRSS                                              CSW209
     C                     ELSE                                                               CSW209
     C                     MOVELDSTT      WENTT2  1                                           CSW209
     C                     MOVELDST1      ADDRSS                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     SELEC                                                              CSW209
     C           WENTT2    WHEQ 'N'                                                           CSW209
     C                     MOVELADNOSN    @NOSTN                                              CSW209
     C                     MOVELWCCY      @CYCD                                               CSW209
      *                                                                                       CSW209
     C           WENTT2    WHEQ 'F'                                                           CSW209
     C                     MOVELADFNNB    @NOSTN                                              CSW209
     C                     MOVELWCCY      @CYCD                                               CSW209
      *                                                                                       CSW209
     C           WENTT2    WHEQ 'P'                                                           CSW209
     C           BGMBIN    IFEQ 'N'                                                           CSW209
     C                     MOVELBJSBRC    @BRCD                                               CSW209
     C                     ELSE                                                               CSW209
     C                     MOVELADPBRC    @BRCD                                               CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     MOVELADPCNM    @CUST                                               CSW209
     C                     MOVELADPACD    @ACCD                                               CSW209
     C                     MOVELADPASQ    @ACSN                                               CSW209
     C                     MOVELWCCY      @CYCD                                               CSW209
     C                     EXSR SRNOST                                                        CSW209
     C                     MOVELA7NONB    @NOSTN                                              CSW209
      *                                                                                       CSW209
     C           WENTT2    WHEQ 'G'                                                           CSW209
     C           BGMBIN    IFEQ 'N'                                                           CSW209
     C                     MOVELBJSBRC    @BRCD                                               CSW209
     C                     ELSE                                                               CSW209
     C                     MOVELADGBRC    @BRCD                                               CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     MOVELADGCNM    @CUST                                               CSW209
     C                     MOVELADGACD    @ACCD                                               CSW209
     C                     MOVELADGASQ    @ACSN                                               CSW209
     C                     MOVELADGCCY    @CYCD                                               CSW209
     C                     EXSR SRNOST                                                        CSW209
     C                     MOVELA7NONB    @NOSTN                                              CSW209
      *                                                                                       CSW209
     C           WENTT2    WHEQ 'R'                                                           CSW209
     C                     MOVELADACNO    ACNO                                                CSW209
     C           ACNO      CHAINACNUMA               62                                       CSW209
     C                     MOVELBRCA      @BRCD                                               CSW209
     C                     MOVELCNUM      @CUST                                               CSW209
     C                     MOVELACOD      @ACCD                                               CSW209
     C                     MOVELACSQ      @ACSN                                               CSW209
     C                     MOVELCCY       @CYCD                                               CSW209
     C                     EXSR SRNOST                                                        CSW209
     C                     MOVELA7NONB    @NOSTN                                              CSW209
      *                                                                                       CSW209
      *                                                                                       CSW209
     C                     ENDSL                                                              CSW209
      *                                                                                       CSW209
      * CHECK IF NON-ACCOUNT HOLDER                                                           CSW209
      *                                                                                       CSW209
     C                     MOVELSMCY      I@CCY   3                                           CSW209
     C                     MOVELWENTTP    I@TYPE  1                                           CSW209
     C                     MOVELBRCAA     I@BRCA  3                                           CSW209
     C                     MOVELWACCT     I@ACCT 35                                           CSW209
      *                                                                                       CSW209
     C           WENTTP    IFNE 'O'                                                           CSW209
     C                     EXSR SRRTAC                                                        CSW209
     C                     MOVELR@IBAN    W@IBAN 34                                           CSW209
     C                     MOVELR@ACNO    W@ACNO 10                                           CSW209
     C                     MOVELR@GLAC    W@GLAC 35                                           CSW209
     C                     MOVELR@GLAC    PACCD                                               CSW209
     C                     MOVELR@CUST    @CUST                                               CSW209
     C                     ELSE                                                               CSW209
      * SET IN SR01                                                                           CSW209
     C                     MOVELPNAHO     PNAHO                                               CSW209
     C                     MOVEL*BLANKS   W@IBAN                                              CSW209
     C                     MOVEL*BLANKS   W@ACNO                                              CSW209
     C                     MOVEL*BLANKS   W@GLAC                                              CSW209
     C                     MOVEL*BLANKS   PACCD                                               CSW209
     C                     MOVEL*BLANKS   @CUST                                               CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     MOVELWENTTP    PACCTP                                              CSW209
      *                                                                                       CSW209
     C           ODMT      IFEQ *BLANKS                                                       CSW209
     C                     MOVELOPCOC1    P@IN1                                               CSW209
     C                     MOVELOPCOC2    P@IN2                                               CSW209
     C                     MOVELOPCOC3    P@IN3                                               CSW209
     C                     MOVELOPCOC4    P@IN4                                               CSW209
     C                     MOVELOPCOC5    P@IN5                                               CSW209
     C                     ELSE                                                               CSW209
     C                     MOVELODMT      P@IN1                                               CSW209
     C                     MOVEL*BLANKS   P@IN2                                               CSW209
     C                     MOVEL*BLANKS   P@IN3                                               CSW209
     C                     MOVEL*BLANKS   P@IN4                                               CSW209
     C                     MOVEL*BLANKS   P@IN5                                               CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     CALL 'FT001000'                                                    CSW209
     C                     PARM *BLANKS   PRTRN   7                                           CSW209
     C                     PARM *BLANKS   PMSID   7                                           CSW209
     C                     PARM *BLANK    PERTP   1                                           CSW209
     C                     PARM 'FRMT'    PVTYP   4                                           CSW209
     C                     PARM           P@IN1  35                                           CSW209
     C                     PARM           P@IN2  35                                           CSW209
     C                     PARM           P@IN3  35                                           CSW209
     C                     PARM           P@IN4  35                                           CSW209
     C                     PARM           P@IN5  35                                           CSW209
     C                     PARM           PACCTP  1                                           CSW209
     C                     PARM           PACCD  34                                           CSW209
     C                     PARM           @CUST   6                                           CSW209
     C                     PARM           PNAHO  10                                           CSW209
     C                     PARM NWRK      PNTWRK  6                                           CSW209
     C                     PARM '103'     PMSGTP  3                                           CSW209
     C                     PARM ':50F:'   PMSTAG  5                                           CSW209
     C                     PARM WLOCN     @CNTLC  2                                           CSW209
     C                     PARM           BRCAA                                               CSW209
     C                     PARM           PCCY                                                CSW209
     C                     PARM           @NOSTN  2                                           CSW209
     C                     PARM 'FT'      PMODI   2                                           CSW209
     C                     PARM           PMSGL1 35                                           CSW209
     C                     PARM           PMSGL2 35                                           CSW209
     C                     PARM           PMSGL3 35                                           CSW209
     C                     PARM           PMSGL4 35                                           CSW209
     C                     PARM           PMSGL5 35                                           CSW209
      *                                                                                       CSW209
     C                     ENDSR                                                              CSW209
      *****************************************************************                       CSW209
      *                                                               *                       CSW209
      *  SRFAMT - Format amount to SWIFT amount format                *                       CSW209
      *                                                               *                       CSW209
      *  Called by: Main                                              *                       CSW209
      *                                                               *                       CSW209
      *  Calls    : AOCURRR0, ZM0040, DBERR                           *                       CSW209
      *                                                               *                       CSW209
      *****************************************************************                       CSW209
     C           SRFAMT    BEGSR                                                              CSW209
      *                                                                                       CSW209
      ** Define input/ouput parameters.                                                       CSW209
      *                                                                                       CSW209
     C                     MOVE WICCY     WICCY   3                                           CSW209
     C                     Z-ADDWIAMNT    WIAMNT 130                                          CSW209
     C                     MOVE *BLANKS   WOCCYS  3                                           CSW209
     C                     Z-ADD0         WODECS  10                                          CSW209
     C                     MOVE *BLANKS   WOAMNT 15                                           CSW209
      *                                                                                       CSW209
      ** Define other work field.                                                             CSW209
      *                                                                                       CSW209
     C                     MOVE WIAMNT    WAMTA  13                                           CSW209
      *                                                                                       CSW209
      ** Access Currency details.                                                             CSW209
      *                                                                                       CSW209
     C                     CALL 'AOCURRR0'                                                    CSW209
     C                     PARM *BLANKS   PRTCD                                               CSW209
     C                     PARM '*KEY   ' POPTN                                               CSW209
     C                     PARM WICCY     PWCCY   3                                           CSW209
     C           SDCURR    PARM SDCURR    DSSDY                                               CSW209
      *                                                                                       CSW209
     C           PRTCD     IFNE *BLANKS                                                       CSW209
     C                     MOVE '044'     DBERR#                                              CSW209
     C                     MOVELWICCY     DBERKY                                              CSW209
     C                     MOVEL'SDCURRPD'DBFNAM                                              CSW209
     C                     EXSR DBERR                                                         CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     MOVE A6SWCY    WOCCYS                                              CSW209
     C                     Z-ADDA6NBDP    WODECS                                              CSW209
      *                                                                                       CSW209
      ** Perform old processing if CSW020 is not switched on.                                 CSW209
      *                                                                                       CSW209
     C           CSW020    IFNE 'Y'                                                           CSW209
      *                                                                                       CSW209
     C           14        SUB  A6NBDP    X       20                                          CSW209
      *                                                                                       CSW209
      ** If 0 decimal places, don't edit.                                                     CSW209
      *                                                                                       CSW209
     C           A6NBDP    IFEQ 0                                                             CSW209
     C                     MOVE *BLANK    AMT                                                 CSW209
     C                     MOVE *ZEROS    AM                                                  CSW209
     C                     MOVEAWAMTA     AMT,2                                               CSW209
     C                     MOVEAWAMTA     AM,1                                                CSW209
     C                     Z-ADD13        W                                                   CSW209
     C                     MOVE ','       AM,X                                                CSW209
     C                     ELSE                                                               CSW209
      *                                                                                       CSW209
      ** Move amount into array.                                                              CSW209
      *                                                                                       CSW209
     C                     MOVEAWAMTA     AMT,1                                               CSW209
      *                                                                                       CSW209
      ** Determine position of decimal digits in 2nd array.                                   CSW209
      *                                                                                       CSW209
     C           X         ADD  1         Y       20                                          CSW209
      *                                                                                       CSW209
      ** Move decimal digits into 2nd array field.                                            CSW209
      *                                                                                       CSW209
     C                     MOVEAAMT,X     AM,Y                                                CSW209
      *                                                                                       CSW209
      ** Determine position & move comma.                                                     CSW209
      *                                                                                       CSW209
     C                     SUB  1         Y                                                   CSW209
     C                     MOVE ','       AM,Y                                                CSW209
      *                                                                                       CSW209
      ** Determine position of digit before comma.                                            CSW209
      *                                                                                       CSW209
     C                     SUB  1         Y                                                   CSW209
      *                                                                                       CSW209
      ** Save position of digit before comma.                                                 CSW209
      *                                                                                       CSW209
     C                     Z-ADDY         W       20                                          CSW209
      *                                                                                       CSW209
      ** Determine position of digit to be moved before comma.                                CSW209
      *                                                                                       CSW209
     C                     SUB  1         X                                                   CSW209
     C                     Z-ADDX         Z       20                                          CSW209
      *                                                                                       CSW209
      ** Move characters one by one from right to left.                                       CSW209
      *                                                                                       CSW209
     C                     DO   X                                                             CSW209
     C                     MOVE AMT,Z     AM,Y                                                CSW209
     C                     SUB  1         Z                                                   CSW209
     C                     SUB  1         Y                                                   CSW209
     C                     ENDDO                                                              CSW209
      *                                                                                       CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     Z-ADD1         Y                                                   CSW209
      *                                                                                       CSW209
      ** Replace leading zeros with blank.                                                    CSW209
      *                                                                                       CSW209
     C           AM,Y      DOWEQ'0'                                                           CSW209
     C           Y         ANDNEW                                                             CSW209
     C                     MOVE ' '       AM,Y                                                CSW209
     C                     ADD  1         Y                                                   CSW209
     C                     ENDDO                                                              CSW209
      *                                                                                       CSW209
      ** Save field from array.                                                               CSW209
      *                                                                                       CSW209
     C                     MOVEAAM        AMX    14                                           CSW209
     C                     MOVE AMX       WOAMNT                                              CSW209
      *                                                                                       CSW209
     C                     ELSE                                                               CSW209
      *                                                                                       CSW209
      ** If CSW020 is switched on, perform decimal places prosessing.                         CSW209
      *                                                                                       CSW209
     C                     CALL 'ZM0040'                                                      CSW209
     C                     PARM WIAMNT    ZAMNT                                               CSW209
     C                     PARM WICCY     ZCCY                                                CSW209
     C                     PARM *BLANKS   ZSAMNT                                              CSW209
     C                     PARM *BLANKS   ZSCCY                                               CSW209
     C                     PARM *BLANKS   ZERR                                                CSW209
      *                                                                                       CSW209
     C           ZERR      IFEQ '1'                                                           CSW209
     C                     MOVE '045'     DBERR#                                              CSW209
     C                     MOVELWICCY     DBERKY                                              CSW209
     C                     MOVEL'ZM0040  'DBFNAM                                              CSW209
     C                     EXSR DBERR                                                         CSW209
     C                     ELSE                                                               CSW209
      *                                                                                       CSW209
     C                     MOVE ZSAMNT    WOAMNT                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
      ** Left-justify amount.                                                                 CSW209
      *                                                                                       CSW209
     C                     MOVEA*BLANKS   FAMT                                                CSW209
     C                     MOVEAWOAMNT    FAMT                                                CSW209
     C                     Z-ADD1         S                                                   CSW209
     C           FAMT,S    DOWEQ' '                                                           CSW209
     C                     ADD  1         S                                                   CSW209
     C                     ENDDO                                                              CSW209
     C                     MOVE *BLANKS   WOAMNT                                              CSW209
     C                     MOVEAFAMT,S    WOAMNT                                              CSW209
      *                                                                                       CSW209
     C                     ENDSR                                                              CSW209
      *****************************************************************                       CSW209
      /EJECT                                                                                  CSW209
      *****************************************************************                       CSW215
      *                                                               *                       CSW215
      *  SRFM59 - Validate Beneficiary 59F Format                     *                       CSW215
      *                                                               *                       CSW215
      *****************************************************************                       CSW215
     C           SRFM59    BEGSR                                                              CSW215
      *                                                                                       CSW215
     C                     CALL 'MG001001'                                                    CSW215
     C                     PARM *BLANKS   PRTRN                                               CSW215
     C                     PARM 'FRMT'    PVTYP                                               CSW215
     C                     PARM           OPCBC1                                              CSW215
     C                     PARM           OPCBC2                                              CSW215
     C                     PARM           OPCBC3                                              CSW215
     C                     PARM           OPCBC4                                              CSW215
     C                     PARM           OPCBC5                                              CSW215
     C                     PARM NWRK      PNTWRK                                              CSW215
     C                     PARM '202'     PMSGTP                                              CSW215
     C                     PARM ':59F:'   PMSTAG                                              CSW215
     C                     PARM           BRCAA                                               CSW215
     C                     PARM WLOCN     PCOUNT  2                                           CSW215
     C                     PARM PCCY      PCURRY  3                                           CSW215
     C                     PARM           @NOSTN                                              CSW215
     C                     PARM *BLANKS   PBENF1 35                                           CSW215
     C                     PARM *BLANKS   PBENF2 35                                           CSW215
     C                     PARM *BLANKS   PBENF3 35                                           CSW215
     C                     PARM *BLANKS   PBENF4 35                                           CSW215
     C                     PARM *BLANKS   PBENF5 35                                           CSW215
     C                     PARM *BLANKS   PMSID                                               CSW215
     C                     PARM *BLANK    PERTP                                               CSW215
      *                                                                                       CSW215
     C           PRTRN     IFEQ *BLANKS                                                       CSW215
     C                     MOVEL'Y'       WRK59F                                              CSW215
     C                     ENDIF                                                              CSW215
      *                                                                                       CSW215
     C                     ENDSR                                                              CSW215
      *****************************************************************                       CSW215
      /EJECT                                                                                  CSW215
      *****************************************************************                       CSW215
     C/COPY WNCPYSRC,FT0645C025
     C/EJECT
     O*
     OOTPAYDDRE                OTPAYO                                     071383
     O                         MT202                                      071383
     O*                                                                   071383
     OCQPACDDRE                CQPACO                                     071383
     O                         MT202                                      071383
     O*                                                                   071383
      *                                                                   S01408
     O/COPY WNCPYSRC,FT0645OOP1                                           S01408
      *                                                                   S01408
      ** Replace *EQUATE for MGOMSGPD with a 4040 since it will be done                     AR972805
      ** externally                                                                         AR972805
      *                                                                                     AR972805
******* TRANS. SPEC. PRINT MSGS AS THEY WILL BE AFTER MS0200 (NO INV.CHRS)                  AR972805
******* FT0645P1,MGOMSGPD                                                                   AR972805
******* 4E504B5E7D7F4DC05DD060CD6F5A6F5B6F4A6F6C6F5C6F4C6F7E6F6E6F7C6FE0D57B6FA6            AR972805
******* 6F4F6F5F7D7960A1606D                                                                AR972805
** FTRANS
*EQUATE FT0645P1,MGOMSGPD
*EQUATE 4040
     X/COPY WNCPYSRC,FT0645X001                                           S01408
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
**   SVAL  -  SYSTEM VALUES ARRAY                                                          BUG15044A
UseFullFTRefInMsg                                                                          BUG15044A
