     H        1   D                       F
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas FT Bank transfers non-input cycle supp msgs')    *
     F*****************************************************************
     F*                                                               *
     F*  Midas - Funds Transfer Module                                *
     F*                                                               *
     F*  FT0648 - Bank Transfers - Supplementary Messages             *
     F*                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
      *                                                               *
      *  Last Amend No. CFT162             Date 08Sep17               *
      *  Prev Amend No. CSW215             Date 06Apr15               *
      *                 AR986522           Date 19Aug14               *
      *                 AR972805           Date 27Feb13               *
      *                 260987A            Date 18Dec12               *
      *                 CFT120             Date 28Sep12               *
      *                 CFT124             Date 28Sep12               *
      *                 AR787620           Date 10Jun11               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 BUG24491           Date 07Aug09               *
      *                 BUG24801           Date 07Jul09               *
      *                 BUG24736           Date 03Jul09               *
      *                 BUG24436           Date 18Jun09               *
      *                 CSW209             Date 01Apr09               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 BUG15044A          Date 25Oct07               *
      *                 BUG15201           Date 30Oct07               *
      *                 CSW207A            Date 25Jul07               *
      * Midas Plus 1.4 Base ------------------------------------------*
      *                 GBO009             Date 14Aug06               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CFT032             Date 11Sep06               *
      *                 CDL049             Date 07Jul06               *
      *                 222448             Date 06Jun06               *
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 222385             Date 23Oct03               *
      *                 219242             Date 01Jul03               *
      *                 219241             Date 01Jul03               *
      *                 CSD015             Date 14Oct02               *
      * Midas Release 4.01.01 ----------------------------------------*
      *                 CSW202             Date 20May02               *
      * Midas Release 4.01 -------------------------------------------*
      *                 CSW025             Date 26Mar02               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 CSW201             Date 02May01               *
      *                 138077             Date 22Jun01               *
      * Midas DBA 3.05 -----------------------------------------------*
      *                CFT009              Date 01Jun00               *
      * Midas DBA 3.04 -----------------------------------------------*
      *                CFT014              Date 25May00               *
      * Midas DBA 3.03 -----------------------------------------------*
      * Midas DBA 3.02 -----------------------------------------------*
      *                CSW020              Date 10Jan00               *
      *                CFT004              Date 27Aug99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
     F*                164663              DATE 25AUG99               *
     F*                135400              DATE 16OCT98               *
     F*                140639              DATE 24SEPT98              *
     F*                113352              DATE 29JAN97               *
     F*                 S01408             DATE 18NOV96               *
     F*                 S01408             DATE 30OCT96               *
     F*                 CSW096             DATE 03JUN96               *
     F*                 097462             DATE 21MAY96               *
     F*                 S01408             DATE 10JAN96               *
     F*                 087873             DATE 01JUN95               *
     F*                 088545             DATE 21JUN95               *
     F*                 S01499             DATE 06JUN94               *
     F*                 S01494             DATE 25MAY94               *
     F*                 068367             DATE 18MAR94               *
     F*                 068242             DATE 16MAR94               *
     F*                 064393             DATE 08DEC93               *
     F*                 S01435             DATE 08SEP93               *
     F*                 058476             DATE 20JUL93               *
     F*                 S01414             DATE 29MAR93               *
     F*                 041780             DATE 17FEB93               *
     F*                 E32481             DATE 29JUL91               *
     F*                 E24916             DATE 03JUN91               *
     F*                 S01310             DATE 17MAY91               *
     F*                 E29942             DATE 08MAY91               *
     F*                 E30710             DATE 20DEC90               *
     F*                 S01194             DATE 20SEP90               *
     F*                 S01117             DATE 20SEP90               *
     F*                 E22406             DATE 09JUL90               *
     F*                 E21471             DATE 04MAY90               *
     F*                 E21286             DATE 01MAR90               *
     F*                 S01177             DATE 23/11/89              *
     F*                                                               *
     F*---------------------------------------------------------------*
     F*                                                               *
      *  CFT162 - MT900 and MT910 Message Generation (Recompile)      *
      *  CSW215 - SWIFT Changes 2015                                  *
      *  AR986522 - Fix for field 33B: Wrong currency.                *
      *           - (Child: AR986526)                                 *
      *  AR972805 - Remove equate translation as done externally.     *
      *             (Child: AR972806)                                 *
      *  260987A - Destination not always displayed on the report.    *
      *  CFT120 - FT IN/OP - Charges to DR of Account Currency        *
      *           (Recompile)                                         *
      *  CFT124 - Ordering Customer of MT103 50K - 'Account' Formats  *
      *  AR787620 - Hooks Incorporation                               *
      *             WNCPYSRC,FTH00022                                 *
      *             WNCPYSRC,FTH00013                                 *
      *             WNCPYSRC,FTH00020                                 *
      *  BUG24491 - Lines 5 and 6 values for Sender to Receiver Info  *
      *             (cover) are missing.                              *
      *  BUG24801 - Destination value for MT202COV is incorrect       *
      *  BUG24736 - MT202 COV cannot cover MT202 classic              *
      *  BUG24436 - Missing MT202COV fields in the generated MT202COV *
      *  CSW209 - SWIFT 2009 Changes                                  *
      *  BUG15044A - Additional coding for swift reference consistent *
      *              with fix 242289 in core.                         *
      *  BUG15201 - Encounter Database Errors (Recompile)             *
      *  CSW207A - Swift 2007 Changes                                 *
      *  GBO009 - Funds Transfer Outgoing Payment Reference           *
      *           Core hooks FT0648C025, FT0648C026, FT0648C027,      *
      *           FT0648C028, FT0648C029, FT0648C030 added            *
      *  CFT032 - Account line in field 50k in MT103 (recompile)      *
      *  CDL049 - Addition of a Reference Rate field (recompile)      *
      *  222448 - Include the Receiver's Charges in field 32A.        *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  222385 - SWIFT msgs are Watch List checked regardless of     *
      *           configuration file setting                          *
      *  219242 - Not possible to create MT103+ payment msg from      *
      *           non-FT transaction (Recompile)                      *
      *  219241 - Defaulting of "Details of Charges" assign a         *
      *           system value (Recompile)                            *
      *  CSD015 - Midas Compliance Watch - Watch List Checking        *
      *  CSW202 - SWIFT 2002 Standards Update                         *
      *  CSW025 - Midas Message Manager                               *
      *           - Pass original change type                         *
      *  CSW201 - SWIFT 2001 Standards Update                         *
      *  138077 - Add extension file MGOEXTPD to store customer no.   *
      *           of field with SWIFT address.                        *
      *         - Allow messages to have expansion even if it starts  *
      *           with "/".                                           *
     F*  CFT009 - FT Fees and Charge Development                      *
      *  CFT014 - Straight-through Processing Phase 2 MT103 Messages  *
      *           Generation for FT                                   *
     F*  CSW020 - SWIFT Decimal Places                                *
     F*           Adjust the amount if the Swift decimal places       *
     F*           differs from the currency decimal places            *
     F*  CFT004 - International Bank Account Number                   *
     F*           New Account Type 'I' (IBAN)                         *
     F*     164663 - Extension of fix 141572 to setup CINDV (Century  *
     F*              indicator for Value Date) for Y2K display problem*
     F*     135400 - Use previous related reference if present, not   *
     F*              previous TRN.                                    *
     F*     140639 - EMU-FT-Generation Report of MT202 is not         *
     F*              reflected.                                       *
     F*     113352 - Set-up CIND (Century Flag) to correct year 2000  *
     F*              display problem.                                 *
     F*     S01408 - Addition of Core Hook FT0648CCP6                 *
     F*              Addition of Core Hook FT0648CCP5                 *
     F*              Addition of Core Hook FT0648CCP4                 *
     F*              Addition of Core Hook FT0648CCP3                 *
     F*     S01408 - Addition of Core Hook FT0648IIP1                 *
     F*              Addition of Core Hook FT0648FFP1                 *
     F*              Addition of Core Hook FT0648CCP1                 *
     F*              Addition of Core Hook FT0648CCP2                 *
     F*              Addition of Core Hook FT0648X001                 *
     F*     CSW096 - SWIFT changes 1996                               *
     F*     097462 - Correct Telex address for Sender's Correspondent *
     F*     S01408 - Core hook FT0648OOP1 added                       *
     F*     087873 - Further to fix 064393; some SWIFT messages had   *
     F*              our customer name in Network Sender field        *
     F*              rather than our Swift ID.                        *
     F*     088545 - If there is no message status default for that   *
     F*              message type for the involved customer,          *
     F*              default the message status with the ICD.         *
     F*     S01499 - BLI V.A.T. Processing                            *
     F*     S01494 - BLI Funds Transfer Enhancements                  *
     F*     068367 - Ensure Priority and Delivery Notification fields *
     F*              are a valid combination.                         *
     F*     068242 - Remove COMIT on MG files                         *
     F*     064393 - GET SENDERS TID FROM BRANCH NOT CUSTOMER.        *
     F*     S01435 - Incoming Message Management.                     *
     F*     058476 - Amounts incorrectly formatted on S.W.I.F.T.      *
     F*              Field M1AMNT not cleared correctly.              *
     F*     S01414 - Book Code and Profit Centre Incorporation.       *
     F*              Rename of profit centre field on ACCNTABF        *
     F*     041780 - Correctly output Swift Value Date to MSIXOPF     *
     F*              (only the above part of the fix needs to be      *
     F*               applied because the remainder was covered by    *
     F*               the R10 Swift Rationalisation)                  *
     F*     E32481 - PGM PROCESSES MULTIPLE RECORDS INSTEAD OF SINGLE.*
     F*     E24916 - :58: SHOULD HAVE THE A/C WITH BANK IF INPUT      *
     F*     S01310 - SWIFT RATIONALISATION.                           *
     F*     E29942 - REMOVE REDUNDANT CODING                          *
     F*     E30710 - SETTLE CURRENCY USED INSTEAD OF PAY IN SR08      *
     F*     S01194 - NEW DATABASE ERROR HANDLING                      *
     F*     S01117 - REPORT CONTROL FACILITY                          *
     F*     S01117 - FUNDS TRANSFER DEFAULT BRANCH REMOVAL AND        *
     F*              CHANGE OF INTERBRANCH ENTRIES                    *
     F*     E22406 - TERMINAL IDENTIFICATION REMOVAL.                 *
     F*     E21471 - DISPLAY CHAPS CODE IN OUTGOING MESSAGE.          *
     F*     E21286 - OUTPUTS FILE CONTROLS TO FTFCTL INSTEAD OF       *
     F*              MSFCTL.                                          *
     F*              (THIS IS THE RE-APPLICATION OF E17216 WHICH WAS  *
     F*              OVERWRITTEN)                                     *
     F*     S01177 - CHANGES FOR EXTENDED SETTLEMENTS                 *
     F*****************************************************************
     F*OTPAY***IF**E***********K        DISK                              E32481
     F*CQPAC***IF**E***********K        DISK                              E32481
     F************CQPADDDF*****                     KIGNORE               E32481
     F*                                                                   S01408
     F/COPY WNCPYSRC,FT0648FFP1                                           S01408
     F*                                                                   S01408
     FPRFP2   IF  E           K        DISK                               E32481
     F*CLINT***IF**E********** K        DISK                              S01310
     F************CLINTCAF****                      KIGNORE               S01310
     F************CLINTC1F****                      KIGNORE               S01310
     F*MSIXOPF*O***E**********          DISK         KCOMIT       A       S01310
     F*MSMSOPF*O***E********** K        DISK         KCOMIT       A       S01310
     F*T0648P1O***E********************PRINTER                        UC  S01117
     F*T0648P2O***E********************PRINTER                        UC  S01117
     FACNUMA  IF  E           K        DISK
     F***OTPAYXL2IF  E           K        DISK                           UC          CFT014 BUG24436
     FOTPAYXL2UF  E           K        DISK                           UC                    BUG24436
     F*MGOREFPDO***E*                   DISK         KCOMIT       A S01310068242
     F*MGOMSGPDO***E*          K        DISK         KCOMIT       A S01310068242
     F***MGOEXTPDO   E                    DISK                                         138077 CSW209
     FMGOEXTPDIF  E           K        DISK                      A                            CSW209
     FMGOREFL0IF  E           K        DISK                                                 BUG24736
     F            MGOREFD0                          KRENAMEMGOREFTR                         BUG24736
     FMGOREFPDO   E                    DISK                      A        068242
     FMGOMSGPDO   E           K        DISK                      A        068242
     FFT0648AUO   E                    PRINTER      KINFDS SPOOLU         S01117
     F*FT0648P1O   E                   PRINTER      KINFDS SPOOL1     UC  S01117
     F*FT0648P2O   E                   PRINTER      KINFDS SPOOL2     UC  S01117
     FFT0648P1O   E                    PRINTER      KINFDS SPOOL1         E32481
     FFT0648P2O   E                    PRINTER      KINFDS SPOOL2         E32481
     FSDBRCHL5IF  E           K        DISK                               E22406
     FTABFP   IF  E           K        DISK
     F            TABTB20F                          KIGNORE
     F            TABTG20F                          KIGNORE
     F            TABLETHF                          KIGNORE
     F            TABLETPF                          KIGNORE
     F************TABLETJF                          KIGNORE               S01117
     F            TABLET5F                          KIGNORE
     F            TABTE10F                          KIGNORE
     F/COPY WNCPYSRC,FT0648F001
     F*
     F/EJECT
     F*
     F****************************************************************
     F* ID F  C  H  L    FUNCTION OF INDICATORS                      *
     F****************************************************************
     F*       09        UNSUCCESSFUL CHAIN TO SDBRCHL5.              *    E22406
     F*       10        UNSUCCESSFUL CHAIN TO TABFP.                 *
     F*       11        UNSUCESSFUL CHAIN TO ACNUMA                  *
     F*       12        UNSUCESSFUL CHAIN TO CLINT
     F*       15        LOKUP operation searching array (DFS)        *    S01310
     F*       16        LOKUP operation searching array (DFS)        *    S01310
     F*       17        LOKUP operation searching array (DFS)        *    S01310
     F*       20        Call of SR01 for destination of message      *    S01310
     F*       35        COV DETAILS                                  *                        CSW209
     F*       37        IF CSW209 IS INSTALLED                       *                        CSW209
     F*       40        FIRST CYCLE COMPLETED.                       *
     F********41********UNSUCESSFUL*WRITE*MSIXOPFF                   *    S01310
     F********42********UNSUCESSFUL*WRITE*MSMSOPFF                   *    S01310
     F*       41        UNSUCESSFUL WRITE MGOMSGPD                   *    S01310
     F*       42        UNSUCESSFUL WRITE MGOREFPD                   *    S01310
     F*       50        MULTIBRANCH INDICATOR ACTIVE                 *    S01117
      *  60 - Work indicator                                         *    CFT014
     F*                                                              *
     F*       61-65     IF RECORD FOUND IN MGOEXTPD                  *                        CSW209
     F*       U7        ) DATA BASE                                  *
     F*       U8        ) ERROR.                                     *
     F*             LR  LAST RECORD (TERMINATE PROGRAM).             *
     F*                                                              *
     F*  N.B:- 90-99    STANDARD SUBROUTINE INDICATORS.              *
     F****************************************************************
     F*
     F/EJECT
     E                    CPY@    1   1 80
     E*
     E                    MTH    12  12  3               MONTH  SR. ARRAY
     E                    AMT        13  1               AMOUNT ARRAY
     E                    AM         14  1               EDITED AMOUNT ARR
     E                    FAMT       15  1               LEFT ADJ AMNT ARR
     E                    ADDR        6 35               NAME/ADDRESS  ARR
     E                    DFS        15  3               default status   S01310
     E                    WA1        50  1                                                    CSW209
      *
     E                    SVAL    1   1 20                                                 BUG15044A
     E/EJECT
     I*                                                                   S01414
     I* Rename of ACCNTABF Profit Centre to avoid overwriting             S01414
     I*                                                                   S01414
     IACCNTABF                                                            S01117
     I              PRFC                            ACPRFC                S01414
     I*                                                                   S01414
     IMGOREFTR                                                                              BUG24801
     I              SYTM                            RSYTM                                   BUG24801
     I              MODI                            RMODI                                   BUG24801
     I              TRNO                            RTRNO                                   BUG24801
     I              TRNF                            RTRNF                                   BUG24801
     I              TRNM                            RTRNM                                   BUG24801
     I              MTRN                            RMTRN                                   BUG24801
     I              TNTP                            RTNTP                                   BUG24801
     I              SBTP                            RSBTP                                   BUG24801
     I              EVTP                            REVTP                                   BUG24801
     I              NWRK                            RNWRK                                   BUG24801
     I              SECN                            RSECN                                   BUG24801
     I              NWSN                            RNWSN                                   BUG24801
     I              DECN                            RDECN                                   BUG24801
     I              NWDS                            RNWDS                                   BUG24801
     I              NWBN                            RNWBN                                   BUG24801
     I              MTPY                            RMTPY                                   BUG24801
     I              MPRY                            RMPRY                                   BUG24801
     I              MGSG                            RMGSG                                   BUG24801
     I              MGST                            RMGST                                   BUG24801
     I              LSCC                            RLSCC                                   BUG24801
     I              F57U                            RF57U                                   BUG24801
     I              PTST                            RPTST                                   BUG24801
     I              CARQ                            RCARQ                                   BUG24801
     I              MPDE                            RMPDE                                   BUG24801
     I              HRDT                            RHRDT                                   BUG24801
     I              MGDE                            RMGDE                                   BUG24801
     I              MGTM                            RMGTM                                   BUG24801
     I              LADT                            RLADT                                   BUG24801
     I              LATM                            RLATM                                   BUG24801
     I              RELD                            RRELD                                   BUG24801
     I              RELT                            RRELT                                   BUG24801
     I              RUSR                            RRUSR                                   BUG24801
     I              RWSN                            RRWSN                                   BUG24801
     I              AMTX                            RAMTX                                   BUG24801
     I              AMTS                            RAMTS                                   BUG24801
     I              SVDT                            RSVDT                                   BUG24801
     I              CCY                             RCCY                                    BUG24801
     I              NSNO                            RNSNO                                   BUG24801
     I              SACN                            RSACN                                   BUG24801
     I              AORR                            RAORR                                   BUG24801
     I              DESI                            RDESI                                   BUG24801
     I              BRCA                            RBRCA                                   BUG24801
     I              OTHB                            ROTHB                                   BUG24801
     I              RCBR                            RRCBR                                   BUG24801
     I              OTHT                            ROTHT                                   BUG24801
     I              NETI                            RNETI                                   BUG24801
     I              DELC                            RDELC                                   BUG24801
     I              DYST                            RDYST                                   BUG24801
     I              RSID                            RRSID                                   BUG24801
     I              MSE1                            RMSE1                                   BUG24801
     I              ELIN                            RELIN                                   BUG24801
     I              SSAC                            RSSAC                                   BUG24801
     I              MIR                             RMIR                                    BUG24801
     I              TSKS                            RTSKS                                   BUG24801
     I              TSKY                            RTSKY                                   BUG24801
     I              TSEQ                            RTSEQ                                   BUG24801
     I              CFPF                            RCFPF                                   BUG24801
     I              PT210                           RPT210                                  BUG24801
     I              AVDT                            RAVDT                                   BUG24801
     I              ASEQ                            RASEQ                                   BUG24801
     I              TODY                            RTODY                                   BUG24801
     I              CIND                            RCIND                                   BUG24801
     I              CINDV                           RCINDV                                  BUG24801
     I              CLSS                            RCLSS                                   BUG24801
      *                                                                                     BUG24801
     I/COPY WNCPYSRC,FT0648I001
     I*  DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
     ICPYR@#      DS
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
     I*                                                                   S01117
     ISPOOLU      DS                                                      S01117
     I* FILE INFORMATION DATA STRUCTURE                                   S01117
     I                                       83  92 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
     I*
     ISPOOL1      DS                                                      S01117
     I* FILE INFORMATION DATA STRUCTURE                                   S01117
     I                                       83  92 SFILE1                S01117
     I                                    B 123 1240SFNUM1                S01117
     ISPOOL2      DS                                                      S01117
     I* FILE INFORMATION DATA STRUCTURE                                   S01117
     I                                       83  92 SFILE2                S01117
     I                                    B 123 1240SFNUM2                S01117
     I*                                                                   S01117
     IRUNDAT      DS                             13                       S01117
     I* DATA STRUCTURE TO RETRIVE MULTIBRANCH INDICATOR                   S01117
     I                                       13  13 MBIN                  S01117
     IEXTN        DS                         45                           138077
     I                                        1   20MPSN                  138077
     I                                        3   7 MTG                   138077
     I                                        8  15 MCSI                  138077
      *                                                                   138077
      **  Multiple occurrence data structure for extension file           138077
      *                                                                   138077
     I            DS                                                      138077
     I                                        1   5 @MTG                  138077
     I                                        2   2 FLDTYP                138077
     I                                        4   4 FLDTAG                138077
      *                                                                   138077
      **  Field tag data structure                                        138077
      *                                                                   138077
     I*                                                                   S01117
     I************DS                                                      S01310
     I********************************************************
     I********DATA*STRUCTURE*TO*BUILD*BANK*TRANSFER          *            S01310
     I*********RECORDS*OUTGOING*SWIFT*MESSAGE*TYPE*MT202-1   *            S01310
     I********************************************************
     I************                            1 256 MT2021                S01310
     I************                            1   1 M1HEAD                S01310
     I************                            2   3 M1CRL1                S01310
     I************                            4  15 M1OTID                S01310
     I************                           16  16 M1SP1                 S01310
     I************                           17  21 M1ISNO                S01310
     I************                           22  23 M1CRL2                S01310
     I************                           24  26 M1MSGT                S01310
     I************                           27  27 M1SP2                 S01310
     I************                           28  29 M1MSGP                S01310
     I************                           30  31 M1CRL3                S01310
     I************                           32  43 M1RADD                S01310
     I************                           44  45 M1CRL4                S01310
     I************                           68  71 M1TG20                S01310
     I************                           72  87 M1TREF                S01310
     I************                           88  89 M1CRL6                S01310
     I************                           90  93 M1TG21                S01310
     I************                           94 109 M1RTRT                S01310
     I************                          110 111 M1CRL7                S01310
     I************                          112 116 M1TG32                S01310
     I************                          117 122 M1VDAT                S01310
     I************                          123 125 M1RCCY                S01310
     I************                          126 140 M1AMNT                S01310
     I************                          141 142 M1CRL8                S01310
     I************                          143 145 M1TG52                S01310
     I************                          146 146 M1OBTG                S01310
     I************                          147 147 M1HYPH                S01310
     I************                          148 184 M1OBK1                S01310
     I************                          185 186 M1CRL9                S01310
     I************                          187 221 M1OBK2                S01310
     I************                          222 223 M1CRLA                S01310
     I************                          257 257 MXMIND                S01310
     I************                          258 272 MXTREF                S01310
     I************                          273 273 MXDFLG                S01310
     I************                                                        S01310
     I************DS                                                      S01310
     I********************************************************            S01310
     I********DATA*STRUCTURE*TO*BUILD*BANK*TRANSFER          *            S01310
     I*********RECORDS*OUTGOING*SWIFT*MESSAGE*TYPE MT202-2   *            S01310
     I********************************************************            S01310
     I************                            1 256 MT2022                S01310
     I************                            1  35 M2OBK3                S01310
     I************                           36  37 M2CRL1                S01310
     I************                           38  72 M2OBK4                S01310
     I************                           73  74 M2CRL2                S01310
     I************                           75 109 M2OBK5                S01310
     I************                          110 111 M2CRL3                S01310
     I************                          112 114 M2TG53                S01310
     I************                          115 115 M2SCTT                S01310
     I************                          116 116 M2COLN                S01310
     I************                          117 153 M2SCR1                S01310
     I************                          154 155 M2CRL4                S01310
     I************                          156 190 M2SCR2                S01310
     I************                          191 192 M2CRL5                S01310
     I************                          193 227 M2SCR3                S01310
     I************                          228 229 M2CRL6                S01310
     I************                                                        S01310
     I************DS                                                      S01310
     I********************************************************            S01310
     I********DATA*STRUCTURE*TO*BUILD*BANK*TRANSFER          *            S01310
     I*********RECORDS*OUTGOING*SWIFT*MESSAGE*TYPE MT202-3   *            S01310
     I********************************************************            S01310
     I************                            1 256 MT2023                S01310
     I************                            1  35 M3SCR4                S01310
     I************                           36  37 M3CRL1                S01310
     I************                           38  72 M3SCR5                S01310
     I************                           73  74 M3CRL2                S01310
     I************                           75  77 M3TG54                S01310
     I************                           78  78 M3RCTT                S01310
     I************                           79  79 M3COLN                S01310
     I************                           80 116 M3RCR1                S01310
     I************                          117 118 M3CRL3                S01310
     I************                          119 153 M3RCR2                S01310
     I************                          154 155 M3CRL4                S01310
     I************                          156 190 M3RCR3                S01310
     I************                          191 192 M3CRL5                S01310
     I************                          193 227 M3RCR4                S01310
     I************                          228 229 M3CRL6                S01310
     I************                                                        S01310
     I************DS                                                      S01310
     I********************************************************            S01310
     I********DATA*STRUCTURE*TO*BUILD*BANK*TRANSFER          *            S01310
     I*********RECORDS*OUTGOING*SWIFT*MESSAGE*TYPE MT202-4   *            S01310
     I************                                                        S01310
     I************                            1 256 MT2024                S01310
     I************                            1  35 M4RCR5                S01310
     I************                           36  37 M4CRL1                S01310
     I************                           38  40 M4TG56                S01310
     I************                           41  41 M4INBT                S01310
     I************                           42  42 M4CLN1                S01310
     I************                           43  79 M4INB1                S01310
     I************                           80  81 M4CRL2                S01310
     I************                           82 116 M4INB2                S01310
     I************                          117 118 M4CRL3                S01310
     I************                          119 153 M4INB3                S01310
     I************                          154 155 M4CRL4                S01310
     I************                          156 190 M4INB4                S01310
     I************                          191 192 M4CRL5                S01310
     I************                          193 227 M4INB5                S01310
     I************                          228 229 M4CRL6                S01310
     I************                                                        S01310
     I************DS                                                      S01310
     I********************************************************            S01310
     I********DATA*STRUCTURE*TO*BUILD*BANK*TRANSFER          *            S01310
     I*********RECORDS*OUTGOING*SWIFT*MESSAGE*TYPE*MT202-5   *            S01310
     I********************************************************            S01310
     I************                            1 256 MT2025                S01310
     I************                            1   3 M5TG57                S01310
     I************                            4   4 M5ABTT                S01310
     I************                            5   5 M5CLN1                S01310
     I************                            6  42 M5AWB1                S01310
     I************                           43  44 M5CRL1                S01310
     I************                           45  79 M5AWB2                S01310
     I************                           80  81 M5CRL2                S01310
     I************                           82 116 M5AWB3                S01310
     I************                          117 118 M5CRL3                S01310
     I************                          119 153 M5AWB4                S01310
     I************                          154 155 M5CRL4                S01310
     I************                          156 190 M5AWB5                S01310
     I************                          191 192 M5CRL5                S01310
     I************                          193 195 M5TG58                S01310
     I************                          196 196 M5BBTT                S01310
     I************                          197 197 M5CLN2                S01310
     I************                          198 234 M5BBK1                S01310
     I************                          235 236 M5CRL6                S01310
     I************                                                        S01310
     I************DS                                                      S01310
     I********************************************************            S01310
     I********DATA*STRUCTURE*TO*BUILD*BANK*TRANSFER          *            S01310
     I*********RECORDS*OUTGOING*SWIFT*MESSAGE*TYPE*MT202-6   *            S01310
     I********************************************************            S01310
     I************                            1 256 MT2026                S01310
     I************                            1  35 M6BBK2                S01310
     I************                           36  37 M6CRL1                S01310
     I************                           38  72 M6BBK3                S01310
     I************                           73  74 M6CRL2                S01310
     I************                           75 109 M6BBK4                S01310
     I************                          110 111 M6CRL3                S01310
     I************                          112 146 M6BBK5                S01310
     I************                          147 148 M6CRL4                S01310
     I**************************************149 152 M6TG72                S01177
     I**************************************153 187 M6BTB1                S01177
     I**************************************188 189 M6CRL5                S01177
     I**************************************190 224 M6BTB2                S01177
     I**************************************225 226 M6CRL6                S01177
     I************                          153 156 M6TG72          S01177S01310
     I************                          157 191 M6BTB1          S01177S01310
     I************                          192 193 M6CRL5          S01177S01310
     I************                          194 228 M6BTB2          S01177S01310
     I************                          229 230 M6CRL6          S01177S01310
     I************                                                        S01310
     I************DS                                                      S01310
     I********************************************************            S01310
     I********DATA*STRUCTURE*TO*BUILD*BANK*TRANSFER          *            S01310
     I*********RECORDS*OUTGOING*SWIFT*MESSAGE*TYPE MT202-7   *            S01310
     I********************************************************            S01310
     I************                            1 256 MT2027                S01310
     I************                            1  35 M7BTB3                S01310
     I************                           36  37 M7CRL1                S01310
     I************                           38  72 M7BTB4                S01310
     I************                           73  74 M7CRL2                S01310
     I************                           75 109 M7BTB5                S01310
     I************                          110 111 M7CRL3                S01310
     I************                          112 146 M7BTB6                S01310
     I************                          147 148 M7CRL4                S01310
     I************                          149 149 M7HYPH                S01310
     I************                          150 150 M7ETX                 S01310
      *                                                                   CSW096
     IP@IN        DS                            256                       CSW096
     I                                        1   3 I@SNBR                CSW096
     I                                        4   9 I@DSCN                CSW096
     I                                       10  12 I@MTPY                CSW096
     I                                       13  140I@SETT                CSW096
     I                                       15  15 I@CONC                CSW096
     I                                       16  16 I@FTCS                CSW096
     I                                       17  18 I@MMOD                CSW096
      ** Data structure for input parameter                               CSW096
      *                                                                   CSW096
     IP@OUT       DS                            256                       CSW096
     I**********                              1   60O@CNSN                             CSW096 CSD027
     I                                        1   6 O@CNSN                                    CSD027
     I                                        7  18 O@SWSN                CSW096
     I                                       19  38 O@NWSN                CSW096
     I                                       39  49 O@SWDS                CSW096
     I                                       46  46 W@96CN                CSW096
     I                                       47  49 W@BIC                 CSW096
     I                                       50  69 O@NWDS                CSW096
     I                                       70  75 O@NWRK                CSW096
     I                                       76  76 O@MGSG                CSW096
     I                                       77  80 O@MGST                CSW096
     I                                       81  81 O@PAIN                CSW096
     I                                       82  87 O@PCNB                CSW096
     I                                       88  90 O@SPRS                CSW096
      ** Data structure for output parameter                              CSW096
      *                                                                   CSW096
     I*
     I            DS
     I*
     I**********************************************
     I*       DATA STRUCTURE TO SAVE FIELDS FROM   *
     I*        INSTALLATION CONTROL DATA AREA.     *
     I**********************************************
     I*
     I****************************************1   30SDFBR                 S01117
     I                                        4  15 SCSID
     I                                       12  12 CSID9
     I                                       13  13 CSID10
     I                                       14  14 CSID11
     I                                       15  15 CSID12
     I*
     I*
     I**********************************************
     I*   DATA STRUCTURE TO HANDLE THE CONVERSION  *
     I*   OF DATE FORMAT YYMMDD TO DDMMMYY.        *
     I**********************************************
     I            DS
     I                                        1   60SDATE
     I                                        1   2 SYY
     I                                        3   40SMM
     I                                        5   6 SDD
     I            DS
     I                                        1   7 WDATE
     I                                        1   2 WDD
     I                                        3   5 WMM
     I                                        6   7 WYY
     I*
     I**********************************************
     I*   DATA STRUCTURE TO MANIPULATE AMOUNT      *
     I**********************************************
     I            DS
     I                                        1  130WAMNT
     I                                        1  13 RAMNT
     I* FOR EDITING ON THE REPORT
     I                                        1  130P2AMT0
     I                                        1  130P2AMT1
     I                                        1  130P2AMT2
     I                                        1  130P2AMT3
     I**********************************************
     I*   DATA STRUCTURE TO ELIMINATE BLANK LINES  *
     I**********************************************
     IOFSPT       DS                            175
     I                                        1  35 OFSPT1
     I                                       36  70 OFSPT2
     I                                       71 105 OFSPT3
     I                                      106 140 OFSPT4
     I                                      141 175 OFSPT5
     I**********************************************
     I*   DATA STRUCTURE TO MANIPULATE PAY REF.    *
     I**********************************************
     I            DS
     I                                        1  15 DSPREF
     I                                       12  13 PAYT
     I*
     I**********************************************
     I*       DATA STRUCTURE USED IN THE EVENT     *
     I*                    OF DATABASE ERRORS.     *
     I**********************************************
     I*
     IDLDA        DS                            256
     I**************************************134 138 DBFILE                S01194
     I**************************************139 167 DBKEY                 S01194
     I**************************************168 175 DBPGM                 S01194
     I**************************************176 177 DBASE                 S01194
     I                                      134 141 DBFILE                S01194
     I                                      142 170 DBKEY                 S01194
     I                                      171 180 DBPGM                 S01194
     I                                      181 1830DBASE                 S01194
     I*
     I**********************************************
     I****DATA*STRUCTURE*USED*IN*UPDATING*OTHER    *                      S01310
     I****MESSAGES*COUNT*IN*DATA*AREA*MSFCTL*.************************    E21286
     I****MESSAGES*COUNT*IN*DATA*AREA*FTFCTL*.     *                E21286S01310
     I**********************************************                      S01310
     I***********                                                         S01310
     I*FCTL       DS                            256                       S01310
     I***********                         P  91  930DFOMC                 S01310
     I***********                         P  94  960DFOTL                 S01310
     I*
     I**********************************************
     I*       DATA STRUCTURE - PROGRAM STATUS      *
     I**********************************************
     I*
     IPSDS       SDS
     I                                        1  10 ##PGM                 S01435
     I                                      254 263 USRID
     I*
     I*********************************************                       S01310
     I********DATA*STRUCTURE*TO*CONTAIN           *                       S01310
     I*************HEX*FIELDS                     *                       S01310
     I*********************************************
     I*
     I************DS                                                      S01310
     I************                        B   1   20B0D                   S01310
     I************                            2   2 X0D                   S01310
     I************                        B   3   40B25                   S01310
     I************                            4   4 X25                   S01310
     I************                        B   5   60B01                   S01310
     I************                            6   6 X01                   S01310
     I************                        B   7   80B03                   S01310
     I************                            8   8 X03                   S01310
     I************                            9  10 X0D25                 S01310
      *                                                                   S01310
     I            DS                                                      S01310
     I                                        1  24 DS32                  S01310
     I                                        1   6 M1VDAT                S01310
     I                                        7   9 M1RCCY                S01310
     I                                       10  24 M1AMNT                S01310
      **  Data structure for field 32 - date/currency/amount field        S01310
      *                                                                   S01310
     I            DS                                                      S01310
     I                                        1  12 CSID                  S01310
     I                                        9  11 @BIC                  S01310
      **  Data structure to test for BIC code                             S01310
      *                                                                   S01310
     IMULT        DS                         95                           S01310
     I                                        1   5 MTAG                  S01310
     I                                        6  55 MFLD                  S01310
      **  Multiple occurrence data structure for message                  S01310
      *                                                                   S01310
     I/COPY WNCPYSRC,FT0648I002
     I*                                                                   S01310
     ISDCUST    E DSSDCUSTPD                                              S01310
      **  External Data structure for customer details.                   S01310
      *                                                                   S01310
     ISDMMOD    E DSSDMMODPD                                              S01310
      **  External Data structure for module ICD file.                    S01310
      *                                                                   S01310
     ISDMGME    E DSSDMGMEPD                                              S01310
      **  Data structure for MESSAGE MANAGEMENT file                      S01310
      *                                                                   S01117
     ISDCURR    E DSSDCURRPD                                              S01117
      **  Data structure for CURRENCIES file                              S01117
     I*                                                                   S01310
     ISDCNST    E DSSDCNSTPD                                              S01435
      *                                                                   S01435
      *  Calling parameter data structure for ME1400                      S01435
      *                                                                   S01435
     IMEBICD    E DSMEBICDPD                                              S01435
      *                                                                   S01435
      *  Calling parameter data structure for ME1400                      S01435
      *                                                                                       CSW202
     IMEBEIS    E DSMEBEISPD                                                                  CSW202
      ** Data structure for BEI master file                                                   CSW202
      *                                                                   S01435
     I/COPY WNCPYSRC,FTH00309
      /EJECT                                                              S01435
     IW8FT        DS                            128                       S01435
      *                                                                   S01435
      * Address data structure                                            S01435
      *                                                                   S01435
      * Currency                                                          S01435
     I                                        1   3 W8CCY                 S01435
      * Settlement Type                                                   S01435
     I                                        4   5 W8STMT                S01435
      * Mandatory Text - convert BIC identifiers                          S01435
     I                                        6   6 W8MTXT                S01435
      * Message Tag                                                       S01435
     I                                        7  11 W8MTAG                S01435
      * Construct of data in field                                        S01435
     I                                       12  12 W8TYPE                S01435
      * Number of Lines available                                         S01435
     I                                       13  140W8NLIN                S01435
      * Network and Message Type                                          S01435
     I                                       15  20 W8NWRK                S01435
     I                                       21  23 W8MTPY                S01435
      * Calling Program                                                   S01435
     I                                       24  33 W8CPGM                S01435
      * Action *PRINT/*ENQ/*MSG GEN                                       S01435
     I                                       34  41 W8ACT                 S01435
      * Critical reporting - Database error if 'Y'                        S01435
      * If no BIC directory and BIC entered no error                      S01435
     I                                       42  42 W8CRIT                S01435
      * Force Midas Address - where possible                              S01435
     I                                       43  43 W8MADD                S01435
      * If Retail get first address from account                          S01435
     I                                       44  44 W8RTAD                S01435
      * Alternative Address                                               S01435
     I                                       45  45 W8ALTN                S01435
      * Address type selected in W0MSG                                    S01435
     I                                       46  46 W8ADTP                S01435
      *                                                                   S01435
     C/COPY FTCPYSRC,SFTADDRI                                             S01435
      *                                                                   S01435
      * Address data structure                                            S01435
      *                                                                   S01435
     IDSFDY     E DSDSFDY                                                 S01310
      **  Short data structure for access programs                        S01310
      *                                                                   S01310
     IDSSDY     E DSDSSDY                                                 S01310
      **  Long data structure for access programs                         S01310
     I*                                                                   S01310
     ISCSARD    E DSSCSARDPD                                              CFT004
      * External data structure - SAR details                             CFT004
     I*
     ISDFTFR    E DSSDFTFRPD                                              CFT009
     I*External data structure for Funds Transfer Details                 CFT009
     I*                                                                   S01408
     I/COPY WNCPYSRC,FT0648IIP1                                           S01408
     I*                                                                   S01408
     IWLTDS     E DSSDWLTOPD                                                                  CSD015
      ** DS For Watch List Transaction Details File                                           CSD015
      *                                                                                       CSD015
     IPSTRNG      DS                           9999                                           CSD015
      *                                                                                       CSD015
     ISDWLCC    E DSSDWLCCPD                                                                  222385
      ** Watch list checking details                                                          222385
      *                                                                                       222385
     I              'MT202COV50x_AcFmt'   C         SVAFMT                                    CFT124
      *                                                                                       CFT124
      ** Define system value for CFT124                                                       CFT124
      *                                                                                       CFT124
     I/EJECT
     C                     MOVEACPY@      BIS@   80
     C           *LIKE     DEFN OPPARM    IPPARM                          E32481
     C/COPY WNCPYSRC,FT0648C022
     C******************************
     C*****KEY*LIST*****PARAMETERS *                                      S01310
     C******************************                                      S01310
     C***********CUSKEY****KLIST                                          S01310
     C*********************KFLD           KCUSNO                          S01310
     C*********************KFLD           KEYA                            S01310
     C*
     C*
     C*    INPUT OUTPUT PARAMETERS *
     C******************************
     C           *ENTRY    PLIST
     C***********DSPREF****PARM           PREF                            E32481
     C                     PARM           IPPARM                          E32481
     C                     PARM           OPPARM                          E32481
     C                     PARM           RSEQ                            S01117
     C*
     C***********************
     C*    FIRST CYCLE.     *
     C***********************
     C*
     C  N40                EXSR FIRST
     C*
     C/EJECT
     C*
     C****************************
     C*    DETAIL PROCESSING.    *
     C****************************
     C*
     C*****************************
     C*    RECORD READ FROM OTPAYDD
     C*****************************
     C/COPY WNCPYSRC,FT0648C019
     C*
     C                     MOVELCHTP      @CHG    1                                           CSW025
      *                                                                                       CSW025
     C           *LOVAL    SETLLPRFP2                                     E32481
     C                     READ PRFP2                    13               E32481
     C                     MOVELPREF      DSPREF                          E32481
      *                                                                   E32481
      ** Do While records found on the OTPAYDD file.                      E32481
      *                                                                   E32481
     C           *IN13     DOWEQ'0'                                       E32481
     C/COPY WNCPYSRC,FT0648C025
     C           PAYT      IFEQ 'OP'
     C/COPY WNCPYSRC,FT0648C026
      *                                                                   CFT014
      ** Retrieve corresponding record on extension file                  CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
     C           CFT009    OREQ 'Y'                                       CFT009
     C           PREF      CHAINOTPAYXL2             60                   CFT014
     C           *IN60     IFEQ *ON                                       CFT014
     C                     MOVEL'OTPAYXL2'DBFNAM           ************   CFT014
     C                     MOVELPREF      DBERKY           * DBERR030 *   CFT014
     C                     MOVE '30'      DBERR#           ************   CFT014
     C                     EXSR DBERR                                     CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ADD  1         AUNO1                           S01117
     C*********************                                               E32481
     C***********PREF******CHAINOTPAYDDF             99                   E32481
     C**N99******RECI******COMP 'D'                  9999                 E32481
     C***99****************DO                              B001           E32481
     C*********************MOVE 'OTPAY'   DBFNAM  5         )))  DATA  )))S01310
     C*********************MOVEL'OTPAY'   DBFNAM  8         )))  DATA  )))S01310
     C*********************MOVELPREF      DBERKY 39         )))  BASE  )))E32481
     C*********************MOVE '20'      DBERR#  2         ))) ERROR  )))E32481
     C*********************EXSR DBERR                       )))   20   )))E32481
     C*********************END                             E001           E32481
      *                                                                   E32481
      ** Initialise non-constant fields                                   E32481
      *                                                                   E32481
     C                     EXSR INTF                                      E32481
     C*
     C                     EXSR BRANCH                                    S01117
     C/COPY WNCPYSRC,FT0648C015
     C*
     C*  SETUP PARAMETERS  AND EXECUTE SR01 TO
     C** DETERMINE SWIFT ADDRESS OF SENDERS CORRESPONDENT
     C*
     C                     MOVELSNCT      ISPTP   1
     C                     MOVELSNCO      ISPTY1 35
     C                     MOVE *BLANKS   ISPTY2 35
     C                     MOVE *BLANKS   ISPTY3 35
     C                     MOVE *BLANKS   ISPTY4 35
     C                     MOVE *BLANKS   ISPTY5 35
     C                     MOVE PCCY      ISCCY   3
     C                     MOVE 'A'       IVTAG1  1
     C                     MOVE ' '       IVTAG2  1
      *                                                                                      260987A
     C           SNCT      IFEQ 'A'                                                          260987A
     C                     MOVE 'D'       IVTAG3  1                                          260987A
     C                     ELSE                                                              260987A
     C                     MOVE ' '       IVTAG3  1
     C                     ENDIF                                                             260987A
      *                                                                                      260987A
     C/COPY WNCPYSRC,FT0648C018
      *                                                                   S01310
      **  Seton destination indicator (in a cover 202 , senders           S01310
      **  correspondent becomes destination).                             S01310
      *                                                                   S01310
     C                     SETON                     20                   S01310
      *                                                                   S01310
     C                     EXSR SR01
     C*********PARAMETERS*OFSPT1*SHOULD*BE*MOVED*TO********************                      260987A
     C*********FIELD*RECIPIENT*ADDRESS*OF*SWIFT*DATA*STRUCTURE*********                      260987A
     C*********SAVE*IT*AS*IT*WILL*BE*USED*IN*SUBROUTINE*10*&*4.********                      260987A
     C**********           MOVELOFSPT1    RECADD 12                                          260987A
      *                                                                                      260987A
      ** Output same destination to printout as MGOREFPD.                                    260987A
      *                                                                                      260987A
     C                     MOVELNWDS      RECADD 12                                          260987A
     C************                                                        CSW096
     C**IF*BIC*CODE DO NOT OUTPUT TO SWIFT                                CSW096
     C************                                                        CSW096
     C************         MOVE RECADD    WKBIC   4                       CSW096
     C***********WKBIC     IFEQ 'BIC '                                    CSW096
     C************         MOVE 'N'       OSUFLG                          CSW096
     C************         END                                            CSW096
     C*
     C* ****** SAVE CUSTOMER FIELDS TO BE USED IN SUBROUTINE 8.****
     C**********           MOVE CUSTNO    SCUSNO  60                                          CSD027
     C                     MOVE CUSTNO    SCUSNO  6                                           CSD027
     C                     MOVE CTWN      SCTWN  10
     C                     MOVE CRNM      SCRNM  20
     C/COPY WNCPYSRC,FT0648C010
     C*
     C***IF*THE*SWIFT*UNDER*FLAG*=*'N'*FROM*SUBROUTINE*SR01               S01310
     C***THEN*THE*MESSAGE*MUST*BE*SENT*VIA*TELEX                          S01310
     C*
      ** Only do this processing if default network is 'PAPER'            S01310
      *                                                                   S01310
     C           OSUFLG    IFEQ 'N'
     C*********************OPEN FT0648P2                                  E32481
     C*                                                                   S01117
     C* IF MULTIBRANCHING INDICATOR ACTIVE,MOVE BOOKING BRANCH AND        S01117
     C* BRANCH NAME TO THE RELATIVE FIELDS SET UP WITHIN THE PRINTER FILE S01117
     C*                                                                   S01117
     C           *IN50     IFEQ '1'                                       S01117
     C                     MOVE BRCAA     P2BRCA                          S01117
     C                     MOVELBRNM      P2BRNM                          S01117
     C                     END                                            S01117
     C* ****** FORMAT RECEIVING BANK FROM DESTINATION FIELDS ******
     C                     MOVELDSTT      ISPTP
     C                     MOVELPCCY      ISCCY                           S01435
     C                     MOVELDST1      ISPTY1
     C                     MOVELDST2      ISPTY2
     C                     MOVELDST3      ISPTY3
     C                     MOVELDST4      ISPTY4
     C                     MOVELPCCY      ISCCY
     C*
     C                     EXSR SR05
     C* ****** MOVE FORMATTED RECEIVING BANK FIELDS INTO PRINT LINE**
     C                     MOVELOFSPT1    P2RBK1
     C                     MOVELOFSPT2    P2RBK2
     C                     MOVELOFSPT3    P2RBK3
     C                     MOVELOFSPT4    P2RBK4
     C                     MOVELOFSPT5    P2RBK5
     C*
     C* ****** FORMAT SENDERS CORRESPONDENT          ******
     C                     MOVELSNCT      ISPTP
     C                     MOVELPCCY      ISCCY                           S01435
     C                     MOVELSNCO      ISPTY1
     C                     EXSR SR05
     C* ****** MOVE FORMATTED SENDERS CORRESP. FIELDS INTO **
     C* ****** DESTINATION FIELD PRINT LINE                **
     C                     MOVELOFSPT1    P2DST1
     C                     MOVELOFSPT2    P2DST2
     C                     MOVELOFSPT3    P2DST3
     C                     MOVELOFSPT4    P2DST4
     C                     MOVELOFSPT5    P2DST5
     C*
     C* ****** FORMAT RECEIVERS CORRESPONDENT        ******
     C                     MOVELRCRT      ISPTP
     C                     MOVELPCCY      ISCCY                           S01435
     C                     MOVELRCO1      ISPTY1
     C                     MOVELRCO2      ISPTY2
     C                     MOVELRCO3      ISPTY3
     C                     MOVELRCO4      ISPTY4
     C                     MOVELRCO5      ISPTY5
     C                     EXSR SR05
     C* ****** MOVE FORMATTED RECEIVERS CORR. FIELDS INTO PRINT LINE**
     C                     MOVELOFSPT1    P2RCR1
     C                     MOVELOFSPT2    P2RCR2
     C                     MOVELOFSPT3    P2RCR3
     C                     MOVELOFSPT4    P2RCR4
     C                     MOVELOFSPT5    P2RCR5
     C*
     C* ****** FORMAT ACCOUNT WITH BANK              ******
     C                     MOVELACBT      ISPTP
     C                     MOVELPCCY      ISCCY                           S01435
     C                     MOVELACB1      ISPTY1
     C                     MOVELACB2      ISPTY2
     C                     MOVELACB3      ISPTY3
     C                     MOVELACB4      ISPTY4
     C                     MOVELACB5      ISPTY5
     C                     EXSR SR05
     C* ****** MOVE FORMATTED ACCNT WITH BANK FIELDS INTO PRINT LINE**
     C                     MOVELOFSPT1    P2AWB1
     C                     MOVELOFSPT2    P2AWB2
     C                     MOVELOFSPT3    P2AWB3
     C                     MOVELOFSPT4    P2AWB4
     C                     MOVELOFSPT5    P2AWB5
     C*
     C* ****** FORMAT BENEFICIARY CUSTOMER           ******
     C                     MOVELBNCT      ISPTP
     C                     MOVELPCCY      ISCCY                           S01435
     C                     MOVELBNC1      ISPTY1
     C                     MOVELBNC2      ISPTY2
     C                     MOVELBNC3      ISPTY3
     C                     MOVELBNC4      ISPTY4
     C                     MOVELBNC5      ISPTY5
     C                     EXSR SR05
     C* ****** MOVE FORMATTED BENEFICIARY CUST FIELDS INTO PRINT LINE**
     C                     MOVELOFSPT1    P2BC1
     C                     MOVELOFSPT2    P2BC2
     C                     MOVELOFSPT3    P2BC3
     C                     MOVELOFSPT4    P2BC4
     C                     MOVELOFSPT5    P2BC5
     C*
     C* ****** DETERMINE AMOUNT      ****
     C                     EXSR SR06
     C                     EXSR SRP2                       PRT TELX REPORT
     C*********************ELSE                            SWFT USER FLG=YS01310
     C                     END                                            S01310
     C*********************OPEN FT0648P1                                  E32481
     C*
     C*  INTIALISE AND PRESET FIELDS IN DATA STRUCTURE
     C*  FOR SWIFT MESSAGES TYPE RECORDS
     C                     EXSR SR10
     C*  FORMAT THE AMOUNT                                                S01310
     C                     EXSR SR06                                      S01310
      *                                                                   S01310
      ** Set up field :32A: (date/currency/amount)                        S01310
      *                                                                   S01310
     C                     EXSR FLD32                                     S01310
     C/COPY WNCPYSRC,FT0648C003
      *                                                                   S01310
     C*********************MOVEL*BLANK    M1OBK1                          E29942
     C*********************MOVE *BLANK    M1OBK2                          E29942
     C*********************MOVE *BLANK    M2OBK3                          E29942
     C*********************MOVE *BLANK    M2OBK4                          E29942
     C*********************MOVE *BLANK    M2OBK5                          E29942
     C***********M1OBK1****IFNE *BLANK                                    E29942
     C***********M1OBK2****ORNE *BLANK                                    E29942
     C***********M2OBK3****ORNE *BLANK                                    E29942
     C***********M2OBK4****ORNE *BLANK                                    E29942
     C***********M2OBK5****ORNE *BLANK                                    E29942
     C*********************MOVE OSTAG     M1OBTG                          E29942
     C*********************MOVE ':52'     M1TG52                          E29942
     C*********************MOVE ':'       M1HYPH                          E29942
     C*********************MOVE X0D25     M1CRL9                          E29942
     C*********************END                                            E29942
     C***********M1OBK2****IFNE *BLANK                                    E29942
     C***********M2OBK3****ORNE *BLANK                                    E29942
     C***********M2OBK4****ORNE *BLANK                                    E29942
     C***********M2OBK5****ORNE *BLANK                                    E29942
     C*********************MOVE X0D25     M1CRLA                          E29942
     C*********************END                                            E29942
     C***********M2OBK3****IFNE *BLANK                                    E29942
     C***********M2OBK4****ORNE *BLANK                                    E29942
     C***********M2OBK5****ORNE *BLANK                                    E29942
     C*********************MOVE X0D25     M2CRL1                          E29942
     C*********************END                                            E29942
     C***********M2OBK4****IFNE *BLANK                                    E29942
     C***********M2OBK5****ORNE *BLANK                                    E29942
     C*********************MOVE X0D25     M2CRL2                          E29942
     C*********************END                                            E29942
     C***********M2OBK5****IFNE *BLANK                                    E29942
     C*********************MOVE X0D25     M2CRL3                          E29942
     C*********************END                                            E29942
     C*********************MOVEL*BLANK    M2SCR1                          E29942
     C*********************MOVEL*BLANK    M2SCR2                          E29942
     C*********************MOVEL*BLANK    M2SCR3                          E29942
     C*********************MOVEL*BLANK    M3SCR4                          E29942
     C*********************MOVEL*BLANK    M3SCR5                          E29942
     C***********M2SCR1****IFNE *BLANK                                    E29942
     C***********M2SCR2****ORNE *BLANK                                    E29942
     C***********M2SCR3****ORNE *BLANK                                    E29942
     C***********M3SCR4****ORNE *BLANK                                    E29942
     C***********M3SCR5****ORNE *BLANK                                    E29942
     C*********************MOVE OSTAG     M2SCTT                          E29942
     C*********************MOVE X0D25     M2CRL4                          E29942
     C*********************MOVE ':53'     M2TG53                          E29942
     C*********************MOVE ':'       M2COLN                          E29942
     C*********************END                                            E29942
     C***********M2SCR2****IFNE *BLANK                                    E29942
     C***********M2SCR3****ORNE *BLANK                                    E29942
     C***********M3SCR4****ORNE *BLANK                                    E29942
     C***********M3SCR5****ORNE *BLANK                                    E29942
     C*********************MOVE X0D25     M2CRL5                          E29942
     C*********************END                                            E29942
     C***********M2SCR3****IFNE *BLANK                                    E29942
     C***********M3SCR4****ORNE *BLANK                                    E29942
     C***********M3SCR5****ORNE *BLANK                                    E29942
     C*********************MOVE X0D25     M2CRL6                          E29942
     C*********************END                                            E29942
     C***********M3SCR4****IFNE *BLANK                                    E29942
     C***********M3SCR5****ORNE *BLANK                                    E29942
     C*********************MOVE X0D25     M3CRL1                          E29942
     C*********************END                                            E29942
     C***********M3SCR5****IFNE *BLANK                                    E29942
     C*********************MOVE X0D25     M3CRL2                          E29942
     C*********************END                                            E29942
      *                                                                   CFT014
      ** Format Third Reimbursement if it exists.                         CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
      *                                                                   CFT014
     C           OPTRI1    IFNE *BLANKS                                   CFT014
     C           OPTRI2    ORNE *BLANKS                                   CFT014
     C           OPTRI3    ORNE *BLANKS                                   CFT014
     C           OPTRI4    ORNE *BLANKS                                   CFT014
     C           OPTRI5    ORNE *BLANKS                                   CFT014
     C                     MOVELOPTRIT    ISPTP                           CFT014
     C                     MOVELOPTRI1    ISPTY1                          CFT014
     C                     MOVELOPTRI2    ISPTY2                          CFT014
     C                     MOVELOPTRI3    ISPTY3                          CFT014
     C                     MOVELOPTRI4    ISPTY4                          CFT014
     C                     MOVELOPTRI5    ISPTY5                          CFT014
     C                     MOVEL*BLANKS   ISCCY                           CFT014
     C                     MOVEL'A'       IVTAG1                          CFT014
     C                     MOVEL'B'       IVTAG2                          CFT014
     C                     MOVEL'D'       IVTAG3                          CFT014
     C                     MOVE *OFF      *IN20                           CFT014
     C                     MOVE 'Y'       W201IN                                              CSW201
     C                     EXSR SR01                                      CFT014
     C                     MOVE 'N'       W201IN                                              CSW201
     C                     MOVELOFSPT1    WTRI1                           CFT014
     C                     MOVELOFSPT2    WTRI2                           CFT014
     C                     MOVELOFSPT3    WTRI3                           CFT014
     C                     MOVELOFSPT4    WTRI4                           CFT014
     C                     MOVELOFSPT5    WTRI5                           CFT014
     C                     MOVE OSTAG     WTRITG                          CFT014
     C                     MOVE 'Y'       WTRIOK                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C*
     C*  SETUP PARAMETERS AND EXECUTE SR01 TO
     C*  FORMAT THE RECEIVERS CORRESPONDENT
     C                     MOVELRCRT      ISPTP
     C                     MOVELRCO1      ISPTY1
     C                     MOVELRCO2      ISPTY2
     C                     MOVELRCO3      ISPTY3
     C                     MOVELRCO4      ISPTY4
     C                     MOVELRCO5      ISPTY5
     C                     MOVE PCCY      ISCCY
     C                     MOVE 'A'       IVTAG1            TAG IND 1
     C                     MOVE 'B'       IVTAG2            TAG IND 2
     C                     MOVE 'D'       IVTAG3            TAG IND 3
      *                                                                   S01310
      ** Set off destination indicator                                    S01310
      *                                                                   S01310
     C                     SETOF                     20                   S01310
     C                     MOVE 'Y'       W201IN  1                                           CSW201
      *                                                                   S01310
     C                     EXSR SR01
     C                     MOVE 'N'       W201IN                                              CSW201
     C*                                                                   E21471
     C** DISPLAY CHAPS CODE.                                              E21471
     C*                                                                   E21471
     C           STMT      IFEQ 10                         B001           E21471
     C           CHAP      ANDNE0                                         E21471
     C           OSTAG     ANDNE'D'                                       E21471
     C           OFSPT1    ANDNE*BLANK                                    E21471
     C                     MOVE OFSPT4    OFSPT5                          E21471
     C                     MOVE OFSPT3    OFSPT4                          E21471
     C                     MOVE OFSPT2    OFSPT3                          E21471
     C                     MOVELOFSPT1    OFSPT2                          E21471
     C                     MOVE *BLANK    OFSPT1                          E21471
     C                     MOVEL'//SC'    @CHAP  10                       E21471
     C                     MOVE CHAP      @CHAP                           E21471
     C                     MOVEL@CHAP     OFSPT1                          E21471
     C                     END                             E001           E21471
     C*                                                                   E21471
     C* ** MOVE FORMATTED RECEIVERS CORR. FIELDS INTO DATA STRUCTRE**
     C*********************MOVE OSTAG     OSTOR   1                       S01310
     C                     MOVEL*BLANKS   ##RCB  11                       140639
     C                     EXSR SRRCB                                     140639
     C           ##RCB     IFNE *BLANKS                                   140639
     C           WTRIOK    OREQ 'Y'                                       CFT014
      *                                                                   CFT014
     C                     MOVELOFSPT1    P1IBK1                          140639
     C                     MOVELOFSPT2    P1IBK2                          140639
     C                     MOVELOFSPT3    P1IBK3                          140639
     C                     MOVELOFSPT4    P1IBK4                          140639
     C                     MOVELOFSPT5    P1IBK5                          140639
     C                     MOVE OSTAG     P1IBKT                          140639
     C*                                                                   140639
     C           WTRIOK    IFEQ 'Y'                                       CFT014
     C                     MOVELWTRI1     M5AWB1                          CFT014
     C                     MOVELWTRI2     M5AWB2                          CFT014
     C                     MOVELWTRI3     M5AWB3                          CFT014
     C                     MOVELWTRI4     M5AWB4                          CFT014
     C                     MOVELWTRI5     M5AWB5                          CFT014
     C                     MOVE WTRITG    M5ABTT                          CFT014
     C                     ELSE                                           CFT014
     C                     MOVEL##RCB     M5AWB1                          140639
     C                     MOVEL*BLANKS   M5AWB2                          140639
     C                     MOVEL*BLANKS   M5AWB3                          140639
     C                     MOVEL*BLANKS   M5AWB4                          140639
     C                     MOVEL*BLANKS   M5AWB5                          140639
     C                     MOVE 'A'       M5ABTT                          140639
      *                                                                                       CSW201
      ** If CSW201 is installed, check if BIC is a BEI.                                       CSW201
      *                                                                                       CSW201
     C           CSW201    IFEQ 'Y'                                                           CSW201
      *                                                                                       CSW201
     C                     MOVEL##RCB     W9BICC                                              CSW201
     C                     MOVE ##RCB     W9BICB                                              CSW201
      *                                                                                       CSW201
     C                     CALL 'ME1400'                                                      CSW201
     C                     PARM *BLANKS   W9RTN                                               CSW201
     C                     PARM           W9BICC                                              CSW201
     C                     PARM           W9BICB                                              CSW201
     C                     PARM           SDCUST                                              CSW201
     C                     PARM           SDCNST                                              CSW201
     C                     PARM           MEBICD                                              CSW201
     C                     PARM *BLANKS   W9CUST                                              CSW201
     C                     PARM *BLANKS   W9CNST                                              CSW201
     C                     PARM *BLANKS   W9BICD                                              CSW201
      *                                                                                       CSW202
      ** If SWIFT 2002 is on, determine if BIC is a BEI via AOBEISR0.                         CSW202
      *                                                                                       CSW202
     C           CSW202    IFEQ 'Y'                                                           CSW202
     C           W9BICD    ANDEQ'Y'                                                           CSW202
     C                     CALL 'AOBEISR0'                                                    CSW202
     C                     PARM *BLANKS   PRTCD   7                                           CSW202
     C                     PARM '*VERIFY' POPTN   7                                           CSW202
     C                     PARM BDSUBT    PBICD   4                                           CSW202
     C           MEBEIS    PARM MEBEIS    DSFDY                                               CSW202
     C                     ENDIF                                                              CSW202
      *                                                                                       CSW201
      ** Format to :57D (Address) if BEI                                                      CSW201
      *                                                                                       CSW201
     C           W9RTN     IFEQ *BLANKS                                                       CSW201
     C           W9BICD    ANDEQ'Y'                                                           CSW201
     C           BDSUBT    ANDEQ'BEID'                                                        CSW201
     C           CSW202    ANDEQ'N'                                                           CSW202
      *                                                                                       CSW201
     C           W9RTN     OREQ *BLANKS                                                       CSW201
     C           W9BICD    ANDEQ'Y'                                                           CSW201
     C           BDSUBT    ANDEQ'TRCO'                                                        CSW201
     C           CSW202    ANDEQ'N'                                                           CSW202
      *                                                                                       CSW202
     C           W9BICD    OREQ 'Y'                                                           CSW202
     C           CSW202    ANDEQ'Y'                                                           CSW202
     C           PRTCD     ANDEQ*BLANKS                                                       CSW202
      *                                                                                       CSW201
     C                     MOVE 'D'       M5ABTT                                              CSW201
     C           W9CNST    IFEQ 'Y'                                                           CSW201
     C                     MOVELAWCPNM    M5AWB1                                              CSW201
     C                     MOVELAWCNTN    M5AWB2                                              CSW201
     C                     ENDIF                                                              CSW201
     C           W9CUST    IFEQ 'Y'                                                           CSW201
     C                     MOVELBBCNA1    M5AWB1                                              CSW201
     C                     MOVELBBCNA2    M5AWB2                                              CSW201
     C                     MOVELBBCNA3    M5AWB3                                              CSW201
     C                     MOVELBBCNA4    M5AWB4                                              CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C                     ENDIF                                                              CSW201
     C                     ENDIF                                                              CSW201
     C                     ENDIF                                          CFT014
     C*                                                                   140639
     C                     ELSE                                           140639
     C                     MOVELOFSPT1    M5AWB1
     C                     MOVELOFSPT2    M5AWB2
     C                     MOVELOFSPT3    M5AWB3
     C                     MOVELOFSPT4    M5AWB4
     C                     MOVELOFSPT5    M5AWB5
     C                     MOVE OSTAG     M5ABTT
     C                     ENDIF                                          140639
      *                                                                   S01310
      **  Set up field :57: (account/with bank)                           S01310
      *                                                                   S01310
      *                                                                   CSW096
      * Check for /RCB/ existence in Bank to Bank                         CSW096
      *                                                                   CSW096
     C*****                MOVEL*BLANKS   ##RCB  11             CSW096    140639
     C*****                EXSR SRRCB                           CSW096    140639
      *                                                                   CSW096
      * If /RCB/ then quote receiver in field 56                          CSW096
      * else as per normal in 57                                          CSW096
      *                                                                   CSW096
     C           ##RCB     IFEQ *BLANKS                                   CSW096
     C                     MOVEL':57'     @MTAG   5                       S01310
     C                     ELSE                                           CSW096
     C                     MOVEL':56'     @MTAG                           CSW096
     C                     ENDIF                                          CSW096
      *                                                                   CFT014
      ** Output Receiver's Correspondent on field 56 if Third Reim-       CFT014
      ** bursement Institution was enetered.                              CFT014
     C           WTRIOK    IFEQ 'Y'                                       CFT014
     C                     MOVEL':56'     @MTAG                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CSW096
     C                     EXSR PARTY                                     S01310
      *                                                                   CSW096
      * If /RCB/ then place contents in 57                                CSW096
      *                                                                   CSW096
     C           WTRIOK    IFEQ 'Y'                                       CFT014
      *                                                                   CFT014
      ** If Third Reimbursement exists, use it instead of /RCB/.          CFT014
     C                     MOVEL':57'     @MTAG                           CFT014
     C                     MOVELWTRI1     OFSPT1                          CFT014
     C                     MOVELWTRI2     OFSPT2                          CFT014
     C                     MOVELWTRI3     OFSPT3                          CFT014
     C                     MOVELWTRI4     OFSPT4                          CFT014
     C                     MOVELWTRI5     OFSPT5                          CFT014
     C                     MOVE WTRITG    OSTAG                           CFT014
     C                     EXSR PARTY                                     CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C           ##RCB     IFNE *BLANKS                                   CSW096
      *                                                                   CSW096
      * Set up fields for call to PARTY                                   CSW096
      *                                                                   CSW096
     C                     MOVEL':57'     @MTAG                           CSW096
     C                     MOVEL'A'       OSTAG                           CSW096
     C                     MOVEL##RCB     OFSPT1                          CSW096
     C                     MOVEL*BLANKS   OFSPT2                          CSW096
     C                     MOVEL*BLANKS   OFSPT3                          CSW096
     C                     MOVEL*BLANKS   OFSPT4                          CSW096
     C                     MOVEL*BLANKS   OFSPT5                          CSW096
      *                                                                                       CSW201
      ** If CSW201 is installed, BIC must not be a BEI.                                       CSW201
      *                                                                                       CSW201
     C           CSW201    IFEQ 'Y'                                                           CSW201
      *                                                                                       CSW201
     C           W9RTN     IFEQ *BLANKS                                                       CSW201
     C           W9BICD    ANDEQ'Y'                                                           CSW201
     C           BDSUBT    ANDEQ'BEID'                                                        CSW201
     C           CSW202    ANDEQ'N'                                                           CSW202
      *                                                                                       CSW201
     C           W9RTN     OREQ *BLANKS                                                       CSW201
     C           W9BICD    ANDEQ'Y'                                                           CSW201
     C           BDSUBT    ANDEQ'TRCO'                                                        CSW201
     C           CSW202    ANDEQ'N'                                                           CSW202
      *                                                                                       CSW202
     C           W9BICD    OREQ 'Y'                                                           CSW202
     C           CSW202    ANDEQ'Y'                                                           CSW202
     C           PRTCD     ANDEQ*BLANKS                                                       CSW202
      *                                                                                       CSW201
     C                     MOVE 'D'       OSTAG                                               CSW201
      *                                                                                       CSW201
     C           W9CNST    IFEQ 'Y'                                                           CSW201
     C                     MOVELM5AWB1    OFSPT1                                              CSW201
     C                     MOVELM5AWB2    OFSPT2                                              CSW201
     C                     ENDIF                                                              CSW201
     C           W9CUST    IFEQ 'Y'                                                           CSW201
     C                     MOVELM5AWB1    OFSPT1                                              CSW201
     C                     MOVELM5AWB2    OFSPT2                                              CSW201
     C                     MOVELM5AWB3    OFSPT3                                              CSW201
     C                     MOVELM5AWB4    OFSPT4                                              CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C                     ENDIF                                                              CSW201
     C                     ENDIF                                                              CSW201
      *                                                                   CSW096
     C                     EXSR PARTY                                     CSW096
      *                                                                   CSW096
     C                     ENDIF                                          CSW096
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   S01310
     C*********************MOVEL*BLANK    M3RCR1                          E29942
     C*********************MOVEL*BLANK    M3RCR2                          E29942
     C*********************MOVEL*BLANK    M3RCR3                          E29942
     C*********************MOVEL*BLANK    M3RCR4                          E29942
     C*********************MOVEL*BLANK    M4RCR5                          E29942
     C***********M3RCR1****IFNE *BLANK                                    E29942
     C***********M3RCR2****ORNE *BLANK                                    E29942
     C***********M3RCR3****ORNE *BLANK                                    E29942
     C***********M3RCR4****ORNE *BLANK                                    E29942
     C***********M4RCR5****ORNE *BLANK                                    E29942
     C*********************MOVE OSTAG     M3RCTT                          E29942
     C*********************MOVE ':54'     M3TG54                          E29942
     C*********************MOVE ':'       M3COLN                          E29942
     C*********************MOVE X0D25     M3CRL3                          E29942
     C*********************END                                            E29942
     C***********M3RCR2****IFNE *BLANK                                    E29942
     C***********M3RCR3****ORNE *BLANK                                    E29942
     C***********M3RCR4****ORNE *BLANK                                    E29942
     C***********M4RCR5****ORNE *BLANK                                    E29942
     C*********************MOVE X0D25     M3CRL4                          E29942
     C*********************END                                            E29942
     C***********M3RCR3****IFNE *BLANK                                    E29942
     C***********M3RCR4****ORNE *BLANK                                    E29942
     C***********M4RCR5****ORNE *BLANK                                    E29942
     C*********************MOVE X0D25     M3CRL5                          E29942
     C*********************END                                            E29942
     C***********M3RCR4****IFNE *BLANK                                    E29942
     C***********M4RCR5****ORNE *BLANK                                    E29942
     C*********************MOVE X0D25     M3CRL6                          E29942
     C*********************END                                            E29942
     C***********M4RCR5****IFNE *BLANK                                    E29942
     C*********************MOVE X0D25     M4CRL1                          E29942
     C*********************END                                            E29942
     C*********************                                               E29942
     C*********************MOVE *BLANKS   M4INBT                          E29942
     C*********************MOVE X0D25     M4CRL2                          E29942
     C*********************MOVE ':56'     M4TG56                          E29942
     C*********************MOVE ':'       M4CLN1                          E29942
     C*********************MOVE *BLANKS   M4INB1                          E29942
     C*********************MOVE *BLANKS   M4INB2                          E29942
     C*********************MOVE *BLANKS   M4INB3                          E29942
     C*********************MOVE *BLANKS   M4INB4                          E29942
     C*********************MOVE *BLANKS   M4INB5                          E29942
     C***********M5AWB1****IFNE *BLANK                                    S01310
     C***********M5AWB2****ORNE *BLANK                                    S01310
     C***********M5AWB3****ORNE *BLANK                                    S01310
     C***********M5AWB4****ORNE *BLANK                                    S01310
     C***********M5AWB5****ORNE *BLANK                                    S01310
     C*********************MOVE OSTOR     M5ABTT                          S01310
     C*********************MOVE ':57'     M5TG57                          S01310
     C*********************MOVE ':'       M5CLN1                          S01310
     C*********************MOVE X0D25     M5CRL1                          S01310
     C*********************END                                            S01310
     C***********M5AWB2****IFNE *BLANK                                    S01310
     C***********M5AWB3****ORNE *BLANK                                    S01310
     C***********M5AWB4****ORNE *BLANK                                    S01310
     C***********M5AWB5****ORNE *BLANK                                    S01310
     C*********************MOVE X0D25     M5CRL2                          S01310
     C*********************END                                            S01310
     C***********M5AWB3****IFNE *BLANK                                    S01310
     C***********M5AWB4****ORNE *BLANK                                    S01310
     C***********M5AWB5****ORNE *BLANK                                    S01310
     C*********************MOVE X0D25     M5CRL3                          S01310
     C*********************END                                            S01310
     C***********M5AWB4****IFNE *BLANK                                    S01310
     C***********M5AWB5****ORNE *BLANK                                    S01310
     C*********************MOVE X0D25     M5CRL4                          S01310
     C*********************END                                            S01310
     C***********M5AWB5****IFNE *BLANK                                    S01310
     C*********************MOVE X0D25     M5CRL5                          S01310
     C*********************END                                            S01310
     C/COPY WNCPYSRC,FTH00022
     C*
     C*  SETUP PARAMETERS AND EXECUTE SR01 TO
     C*  FORMAT THE BENEFICIARY  BANK
     C                     MOVELDSTT      ISPTP
     C                     MOVELDST1      ISPTY1
     C                     MOVELDST2      ISPTY2
     C                     MOVELDST3      ISPTY3
     C                     MOVELDST4      ISPTY4
     C                     MOVEL*BLANK    ISPTY5
     C                     MOVE PCCY      ISCCY
     C                     MOVE 'A'       IVTAG1            TAG IND 1
     C                     MOVE ' '       IVTAG2            TAG IND 2
     C                     MOVE 'D'       IVTAG3            TAG IND 3
     C                     MOVE 'Y'       W201IN                                              CSW201
     C                     EXSR SR01
     C                     MOVE 'N'       W201IN                                              CSW201
     C*                                                                   E21471
     C** DISPLAY CHAPS CODE.                                              E21471
     C*                                                                   E21471
     C           STMT      IFEQ 10                         B001           E21471
     C           CHAP      ANDNE0                                         E21471
     C           OSTAG     ANDNE'D'                                       E21471
     C           OFSPT1    ANDEQ*BLANK                                    E21471
     C                     MOVE OFSPT4    OFSPT5                          E21471
     C                     MOVE OFSPT3    OFSPT4                          E21471
     C                     MOVE OFSPT2    OFSPT3                          E21471
     C                     MOVELOFSPT1    OFSPT2                          E21471
     C                     MOVE *BLANK    OFSPT1                          E21471
     C                     MOVEL'//SC'    @CHAP  10                       E21471
     C                     MOVE CHAP      @CHAP                           E21471
     C                     MOVEL@CHAP     OFSPT1                          E21471
     C                     END                             E001           E21471
     C*                                                                   E21471
     C* ** MOVE FORMATTED BENEFICIARY  BANK FIELDS INTO DATA STRUCTRE**
     C/COPY WNCPYSRC,FT0648C004
     C                     MOVELOFSPT1    M5BBK1
     C                     MOVELOFSPT2    M6BBK2
     C                     MOVELOFSPT3    M6BBK3
     C                     MOVELOFSPT4    M6BBK4
     C                     MOVELOFSPT5    M6BBK5
     C                     MOVE OSTAG     M5BBTT
     C                     MOVELOFSPT1    NWBN                            S01310
     C/COPY WNCPYSRC,FT0648C011
      *                                                                   S01310
      **  Set up field :58: (beneficiary)                                 S01310
      *                                                                   S01310
     C                     MOVEL':58'     @MTAG   5                       S01310
     C                     EXSR PARTY                                     S01310
      *                                                                   S01310
     C***********M5BBK1****IFNE *BLANK                                    S01310
     C***********M6BBK2****ORNE *BLANK                                    S01310
     C***********M6BBK3****ORNE *BLANK                                    S01310
     C***********M6BBK4****ORNE *BLANK                                    S01310
     C***********M6BBK5****ORNE *BLANK                                    S01310
     C*********************MOVE OSTAG     M5BBTT                          S01310
     C*********************MOVE X0D25     M5CRL6                          S01310
     C*********************MOVE ':58'     M5TG58                          S01310
     C*********************MOVE ':'       M5CLN2                          S01310
     C*********************END                                            S01310
     C***********M6BBK2****IFNE *BLANK                                    S01310
     C***********M6BBK3****ORNE *BLANK                                    S01310
     C***********M6BBK4****ORNE *BLANK                                    S01310
     C***********M6BBK5****ORNE *BLANK                                    S01310
     C*********************MOVE X0D25     M6CRL1                          S01310
     C*********************END                                            S01310
     C***********M6BBK3****IFNE *BLANK                                    S01310
     C***********M6BBK4****ORNE *BLANK                                    S01310
     C***********M6BBK5****ORNE *BLANK                                    S01310
     C*********************MOVE X0D25     M6CRL2                          S01310
     C*********************END                                            S01310
     C***********M6BBK4****IFNE *BLANK                                    S01310
     C***********M6BBK5****ORNE *BLANK                                    S01310
     C*********************MOVE X0D25     M6CRL3                          S01310
     C*********************END                                            S01310
     C***********M6BBK5****IFNE *BLANK                                    S01310
     C*********************MOVE X0D25     M6CRL4                          S01310
     C*********************END                                            S01310
     C*
     C*****MOVE*BANK*TO*BANK INFOS INTO DATA STRUCTURE **                 E29942
     C*********************MOVE *BLANK    M6BTB1                          E29942
     C*********************MOVE *BLANK    M6BTB2                          E29942
     C*********************MOVE *BLANK    M7BTB3                          E29942
     C*********************MOVE *BLANK    M7BTB4                          E29942
     C*********************MOVE *BLANK    M7BTB5                          E29942
     C*********************MOVE *BLANK    M7BTB6                          E29942
     C*********************                                               E29942
     C*********************                                               E29942
     C***********M6BTB1****IFNE *BLANK                                    E29942
     C***********M6BTB2****ORNE *BLANK                                    E29942
     C***********M7BTB3****ORNE *BLANK                                    E29942
     C***********M7BTB4****ORNE *BLANK                                    E29942
     C***********M7BTB5****ORNE *BLANK                                    E29942
     C***********M7BTB6****ORNE *BLANK                                    E29942
     C*********************MOVE ':72:'    M6TG72                          E29942
     C*********************MOVE X0D25     M6CRL5                          E29942
     C*********************END                                            E29942
     C***********M6BTB2****IFNE *BLANK                                    E29942
     C***********M7BTB3****ORNE *BLANK                                    E29942
     C***********M7BTB4****ORNE *BLANK                                    E29942
     C***********M7BTB5****ORNE *BLANK                                    E29942
     C***********M7BTB6****ORNE *BLANK                                    E29942
     C*********************MOVE X0D25     M6CRL6                          E29942
     C*********************END                                            E29942
     C***********M7BTB3****IFNE *BLANK                                    E29942
     C***********M7BTB4****ORNE *BLANK                                    E29942
     C***********M7BTB5****ORNE *BLANK                                    E29942
     C***********M7BTB6****ORNE *BLANK                                    E29942
     C*********************MOVE X0D25     M7CRL1                          E29942
     C*********************END                                            E29942
     C***********M7BTB4****IFNE *BLANK                                    E29942
     C***********M7BTB5****ORNE *BLANK                                    E29942
     C***********M7BTB6****ORNE *BLANK                                    E29942
     C*********************MOVE X0D25     M7CRL2                          E29942
     C*********************END                                            E29942
     C***********M7BTB5****IFNE *BLANK                                    E29942
     C***********M7BTB6****ORNE *BLANK                                    E29942
     C*********************MOVE X0D25     M7CRL3                          E29942
     C*********************END                                            E29942
     C***********M7BTB6****IFNE *BLANK                                    E29942
     C*********************MOVE X0D25     M7CRL4                          E29942
     C*********************END                                            E29942
     C*********************                                               S01310
     C**FIELD*21*SHOULD*HAVE THE SAME REFERENCE AS FIELD 20 ON THE        S01310
     C**ORIGINAL*MT100/MT202, SO LUX39 FIX IS NOT QUITE RIGHT.            S01310
     C*********************MOVELRLPR      M1RTRT                          S01310
     C*********************MOVELPREF      M1RTRT                          S01310
     C*********************MOVELPREF      M1RREF                          S01310
     C***FORMAT*THE*AMOUNT*                                               S01310
     C*********************EXSR SR06                                      S01310
     C*********************MOVEASAM       FAMT                            S01310
     C*********************Z-ADD1         S       30                      S01310
     C***********FAMT,S****DOWEQ' '                                       S01310
     C*********************ADD  1         S                               S01310
     C*********************END                                            S01310
     C*********************MOVEAFAMT,S    M1AMNT                          S01310
      *                                                                   S01310
      ** Output correctly generated message to PF/MGOMSGPD and write      S01310
      ** reference record to PF/MGOREFPD.                                 S01310
      *                                                                   S01310
     C*                                                                   S01408
      *                                                                                       CSW209
      ** Format COV details                                                                   CSW209
      *                                                                                       CSW209
     C           CSW209    IFEQ 'Y'                                                           CSW209
      *                                                                                       CSW209
      **  Set up Sender to Receiver Information Cover A                                       CSW209
      *                                                                                       CSW209
     C           OPOCB1    IFNE *BLANKS                                                       CSW209
     C           OPOCB2    ORNE *BLANKS                                                       CSW209
     C           OPOCB3    ORNE *BLANKS                                                       CSW209
     C           OPOCB4    ORNE *BLANKS                                                       CSW209
     C           OPOCB5    ORNE *BLANKS                                                       CSW209
     C           OPOCB6    ORNE *BLANKS                                                     BUG24491
      *                                                                                       CSW209
     C           OPOCB1    IFNE *BLANKS                                                       CSW209
     C                     ADD  1         M                                                   CSW209
     C           M         OCUR MULT                                                          CSW209
     C                     MOVEL':72: '   MTAG                                                CSW209
     C                     MOVELOPOCB1    MFLD                                                CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C           OPOCB2    IFNE *BLANKS                                                       CSW209
     C                     ADD  1         M                                                   CSW209
     C           M         OCUR MULT                                                          CSW209
     C                     MOVELOPOCB2    MFLD                                                CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C           OPOCB3    IFNE *BLANKS                                                       CSW209
     C                     ADD  1         M                                                   CSW209
     C           M         OCUR MULT                                                          CSW209
     C                     MOVELOPOCB3    MFLD                                                CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C           OPOCB4    IFNE *BLANKS                                                       CSW209
     C                     ADD  1         M                                                   CSW209
     C           M         OCUR MULT                                                          CSW209
     C                     MOVELOPOCB4    MFLD                                                CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C           OPOCB5    IFNE *BLANKS                                                       CSW209
     C                     ADD  1         M                                                   CSW209
     C           M         OCUR MULT                                                          CSW209
     C                     MOVELOPOCB5    MFLD                                                CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C           OPOCB6    IFNE *BLANKS                                                       CSW209
     C                     ADD  1         M                                                   CSW209
     C           M         OCUR MULT                                                          CSW209
     C                     MOVELOPOCB6    MFLD                                                CSW209
     C                     ENDIF                                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C           *IN35     IFEQ '1'                                                           CSW209
      *                                                                                       CSW209
      ** Initialise fields for FT0648P1                                                       CSW209
      *                                                                                       CSW209
     C                     MOVEL*BLANKS   P1COC1                                              CSW209
     C                     MOVEL*BLANKS   P1COC2                                              CSW209
     C                     MOVEL*BLANKS   P1COC3                                              CSW209
     C                     MOVEL*BLANKS   P1COC4                                              CSW209
     C                     MOVEL*BLANKS   P1COC5                                              CSW209
     C                     MOVEL*BLANKS   P1COB1                                              CSW209
     C                     MOVEL*BLANKS   P1COB2                                              CSW209
     C                     MOVEL*BLANKS   P1COB3                                              CSW209
     C                     MOVEL*BLANKS   P1COB4                                              CSW209
     C                     MOVEL*BLANKS   P1COB5                                              CSW209
     C                     MOVEL*BLANKS   P1CIB1                                              CSW209
     C                     MOVEL*BLANKS   P1CIB2                                              CSW209
     C                     MOVEL*BLANKS   P1CIB3                                              CSW209
     C                     MOVEL*BLANKS   P1CIB4                                              CSW209
     C                     MOVEL*BLANKS   P1CIB5                                              CSW209
     C                     MOVEL*BLANKS   P1CAB1                                              CSW209
     C                     MOVEL*BLANKS   P1CAB2                                              CSW209
     C                     MOVEL*BLANKS   P1CAB3                                              CSW209
     C                     MOVEL*BLANKS   P1CAB4                                              CSW209
     C                     MOVEL*BLANKS   P1CAB5                                              CSW209
     C                     MOVEL*BLANKS   P1CBC1                                              CSW209
     C                     MOVEL*BLANKS   P1CBC2                                              CSW209
     C                     MOVEL*BLANKS   P1CBC3                                              CSW209
     C                     MOVEL*BLANKS   P1CBC4                                              CSW209
     C                     MOVEL*BLANKS   P1CBC5                                              CSW209
     C                     MOVEL*BLANKS   P1CDP1                                              CSW209
     C                     MOVEL*BLANKS   P1CDP2                                              CSW209
     C                     MOVEL*BLANKS   P1CDP3                                              CSW209
     C                     MOVEL*BLANKS   P1CDP4                                              CSW209
     C                     MOVEL*BLANKS   P1CBB1                                              CSW209
     C                     MOVEL*BLANKS   P1CBB2                                              CSW209
     C                     MOVEL*BLANKS   P1CBB3                                              CSW209
     C                     MOVEL*BLANKS   P1CBB4                                              CSW209
     C                     MOVEL*BLANKS   P1CBB5                                              CSW209
     C                     MOVEL*BLANKS   P1CBB6                                              CSW209
     C                     MOVE *BLANKS   EXTTAG  5                                           CSW209
      *                                                                                       CSW209
     C                     EXSR SRCOV                                                         CSW209
      *                                                                                       CSW209
      ** Update Validation Flag (Cover) to 'COV'                                            BUG24436
      *                                                                                     BUG24436
     C           PREF      CHAINOTPAYXL2             51                                     BUG24436
     C           *IN51     IFEQ *OFF                                                        BUG24436
     C                     MOVEL'COV'     OPOCVF                                            BUG24436
     C                     UPDAT@OPYXL2                                                     BUG24436
     C                     ENDIF                                                            BUG24436
      *                                                                                     BUG24436
     C                     ENDIF                                                              CSW209
     C                     ENDIF                                                              CSW209
     C/COPY WNCPYSRC,FT0648CCP1                                           S01408
     C*                                                                   S01408
     C                     EXSR OMSG                                      S01310
     C*
     C***OUTPUT*SEVEN*RECORDS*TO*THE*OUTGOING*SWIFT*MESSAGES              S01310
     C***FILE*(PF/MSMSOPF)*AND*ONE*RECORD*TO*(PF/MSIXOPF)                 S01310
     C*********************EXSR SR08                                      S01310
     C*
     C*  OUTPUT AN ENTRY TO THE SWIFT MESSAGE REPORT PRTF/FT0648P1     )))
     C*  INCLUDE NARRATIVE 'RECOVERY' IF ROLLBACK INDICATOR
     C*  HAS BEEN SETON IN SUBROUTINE SR08
     C                     EXSR SRP1
     C/COPY WNCPYSRC,FT0648C012
     C*
     C           *IN41     IFEQ '0'
     C                     MOVE 'Y'       OPPARM           MSG PROD FLAG  E32481
     C*****INCREMENT*MESSAGES*COUNT*FIELD*IN*DATAAREA*MSFCTL***********   E21286
     C*****INCREMENT*MESSAGES*COUNT*FIELD*IN*DATAAREA*FTFCTL        E21286S01310
     C**********           EXSR SR11                                      S01310
     C                     END
      *                                                                   E32481
     C                     END                                            E32481
      *                                                                   E32481
     C                     READ PRFP2                    13               E32481
     C                     MOVELPREF      DSPREF                          E32481
      *                                                                   E32481
     C                     END
     C*********************END                                            S01310
     C*****************************
     C*    RECORD READ FROM CQPACDD
     C*****************************
      *                                                                   E32481
     C           *LOVAL    SETLLPRFP2                                     E32481
     C                     READ PRFP2                    13               E32481
     C                     MOVELPREF      DSPREF                          E32481
      *                                                                   E32481
      ** Do While records found on the CQPACDD file.                      E32481
      *                                                                   E32481
     C           *IN13     DOWEQ'0'                                       E32481
     C*
     C/COPY WNCPYSRC,FT0648C027
     C           PAYT      IFEQ 'CP'
     C/COPY WNCPYSRC,FT0648C028
     C                     ADD  1         AUNO2                           S01117
     C*
     C***********PREF******CHAINCQPACDDF             99                   E32481
     C**N99******RECI******COMP 'D'                  9999                 E32481
     C***99****************DO                              B001           E32481
     C*********************MOVE 'CQPAC'   DBFNAM  5         )))  DATA  )))S01310
     C*********************MOVEL'CQPAC'   DBFNAM  8         )))  DATA  )))S01310
     C*********************MOVELPREF      DBERKY 39         )))  BASE  )))E32481
     C*********************MOVE '21'      DBERR#  2         ))) ERROR  )))E32481
     C*********************EXSR DBERR                       )))   21   )))E32481
     C*********************END                             E001           E32481
      *                                                                   E32481
      ** Initialise non-constant fields                                   E32481
      *                                                                   E32481
     C                     EXSR INTF                                      E32481
     C*                                                                   S01117
     C                     EXSR BRANCH                                    S01117
     C*
     C*  SETUP PARAMETERS  AND EXECUTE SR01 TO
     C** DETERMINE SWIFT ADDRESS OF SENDERS CORRESPONDENT
     C*
     C                     MOVELSNCT      ISPTP   1
     C                     MOVELSNCO      ISPTY1 35
     C                     MOVE *BLANKS   ISPTY2 35
     C                     MOVE *BLANKS   ISPTY3 35
     C                     MOVE *BLANKS   ISPTY4 35
     C                     MOVE *BLANKS   ISPTY5 35
     C                     MOVE PCCY      ISCCY   3
     C                     MOVE 'A'       IVTAG1  1
     C                     MOVE ' '       IVTAG2  1
      *                                                                                      260987A
     C           SNCT      IFEQ 'A'                                                          260987A
     C                     MOVE 'D'       IVTAG3  1                                          260987A
     C                     ELSE                                                              260987A
     C                     MOVE ' '       IVTAG3  1
     C                     ENDIF                                                             260987A
      *                                                                   S01310
      **  Seton destination indicator                                     S01310
      *                                                                   S01310
     C                     SETON                     20                   S01310
      *                                                                   S01310
     C                     EXSR SR01
     C*********PARAMETERS*OFSPT1*SHOULD*BE*MOVED*TO********************                      260987A
     C*********FIELD*RECIPIENT*ADDRESS*OF*SWIFT*DATA*STRUCTURE*********                      260987A
     C*********SAVE*IT*AS*IT*WILL*BE*USED*IN*SUBROUTINE*10*&*4.********                      260987A
     C**********           MOVELOFSPT1    RECADD 12                                          260987A
      *                                                                                      260987A
      ** Output same destination to printout as MGOREFPD.                                    260987A
      *                                                                                      260987A
     C                     MOVELNWDS      RECADD 12                                          260987A
     C************                                                        CSW096
     C**IF*BIC*CODE DO NOT OUTPUT TO SWIFT                                CSW096
     C************                                                        CSW096
     C************         MOVE RECADD    WKBIC   4                       CSW096
     C***********WKBIC     IFEQ 'BIC '                                    CSW096
     C************         MOVE 'N'       OSUFLG                          CSW096
     C************         END                                            CSW096
     C*
     C* ****** SAVE CUSTOMER FIELDS TO BE USED IN SUBROUTINE 8.****
     C**********           MOVE CUSTNO    SCUSNO  60                                          CSD027
     C                     MOVE CUSTNO    SCUSNO  6                                           CSD027
     C                     MOVE CTWN      SCTWN  10
     C                     MOVE CRNM      SCRNM  20
     C/COPY WNCPYSRC,FT0648C021
     C*
     C***IF*THE*SWIFT*UNDER*FLAG*=*'N'*FROM*SUBROUTINE*SR01               S01310
     C***THEN*THE*MESSAGE*MUST*BE*SENT*VIA*TELEX                          S01310
     C*
      ** Only do this processing if default network is 'PAPER'            S01310
      *                                                                   S01310
     C           OSUFLG    IFEQ 'N'
     C*********************OPEN FT0648P2                                  E32481
     C*                                                                   S01117
     C* IF MULTIBRANCHING INDICATOR ACTIVE,MOVE BOOKING BRANCH AND        S01117
     C* BRANCH NAME TO THE RELATIVE FIELDS SET UP WITHIN THE PRINTER FILE S01117
     C*                                                                   S01117
     C           *IN50     IFEQ '1'                                       S01117
     C                     MOVE BRCAA     P2BRCA                          S01117
     C                     MOVELBRNM      P2BRNM                          S01117
     C                     END                                            S01117
     C* ****** FORMAT RECEIVING BANK FROM DESTINATION FIELDS ******
     C                     MOVELRBKT      ISPTP
     C                     MOVELRBK1      ISPTY1
     C                     MOVELRBK2      ISPTY2
     C                     MOVELRBK3      ISPTY3
     C                     MOVELRBK4      ISPTY4
     C                     MOVELPCCY      ISCCY
     C*
     C                     EXSR SR05
     C* ****** MOVE FORMATTED RECEIVING BANK FIELDS INTO PRINT LINE**
     C                     MOVELOFSPT1    P2RBK1
     C                     MOVELOFSPT2    P2RBK2
     C                     MOVELOFSPT3    P2RBK3
     C                     MOVELOFSPT4    P2RBK4
     C                     MOVELOFSPT5    P2RBK5
     C*
     C* ****** FORMAT SENDERS CORRESPONDENT          ******
     C                     MOVELSNCT      ISPTP
     C                     MOVELPCCY      ISCCY                           S01435
     C                     MOVELSNCO      ISPTY1
     C                     EXSR SR05
     C* ****** MOVE FORMATTED SENDERS CORRESP. FIELDS INTO **
     C* ****** DESTINATION FIELD PRINT LINE                **
     C                     MOVELOFSPT1    P2DST1
     C                     MOVELOFSPT2    P2DST2
     C                     MOVELOFSPT3    P2DST3
     C                     MOVELOFSPT4    P2DST4
     C                     MOVELOFSPT5    P2DST5
     C*
     C* ****** FORMAT RECEIVERS CORRESPONDENT        ******
     C                     MOVELRCRT      ISPTP
     C                     MOVELPCCY      ISCCY                           S01435
     C                     MOVELRCO1      ISPTY1
     C                     MOVELRCO2      ISPTY2
     C                     MOVELRCO3      ISPTY3
     C                     MOVELRCO4      ISPTY4
     C                     MOVELRCO5      ISPTY5
     C                     EXSR SR05
     C* ****** MOVE FORMATTED RECEIVERS CORR. FIELDS INTO PRINT LINE**
     C                     MOVELOFSPT1    P2RCR1
     C                     MOVELOFSPT2    P2RCR2
     C                     MOVELOFSPT3    P2RCR3
     C                     MOVELOFSPT4    P2RCR4
     C                     MOVELOFSPT5    P2RCR5
     C*
     C* ****** FORMAT ACCOUNT WITH BANK              ******
     C                     MOVELACBT      ISPTP
     C                     MOVELPCCY      ISCCY                           S01435
     C                     MOVELACB1      ISPTY1
     C                     MOVELACB2      ISPTY2
     C                     MOVELACB3      ISPTY3
     C                     MOVELACB4      ISPTY4
     C                     MOVELACB5      ISPTY5
     C                     EXSR SR05
     C* ****** MOVE FORMATTED ACCNT WITH BANK FIELDS INTO PRINT LINE**
     C                     MOVELOFSPT1    P2AWB1
     C                     MOVELOFSPT2    P2AWB2
     C                     MOVELOFSPT3    P2AWB3
     C                     MOVELOFSPT4    P2AWB4
     C                     MOVELOFSPT5    P2AWB5
     C*
     C* ****** MOVE BLANKS INTO PRINT LINE**
     C                     MOVEL*BLANKS   P2BC1
     C                     MOVEL*BLANKS   P2BC2
     C                     MOVEL*BLANKS   P2BC3
     C                     MOVEL*BLANKS   P2BC4
     C                     MOVEL*BLANKS   P2BC5
     C* ****** DETERMINE AMOUNT      ****
     C                     EXSR SR07
     C                     EXSR SRP2                       PRT TELX REPORT
     C*********************ELSE                            SWFT USER FLG=YS01310
     C                     END                                            S01310
     C*********************OPEN FT0648P1                                  E32481
     C*
     C*  INTIALISE AND PRESET FIELDS IN DATA STRUCTURE
     C*  FOR SWIFT MESSAGES TYPE RECORDS
     C                     EXSR SR10
     C*  FORMAT THE AMOUNT                                                S01310
     C                     EXSR SR07                                      S01310
      *                                                                   S01310
      **  Set up field :32A: (date/currency/amount)                       S01310
      *                                                                   S01310
     C                     EXSR FLD32                                     S01310
     C/COPY WNCPYSRC,FT0648C005
      *                                                                   S01310
     C*********************MOVEL*BLANK    M1OBK1                          E29942
     C*********************MOVE *BLANK    M1OBK2                          E29942
     C*********************MOVE *BLANK    M2OBK3                          E29942
     C*********************MOVE *BLANK    M2OBK4                          E29942
     C*********************MOVE *BLANK    M2OBK5                          E29942
     C***********M1OBK1****IFNE *BLANK                                    E29942
     C***********M1OBK2****ORNE *BLANK                                    E29942
     C***********M2OBK3****ORNE *BLANK                                    E29942
     C***********M2OBK4****ORNE *BLANK                                    E29942
     C***********M2OBK5****ORNE *BLANK                                    E29942
     C*********************MOVE OSTAG     M1OBTG                          E29942
     C*********************MOVE ':52'     M1TG52                          E29942
     C*********************MOVE ':'       M1HYPH                          E29942
     C*********************MOVE X0D25     M1CRL9                          E29942
     C*********************END                                            E29942
     C***********M1OBK2****IFNE *BLANK                                    E29942
     C***********M2OBK3****ORNE *BLANK                                    E29942
     C***********M2OBK4****ORNE *BLANK                                    E29942
     C***********M2OBK5****ORNE *BLANK                                    E29942
     C*********************MOVE X0D25     M1CRLA                          E29942
     C*********************END                                            E29942
     C***********M2OBK3****IFNE *BLANK                                    E29942
     C***********M2OBK4****ORNE *BLANK                                    E29942
     C***********M2OBK5****ORNE *BLANK                                    E29942
     C*********************MOVE X0D25     M2CRL1                          E29942
     C*********************END                                            E29942
     C***********M2OBK4****IFNE *BLANK                                    E29942
     C***********M2OBK5****ORNE *BLANK                                    E29942
     C*********************MOVE X0D25     M2CRL2                          E29942
     C*********************END                                            E29942
     C***********M2OBK5****IFNE *BLANK                                    E29942
     C*********************MOVE X0D25     M2CRL3                          E29942
     C*********************END                                            E29942
     C*********************MOVEL*BLANK    M2SCR1                          E29942
     C*********************MOVEL*BLANK    M2SCR2                          E29942
     C*********************MOVEL*BLANK    M2SCR3                          E29942
     C*********************MOVEL*BLANK    M3SCR4                          E29942
     C*********************MOVEL*BLANK    M3SCR5                          E29942
     C***********M2SCR1****IFNE *BLANK                                    E29942
     C***********M2SCR2****ORNE *BLANK                                    E29942
     C***********M2SCR3****ORNE *BLANK                                    E29942
     C***********M3SCR4****ORNE *BLANK                                    E29942
     C***********M3SCR5****ORNE *BLANK                                    E29942
     C*********************MOVE OSTAG     M2SCTT                          E29942
     C*********************MOVE X0D25     M2CRL4                          E29942
     C*********************MOVE ':53'     M2TG53                          E29942
     C*********************MOVE ':'       M2COLN                          E29942
     C*********************END                                            E29942
     C***********M2SCR2****IFNE *BLANK                                    E29942
     C***********M2SCR3****ORNE *BLANK                                    E29942
     C***********M3SCR4****ORNE *BLANK                                    E29942
     C***********M3SCR5****ORNE *BLANK                                    E29942
     C*********************MOVE X0D25     M2CRL5                          E29942
     C*********************END                                            E29942
     C***********M2SCR3****IFNE *BLANK                                    E29942
     C***********M3SCR4****ORNE *BLANK                                    E29942
     C***********M3SCR5****ORNE *BLANK                                    E29942
     C*********************MOVE X0D25     M2CRL6                          E29942
     C*********************END                                            E29942
     C***********M3SCR4****IFNE *BLANK                                    E29942
     C***********M3SCR5****ORNE *BLANK                                    E29942
     C*********************MOVE X0D25     M3CRL1                          E29942
     C*********************END                                            E29942
     C***********M3SCR5****IFNE *BLANK                                    E29942
     C*********************MOVE X0D25     M3CRL2                          E29942
     C*********************END                                            E29942
     C*********************                                               E29942
     C*  SETUP PARAMETERS AND EXECUTE SR01 TO
     C*  FORMAT THE RECEIVERS CORRESPONDENT
     C                     MOVELRCRT      ISPTP
     C                     MOVELRCO1      ISPTY1
     C                     MOVELRCO2      ISPTY2
     C                     MOVELRCO3      ISPTY3
     C                     MOVELRCO4      ISPTY4
     C                     MOVELRCO5      ISPTY5
     C/COPY WNCPYSRC,FTH00320
     C                     MOVE PCCY      ISCCY
     C                     MOVE 'A'       IVTAG1            TAG IND 1
     C                     MOVE 'B'       IVTAG2            TAG IND 2
     C                     MOVE 'D'       IVTAG3            TAG IND 3
      *                                                                   S01310
      ** Set off destination indicator                                    S01310
      *                                                                   S01310
     C                     SETOF                     20                   S01310
     C                     MOVE 'Y'       W201IN                                              CSW201
      *                                                                   S01310
     C                     EXSR SR01
     C                     MOVE 'N'       W201IN                                              CSW201
      *                                                                                       CSW201
     C* ** MOVE FORMATTED RECEIVERS CORR. FIELDS INTO DATA STRUCTRE**
     C*********************MOVE OSTAG     OSTOR   1                       S01310
     C                     MOVELOFSPT1    M5AWB1
     C                     MOVELOFSPT2    M5AWB2
     C                     MOVELOFSPT3    M5AWB3
     C                     MOVELOFSPT4    M5AWB4
     C                     MOVELOFSPT5    M5AWB5
     C                     MOVE OSTAG     M5ABTT
     C*********************MOVEL*BLANK    M3RCR1                          E29942
     C*********************MOVEL*BLANK    M3RCR2                          E29942
     C*********************MOVEL*BLANK    M3RCR3                          E29942
     C*********************MOVEL*BLANK    M3RCR4                          E29942
     C*********************MOVEL*BLANK    M4RCR5                          E29942
     C***********M3RCR1****IFNE *BLANK                                    E29942
     C***********M3RCR2****ORNE *BLANK                                    E29942
     C***********M3RCR3****ORNE *BLANK                                    E29942
     C***********M3RCR4****ORNE *BLANK                                    E29942
     C***********M4RCR5****ORNE *BLANK                                    E29942
     C*********************MOVE OSTAG     M3RCTT                          E29942
     C*********************MOVE ':54'     M3TG54                          E29942
     C*********************MOVE ':'       M3COLN                          E29942
     C*********************MOVE X0D25     M3CRL3                          E29942
     C*********************END                                            E29942
     C***********M3RCR2****IFNE *BLANK                                    E29942
     C***********M3RCR3****ORNE *BLANK                                    E29942
     C***********M3RCR4****ORNE *BLANK                                    E29942
     C***********M4RCR5****ORNE *BLANK                                    E29942
     C*********************MOVE X0D25     M3CRL4                          E29942
     C*********************END                                            E29942
     C***********M3RCR3****IFNE *BLANK                                    E29942
     C***********M3RCR4****ORNE *BLANK                                    E29942
     C***********M4RCR5****ORNE *BLANK                                    E29942
     C*********************MOVE X0D25     M3CRL5                          E29942
     C*********************END                                            E29942
     C***********M3RCR4****IFNE *BLANK                                    E29942
     C***********M4RCR5****ORNE *BLANK                                    E29942
     C*********************MOVE X0D25     M3CRL6                          E29942
     C*********************END                                            E29942
     C***********M4RCR5****IFNE *BLANK                                    E29942
     C*********************MOVE X0D25     M4CRL1                          E29942
     C*********************END                                            E29942
     C*********************                                               E29942
     C*********************MOVE *BLANKS   M4INBT                          E29942
     C*********************MOVE X0D25     M4CRL2                          E29942
     C*********************MOVE ':56'     M4TG56                          E29942
     C*********************MOVE ':'       M4CLN1                          E29942
     C*********************MOVE *BLANKS   M4INB1                          E29942
     C*********************MOVE *BLANKS   M4INB2                          E29942
     C*********************MOVE *BLANKS   M4INB3                          E29942
     C*********************MOVE *BLANKS   M4INB4                          E29942
     C*********************MOVE *BLANKS   M4INB5                          E29942
     C***********M5AWB1****IFNE *BLANK                                    S01310
     C***********M5AWB2****ORNE *BLANK                                    S01310
     C***********M5AWB3****ORNE *BLANK                                    S01310
     C***********M5AWB4****ORNE *BLANK                                    S01310
     C***********M5AWB5****ORNE *BLANK                                    S01310
     C*********************MOVE OSTOR     M5ABTT                          S01310
     C*********************MOVE ':57'     M5TG57                          S01310
     C*********************MOVE ':'       M5CLN1                          S01310
     C*********************MOVE X0D25     M5CRL1                          S01310
     C*********************END                                            S01310
     C***********M5AWB2****IFNE *BLANK                                    S01310
     C***********M5AWB3****ORNE *BLANK                                    S01310
     C***********M5AWB4****ORNE *BLANK                                    S01310
     C***********M5AWB5****ORNE *BLANK                                    S01310
     C*********************MOVE X0D25     M5CRL2                          S01310
     C*********************END                                            S01310
     C***********M5AWB3****IFNE *BLANK                                    S01310
     C***********M5AWB4****ORNE *BLANK                                    S01310
     C***********M5AWB5****ORNE *BLANK                                    S01310
     C*********************MOVE X0D25     M5CRL3                          S01310
     C*********************END                                            S01310
     C***********M5AWB4****IFNE *BLANK                                    S01310
     C***********M5AWB5****ORNE *BLANK                                    S01310
     C*********************MOVE X0D25     M5CRL4                          S01310
     C*********************END                                            S01310
     C***********M5AWB5****IFNE *BLANK                                    S01310
     C*********************MOVE X0D25     M5CRL5                          S01310
     C*********************END                                            S01310
      *                                                                   S01310
      **  Set up field :57: (account/with bank)                           S01310
      *                                                                   S01310
     C                     MOVEL':57'     @MTAG   5                       S01310
     C                     EXSR PARTY                                     S01310
     C*
     C*  SETUP PARAMETERS AND EXECUTE SR01 TO
     C*  FORMAT THE BENEFICIARY  BANK
     C*                                                                   E24916
     C** IF THE ACCOUNT WITH BANK IS INPUT THEN USE IT ELSE REMITTING BANKE24916
     C*                                                                   E24916
     C           ACB1      IFEQ *BLANKS                                   E24916
     C           ACB2      ANDEQ*BLANKS                                   E24916
     C           ACB3      ANDEQ*BLANKS                                   E24916
     C           ACB4      ANDEQ*BLANKS                                   E24916
     C           ACB5      ANDEQ*BLANKS                                   E24916
     C                     MOVELRBKT      ISPTP
     C                     MOVELRBK1      ISPTY1
     C                     MOVELRBK2      ISPTY2
     C                     MOVELRBK3      ISPTY3
     C                     MOVELRBK4      ISPTY4
     C                     MOVEL*BLANK    ISPTY5
     C                     ELSE                                           E24916
     C                     MOVELACBT      ISPTP                           E24916
     C                     MOVELACB1      ISPTY1                          E24916
     C                     MOVELACB2      ISPTY2                          E24916
     C                     MOVELACB3      ISPTY3                          E24916
     C                     MOVELACB4      ISPTY4                          E24916
     C                     MOVELACB5      ISPTY5                          E24916
     C                     END                                            E24916
     C                     MOVE PCCY      ISCCY
     C                     MOVE 'A'       IVTAG1            TAG IND 1
     C                     MOVE ' '       IVTAG2            TAG IND 2
     C                     MOVE 'D'       IVTAG3            TAG IND 3
     C                     MOVE 'Y'       W201IN                                              CSW201
     C                     EXSR SR01
     C                     MOVE 'N'       W201IN                                              CSW201
      *                                                                                       CSW201
     C* ** MOVE FORMATTED BENEFICIARY  BANK FIELDS INTO DATA STRUCTRE**
     C/COPY WNCPYSRC,FT0648C006
     C                     MOVELOFSPT1    M5BBK1
     C                     MOVELOFSPT2    M6BBK2
     C                     MOVELOFSPT3    M6BBK3
     C                     MOVELOFSPT4    M6BBK4
     C                     MOVELOFSPT5    M6BBK5
     C                     MOVE OSTAG     M5BBTT
     C/COPY WNCPYSRC,FT0648C013
      *                                                                   S01310
      **  Set up field :58: (beneficiary)                                 S01310
      *                                                                   S01310
     C                     MOVEL':58'     @MTAG   5                       S01310
     C                     EXSR PARTY                                     S01310
     C/COPY WNCPYSRC,FT0648C007
      *                                                                   S01310
     C***********M5BBK1****IFNE *BLANK                                    S01310
     C***********M6BBK2****ORNE *BLANK                                    S01310
     C***********M6BBK3****ORNE *BLANK                                    S01310
     C***********M6BBK4****ORNE *BLANK                                    S01310
     C***********M6BBK5****ORNE *BLANK                                    S01310
     C*********************MOVE OSTAG     M5BBTT                          S01310
     C*********************MOVE X0D25     M5CRL6                          S01310
     C*********************MOVE ':58'     M5TG58                          S01310
     C*********************MOVE ':'       M5CLN2                          S01310
     C*********************END                                            S01310
     C***********M6BBK2****IFNE *BLANK                                    S01310
     C***********M6BBK3****ORNE *BLANK                                    S01310
     C***********M6BBK4****ORNE *BLANK                                    S01310
     C***********M6BBK5****ORNE *BLANK                                    S01310
     C*********************MOVE X0D25     M6CRL1                          S01310
     C*********************END                                            S01310
     C***********M6BBK3****IFNE *BLANK                                    S01310
     C***********M6BBK4****ORNE *BLANK                                    S01310
     C***********M6BBK5****ORNE *BLANK                                    S01310
     C*********************MOVE X0D25     M6CRL2                          S01310
     C*********************END                                            S01310
     C***********M6BBK4****IFNE *BLANK                                    S01310
     C***********M6BBK5****ORNE *BLANK                                    S01310
     C*********************MOVE X0D25     M6CRL3                          S01310
     C*********************END                                            S01310
     C***********M6BBK5****IFNE *BLANK                                    S01310
     C*********************MOVE X0D25     M6CRL4                          S01310
     C*********************END                                            S01310
     C*********************                                               E29942
     C*****MOVE*BANK*TO*BANK INFOS INTO DATA STRUCTURE **                 E29942
     C*********************MOVE *BLANK    M6BTB1                          E29942
     C*********************MOVE *BLANK    M6BTB2                          E29942
     C*********************MOVE *BLANK    M7BTB3                          E29942
     C*********************MOVE *BLANK    M7BTB4                          E29942
     C*********************MOVE *BLANK    M7BTB5                          E29942
     C*********************MOVE *BLANK    M7BTB6                          E29942
     C*********************                                               E29942
     C*********************                                               E29942
     C***********M6BTB1****IFNE *BLANK                                    E29942
     C***********M6BTB2****ORNE *BLANK                                    E29942
     C***********M7BTB3****ORNE *BLANK                                    E29942
     C***********M7BTB4****ORNE *BLANK                                    E29942
     C***********M7BTB5****ORNE *BLANK                                    E29942
     C***********M7BTB6****ORNE *BLANK                                    E29942
     C*********************MOVE ':72:'    M6TG72                          E29942
     C*********************MOVE X0D25     M6CRL5                          E29942
     C*********************END                                            E29942
     C***********M6BTB2****IFNE *BLANK                                    E29942
     C***********M7BTB3****ORNE *BLANK                                    E29942
     C***********M7BTB4****ORNE *BLANK                                    E29942
     C***********M7BTB5****ORNE *BLANK                                    E29942
     C***********M7BTB6****ORNE *BLANK                                    E29942
     C*********************MOVE X0D25     M6CRL6                          E29942
     C*********************END                                            E29942
     C***********M7BTB3****IFNE *BLANK                                    E29942
     C***********M7BTB4****ORNE *BLANK                                    E29942
     C***********M7BTB5****ORNE *BLANK                                    E29942
     C***********M7BTB6****ORNE *BLANK                                    E29942
     C*********************MOVE X0D25     M7CRL1                          E29942
     C*********************END                                            E29942
     C***********M7BTB4****IFNE *BLANK                                    E29942
     C***********M7BTB5****ORNE *BLANK                                    E29942
     C***********M7BTB6****ORNE *BLANK                                    E29942
     C*********************MOVE X0D25     M7CRL2                          E29942
     C*********************END                                            E29942
     C***********M7BTB5****IFNE *BLANK                                    E29942
     C***********M7BTB6****ORNE *BLANK                                    E29942
     C*********************MOVE X0D25     M7CRL3                          E29942
     C*********************END                                            E29942
     C***********M7BTB6****IFNE *BLANK                                    E29942
     C*********************MOVE X0D25     M7CRL4                          E29942
     C*********************END                                            E29942
     C**FIELD*21*SHOULD*HAVE THE SAME REFERENCE AS FIELD 20 ON THE        S01310
     C**ORIGINAL*MT100/MT202/MT400, SO       FIX IS NOT QUITE RIGHT.      S01310
     C*********************                                               S01310
     C*********************MOVELPREF      M1RTRT                          S01310
     C*********************MOVELPREF      M1RREF                          S01310
     C***FORMAT*THE*AMOUNT*                                               S01310
     C*********************EXSR SR07                                      S01310
     C*********************MOVEASAM       FAMT                            S01310
     C*********************Z-ADD1         S       30                      S01310
     C***********FAMT,S****DOWEQ' '                                       S01310
     C*********************ADD  1         S                               S01310
     C*********************END                                            S01310
     C*********************MOVEAFAMT,S    M1AMNT                          S01310
     C*********************                                               S01310
     C***OUTPUT*SEVEN*RECORDS*TO*THE*OUTGOING*SWIFT*MESSAGES              S01310
     C***FILE*(PF/MSMSOPF)*AND*ONE*RECORD*TO*(PF/MSIXOPF)                 S01310
     C*********************EXSR SR08                                      S01310
      *                                                                   S01310
      ** Output correctly generated message to PF/MGOMSGPD and write      S01310
      ** reference record to PF/MGOREFPD.                                 S01310
      *                                                                   S01310
     C                     EXSR OMSG                                      S01310
     C*
     C*  OUTPUT AN ENTRY TO THE SWIFT MESSAGE REPORT PRTF/FT0648P1     )))
     C*  INCLUDE NARRATIVE 'RECOVERY' IF ROLLBACK INDICATOR
     C*  HAS BEEN SETON IN SUBROUTINE SR08
     C                     EXSR SRP1
     C/COPY WNCPYSRC,FT0648C014
     C*
     C           *IN41     IFEQ '0'
     C                     MOVE 'Y'       OPPARM           MSG PROD FLAG  E32481
     C*****INCREMENT*MESSAGES*COUNT*FIELD*IN*DATAAREA*MSFCTL***********   E21286
     C*****INCREMENT*MESSAGES*COUNT*FIELD*IN*DATAAREA*FTFCTL        E21286S01310
     C**********           EXSR SR11                                      S01310
     C                     END
      *                                                                   E32481
     C                     END                                            E32481
      *                                                                   E32481
     C                     READ PRFP2                    13               E32481
     C                     MOVELPREF      DSPREF                          E32481
      *                                                                   E32481
     C                     END
     C*********************END                                            S01310
     C*                                                                   S01117
     C**  OUTPUT A RUN CONTROL REPORT                                     S01117
     C                     ADD  1         PAGEAU                          S01117
     C                     WRITEAUH1                   80                 S01117
     C           *IN80     IFEQ '1'                                       S01117
     C*                                                                   S01117
     C                     MOVE 'FT0648AU'DBFNAM           ***************S01117
     C                     MOVEL'3'       DBERKY           ** DBERR  20 **S01117
     C                     MOVE '20'      DBERR#           ***************S01117
     C                     EXSR DBERR                                     S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     SETON                     LR
     C/EJECT
     C****************************************************************
     C*    FIRST RECORD PROCESSING
     C*    FIRST SR.
     C*
     C           FIRST     BEGSR
     C*                                                     **************
     C           *NAMVAR   DEFN           RUNDAT                          S01117
     C                     IN   RUNDAT                                    S01117
     C*                                                                   S01117
     C* IF MULTIBRANCH INDICATOR IS ACTIVE FROM RUNDAT                    S01117
     C*                                                                   S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C                     MOVE '1'       *IN50                           S01117
     C                     END                                            S01117
     C* MOVE REPORT NAME AND SPOOL FILE NBR TO ZSFILE AND CALL ZSFILE     S01117
     C* FOR PRTF FT0648P1                                                 S01117
     C                     Z-ADDSFNUM1    SPLNO                           S01117
     C                     MOVELSFILE1    SFILP                           S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           RSEQ    5                       S01117
     C                     PARM *BLANKS   RENT    3                       S01117
     C                     PARM           SFILP  10                       S01117
     C                     PARM           SPLNO   60                      S01117
     C                     PARM *BLANKS   ZERR    1                       S01117
     C*                                                                   S01117
     C* IF ERROR PERFORM DATABASE ERROR HANDLING AND EXIT PROGRAM         S01117
     C*                                                                   S01117
     C           ZERR      IFEQ 'Y'                                       S01117
     C           *LOCK     IN   DLDA                                      S01117
     C                     MOVEL'FT0648'  DBPGM            ***************S01117
     C                     MOVEL'FT0648P1'DBKEY            ** DBERR  23 **S01117
     C                     MOVEL'ZSFILE'  DBFILE           ***************S01117
     C                     Z-ADD23        DBASE                           S01117
     C                     OUT  DLDA                                      S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C* MOVE REPORT NAME AND SPOOL FILE NBR TO ZSFILE AND CALL ZSFILE     S01117
     C* FOR PRTF FT0648P2                                                 S01117
     C                     Z-ADDSFNUM2    SPLNO                           S01117
     C                     MOVELSFILE2    SFILP                           S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           RSEQ    5                       S01117
     C                     PARM *BLANKS   RENT    3                       S01117
     C                     PARM           SFILP  10                       S01117
     C                     PARM           SPLNO   60                      S01117
     C                     PARM *BLANKS   ZERR    1                       S01117
     C*                                                                   S01117
     C* IF ERROR PERFORM DATABASE ERROR HANDLING AND EXIT PROGRAM         S01117
     C*                                                                   S01117
     C           ZERR      IFEQ 'Y'                                       S01117
     C           *LOCK     IN   DLDA                                      S01117
     C                     MOVEL'FT0648'  DBPGM            ***************S01117
     C                     MOVEL'FT0648P2'DBKEY            ** DBERR  27 **S01117
     C                     MOVEL'ZSFILE'  DBFILE           ***************S01117
     C                     Z-ADD27        DBASE                           S01117
     C                     OUT  DLDA                                      S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C* MOVE AUDIT REPORT NAME AND SPOOL FILE NBR TO ZSFILE AND           S01117
     C* CALL ZSFILE                                                       S01117
     C                     Z-ADDSFNUMU    SPLNO                           S01117
     C                     MOVELSFILEU    SFILP                           S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           RSEQ    5                       S01117
     C                     PARM *BLANKS   RENT    3                       S01117
     C                     PARM           SFILP  10                       S01117
     C                     PARM           SPLNO   60                      S01117
     C                     PARM *BLANKS   ZERR    1                       S01117
     C*                                                                   S01117
     C* IF ERROR PERFORM DATABASE ERROR HANDLING AND EXIT PROGRAM         S01117
     C*                                                                   S01117
     C           ZERR      IFEQ 'Y'                                       S01117
     C                     SETON                     U7U8LR               S01117
     C           *LOCK     IN   DLDA                                      S01117
     C                     MOVEL'FT0648'  DBPGM            ***************S01117
     C                     MOVEL'FT0648AU'DBKEY            ** DBERR  21 **S01117
     C                     MOVEL'ZSFILE'  DBFILE           ***************S01117
     C                     Z-ADD21        DBASE                           S01117
     C                     OUT  DLDA                                      S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C*    INITIALISE RECORD COUNTERS                                     S01117
     C                     Z-ADD0         AUNO1                           S01117
     C                     Z-ADD0         AUNO2                           S01117
     C                     Z-ADD0         PAGEP1                          S01117
     C                     Z-ADD0         PAGEP2                          S01117
     C                     Z-ADD0         PAGEAU                          S01117
     C*                                                     **************
     C**   SET UP KEY AND ACCESS INSTALLATION CONTROL RECORD (TABTB10F)
     C                     MOVEL'01      'ZTABKY 12
     C                     MOVE '  10'    ZTABKY
     C**
     C           ZTABKY    CHAINTABFP                99    ON NOT THERE
     C  N99      RECI      COMP 'D'                  9999  ON, IS DELETED
     C*
     C           *IN99     IFEQ '1'                         ))))))))))))))
     C*********************MOVE 'TABFP'   DBFNAM  5         )))  DATA  )))S01310
     C                     MOVEL'TABFP'   DBFNAM  8         )))  DATA  )))S01310
     C                     MOVELZTABKY    DBERKY 39         )))  BASE  )))
     C                     MOVE '01'      DBERR#  2         ))) ERROR  )))
     C                     EXSR DBERR                       )))   01   )))
     C                     END                              ))))))))))))))
     C*
     C**   INSTALLATION CONTROL RECORD FOUND SO SAVE FIELDS
     C                     MOVE RUNA      SRUNA   7        SAVE ALPHA DATE
     C                     MOVE TITL      STITL  53        SAVE TITLE
     C*
     C**   SET UP KEY AND ACCESS INSTALLATION CONTROL RECORD (TABTB11F)
     C*
     C                     MOVE *BLANKS   ZTABKY
     C                     MOVEL'01'      ZTABKY
     C                     MOVE '11'      ZTABKY
     C           ZTABKY    CHAINTABFP                10
     C  N10      RECI      COMP 'D'                  1010
     C*
     C           *IN10     IFEQ '1'                         ))))))))))))))
     C*********************MOVE 'TABFP'   DBFNAM            )))  DATA  )))S01310
     C                     MOVEL'TABFP'   DBFNAM            )))  DATA  )))S01310
     C                     MOVELZTABKY    DBERKY            )))  BASE  )))
     C                     MOVE '02'      DBERR#            ))) ERROR  )))
     C                     EXSR DBERR                       )))   02   )))
     C                     END                              ))))))))))))))
     C*
     C**   INST. CONTROL RECORD FOUND SO SAVE CUST. NO. OF HEAD OFFICE
     C**********           Z-ADDHEAD      SHEAD   60       SAVE CUST NO OF                    CSD027
     C                     MOVE HEAD      SHEAD   6        SAVE CUST NO OF                    CSD027
     C*********************Z-ADDFTDB      SDFBR            SAVE BRANCH NUMS01117
     C*
     C****SET*UP*KEY*AND*ACCESS*INST.*CONTROL*REC*BRANCH*CODE*(TABLETR)*  S01117
     C*********************                                               S01117
     C*********************MOVEL'10    '  ZTABKY                          S01117
     C*********************MOVE SDFBR     ZTABKY                          S01117
     C***********ZTABKY****CHAINTABFP                10                   S01117
     C**N10******RECI******COMP 'D'                  1010  ON , DELETED   S01117
     C*********************                                               S01117
     C************IN10*****IFEQ '1'                         ))))))))))))))S01117
     C*********************MOVE 'TABFP'   DBFNAM            )))  DATA  )))S01117
     C*********************MOVELZTABKY    DBERKY            )))  BASE  )))S01117
     C*********************MOVE '03'      DBERR#            ))) ERROR  )))S01117
     C*********************EXSR DBERR                       )))   03   )))S01117
     C*********************END                              ))))))))))))))S01117
     C***SAVE*BRANCH*INTERNAL*CUSTOMER*NO.*                               S01117
     C*********************MOVE BICN      SBICN   60                      S01117
     C***SET*UP*KEY*TO*ACCESS*CLIENT*FILE.*                               S01117
     C*********************MOVE BICN      KCUSNO  60                      S01117
     C*********************MOVE 'A'       KEYA    1                       S01117
     C*********************                                               S01117
     C***ACCESS*CLIENT*FILE*                                              S01117
     C***********CUSKEY****CHAINCLINTCBF             80                   S01117
     C*********************                                               S01117
     C************IN80*****IFEQ '1'                         ))))))))))))))S01117
     C*********************MOVE 'TABFP'   DBFNAM            )))  DATA  )))S01117
     C*********************MOVEL'      A' DBERKY            )))  BASE  )))S01117
     C*********************MOVELKCUSNO    DBERKY            )))  BASE  )))S01117
     C*********************MOVE '04'      DBERR#            ))) ERROR  )))S01117
     C*********************EXSR DBERR                       )))   04   )))S01117
     C*********************END                              ))))))))))))))S01117
     C*********************                                               S01117
     C**************************************
     C*****REMOVE*TERMINAL*ID*             *                              S01117
     C**************************************
     C*********************                                               S01117
     C***MOVE*SWIFT*ADDRESS*IN*DATA*STRUCTURE*                            S01117
     C*********************MOVE CSID      SCSID                           S01117
     C***SAVE***'OUR*TID'*FIELD*IN*WORK*AREA*                             S01117
     C*********************MOVE SCSID     MXOTID 12                       S01117
     C*********************                                         E22406S01310
     C*********************MOVE TELX      MXOTLX 12                 E22406S01310
     C*********************                                         E22406S01310
     C**ACCESS*TO*SDBRCHL5*                                         E22406S01310
     C*********************MOVE BICN      WWBICN  6                 E22406S01310
     C***********WWBICN****CHAINSDBRCHL5             09             E22406S01310
     C**N09******A8TYLC****COMP 'D'                      09         E22406S01310
     C*********************                                         E22406S01310
     C************IN09*****IFEQ '1'                         ))))))))E22406S01310
     C*********************MOVE 'SDBR5'   DBFNAM            )))  DATE22406S01310
     C*********************MOVELA8BICN    DBERKY            )))  BASE22406S01310
     C*********************MOVE '22'      DBERR#            ))) ERROE22406S01310
     C*********************EXSR DBERR                       )))   22E22406S01310
     C*********************END                              ))))))))E22406S01310
     C*********************                                         E22406S01310
     C*********************MOVE A8BTID    SCSID                     E22406S01310
     C*********************MOVE SCSID     MXOTID 12                 E22406S01310
     C*  CHECK TYPE OF RUN
     C           IPPARM    IFEQ 'I'                                       E32481
     C                     SETON                     13                   E32481
     C                     END                                            E32481
     C*  SET MESSAGE PRODUCTION PARAMETER
     C                     MOVE 'N'       OPPARM  1
     C***SET*UP*HEXADECIMAL*VALUE*OF*X'0D25'                              S01310
     C*********************Z-ADD13        B0D                             S01310
     C*********************Z-ADD37        B25                             S01310
     C*********************MOVELX0D       X0D25                           S01310
     C*********************MOVE X25       X0D25                           S01310
      *                                                                   S01310
      **  Access SDMMODPD for networks available.                         S01310
      *                                                                   S01310
     C                     CALL 'AOMMODR0'                                S01310
     C                     PARM '*MSG   ' @RTCD                           S01310
     C                     PARM '*FIRST ' @OPTN                           S01310
     C           SDMMOD    PARM SDMMOD    DSSDY                           S01310
      *                                                                   S01310
      ** If no record is found on sdmmodpd.                               S01310
      *                                                                   S01310
     C           @RTCD     IFNE *BLANKS                                   S01310
     C                     MOVE '024'     DBERR#             * * * * * * *S01310
     C                     MOVEL'FIRST'   DBERKY             * DBERR 024 *S01310
     C                     MOVEL'SDMMODPD'DBFNAM             * * * * * * *S01310
     C                     EXSR DBERR                                     S01310
     C                     END                                            S01310
      *                                                                   S01310
      **  Access SDMGMEPD for drop SWIFT msg. no. days                    S01310
      *                                                                   S01310
     C                     CALL 'AOMGMER0'                                S01310
     C                     PARM '*MSG   ' @RTCD   7                       S01310
     C                     PARM '*FIRST ' @OPTN   7                       S01310
     C           SDMGME    PARM SDMGME    DSFDY                           S01310
      *                                                                   S01310
      ** If no record is found on SDMGMEPD.                               S01310
      *                                                                   S01310
     C           @RTCD     IFNE *BLANKS                                   S01310
     C                     MOVE '25'      DBERR#             * * * * * * *S01310
     C                     MOVEL'FIRST'   DBERKY             * DBERR 025 *S01310
     C                     MOVEL'SDMGMEPD'DBFNAM             * * * * * * *S01310
     C                     EXSR DBERR                                     S01310
     C                     END                                            S01310
      *                                                                   S01310
      **  Convert history retention date to YYMMDD                        S01310
      *                                                                   S01310
     C           RUND      ADD  ENDSMN    ZMDAY                           S01310
     C                     CALL 'ZM0060'               15                 S01310
     C                     PARM           ZMDAY                           S01310
     C                     PARM           ZMDATE                          S01310
      *                                                                   S01310
      ** If the program ends in error.                                    S01310
      *                                                                   S01310
     C           *IN15     IFEQ '1'                                       S01310
     C                     MOVE '26'      DBERR#             * * * * * * *S01310
     C                     MOVEL'       ' DBERKY             * DBERR 026 *S01310
     C                     MOVEL'ZM0060'  DBFNAM             * * * * * * *S01310
     C                     EXSR DBERR                                     S01310
     C                     END                                            S01310
     C                     MOVE ZMDATE    @HRDT   6                       S01310
      *                                                                   S01310
     C                     BITOF'01234567'CR      1                       S01310
     C                     BITOF'01234567'LF      1                       S01310
     C                     BITON'457'     CR               CARRIAGE RETURNS01310
     C                     BITON'257'     LF               LINE FEED      S01310
     C*                                                                   S01310
     C                     MOVELCR        CRLF    2                       S01310
     C                     MOVE LF        CRLF                            S01310
      *                                                                   S01310
      **  CRLF Control Character for message data records                 S01310
      *                                                                   S01310
     C                     MOVE CRLF      CTRC                            S01310
      *                                                                   S01310
     C/COPY WNCPYSRC,FT0648C001
     C*                                                                   CSW020
      * Access SAR details to determine if SWIFT Decimal Places is        CSW020
      * switched on (CSW020)                                              CSW020
     C                     CALL 'AOSARDR0'                                CSW020
     C                     PARM *BLANKS   @RTCD                           CSW020
     C                     PARM '*VERIFY' @OPTN                           CSW020
     C                     PARM 'CSW020'  @SARD   6                       CSW020
     C           SCSARD    PARM SCSARD    DSFDY                           CSW020
     C*                                                                   CSW020
     C** If core feature is switched ON, set a variable field to          CSW020
     C** condition the rest of the processing                             CSW020
     C*                                                                   CSW020
     C           @RTCD     IFEQ *BLANKS                                   CSW020
     C                     MOVE 'Y'       CSW020  1                       CSW020
     C                     ELSE                                           CSW020
     C*                                                                   CSW020
     C** else, database error (return code other than *NRF)               CSW020
     C*                                                                   CSW020
     C           @RTCD     IFNE '*NRF   '                                 CSW020
     C                     MOVEL'SCSARDPD'DBFNAM           ************   CSW020
     C                     MOVEL'*VERIFY' DBERKY           * DBERR 32 *   CSW020
     C                     MOVE '32'      DBERR#           ************   CSW020
     C                     EXSR DBERR                                     CSW020
     C                     END                                            CSW020
     C                     END                                            CSW020
      *                                                                   CFT014
     C                     MOVE 'N'       CFT014  1                       CFT014
     C                     CALL 'AOSARDR0'                                CFT014
     C                     PARM *BLANKS   WRTCD   7                       CFT014
     C                     PARM '*VERIFY' WOPTN   7                       CFT014
     C                     PARM 'CFT014'  WSARD   6                       CFT014
     C           SCSARD    PARM SCSARD    DSFDY                           CFT014
     C           WRTCD     IFEQ *BLANKS                                   CFT014
     C                     MOVE 'Y'       CFT014                          CFT014
     C*********************OPEN OTPAYXL2                            CFT014CFT009
     C                     ELSE                                           CFT014
     C           WRTCD     IFNE '*NRF   '                                 CFT014
     C                     MOVEL'SCSARDPD'DBFNAM           ************   CFT014
     C                     MOVEL'CFT014  'DBERKY           * DBERR031 *   CFT014
     C                     MOVE '31'      DBERR#           ************   CFT014
     C                     EXSR DBERR                                     CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT009
     C                     MOVE 'N'       CFT009  1                       CFT009
     C                     CALL 'AOSARDR0'                                CFT009
     C                     PARM *BLANKS   WRTCD   7                       CFT009
     C                     PARM '*VERIFY' WOPTN   7                       CFT009
     C                     PARM 'CFT009'  WSARD   6                       CFT009
     C           SCSARD    PARM SCSARD    DSFDY                           CFT009
     C           WRTCD     IFEQ *BLANKS                                   CFT009
     C                     MOVE 'Y'       CFT009                          CFT009
     C                     ELSE                                           CFT009
     C           WRTCD     IFNE '*NRF   '                                 CFT009
     C                     MOVEL'SCSARDPD'DBFNAM           ************   CFT009
     C                     MOVEL'CFT009  'DBERKY           * DBERR033 *   CFT009
     C                     MOVE '33'      DBERR#           ************   CFT009
     C                     EXSR DBERR                                     CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                                       CSW201
      ** Check if switchable feature CSW201 is switched on                                    CSW201
      *                                                                                       CSW201
     C                     CALL 'SWIF2001'                                                    CSW201
     C                     PARM           @RTCD                                               CSW201
      *                                                                                       CSW201
     C           @RTCD     IFEQ 'CSW2001'                                                     CSW201
     C                     MOVE 'Y'       CSW201  1                                           CSW201
     C                     ELSE                                                               CSW201
     C                     MOVE 'N'       CSW201                                              CSW201
     C                     ENDIF                                                              CSW201
      *                                                                   CFT009
     C           CFT014    IFEQ 'Y'                                       CFT009
     C           CFT009    OREQ 'Y'                                       CFT009
     C           CSW209    OREQ 'Y'                                                         BUG24436
     C                     OPEN OTPAYXL2                                  CFT009
     C                     ENDIF                                          CFT009
      *                                                                                       CSW202
      ** Check if SWIFT 2002 is on                                                            CSW202
      *                                                                                       CSW202
     C                     CALL 'SWIF2002'                                                    CSW202
     C                     PARM *BLANKS   PRTCD                                               CSW202
      *                                                                                       CSW202
     C           PRTCD     IFEQ 'CSW2002'                                                     CSW202
     C                     MOVE 'Y'       CSW202  1                                           CSW202
     C                     ELSE                                                               CSW202
     C                     MOVE 'N'       CSW202                                              CSW202
     C                     ENDIF                                                              CSW202
      *                                                                                       CSW202
      ** Access SAR file to determine if Midas Compliance Watch -                             CSD015
      ** Watch List Checking (CSD015) is installed                                            CSD015
      *                                                                                       CSD015
     C                     CALL 'AOSARDR0'                                                    CSD015
     C                     PARM *BLANKS   PRTCD                                               CSD015
     C                     PARM '*VERIFY' POPTN                                               CSD015
     C                     PARM 'CSD015'  @SARD                                               CSD015
     C           SCSARD    PARM SCSARD    DSFDY                                               CSD015
      *                                                                                       CSD015
      ** Database error                                                                       CSD015
      *                                                                                       CSD015
     C           PRTCD     IFNE *BLANKS                                                       CSD015
     C           PRTCD     ANDNE'*NRF   '                                                     CSD015
     C                     MOVEL'CSD015'  DBERKY                                              CSD015
     C                     MOVEL'SCSARDPD'DBFNAM                                              CSD015
     C                     MOVE '34'      DBERR#                                              CSD015
     C                     EXSR DBERR                                                         CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PRTCD     IFEQ *BLANKS                                                       CSD015
     C                     MOVEL'Y'       CSD015  1                                           CSD015
      *                                                                                       222385
      ** Access AOWLCCR0 to check if function code MESSGENT is available                      222385
      *                                                                                       222385
     C                     CALL 'AOWLCCR0'                                                    222385
     C                     PARM *BLANKS   PRTCD                                               222385
     C                     PARM '*KEY'    POPTN                                               222385
     C                     PARM 'MESSGENT'PFUNC   8                                           222385
     C           SDWLCC    PARM SDWLCC    DSFDY                                               222385
      *                                                                                       222385
     C           PRTCD     IFNE *BLANKS                                                       222385
     C           PRTCD     ANDNE'*NRF'                                                        222385
     C                     MOVEL'SDWLCCPD'DBFNAM                                              222385
     C                     MOVELPFUNC     DBERKY                                              222385
     C                     MOVEL'32'      DBERR#                                              222385
     C                     EXSR DBERR                                                         222385
     C                     ENDIF                                                              222385
      *                                                                                       222385
     C                     ELSE                                                               CSD015
     C                     MOVEL'N'       CSD015                                              CSD015
     C                     MOVEL'N'       W1EWLC                                              222385
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Check if switchable feature CSW025 is switched on.                                   CSD015
      *                                                                                       CSD015
     C                     CALL 'AOSARDR0'                                                    CSD015
     C                     PARM *BLANKS   PRTCD                                               CSD015
     C                     PARM '*VERIFY' POPTN                                               CSD015
     C                     PARM 'CSW025'  @SARD                                               CSD015
     C           SCSARD    PARM SCSARD    DSFDY                                               CSD015
      *                                                                                       CSD015
      ** Database error                                                                       CSD015
      *                                                                                       CSD015
     C           PRTCD     IFNE *BLANKS                                                       CSD015
     C           PRTCD     ANDNE'*NRF   '                                                     CSD015
     C                     MOVEL'CSW025'  DBERKY                                              CSD015
     C                     MOVEL'SCSARDPD'DBFNAM                                              CSD015
     C                     MOVE '35'      DBERR#                                              CSD015
     C                     EXSR DBERR                                                         CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PRTCD     IFEQ *BLANKS                                                       CSD015
     C                     MOVEL'Y'       CSW025  1                                           CSD015
     C                     ELSE                                                               CSD015
     C                     MOVEL'N'       CSW025                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                      CSW207A
      ** Check if SWIFT2007 is installed                                                     CSW207A
      *                                                                                      CSW207A
     C                     CALL 'SWIF2007'                                                   CSW207A
     C                     PARM           @RTCD                                              CSW207A
      *                                                                                      CSW207A
     C           @RTCD     IFEQ 'CSW2007'                                                    CSW207A
     C                     MOVE 'Y'       CSW207  1                                          CSW207A
     C                     ELSE                                                              CSW207A
     C                     MOVE 'N'       CSW207                                             CSW207A
     C                     ENDIF                                                             CSW207A
      *                                                                                      CSW207A
      *                                                                                       CSW209
      ** Check if SWIFT2009 is installed                                                      CSW209
      *                                                                                       CSW209
     C                     CALL 'SWIF2009'                                                    CSW209
     C                     PARM           @RTCD                                               CSW209
      *                                                                                       CSW209
     C           @RTCD     IFEQ 'CSW2009'                                                     CSW209
     C                     MOVE 'Y'       CSW209  1                                           CSW209
     C                     MOVE *ON       *IN37                                               CSW209
     C                     ELSE                                                               CSW209
     C                     MOVE 'N'       CSW209                                              CSW209
     C                     MOVE *OFF      *IN37                                               CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
      *                                                                                       CFT124
      ** Access SAR details to determine if CFT124 is                                         CFT124
      ** switched on                                                                          CFT124
      *                                                                                       CFT124
     C                     CALL 'AOSARDR0'                                                    CFT124
     C                     PARM *BLANKS   @RTCD                                               CFT124
     C                     PARM '*VERIFY '@OPTN                                               CFT124
     C                     PARM 'CFT124'  @SARD                                               CFT124
     C           SCSARD    PARM SCSARD    DSFDY                                               CFT124
      *                                                                                       CFT124
     C           @RTCD     IFEQ *BLANKS                                                       CFT124
     C                     MOVE 'Y'       CFT124  1                                           CFT124
     C                     ELSE                                                               CFT124
     C                     MOVE 'N'       CFT124                                              CFT124
     C                     ENDIF                                                              CFT124
      *                                                                                       CFT124
      ** Access MT10350K* system values if CFT124 is installed                                CFT124
      *                                                                                       CFT124
     C           CFT124    IFEQ 'Y'                                                           CFT124
     C                     MOVELSVAFMT    P@OP01                                              CFT124
      *                                                                                       CFT124
     C                     CALL 'AOSVALR0'                                                    CFT124
     C                     PARM *BLANKS   @RTCD                                               CFT124
     C                     PARM           P@OP01 20                                           CFT124
     C                     PARM           P@VL01200                                           CFT124
     C                     PARM *BLANKS   P@OP02 20                                           CFT124
     C                     PARM *BLANKS   P@VL02200                                           CFT124
     C                     PARM *BLANKS   P@OP03 20                                           CFT124
     C                     PARM *BLANKS   P@VL03200                                           CFT124
     C                     PARM *BLANKS   P@OP04 20                                           CFT124
     C                     PARM *BLANKS   P@VL04200                                           CFT124
     C                     PARM *BLANKS   P@OP05 20                                           CFT124
     C                     PARM *BLANKS   P@VL05200                                           CFT124
     C                     PARM *BLANKS   P@OP06 20                                           CFT124
     C                     PARM *BLANKS   P@VL06200                                           CFT124
     C                     PARM *BLANKS   P@OP07 20                                           CFT124
     C                     PARM *BLANKS   P@VL07200                                           CFT124
     C                     PARM *BLANKS   P@OP08 20                                           CFT124
     C                     PARM *BLANKS   P@VL08200                                           CFT124
     C                     PARM *BLANKS   P@OP09 20                                           CFT124
     C                     PARM *BLANKS   P@VL09200                                           CFT124
     C                     PARM *BLANKS   P@OP10 20                                           CFT124
     C                     PARM *BLANKS   P@VL10200                                           CFT124
      *                                                                                       CFT124
     C           @RTCD     IFNE *BLANKS                                                       CFT124
     C                     MOVE '055'     DBERR#                                              CFT124
     C                     MOVEL'CFT124'  DBERKY                                              CFT124
     C                     MOVEL'SDSVALPD'DBFNAM                                              CFT124
     C                     EXSR DBERR                                                         CFT124
     C                     ELSE                                                               CFT124
     C                     MOVELP@VL01    W#AFMT  1                                           CFT124
     C                     ENDIF                                                              CFT124
      *                                                                                       CFT124
     C                     ENDIF                                                              CFT124
      *                                                                                       CFT124
      *                                                                                       CFT124
      ** Check if SWIFT2015 is installed                                                      CSW215
      *                                                                                       CSW215
     C                     CALL 'SWIF2015'                                                    CSW215
     C                     PARM           PRTCD                                               CSW215
      *                                                                                       CSW215
     C           PRTCD     IFEQ 'CSW2015'                                                     CSW215
     C                     MOVE 'Y'       CSW215  1                                           CSW215
     C                     ELSE                                                               CSW215
     C                     MOVE 'N'       CSW215                                              CSW215
     C                     ENDIF                                                              CSW215
     C/COPY WNCPYSRC,FTH00310
      *                                                                   CFT009
      *                                                                   CSW020
     C           TAGEND    TAG                              TAG: TAGEND
     C                     SETON                     40     1ST CYCLE DONE
     C                     ENDSR
     C/EJECT                                                              S01117
      *****************************************************************   CSW096
      *                                                               *   CSW096
      * Check for /RCB/ existence in Bank to Bank                     *   CSW096
      *                                                               *   CSW096
      *****************************************************************   CSW096
     C           SRRCB     BEGSR                                          CSW096
      *                                                                   CSW096
     C           1         DO   6         #X      50                      CSW096
      *                                                                   CSW096
      * Get Bank to Bank line information                                 CSW096
      *                                                                   CSW096
     C                     SELEC                                          CSW096
     C           #X        WHEQ 1                                         CSW096
     C                     MOVELBBI1      ##035A 35                       CSW096
     C           #X        WHEQ 2                                         CSW096
     C                     MOVELBBI2      ##035A                          CSW096
     C           #X        WHEQ 3                                         CSW096
     C                     MOVELBBI3      ##035A                          CSW096
     C           #X        WHEQ 4                                         CSW096
     C                     MOVELBBI4      ##035A                          CSW096
     C           #X        WHEQ 5                                         CSW096
     C                     MOVELBBI5      ##035A                          CSW096
     C           #X        WHEQ 6                                         CSW096
     C                     MOVELBBI6      ##035A                          CSW096
     C                     ENDSL                                          CSW096
      *                                                                   CSW096
      * Get first five characters                                         CSW096
      *                                                                   CSW096
     C                     MOVEL##035A    ##005A  5                       CSW096
      *                                                                   CSW096
      * If /RCB/ then extract SWIFT BIC                                   CSW096
      * and leave loop                                                    CSW096
      *                                                                   CSW096
     C           ##005A    IFEQ '/RCB/'                                   CSW096
     C           11        SUBST##035A:6  ##RCB                           CSW096
     C                     LEAVE                                          CSW096
     C                     ENDIF                                          CSW096
      *                                                                   CSW096
     C                     ENDDO                                          CSW096
      *                                                                   CSW096
      * Access SAR details to determine if IBAN validation is             CFT004
      * switched on (CFT004)                                              CFT004
     C                     CALL 'AOSARDR0'                                CFT004
     C                     PARM *BLANKS   @RTCD                           CFT004
     C                     PARM '*VERIFY' @OPTN                           CFT004
     C                     PARM 'CFT004'  @SARD   6                       CFT004
     C           SCSARD    PARM SCSARD    DSFDY                           CFT004
     C*                                                                   CFT004
     C** If core feature is switched ON, set a variable field to          CFT004
     C** condition the rest of the processing                             CFT004
     C*                                                                   CFT004
     C           @RTCD     IFEQ *BLANKS                                   CFT004
     C                     MOVE 'Y'       CFT004  1                       CFT004
     C                     ELSE                                           CFT004
     C*                                                                   CFT004
     C** else, database error (return code other than *NRF)               CFT004
     C*                                                                   CFT004
     C           @RTCD     IFNE '*NRF   '                                 CFT004
     C                     MOVEL'SCSARDPD'DBFNAM           ************   CFT004
     C                     MOVEL'*VERIFY' DBERKY           * DBERR 29 *   CFT004
     C                     MOVE '29'      DBERR#           ************   CFT004
     C                     EXSR DBERR                                     CFT004
     C                     END                                            CFT004
     C                     END                                            CFT004
     C/COPY WNCPYSRC,FT0648C020
     C*                                                                   CFT004
     C           EXRCB     TAG                                            CSW096
     C                     ENDSR                                          CSW096
      *****************************************************************   CSW096
      /EJECT                                                              CSW096
     C*****************************************************************   S01117
     C*   SUBROUTINE BRANCH                                   *           S01117
     C*     TO VALIDATE EACH BOOKING BRANCH FOR EVERY RECORD  *           S01117
     C*     CALLED BY MAIN PROCESSING                         *           S01117
     C*********************************************************           S01117
     C*                                                                   S01117
     C           BRANCH    BEGSR                                          S01117
     C*  SAVE BOOKING BRANCH (BRCA) READ FROM OTPAYDD AND CQPACDD FILES   S01117
     C                     MOVE BRCA      BRCAA   3                       S01117
     C*   SET UP KEY AND ACCESS INST. CONTROL REC BRANCH CODE (TABLETR)   S01117
     C*                                                                   S01117
     C                     MOVEL'10    '  ZTABKY                          S01117
     C                     MOVE BRCA      ZTABKY                          S01117
     C           ZTABKY    CHAINTABFP                10                   S01117
     C  N10      RECI      COMP 'D'                  1010  ON , DELETED   S01117
     C*                                                                   S01117
     C           *IN10     IFEQ '1'                         ))))))))))))))S01117
     C*********************MOVE 'TABFP'   DBFNAM            )))  DATS01117S01310
     C                     MOVEL'TABFP'   DBFNAM            )))  DATS01117S01310
     C                     MOVELZTABKY    DBERKY            )))  BASE  )))S01117
     C                     MOVE '03'      DBERR#            ))) ERROR  )))S01117
     C                     EXSR DBERR                       )))   03   )))S01117
     C                     END                              ))))))))))))))S01117
     C*  SAVE BRANCH INTERNAL CUSTOMER NO.                                S01117
     C**********           MOVE BICN      SBICN   60                                   S01117 CSD027
     C                     MOVE BICN      SBICN   6                                           CSD027
     C***SET*UP*KEY*TO*ACCESS CLIENT FILE.                          S01117S01310
     C*********************MOVE BICN      KCUSNO  60                S01117S01310
     C*********************MOVE 'A'       KEYA    1                 S01117S01310
     C*********************                                         S01117S01310
     C***ACCESS*CLIENT*FILE                                         S01117S01310
     C***********BICN******CHAINCLINTCBF             80             S01117S01310
     C*********************                                         S01117S01310
     C************IN80*****IFEQ '1'                         ))))))))S01117S01310
     C*********************MOVE 'TABFP'   DBFNAM            )))  DATS01117S01310
     C*********************MOVEL'      A' DBERKY            )))  BASS01117S01310
     C*********************MOVELBICN      DBERKY            )))  BASS01117S01310
     C*********************MOVE '04'      DBERR#            ))) ERROS01117S01310
     C*********************EXSR DBERR                       )))   04S01117S01310
     C*********************END                              ))))))))S01117S01310
      *                                                                   S01310
      **  Access SDCUSTPD using branch internal customer number           S01310
      *                                                                   S01310
     C                     MOVE *BLANKS   @KEY1                           S01310
     C                     MOVELBICN      @KEY1                           S01310
     C                     CALL 'AOCUSTR0'                                S01310
     C                     PARM '*MSG   ' @RTCD   7                       S01310
     C                     PARM '*KEY   ' @OPTN   7                       S01310
     C                     PARM           @KEY1  10                       S01310
     C                     PARM *BLANKS   @KYST   7                       S01310
     C           SDCUST    PARM SDCUST    DSSDY                           S01310
      *                                                                   S01310
      ** Customer record not found - Error                                S01310
      *                                                                   S01310
     C           @RTCD     IFNE *BLANKS                                   S01310
     C           CSW207    ANDNE'Y'                                      CSW207A
     C                     MOVE '004'     DBERR#             * * * * * * *S01310
     C                     MOVEL@KEY1     DBERKY             * DBERR 004 *S01310
     C                     MOVEL'SDCUSTPD'DBFNAM             * * * * * * *S01310
     C                     EXSR DBERR                                     S01310
     C                     END                                            S01310
      *                                                                   S01310
      **  Save sender's addresses & parent customer number                S01310
      *                                                                   S01310
     C           @RTCD     IFEQ *BLANKS                                                      CSW207A
     C                     MOVE BBTXA1    STELX  10                       S01310
     C                     MOVELBBTXA1    TELX   12                       S01310
     C                     MOVE BBSTAD    SSTTX  12                       S01310
     C                     MOVE BBCRNM    SCRNM  20                       S01310
     C*                                                                   S01117
     C**************************************                              S01117
     C*    REMOVE TERMINAL ID              *                              S01117
     C**************************************                              S01117
     C*                                                                   S01117
     C*  SAVE   'OUR TID' FIELD IN WORK AREA                              S01310
     C*                                                                   S01310
     C                     MOVE TELX      MXOTLX 12                       S01310
     C*                                                                   S01310
     C* ACCESS TO SDBRCHL5                                                S01310
     C                     MOVE BICN      WWBICN  6                       S01310
     C           WWBICN    CHAINSDBRCHL5             09                   S01310
     C  N09      A8TYLC    COMP 'D'                      09               S01310
     C*                                                                   S01310
     C           *IN09     IFEQ '1'                         ))))))))))))))S01310
     C                     MOVEL'SDBRCHL5'DBFNAM            )))  DATA  )))S01310
     C                     MOVELA8BICN    DBERKY            )))  BASE  )))S01310
     C                     MOVE '22'      DBERR#            ))) ERROR  )))S01310
     C                     EXSR DBERR                       )))   22   )))S01310
     C                     END                              ))))))))))))))S01310
     C*                                                                   S01310
     C                     MOVE A8BTID    SNCSID                          064393
     C                     MOVE A8BTID    SCSID                           S01310
     C                     MOVE SCSID     MXOTID 12                       S01310
      *                                                                   S01310
      **  Save swift address of sender                                    S01310
      *                                                                   S01310
     C                     MOVE BBCSID    SCSID                           S01310
     C                     ENDIF                                                             CSW207A
     C                     ENDSR                                          S01117
     C/EJECT
     C********************************************************************
     C*     *         SUBROUTINE 01                         ***        ***
     C*     *   TO FORMAT SETTLEMENT PARTY TO SWIFT FORMAT  ***        ***
     C*     *                                               ***        ***
     C*********************************************************        ***
     C           SR01      BEGSR                            ***        ***
     C*   INITIALISE OUTPUT PARAMETER FIELDS                           ***
     C                     MOVE *BLANKS   OFSPT1 35
     C                     MOVE *BLANKS   OFSPT2 35
     C                     MOVE *BLANKS   OFSPT3 35
     C                     MOVE *BLANKS   OFSPT4 35
     C                     MOVE *BLANKS   OFSPT5 35
     C                     MOVE *BLANKS   OSTAG   1
     C*********************MOVE 'N'       OSUFLG  1                       S01310
     C*                                                                ***
     C*   FULL NOSTRO PROCESSING - APPEND THE PAY CURRENCY TO THE      ***
     C*   FIRST SETTLEMENT PARTY FIELD TO ACCESS NOSTRO DET FROM
     C*   PF/TABLETL TO OBTAIN CUST NO.                                ***
     C           ISPTP     IFEQ 'F'
     C                     MOVELISPTY1    TLCCNN  5        BUILD
     C                     MOVEL'70'      TABTLK 12           KEY
     C                     MOVE TLCCNN    TABTLK 12            KEY
     C           TABTLK    CHAINTABFP                10    ON, DELETED
     C           *IN10     IFEQ '1'                         ))))))))))))))
     C*********************MOVE 'TABFP'   DBFNAM  5         )))  DATA  )))S01310
     C                     MOVEL'TABFP'   DBFNAM  8         )))  DATA  )))S01310
     C                     MOVELTABTLK    DBERKY 39         )))  BASE  )))
     C                     MOVE '06'      DBERR#  2         ))) ERROR  )))
     C                     EXSR DBERR                       )))   06   )))
     C                     END                              ))))))))))))))
     C**********           MOVE CNUM      CUSTNO  60                                          CSD027
     C                     MOVE CNUM      CUSTNO  6                                           CSD027
     C                     END
     C*                                                                ***
     C*   NOSTRO NO. PROCESSING - APPEND THE PAY CURRENCY TO THE       ***
     C*   FIRST 2 CHARS OF THE 1ST SETL PTY FIELD TO ACCESS NOSTRO DET
     C*   FROM PF/TABLETL TO OBTAIN CUST NO.                           ***
     C           ISPTP     IFEQ 'N'
     C                     MOVELISPTY1    TLNN    2        BUILD
     C                     MOVELPCCY      TLCCNN             KEY
     C                     MOVE TLNN      TLCCNN              KEY
     C                     MOVEL'70'      TABTLK                KEY
     C                     MOVE TLCCNN    TABTLK 12              KEY
     C           TABTLK    CHAINTABFP                10    ON, DELETED
     C           *IN10     IFEQ '1'                         ))))))))))))))
     C*********************MOVE 'TABFP'   DBFNAM  5         )))  DATA  )))S01310
     C                     MOVEL'TABFP'   DBFNAM  8         )))  DATA  )))S01310
     C                     MOVELTABTLK    DBERKY 39         )))  BASE  )))
     C                     MOVE '07'      DBERR#  2         ))) ERROR  )))
     C                     EXSR DBERR                       )))   07   )))
     C                     END                              ))))))))))))))
     C**********           MOVE CNUM      CUSTNO  60                                          CSD027
     C                     MOVE CNUM      CUSTNO  6                                           CSD027
     C                     END
     C*                                                                ***
     C*   RETAIL ACCNT PROCESSING -                                    ***
     C*   USE 1ST 10 CHARS OF THE 1ST SETL PTY FIELD TO ACCESS
     C*   THE ACCOUNT DETAILS FROM LF/ACNUMA TO OBTAIN CUST NO.        ***
     C           ISPTP     IFEQ 'R'
     C                     MOVELISPTY1    ACNUMK 100
     C           ACNUMK    CHAINACNUMA               11    ON, DELETED
     C           *IN11     IFEQ '1'                         ))))))))))))))
     C*********************MOVE 'ACNUMA'  DBFNAM            )))  DATA  )))S01310
     C                     MOVEL'ACNUMA'  DBFNAM            )))  DATA  )))S01310
     C                     MOVELACNUMK    DBERKY 39         )))  BASE  )))
     C                     MOVE '08'      DBERR#  2         ))) ERROR  )))
     C                     EXSR DBERR                       )))   08   )))
     C                     END                              ))))))))))))))
     C**********           MOVE CNUM      CUSTNO  60                                          CSD027
     C                     MOVE CNUM      CUSTNO  6                                           CSD027
     C                     END
     C*                                                                ***
     C*   FULL ACCOUNT/PARTIAL ACCOUNT/CUSTOMER PROCESSING - CUST NO.  ***
     C*   IS 1ST 6 CHARS OF THE 1ST SETL PTY FIELD.
     C           ISPTP     IFEQ 'G'
     C           ISPTP     OREQ 'P'
     C           ISPTP     OREQ 'C'
      *                                                                   S01435
      * If using account line construct then use second line              S01435
      *                                                                   S01435
     C                     MOVELISPTY1    ##001   1                       S01435
     C           ##001     IFEQ '/'                                       S01435
     C                     MOVELISPTY2    CUSTNO                          S01435
     C                     ELSE                                           S01435
     C                     MOVELISPTY1    CUSTNO
     C                     END                                            S01435
     C                     END
      *                                                                   S01435
      * If SWIFT identifier then use ME1400 to check details              S01435
      *                                                                   S01435
     C           ISPTP     IFEQ 'S'                                       S01435
      *                                                                   S01435
      *  Call Access object to validate identifier                        S01435
      *                                                                   S01435
     C                     MOVELISPTY1    ##001   1                       S01435
     C           ##001     IFEQ '/'                                       S01435
     C                     MOVELISPTY2    W9BICC                          S01435
     C           3         SUBSTISPTY2:9  W9BICB                          S01435
     C                     ELSE                                           S01435
     C                     MOVELISPTY1    W9BICC                          S01435
     C           3         SUBSTISPTY1:9  W9BICB                          S01435
     C                     END                                            S01435
      *                                                                   S01435
     C                     CALL 'ME1400'                                  S01435
     C                     PARM *BLANKS   W9RTN   7                       S01435
     C                     PARM           W9BICC  8                       S01435
     C                     PARM           W9BICB  3                       S01435
     C                     PARM           SDCUST                          S01435
     C                     PARM           SDCNST                          S01435
     C                     PARM           MEBICD                          S01435
     C                     PARM *BLANKS   W9CUST  1                       S01435
     C                     PARM *BLANKS   W9CNST  1                       S01435
     C                     PARM *BLANKS   W9BICD  1                       S01435
      *                                                                   S01435
      * If customer details exist then set up CUSTNO                      S01435
      *                                                                   S01435
     C           W9CUST    IFEQ 'Y'                                       S01435
     C                     MOVELBBCUST    CUSTNO                          S01435
      *                                                                   S01435
     C                     END                                            S01435
      *                                                                   S01435
     C                     END                                            S01435
      *                                                                   S01435
     C*                                                                ***
     C****ACCESS*FULL*CUSTOMER*DETAILS*FROM*LF/CLINT                   ***S01310
     C           ISPTP     IFEQ 'G'
     C           ISPTP     OREQ 'P'
     C           ISPTP     OREQ 'C'
     C           ISPTP     OREQ 'F'
     C           ISPTP     OREQ 'N'
     C           ISPTP     OREQ 'R'
     C           W9CUST    OREQ 'Y'                                       S01435
     C           ISPTP     ANDEQ'S'                                       S01435
     C***SET*UP*CUSTOMER*KEY                                              S01310
     C*********************MOVELCUSTNO    KCUSNO  60                      S01310
     C*********************MOVE 'A'       KEYA    1                       S01310
     C***********CUSKEY****CHAINCLINTCBF             12    ON, DELETED    S01310
     C************IN12*****IFEQ '1'                         ))))))))))))))S01310
     C*********************MOVE 'CLINT'   DBFNAM  5         )))  DATA  )))S01310
     C*********************MOVEL'      A' DBERKY            )))  BASE  )))S01310
     C*********************MOVELKCUSNO    DBERKY            )))  BASE  )))S01310
     C*********************MOVE '09'      DBERR#  2         ))) ERROR  )))S01310
     C*********************EXSR DBERR                       )))   09   )))S01310
     C*********************END                              ))))))))))))))S01310
     C***********CSID******IFEQ *BLANKS                                   S01310
     C*********************MOVE 'N'       OSUFLG                          S01310
     C*********************END                                            S01310
     C*********************GOTO SR01A                                     S01310
     C*********************END                                            S01310
      *                                                                   S01310
      **  Access SDCUSTPD using customer number                           S01310
      *                                                                   S01310
     C                     MOVE *BLANKS   @KEY1                           S01310
     C                     MOVELCUSTNO    @KEY1                           S01310
     C                     CALL 'AOCUSTR0'                                S01310
     C                     PARM '*MSG   ' @RTCD                           S01310
     C                     PARM '*KEY   ' @OPTN                           S01310
     C                     PARM           @KEY1  10                       S01310
     C                     PARM *BLANKS   @KYST   7                       S01310
     C           SDCUST    PARM SDCUST    DSSDY                           S01310
      *                                                                   S01310
      ** Customer record not found - Error                                S01310
      *                                                                   S01310
     C           @RTCD     IFNE *BLANKS                                   S01310
     C           CSW207    ANDNE'Y'                                      CSW207A
     C                     MOVE '009'     DBERR#             * * * * * * *S01310
     C                     MOVEL@KEY1     DBERKY             * DBERR 009 *S01310
     C                     MOVEL'SDCUSTPD'DBFNAM             * * * * * * *S01310
     C                     EXSR DBERR                                     S01310
     C                     END                                            S01310
      *                                                                   S01310
      ** Move new field names to old to ensure pgm continuity.            S01310
      *                                                                   S01310
     C           @RTCD     IFEQ *BLANKS                                                      CSW207A
     C**********           MOVELBBPCNB    CPAR    60                                   S01310 CSD027
     C                     MOVELBBPCNB    CPAR    6                                           CSD027
     C                     MOVELBBCRNM    CRNM   20                       S01310
     C                     MOVELBBCRTN    CTWN   10                       S01310
     C                     MOVELBBCSID    CSID                            S01310
     C                     MOVELBBTXA1    TELX                            097462
     C                     MOVE BBSTAD    STTX   12                       S01310
     C                     ENDIF                                                             CSW207A
     C*                                                                   S01310
      **  Access destination address details                              S01310
      *   (20 only set on for destination)                                S01310
     C*                                                                   S01310
     C           *IN20     IFEQ '1'                                       S01310
      *                                                                   S01310
      **  Initialise networking fields                                    S01310
      *                                                                   S01310
     C                     MOVE *BLANKS   NWSN                            S01310
     C                     MOVE *BLANKS   NWDS                            S01310
     C                     MOVE *BLANKS   NWRK                            S01310
      ***********                                                  S01310 CSW096
      ***If*the*destination*has*a*default*address*(BBDNW4)*use*it*,S01310 CSW096
      ***else*use*the*priority*network*address.********************S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********BBDNW2    IFNE *BLANKS                            S01310 CSW096
     C***********          EXSR NWAD                               S01310 CSW096
     C***********          ELSE                                    S01310 CSW096
     C***********          EXSR PRAD                               S01310 CSW096
     C***********          END                                     S01310 CSW096
      ***********                                                  S01310 CSW096
      ****Fill*up*the*appropriate*array*information*from*PF/SDCUSTPS01310 CSW096
      ***********                                                  S01310 CSW096
     C***********          EXSR FILL                               S01310 CSW096
      ***********                                                  S01310 CSW096
      ****If*message*status*blank,*determine*value.****************S01310 CSW096
      ****Is*default*status*for*MT202*messages*released*?**********S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********MGST      IFEQ *BLANKS                            S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********'202'     LOKUPDFS                      15        S01310 CSW096
     C***********'20*'     LOKUPDFS                      16        S01310 CSW096
     C***********'2**'     LOKUPDFS                      17        S01310 CSW096
      ***********                                                  S01310 CSW096
     C************IN15     IFEQ '1'                                S01310 CSW096
     C************IN16     OREQ '1'                                S01310 CSW096
     C************IN17     OREQ '1'                                S01310 CSW096
     C***********          MOVE 'RSND'    MGST                     S01310 CSW096
     C***********          MOVE '2'       MGSG                     S01310 CSW096
     C***********          ELSE                                    S01310 CSW096
      ***********                                                  088545 CSW096
      ****If*there*is*no*default*for*that*type*of*message*for*that*088545 CSW096
      ****customer,*setup*the*message*status*whith*the*ICD*default.088545 CSW096
      ***********                                                  088545 CSW096
     C***********FTCS      IFEQ 'R'                                088545 CSW096
     C***********          MOVE 'RSND'    MGST                     088545 CSW096
     C***********          MOVE '2'       MGSG                     088545 CSW096
     C***********          ELSE                                    088545 CSW096
     C***********          MOVE 'CRTD'    MGST                     S01310 CSW096
     C***********          MOVE '1'       MGSG                     S01310 CSW096
     C***********          END                                     088545 CSW096
     C***********          END                                     S01310 CSW096
     C***********          END                                     S01310 CSW096
      *                                                                   CSW096
     C                     EXSR SRROUT                                    CSW096
      *                                                                                       CSW209
      ** Output COV if Outgoing Validation Flag is equal to 'COV'                             CSW209
      ** Else, Access AOBAGRV0 to check if bilateral agreement exist                          CSW209
      *                                                                                       CSW209
     C           CSW209    IFEQ 'Y'                                                           CSW209
     C                     MOVE *OFF      *IN35                                               CSW209
      *                                                                                       CSW209
     C           OPOMVF    IFEQ 'COV'                                                         CSW209
     C                     MOVE *ON       *IN35                                               CSW209
      *                                                                                       CSW209
     C                     ELSE                                                               CSW209
      *                                                                                       CSW209
      ** Set parameters for AOBAGRV0                                                          CSW209
      *                                                                                       CSW209
     C                     MOVEL*BLANKS   PS2RIN                                              CSW209
     C                     MOVEL*BLANKS   PSNDCR                                              CSW209
     C                     MOVEL*BLANKS   PRCVCR                                              CSW209
     C                     MOVEL*BLANKS   PORBNK                                              CSW209
      *                                                                                       CSW209
     C                     MOVELNWSN      WNWSN  11                                           CSW209
     C                     MOVELORBK      PORBNK                                              CSW209
     C           BBI1      CAT  BBI2      PS2RIN                                              CSW209
     C           PS2RIN    CAT  BBI3      PS2RIN                                              CSW209
     C           PS2RIN    CAT  BBI4      PS2RIN                                              CSW209
     C           PS2RIN    CAT  BBI5      PS2RIN                                              CSW209
     C           PS2RIN    CAT  BBI6      PS2RIN                                              CSW209
     C                     MOVELSNCO      PSNDCR                                              CSW209
     C           SNCT      IFEQ 'N'                                                         BUG24436
     C                     MOVELSNCO      PSNDN   2                                         BUG24436
     C                     MOVEL*BLANKS   PSNDCR                                            BUG24436
     C                     MOVELPSNDN     PSNDCR                                            BUG24436
     C                     ENDIF                                                            BUG24436
     C           RCO1      CAT  RCO2      PRCVCR                                              CSW209
     C           PRCVCR    CAT  RCO3      PRCVCR                                              CSW209
     C           PRCVCR    CAT  RCO4      PRCVCR                                              CSW209
     C           PRCVCR    CAT  RCO5      PRCVCR                                              CSW209
      *                                                                                       CSW209
     C                     CALL 'AOBAGRV0'                                                    CSW209
     C                     PARM *BLANKS   PRTCD   7                                           CSW209
     C                     PARM 'SCT_C202'PBAGR  10                                           CSW209
     C                     PARM BRCAA     PBRCH   3                                           CSW209
     C                     PARM NWRK      PNWRK   6                                           CSW209
     C                     PARM '103'     PMTYP   3                                           CSW209
     C                     PARM SMCY      PSCUR   3                                           CSW209
     C                     PARM PCCY      PPCUR   3                                           CSW209
     C                     PARM WNWSN     PSSWID 11                                           CSW209
     C                     PARM NWDS      PRSWID 11                                           CSW209
     C                     PARM *BLANKS   PVALF   8                                           CSW209
     C                     PARM           PORBNK256                                           CSW209
     C                     PARM           PS2RIN256                                           CSW209
     C                     PARM           PSNDCR256                                           CSW209
     C                     PARM           PRCVCR256                                           CSW209
      *                                                                                       CSW209
     C           PRTCD     IFEQ '*CRTCOV'                                                     CSW209
     C                     MOVE *ON       *IN35                                               CSW209
     C                     ENDIF                                                              CSW209
     C                     ENDIF                                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     END                                            S01310
     C                     END                                            S01310
      *                                                                   S01435
      * If SWIFT identifier and destination of message set up             S01435
      * routing data                                                      S01435
      *                                                                   S01435
     C           ISPTP     IFEQ 'S'                                       S01435
     C           *IN20     ANDEQ'1'                                       S01435
     C                     MOVEL'Y'       OSUFLG                          S01435
     C**********           Z-ADD0         CPAR                                         S01435 CSD027
     C                     MOVE *BLANKS   CPAR                                                CSD027
     C                     MOVELISPTY1    CRNM                            S01435
     C*****************    MOVELSCRNM     NWSN                     S01435 087873
     C                     MOVELSNCSID    NWSN                            087873
     C                     MOVELISPTY1    NWDS                            S01435
     C                     MOVEL'SWIFT'   NWRK                            S01435
     C                     MOVEL*BLANKS   CTWN                            S01435
     C                     MOVELISPTY1    CSID                            S01435
      *                                                                   088545
      *  Default the message status whith the ICD.                        088545
      *                                                                   088545
     C           FTCS      IFEQ 'R'                                       088545
     C                     MOVE 'RSND'    MGST                            088545
     C                     MOVE '2'       MGSG                            088545
     C                     ELSE                                           088545
     C                     MOVE 'CRTD'    MGST                            S01435
     C                     MOVE '1'       MGSG                            S01435
     C                     END                                            088545
     C                     END                                            S01435
      *                                                                   S01310
     C*                                                                ***
     C*   SWIFT ADDRESS AND AT LEAST ONE VALID TAG FIELDS = 'A'        ***
     C           ISPTP     IFEQ 'S'
     C           IVTAG1    ANDEQ'A'
      *                                                                   S01435
      * If using account line construct then use second line              S01435
      *                                                                   S01435
     C                     MOVELISPTY1    ##001                           S01435
     C           ##001     IFEQ '/'                                       S01435
     C                     MOVELISPTY2    SP12                            S01435
     C                     MOVELSP12      SCSID                           S01435
     C                     MOVELISPTY1    OFSPT1                          S01435
     C                     MOVELSCSID     OFSPT2                          S01435
     C                     ELSE                                           S01435
     C                     MOVELISPTY1    SP12   12        1ST 12 CHARS
     C                     MOVELSP12      SCSID            1ST 12 CHARS
     C                     MOVELSCSID     OFSPT1
     C                     END                                            S01435
     C                     MOVE 'A'       OSTAG
     C*********************MOVE 'Y'       OSUFLG                          S01310
     C                     GOTO SR01N
     C                     END
     C*                                                                ***
     C*   SWIFT ADDRESS AND AT LEAST ONE VALID TAG FIELDS = 'D'        ***
     C           ISPTP     IFEQ 'S'
     C           IVTAG3    ANDEQ'D'
      *                                                                   S01435
      * Use FT0315 to format text for D address type                      S01435
      *                                                                   S01435
      *                                                                   S01435
      *  Set up general parameters                                        S01435
      *                                                                   S01435
     C           *LIKE     DEFN BCCY      XCCY                            S01435
      *                                                                   S01435
     C                     CLEARW8FT                                      S01435
     C                     MOVEL*BLANKS   W8STMT                          S01435
     C                     MOVEL##PGM     W8CPGM                          S01435
     C                     MOVEL'*MSG  '  W8ACT                           S01435
     C                     Z-ADD5         W8NLIN                          S01435
     C                     MOVEL'Y'       W8MTXT                          S01435
      *                                                                   S01435
      *  Format data to be translated                                     S01435
      *                                                                   S01435
     C                     MOVELISPTP     W8TYPE                          S01435
     C                     MOVELISCCY     W8CCY                           S01435
     C                     MOVEL*BLANKS   W8LINS                          S01435
     C                     MOVELISPTY1    ADCHK1                          S01435
     C                     MOVELISPTY2    ADCHK2                          S01435
     C                     MOVELISPTY3    ADCHK3                          S01435
     C                     MOVELISPTY4    ADCHK4                          S01435
     C                     MOVELISPTY5    ADCHK5                          S01435
     C                     MOVELADDRSS    W8LINS                          S01435
      *                                                                   S01435
      * Call expansion program                                            S01435
      *                                                                   S01435
     C                     CALL 'FT0315'               1111               S01435
     C                     PARM           W8RTN   7                       S01435
     C                     PARM           W8FT                            S01435
     C                     PARM           W8LINS256                       S01435
     C                     PARM           W8RPT 256                       S01435
     C                     PARM           W8MSG 256                       S01435
     C                     PARM           W8SCR 256                       S01435
      *                                                                   S01435
      ** Check if database error occurred                                 S01435
      *                                                                   S01435
     C           *IN11     IFEQ '1'                                       S01435
     C           W8RTN     ORNE *BLANKS                                   S01435
     C                     MOVE '089'     DBERR#             * * * * * * *S01435
     C                     MOVEL'*CALL'   DBERKY             * DBERR 089 *S01435
     C                     MOVEL'FT0315'  DBFNAM             * * * * * * *S01435
     C                     EXSR DBERR                                     S01435
     C                     END                                            S01435
      *                                                                   S01435
     C                     MOVELW8MSG     ADDRSS                          S01435
     C                     MOVELADCHK1    OFSPT1                          S01435
     C                     MOVELADCHK2    OFSPT2                          S01435
     C                     MOVELADCHK3    OFSPT3                          S01435
     C                     MOVELADCHK4    OFSPT4                          S01435
     C                     MOVELADCHK5    OFSPT5                          S01435
      *                                                                   S01435
     C***********          MOVELISPTY1    SP12   12        1ST 12 CHARS   S01435
     C***********          MOVELSP12      OFSPT1           1ST 12 CHARS   S01435
     C                     MOVE 'D'       OSTAG
     C*********************MOVE 'Y'       OSUFLG                          S01310
     C                     GOTO SR01N
     C                     END
     C*                                                                ***
     C*   FULL ADDRESS AND AT LEAST ONE VALID TAG FIELDS = 'D'         ***
     C*   Or IBAN Number                                                  CFT004
     C           ISPTP     IFEQ 'A'
     C           IVTAG3    ANDEQ'D'
     C           CFT004    OREQ 'Y'                                       CFT004
     C           ISPTP     ANDEQ'I'                                       CFT004
     C                     MOVELISPTY1    OFSPT1
     C                     MOVELISPTY2    OFSPT2
     C                     MOVELISPTY3    OFSPT3
     C                     MOVELISPTY4    OFSPT4
     C                     MOVELISPTY5    OFSPT5
     C                     MOVE 'D'       OSTAG
     C*********************MOVE 'N'       OSUFLG                          S01310
      *                                                                                      260987A
      ** Ensure fields for MGOREFPD set up correctly (if destination).                       260987A
      *                                                                                      260987A
     C           *IN20     IFEQ '1'                                                          260987A
     C                     MOVEL'PAPER'   NWRK                                               260987A
     C                     MOVELSBICN     NWSN                                               260987A
     C                     MOVELSBICN     SECN                                               260987A
     C                     MOVELISPTY1    NWDS                                               260987A
     C                     MOVEL*BLANKS   BBCUST                                             260987A
     C                     ENDIF                                                             260987A
      *                                                                                      260987A
      ** Default the message status whith the ICD.                                           260987A
      *                                                                                      260987A
     C           FTCS      IFEQ 'R'                                                          260987A
     C                     MOVE 'RSND'    MGST                                               260987A
     C                     MOVE '2'       MGSG                                               260987A
     C                     ELSE                                                              260987A
     C                     MOVE 'CRTD'    MGST                                               260987A
     C                     MOVE '1'       MGSG                                               260987A
     C                     ENDIF                                                             260987A
      *                                                                                      260987A
     C                     GOTO SR01N
     C                     END
     C*
     C           SR01A     TAG
     C* IF TYPE BLANK IGNORE
     C           ISPTP     IFEQ ' '                        B001
     C                     GOTO SR01N
     C                     END                             E001
     C*                                                                ***
     C*   VALID TAG FIELD = 'D' AND THE SWIFT ADDRESS ON LF/CLINT IS   ***
     C*   NON BLANK                                                    ***
     C           IVTAG1    IFEQ 'A'
     C           CSID      ANDNE*BLANK
      *                                                                   S01435
      * If using account line construct then use second line              S01435
      *                                                                   S01435
     C                     MOVELISPTY1    ##001                           S01435
     C           ##001     IFEQ '/'                                       S01435
     C                     MOVELCSID      SCSID                           S01435
     C                     MOVELISPTY1    OFSPT1                          S01435
     C                     MOVELSCSID     OFSPT2                          S01435
     C                     ELSE                                           S01435
     C                     MOVELCSID      SCSID
     C                     MOVELSCSID     OFSPT1
     C                     MOVE 'A'       OSTAG
     C                     END                                            S01435
     C*********************MOVE 'Y'       OSUFLG                          S01310
     C                     GOTO SR01N
     C                     END
     C*                                                                ***
     C*   VALID TAG FIELD = 'B' AND THE CUSTOMER PARENT NUMBER FROM    ***
     C*  LF/CLINT IS NON ZERO AND EQUAL TO THE CUST. NO. OF HEAD OFFICE***
      *                                                                   S01435
      * If using account line construct then 'B' not allowed              S01435
      *                                                                   S01435
     C                     MOVELISPTY1    ##001                           S01435
     C           IVTAG2    IFEQ 'B'
     C********** CPAR      ANDNE*ZERO                                                         CSD027
     C           CPAR      ANDNE*BLANKS                                                       CSD027
     C           CPAR      ANDEQSHEAD                      SAVE 1ST CYCLE
     C           ##001     ANDNE'/'                                       S01435
     C                     MOVELCTWN      OFSPT1
     C                     MOVE 'B'       OSTAG
     C*********************MOVE 'N'       OSUFLG                          S01310
     C                     GOTO SR01N
     C                     END
     C*                                                                ***
     C*   VALID TAG FIELD = 'D'                                        ***
     C           IVTAG3    IFEQ 'D'
     C*********************MOVE 'B'       KEYA                            S01310
     C***********CUSKEY****CHAINCLINTCCF             12    ON, DELETED    S01310
     C************IN12*****IFEQ '1'                         ))))))))))))))S01310
     C*********************MOVE 'CLINT'   DBFNAM  5         )))  DATA  )))S01310
     C*********************MOVEL'      B' DBERKY            )))  BASE  )))S01310
     C*********************MOVELKCUSNO    DBERKY            )))  BASE  )))S01310
     C*********************MOVE '14'      DBERR#  2         ))) ERROR  )))S01310
     C*********************EXSR DBERR                       )))   14   )))S01310
     C*********************END                              ))))))))))))))S01310
     C*********************MOVELCNA1      OFSPT1                          S01310
     C*********************MOVELCNA2      OFSPT2                          S01310
     C*********************MOVELCNA3      OFSPT3                          S01310
     C*********************MOVELCNA4      OFSPT4                          S01310
      *                                                                   S01435
      * Replaced by call FT0315                                           S01435
      *                                                                   S01435
      ***********                                                         S01435
     C***********          MOVE BBCNA1    OFSPT1                    S01310S01435
     C***********          MOVE BBCNA2    OFSPT2                    S01310S01435
     C***********          MOVE BBCNA3    OFSPT3                    S01310S01435
     C***********          MOVE BBCNA4    OFSPT4                    S01310S01435
     C***********          MOVE 'D'       OSTAG                           S01435
     C*********************MOVE 'N'       OSUFLG                    S01310S01435
     C***********          END                                            S01435
      *                                                                   S01435
      * Use FT0315 to format text for D address type                      S01435
      *                                                                   S01435
      *                                                                   S01435
      *  Set up general parameters                                        S01435
      *                                                                   S01435
     C                     CLEARW8FT                                      S01435
     C                     MOVEL*BLANKS   W8STMT                          S01435
     C                     MOVEL##PGM     W8CPGM                          S01435
     C                     MOVEL'*MSG  '  W8ACT                           S01435
     C                     Z-ADD5         W8NLIN                          S01435
     C                     MOVEL'Y'       W8MTXT                          S01435
      *                                                                   S01435
      *  Format data to be translated                                     S01435
      *                                                                   S01435
     C                     MOVELISPTP     W8TYPE                          S01435
     C                     MOVELISCCY     W8CCY                           S01435
     C                     MOVEL*BLANKS   W8LINS                          S01435
     C                     MOVELISPTY1    ADCHK1                          S01435
     C                     MOVELISPTY2    ADCHK2                          S01435
     C                     MOVELISPTY3    ADCHK3                          S01435
     C                     MOVELISPTY4    ADCHK4                          S01435
     C                     MOVELISPTY5    ADCHK5                          S01435
     C                     MOVELADDRSS    W8LINS                          S01435
      *                                                                   S01435
      * Call expansion program                                            S01435
      *                                                                   S01435
     C                     CALL 'FT0315'               1111               S01435
     C                     PARM           W8RTN   7                       S01435
     C                     PARM           W8FT                            S01435
     C                     PARM           W8LINS256                       S01435
     C                     PARM           W8RPT 256                       S01435
     C                     PARM           W8MSG 256                       S01435
     C                     PARM           W8SCR 256                       S01435
      *                                                                   S01435
      ** Check if database error occurred                                 S01435
      *                                                                   S01435
     C           *IN11     IFEQ '1'                                       S01435
     C           W8RTN     ORNE *BLANKS                                   S01435
     C                     MOVE '090'     DBERR#             * * * * * * *S01435
     C                     MOVEL'*CALL'   DBERKY             * DBERR 090 *S01435
     C                     MOVEL'FT0315'  DBFNAM             * * * * * * *S01435
     C                     EXSR DBERR                                     S01435
     C                     END                                            S01435
      *                                                                   S01435
     C                     MOVELW8MSG     ADDRSS                          S01435
     C                     MOVELADCHK1    OFSPT1                          S01435
     C                     MOVELADCHK2    OFSPT2                          S01435
     C                     MOVELADCHK3    OFSPT3                          S01435
     C                     MOVELADCHK4    OFSPT4                          S01435
     C                     MOVELADCHK5    OFSPT5                          S01435
     C                     MOVE 'D'       OSTAG                           S01435
     C                     END                                            S01435
      *                                                                   S01435
     C*                                                                ***
     C           SR01N     TAG
      *                                                                                       CSW201
      ** Process Swift 2001 standards                                                         CSW201
      *                                                                                       CSW201
     C           CSW201    IFEQ 'Y'                                                           CSW201
     C           W201IN    ANDEQ'Y'                                                           CSW201
     C           OSTAG     ANDEQ'A'                                                           CSW201
     C                     MOVELSCSID     W9BICC                                              CSW201
     C           3         SUBSTSCSID:9   W9BICB                                              CSW201
      *                                                                                       CSW201
     C                     CALL 'ME1400'                                                      CSW201
     C                     PARM *BLANKS   W9RTN                                               CSW201
     C                     PARM           W9BICC                                              CSW201
     C                     PARM           W9BICB                                              CSW201
     C                     PARM           SDCUST                                              CSW201
     C                     PARM           SDCNST                                              CSW201
     C                     PARM           MEBICD                                              CSW201
     C                     PARM *BLANKS   W9CUST                                              CSW201
     C                     PARM *BLANKS   W9CNST                                              CSW201
     C                     PARM *BLANKS   W9BICD                                              CSW201
      *                                                                                       CSW202
      ** If SWIFT 2002 is on, determine if BIC is a BEI via AOBEISR0.                         CSW202
      *                                                                                       CSW202
     C           CSW202    IFEQ 'Y'                                                           CSW202
     C           W9BICD    ANDEQ'Y'                                                           CSW202
     C                     CALL 'AOBEISR0'                                                    CSW202
     C                     PARM *BLANKS   PRTCD                                               CSW202
     C                     PARM '*VERIFY' POPTN                                               CSW202
     C                     PARM BDSUBT    PBICD                                               CSW202
     C           MEBEIS    PARM MEBEIS    DSFDY                                               CSW202
     C                     ENDIF                                                              CSW202
      *                                                                                       CSW201
     C           W9RTN     IFEQ *BLANKS                                                       CSW201
     C           W9BICD    ANDEQ'Y'                                                           CSW201
     C           BDSUBT    ANDEQ'BEID'                                                        CSW201
     C           CSW202    ANDEQ'N'                                                           CSW202
      *                                                                                       CSW201
     C           W9RTN     OREQ *BLANKS                                                       CSW201
     C           W9BICD    ANDEQ'Y'                                                           CSW201
     C           BDSUBT    ANDEQ'TRCO'                                                        CSW201
     C           CSW202    ANDEQ'N'                                                           CSW202
      *                                                                                       CSW202
     C           W9BICD    OREQ 'Y'                                                           CSW202
     C           CSW202    ANDEQ'Y'                                                           CSW202
     C           PRTCD     ANDEQ*BLANKS                                                       CSW202
      *                                                                                       CSW201
     C                     MOVEL'D'       OSTAG                                               CSW201
      *                                                                                       CSW201
     C           W9CNST    IFEQ 'Y'                                                           CSW201
      *                                                                                       CSW201
      ** If account line, then start with second line.                                        CSW201
      *                                                                                       CSW201
     C           ##001     IFEQ '/'                                                           CSW201
     C                     MOVELISPTY1    OFSPT1                                              CSW201
     C                     MOVELAWCPNM    OFSPT2                                              CSW201
     C                     MOVELAWCNTN    OFSPT3                                              CSW201
     C                     ELSE                                                               CSW201
     C                     MOVELAWCPNM    OFSPT1                                              CSW201
     C                     MOVELAWCNTN    OFSPT2                                              CSW201
     C                     ENDIF                                                              CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C           W9CUST    IFEQ 'Y'                                                           CSW201
      *                                                                                       CSW201
      ** If account line, then start with second line.                                        CSW201
      *                                                                                       CSW201
     C           ##001     IFEQ '/'                                                           CSW201
     C                     MOVELISPTY1    OFSPT1                                              CSW201
     C                     MOVELBBCNA1    OFSPT2                                              CSW201
     C                     MOVELBBCNA2    OFSPT3                                              CSW201
     C                     MOVELBBCNA3    OFSPT4                                              CSW201
     C                     MOVELBBCNA4    OFSPT5                                              CSW201
     C                     ELSE                                                               CSW201
     C                     MOVELBBCNA1    OFSPT1                                              CSW201
     C                     MOVELBBCNA2    OFSPT2                                              CSW201
     C                     MOVELBBCNA3    OFSPT3                                              CSW201
     C                     MOVELBBCNA4    OFSPT4                                              CSW201
     C                     ENDIF                                                              CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C                     ENDIF                                                              CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C                     EXSR EMBLK
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0648CCP2                                           S01408
     C*                                                                   S01408
     C                     ENDSR
     C/EJECT
     C********************************************************************
      *   FLD32 - set up field 32A                                    *   S01310
      *   Called by - main process                                    *   S01310
      *   Calls -                                                     *   S01310
      *****************************************************************   S01310
      *                                                                   S01310
     C           FLD32     BEGSR                                          S01310
      *                                                                   058476
      *  Clear data structure to prevent old data being output.           058476
      *                                                                   058476
     C                     MOVEL*BLANKS   M1AMNT                          058476
      *                                                                   058476
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0648CCP3                                           S01408
     C*                                                                   S01408
      *                                                                   S01310
      ** Format the amount for field 32                                   S01310
      *                                                                   S01310
     C                     MOVEASAM       FAMT                            S01310
     C                     Z-ADD1         S       30                      S01310
     C           FAMT,S    DOWEQ' '                                       S01310
     C                     ADD  1         S                               S01310
     C                     END                                            S01310
     C                     MOVEAFAMT,S    M1AMNT                          S01310
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0648CCP4                                           S01408
     C*                                                                   S01408
      *                                                                   S01310
      ** Set up field 32 in multiple occurence data structure             S01310
      *                                                                   S01310
     C                     ADD  1         M                               S01310
     C           M         OCUR MULT                                      S01310
     C                     MOVEL':32A:'   MTAG                            S01310
     C                     MOVELDS32      MFLD                            S01310
      *                                                                   S01310
     C                     ENDSR                                          S01310
     C/EJECT                                                              S01310
      *****************************************************************   S01310
      *   PARTY - set up field 57 & field 58                          *   S01310
      *   Called by - main process                                    *   S01310
      *   Calls -                                                     *   S01310
      *****************************************************************   S01310
      *                                                                   S01310
     C           PARTY     BEGSR                                          S01310
      *                                                                   S01310
      **  Set up field tag (A = swift address, B = branch address,        S01310
      **  D = address)                                                    S01310
      *                                                                   S01310
     C           OSTAG     IFEQ 'A'                                       S01310
     C                     MOVE 'A:'      @MTAG                           S01310
     C                     END                                            S01310
      *                                                                   S01310
     C           OSTAG     IFEQ 'B'                                       S01310
     C                     MOVE 'B:'      @MTAG                           S01310
     C                     END                                            S01310
      *                                                                   S01310
     C           OSTAG     IFEQ 'D'                                       S01310
     C                     MOVE 'D:'      @MTAG                           S01310
     C                     END                                            S01310
      *                                                                   S01310
     C           OFSPT1    IFNE *BLANK                                    S01310
     C                     ADD  1         M                               S01310
     C           M         OCUR MULT                                      S01310
     C                     MOVEL@MTAG     MTAG                            S01310
     C                     MOVELOFSPT1    MFLD                            S01310
     C                     EXSR SEXTN                                     138077
     C                     END                                            S01310
      *                                                                   S01310
     C           OFSPT2    IFNE *BLANK                                    S01310
     C                     ADD  1         M                               S01310
     C           M         OCUR MULT                                      S01310
     C                     MOVELOFSPT2    MFLD                            S01310
     C                     END                                            S01310
      *                                                                   S01310
     C           OFSPT3    IFNE *BLANK                                    S01310
     C                     ADD  1         M                               S01310
     C           M         OCUR MULT                                      S01310
     C                     MOVELOFSPT3    MFLD                            S01310
     C                     END                                            S01310
      *                                                                   S01310
     C           OFSPT4    IFNE *BLANK                                    S01310
     C                     ADD  1         M                               S01310
     C           M         OCUR MULT                                      S01310
     C                     MOVELOFSPT4    MFLD                            S01310
     C                     END                                            S01310
      *                                                                   S01310
     C           OFSPT5    IFNE *BLANK                                    S01310
     C                     ADD  1         M                               S01310
     C           M         OCUR MULT                                      S01310
     C                     MOVELOFSPT5    MFLD                            S01310
     C                     END                                            S01310
      *                                                                   S01310
     C                     ENDSR                                          S01310
     C/EJECT                                                              S01310
      *****************************************************************   S01310
      *   OMSG - output correctly generated messages                  *   S01310
      *   Called by - main process                                    *   S01310
      *   Calls - WREF Write o/p reference to PF/MGOREFPD.            *   S01310
      *****************************************************************   S01310
      *                                                                   S01310
     C           OMSG      BEGSR                                          S01310
      *                                                                   S01310
      **  Write reference record to PF/MGOREFPD.                          S01310
      *                                                                   S01310
     C                     EXSR WREF                                      S01310
     C/COPY WNCPYSRC,FTH00013
      *                                                                   S01310
      **  Write multiple occurrence data structure to MGOMSGPD            S01310
     C                     Z-ADD1         M       20                      S01310
     C           M         OCUR MULT                                      S01310
      *                                                                   S01310
     C********** M         DOWLE40                                        S01310              CSW209
     C           M         DOWLE50                                                            CSW209
     C           MFLD      ANDNE*BLANKS                                   S01310
     C                     WRITEMGOMSGD0               42                 S01310
      *                                                                   S01310
      **  Error on write to PF/MGOMSGPD (message data file)               S01310
      *                                                                   S01310
     C           *IN42     IFEQ '1'                                       S01310
     C                     MOVE '012'     DBERR#           * * * * * * * *S01310
     C                     MOVEL'       ' DBERKY           *  DBERR 012  *S01310
     C                     MOVEL'MGOMSGPD'DBFNAM           * * * * * * * *S01310
     C                     EXSR DBERR                                     S01310
     C                     END                                            S01310
      *                                                                   S01310
     C                     ADD  1         M                               S01310
     C           M         OCUR MULT                                      S01310
     C                     END                                            S01310
      *                                                                   138077
      **  Write multiple occurrence data structure to MGOEXTPD            138077
      *                                                                   138077
     C                     Z-ADD1         V       20                      138077
     C           V         OCUR EXTN                                      138077
     C           V         DOWLE20                                        138077
     C           MCSI      ANDNE*BLANKS                                   138077
     C                     WRITEMGOEXTD0               43                 138077
      *                                                                   138077
      **  Error on write to PF/MGOEXTPD (message data extension file)     138077
      *                                                                   138077
     C           *IN43     IFEQ '1'                                       138077
     C                     MOVE '043'     DBERR#           * * * * * * * *138077
     C                     MOVEL'        'DBERKY           *  DBERR 043  *138077
     C                     MOVEL'MGOEXTPD'DBFNAM           * * * * * * * *138077
     C                     EXSR DBERR                                     138077
     C                     END                                            138077
     C                     ADD  1         V                               138077
     C           V         OCUR EXTN                                      138077
     C                     ENDDO                                          138077
      *                                                                   S01310
     C                     ENDSR                                          S01310
      *****************************************************************                       CSD015
      /EJECT                                                                                  CSD015
      *****************************************************************                       CSD015
      *                                                               *                       CSD015
      *  SRWTCH - Watch Processing                                    *                       CSD015
      *                                                               *                       CSD015
      *****************************************************************                       CSD015
      *                                                                                       CSD015
     C           SRWTCH    BEGSR                                                              CSD015
      *                                                                                       CSD015
      ** Re-determine Message Status                                                          CSD015
      *                                                                                       CSD015
     C                     MOVE 'N'       PARLS   1                                           CSD015
     C           MGST      IFEQ 'RSND'                                                        CSD015
     C           NWRK      IFEQ 'SWIFT '                                                      CSD015
     C           NWRK      OREQ 'TELEX '                                                      CSD015
     C           NWRK      OREQ 'STTX  '                                                      CSD015
     C                     MOVE 'CRTD'    MGST                                                CSD015
     C                     MOVE '1'       MGSG                                                CSD015
     C                     MOVE 'Y'       PARLS                                               CSD015
     C                     ENDIF                                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Initialise parameters for compliance engine program.                                 CSD015
      *                                                                                       CSD015
     C                     CLEARWLTDS                                                         CSD015
     C                     Z-ADD*ZERO     W4VDAT                                              CSD015
     C                     Z-ADD*ZERO     W4MDAT                                              CSD015
     C                     Z-ADD*ZERO     W4AMT1                                              CSD015
     C                     Z-ADD*ZERO     W4AMT2                                              CSD015
      *                                                                                       CSD015
      ** Set up parameter for Compliance Engine Program                                       CSD015
      *                                                                                       CSD015
     C                     MOVELTRNO      W4IDEN                                              CSD015
     C                     MOVELMTPY      W4ITEM                                              CSD015
     C                     MOVELBRCAA     W4BRCH                                              CSD015
     C                     MOVEL'MGOREF  'W4FUNT                                              CSD015
     C                     MOVELDECN      W4CNUM                                              CSD015
     C                     Z-ADDRUND      W4DDAT                                              CSD015
     C                     MOVELPARLS     W4ARLS                                              CSD015
      *                                                                                       CSD015
      ** Send transaction to Compliance Engine Program                                        CSD015
      *                                                                                       CSD015
     C                     CALL 'SDWLCLOP'                                                    CSD015
     C                     PARM           WLTDS                                               CSD015
     C                     PARM *BLANKS   PSTRNG                                              CSD015
      *                                                                                       CSD015
     C                     ENDSR                                                              CSD015
      *                                                                                       CSD015
      *****************************************************************                       CSD015
     C/EJECT                                                              S01310
      *****************************************************************   S01310
      *   WREF - Write reference record to PF/MGOREFPD                *   S01310
      *   Called by - OMSG  output message PF/MGOMSGPD                *   S01310
      *****************************************************************   S01310
      *                                                                   S01310
     C           WREF      BEGSR                                          S01310
      *                                                                   S01310
     C                     MOVE *BLANKS   SYTM                            S01310
     C                     MOVEL'FT'      MODI                            S01310
     C                     MOVE *BLANKS   TRNF                            S01310
     C                     MOVE *BLANKS   TRNM                            S01310
     C                     MOVELPREF      MTRN                            S01310
     C                     MOVE PYTP      TNTP                            S01310
     C                     MOVE PYST      SBTP                            S01310
     C                     MOVE *BLANKS   EVTP                            S01310
     C                     MOVE SBICN     SECN                            S01310
     C                     MOVE SCUSNO    DECN                            S01310
     C                     MOVE '202'     MTPY                            S01310
     C*********************MOVE 'N'       MPRY                      S01310S01117
     C*  FORMAT SWIFT PRIORITY CODE                                       S01117
     C*                                                                   S01117
     C           SWPC      IFEQ 1                                         S01117
     C                     MOVE 'U'       MPRY                            S01117
     C                     ELSE                                           S01117
     C           SWPC      IFEQ 2                                         S01117
     C                     MOVE 'N'       MPRY                            S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C                     MOVEL*BLANKS   LSCC                            S01310
     C                     MOVEL*BLANKS   PTST                            S01310
     C                     MOVEL*BLANKS   CARQ                            S01310
     C                     MOVEL*BLANKS   MPDE                            S01310
     C                     MOVE @HRDT     HRDT                            S01310
     C/COPY WNCPYSRC,FT0648C016
     C                     TIME           MGTM                            S01310
     C                     MOVE RUNA      LADT                            S01310
     C                     MOVE MGTM      LATM                            S01310
      *                                                                   S01310
      **  Convert run date to YYMMDD                                      S01310
      *                                                                   S01310
     C                     CALL 'ZM0060'                                  S01310
     C                     PARM RUND      ZMDAY   50                      S01310
     C                     PARM           ZMDATE  6                       S01310
     C                     MOVE ZMDATE    MGDE                            S01310
     C*                                                                   S01310
     C*                                                                   S01310
      ** Set-up Message Generation  Century flag                          113352
      *                                                                   113352
     C                     MOVELMGDE      YY      20                      113352
     C           YY        IFLT 72                                        113352
     C                     MOVE '2'       CIND                            113352
     C                     ELSE                                           113352
     C                     MOVE '1'       CIND                            113352
     C                     ENDIF                                          113352
      *                                                                                       CSD015
      ** If Watch List Checking is Applied and CSW025 is off,                                 CSD015
      ** do watch processing.                                                                 CSD015
      *                                                                                       CSD015
     C           CSD015    IFEQ 'Y'                                                           CSD015
     C           W1EWLC    ANDEQ'Y'                                                           222385
     C           CSW025    ANDEQ'N'                                                           CSD015
     C                     EXSR SRWTCH                                                        CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           MGST      IFEQ 'RSND'                                    S01310
     C                     MOVE SRUNA     RELD                            S01310
     C                     MOVE LATM      RELT                            S01310
     C                     END                                            S01310
      *                                                                   S01310
     C                     MOVEL*BLANKS   RWSN                            S01310
     C                     MOVELM1AMNT    AMTS                            S01310
     C*********************MOVEL*BLANKS   AMTX                      S01310S01117
     C                     MOVELM1AMNT    AMTX                            S01117
     C*********************MOVELSLDTD3    SVDT                      S01310041780
     C                     MOVE PVDTD3    SVDT                            041780
      *                                                                   164663
      ** Setup century indicator CINDV for value date SVDT                164663
      *                                                                   164663
     C           SVDT      IFEQ *BLANK                                    164663
     C                     MOVE *BLANK    CINDV                           164663
     C                     ELSE                                           164663
     C                     MOVELSVDT      YY      20                      164663
     C           YY        IFLT 72                                        164663
     C                     MOVE '2'       CINDV                           164663
     C                     ELSE                                           164663
     C                     MOVE '1'       CINDV                           164663
     C                     ENDIF                                          164663
     C                     ENDIF                                          164663
      *                                                                   164663
      *                                                                   S01310
     C***********DSTT******IFEQ 'F'                                 S01310S01117
     C*********************MOVELDST1      DEST5   5                 S01310S01117
     C*********************MOVE DEST5     NSNO                      S01310S01117
     C*********************END                                      S01310S01117
      *                                                                   S01310
     C***********DSTT******IFEQ 'C'                                 S01310S01117
     C***********DSTT******OREQ 'A'                                 S01310S01117
     C                     MOVE *BLANKS   NSNO                            S01117
     C                     MOVE PCCY      CCY                             S01117
     C           SNCT      IFEQ 'N'                                       S01310
     C                     MOVE SNCO      NSNO                            S01310
     C*********************MOVE PCCY      CCY                       S01310S01117
     C                     END                                            S01310
     C*********************END                                      S01310S01117
      *                                                                   S01310
     C                     MOVEL*BLANKS   SACN                            S01310
     C                     MOVEL*BLANKS   AORR                            S01310
     C                     MOVEL*BLANKS   DESI                            S01310
      *                                                                   S01310
      **  Branch details                                                  S01310
      *                                                                   S01310
     C                     MOVE *BLANKS   RCBR                            S01310
      *                                                                   S01310
     C                     MOVE BRCAA     BRCA                            S01310
     C* IF MULTIBRANCH INDICATOR FROM RUNDAT ACTIVE                       S01310
     C           *IN50     IFEQ '1'                                       S01310
     C           BRCAA     IFNE ORBR                                      S01310
     C                     MOVE ORBR      OTHB                            S01310
     C* MOVE "ORIGINATING BRANCH" TO 'OTHER BRANCH TYPE'(OTHT)            S01310
     C                     MOVE ' BRANCH"'FLD1   20                       S01310
     C                     MOVEL'"ORIGINA'FLD2   12                       S01310
     C                     MOVE 'TING'    FLD2                            S01310
     C                     MOVELFLD2      FLD1                            S01310
     C                     MOVE FLD1      OTHT                            S01310
     C*                                                                   S01310
     C                     ELSE                                           S01310
     C                     MOVE *BLANKS   OTHB                            S01310
     C                     MOVE *BLANKS   OTHT                            S01310
     C                     END                                            S01310
     C* IF MULTIBRANCH INDICATOR FROM RUNDAT NOT ACTIVE                   S01310
     C                     ELSE                                           S01310
     C                     MOVE *BLANKS   OTHB                            S01310
     C                     MOVE *BLANKS   OTHT                            S01310
     C                     END                                            S01310
      *                                                                   S01310
     C                     MOVE *BLANKS   NETI                            S01310
     C*********************MOVE *BLANKS   DELC                      S01310S01117
     C*                                                                   S01117
     C*   READ SDCURRPD FOR DELIVERY NOTIFICATION AND NON-DELIVERY        S01117
     C*     WARNING FLAGS                                                 S01117
     C                     CALL 'AOCURRR0'                                S01117
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM PCCY      @CCY    3                       S01117
     C           SDCURR    PARM SDCURR    DSSDY                           S01117
     C*                                                                   S01117
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     MOVE '28'      DBERR#             *************S01117
     C                     MOVEL@CCY      DBERKY             * DBERR 028 *S01117
     C                     MOVEL'SDCURRPD'DBFNAM             *************S01117
     C                     EXSR DBERR                                     S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C           A6NDWR    IFEQ 'Y'                                       S01117
     C           A6DNOR    ANDEQ'Y'                                       S01117
     C                     MOVE '3'       DELC                            S01117
     C                     END                                            S01117
     C           A6NDWR    IFNE 'Y'                                       S01117
     C           A6DNOR    ANDEQ'Y'                                       S01117
     C                     MOVE '2'       DELC                            S01117
     C                     END                                            S01117
     C           A6NDWR    IFEQ 'Y'                                       S01117
     C           A6DNOR    ANDNE'Y'                                       S01117
     C                     MOVE '1'       DELC                            S01117
     C                     END                                            S01117
     C           A6NDWR    IFNE 'Y'                                       S01117
     C           A6DNOR    ANDNE'Y'                                       S01117
     C***********          MOVE '0'       DELC                      S01117068367
     C                     MOVEL*BLANKS   DELC                            068367
     C                     END                                            S01117
      *                                                                   068367
      * Ensure that message priority and delivery notification are        068367
      * valid combination :                                               068367
      * 1. for MPRY = 'U' DELC must be '1' or '3',                        068367
      * 2. for MPRY = 'N' DELC must be ' ' or '2'.                        068367
      *                                                                   068367
     C           MPRY      IFEQ 'U'                                       068367
     C           DELC      ANDEQ' '                                       068367
     C           MPRY      OREQ 'U'                                       068367
     C           DELC      ANDEQ'2'                                       068367
     C                     MOVEL'1'       DELC                            068367
     C                     END                                            068367
      *                                                                   068367
     C           MPRY      IFEQ 'N'                                       068367
     C           DELC      ANDEQ'1'                                       068367
     C           MPRY      OREQ 'N'                                       068367
     C           DELC      ANDEQ'3'                                       068367
     C                     MOVEL'2'       DELC                            068367
     C                     END                                            068367
     C*                                                                   S01117
     C                     MOVE *BLANKS   DYST                            S01310
     C                     MOVE *BLANKS   RSID                            S01310
     C                     MOVE *BLANKS   MSE1                            S01310
     C                     MOVE *BLANKS   ELIN                            S01310
     C                     MOVE *BLANKS   SSAC                            S01310
     C                     MOVE *BLANKS   MIR                             S01310
     C*********************MOVE *BLANKS   TSKS                      S01310S01117
     C                     MOVE 'Y'       TSKS                            S01117
     C                     MOVE *BLANKS   TSKY                            S01310
     C/COPY WNCPYSRC,FT0648C002
      *                                                                   S01310
     C                     MOVEL@CHG      AORR                                                CSW025
     C/COPY WNCPYSRC,FTH00311
     C                     WRITEMGOREFD0               41                 S01310
      *                                                                   S01310
      **  Error on write to PF/MGOREFPD (message reference file)          S01310
      *                                                                   S01310
     C           *IN41     IFEQ '1'                                       S01310
     C                     MOVE '014'     DBERR#           * * * * * * * *S01310
     C                     MOVEL'       ' DBERKY           *  DBERR 014  *S01310
     C                     MOVEL'MGOREFPD'DBFNAM           * * * * * * * *S01310
     C                     EXSR DBERR                                     S01310
     C                     END                                            S01310
     C/COPY WNCPYSRC,FT0648C009
     C                     ENDSR                                          S01310
      *                                                                   S01310
     C/EJECT                                                              S01310
     C********************************************************************
     C*               SUBROUTINE EMBLK                                 ***
     C*                                                                ***
     C*     TO ELIMINATE BLANK LINES ON NAME AND ADDRESS FIELDS        ***
     C*                                                                ***
     C*      CALLED BY: SR01
     C*
     C********************************************************************
     C           EMBLK     BEGSR                                       ***
     C                     MOVEA*BLANKS   ADDR
     C                     Z-ADD1         A       10
     C*
     C           OFSPT1    IFNE *BLANK
     C                     MOVE OFSPT1    ADDR,A
     C                     ADD  1         A
     C                     END
     C*
     C           OFSPT2    IFNE *BLANK
     C                     MOVE OFSPT2    ADDR,A
     C                     ADD  1         A
     C                     END
     C*
     C           OFSPT3    IFNE *BLANK
     C                     MOVE OFSPT3    ADDR,A
     C                     ADD  1         A
     C                     END
     C*
     C           OFSPT4    IFNE *BLANK
     C                     MOVE OFSPT4    ADDR,A
     C                     ADD  1         A
     C                     END
     C*
     C           OFSPT5    IFNE *BLANK
     C                     MOVE OFSPT5    ADDR,A
     C                     ADD  1         A
     C                     END
     C*
     C                     MOVEAADDR      OFSPT
     C*
     C                     ENDSR
     C/EJECT
     C*                                                                ***
     C/EJECT
     C********************************************************************
     C*     *         SUBROUTINE 03                         ***        ***
     C*     *                                               ***        ***
     C*     *     TO FORMAT AMOUNT                          ***        ***
     C*     *                                               ***        ***
     C*********************************************************        ***
     C           SR03      BEGSR                            ***        ***
     C*                                                                   CSW020
     C** Perform Old Processing if CSW020 is not switched on.             CSW020
     C           CSW020    IFNE 'Y'                                       CSW020
     C*                                                                ***
     C*   CHAIN TO TABLETG TO FIND DECIMAL POSITION                    ***
     C                     MOVEL'20'      TABTGK 12
     C                     MOVELPCCY      TGCCSR  4
     C                     MOVE '1'       TGCCSR
     C                     MOVE TGCCSR    TABTGK
     C           TABTGK    CHAINTABFP                10
     C*
     C           *IN10     IFEQ '1'                         ))))))))))))))
     C*********************MOVE 'TABFP'   DBFNAM            )))  DATA  )))S01310
     C                     MOVEL'TABFP'   DBFNAM            )))  DATA  )))S01310
     C                     MOVELTABTGK    DBERKY            )))  BASE  )))
     C                     MOVE '15'      DBERR#            ))) ERROR  )))
     C                     EXSR DBERR                       )))   15   )))
     C                     END                              ))))))))))))))
     C*
     C** USE THE SWIFT CURRENCY FROM TABLE ON THE SWIFT MESSAGES
     C*          =====
     C                     MOVE CCYS      M1RCCY
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0648CCP5                                           S01408
     C*                                                                   S01408
     C*
     C*    DETERMINE DECIMAL POSITION (FOR REPORT)
     C           CDP       COMP 2                    33  32
     C           CDP       COMP 1                      3031
     C*
     C*    DETERMINE DECIMAL POSITION
     C           14        SUB  CDP       X       20
     C*    IF 0 DECIMAL PLACES DON'T EDIT
     C           CDP       IFEQ 0                          B001
     C                     MOVE *BLANK    AMT
     C                     MOVE *ZEROS    AM
     C                     MOVEARAMNT     AMT,2
     C                     MOVEARAMNT     AM,1
     C                     Z-ADD13        W
     C                     MOVE ','       AM,X
     C                     ELSE                            E001
     C*    MOVE AMOUNT INTO ARRAY
     C                     MOVEARAMNT     AMT,1
     C*    DETERMINE POSITION OF DECIMAL DIGITS IN 2ND ARRAY
     C           X         ADD  1         Y       20
     C*    MOVE DECIMAL DIGITS INTO 2ND ARRAY FIELD
     C                     MOVEAAMT,X     AM,Y
     C*    DETERMINE POSITION & MOVE COMMA
     C                     SUB  1         Y
     C                     MOVE ','       AM,Y
     C*    DETERMINE POSITION OF DIGIT B4  COMMA
     C                     SUB  1         Y
     C*    SAVE POSITION OF DIGIT B4  COMMA
     C                     Z-ADDY         W       20
     C*    DETERMINE POSITION OF DIGIT TO BE MOVED B4  COMMA
     C                     SUB  1         X
     C                     Z-ADDX         Z       20
     C*    DO OPERATIONS MOVING CHARACTERS ONE AT A TIME
     C*    FROM RIGHT TO LEFT
     C                     DO   X
     C                     MOVE AMT,Z     AM,Y
     C                     SUB  1         Z
     C                     SUB  1         Y
     C                     END
     C                     END                             E001
     C*    SET INDEX TO 1
     C                     Z-ADD1         Y
     C*    REPLACE LEADING ZEROS WITH BLANK
     C           AM,Y      DOWEQ'0'
     C           Y         CABEQW         SR03A
     C                     MOVE ' '       AM,Y
     C                     ADD  1         Y
     C                     END
     C*  ** SAVE FIELD FROM ARRAY                                      ***
     C           SR03A     TAG
     C                     MOVEAAM        AMX    14
     C                     MOVE AMX       SAM    15
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0648CCP6                                           S01408
     C*                                                                   S01408
     C                     ELSE                                           CSW020
     C*                                                                   CSW020
     C** If CSW020 is switched on perform decimal places prosessing       CSW020
     C                     CALL 'ZM0040'                                  CSW020
     C                     PARM WAMNT     ZAMNT  130                      CSW020
     C                     PARM PCCY      ZCCY    3                       CSW020
     C                     PARM *BLANKS   ZSAMNT 15                       CSW020
     C                     PARM *BLANKS   ZSCCY   3                       CSW020
     C                     PARM *BLANKS   ZERR    1                       CSW020
     C*                                                                   CSW020
     C** Handle Database Error                                            CSW020
     C           ZERR      IFEQ '1'                                       CSW020
     C                     MOVEL'ZM0040  'DBFNAM           ************   CSW020
     C                     MOVELPCCY      DBERKY           * DBERR 33 *   CSW020
     C                     MOVE '33'      DBERR#           ************   CSW020
     C                     EXSR DBERR                                     CSW020
     C*                                                                   CSW020
     C                     ELSE                                           CSW020
     C                     MOVE ZSAMNT    SAM                             CSW020
     C                     MOVE ZSCCY     M1RCCY                          CSW020
     C*                                                                   CSW020
     C**    Access Currency Details                                       CSW020
     C                     CALL 'AOCURRR0'                                CSW020
     C                     PARM '*MSG   ' @RTCD   7                       CSW020
     C                     PARM '*KEY   ' @OPTN   7                       CSW020
     C                     PARM PCCY      @CCY    3                       CSW020
     C           SDCURR    PARM SDCURR    DSSDY                           CSW020
     C*                                                                   CSW020
     C                     MOVE A6CYNM    CCNM                            CSW020
     C           A6NBDP    COMP 2                    33  32               CSW020
     C           A6NBDP    COMP 1                      3031               CSW020
     C                     ENDIF                                          CSW020
     C*                                                                   CSW020
     C                     ENDIF                                          CSW020
     C*                                                                ***
     C                     ENDSR                           END SR03
     C/EJECT
     C********************************************************************
     C*     *         SUBROUTINE 05                         ***        ***
     C*     *                                               ***        ***
     C*     *  FORMAT SETTLEMENT PARTY FOR TELEX REPORT     ***        ***
     C*     *                                               ***        ***
     C*     *                                               ***        ***
     C*********************************************************        ***
     C           SR05      BEGSR                            ***        ***
     C*     INTIALISE O/P PARAMETERS FROM THIS SUBROUTINE
     C                     MOVE *BLANKS   OFSPT1 35
     C                     MOVE *BLANKS   OFSPT2 35
     C                     MOVE *BLANKS   OFSPT3 35
     C                     MOVE *BLANKS   OFSPT4 35
     C                     MOVE *BLANKS   OFSPT5 35
      *                                                                   S01435
      * Replaced by call FT0315                                           S01435
      *                                                                   S01435
      ***********                                                         S01435
     C***********                                                      ***S01435
     C*****FULL*NOSTRO - PROCESSING                         **         ***S01435
     C***********ISPTP     IFEQ 'F'                                       S01435
     C*****SETUP*AND ACCESS PF/TABLETL                                 ***S01435
     C***********          MOVELISPTY1    TLCCNN  5        BUILD          S01435
     C***********          MOVEL'70'      TABTLK 12          KEY          S01435
     C***********          MOVE TLCCNN    TABTLK               KEY        S01435
     C***********TABTLK    CHAINTABFP                10                   S01435
     C************IN10     IFEQ '1'                         ))))))))))))))S01435
     C*********************MOVE 'TABFP'   DBFNAM            )))  DATS01310S01435
     C***********          MOVEL'TABFP'   DBFNAM            )))  DATS01310S01435
     C***********          MOVELTABTLK    DBERKY            )))  BASE  )))S01435
     C***********          MOVE '10'      DBERR#            ))) ERROR  )))S01435
     C***********          EXSR DBERR                       )))   10   )))S01435
     C***********          END                              ))))))))))))))S01435
     C***********          MOVE CNUM      CUSTNO                          S01435
     C***********          MOVELTLCCNN    OFSPT1                          S01435
     C***********          GOTO NADD                                      S01435
     C***********          END                                            S01435
     C***********                                                      ***S01435
     C*****NOSTRO NUMBER - PROCESSING                         **       ***S01435
     C***********ISPTP     IFEQ 'N'                                       S01435
     C*****SETUP*AND ACCESS PF/TABLETL                                 ***S01435
     C***********          MOVELISPTY1    TLNN    2        BUILD          S01435
     C***********          MOVELISCCY     TLCCNN             KEY          S01435
     C***********          MOVE TLNN      TLCCNN             KEY          S01435
     C***********          MOVEL'70'      TABTLK 12          KEY          S01435
     C***********          MOVE TLCCNN    TABTLK               KEY        S01435
     C***********TABTLK    CHAINTABFP                10                   S01435
     C************IN10     IFEQ '1'                         ))))))))))))))S01435
     C*********************MOVE 'TABFP'   DBFNAM            )))  DATS01310S01435
     C***********          MOVEL'TABFP'   DBFNAM            )))  DATS01310S01435
     C***********          MOVELTABTLK    DBERKY            )))  BASE  )))S01435
     C***********          MOVE '11'      DBERR#            ))) ERROR  )))S01435
     C***********          EXSR DBERR                       )))   11   )))S01435
     C***********          END                              ))))))))))))))S01435
     C***********          MOVE CNUM      CUSTNO                          S01435
     C***********          MOVELTLNN      OFSPT1                          S01435
     C***********          GOTO NADD                                      S01435
     C***********          END                                            S01435
     C***********                                                      ***S01435
     C*****RETAIL ACCOUNT - PROCESSING                         **      ***S01435
     C***********ISPTP     IFEQ 'R'                                       S01435
     C*****SETUP*AND ACCESS ACCOUNT NUMBER FILE                        ***S01435
     C***********          MOVELISPTY1    ACNUMK                          S01435
     C***********ACNUMK    CHAINACNUMA               11    ON, DELETED    S01435
     C************IN11     IFEQ '1'                         ))))))))))))))S01435
     C*********************MOVE 'ACNUMA'  DBFNAM  5         )))  DATS01310S01435
     C***********          MOVEL'ACNUMA'  DBFNAM  8         )))  DATS01310S01435
     C***********          MOVELACNUMK    DBERKY 39         )))  BASE  )))S01435
     C***********          MOVE '12'      DBERR#  2         ))) ERROR  )))S01435
     C***********          EXSR DBERR                       )))   12   )))S01435
     C***********          END                              ))))))))))))))S01435
     C***********          MOVE CNUM      CUSTNO                          S01435
     C***********          MOVELACNUMK    OFSPT1                          S01435
     C***********          GOTO NADD                                      S01435
     C***********          END                                            S01435
     C***********                                                      ***S01435
     C*****FULL/PARTIAL ACCOUNT/CUSTOMER  - PROCESSING                 ***S01435
     C***********ISPTP     IFEQ 'G'                                       S01435
     C***********ISPTP     OREQ 'P'                                       S01435
     C***********ISPTP     OREQ 'C'                                       S01435
     C***********          MOVELISPTY1    CUSTNO                          S01435
     C***********          MOVELISPTY1    OFSPT1                          S01435
     C***********          GOTO NADD                                      S01435
     C***********          END                                            S01435
     C***********                                                      ***S01435
     C*****SETTLEMENT PARTY  - PROCESSING                              ***S01435
     C***********ISPTP     IFEQ 'S'                                       S01435
     C***********ISPTP     OREQ 'A'                                       S01435
     C***********          MOVELISPTY1    OFSPT1                          S01435
     C***********          MOVELISPTY2    OFSPT2                          S01435
     C***********          MOVELISPTY3    OFSPT3                          S01435
     C***********          MOVELISPTY4    OFSPT4                          S01435
     C***********          MOVELISPTY5    OFSPT5                          S01435
     C***********          GOTO SR05N                                     S01435
     C***********          END                                            S01435
     C***********                                                      ***S01435
     C***********NADD      TAG                                            S01435
     C***IF*TYPE*BLANK IGNORE                                             S01435
     C***********ISPTP     IFEQ ' '                        B001           S01435
     C***********          GOTO SR05N                                     S01435
     C***********          END                             E001           S01435
      *********************                                         S01310S01435
     C***SET*UP*CUSTOMER*KEY                                        S01310S01435
     C*********************MOVELCUSTNO    KCUSNO                    S01310S01435
     C*********************MOVE 'B'       KEYA                      S01310S01435
     C***ACCESS*CLIENT*FILE                                         S01310S01435
     C***********CUSKEY****CHAINCLINTCCF             80             S01310S01435
     C*********************                                         S01310S01435
     C************IN80*****IFEQ '1'                         ))))))))S01310S01435
     C*********************MOVE 'CLINT'   DBFNAM            )))  DATS01310S01435
     C*********************MOVEL'      B' DBERKY            )))  BASS01310S01435
     C*********************MOVELKCUSNO    DBERKY            )))  BASS01310S01435
     C*********************MOVE '16'      DBERR#            ))) ERROS01310S01435
     C*********************EXSR DBERR                       )))   16S01310S01435
     C*********************END                              ))))))))S01310S01435
     C*********************MOVE CNA1      OFSPT2                    S01310S01435
     C*********************MOVE CNA2      OFSPT3                    S01310S01435
     C*********************MOVE CNA3      OFSPT4                    S01310S01435
     C*********************MOVE CNA4      OFSPT5                    S01310S01435
     C***********                                                     *** S01435
      ***********                                                   S01310S01435
      ***Access*SDCUSTPD with the customer number.                  S01310S01435
      ***********                                                   S01310S01435
     C***********          MOVE *BLANKS   @KEY1                     S01310S01435
     C***********          MOVELCUSTNO    @KEY1                     S01310S01435
     C***********          CALL 'AOCUSTR0'                          S01310S01435
     C***********          PARM '*MSG   ' @RTCD                     S01310S01435
     C***********          PARM '*KEY   ' @OPTN                     S01310S01435
     C***********          PARM           @KEY1  10                 S01310S01435
     C***********          PARM *BLANKS   @KYST   7                 S01310S01435
     C***********SDCUST    PARM SDCUST    DSSDY                     S01310S01435
      ***********                                                   S01310S01435
      ***Customer record not found - Error                          S01310S01435
      ***********                                                   S01310S01435
     C***********@RTCD     IFNE *BLANKS                             S01310S01435
     C***********          MOVE '016'     DBERR#             * * * *S01310S01435
     C***********          MOVEL@KEY1     DBERKY             * DBERRS01310S01435
     C***********          MOVEL'SDCUSTPD'DBFNAM             * * * *S01310S01435
     C***********          EXSR DBERR                               S01310S01435
     C***********          END                                      S01310S01435
     C***********          MOVE BBCNA1    OFSPT2                    S01310S01435
     C***********          MOVE BBCNA2    OFSPT3                    S01310S01435
     C***********          MOVE BBCNA3    OFSPT4                    S01310S01435
     C***********          MOVE BBCNA4    OFSPT5                    S01310S01435
      *                                                                   S01435
      * Use FT0315 to format text for D address type                      S01435
      *                                                                   S01435
      *                                                                   S01435
      *  Set up general parameters                                        S01435
      *                                                                   S01435
     C                     CLEARW8FT                                      S01435
     C                     MOVEL*BLANKS   W8STMT                          S01435
     C                     MOVEL##PGM     W8CPGM                          S01435
     C                     MOVEL'*MSG  '  W8ACT                           S01435
     C                     Z-ADD5         W8NLIN                          S01435
     C                     MOVEL'Y'       W8MTXT                          S01435
      *                                                                   S01435
      *  Format data to be translated                                     S01435
      *                                                                   S01435
     C                     MOVELISPTP     W8TYPE                          S01435
     C                     MOVELISCCY     W8CCY                           S01435
     C                     MOVEL*BLANKS   W8LINS                          S01435
     C                     MOVELISPTY1    ADCHK1                          S01435
     C                     MOVELISPTY2    ADCHK2                          S01435
     C                     MOVELISPTY3    ADCHK3                          S01435
     C                     MOVELISPTY4    ADCHK4                          S01435
     C                     MOVELISPTY5    ADCHK5                          S01435
     C                     MOVELADDRSS    W8LINS                          S01435
      *                                                                   S01435
      * Call expansion program                                            S01435
      *                                                                   S01435
     C                     CALL 'FT0315'               1111               S01435
     C                     PARM           W8RTN   7                       S01435
     C                     PARM           W8FT                            S01435
     C                     PARM           W8LINS256                       S01435
     C                     PARM           W8RPT 256                       S01435
     C                     PARM           W8MSG 256                       S01435
     C                     PARM           W8SCR 256                       S01435
      *                                                                   S01435
      ** Check if database error occurred                                 S01435
      *                                                                   S01435
     C           *IN11     IFEQ '1'                                       S01435
     C           W8RTN     ORNE *BLANKS                                   S01435
     C                     MOVE '090'     DBERR#             * * * * * * *S01435
     C                     MOVEL'*CALL'   DBERKY             * DBERR 090 *S01435
     C                     MOVEL'FT0315'  DBFNAM             * * * * * * *S01435
     C                     EXSR DBERR                                     S01435
     C                     END                                            S01435
      *                                                                   S01435
     C           CFT004    IFEQ 'Y'                                       CFT004
     C           W8TYPE    ANDEQ'I'                                       CFT004
     C                     MOVELW8RPT     ADDRSS                          CFT004
     C                     ELSE                                           CFT004
     C                     MOVELW8MSG     ADDRSS                          S01435
     C                     ENDIF                                          CFT004
     C                     MOVELADCHK1    OFSPT1                          S01435
     C                     MOVELADCHK2    OFSPT2                          S01435
     C                     MOVELADCHK3    OFSPT3                          S01435
     C                     MOVELADCHK4    OFSPT4                          S01435
     C                     MOVELADCHK5    OFSPT5                          S01435
      *                                                                   S01435
     C*                                                                ***
     C*                                                                ***
     C           SR05N     ENDSR                           END SR05
     C/EJECT
     C********************************************************************
     C*     *         SUBROUTINE 06                                    ***
     C*     *                                               ***        ***
     C*     *   DETERMINE AND FORMAT AMOUNT OUTGOING        ***        ***
     C*     *   PAYMENTS                                    ***        ***
     C*     *                                               ***        ***
     C*********************************************************        ***
     C           SR06      BEGSR                                       ***
     C*                                                                ***
     C*  ** CHECK 'PAY PLUS CHARGES' IND NOT = 'Y' AND      **         ***
     C*  ** 'CHARGES TO THE DEBIT ACCOUNT' IS BLANK         **         ***
     C*                                                                ***
     C           ADDC      IFNE 'A'
     C***********CDRO      ANDEQ*ZERO                                                         CSD027
     C           CDRO      ANDEQ*BLANKS                                                       CSD027
     C           PYAM      SUB  TXCH      WAMNT  130
     C           WAMNT     SUB  CQCH      WAMNT
     C           WAMNT     SUB  CSTA      WAMNT
     C           WAMNT     SUB  SPCH      WAMNT
     C           WAMNT     SUB  MSCH      WAMNT
     C           WAMNT     SUB  TRCM      WAMNT
     C*                                                                   S01494
     C**  FX/Change Commission                                            S01494
     C           WAMNT     SUB  OPCHCM    WAMNT                           S01494
     C*                                                                   S01499
     C**  Total V.A.T. Charges                                            S01499
     C           WAMNT     SUB  OPVATT    WAMNT                           S01499
      *                                                                   CFT009
      * IF CFT009 ACTIVE, SUBTRACT NEW CHARGES                            CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
      *                                                                   CFT009
      ** Take charges amounts in levied currency from file fields.        CFT009
      *                                                                   CFT009
     C                     SUB  MISC01    WAMNT                           CFT009
      *                                                                   CFT009
     C                     SUB  MISC02    WAMNT                           CFT009
      *                                                                   CFT009
     C                     SUB  MISC03    WAMNT                           CFT009
      *                                                                   CFT009
     C                     SUB  MISC04    WAMNT                           CFT009
      *                                                                   CFT009
     C                     SUB  MISC05    WAMNT                           CFT009
      *                                                                   CFT009
     C                     SUB  SWSCHG    WAMNT                           CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     END                                         ***
     C*                                                                ***
     C           ADDC      IFEQ 'A'
     C***********CDRO      ORNE *ZERO                                                         CSD027
     C           CDRO      ORNE *BLANKS                                                       CSD027
     C                     Z-ADDPYAM      WAMNT
     C                     END
      *                                                                                       222448
      ** Add Receiver's Charges Remitted from the extension file.                             222448
      *                                                                                       222448
     C           CFT014    IFEQ 'Y'                                                           222448
     C                     ADD  OPRCRM    WAMNT                                               222448
     C                     ENDIF                                                              222448
     C*                                                                ***
     C*  ** FORMAT THE AMOUNT USING PROCEDURE SR03                     ***
     C                     EXSR SR03
     C*                                                                ***
     C                     ENDSR                           END SR06
     C/EJECT
     C********************************************************************
     C*     *         SUBROUTINE 07                         ***        ***
     C*     *                                               ***        ***
     C*     *  DETERMINE AND FORMAT AMOUNT FOR              ***        ***
     C*     *  CHEQUES TO BE PAID                           ***        ***
     C*     *                                               ***        ***
     C*********************************************************        ***
     C           SR07      BEGSR                            ***        ***
     C*                                                                ***
     C* **AMOUNT = 'TOTAL REMITTANCE'  + 'CORRESPONDENTS CHARGES'      ***
     C*                                - 'DEDUCTIONS'                  ***
     C*                                                                ***
     C           TOTR      ADD  COCH      WAMNT
     C                     SUB  DEDS      WAMNT
     C*                                                                   S01499
     C**  Total V.A.T. charges                                            S01499
     C                     ADD  PCVATC    WAMNT                           S01499
     C                     SUB  PCVATD    WAMNT                           S01499
     C*                                                                ***
     C* ** FORMAT THE AMOUNT USING SUBROUTINE 03                       ***
     C                     EXSR SR03
     C*                                                                ***
     C                     ENDSR                           END SR07
     C/EJECT
4630 C********************************************************************
     C********************************************************************
     C****************SUBROUTINE 08                         ***        ***S01310
     C**********OUTPUT*7*RECORDS TO THE OUTGOING SWIFT      ***        ***S01310
     C**********MESSAGES*FILE (PF/MSMSOPF).                 ***        ***S01310
     C**********OUTPUT*A*RECORD TO THE SWIFT REFERENCE      ***        ***S01310
     C**********FILE*(PF/MSIXOPF).                          ***        ***S01310
     C*********************************************************        ***S01310
     C***********SR08******BEGSR                                       ***S01310
     C*********************                                            ***S01310
     C****FIELDS*COMMON*TO*RECORDS TO BE OUTPUTTED                     ***S01310
     C*********************MOVE MXMIND    MSMI                         ***S01310
     C*********************MOVELMXTREF    TNRF                         ***S01310
     C*********************MOVE '1'       TNRF                            S01310
     C*********************MOVE MXDFLG    PTDL                         ***S01310
     C*********************                                            ***S01310
     C****FIRST*RECORD*****                                            ***S01310
     C*********************MOVELMT2021    MDTA                         ***S01310
     C*********************WRITEMSMSOPFF               42  ON, D/B ERROR  S01310
     C************IN42*****CABEQ'1'       WRTERR                          S01310
     C*********************                                            ***S01310
     C****SECOND*RECORD****                                            ***S01310
     C*********************MOVELMT2022    MDTA                         ***S01310
     C*********************WRITEMSMSOPFF               42  ON, D/B ERROR  S01310
     C************IN42*****CABEQ'1'       WRTERR                          S01310
     C*********************                                            ***S01310
     C****THIRD*RECORD*****                                            ***S01310
     C*********************MOVELMT2023    MDTA                         ***S01310
     C*********************WRITEMSMSOPFF               42  ON, D/B ERROR  S01310
     C************IN42*****CABEQ'1'       WRTERR                          S01310
     C*********************                                            ***S01310
     C****FOURTH*RECORD****                                            ***S01310
     C*********************MOVELMT2024    MDTA                         ***S01310
     C*********************WRITEMSMSOPFF               42  ON, D/B ERROR  S01310
     C************IN42*****CABEQ'1'       WRTERR                          S01310
     C*********************                                            ***S01310
     C****FIFTH*RECORD*****                                            ***S01310
     C*********************MOVELMT2025    MDTA                         ***S01310
     C*********************WRITEMSMSOPFF               42  ON, D/B ERROR  S01310
     C************IN42*****CABEQ'1'       WRTERR                          S01310
     C*********************                                            ***S01310
     C****SIXTH*RECORD*****                                            ***S01310
     C*********************MOVELMT2026    MDTA                         ***S01310
     C*********************WRITEMSMSOPFF               42  ON, D/B ERROR  S01310
     C************IN42*****CABEQ'1'       WRTERR                          S01310
     C*********************                                            ***S01310
     C****SEVENTH*RECORD***                                            ***S01310
     C*********************MOVELMT2027    MDTA                         ***S01310
     C*********************WRITEMSMSOPFF               42  ON, D/B ERROR  S01310
     C************IN42*****CABEQ'1'       WRTERR                          S01310
     C*********************                                            ***S01310
     C*********************                                            ***S01310
     C***FORMAT*AND*OUTPUT*A RECORD TO THE SWIFT                       ***S01310
     C***REFERENCE*FILE*(PF/MSIXOPF)                                   ***S01310
     C*********************MOVE 'D'       RECI                            S01310
     C*********************MOVE 'P'       MSMI                            S01310
     C*********************MOVELPREF      TNRF                            S01310
     C*********************MOVE PREF      PREFS  14                       S01310
     C*********************MOVELPREFS     TNRF                            S01310
     C*********************MOVE '1'       TNRF                            S01310
     C*********************MOVE FTCS      MSTS                            S01310
     C*********************MOVE RUNA      LADT                            S01310
     C*********************TIME           LATM                            S01310
     C*********************MOVE PYTP      TNTP                            S01310
     C*********************MOVE PYST      SBTP                            S01310
     C*********************MOVE '202'     MTPY                            S01310
     C*********************MOVE SWPC      MSGP                            S01310
     C*********************MOVE SCRNM     RPNM                            S01310
     C*********************MOVE SCTWN     RPTN                            S01310
     C*********************TIME           MGTM                            S01310
     C*********************MOVE RUNA      MGDT                            S01310
     C*********************MOVE MXOTID    STID                            S01310
     C*********************MOVE RECADD    DTID                            S01310
     C*********************MOVE SBICN     SECN                            S01310
     C*********************MOVE SCUSNO    DECN                            S01310
     C***********AUP2******IFNE *BLANK                                    S01310
     C*********************MOVE AUP2      RUSR                            S01310
     C*********************ELSE                                           S01310
     C*********************MOVE AUP1      RUSR                            S01310
     C*********************END                                            S01310
     C*********************MOVE SRUNA     RELD                            S01310
     C*********************MOVE LCHT      RELT                            S01310
     C*********************EXSR SR06                                      S01310
     C*********************MOVEASAM       FAMT                            S01310
     C*********************Z-ADD1         S                               S01310
     C***********FAMT,S****DOWEQ' '                                       S01310
     C*********************ADD  1         S                               S01310
     C*********************END                                            S01310
     C*********************MOVE *BLANKS   AMTS                            S01310
     C*********************MOVEAFAMT,S    AMTS                            S01310
     C*********************MOVE SLDTD3    SVDT                            S01310
     C***********DSTT******IFEQ 'F'                                       S01310
     C*********************MOVELDST1      NSTR                            S01310
     C*********************END                                            S01310
     C***********DSTT******IFEQ 'C'                                       S01310
     C***********DSTT******OREQ 'A'                                       S01310
     C***********SNCT******IFEQ 'N'                                       S01310
     C*********************MOVELSNCO      XSNCO   2                       S01310
     C*********************MOVE XSNCO     NSTR                            S01310
     C*********************MOVELSMCY      NSTR                      E30710S01310
     C*********************MOVELPCCY      NSTR                      E30710S01310
     C*********************END                                            S01310
     C*********************END                                            S01310
     C*********************MOVE 'S'       SWTX                            S01310
     C*********************MOVE 'Y'       TSKS                            S01310
     C*********************MOVE BRCAA     BRCA                      S01117S01310
     C**IF*MULTIBRANCH*INDICATOR FROM RUNDAT ACTIVE                 S01117S01310
     C************IN50*****IFEQ '1'                                 S01117S01310
     C***********BRCAA*****IFNE ORBR                                S01117S01310
     C*********************MOVE ORBR      OTHB                      S01117S01310
     C**MOVE*"ORIGINATING*BRANCH" TO 'OTHER BRANCH TYPE'(OTHT)      S01117S01310
     C*********************MOVE ' BRANCH"'FLD1   20                 S01117S01310
     C*********************MOVEL'"ORIGINA'FLD2   12                 S01117S01310
     C*********************MOVE 'TING'    FLD2                      S01117S01310
     C*********************MOVELFLD2      FLD1                      S01117S01310
     C*********************MOVE FLD1      OTHT                      S01117S01310
     C*********************                                         S01117S01310
     C*********************ELSE                                     S01117S01310
     C*********************MOVE *BLANKS   OTHB                      S01117S01310
     C*********************MOVE *BLANKS   OTHT                      S01117S01310
     C*********************END                                      S01117S01310
     C**IF*MULTIBRANCH*INDICATOR FROM RUNDAT NOT ACTIVE             S01117S01310
     C*********************ELSE                                     S01117S01310
     C*********************MOVE *BLANKS   OTHB                      S01117S01310
     C*********************MOVE *BLANKS   OTHT                      S01117S01310
     C*********************END                                      S01117S01310
     C*********************WRITEMSIXOPFF               41  ON, D/B ERROR  S01310
     C*********************GOTO SR08N                                     S01310
     C*********************                                            ***S01310
     C***********WRTERR****TAG                              ))))))))))))))S01310
     C*********************MOVE 'MSMSOPFF'DBFNAM            )))  DATA  )))S01310
     C*********************MOVELMXTREF    DBERKY            )))  BASE  )))S01310
     C*********************MOVE '05'      DBERR#            ))) ERROR  )))S01310
     C*********************EXSR DBERR                       )))   05   )))S01310
     C*********************                                 ))))))))))))))S01310
     C*********************                                            ***S01310
     C***********SR08N*****ENDSR                           END SR08       S01310
     C/EJECT
     C********************************************************************
     C*     *         SUBROUTINE 10                         ***        ***
     C*     *                                               ***        ***
     C*     *  TO INITIALISE FIELDS IN DATA STRUCTURE       ***        ***
     C*     *  FOR FORMATTING SWIFT RECORDS                 ***        ***
     C*     *                                               ***        ***
     C*********************************************************        ***
     C           SR10      BEGSR                                       ***
     C*                                                                ***
     C*********************MOVE *BLANKS   MT2021                          S01310
     C*********************MOVE *BLANKS   MT2022                          S01310
     C*********************MOVE *BLANKS   MT2023                          S01310
     C*********************MOVE *BLANKS   MT2024                          S01310
     C*********************MOVE *BLANKS   MT2025                          S01310
     C*********************MOVE *BLANKS   MT2026                          S01310
     C*********************MOVE *BLANKS   MT2027                          S01310
     C*    SET 'OUR TID'                                               ***
     C**********           MOVE MXOTID    M1OTID                                             260987A
      *                                                                                      260987A
      ** TID should be set the same as MGOREFPD.                                             260987A
      *                                                                                      260987A
     C                     MOVELNWSN      M1OTID                                             260987A
     C*********************Z-ADD1         B01                             S01310
     C*********************MOVE X01       M1HEAD                          S01310
     C*********************MOVE X0D25     M1CRL1                          S01310
     C*********************MOVE X0D25     M1CRL2                          S01310
     C*********************MOVE X0D25     M1CRL3                          S01310
     C*********************MOVE X0D25     M1CRL4                          S01310
     C*********************MOVE X0D25     M1CRL6                          S01310
     C*********************MOVE X0D25     M1CRL7                          S01310
     C*********************MOVE X0D25     M1CRL8                          S01310
     C*********************MOVE '202'     M1MSGT                          S01310
     C*********************MOVE SWPC      M1MSGP                          S01117
     C*  FORMAT SWIFT PRIORITY CODE                                       S01117
     C*                                                                   S01117
     C           SWPC      IFEQ 1                                         S01117
     C                     MOVE 'U'       M1MSGP                          S01117
     C                     ELSE                                           S01117
     C           SWPC      IFEQ 2                                         S01117
     C                     MOVE 'N'       M1MSGP                          S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C                     MOVE RECADD    M1RADD
      *                                                                   S01310
      **  Put original payment reference into print file field and        S01310
      **  use this field as a store                                       S01310
      *                                                                   S01310
     C/COPY WNCPYSRC,FTH00324
     C           FULLRF    IFEQ 'Y'                                                        BUG15044A
     C                     MOVELPREF      M1RREF                                           BUG15044A
     C                     ELSE                                                            BUG15044A
     C                     MOVE PREF      M1RREF                          S01310
     C                     MOVEL'FT'      M1RREF                          S01310
     C                     ENDIF                                                           BUG15044A
     C           RBKR      IFNE *BLANK                                    135400
     C                     MOVE RBKR      M1RREF                          135400
     C                     END                                            135400
      *                                                                   S01310
      **  Move 'M' into payment type to uniquely identify message         S01310
      *                                                                   S01310
     C                     MOVE 'M'       PAYT                            S01310
     C                     MOVE 'M'       PAYT                            S01310
     C           FULLRF    IFEQ 'Y'                                                        BUG15044A
     C                     MOVELDSPREF    TRNO                                             BUG15044A
     C                     ELSE                                                            BUG15044A
     C                     MOVE DSPREF    TRNO                            S01310
     C                     MOVEL'FT'      TRNO                            S01310
     C                     ENDIF                                                           BUG15044A
     C/COPY WNCPYSRC,FTH00325
      *                                                                   S01310
      ** Set up field 20 - Transaction reference number                   S01310
      *                                                                   S01310
     C*********************ADD  1         M                         S01310E32481
     C                     Z-ADD1         M                               E32481
     C           M         OCUR MULT                                      S01310
     C           CSW209    IFEQ 'Y'                                                           CSW209
      *                                                                                     BUG24736
      ** Check first if MT103/MT102 or MT202 is generated in Main.                          BUG24736
      *                                                                                     BUG24736
     C           OPOMVF    IFNE 'COV'                                                       BUG24736
     C**********           MOVELTRNO      TRNTYP 16                                BUG24736 BUG24801
     C           *LOVAL    SETLLMGOREFTR                                                    BUG24736
     C           M1RREF    CHAINMGOREFTR             31                                     BUG24736
      *                                                                                     BUG24736
      ** If transaction's message type is 202, set indicator for MT202 COV off              BUG24736
      ** regardless of the bilateral agreement.                                             BUG24736
      *                                                                                     BUG24736
     C           *IN31     IFEQ '0'                                                         BUG24736
     C********** MTPY      IFEQ '202'                                              BUG24736 BUG24801
     C           RMTPY     IFEQ '202'                                                       BUG24801
     C                     MOVE *OFF      *IN35                                             BUG24736
     C                     ENDIF                                                            BUG24736
     C                     ENDIF                                                            BUG24736
      *                                                                                     BUG24736
     C**********           MOVELTRNTYP    TRNO                                     BUG24736 BUG24801
     C                     ENDIF                                                            BUG24736
      *                                                                                     BUG24736
     C           *IN35     IFEQ '1'                                                           CSW209
      *                                                                                       CSW209
      ** Initialise work fileds for message data extension files                              CSW209
      *                                                                                       CSW209
     C                     MOVEL*BLANKS   CNT50   6                                           CSW209
     C                     MOVEL*BLANKS   CNT52   6                                           CSW209
     C                     MOVEL*BLANKS   CNT56   6                                           CSW209
     C                     MOVEL*BLANKS   CNT57   6                                           CSW209
     C                     MOVEL*BLANKS   CNT59   6                                           CSW209
     C                     MOVE *OFF      *IN61                                               CSW209
     C                     MOVE *OFF      *IN62                                               CSW209
     C                     MOVE *OFF      *IN63                                               CSW209
     C                     MOVE *OFF      *IN64                                               CSW209
     C                     MOVE *OFF      *IN65                                               CSW209
      *                                                                                       CSW209
      ** Access message data extension file to get the correct extension details              CSW209
      *                                                                                       CSW209
     C                     MOVELTRNO      COVTRN 16                                           CSW209
     C           *LOVAL    SETLLMGOEXTD0                                                      CSW209
     C           M1RREF    CHAINMGOEXTD0             30                                       CSW209
     C           *IN30     DOWNE'1'                                                           CSW209
     C                     MOVELMTG       #TAG    3                                           CSW209
     C           MTPY      IFEQ '103'                                                         CSW209
     C           MTPY      OREQ '202'                                                         CSW209
     C                     SELEC                                                              CSW209
     C           #TAG      WHEQ ':50'                                                         CSW209
     C                     MOVELMCSI      CNT50                                               CSW209
     C                     MOVE *ON       *IN61                                               CSW209
     C           #TAG      WHEQ ':52'                                                         CSW209
     C                     MOVELMCSI      CNT52                                               CSW209
     C                     MOVE *ON       *IN62                                               CSW209
     C           #TAG      WHEQ ':56'                                                         CSW209
     C                     MOVELMCSI      CNT56                                               CSW209
     C                     MOVE *ON       *IN63                                               CSW209
     C           #TAG      WHEQ ':57'                                                         CSW209
     C                     MOVELMCSI      CNT57                                               CSW209
     C                     MOVE *ON       *IN64                                               CSW209
     C           #TAG      WHEQ ':59'                                                         CSW209
     C                     MOVELMCSI      CNT59                                               CSW209
     C                     MOVE *ON       *IN65                                               CSW209
     C                     ENDSL                                                              CSW209
     C                     ENDIF                                                              CSW209
     C           M1RREF    READEMGOEXTD0                 30                                   CSW209
     C                     ENDDO                                                              CSW209
     C                     MOVELCOVTRN    TRNO                                                CSW209
      *                                                                                       CSW209
      **  Field :119: - Block 3 Data                                                          CSW209
      *                                                                                       CSW209
     C                     MOVEL':119:'   MTAG                                                CSW209
     C                     MOVEL'COV'     MFLD                                                CSW209
     C                     MOVEL'COV'     M1COV                                               CSW209
     C                     ADD  1         M                                                   CSW209
     C           M         OCUR MULT                                                          CSW209
     C                     ENDIF                                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     MOVEL':20: '   MTAG                            S01310
     C                     MOVELTRNO      MFLD                            S01310
     C*********************MOVE ':20:'    M1TG20                          S01310
     C*********************MOVELPREF      M1TREF                          S01310
     C*********************MOVE '1'       M1TREF                          S01310
     C                     MOVELTRNO      M1TREF                          S01310
      *                                                                   S01310
      ** Set up field 21 - Related reference number                       S01310
      *                                                                   S01310
     C                     ADD  1         M                               S01310
     C           M         OCUR MULT                                      S01310
     C                     MOVEL':21: '   MTAG                            S01310
     C                     MOVELM1RREF    MFLD                            S01310
     C                     MOVE PREF      MXTREF                          S01310
     C                     MOVE PVDTD3    M1VDAT
     C*********************MOVE ':21:'    M1TG21                          S01310
     C*********************MOVELPREF      M1RREF                          S01310
     C*********************MOVE ':32A:'   M1TG32                          S01310
     C*********************MOVE 'P'       MXMIND                          S01310
     C*********************MOVE PREF      PREFS  14                       S01310
     C*********************MOVELPREFS     MXTREF                          S01310
     C*********************MOVE '1'       MXTREF                          S01310
     C*********************MOVE *BLANKS   MXDFLG                          S01310
     C*********************MOVE '-'       M7HYPH                          S01310
     C*********************Z-ADD3         B03                             S01310
     C*********************MOVE X03       M7ETX                           S01310
     C*                                                                ***
     C                     ENDSR                           END SR10
     C/EJECT
     C********************************************************************
     C*********       SUBROUTINE 11                         ***        ***S01310
     C*********                                             ***        ***S01310
     C*********TO INCREMENT MESSAGES COUNT FIELD IN         ***        ***S01310
     C*********DATA*AREA*MSFCTL*******************************************E21286
     C*********DATA AREA FTFCTL                             ***     E21286S01310
     C*********************************************************        ***S01310
     C***********SR11      BEGSR                                       ***S01310
     C***********                                                      ***S01310
     C*****INCREMENT*MESSAGES*COUNT*FIELD*IN*DATAAREA*MSFCTL**************E21286
     C*****INCREMENT MESSAGES COUNT FIELD IN DATAAREA FTFCTL        E21286S01310
     C************NAMVAR   DEFN MSFCTL    DFCTL                           E21286
     C************NAMVAR   DEFN FTFCTL    DFCTL                     E21286S01310
     C************LOCK     IN   DFCTL                                     S01310
     C***********          ADD  1         DFOMC                           S01310
     C***********          ADD  1         DFOTL                           S01310
     C***********          OUT  DFCTL                                     S01310
     C***********                                                      ***S01310
     C***********          ENDSR                           END SR11       S01310
     C*EJECT                                                              S01310
     C********************************************************************
     C*     *         SUBROUTINE P1                         ***        ***
     C*     *                                               ***        ***
     C*     *   OUTPUT AN ENTRY TO SWIFT MESSAGE            ***        ***
     C*     *   REPORT PRTF/FT0648P1                        ***        ***
     C*     *                                               ***        ***
     C*********************************************************        ***
     C           SRP1      BEGSR                                       ***
     C                     ADD  1         PAGEP1                          S01117
     C                     WRITEP1H1                   80
     C           CSW209    IFEQ 'Y'                                                           CSW209
     C  N80                ADD  1         PAGEP1                                              CSW209
     C  N80                WRITEP1H2                   80                                     CSW209
     C                     ENDIF                                                              CSW209
     C*********************CLOSEFT0648P1                                  E32481
     C   80                DO                              B001
     C*                                                    ))))))))))))))
     C                     MOVE 'FT0648P1'DBFNAM           )))  DATA  )))
     C                     MOVEL'1'       DBERKY           )))  BASE  )))
     C                     MOVE 17        DBERR#           ))) ERROR  )))
     C                     EXSR DBERR                      )))   17   )))
     C*                                                    ))))))))))))))
     C                     END                             E001
     C*                                                                ***
     C                     ENDSR                           END SRP1
     C/EJECT
     C********************************************************************
     C*     *         SUBROUTINE P2                         ***        ***
     C*     *                                               ***        ***
     C*     *  TO HANDLE TELEX REPORT                       ***        ***
     C*     *                                               ***        ***
     C*     *                                               ***        ***
     C*********************************************************        ***
     C           SRP2      BEGSR                                       ***
     C*                                                                ***
     C/COPY WNCPYSRC,FT0648C029
     C           PAYT      IFEQ 'OP'
     C/COPY WNCPYSRC,FT0648C030
     C                     MOVEL'RECEIVIN'P2LIT1
     C                     MOVE 'G'       P2LIT1
     C                     ELSE
     C                     MOVEL'REMITTIN'P2LIT1
     C                     MOVE 'G'       P2LIT1
     C                     END
     C*                                                                ***
     C*  ** CHANGE OF CURRENCY, THEN PRINT ELS SUPPRESS CURRENCY       ***
     C*  ** 'CCNM' IS FROM TABLETG ACESS IN SR03 VIA SR06/SR07         ***
     C           P2CCY     IFNE CCNM
     C                     SETON                     14
     C                     Z-ADD0         MREC    10
     C                     MOVE CCNM      P2CCY
     C                     ELSE
     C                     ADD  1         MREC
     C                     SETOF                     14
     C                     END
     C*
     C           MREC      IFGT 1
     C                     SETON                     14
     C                     Z-ADD0         MREC
     C                     END
     C*                                                                ***
     C*  ** CONVERT PAY VALUE DATE FROM 'YYMMDD' TO 'DDMMMYY'          ***
     C                     MOVE PVDTD3    SDATE
     C                     MOVE MTH,SMM   WMM
     C                     MOVE SDD       WDD
     C                     MOVE SYY       WYY
     C*                                                                ***
     C*  ** CHANGE DATE THEN PRINT ELSE SUPRESS DATE PRINTING          ***
     C           WDATE     IFNE P2VAL
     C                     SETON                     15
     C                     Z-ADD0         DREC    10
     C                     MOVELWDATE     P2VAL
     C                     ELSE
     C                     ADD  1         DREC
     C                     SETOF                     15
     C                     END
     C*                                                                ***
     C           DREC      IFGT 1
     C                     SETON                     15
     C                     Z-ADD0         DREC
     C                     END
     C*                                                                ***
     C*********************MOVELPREF      P2REF                           S01310
     C           FULLRF    IFEQ 'Y'                                                        BUG15044A
     C                     MOVELPREF      TRNO                                             BUG15044A
     C                     ELSE                                                            BUG15044A
     C                     MOVE PREF      TRNO                            S01310
     C                     MOVEL'FT'      TRNO                            S01310
     C                     END                                                             BUG15044A
     C                     MOVELTRNO      P2REF                           S01310
     C*                                                                ***
     C* ** FORMAT BANK TO BANK INFORMATIONS                            ***
     C                     MOVE BBI1      P2BTB1                       ***
     C                     MOVE BBI2      P2BTB2                       ***
     C                     MOVE BBI3      P2BTB3                       ***
     C                     MOVE BBI4      P2BTB4                       ***
     C                     MOVE BBI5      P2BTB5                       ***
     C                     MOVE BBI6      P2BTB6                       ***
     C/COPY WNCPYSRC,FT0648C008
     C*                                                                ***
     C*  ** PRINT TELEX MESSAGE                                        ***
     C***14****************                                               S01117
     C*OR*15***************WRITEP2H1                   80                 S01117
     C           *IN14     IFEQ '1'                                       S01117
     C           *IN15     OREQ '1'                                       S01117
     C                     ADD  1         PAGEP2                          S01117
     C                     WRITEP2H1                   80                 S01117
     C                     END                                            S01117
     C   80                DO                              B001
     C*                                                    ))))))))))))))
     C                     MOVE 'FT0648P2'DBFNAM           )))  DATA  )))
     C                     MOVEL'2'       DBERKY           )))  BASE  )))
     C                     MOVE 19        DBERR#           ))) ERROR  )))
     C                     EXSR DBERR                      )))   19   )))
     C*                                                    ))))))))))))))
     C                     END                             E001
     C                     WRITEP2H2                                   ***
     C*********************CLOSEFT0648P2                                  E32481
     C*                                                                ***
     C*                                                                ***
     C                     ENDSR                           END SRP2
     C/EJECT
      *****************************************************************   S01310
      ****NWAD*-*determine*default*network*addresses***************S01310 CSW096
      ****Called*by*-*SR01*****************************************S01310 CSW096
      ****Calls*-*none*********************************************S01310 CSW096
      *************************************************************S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********NWAD      BEGSR                                   S01310 CSW096
      ***********                                                  S01310 CSW096
      ****Default*is*SWIFT*****************************************S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********BBDNW2    IFEQ 'SWIFT'                            S01310 CSW096
     C***********BBCSID    ANDNE*BLANKS                            S01310 CSW096
     C***********@BIC      ANDNE'BIC'                              S01310 CSW096
     C***********BGMSDL    ANDEQ'Y'                                S01310 CSW096
     C***********          MOVELSCSID     NWSN                      S01310064393
     C***********          MOVELSNCSID    NWSN                     064393 CSW096
     C***********          MOVELBBCSID    NWDS                     S01310 CSW096
     C***********          MOVELBBDNW2    NWRK                     S01310 CSW096
     C***********          MOVE 'Y'       OSUFLG                   S01310 CSW096
     C***********          END                                     S01310 CSW096
      ***********                                                  S01310 CSW096
      ****Default*is*TELEX*****************************************S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********BBDNW2    IFEQ 'TELEX'                            S01310 CSW096
     C***********BBTXA1    ANDNE*BLANKS                            S01310 CSW096
     C***********BGMTMI    ANDEQ'Y'                                S01310 CSW096
     C***********          MOVELSTELX     NWSN                     S01310 CSW096
     C***********          MOVELBBTXA1    NWDS                     S01310 CSW096
     C***********          MOVELBBDNW2    NWRK                     S01310 CSW096
     C***********          MOVE 'Y'       OSUFLG                   S01310 CSW096
     C***********          END                                     S01310 CSW096
      ***********                                                  S01310 CSW096
      ****Default*is*STTX******************************************S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********BBDNW2    IFEQ 'STTX'                             S01310 CSW096
     C***********BBSTAD    ANDNE*BLANKS                            S01310 CSW096
     C***********BGMSDL    ANDEQ'Y'                                S01310 CSW096
     C***********          MOVELSSTTX     NWSN                     S01310 CSW096
     C***********          MOVELBBSTAD    NWDS                     S01310 CSW096
     C***********          MOVELBBDNW2    NWRK                     S01310 CSW096
     C***********          MOVE 'Y'       OSUFLG                   S01310 CSW096
     C***********          END                                     S01310 CSW096
      ***********                                                  S01310 CSW096
      ****Default*is*PAPER*****************************************S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********BBDNW2    IFEQ 'PAPER'                            S01310 CSW096
     C***********          MOVELSCRNM     NWSN                     S01310 CSW096
     C***********          MOVELBBCRNM    NWDS                     S01310 CSW096
     C***********          MOVELBBDNW2    NWRK                     S01310 CSW096
     C***********          MOVE 'RSND'    MGST                     S01310 CSW096
     C***********          MOVE '2'       MGSG                     S01310 CSW096
     C***********          MOVE 'N'       OSUFLG                   S01310 CSW096
     C***********          END                                     S01310 CSW096
      ***********                                                  S01310 CSW096
      ****Found*to*be*unroutable***********************************S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********NWRK      IFEQ *BLANKS                            S01310 CSW096
     C***********NWDS      OREQ *BLANKS                            S01310 CSW096
     C***********NWSN      OREQ *BLANKS                            S01310 CSW096
     C***********          MOVELSCRNM     NWSN                     S01310 CSW096
     C***********          MOVELBBCRNM    NWDS                     S01310 CSW096
     C***********          MOVEL'UNROUT'  NWRK                     S01310 CSW096
     C***********          MOVE 'CRTD'    MGST                     S01310 CSW096
     C***********          END                                     S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********          ENDSR                                   S01310 CSW096
     C*/EJECT****                                                  S01310 CSW096
      *************************************************************S01310 CSW096
      ****PRAD*-*determine*settlement*network*address**************S01310 CSW096
      ****Called*by*-*SR01*****************************************S01310 CSW096
      ****Calls*-*none*********************************************S01310 CSW096
      *************************************************************S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********PRAD      BEGSR                                   S01310 CSW096
      ***********                                                  S01310 CSW096
      ****Set*up*priority*sender,*destination*&*network************S01310 CSW096
      ***********                                                  S01310 CSW096
      ****'S'*=*SWIFT;*'T'*=*TELEX;*'X'*=*STTX*********************S01310 CSW096
      ***********                                                  S01310 CSW096
      *******************(1)**(2)**(3)**(4)**(5)**(6)**(7)*********S01310 CSW096
      ****-------------------------------------------------********S01310 CSW096
      ****SWIFT*ADDRESS  Y   N   N   Y   Y   Y   Y ********S01310 CSW096
      ****TELEX*ADDRESS  N   Y   N   Y   Y   N   N ********S01310 CSW096
      ****STTX*ADDRESS*  N   N   Y   N   N   Y   Y ********S01310 CSW096
      ****SETT.*TYPE***             01  08  01  08 ********S01310 CSW096
      ****-------------------------------------------------********S01310 CSW096
      ****DESTN*=*CSID*  X               X       X ********S01310 CSW096
      ****DESTN*=*TELX*      X       X             ********S01310 CSW096
      ****DESTN*=*STTX*          X           X     ********S01310 CSW096
      ****-------------------------------------------------********S01310 CSW096
      ****MESSAGE*ROUTE                            ********S01310 CSW096
      ****CODE*(SWTX)**  S   T   X   T   S   X   S ********S01310 CSW096
      ***********                                                  S01310 CSW096
      ****New*field*names*already*moved*to*old*********************S01310 CSW096
      ***********                                                  S01310 CSW096
      ****SWIFT*?**************************************************S01310 CSW096
      ****(1)******************************************************S01310 CSW096
     C***********          MOVE CSID      CSBIC   4                S01310 CSW096
     C***********BGMSDL    IFEQ 'Y'                                S01310 CSW096
     C***********CSBIC     ANDNE'BIC '                             S01310 CSW096
     C***********CSID      IFNE *BLANKS                            S01310 CSW096
     C***********TELX      ANDEQ*BLANKS                            S01310 CSW096
     C***********STTX      ANDEQ*BLANKS                            S01310 CSW096
      ****(5)******************************************************S01310 CSW096
     C***********CSID      ORNE *BLANKS                            S01310 CSW096
     C***********TELX      ANDNE*BLANKS                            S01310 CSW096
     C***********STTX      ANDEQ*BLANKS                            S01310 CSW096
     C***********STMT      ANDEQ08                                 S01310 CSW096
      ****(7)******************************************************S01310 CSW096
     C***********CSID      ORNE *BLANKS                            S01310 CSW096
     C***********TELX      ANDEQ*BLANKS                            S01310 CSW096
     C***********STTX      ANDNE*BLANKS                            S01310 CSW096
     C***********STMT      ANDEQ08                                 S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********          MOVE CSID      CSID   12                S01310 CSW096
     C***********          MOVE 'S'       SWTX    1                S01310 CSW096
     C***********          MOVELSCSID     NWSN                      S01310064393
     C***********          MOVELSNCSID    NWSN                     064393 CSW096
     C***********          MOVELCSID      NWDS                     S01310 CSW096
     C***********          MOVEL'SWIFT'   NWRK                     S01310 CSW096
     C***********          MOVE 'Y'       OSUFLG  1                S01310 CSW096
     C***********          END                                     S01310 CSW096
     C***********          END                                     S01310 CSW096
      ****(2)******************************************************S01310 CSW096
     C***********BGMTMI    IFEQ 'Y'                                S01310 CSW096
     C***********CSID      IFEQ *BLANKS                            S01310 CSW096
     C***********TELX      ANDNE*BLANKS                            S01310 CSW096
     C***********STTX      ANDEQ*BLANKS                            S01310 CSW096
      ****(4)******************************************************S01310 CSW096
     C***********CSID      ORNE *BLANKS                            S01310 CSW096
     C***********TELX      ANDNE*BLANKS                            S01310 CSW096
     C***********STTX      ANDEQ*BLANKS                            S01310 CSW096
     C***********STMT      ANDEQ01                                 S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********          MOVE 'T'       SWTX                     S01310 CSW096
     C***********          MOVELSTELX     NWSN                     S01310 CSW096
     C***********          MOVELTELX      NWDS                     S01310 CSW096
     C***********          MOVEL'TELEX'   NWRK                     S01310 CSW096
     C***********          MOVE 'Y'       OSUFLG                   S01310 CSW096
     C***********          END                                     S01310 CSW096
     C***********          END                                     S01310 CSW096
      ***********                                                  S01310 CSW096
      ****STTX*network*available*?*********************************S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********BGMSDL    IFEQ 'Y'                                S01310 CSW096
      ****(3)******************************************************S01310 CSW096
     C***********CSID      IFEQ *BLANKS                            S01310 CSW096
     C***********TELX      ANDEQ*BLANKS                            S01310 CSW096
     C***********STTX      ANDNE*BLANKS                            S01310 CSW096
      ****(6)******************************************************S01310 CSW096
     C***********CSID      ORNE *BLANKS                            S01310 CSW096
     C***********TELX      ANDEQ*BLANKS                            S01310 CSW096
     C***********STTX      ANDNE*BLANKS                            S01310 CSW096
     C***********STMT      ANDEQ01                                 S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********          MOVE 'X'       SWTX                     S01310 CSW096
     C***********          MOVELSSTTX     NWSN                     S01310 CSW096
     C***********          MOVELSTTX      NWDS                     S01310 CSW096
     C***********          MOVEL'STTX'    NWRK                     S01310 CSW096
     C***********          MOVE 'Y'       OSUFLG                   S01310 CSW096
     C***********          END                                     S01310 CSW096
     C***********          END                                     S01310 CSW096
      ***********                                                  S01310 CSW096
      ***Found*to*be*unroutable.***********************************S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********NWRK      IFEQ *BLANKS                            S01310 CSW096
     C***********NWSN      OREQ *BLANKS                            S01310 CSW096
     C***********          MOVELSCRNM     NWSN                     S01310 CSW096
     C***********          MOVELCRNM      NWDS                     S01310 CSW096
     C***********          MOVEL'UNROUT'  NWRK                     S01310 CSW096
     C***********          MOVE 'CRTD'    MGST                     S01310 CSW096
     C***********          MOVE '1'       MGSG                     S01310 CSW096
     C***********          MOVE 'Y'       OSUFLG                   S01310 CSW096
     C***********          END                                     S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********          ENDSR                                   S01310 CSW096
     C*/EJECT****                                                  S01310 CSW096
      *************************************************************S01310 CSW096
      ****FILL*-*Fill*up*array**DFS********************************S01310 CSW096
      ****Called*by*-*SR01.****************************************S01310 CSW096
      ****Calls*-*none*********************************************S01310 CSW096
      *************************************************************S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********FILL      BEGSR                                   S01310 CSW096
      ***********                                                  S01310 CSW096
      ****Is*message*to*be*generated*as*released*?*****************S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********          MOVE BBDS01    DFS,1                    S01310 CSW096
     C***********          MOVE BBDS02    DFS,2                    S01310 CSW096
     C***********          MOVE BBDS03    DFS,3                    S01310 CSW096
     C***********          MOVE BBDS04    DFS,4                    S01310 CSW096
     C***********          MOVE BBDS05    DFS,5                    S01310 CSW096
     C***********          MOVE BBDS06    DFS,6                    S01310 CSW096
     C***********          MOVE BBDS07    DFS,7                    S01310 CSW096
     C***********          MOVE BBDS08    DFS,8                    S01310 CSW096
     C***********          MOVE BBDS09    DFS,9                    S01310 CSW096
     C***********          MOVE BBDS10    DFS,10                   S01310 CSW096
     C***********          MOVE BBDS11    DFS,11                   S01310 CSW096
     C***********          MOVE BBDS12    DFS,12                   S01310 CSW096
     C***********          MOVE BBDS13    DFS,13                   S01310 CSW096
     C***********          MOVE BBDS14    DFS,14                   S01310 CSW096
     C***********          MOVE BBDS15    DFS,15                   S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********          ENDSR                                   S01310 CSW096
     C/EJECT                                                              S01310
      *****************************************************************   CSW096
      *   SRROUT - determine message routing                          *   CSW096
      *   Called by - SR01                                            *   CSW096
      *   Calls -                                                     *   CSW096
      *****************************************************************   CSW096
      *                                                                   CSW096
     C           SRROUT    BEGSR                                          CSW096
      *                                                                   CSW096
     C                     MOVE BRCA      I@SNBR                          CSW096
     C                     MOVE *BLANKS   I@DSCN                          CSW096
     C                     MOVE CUSTNO    I@DSCN                          CSW096
     C                     MOVE '202'     I@MTPY                          CSW096
     C                     MOVE 'N'       I@CONC                          CSW096
     C                     Z-ADDSTMT      I@SETT                          CSW096
     C                     MOVE FTCS      I@FTCS                          CSW096
     C                     MOVE MODI      I@MMOD                          CSW096
      *###################################################################CSW096
      *                                                                  #CSW096
      * Below are two copy sources intended for setting up the custom    #CSW096
      * parameter (P@ZZ) in the call to MG9900.                          #CSW096
      * One (MG9900FTCL) is in ALL MG generation programs and is for use #CSW096
      * when a change is required to all of them.                        #CSW096
      * The other is only in this program.                               #CSW096
     C/COPY WNCPYSRC,MG9900FTCL                                          #CSW096
     C/COPY WNCPYSRC,FT0648ROUT                                          #CSW096
      *                                                                  #CSW096
      *###################################################################CSW096
     C                     CALL 'MG9900'                                  CSW096
     C                     PARM *BLANKS   @RTCD                           CSW096
     C                     PARM           P@IN                            CSW096
     C                     PARM *BLANKS   P@OUT                           CSW096
     C                     PARM           P@ZZ  256                       CSW096
      *                                                                   CSW096
     C           @RTCD     IFNE *BLANKS                                   CSW096
     C                     MOVE '92'      DBERR#             * * * * * * *CSW096
     C                     MOVEL'*CALL'   DBERKY             * DBERR 920 *CSW096
     C                     MOVEL'MG9900  'DBFNAM             * * * * * * *CSW096
     C                     EXSR DBERR                                     CSW096
     C                     ELSE                                           CSW096
     C                     MOVE O@NWRK    NWRK                            CSW096
     C                     MOVE O@NWSN    NWSN                            CSW096
     C                     MOVE O@NWDS    NWDS                            CSW096
     C                     MOVE O@MGSG    MGSG                            CSW096
     C                     MOVE O@MGST    MGST                            CSW096
     C                     MOVE O@PCNB    CPAR                            CSW096
     C                     END                                            CSW096
      *                                                                   CSW096
      ** Change the Network to 'PAPER' if the Precious Metal Indicator                        CSW215
      ** of the currency is 'Y' and Network is currently set to 'SWIFT'                       CSW215
      *                                                                                       CSW215
     C           CSW215    IFEQ 'Y'                                                           CSW215
     C                     CALL 'AOCURRR0'                                                    CSW215
     C                     PARM *BLANKS   PRTCD                                               CSW215
     C                     PARM '*KEY   ' POPTN                                               CSW215
     C                     PARM PCCY      PWCCY                                               CSW215
     C           SDCURR    PARM SDCURR    DSSDY                                               CSW215
      *                                                                                       CSW215
     C           PRTCD     IFNE *BLANKS                                                       CSW215
     C                     MOVE '035'     DBERR#                                              CSW215
     C                     MOVELPCCY      DBERKY                                              CSW215
     C                     MOVEL'SDCURRPD'DBFNAM                                              CSW215
     C                     EXSR DBERR                                                         CSW215
     C                     ENDIF                                                              CSW215
      *                                                                                       CSW215
     C           PRTCD     IFEQ *BLANKS                                                       CSW215
     C           NWRK      ANDEQ'SWIFT'                                                       CSW215
     C           A6PMRT    ANDEQ'Y'                                                           CSW215
     C                     MOVEL'PAPER'   NWRK                                                CSW215
     C                     ENDIF                                                              CSW215
     C                     ENDIF                                                              CSW215
      *                                                                                       CSW215
     C           BBDNW2    IFEQ *BLANKS                                   CSW096
     C           NWRK      IFEQ 'SWIFT'                                   CSW096
     C                     MOVE 'S'       SWTX    1                       CSW096
     C                     END                                            CSW096
     C           NWRK      IFEQ 'TELEX'                                   CSW096
     C                     MOVE 'T'       SWTX                            CSW096
     C                     END                                            CSW096
     C           NWRK      IFEQ 'STTX'                                    CSW096
     C                     MOVE 'X'       SWTX                            CSW096
     C                     END                                            CSW096
     C                     END                                            CSW096
      *                                                                   CSW096
     C           NWRK      IFNE 'PAPER'                                   CSW096
     C                     MOVE 'Y'       OSUFLG  1                       CSW096
     C                     ELSE                                           CSW096
     C                     MOVE 'N'       OSUFLG                          CSW096
     C                     END                                            CSW096
      *                                                                   CSW096
     C                     ENDSR                                          CSW096
      /EJECT                                                              138077
      *****************************************************************   138077
      *                                                               *   138077
      *   SEXTN - Store customer with SWIFT address to data structure *   138077
      *                                                               *   138077
      *****************************************************************   138077
      *                                                                   138077
     C           SEXTN     BEGSR                                          138077
      *                                                                   138077
     C                     MOVELMTAG      @MTG                            138077
     C           CSW209    IFEQ 'Y'                                                           CSW209
     C           MTAG      ANDEQ*BLANKS                                                       CSW209
     C                     MOVELEXTTAG    @MTG                                                CSW209
     C                     ENDIF                                                              CSW209
     C           FLDTYP    IFEQ '5'                                       138077
     C           FLDTAG    ANDEQ'A'                                       138077
     C           FLDTYP    OREQ '5'                                                           CSW209
     C           FLDTAG    ANDEQ'F'                                                           CSW209
     C           CSW209    ANDEQ'Y'                                                           CSW209
     C                     ADD  1         V                               138077
     C           V         OCUR EXTN                                      138077
     C                     Z-ADDM         MPSN                            138077
     C                     MOVEL@MTG      MTG                             138077
     C                     MOVELBBCUST    MCSI                            138077
     C                     ENDIF                                          138077
      *                                                                   138077
     C           SEXT9     ENDSR                                          138077
     C/COPY WNCPYSRC,FTH00312
     C/EJECT                                                              CSW096
      *****************************************************************   E32481
      *   INTF - Initalise non-constant fields                        *   E32481
      *   Called by - main process                                    *   E32481
      *   Calls     -                                                 *   E32481
      *****************************************************************   E32481
      *                                                                   E32481
     C           INTF      BEGSR                                          E32481
      *                                                                   E32481
     C                     MOVE *BLANKS   TRNO                            E32481
     C                     MOVE '      '  NWRK                            E32481
     C**********           Z-ADD0         SECN                                         E32481 CSD027
     C                     MOVE *BLANKS   SECN                                                CSD027
     C                     MOVE *BLANKS   NWSN                            E32481
     C**********           Z-ADD0         DECN                                         E32481 CSD027
     C                     MOVE *BLANKS   DECN                                                CSD027
     C                     MOVE *BLANKS   NWDS                            E32481
     C                     MOVE *BLANKS   MGSG                            E32481
     C                     MOVE *BLANKS   MGST                            E32481
     C                     Z-ADD0         MGTM                            E32481
     C                     Z-ADD0         LATM                            E32481
     C                     MOVE *BLANKS   RELD                            E32481
     C                     Z-ADD0         RELT                            E32481
     C                     MOVE *BLANKS   AMTS                            E32481
     C                     MOVE *BLANKS   SVDT                            E32481
     C                     MOVE *BLANKS   CINDV                           164663
      *                                                                   E32481
     C                     MOVE *BLANKS   SNCSID 12                       E32481
     C                     MOVE *BLANKS   STELX  10                       E32481
     C                     MOVE *BLANKS   SSTTX  12                       E32481
     C                     MOVE *BLANKS   SCRNM  20                       E32481
      *                                                                   E32481
      **  Clear multiple occurrence data structure                        E32481
      *                                                                   E32481
     C                     Z-ADD1         Q       20                      E32481
     C           Q         OCUR MULT                                      E32481
      *                                                                   E32481
     C           Q         DOWLE50                                        E32481
     C           MULT      ANDNE*BLANKS                                   E32481
     C                     MOVE *BLANKS   MULT                            E32481
     C                     ADD  1         Q                               E32481
     C           Q         OCUR MULT                                      E32481
     C                     END                                            E32481
      *                                                                   138077
      ** Clear multiple occurrence DS for the extension file.             138077
      *                                                                   138077
     C                     Z-ADD1         V       20                      138077
     C           V         OCUR EXTN                                      138077
     C           V         DOWLE20                                        138077
     C           MCSI      ANDNE*BLANKS                                   138077
     C                     Z-ADD*ZEROS    MPSN                            138077
     C                     MOVE *BLANKS   MTG                             138077
     C                     MOVE *BLANKS   MCSI                            138077
     C                     ADD  1         V                               138077
     C           V         OCUR EXTN                                      138077
     C                     ENDDO                                          138077
     C                     Z-ADD0         V                               138077
      *                                                                   CFT014
      ** Third Reimbursement Institution work fields                      CFT014
     C                     MOVE *BLANKS   WTRI1  35                       CFT014
     C                     MOVE *BLANKS   WTRI2  35                       CFT014
     C                     MOVE *BLANKS   WTRI3  35                       CFT014
     C                     MOVE *BLANKS   WTRI4  35                       CFT014
     C                     MOVE *BLANKS   WTRI5  35                       CFT014
     C                     MOVE *BLANK    WTRITG  1                       CFT014
     C                     MOVE 'N'       WTRIOK  1                       CFT014
      *                                                                   CFT014
     C                     MOVE *BLANKS   P1IBK1                          CFT014
     C                     MOVE *BLANKS   P1IBK2                          CFT014
     C                     MOVE *BLANKS   P1IBK3                          CFT014
     C                     MOVE *BLANKS   P1IBK4                          CFT014
     C                     MOVE *BLANKS   P1IBK5                          CFT014
     C                     MOVE *BLANK    P1IBKT                          CFT014
      *                                                                   E32481
      ** Check if FT MTmsg will use full Reference in Swift Message                        BUG15044A
      ** Reference field :20:                                                              BUG15044A
     C                     CALL 'AOSVALR0'                                                 BUG15044A
     C                     PARM *BLANKS   W0RTCD  7                                        BUG15044A
     C                     PARM SVAL,1    P@OP01 20                                        BUG15044A
     C                     PARM *BLANKS   P@VL01200                                        BUG15044A
     C                     PARM *BLANKS   P@OP02 20                                        BUG15044A
     C                     PARM *BLANKS   P@VL02200                                        BUG15044A
     C                     PARM *BLANKS   P@OP03 20                                        BUG15044A
     C                     PARM *BLANKS   P@VL03200                                        BUG15044A
     C                     PARM *BLANKS   P@OP04 20                                        BUG15044A
     C                     PARM *BLANKS   P@VL04200                                        BUG15044A
     C                     PARM *BLANKS   P@OP05 20                                        BUG15044A
     C                     PARM *BLANKS   P@VL05200                                        BUG15044A
     C                     PARM *BLANKS   P@OP06 20                                        BUG15044A
     C                     PARM *BLANKS   P@VL06200                                        BUG15044A
     C                     PARM *BLANKS   P@OP07 20                                        BUG15044A
     C                     PARM *BLANKS   P@VL07200                                        BUG15044A
     C                     PARM *BLANKS   P@OP08 20                                        BUG15044A
     C                     PARM *BLANKS   P@VL08200                                        BUG15044A
     C                     PARM *BLANKS   P@OP09 20                                        BUG15044A
     C                     PARM *BLANKS   P@VL09200                                        BUG15044A
     C                     PARM *BLANKS   P@OP10 20                                        BUG15044A
     C                     PARM *BLANKS   P@VL10200                                        BUG15044A
      *                                                                                    BUG15044A
      ** If 'Y' Use Full Reference, i.e. FT+PREF as field :20: TRNO                        BUG15044A
     C           P@VL01    IFEQ 'Y'                                                        BUG15044A
     C                     MOVE 'Y'       FULLRF  1                                        BUG15044A
     C                     ELSE                                                            BUG15044A
     C                     MOVE 'N'       FULLRF                                           BUG15044A
     C                     ENDIF                                                           BUG15044A
      *                                                                                    BUG15044A
     C/COPY WNCPYSRC,FTH00020
     C                     ENDSR                                          E32481
     C/EJECT                                                              E32481
     C************************************************************                            CSW209
     C* SRCOV - Setup Cover message fields to be output in                                    CSW209
     C*         MGOMSGPD                                                                      CSW209
     C************************************************************                            CSW209
     C*                                                                                       CSW209
     C           SRCOV     BEGSR                                                              CSW209
      *                                                                                       CSW209
      ** Field :50 - Ordering Customer (Cover)                                                CSW209
      *                                                                                       CSW209
     C           OPCOC1    IFNE *BLANKS                                                       CSW209
     C           OPCOC2    ORNE *BLANKS                                                       CSW209
     C           OPCOC3    ORNE *BLANKS                                                       CSW209
     C           OPCOC4    ORNE *BLANKS                                                       CSW209
     C           OPCOC5    ORNE *BLANKS                                                       CSW209
      *                                                                                       CSW209
     C           OPCOC1    IFNE *BLANKS                                                       CSW209
      *                                                                                       CSW209
     C                     ADD  1         M                                                   CSW209
     C           M         OCUR MULT                                                          CSW209
     C           OPCOCT    IFEQ 'A'                                                           CSW209
     C                     MOVELOPCOCT    PACCTP                                              CSW209
     C                     MOVELOPCOC1    P@IN1                                               CSW209
     C                     MOVE OPCOC2    P@IN2                                               CSW209
     C                     MOVE OPCOC3    P@IN3                                               CSW209
     C                     MOVE OPCOC4    P@IN4                                               CSW209
     C                     MOVE OPCOC5    P@IN5                                               CSW209
      *                                                                                       CSW209
      ** Call FT001000 to check for 50 Tag                                                    CSW209
      *                                                                                       CSW209
     C                     CALL 'FT001000'                                                    CSW209
     C                     PARM *BLANKS   PRTRN   7                                           CSW209
     C                     PARM *BLANKS   PMSID   7                                           CSW209
     C                     PARM *BLANK    PERTP   1                                           CSW209
     C                     PARM 'FRMT'    PVTYP   4                                           CSW209
     C                     PARM           P@IN1  35                                           CSW209
     C                     PARM           P@IN2  35                                           CSW209
     C                     PARM           P@IN3  35                                           CSW209
     C                     PARM           P@IN4  35                                           CSW209
     C                     PARM           P@IN5  35                                           CSW209
     C                     PARM           PACCTP  1                                           CSW209
     C                     PARM *BLANKS   PACCD  34                                           CSW209
     C                     PARM *BLANKS   @CUST   6                                           CSW209
     C                     PARM *BLANKS   PNAHO  10                                           CSW209
     C                     PARM 'SWIFT'   PNTWRK  6                                           CSW209
     C                     PARM '202'     PMSGTP  3                                           CSW209
     C                     PARM ':50F:'   PMSTAG  5                                           CSW209
     C                     PARM *BLANKS   @CNTLC  2                                           CSW209
     C                     PARM           BRCAA                                               CSW209
     C                     PARM           PCCY                                                CSW209
     C                     PARM *BLANKS   @NOSTN  2                                           CSW209
     C                     PARM 'FT'      PMODI   2                                           CSW209
     C                     PARM           PMSGL1 35                                           CSW209
     C                     PARM           PMSGL2 35                                           CSW209
     C                     PARM           PMSGL3 35                                           CSW209
     C                     PARM           PMSGL4 35                                           CSW209
     C                     PARM           PMSGL5 35                                           CSW209
      *                                                                                       CSW209
     C           PRTRN     IFEQ *BLANKS                                                       CSW209
     C                     MOVEL'F'       P1COCT                                              CSW209
     C                     MOVEL':50F:'   MTAG                                                CSW209
     C                     ELSE                                                               CSW209
     C                     MOVEL'K'       P1COCT                                              CSW209
     C                     MOVEL':50K:'   MTAG                                                CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C           OPCOCT    IFEQ 'S'                                                           CSW209
     C                     MOVEL'A'       OPCOCT                                              CSW209
     C                     MOVEL':50A:'   MTAG                                                CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     MOVELMTAG      EXTTAG                                              CSW209
     C                     MOVELOPCOC1    MFLD                                                CSW209
     C           CFT124    IFEQ 'N'                                                           CFT124
     C                     MOVELOPCOC1    P1COC1                                              CSW209
     C                     ELSE                                                               CFT124
     C           W#AFMT    IFEQ 'Y'                                                           CFT124
     C           '/'       CAT  ORC1:0    P1COC1                                              CFT124
     C                     ENDIF                                                              CFT124
     C                     ENDIF                                                              CFT124
      *                                                                                       CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C           OPCOC2    IFNE *BLANKS                                                       CSW209
     C                     ADD  1         M                                                   CSW209
     C           M         OCUR MULT                                                          CSW209
     C                     MOVELOPCOC2    MFLD                                                CSW209
     C                     MOVELOPCOC2    P1COC2                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C           OPCOC3    IFNE *BLANKS                                                       CSW209
     C                     ADD  1         M                                                   CSW209
     C           M         OCUR MULT                                                          CSW209
     C                     MOVELOPCOC3    MFLD                                                CSW209
     C                     MOVELOPCOC3    P1COC3                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C           OPCOC4    IFNE *BLANKS                                                       CSW209
     C                     ADD  1         M                                                   CSW209
     C           M         OCUR MULT                                                          CSW209
     C                     MOVELOPCOC4    MFLD                                                CSW209
     C                     MOVELOPCOC4    P1COC4                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C           OPCOC5    IFNE *BLANKS                                                       CSW209
     C                     ADD  1         M                                                   CSW209
     C           M         OCUR MULT                                                          CSW209
     C                     MOVELOPCOC5    MFLD                                                CSW209
     C                     MOVELOPCOC5    P1COC5                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C   61                MOVELCNT50     BBCUST                                              CSW209
     C   61                EXSR SEXTN                                                         CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
      ** Field :52 : - Ordering Institution (Cover)                                           CSW209
      *                                                                                       CSW209
     C           OPCOB1    IFNE *BLANK                                                        CSW209
     C           OPCOB2    ORNE *BLANK                                                        CSW209
     C           OPCOB3    ORNE *BLANK                                                        CSW209
     C           OPCOB4    ORNE *BLANK                                                        CSW209
     C           OPCOB5    ORNE *BLANK                                                        CSW209
      *                                                                                       CSW209
     C           OPCOB1    IFNE *BLANKS                                                       CSW209
     C                     ADD  1         M                                                   CSW209
     C           M         OCUR MULT                                                          CSW209
     C           OPCOBT    IFEQ 'S'                                                           CSW209
     C                     MOVEL'A'       P1COBT                                              CSW209
     C                     MOVEL':52A:'   MTAG                                                CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C           OPCOBT    IFEQ 'A'                                                           CSW209
     C                     MOVEL'D'       P1COBT                                              CSW209
     C                     MOVEL':52D:'   MTAG                                                CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     MOVELMTAG      EXTTAG                                              CSW209
     C                     MOVELOPCOB1    MFLD                                                CSW209
     C                     MOVELOPCOB1    P1COB1                                              CSW209
      *                                                                                       CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C           OPCOB2    IFNE *BLANKS                                                       CSW209
     C                     ADD  1         M                                                   CSW209
     C           M         OCUR MULT                                                          CSW209
     C                     MOVELOPCOB2    MFLD                                                CSW209
     C                     MOVELOPCOB2    P1COB2                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C           OPCOB3    IFNE *BLANKS                                                       CSW209
     C                     ADD  1         M                                                   CSW209
     C           M         OCUR MULT                                                          CSW209
     C                     MOVELOPCOB3    MFLD                                                CSW209
     C                     MOVELOPCOB3    P1COB3                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C           OPCOB4    IFNE *BLANKS                                                       CSW209
     C                     ADD  1         M                                                   CSW209
     C           M         OCUR MULT                                                          CSW209
     C                     MOVELOPCOB4    MFLD                                                CSW209
     C                     MOVELOPCOB4    P1COB4                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C           OPCOB5    IFNE *BLANKS                                                       CSW209
     C                     ADD  1         M                                                   CSW209
     C           M         OCUR MULT                                                          CSW209
     C                     MOVELOPCOB5    MFLD                                                CSW209
     C                     MOVELOPCOB5    P1COB5                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C   62                MOVELCNT52     BBCUST                                              CSW209
     C   62                EXSR SEXTN                                                         CSW209
      *                                                                                       CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
      ** Field :56 - Intermediary Institution (Cover)                                         CSW209
      *                                                                                       CSW209
     C           OPCIB1    IFNE *BLANK                                                        CSW209
     C           OPCIB2    ORNE *BLANK                                                        CSW209
     C           OPCIB3    ORNE *BLANK                                                        CSW209
     C           OPCIB4    ORNE *BLANK                                                        CSW209
     C           OPCIB5    ORNE *BLANK                                                        CSW209
      *                                                                                       CSW209
     C           OPCIB1    IFNE *BLANKS                                                       CSW209
     C                     ADD  1         M                                                   CSW209
     C           M         OCUR MULT                                                          CSW209
     C                     SELEC                                                              CSW209
     C           OPCIBT    WHEQ 'S'                                                           CSW209
     C                     MOVEL'A'       P1CIBT                                              CSW209
     C                     MOVEL':56A:'   MTAG                                                CSW209
     C           OPCIBT    WHEQ 'Z'                                                           CSW209
     C                     MOVEL'C'       P1CIBT                                              CSW209
     C                     MOVEL':56C:'   MTAG                                                CSW209
     C           OPCIBT    WHEQ 'A'                                                           CSW209
     C                     MOVEL'D'       P1CIBT                                              CSW209
     C                     MOVEL':56D:'   MTAG                                                CSW209
     C                     ENDSL                                                              CSW209
      *                                                                                       CSW209
     C                     MOVELMTAG      EXTTAG                                              CSW209
     C                     MOVELOPCIB1    MFLD                                                CSW209
     C                     MOVELOPCIB1    P1CIB1                                              CSW209
      *                                                                                       CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C           OPCIB2    IFNE *BLANKS                                                       CSW209
     C                     ADD  1         M                                                   CSW209
     C           M         OCUR MULT                                                          CSW209
     C                     MOVELOPCIB2    MFLD                                                CSW209
     C                     MOVELOPCIB2    P1CIB2                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C           OPCIB3    IFNE *BLANKS                                                       CSW209
     C                     ADD  1         M                                                   CSW209
     C           M         OCUR MULT                                                          CSW209
     C                     MOVELOPCIB3    MFLD                                                CSW209
     C                     MOVELOPCIB3    P1CIB3                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C           OPCIB4    IFNE *BLANKS                                                       CSW209
     C                     ADD  1         M                                                   CSW209
     C           M         OCUR MULT                                                          CSW209
     C                     MOVELOPCIB4    MFLD                                                CSW209
     C                     MOVELOPCIB4    P1CIB4                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C           OPCIB5    IFNE *BLANKS                                                       CSW209
     C                     ADD  1         M                                                   CSW209
     C           M         OCUR MULT                                                          CSW209
     C                     MOVELOPCIB5    MFLD                                                CSW209
     C                     MOVELOPCIB5    P1CIB5                                              CSW209
     C                     ENDIF                                                              CSW209
     C   63                MOVELCNT56     BBCUST                                              CSW209
     C   63                EXSR SEXTN                                                         CSW209
      *                                                                                       CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
      ** Field :57 - Account with Institution (Cover)                                         CSW209
      *                                                                                       CSW209
     C           OPCAB1    IFNE *BLANK                                                        CSW209
     C           OPCAB2    ORNE *BLANK                                                        CSW209
     C           OPCAB3    ORNE *BLANK                                                        CSW209
     C           OPCAB4    ORNE *BLANK                                                        CSW209
     C           OPCAB5    ORNE *BLANK                                                        CSW209
      *                                                                                       CSW209
     C           OPCAB1    IFNE *BLANKS                                                       CSW209
     C                     ADD  1         M                                                   CSW209
     C           M         OCUR MULT                                                          CSW209
     C                     SELEC                                                              CSW209
     C           OPCABT    WHEQ 'S'                                                           CSW209
     C                     MOVEL'A'       P1CABT                                              CSW209
     C                     MOVEL':57A:'   MTAG                                                CSW209
     C           OPCABT    WHEQ 'Y'                                                           CSW209
     C                     MOVEL'B'       P1CABT                                              CSW209
     C                     MOVEL':57B:'   MTAG                                                CSW209
     C           OPCABT    WHEQ 'Z'                                                           CSW209
     C                     MOVEL'C'       P1CABT                                              CSW209
     C                     MOVEL':57C:'   MTAG                                                CSW209
     C           OPCABT    WHEQ 'A'                                                           CSW209
     C                     MOVEL'D'       P1CABT                                              CSW209
     C                     MOVEL':57D:'   MTAG                                                CSW209
     C                     ENDSL                                                              CSW209
     C                     MOVELMTAG      EXTTAG                                              CSW209
     C                     MOVELOPCAB1    MFLD                                                CSW209
     C                     MOVELOPCAB1    P1CAB1                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C           OPCAB2    IFNE *BLANKS                                                       CSW209
     C                     ADD  1         M                                                   CSW209
     C           M         OCUR MULT                                                          CSW209
     C                     MOVELOPCAB2    MFLD                                                CSW209
     C                     MOVELOPCAB2    P1CAB2                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C           OPCAB3    IFNE *BLANKS                                                       CSW209
     C                     ADD  1         M                                                   CSW209
     C           M         OCUR MULT                                                          CSW209
     C                     MOVELOPCAB3    MFLD                                                CSW209
     C                     MOVELOPCAB3    P1CAB3                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C           OPCAB4    IFNE *BLANKS                                                       CSW209
     C                     ADD  1         M                                                   CSW209
     C           M         OCUR MULT                                                          CSW209
     C                     MOVELOPCAB4    MFLD                                                CSW209
     C                     MOVELOPCAB4    P1CAB4                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C           OPCAB5    IFNE *BLANKS                                                       CSW209
     C                     ADD  1         M                                                   CSW209
     C           M         OCUR MULT                                                          CSW209
     C                     MOVELOPCAB5    MFLD                                                CSW209
     C                     MOVELOPCAB5    P1CAB5                                              CSW209
     C                     ENDIF                                                              CSW209
     C   64                MOVELCNT57     BBCUST                                              CSW209
     C   64                EXSR SEXTN                                                         CSW209
      *                                                                                       CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
      ** Field :59: - Beneficiary Customer (Cover)                                            CSW209
      *                                                                                       CSW209
     C           OPCBC1    IFNE *BLANK                                                        CSW209
     C           OPCBC2    ORNE *BLANK                                                        CSW209
     C           OPCBC3    ORNE *BLANK                                                        CSW209
     C           OPCBC4    ORNE *BLANK                                                        CSW209
     C           OPCBC5    ORNE *BLANK                                                        CSW209
      *                                                                                       CSW209
     C                     MOVEL'N'       WRK59F  1                                           CSW215
     C           CSW215    IFEQ 'Y'                                                           CSW215
     C                     SUBSTOPCBC1:1  WSLASH  1                                           CSW215
     C                     SUBSTOPCBC1:1  WLINE1  2                                           CSW215
     C                     SUBSTOPCBC2:1  WLINE2  2                                           CSW215
      *                                                                                       CSW215
     C           WSLASH    IFEQ '/'                                                           CSW215
     C           WLINE2    ANDEQ'1/'                                                          CSW215
     C           WLINE1    OREQ '1/'                                                          CSW215
     C                     MOVEL'Y'       WRK59F                                              CSW215
     C                     ENDIF                                                              CSW215
     C                     ENDIF                                                              CSW215
      *                                                                                       CSW215
     C           OPCBC1    IFNE *BLANKS                                                       CSW209
     C                     ADD  1         M                                                   CSW209
     C           M         OCUR MULT                                                          CSW209
     C                     SELEC                                                              CSW209
     C           OPCBCT    WHEQ 'S'                                                           CSW209
     C                     MOVEL'A'       P1CBCT                                              CSW209
     C                     MOVEL':59A:'   MTAG                                                CSW209
     C           OPCBCT    WHEQ 'A'                                                           CSW209
     C                     MOVEL' '       P1CBCT                                              CSW209
     C           WRK59F    IFEQ 'Y'                                                           CSW215
     C                     MOVEL':59F:'   MTAG                                                CSW215
     C                     ELSE                                                               CSW215
     C                     MOVEL':59: '   MTAG                                                CSW209
     C                     ENDIF                                                              CSW215
     C                     ENDSL                                                              CSW209
     C                     MOVELMTAG      EXTTAG                                              CSW209
     C                     MOVELOPCBC1    MFLD                                                CSW209
     C                     MOVELOPCBC1    P1CBC1                                              CSW209
      *                                                                                       CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C           OPCBC2    IFNE *BLANKS                                                       CSW209
     C                     ADD  1         M                                                   CSW209
     C           M         OCUR MULT                                                          CSW209
     C                     MOVELOPCBC2    MFLD                                                CSW209
     C                     MOVELOPCBC2    P1CBC2                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C           OPCBC3    IFNE *BLANKS                                                       CSW209
     C                     ADD  1         M                                                   CSW209
     C           M         OCUR MULT                                                          CSW209
     C                     MOVELOPCBC3    MFLD                                                CSW209
     C                     MOVELOPCBC3    P1CBC3                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C           OPCBC4    IFNE *BLANKS                                                       CSW209
     C                     ADD  1         M                                                   CSW209
     C           M         OCUR MULT                                                          CSW209
     C                     MOVELOPCBC4    MFLD                                                CSW209
     C                     MOVELOPCBC4    P1CBC4                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C           OPCBC5    IFNE *BLANKS                                                       CSW209
     C                     ADD  1         M                                                   CSW209
     C           M         OCUR MULT                                                          CSW209
     C                     MOVELOPCBC5    MFLD                                                CSW209
     C                     MOVELOPCBC5    P1CBC5                                              CSW209
     C                     ENDIF                                                              CSW209
     C   65                MOVELCNT59     BBCUST                                              CSW209
     C   65                EXSR SEXTN                                                         CSW209
      *                                                                                       CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
      **  Field :70 - Remittance Information (Cover)                                          CSW209
      *                                                                                       CSW209
     C           OPCDP1    IFNE *BLANKS                                                       CSW209
     C           OPCDP2    ORNE *BLANKS                                                       CSW209
     C           OPCDP3    ORNE *BLANKS                                                       CSW209
     C           OPCDP4    ORNE *BLANKS                                                       CSW209
      *                                                                                       CSW209
     C           OPCDP1    IFNE *BLANKS                                                       CSW209
     C                     ADD  1         M                                                   CSW209
     C           M         OCUR MULT                                                          CSW209
     C                     MOVEL':70: '   MTAG                                                CSW209
     C                     MOVELOPCDP1    MFLD                                                CSW209
     C                     MOVELOPCDP1    P1CDP1                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C           OPCDP2    IFNE *BLANKS                                                       CSW209
     C                     ADD  1         M                                                   CSW209
     C           M         OCUR MULT                                                          CSW209
     C                     MOVELOPCDP2    MFLD                                                CSW209
     C                     MOVELOPCDP2    P1CDP2                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C           OPCDP3    IFNE *BLANKS                                                       CSW209
     C                     ADD  1         M                                                   CSW209
     C           M         OCUR MULT                                                          CSW209
     C                     MOVELOPCDP3    MFLD                                                CSW209
     C                     MOVELOPCDP3    P1CDP3                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C           OPCDP4    IFNE *BLANKS                                                       CSW209
     C                     ADD  1         M                                                   CSW209
     C           M         OCUR MULT                                                          CSW209
     C                     MOVELOPCDP4    MFLD                                                CSW209
     C                     MOVELOPCDP4    P1CDP4                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
      ** Field :72: - Sender to Receiver Information Cover                                    CSW209
      *                                                                                       CSW209
     C           OPCBB1    IFNE *BLANKS                                                       CSW209
     C           OPCBB2    ORNE *BLANKS                                                       CSW209
     C           OPCBB3    ORNE *BLANKS                                                       CSW209
     C           OPCBB4    ORNE *BLANKS                                                       CSW209
     C           OPCBB5    ORNE *BLANKS                                                       CSW209
     C           OPCBB6    ORNE *BLANKS                                                     BUG24491
      *                                                                                       CSW209
     C           OPCBB1    IFNE *BLANKS                                                       CSW209
     C                     ADD  1         M                                                   CSW209
     C           M         OCUR MULT                                                          CSW209
     C                     MOVEL':72: '   MTAG                                                CSW209
     C                     MOVELOPCBB1    MFLD                                                CSW209
     C                     MOVELOPCBB1    P1CBB1                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C           OPCBB2    IFNE *BLANKS                                                       CSW209
     C                     ADD  1         M                                                   CSW209
     C           M         OCUR MULT                                                          CSW209
     C                     MOVELOPCBB2    MFLD                                                CSW209
     C                     MOVELOPCBB2    P1CBB2                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C           OPCBB3    IFNE *BLANKS                                                       CSW209
     C                     ADD  1         M                                                   CSW209
     C           M         OCUR MULT                                                          CSW209
     C                     MOVELOPCBB3    MFLD                                                CSW209
     C                     MOVELOPCBB3    P1CBB3                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C           OPCBB4    IFNE *BLANKS                                                       CSW209
     C                     ADD  1         M                                                   CSW209
     C           M         OCUR MULT                                                          CSW209
     C                     MOVELOPCBB4    MFLD                                                CSW209
     C                     MOVELOPCBB4    P1CBB4                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C********** OPOCB5    IFNE *BLANKS                                              CSW209 BUG24491
     C           OPCBB5    IFNE *BLANKS                                                     BUG24491
     C                     ADD  1         M                                                   CSW209
     C           M         OCUR MULT                                                          CSW209
     C                     MOVELOPCBB5    MFLD                                                CSW209
     C                     MOVELOPCBB5    P1CBB5                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C********** OPOCB6    IFNE *BLANKS                                              CSW209 BUG24491
     C           OPCBB6    IFNE *BLANKS                                                     BUG24491
     C                     ADD  1         M                                                   CSW209
     C           M         OCUR MULT                                                          CSW209
     C                     MOVELOPCBB6    MFLD                                                CSW209
     C                     MOVELOPCBB6    P1CBB6                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
      ** Field 33B - Instructed Currency/Amount                                               CSW209
      *                                                                                       CSW209
     C           OPCICY    IFNE *BLANKS                                                       CSW209
     C                     ADD  1         M                                                   CSW209
     C           M         OCUR MULT                                                          CSW209
     C                     MOVEL':33B:'   MTAG                                                CSW209
     C                     MOVELOPCICY    WICCY                                               CSW209
     C                     Z-ADDOPCIAM    WIAMNT                                              CSW209
     C                     EXSR SRFAMT                                                        CSW209
     C                     MOVEA*BLANKS   WA1                                                 CSW209
     C                     MOVEAWOCCYS    WA1                                                 CSW209
     C                     MOVEAWOAMNT    WA1,4                                               CSW209
     C                     MOVEAWA1       MFLD                                                CSW209
     C                     MOVEAWA1       P1R33B                                              CSW209
     C**********           MOVELOPCICY    P1R33B                                     CSW209 AR986522
     C                     MOVELP1R33B    MFLD                                                CSW209
     C                     CALL 'ZSEDIT'                                                      CSW209
     C                     PARM OPCIAM    PAMNT  150                                          CSW209
     C                     PARM WODECS    PDECS   10                                          CSW209
     C                     PARM 'J'       PCODE   1                                           CSW209
     C                     PARM *BLANKS   POUT21 21                                           CSW209
     C                     MOVELPOUT21    WCHR20 20                                           CSW209
     C                     MOVE WCHR20    P1R33B                                              CSW209
     C                     MOVELOPCICY    P1R33B                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     ENDSR                                                              CSW209
     C*                                                                                       CSW209
     C************************************************************                            CSW209
     C* END OF SUBROUTINE                                                                     CSW209
     C************************************************************                            CSW209
     C/EJECT                                                                                  CSW209
      *****************************************************************                       CSW209
      *                                                               *                       CSW209
      *  SRFAMT - Format amount to SWIFT amount format                *                       CSW209
      *                                                               *                       CSW209
      *  Called by: Main                                              *                       CSW209
      *                                                               *                       CSW209
      *  Calls    : AOCURRR0, ZM0040, DBERR                           *                       CSW209
      *                                                               *                       CSW209
      *****************************************************************                       CSW209
     C           SRFAMT    BEGSR                                                              CSW209
      *                                                                                       CSW209
      ** Define input/ouput parameters.                                                       CSW209
      *                                                                                       CSW209
     C                     MOVE WICCY     WICCY   3                                           CSW209
     C                     Z-ADDWIAMNT    WIAMNT 130                                          CSW209
     C                     MOVE *BLANKS   WOCCYS  3                                           CSW209
     C                     Z-ADD0         WODECS  10                                          CSW209
     C                     MOVE *BLANKS   WOAMNT 15                                           CSW209
      *                                                                                       CSW209
      ** Define other work field.                                                             CSW209
      *                                                                                       CSW209
     C                     MOVE WIAMNT    WAMTA  13                                           CSW209
      *                                                                                       CSW209
      ** Access Currency details.                                                             CSW209
      *                                                                                       CSW209
     C                     CALL 'AOCURRR0'                                                    CSW209
     C                     PARM *BLANKS   PRTCD                                               CSW209
     C                     PARM '*KEY   ' POPTN                                               CSW209
     C                     PARM WICCY     PWCCY   3                                           CSW209
     C           SDCURR    PARM SDCURR    DSSDY                                               CSW209
      *                                                                                       CSW209
     C           PRTCD     IFNE *BLANKS                                                       CSW209
     C                     MOVE '044'     DBERR#                                              CSW209
     C                     MOVELWICCY     DBERKY                                              CSW209
     C                     MOVEL'SDCURRPD'DBFNAM                                              CSW209
     C                     EXSR DBERR                                                         CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     MOVE A6SWCY    WOCCYS                                              CSW209
     C                     Z-ADDA6NBDP    WODECS                                              CSW209
      *                                                                                       CSW209
      ** Perform old processing if CSW020 is not switched on.                                 CSW209
      *                                                                                       CSW209
     C           CSW020    IFNE 'Y'                                                           CSW209
      *                                                                                       CSW209
     C           14        SUB  A6NBDP    X       20                                          CSW209
      *                                                                                       CSW209
      ** If 0 decimal places, don't edit.                                                     CSW209
      *                                                                                       CSW209
     C           A6NBDP    IFEQ 0                                                             CSW209
     C                     MOVE *BLANK    AMT                                                 CSW209
     C                     MOVE *ZEROS    AM                                                  CSW209
     C                     MOVEAWAMTA     AMT,2                                               CSW209
     C                     MOVEAWAMTA     AM,1                                                CSW209
     C                     Z-ADD13        W                                                   CSW209
     C                     MOVE ','       AM,X                                                CSW209
     C                     ELSE                                                               CSW209
      *                                                                                       CSW209
      ** Move amount into array.                                                              CSW209
      *                                                                                       CSW209
     C                     MOVEAWAMTA     AMT,1                                               CSW209
      *                                                                                       CSW209
      ** Determine position of decimal digits in 2nd array.                                   CSW209
      *                                                                                       CSW209
     C           X         ADD  1         Y       20                                          CSW209
      *                                                                                       CSW209
      ** Move decimal digits into 2nd array field.                                            CSW209
      *                                                                                       CSW209
     C                     MOVEAAMT,X     AM,Y                                                CSW209
      *                                                                                       CSW209
      ** Determine position & move comma.                                                     CSW209
      *                                                                                       CSW209
     C                     SUB  1         Y                                                   CSW209
     C                     MOVE ','       AM,Y                                                CSW209
      *                                                                                       CSW209
      ** Determine position of digit before comma.                                            CSW209
      *                                                                                       CSW209
     C                     SUB  1         Y                                                   CSW209
      *                                                                                       CSW209
      ** Save position of digit before comma.                                                 CSW209
      *                                                                                       CSW209
     C                     Z-ADDY         W       20                                          CSW209
      *                                                                                       CSW209
      ** Determine position of digit to be moved before comma.                                CSW209
      *                                                                                       CSW209
     C                     SUB  1         X                                                   CSW209
     C                     Z-ADDX         Z       20                                          CSW209
      *                                                                                       CSW209
      ** Move characters one by one from right to left.                                       CSW209
      *                                                                                       CSW209
     C                     DO   X                                                             CSW209
     C                     MOVE AMT,Z     AM,Y                                                CSW209
     C                     SUB  1         Z                                                   CSW209
     C                     SUB  1         Y                                                   CSW209
     C                     ENDDO                                                              CSW209
      *                                                                                       CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     Z-ADD1         Y                                                   CSW209
      *                                                                                       CSW209
      ** Replace leading zeros with blank.                                                    CSW209
      *                                                                                       CSW209
     C           AM,Y      DOWEQ'0'                                                           CSW209
     C           Y         ANDNEW                                                             CSW209
     C                     MOVE ' '       AM,Y                                                CSW209
     C                     ADD  1         Y                                                   CSW209
     C                     ENDDO                                                              CSW209
      *                                                                                       CSW209
      ** Save field from array.                                                               CSW209
      *                                                                                       CSW209
     C                     MOVEAAM        AMX    14                                           CSW209
     C                     MOVE AMX       WOAMNT                                              CSW209
      *                                                                                       CSW209
     C                     ELSE                                                               CSW209
      *                                                                                       CSW209
      ** If CSW020 is switched on, perform decimal places prosessing.                         CSW209
      *                                                                                       CSW209
     C                     CALL 'ZM0040'                                                      CSW209
     C                     PARM WIAMNT    ZAMNT                                               CSW209
     C                     PARM WICCY     ZCCY                                                CSW209
     C                     PARM *BLANKS   ZSAMNT                                              CSW209
     C                     PARM *BLANKS   ZSCCY                                               CSW209
     C                     PARM *BLANKS   ZERR                                                CSW209
      *                                                                                       CSW209
     C           ZERR      IFEQ '1'                                                           CSW209
     C                     MOVE '045'     DBERR#                                              CSW209
     C                     MOVELWICCY     DBERKY                                              CSW209
     C                     MOVEL'ZM0040  'DBFNAM                                              CSW209
     C                     EXSR DBERR                                                         CSW209
     C                     ELSE                                                               CSW209
      *                                                                                       CSW209
     C                     MOVE ZSAMNT    WOAMNT                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
      ** Left-justify amount.                                                                 CSW209
      *                                                                                       CSW209
     C                     MOVEA*BLANKS   FAMT                                                CSW209
     C                     MOVEAWOAMNT    FAMT                                                CSW209
     C                     Z-ADD1         S                                                   CSW209
     C           FAMT,S    DOWEQ' '                                                           CSW209
     C                     ADD  1         S                                                   CSW209
     C                     ENDDO                                                              CSW209
     C                     MOVE *BLANKS   WOAMNT                                              CSW209
     C                     MOVEAFAMT,S    WOAMNT                                              CSW209
      *                                                                                       CSW209
     C                     ENDSR                                                              CSW209
      *****************************************************************                       CSW209
      /EJECT                                                                                  CSW209
     C/COPY WNCPYSRC,FT0648C017
     C********************************************************************
     C*    *     SUBROUTINE TO SET UP DATA STRUCTURE   *     *** DBERR ***
     C*    *                FOR DATABASE ERRORS.       *     *** DBERR ***
     C********************************************************** DBERR ***
     C*    ERROR     CAUSE                                   *** DBERR ***
     C*       01     VALID I.C.R.-1 RECORD NOT FOUND.        *** DBERR ***
     C*       02     VALID I.C.R.-2 RECORD NOT FOUND.        *** DBERR ***
     C*       03     VALID CURRENCY RECORD NOT FOUND.        *** DBERR ***
     C*       04     UNSUCCESSFUL CHAIN TO LF/OTPAY.         *** DBERR ***
     C*       05     UNSUCCESSFUL CHAIN TO LF/CQPAC.         *** DBERR ***
     C*       06     UNSUCCESSFUL CHAIN TO LF/NTRAN.         *** DBERR ***
     C********************************************************** DBERR ***
     C           DBERR     BEGSR                             *** DBERR ***
     C*                                                      *************
     C           *NAMVAR   DEFN LDA       DLDA
     C           *LOCK     IN   DLDA
     C                     MOVEL'FT0648  'DBPGM            ) SET UP
     C*********************MOVE DBFNAM    DBFILE           ) DATA BASE    S01117
     C                     MOVELDBFNAM    DBFILE           ) DATA BASE    S01117
     C                     MOVELDBERKY    DBKEY            ) ERROR
     C                     MOVE *BLANKS   DBASE                           S01117
     C                     MOVE DBERR#    DBASE            ) FIELDS
     C                     OUT  DLDA
     C                     SETON                     U7U8LR
     C                     SETON                     78                   S01117
     C                     Z-ADD1         PAGEAU                          S01117
     C                     WRITEAUH1                                      S01117
     C                     DUMP
     C                     RETRN
     C*                                                      *************
     C                     ENDSR                             *** DBERR ***
     C/EJECT
     O*
      *                                                                   S01408
     O/COPY WNCPYSRC,FT0648OOP1                                           S01408
      *                                                                   S01408
      ** Replace *EQUATE for FT0648P1 with a 4040 since it will be done                     AR972805
      ** externally                                                                         AR972805
      *                                                                                     AR972805
******* TRANS. SPEC. PRINT MSGS AS THEY WILL BE AFTER MS0200 (NO INV.CHRS)                  AR972805
******* FT0648P1                                                                            AR972805
******* 4E504B5E7D7F4DC05DD060CD6F5A6F5B6F4A6F6C6F5C6F4C6F7E6F6E6F7C6FE0D57B6FA6            AR972805
******* 6F4F6F5F7D7960A1606D                                                                AR972805
** FTRANS
*EQUATE FT0648P1
*EQUATE 4040
     X/COPY WNCPYSRC,FT0648X001                                           S01408
** CPY@   **      OBJECT COPYRIGHT
(c) Misys International Banking Systems Ltd. 2001
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
**   SVAL  -  SYSTEM VALUES ARRAY                                                          BUG15044A
UseFullFTRefInMsg                                                                          BUG15044A
