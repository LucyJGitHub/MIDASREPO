     H        1   D                       F
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas FT Nostro transfers non-input cycle')            *
     F*****************************************************************
     F*                                                               *
     F*  Midas - Funds Transfer Module                                *
     F*                                                               *
     F*  FT0656 - Nostro Transfers                                    *
     F*                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. CSD103             Date 10Aug20               *
      *  Prev Amend No. MD046248           Date 27Oct17               *
      *                 CSW215             Date 06Apr15               *
      *                 CAP212             Date 15Sep14               *
      *                 263658             Date 19Aug14               *
      *                 260987A            Date 09Nov12               *
      *                 262185             Date 14Oct09               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 BUG15201           Date 30Oct07               *
      * Midas Plus 1.4 Base ------------------------------------------*
      *                 227364             Date 04Dec06               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CFT032             Date 11Sep06               *
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 222385             Date 23Oct03               *
      *                 219242             Date 01Jul03               *
      *                 219241             Date 01Jul03               *
      *                 CSD015             Date 14Oct02               *
      * Midas Release 4.01.01 ----------------------------------------*
      *                 CSW202             Date 20May02               *
      * Midas Release 4.01 -------------------------------------------*
      *                 CSW025             Date 26Mar02               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 197993             Date 18Sep01               *
      *                 138077             Date 22Jun01               *
      *                 CSW201             Date 02May01               *
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CFT009             Date 01Jun00               *
      * Midas DBA 3.04 -----------------------------------------------*
      *                 CFT014             Date 25May00               *
      * Midas DBA 3.03 -----------------------------------------------*
      * Midas DBA 3.02 -----------------------------------------------*
      *                 CSW020             Date 10Jan00               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 164663             Date 25Aug99               *
     F*                 147120             Date 27Apr99               *
     F*                 141797             DATE 10SEP98               *
     F*                 113352             DATE 29JAN97               *
     F*                 S01408             DATE 19NOV96               *
     F*                 CSW096             DATE 03JUN96               *
     F*                 089269             DATE 08JUL96               *
     F*                 S01408             DATE 10JAN96               *
     F*                 084587             DATE 23OCT95               *
     F*                 089643             DATE 23OCT95               *
     F*                 087198             DATE 23OCT95               *
     F*                 088545             DATE 21JUN95               *
     F*                 S01494             DATE 25MAY94               *
     F*                 068367             DATE 18MAR94               *
     F*                 068242             DATE 16MAR94               *
     F*                 064393             DATE 08DEC93               *
     F*                 042492             DATE 07MAY93               *
     F*                 S01414             DATE 29MAR93               *
     F*                 E29973             DATE 09JUL91               *
     F*                 S01310             DATE 09JUL91               *
     F*                 S01194             DATE 14SEP90               *
     F*                 S01117             DATE 14SEP90               *
     F*                 E22406             DATE 10JUL90               *
     F*                 E21276             DATE 17MAY90               *
     F*                 E21286             DATE 01MAR90               *
     F*                                                               *
     F*---------------------------------------------------------------*
      *                                                               *
      *  CSD103 - LIBOR Deregulation - Common Layer/Standing Data     *
      *  MD046248 - Finastra Rebranding                               *
      *  CSW215 - SWIFT Changes 2015                                  *
      *  CAP212 - FT Nostro Transfer API (Recompile)                  *
      *  263658 - Amended so that system will use new our account no. *
      *           at nostro (A7OACN) field and not the old field.     *
      *  260987A - Destination not always displayed on the report.    *
      *            Fields omitted on write to MGOREFPD. Wrong Sender  *
      *            address when network is Paper.                     *
      *  262185 - Need to move ACBN to the Nostro number field (NSNO) *
      *           for MT210.                                          *
      *  BUG15201 - Encounter Database Errors (Recompile)             *
      *  227364 - Output 'Our Account at Nostro' in field :53B: if    *
      *           there is a Nostro Sender's Correspondent.           *
      *  CFT032 - Account line in field 50k in MT103 (recompile)      *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  222385 - SWIFT msgs are Watch List checked regardless of     *
      *           configuration file setting                          *
      *  219242 - Not possible to create MT103+ payment msg from      *
      *           non-FT transaction (Recompile)                      *
      *  219241 - Defaulting of "Details of Charges" assign a         *
      *           system value (Recompile)                            *
      *  CSD015 - Midas Compliance Watch - Watch List Checking        *
      *  CSW202 - SWIFT 2002 Standards Update                         *
      *  CSW025 - Midas Message Manager                               *
      *           - Pass original change type                         *
      *  197993 - Option D must output party id together with         *
      *           customer address if entered.                        *
      *  138077 - Add extension file MGOEXTPD to store customer no.   *
      *           of field with SWIFT address.                        *
      *         - Allow messages to have expansion even if it starts  *
      *           with "/".                                           *
      *  CSW201 - SWIFT 2001 Standards Update                         *
     F*  CFT009 - FT Fees and Charge Development-Recompiled           *
      *  CFT014 - Straight-through Processing Phase 2 MT103           *
      *           Messages Generation for FT. Recompile only.         *
     F*  CSW020 - SWIFT Decimal Places                                *
     F*           Adjust the amount if the Swift decimal places       *
     F*           differs from the currency decimal places            *
     F*  164663 - Extension of fix 141572 to setup CINDV (Century     *
     F*           indicator for Value Date) for Y2K display problem.  *
     F*  147120 - Field 56A of MT210 shows the 'To Nostro' instead of *
     F*           the Intermediary entered in the Nostro Transfer     *
     F*           Maintenance. Check if Intermediary is entered then  *
     F*           move details of Intermediary to field 56A of MT210. *
     F*  141797 - Extension of 113352 to include MT200s.              *
     F*  113352 - Set-up CIND (Century Flag) to correct year 2000     *
     F*           display problem.                                    *
     F*  S01408 - Addition of core hook FT0656CCP6                    *
     F*           Addition of core hook FT0656CCP5                    *
     F*           Addition of core hook FT0656CCP4                    *
     F*           Addition of core hook FT0656CCP3                    *
     F*           Addition of core hook FT0656CCP2                    *
     F*           Addition of core hook FT0656CCP1                    *
     F*  CSW096 - SWIFT changes 1996                                  *
     F*  089269 - System generating unroutable MT210 messages.        *
     F*           Check client details to see if MT210 should be      *
     F*           produced for this customer.                         *
     F*  S01408 - Core hook FT0656OOP1 added                          *
     F*  087198 - Delivery notification can not be set to '0'.        *
     F*           Complition of 068367.
     F*  084587 - Amount in field 32 is not initialised properly      *
     F*           and causes message to be "NACKED".                  *
     F*           (":32A:12000,00,)                                   *
     F*  089643 - If Intermediary Bank details are left blank, do     *
     F*           not output Field 56 to MT200 message.               *
     F*  088545 - If there is no message status default for that      *
     F*           message type for the involved customer,             *
     F*           default the message status with the ICD.            *
     F*  S01494 - BLI Funds Transfer Enhancements                     *
     F*         - Formatting of field :56* for MT210 is incorrect.    *
     F*           (TEMP21)                                            :
     F*  068367 - Ensure Priority and Delivery Notification fields    *
     F*           are a valid combination.                            *
     F*  068242 - Remove COMIT on MG files                            *
     F*  064393 - GET SENDERS TID FROM BRANCH NOT CUSTOMER.           *
     F*  042492 - Field 52A not showing details correctly             *
     F*  S01414 - Book Code and Profit Centre Incorporation.          *
     F*           Rename of profit centre field on ACCNTABF           *
     F*  E29973 - INTERMEDIARY BANK ON P2 REPORT.                     *
     F*  S01310 - SWIFT RATIONALISATION.                              *
     F*  S01194 - NEW DATABASE ERROR HANDLING                         *
     F*  S01117 - REPORT CONTROL FACILITY                             *
     F*  S01117 - FUNDS TRANSFER DEFAULT BRANCH REMOVAL AND           *
     F*           CHANGE OF INTERBRANCH ENTRIES                       *
     F*  E22406 - TERMINAL IDENTIFICATION REMOVAL.                    *
     F*  E21276 - PREVENT OUTPUT OF EMPTY FIELDS TO REPORTS.          *
     F*  E21286 - OUTPUT FILE CONTROLS TO MSFCTL INSTEAD OF           *
     F*           FTFCTL.                                             *
     F*           (THIS IS THE RE-APPLICATION OF E17216 WHICH WAS     *
     F*           OVERWRITTEN)                                        *
     F*****************************************************************
     FPRFP4   IP  E           K        DISK
     F*CLINT***IF**E           K        DISK                              S01310
     F************CLINTCAF                          KIGNORE               S01310
     F************CLINTC1F                          KIGNORE               S01310
     F*SNAME***IF**E           K        DISK                              S01310
     F************CLINTCBF                          KRENAMESNAMEF         S01310
     F*MSADR***IF**E           K        DISK                              S01310
     F************CLINTCBF                          KRENAMEMSADRCBF       S01310
     F***SDCUSTL7IF**E           K        DISK                     S01117 S01494
     FACNUMA  IF  E           K        DISK
     F*MSIXOPF*O***E                    DISK                      A       S01310
     F*MSMSOPF*O***E           K        DISK                      A       S01310
     FMGOEXTPDO   E                    DISK                               138077
     FMGOREFPDO   E                    DISK                               S01310
     F*************                                 KCOMIT          S01310068242
     FMGOMSGPDO   E                    DISK                               S01310
     F*************                                 KCOMIT          S01310068242
     F*
     F*FT0656P3O***E********************PRINTER                           S01117
     F*FT0656P1O***E********************PRINTER                           S01117
     F*FT0656P2O***E********************PRINTER                           S01117
     F*FT0656P4O***E********************PRINTER                           S01117
     F*FT0656P5O***E********************PRINTER                           S01117
     FFT0656AUO   E                    PRINTER      KINFDS SPOOLU         S01117
     FFT0656P1O   E                    PRINTER      KINFDS SPOOL1         S01117
     FFT0656P2O   E                    PRINTER      KINFDS SPOOL2         S01117
     FFT0656P4O   E                    PRINTER      KINFDS SPOOL4         S01117
     FFT0656P5O   E                    PRINTER      KINFDS SPOOL5         S01117
     FSDBRCHL5IF  E           K        DISK                               E22406
     FTABFP   IF  E           K        DISK
     F            TABTB20F                          KIGNORE
     F            TABTG20F                          KIGNORE
     F            TABLETHF                          KIGNORE
     F            TABLETPF                          KIGNORE
     F************TABLETJF                          KIGNORE               S01117
     F            TABLET5F                          KIGNORE
     F            TABTE10F                          KIGNORE
     F*
     FSDNOSTL0IF  E           K        DISK                                                   227364
     F/COPY WNCPYSRC,FT0656F001
     F/EJECT
     F*
     F****************************************************************
     F* ID F  C  H  L    FUNCTION OF INDICATORS                      *
     F****************************************************************
     F* 01              RECORD READ FROM NTRANDD                     *
     F*                                                              *
     F*       09        UNSUCCESSFUL CHAIN TO SDBRCHL5.              *    E22406
     F*       10        UNSUCCESSFUL CHAIN TO TABFP.                 *
     F*       11        UNSUCESSFUL CHAIN TO ACNUMA                  *
     F********12********UNSUCESSFUL CHAIN TO CLINT                        S01310
     F*       15        LOKUP operation searching array (GNR)        *    S01310
     F*       16        LOKUP operation searching array (GNR)        *    S01310
     F*       17        LOKUP operation searching array (GNR)        *    S01310
     F*       20        CALL OF SR01 FOR DESTINATION OF MESSAGE      *
     F*       21        NETWORK INDICATOR.                           *    S01310
     F********34        DONT UPDATE MSFCTL FOR MT200 TELEX MESSAGE   *    S01310
     F********35        DONT UPDATE MSFCTL FOR MT210 TELEX MESSGAE   *    S01310
     F*       40        FIRST CYCLE COMPLETED.                       *
     F********41********UNSUCESSFUL WRITE MSIXOPFF                   *    S01310
     F********42********UNSUCESSFUL WRITE MSMSOPFF                   *    S01310
     F*       41        UNSUCESSFUL WRITE MGOREFPD                   *    S01310
     F*       42        UNSUCESSFUL WRITE MGOMSGPD                   *    S01310
     F*       51        OUTPUT INTERMEDIARY BANK DATA TO REPORT.     *    E21276
     F*       52        OUTPUT BANK TO BANK DATA TO REPORT.          *    E21276
     F********56********MT210 not to be generated for customer     089269 CSW096
     F********57********MT21* not to be generated for customer     089269 CSW096
     F********58********MT2** not to be generated for customer     089269 CSW096
     F*       60        MULTIBRANCH INDICATOR ACTIVE                 *    S01117
     F*                                                              *
     F*       U7        ) DATA BASE                                  *
     F*       U8        ) ERROR.                                     *
     F*             LR  LAST RECORD (TERMINATE PROGRAM).             *
     F*                                                              *
     F*  N.B:- 90-99    STANDARD SUBROUTINE INDICATORS.              *
     F****************************************************************
     F*
     F/EJECT
     E                    CPY@    1   1 80
     E*
     E                    MTH    12  12  3               MONTH  SR. ARRAY
     E                    AMT        13  1               AMOUNT ARRAY
     E                    AM         14  1               EDITED AMOUNT ARR
     E                    FAMT       15  1               LEFT ADJ AMNT ARR
     E                    ADDR        6 35               NAME/ADDRESS  ARR
     E                    @WRK       50  1               work array       S01310
     E                    GNR        15  3               msg gen released.S01310
     E********************NGN        15  3        msg not generatd.089269 CSW096
      *
     E/EJECT
     I*
     I*CLINTCBF****70                                                     S01310
     I**************SWTX                            SWTXRN                S01310
     INTRANDDF    01
     I*                                                                   S01414
     I* Rename of ACCNTABF Profit Centre to avoid overwriting             S01414
     I*                                                                   S01414
     IACCNTABF                                                            S01414
     I              PRFC                            ACPRFC                S01414
     I*                                                                   S01117
     ISPOOLU      DS                                                      S01117
     I* FILE INFORMATION DATA STRUCTURE                                   S01117
     I                                       83  92 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
     ISPOOL1      DS                                                      S01117
     I* FILE INFORMATION DATA STRUCTURE                                   S01117
     I                                       83  92 SFILE1                S01117
     I                                    B 123 1240SFNUM1                S01117
     ISPOOL2      DS                                                      S01117
     I* FILE INFORMATION DATA STRUCTURE                                   S01117
     I                                       83  92 SFILE2                S01117
     I                                    B 123 1240SFNUM2                S01117
     ISPOOL4      DS                                                      S01117
     I* FILE INFORMATION DATA STRUCTURE                                   S01117
     I                                       83  92 SFILE4                S01117
     I                                    B 123 1240SFNUM4                S01117
     ISPOOL5      DS                                                      S01117
     I* FILE INFORMATION DATA STRUCTURE                                   S01117
     I                                       83  92 SFILE5                S01117
     I                                    B 123 1240SFNUM5                S01117
     I*                                                                   S01117
     IRUNDAT      DS                             13                       S01117
     I* DATA STRUCTURE TO RETRIEVE MULTIBRANCH INDICATOR                  S01117
     I                                       13  13 MBIN                  S01117
     IEXTN        DS                         45                           138077
     I                                        1   20MPSN                  138077
     I                                        3   7 MTG                   138077
     I                                        8  15 MCSI                  138077
      *                                                                   138077
      **  Multiple occurrence data structure for extension file           138077
      *                                                                   138077
     I            DS                                                      138077
     I                                        1   5 @MTG                  138077
     I                                        2   2 FLDTYP                138077
     I                                        4   4 FLDTAG                138077
      *                                                                   138077
      **  Field tag data structure                                        138077
      *                                                                   138077
     I/COPY FTCPYSRC,SFTADDRI                                             S01494
     I*                                                                   S01494
     IW8FT        DS                            128                       S01494
     I*                                                                   S01494
     I** Address data structure                                           S01494
     I*                                                                   S01494
     I** Currency                                                         S01494
     I                                        1   3 W8CCY                 S01494
     I** Settlement Type                                                  S01494
     I                                        4   5 W8STMT                S01494
     I** Mandatory Text - convert BIC identifiers                         S01494
     I                                        6   6 W8MTXT                S01494
     I** Message Tag                                                      S01494
     I                                        7  11 W8MTAG                S01494
     I** Construct of data in field                                       S01494
     I                                       12  12 W8TYPE                S01494
     I** Number of Lines available                                        S01494
     I                                       13  140W8NLIN                S01494
     I** Network and Message Type                                         S01494
     I                                       15  20 W8NWRK                S01494
     I                                       21  23 W8MTPY                S01494
     I** Calling Program                                                  S01494
     I                                       24  33 W8CPGM                S01494
     I** Action *PRINT/*ENQ/*MSG GEN                                      S01494
     I                                       34  41 W8ACT                 S01494
     I** Critical reporting - Database error if 'Y'                       S01494
     I** If no BIC directory and BIC entered no error                     S01494
     I                                       42  42 W8CRIT                S01494
     I** Force Midas Address - where possible                             S01494
     I                                       43  43 W8MADD                S01494
     I** If Retail get first address from account                         S01494
     I                                       44  44 W8RTAD                S01494
     I** Alternative Address                                              S01494
     I                                       45  45 W8ALTN                S01494
     I** Address type selected in W0MSG                                   S01494
     I                                       46  46 W8ADTP                S01494
     I*                                                                   S01494
     ISDCNST    E DSSDCNSTPD                                              S01494
     I*                                                                   S01494
     I** Calling parameter data structure for ME1400                      S01494
     I*                                                                   S01494
     IMEBICD    E DSMEBICDPD                                              S01494
     I*                                                                   S01494
     I** Calling parameter data structure for ME1400                      S01494
     I*                                                                   S01494
     IMEBEIS    E DSMEBEISPD                                                                  CSW202
      ** Data Structure for Business Entity Identifier file                                   CSW202
      *                                                                                       CSW202
     I*
     I/COPY WNCPYSRC,FT0656I002
      ***************************************************************     S01310
      *  NOTE:                                                      *     S01310
      *  The following data structures were originally used as the  *     S01310
      *  method of writing out the swift message to PF/MSMSOPF.     *     S01310
      *  As this method of output has been replaced by a multiple   *     S01310
      *  occurence data structure only the definitions of the       *     S01310
      *  relevant fields has been retained.                         *     S01310
      *  The multiple occurence data structure is used to store up  *     S01310
      *  the records that make up the SWIFT message before writing  *     S01310
      *  the whole message to file.                                 *     S01310
      *  To store the records of the message , you must first       *     S01310
      *  access an OCUR record, then obtain the Message Tag and     *     S01310
      *  Message Field data values for this OCUR record. Continue   *     S01310
      *  this process until the SWIFT message is complete.          *     S01310
      ***************************************************************     S01310
     I            DS
     I********************************************************
     I*    DATA STRUCTURE TO BUILD NOSTRO TRANSFERS          *
     I*    RECORD OUTGOING SWIFT MESSAGE TYPE MT200-1        *
     I********************************************************
     I                                        1 256 MT2001
     I                                        1   1 M1HEAD
     I************                            2   3 M1CRL1                S01310
     I                                        4  15 M1OTID
     I                                       16  16 M1SP1
     I                                       17  21 M1ISNO
     I************                           22  23 M1CRL2                S01310
     I                                       24  26 M1MSGT
     I                                       27  27 M1SP2
     I************                           28  29 M1MSGP                S01117
     I************                           30  31 M1CRL3                S01310
     I                                       32  43 M1RADD
     I************                           44  45 M1CRL4                S01310
     I************                           68  71 M1TG20                S01310
     I                                       72  87 M1TREF
     I************                           88  89 M1CRL6                S01310
     I************                           90  94 M1TG32                S01310
     I                                       95 100 M1VDAT
     I                                      101 103 M1RCCY
     I                                      104 118 M1AMNT
     I************                          119 120 M1CRL7                S01310
     I*
     I************                          257 257 MXMIND                S01310
     I************                          258 272 MXTREF                S01310
     I************                          273 273 MXDFLG                S01310
     I*
     I            DS
     I********************************************************
     I*     DATA STRUCTURE TO BUILD NOSTRO TRANSFERS         *
     I*     RECORD OUTGOING SWIFT MESSAGE TYPE MT200-2       *
     I********************************************************
     I                                        1 256 MT2002
     I*
     I************                           75  77 M2TG56                S01310
     I                                       78  78 M2INTG
     I************                           79  79 M2CLN                 S01310
     I                                       80 114 M2IBK1
     I************                          115 116 M2CRL1                S01310
     I                                      117 151 M2IBK2
     I************                          152 153 M2CRL2                S01310
     I                                      154 188 M2IBK3
     I************                          189 190 M2CRL3                S01310
     I                                      191 225 M2IBK4
     I************                          226 227 M2CRL4                S01310
     I*
     I            DS
     I********************************************************
     I*     DATA STRUCTURE TO BUILD NOSTRO TRANSFERS         *
     I*     RECORD OUTGOING SWIFT MESSAGE TYPE MT200-3       *
     I********************************************************
     I                                        1 256 MT2003
     I************                           38  40 M3TG57                S01310
     I                                       41  41 M3ABTT
     I************                           42  42 M3CLN                 S01310
     I                                       43  79 M3AWB1
     I************                           80  81 M3CRL1                S01310
     I                                       82 116 M3AWB2
     I************                          117 118 M3CRL2                S01310
     I                                      119 153 M3AWB3
     I************                          154 155 M3CRL3                S01310
     I                                      156 190 M3AWB4
     I************                          191 192 M3CRL4                S01310
     I                                      193 227 M3AWB5
     I************                          228 229 M3CRL5                S01310
     I*
     I            DS
     I********************************************************
     I*     DATA STRUCTURE TO BUILD NOSTRO TRANSFERS         *
     I*     RECORD OUTGOING SWIFT MESSAGE TYPE MT200-4       *
     I********************************************************
     I                                        1 256 MT2004
     I************                            1   4 M4TG72                S01310
     I                                        5  39 M4BTB1
     I************                           40  41 M4CRL1                S01310
     I                                       42  76 M4BTB2
     I************                           77  78 M4CRL2                S01310
     I                                       79 113 M4BTB3
     I************                          114 115 M4CRL3                S01310
     I                                      116 150 M4BTB4
     I************                          151 152 M4CRL4                S01310
     I                                      153 187 M4BTB5
     I************                          188 189 M4CRL5                S01310
     I                                      190 224 M4BTB6
     I************                          225 226 M4CRL6                S01310
     I************                          227 227 M4HYPH                S01310
     I************                          228 228 M4ETX                 S01310
     I*
     I            DS
     I********************************************************
     I*     DATA STRUCTURE TO BUILD NOSTRO TRANSFERS         *
     I*     RECORD OUTGOING SWIFT MESSAGE TYPE MT210-1       *
     I********************************************************
     I*
     I                                        1 256 MT2101
     I                                        1   1 NT1M1H
     I************                            2   3 NT1EF1                S01310
     I                                        4  15 NT1MXO
     I                                       16  16 NT1WK1
     I                                       17  21 NT1WK2
     I************                           22  23 NT1EF2                S01310
     I                                       24  29 NT1WK3
     I************                           30  31 NT1EF3                S01310
     I                                       32  43 NT1SWA
     I************                           44  45 NT1EF4                S01310
     I************                           46  49 NT1WK4                S01310
     I************                           50  50 NT1WK6                S01310
     I                                       51  65 NT1RS1
     I************                           66  67 NT1EF5                S01310
     I************                           68  71 NT1WK5                S01310
     I                                       72  77 NT1VDT
     I************                           78  79 NT1EF6                S01310
     I**
     I                                      257 272 NTXRS
     I                                      273 273 NTXPDT
     I*
     I            DS
     I********************************************************
     I*     DATA STRUCTURE TO BUILD NOSTRO TRANSFERS         *
     I*     RECORD OUTGOING SWIFT MESSAGE TYPE MT210-2       *
     I********************************************************
     I*
     I                                        1 256 MT2102
     I************                            1   4 NT2WK1                S01310
     I************                            5   5 NT2WK2                S01310
     I************                            6  19 NT2REF                S01310
     I                                       20  20 NT2SSN
     I************                           21  22 NT2EF1                S01310
     I************                           23  27 NT2WK3                S01310
     I                                       28  30 NT2CCY
     I                                       31  45 NT2AMT
     I************                           46  47 NT2EF2                S01310
     I************                          200 202 NT2WK4                S01310
     I                                      203 203 NT2FLG
     I************                          204 204 NT2WK5                S01310
     I                                      205 241 NT2AD1
     I************                          242 243 NT2EF3                S01310
     I*
     I            DS
     I********************************************************
     I*     DATA STRUCTURE TO BUILD NOSTRO TRANSFERS         *
     I*     RECORD OUTGOING SWIFT MESSAGE TYPE MT210-3       *
     I********************************************************
     I*
     I                                        1 256 MT2103
     I                                        1  35 NT3AD2
     I************                           36  37 NT3EF1                S01310
     I                                       38  72 NT3AD3
     I************                           73  74 NT3EF2                S01310
     I                                       75 109 NT3AD4
     I************                          110 111 NT3EF3                S01310
     I************                          149 151 NT3WK1                S01310
     I                                      152 152 NT3IND
     I************                          153 153 NT3WK2                S01310
     I                                      154 190 NT3BA1
     I************                          191 192 NT3EF4                S01310
     I                                      193 227 NT3BA2
     I************                          228 229 NT3EF5                S01310
     I*
     I            DS
     I********************************************************
     I*     DATA STRUCTURE TO BUILD NOSTRO TRANSFERS         *
     I*     RECORD OUTGOING SWIFT MESSAGE TYPE MT210-4       *
     I********************************************************
     I*
     I                                        1 256 MT2104
     I                                        1  35 NT4BA3
     I************                           36  37 NT4EF1                S01310
     I                                       38  72 NT4BA4
     I************                           73  74 NT4EF2                S01310
     I************                          111 112 NT4WK1                S01310
     I************                          113 113 NT4ETX                S01310
      *                                                                   CSW096
     IP@IN        DS                            256                       CSW096
     I                                        1   3 I@SNBR                CSW096
     I                                        4   9 I@DSCN                CSW096
     I                                       10  12 I@MTPY                CSW096
     I                                       13  140I@SETT                CSW096
     I                                       15  15 I@CONC                CSW096
     I                                       16  16 I@FTCS                CSW096
     I                                       17  18 I@MMOD                CSW096
      ** Data structure for input parameter                               CSW096
      *                                                                   CSW096
     IP@OUT       DS                            256                       CSW096
     I**********                              1   60O@CNSN                             CSW096 CSD027
     I                                        1   6 O@CNSN                                    CSD027
     I                                        7  18 O@SWSN                CSW096
     I                                       19  38 O@NWSN                CSW096
     I                                       39  49 O@SWDS                CSW096
     I                                       46  46 W@96CN                CSW096
     I                                       47  49 W@BIC                 CSW096
     I                                       50  69 O@NWDS                CSW096
     I                                       70  75 O@NWRK                CSW096
     I                                       76  76 O@MGSG                CSW096
     I                                       77  80 O@MGST                CSW096
     I                                       81  81 O@PAIN                CSW096
     I                                       82  87 O@PCNB                CSW096
     I                                       88  90 O@SPRS                CSW096
      ** Data structure for output parameter                              CSW096
      *                                                                   CSW096
     I*
     I            DS
     I*
     I**********************************************
     I*       DATA STRUCTURE TO SAVE FIELDS FROM   *
     I*        INSTALLATION CONTROL DATA AREA.     *
     I**********************************************
     I*
     I****************************************1   30SDFBR                 S01117
     I                                        4  15 SCSID
     I                                       12  12 CSID9
     I                                       13  13 CSID10
     I                                       14  14 CSID11
     I                                       15  15 CSID12
     I*
     I**********************************************
     I*   DATA STRUCTURE TO HANDLE THE CONVERSION  *
     I*   OF DATE FORMAT YYMMDD TO DDMMMYY.        *
     I**********************************************
     I            DS
     I                                        1   60SDATE
     I                                        1   2 SYY
     I                                        3   40SMM
     I                                        5   6 SDD
     I            DS
     I                                        1   7 WDATE
     I                                        1   2 WDD
     I                                        3   5 WMM
     I                                        6   7 WYY
     I*
     I**********************************************
     I*   DATA STRUCTURE TO MANIPULATE AMOUNT      *
     I**********************************************
     I            DS
     I                                        1  130WAMNT
     I                                        1  13 RAMNT
     I* FOR EDITING ON THE REPORT
     I                                        1  130P2AMT0
     I                                        1  130P2AMT1
     I                                        1  130P2AMT2
     I                                        1  130P2AMT3
     I*
     I**********************************************
     I*   DATA STRUCTURE TO ELIMINATE BLANK LINES  *
     I**********************************************
     IOFSPT       DS                            175
     I                                        1  35 OFSPT1
     I                                       36  70 OFSPT2
     I                                       71 105 OFSPT3
     I                                      106 140 OFSPT4
     I                                      141 175 OFSPT5
     I*
     I**********************************************
     I*       DATA STRUCTURE USED IN THE EVENT     *
     I*                    OF DATABASE ERRORS.     *
     I**********************************************
     I*
     IDLDA        DS                            256
     I**************************************134 138 DBFILE                S01194
     I**************************************139 167 DBKEY                 S01194
     I**************************************168 175 DBPGM                 S01194
     I**************************************176 177 DBASE                 S01194
     I                                      134 141 DBFILE                S01194
     I                                      142 170 DBKEY                 S01194
     I                                      171 180 DBPGM                 S01194
     I                                      181 1830DBASE                 S01194
     I*
     I**********************************************
     I****DATA*STRUCTURE*USED*IN*UPDATING*OTHER    *                      S01310
     I****MESSAGES*COUNT*IN*DATA*AREA*MSFCTL*.****************************E21286
     I****MESSAGES*COUNT*IN*DATA*AREA*FTFCTL*.     *                E21286S01310
     I**********************************************
     I*
     I*FCTL       DS                            256                       S01310
     I**********                          P  91  930DFOMC                 S01310
     I**********                          P  94  960DFOTL                 S01310
     I*
     I**********************************************
     I*       DATA STRUCTURE - PROGRAM STATUS      *
     I**********************************************
     I*
     IPSDS       SDS
     I                                        1  10 ##PGM                 S01494
     I                                      254 263 USRID
     I*********************************************                       S01310
     I********DATA STRUCTURE TO CONTAIN           *                       S01310
     I************ HEX FIELDS                     *                       S01310
     I*********************************************                       S01310
     I************                                                        S01310
     I************DS                                                      S01310
     I************                        B   1   20B0D                   S01310
     I************                            2   2 X0D                   S01310
     I************                        B   3   40B25                   S01310
     I************                            4   4 X25                   S01310
     I************                        B   5   60B01                   S01310
     I************                            6   6 X01                   S01310
     I************                        B   7   80B03                   S01310
     I************                            8   8 X03                   S01310
     I************                            9  10 X0D25                 S01310
     I*
     I                                        1  12 CSID                  S01310
     I                                        9  11 @BIC                  S01310
      **  Data structure to test for BIC code                             S01310
      *                                                                   S01310
     IMULT        DS                         95                           S01310
     I                                        1   5 MTAG                  S01310
     I                                        6  55 MFLD                  S01310
      **  Multiple occurrence data structure for message                  S01310
      *                                                                   S01310
     I@MTAG       DS                          5                           S01310
     I                                        1   1 COLON1                S01310
     I                                        2   3 FLDNO                 S01310
     I                                        4   4 TAG                   S01310
     I                                        5   5 COLON2                S01310
      **  Data structure constructing message field tag                   S01310
      *                                                                   S01310
     IFLD32A      DS                         18                           S01310
     I                                        1   60VDATD3                S01310
     I                                        7   9 CCY32A                S01310
     I                                       10  24 AMT32A                S01310
      **  Data structure containing codeword for field 32A                S01310
      *                                                                   S01310
     IFLD32B      DS                         18                           S01310
     I                                        1   3 CCY32B                S01310
     I                                        4  18 AMT32B                S01310
      **  Data structure containing codeword for field 32B                S01310
      *                                                                   S01310
     IREFNO       DS                         16                           S01310
     I                                        1   2 MODID                 S01310
     I                                        3  12 DATE                  S01310
     I                                       13  14 PAYTP                 S01310
     I                                       15  16 SETTP                 S01310
      **  Data structure to produce payment reference.                    S01310
      *                                                                   S01310
     ITFRF        DS                                                      S01310
     I                                        2  11 PDATE                 S01310
     I                                       14  15 PSET                  S01310
      **  Data structure to produce payment reference.                    S01310
      *                                                                   S01310
     I*  DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
     ICPYR@#      DS
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
      *                                                                   S01310
     ISDCUST    E DSSDCUSTPD                                              S01310
      **  External Data structure for customer details.                   S01310
      *                                                                   S01310
     ISDMMOD    E DSSDMMODPD                                              S01310
      **  External Data structure for modules files.                      S01310
      *                                                                   S01310
     ISDMGME    E DSSDMGMEPD                                              S01310
      **  Data structure for MESSAGE MANAGEMENT file                      S01310
      *                                                                   S01310
     ISDCURR    E DSSDCURRPD                                              S01117
      **  Data structure for CURRENCIES file                              S01117
      *                                                                   S01117
     IDSFDY     E DSDSFDY                                                 S01310
      **  Short data structure for access programs                        S01310
      *                                                                   S01310
     IDSSDY     E DSDSSDY                                                 S01310
      **  Long data structure for access programs                         S01310
      *                                                                   S01310
     ISCSARD    E DSSCSARDPD                                              CSW020
      **  External data structure - SAR details                           CSW020
      *                                                                                       CSD015
     IWLTDS     E DSSDWLTOPD                                                                  CSD015
      ** Data structure for 1st parameter of Watchlist Engine (SDCWLCHK)                      CSD015
      *                                                                                       CSD015
     IPSTRNG      DS                           9999                                           CSD015
      ** Data structure for 2nd parameter of Watchlist Engine (SDCWLCHK)                      CSD015
      *                                                                                       CSD015
     ISDWLCC    E DSSDWLCCPD                                                                  222385
      ** Watch list checking details                                                          222385
      *                                                                                       222385
     I/COPY WNCPYSRC,FT0656I001
      *                                                                   CSW020
     I/EJECT
     C                     MOVEACPY@      BIS@   80
     C           *LIKE     DEFN OPPARM    IPPARM
      *                                                                                       227364
      **  Set up currency/nostro code key                                                     227364
      *                                                                                       227364
     C           NKEY      KLIST                                                              227364
     C                     KFLD           CCY                                                 227364
     C                     KFLD           NNOST                                               227364
      *                                                                                       227364
     C******************************                                      S01310
     C*****KEY*LIST*****PARAMETERS *                                      S01310
     C******************************                                      S01310
     C***********CUSKEY****KLIST                                          S01310
     C*********************KFLD           KCUSNO                          S01310
     C*********************KFLD           KEYA                            S01310
     C*
     C******************************
     C*    INPUT OUTPUT PARAMETERS *
     C******************************
     C           *ENTRY    PLIST
     C                     PARM           IPPARM
     C                     PARM           OPPARM
     C                     PARM           RSEQ                            S01117
     C*
     C***********************
     C*    FIRST CYCLE.     *
     C***********************
     C*
     C  N40                EXSR FIRST
     C*
     C****************************
     C*    DETAIL PROCESSING.    *
     C****************************
     C*
     C/EJECT
     C*
     C*************************************************
     C*    RECORD READ FROM NTRANDD VIA LOGICAL PRFP4 *
     C*************************************************
      *                                                                   S01310
     C                     MOVELCHTP      @CHG    1                                           CSW025
      *                                                                                       CSW025
      ** Initialise non-constant fields                                   S01310
      *                                                                   S01310
     C                     EXSR INTF                                      S01310
     C*
     C                     EXSR BRANCH                                    S01117
     C** KEEP TALLY OF NUMBER OF RECORDS READ FROM LF/PRFP4
     C*********************ADD  1         P3NO1                           S01117
     C                     ADD  1         AUNO1                           S01117
     C***SET*OFF*TELEX*MESSAGE*INDICATORS                                 S01310
     C**********           SETOF                     3435                 S01310
     C*                                                                   E21276
     C** SET OFF EMPTY FIELD INDICATORS (FOR INTERMEDIARY BANK            E21276
     C** AND FOR BANK TO BANK INFORMATION).                               E21276
     C*                                                                   E21276
     C                     SETOF                     5152                 E21276
     C*
     C** SETUP PARAMETERS  AND EXECUTE SR01 TO
     C** DETERMINE SWIFT ADDRESS OF DESTINATION BANK
     C*
     C                     MOVE 'N'       ISPTP   1
     C                     MOVELDEST      ISPTY1 35
     C                     MOVE *BLANKS   ISPTY2 35
     C                     MOVE *BLANKS   ISPTY3 35
     C                     MOVE *BLANKS   ISPTY4 35
     C                     MOVE *BLANKS   ISPTY5 35
     C                     MOVE CCY       ISCCY   3
     C                     MOVE 'A'       IVTAG1  1
     C                     MOVE ' '       IVTAG2  1
     C                     MOVE ' '       IVTAG3  1
     C*
     C* SETON INDICATOR FOR SUBSEQUENT BLOCK OF SWFT CALL FOR
     C* DETAIL FIELD ADDRESSES(RATHER THAN DESTINATION ADDRESS)
      * Also seton indicator for message is an MT200 to enable the        S01310
      * network to be correctly decided.                                  S01310
     C*
     C*********************SETON                     20                   S01310
     C                     SETON                     2021                 S01310
     C*
     C                     EXSR SR01
     C*
     C***PARAMETERS*OFSPT1*SHOULD*BE*MOVED*TO**************************                      260987A
     C***FIELD*RECIPIENT*ADDRESS*OF*SWIFT*DATA*STRUCTURE***************                      260987A
     C***SAVE*IT*AS*IT*WILL*BE*USED*IN*SUBROUTINE*10*&*4.**************                      260987A
     C***********                                                                            260987A
     C**********           MOVELOFSPT1    RECADD 12                                          260987A
      *                                                                                      260987A
      ** Output same destination to printout as MGOREFPD.                                    260987A
      *                                                                                      260987A
     C                     MOVELNWDS      RECADD 12                                          260987A
     C*
     C*  SAVE CUSTOMER FIELDS TO BE USED IN SUBROUTINE 8
     C*
     C**********           MOVE CUSTNO    SCUSNO  60                                          CSD027
     C                     MOVE CUSTNO    SCUSNO  6                                           CSD027
     C                     MOVE CTWN      SCTWN  10
     C                     MOVE CRNM      SCRNM  20
     C*
     C*  SAVE MT200 INDICATOR AND THEN CALL SR01 A SECOND TIME IN ORDER
     C*  TO DETERMINE VALUES ASSOCIATED WITH MT210
     C*
     C                     MOVE OSUFLG    MT200X  1
     C                     MOVE SWTX      SWT200  1
     C*
     C********** SWTX      IFEQ 'T'                                                          260987A
     C**********           MOVE MXOTLX    MTD200 12                                          260987A
     C**********           SETON                     34                   S01310
     C**********           ELSE                                                              260987A
     C**********           MOVE MXOSFT    MTD200                                             260987A
     C**********           END                                                               260987A
      *                                                                                      260987A
      ** Sender's address on printout to be same as output to MGOREFPD.                      260987A
      *                                                                                      260987A
     C                     MOVELNWSN      MTD200 12                                          260987A
      *                                                                   S01310
      ** Save the network ,the sender and receiver addresses, and the     S01310
      ** message type and status to prevent them being overwritten by     S01310
      ** the MT210 messages.                                              S01310
      *                                                                   S01310
     C                     MOVELNWRK      SNWRK   6                       S01310
     C                     MOVELNWSN      SNWSN  20                       S01310
     C                     MOVELNWDS      SNWDS  20                       S01310
     C                     MOVELMGST      SMGST   4                       S01310
     C                     MOVELMGSG      SMGSG   1                       S01310
      *                                                                   S01310
     C                     MOVEL*BLANKS   NWRK                            S01310
     C                     MOVEL*BLANKS   NWSN                            S01310
     C                     MOVEL*BLANKS   NWDS                            S01310
     C                     MOVE *BLANKS   MGST                            S01310
     C*
      ** Account with bank for the destination of the MT210.              S01310
      *                                                                   S01310
     C                     MOVE 'N'       ISPTP   1
     C                     MOVELACBN      ISPTY1 35
     C                     MOVE *BLANKS   ISPTY2 35
     C                     MOVE *BLANKS   ISPTY3 35
     C                     MOVE *BLANKS   ISPTY4 35
     C                     MOVE *BLANKS   ISPTY5 35
     C                     MOVE CCY       ISCCY   3
     C                     MOVE 'A'       IVTAG1  1
     C                     MOVE ' '       IVTAG2  1
     C                     MOVE ' '       IVTAG3  1
     C*
     C* SETON INDICATOR FOR SUBSEQUENT BLOCK OF SWFT CALL FOR
     C* DETAIL FIELD ADDRESSES(RATHER THAN DESTINATION ADDRESS)
     C*
     C                     SETON                     20
     C                     MOVE '0'       *IN21                           S01310
     C*
     C                     EXSR SR01
     C*
     C* SAVE MT210 INDICATOR
     C*
     C                     MOVE OSUFLG    MT210X  1
     C                     MOVE SWTX      SWT210  1
     C                     MOVE SCSID     ACSWID 12
     C                     MOVELOFSPT1    RECAD2 12
     C**********           MOVE CUSTNO    SCUSN2  60                                          CSD027
     C                     MOVE CUSTNO    SCUSN2  6                                           CSD027
     C                     MOVE CTWN      SCTWN2 10
     C                     MOVE CRNM      SCRNM2 20
     C*
     C********** SWTX      IFEQ 'T'                                                          260987A
     C**********           MOVE MXOTLX    MTD210 12                                          260987A
     C**********           SETON                     35                   S01310
     C**********           ELSE                                                              260987A
     C**********           MOVE MXOSFT    MTD210                                             260987A
     C**********           END                                                               260987A
      *                                                                                      260987A
      ** Sender's address on printout to be same as output to MGOREFPD.                      260987A
      *                                                                                      260987A
     C                     MOVELNWSN      MTD210 12                                          260987A
      *                                                                   S01310
      ** Save the network ,network addresses and message status.          S01310
      *                                                                   S01310
     C                     MOVELNWRK      SNWRK2  6                       S01310
     C                     MOVELNWSN      SNWSN2 20                       S01310
     C                     MOVELNWDS      SNWDS2 20                       S01310
     C                     MOVELMGST      SMGST2  4                       S01310
     C                     MOVELMGSG      SMGSG2  1                       S01310
     C*
     C                     MOVE MTD210    NT1MXO
     C                     MOVE *BLANKS   NT3IND                          E21276
     C                     MOVE *BLANKS   NT3BA1
     C                     MOVE *BLANKS   NT3BA2
     C                     MOVE *BLANKS   NT4BA3
     C                     MOVE *BLANKS   NT4BA4
     C                     MOVE '0'       *IN50
      *                                                                   042492
      ** The branch's BIC (branch internal customer) from the Sender      042492
      ** will be printed in the 52A Ordering Institution field.           042492
      *                                                                   042492
      ** If the Intermediary Bank exists then this will be printed in     042492
      ** the 56A Intermediary field.                                      042492
      *                                                                   042492
      ** If the Intermediary Bank is not entered then the Destination     042492
      ** will be printed in the 56A Intermediary field.                   042492
      **                                                                  042492
     C                     MOVEL*BLANKS   NT2AD1                          042492
     C                     MOVEL*BLANKS   NT3AD2                          042492
     C                     MOVEL*BLANKS   NT3AD3                          042492
     C                     MOVEL*BLANKS   NT3AD4                          042492
      *                                                                   042492
      ** Set up the destination bank field with the branch's internal     042492
      ** customer number.                                                 042492
      *                                                                   042492
     C                     MOVEL*BLANKS   WRK11                           042492
     C                     MOVELMTD210    WRK8    8                       042492
     C                     MOVE MTD210    WRK3    3                       042492
     C                     MOVELWRK8      WRK11  11                       042492
      *                                                                   042492
     C           WRK3      IFNE 'XXX'                                     042492
     C                     MOVE WRK3      WRK11                           042492
     C                     END                                            042492
      *                                                                   042492
     C                     MOVELWRK11     NT2AD1                          042492
      *                                                                   042492
      **  Ensure that a 52A field is output                               042492
      *                                                                   042492
     C                     MOVEL'A'       NT2FLG                          042492
      *                                                                   S01310
      ** Intermediary Bank.                                               S01310
      *                                                                   S01310
     C***********INBK      IFNE *BLANKS                                   S01494
     C***********                                                         S01494
     C*********************MOVELINBK      KCUSNO                          S01310
     C*********************MOVE 'A'       KEYA                            S01310
     C***********CUSKEY****CHAINCLINTCBF             50                   S01310
     C*********************                                               S01310
     C************IN50*****IFEQ '1'                                       S01310
     C*********************MOVELINBK      SHORTN 10                       S01310
     C***********SHORTN****CHAINSNAMEF               50                   S01310
     C*********************                                               S01310
     C************IN50*****IFEQ '1'                                       S01310
     C***********INBK******CHAINMSADRCBF             50                   S01310
     C*********************END                                            S01310
     C*********************                                               S01310
     C*********************END                                            S01310
     C*********************                                               S01310
     C************IN50*****IFEQ '0'                                       S01310
     C*********************TESTB'0'       CMIN       50                   S01310
     C*********************END                                            S01310
     C*********************                                               S01310
     C************IN50*****IFEQ '1'                        )))))))))))))))S01310
     C*********************MOVE 'CLINT'   DBFNAM  5        )))  DATA   )))S01310
     C*********************MOVELINBK      DBERKY 39        )))  BASE   )))S01310
     C*********************MOVE '20'      DBERR#           )))  ERROR  )))S01310
     C*********************EXSR DBERR                      )))   20    )))S01310
     C*********************END                             )))))))))))))))S01310
     C*********************                                            )))S01310
     C*********************MOVE CNUM      KCUSNO                       )))S01310
     C*********************MOVE 'B'       KEYA                         )))S01310
     C***********CUSKEY****CHAINCLINTCCF             12                   S01310
     C************IN12*****IFEQ '1'                        )))))))))))))))S01310
     C*********************MOVE 'CLINT'   DBFNAM  5        )))  DATA   )))S01310
     C*********************MOVE '      B' DBERKY 39        )))  BASE   )))S01310
     C*********************MOVE '21'      DBERR#           )))  ERROR  )))S01310
     C*********************EXSR DBERR                      )))   21    )))S01310
     C*********************END                             )))))))))))))))S01310
      ***********                                                  S01310 S01494
      ****Access*SDCUSTPD*using*Intermediary.**********************S01310 S01494
      ***********                                                  S01310 S01494
     C***********          MOVE *BLANKS   @KEY1                    S01310 S01494
     C***********          MOVELINBK      @KEY1                    S01310 S01494
     C***********          CALL 'AOCUSTR0'                         S01310 S01494
     C***********          PARM '*MSG   ' @RTCD   7                S01310 S01494
     C***********          PARM '*KEY   ' @OPTN   7                S01310 S01494
     C***********          PARM           @KEY1  10                S01310 S01494
     C***********          PARM *BLANKS   @KYST   7                S01310 S01494
     C***********SDCUST    PARM SDCUST    DSSDY                    S01310 S01494
      *********************                                         S01310S01117
      ***Check*the*bank/non-bank*indicator.*                        S01310S01117
      *********************                                         S01310S01117
     C***********@RTCD*****IFEQ *BLANKS                             S01310S01117
     C***********BBBNBI****ANDEQ'N'                                 S01310S01117
     C*********************MOVE '1'       *IN50                     S01310S01117
     C*********************END                                      S01310S01117
     C***********                                                         S01117
     C***If*not*cust no.*or*short*name*,*then*is*INBK*a*SWIFT*address?*   S01117
      ***********                                                  S01117 S01494
     C***********@RTCD     IFNE *BLANKS                            S01117 S01494
     C***********INBK      CHAINSDCUSTL7             50            S01117 S01494
     C***********          END                                     S01117 S01494
     C***********                                                  S01117 S01494
     C***Check*the*bank/non-bank*indicator.                        S01117 S01494
     C***********                                                  S01117 S01494
     C************IN50     IFEQ '0'                                S01117 S01494
     C***********BBBNBI    ANDNE'Y'                                S01117 S01494
     C***********          MOVE '1'       *IN50                    S01117 S01494
     C***********          END                                     S01117 S01494
      ***********                                                  S01310 S01494
      ***Customer*record*not*found*or*intermediary*is*not*a*bank*-*S01310 S01494
      ***********                                                  S01310 S01494
     C***********@RTCD*****IFNE *BLANKS                             S01310S01117
     C************IN50*****OREQ '1'                                 S01310S01117
     C************IN50     IFEQ '1'                                S01117 S01494
     C***********          MOVE '004'     DBERR#            * * * *S01310 S01494
     C*********************MOVEL@KEY1     DBERKY            * DBERR 004 *0S01117
     C***********          MOVELINBK      DBERKY            * * * *S01117 S01494
     C***********          MOVEL'SDCUSTPD'DBFNAM                   S01310 S01494
     C***********          EXSR DBERR                              S01310 S01494
      ***********                                                  S01310 S01494
     C***********          ELSE                                    S01310 S01494
     C***********          EXSR CUST                               S01310 S01494
     C*                                                                   S01494
     C** Setup parameters and execute SR01 for Intermediary Bank          S01494
     C*                                                                   S01494
     C                     MOVELNTINBT    ISPTP                           S01494
     C                     MOVELNTINB1    ISPTY1                          S01494
     C                     MOVELNTINB2    ISPTY2                          S01494
     C                     MOVELNTINB3    ISPTY3                          S01494
     C                     MOVELNTINB4    ISPTY4                          S01494
     C                     MOVELNTINB5    ISPTY5                          S01494
     C                     MOVE CCY       ISCCY                           S01494
     C                     MOVE 'A'       IVTAG1                          S01494
     C                     MOVE ' '       IVTAG2                          S01494
     C                     MOVE 'D'       IVTAG3                          S01494
     C*                                                                   S01494
     C** Set off indicator for block of SWIFT call for detail             S01494
     C** field address (rather than destination address)                  S01494
     C*                                                                   S01494
     C                     SETOF                     20                   S01494
     C                     MOVEL'Y'       W201IN  1                                           CSW201
     C*                                                                   S01494
     C                     EXSR SR01                                      S01494
     C                     MOVEL'N'       W201IN                                              CSW201
     C*
     C* FILL MT210 DATA STRUCTURE FOR INTERMEDIARY BANK
     C*
     C           NTINBT    IFEQ *BLANKS                                   147120
     C           CSID      IFEQ *BLANKS
     C                     MOVELCNA1      NT3BA1
     C                     MOVE CNA2      NT3BA2
     C                     MOVE CNA3      NT4BA3
     C                     MOVE CNA4      NT4BA4
     C                     MOVE 'D'       NT3IND
     C                     ELSE
     C                     MOVELCSID      NT3BA1
     C                     MOVE 'A'       NT3IND
     C                     END
     C                     ELSE                                           147120
     C                     MOVELOFSPT1    NT3BA1                          147120
     C                     MOVELOFSPT2    NT3BA2                          147120
     C                     MOVELOFSPT3    NT4BA3                          147120
     C                     MOVELOFSPT4    NT4BA4                          147120
     C                     MOVE OSTAG     NT3IND                          147120
     C                     ENDIF                                          147120
     C***********          END                                     S01310 S01494
     C*
     C***********          END                                            S01494
      *                                                                   S01310
      ** Destination .                                                    S01310
      *                                                                   S01310
     C*
     C**USE*CUSNO*OBTAINED*IN FIRST CALL OF SR01 TO ACCESS CLINTCC        S01310
     C**FOR*ADDRESS*DETAILS/SWIFT ADDRESS OF DESTINATION BANK             S01310
     C*********************                                               S01310
     C*********************MOVE SCUSNO    KCUSNO                          S01310
     C*********************MOVE 'A'       KEYA                            S01310
     C***********CUSKEY****CHAINCLINTCBF             12    )))))))))))))))S01310
     C*********************                                )))  DATA   )))S01310
     C************IN12*****IFEQ '1'                        )))  BASE   )))S01310
     C*********************MOVE 'CLINT'   DBFNAM           )))  ERROR  )))S01310
     C*********************MOVEL'      A' DBERKY           )))  23     )))S01310
     C*********************MOVELKCUSNO    DBERKY           )))))))))))))))S01310
     C*********************MOVE '23'      DBERR#                          S01310
     C*********************EXSR DBERR                                     S01310
     C*********************END                                            S01310
     C*********************                                               S01310
     C***********CSID******IFEQ *BLANKS                                   S01310
     C*********************MOVE 'B'       KEYA                            S01310
     C***********CUSKEY****CHAINCLINTCCF             12                   S01310
     C*********************                                )))))))))))))))S01310
     C*********************                                )))  DATA   )))S01310
     C************IN12*****IFEQ '1'                        )))  BASE   )))S01310
     C*********************MOVE 'CLINT'   DBFNAM           )))  ERROR  )))S01310
     C*********************MOVEL'      A' DBERKY           )))  24     )))S01310
     C*********************MOVELKCUSNO    DBERKY           )))))))))))))))S01310
     C*********************MOVE '24'      DBERR#                          S01310
     C*********************EXSR DBERR                                     S01310
     C*********************ELSE                                           S01310
      *                                                                   S01310
      ** Access PF/SDCUSTPD for destination bank obtained in SR01.(scusno)S01310
      *                                                                   S01310
     C                     MOVE *BLANKS   @KEY1                           S01310
     C                     MOVELSCUSNO    @KEY1                           S01310
     C                     CALL 'AOCUSTR0'                                S01310
     C                     PARM '*MSG   ' @RTCD   7                       S01310
     C                     PARM '*KEY   ' @OPTN   7                       S01310
     C                     PARM           @KEY1  10                       S01310
     C                     PARM *BLANKS   @KYST   7                       S01310
     C           SDCUST    PARM SDCUST    DSSDY                           S01310
      *                                                                   S01310
      ** Customer record not found - Error                                S01310
      *                                                                   S01310
     C           @RTCD     IFNE *BLANKS                                   S01310
     C                     MOVE '23'      DBERR#             * * * * * * *S01310
     C                     MOVEL@KEY1     DBERKY             * DBERR 023 *S01310
     C                     MOVEL'SDCUSTPD'DBFNAM             * * * * * * *S01310
     C                     EXSR DBERR                                     S01310
     C                     END                                            S01310
      *                                                                   S01310
     C                     EXSR CUST                                      S01310
      *                                                                   S01310
      *
      **  Ensure that the destination bank fields contain final           042492
      **  destination details rather than those of an intermediary        042492
      **  bank (if intermediary bank used).                               042492
      *                                                                   042492
     C***********CSID      IFEQ *BLANKS                             S01310042492
     C*********************MOVE *BLANKS   NT2AD1                          042492
     C*********************MOVELCNA1      NT2AD1                          042492
     C*********************MOVE CNA2      NT3AD2                          042492
     C*********************MOVE CNA3      NT3AD3                          042492
     C*********************MOVE CNA4      NT3AD4                          042492
     C*********************MOVE 'D'       NT2FLG                          042492
     C*********************END                                            S01310
     C*
     C*********************ELSE                                           042492
     C*********************MOVE *BLANKS   NT2AD1                          042492
     C*********************MOVELCSID      NT2AD1                          042492
     C*********************MOVE *BLANKS   NT3AD2                          042492
     C*********************MOVE *BLANKS   NT3AD3                          042492
     C*********************MOVE *BLANKS   NT3AD4                          042492
     C*********************MOVE 'A'       NT2FLG                          042492
     C*********************END                                            042492
      *                                                                   042492
      **  If an intermediary bank is to be used set up all                042492
      **  intermediary fields correctly here.                             042492
      *                                                                   042492
     C***********NT3IND    IFNE *BLANKS                            042492 S01494
     C           NT3IND    IFEQ *BLANKS                                   S01494
     C*                                                                   S01494
     C           CSID      IFEQ *BLANKS                                   S01494
     C                     MOVE *BLANKS   NT3BA1                          042492
     C                     MOVELCNA1      NT3BA1                          042492
     C                     MOVE CNA2      NT3BA2                          042492
     C                     MOVE CNA3      NT4BA3                          042492
     C                     MOVE CNA4      NT4BA4                          042492
     C                     MOVE 'D'       NT3IND                          042492
      *                                                                   042492
     C                     ELSE                                           042492
      *                                                                   042492
      **  If the intermediary bank is blank fill the fields directly      042492
      **  with the receiver bank information which will be the            042492
      **  destination.                                                    042492
      *                                                                   042492
     C                     MOVEL*BLANKS   NT3BA1                          042492
     C                     MOVELCSID      NT3BA1                          042492
     C                     MOVEL*BLANKS   NT3BA2                          042492
     C                     MOVEL*BLANKS   NT4BA3                          042492
     C                     MOVEL*BLANKS   NT4BA4                          042492
     C                     MOVE 'A'       NT3IND                          042492
     C                     END                                            042492
     C*                                                                   S01494
     C                     END                                            S01494
     C*
     C*  IF MT200 INDICATOR = 'N' FROM SUBROUTINE SR01
     C***THEN*THE*MESSAGE*MUST BE SENT VIA TELEX                          S01310
      ** then the message is a paper message and must be printed out      S01310
      ** aswell as writing a record to PF/MGOREFPD and PF/MGOMSGPD.       S01310
      *
     C           MT200X    IFEQ 'N'
     C*                                                                   S01117
     C* IF MULTIBRANCHING INDICATOR ACTIVE,MOVE BOOKING BRANCH AND        S01117
     C* BRANCH NAME TO THE RELATIVE FIELDS SET UP WITHIN THE PRINTER FILE S01117
     C*                                                                   S01117
     C           *IN60     IFEQ '1'                                       S01117
     C                     MOVE BRCAA     P2BRCA                          S01117
     C                     MOVELBRNM      P2BRNM                          S01117
     C                     END                                            S01117
     C*
     C*  FORMAT DEST BANK FROM DESTINATION FIELDS
     C*
     C                     MOVE 'N'       ISPTP
     C                     MOVE *BLANKS   ISPTY1
     C                     MOVELDEST      ISPTY1
     C                     MOVE *BLANKS   ISPTY2
     C                     MOVE *BLANKS   ISPTY3
     C                     MOVE *BLANKS   ISPTY4
     C                     MOVE *BLANKS   ISPTY5
     C                     EXSR SR05
     C*  DESTINATION FIELD PRINT LINE
     C                     MOVELOFSPT1    P2DST1
     C                     MOVELOFSPT2    P2DST2
     C                     MOVELOFSPT3    P2DST3
     C                     MOVELOFSPT4    P2DST4
     C                     MOVELOFSPT5    P2DST5
     C*
     C*  FORMAT ACCOUNT WITH BANK
     C                     MOVE 'N'       ISPTP
     C                     MOVE *BLANKS   ISPTY1
     C                     MOVELACBN      ISPTY1
     C                     MOVE *BLANKS   ISPTY2
     C                     MOVE *BLANKS   ISPTY3
     C                     MOVE *BLANKS   ISPTY4
     C                     MOVE *BLANKS   ISPTY5
     C                     EXSR SR05
     C*  MOVE FORMATTED ACCOUNT WITH BANK FIELDS
     C*  INTO PRINT LINE
     C                     MOVELOFSPT1    P2AWB1
     C                     MOVELOFSPT2    P2AWB2
     C                     MOVELOFSPT3    P2AWB3
     C                     MOVELOFSPT4    P2AWB4
     C                     MOVELOFSPT5    P2AWB5
      *                                                                   E29973
     C*  FORMAT INTERMEDIATE BANK                                         E29973
     C***********          MOVE 'I'       ISPTP                           S01494
     C***********          MOVE *BLANKS   ISPTY1                          S01494
     C***********          MOVELINBK      ISPTY1                          S01494
     C***********          MOVE *BLANKS   ISPTY2                          S01494
     C***********          MOVE *BLANKS   ISPTY3                          S01494
     C***********          MOVE *BLANKS   ISPTY4                          S01494
     C***********          MOVE *BLANKS   ISPTY5                          S01494
     C                     MOVELNTINBT    ISPTP                           S01494
     C                     MOVELNTINB1    ISPTY1                          S01494
     C                     MOVELNTINB2    ISPTY2                          S01494
     C                     MOVELNTINB3    ISPTY3                          S01494
     C                     MOVELNTINB4    ISPTY4                          S01494
     C                     MOVELNTINB5    ISPTY5                          S01494
     C                     EXSR SR05                                      E29973
     C                     MOVELOFSPT1    P2IBK1                          E29973
     C                     MOVELOFSPT2    P2IBK2                          E29973
     C                     MOVELOFSPT3    P2IBK3                          E29973
     C                     MOVELOFSPT4    P2IBK4                          E29973
     C                     MOVELOFSPT5    P2IBK5                          E29973
     C*
     C*  FORMAT BANK TO BANK INFORMATIONS                              ***
     C                     MOVE BBI1      P2BTB1                       ***
     C                     MOVE BBI2      P2BTB2                       ***
     C                     MOVE BBI3      P2BTB3                       ***
     C                     MOVE BBI4      P2BTB4                       ***
     C*
     C*   DETERMINE AMOUNT
     C                     EXSR SR06
     C                     EXSR SRP2                       PRT TELX REPORT
     C*********************ELSE                            SWFT USER FLG=YS01310
     C                     END                                            S01310
      *                                                                   S01310
      ** Write a record to PF/MGOREFPD and PF/MGOMSGPD for an MT200.      S01310
      *                                                                   S01310
     C*
     C*  INTIALISE AND PRESET FIELDS IN DATA STRUCTURE
     C*  FOR SWIFT MESSAGES TYPE RECORDS
     C                     EXSR SR10
     C*
      *                                                                   S01310
      ** Field :20: - Transaction Reference Number.                       S01310
      *                                                                   S01310
     C                     Z-ADD1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     MOVEA*BLANKS   @WRK                            S01310
      *                                                                   S01310
     C                     MOVEL':20:'    MTAG                            S01310
     C                     MOVE 'FT'      MODID                           S01310
     C                     MOVE PDATE     DATE                            S01310
     C                     MOVE 'NP'      PAYTP                           S01310
     C                     MOVE PSET      SETTP                           S01310
     C                     MOVELREFNO     MFLD                            S01310
      *                                                                   S01310
      ** Save the transaction Reference Number.                           S01310
      *                                                                   S01310
     C                     MOVELMFLD      TRNB   16                       S01310
     C                     MOVELMFLD      TRNO                            S01310
     C                     MOVELMFLD      M1TREF                          S01310
     C/COPY WNCPYSRC,FTH00597
      *                                                                   S01310
      ** Field :32A: - Value Date, Currency Code, Amount.  (MT200).       S01310
      *                                                                   S01310
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     MOVEL':32A:'   MTAG                            S01310
     C*********************MOVELCCY       CCY32A                    S01310S01117
     C*  FORMAT THE AMOUNT                                                S01310
     C                     EXSR SR06                                      S01310
     C                     MOVE M1RCCY    CCY32A                          S01117
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0656CCP1                                           S01408
     C*                                                                   S01408
     C                     MOVEASAM       FAMT                            S01310
     C                     Z-ADD1         S       30                      S01310
     C           FAMT,S    DOWEQ' '                                       S01310
     C                     ADD  1         S                               S01310
     C                     END                                            S01310
     C                     MOVE *BLANKS   AMT32A                          084587
     C                     MOVEAFAMT,S    AMT32A                          S01310
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0656CCP2                                           S01408
     C*                                                                   S01408
     C                     MOVELAMT32A    M1AMNT                          S01310
      *                                                                   S01310
     C                     MOVELFLD32A    MFLD                            S01310
     C/COPY WNCPYSRC,FTH00598
      *                                                                                       227364
     C/COPY WNCPYSRC,FTH00599
      ** Field :53B: - Senders Correspondent    (MT200).                                      227364
      *                                                                                       227364
     C                     MOVELDEST      NNOST   2                                           227364
     C           NKEY      CHAINSDNOSTL0             60                                       227364
      *                                                                                       227364
     C           *IN60     IFEQ '1'                        ***************                    227364
     C                     MOVELDEST      DBKEY            *DB ERROR 033 *                    227364
     C                     MOVE '033'     DBASE            ***************                    227364
     C                     MOVEL'SDNOSTPD'DBFILE                                              227364
     C                     EXSR DBERR                                                         227364
     C                     ELSE                                                               227364
      *                                                                                       227364
      ** 'Our Account Number at Nostro' is non-blank.                                         227364
      *                                                                                       227364
     C*********  A7OANN    IFNE *BLANKS                                                227364 263658
     C           A7OACN    IFNE *BLANKS                                                       263658
     C                     ADD  1         Q                                                   227364
     C           Q         OCUR MULT                                                          227364
     C                     MOVEA*BLANKS   @WRK                                                227364
     C                     MOVEL':53B:'   MTAG                                                227364
     C                     MOVEA'/'       @WRK,1                                              227364
     C**********           MOVEAA7OANN    @WRK,2                                       227364 263658
     C                     MOVEAA7OACN    @WRK,2                                              263658
     C                     MOVEA@WRK      MFLD                                                227364
     C                     ENDIF                                                              227364
     C                     ENDIF                                                              227364
      *                                                                   S01310
     C/COPY WNCPYSRC,FT0656C003
      ** Field :56 : - Intermediary.            (MT200).                  S01310
      *                                                                   S01310
     C*  FORMAT INTERMEDIATE BANK
     C***********          MOVE 'I'       ISPTP                           S01494
     C***********          MOVE *BLANKS   ISPTY1                          S01494
     C***********          MOVELINBK      ISPTY1                          S01494
     C***********          MOVE *BLANKS   ISPTY2                          S01494
     C***********          MOVE *BLANKS   ISPTY3                          S01494
     C***********          MOVE *BLANKS   ISPTY4                          S01494
     C***********          MOVE *BLANKS   ISPTY5                          S01494
     C***********          EXSR SR05                                      S01494
     C*                                                                   089643
     C** Only output Field 56 to MT200 if Intermediary bank details       089643
     C** are entered.                                                     089643
     C*                                                                   S01494
     C** Setup parameters & execute SR01 to format Intermediary bank      S01494
     C*                                                                   S01494
     C           NTINBT    IFNE *BLANKS                                   089643
     C                     MOVELNTINBT    ISPTP                           S01494
     C                     MOVELNTINB1    ISPTY1                          S01494
     C                     MOVELNTINB2    ISPTY2                          S01494
     C                     MOVELNTINB3    ISPTY3                          S01494
     C                     MOVELNTINB4    ISPTY4                          S01494
     C                     MOVELNTINB5    ISPTY5                          S01494
     C                     MOVE CCY       ISCCY                           S01494
     C                     MOVE 'A'       IVTAG1            Tag Ind 1     S01494
     C                     MOVE ' '       IVTAG2            Tag Ind 2     S01494
     C                     MOVE 'D'       IVTAG3            Tag Ind 3     S01494
     C*                                                                   S01494
     C** Set off indicator for block of SWIFT call for detail             S01494
     C** field address (rather than destination address)                  S01494
     C*                                                                   S01494
     C                     SETOF                     20                   S01494
     C                     MOVEL'Y'       W201IN                                              CSW201
     C*                                                                   S01494
     C                     EXSR SR01                                      S01494
     C                     MOVEL'N'       W201IN                                              CSW201
     C*                                                                   S01494
     C*  INTERMEDIARY BANK PRINT LINES
     C                     MOVELOFSPT1    M2IBK1
     C                     MOVELOFSPT2    M2IBK2
     C                     MOVELOFSPT3    M2IBK3
     C                     MOVELOFSPT4    M2IBK4
     C                     MOVELOFSPT5    M3IBK5
     C                     MOVELOSTAG     M2INTG                          S01310
     C                     MOVELOSTAG     M2IBKT                          S01310
     C*                                                                   E21276
     C** CONDITION OUTPUT OF INTERMEDIARY BANK TO FT0656P1.               E21276
     C*                                                                   E21276
     C           M2IBK1    IFNE *BLANK                                    E21276
     C                     SETON                     51                   E21276
     C                     END                                            E21276
     C*
     C*********************MOVE X0D25     M2CRL1                          S01310
     C*********************MOVE X0D25     M2CRL2                          S01310
     C*********************MOVE X0D25     M2CRL3                          S01310
     C*********************MOVE X0D25     M2CRL4                          S01310
     C*********************MOVE X0D25     M3CRL5                          S01310
     C*********************                                               E29973
     C*********************MOVELOFSPT1    P2IBK1                          E29973
     C*********************MOVELOFSPT2    P2IBK2                          E29973
     C*********************MOVELOFSPT3    P2IBK3                          E29973
     C*********************MOVELOFSPT4    P2IBK4                          E29973
     C*********************MOVELOFSPT5    P2IBK5                          E29973
     C*  FIELD 56 FOR SWIFT OUTPUT
     C*********************MOVE ':56'     M2TG56                          S01310
     C*********************MOVE ':'       M2CLN                           S01310
      *                                                                   S01310
      *                                                                   S01310
      ** Write the record to the multiple occurence data structure.       S01310
      *                                                                   S01310
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     MOVEL'56'      FLDNO                           S01310
     C/COPY WNCPYSRC,FTH00600
     C                     EXSR FSWAD                                     S01310
     C*
     C                     END                                            089643
      *                                                                   S01310
      ** Field :57 : - Account with Bank.         (MT200).                S01310
      *                                                                   S01310
     C*  SETUP PARAMETERS AND EXECUTE SR01 TO
     C*  FORMAT THE 'ACCOUNT WITH BANK' CUSTOMER
     C                     MOVE 'N'       ISPTP            SETTLMT TYPE
     C                     MOVELACBN      ISPTY1           SETTLMT ADD1
     C                     MOVE *BLANKS   ISPTY2           SETTLMT ADD2
     C                     MOVE *BLANKS   ISPTY3           SETTLMT ADD3
     C                     MOVE *BLANKS   ISPTY4           SETTLMT ADD4
     C                     MOVE *BLANKS   ISPTY5           SETTLMT ADD5
     C                     MOVE CCY       ISCCY   3        CURRENCY
     C                     MOVE 'A'       IVTAG1  1        TAG IND 1
     C                     MOVE 'B'       IVTAG2  1        TAG IND 2
     C                     MOVE 'D'       IVTAG3  1        TAG IND 3
     C*
     C* SET OFF INDICATOR FOR BLOCK OF SWFT CALL FOR DETAIL
     C* FIELD ADDRESS(RATHER THAN DESTINATION ADDRESS)
     C*
     C                     SETOF                     20
     C*
     C/COPY WNCPYSRC,FT0656C004
     C                     MOVEL'Y'       W201IN                                              CSW201
     C                     EXSR SR01
     C                     MOVEL'N'       W201IN                                              CSW201
     C/COPY WNCPYSRC,FT0656C005
     C*
     C* MOVE FORMATTED 'ACCOUNT WITH BANK' FIELDS INTO DATA STRUCTURE
     C*------------------------------------------ SWIFT RECORD THREE --
     C                     MOVELOFSPT1    M3AWB1
     C                     MOVELOFSPT2    M3AWB2
     C                     MOVELOFSPT3    M3AWB3
     C                     MOVELOFSPT4    M3AWB4
     C                     MOVELOFSPT5    M3AWB5
     C*
     C           M3AWB1    IFNE *BLANK
     C           M3AWB2    ORNE *BLANK
     C           M3AWB3    ORNE *BLANK
     C           M3AWB4    ORNE *BLANK
     C           M3AWB5    ORNE *BLANK
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     MOVE OSTAG     M3ABTT
     C                     MOVE '57'      FLDNO                           S01310
     C/COPY WNCPYSRC,FTH00601
     C                     EXSR FSWAD                                     S01310
     C*********************MOVE ':57'     M3TG57                          S01310
     C*********************MOVE ':'       M3CLN                           S01310
     C*********************MOVE X0D25     M3CRL1                          S01310
     C                     END
     C*
     C***********M3AWB2****IFNE *BLANK                                    S01310
     C***********M3AWB3****ORNE *BLANK                                    S01310
     C***********M3AWB4****ORNE *BLANK                                    S01310
     C***********M3AWB5****ORNE *BLANK                                    S01310
     C*********************MOVE X0D25     M3CRL2                          S01310
     C*********************END                                            S01310
     C***********M3AWB3****IFNE *BLANK                                    S01310
     C***********M3AWB4****ORNE *BLANK                                    S01310
     C***********M3AWB5****ORNE *BLANK                                    S01310
     C*********************MOVE X0D25     M3CRL3                          S01310
     C*********************END                                            S01310
     C***********M3AWB4****IFNE *BLANK                                    S01310
     C***********M3AWB5****ORNE *BLANK                                    S01310
     C*********************MOVE X0D25     M3CRL4                          S01310
     C*********************END                                            S01310
     C***********M3AWB5****IFNE *BLANK                                    S01310
     C*********************MOVE X0D25     M3CRL5                          S01310
     C*********************END                                            S01310
      *                                                                   S01310
      ** Field :72: - Sender to Receiver Information.   (MT200).          S01310
      *                                                                   S01310
     C*
     C*  MOVE BANK TO BANK INFOS INTO DATA STRUCTURE
     C*------------------------------------------ SWIFT RECORD FOUR  --
     C                     MOVE *BLANKS   OFSPT
     C                     MOVE BBI1      OFSPT1
     C                     MOVE BBI2      OFSPT2
     C                     MOVE BBI3      OFSPT3
     C                     MOVE BBI4      OFSPT4
     C                     EXSR EMBLK
     C                     MOVELOFSPT1    M4BTB1
     C                     MOVELOFSPT2    M4BTB2
     C                     MOVELOFSPT3    M4BTB3
     C                     MOVELOFSPT4    M4BTB4
     C*
     C           M4BTB1    IFNE *BLANKS                                   S01310
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     MOVEL':72:'    MTAG                            S01310
     C                     MOVELM4BTB1    MFLD                            S01310
     C                     END                                            S01310
     C           M4BTB2    IFNE *BLANKS                                   S01310
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     MOVELM4BTB2    MFLD                            S01310
     C                     END                                            S01310
     C           M4BTB3    IFNE *BLANKS                                   S01310
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     MOVELM4BTB3    MFLD                            S01310
     C                     END                                            S01310
     C           M4BTB4    IFNE *BLANKS                                   S01310
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     MOVELM4BTB4    MFLD                            S01310
     C                     END                                            S01310
     C           M4BTB1    IFNE *BLANK
     C           M4BTB2    ORNE *BLANK
     C           M4BTB3    ORNE *BLANK
     C           M4BTB4    ORNE *BLANK
     C                     SETON                     52                   E21276
     C*********************MOVE ':72:'    M4TG72                          S01310
     C*********************MOVE X0D25     M4CRL1                          S01310
     C                     END
     C***********M4BTB2****IFNE *BLANK                                    S01310
     C***********M4BTB3****ORNE *BLANK                                    S01310
     C***********M4BTB4****ORNE *BLANK                                    S01310
     C*********************MOVE X0D25     M4CRL2                          S01310
     C*********************END                                            S01310
     C***********M4BTB3****IFNE *BLANK                                    S01310
     C***********M4BTB4****ORNE *BLANK                                    S01310
     C*********************MOVE X0D25     M4CRL3                          S01310
     C*********************END                                            S01310
     C***********M4BTB4****IFNE *BLANK                                    S01310
     C*********************MOVE X0D25     M4CRL4                          S01310
     C*********************END                                            S01310
     C*********************                                               S01310
     C***FORMAT*THE*AMOUNT*                                               S01310
     C*********************EXSR SR06                                      S01310
     C*********************MOVEASAM       FAMT                            S01310
     C*********************Z-ADD1         S       30                      S01310
     C***********FAMT,S****DOWEQ' '                                       S01310
     C*********************ADD  1         S                               S01310
     C*********************END                                            S01310
     C*********************MOVEAFAMT,S    M1AMNT                          S01310
     C*********************                                               S01310
     C***OUTPUT*FOUR**RECORDS TO THE OUTGOING SWIFT MESSAGES              S01310
     C***FILE*(PF/MSMSOPF)*AND ONE RECORD TO (PF/MSIXOPF)                 S01310
     C*********************EXSR SR08                                      S01310
      *                                                                   S01310
      ** Output correctly generated message to PF/MGOMSGPD and write      S01310
      ** reference record to PF/MGOREFPD for MT200's.                     S01310
      *                                                                   S01310
     C                     MOVE '200'     MTPY                            138077
     C/COPY WNCPYSRC,FTH00602
     C                     EXSR OMSG                                      S01310
     C                     EXSR WREF2                                     S01310
     C*
     C***FORMAT*MT200*TRN*TO INCLUDE SWIFT SEQUENCE NO. FOR COMPARISON    S01310
     C***WITH*ASSOCIATED*MT210                                            S01310
     C*********************                                               S01310
     C*********************MOVE TFRF      M#TREF 14                       S01310
     C*********************MOVE TRNB      M#TREF 14                       S01310
     C*********************MOVE SWSN      MTWORK 15                       S01310
     C*********************MOVE SWSN      MTWORK 16                       S01310
     C*********************MOVELM#TREF    MTWORK                          S01310
     C*
     C/COPY WNCPYSRC,FTH00603
     C*  OUTPUT AN ENTRY TO THE SWIFT MESSAGE REPORT PRTF/FT0656P1     )))
     C*  INCLUDE NARRATIVE 'RECOVERY' IF ROLLBACK INDICATOR
     C*  HAS BEEN SETON IN SUBROUTINE SR08
     C                     EXSR SRP1
     C*                                                                )))
     C                     MOVE 'Y'       OPPARM           MSG PROD FLAG
     C***INCREMENT*MESSAGES*COUNT*FIELD*IN*DATAAREA*MSFCTL*************   E21286
     C***INCREMENT*MESSAGES*COUNT*FIELD*IN*DATAAREA*FTFCTL          E21286S01310
     C**ONLY*IF*MESSAGE*IS*NOT*A*TELEX*MESSAGE                            S01310
     C**N34                EXSR SR11                                      S01310
     C*                                                                )))
     C*********************END                                            S01310
      *                                                                   S01310
      ** MT210 Processing.                                                S01310
      *                                                                   S01310
      *  Generate MT210 if it is not flagged as not to be generated for   089269
      *  this customer.                                                   089269
     C************IN56     IFEQ '0'                                089269 CSW096
     C************IN57     ANDEQ'0'                                089269 CSW096
     C************IN58     ANDEQ'0'                                089269 CSW096
     C           O@SPRS    IFNE 'Yes'                                     CSW096
     C*                                                                )))
     C*  PROCESS THE 'ACCOUNT WITH' BANK DEPENDING ON WHETHER A SWIFT
     C*  MESSAGE OR A TELEX IS TO BE SENT
     C*
     C           MT210X    IFEQ 'N'
     C*                                                                   S01117
     C* IF MULTIBRANCHING INDICATOR ACTIVE,MOVE BOOKING BRANCH AND        S01117
     C* BRANCH NAME TO THE RELATIVE FIELDS SET UP WITHIN THE PRINTER FILE S01117
     C*                                                                   S01117
     C           *IN60     IFEQ '1'                                       S01117
     C                     MOVE BRCAA     P2BRCA                          S01117
     C                     MOVELBRNM      P2BRNM                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C*  FORMAT DEST BANK FROM DESTINATION FIELDS
     C                     MOVE 'N'       ISPTP
     C                     MOVE *BLANKS   ISPTY1
     C                     MOVELDEST      ISPTY1
     C                     MOVE *BLANKS   ISPTY2
     C                     MOVE *BLANKS   ISPTY3
     C                     MOVE *BLANKS   ISPTY4
     C                     MOVE *BLANKS   ISPTY5
     C                     EXSR SR05
     C*  DESTINATION FIELD PRINT LINE
     C                     MOVELOFSPT1    P2DST1
     C                     MOVELOFSPT2    P2DST2
     C                     MOVELOFSPT3    P2DST3
     C                     MOVELOFSPT4    P2DST4
     C                     MOVELOFSPT5    P2DST5
     C*
     C*   FORMAT ACCOUNT WITH BANK
     C                     MOVE 'N'       ISPTP
     C                     MOVE *BLANKS   ISPTY1
     C                     MOVELACBN      ISPTY1
     C                     MOVE *BLANKS   ISPTY2
     C                     MOVE *BLANKS   ISPTY3
     C                     MOVE *BLANKS   ISPTY4
     C                     MOVE *BLANKS   ISPTY5
     C                     EXSR SR05
     C*  MOVE FORMATTED ACCOUNT WITH BANK FIELDS
     C*  INTO PRINT LINE
     C                     MOVELOFSPT1    P2AWB1
     C                     MOVELOFSPT2    P2AWB2
     C                     MOVELOFSPT3    P2AWB3
     C                     MOVELOFSPT4    P2AWB4
     C                     MOVELOFSPT5    P2AWB5
     C*
     C*
     C*  FORMAT BANK TO BANK INFORMATIONS                              ***
     C                     MOVE BBI1      P2BTB1                       ***
     C                     MOVE BBI2      P2BTB2                       ***
     C                     MOVE BBI3      P2BTB3                       ***
     C                     MOVE BBI4      P2BTB4                       ***
     C*
     C*  DETERMINE AMOUNT
     C                     EXSR SR06
     C                     EXSR SRP3                       PRT TELX REPORT
     C*
     C*********************ELSE                                           S01310
     C                     END                                            S01310
     C*
      *                                                                   S01310
      ** Write out a message to PF/MGOREFPD and PF/MGOMSGPD for MT210.    S01310
      *                                                                   S01310
     C*********************MOVE TFRF      PREFS                           S01310
     C*********************MOVE '1'       MXTREF                          S01310
     C*********************MOVELPREFS     MXTREF                          S01310
     C*********************                                               S01310
     C**MOVE*REMAINING*FIELDS INTO DATA STRUCTURE                         S01310
     C*********************                                               S01310
     C**1.*RIGHTMOST*14*CHARACTERS OF NOSTRO TRANSFER REFERENCE           S01310
     C*********************                                               S01310
     C*********************MOVE TFRF      NT2REF                          S01310
     C*********************                                               S01310
     C**2.*SWIFT*SEQUENCE*NO. OF PREVIOUS MT200                           S01310
     C*********************                                               S01310
     C***********SWSN******IFNE *ZERO                                     S01310
     C*********************MOVE SWSN      NT2SSN                          S01310
     C*********************ELSE                                           S01310
     C*********************MOVE *BLANKS   NT2SSN                          S01310
     C*********************END                                            S01310
     C*********************                                               S01310
     C**3.*COMBINATION*OF*1 AND CURRENT SWSN                              S01310
     C*********************                                               S01310
     C*********************ADD  1         SWSN                            S01310
     C*********************MOVE SWSN      NTWORK 15                       S01310
     C*********************MOVELNT2REF    NTWORK                          S01310
     C*********************MOVE NTWORK    NT1RS1                          S01310
     C*********************MOVELNTWORK    NTXRS                           S01310
     C*
     C**4.*SWIFT*ADDRESS*OF*ACCOUNT*WITH*BANK**************************                      260987A
     C**********                                                                             260987A
     C**********           MOVE ACSWID    NT1SWA                                             260987A
      *                                                                                      260987A
      ** 4. NETWORK ADDRESS OF ACCOUNT WITH BANK.                                            260987A
      *                                                                                      260987A
     C                     MOVELSNWDS2    NT1SWA                                             260987A
      *                                                                   S01310
      ** Field :20: - Transaction Reference Number.   (MT210).            S01310
      **              TRN now consists of same TRN as the MT200 except    S01310
      **              that the payment type is NR (nostro receive).       S01310
      **              (MT200 payment type is NP (nostro payment).         S01310
      *                                                                   S01310
     C                     Z-ADD1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     MOVEL':20:'    MTAG                            S01310
     C                     MOVE 'NR'      PAYTP                           S01310
     C                     MOVELREFNO     MFLD                            S01310
      *                                                                   S01310
      ** Store the TRN for output in WREF2 for MT210's.                   S01310
      *                                                                   S01310
     C                     MOVELMFLD      TRNA   16                       S01310
     C                     MOVELMFLD      TRNO                            S01310
     C/COPY WNCPYSRC,FT0656C006
      *                                                                   S01310
      ** Field :30: - Value Date.             (MT210).                    S01310
      *                                                                   S01310
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     MOVEL':30:'    MTAG                            S01310
     C                     MOVELVDATD3    MFLD                            S01310
      *                                                                   S01310
      ** Field :21: - Related Reference.      (MT210).                    S01310
      **              Consists of the TRN of the MT200.                   S01310
      *                                                                   S01310
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     MOVEL':21:'    MTAG                            S01310
     C                     MOVELTRNB      MFLD                            S01310
     C*
     C*  5. OTHERS (INCLUDING FIELD END CONSTANTS)
     C*
     C*  FORMAT THE AMOUNT
     C                     EXSR SR06
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0656CCP3                                           S01408
     C*                                                                   S01408
     C                     MOVEASAM       FAMT
     C                     Z-ADD1         S       30
     C           FAMT,S    DOWEQ' '
     C                     ADD  1         S
     C                     END
     C                     MOVEAFAMT,S    M1AMNT
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0656CCP4                                           S01408
     C*                                                                   S01408
      *                                                                   S01310
      ** Field :32B: - Currency Code , Amount.                            S01310
      *                                                                   S01310
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     MOVEL':32B:'   MTAG                            S01310
     C                     MOVE M1RCCY    CCY32B                          S01310
     C                     MOVE *BLANKS   AMT32B                          084587
     C                     MOVELM1AMNT    AMT32B                          S01310
     C                     MOVELFLD32B    MFLD                            S01310
      *                                                                   S01310
      ** Field :52 : - Ordering Customer.                                 S01310
      *                                                                   S01310
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     MOVELNT2AD1    OFSPT1                          S01310
     C                     MOVE NT3AD2    OFSPT2                          S01310
     C                     MOVE NT3AD3    OFSPT3                          S01310
     C                     MOVE NT3AD4    OFSPT4                          S01310
     C           NT2AD1    IFNE *BLANKS                                   S01310
      ** If SWIFT 2001 enhancement is installed, check if NT2AD1 is                           CSW201
      ** existing in BIC directory                                                            CSW201
     C           CSW201    IFEQ 'Y'                                                           CSW201
     C                     MOVEL'N'       WCHGIN  1                                           CSW201
     C                     MOVELNT2AD1    W9BICC                                              CSW201
     C           3         SUBSTNT2AD1:9  W9BICB                                              CSW201
     C                     CALL 'ME1400'                                                      CSW201
     C                     PARM *BLANKS   W9RTN   7                                           CSW201
     C                     PARM           W9BICC  8                                           CSW201
     C                     PARM           W9BICB  3                                           CSW201
     C                     PARM           SDCUST                                              CSW201
     C                     PARM           SDCNST                                              CSW201
     C                     PARM           MEBICD                                              CSW201
     C                     PARM *BLANKS   W9CUST  1                                           CSW201
     C                     PARM *BLANKS   W9CNST  1                                           CSW201
     C                     PARM *BLANKS   W9BICD  1                                           CSW201
      ** If it is existing, and subtype is 'BEID' or 'TRCO',                                  CSW201
      ** BEIs aren't allowed anymore.                                                         CSW201
     C           W9RTN     IFEQ *BLANKS                                                       CSW201
     C           W9BICD    ANDEQ'Y'                                                           CSW201
      *                                                                                       CSW202
      ** If SWIFT 2002 Standards Update is switched on, check if                              CSW202
      ** subtype is included in BEI subtypes file MEBEISPD. If yes,                           CSW202
      ** format with option D.                                                                CSW202
      *                                                                                       CSW202
     C           CSW202    IFEQ 'Y'                                                           CSW202
      *                                                                                       CSW202
     C                     CALL 'AOBEISR0'                                                    CSW202
     C                     PARM *BLANKS   PRTCD                                               CSW202
     C                     PARM '*VERIFY' POPTN   7                                           CSW202
     C                     PARM BDSUBT    PBICD   4                                           CSW202
     C           MEBEIS    PARM MEBEIS    DSFDY                                               CSW202
      *                                                                                       CSW202
     C                     ENDIF                                                              CSW202
      *                                                                                       CSW202
     C           BDSUBT    IFEQ 'BEID'                                                        CSW201
     C           CSW202    ANDEQ'N'                                                           CSW202
     C           BDSUBT    OREQ 'TRCO'                                                        CSW201
     C           CSW202    ANDEQ'N'                                                           CSW202
     C           CSW202    OREQ 'Y'                                                           CSW202
     C           PRTCD     ANDEQ*BLANKS                                                       CSW202
     C                     MOVE 'Y'       WCHGIN                                              CSW201
     C                     MOVE 'D'       OSTAG                                               CSW201
     C                     SELEC                                                              CSW201
     C           W9CUST    WHEQ 'Y'                                                           CSW201
     C                     MOVELBBCNA1    OFSPT1                                              CSW201
     C                     MOVELBBCNA2    OFSPT2                                              CSW201
     C                     MOVELBBCNA3    OFSPT3                                              CSW201
     C                     MOVELBBCNA4    OFSPT4                                              CSW201
     C           W9CNST    WHEQ 'Y'                                                           CSW201
     C                     MOVELAWCPNM    OFSPT1                                              CSW201
     C                     MOVELAWCNTN    OFSPT2                                              CSW201
     C                     OTHER                                                              CSW201
     C                     MOVELNT2AD1    OFSPT1                                              CSW201
     C                     ENDSL                                                              CSW201
     C                     ENDIF                                                              CSW201
     C                     ENDIF                                                              CSW201
     C                     ENDIF                                                              CSW201
     C                     MOVEL'52'      FLDNO                           S01310
     C           WCHGIN    IFEQ 'N'                                                           CSW201
     C           CSW201    OREQ 'N'                                                           CSW201
     C                     MOVE NT2FLG    OSTAG                           S01310
     C                     ENDIF                                                              CSW201
     C                     EXSR FSWAD                                     S01310
     C                     END                                            S01310
      *                                                                   S01310
      ** Field :56 : - Intermediary Customer.                             S01310
      *                                                                   S01310
     C** Only output Field 56 to MT200 if Intermediary bank details       089643
     C** are entered.                                                     089643
     C*                                                                   089643
     C           NTINBT    IFNE *BLANKS                                   089643
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     MOVELNT3BA1    OFSPT1                          S01310
     C                     MOVE NT3BA2    OFSPT2                          S01310
     C                     MOVE NT4BA3    OFSPT3                          S01310
     C                     MOVE NT4BA4    OFSPT4                          S01310
     C                     MOVE *BLANKS   OFSPT5                          S01310
     C           NT3BA1    IFNE *BLANKS                                   S01310
     C                     MOVEL'56'      FLDNO                           S01310
     C                     MOVE NT3IND    OSTAG                           S01310
     C                     EXSR FSWAD                                     S01310
     C                     END                                            S01310
     C                     END                                            089643
     C*
     C                     MOVE M1HEAD    NT1M1H
     C*********************MOVE MTD210    STID                            S01310
     C                     MOVE VDATD3    NT1VDT
     C                     MOVE PTDL      NTXPDT
     C                     MOVE M1RCCY    NT2CCY
     C                     MOVE M1AMNT    NT2AMT
     C*********************MOVE X0D25     NT1EF1                          S01310
     C*********************MOVE X0D25     NT1EF2                          S01310
     C*********************MOVE X0D25     NT1EF3                          S01310
     C*********************MOVE X0D25     NT1EF4                          S01310
     C*********************MOVE X0D25     NT1EF5                          S01310
     C*********************MOVE X0D25     NT1EF6                          S01310
     C*********************MOVE X0D25     NT2EF1                          S01310
     C*********************MOVE X0D25     NT2EF2                          S01310
     C*********************MOVE X0D25     NT2EF3                          S01310
     C*********************MOVE X0D25     NT3EF1                          S01310
     C*********************MOVE X0D25     NT3EF2                          S01310
     C*********************MOVE X0D25     NT3EF3                          S01310
     C*********************MOVE X0D25     NT3EF4                          S01310
     C*********************MOVE X0D25     NT3EF5                          S01310
     C*********************MOVE X0D25     NT4EF1                          S01310
     C*********************MOVE X0D25     NT4EF2                          S01310
     C                     MOVE ' '       NT1WK1
     C                     MOVE '00001'   NT1WK2
     C*********************MOVE SWPC      NT1WK3                          S01117
     C           SWPC      IFEQ 1                                         S01117
     C                     MOVE 'U'       NT1WK3                          S01117
     C                     ELSE                                           S01117
     C           SWPC      IFEQ 2                                         S01117
     C                     MOVE 'N'       NT1WK3                          S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C                     MOVEL'210'     NT1WK3
     C*********************MOVE ':20:'    NT1WK4                          S01310
     C*********************MOVE ':30:'    NT1WK5                          S01310
     C*********************MOVE 'P'       NT1WK6                          S01310
     C*********************MOVE ':21:'    NT2WK1                          S01310
     C*********************MOVE 'P'       NT2WK2                          S01310
     C*********************MOVE ':32B:'   NT2WK3                          S01310
     C*********************MOVE ':52'     NT2WK4                          S01310
     C*********************MOVE ':'       NT2WK5                          S01310
     C*********************MOVE ':56'     NT3WK1                          S01310
     C*********************MOVE ':'       NT3WK2                          S01310
     C*********************MOVE '-'       NT4WK1                          S01310
     C*********************MOVE X03       NT4ETX                          S01310
     C*********************                                               S01310
     C**CALL*SR07*TO*OUTPUT MT210 TO MSMSOPF AND MSIXOPF FILES            S01310
     C*********************                                               S01310
     C*********************EXSR SR07                                      S01310
     C*
      *                                                                   S01310
      ** Output correctly generated message to PF/MGOMSGPD and write      S01310
      ** reference record to PF/MGOREFPD for MT210's.                     S01310
      *                                                                   S01310
     C                     MOVE '210'     MTPY                            138077
     C                     EXSR OMSG                                      S01310
     C                     EXSR WREF1                                     S01310
     C* CALL SRP4 PRODUCE MT210 REPORT
     C*
     C                     EXSR SRP4
     C*
     C                     MOVE 'Y'       OPPARM           MSG PROD FLAG
     C***INCREMENT*MESSAGES*COUNT*FIELD*IN*DATAAREA*MSFCTL*************   E21286
     C***INCREMENT*MESSAGES*COUNT*FIELD*IN*DATAAREA*FTFCTL          E21286S01310
     C**ONLY*IF*MESSAGE*IS*NOT*A*TELEX*MESSAGE                            S01310
     C**N35                EXSR SR11                                      S01310
     C*
     C*********************END                                            S01310
     C                     END                                            089269
     C*
     C*                                                                )))
     C/EJECT
     C*
     C**********************************
     C*    LAST RECORD PROCESSING.     *
     C**********************************
     C*
     C**  OUTPUT A RUN CONTROL REPORT
     CLRN40                EXSR FIRST
     C*LR*******************ADD  1         PAGEP3                         S01117
     CLR                   ADD  1         PAGEAU                          S01117
     C*LR*******************WRITEP3H1                   80                S01117
     CLR                   WRITEHEADAU                 80                 S01117
     CLR 80                DO                              B001
     C*                                                    ))))))))))))))
     C*R*******************MOVE 'FT0656P3'DBFNAM           )))  DATA  ))) S01117
     CLR                   MOVEL'FT0656AU'DBFNAM           )))        ))) S01117
     CLR                   MOVEL'3'       DBERKY           )))  BASE  )))
     C*LR*******************MOVE 18        DBERR#           ))) ERROR  )))S01117
     CLR                   MOVE '18'      DBERR#           )))        ))) S01117
     CLR                   EXSR DBERR                      )))   18    )))
     C*                                                    ))))))))))))))
     CLR                   END                             E001
     CLR                   RETRN
     C*
     C/EJECT
     C*****************************************************************   S01310
     C*   FSWAD - Format SWIFT address                                *   S01310
     C*   Called by - main process.                                   *   S01310
     C*   Calls     -                                                 *   S01310
     C*****************************************************************   S01310
     C*                                                                   S01310
     C           FSWAD     BEGSR                                          S01310
     C*                                                                   S01310
     C**  Address 1                                                       S01310
     C                     MOVELOFSPT1    MFLD                            S01310
     C*                                                                   S01310
     C**  SWIFT address;  Else full address                               S01310
     C           OSTAG     IFEQ 'A'                                       S01310
     C                     MOVE 'A'       TAG                             S01310
     C                     MOVE @MTAG     MTAG                            S01310
     C/COPY WNCPYSRC,FT0656C007
     C**  Address 2                                                       S01494
     C                     MOVE *BLANKS   SAVMTG  5                       138077
     C           OFSPT2    IFNE *BLANKS                                   S01494
     C                     MOVE MTAG      SAVMTG                          138077
     C                     ADD  1         Q                               S01494
     C           Q         OCUR MULT                                      S01494
     C                     MOVELOFSPT2    MFLD                            S01494
     C                     END                                            S01494
     C                     EXSR SEXTN                                     138077
     C                     END                                            S01310
     C*                                                                   S01310
     C           OSTAG     IFEQ 'B'                                       S01310
     C                     MOVE 'B'       TAG                             S01310
     C                     MOVE @MTAG     MTAG                            S01310
     C                     END                                            S01310
     C*                                                                   S01310
     C           OSTAG     IFEQ 'D'                                       S01310
     C                     MOVE 'D'       TAG                             S01310
     C                     MOVE @MTAG     MTAG                            S01310
     C**  Address 2                                                       S01310
     C           OFSPT2    IFNE *BLANKS                                   S01310
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     MOVELOFSPT2    MFLD                            S01310
     C**  Address 3                                                       S01310
     C           OFSPT3    IFNE *BLANKS                                   S01310
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     MOVELOFSPT3    MFLD                            S01310
     C**  Address 4                                                       S01310
     C           OFSPT4    IFNE *BLANKS                                   S01310
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     MOVELOFSPT4    MFLD                            S01310
     C**  Address 5                                                       S01310
     C           OFSPT5    IFNE *BLANKS                                   S01310
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     MOVELOFSPT5    MFLD                            S01310
     C                     END                             Address 5      S01310
     C                     END                             Address 4      S01310
     C                     END                             Address 3      S01310
     C                     END                             Address 2      S01310
     C                     END                             Address 1      S01310
     C*                                                                   S01310
     C                     ENDSR                                          S01310
     C/EJECT                                                              S01310
     C****************************************************************    S01310
     C*   CUST - Moves new field names to old to retain pgm continuity*   S01310
     C*   Called by - main process.                                   *   S01310
     C*   Calls     -                                                 *   S01310
     C*****************************************************************   S01310
      *                                                                   S01310
     C           CUST      BEGSR                                          S01310
     C                     MOVELBBCSID    CSID                            S01310
     C                     MOVELBBCNA1    CNA1   35                       S01310
     C                     MOVELBBCNA2    CNA2   35                       S01310
     C                     MOVELBBCNA3    CNA3   35                       S01310
     C                     MOVELBBCNA4    CNA4   35                       S01310
     C                     ENDSR                                          S01310
     C/EJECT                                                              S01310
     C****************************************************************
     C* FIRST SR.
     C* FIRST CYCLE
     C*
     C           FIRST     BEGSR
     C*
     C           *NAMVAR   DEFN           RUNDAT                          S01117
     C                     IN   RUNDAT                                    S01117
     C*                                                                   S01117
     C* IF MULTIBRANCH INDICATOR IS ACTIVE FROM RUNDAT                    S01117
     C*                                                                   S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C                     MOVE '1'       *IN60                           S01117
     C                     END                                            S01117
     C* MOVE REPORT NAME AND SPOOL FILE NBR TO ZSFILE AND CALL ZSFILE     S01117
     C                     Z-ADDSFNUM1    SPLNO                           S01117
     C                     MOVELSFILE1    SFILP                           S01117
     C                     EXSR SUBZSF                                    S01117
     C*                                                                   S01117
     C* IF ERROR PERFORM DATABASE ERROR HANDLING AND EXIT PROGRAM         S01117
     C*                                                                   S01117
     C           ZERR      IFEQ 'Y'                                       S01117
     C           *LOCK     IN   DLDA                                      S01117
     C                     MOVEL'FT0656'  DBPGM            ***************S01117
     C                     MOVEL'FT0656P1'DBKEY            ** DBERR  28 **S01117
     C                     MOVEL'ZSFILE'  DBFILE           ***************S01117
     C                     Z-ADD28        DBASE                           S01117
     C                     OUT  DLDA                                      S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C* MOVE REPORT NAME AND SPOOL FILE NBR TO ZSFILE AND CALL ZSFILE     S01117
     C                     Z-ADDSFNUM2    SPLNO                           S01117
     C                     MOVELSFILE2    SFILP                           S01117
     C                     EXSR SUBZSF                                    S01117
     C*                                                                   S01117
     C* IF ERROR PERFORM DATABASE ERROR HANDLING AND EXIT PROGRAM         S01117
     C*                                                                   S01117
     C           ZERR      IFEQ 'Y'                                       S01117
     C           *LOCK     IN   DLDA                                      S01117
     C                     MOVEL'FT0656'  DBPGM            ***************S01117
     C                     MOVEL'FT0656P2'DBKEY            ** DBERR  29 **S01117
     C                     MOVEL'ZSFILE'  DBFILE           ***************S01117
     C                     Z-ADD29        DBASE                           S01117
     C                     OUT  DLDA                                      S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C* MOVE REPORT NAME AND SPOOL FILE NBR TO ZSFILE AND CALL ZSFILE     S01117
     C                     Z-ADDSFNUM4    SPLNO                           S01117
     C                     MOVELSFILE4    SFILP                           S01117
     C                     EXSR SUBZSF                                    S01117
     C*                                                                   S01117
     C* IF ERROR PERFORM DATABASE ERROR HANDLING AND EXIT PROGRAM         S01117
     C*                                                                   S01117
     C           ZERR      IFEQ 'Y'                                       S01117
     C           *LOCK     IN   DLDA                                      S01117
     C                     MOVEL'FT0656'  DBPGM            ***************S01117
     C                     MOVEL'FT0656P4'DBKEY            ** DBERR  30 **S01117
     C                     MOVEL'ZSFILE'  DBFILE           ***************S01117
     C                     Z-ADD30        DBASE                           S01117
     C                     SETON                     U7U8LR               S01117
     C*********************OUT  LDA                                       S01117
     C                     OUT  DLDA                                      S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C* MOVE REPORT NAME AND SPOOL FILE NBR TO ZSFILE AND CALL ZSFILE     S01117
     C                     Z-ADDSFNUM5    SPLNO                           S01117
     C                     MOVELSFILE5    SFILP                           S01117
     C                     EXSR SUBZSF                                    S01117
     C*                                                                   S01117
     C* IF ERROR PERFORM DATABASE ERROR HANDLING AND EXIT PROGRAM         S01117
     C*                                                                   S01117
     C           ZERR      IFEQ 'Y'                                       S01117
     C           *LOCK     IN   DLDA                                      S01117
     C                     MOVEL'FT0656'  DBPGM            ***************S01117
     C                     MOVEL'FT0656P5'DBKEY            ** DBERR  31 **S01117
     C                     MOVEL'ZSFILE'  DBFILE           ***************S01117
     C                     Z-ADD31        DBASE                           S01117
     C                     SETON                     U7U8LR               S01117
     C*********************OUT  LDA                                       S01117
     C                     OUT  DLDA                                      S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C* MOVE AUDIT REPORT NAME AND SPOOL FILE NBR TO ZSFILE AND           S01117
     C* CALL ZSFILE                                                       S01117
     C                     Z-ADDSFNUMU    SPLNO                           S01117
     C                     MOVELSFILEU    SFILP                           S01117
     C                     EXSR SUBZSF                                    S01117
     C*                                                                   S01117
     C* IF ERROR PERFORM DATABASE ERROR HANDLING AND EXIT PROGRAM         S01117
     C*                                                                   S01117
     C           ZERR      IFEQ 'Y'                                       S01117
     C           *LOCK     IN   DLDA                                      S01117
     C                     MOVEL'FT0656'  DBPGM            ***************S01117
     C                     MOVEL'FT0656AU'DBKEY            ** DBERR  32 **S01117
     C                     MOVEL'ZSFILE'  DBFILE           ***************S01117
     C                     Z-ADD32        DBASE                           S01117
     C                     SETON                     U7U8LR               S01117
     C*********************OUT  LDA                                       S01117
     C                     OUT  DLDA                                      S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*    INITIALISE RECORD COUNTERS                                  ***
     C*********************Z-ADD0         P3NO1                           S01117
     C                     Z-ADD0         AUNO1                           S01117
     C*********************Z-ADD0         P3NO2                           S01117
     C*********************Z-ADD0         AUNO2                     S01117S01310
     C*********************Z-ADD0         P3NO3                           S01117
     C*********************Z-ADD0         AUNO3                     S01117S01310
     C*********************Z-ADD0         P3NO5                           S01117
     C*********************Z-ADD0         AUNO5                     S01117S01310
     C                     Z-ADD0         PAGEP1
     C                     Z-ADD0         PAGEP2
     C*********************Z-ADD0         PAGEP3                          S01117
     C                     Z-ADD0         PAGEAU                          S01117
     C                     Z-ADD0         PAGEP4
     C                     Z-ADD0         PAGEP5
     C                     Z-ADD0         SWSN
     C                     TIME           TIME    60
     C           *LIKE     DEFN ADPBRC    ISBRCA                          S01494
     C*                                                     **************
     C**   SET UP KEY AND ACCESS INSTALLATION CONTROL RECORD (TABTB10F)
     C                     MOVEL'01      'ZTABKY 12
     C                     MOVE '  10'    ZTABKY
     C**
     C           ZTABKY    CHAINTABFP                99    ON NOT THERE
     C  N99      RECI      COMP 'D'                  9999  ON, IS DELETED
     C*
     C           *IN99     IFEQ '1'                         ))))))))))))))
     C*********************MOVE 'TABFP'   DBFNAM  5         )))  DATA  )))S01310
     C                     MOVEL'TABFP'   DBFNAM  8         )))  DATA  )))S01310
     C                     MOVELZTABKY    DBERKY 39         )))  BASE  )))
     C                     MOVE '01'      DBERR#  2         ))) ERROR  )))
     C                     EXSR DBERR                       )))   01   )))
     C                     END                              ))))))))))))))
     C*
     C**   INSTALLATION CONTROL RECORD FOUND SO SAVE FIELDS
     C                     MOVE RUNA      SRUNA   7        SAVE ALPHA DATE
     C                     MOVE TITL      STITL  53        SAVE TITLE
     C*
     C**   SET UP KEY AND ACCESS INSTALLATION CONTROL RECORD (TABTB11F)
     C*
     C                     MOVE *BLANKS   ZTABKY
     C                     MOVEL'01'      ZTABKY
     C                     MOVE '11'      ZTABKY
     C           ZTABKY    CHAINTABFP                10
     C  N10      RECI      COMP 'D'                  1010
     C*
     C           *IN10     IFEQ '1'                         ))))))))))))))
     C*********************MOVE 'TABFP'   DBFNAM            )))  DATA  )))S01310
     C                     MOVEL'TABFP'   DBFNAM            )))  DATA  )))S01310
     C                     MOVELZTABKY    DBERKY            )))  BASE  )))
     C                     MOVE '02'      DBERR#            ))) ERROR  )))
     C                     EXSR DBERR                       )))   02   )))
     C                     END                              ))))))))))))))
     C*
     C**   INST. CONTROL RECORD FOUND SO SAVE CUST. NO. OF HEAD OFFICE
     C**********           Z-ADDHEAD      SHEAD   60       SAVE CUST NO OF                    CSD027
     C                     MOVE HEAD      SHEAD   6        SAVE CUST NO OF                    CSD027
     C*********************Z-ADDFTDB      SDFBR            SAVE BRANCH NUMS01117
     C*
     C****SET*UP*KEY*AND*ACCESS*INST.*CONTROL*REC*BRANCH*CODE*(TABLETR)*  S01117
     C*********************                                               S01117
     C*********************MOVEL'10    '  ZTABKY                          S01117
     C*********************MOVE SDFBR     ZTABKY                          S01117
     C***********ZTABKY****CHAINTABFP                10                   S01117
     C**N10******RECI******COMP 'D'                  1010  ON , DELETED   S01117
     C*********************                                               S01117
     C************IN10*****IFEQ '1'                         ))))))))))))))S01117
     C*********************MOVE 'TABFP'   DBFNAM            )))  DATA  )))S01117
     C*********************MOVELZTABKY    DBERKY            )))  BASE  )))S01117
     C*********************MOVE '03'      DBERR#            ))) ERROR  )))S01117
     C*********************EXSR DBERR                       )))   03   )))S01117
     C*********************END                              ))))))))))))))S01117
     C***SAVE*BRANCH*INTERNAL*CUSTOMER*NO.*                               S01117
     C*********************MOVE BICN      SBICN   60                      S01117
     C***SET*UP*KEY*TO*ACCESS*CLIENT*FILE*(FOR*CLINTCB).*                 S01117
     C*********************MOVE BICN      KCUSNO  60                      S01117
     C*********************MOVE 'A'       KEYA    1                       S01117
     C*********************                                               S01117
     C***ACCESS*CLIENT*FILE*                                              S01117
     C***********CUSKEY****CHAINCLINTCBF             80                   S01117
     C*********************                                               S01117
     C************IN80*****IFEQ '1'                         ))))))))))))))S01117
     C*********************MOVE 'TABFP'   DBFNAM            )))  DATA  )))S01117
     C*********************MOVEL'      A' DBERKY            )))  BASE  )))S01117
     C*********************MOVELKCUSNO    DBERKY            )))  BASE  )))S01117
     C*********************MOVE '04'      DBERR#            ))) ERROR  )))S01111
     C*********************EXSR DBERR                       )))   04   )))S01117
     C*********************END                              ))))))))))))))S01117
     C*********************                                               S01117
     C**************************************
     C*****REMOVE*TERMINAL*ID*             *                              S01117
     C**************************************
     C*********************                                               S01117
     C***MOVE*SWIFT*ADDRESS*IN*DATA*STRUCTURE*                            S01117
     C*********************MOVE CSID      SCSID                           S01117
     C***SAVE***'OUR*TID'*FIELD*IN*WORK*AREA*                             S01117
     C*********************MOVE SCSID     MXOSFT 12                       S01117
     C*********************MOVE TELX      MXOTLX 12                       S01117
     C*********************                                         E22406S01310
     C**ACCESS*TO*SDBRCHL5*                                         E22406S01310
     C*********************MOVE BICN      WWBICN  6                 E22406S01310
     C***********WWBICN****CHAINSDBRCHL5             09             E22406S01310
     C**N09******A8TYLC****COMP 'D'                      09         E22406S01310
     C*********************                                         E22406S01310
     C************IN09*****IFEQ '1'                         ))))))))E22406S01310
     C*********************MOVE 'SDBR5'   DBFNAM            )))  D))E22406S01310
     C*********************MOVELA8BICN    DBERKY            )))  B))E22406S01310
     C*********************MOVE '28'      DBERR#            ))) ER))E22406S01310
     C*********************EXSR DBERR                       )))   2)E22406S01310
     C*********************END                              ))))))))E22406S01310
     C*********************                                         E22406S01310
     C*********************MOVE A8BTID    SCSID                     E22406S01310
     C*********************MOVE SCSID     MXOSFT 12                 E22406S01310
      *                                                                   S01310
      **  Access SDMMODPD for networks available.                         S01310
      *                                                                   S01310
     C                     CALL 'AOMMODR0'                                S01310
     C                     PARM '*MSG   ' @RTCD                           S01310
     C                     PARM '*FIRST ' @OPTN                           S01310
     C           SDMMOD    PARM SDMMOD    DSFDY                           S01310
      *                                                                   S01310
      ** If no record is found on sdmmodpd.                               S01310
      *                                                                   S01310
     C           @RTCD     IFNE *BLANKS                                   S01310
     C                     MOVE '03'      DBERR#             * * * * * * *S01310
     C                     MOVEL'FIRST'   DBERKY             * DBERR 003 *S01310
     C                     MOVEL'SDMMODPD'DBFNAM             * * * * * * *S01310
     C                     EXSR DBERR                                     S01310
     C                     END                                            S01310
      *                                                                   S01310
      **  Access SDMGMEPD for drop SWIFT msg. no. days                    S01310
      *                                                                   S01310
     C                     CALL 'AOMGMER0'                                S01310
     C                     PARM '*MSG   ' @RTCD   7                       S01310
     C                     PARM '*FIRST ' @OPTN   7                       S01310
     C           SDMGME    PARM SDMGME    DSFDY                           S01310
      *                                                                   S01310
      ** If no record is found on SDMGMEPD.                               S01310
      *                                                                   S01310
     C           @RTCD     IFNE *BLANKS                                   S01310
     C                     MOVE '25'      DBERR#             * * * * * * *S01310
     C                     MOVEL'FIRST'   DBERKY             * DBERR 025 *S01310
     C                     MOVEL'SDMGMEPD'DBFNAM             * * * * * * *S01310
     C                     EXSR DBERR                                     S01310
     C                     END                                            S01310
      *                                                                   S01310
      **  Convert history retention date to YYMMDD                        S01310
      *                                                                   S01310
     C           RUND      ADD  ENDSMN    ZMDAY                           S01310
     C                     CALL 'ZM0060'               14                 S01310
     C                     PARM           ZMDAY                           S01310
     C                     PARM           ZMDATE                          S01310
      *                                                                   S01310
      ** If the program ends in error.                                    S01310
      *                                                                   S01310
     C           *IN14     IFEQ '1'                                       S01310
     C                     MOVE '26'      DBERR#             * * * * * * *S01310
     C                     MOVEL'       ' DBERKY             * DBERR 026 *S01310
     C                     MOVEL'ZM0060'  DBFNAM             * * * * * * *S01310
     C                     EXSR DBERR                                     S01310
     C                     END                                            S01310
     C                     MOVE ZMDATE    @HRDT   6                       S01310
      *                                                                   S01310
      **  Initialise constant fields                                      S01310
      *                                                                   S01310
     C                     MOVE *LOVAL    CR      1                       S01310
     C                     BITON'457'     CR                              S01310
     C                     MOVE *LOVAL    LF      1                       S01310
     C                     BITON'257'     LF                              S01310
     C                     MOVELCR        CRLF    2                       S01310
     C                     MOVE LF        CRLF                            S01310
     C                     MOVE ':'       COLON1                          S01310
     C                     MOVE ':'       COLON2                          S01310
      *                                                                   S01310
      **  CRLF Control Character for message data records                 S01310
      *                                                                   S01310
     C                     MOVE CRLF      CTRC                            S01310
     C*  CHECK TYPE OF RUN
     C           IPPARM    IFEQ 'I'
     C                     SETON                     13
     C                     END
     C*  SET MESSAGE PRODUCTION PARAMETER
     C                     MOVE 'N'       OPPARM  1
     C***SET*UP*HEXADECIMAL VALUE OF X'0D25'                              S01310
     C*********************Z-ADD13        B0D                             S01310
     C*********************Z-ADD37        B25                             S01310
     C*********************MOVELX0D       X0D25                           S01310
     C*********************MOVE X25       X0D25                           S01310
     C*                                                                   CSW020
      * Access SAR details to determine if SWIFT Decimal Places is        CSW020
      * switched on (CSW020)                                              CSW020
     C                     CALL 'AOSARDR0'                                CSW020
     C                     PARM *BLANKS   @RTCD                           CSW020
     C                     PARM '*VERIFY' @OPTN                           CSW020
     C                     PARM 'CSW020'  @SARD   6                       CSW020
     C           SCSARD    PARM SCSARD    DSFDY                           CSW020
     C*                                                                   CSW020
     C** If core feature is switched ON, set a variable field to          CSW020
     C** condition the rest of the processing                             CSW020
     C*                                                                   CSW020
     C           @RTCD     IFEQ *BLANKS                                   CSW020
     C                     MOVE 'Y'       CSW020  1                       CSW020
     C                     ELSE                                           CSW020
     C*                                                                   CSW020
     C** else, database error (return code other than *NRF)               CSW020
     C*                                                                   CSW020
     C           @RTCD     IFNE '*NRF   '                                 CSW020
     C                     MOVEL'SCSARDPD'DBFNAM           ************   CSW020
     C                     MOVEL'*VERIFY' DBERKY           * DBERR 32 *   CSW020
     C                     MOVE '32'      DBERR#           ************   CSW020
     C                     EXSR DBERR                                     CSW020
     C                     END                                            CSW020
     C                     END                                            CSW020
      ** Check if SWIFT 2001 enhancement is installed                                         CSW201
     C                     CALL 'SWIF2001'                                                    CSW201
     C                     PARM *BLANKS   @RTCD                                               CSW201
     C           @RTCD     IFEQ 'CSW2001'                                                     CSW201
     C                     MOVEL'Y'       CSW201  1                                           CSW201
     C                     ELSE                                                               CSW201
     C                     MOVEL'N'       CSW201                                              CSW201
     C                     ENDIF                                                              CSW201
      *                                                                   CSW020
      ** Check if switchable feature CSW202 is switched on.                                   CSW202
      *                                                                                       CSW202
     C                     CALL 'SWIF2002'                                                    CSW202
     C                     PARM *BLANKS   PRTCD   7                                           CSW202
      *                                                                                       CSW202
     C           PRTCD     IFEQ 'CSW2002'                                                     CSW202
     C                     MOVE 'Y'       CSW202  1                                           CSW202
     C                     ELSE                                                               CSW202
     C                     MOVE 'N'       CSW202                                              CSW202
     C                     ENDIF                                                              CSW202
      *                                                                                       CSW202
      ** Check if Midas Compliance Watch (CSD015) is installed                                CSD015
      *                                                                                       CSD015
     C                     MOVE 'N'       CSD015  1                                           CSD015
     C                     MOVEL'N'       W1EWLC                                              222385
     C                     CALL 'AOSARDR0'                                                    CSD015
     C                     PARM *BLANKS   @RTCD                                               CSD015
     C                     PARM '*VERIFY' @OPTN                                               CSD015
     C                     PARM 'CSD015'  @SARD                                               CSD015
     C           SCSARD    PARM SCSARD    DSFDY                                               CSD015
      *                                                                                       CSD015
      ** Database Error (return code other than *NRF)                                         CSD015
      *                                                                                       CSD015
     C           @RTCD     IFNE *BLANKS                                                       CSD015
     C           @RTCD     ANDNE'*NRF   '                                                     CSD015
     C                     MOVEL'SCSARDPD'DBFNAM                                              CSD015
     C                     MOVEL'CSD015'  DBERKY                                              CSD015
     C                     MOVEL'35'      DBERR#                                              CSD015
     C                     EXSR DBERR                                                         CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       222385
     C           @RTCD     IFEQ *BLANK                                                        222385
     C                     MOVEL'Y'       CSD015                                              222385
      *                                                                                       222385
      ** Access AOWLCCR0 to check if function code MESSGENT is available                      222385
      *                                                                                       222385
     C                     CALL 'AOWLCCR0'                                                    222385
     C                     PARM *BLANKS   PRTCD                                               222385
     C                     PARM '*KEY'    POPTN                                               222385
     C                     PARM 'MESSGENT'PFUNC   8                                           222385
     C           SDWLCC    PARM SDWLCC    DSFDY                                               222385
      *                                                                                       222385
     C           PRTCD     IFNE *BLANKS                                                       222385
     C           PRTCD     ANDNE'*NRF'                                                        222385
     C                     MOVEL'SDWLCCPD'DBFNAM                                              222385
     C                     MOVELPFUNC     DBERKY                                              222385
     C                     MOVEL'32'      DBERR#                                              222385
     C                     EXSR DBERR                                                         222385
     C                     ENDIF                                                              222385
      *                                                                                       222385
     C                     ENDIF                                                              222385
      *                                                                                       CSD015
      ** Check if switchable feature CSW025 is switched on.                                   CSD015
      *                                                                                       CSD015
     C                     MOVEL'N'       CSW025                                              CSD015
     C                     CALL 'AOSARDR0'                                                    CSD015
     C                     PARM *BLANKS   @RTCD                                               CSD015
     C                     PARM '*VERIFY' @OPTN                                               CSD015
     C                     PARM 'CSW025'  @SARD                                               CSD015
     C           SCSARD    PARM SCSARD    DSFDY                                               CSD015
      *                                                                                       CSD015
      ** An NRF (No Record Found) return code is valid.                                       CSD015
      ** Issue database error only for error return codes.                                    CSD015
      *                                                                                       CSD015
     C           @RTCD     IFNE *BLANKS                                                       CSD015
     C           @RTCD     ANDNE'*NRF   '                                                     CSD015
     C                     MOVEL'CSW025'  DBERKY                                              CSD015
     C                     MOVEL'SCSARDPD'DBFNAM                                              CSD015
     C                     MOVEL'39'      DBERR#                                              CSD015
     C                     EXSR DBERR                                                         CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           @RTCD     IFEQ *BLANK                                                        CSD015
     C                     MOVEL'Y'       CSW025  1                                           CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Check if switchable feature CSW215 is switched on.                                   CSW215
      *                                                                                       CSW215
     C                     CALL 'SWIF2015'                                                    CSW215
     C                     PARM *BLANKS   PRTCD                                               CSW215
      *                                                                                       CSW215
     C           PRTCD     IFEQ 'CSW2015'                                                     CSW215
     C                     MOVE 'Y'       CSW215  1                                           CSW215
     C                     ELSE                                                               CSW215
     C                     MOVE 'N'       CSW215                                              CSW215
     C                     ENDIF                                                              CSW215
      *                                                                                       CSW215
     C           TAGEND    TAG                              TAG: TAGEND
     C                     SETON                     40     1ST CYCLE DONE
     C*                                                                ***
     C/COPY WNCPYSRC,FT0656C008
     C                     ENDSR                            END N*IN40
     C*                                                                ***
     C********************************************************************
     C/EJECT                                                              S01117
     C*****************************************************************   S01117
     C*   SUBROUTINE BRANCH                                   *           S01117
     C*     TO VALIDATE EACH BOOKING BRANCH FOR EVERY RECORD  *           S01117
     C*     CALLED BY MAIN PROCESSING                         *           S01117
     C*********************************************************           S01117
     C*                                                                   S01117
     C           BRANCH    BEGSR                                          S01117
     C*   SAVE BOOKING BRANCH (BRCA) READ FROM NTRANDD FILE               S01117
     C                     MOVE BRCA      BRCAA   3                       S01117
     C*   SET UP KEY AND ACCESS INST. CONTROL REC BRANCH CODE (TABLETR)   S01117
     C*                                                                   S01117
     C                     MOVEL'10    '  ZTABKY                          S01117
     C                     MOVE BRCA      ZTABKY                          S01117
     C           ZTABKY    CHAINTABFP                10                   S01117
     C  N10      RECI      COMP 'D'                  1010  ON , DELETED   S01117
     C*                                                                   S01117
     C           *IN10     IFEQ '1'                         ))))))))))))))S01117
     C*********************MOVE 'TABFP'   DBFNAM            )))  DATS01117S01310
     C                     MOVEL'TABFP'   DBFNAM            )))  DATS01117S01310
     C                     MOVELZTABKY    DBERKY            )))  BASE  )))S01117
     C                     MOVE '03'      DBERR#            ))) ERROR  )))S01117
     C                     EXSR DBERR                       )))   03   )))S01117
     C                     END                              ))))))))))))))S01117
     C*  SAVE BRANCH INTERNAL CUSTOMER NO.                                S01117
     C**********           MOVE BICN      SBICN   60                                   S01117 CSD027
     C                     MOVE BICN      SBICN   6                                           CSD027
     C***SET*UP*KEY*TO*ACCESS CLIENT FILE (FOR CLINTCB)             S01117S01310
     C*********************MOVE BICN      KCUSNO  60                S01117S01310
     C*********************MOVE 'A'       KEYA    1                 S01117S01310
     C*********************                                         S01117S01310
     C***ACCESS*CLIENT*FILE                                         S01117S01310
     C***********BICN******CHAINCLINTCBF             80             S01117S01310
     C*********************                                         S01117S01310
     C************IN80*****IFEQ '1'                         ))))))))S01117S01310
     C*********************MOVE 'TABFP'   DBFNAM            )))  DATS01117S01310
     C*********************MOVEL'      A' DBERKY            )))  BASS01117S01310
     C*********************MOVELBICN      DBERKY            )))  BASS01117S01310
     C*********************MOVE '04'      DBERR#            ))) ERROS01117S01310
     C*********************EXSR DBERR                       )))   04S01117S01310
     C*********************END                              ))))))))S01117S01310
      *                                                                   S01310
      **  Access SDCUSTPD using branch internal customer number           S01310
      *                                                                   S01310
     C                     MOVE *BLANKS   @KEY1                           S01310
     C                     MOVELBICN      @KEY1                           S01310
     C                     CALL 'AOCUSTR0'                                S01310
     C                     PARM '*MSG   ' @RTCD   7                       S01310
     C                     PARM '*KEY   ' @OPTN   7                       S01310
     C                     PARM           @KEY1  10                       S01310
     C                     PARM *BLANKS   @KYST   7                       S01310
     C           SDCUST    PARM SDCUST    DSSDY                           S01310
      *                                                                   S01310
      ** Customer record not found - Error                                S01310
      *                                                                   S01310
     C           @RTCD     IFNE *BLANKS                                   S01310
     C                     MOVE '004'     DBERR#             * * * * * * *S01310
     C                     MOVEL@KEY1     DBERKY             * DBERR 004 *S01310
     C                     MOVEL'SDCUSTPD'DBFNAM             * * * * * * *S01310
     C                     EXSR DBERR                                     S01310
     C                     END                                            S01310
      *                                                                   S01310
      **  Save sender's addresses & parent customer number                S01310
      *                                                                   S01310
     C***********          MOVE BBCSID    SNCSID 12                 S01310064393
     C                     MOVE BBTXA1    STELX  10                       S01310
     C                     MOVE BBSTAD    SSTTX  12                       S01310
     C                     MOVE BBCRNM    SCRNM  20                       S01310
      *                                                                   S01310
      ** Move new field names to old to ensure pgm continuity.            S01310
      *                                                                   S01310
     C                     MOVE BBCSID    CSID   12                       S01310
     C                     MOVELBBTXA1    TELX   12                       S01310
     C*                                                                   S01117
     C**************************************                              S01117
     C*    REMOVE TERMINAL ID              *                              S01117
     C**************************************                              S01117
     C*                                                                   S01117
     C*  SAVE   'OUR TID' FIELD IN WORK AREA                              S01117
     C                     MOVE TELX      MXOTLX 12                       S01117
     C*                                                                   S01310
     C* ACCESS TO SDBRCHL5                                                S01310
     C                     MOVE BICN      WWBICN  6                       S01310
     C           WWBICN    CHAINSDBRCHL5             09                   S01310
     C  N09      A8TYLC    COMP 'D'                      09               S01310
     C*                                                                   S01310
     C           *IN09     IFEQ '1'                         ))))))))))))))S01310
     C                     MOVE 'SDBRCHL5'DBFNAM            )))  DATA  )))S01310
     C                     MOVELA8BICN    DBERKY            )))  BASE  )))S01310
     C                     MOVE '28'      DBERR#            ))) ERROR  )))S01310
     C                     EXSR DBERR                       )))   28   )))S01310
     C                     END                              ))))))))))))))S01310
     C*                                                                   S01310
     C                     MOVE A8BTID    SNCSID                          064393
     C                     MOVE A8BTID    SCSID                           S01310
     C                     MOVE SCSID     MXOSFT 12                       S01310
     C                     ENDSR                                          S01117
     C/EJECT
     C********************************************************************S01117
     C********************************************************************S01117
     C*               SUBROUTINE SUBZSF                                ***S01117
     C*                ZSFILE HANDLING                                 ***S01117
     C*                                                                ***S01117
     C           SUBZSF    BEGSR                                          S01117
     C*                                                                   S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           RSEQ    5                       S01117
     C                     PARM *BLANKS   RENT    3                       S01117
     C                     PARM           SFILP  10                       S01117
     C                     PARM           SPLNO   60                      S01117
     C                     PARM *BLANKS   ZERR    1                       S01117
     C*                                                                   S01117
     C                     ENDSR                                          S01117
     C*                                                                   S01117
     C/EJECT                                                              S01117
     C********************************************************************S01117
     C********************************************************************
     C*               SUBROUTINE 01                                    ***
     C*         TO FORMAT SETTLEMENT PARTY TO SWIFT FORMAT             ***
     C*                                                                ***
     C           SR01      BEGSR                                       ***
     C*                                                                ***
     C*   INITIALISE OUTPUT PARAMETER FIELDS                           ***
     C                     MOVE *BLANKS   OFSPT1 35
     C                     MOVE *BLANKS   OFSPT2 35
     C                     MOVE *BLANKS   OFSPT3 35
     C                     MOVE *BLANKS   OFSPT4 35
     C                     MOVE *BLANKS   OFSPT5 35
     C                     MOVE *BLANKS   OSTAG   1
     C                     MOVE 'N'       OSUFLG  1
     C*                                                                ***
     C*   FULL NOSTRO PROCESSING - APPEND THE PAY CURRENCY TO THE      ***
     C*   FIRST SETTLEMENT PARTY FIELD TO ACCESS NOSTRO DET FROM
     C*   PF/TABLETL TO OBTAIN CUST NO.                                ***
     C           ISPTP     IFEQ 'F'
     C                     MOVELISPTY1    TLCCNN  5        BUILD
     C                     MOVEL'70'      TABTLK 12           KEY
     C                     MOVE TLCCNN    TABTLK 12            KEY
     C           TABTLK    CHAINTABFP                10    ON, DELETED
     C           *IN10     IFEQ '1'                         ))))))))))))))
     C*********************MOVE 'TABFP'   DBFNAM  5         )))  DATA  )))S01310
     C                     MOVEL'TABFP'   DBFNAM            )))  DATA  )))S01310
     C                     MOVELTABTLK    DBERKY 39         )))  BASE  )))
     C                     MOVE '06'      DBERR#  2         ))) ERROR  )))
     C                     EXSR DBERR                       )))   06   )))
     C                     END                              ))))))))))))))
     C**********           MOVE CNUM      CUSTNO  60                                          CSD027
     C                     MOVE CNUM      CUSTNO  6                                           CSD027
     C                     END
     C*                                                                ***
     C*   NOSTRO NO. PROCESSING - APPEND THE PAY CURRENCY TO THE       ***
     C*   FIRST 2 CHARS OF THE 1ST SETL PTY FIELD TO ACCESS NOSTRO DET
     C*   FROM PF/TABLETL TO OBTAIN CUST NO.                           ***
     C           ISPTP     IFEQ 'N'
     C                     MOVELISPTY1    TLNN    2        BUILD
     C                     MOVELCCY       TLCCNN             KEY
     C                     MOVE TLNN      TLCCNN              KEY
     C                     MOVEL'70'      TABTLK                KEY
     C                     MOVE TLCCNN    TABTLK 12              KEY
     C           TABTLK    CHAINTABFP                10    ON, DELETED
     C           *IN10     IFEQ '1'                         ))))))))))))))
     C*********************MOVE 'TABFP'   DBFNAM  5         )))  DATA  )))S01310
     C                     MOVEL'TABFP'   DBFNAM            )))  DATA  )))S01310
     C                     MOVELTABTLK    DBERKY 39         )))  BASE  )))
     C                     MOVE '07'      DBERR#  2         ))) ERROR  )))
     C                     EXSR DBERR                       )))   07   )))
     C                     END                              ))))))))))))))
     C**********           MOVE CNUM      CUSTNO  60                                          CSD027
     C                     MOVE CNUM      CUSTNO  6                                           CSD027
     C/COPY WNCPYSRC,FT0656C009
     C                     END
     C*                                                                ***
     C*   RETAIL ACCNT PROCESSING -                                    ***
     C*   USE 1ST 10 CHARS OF THE 1ST SETL PTY FIELD TO ACCESS
     C*   THE ACCOUNT DETAILS FROM LF/ACNUMA TO OBTAIN CUST NO.        ***
     C           ISPTP     IFEQ 'R'
     C                     MOVELISPTY1    ACNUMK 100
     C           ACNUMK    CHAINACNUMA               11    ON, DELETED
     C           *IN11     IFEQ '1'                         ))))))))))))))
     C*********************MOVE 'ACNUM'   DBFNAM  5         )))  DATA  )))S01310
     C                     MOVEL'ACNUM'   DBFNAM            )))  DATA  )))S01310
     C                     MOVELACNUMK    DBERKY 39         )))  BASE  )))
     C                     MOVE '08'      DBERR#  2         ))) ERROR  )))
     C                     EXSR DBERR                       )))   08   )))
     C                     END                              ))))))))))))))
     C**********           MOVE CNUM      CUSTNO  60                                          CSD027
     C                     MOVE CNUM      CUSTNO  6                                           CSD027
     C                     END
     C*                                                                ***
     C*   FULL ACCOUNT/PARTIAL ACCOUNT/CUSTOMER PROCESSING - CUST NO.  ***
     C*   IS 1ST 6 CHARS OF THE 1ST SETL PTY FIELD.
     C           ISPTP     IFEQ 'G'
     C           ISPTP     OREQ 'P'
     C           ISPTP     OREQ 'C'
     C*                                                                   S01494
     C** If using account line construct then use second line             S01494
     C*                                                                   S01494
     C                     MOVELISPTY1    ##001   1                       S01494
     C           ##001     IFEQ '/'                                       S01494
     C                     MOVELISPTY2    CUSTNO                          S01494
     C                     ELSE                                           S01494
     C                     MOVELISPTY1    CUSTNO
     C                     END                                            S01494
     C                     END
     C*                                                                   S01494
     C** If SWIFT identifier then use ME1400 to check details             S01494
     C*                                                                   S01494
     C           ISPTP     IFEQ 'S'                                       S01494
     C*                                                                   S01494
     C** Call Access object to validate identifier                        S01494
     C*                                                                   S01494
     C                     MOVELISPTY1    ##001   1                       S01494
     C           ##001     IFEQ '/'                                       S01494
     C                     MOVELISPTY2    W9BICC                          S01494
     C           3         SUBSTISPTY2:9  W9BICB                          S01494
     C                     ELSE                                           S01494
     C                     MOVELISPTY1    W9BICC                          S01494
     C           3         SUBSTISPTY1:9  W9BICB                          S01494
     C                     END                                            S01494
      *                                                                   S01494
     C                     CALL 'ME1400'                                  S01494
     C                     PARM *BLANKS   W9RTN   7                       S01494
     C                     PARM           W9BICC  8                       S01494
     C                     PARM           W9BICB  3                       S01494
     C                     PARM           SDCUST                          S01494
     C                     PARM           SDCNST                          S01494
     C                     PARM           MEBICD                          S01494
     C                     PARM *BLANKS   W9CUST  1                       S01494
     C                     PARM *BLANKS   W9CNST  1                       S01494
     C                     PARM *BLANKS   W9BICD  1                       S01494
     C*                                                                   S01494
     C** If customer details exist then set up CUSTNO                     S01494
     C*                                                                   S01494
     C           W9CUST    IFEQ 'Y'                                       S01494
     C                     MOVELBBCUST    CUSTNO                          S01494
     C*                                                                   S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C                     END                                            S01494
     C*                                                                ***
     C*   ACCESS FULL CUSTOMER DETAILS FROM LF/CLINT                   ***
     C           ISPTP     IFEQ 'G'
     C           ISPTP     OREQ 'P'
     C           ISPTP     OREQ 'C'
     C           ISPTP     OREQ 'F'
     C           ISPTP     OREQ 'N'
     C           ISPTP     OREQ 'R'
     C           W9CUST    OREQ 'Y'                                       S01494
     C           ISPTP     ANDEQ'S'                                       S01494
     C***SET*UP*CUSTOMER*KEY                                              S01310
     C*********************MOVELCUSTNO    KCUSNO  60                      S01310
     C*********************MOVE 'A'       KEYA    1                       S01310
     C***********CUSKEY****CHAINCLINTCBF             12    ON, DELETED    S01310
     C************IN12*****IFEQ '1'                         ))))))))))))))S01310
     C*********************MOVE 'CLINT'   DBFNAM  5         )))  DATA  )))S01310
     C*********************MOVEL'      A' DBERKY            )))  BASE  )))S01310
     C*********************MOVELKCUSNO    DBERKY            )))  BASE  )))S01310
     C*********************MOVE '09'      DBERR#  2         ))) ERROR  )))S01310
     C*********************EXSR DBERR                       )))   09   )))S01310
     C*********************END                              ))))))))))))))S01310
     C*
     C**********           MOVE CUSTNO    CUSTKY  60                                   S01310 CSD027
     C                     MOVE CUSTNO    CUSTKY  6                                           CSD027
      *                                                                   S01310
      *   Access SDCUSTPD using customer number                           S01310
      *                                                                   S01310
     C                     MOVE *BLANKS   @KEY1                           S01310
     C                     MOVELCUSTKY    @KEY1                           S01310
     C                     CALL 'AOCUSTR0'                                S01310
     C                     PARM '*MSG   ' @RTCD                           S01310
     C                     PARM '*KEY   ' @OPTN                           S01310
     C                     PARM           @KEY1  10                       S01310
     C                     PARM *BLANKS   @KYST   7                       S01310
     C           SDCUST    PARM SDCUST    DSSDY                           S01310
      *                                                                   S01310
      ** Customer record not found - Error                                S01310
      *                                                                   S01310
     C           @RTCD     IFNE *BLANKS                                   S01310
     C                     MOVE '009'     DBERR#             * * * * * * *S01310
     C                     MOVEL@KEY1     DBERKY             * DBERR 009 *S01310
     C                     MOVEL'SDCUSTPD'DBFNAM             * * * * * * *S01310
     C                     EXSR DBERR                                     S01310
     C                     END                                            S01310
      *                                                                   S01310
      ** Move old field names to new to retain pgm continuity.            S01310
      *                                                                   S01310
     C**********           MOVELBBPCNB    CPAR    60                                   S01310 CSD027
     C                     MOVELBBPCNB    CPAR    6                                           CSD027
     C                     MOVELBBCRNM    CRNM   20                       S01310
     C                     MOVELBBCRTN    CTWN   10                       S01310
     C                     MOVELBBCSID    CSID                            S01310
      *                                                                   S01310
     C* ACCESS DESTINATION ADDRESS DETAILS VIA SWFT SUBROUTINE
     C* (20 ONLY SET ON FOR DESTINATION)
     C*
     C           *IN20     IFEQ '1'
     C*
     C*********************EXSR SWFT                                      S01310
      ***********                                                  S01310 CSW096
      ***If*the*destination*has*a*default*address*(BBDNW2)*use*it*,S01310 CSW096
      ***else*use*the*priority*network*address.********************S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********BBDNW2    IFNE *BLANKS                            S01310 CSW096
     C***********          EXSR NWAD                               S01310 CSW096
     C***********          ELSE                                    S01310 CSW096
     C***********          EXSR PRAD                               S01310 CSW096
     C***********          END                                     S01310 CSW096
      ***********                                                  S01310 CSW096
      ****Fill*up*the*appropriate*array*information*from*PF/SDCUSTPS01310 CSW096
     C***********          EXSR FILL                               S01310 CSW096
      ***********                                                  S01310 CSW096
      ***********                                                  089269 CSW096
      ****Check*if*MT210*should*not*be*generated*for*this*customer.089269 CSW096
      ***********                                                  089269 CSW096
     C************IN21     IFEQ '0'                                089269 CSW096
      ***********                                                  089269 CSW096
     C***********'210'     LOKUPNGN                      56        089269 CSW096
     C***********'21*'     LOKUPNGN                      57        089269 CSW096
     C***********'2**'     LOKUPNGN                      58        089269 CSW096
      ***********                                                  089269 CSW096
     C***********          END                                     089269 CSW096
      ****If*message*status*blank,*determine*value.****************S01310 CSW096
      ****Is*default*status*for*MT210*or**MT200*messages*released*?S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********MGST      IFEQ *BLANKS                            S01310 CSW096
      ***********                                                  S01310 CSW096
      ****Message*type*MT200.**************************************S01310 CSW096
      ***********                                                  S01310 CSW096
     C************IN21     IFEQ '1'                                S01310 CSW096
     C***********'200'     LOKUPGNR                      15        S01310 CSW096
     C***********'20*'     LOKUPGNR                      16        S01310 CSW096
     C***********'2**'     LOKUPGNR                      17        S01310 CSW096
      ***********                                                  S01310 CSW096
      ****Message*type*MT210.**************************************S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********          ELSE                                    S01310 CSW096
     C***********'210'     LOKUPGNR                      15        S01310 CSW096
     C***********'21*'     LOKUPGNR                      16        S01310 CSW096
     C***********'2**'     LOKUPGNR                      17        S01310 CSW096
     C***********          END                                     S01310 CSW096
      ***********                                                  S01310 CSW096
     C************IN15     IFEQ '1'                                S01310 CSW096
     C************IN16     OREQ '1'                                S01310 CSW096
     C************IN17     OREQ '1'                                S01310 CSW096
     C***********          MOVE 'RSND'    MGST                     S01310 CSW096
     C***********          MOVE '2'       MGSG                     S01310 CSW096
     C***********          ELSE                                    S01310 CSW096
      ***********                                                  088545 CSW096
      ****If*there*is*no*default*for*that*type*of*message*for*that*088545 CSW096
      ****customer,*setup*the*message*status*whith*the*ICD*default.088545 CSW096
      ***********                                                  088545 CSW096
      ***********FTCS      IFEQ 'R'                                088545 CSW096
     C***********          MOVE 'RSND'    MGST                     088545 CSW096
     C***********          MOVE '2'       MGSG                     088545 CSW096
     C***********          ELSE                                    088545 CSW096
     C***********          MOVE 'CRTD'    MGST                     S01310 CSW096
     C***********          MOVE '1'       MGSG                     S01310 CSW096
     C***********          END                                     088545 CSW096
     C***********          END                                     S01310 CSW096
     C***********          END                                     S01310 CSW096
      *                                                                   CSW096
     C                     EXSR SRROUT                                    CSW096
      *                                                                   S01310
     C***********CSID******IFEQ *BLANKS                                   S01310
     C*********************MOVE 'N'       OSUFLG                          S01310
     C*********************END                                            S01310
     C                     END
     C                     GOTO SR01A
     C                     END
     C*                                                                   S01494
     C** If SWIFT identifier and destination of message set up            S01494
     C** routing data                                                     S01494
     C*                                                                   S01494
     C           ISPTP     IFEQ 'S'                                       S01494
     C           *IN20     ANDEQ'1'                                       S01494
     C                     MOVEL'Y'       OSUFLG                          S01494
     C**********           Z-ADD0         CPAR                                         S01494 CSD027
     C                     MOVE *BLANKS   CPAR                                                CSD027
     C                     MOVELISPTY1    CRNM                            S01494
     C                     MOVELSCRNM     NWSN                            S01494
     C                     MOVELISPTY1    NWDS                            S01494
     C                     MOVEL'SWIFT'   NWRK                            S01494
     C                     MOVEL*BLANKS   CTWN                            S01494
     C                     MOVELISPTY1    CSID                            S01494
      *                                                                   088545
      *  Default the message status whith the ICD.                        088545
      *                                                                   088545
     C           FTCS      IFEQ 'R'                                       088545
     C                     MOVE 'RSND'    MGST                            088545
     C                     MOVE '2'       MGSG                            088545
     C                     ELSE                                           088545
     C                     MOVE 'CRTD'    MGST                            S01494
     C                     MOVE '1'       MGSG                            S01494
     C                     END                                            088545
     C                     END                                            S01494
     C*                                                                ***
     C*   SWIFT ADDRESS AND AT LEAST ONE VALID TAG FIELDS = 'A'        ***
     C           ISPTP     IFEQ 'S'
     C           IVTAG1    ANDEQ'A'
     C*                                                                   S01494
     C** If using account line construct then use second line             S01494
     C*                                                                   S01494
     C                     MOVELISPTY1    ##001                           S01494
     C           ##001     IFEQ '/'                                       S01494
     C                     MOVELISPTY2    SP12                            S01494
     C                     MOVELSP12      SCSID                           S01494
     C                     MOVELISPTY1    OFSPT1                          S01494
     C                     MOVELSCSID     OFSPT2                          S01494
     C                     ELSE                                           S01494
     C                     MOVELISPTY1    SP12   12        1ST 12 CHARS
     C                     MOVELSP12      SCSID            1ST 12 CHARS
     C                     MOVELSCSID     OFSPT1
     C                     END                                            S01494
     C                     MOVE 'A'       OSTAG
     C*********************MOVE 'Y'       OSUFLG                          S01310
     C                     GOTO SR01N
     C                     END
     C*                                                                ***
     C*   SWIFT ADDRESS AND AT LEAST ONE VALID TAG FIELDS = 'D'        ***
     C           ISPTP     IFEQ 'S'
     C           IVTAG3    ANDEQ'D'
     C*                                                                   S01494
     C** Use FT0315 to format text for D address type                     S01494
     C*                                                                   S01494
     C*                                                                   S01494
     C** Set up general parameters                                        S01494
     C*                                                                   S01494
     C           *LIKE     DEFN BCCY      XCCY                            S01494
     C*                                                                   S01494
     C                     CLEARW8FT                                      S01494
     C                     MOVEL*BLANKS   W8STMT                          S01494
     C                     MOVEL##PGM     W8CPGM                          S01494
     C                     MOVEL'*MSG  '  W8ACT                           S01494
     C                     Z-ADD5         W8NLIN                          S01494
     C                     MOVEL'Y'       W8MTXT                          S01494
     C*                                                                   S01494
     C** Format data to be translated                                     S01494
     C*                                                                   S01494
     C                     MOVELISPTP     W8TYPE                          S01494
     C                     MOVELISCCY     W8CCY                           S01494
     C                     MOVEL*BLANKS   W8LINS                          S01494
     C                     MOVELISPTY1    ADCHK1                          S01494
     C                     MOVELISPTY2    ADCHK2                          S01494
     C                     MOVELISPTY3    ADCHK3                          S01494
     C                     MOVELISPTY4    ADCHK4                          S01494
     C                     MOVELISPTY5    ADCHK5                          S01494
     C           W8TYPE    IFEQ 'P'                                       S01494
     C           ISBRCA    ANDNE*BLANKS                                   S01494
     C                     MOVELISBRCA    ADPBRC                          S01494
     C                     END                                            S01494
     C                     MOVELADDRSS    W8LINS                          S01494
     C*                                                                   S01494
     C** Call expansion program                                           S01494
     C*                                                                   S01494
     C                     CALL 'FT0315'               1111               S01494
     C                     PARM           W8RTN   7                       S01494
     C                     PARM           W8FT                            S01494
     C                     PARM           W8LINS256                       S01494
     C                     PARM           W8RPT 256                       S01494
     C                     PARM           W8MSG 256                       S01494
     C                     PARM           W8SCR 256                       S01494
     C*                                                                   S01494
     C** Check if database error occurred                                 S01494
     C*                                                                   S01494
     C           *IN11     IFEQ '1'                                       S01494
     C           W8RTN     ORNE *BLANKS                                   S01494
     C                     MOVE '089'     DBERR#           ************   S01494
     C                     MOVEL'*CALL'   DBERKY           * DBERR 89 *   S01494
     C                     MOVEL'FT0315'  DBFNAM           ************   S01494
     C                     EXSR DBERR                                     S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C                     MOVELW8MSG     ADDRSS                          S01494
     C                     MOVELADCHK1    OFSPT1                          S01494
     C                     MOVELADCHK2    OFSPT2                          S01494
     C                     MOVELADCHK3    OFSPT3                          S01494
     C                     MOVELADCHK4    OFSPT4                          S01494
     C                     MOVELADCHK5    OFSPT5                          S01494
     C*                                                                   S01494
     C***********          MOVELISPTY1    SP12   12        1ST 12 CHARS   S01494
     C***********          MOVELSP12      OFSPT1           1ST 12 CHARS   S01494
     C                     MOVE 'D'       OSTAG
     C*********************MOVE 'Y'       OSUFLG                          S01310
     C                     GOTO SR01N
     C                     END
     C*                                                                ***
     C*   FULL ADDRESS AND AT LEAST ONE VALID TAG FIELDS = 'D'         ***
     C           ISPTP     IFEQ 'A'
     C           IVTAG3    ANDEQ'D'
     C                     MOVELISPTY1    OFSPT1
     C                     MOVELISPTY2    OFSPT2
     C                     MOVELISPTY3    OFSPT3
     C                     MOVELISPTY4    OFSPT4
     C                     MOVELISPTY5    OFSPT5
     C                     MOVE 'D'       OSTAG
     C*********************MOVE 'N'       OSUFLG                          S01310
      *                                                                                      260987A
      ** Ensure fields for MGOREFPD set up correctly (if destination).                       260987A
      *                                                                                      260987A
     C           *IN20     IFEQ '1'                                                          260987A
     C                     MOVEL'PAPER'   NWRK                                               260987A
     C                     MOVELSBICN     NWSN                                               260987A
     C                     MOVELSBICN     SECN                                               260987A
     C                     MOVELISPTY1    NWDS                                               260987A
     C                     MOVEL*BLANKS   BBCUST                                             260987A
     C                     ENDIF                                                             260987A
      *                                                                                      260987A
      ** Default the message status with the ICD.                                            260987A
      *                                                                                      260987A
     C           FTCS      IFEQ 'R'                                                          260987A
     C                     MOVE 'RSND'    MGST                                               260987A
     C                     MOVE '2'       MGSG                                               260987A
     C                     ELSE                                                              260987A
     C                     MOVE 'CRTD'    MGST                                               260987A
     C                     MOVE '1'       MGSG                                               260987A
     C                     ENDIF                                                             260987A
      *                                                                                      260987A
     C                     GOTO SR01N
     C                     END
     C*
     C           SR01A     TAG
     C* IF TYPE BLANK IGNORE
     C           ISPTP     IFEQ ' '                        B001
     C                     GOTO SR01N
     C                     END                             E001
     C*                                                                ***
     C*   VALID TAG FIELD = 'A' AND THE SWIFT ADDRESS ON LF/CLINT IS   ***
     C*   NON BLANK                                                    ***
     C           IVTAG1    IFEQ 'A'
     C           CSID      ANDNE*BLANK
     C*                                                                   S01494
     C** If using account line construct then use second line             S01494
     C*                                                                   S01494
     C                     MOVELISPTY1    ##001                           S01494
     C           ##001     IFEQ '/'                                       S01494
     C                     MOVELCSID      SCSID                           S01494
     C                     MOVELISPTY1    OFSPT1                          S01494
     C                     MOVELSCSID     OFSPT2                          S01494
     C                     ELSE                                           S01494
     C                     MOVELCSID      SCSID
     C                     MOVELSCSID     OFSPT1
     C                     END                                            S01494
     C                     MOVE 'A'       OSTAG
     C*********************MOVE 'Y'       OSUFLG                          S01310
     C                     GOTO SR01N
     C                     END
     C*                                                                ***
     C*   VALID TAG FIELD = 'B' AND THE CUSTOMER PARENT NUMBER FROM    ***
     C*  LF/CLINT IS NON ZERO AND EQUAL TO THE CUST. NO. OF HEAD OFFICE***
     C*                                                                   S01494
     C** If using account line construct then 'B' not allowed             S01494
     C*                                                                   S01494
     C                     MOVELISPTY1    ##001                           S01494
     C           IVTAG2    IFEQ 'B'
     C********** CPAR      ANDNE*ZERO                                                         CSD027
     C           CPAR      ANDNE*BLANKS                                                       CSD027
     C           CPAR      ANDEQSHEAD                      SAVE 1ST CYCLE
     C           ##001     ANDNE'/'                                       S01494
     C                     MOVELCTWN      OFSPT1
     C                     MOVE 'B'       OSTAG
     C*********************MOVE 'N'       OSUFLG                          S01310
     C                     GOTO SR01N
     C                     END
     C*                                                                ***
     C*   VALID TAG FIELD = 'D'                                        ***
     C           IVTAG3    IFEQ 'D'
     C*********************MOVE 'B'       KEYA                            S01310
     C***********CUSKEY****CHAINCLINTCCF             12    ON, DELETED    S01310
     C************IN12*****IFEQ '1'                         ))))))))))))))S01310
     C*********************MOVE 'CLINT'   DBFNAM  5         )))  DATA  )))S01310
     C*********************MOVEL'      B' DBERKY            )))  BASE  )))S01310
     C*********************MOVELKCUSNO    DBERKY            )))  BASE  )))S01310
     C*********************MOVE '14'      DBERR#  2         ))) ERROR  )))S01310
     C*********************EXSR DBERR                       )))   14   )))S01310
     C*********************END                              ))))))))))))))S01310
     C*********************MOVELCNA1      OFSPT1                          S01310
     C*********************MOVELCNA2      OFSPT2                          S01310
     C*********************MOVELCNA3      OFSPT3                          S01310
     C*********************MOVELCNA4      OFSPT4                          S01310
     C*                                                                   S01494
     C** Replaced by call FT0315                                          S01494
     C*                                                                   S01494
      ***********                                                  S01310 S01494
      ***Access*SDCUSTPD with the customer number.                 S01310 S01494
      ***********                                                  S01310 S01494
     C***********          MOVE *BLANKS   @KEY1                    S01310 S01494
     C***********          MOVELCUSTNO    @KEY1                    S01310 S01494
     C***********          CALL 'AOCUSTR0'                         S01310 S01494
     C***********          PARM '*MSG   ' @RTCD                    S01310 S01494
     C***********          PARM '*KEY   ' @OPTN                    S01310 S01494
     C***********          PARM           @KEY1  10                S01310 S01494
     C***********          PARM *BLANKS   @KYST   7                S01310 S01494
     C***********SDCUST    PARM SDCUST    DSSDY                    S01310 S01494
      ***********                                                  S01310 S01494
      ***Customer record not found - Error                         S01310 S01494
      ***********                                                  S01310 S01494
     C***********@RTCD     IFNE *BLANKS                            S01310 S01494
     C***********          MOVE '014'     DBERR#             * * * S01310 S01494
     C***********          MOVEL@KEY1     DBERKY             * DBERS01310 S01494
     C***********          MOVEL'SDCUSTPD'DBFNAM             * * * S01310 S01494
     C***********          EXSR DBERR                              S01310 S01494
     C***********          END                                     S01310 S01494
     C***********          MOVELBBCNA1    OFSPT1                   S01310 S01494
     C***********          MOVELBBCNA2    OFSPT2                   S01310 S01494
     C***********          MOVELBBCNA3    OFSPT3                   S01310 S01494
     C***********          MOVELBBCNA4    OFSPT4                   S01310 S01494
     C***********          MOVE 'D'       OSTAG                           S01494
     C*********************MOVE 'N'       OSUFLG                          S01310
     C***********          END                                            S01494
     C*                                                                ***
     C*                                                                   S01494
     C** Use FT0315 to format text for D address type                     S01494
     C*                                                                   S01494
     C*                                                                   S01494
     C** Set up general parameters                                        S01494
     C*                                                                   S01494
     C                     CLEARW8FT                                      S01494
     C                     MOVEL*BLANKS   W8STMT                          S01494
     C                     MOVEL##PGM     W8CPGM                          S01494
     C                     MOVEL'*MSG  '  W8ACT                           S01494
     C                     Z-ADD5         W8NLIN                          S01494
     C                     MOVEL'Y'       W8MTXT                          S01494
     C*                                                                   S01494
     C** Format data to be translated                                     S01494
     C*                                                                   S01494
     C                     MOVELISPTP     W8TYPE                          S01494
     C                     MOVELISCCY     W8CCY                           S01494
     C                     MOVEL*BLANKS   W8LINS                          S01494
     C                     MOVELISPTY1    ADCHK1                          S01494
     C                     MOVELISPTY2    ADCHK2                          S01494
     C                     MOVELISPTY3    ADCHK3                          S01494
     C                     MOVELISPTY4    ADCHK4                          S01494
     C                     MOVELISPTY5    ADCHK5                          S01494
     C           W8TYPE    IFEQ 'P'                                       S01494
     C           ISBRCA    ANDNE*BLANKS                                   S01494
     C                     MOVELISBRCA    ADPBRC                          S01494
     C                     END                                            S01494
     C                     MOVELADDRSS    W8LINS                          S01494
     C*                                                                   S01494
     C** Call expansion program                                           S01494
     C*                                                                   S01494
     C                     CALL 'FT0315'               1111               S01494
     C                     PARM           W8RTN   7                       S01494
     C                     PARM           W8FT                            S01494
     C                     PARM           W8LINS256                       S01494
     C                     PARM           W8RPT 256                       S01494
     C                     PARM           W8MSG 256                       S01494
     C                     PARM           W8SCR 256                       S01494
     C*                                                                   S01494
     C** Check if database error occurred                                 S01494
     C*                                                                   S01494
     C           *IN11     IFEQ '1'                                       S01494
     C           W8RTN     ORNE *BLANKS                                   S01494
     C                     MOVE '090'     DBERR#           ************   S01494
     C                     MOVEL'*CALL'   DBERKY           * DBERR 90 *   S01494
     C                     MOVEL'FT0315'  DBFNAM           ************   S01494
     C                     EXSR DBERR                                     S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C                     MOVELW8MSG     ADDRSS                          S01494
     C                     MOVELADCHK1    OFSPT1                          S01494
     C                     MOVELADCHK2    OFSPT2                          S01494
     C                     MOVELADCHK3    OFSPT3                          S01494
     C                     MOVELADCHK4    OFSPT4                          S01494
     C                     MOVELADCHK5    OFSPT5                          S01494
     C                     MOVE 'D'       OSTAG                           S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C           SR01N     TAG
     C           CSW201    IFEQ 'Y'                                                           CSW201
     C           OSTAG     ANDEQ'A'                                                           CSW201
     C           W201IN    ANDEQ'Y'                                                           CSW201
     C                     MOVELSCSID     WSWFID                                              CSW201
     C                     CALL 'AOBICDV0'                                                    CSW201
     C                     PARM *BLANKS   PRETCD 10                                           CSW201
     C                     PARM           WSWFID 18                                           CSW201
     C                     PARM           PTYPE   7                                           CSW201
     C           MEBICD    PARM MEBICD    DSSDY                                               CSW201
     C           PTYPE     IFEQ '*BIC'                                                        CSW201
      *                                                                                       CSW202
      ** If SWIFT 2002 Standards Update is switched on, check if                              CSW202
      ** subtype is included in BEI subtypes file MEBEISPD. If yes,s                          CSW202
      ** format with option D.                                                                CSW202
      *                                                                                       CSW202
     C           CSW202    IFEQ 'Y'                                                           CSW202
      *                                                                                       CSW202
     C                     CALL 'AOBEISR0'                                                    CSW202
     C                     PARM *BLANKS   PRTCD                                               CSW202
     C                     PARM '*VERIFY' POPTN                                               CSW202
     C                     PARM BDSUBT    PBICD                                               CSW202
     C           MEBEIS    PARM MEBEIS    DSFDY                                               CSW202
      *                                                                                       CSW202
     C                     ENDIF                                                              CSW202
      *                                                                                       CSW202
     C           BDSUBT    IFEQ 'BEID'                                                        CSW201
     C           CSW202    ANDEQ'N'                                                           CSW202
     C           BDSUBT    OREQ 'TRCO'                                                        CSW201
     C           CSW202    ANDEQ'N'                                                           CSW202
     C           CSW202    OREQ 'Y'                                                           CSW202
     C           PRTCD     ANDEQ*BLANKS                                                       CSW202
     C                     MOVEL'D'       OSTAG                                               CSW201
      *                                                                                       197993
      ** If account line, then start with second line.                                        197993
     C           ##001     IFEQ '/'                                                           197993
     C                     MOVELISPTY1    OFSPT1                                              197993
     C                     MOVELBBCNA1    OFSPT2                                              197993
     C                     MOVELBBCNA2    OFSPT3                                              197993
     C                     MOVELBBCNA3    OFSPT4                                              197993
     C                     MOVELBBCNA4    OFSPT5                                              197993
     C                     ELSE                                                               197993
     C                     MOVELBBCNA1    OFSPT1                                              CSW201
     C                     MOVELBBCNA2    OFSPT2                                              CSW201
     C                     MOVELBBCNA3    OFSPT3                                              CSW201
     C                     MOVELBBCNA4    OFSPT4                                              CSW201
     C                     ENDIF                                                              197993
      *                                                                                       197993
     C                     ENDIF                                                              CSW201
     C                     ENDIF                                                              CSW201
     C                     ENDIF                                                              CSW201
     C                     EXSR EMBLK
     C*                                                                ***
     C                     ENDSR
     C*                                                                ***
     C********************************************************************
     C/EJECT
     C********************************************************************
     C*               SUBROUTINE EMBLK                                 ***
     C*                                                                ***
     C*     TO ELIMINATE BLANK LINES ON NAME AND ADDRESS FIELDS        ***
     C*                                                                ***
     C*      CALLED BY: MAIN PROCESSING, SR01
     C*
     C           EMBLK     BEGSR                                       ***
     C*                                                                ***
     C                     MOVEA*BLANKS   ADDR
     C                     Z-ADD1         A       10
     C*
     C           OFSPT1    IFNE *BLANK
     C                     MOVE OFSPT1    ADDR,A
     C                     ADD  1         A
     C                     END
     C*
     C           OFSPT2    IFNE *BLANK
     C                     MOVE OFSPT2    ADDR,A
     C                     ADD  1         A
     C                     END
     C*
     C           OFSPT3    IFNE *BLANK
     C                     MOVE OFSPT3    ADDR,A
     C                     ADD  1         A
     C                     END
     C*
     C           OFSPT4    IFNE *BLANK
     C                     MOVE OFSPT4    ADDR,A
     C                     ADD  1         A
     C                     END
     C*
     C           OFSPT5    IFNE *BLANK
     C                     MOVE OFSPT5    ADDR,A
     C                     ADD  1         A
     C                     END
     C*
     C                     MOVEAADDR      OFSPT
     C*
     C                     ENDSR
     C*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C*               SUBROUTINE 03                                    ***
     C*                                                                ***
     C*           TO FORMAT AMOUNT                                     ***
     C*                                                                ***
     C           SR03      BEGSR                                       ***
     C*                                                                   CSW020
     C** Perform Old Processing if CSW020 is not switched on.             CSW020
     C           CSW020    IFNE 'Y'                                       CSW020
     C*                                                                ***
     C*   CHAIN TO TABLETG TO FIND DECIMAL POSITION                    ***
     C                     MOVEL'20'      TABTGK 12
     C                     MOVELCCY       TGCCSR  4
     C                     MOVE '1'       TGCCSR
     C                     MOVE TGCCSR    TABTGK
     C           TABTGK    CHAINTABFP                10
     C*
     C           *IN10     IFEQ '1'                         ))))))))))))))
     C*********************MOVE 'TABFP'   DBFNAM            )))  DATA  )))S01310
     C                     MOVEL'TABFP'   DBFNAM            )))  DATA  )))S01310
     C                     MOVELTABTGK    DBERKY            )))  BASE  )))
     C                     MOVE '15'      DBERR#            ))) ERROR  )))
     C                     EXSR DBERR                       )))   15   )))
     C                     END                              ))))))))))))))
     C*
     C** USE THE SWIFT CURRENCY FROM TABLE ON THE SWIFT MESSAGES
     C*          =====
     C                     MOVE CCYS      M1RCCY
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0656CCP5                                           S01408
     C*                                                                   S01408
     C*
     C*    DETERMINE DECIMAL POSITION (FOR REPORT)
     C           CDP       COMP 2                    33  32
     C           CDP       COMP 1                      3031
     C*
     C*    DETERMINE DECIMAL POSITION
     C           14        SUB  CDP       X       20
     C*    IF 0 DECIMAL PLACES DON'T EDIT
     C           CDP       IFEQ 0                          B001
     C                     MOVE *BLANK    AMT
     C                     MOVE *ZEROS    AM
     C                     MOVEARAMNT     AMT,2
     C                     MOVEARAMNT     AM,1
     C                     Z-ADD13        W
     C                     MOVE ','       AM,X
     C                     ELSE                            E001
     C*    MOVE AMOUNT INTO ARRAY
     C                     MOVEARAMNT     AMT,1
     C*    DETERMINE POSITION OF DECIMAL DIGITS IN 2ND ARRAY
     C           X         ADD  1         Y       20
     C*    MOVE DECIMAL DIGITS INTO 2ND ARRAY FIELD
     C                     MOVEAAMT,X     AM,Y
     C*    DETERMINE POSITION & MOVE COMMA
     C                     SUB  1         Y
     C                     MOVE ','       AM,Y
     C*    DETERMINE POSITION OF DIGIT B4  COMMA
     C                     SUB  1         Y
     C*    SAVE POSITION OF DIGIT B4  COMMA
     C                     Z-ADDY         W       20
     C*    DETERMINE POSITION OF DIGIT TO BE MOVED B4  COMMA
     C                     SUB  1         X
     C                     Z-ADDX         Z       20
     C*    DO OPERATIONS MOVING CHARACTERS ONE AT A TIME
     C*    FROM RIGHT TO LEFT
     C                     DO   X
     C                     MOVE AMT,Z     AM,Y
     C                     SUB  1         Z
     C                     SUB  1         Y
     C                     END
     C                     END                             E001
     C*    SET INDEX TO 1
     C                     Z-ADD1         Y
     C*    REPLACE LEADING ZEROS WITH BLANK
     C           AM,Y      DOWEQ'0'
     C           Y         CABEQW         SR03A
     C                     MOVE ' '       AM,Y
     C                     ADD  1         Y
     C                     END
     C*  ** SAVE FIELD FROM ARRAY                                      ***
     C           SR03A     TAG
     C                     MOVEAAM        AMX    14
     C                     MOVE AMX       SAM    15
     C*                                                                ***
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT0656CCP6                                           S01408
     C*                                                                   S01408
     C                     ELSE                                           CSW020
     C*                                                                   CSW020
     C** If CSW020 is switched on perform decimal places prosessing       CSW020
     C                     CALL 'ZM0040'                                  CSW020
     C                     PARM WAMNT     ZAMNT  130                      CSW020
     C                     PARM CCY       ZCCY    3                       CSW020
     C                     PARM *BLANKS   ZSAMNT 15                       CSW020
     C                     PARM *BLANKS   ZSCCY   3                       CSW020
     C                     PARM *BLANKS   ZERR    1                       CSW020
     C*                                                                   CSW020
     C** Handle Database Error                                            CSW020
     C           ZERR      IFEQ '1'                                       CSW020
     C                     MOVEL'ZM0040  'DBFNAM           ************   CSW020
     C                     MOVELCCY       DBERKY           * DBERR 33 *   CSW020
     C                     MOVE '33'      DBERR#           ************   CSW020
     C                     EXSR DBERR                                     CSW020
     C*                                                                   CSW020
     C                     ELSE                                           CSW020
     C                     MOVE ZSAMNT    SAM                             CSW020
     C                     MOVE ZSCCY     M1RCCY                          CSW020
     C                     ENDIF                                          CSW020
     C*                                                                   CSW020
     C                     ENDIF                                          CSW020
     C                     ENDSR                           END SR03
     C*                                                                ***
     C********************************************************************
     C/EJECT
     C********************************************************************
     C*               SUBROUTINE 05                                    ***
     C*                                                                ***
     C*        FORMAT SETTLEMENT PARTY FOR TELEX REPORT                ***
     C*                                                                ***
     C           SR05      BEGSR                                       ***
     C*                                                                ***
     C*     INTIALISE O/P PARAMETERS FROM THIS SUBROUTINE
     C                     MOVE *BLANKS   OFSPT1 35
     C                     MOVE *BLANKS   OFSPT2 35
     C                     MOVE *BLANKS   OFSPT3 35
     C                     MOVE *BLANKS   OFSPT4 35
     C                     MOVE *BLANKS   OFSPT5 35
     C                     MOVE *BLANKS   OSTAG                           S01117
     C*                                                                   S01494
     C** Replaced by call FT0315                                          S01494
     C*                                                                   S01494
     C***********                                                      ***S01494
     C*****FULL*NOSTRO - PROCESSING                         **         ***S01494
     C***********ISPTP     IFEQ 'F'                                       S01494
     C*****SETUP*AND ACCESS PF/TABLETL                                 ***S01494
     C***********          MOVELISPTY1    TLCCNN  5        BUILD          S01494
     C***********          MOVEL'70'      TABTLK 12          KEY          S01494
     C***********          MOVE TLCCNN    TABTLK               KEY        S01494
     C***********TABTLK    CHAINTABFP                10                   S01494
     C************IN10     IFEQ '1'                         ))))))))))))))S01494
     C*********************MOVE 'TABFP'   DBFNAM            )))  DATA  )))S01310
     C***********          MOVEL'TABFP'   DBFNAM            )))  DAS01310 S01494
     C***********          MOVELTABTLK    DBERKY            )))  BASE  )))S01494
     C***********          MOVE '10'      DBERR#            ))) ERROR  )))S01494
     C***********          EXSR DBERR                       )))   10   )))S01494
     C***********          END                              ))))))))))))))S01494
     C***********          MOVE CNUM      CUSTNO                          S01494
     C***********          MOVELTLCCNN    OFSPT1                          S01494
     C***********          GOTO NADD                                      S01494
     C***********          END                                            S01494
     C***********                                                      ***S01494
     C*****NOSTRO NUMBER - PROCESSING                         **       ***S01494
     C***********ISPTP     IFEQ 'N'                                       S01494
     C*****SETUP*AND ACCESS PF/TABLETL                                 ***S01494
     C***********          MOVELISPTY1    TLNN    2        BUILD          S01494
     C***********          MOVELISCCY     TLCCNN             KEY          S01494
     C***********          MOVE TLNN      TLCCNN             KEY          S01494
     C***********          MOVEL'70'      TABTLK 12          KEY          S01494
     C***********          MOVE TLCCNN    TABTLK               KEY        S01494
     C***********TABTLK    CHAINTABFP                10                   S01494
     C************IN10     IFEQ '1'                         ))))))))))))))S01494
     C*********************MOVE 'TABFP'   DBFNAM            )))  DATA  )))S01310
     C***********          MOVEL'TABFP'   DBFNAM            )))  DAS01310 S01494
     C***********          MOVELTABTLK    DBERKY            )))  BASE  )))S01494
     C***********          MOVE '11'      DBERR#            ))) ERROR  )))S01494
     C***********          EXSR DBERR                       )))   11   )))S01494
     C***********          END                              ))))))))))))))S01494
     C***********          MOVE CNUM      CUSTNO                          S01494
     C***********          MOVELTLNN      OFSPT1                          S01494
     C***********          GOTO NADD                                      S01494
     C***********          END                                            S01494
     C***********                                                      ***S01494
     C*****RETAIL ACCOUNT - PROCESSING                         **      ***S01494
     C***********ISPTP     IFEQ 'R'                                       S01494
     C*****SETUP*AND ACCESS ACCOUNT NUMBER FILE                        ***S01494
     C***********          MOVELISPTY1    ACNUMK                          S01494
     C***********ACNUMK    CHAINACNUMA               11    ON, DELETED    S01494
     C************IN11     IFEQ '1'                         ))))))))))))))S01494
     C*********************MOVE 'ACNUM'   DBFNAM  5         )))  DATA  )))S01310
     C***********          MOVEL'ACNUMA'  DBFNAM            )))  DAS01310 S01494
     C***********          MOVELACNUMK    DBERKY 39         )))  BASE  )))S01494
     C***********          MOVE '12'      DBERR#  2         ))) ERROR  )))S01494
     C***********          EXSR DBERR                       )))   12   )))S01494
     C***********          END                              ))))))))))))))S01494
     C***********          MOVE CNUM      CUSTNO                          S01494
     C***********          MOVELACNUMK    OFSPT1                          S01494
     C***********          GOTO NADD                                      S01494
     C***********          END                                            S01494
     C***********                                                      ***S01494
     C*****FULL/PARTIAL ACCOUNT/CUSTOMER  - PROCESSING                 ***S01494
     C***********ISPTP     IFEQ 'G'                                       S01494
     C***********ISPTP     OREQ 'P'                                       S01494
     C***********ISPTP     OREQ 'C'                                       S01494
     C***********          MOVELISPTY1    CUSTNO                          S01494
     C***********          MOVELISPTY1    OFSPT1                          S01494
     C***********          GOTO NADD                                      S01494
     C***********          END                                            S01494
     C***********                                                      ***S01494
     C*****SETTLEMENT PARTY  - PROCESSING                              ***S01494
     C***********ISPTP     IFEQ 'S'                                       S01494
     C***********ISPTP     OREQ 'A'                                       S01494
     C***********          MOVELISPTY1    OFSPT1                          S01494
     C***********          MOVELISPTY2    OFSPT2                          S01494
     C***********          MOVELISPTY3    OFSPT3                          S01494
     C***********          MOVELISPTY4    OFSPT4                          S01494
     C***********          MOVELISPTY5    OFSPT5                          S01494
     C***********          GOTO SR05N                                     S01494
     C***********          END                                            S01494
     C*********************                                               S01310
     C***INTERMEDIARY*BANK*- PROCESSING                                   S01310
     C***********ISPTP*****IFEQ 'I'                                       S01310
     C***********ISPTY1****ANDNE*BLANKS                                   S01310
     C*********************MOVE 'D'       M2INTG                          S01310
     C*********************                                               S01310
     C*********************MOVELISPTY1    SHORTN 10                       S01310
     C***********SHORTN****CHAINSNAMEF               09                   S01310
     C*********************                                               S01310
     C************IN09*****IFEQ '0'                        SHORT NAME     S01310
     C*********************MOVE *BLANKS   ISPTY1                          S01310
     C*********************MOVELCNUM      ISPTY1                          S01310
     C*********************ELSE                                           S01310
     C*********************MOVE ISPTY1    WORK29 29                       S01310
     C***********WORK29****IFNE *BLANKS                                   S01310
     C*********************MOVE 'A'       M2INTG                          S01310
     C*********************MOVELISPTY1    OFSPT1                          S01310
     C*********************GOTO SR05N                                     S01310
     C*********************END                                            S01310
     C*******CHAIN*TO*CLINTCB FOR CSID                                    S01310
     C*********************MOVELISPTY1    KCUSNO                          S01310
     C*********************MOVE 'A'       KEYA                            S01310
     C***********CUSKEY****CHAINCLINTCBF             09                   S01310
     C*********************                                               S01310
     C************IN09*****IFEQ '1'                         ))))))))))))))S01310
     C*********************MOVE 'CLINT'   DBFNAM            )))  DATA  )))S01310
     C*********************MOVEL'      A' DBERKY            )))  BASE  )))S01310
     C*********************MOVELKCUSNO    DBERKY            )))  BASE  )))S01310
     C*********************MOVE '27'      DBERR#            ))) ERROR  )))S01310
     C*********************EXSR DBERR                       )))   27   )))S01310
     C*********************END                              ))))))))))))))S01310
     C*********************END                                            S01310
     C*********************MOVELCNUM      CUSTNO                          S01310
     C*********************ELSE                                           S01310
     C*********************GOTO SR05N                                     S01310
     C*********************END                                            S01310
     C*****INTERMEDIARY BANK - PROCESSING                          S01117 S01494
     C***********          MOVE '0'       *IN09                    S01117 S01494
     C***********ISPTP     IFEQ 'I'                                S01117 S01494
     C***********ISPTY1    ANDNE*BLANKS                            S01117 S01494
     C***********                                                  S01117 S01494
     C***********          MOVE *BLANKS   @KEY1                    S01117 S01494
     C***********          MOVELINBK      @KEY1                    S01117 S01494
     C***********          CALL 'AOCUSTR0'                         S01117 S01494
     C***********          PARM '*MSG   ' @RTCD                    S01117 S01494
     C***********          PARM '*KEY   ' @OPTN                    S01117 S01494
     C***********          PARM           @KEY1                    S01117 S01494
     C***********          PARM *BLANKS   @KYST                    S01117 S01494
     C***********SDCUST    PARM SDCUST    DSSDY                    S01117 S01494
     C***********                                                  S01117 S01494
     C***********@RTCD     IFNE *BLANKS                            S01117 S01494
     C***********INBK      CHAINSDCUSTL7             09            S01117 S01494
     C***********          END                                     S01117 S01494
     C***********                                                  S01117 S01494
     C************IN09     IFEQ '1'                                S01117 S01494
     C***********          MOVE '27'      DBERR#            * * * *S01117 S01494
     C***********          MOVELINBK      DBERKY            * DBERRS01117 S01494
     C***********          MOVEL'SDCUSTPD'DBFNAM            * * * *S01117 S01494
     C***********          EXSR DBERR                              S01117 S01494
     C***********                                                  S01117 S01494
     C***********          ELSE                                    S01117 S01494
     C***********                                                  S01117 S01494
     C***********BBCSID    IFNE *BLANKS                            S01117 S01494
     C***********          MOVELBBCSID    OFSPT1                   S01117 S01494
     C***********          MOVE 'A'       OSTAG                    S01117 S01494
     C***********          ELSE                                    S01117 S01494
     C***********          MOVELBBCNA1    OFSPT1                   S01117 S01494
     C***********          MOVELBBCNA2    OFSPT2                   S01117 S01494
     C***********          MOVELBBCNA3    OFSPT3                   S01117 S01494
     C***********          MOVELBBCNA4    OFSPT4                   S01117 S01494
     C***********          MOVE 'D'       OSTAG                    S01117 S01494
     C***********          END                                     S01117 S01494
     C***********                                                  S01117 S01494
     C***********          END                                     S01117 S01494
     C***********                                                  S01117 S01494
     C***********          END                                     S01117 S01494
     C***********                                                  S01494 S01494
     C***********NADD      TAG                                            S01494
     C***IF*TYPE*BLANK IGNORE                                             S01494
     C***********ISPTP     IFEQ ' '                        B001           S01494
     C***********          GOTO SR05N                                     S01494
     C***********          END                             E001           S01494
     C***SET*UP*CUSTOMER*KEY                                              S01310
     C*********************MOVELCUSTNO    KCUSNO                          S01310
     C*********************MOVE 'B'       KEYA                            S01310
     C***ACCESS*CLIENT*FILE                                               S01310
     C***********CUSKEY****CHAINCLINTCCF             80                   S01310
     C*********************                                               S01310
     C************IN80*****IFEQ '1'                         ))))))))))))))S01310
     C*********************MOVE 'CLINT'   DBFNAM            )))  DATA  )))S01310
     C*********************MOVEL'      B' DBERKY            )))  BASE  )))S01310
     C*********************MOVELKCUSNO    DBERKY            )))  BASE  )))S01310
     C*********************MOVE '16'      DBERR#            ))) ERROR  )))S01310
     C*********************EXSR DBERR                       )))   16   )))S01310
     C*********************END                              ))))))))))))))S01310
     C*********************MOVE CNA1      OFSPT2                          S01310
     C*********************MOVE CNA2      OFSPT3                          S01310
     C*********************MOVE CNA3      OFSPT4                          S01310
     C*********************MOVE CNA4      OFSPT5                          S01310
      ***********                                                  S01310 S01494
      ***Access*SDCUSTPD with the customer number.                 S01310 S01494
      ***********                                                  S01310 S01494
     C***********ISPTP     IFNE 'I'                                S01117 S01494
     C***********          MOVE *BLANKS   @KEY1                    S01310 S01494
     C***********ISPTP*****IFEQ 'I'                                 S01310S01117
     C*********************MOVELISPTY1    @KEY1                     S01310S01117
     C*********************ELSE                                     S01310S01117
     C***********          MOVELCUSTNO    @KEY1                    S01310 S01494
     C*********************END                                      S01310S01117
     C***********          CALL 'AOCUSTR0'                         S01310 S01494
     C***********          PARM '*MSG   ' @RTCD                    S01310 S01494
     C***********          PARM '*KEY   ' @OPTN                    S01310 S01494
     C***********          PARM           @KEY1  10                S01310 S01494
     C***********          PARM *BLANKS   @KYST   7                S01310 S01494
     C***********SDCUST    PARM SDCUST    DSSDY                    S01310 S01494
      ***********                                                  S01310 S01494
      ***Customer record not found - Error                         S01310 S01494
      ***********                                                  S01310 S01494
     C***********@RTCD     IFNE *BLANKS                            S01310 S01494
     C***********          MOVE '016'     DBERR#             * * * S01310 S01494
     C***********          MOVEL@KEY1     DBERKY             * DBERS01310 S01494
     C***********          MOVEL'SDCUSTPD'DBFNAM             * * * S01310 S01494
     C***********          EXSR DBERR                              S01310 S01494
     C***********          END                                     S01310 S01494
      ***********                                                  S01310 S01494
     C***********BBCSID    IFNE *BLANKS                            S01310 S01494
     C***********          MOVELBBCSID    OFSPT1                   S01310 S01494
     C***********          MOVE 'A'       OSTAG                    S01310 S01494
     C***********          ELSE                                    S01310 S01494
     C***********          MOVELBBCNA1    OFSPT1                   S01310 S01494
     C***********          MOVELBBCNA2    OFSPT2                   S01310 S01494
     C***********          MOVELBBCNA3    OFSPT3                   S01310 S01494
     C***********          MOVELBBCNA4    OFSPT4                   S01310 S01494
     C***********          MOVE 'D'       OSTAG                    S01310 S01494
     C***********          END                                     S01310 S01494
     C***********                                                  S01117 S01494
     C***********          END                                     S01117 S01494
      ***********                                                  S01310 S01494
     C***********ISPTP*****IFEQ 'I'                                       S01310
     C***********CSID******ANDNE*BLANKS                                   S01310
     C*********************MOVE *BLANKS   OFSPT1                          S01310
     C*********************MOVE *BLANKS   OFSPT2                          S01310
     C*********************MOVE *BLANKS   OFSPT3                          S01310
     C*********************MOVE *BLANKS   OFSPT4                          S01310
     C*********************MOVE *BLANKS   OFSPT5                          S01310
     C*********************MOVELCSID      OFSPT1                          S01310
     C*********************MOVE 'A'       M2INTG                          S01310
     C*********************END                                            S01310
     C*                                                                ***
     C*                                                                   S01494
     C** Use FT0315 to format text for D address type                     S01494
     C*                                                                   S01494
     C*                                                                   S01494
     C** Set up general parameters                                        S01494
     C*                                                                   S01494
     C                     CLEARW8FT                                      S01494
     C                     MOVEL*BLANKS   W8STMT                          S01494
     C                     MOVEL##PGM     W8CPGM                          S01494
     C                     MOVEL'*MSG  '  W8ACT                           S01494
     C                     Z-ADD5         W8NLIN                          S01494
     C                     MOVEL'Y'       W8MTXT                          S01494
     C*                                                                   S01494
     C** Format data to be translated                                     S01494
     C*                                                                   S01494
     C                     MOVELISPTP     W8TYPE                          S01494
     C                     MOVELISCCY     W8CCY                           S01494
     C                     MOVEL*BLANKS   W8LINS                          S01494
     C                     MOVELISPTY1    ADCHK1                          S01494
     C                     MOVELISPTY2    ADCHK2                          S01494
     C                     MOVELISPTY3    ADCHK3                          S01494
     C                     MOVELISPTY4    ADCHK4                          S01494
     C                     MOVELISPTY5    ADCHK5                          S01494
     C           W8TYPE    IFEQ 'P'                                       S01494
     C           ISBRCA    ANDNE*BLANKS                                   S01494
     C                     MOVELISBRCA    ADPBRC                          S01494
     C                     END                                            S01494
     C                     MOVELADDRSS    W8LINS                          S01494
     C*                                                                   S01494
     C** Call expansion program                                           S01494
     C*                                                                   S01494
     C                     CALL 'FT0315'               1111               S01494
     C                     PARM           W8RTN   7                       S01494
     C                     PARM           W8FT                            S01494
     C                     PARM           W8LINS256                       S01494
     C                     PARM           W8RPT 256                       S01494
     C                     PARM           W8MSG 256                       S01494
     C                     PARM           W8SCR 256                       S01494
     C*                                                                   S01494
     C** Check if database error occurred                                 S01494
     C*                                                                   S01494
     C           *IN11     IFEQ '1'                                       S01494
     C           W8RTN     ORNE *BLANKS                                   S01494
     C                     MOVE '091'     DBERR#           ************   S01494
     C                     MOVEL'*CALL'   DBERKY           * DBERR 91 *   S01494
     C                     MOVEL'FT0315'  DBFNAM           ************   S01494
     C                     EXSR DBERR                                     S01494
     C                     END                                            S01494
     C*                                                                   S01494
     C                     MOVELW8MSG     ADDRSS                          S01494
     C                     MOVELADCHK1    OFSPT1                          S01494
     C                     MOVELADCHK2    OFSPT2                          S01494
     C                     MOVELADCHK3    OFSPT3                          S01494
     C                     MOVELADCHK4    OFSPT4                          S01494
     C                     MOVELADCHK5    OFSPT5                          S01494
     C           SR05N     ENDSR                           END SR05
     C*                                                                ***
     C********************************************************************
     C/EJECT
     C********************************************************************
     C*               SUBROUTINE 06                                    ***
     C*                                                                ***
     C*         DETERMINE AND FORMAT AMOUNT OUTGOING                   ***
     C*         PAYMENTS                                               ***
     C*                                                                ***
     C           SR06      BEGSR                                       ***
     C*                                                                ***
     C*  **     PUT 'AMNT' INTO THE WORK FIELD    **                   ***
     C*                                                                ***
     C                     Z-ADDAMNT      WAMNT  130
     C*                                                                ***
     C*  ** FORMAT THE AMOUNT USING PROCEDURE SR03                     ***
     C                     EXSR SR03
     C*                                                                   CSW020
     C**    Access Currency Details                                       CSW020
     C           CSW020    IFEQ 'Y'                                       CSW020
     C*                                                                   CSW020
     C                     CALL 'AOCURRR0'                                CSW020
     C                     PARM '*MSG   ' @RTCD   7                       CSW020
     C                     PARM '*KEY   ' @OPTN   7                       CSW020
     C                     PARM CCY       @CCY    3                       CSW020
     C           SDCURR    PARM SDCURR    DSSDY                           CSW020
     C*                                                                   CSW020
     C                     MOVE A6CYNM    CCNM                            CSW020
     C           A6NBDP    COMP 2                    33  32               CSW020
     C           A6NBDP    COMP 1                      3031               CSW020
     C*                                                                   CSW020
     C                     ENDIF                                          CSW020
     C*                                                                ***
     C                     ENDSR                           END SR06
     C*                                                                ***
     C********************************************************************
     C/EJECT
     C********************************************************************S01310
     C****************SUBROUTINE 07                                    ***S01310
     C**********OUTPUT*7*RECORDS TO THE OUTGOING SWIFT                 ***S01310
     C**********MESSAGES*FILE (PF/MSMSOPF).                            ***S01310
     C**********OUTPUT*A*RECORD TO THE SWIFT REFERENCE                 ***S01310
     C**********FILE*(PF/MSIXOPF). (FOR MT210)                         ***S01310
     C*********************                                            ***S01310
     C***********SR07******BEGSR                                       ***S01310
     C*********************                                            ***S01310
     C****FIELDS*COMMON*TO*RECORDS TO BE OUTPUTTED                     ***S01310
     C*********************MOVE 'P'       MSMI                         ***S01310
     C*********************MOVELNT1RS1    TNRF                         ***S01310
     C*********************MOVE NTXPDT    PTDL                         ***S01310
     C*********************                                            ***S01310
     C****FIRST*RECORD*****                                            ***S01310
     C*********************MOVELMT2101    MDTA                         ***S01310
     C*********************WRITEMSMSOPFF               42  ON, D/B ERROR  S01310
     C************IN42*****CABEQ'1'       WRERR                           S01310
     C*********************                                            ***S01310
     C****SECOND*RECORD****                                            ***S01310
     C*********************MOVELMT2102    MDTA                         ***S01310
     C*********************WRITEMSMSOPFF               42  ON, D/B ERROR  S01310
     C************IN42*****CABEQ'1'       WRERR                           S01310
     C*********************                                            ***S01310
     C****THIRD*RECORD*****                                            ***S01310
     C*********************MOVELMT2103    MDTA                         ***S01310
     C*********************WRITEMSMSOPFF               42  ON, D/B ERROR  S01310
     C************IN42*****CABEQ'1'       WRERR                           S01310
     C*********************                                            ***S01310
     C****FOURTH*RECORD****                                            ***S01310
     C*********************MOVELMT2104    MDTA                         ***S01310
     C*********************WRITEMSMSOPFF               42  ON, D/B ERROR  S01310
     C************IN42*****CABEQ'1'       WRERR                           S01310
     C*********************                                            ***S01310
     C*********************ADD  4         P3NO5                           S01117
     C*********************ADD  4         AUNO5                     S01117S01310
     C*********************                                            ***S01310
     C***FORMAT*AND*OUTPUT*A RECORD TO THE SWIFT                       ***S01310
     C***REFERENCE*FILE*(PF/MSIXOPF)                                   ***S01310
     C*********************MOVE 'D'       RECI                            S01310
     C*********************MOVE 'P'       MSMI                            S01310
     C*********************MOVE FTCS      MSTS                            S01310
     C*********************MOVE RUNA      LADT                            S01310
     C*********************TIME           LATM                            S01310
     C*********************MOVE PYTP      TNTP                            S01310
     C*********************MOVE PYST      SBTP                            S01310
     C*********************MOVE '210'     MTPY                            S01310
     C*********************MOVE SWPC      MSGP                            S01310
     C*********************MOVE SCRNM2    RPNM                            S01310
     C*********************MOVE SCTWN2    RPTN                            S01310
     C*********************TIME           MGTM                            S01310
     C*********************MOVE RUNA      MGDT                            S01310
     C*********************MOVE MTD210    STID                            S01310
     C*********************MOVE RECAD2    DTID                            S01310
     C*********************MOVE SBICN     SECN                            S01310
     C*********************MOVE SCUSN2    DECN                            S01310
     C*********************MOVE SWT210    SWTX                            S01310
     C***********AUP2******IFNE *BLANK                                    S01310
     C*********************MOVE AUP2      RUSR                            S01310
     C*********************ELSE                                           S01310
     C*********************MOVE AUP1      RUSR                            S01310
     C*********************END                                            S01310
     C*********************MOVE SRUNA     RELD                            S01310
     C*********************MOVE LCHT      RELT                            S01310
     C*********************MOVE M1AMNT    AMTS                    BL0015  S01310
     C*********************MOVE VDATD3    SVDT                    BL0015  S01310
     C*********************MOVE DEST      NSTR                    BL0015  S01310
     C*********************MOVELCCY       NSTR                    BL0015  S01310
     C*********************MOVE 'Y'       TSKS                    BL0015  S01310
     C*********************MOVE BRCAA     BRCA                      S01117S01310
     C**IF*MULTIBRANCH*INDICATOR FROM RUNDAT ACTIVE                 S01117S01310
     C************IN60*****IFEQ '1'                                 S01117S01310
     C***********BRCAA*****IFNE ORBR                                S01117S01310
     C*********************MOVE ORBR      OTHB                      S01117S01310
     C**MOVE*"ORIGINATING*BRANCH" TO 'OTHER BRANCH TYPE'(OTHT)      S01117S01310
     C*********************MOVE ' BRANCH"'FLD1   20                 S01117S01310
     C*********************MOVEL'"ORIGINA'FLD2   12                 S01117S01310
     C*********************MOVE 'TING'    FLD2                      S01117S01310
     C*********************MOVELFLD2      FLD1                      S01117S01310
     C*********************MOVE FLD1      OTHT                      S01117S01310
     C*********************                                         S01117S01310
     C*********************ELSE                                     S01117S01310
     C*********************MOVE *BLANKS   OTHB                      S01117S01310
     C*********************MOVE *BLANKS   OTHT                      S01117S01310
     C*********************END                                      S01117S01310
     C**IF*MULTIBRANCH*INDICATOR FROM RUNDAT NOT ACTIVE             S01117S01310
     C*********************ELSE                                     S01117S01310
     C*********************MOVE *BLANKS   OTHB                      S01117S01310
     C*********************MOVE *BLANKS   OTHT                      S01117S01310
     C*********************END                                      S01117S01310
     C*********************WRITEMSIXOPFF               41  ON, D/B ERROR  S01310
     C**N41****************ADD  1         P3NO3                     S01117S01310
     C**N41****************ADD  1         AUNO3                     S01117S01310
     C*********************GOTO SR07N                                     S01310
     C*********************                                            ***S01310
     C***********WRERR*****TAG                              ))))))))))))))S01310
     C*********************MOVE 'MSMSOPFF'DBFNAM            )))  DATA  )))S01310
     C*********************MOVELNT2REF    DBERKY            )))  BASE  )))S01310
     C*********************MOVE '22'      DBERR#            ))) ERROR  )))S01310
     C*********************EXSR DBERR                       )))   22   )))S01310
     C*********************                                 ))))))))))))))S01310
     C***********SR07N*****ENDSR                           END SR07       S01310
     C*********************                                            ***S01310
     C********************************************************************S01310
     C*/EJECT**************                                               S01310
     C********************************************************************S01310
     C****************SUBROUTINE 08                                    ***S01310
     C**********OUTPUT*7*RECORDS TO THE OUTGOING SWIFT                 ***S01310
     C**********MESSAGES*FILE (PF/MSMSOPF).                            ***S01310
     C**********OUTPUT*A*RECORD TO THE SWIFT REFERENCE                 ***S01310
     C**********FILE*(PF/MSIXOPF).                                     ***S01310
     C*********************                                            ***S01310
     C***********SR08******BEGSR                                       ***S01310
     C*********************                                            ***S01310
     C****FIELDS*COMMON*TO*RECORDS TO BE OUTPUTTED                     ***S01310
     C*********************MOVE MXMIND    MSMI                         ***S01310
     C*********************Z-ADD1         SWSN                            S01310
     C*********************MOVE TFRF      PREFS  14                       S01310
     C*********************MOVE SWSN      TNRF                            S01310
     C*********************MOVELPREFS     TNRF                            S01310
     C*********************MOVE MXDFLG    PTDL                         ***S01310
     C*********************                                            ***S01310
     C****FIRST*RECORD*****                                            ***S01310
     C*********************MOVELMT2001    MDTA                         ***S01310
     C*********************WRITEMSMSOPFF               42  ON, D/B ERROR  S01310
     C************IN42*****CABEQ'1'       WRTERR                          S01310
     C*********************                                            ***S01310
     C****SECOND*RECORD****                                            ***S01310
     C*********************MOVELMT2002    MDTA                         ***S01310
     C*********************WRITEMSMSOPFF               42  ON, D/B ERROR  S01310
     C************IN42*****CABEQ'1'       WRTERR                          S01310
     C*********************                                            ***S01310
     C****THIRD*RECORD*****                                            ***S01310
     C*********************MOVELMT2003    MDTA                         ***S01310
     C*********************WRITEMSMSOPFF               42  ON, D/B ERROR  S01310
     C************IN42*****CABEQ'1'       WRTERR                          S01310
     C*********************                                            ***S01310
     C****FOURTH*RECORD****                                            ***S01310
     C*********************MOVELMT2004    MDTA                         ***S01310
     C*********************WRITEMSMSOPFF               42  ON, D/B ERROR  S01310
     C************IN42*****CABEQ'1'       WRTERR                          S01310
     C*********************                                            ***S01310
     C*********************ADD  4         P3NO2                           S01117
     C*********************ADD  4         AUNO2                     S01117S01310
     C*********************                                            ***S01310
     C***FORMAT*AND*OUTPUT*A RECORD TO THE SWIFT                       ***S01310
     C***REFERENCE*FILE*(PF/MSIXOPF)                                   ***S01310
     C*********************MOVE 'D'       RECI                            S01310
     C*********************MOVE 'P'       MSMI                            S01310
     C*********************MOVE FTCS      MSTS                            S01310
     C*********************MOVE RUNA      LADT                            S01310
     C*********************TIME           LATM                            S01310
     C*********************MOVE PYTP      TNTP                            S01310
     C*********************MOVE PYST      SBTP                            S01310
     C*********************MOVE '200'     MTPY                            S01310
     C*********************MOVE SWPC      MSGP                            S01310
     C*********************MOVE SCRNM     RPNM                            S01310
     C*********************MOVE SCTWN     RPTN                            S01310
     C*********************TIME           MGTM                            S01310
     C*********************MOVE RUNA      MGDT                            S01310
     C*********************MOVE MTD200    STID                            S01310
     C*********************MOVE RECADD    DTID                            S01310
     C*********************MOVE SBICN     SECN                            S01310
     C*********************MOVE SCUSNO    DECN                            S01310
     C*********************MOVE SWT200    SWTX                            S01310
     C***********AUP2******IFNE *BLANK                                    S01310
     C*********************MOVE AUP2      RUSR                            S01310
     C*********************ELSE                                           S01310
     C*********************MOVE AUP1      RUSR                            S01310
     C*********************END                                            S01310
     C*********************MOVE SRUNA     RELD                            S01310
     C*********************MOVE LCHT      RELT                            S01310
     C*********************MOVE M1AMNT    AMTS                            S01310
     C*********************MOVE VDATD3    SVDT                            S01310
     C*********************MOVE DEST      NSTR                            S01310
     C*********************MOVELCCY       NSTR                            S01310
     C*********************MOVE 'Y'       TSKS                            S01310
     C*********************MOVE BRCAA     BRCA                      S01117S01310
     C**IF*MULTIBRANCH*INDICATOR FROM RUNDAT ACTIVE                 S01117S01310
     C************IN60*****IFEQ '1'                                 S01117S01310
     C***********BRCAA*****IFNE ORBR                                S01117S01310
     C*********************MOVE ORBR      OTHB                      S01117S01310
     C**MOVE*"ORIGINATING*BRANCH" TO 'OTHER BRANCH TYPE'(OTHT)      S01117S01310
     C*********************MOVE ' BRANCH"'FLD1   20                 S01117S01310
     C*********************MOVEL'"ORIGINA'FLD2   12                 S01117S01310
     C*********************MOVE 'TING'    FLD2                      S01117S01310
     C*********************MOVELFLD2      FLD1                      S01117S01310
     C*********************MOVE FLD1      OTHT                      S01117S01310
     C*********************                                         S01117S01310
     C*********************ELSE                                     S01117S01310
     C*********************MOVE *BLANKS   OTHB                      S01117S01310
     C*********************MOVE *BLANKS   OTHT                      S01117S01310
     C*********************END                                      S01117S01310
     C**IF*MULTIBRANCH*INDICATOR FROM RUNDAT NOT ACTIVE             S01117S01310
     C*********************ELSE                                     S01117S01310
     C*********************MOVE *BLANKS   OTHB                      S01117S01310
     C*********************MOVE *BLANKS   OTHT                      S01117S01310
     C*********************END                                      S01117S01310
     C*********************WRITEMSIXOPFF               41  ON, D/B ERROR  S01310
     C************IN41*****IFEQ '1'                         ))))))))))))))S01310
     C*********************MOVE 'MSIXOPFF'DBFNAM            )))  DATA  )))S01310
     C*********************MOVELMXTREF    DBERKY            )))  BASE  )))S01310
     C*********************MOVE '17'      DBERR#            ))) ERROR  )))S01310
     C*********************EXSR DBERR                       )))   17   )))S01310
     C*********************END                              ))))))))))))))S01310
     C*********************                                               S01310
     C**N41****************ADD  1         P3NO3                     S01117S01310
     C**N41****************ADD  1         AUNO3                     S01117S01310
     C*********************GOTO SR08N                                     S01310
     C*********************                                            ***S01310
     C***********WRTERR****TAG                              ))))))))))))))S01310
     C*********************MOVE 'MSMSOPFF'DBFNAM            )))  DATA  )))S01310
     C*********************MOVELMXTREF    DBERKY            )))  BASE  )))S01310
     C*********************MOVE '05'      DBERR#            ))) ERROR  )))S01310
     C*********************EXSR DBERR                       )))   05   )))S01310
     C*********************                                 ))))))))))))))S01310
     C***********SR08N*****ENDSR                           END SR08       S01310
     C*********************                                            ***S01310
     C********************************************************************S01310
     C*/EJECT**************                                               S01310
     C*****************************************************************   S01310
     C*   OMSG - output correctly generated messages                  *   S01310
     C*   Called by - main process                                    *   S01310
     C*   Calls -                                                     *   S01310
     C*****************************************************************   S01310
     C*                                                                   S01310
     C           OMSG      BEGSR                                          S01310
      *                                                                   S01310
      **  Write multiple occurrence data structure to MGOMSGPD            S01310
      *                                                                   S01310
     C                     Z-ADD1         Q       20                      S01310
     C           Q         OCUR MULT                                      S01310
      *                                                                   S01310
     C           Q         DOWLE40                                        S01310
     C           MFLD      ANDNE*BLANKS                                   S01310
     C                     WRITEMGOMSGD0               42                 S01310
      *                                                                   S01310
      **  Error on write to PF/MGOMSGPD (message data file)               S01310
      *                                                                   S01310
     C           *IN42     IFEQ '1'                                       S01310
     C                     MOVE '012'     DBERR#           * * * * * * * *S01310
     C                     MOVEL'       ' DBERKY           *  DBERR 012  *S01310
     C                     MOVEL'MGOMSGPD'DBFNAM           * * * * * * * *S01310
     C                     EXSR DBERR                                     S01310
     C                     END                                            S01310
      *                                                                   S01310
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     END                                            S01310
      *                                                                   138077
      **  Write multiple occurrence data structure to MGOEXTPD            138077
      *                                                                   138077
     C                     Z-ADD1         V       20                      138077
     C           V         OCUR EXTN                                      138077
     C           V         DOWLE20                                        138077
     C           MCSI      ANDNE*BLANKS                                   138077
     C                     WRITEMGOEXTD0               43                 138077
      *                                                                   138077
      **  Error on write to PF/MGOEXTPD (message data extension file)     138077
      *                                                                   138077
     C           *IN43     IFEQ '1'                                       138077
     C                     MOVE '043'     DBERR#           * * * * * * * *138077
     C                     MOVEL'        'DBERKY           *  DBERR 043  *138077
     C                     MOVEL'MGOEXTPD'DBFNAM           * * * * * * * *138077
     C                     EXSR DBERR                                     138077
     C                     END                                            138077
     C                     ADD  1         V                               138077
     C           V         OCUR EXTN                                      138077
     C                     ENDDO                                          138077
      *                                                                   S01310
     C                     ENDSR                                          S01310
     C/EJECT                                                              S01310
      *****************************************************************   S01310
      *   WREF1- Write reference record to PF/MGOREFPD for MT210's.   *   S01310
      *   Called by - Main Processing.                                *   S01310
      *   Calls     -                                                 *   S01310
      *****************************************************************   S01310
      *                                                                   S01310
     C           WREF1     BEGSR                                          S01310
      *                                                                   S01310
     C                     MOVE *BLANKS   SYTM                            S01310
     C                     MOVEL'FT'      MODI                            S01310
     C                     MOVELTRNA      TRNO                            S01310
     C                     MOVE *BLANKS   TRNF                            S01310
     C                     MOVE *BLANKS   TRNM                            S01310
     C                     MOVELTFRF      MTRN                            S01310
     C                     MOVE PYTP      TNTP                            S01310
     C                     MOVE PYST      SBTP                            S01310
     C                     MOVE *BLANKS   EVTP                            S01310
      *                                                                   S01310
     C                     MOVEL*BLANKS   NWRK                            S01310
     C                     MOVEL*BLANKS   NWSN                            S01310
     C                     MOVEL*BLANKS   NWDS                            S01310
     C                     MOVELSNWRK2    NWRK                            S01310
     C                     MOVELSNWSN2    NWSN                            S01310
     C                     MOVELSNWDS2    NWDS                            S01310
     C                     MOVELSMGST2    MGST                            S01310
     C                     MOVELSMGSG2    MGSG                            S01310
     C                     MOVELSBICN     SECN                            S01310
     C                     MOVELSCUSN2    DECN                            S01310
     C                     MOVEL*BLANKS   NWBN                            S01310
     C                     MOVE '210'     MTPY                            S01310
     C           SWPC      IFEQ 1                                         S01117
     C                     MOVE 'U'       MPRY                            S01117
     C                     ELSE                                           S01117
     C           SWPC      IFEQ 2                                         S01117
     C                     MOVE 'N'       MPRY                            S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C                     MOVEL*BLANKS   LSCC                            S01310
     C                     MOVEL*BLANKS   PTST                            S01310
     C                     MOVEL*BLANKS   CARQ                            S01310
     C                     MOVEL*BLANKS   MPDE                            S01310
     C                     MOVEL@HRDT     HRDT                            S01310
     C                     TIME           MGTM                            S01310
     C                     MOVE RUNA      LADT                            S01310
     C                     MOVE MGTM      LATM                            S01310
      *                                                                                       CSD015
      ** If Watch List Checking is Applied and CSW025 is off,                                 CSD015
      ** do watch processing.                                                                 CSD015
      *                                                                                       CSD015
     C           CSD015    IFEQ 'Y'                                                           CSD015
     C           W1EWLC    ANDEQ'Y'                                                           222385
     C           CSW025    ANDEQ'N'                                                           CSD015
     C                     EXSR SRWTCH                                                        CSD015
     C                     ENDIF                                                              CSD015
      *                                                                   S01310
      **  Convert run date to YYMMDD                                      S01310
      *                                                                   S01310
     C                     CALL 'ZM0060'                                  S01310
     C                     PARM RUND      ZMDAY   50                      S01310
     C                     PARM           ZMDATE  6                       S01310
     C                     MOVE ZMDATE    MGDE                            S01310
      *                                                                   S01310
      *                                                                   S01310
      ** Set-up Message Generation  Century flag                          113352
      *                                                                   113352
     C                     MOVELMGDE      YY      20                      113352
     C           YY        IFLT 72                                        113352
     C                     MOVE '2'       CIND                            113352
     C                     ELSE                                           113352
     C                     MOVE '1'       CIND                            113352
     C                     ENDIF                                          113352
     C           MGST      IFEQ 'RSND'                                    S01310
     C                     MOVE SRUNA     RELD                            S01310
     C                     MOVE LATM      RELT                            S01310
     C                     END                                            S01310
      *                                                                   S01310
     C           AUP2      IFNE *BLANK                                    S01310
     C                     MOVE AUP2      RUSR                            S01310
     C                     ELSE                                           S01310
     C                     MOVE AUP1      RUSR                            S01310
     C                     END                                            S01310
     C                     MOVEL*BLANKS   RWSN                            S01310
     C                     MOVELM1AMNT    AMTS                            S01310
     C*********************MOVEL*BLANKS   AMTX                      S01310S01117
     C                     MOVELM1AMNT    AMTX                            S01117
     C                     MOVELVDATD3    SVDT                            S01310
      *                                                                   164663
      ** Setup century indicator CINDV for value date SVDT                164663
      *                                                                   164663
     C           SVDT      IFEQ *BLANK                                    164663
     C                     MOVE *BLANK    CINDV                           164663
     C                     ELSE                                           164663
     C                     MOVELSVDT      YY      20                      164663
     C           YY        IFLT 72                                        164663
     C                     MOVE '2'       CINDV                           164663
     C                     ELSE                                           164663
     C                     MOVE '1'       CINDV                           164663
     C                     ENDIF                                          164663
     C                     ENDIF                                          164663
      *                                                                   164663
     C*********************MOVELM1RCCY    CCY                       S01310S01117
     C**********           MOVEL*BLANKS   NSNO                                         S01310 262185
     C                     MOVE ACBN      NSNO                                                262185
     C                     MOVEL*BLANKS   SACN                            S01310
     C                     MOVEL*BLANKS   AORR                            S01310
     C                     MOVEL*BLANKS   DESI                            S01310
      *                                                                   S01310
      **  Branch details                                                  S01310
      *                                                                   S01310
     C                     MOVE BRCAA     BRCA                            S01310
      * IF MULTIBRANCH INDICATOR FROM RUNDAT ACTIVE                       S01310
     C           *IN60     IFEQ '1'                                       S01310
     C           BRCAA     IFNE ORBR                                      S01310
     C                     MOVE ORBR      ORBR    3                       S01310
     C                     MOVE ORBR      OTHB                            S01310
      * MOVE "ORIGINATING BRANCH" TO 'OTHER BRANCH TYPE'(OTHT)            S01310
     C                     MOVE ' BRANCH"'FLD1   20                       S01310
     C                     MOVEL'"ORIGINA'FLD2   12                       S01310
     C                     MOVE 'TING'    FLD2                            S01310
     C                     MOVELFLD2      FLD1                            S01310
     C                     MOVE FLD1      OTHT                            S01310
      *                                                                   S01310
     C                     ELSE                                           S01310
     C                     MOVE *BLANKS   OTHB                            S01310
     C                     MOVE *BLANKS   OTHT                            S01310
     C                     END                                            S01310
      * IF MULTIBRANCH INDICATOR FROM RUNDAT NOT ACTIVE                   S01310
     C                     ELSE                                           S01310
     C                     MOVE *BLANKS   OTHB                            S01310
     C                     MOVE *BLANKS   OTHT                            S01310
     C                     END                                            S01310
     C                     MOVE *BLANKS   RCBR                            S01310
      *                                                                   S01310
     C                     MOVE *BLANKS   NETI                            S01310
     C*********************MOVE *BLANKS   DELC                      S01310S01117
     C*                                                                   S01117
     C*   READ SDCURRPD FOR DELIVERY NOTIFICATION AND NON-DELIVERY        S01117
     C*     WARNING FLAGS                                                 S01117
     C                     CALL 'AOCURRR0'                                S01117
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM CCY       @CCY    3                       S01117
     C           SDCURR    PARM SDCURR    DSSDY                           S01117
     C*                                                                   S01117
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     MOVE '33'      DBERR#             *************S01117
     C                     MOVEL@CCY      DBERKY             * DBERR 033 *S01117
     C                     MOVEL'SDCURRPD'DBFNAM             *************S01117
     C                     EXSR DBERR                                     S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C           A6NDWR    IFEQ 'Y'                                       S01117
     C           A6DNOR    ANDEQ'Y'                                       S01117
     C                     MOVE '3'       DELC                            S01117
     C                     END                                            S01117
     C           A6NDWR    IFNE 'Y'                                       S01117
     C           A6DNOR    ANDEQ'Y'                                       S01117
     C                     MOVE '2'       DELC                            S01117
     C                     END                                            S01117
     C           A6NDWR    IFEQ 'Y'                                       S01117
     C           A6DNOR    ANDNE'Y'                                       S01117
     C                     MOVE '1'       DELC                            S01117
     C                     END                                            S01117
     C           A6NDWR    IFNE 'Y'                                       S01117
     C           A6DNOR    ANDNE'Y'                                       S01117
     C***********          MOVE '0'       DELC                      S01117068367
     C                     MOVEL*BLANKS   DELC                            068367
     C                     END                                            S01117
      *                                                                   068367
      * Ensure that message priority and delivery notification are        068367
      * valid combination :                                               068367
      * 1. for MPRY = 'U' DELC must be '1' or '3',                        068367
      * 2. for MPRY = 'N' DELC must be ' ' or '2'.                        068367
      *                                                                   068367
     C           MPRY      IFEQ 'U'                                       068367
     C           DELC      ANDEQ' '                                       068367
     C           MPRY      OREQ 'U'                                       068367
     C           DELC      ANDEQ'2'                                       068367
     C                     MOVEL'1'       DELC                            068367
     C                     END                                            068367
      *                                                                   068367
     C           MPRY      IFEQ 'N'                                       068367
     C           DELC      ANDEQ'1'                                       068367
     C           MPRY      OREQ 'N'                                       068367
     C           DELC      ANDEQ'3'                                       068367
     C                     MOVEL'2'       DELC                            068367
     C                     END                                            068367
     C*                                                                   S01117
     C                     MOVE *BLANKS   DYST                            S01310
     C                     MOVE *BLANKS   RSID                            S01310
     C                     MOVE *BLANKS   MSE1                            S01310
     C                     MOVE *BLANKS   ELIN                            S01310
     C                     MOVE *BLANKS   SSAC                            S01310
     C                     MOVE *BLANKS   MIR                             S01310
     C                     MOVE *BLANKS   TSKS                            S01310
     C                     MOVE *BLANKS   TSKY                            S01310
     C/COPY WNCPYSRC,FT0656C001
      *                                                                   S01310
     C                     MOVEL@CHG      AORR                                                CSW025
     C                     WRITEMGOREFD0               41                 S01310
      *                                                                   S01310
      **  Error on write to PF/MGOREFPD (message reference file)          S01310
      *                                                                   S01310
     C           *IN41     IFEQ '1'                                       S01310
     C                     MOVE '14'      DBERR#           * * * * * * * *S01310
     C                     MOVEL'       ' DBERKY           *  DBERR 014  *S01310
     C                     MOVEL'MGOREFPD'DBFNAM           * * * * * * * *S01310
     C                     EXSR DBERR                                     S01310
     C                     END                                            S01310
     C                     ENDSR                                          S01310
     C*                                                                   S01310
     C/EJECT                                                              S01310
      *****************************************************************   S01310
      *   WREF2- Write reference record to PF/MGOREFPD for MT200's.   *   S01310
      *   Called by - Main Processing.                                *   S01310
      *   Calls     - INTF - Initialise non-constant fields.          *   S01310
      *****************************************************************   S01310
      *                                                                   S01310
     C           WREF2     BEGSR                                          S01310
      *                                                                   S01310
     C                     MOVE *BLANKS   SYTM                            S01310
     C                     MOVEL'FT'      MODI                            S01310
     C                     MOVELTRNB      TRNO                            S01310
     C                     MOVE *BLANKS   TRNF                            S01310
     C                     MOVE *BLANKS   TRNM                            S01310
     C                     MOVELTFRF      MTRN                            S01310
     C                     MOVE PYTP      TNTP                            S01310
     C                     MOVE PYST      SBTP                            S01310
     C                     MOVE *BLANKS   EVTP                            S01310
      *                                                                   S01310
     C                     MOVEL*BLANKS   NWRK                            S01310
     C                     MOVEL*BLANKS   NWSN                            S01310
     C                     MOVEL*BLANKS   NWDS                            S01310
     C                     MOVELSNWRK     NWRK                            S01310
     C                     MOVELSNWSN     NWSN                            S01310
     C/COPY WNCPYSRC,FTH00604
     C                     MOVELSNWDS     NWDS                            S01310
     C                     MOVELSMGST     MGST                            S01310
     C                     MOVELSMGSG     MGSG                            S01310
     C                     MOVELSBICN     SECN                            S01310
     C                     MOVELSCUSNO    DECN                            S01310
     C/COPY WNCPYSRC,FTH00605
     C                     MOVEL*BLANKS   NWBN                            S01310
     C/COPY WNCPYSRC,FTH00606
     C                     MOVE '200'     MTPY                            S01310
     C/COPY WNCPYSRC,FTH00607
     C           SWPC      IFEQ 1                                         S01117
     C                     MOVE 'U'       MPRY                            S01117
     C                     ELSE                                           S01117
     C           SWPC      IFEQ 2                                         S01117
     C                     MOVE 'N'       MPRY                            S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C                     MOVEL*BLANKS   LSCC                            S01310
     C                     MOVEL*BLANKS   PTST                            S01310
     C                     MOVEL*BLANKS   CARQ                            S01310
     C                     MOVEL*BLANKS   MPDE                            S01310
     C                     MOVEL@HRDT     HRDT                            S01310
     C                     TIME           MGTM                            S01310
     C                     MOVE RUNA      LADT                            S01310
     C                     MOVE MGTM      LATM                            S01310
      *                                                                                       CSD015
      ** If Watch List Checking is Applied and CSW025 is off,                                 CSD015
      ** do watch processing.                                                                 CSD015
      *                                                                                       CSD015
     C           CSD015    IFEQ 'Y'                                                           CSD015
     C           CSW025    ANDEQ'N'                                                           CSD015
     C                     EXSR SRWTCH                                                        CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      *                                                                   S01310
      **  Convert run date to YYMMDD                                      S01310
      *                                                                   S01310
     C                     CALL 'ZM0060'                                  S01310
     C                     PARM RUND      ZMDAY   50                      S01310
     C                     PARM           ZMDATE  6                       S01310
     C                     MOVE ZMDATE    MGDE                            S01310
      *                                                                   S01310
      *                                                                   141797
      ** Set-up Message Generation  Century flag                          141797
      *                                                                   141797
     C                     MOVELMGDE      YY      20                      141797
     C           YY        IFLT 72                                        141797
     C                     MOVE '2'       CIND                            141797
     C                     ELSE                                           141797
     C                     MOVE '1'       CIND                            141797
     C                     ENDIF                                          141797
      *                                                                   141797
     C           MGST      IFEQ 'RSND'                                    S01310
     C                     MOVE SRUNA     RELD                            S01310
     C                     MOVE LATM      RELT                            S01310
     C                     END                                            S01310
      *                                                                   S01310
     C           AUP2      IFNE *BLANK                                    S01310
     C                     MOVE AUP2      RUSR                            S01310
     C                     ELSE                                           S01310
     C                     MOVE AUP1      RUSR                            S01310
     C                     END                                            S01310
     C                     MOVEL*BLANKS   RWSN                            S01310
     C                     MOVELM1AMNT    AMTS                            S01310
     C*********************MOVEL*BLANKS   AMTX                      S01310S01117
     C                     MOVELM1AMNT    AMTX                            S01117
     C                     MOVELVDATD3    SVDT                            S01310
      *                                                                   164663
      ** Setup century indicator CINDV for value date SVDT                164663
      *                                                                   164663
     C           SVDT      IFEQ *BLANK                                    164663
     C                     MOVE *BLANK    CINDV                           164663
     C                     ELSE                                           164663
     C                     MOVELSVDT      YY      20                      164663
     C           YY        IFLT 72                                        164663
     C                     MOVE '2'       CINDV                           164663
     C                     ELSE                                           164663
     C                     MOVE '1'       CINDV                           164663
     C                     ENDIF                                          164663
     C                     ENDIF                                          164663
      *                                                                   164663
     C*********************MOVELM1RCCY    CCY                       S01310S01117
     C*********************MOVEL*BLANKS   NSNO                      S01310S01117
     C/COPY WNCPYSRC,FTH00614
     C                     MOVE DEST      NSNO                            S01117
     C/COPY WNCPYSRC,FTH00615
     C                     MOVEL*BLANKS   SACN                            S01310
     C                     MOVEL*BLANKS   AORR                            S01310
     C                     MOVEL*BLANKS   DESI                            S01310
      *                                                                   S01310
      **  Branch details                                                  S01310
      *                                                                   S01310
     C                     MOVE BRCAA     BRCA                            S01310
      * IF MULTIBRANCH INDICATOR FROM RUNDAT ACTIVE                       S01310
     C           *IN60     IFEQ '1'                                       S01310
     C           BRCAA     IFNE ORBR                                      S01310
     C                     MOVE ORBR      ORBR    3                       S01310
     C                     MOVE ORBR      OTHB                            S01310
      * MOVE "ORIGINATING BRANCH" TO 'OTHER BRANCH TYPE'(OTHT)            S01310
     C                     MOVE ' BRANCH"'FLD1   20                       S01310
     C                     MOVEL'"ORIGINA'FLD2   12                       S01310
     C                     MOVE 'TING'    FLD2                            S01310
     C                     MOVELFLD2      FLD1                            S01310
     C                     MOVE FLD1      OTHT                            S01310
      *                                                                   S01310
     C                     ELSE                                           S01310
     C                     MOVE *BLANKS   OTHB                            S01310
     C                     MOVE *BLANKS   OTHT                            S01310
     C                     END                                            S01310
      * IF MULTIBRANCH INDICATOR FROM RUNDAT NOT ACTIVE                   S01310
     C                     ELSE                                           S01310
     C                     MOVE *BLANKS   OTHB                            S01310
     C                     MOVE *BLANKS   OTHT                            S01310
     C                     END                                            S01310
     C                     MOVE *BLANKS   RCBR                            S01310
      *                                                                   S01310
     C                     MOVE *BLANKS   NETI                            S01310
     C*********************MOVE *BLANKS   DELC                      S01310S01117
     C*                                                                   S01117
     C*   READ SDCURRPD FOR DELIVERY NOTIFICATION AND NON-DELIVERY        S01117
     C*     WARNING FLAGS                                                 S01117
     C                     CALL 'AOCURRR0'                                S01117
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM CCY       @CCY    3                       S01117
     C           SDCURR    PARM SDCURR    DSSDY                           S01117
     C*                                                                   S01117
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     MOVE '33'      DBERR#             *************S01117
     C                     MOVEL@CCY      DBERKY             * DBERR 033 *S01117
     C                     MOVEL'SDCURRPD'DBFNAM             *************S01117
     C                     EXSR DBERR                                     S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C           A6NDWR    IFEQ 'Y'                                       S01117
     C           A6DNOR    ANDEQ'Y'                                       S01117
     C                     MOVE '3'       DELC                            S01117
     C                     END                                            S01117
     C           A6NDWR    IFNE 'Y'                                       S01117
     C           A6DNOR    ANDEQ'Y'                                       S01117
     C                     MOVE '2'       DELC                            S01117
     C                     END                                            S01117
     C           A6NDWR    IFEQ 'Y'                                       S01117
     C           A6DNOR    ANDNE'Y'                                       S01117
     C                     MOVE '1'       DELC                            S01117
     C                     END                                            S01117
     C           A6NDWR    IFNE 'Y'                                       S01117
     C           A6DNOR    ANDNE'Y'                                       S01117
     C***********          MOVE '0'       DELC                      S01117087198
     C                     MOVE ' '       DELC                            087198
     C                     END                                            S01117
      *                                                                   087198
      * Ensure that message priority and delivery notification are        087198
      * valid combination :                                               087198
      * 1. for MPRY = 'U' DELC must be '1' or '3',                        087198
      * 2. for MPRY = 'N' DELC must be ' ' or '2'.                        087198
      *                                                                   087198
     C           MPRY      IFEQ 'U'                                       087198
     C           DELC      ANDEQ' '                                       087198
     C           MPRY      OREQ 'U'                                       087198
     C           DELC      ANDEQ'2'                                       087198
     C                     MOVEL'1'       DELC                            087198
     C                     END                                            087198
      *                                                                   087198
     C           MPRY      IFEQ 'N'                                       087198
     C           DELC      ANDEQ'1'                                       087198
     C           MPRY      OREQ 'N'                                       087198
     C           DELC      ANDEQ'3'                                       087198
     C                     MOVEL'2'       DELC                            087198
     C                     END                                            087198
     C*                                                                   S01117
     C                     MOVE *BLANKS   DYST                            S01310
     C                     MOVE *BLANKS   RSID                            S01310
     C                     MOVE *BLANKS   MSE1                            S01310
     C                     MOVE *BLANKS   ELIN                            S01310
     C                     MOVE *BLANKS   SSAC                            S01310
     C                     MOVE *BLANKS   MIR                             S01310
     C*********************MOVE *BLANKS   TSKS                      S01310S01117
     C                     MOVE 'Y'       TSKS                            S01117
     C                     MOVE *BLANKS   TSKY                            S01310
     C/COPY WNCPYSRC,FT0656C002
      *                                                                   S01310
     C                     MOVEL@CHG      AORR                                                CSW025
     C                     WRITEMGOREFD0               41                 S01310
      *                                                                   S01310
      **  Error on write to PF/MGOREFPD (message reference file)          S01310
      *                                                                   S01310
     C           *IN41     IFEQ '1'                                       S01310
     C                     MOVE '14'      DBERR#           * * * * * * * *S01310
     C                     MOVEL'       ' DBERKY           *  DBERR 014  *S01310
     C                     MOVEL'MGOREFPD'DBFNAM           * * * * * * * *S01310
     C                     EXSR DBERR                                     S01310
     C                     END                                            S01310
      *                                                                   S01310
      ** Clear the multiple occurrence data structure and the fields      S01310
      ** from PF/MGOREFPD for use by the MT210's.                         S01310
      *                                                                   S01310
     C                     EXSR INTF                                      S01310
      *                                                                   S01310
     C                     ENDSR                                          S01310
     C*                                                                   S01310
     C/EJECT                                                              S01310
     C********************************************************************
     C*               SUBROUTINE 10                                    ***
     C*                                                                ***
     C*        TO INITIALISE FIELDS IN DATA STRUCTURE                  ***
     C*        FOR FORMATTING SWIFT RECORDS                            ***
     C*                                                                ***
     C*                                                                ***
     C           SR10      BEGSR                                       ***
     C*                                                                ***
     C                     MOVE *BLANKS   MT2001
     C                     MOVE *BLANKS   MT2002
     C                     MOVE *BLANKS   MT2003
     C                     MOVE *BLANKS   MT2004
     C*    SET 'OUR TID'                                               ***
     C*********************MOVE MTD200    STID                            S01310
     C                     MOVE MTD200    M1OTID
     C*********************Z-ADD1         B01                             S01310
     C*********************MOVE X01       M1HEAD                          S01310
     C*********************MOVE X0D25     M1CRL1                          S01310
     C*********************MOVE X0D25     M1CRL2                          S01310
     C*********************MOVE X0D25     M1CRL3                          S01310
     C*********************MOVE X0D25     M1CRL4                          S01310
     C*********************MOVE X0D25     M1CRL6                          S01310
     C*********************MOVE X0D25     M1CRL7                          S01310
     C                     MOVE '200'     M1MSGT
     C*********************MOVE SWPC      M1MSGP                          S01117
     C*  FORMAT SWIFT PRIORITY CODE                                       S01117
     C*                                                                   S01117
     C           SWPC      IFEQ 1                                         S01117
     C                     MOVE 'U'       M1MSGP                          S01117
     C                     ELSE                                           S01117
     C           SWPC      IFEQ 2                                         S01117
     C                     MOVE 'N'       M1MSGP                          S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C                     MOVE RECADD    M1RADD
     C*********************MOVE ':20:'    M1TG20                          S01310
     C*********************                                               S01310
     C***FORMAT*MT200*TRN*TO INCLUDE SWIFT SEQUENCE NO. FOR COMPARISON    S01310
     C***WITH*ASSOCIATED*MT210                                            S01310
     C*********************                                               S01310
     C*********************MOVE TFRF      M#TREF 14                       S01310
     C*********************Z-ADD1         SWSN                            S01310
     C*********************MOVE SWSN      MTTREF                          S01310
     C*********************MOVELM#TREF    MTTREF 15                       S01310
     C*********************MOVELMTTREF    M1TREF                          S01310
     C*********************MOVE ':32A:'   M1TG32                          S01310
     C                     MOVE VDATD3    M1VDAT
     C*********************MOVE 'P'       MXMIND                          S01310
     C*********************MOVE TFRF      PREFS                           S01310
     C*********************MOVELPREFS     MXTREF                          S01310
     C*********************MOVE *BLANKS   MXDFLG                          S01310
     C*********************MOVE '-'       M4HYPH                          S01310
     C*********************Z-ADD3         B03                             S01310
     C*********************MOVE X03       M4ETX                           S01310
     C*                                                                ***
     C                     ENDSR                           END SR10
     C*                                                                ***
     C********************************************************************
     C/EJECT
     C********************************************************************
     C*********       SUBROUTINE 11                                    ***S01310
     C*********                                                        ***S01310
     C*********TO INCREMENT MESSAGES COUNT FIELD IN                    ***S01310
     C*********DATA*AREA*MSFCTL*************************************** ***E21286
     C*********DATA AREA FTFCTL                                     E21286S01310
     C*********                                                        ***S01310
     C*********  SR11      BEGSR                                       ***S01310
     C*********                                                        ***S01310
     C*****INCREMENT*MESSAGES*COUNT*FIELD*IN*DATAAREA*MSFCTL**************E21286
     C*****INCREMENT*MESSAGES*COUNT*FIELD*IN*DATAAREA*FTFCTL        E21286S01310
     C************NAMVAR   DEFN MSFCTL    DFCTL                           S01310
     C************NAMVAR   DEFN FTFCTL    DFCTL                           S01310
     C************LOCK     IN   DFCTL                                     S01310
     C***********          ADD  1         DFOMC                           S01310
     C***********          ADD  1         DFOTL                           S01310
     C***********          OUT  DFCTL                                     S01310
     C***********                                                      ***S01310
     C***********          ENDSR                           END SR11       S01310
     C***********                                                      ***S01310
     C********************************************************************S01310
     C*EJECT                                                              S01310
     C********************************************************************
     C*               SUBROUTINE P1                                    ***
     C*                                                                ***
     C*         OUTPUT AN ENTRY TO SWIFT MESSAGE                       ***
     C*         REPORT PRTF/FT0656P1                                   ***
     C*                                                                ***
     C           SRP1      BEGSR                                       ***
     C*                                                                ***
     C                     ADD  1         PAGEP1
     C/COPY WNCPYSRC,FTH00608
     C                     WRITEP1H1                   80
     C/COPY WNCPYSRC,FTH00609
     C   80                DO                              B001
     C*                                                    ))))))))))))))
     C*********************MOVE 'FT0656P1'DBFNAM           )))  DATA  ))) S01310
     C                     MOVEL'FT0656P1'DBFNAM           )))  DATA  ))) S01310
     C                     MOVEL'1'       DBERKY           )))  BASE  )))
     C                     MOVE 17        DBERR#           ))) ERROR  )))
     C                     EXSR DBERR                      )))   17   )))
     C*                                                    ))))))))))))))
     C                     END                             E001
     C*                                                                ***
     C                     ENDSR                           END SRP1
     C*                                                                ***
     C********************************************************************
     C/EJECT
     C********************************************************************
     C*               SUBROUTINE P4                                    ***
     C*                                                                ***
     C*         OUTPUT AN ENTRY TO SWIFT MESSAGE                       ***
     C*         REPORT PRTF/FT0655P4                                   ***
     C*                                                                ***
     C           SRP4      BEGSR                                       ***
     C*                                                                ***
     C                     ADD  1         PAGEP4
     C                     WRITEP4H1                   80
     C   80                DO                              B001
     C*                                                    ))))))))))))))
     C*********************MOVE 'FT0656P4'DBFNAM           )))  DATA  ))) S01310
     C                     MOVEL'FT0656P4'DBFNAM           )))  DATA  ))) S01310
     C                     MOVEL'1'       DBERKY           )))  BASE  )))
     C                     MOVE '25'      DBERR#           ))) ERROR  )))
     C                     EXSR DBERR                      )))   25   )))
     C*                                                    ))))))))))))))
     C                     END                             E001
     C*                                                                ***
     C                     ENDSR                           END SRP4
     C*                                                                ***
     C********************************************************************
     C/EJECT
     C********************************************************************
     C*               SUBROUTINE P3                                    ***
     C*                                                                ***
     C*        TO HANDLE 'NOTICE TO RECEIVE' TELEX REPORT              ***
     C*                                                                ***
     C           SRP3      BEGSR                                       ***
     C*                                                                ***
     C*  ** CHANGE OF CURRENCY, THEN PRINT ELS SUPPRESS CURRENCY       ***
     C*  ** 'CCNM' IS FROM TABLETG ACESS IN SR03 VIA SR06              ***
     C           P2CCY     IFNE CCNM
     C                     SETON                     14
     C                     Z-ADD0         MREC    10
     C                     MOVE CCNM      P2CCY
     C                     ELSE
     C                     ADD  1         MREC
     C                     SETOF                     14
     C                     END
     C*
     C           MREC      IFGT 1
     C                     SETON                     14
     C                     Z-ADD0         MREC
     C                     END
     C*                                                                ***
     C*  ** CONVERT PAY VALUE DATE FROM 'YYMMDD' TO 'DDMMMYY'          ***
     C                     MOVE VDATD3    SDATE
     C                     MOVE MTH,SMM   WMM
     C                     MOVE SDD       WDD
     C                     MOVE SYY       WYY
     C*                                                                ***
     C*  ** CHANGE DATE THEN PRINT ELSE SUPRESS DATE PRINTING          ***
     C           WDATE     IFNE P2VAL
     C                     SETON                     15
     C                     Z-ADD0         DREC    10
     C                     MOVELWDATE     P2VAL
     C                     ELSE
     C                     ADD  1         DREC
     C                     SETOF                     15
     C                     END
     C*                                                                ***
     C           DREC      IFGT 1
     C                     SETON                     15
     C                     Z-ADD0         DREC
     C                     END
     C*                                                                ***
     C                     MOVELTFRF      P2REF
     C*                                                                ***
     C*  ** PRINT TELEX MESSAGE                                        ***
     C                     ADD  1         PAGEP5
     C                     WRITEP5H1                   80
     C   80                DO                              B001
     C*                                                    ))))))))))))))
     C*********************MOVE 'FT0656P2'DBFNAM           )))  DATA  ))) S01310
     C                     MOVEL'FT0656P2'DBFNAM           )))  DATA  ))) S01310
     C                     MOVEL'2'       DBERKY           )))  BASE  )))
     C                     MOVE '26'      DBERR#           ))) ERROR  )))
     C                     EXSR DBERR                      )))   26   )))
     C*                                                    ))))))))))))))
     C                     END                             E001
     C                     WRITEP5H2                                   ***
     C*                                                                ***
     C                     ENDSR                           END SRP3
     C*                                                                ***
     C********************************************************************
     C/EJECT
     C********************************************************************
     C*               SUBROUTINE P2                                    ***
     C*                                                                ***
     C*        TO HANDLE TELEX REPORT                                  ***
     C*                                                                ***
     C           SRP2      BEGSR                                       ***
     C*                                                                ***
     C*  ** CHANGE OF CURRENCY, THEN PRINT ELS SUPPRESS CURRENCY       ***
     C*  ** 'CCNM' IS FROM TABLETG ACESS IN SR03 VIA SR06/SR07         ***
     C           P2CCY     IFNE CCNM
     C                     SETON                     14
     C                     Z-ADD0         MREC    10
     C                     MOVE CCNM      P2CCY
     C                     ELSE
     C                     ADD  1         MREC
     C                     SETOF                     14
     C                     END
     C*
     C           MREC      IFGT 1
     C                     SETON                     14
     C                     Z-ADD0         MREC
     C                     END
     C*                                                                ***
     C*  ** CONVERT PAY VALUE DATE FROM 'YYMMDD' TO 'DDMMMYY'          ***
     C                     MOVE VDATD3    SDATE
     C                     MOVE MTH,SMM   WMM
     C                     MOVE SDD       WDD
     C                     MOVE SYY       WYY
     C*                                                                ***
     C*  ** CHANGE DATE THEN PRINT ELSE SUPRESS DATE PRINTING          ***
     C*                                                                ***
     C                     MOVELTFRF      P2REF
     C           WDATE     IFNE P2VAL
     C                     SETON                     15
     C                     Z-ADD0         DREC    10
     C                     MOVELWDATE     P2VAL
     C                     ELSE
     C                     ADD  1         DREC
     C                     SETOF                     15
     C                     END
     C*                                                                ***
     C           DREC      IFGT 1
     C                     SETON                     15
     C                     Z-ADD0         DREC
     C                     END
     C*                                                                ***
     C*  ** PRINT TELEX MESSAGE                                        ***
     C                     ADD  1         PAGEP2
     C                     WRITEP2H1                   80
     C   80                DO                              B001
     C*                                                    ))))))))))))))
     C*********************MOVE 'FT0656P2'DBFNAM           )))  DATA  ))) S01310
     C                     MOVEL'FT0656P2'DBFNAM           )))  DATA  ))) S01310
     C                     MOVEL'2'       DBERKY           )))  BASE  )))
     C                     MOVE '19'      DBERR#           ))) ERROR  )))
     C                     EXSR DBERR                      )))   19   )))
     C*                                                    ))))))))))))))
     C                     END                             E001
     C                     WRITEP2H2                                   ***
     C*                                                                ***
     C*                                                                ***
     C                     ENDSR                           END SRP2
     C/EJECT
     C************************************************************        S01310
     C**SWFT*SR.***********                                               S01310
     C**TO*DETERMINE*ROUTE*FOR SWIFT MESSAGE GENERATION                   S01310
     C************************************************************        S01310
     C**SEE*BELOW*FOR*DETAILS OF DECISION                                 S01310
     C*********************                                               S01310
     C***********SWFT******BEGSR                                          S01310
      *****************************************************************   S01310
      ****PRAD*-*determine*settlement*network*address**************S01310 CSW096
      ****Called*by*-*SR01.****************************************S01310 CSW096
      ****Calls*****-**********************************************S01310 CSW096
      *************************************************************S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********PRAD      BEGSR                                   S01310 CSW096
      ***********                                                  S01310 CSW096
      ****Set*up*priority*sender,*destination*&*network************S01310 CSW096
      ***********                                                  S01310 CSW096
      ****'S'*=*SWIFT;*'T'*=*TELEX;*'X'*=*STTX*********************S01310 CSW096
      ***********                                                  S01310 CSW096
     C****PROCESSING*TO*DETERMINE*WHETHER*THE*MESSAGE*********************CSW096
     C****DESTINATION*IS*SWIFT,*TELEX*OR*STTX*****************************CSW096
     C***********                                                         CSW096
     C*******************(1)**(2)**(3)**(4)**(5)**(6)**(7)****************CSW096
     C****-------------------------------------------------***************CSW096
     C****SWIFT*ADDRESS  Y   N   N   Y   Y   Y   Y ***************CSW096
     C****TELEX*ADDRESS  N   Y   N   Y   Y   N   N ***************CSW096
     C****STTX*ADDRESS*  N   N   Y   N   N   Y   Y ***************CSW096
     C****SETT.*TYPE***             01  08  01  08 ***************CSW096
     C****-------------------------------------------------***************CSW096
     C****DESTN*=*CSID*  X               X       X ***************CSW096
     C****DESTN*=*TELX*      X       X             ***************CSW096
     C****DESTN*=*STTX*          X           X     ***************CSW096
     C****-------------------------------------------------***************CSW096
     C****MESSAGE*ROUTE                            ***************CSW096
     C****CODE*(SWTX)**  S   T   X   T   S   X   S ***************CSW096
     C***********                                                         CSW096
      ***********                                                  S01310 CSW096
      ***Move*new*field*names*to*old*to*ensure*continuity*of*code.*S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********          MOVELBBCSID    CSID                     S01310 CSW096
     C***********          MOVELBBTXA1    TELX                     S01310 CSW096
     C***********          MOVELBBSTAD    STTX   12                S01310 CSW096
     C***********          MOVELBBCRNM    CRNM                     S01310 CSW096
      ****SWIFT*?**************************************************S01310 CSW096
     C****(1)**********************************************************   CSW096
     C***********          MOVE CSID      CSBIC   4                       CSW096
     C***********GSFM******IFEQ 'Y'                                       S01310
     C***********BGMSDL    IFEQ 'Y'                                S01310 CSW096
     C***********CSBIC     ANDNE'BIC '                                    CSW096
     C***********CSID      IFNE *BLANKS                                   CSW096
     C***********TELX      ANDEQ*BLANKS                                   CSW096
     C***********STTX      ANDEQ*BLANKS                                   CSW096
     C****(5)**********************************************************   CSW096
     C***********CSID      ORNE *BLANKS                                   CSW096
     C***********TELX      ANDNE*BLANKS                                   CSW096
     C***********STTX      ANDEQ*BLANKS                                   CSW096
     C***********STMT      ANDEQ08                                        CSW096
     C****(7)*************************************************************CSW096
     C***********CSID      ORNE *BLANKS                                   CSW096
     C***********TELX      ANDEQ*BLANKS                                   CSW096
     C***********STTX      ANDNE*BLANKS                                   CSW096
     C***********STMT      ANDEQ08                                        CSW096
     C***********                                                         CSW096
     C*********************MOVE CSID      CSID   12                       S01310
     C***********          MOVE 'S'       SWTX    1                       CSW096
     C***********          MOVELSNCSID    NWSN                     S01310 CSW096
     C***********          MOVELCSID      NWDS                     S01310 CSW096
     C***********          MOVEL'SWIFT'   NWRK                     S01310 CSW096
     C***********          MOVE 'Y'       OSUFLG                   S01310 CSW096
     C***********          END                                     S01310 CSW096
     C***********          END                                            CSW096
      ***********                                                  S01310 CSW096
      ****Telex****************************************************S01310 CSW096
     C****(2)**********************************************************   CSW096
     C***********BGMTMI    IFEQ 'Y'                                S01310 CSW096
     C***********CSID      IFEQ *BLANKS                                   CSW096
     C***********TELX      ANDNE*BLANKS                                   CSW096
     C***********STTX      ANDEQ*BLANKS                                   CSW096
     C****(4)**********************************************************   CSW096
     C***********CSID      ORNE *BLANKS                                   CSW096
     C***********TELX      ANDNE*BLANKS                                   CSW096
     C***********STTX      ANDEQ*BLANKS                                   CSW096
     C***********STMT      ANDEQ01                                        CSW096
     C***********                                                         CSW096
     C*********************MOVE TELX      CSID                            S01310
     C***********          MOVE 'T'       SWTX                            CSW096
     C***********          MOVELSTELX     NWSN                     S01310 CSW096
     C***********          MOVELTELX      NWDS                     S01310 CSW096
     C***********          MOVEL'TELEX'   NWRK                     S01310 CSW096
     C***********          MOVE 'Y'       OSUFLG                   S01310 CSW096
     C***********          END                                     S01310 CSW096
     C***********          END                                            CSW096
      ***********                                                  S01310 CSW096
      ****STTX*network*available*?*********************************S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********BGMSDL    IFEQ 'Y'                                S01310 CSW096
     C****(3)*************************************************************CSW096
     C***********CSID      IFEQ *BLANKS                                   CSW096
     C***********TELX      ANDEQ*BLANKS                                   CSW096
     C***********STTX      ANDNE*BLANKS                                   CSW096
     C****(6)*************************************************************CSW096
     C***********CSID      ORNE *BLANKS                                   CSW096
     C***********TELX      ANDEQ*BLANKS                                   CSW096
     C***********STTX      ANDNE*BLANKS                                   CSW096
     C***********STMT      ANDEQ01                                        CSW096
     C***********                                                         CSW096
     C*********************MOVE STTX      CSID                            S01310
     C***********          MOVE 'X'       SWTX                            CSW096
     C***********          MOVELSSTTX     NWSN                     S01310 CSW096
     C***********          MOVELSTTX      NWDS                     S01310 CSW096
     C***********          MOVEL'STTX'    NWRK                     S01310 CSW096
     C***********          MOVE 'Y'       OSUFLG                   S01310 CSW096
     C***********          END                                            CSW096
     C*********************ELSE                                           S01310
     C*********************MOVE *BLANKS   CSID                            S01310
     C*********************MOVE *BLANKS   SWTX                            S01310
     C***********          END                                            CSW096
      ***********                                                  S01310 CSW096
      ***Found*to*be*unroutable.***********************************S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********NWRK      IFEQ *BLANKS                            S01310 CSW096
     C***********NWSN      OREQ *BLANKS                            S01310 CSW096
     C***********          MOVELSCRNM     NWSN                     S01310 CSW096
     C***********          MOVELCRNM      NWDS                     S01310 CSW096
     C***********          MOVEL'UNROUT'  NWRK                     S01310 CSW096
     C***********          MOVE 'CRTD'    MGST                     S01310 CSW096
     C***********          MOVE '1'       MGSG                     S01310 CSW096
     C***********          MOVE 'Y'       OSUFLG                   S01310 CSW096
     C***********          END                                     S01310 CSW096
     C***********                                                  S01494 CSW096
     C****Direct*settlement*type*"02"*to*network*"PAPER"*irrespectiS01494 CSW096
     C****of*the*customer*setup*for*the*nostros.*******************S01494 CSW096
     C***********                                                  S01494 CSW096
     C***********STMT      IFEQ 02                                 S01494 CSW096
     C***********          MOVELSCRNM     NWSN                     S01494 CSW096
     C***********          MOVELCRNM      NWDS                     S01494 CSW096
     C***********          MOVEL'PAPER '  NWRK                     S01494 CSW096
     C***********          MOVE 'RSND'    MGST                     S01494 CSW096
     C***********          MOVE '2'       MGSG                     S01494 CSW096
     C***********          MOVE 'N'       OSUFLG                   S01494 CSW096
     C***********          END                                     S01494 CSW096
     C***********                                                         CSW096
     C***********          ENDSR                                          CSW096
     C***********                                                         CSW096
     C********************************************************************CSW096
     C**END*OF*SWIFT*TELEX*SUBROUTINE*************************************CSW096
     C********************************************************************CSW096
     C*/EJECT****                                                         CSW096
     C*************************************************************S01310 CSW096
     C****NWAD*-*determine*default*network*addresses***************S01310 CSW096
     C****Called*by*-*SR01.****************************************S01310 CSW096
     C****Calls*****-**********************************************S01310 CSW096
     C*************************************************************S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********NWAD      BEGSR                                   S01310 CSW096
      ***********                                                  S01310 CSW096
      ****Default*is*SWIFT*****************************************S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********BBDNW2    IFEQ 'SWIFT'                            S01310 CSW096
     C***********BBCSID    ANDNE*BLANKS                            S01310 CSW096
     C***********@BIC      ANDNE'BIC'                              S01310 CSW096
     C***********BGMSDL    ANDEQ'Y'                                S01310 CSW096
     C***********          MOVELSNCSID    NWSN                     S01310 CSW096
     C***********          MOVELBBCSID    NWDS                     S01310 CSW096
     C***********          MOVELBBDNW2    NWRK                     S01310 CSW096
     C***********          MOVE 'Y'       OSUFLG                   S01310 CSW096
     C***********          END                                     S01310 CSW096
      ***********                                                  S01310 CSW096
      ****Default*is*TELEX*****************************************S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********BBDNW2    IFEQ 'TELEX'                            S01310 CSW096
     C***********BBTXA1    ANDNE*BLANKS                            S01310 CSW096
     C***********BGMTMI    ANDEQ'Y'                                S01310 CSW096
     C***********          MOVELSTELX     NWSN                     S01310 CSW096
     C***********          MOVELBBTXA1    NWDS                     S01310 CSW096
     C***********          MOVE BBDNW2    NWRK                     S01310 CSW096
     C***********          MOVE 'Y'       OSUFLG                   S01310 CSW096
     C***********          END                                     S01310 CSW096
      ***********                                                  S01310 CSW096
      ****Default*is*STTX******************************************S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********BBDNW2    IFEQ 'STTX'                             S01310 CSW096
     C***********BBSTAD    ANDNE*BLANKS                            S01310 CSW096
     C***********BGMSDL    ANDEQ'Y'                                S01310 CSW096
     C***********          MOVELSSTTX     NWSN                     S01310 CSW096
     C***********          MOVELBBSTAD    NWDS                     S01310 CSW096
     C***********          MOVE BBDNW2    NWRK                     S01310 CSW096
     C***********          MOVE 'Y'       OSUFLG                   S01310 CSW096
     C***********          END                                     S01310 CSW096
      ***********                                                  S01310 CSW096
      ****Default*is*PAPER*****************************************S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********BBDNW2    IFEQ 'PAPER'                            S01310 CSW096
     C***********          MOVELSCRNM     NWSN                     S01310 CSW096
     C***********          MOVELBBCRNM    NWDS                     S01310 CSW096
     C***********          MOVE BBDNW2    NWRK                     S01310 CSW096
     C***********          MOVE 'RSND'    MGST                     S01310 CSW096
     C***********          MOVE '2'       MGSG                     S01310 CSW096
     C***********          MOVE 'N'       OSUFLG                   S01310 CSW096
     C***********          END                                     S01310 CSW096
      ***********                                                  S01310 CSW096
      ****Found*to*be*unroutable***********************************S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********NWRK      IFEQ *BLANKS                            S01310 CSW096
     C***********NWDS      OREQ *BLANKS                            S01310 CSW096
     C***********NWSN      OREQ *BLANKS                            S01310 CSW096
     C***********          MOVELSCRNM     NWSN                     S01310 CSW096
     C***********          MOVELBBCRNM    NWDS                     S01310 CSW096
     C***********          MOVEL'UNROUT'  NWRK                     S01310 CSW096
     C***********          MOVE 'CRTD'    MGST                     S01310 CSW096
     C***********          MOVE '1'       MGSG                     S01310 CSW096
     C***********          MOVE 'Y'       OSUFLG                   S01310 CSW096
     C***********          END                                     S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********          ENDSR                                   S01310 CSW096
     C*/EJECT****                                                  S01310 CSW096
      *************************************************************S01310 CSW096
      ****FILL*-*Fill*up*array**GNR********************************S01310 CSW096
      ****Called*by***-*SR01.**************************************S01310 CSW096
      ****Calls*******-********************************************S01310 CSW096
      *************************************************************S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********FILL      BEGSR                                   S01310 CSW096
      ***********                                                  S01310 CSW096
      ****Is*message*to*be*generated*as*released*?*****************S01310 CSW096
      ***********                                                  S01310 CSW096
     C***********          MOVE BBDS01    GNR,1                    S01310 CSW096
     C***********          MOVE BBDS02    GNR,2                    S01310 CSW096
     C***********          MOVE BBDS03    GNR,3                    S01310 CSW096
     C***********          MOVE BBDS04    GNR,4                    S01310 CSW096
     C***********          MOVE BBDS05    GNR,5                    S01310 CSW096
     C***********          MOVE BBDS06    GNR,6                    S01310 CSW096
     C***********          MOVE BBDS07    GNR,7                    S01310 CSW096
     C***********          MOVE BBDS08    GNR,8                    S01310 CSW096
     C***********          MOVE BBDS09    GNR,9                    S01310 CSW096
     C***********          MOVE BBDS10    GNR,10                   S01310 CSW096
     C***********          MOVE BBDS11    GNR,11                   S01310 CSW096
     C***********          MOVE BBDS12    GNR,12                   S01310 CSW096
     C***********          MOVE BBDS13    GNR,13                   S01310 CSW096
     C***********          MOVE BBDS14    GNR,14                   S01310 CSW096
     C***********          MOVE BBDS15    GNR,15                   S01310 CSW096
      ***********                                                  089269 CSW096
      ****Load*table of message types not to be generated for custo089269 CSW096
      ***********                                                  089269 CSW096
     C***********          MOVE BBNG01    NGN,1                    089269 CSW096
     C***********          MOVE BBNG02    NGN,2                    089269 CSW096
     C***********          MOVE BBNG03    NGN,3                    089269 CSW096
     C***********          MOVE BBNG04    NGN,4                    089269 CSW096
     C***********          MOVE BBNG05    NGN,5                    089269 CSW096
     C***********          MOVE BBNG06    NGN,6                    089269 CSW096
     C***********          MOVE BBNG07    NGN,7                    089269 CSW096
     C***********          MOVE BBNG08    NGN,8                    089269 CSW096
     C***********          MOVE BBNG09    NGN,9                    089269 CSW096
     C***********          MOVE BBNG10    NGN,10                   089269 CSW096
     C***********          MOVE BBNG11    NGN,11                   089269 CSW096
     C***********          MOVE BBNG12    NGN,12                   089269 CSW096
     C***********          MOVE BBNG13    NGN,13                   089269 CSW096
     C***********          MOVE BBNG14    NGN,14                   089269 CSW096
     C***********          MOVE BBNG15    NGN,15                   089269 CSW096
      ***********                                                  S01310 CSW096
     C***********          ENDSR                                   S01310 CSW096
     C/EJECT                                                              S01310
      *****************************************************************   CSW096
      *   SRROUT - determine message routing                          *   CSW096
      *   Called by - SR01                                            *   CSW096
      *   Calls -                                                     *   CSW096
      *****************************************************************   CSW096
      *                                                                   CSW096
     C           SRROUT    BEGSR                                          CSW096
      *                                                                   CSW096
     C                     MOVE BRCA      I@SNBR                          CSW096
     C                     MOVE *BLANKS   I@DSCN                          CSW096
     C                     MOVE CUSTNO    I@DSCN                          CSW096
     C           *IN21     IFEQ '1'                                       CSW096
     C                     MOVE '200'     I@MTPY                          CSW096
     C                     ELSE                                           CSW096
     C                     MOVE '210'     I@MTPY                          CSW096
     C                     END                                            CSW096
     C                     MOVE 'N'       I@CONC                          CSW096
     C                     Z-ADDSTMT      I@SETT                          CSW096
     C                     MOVE FTCS      I@FTCS                          CSW096
     C                     MOVE MODI      I@MMOD                          CSW096
      *###################################################################CSW096
      *                                                                  #CSW096
      * Below are two copy sources intended for setting up the custom    #CSW096
      * parameter (P@ZZ) in the call to MG9900.                          #CSW096
      * One (MG9900FTCL) is in ALL MG generation programs and is for use #CSW096
      * when a change is required to all of them.                        #CSW096
      * The other is only in this program.                               #CSW096
     C/COPY WNCPYSRC,MG9900FTCL                                          #CSW096
     C/COPY WNCPYSRC,FT0656ROUT                                          #CSW096
      *                                                                  #CSW096
      *###################################################################CSW096
     C                     CALL 'MG9900'                                  CSW096
     C                     PARM *BLANKS   @RTCD                           CSW096
     C                     PARM           P@IN                            CSW096
     C                     PARM *BLANKS   P@OUT                           CSW096
     C                     PARM           P@ZZ  256                       CSW096
      *                                                                   CSW096
     C           @RTCD     IFNE *BLANKS                                   CSW096
     C                     MOVE '92'      DBERR#             * * * * * * *CSW096
     C                     MOVEL'*CALL'   DBERKY             * DBERR 920 *CSW096
     C                     MOVEL'MG9900  'DBFNAM             * * * * * * *CSW096
     C                     EXSR DBERR                                     CSW096
     C                     ELSE                                           CSW096
     C                     MOVE O@NWRK    NWRK                            CSW096
     C                     MOVE O@NWSN    NWSN                            CSW096
     C                     MOVE O@NWDS    NWDS                            CSW096
     C                     MOVE O@MGSG    MGSG                            CSW096
     C                     MOVE O@MGST    MGST                            CSW096
     C                     MOVE O@PCNB    CPAR                            CSW096
     C                     END                                            CSW096
      *                                                                                       CSW215
      ** Change the Network to 'PAPER' if the Precious Metal Indicator                        CSW215
      ** of the currency is 'Y' and Network is currently set to 'SWIFT'                       CSW215
      *                                                                                       CSW215
     C           CSW215    IFEQ 'Y'                                                           CSW215
     C                     CALL 'AOCURRR0'                                                    CSW215
     C                     PARM *BLANKS   PRTCD                                               CSW215
     C                     PARM '*KEY   ' POPTN                                               CSW215
     C                     PARM CCY       PWCCY   3                                           CSW215
     C           SDCURR    PARM SDCURR    DSSDY                                               CSW215
      *                                                                                       CSW215
     C           PRTCD     IFNE *BLANKS                                                       CSW215
     C                     MOVE '035'     DBERR#                                              CSW215
     C                     MOVELCCY       DBERKY                                              CSW215
     C                     MOVEL'SDCURRPD'DBFNAM                                              CSW215
     C                     EXSR DBERR                                                         CSW215
     C                     ENDIF                                                              CSW215
      *                                                                                       CSW215
     C           PRTCD     IFEQ *BLANKS                                                       CSW215
     C           NWRK      ANDEQ'SWIFT'                                                       CSW215
     C           A6PMRT    ANDEQ'Y'                                                           CSW215
     C                     MOVEL'PAPER'   NWRK                                                CSW215
     C                     ENDIF                                                              CSW215
     C                     ENDIF                                                              CSW215
      *                                                                   CSW096
     C           BBDNW2    IFEQ *BLANKS                                   CSW096
     C           NWRK      IFEQ 'SWIFT'                                   CSW096
     C                     MOVE 'S'       SWTX    1                       CSW096
     C                     END                                            CSW096
     C           NWRK      IFEQ 'TELEX'                                   CSW096
     C                     MOVE 'T'       SWTX                            CSW096
     C                     END                                            CSW096
     C           NWRK      IFEQ 'STTX'                                    CSW096
     C                     MOVE 'X'       SWTX                            CSW096
     C                     END                                            CSW096
     C                     END                                            CSW096
      *                                                                   CSW096
     C           NWRK      IFNE 'PAPER'                                   CSW096
     C                     MOVE 'Y'       OSUFLG                          CSW096
     C                     ELSE                                           CSW096
     C                     MOVE 'N'       OSUFLG                          CSW096
     C                     END                                            CSW096
      *                                                                   CSW096
     C                     ENDSR                                          CSW096
      /EJECT                                                              138077
      *****************************************************************   138077
      *                                                               *   138077
      *   SEXTN - Store customer with SWIFT address to data structure *   138077
      *                                                               *   138077
      *****************************************************************   138077
      *                                                                   138077
     C           SEXTN     BEGSR                                          138077
      *                                                                   138077
     C           SAVMTG    IFNE *BLANKS                                   138077
     C                     MOVE SAVMTG    @MTG                            138077
     C                     ELSE                                           138077
     C                     MOVELMTAG      @MTG                            138077
     C                     ENDIF                                          138077
     C           FLDTYP    IFEQ '5'                                       138077
     C           FLDTAG    ANDEQ'A'                                       138077
     C                     ADD  1         V                               138077
     C           V         OCUR EXTN                                      138077
     C                     Z-ADDQ         MPSN                            138077
     C                     MOVEL@MTG      MTG                             138077
     C                     MOVELBBCUST    MCSI                            138077
     C                     ENDIF                                          138077
      *                                                                   138077
     C           SEXT9     ENDSR                                          138077
     C/EJECT                                                              CSW096
      *****************************************************************   S01310
      *   INTF - Initalise non-constant fields                        *   S01310
      *   Called by - main process                                    *   S01310
      *   Calls     -                                                 *   S01310
      *****************************************************************   S01310
      *                                                                   S01310
     C           INTF      BEGSR                                          S01310
      *                                                                   S01310
     C                     MOVE *BLANKS   TRNO                            S01310
     C                     MOVE *BLANKS   TRNA                            S01310
     C                     MOVE '      '  NWRK                            S01310
     C**********           Z-ADD0         SECN                                         S01310 CSD027
     C                     MOVE *BLANKS   SECN                                                CSD027
     C                     MOVE *BLANKS   NWSN                            S01310
     C**********           Z-ADD0         DECN                                         S01310 CSD027
     C                     MOVE *BLANKS   DECN                                                CSD027
     C                     MOVE *BLANKS   NWDS                            S01310
     C                     MOVE *BLANKS   MGSG                            S01310
     C                     MOVE *BLANKS   MGST                            S01310
     C                     Z-ADD0         MGTM                            S01310
     C                     Z-ADD0         LATM                            S01310
     C                     MOVE *BLANKS   RELD                            S01310
     C                     Z-ADD0         RELT                            S01310
     C                     MOVE *BLANKS   AMTS                            S01310
     C                     MOVE *BLANKS   SVDT                            S01310
     C                     MOVE *BLANKS   CINDV                           164663
      *                                                                   S01310
     C                     MOVE *BLANKS   SNCSID 12                       S01310
     C                     MOVE *BLANKS   STELX  10                       S01310
     C                     MOVE *BLANKS   SSTTX  12                       S01310
     C                     MOVE *BLANKS   SCRNM  20                       S01310
      *                                                                   S01310
      **  Clear multiple occurrence data structure                        S01310
      *                                                                   S01310
     C                     Z-ADD1         Q       20                      S01310
     C           Q         OCUR MULT                                      S01310
      *                                                                   S01310
     C           Q         DOWLE50                                        S01310
     C           MULT      ANDNE*BLANKS                                   S01310
     C                     MOVE *BLANKS   MULT                            S01310
     C                     ADD  1         Q                               S01310
     C           Q         OCUR MULT                                      S01310
     C                     END                                            S01310
      *                                                                   138077
      ** Clear multiple occurrence DS for the extension file.             138077
      *                                                                   138077
     C                     Z-ADD1         V       20                      138077
     C           V         OCUR EXTN                                      138077
     C           V         DOWLE20                                        138077
     C           MCSI      ANDNE*BLANKS                                   138077
     C                     Z-ADD*ZEROS    MPSN                            138077
     C                     MOVE *BLANKS   MTG                             138077
     C                     MOVE *BLANKS   MCSI                            138077
     C                     ADD  1         V                               138077
     C           V         OCUR EXTN                                      138077
     C                     ENDDO                                          138077
     C                     Z-ADD0         V                               138077
      *                                                                   S01310
     C                     ENDSR                                          S01310
     C/EJECT                                                              S01310
     C*****************************************************************                       CSD015
      *                                                               *                       CSD015
      *  SRWTCH - Sub-routine to perform compliance watch processing. *                       CSD015
      *                                                               *                       CSD015
      *****************************************************************                       CSD015
      *                                                                                       CSD015
     C           SRWTCH    BEGSR                                                              CSD015
      *                                                                                       CSD015
      ** Re-determine Message Status                                                          CSD015
      *                                                                                       CSD015
     C                     MOVE 'N'       PARLS   1                                           CSD015
     C           MGST      IFEQ 'RSND'                                                        CSD015
     C           NWRK      IFEQ 'SWIFT '                                                      CSD015
     C           NWRK      OREQ 'TELEX '                                                      CSD015
     C           NWRK      OREQ 'STTX  '                                                      CSD015
     C                     MOVE 'CRTD'    MGST                                                CSD015
     C                     MOVE '1'       MGSG                                                CSD015
     C                     MOVE 'Y'       PARLS                                               CSD015
     C                     ENDIF                                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Initialise parameter for compliance engine program.                                  CSD015
      *                                                                                       CSD015
     C                     MOVE *BLANKS   WLTDS                                               CSD015
     C                     Z-ADD*ZERO     W4VDAT                                              CSD015
     C                     Z-ADD*ZERO     W4MDAT                                              CSD015
     C                     Z-ADD*ZERO     W4AMT1                                              CSD015
     C                     Z-ADD*ZERO     W4AMT2                                              CSD015
      *                                                                                       CSD015
      ** Set up parameter for compliance engine program                                       CSD015
      *                                                                                       CSD015
     C                     MOVELTRNO      W4IDEN                                              CSD015
     C                     MOVELMTPY      W4ITEM                                              CSD015
     C                     MOVELBRCAA     W4BRCH                                              CSD015
     C                     MOVEL'MGOREF  'W4FUNT                                              CSD015
     C                     MOVELDECN      W4CNUM                                              CSD015
     C                     Z-ADDRUND      W4DDAT                                              CSD015
     C                     MOVELPARLS     W4ARLS                                              CSD015
      *                                                                                       CSD015
      ** Send transaction to compliance engine program                                        CSD015
      *                                                                                       CSD015
     C                     CALL 'SDWLCLOP'                                                    CSD015
     C                     PARM           WLTDS                                               CSD015
     C                     PARM *BLANKS   PSTRNG                                              CSD015
      *                                                                                       CSD015
     C           EWATCH    ENDSR                                                              CSD015
      *                                                                                       CSD015
      *****************************************************************                       CSD015
      /EJECT                                                                                  CSD015
     C********************************************************************
     C*          SUBROUTINE TO SET UP DATA STRUCTURE
     C*                     FOR DATABASE ERRORS.
     C*
     C*    ERROR     CAUSE
     C*       01     VALID I.C.R.-1 RECORD NOT FOUND.
     C*       02     VALID I.C.R.-2 RECORD NOT FOUND.
     C*       03     VALID CURRENCY RECORD NOT FOUND.
     C*       04     UNSUCCESSFUL CHAIN TO LF/OTPAY.
     C*       05     UNSUCCESSFUL CHAIN TO LF/CQPAC.
     C*       06     UNSUCCESSFUL CHAIN TO LF/NTRAN.
     C*
     C           DBERR     BEGSR                             *** DBERR ***
     C*
     C           *NAMVAR   DEFN LDA       DLDA
     C           *LOCK     IN   DLDA
     C                     MOVEL'FT0656'  DBPGM            ) SET UP
     C*********************MOVE DBFNAM    DBFILE           ) DATA BASE    S01117
     C                     MOVELDBFNAM    DBFILE           ) DATA BASE    S01117
     C                     MOVELDBERKY    DBKEY            ) ERROR
     C                     MOVE *BLANKS   DBASE                           S01117
     C                     MOVE DBERR#    DBASE            ) FIELDS
     C                     OUT  DLDA
     C                     SETON                     78                   S01117
     C                     Z-ADD1         PAGEAU                          S01117
     C                     WRITEHEADAU                                    S01117
     C                     SETON                     U7U8LR
     C                     DUMP
     C                     RETRN
     C*
     C                     ENDSR                             *** DBERR ***
     C/EJECT
     C********************************************************************
     C/EJECT
     O*
      *                                                                   S01408
     O/COPY WNCPYSRC,FT0656OOP1                                           S01408
      *                                                                   S01408
** FILE TRANS. SPEC. PRINT MSGS AS THEY WILL BE AFTER MS0200 (NO INV.CHRS)
*EQUATE FT0656P1,MGOMSGPD
*EQUATE 4E504B5E7D7F4DC05DD060CD6F5A6F5B6F4A6F6C6F5C6F4C6F7E6F6E6F7C6FE0D57B6FA6
*EQUATE 6F4F6F5F7D7960A1606D
     X/COPY WNCPYSRC,FT0656X001
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
