     H        1
      *****************************************************************
/*XBIA*  OVRDBF INPAYJ2 INPAYXJ0
/*XBIB*  OVRDBF OTPAYJ2 OTPAYXJ0
/*XBIC*  OVRDBF FT101X0 FT101HPD
/*XBID*  OVRDBF FT102X0 FT102HPD
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas FT Payments reporting/authorisation')            *
      *****************************************************************
      *                                                               *
      *  Midas - Funds Transfer Module.                               *
      *                                                               *
      *  FT0803 - Payments Reporting/Authorisation                    *
      *                                                               *
      *  Function:  This program Reports/Authorises batch of          *
      *             Outgoing and Incoming payments using the          *
      *             selection criteria from FT0801.                   *
      *                                                               *
      *  Called by: FTC0803 - Check for insufficient funds.           *
      *                                                               *
      *  Calls    : FT0805 - Checking for insufficient funds.         *
      *             ME1050 - Update status of network message         *
      *             FT0315 - Format fields for Report/Message/Screen  *
      *                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. CSD103             Date 10Aug20               *
      *  Prev Amend No. CSW220             Date 09Mar20               *
      *                 MD046248           Date 27Oct17               *
      *                 MD045438           Date 02May17               *
      *                 MD041081           Date 29Mar17               *
      *                 MD042279           Date 28Oct16               *
      *                 216511             Date 31May07               *
      *                 CFT151             Date 28Sep12               *
      *                 CFT120             Date 28Sep12               *
      *                 AR787620           Date 10Jun11               *
      *                 CRE075             Date 06Dec10               *
      *                 CER059             Date 19Jul10               *
      *                 BUG24029           Date 20May09               *
      *                 CER054             Date 07Apr09               *
      *                 BUG22580           Date 02Feb09               *
      *                 CER048             Date 19May08               *
      *                 CER047             Date 19May08               *
      *                 CER030             Date 09Jul08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 CSW209             Date 01Apr09               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 CSW207             Date 12Jun07               *
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CFT032             Date 11Sep06               *
      *                 CDL049             Date 07Jul06               *
      *                 BUG11679           Date 05Jul06               *
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CSW037A            Date 02May05               *
      *                 BUG6198            Date 04Apr05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 TDA020             Date 14Apr04               *
      *                 221761             Date 14Apr04               *
      *                 CRE020             Date 20Jan04               *
      *                 CGL029             Date 01Sep03               *
      *                 CSW203             Date 26May03               *
      *                 CSD015             Date 14Oct02               *
      * Midas Release 4.01.03 ----------------------------------------*
      *                 211662             Date 20Nov02               *
      * Midas Release 4.01 -------------------------------------------*
      * Midas Release 4 --------------- Base -------------------------*
      *                 CSW201             Date 02May01               *
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CFT009             Date 01Jun00               *
      * Midas DBA 3.04 -----------------------------------------------*
      *                 185107             Date 17Oct00               *
      *                 184060             Date 22Sep00               *
      *                 CFT014             Date 25May00               *
      * Midas DBA 3.03 -----------------------------------------------*
      *                 CAP136             Date 15Nov99               *
      *                 175479             Date 07Feb00               *
      *                 CFT006             Date 28Oct99               *
      * Midas DBA 3.02 -----------------------------------------------*
      *                 166281             DATE 24Aug99               *
      *                 166587             DATE 26Aug99               *
      *                 CFT004             DATE 27Jul99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CFT003  *CREATE    Date 06May98               *
      *                                                               *
      *---------------------------------------------------------------*
      *                                                               *
      *  CSD103 - LIBOR Deregulation - Common Layer/Standing Data     *
      *  CSW220 - SWIFT Changes 2020 (Recompile)                      *
      *  MD046248 - Finastra Rebranding                               *
      *  MD045438 - Unable to start COB due to Outstanding Payments   *
      *             issue.                                            *
      *  MD041081 - FTC0803 job fails with CPF5004. Recompile due to  *
      *             changes in FT0803P3.                              *
      *  MD042279 - DB error 005 when Sender if full GL account.      *
      *             Increase length of variable to 24 to consider     *
      *             10 digits account code.                           *
      *  216511 - Validate account.                                   *
      *  CFT151 - FT IN/OP Alphanumeric sequence                      *
      *  CFT120 - FT IN/OP - Charges to DR of Account Currency        *
      *           (Recompile)                                         *
      *  AR787620 - Hooks Incorporation                               *
      *             WNCPYSRC,FTH00087                                 *
      *             WNCPYSRC,FTH00088                                 *
      *             WNCPYSRC,FTH00089                                 *
      *             WNCPYSRC,FTH00090                                 *
      *             WNCPYSRC,FTH00091                                 *
      *  CRE075 - Effective Date for Retail Accounts (Recompile)      *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  BUG24029 - COB Error RE3662 Database Error                   *
      *  CER054 - German Features - Church Tax (Recompile)            *
      *  BUG22580 - Fields incorrectly labeled and lengths            *
      *           (Recompile)                                         *
      *  CER048 - German Features - Taxes (Recompile)                 *
      *  CER047 - German Features LF037-00 Reporting §24c KWG         *
      *           (Recompile)                                         *
      *  CER030 - Multicash German Feature                            *
      *  CSW209 - SWIFT 2009 Changes                                  *
      *  CSW207 - SWIFT 2007 Changes                                  *
      *  CFT032 - Account Line in Field 50X in MT103                  *
      *  CDL049 - Addition of a Reference Rate field (recompile)      *
      *  BUG11679 - Additional Conversion of Customer Number to Alpha.*
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  BUG6198- Cannot save new Details for CUSD (Recompile)        *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  TDA020 - Rename RSEQNO in FT101HPD as it conflicts with      *
      *           RSEQNO of READVCPD.                                 *
      *  221761 - Remove SNDREF as key as FT101HL6 is already unique  *
      *           on RFTID.                                           *
      *  CRE020 - Midas Plus Online Printing of Advices (GE7)         *
      *  CGL029 - Increase Account Code to 10 digits (Recompile)      *
      *  CSW203 - SWIFT 2003 Standards Update                         *
      *  CSD015 - Midas Compliance Watch - Watch List Checking        *
      *  211662 - Call QSYS/QUSRJOBI to retrieve the username that    *
      *           submitted job FTC0803.                              *
      *  CSW201 - SWIFT 2001 Standards Update                         *
      *  CFT009 - FT Fees and Charge Development                      *
      *  185107 - Mapping of details from swift message - Recompile   *
      *  184060 - No transaction type code in detail screen -Recompile*
      *  CFT014 - Straight-through Processing Phase 2 MT103           *
      *           Messages Generation for FT.                         *
      *  CAP136 - Conversion of FT Incoming Payment inputs into       *
      *           modular structure to use as APIs.                   *
      *  175479 - Incorporate Fontis : dealer's reference             *
      *  CFT006 - Funds Transfer addition of MT101 and MT102 messages *
      *  166281 - Wrong account checked during authorisation process  *
      *  166587 - FT Batch Auth., wrong Authorisation level check     *
      *  CFT004 - International Bank Account Number                   *
      *           New Account Type 'I' (IBAN)                         *
      *  CFT003 - FT Batch Authorisation                              *
      *           Based on FTH003 original references:                *
      *           CFT078/098526/092142/090273/068147/IMP068/IMP048    *
      *           IMP044/IMP040/IMP039/DBF139/HUB01B                  *
      *                                                               *
      *****************************************************************
     FINPAYJ2 IF  E           K        DISK
     F** Midas Join Logical file for INPAYDD and INPAYXPD
     FOTPAYJ2 IF  E           K        DISK
     F** Midas Join Logical file for OTPAYDD and OTPAYXPD
     FINPAY   UF  E           K        DISK
     F                                              KCOMIT
     F** Midas Incoming payments file/LF
     FOTPAY   UF  E           K        DISK                      A
     F                                              KCOMIT
     FOTPAYZZ UF  E                    DISK
     F                                              KCOMIT
     FINPAYXL0UF  E           K        DISK
     F                                              KCOMIT
     F** Midas Incoming payments Extension file/LF
     FOTPAYXL0UF  E           K        DISK                      A
     F                                              KCOMIT
     F** Midas Outgoing payments Extension file/LF
     FFTCONTL0UF  E           K        DISK
     F                                              KCOMIT
     F** Midas Outgoing payments Extension file/LF
     FSDCUSTL7IF  E           K        DISK
     F** Midas Customer details logical File on SWIFT ID
     FMEINCRL1IF  E           K        DISK
     F* IMM Incoming Msg Control File
     FFT101X0 IF  E           K        DISK                               CFT006
     FFT102X0 IF  E           K        DISK                               CFT006
     FFT101HL3UF  E           K        DISK                               CFT006
     F                                              KCOMIT                CFT006
     F            FT101HD0                          KRENAMEFT101H         CFT006
     FFT102HL3UF  E           K        DISK                               CFT006
     F                                              KCOMIT                CFT006
     F            FT102HD0                          KRENAMEFT102H         CFT006
     FFT101HL6IF  E           K        DISK                               CFT006
     F            FT101HD0                          KRENAMEFT101H6        CFT006
     FFT102HL5IF  E           K        DISK                               CFT006
     F            FT102HD0                          KRENAMEFT102H5        CFT006
     FFT101DL2IF  E           K        DISK                               CFT006
     FFT102DL1IF  E           K        DISK                               CFT006
     FFT0803P1O   E             10     PRINTER                        UC
     F                                              KINFDS SPOOL1
     F** Midas AutoGen Payments Detail Report
     FFT0803P2O   E                    PRINTER                        UC
     F                                              KINFDS SPOOL2
     F** Midas NonAutogen Payments Detail Report
     FFT0803P3O   E                    PRINTER                        UC
     F                                              KINFDS SPOOL3
     F** Midas Payments Exception Detail Report
     FFT0803AUO   E             11     PRINTER                        UC
     F                                              KINFDS SPOOLA
     F** Midas Autogen Payments Audit report
      *                                                                                       CSD015
     FSDCWHTL1IF  E           K        DISK                                                   CSD015
      ** Compliance Watch Hit List File                                                       CSD015
      *                                                                                       CSD015
      ** Retail Advice Index File                                                             CRE020
     FREADVCL1UF  E           K        DISK         KCOMIT       A    UC                      CRE020
      *                                                                                       CRE020
     F/COPY WNCPYSRC,FT0803F001
     F*****************************************************************
     F/EJECT
     F* ID F  C  H  L    FUNCTION OF INDICATORS                       *
     F*                                                               *
     F*       11         Overflow indicator                           *
     F*       12         Write footer indicator                       *
      *       14         SWIFT 2009 feature is installed.             *                       CSW209
      *       20         Display set 2 of senders charges fields      *                       CSW201
      *       21         Display set 3 of senders charges fields      *                       CSW201
      *       22         Display set 4 of senders charges fields      *                       CSW201
      *       23         Display set 5 of senders charges fields      *                       CSW201
      *       24         CSW201 enhancement is installed              *                       CSW201
     F*       28         Database error occured                       *
     F*       29         ON-Incoming process, OFF-Outgoing process    *
     F*       30         ON-Reporting, OFF-Authorisation              *
     F*       31         BACK VALUED PAYMENT indicator                *
     F*       32         INSUFFICIENT FUNDS indicator                 *
     F*       33         AMOUNT ABOVE THRESHOLD LIMIT indicator       *
     F*       34         No outgoing payment processed                *
     F*       35         No incoming payment processed                *
     F*       36         No records in OTPAYJ2                        *
     F*       37         No records in INPAYJ2                        *
     F*       38         FT0803AU is open                             *
     F*       39         FT0803P1 is open                             *
     F*       40         FT0803P2 is open                             *
     F*       41         FT0803P3 is open                             *
     F*       42         Work indicator                               *
     F*       43         Chain FT101HL6                               *   CFT006
     F*       44         Chain FT102HL5                               *   CFT006
     F*       45         CFT009 IS ON                                 *   CFT009
     F*       51         ON-Regular Payment                           *
     F*       52         ON-NonAutogen, OFF-Autogen                   *
     F*       54         Add/Deduct Charges (ON-'A', OFF-'D')         *
     F*       56         Read FT101X0                                 *   CFT006
     F*       57         Read FT102X0                                 *   CFT006
     F*       58         No records in FT101X0                        *   CFT006
     F*       59         No records in FT102X0                        *   CFT006
     F*       60         Chain FT101HL3                               *   CFT006
     F*       61         End of file for LF/OTPAYJ2                   *
     F*       62         End of file for LF/INPAYJ2                   *
     F*       63         End of file for LF/OTPAY                     *
     F*       64         End of file for LF/INPAY                     *
     F*       65         Error on write to OTPAY                      *
     F*       66         Error on write to INPAY                      *
     F*       67         End of file for LF/SDCUSTL7                  *
     F*       68         Chain FT102HL3                               *   CFT006
     F*       72         Chain FT101DL2                               *   CFT006
     F*       73         Chain FT102DL1                               *   CFT006
     F*       75         Chain to MEINCRL1 fail                       *
     F*       88         Multibranching YES                           *
     F*       98         Date Format indicator (DDMMYY/MMDDYY)        *
     F*       U7         System error, wrong status                   *
     F*       U8         Database error                               *
     F*                                                               *
     F*****************************************************************
     F*                                                               *
     F*           INDEX TO SUBROUTINES                                *
     F*                                                               *
     F*   INIT     - Initialisation                                   *
     F*   DETL     - Detail Processing                                *
     F*   TERM     - Termination Processing                           *
     F*   SYSL     - System Level Processing                          *
     F*   SINB     - Single Branch Processing                         *
     F*   ALLB     - ALL Branch Processing                            *
     F*   RFTDTL   - RFT processing                                   *   CFT006
     F*   RFTAUT   - RFT processing - autogen report                  *   CFT006
     F*   RFTNAU   - RFT processing - non-autogen report              *   CFT006
     F*   CCTDTL   - CCT processing                                   *   CFT006
     F*   CCTAUT   - CCT processing - autogen report                  *   CFT006
     F*   CCTNAU   - CCT processing - non-autogen report              *   CFT006
     F*   ODTL     - Get other details for the report                 *
     F*   EXCP     - Exception Processing                             *
     F*   AUGN     - Autogen Processing                               *
     F*   NAUG     - Non-AutoGen processing                           *
     F*   PAYA     - Payments Authorisation                           *
     F*   GENO     - Generate Outgoing Payments                       *
     F*   INCR     - Check the source network                         *
     F*   DMPYT    - De-marked Payment                                *
     F*   #HGETA   - Get customer name and adress                     *
     F*   SRINFT   - Update Incoming message FT Transaction Status    *
      *  POPINR - Populate Incoming Extended Narrative                *                       CER030
      *  POPONR - Populate Outgoing Extended Narrative                *                       CER030
      *  POPRTY - Populate Transaction Type                           *                       CER030
     F*   *PSSR    - Error processing                                 *
     F*                                                               *
     F*****************************************************************
     E/EJECT
     E*
     E/COPY ZSRSRC,ZDATE2Z1
     E/COPY ZSRSRC,ZFRPEDZ1
     E/COPY ZSRSRC,ZEDITZ1
     E                    CPY@    1   1 80                   COPYRIGHT
     E**********          WKA        22  1                   Accnt array                      CGL029
     E                    WKA        28  1                                                    CGL029
     E                    HKA     1  35 35                   Remarks array
     E                    POWER   1   7  7 3                 POWERS TABLE
     E                    @SM       100  2                   EXT SETT CODE
     E                    @DFT    1   1 35                   Default Text
      *
      *  Subroutine stack
      *
     E                    @STK       20 10
      *
      *  Error texts
      *
     E                    ERR@    1   1 80
     E                    DCC     1   3  3                                                    CRE020
     I/EJECT
      *                                                                                       CRE020
      ** Declare CRE020 System Value Constants                                                CRE020
      *                                                                                       CRE020
     I              'Out/RegularPayments' C         OTSVAL                                    CRE020
     I              'IncomingPayments'    C         INSVAL                                    CRE020
     IFT102HD0                                                            CFT006
     I              SINST                           CSINST                CFT006
     I              INUSER                          CINUSE                CFT006
     I**  CCT Header                                                      CFT006
     I*                                                                   CFT006
     IFT102H                                                              CFT006
     I              SINST                           DSINST                CFT006
     I**  CCT Header                                                      CFT006
     I*                                                                   CFT006
     IFT102H5                                                             CFT006
     I              SINST                           DSINS2                CFT006
     I**  CCT Header                                                      CFT006
     I*                                                                   CFT006
      ** Rename Field                                                                         TDA020
     IFT101HD0                                                                                TDA020
     I              RSEQNO                          RSEQND                                    TDA020
     IFT101H                                                                                  TDA020
     I              RSEQNO                          RSEQN0                                    TDA020
     IFT101H6                                                                                 TDA020
     I              RSEQNO                          RSEQN6                                    TDA020
      *                                                                                       TDA020
     I              'FTM101CFM'           C         RFTUPD                CFT006
     I              'FTM102CFM'           C         CCTUPD                CFT006
     I/COPY ZSRSRC,ZFRPEDZ2
     IINFT      E DSMEINFTPD
      *
      *  Define parameters to be passed for FT IMM update
      *
     ISPOOL1      DS
     I*  Information Data Structure for printer FT0803P1
     I                                       83  92 FILE1
     I                                    B 123 1240FNUM1
     I*
     ISPOOL2      DS
     I*  Information Data Structure for printer FT0803P2
     I                                       83  92 FILE2
     I                                    B 123 1240FNUM2
     I                                    B 367 3680PLINE2                                    CER030
     I*
     ISPOOL3      DS
     I*  Information Data Structure for printer FT0803P3
     I                                       83  92 FILE3
     I                                    B 123 1240FNUM3
     I*
     ISPOOLA      DS
     I*  Information Data Structure for printer FT0803AU
     I                                       83  92 FILEA
     I                                    B 123 1240FNUMA
      *
      *  Send message data structure
      *
     IDBDTA       DS
     I                                        1  10 @BPGM
     I                                       11  20 @BFILE
     I                                       21  50 @BKEY
     I                                       51  550@BERNB
     I                                       56 135 @BNARR
     I                                      136 145 @BSTK
     I                                      146 175 @BPREF
     I*
     I           SDS
     I**  Program status data structure
     I*
     I                                     *PARMS   PGMPRM
     I                                        1  10 ##PGM
     I                                      244 253 WSDEV
     I                                      254 263 WSUSR
     I*
     IP#USRJ      DS                            136                                           211662
      ** QUSRJOBI data structure                                                              211662
      *                                                                                       211662
     I                                      127 136 J#SUSR                                    211662
     I            DS                                                                          211662
     I                                    B   1   40P#LEN                                     211662
     I*                                                                                       211662
     ILDA         DS                            256
     I**  Local data area data structure
     I*
     I                                      134 141 DBFILE
     I                                      142 170 DBKEY
     I                                      171 180 DBPGM
     I                                      181 1830DBASE
     IDSRUN       DS
     I**  RUNDAT data area data structure (date format -ddmmmyy)
     I*
     I                                        1   7 RUNA
     I                                       12  12 DATF
     I                                       13  13 MBIN
     I           UDS
     I**  Data Area Data structure for *LDA
     I*
     I                                        1 130 @@RPRM
     I                                        1   1 @RAIN
     I                                        2  16 @FTRN
     I                                       17  31 @TTRN
     I                                       32  36 @FSVD
     I                                       37  41 @TSVD
     I                                       42  46 @FPVD
     I                                       47  51 @TPVD
     I                                       52  53 @PTYP
     I                                       54  55 @PSTY
     I                                       56  58 @SCCY
     I                                       59  61 @PCCY
     I                                       62  66 @NCDE
     I                                       67  68 @SMTH
     I                                       69  69 @CPIN
     I                                       70  70 @TAGI
     I                                       71  80 @USER
     I                                       81  90 @OPR1
     I                                       91 100 @OPR2
     I                                      101 110 @OPR3
     I                                      111 120 @OPR4
     I                                      121 130 @OPR5
     I@DSTN       DS
     I**  Data structure for Destination
     I*
     I                                        1  35 DST1
     I*
     I                                        1   5 @DSNS
     I                                        1   3 @DSNC
     I                                        4   5 @DSNN
     I*
     I                                        1  10 @DSRT
     I*
     I**********                              1  18 @DSAN                                     CGL029
     I                                        1  24 @DSAN                                     CGL029
     I                                        7   9 @DSCY
     I**********                             10  13 @DSAC                                     CGL029
     I**********                             14  15 @DSAS                                     CGL029
     I**********                             16  18 @DSBR                                     CGL029
     I                                       10  19 @DSAC                                     CGL029
     I                                       20  21 @DSAS                                     CGL029
     I                                       22  24 @DSBR                                     CGL029
     I*
     I                                        1   6 @DSCN
     I                                        1  10 @DSCS
     I*
     I                                        1  12 @DSSA
     I@SNDR       DS
     I**  Data structure for Sender
     I*
     I                                        1  35 SND1
     I*
     I                                        1   5 @SNNS
     I                                        1   3 @SNNC
     I                                        4   5 @SNNN
     I*
     I                                        1  10 @SNRT
     I*
     I**********                              1  18 @SNAN                                     CGL029
     I                                        1  24 @SNAN                                     CGL029
     I                                        7   9 @SNCY
     I**********                             10  13 @SNAC                                     CGL029
     I**********                             14  15 @SNAS                                     CGL029
     I**********                             16  18 @SNBR                                     CGL029
     I                                       10  19 @SNAC                                     CGL029
     I                                       20  21 @SNAS                                     CGL029
     I                                       22  24 @SNBR                                     CGL029
     I*
     I                                        1   6 @SNCN
     I                                        1  10 @SNCS
     I*
     I                                        1  12 @SNSA
     I@SNCO       DS
     I**  Data structure for Sender's Correspondent
     I*
     I***********                             1  100SNCO                                      CSD027
     I                                        1  10 SNCO                                      CSD027
     I                                        1  10 @SCRT
     I                                        1   2 @SCNN
     I*
     I                                        1  35 SNC1
     I                                        1  12 @SCSW
     I@ORBK       DS
     I**  Data structure for Ordering Bank
     I*
     I**********                              1  120ORBK                                      CGL029
     I***********                             1  180ORBK                               CGL029 CSD027
     I                                        1  18 ORBK                                      CSD027
     I                                        1  10 @OBRT
     I                                        1   2 @OBNN
     I                                        1   6 @OBCN
     I**********                              7  10 @OBAC                                     CGL029
     I**********                             11  12 @OBAS                                     CGL029
     I**********                             13  15 @OBBR                                     CGL029
     I                                        7  16 @OBAC                                     CGL029
     I                                       17  18 @OBAS                                     CGL029
     I                                       19  21 @OBBR                                     CGL029
     I*
     I                                        1  35 ORB1
     I                                        1  12 @OBSW
     I@ORCS       DS
     I**  Data structure for Ordering Customer
     I*
     I**********                              1  35 ORC1                                      CFT032
     I                                        1  34 @ORC1                                     CFT032
     I                                        1  10 @OCRT
     I                                        1   6 @OCCN
     I**********                              7  10 @OCAC                                     CGL029
     I**********                             11  12 @OCAS                                     CGL029
     I                                        7  16 @OCAC                                     CGL029
     I                                       17  18 @OCAS                                     CGL029
     I*
     I**********                              1  12 @OCSW                                     CGL029
     I                                        1  18 @OCSW                                     CGL029
     I*
     I@RCCO       DS
     I**  Data structure for Receiver's Correspondent
     I*
     I                                        1  35 RCO1
     I***********                             1   6 @RCCN                 CFT014
     I                                        1   5 @RCCN                 CFT014
     I                                        1  10 @RCCS
     I                                        1  12 @RCSW
     I*
     I***********                             1  100RCCO                  CFT014
     I                                        1   2 @RCNN
     I                                        1  10 @RCRT
      *                                                                   CFT014
     I                                        1  35 INRCO1                CFT014
      *                                                                   CFT014
     IWOTRI1      DS                                                      CFT014
     I                                        1  35 OPTRI1                CFT014
     I                                        1   6 WTRCUS                CFT014
     I                                        1  12 WTRSID                CFT014
      *                                                                   CFT014
     I            DS                                                      CFT014
     I**********                              1  15 WACNT                              CFT014 CGL029
     I                                        1  21 WACNT                                     CGL029
     I                                        1   6 FCNUM                 CFT014
     I                                        7   9 FCCY                  CFT014
     I**********                             10  13 FACOD                              CFT014 CGL029
     I**********                             14  15 FACSQ                              CFT014 CGL029
     I                                       10  19 FACOD                                     CGL029
     I                                       20  21 FACSQ                                     CGL029
      *                                                                   CFT014
     I            DS                                                      CFT014
     I                                        1  34 WINTRB                CFT014
     I**********                              1  15 TPACNT                             CFT014 CGL029
     I**********                             16  18 TPBRCA                             CFT014 CGL029
     I                                        1  21 TPACNT                                    CGL029
     I                                       22  24 TPBRCA                                    CGL029
      *                                                                   CFT014
     I/COPY FTCPYSRC,FT0010I001                                           CFT014
      *                                                                   CFT014
     I@ACB1       DS
     I**  Data structure for Account With Bank - outgoing
     I*
     I                                        1  35 ACB9
     I                                        1   6 @ACCN
     I                                        1  10 @ACCS
     I                                        1  12 @ACSW
     I*
     I**********                              1  12 ACBK                                      CGL029
     I                                        1  18 ACBK                                      CGL029
     I                                        1   2 @ACNN
     I                                        1  10 @ACRT
     I**********                              7  10 @ACAC                                     CGL029
     I**********                             11  12 @ACAS                                     CGL029
     I**********                             13  15 @ACBB                                     CGL029
     I                                        7  16 @ACAC                                     CGL029
     I                                       17  18 @ACAS                                     CGL029
     I                                       19  21 @ACBB                                     CGL029
     I@BENC       DS
     I**  Data structure for Beneficiary Customer
     I*
     I                                        1  35 BNC9
     I                                        1   6 @BNCN
     I                                        1  10 @BNCS
     I                                        1  12 @BNSW
     I                                        1  18 @BNSW2                                    CGL029
     I**********                             13  15 @BNBR                                     CGL029
     I                                       19  21 @BNBR                                     CGL029
     I*
     I**********                              7  10 @BNAC                                     CGL029
     I**********                             11  12 @BNAS                                     CGL029
     I                                        7  16 @BNAC                                     CGL029
     I                                       17  18 @BNAS                                     CGL029
     I                                        1  10 @BNRT
     I@INBK       DS
     I**  Data structure for intermediary Bank
     I*
     I                                        1  35 INB9
     I                                        1   6 @IBCN
     I                                        1  10 @IBCS
     I                                        1  12 @IBSW
     I*
     I** Sender DS being used in generating OP from IN payments.
     IFGLNO       DS
     I**********                              1   60@@CNUM                                    CSD027
     I                                        1   6 @@CNUM                                    CSD027
     I                                        7   9 @@CCY
     I**********                             10  130@@ACOD                                    CGL029
     I**********                             14  150@@ACSQ                                    CGL029
     I**********                             16  18 @@BRCA                                    CGL029
     I                                       10  190@@ACOD                                    CGL029
     I                                       20  210@@ACSQ                                    CGL029
     I                                       22  24 @@BRCA                                    CGL029
     I*
     I** Data structure redefining ORBK for keys
     I*
     I            DS
     I**********                              1   60ORNUM                                     CSD027
     I                                        1   6 ORNUM                                     CSD027
     I**********                              7  100ORCOD                                     CGL029
     I**********                             11  120ORSEQ                                     CGL029
     I**********                              1  12 ORBKS                                     CGL029
     I                                        7  160ORCOD                                     CGL029
     I                                       17  180ORSEQ                                     CGL029
     I                                        1  18 ORBKS                                     CGL029
      *
      * Funds Transfer Default Account
      *
     I***FTDFAC*     DS                             12                                        CGL029
     IFTDFAC      DS                             18                                           CGL029
     I**********                              1   60OBCNUM                                  BUG11679
     I                                        1   6 OBCNUM                                  BUG11679
     I**********                              7  100OBACOD                                    CGL029
     I**********                             11  120OBACSQ                                    CGL029
     I**********                              1  120OBFTAC                                    CGL029
     I                                        7  160OBACOD                                    CGL029
     I                                       17  180OBACSQ                                    CGL029
     I**********                              1  180OBFTAC                             CGL029 CSD027
     I                                        1  18 OBFTAC                                    CSD027
     I@ACCT       DS
     I**  Data structure for Account key
     I*
     I**********                              1  15 @ACNT                                     CGL029
     I                                        1  21 @ACNT                                     CGL029
     I**********                              1   60HCNUM                                   BUG11679
     I                                        1   6 HCNUM                                   BUG11679
     I                                        1   6 @CNNM
     I                                        7   9 HCCY
     I**********                             10  130HACOD                                     CGL029
     I**********                             10  13 @ACOD                                     CGL029
     I**********                             14  150HACSQ                                     CGL029
     I**********                             14  15 @ACSQ                                     CGL029
     I                                       10  190HACOD                                     CGL029
     I                                       10  19 @ACOD                                     CGL029
     I                                       20  210HACSQ                                     CGL029
     I                                       20  21 @ACSQ                                     CGL029
     I@PAYR       DS
     I**  Data structure to define payment reference
     I*
     I                                        1  15 @PREF
     I                                        1   1 @PAYM
     I                                        2   7 @RUND
     I                                        2   3 @YY
     I                                        4   5 @MM
     I                                        6   7 @DD
     I********                                8  110@PSEQ                                     CFT151
     I                                        8  11 @PSEQ                                     CFT151
     I                                       12  13 @PYTP
     I                                       14  150@STMT
     I/COPY WNCPYSRC,FTH00087
      *
      ** Split name into components.
     IXNAMDS      DS                            175
     I                                        1  35 XADD1
      **            address lines 2 - 5.
     I                                       36  70 XADD2
     I                                       71 105 XADD3
     I                                      106 140 XADD4
     I                                      141 175 XADD5
      *                                                                   CFT014
     I***WACCN**     DS                            553                                 CFT014 CGL029
     IWACCN       DS                            573                                           CGL029
     I**********                              2   70WWCNUM                             CFT014 CSD027
     I                                        2   7 WWCNUM                                    CSD027
     I                                        8  10 WWCCY                 CFT014
     I**********                             11  140WWACOD                             CFT014 CGL029
     I                                       11  140QQACOD                                    CGL029
     I                                       15  160WWACSQ                CFT014
     I                                       23  25 WWBRCA                CFT014
     I                                      554 5630WWACOD                                    CGL029
      *
     IWCDET       DS                             24                                           CFT032
     I                                        1   6 WDCNUM                                    CFT032
     I                                        7   9 WDCCY                                     CFT032
     I                                       10  190WDACOD                                    CFT032
     I                                       20  210WDACSQ                                    CFT032
     I                                       22  24 WDBRCA                                    CFT032
      *
     I***OTPAYD    E DSOTPAYDA                                                                CFT151
     IOTPAYD      DS                                                                          CFT151
     I                                        1   40WOTSQ                                     CFT151
     I**  Data Structure for Payment Ref sequence number
     I*
     ISDBANK    E DSSDBANKPD
     I**  Data Structure for Bank Details Access Program
     I*
     I              BJURPT                          TITL
     I              BJRDNB                          RUND
     ISDCURR    E DSSDCURRPD
     I**  Data Structure for Currency Details Access Program
     I*
     I              A6SPRT                          EXRT
     I              A6MDIN                          MLDV
     ISDFTFR    E DSSDFTFRPD
     I**  Data Structure for Funds Transfer ICD file
     I*
     I              BTAUDT                          AUDT
     ISDNAHO    E DSSDNAHOPD                                                                  CSW207
     I**  Data Structure for Additional Cust Details Access Program                           CSW207
     I*                                                                                       CSW207
     ISDCUST    E DSSDCUSTPD
     I**  Data structure for customer file
     I*
     ISDBRCH    E DSSDBRCHPD
     I              QQDFAC                          QQDFC1                                    CGL029
     I**  Data structure for branch file
     I*
     ISDACCT    E DSACCNTAB
     I*  Data structure for account Details
     I*
     ISDNOST    E DSSDNOSTPD
     I** Data Structure for Nostro Details
     I*
     ISCSARD    E DSSCSARDPD                                              CFT006
      *                                                                   CFT006
     I              LCD                             SCLCD                 CFT006
      * External data structure for SAR file details                      CFT006
      *                                                                   CFT006
     ISDCNST    E DSSDCNSTPD                                                                  CFT032
      *                                                                                       CFT032
      ** Calling parameter data structure for ME1400                                          CFT032
      *                                                                                       CFT032
     IMEBICD    E DSMEBICDPD                                                                  CFT032
      *                                                                                       CFT032
      ** Calling parameter data structure for ME1400                                          CFT032
      *                                                                                       CFT032
     IDSSDY     E DSDSSDY
     I** Short Data Structure
     I*                                                                                     BUG24029
     IDSLDY     E DSDSLDY                                                                   BUG24029
     I** Short Data Structure                                                               BUG24029
     I*
     IDSFDY     E DSDSFDY
     I** Long Data Structure
     I*
     IW8FT        DS                            128
      *
      * Address data structure
      *
      * Currency
     I                                        1   3 W8CCY
      * Settlement Type
     I                                        4   5 W8STMT
      * Mandatory Text - convert BIC identifiers
     I                                        6   6 W8MTXT
      * Message Tag
     I                                        7  11 W8MTAG
      * Construct of data in field
     I                                       12  12 W8TYPE
      * Number of Lines available
     I                                       13  140W8NLIN
      * Network and Message Type
     I                                       15  20 W8NWRK
     I                                       21  23 W8MTPY
      * Calling Program
     I                                       24  33 W8CPGM
      * Action *PRINT/*ENQ/*MSG GEN
     I                                       34  41 W8ACT
     I*
     IW8MSG       DS                            256
      * Warning message returned after calling FT0315
      *
     I                                        1  35 W8MSG1
     I                                       36  70 W8MSG2
      ** Swift Cover Message Information (Incoming)                                           CSW209
     IINPAYD    E DSINPAYXL0                                                                  CSW209
      ** Ordering Customer (Cover)                                                            CSW209
     I                                      8521026 DICOC1                                    CSW209
      ** Ordering Institution (Cover)                                                         CSW209
     I                                     10281202 DICOB1                                    CSW209
      ** Intermediary Institution (Cover)                                                     CSW209
     I                                     12041378 DICIB1                                    CSW209
      ** Account with Institution (Cover)                                                     CSW209
     I                                     13801554 DICAB1                                    CSW209
      ** Beneficiary Customer (Cover)                                                         CSW209
     I                                     15561730 DICBC1                                    CSW209
      ** Remittance Information (Cover)                                                       CSW209
     I                                     17311870 DICDP1                                    CSW209
      ** Sender to Receiver Info (Cover A)                                                    CSW209
     I                                     18712080 DICBB1                                    CSW209
      ** Instructed Currency (Cover)                                                          CSW209
     I                                     20812083 DICICY                                    CSW209
      ** Instructed Amount                                                                    CSW209
     I                                     208420970DICIAM                                    CSW209
      ** Swift Cover Message Information (Outgoing)                                           CSW209
     IOTPAYY    E DSOTPAYXL0                                                                  CSW209
     I              OPTRI1                          DHC1                                      CSW209
      ** Outgoing Validation Flag (Cover)                                                     CSW209
     I                                      867 874 DOOCVF                                    CSW209
      ** Ordering Customer (Cover)                                                            CSW209
     I                                      8761050 DOCOC1                                    CSW209
      ** Ordering Institution (Cover)                                                         CSW209
     I                                     10521226 DOCOB1                                    CSW209
      ** Intermediary Institution (Cover)                                                     CSW209
     I                                     12281402 DOCIB1                                    CSW209
      ** Account with Institution (Cover)                                                     CSW209
     I                                     14041578 DOCAB1                                    CSW209
      ** Beneficiary Customer (Cover)                                                         CSW209
     I                                     15801754 DOCBC1                                    CSW209
      ** Remittance Information (Cover)                                                       CSW209
     I                                     17551894 DOCDP1                                    CSW209
      ** Sender to Receiver Information (Cover B)                                             CSW209
     I                                     18952104 DOCBB1                                    CSW209
      ** Instructed Currency (Cover)                                                          CSW209
     I                                     21052107 DOCICY                                    CSW209
      ** Instructed Amount (Cover)                                                            CSW209
     I                                     210821210DOCIAM                                    CSW209
      ** Sender to Receiver Info (Cover A)                                                    CSW209
     I                                     21222331 DOOCB1                                    CSW209
      *                                                                                       CSW209
     ISDWLCC    E DSSDWLCCPD                                                                  CSD015
      ** Midas Functions for Watch List Checking Details File                                 CSD015
      *                                                                                       CSD015
     ISC24X7    E DS                                                                          CSD015
      ** 24x7 Status Dataarea                                                                 CSD015
      *                                                                                       CSD015
     ISDSTAT    E DS                                                                          CSD015
      ** SD Status Dataarea                                                                   CSD015
      *                                                                                       CSD015
     I/COPY WNCPYSRC,FT0803I001
     C/EJECT
     C*================================================================
     C*  P R O G R A M   S T A R T                                    *
     C*================================================================
     C                     MOVEACPY@      BIS@   80
     C*
     C**  Parameters for calling AOBANKR0
     C*
     C           #ABANK    PLIST
     C                     PARM *BLANKS   @RTCD   7
     C                     PARM '*FIRST  '@OPTN   7
     C           SDBANK    PARM SDBANK    DSFDY
     C*
     C**  Parameters for calling AOFTFRR0
     C*
     C           #AFTFR    PLIST
     C                     PARM *BLANKS   @RTCD   7
     C                     PARM '*FIRST  '@OPTN   7
     C           SDFTFR    PARM SDFTFR    DSFDY
     C*
     C           #ACUST    PLIST
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*KEY   ' @OPTN   7
     C                     PARM           @KEY1  10
     C                     PARM *BLANKS   @KYST   7
     C           SDCUST    PARM SDCUST    DSSDY
     C*
     C           #ABRCH    PLIST
     C                     PARM '*MSG   ' @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM           @BRCD   3
     C           SDBRCH    PARM SDBRCH    DSSDY
     C*
     C           #AACCT    PLIST
     C                     PARM *BLANKS   @RTCD   7
     C                     PARM '*KEY'    @OPTN   7
     C                     PARM           @RETL  10
     C                     PARM           @CNNM   6
     C                     PARM           @CUCD   3
     C**********           PARM           @ACCD   4                                           CGL029
     C                     PARM           @ACCD  10                                           CGL029
     C                     PARM           @ACSQ   2
     C                     PARM           @BRCD   3
     C           SDACCT    PARM SDACCT    DSSDY
     C*
     C           #ANOST    PLIST
     C                     PARM *BLANK    @RTCD   7
     C                     PARM '*KEY   ' @OPTN   7
     C                     PARM *BLANK    @KEYA   6
     C                     PARM           @KEYB   3
     C**********           PARM *BLANK    @KEYC   4                                           CGL029
     C                     PARM *BLANK    @KEYC  10                                           CGL029
     C                     PARM *BLANK    @KEYD   2
     C                     PARM           @KEYE   2
     C                     PARM *BLANKS   @KEYG   3
     C                     PARM *BLANKS   @KEYH  10
     C                     PARM *BLANKS   @KEYI   1
     C           SDNOST    PARM SDNOST    DSFDY
     C*
     C***  Access SAR details file to see if HUB00A is installed.
     C*
     C                     CALL 'AOSARDR0'
     C                     PARM *BLANKS   @RTCDE  7
     C                     PARM '*VERIFY' @OPTN   7
     C                     PARM 'HUB00A'  @SARD   6
     C*
     C           @RTCDE    IFEQ *BLANKS
     C                     MOVE 'Y'       HUB00A  1
     C                     ELSE
     C                     MOVE 'N'       HUB00A
     C                     END
     C*
     C                     Z-ADD0         HX      30
     C                     MOVEA*ZEROS    @SM
     C*
     C**  RCF Entry Parameters
     C*
     C           *ENTRY    PLIST
     C                     PARM           @@RSEQ  5
     C                     PARM           @@LVLP  1
     C                     PARM           @@BCH   3
     C                     PARM           @@PARM100
     C*
     C                     MOVEL*BLANKS   P#USRJ136                                           211662
     C                     MOVEL*BLANKS   P#JBNM 26                                           211662
      *                                                                                       211662
      ** Determine who submitted batch job FTC0803                                            211662
      *                                                                                       211662
     C                     CALL 'QUSRJOBI'             81                                     211662
     C                     PARM           P#USRJ                                              211662
     C                     PARM 136       P#LEN                                               211662
     C                     PARM 'JOBI0300'P#FTNM  8                                           211662
     C                     PARM '*'       P#JBNM 26                                           211662
     C                     PARM *BLANKS   P#INJI 16                                           211662
      *                                                                                       211662
      ** If no error occurred, move the username who submitted this job                       211662
      ** to field WSUSR (originally from system data struc.)                                  211662
      *                                                                                       211662
     C           *IN81     IFEQ '0'                                                           211662
     C           J#SUSR    ANDNE*BLANKS                                                       211662
     C                     MOVE *BLANKS   WSUSR                                               211662
     C                     MOVE J#SUSR    WSUSR                                               211662
     C                     ENDIF                                                              211662
     C*                                                                                       211662
     C/EJECT
     C*****************************************************************
     C*   MAIN  :    Main process                                     *
     C*   Calls :    INIT - Init process                              *
     C*              DETL - Detail processing                         *
     C*              TERM - Termination processing                    *
     C*****************************************************************
     C*
     C**  Perform initial process
     C*
     C                     EXSR INIT
     C*
     C**  Perform detail process
     C*
     C                     EXSR DETL
     C*
     C**  Perform termination process
     C*
     C                     EXSR TERM
     C/EJECT
     C*****************************************************************
     C*   INIT     : Initial processing                               *
     C*   Called by: Main process                                     *
     C*   Calls    : None                                             *
     C*****************************************************************
     C           INIT      BEGSR
     C                     CLEARSDACCT
     C*
     C** Setup indicators for the printer file
     C*
     C           @RAIN     IFEQ 'R'
     C                     MOVE '1'       *IN30
     C                     Z-ADD0         @NEXP   60
     C                     ELSE
     C                     MOVE '0'       *IN30
     C                     END                             -@RAIN
     C*
     C**  Set up OTPAYD data area
     C*
     C           *NAMVAR   DEFN OTPAYDA   OTPAYD
     C*
     C*
     C**  Set up LDA
     C*
     C           *NAMVAR   DEFN           LDA
     C           *LOCK     IN   LDA
     C                     MOVE *BLANKS   DBFILE
     C                     MOVE *BLANKS   DBKEY
     C                     MOVEL'FT0803'  DBPGM
     C                     MOVE *BLANKS   DBASE
     C                     OUT  LDA
     C*
     C**  Access data area DSRUN to find date
     C*
     C           *NAMVAR   DEFN RUNDAT    DSRUN
     C                     IN   DSRUN
     C*
     C**  If data area not found then perform database error processing
     C*
     C           RUNA      IFEQ *BLANKS
     C           *LOCK     IN   LDA
     C                     Z-ADD1         DBASE            ***************
     C                     MOVEL'RUNDAT'  DBFILE           * DBERR 001   *
     C                     MOVEL'FIRST'   DBKEY            ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
     C*
     C** Set-up for multibranching indicator
     C*
     C           MBIN      IFEQ 'Y'
     C                     MOVE '1'       *IN88
     C                     ELSE
     C                     MOVE '0'       *IN88
     C                     END
     C*
     C** Access Bank Details
     C*
     C                     CALL 'AOBANKR0'#ABANK
     C*
     C           @RTCD     IFNE *BLANKS
     C           *LOCK     IN   LDA
     C                     Z-ADD2         DBASE            ***************
     C                     MOVEL'FIRST   'DBKEY            * DBERR 002   *
     C                     MOVEL'SDBANKPD'DBFILE           ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
     C*
     C** Access FT ICD Details (get audit threshold)
     C*
     C                     CALL 'AOFTFRR0'#AFTFR
     C*
     C           @RTCD     IFNE *BLANKS
     C           *LOCK     IN   LDA
     C                     Z-ADD3         DBASE            ***************
     C                     MOVEL'FIRST   'DBKEY            * DBERR 003   *
     C                     MOVEL'SDFTFRPD'DBFILE           ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
     C*
     C** Check System Date Format, DDMMYY OR MMDDYY.
     C*
     C           DATF      IFEQ 'M'
     C                     MOVE '1'       *IN98
     C                     ELSE
     C                     MOVE '0'       *IN98
     C                     END                             -DATF
     C*
     C** Inititalize Trailer Details
     C*
     C                     Z-ADD0         HNOTR
     C                     Z-ADD0         HNOEX
     C                     Z-ADD0         HTOTN
     C*
     C** Access ccy d.p. of base currency.
     C*
     C                     CALL 'AOCURRR0'
     C                     PARM *BLANKS   @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM BJCYCD    @CCY    3
     C           SDCURR    PARM SDCURR    DSSDY
     C*
     C           @RTCD     IFNE *BLANKS
     C                     Z-ADD82        DBASE            ***************
     C                     MOVEL'SDCURRPD'DBFILE           * DBERR 082   *
     C                     MOVELSMCY      DBKEY            ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
     C                     MOVE A6NBDP    @BCDP   10
     C*
     C** Access ccy d.p. of local currency.
     C*
     C                     CALL 'AOCURRR0'
     C                     PARM *BLANKS   @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM BJCYCD    @CCY    3
     C           SDCURR    PARM SDCURR    DSSDY
     C*
     C           @RTCD     IFNE *BLANKS
     C                     Z-ADD83        DBASE            ***************
     C                     MOVEL'SDCURRPD'DBFILE           * DBERR 083   *
     C                     MOVELBJLCCY    DBKEY            ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
     C                     MOVE A6NBDP    @LCDP   10
      *                                                                   CFT004
      *** Check if CFT004 is switched on                                  CFT004
      *                                                                   CFT004
     C                     CALL 'AOSARDR0'                                CFT004
     C                     PARM '       ' @RTCD   7                       CFT004
     C                     PARM '*VERIFY' @OPTN                           CFT004
     C                     PARM 'CFT004'  @SARD   6                       CFT004
      *                                                                   CFT004
     C           @RTCD     IFEQ *BLANK                                    CFT004
     C                     MOVE 'Y'       CFT004  1                       CFT004
     C                     ELSE                                           CFT004
     C                     MOVE 'N'       CFT004                          CFT004
     C                     ENDIF                                          CFT004
      *                                                                   CFT006
      ** Access SAR details file to determine if CFT006 is switched ON    CFT006
      *                                                                   CFT006
     C                     CALL 'AOSARDR0'                                CFT006
     C                     PARM *BLANKS   @RTCD   7                       CFT006
     C                     PARM '*VERIFY' @OPTN   7                       CFT006
     C                     PARM 'CFT006'  @SARD   6                       CFT006
     C           SCSARD    PARM SCSARD    DSFDY                           CFT006
      *                                                                   CFT006
      ** If CFT006 is switched ON                                         CFT006
      *                                                                   CFT006
     C           @RTCD     IFEQ *BLANKS                                   CFT006
     C                     MOVE 'Y'       CFT006  1                       CFT006
     C                     ELSE                                           CFT006
     C                     MOVE 'N'       CFT006                          CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      ** Access SAR details file to determine if CFT008 is switched ON    CFT006
      *                                                                   CFT006
     C                     CALL 'AOSARDR0'                                CFT006
     C                     PARM *BLANKS   @RTCD   7                       CFT006
     C                     PARM '*VERIFY' @OPTN   7                       CFT006
     C                     PARM 'CFT008'  @SARD   6                       CFT006
     C           SCSARD    PARM SCSARD    DSFDY                           CFT006
      *                                                                   CFT006
      ** If CFT008 is switched ON                                         CFT006
      *                                                                   CFT006
     C           @RTCD     IFEQ *BLANKS                                   CFT006
     C                     MOVE 'Y'       CFT008  1                       CFT006
     C                     ELSE                                           CFT006
     C                     MOVE 'N'       CFT008                          CFT006
     C                     ENDIF                                          CFT006
     C/COPY WNCPYSRC,FT0803C001
      *                                                                   CFT014
      ** Access SAR details file to determine if CFT014 is switched ON.   CFT014
      *                                                                   CFT014
     C                     CALL 'AOSARDR0'                                CFT014
     C                     PARM *BLANKS   @RTCD                           CFT014
     C                     PARM '*VERIFY' @OPTN                           CFT014
     C                     PARM 'CFT014'  @SARD                           CFT014
     C           SCSARD    PARM SCSARD    DSFDY                           CFT014
      *                                                                   CFT014
     C                     MOVE 'N'       CFT014  1                       CFT014
     C                     MOVE *OFF      *IN83                           CFT014
     C           @RTCD     IFEQ *BLANKS                                   CFT014
     C                     MOVE 'Y'       CFT014                          CFT014
     C                     MOVE *ON       *IN83                           CFT014
     C                     ELSE                                           CFT014
     C           @RTCD     IFNE '*NRF   '                                 CFT014
     C           *LOCK     IN   LDA                                       CFT014
     C                     Z-ADD101       DBASE                           CFT014
     C                     MOVEL'CFT014'  DBKEY                           CFT014
     C                     MOVEL'SCSARDPD'DBFILE                          CFT014
     C                     OUT  LDA                                       CFT014
     C                     EXSR *PSSR                                     CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                                       CFT151
      ** Access SAR details file to determine if CFT151 is switched ON.                       CFT151
      *                                                                                       CFT151
     C                     CALL 'AOSARDR0'                                                    CFT151
     C                     PARM *BLANKS   @RTCD                                               CFT151
     C                     PARM '*VERIFY' @OPTN                                               CFT151
     C                     PARM 'CFT151'  @SARD                                               CFT151
     C           SCSARD    PARM SCSARD    DSFDY                                               CFT151
      *                                                                                       CFT151
     C                     MOVE 'N'       CFT151  1                                           CFT151
     C           @RTCD     IFEQ *BLANKS                                                       CFT151
     C                     MOVE 'Y'       CFT151                                              CFT151
     C                     ELSE                                                               CFT151
     C           @RTCD     IFNE '*NRF   '                                                     CFT151
     C           *LOCK     IN   LDA                                                           CFT151
     C                     Z-ADD101       DBASE                                               CFT151
     C                     MOVEL'CFT151'  DBKEY                                               CFT151
     C                     MOVEL'SCSARDPD'DBFILE                                              CFT151
     C                     OUT  LDA                                                           CFT151
     C                     EXSR *PSSR                                                         CFT151
     C                     ENDIF                                                              CFT151
     C                     ENDIF                                                              CFT151
      *                                                                   CFT014
      ** Access SAR details file to determine if CEU006 is switched ON.   CFT014
      *                                                                   CFT014
     C                     CALL 'AOSARDR0'                                CFT014
     C                     PARM *BLANKS   @RTCD                           CFT014
     C                     PARM '*VERIFY' @OPTN                           CFT014
     C                     PARM 'CEU006'  @SARD                           CFT014
     C           SCSARD    PARM SCSARD    DSFDY                           CFT014
      *                                                                   CFT014
     C                     MOVE 'N'       CEU006  1                       CFT014
     C                     MOVE *OFF      *IN82                           CFT014
     C           @RTCD     IFEQ *BLANKS                                   CFT014
     C                     MOVE 'Y'       CEU006                          CFT014
     C                     MOVE *ON       *IN82                           CFT014
     C                     ELSE                                           CFT014
     C           @RTCD     IFNE '*NRF   '                                 CFT014
     C           *LOCK     IN   LDA                                       CFT014
     C                     Z-ADD102       DBASE                           CFT014
     C                     MOVEL'CEU006'  DBKEY                           CFT014
     C                     MOVEL'SCSARDPD'DBFILE                          CFT014
     C                     OUT  LDA                                       CFT014
     C                     EXSR *PSSR                                     CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Access SAR details file to determine if S01494 is switched ON.   CFT014
      *                                                                   CFT014
     C                     CALL 'AOSARDR0'                                CFT014
     C                     PARM *BLANKS   @RTCD                           CFT014
     C                     PARM '*VERIFY' @OPTN                           CFT014
     C                     PARM 'S01494'  @SARD                           CFT014
     C           SCSARD    PARM SCSARD    DSFDY                           CFT014
      *                                                                   CFT014
     C                     MOVE 'N'       S01494  1                       CFT014
     C           @RTCD     IFEQ *BLANKS                                   CFT014
     C                     MOVE 'Y'       S01494                          CFT014
     C                     ELSE                                           CFT014
     C           @RTCD     IFNE '*NRF   '                                 CFT014
     C           *LOCK     IN   LDA                                       CFT014
     C                     Z-ADD103       DBASE                           CFT014
     C                     MOVEL'S01494'  DBKEY                           CFT014
     C                     MOVEL'SCSARDPD'DBFILE                          CFT014
     C                     OUT  LDA                                       CFT014
     C                     EXSR *PSSR                                     CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Access SAR details file to determine if S01499 is switched ON.   CFT014
      *                                                                   CFT014
     C                     CALL 'AOSARDR0'                                CFT014
     C                     PARM *BLANKS   @RTCD                           CFT014
     C                     PARM '*VERIFY' @OPTN                           CFT014
     C                     PARM 'S01499'  @SARD                           CFT014
     C           SCSARD    PARM SCSARD    DSFDY                           CFT014
      *                                                                   CFT014
     C                     MOVE 'N'       S01499  1                       CFT014
     C           @RTCD     IFEQ *BLANKS                                   CFT014
     C                     MOVE 'Y'       S01499                          CFT014
     C                     ELSE                                           CFT014
     C           @RTCD     IFNE '*NRF   '                                 CFT014
     C           *LOCK     IN   LDA                                       CFT014
     C                     Z-ADD121       DBASE                           CFT014
     C                     MOVEL'S01499'  DBKEY                           CFT014
     C                     MOVEL'SCSARDPD'DBFILE                          CFT014
     C                     OUT  LDA                                       CFT014
     C                     EXSR *PSSR                                     CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                                       CSW201
      ** Check if CSW201 is installed                                                         CSW201
      *                                                                                       CSW201
     C                     CALL 'SWIF2001'                                                    CSW201
     C                     PARM *BLANKS   PRTCD   7                                           CSW201
      *                                                                                       CSW201
     C           PRTCD     IFEQ 'CSW2001'                                                     CSW201
     C                     MOVE 'Y'       CSW201  1                                           CSW201
     C                     MOVE *ON       *IN24                                               CSW201
     C                     ELSE                                                               CSW201
     C                     MOVE 'N'       CSW201                                              CSW201
     C                     MOVE *OFF      *IN24                                               CSW201
     C                     MOVE *OFF      *IN20                                               CSW201
     C                     MOVE *OFF      *IN21                                               CSW201
     C                     MOVE *OFF      *IN22                                               CSW201
     C                     MOVE *OFF      *IN23                                               CSW201
     C                     ENDIF                                                              CSW201
      *                                                                   CFT009
      ** Access SAR details file to determine if CFT009 is switched ON.   CFT009
      *                                                                   CFT009
     C                     CALL 'AOSARDR0'                                CFT009
     C                     PARM *BLANKS   @RTCD                           CFT009
     C                     PARM '*VERIFY' @OPTN                           CFT009
     C                     PARM 'CFT009'  @SARD                           CFT009
     C           SCSARD    PARM SCSARD    DSFDY                           CFT009
      *                                                                   CFT009
     C                     MOVE 'N'       CFT009  1                       CFT009
     C                     MOVE *OFF      *IN45                           CFT009
     C           @RTCD     IFEQ *BLANKS                                   CFT009
     C                     MOVE 'Y'       CFT009                          CFT009
     C                     MOVE *ON       *IN45                           CFT009
     C                     ELSE                                           CFT009
     C           @RTCD     IFNE '*NRF   '                                 CFT009
     C           *LOCK     IN   LDA                                       CFT009
     C                     Z-ADD109       DBASE                           CFT009
     C                     MOVEL'CFT009'  DBKEY                           CFT009
     C                     MOVEL'SCSARDPD'DBFILE                          CFT009
     C                     OUT  LDA                                       CFT009
     C                     EXSR *PSSR                                     CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                                       CSD015
      ** Determine if CSC011 enhancement is installed                                         CSD015
      *                                                                                       CSD015
     C                     MOVE 'N'       CSC011  1                                           CSD015
      *                                                                                       CSD015
     C                     CALL 'AOSARDR0'                                                    CSD015
     C                     PARM *BLANKS   PRTCD                                               CSD015
     C                     PARM '*VERIFY' POPTN                                               CSD015
     C                     PARM 'CSC011'  PSARD                                               CSD015
     C           SCSARD    PARM SCSARD    DSFDY                                               CSD015
      *                                                                                       CSD015
      ** Database Error (return code other than *NRF)                                         CSD015
      *                                                                                       CSD015
     C           PRTCD     IFNE *BLANKS                                                       CSD015
     C           PRTCD     ANDNE'*NRF   '                                                     CSD015
     C           *LOCK     IN   LDA                                                           CSD015
     C                     MOVEL'SCSARDPD'DBFILE                                              CSD015
     C                     MOVEL'CSC011'  DBKEY                                               CSD015
     C                     Z-ADD150       DBASE                                               CSD015
     C                     OUT  LDA                                                           CSD015
     C                     EXSR *PSSR                                                         CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PRTCD     IFEQ *BLANKS                                                       CSD015
     C                     MOVE 'Y'       CSC011                                              CSD015
     C           *NAMVAR   DEFN           SC24X7                                              CSD015
     C                     IN   SC24X7                                                        CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           *NAMVAR   DEFN           SDSTAT                                              CSD015
     C                     IN   SDSTAT                                                        CSD015
      *                                                                                       CSD015
      ** Determine if CSD015 enhancement is installed                                         CSD015
      *                                                                                       CSD015
     C                     MOVE 'N'       CSD015  1                                           CSD015
      *                                                                                       CSD015
     C                     CALL 'AOSARDR0'                                                    CSD015
     C                     PARM *BLANKS   PRTCD   7                                           CSD015
     C                     PARM '*VERIFY' POPTN   7                                           CSD015
     C                     PARM 'CSD015'  PSARD   6                                           CSD015
     C           SCSARD    PARM SCSARD    DSFDY                                               CSD015
      *                                                                                       CSD015
      ** Database Error (return code other than *NRF)                                         CSD015
      *                                                                                       CSD015
     C           PRTCD     IFNE *BLANKS                                                       CSD015
     C           PRTCD     ANDNE'*NRF   '                                                     CSD015
     C           *LOCK     IN   LDA                                                           CSD015
     C                     MOVEL'SCSARDPD'DBFILE                                              CSD015
     C                     MOVEL'CSD015'  DBKEY                                               CSD015
     C                     Z-ADD151       DBASE                                               CSD015
     C                     OUT  LDA                                                           CSD015
     C                     EXSR *PSSR                                                         CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PRTCD     IFEQ *BLANKS                                                       CSD015
     C                     MOVE 'Y'       CSD015                                              CSD015
      *                                                                                       CSD015
      ** Access AOWLCCR0 to check if function code 'FTIPAY' is available                      CSD015
      *                                                                                       CSD015
     C                     CALL 'AOWLCCR0'                                                    CSD015
     C                     PARM *BLANKS   PRTCD                                               CSD015
     C                     PARM '*KEY'    POPTN                                               CSD015
     C                     PARM 'FTIPAY'  PFUNC   8                                           CSD015
     C           SDWLCC    PARM SDWLCC    DSFDY                                               CSD015
      *                                                                                       CSD015
     C           PRTCD     IFNE *BLANKS                                                       CSD015
     C           PRTCD     ANDNE'*NRF'                                                        CSD015
     C           *LOCK     IN   LDA                                                           CSD015
     C                     MOVEL'SDWLCCPD'DBFILE                                              CSD015
     C                     MOVELPFUNC     DBKEY                                               CSD015
     C                     Z-ADD152       DBASE                                               CSD015
     C                     OUT  LDA                                                           CSD015
     C                     EXSR *PSSR                                                         CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** If return code is equal to blank, set WELCI to 'Y'                                   CSD015
      *                                                                                       CSD015
     C           PRTCD     IFEQ *BLANKS                                                       CSD015
     C           W1EWLC    ANDEQ'Y'                                                           CSD015
     C                     MOVE 'Y'       WELCI   1                                           CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Access AOWLCCR0 to check if function code 'FTOPAY' is available                      CSD015
      *                                                                                       CSD015
     C                     CALL 'AOWLCCR0'                                                    CSD015
     C                     PARM *BLANKS   PRTCD                                               CSD015
     C                     PARM '*KEY'    POPTN                                               CSD015
     C                     PARM 'FTOPAY'  PFUNC                                               CSD015
     C           SDWLCC    PARM SDWLCC    DSFDY                                               CSD015
      *                                                                                       CSD015
     C           PRTCD     IFNE *BLANKS                                                       CSD015
     C           PRTCD     ANDNE'*NRF'                                                        CSD015
     C           *LOCK     IN   LDA                                                           CSD015
     C                     MOVEL'SDWLCCPD'DBFILE                                              CSD015
     C                     MOVELPFUNC     DBKEY                                               CSD015
     C                     Z-ADD153       DBASE                                               CSD015
     C                     OUT  LDA                                                           CSD015
     C                     EXSR *PSSR                                                         CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** If return code is equal to blank, set WELCO to 'Y'                                   CSD015
      *                                                                                       CSD015
     C           PRTCD     IFEQ *BLANKS                                                       CSD015
     C           W1EWLC    ANDEQ'Y'                                                           CSD015
     C                     MOVE 'Y'       WELCO   1                                           CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Access AOWLCCR0 to check if function code 'TRANSREQ' is available                    CSD015
      *                                                                                       CSD015
     C                     CALL 'AOWLCCR0'                                                    CSD015
     C                     PARM *BLANKS   PRTCD                                               CSD015
     C                     PARM '*KEY'    POPTN                                               CSD015
     C                     PARM 'TRANSREQ'PFUNC                                               CSD015
     C           SDWLCC    PARM SDWLCC    DSFDY                                               CSD015
      *                                                                                       CSD015
     C           PRTCD     IFNE *BLANKS                                                       CSD015
     C           PRTCD     ANDNE'*NRF'                                                        CSD015
     C           *LOCK     IN   LDA                                                           CSD015
     C                     MOVEL'SDWLCCPD'DBFILE                                              CSD015
     C                     MOVELPFUNC     DBKEY                                               CSD015
     C                     Z-ADD154       DBASE                                               CSD015
     C                     OUT  LDA                                                           CSD015
     C                     EXSR *PSSR                                                         CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** If return code is equal to blank, set WELCR to 'Y'                                   CSD015
      *                                                                                       CSD015
     C           PRTCD     IFEQ *BLANKS                                                       CSD015
     C           W1EWLC    ANDEQ'Y'                                                           CSD015
     C                     MOVE 'Y'       WELCR   1                                           CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Access AOWLCCR0 to check if function code 'CUSTCRTR' is available                    CSD015
      *                                                                                       CSD015
     C                     CALL 'AOWLCCR0'                                                    CSD015
     C                     PARM *BLANKS   PRTCD                                               CSD015
     C                     PARM '*KEY'    POPTN                                               CSD015
     C                     PARM 'CUSTCRTR'PFUNC                                               CSD015
     C           SDWLCC    PARM SDWLCC    DSFDY                                               CSD015
      *                                                                                       CSD015
     C           PRTCD     IFNE *BLANKS                                                       CSD015
     C           PRTCD     ANDNE'*NRF'                                                        CSD015
     C           *LOCK     IN   LDA                                                           CSD015
     C                     MOVEL'SDWLCCPD'DBFILE                                              CSD015
     C                     MOVELPFUNC     DBKEY                                               CSD015
     C                     Z-ADD155       DBASE                                               CSD015
     C                     OUT  LDA                                                           CSD015
     C                     EXSR *PSSR                                                         CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** If return code is equal to blank, set WELCC to 'Y'                                   CSD015
      *                                                                                       CSD015
     C           PRTCD     IFEQ *BLANKS                                                       CSD015
     C           W1EWLC    ANDEQ'Y'                                                           CSD015
     C                     MOVE 'Y'       WELCC   1                                           CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSW203
      ** Check if SWIFT Changes 2003 (CSW203) is installed                                    CSW203
      *                                                                                       CSW203
     C                     CALL 'SWIF2003'                                                    CSW203
     C                     PARM *BLANKS   PRTCD                                               CSW203
      *                                                                                       CSW203
     C           PRTCD     IFEQ 'CSW2003'                                                     CSW203
     C                     MOVE 'Y'       CSW203  1                                           CSW203
     C                     MOVE *ON       *IN85                                               CSW203
     C                     ELSE                                                               CSW203
     C                     MOVE 'N'       CSW203                                              CSW203
     C                     MOVE *OFF      *IN85                                               CSW203
     C                     ENDIF                                                              CSW203
      *                                                                                       CRE020
      ** Check if Online Printing of Advices (GE7) is on                                      CRE020
      *                                                                                       CRE020
     C                     MOVE 'N'       CRE020  1                                           CRE020
     C                     CALL 'AOSARDR0'                                                    CRE020
     C                     PARM *BLANKS   @RTCD                                               CRE020
     C                     PARM '*VERIFY' @OPTN                                               CRE020
     C                     PARM 'CRE020'  @SARD                                               CRE020
     C           SCSARD    PARM SCSARD    DSFDY                                               CRE020
      *                                                                                       CRE020
     C           @RTCD     IFEQ *BLANKS                                                       CRE020
     C                     MOVE 'Y'       CRE020                                              CRE020
     C                     MOVEL'FT0803'  RPRGMN                                              CRE020
     C                     ELSE                                                               CRE020
      *                                                                                       CRE020
     C           @RTCD     IFNE '*NRF   '                                                     CRE020
     C           *LOCK     IN   LDA                                                           CRE020
     C                     Z-ADD522       DBASE                                               CRE020
     C                     MOVEL'CRE020'  DBKEY                                               CRE020
     C                     MOVEL'SCSARDPD'DBFILE                                              CRE020
     C                     OUT  LDA                                                           CRE020
     C                     EXSR *PSSR                                                         CRE020
     C                     ENDIF                                                              CRE020
     C                     ENDIF                                                              CRE020
      *                                                                                       CRE020
     C           CRE020    IFEQ 'Y'                                                           CRE020
     C                     MOVELOTSVAL    POTOPT 20                                           CRE020
     C                     MOVELINSVAL    PINOPT 20                                           CRE020
     C                     MOVE *BLANKS   PBLNK1 20                                           CRE020
     C                     MOVE *BLANKS   PBLNK2200                                           CRE020
      *                                                                                       CRE020
     C                     CALL 'AOSVALR0'                                                    CRE020
     C                     PARM *BLANKS   @RTCD                                               CRE020
     C                     PARM           POTOPT                                              CRE020
     C                     PARM           PSVAL1200                                           CRE020
     C                     PARM           PINOPT                                              CRE020
     C                     PARM           PSVAL2200                                           CRE020
     C                     PARM           PBLNK1                                              CRE020
     C                     PARM           PBLNK2                                              CRE020
     C                     PARM           PBLNK1                                              CRE020
     C                     PARM           PBLNK2                                              CRE020
     C                     PARM           PBLNK1                                              CRE020
     C                     PARM           PBLNK2                                              CRE020
     C                     PARM           PBLNK1                                              CRE020
     C                     PARM           PBLNK2                                              CRE020
     C                     PARM           PBLNK1                                              CRE020
     C                     PARM           PBLNK2                                              CRE020
     C                     PARM           PBLNK1                                              CRE020
     C                     PARM           PBLNK2                                              CRE020
     C                     PARM           PBLNK1                                              CRE020
     C                     PARM           PBLNK2                                              CRE020
     C                     PARM           PBLNK1                                              CRE020
     C                     PARM           PBLNK2                                              CRE020
      *                                                                                       CRE020
     C           @RTCD     IFNE *BLANKS                                                       CRE020
     C           *LOCK     IN   LDA                                                           CRE020
     C                     Z-ADD523       DBASE                                               CRE020
     C                     MOVEL'CRE020'  DBPGM                                               CRE020
     C                     MOVEL'SDSVALPD'DBFILE                                              CRE020
     C                     MOVELPSVAL1    DBKEY                                               CRE020
     C                     OUT  LDA                                                           CRE020
     C                     EXSR *PSSR                                                         CRE020
     C                     ENDIF                                                              CRE020
     C                     ENDIF                                                              CRE020
      *                                                                                       CRE020
      *                                                                                       CER030
      ** Check the switchable feature CER031                                                  CER030
      *                                                                                       CER030
     C                     MOVE 'N'       CER031  1                                           CER030
     C                     MOVE *OFF      *IN15                                               CER030
      *                                                                                       CER030
     C                     CALL 'AOSARDR0'                                                    CER030
     C                     PARM *BLANKS   PRTCD                                               CER030
     C                     PARM '*VERIFY' POPTN                                               CER030
     C                     PARM 'CER031'  PSARD                                               CER030
     C           SCSARD    PARM SCSARD    DSFDY                                               CER030
      *                                                                                       CER030
     C           PRTCD     IFEQ *BLANKS                                                       CER030
     C                     MOVE 'Y'       CER031                                              CER030
     C                     MOVE *ON       *IN15                                               CER030
     C                     ELSE                                                               CER030
      *                                                                                       CER030
     C           PRTCD     IFNE '*NRF   '                                                     CER030
     C           *LOCK     IN   LDA                                                           CER030
     C                     Z-ADD524       DBASE                                               CER030
     C                     MOVEL'CER031'  DBKEY                                               CER030
     C                     MOVEL'SCSARDPD'DBFILE                                              CER030
     C                     OUT  LDA                                                           CER030
     C                     EXSR *PSSR                                                         CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      ** Check the switchable feature CFT003                                                  CER030
      *                                                                                       CER030
     C                     MOVE 'N'       CFT003  1                                           CER030
     C                     MOVE *OFF      *IN16                                               CER030
      *                                                                                       CER030
     C                     CALL 'AOSARDR0'                                                    CER030
     C                     PARM *BLANKS   PRTCD                                               CER030
     C                     PARM '*VERIFY' POPTN                                               CER030
     C                     PARM 'CFT003'  PSARD                                               CER030
     C           SCSARD    PARM SCSARD    DSFDY                                               CER030
      *                                                                                       CER030
     C           PRTCD     IFEQ *BLANKS                                                       CER030
     C                     MOVE 'Y'       CFT003                                              CER030
     C                     ELSE                                                               CER030
      *                                                                                       CER030
     C           PRTCD     IFNE '*NRF   '                                                     CER030
     C           *LOCK     IN   LDA                                                           CER030
     C                     Z-ADD525       DBASE                                               CER030
     C                     MOVEL'CFT003'  DBKEY                                               CER030
     C                     MOVEL'SCSARDPD'DBFILE                                              CER030
     C                     OUT  LDA                                                           CER030
     C                     EXSR *PSSR                                                         CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           CER031    IFEQ 'Y'                                                           CER030
     C           CFT003    ANDEQ'Y'                                                           CER030
     C                     MOVE *ON       *IN16                                               CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      ** Check the switchable feature CGL013                                                  CER030
      *                                                                                       CER030
     C                     MOVE *OFF      *IN17                                               CER030
     C                     MOVE 'N'       CGL013  1                                           CER030
      *                                                                                       CER030
     C                     CALL 'AOSARDR0'                                                    CER030
     C                     PARM *BLANKS   PRTCD                                               CER030
     C                     PARM '*VERIFY' POPTN                                               CER030
     C                     PARM 'CGL013'  PSARD                                               CER030
     C           SCSARD    PARM SCSARD    DSFDY                                               CER030
      *                                                                                       CER030
     C           PRTCD     IFEQ *BLANKS                                                       CER030
     C                     MOVE 'Y'       CGL013                                              CER030
     C                     ELSE                                                               CER030
      *                                                                                       CER030
     C           PRTCD     IFNE '*NRF   '                                                     CER030
     C           *LOCK     IN   LDA                                                           CER030
     C                     Z-ADD526       DBASE                                               CER030
     C                     MOVEL'CGL013'  DBKEY                                               CER030
     C                     MOVEL'SCSARDPD'DBFILE                                              CER030
     C                     OUT  LDA                                                           CER030
     C                     EXSR *PSSR                                                         CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      ** Check the switchable feature CER030                                                  CER030
      *                                                                                       CER030
     C                     MOVE 'N'       CER030  1                                           CER030
      *                                                                                       CER030
     C                     CALL 'AOSARDR0'                                                    CER030
     C                     PARM *BLANKS   PRTCD                                               CER030
     C                     PARM '*VERIFY' POPTN                                               CER030
     C                     PARM 'CER030'  PSARD                                               CER030
     C           SCSARD    PARM SCSARD    DSFDY                                               CER030
      *                                                                                       CER030
     C           PRTCD     IFEQ *BLANKS                                                       CER030
     C                     MOVE 'Y'       CER030                                              CER030
     C                     ELSE                                                               CER030
      *                                                                                       CER030
     C           PRTCD     IFNE '*NRF   '                                                     CER030
     C           *LOCK     IN   LDA                                                           CER030
     C                     Z-ADD527       DBASE                                               CER030
     C                     MOVEL'CER030'  DBKEY                                               CER030
     C                     MOVEL'SCSARDPD'DBFILE                                              CER030
     C                     OUT  LDA                                                           CER030
     C                     EXSR *PSSR                                                         CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           CER030    IFEQ 'Y'                                                           CER030
     C           CGL013    OREQ 'Y'                                                           CER030
     C                     MOVE *ON       *IN17                                               CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      ** Check if SWIFT 2007 Changes (CSW207) is installed                                    CSW207
      *                                                                                       CSW207
     C                     CALL 'SWIF2007'                                                    CSW207
     C                     PARM *BLANKS   PRTCD   7                                           CSW207
      *                                                                                       CSW207
     C           PRTCD     IFEQ 'CSW2007'                                                     CSW207
     C                     MOVE 'Y'       CSW207  1                                           CSW207
     C                     ELSE                                                               CSW207
     C                     MOVE 'N'       CSW207                                              CSW207
     C                     ENDIF                                                              CSW207
     C*                                                                                       CSW207
      ** Check if SWIFT 2009 Changes (CSW209) is installed                                    CSW209
      *                                                                                       CSW209
     C                     CALL 'SWIF2009'                                                    CSW209
     C                     PARM *BLANKS   PRTCD                                               CSW209
      *                                                                                       CSW209
     C           PRTCD     IFEQ 'CSW2009'                                                     CSW209
     C                     MOVE 'Y'       CSW209  1                                           CSW209
     C                     MOVEL'1'       *IN14                                               CSW209
     C                     ELSE                                                               CSW209
     C                     MOVE 'N'       CSW209                                              CSW209
     C                     MOVEL'0'       *IN14                                               CSW209
     C                     ENDIF                                                              CSW209
     C*                                                                                       CSW209
     C*
     C           KEYCCT    KLIST                                          CFT006
     C                     KFLD           CCTTYP                          CFT006
     C                     KFLD           CCTID                           CFT006
     C                     KFLD           FILREF                          CFT006
     C*
     C           KEYRFT    KLIST                                          CFT006
     C                     KFLD           PYTP                            CFT006
     C                     KFLD           RFTID                           CFT006
     C**********           KFLD           SNDREF                                       CFT006 221761
      *                                                                                       CSD015
      ** Compliance Watch Hit List Key List                                                   CSD015
      *                                                                                       CSD015
     C           KCWHT     KLIST                                                              CSD015
     C                     KFLD           KFUNT   8                                           CSD015
     C                     KFLD           KIDEN  40                                           CSD015
     C                     KFLD           KBRCH   3                                           CSD015
      *                                                                   CFT006
     C                     ENDSR
     C/EJECT
     C*****************************************************************
     C*   DETL     : Detail processing                                *
     C*   Called by: Main process                                     *
     C*   Calls    : SYSL - System level processing                   *
     C*              SINB - Single branch processing                  *
     C*              ALLB - All branch processing                     *
     C*              RFTDTL - RFT processing                          *   CFT006
     C*              CCTDTL - CCT processing                          *   CFT006
     C*****************************************************************
     C           DETL      BEGSR
      *
     C                     READ OTPAYJ2                  61
      *
      ** Process records in OTPAYJ2 if there are records found
      *
     C           *IN61     IFEQ '1'
     C                     MOVE '1'       *IN36
     C                     ELSE
      *
      ** Set AUTOGEN indicator (ind 52).  If on = NON-AUTOGEN.  If off
      ** it is an AUTOGEN proceessing.
      *
     C           OPAUTO    IFEQ 'N'
     C           OPAUTO    OREQ ' '
     C                     MOVE '1'       *IN52
     C                     ELSE
     C                     MOVE '0'       *IN52
     C                     END                             -OPAUTO
      *
      ** Set Incoming/Outgoing Payment Indicator.  If on = Incoming.
      ** If off = Outgoing.
      *
     C                     MOVE '0'       *IN29            -Outgoing
      *
      **    If system level processing
      *
     C           @@LVLP    IFEQ 'S'
     C                     EXSR SYSL
     C                     END
      *
      **    If single branch processing
      *
     C           @@LVLP    IFEQ 'B'
     C           @@BCH     ANDNE'ALL'
     C                     EXSR SINB
     C                     END
      *
      **    If all branch processing
      *
     C           @@LVLP    IFEQ 'B'
     C           @@BCH     ANDEQ'ALL'
     C                     EXSR ALLB
     C                     END
      *
     C                     END                             -*IN61
      *
      ** INCOMING PAYMENTS PROCESSSING
      *
     C                     READ INPAYJ2                  62
      *
      ** Process records in INPAYJ2 if there are records found
      *
     C           *IN62     IFEQ '1'
     C                     MOVE '1'       *IN37
      *
     C                     ELSE
      *
      ** Set AUTOGEN indicator (ind 52).  If on = NON-AUTOGEN.  If off
      ** it is an AUTOGEN proceessing.
      *
     C           INAUTO    IFEQ 'N'
     C           INAUTO    OREQ ' '
     C                     MOVE '1'       *IN52
     C                     ELSE
     C                     MOVE '0'       *IN52
     C                     END                             -INAUTO
      *
     C                     MOVE '1'       *IN29            -Incoming
      *
      **    If system level processing
      *
     C           @@LVLP    IFEQ 'S'
     C                     EXSR SYSL
     C                     END
      *
      **    If single branch processing
      *
     C           @@LVLP    IFEQ 'B'
     C           @@BCH     ANDNE'ALL'
     C                     EXSR SINB
     C                     END
      *
      **    If all branch processing
      *
     C           @@LVLP    IFEQ 'B'
     C           @@BCH     ANDEQ'ALL'
     C                     EXSR ALLB
     C                     END
      *
     C                     END
      *                                                                   CFT006
     C           CFT006    IFEQ 'Y'                                       CFT006
      *                                                                   CFT006
      ** RFT processing                                                   CFT006
      *                                                                   CFT006
     C                     READ FT101X0                  56               CFT006
      *                                                                   CFT006
      ** Process records in FT101X0 if there are records found            CFT006
      *                                                                   CFT006
     C           *IN56     IFEQ *ON                                       CFT006
     C                     MOVE *ON       *IN58                           CFT006
     C                     ELSE                                           CFT006
      *                                                                   CFT006
      ** Set AUTOGEN indicator (ind 52).  If on = NON-AUTOGEN.  If off    CFT006
      ** it is an AUTOGEN processing.                                     CFT006
      *                                                                   CFT006
     C           INUSER    IFEQ '*STP'                                    CFT006
     C                     MOVE *OFF      *IN52                           CFT006
     C                     ELSE                                           CFT006
     C                     MOVE *ON       *IN52                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     Z-ADD0         @NEXP                           CFT006
      *                                                                   CFT006
     C                     EXSR RFTDTL                                    CFT006
      *                                                                   CFT006
     C                     ENDIF                                          CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      ** CCT processing                                                   CFT006
      *                                                                   CFT006
     C           CFT008    IFEQ 'Y'                                       CFT006
     C                     READ FT102X0                  57               CFT006
      *                                                                   CFT006
      ** Process records in FT102X0 if there are records found            CFT006
      *                                                                   CFT006
     C           *IN57     IFEQ *ON                                       CFT006
     C                     MOVE *ON       *IN59                           CFT006
     C                     ELSE                                           CFT006
      *                                                                   CFT006
      ** Set AUTOGEN indicator (ind 52).  If on = NON-AUTOGEN.  If off    CFT006
      ** it is an AUTOGEN proceessing.                                    CFT006
      *                                                                   CFT006
     C           CINUSE    IFEQ '*STP'                                    CFT006
     C                     MOVE *OFF      *IN52                           CFT006
     C                     ELSE                                           CFT006
     C                     MOVE *ON       *IN52                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     Z-ADD0         @NEXP                           CFT006
      *                                                                   CFT006
     C                     EXSR CCTDTL                                    CFT006
      *                                                                   CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ENDIF                                          CFT006
      *
     C                     ENDSR
      *
     C/EJECT
     C*****************************************************************
     C*   SYSL     : System Level processing                          *
     C*   Called by: DETL                                             *
     C*   Calls    : ZSFL - Setup printer file via RCF                *
     C*              ODTL - Get other details for reporting           *
     C*              EXCP - Process for Exceptional Condition         *
     C*              AUGN - AutoGen Procesing                         *
     C*              NAUG - Non-AutoGen Processing                    *
     C*              PAYA - Payments Authorisation                    *
     C*****************************************************************
     C           SYSL      BEGSR
      *
      ** If outgoing payment processing.  Indicator 29 is off.
      *
     C           *IN29     IFEQ '0'
      *
      ** Set-on no outgoing payment indicator
      *
     C                     MOVE '1'       *IN34
      *
      ** Do while not End of file, OTPAYJ2
      *
     C           *IN61     DOWNE'1'
     C/COPY WNCPYSRC,FT0803C002
      *
      ** Determine if settlement thru BOJNET.
      *
      *
      ** If found, settlement thru BOJNET.  Set-on indicator 55.
      *
     C                     MOVE STMT      STMTA
     C                     MOVE OPMSGR    @MSGR
     C                     EXSR INCR
      *
      ** Blank out parameter field for call to FT0805.
      *
     C                     MOVE *BLANKS   @ACNT
      *
      ** Select only records that matches entered Nostro code, if
      **  entered, (this is not done in open query file)
      *
     C           @NCDE     IFNE *BLANKS
     C                     MOVELDST1      @DEST   5
     C                     MOVELSNCO      @NST2   2
     C                     MOVE @NST2     @NST5   5
     C                     MOVELPCCY      @NST5   5
     C/COPY WNCPYSRC,FT0803C003
     C                     END
      *
      ** Check if NOSTRO CODE entered is the same with the payment's
      ** DESTINATION field or SENDER CORRESPONDENT field.
      *
     C           @NCDE     IFEQ @DEST
     C           @NCDE     OREQ @NST5
     C           @NCDE     OREQ *BLANKS
      *
      ** Set-off no outgoing payment indicator
      *
     C                     MOVE '0'       *IN34
      *
      ** Get other details and check for exceptional condition
      *
     C                     EXSR ODTL
      *
      ** Check for any exceptional conditions.
      *
     C                     EXSR EXCP
      *
      ** If there are no exceptional conditions, and Autogen
      ** IND 31 is off .... NOT BACKVALUED
      ** IND 32 is off .... SUFFICIENT FUND
      ** IND 33 is off .... AMOUNT BELOW THRESHOLD LIMIT
      ** IND 52 is off .... AUTOGEN otherwise NON-AUTOGEN.
      *
     C           *IN31     IFEQ '0'
     C           *IN32     ANDEQ'0'
     C           *IN33     ANDEQ'0'
     C           *IN52     ANDEQ'0'
     C                     EXSR AUGN
     C                     ELSE
     C                     EXSR NAUG
     C                     END
      *
      ** Set REGULAR PAYMENT Indicator
      *
     C           PYTP      IFEQ 'RP'
     C                     MOVE '1'       *IN51
     C                     ELSE
     C                     MOVE '0'       *IN51
     C                     END
      *
      ** Set ADD/DEDUCT Indicator
      *
     C           ADDC      IFEQ 'A'
     C                     MOVE '1'       *IN54
     C                     ELSE
     C                     MOVE '0'       *IN54
     C                     END
      *
      ** If any exception occured, write to P3
      *
     C           *IN31     IFEQ '1'
     C           *IN32     OREQ '1'
     C           *IN33     OREQ '1'
      *
     C           *IN41     IFEQ '0'
     C                     OPEN FT0803P3
     C                     MOVELFILE3     SFILE
     C                     Z-ADDFNUM3     ZSNUM
     C                     EXSR ZSFL
     C                     MOVE '1'       *IN41
     C                     END
      *
     C                     WRITEHEADP3
     C                     WRITEDETP3
     C           CSW209    IFEQ 'Y'                                                           CSW209
     C                     EXSR WRCOV3                                                        CSW209
     C                     ENDIF                                                              CSW209
      *
     C                     ADD  1         HNOEX
      *
      ** Else, to detail reports
      *
     C                     ELSE
      *
      ** If Transaction is Non-AutoGen, write to P2
      *
     C           *IN52     IFEQ '1'
      *
     C           *IN40     IFEQ '0'
     C                     OPEN FT0803P2
     C                     MOVELFILE2     SFILE
     C                     Z-ADDFNUM2     ZSNUM
     C                     EXSR ZSFL
     C                     MOVE '1'       *IN40
     C                     END
      *
     C                     WRITEHEADP2
     C                     WRITEDETP2
     C           CSW209    IFEQ 'Y'                                                           CSW209
     C                     EXSR WRCOV2                                                        CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CER030
      ** Write Transaction Type Outgoing                                                      CER030
      *                                                                                       CER030
     C           CER030    IFEQ 'Y'                                                           CER030
     C           CGL013    OREQ 'Y'                                                           CER030
      *                                                                                       CER030
     C                     MOVE '0'       *IN18                                               CER030
     C           PLINE2    IFGE 58                                                            CER030
     C                     MOVE '1'       *IN18                                               CER030
     C                     WRITEHEADP2                                                        CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     WRITEDETRN2                                                        CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      ** Write Extended Narrative (Debit) Outgoing                                            CER030
      *                                                                                       CER030
     C           CER031    IFEQ 'Y'                                                           CER030
      *                                                                                       CER030
     C                     MOVE '0'       *IN18                                               CER030
     C           PLINE2    IFGE 52                                                            CER030
     C                     MOVE '1'       *IN18                                               CER030
     C                     WRITEHEADP2                                                        CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     WRITEDETEXN1                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      ** Write Extended Narrative (Credit) Outgoing                                           CER030
      *                                                                                       CER030
     C           CER031    IFEQ 'Y'                                                           CER030
     C           CFT003    ANDEQ'Y'                                                           CER030
      *                                                                                       CER030
     C                     MOVE '0'       *IN18                                               CER030
     C           PLINE2    IFGE 52                                                            CER030
     C                     MOVE '1'       *IN18                                               CER030
     C                     WRITEHEADP2                                                        CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     WRITEDETEXN2                                                       CER030
     C                     ENDIF                                                              CER030
      *
     C                     END
      *
      ** If Autogen, Write to P1
      *
     C           *IN52     IFEQ '0'
      *
     C           *IN39     IFEQ '0'
     C                     OPEN FT0803P1
     C                     MOVELFILE1     SFILE
     C                     Z-ADDFNUM1     ZSNUM
     C                     EXSR ZSFL
     C                     MOVE '1'       *IN39
     C                     END
      *
     C           OVDT      IFNE SLDT
     C           OSMT      ORNE STMT
      *
     C           *IN12     IFEQ '1'
     C*
     C** Format TOTAL settle amount
     C*
     C                     Z-ADDSTOTL     ZFLD15
     C                     Z-ADD@SMDP     ZDECS
     C                     EXSR ZFRPED
     C                     MOVE ZOUT22    SHTOTL
     C*
     C                     WRITEFOOTP1
     C                     END
      *
     C                     WRITEHEADP1
     C                     WRITECOLHED
     C                     WRITEHEADO
     C                     Z-ADD0         STOTL  220
     C                     Z-ADD0         SNMBR
      *
     C                     END
      *
     C                     MOVE '1'       *IN12
     C                     WRITEDETP1O
      *                                                                                       CER030
      ** Write Transaction Type - Outgoing Payment                                            CER030
      *                                                                                       CER030
     C           CER030    IFEQ 'Y'                                                           CER030
     C           CGL013    OREQ 'Y'                                                           CER030
     C                     WRITEDETTRN                                                        CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      ** Write Extended Narratives - Outgoing Payment                                         CER030
      *                                                                                       CER030
     C           CER031    IFEQ 'Y'                                                           CER030
     C                     WRITEDETEXND                                                       CER030
     C           CFT003    IFEQ 'Y'                                                           CER030
     C                     WRITEDETEXNC                                                       CER030
     C                     ENDIF                                                              CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ADD  SMAM      STOTL
     C                     ADD  1         SNMBR
     C                     Z-ADDSLDT      OVDT    50
     C                     Z-ADDSTMT      OSMT    20
      *
     C           *IN10     IFEQ '1'
     C                     WRITEHEADP1
     C                     WRITEHEADO
     C                     MOVE '0'       *IN10
     C                     END
      *
     C                     END
      *
     C                     ADD  1         HNOTR
     C                     END
      *
      ** If Authorise, update OTPAYDD
      *
     C           *IN30     IFEQ '0'
     C                     EXSR PAYA
     C                     END
      *
     C                     ELSE
      *
      ** De-marked Payment in the extension file (INPAYXL0 or OTPAYXL0).
      *
     C                     EXSR DMPYT
     C                     ADD  1         @NEXP
     C                     END
      *
     C                     READ OTPAYJ2                  61
      *
     C                     END                             -DOW not EOF
      *
     C           *IN12     IFEQ '1'
     C*
     C** Format TOTAL settle amount
     C*
     C                     Z-ADDSTOTL     ZFLD15
     C                     Z-ADD@SMDP     ZDECS
     C                     EXSR ZFRPED
     C                     MOVE ZOUT22    SHTOTL
     C*
     C                     WRITEFOOTP1
     C                     END
      *
     C                     END
      *
      ** INCOMING PAYMENTS PROCESSING.
      *
     C           *IN29     IFEQ '1'
      *
      ** Set-on no incoming payment indicator
      *
     C                     MOVE '1'       *IN35
      *
      ** Do while not End of file, INPAYJ2
      *
     C           *IN62     DOWNE'1'
      *
      ** If Level I or Level II is not yet completed do not process.
      *
     C           INLVL1    IFEQ 'Y'
     C           INLVL2    ANDEQ'Y'
     C/COPY WNCPYSRC,FT0803C004
      *
      ** Determine if settlement thru BOJNET.
      *
     C                     MOVE INSETM    STMTA
     C                     MOVE INMSGR    @MSGR
     C                     EXSR INCR
      *
      ** Blank out parameter field for call to FT0805.
      *
     C                     MOVE *BLANKS   @ACNT
      *
      ** Select only records that matches entered Nostro code, if
      **  entered, (this is not done in open query file)
      *
     C           @NCDE     IFNE *BLANKS
     C                     MOVELSND1      @SEND   5
     C***********          MOVELRCCO      @NST2   2                       CFT014
      *                                                                   CFT014
     C           INRCRT    IFEQ 'N'                                       CFT014
     C                     MOVELINRCO1    @NST2   2                       CFT014
     C                     MOVE @NST2     @NST5   5
     C***********          MOVELPCCY      @NST5   5                       CFT014
     C                     MOVELSMCY      @NST5                           CFT014
     C/COPY WNCPYSRC,FT0803C005
     C                     ELSE                                           CFT014
     C                     MOVELINRCO1    @NST5                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
     C                     MOVELINTRIB    WNST5A  5                       CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     END
     C*
     C           @NCDE     IFEQ @SEND
     C           @NCDE     OREQ @NST5
     C           @NCDE     OREQ WNST5A                                    CFT014
     C           @NCDE     OREQ *BLANKS
      *
      ** Set-off no incoming payment indicator
      *
     C                     MOVE '0'       *IN35
      *
      ** Get other details and check for exceptional condition
      *
     C                     EXSR ODTL
      *
      ** Check for Exceptional Conditions.
      *
     C                     EXSR EXCP
      *
      ** If there are no exceptional condtions, and Autogen
      ** IND 31 is off .... NOT BACKVALUED
      ** IND 32 is off .... SUFFICIENT FUND
      ** IND 33 is off .... AMOUNT BELOW THRESHOLD LIMIT
      ** IND 52 is off .... AUTOGEN otherwise NON-AUTOGEN.
      *
     C           *IN31     IFEQ '0'
     C           *IN32     ANDEQ'0'
     C           *IN33     ANDEQ'0'
     C           *IN52     ANDEQ'0'
     C                     EXSR AUGN
     C                     ELSE
     C                     EXSR NAUG
     C                     END
      *
      ** Set REGULAR PAYMENT Indicator
      *
     C           PYTP      IFEQ 'RP'
     C                     MOVE '1'       *IN51
     C                     ELSE
     C                     MOVE '0'       *IN51
     C                     END
      *
      ** Set ADD/DEDUCT Indicator
      *
     C           ADDC      IFEQ 'A'
     C                     MOVE '1'       *IN54
     C                     ELSE
     C                     MOVE '0'       *IN54
     C                     END
      *
      ** If any exception occured, write to P3
      *
     C           *IN31     IFEQ '1'
     C           *IN32     OREQ '1'
     C           *IN33     OREQ '1'
      *
     C           *IN41     IFEQ '0'
     C                     OPEN FT0803P3
     C                     MOVELFILE3     SFILE
     C                     Z-ADDFNUM3     ZSNUM
     C                     EXSR ZSFL
     C                     MOVE '1'       *IN41
     C                     END
      *
     C                     WRITEHEADP3
     C                     WRITEDETP3
     C           CSW209    IFEQ 'Y'                                                           CSW209
     C                     EXSR WRCOV3                                                        CSW209
     C                     ENDIF                                                              CSW209
     C                     ADD  1         HNOEX
      *
      ** Else, to detail reports
      *
     C                     ELSE
      *
      ** If Transaction is Non-AutoGen, write to P2
      *
     C           *IN52     IFEQ '1'
      *
     C           *IN40     IFEQ '0'
     C                     OPEN FT0803P2
     C                     MOVELFILE2     SFILE
     C                     Z-ADDFNUM2     ZSNUM
     C                     EXSR ZSFL
     C                     MOVE '1'       *IN40
     C                     END
      *
     C                     WRITEHEADP2
     C                     WRITEDETP2
     C           CSW209    IFEQ 'Y'                                                           CSW209
     C                     EXSR WRCOV2                                                        CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CER030
      ** Write Transaction Type Incoming                                                      CER030
      *                                                                                       CER030
     C           CER030    IFEQ 'Y'                                                           CER030
     C           CGL013    OREQ 'Y'                                                           CER030
      *                                                                                       CER030
     C                     MOVE '0'       *IN18                                               CER030
     C           PLINE2    IFGE 58                                                            CER030
     C                     MOVE '1'       *IN18                                               CER030
     C                     WRITEHEADP2                                                        CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     WRITEDETRN2                                                        CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      ** Write Extended Narrative (Credit) Incoming                                           CER030
      *                                                                                       CER030
     C           CER031    IFEQ 'Y'                                                           CER030
      *                                                                                       CER030
     C                     MOVE '0'       *IN18                                               CER030
     C           PLINE2    IFGE 52                                                            CER030
     C                     MOVE '1'       *IN18                                               CER030
     C                     WRITEHEADP2                                                        CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     WRITEDETEXN2                                                       CER030
     C                     ENDIF                                                              CER030
      *
     C                     END
      *
      ** If Autogen, Write to P1
      *
     C           *IN52     IFEQ '0'
      *
     C           *IN39     IFEQ '0'
     C                     OPEN FT0803P1
     C                     MOVELFILE1     SFILE
     C                     Z-ADDFNUM1     ZSNUM
     C                     EXSR ZSFL
     C                     MOVE '1'       *IN39
     C                     END
      *
     C           OVDT      IFNE SLDT
     C           OSMT      ORNE STMT
      *
     C           *IN12     IFEQ '1'
     C*
     C** Format TOTAL settle amount
     C*
     C                     Z-ADDSTOTL     ZFLD15
     C                     Z-ADD@SMDP     ZDECS
     C                     EXSR ZFRPED
     C                     MOVE ZOUT22    SHTOTL
     C*
     C                     WRITEFOOTP1
     C                     END
      *
     C                     WRITEHEADP1
     C                     WRITECOLHED
     C                     WRITEHEADI
     C                     Z-ADD0         STOTL
     C                     Z-ADD0         SNMBR
      *
     C                     END
      *
     C                     MOVE '1'       *IN12
     C                     WRITEDETP1I
      *                                                                                       CER030
      ** Write Transaction Type - Incoming Payment                                            CER030
      *                                                                                       CER030
     C           CER030    IFEQ 'Y'                                                           CER030
     C           CGL013    OREQ 'Y'                                                           CER030
     C                     WRITEDETTRN                                                        CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      ** Write Extended Narratives - Incoming Payment                                         CER030
      *                                                                                       CER030
     C           CER031    IFEQ 'Y'                                                           CER030
     C                     MOVE '1'       *IN16                                               CER030
     C                     WRITEDETEXNC                                                       CER030
     C                     MOVE '0'       *IN16                                               CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ADD  SMAM      STOTL
     C                     ADD  1         SNMBR
     C                     Z-ADDSLDT      OVDT    50
     C                     Z-ADDSTMT      OSMT    20
      *
     C           *IN10     IFEQ '1'
     C                     WRITEHEADP1
     C                     WRITEHEADI
     C                     MOVE '0'       *IN10
     C                     END
      *
     C                     END
     C                     ADD  1         HNOTR
      *
     C                     END
      *
      ** If Authorise, update INPAYDD
      *
     C           *IN30     IFEQ '0'
     C                     EXSR PAYA
     C                     END
      *
     C                     ELSE
      *
      ** De-marked Payment in the extension file (INPAYXL0 or OTPAYXL0).
      *
     C                     EXSR DMPYT
     C                     ADD  1         @NEXP
     C                     END
      *
     C                     ELSE
      *
      ** De-marked Payment in the extension file (INPAYXL0 or OTPAYXL0).
      *
     C                     EXSR DMPYT
     C                     ADD  1         @NEXP
     C                     END
      *
     C                     READ INPAYJ2                  62
      *
     C                     END                             -DOW not EOF
      *
     C           *IN12     IFEQ '1'
     C*
     C** Format TOTAL settle amount
     C*
     C                     Z-ADDSTOTL     ZFLD15
     C                     Z-ADD@SMDP     ZDECS
     C                     EXSR ZFRPED
     C                     MOVE ZOUT22    SHTOTL
     C*
     C                     WRITEFOOTP1
     C                     END
      *
     C                     END
      *
     C                     ENDSR
      *
     C/EJECT
     C*****************************************************************
     C*   SINB     : Single Branch processing                         *
     C*   Called by: DETL                                             *
     C*   Calls    : ZSFL - Setup printer file via RCF                *
     C*              ODTL - Get other details for reporting           *
     C*              EXCP - Process for Exceptional Condition         *
     C*              AUGN - AutoGen Procesing                         *
     C*              NAUG - Non-AutoGen Processing                    *
     C*              PAYA - Payments Authorisation                    *
     C*****************************************************************
     C           SINB      BEGSR
      *
      ** OUTGOING PAYMENTS PROCESSING.
      *
     C           *IN29     IFEQ '0'
      *
      ** Set-on no outgoing payment indicator
      *
     C                     MOVE '1'       *IN34
      *
      ** Do while not End of file, OTPAYJ2
      *
     C           *IN61     DOWNE'1'
     C/COPY WNCPYSRC,FT0803C006
      *
      ** Determine if settlement thru BOJNET.
      *
     C                     MOVE STMT      STMTA
     C                     MOVE OPMSGR    @MSGR
     C                     EXSR INCR
      *
      ** Blank out parameter field for call to FT0805.
      *
     C                     MOVE *BLANKS   @ACNT
      *
      ** Select only records that matches entered Nostro code, if
      **  entered, (this is not done in open query file)
      *
     C           @NCDE     IFNE *BLANKS
     C                     MOVELDST1      @DEST   5
     C                     MOVELSNCO      @NST2   2
     C                     MOVE @NST2     @NST5   5
     C                     MOVELPCCY      @NST5   5
     C/COPY WNCPYSRC,FT0803C007
     C                     END
      *
     C           @NCDE     IFEQ @DEST
     C           @NCDE     OREQ @NST5
     C           @NCDE     OREQ *BLANKS
      *
      ** Set-off no outgoing payment indicator
      *
     C                     MOVE '0'       *IN34
      *
      ** Get other details and check for exceptional condition
      *
     C                     EXSR ODTL
     C                     EXSR EXCP
      *
      ** If there are no exceptional condtions, and Autogen
      *
     C           *IN31     IFEQ '0'
     C           *IN32     ANDEQ'0'
     C           *IN33     ANDEQ'0'
     C           *IN52     ANDEQ'0'
     C                     EXSR AUGN
     C                     ELSE
     C                     EXSR NAUG
     C                     END
      *
     C           PYTP      IFEQ 'RP'
     C                     MOVE '1'       *IN51
     C                     ELSE
     C                     MOVE '0'       *IN51
     C                     END
      *
     C           ADDC      IFEQ 'A'
     C                     MOVE '1'       *IN54
     C                     ELSE
     C                     MOVE '0'       *IN54
     C                     END
      *
      ** If any exception occured, write to P3
      *
     C           *IN31     IFEQ '1'
     C           *IN32     OREQ '1'
     C           *IN33     OREQ '1'
      *
     C           *IN41     IFEQ '0'
     C                     OPEN FT0803P3
     C                     MOVELFILE3     SFILE
     C                     Z-ADDFNUM3     ZSNUM
     C                     EXSR ZSFL
     C                     MOVE '1'       *IN41
     C                     END
      *
     C                     WRITEHEADP3
     C                     WRITEDETP3
     C           CSW209    IFEQ 'Y'                                                           CSW209
     C                     EXSR WRCOV3                                                        CSW209
     C                     ENDIF                                                              CSW209
     C                     ADD  1         HNOEX
      *
      ** Else, to detail reports
      *
     C                     ELSE
      *
      ** If Transaction is Non-AutoGen, write to P2
      *
     C           *IN52     IFEQ '1'
      *
     C           *IN40     IFEQ '0'
     C                     OPEN FT0803P2
     C                     MOVELFILE2     SFILE
     C                     Z-ADDFNUM2     ZSNUM
     C                     EXSR ZSFL
     C                     MOVE '1'       *IN40
     C                     END
      *
     C                     WRITEHEADP2
     C                     WRITEDETP2
     C           CSW209    IFEQ 'Y'                                                           CSW209
     C                     EXSR WRCOV2                                                        CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CER030
      ** Write Transaction Type Outgoing                                                      CER030
      *                                                                                       CER030
     C           CER030    IFEQ 'Y'                                                           CER030
     C           CGL013    OREQ 'Y'                                                           CER030
      *                                                                                       CER030
     C                     MOVE '0'       *IN18                                               CER030
     C           PLINE2    IFGE 58                                                            CER030
     C                     MOVE '1'       *IN18                                               CER030
     C                     WRITEHEADP2                                                        CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     WRITEDETRN2                                                        CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      ** Write Extended Narrative (Debit) Outgoing                                            CER030
      *                                                                                       CER030
     C           CER031    IFEQ 'Y'                                                           CER030
      *                                                                                       CER030
     C                     MOVE '0'       *IN18                                               CER030
     C           PLINE2    IFGE 52                                                            CER030
     C                     MOVE '1'       *IN18                                               CER030
     C                     WRITEHEADP2                                                        CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     WRITEDETEXN1                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      ** Write Extended Narrative (Credit) Outgoing                                           CER030
      *                                                                                       CER030
     C           CER031    IFEQ 'Y'                                                           CER030
     C           CFT003    ANDEQ'Y'                                                           CER030
      *                                                                                       CER030
     C                     MOVE '0'       *IN18                                               CER030
     C           PLINE2    IFGE 52                                                            CER030
     C                     MOVE '1'       *IN18                                               CER030
     C                     WRITEHEADP2                                                        CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     WRITEDETEXN2                                                       CER030
     C                     ENDIF                                                              CER030
      *
     C                     END
      *
      ** If Autogen, Write to P1
      *
     C           *IN52     IFEQ '0'
      *
     C           *IN39     IFEQ '0'
     C                     OPEN FT0803P1
     C                     MOVELFILE1     SFILE
     C                     Z-ADDFNUM1     ZSNUM
     C                     EXSR ZSFL
     C                     MOVE '1'       *IN39
     C                     END
      *
     C           OVDT      IFNE SLDT
     C           OSMT      ORNE STMT
      *
     C           *IN12     IFEQ '1'
     C*
     C** Format TOTAL settle amount
     C*
     C                     Z-ADDSTOTL     ZFLD15
     C                     Z-ADD@SMDP     ZDECS
     C                     EXSR ZFRPED
     C                     MOVE ZOUT22    SHTOTL
     C*
     C                     WRITEFOOTP1
     C                     END
      *
     C                     WRITEHEADP1
     C                     WRITECOLHED
     C                     WRITEHEADO
     C                     Z-ADD0         STOTL
     C                     Z-ADD0         SNMBR
      *
     C                     END
      *
     C                     MOVE '1'       *IN12
     C                     WRITEDETP1O
      *                                                                                       CER030
      ** Write Transaction Type - Outgoing Payment                                            CER030
      *                                                                                       CER030
     C           CER030    IFEQ 'Y'                                                           CER030
     C           CGL013    OREQ 'Y'                                                           CER030
     C                     WRITEDETTRN                                                        CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      ** Write Extended Narratives - Outgoing Payment                                         CER030
      *                                                                                       CER030
     C           CER031    IFEQ 'Y'                                                           CER030
     C                     WRITEDETEXND                                                       CER030
     C           CFT003    IFEQ 'Y'                                                           CER030
     C                     WRITEDETEXNC                                                       CER030
     C                     ENDIF                                                              CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ADD  SMAM      STOTL
     C                     ADD  1         SNMBR
     C                     Z-ADDSLDT      OVDT    50
     C                     Z-ADDSTMT      OSMT    20
      *
     C           *IN10     IFEQ '1'
     C                     WRITEHEADP1
     C                     WRITEHEADO
     C                     MOVE '0'       *IN10
     C                     END
      *
     C                     END
     C                     ADD  1         HNOTR
      *
     C                     END
      *
      ** If Authorise, update OTPAYDD
      *
     C           *IN30     IFEQ '0'
     C                     EXSR PAYA
     C                     END
      *
     C                     ELSE
      *
      ** De-marked Payment in the extension file (INPAYXL0 or OTPAYXL0).
      *
     C                     EXSR DMPYT
     C                     ADD  1         @NEXP
     C                     END
      *
     C                     READ OTPAYJ2                  61
      *
     C                     END                             -DOW not EOF
      *
     C           *IN12     IFEQ '1'
     C*
     C** Format TOTAL settle amount
     C*
     C                     Z-ADDSTOTL     ZFLD15
     C                     Z-ADD@SMDP     ZDECS
     C                     EXSR ZFRPED
     C                     MOVE ZOUT22    SHTOTL
     C*
     C                     WRITEFOOTP1
     C                     END
      *
     C                     END
      *
      ** If incoming payment processing
      *
     C           *IN29     IFEQ '1'
      *
      ** Set-on no incoming payment indicator
      *
     C                     MOVE '1'       *IN35
      *
      ** Do while not End of file, INPAYJ2
      *
     C           *IN62     DOWNE'1'
      *
      ** If Level I or Level II is not yet completed do not process.
      *
     C***********INLVL1    IFNE 'Y'                                       166587
     C***********INLVL2    ORNE 'Y'                                       166587
     C           INLVL1    IFEQ 'Y'                                       166587
     C           INLVL2    ANDEQ'Y'                                       166587
     C/COPY WNCPYSRC,FT0803C008
      *
      ** Determine if settlement thru BOJNET.
      *
     C                     MOVE INSETM    STMTA
     C                     MOVE INMSGR    @MSGR
     C                     EXSR INCR
      *
      ** Blank out parameter field for call to FT0805.
      *
     C                     MOVE *BLANKS   @ACNT
      *
      ** Select only records that matches entered Nostro code, if
      **  entered, (this is not done in open query file)
      *
     C           @NCDE     IFNE *BLANKS
     C                     MOVELSND1      @SEND   5
     C***********          MOVELRCCO      @NST2   2                       CFT014
      *                                                                   CFT014
     C           INRCRT    IFEQ 'N'                                       CFT014
     C                     MOVELINRCO1    @NST2   2                       CFT014
     C                     MOVE @NST2     @NST5   5
     C***********          MOVELPCCY      @NST5   5                       CFT014
     C                     MOVELSMCY      @NST5                           CFT014
     C/COPY WNCPYSRC,FT0803C009
     C                     ELSE                                           CFT014
     C                     MOVELINRCO1    @NST5                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
     C                     MOVELINTRIB    WNST5A                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     END
      *
     C           @NCDE     IFEQ @SEND
     C           @NCDE     OREQ @NST5
     C           @NCDE     OREQ WNST5A                                    CFT014
     C           @NCDE     OREQ *BLANKS
      *
      ** Set-off no incoming payment indicator
      *
     C                     MOVE '0'       *IN35
      *
      ** Get other details and check for exceptional condition
      *
     C                     EXSR ODTL
     C                     EXSR EXCP
      *
      ** If there are no exceptional condtions, and Autogen
      *
     C           *IN31     IFEQ '0'
     C           *IN32     ANDEQ'0'
     C           *IN33     ANDEQ'0'
     C           *IN52     ANDEQ'0'
     C                     EXSR AUGN
     C                     ELSE
     C                     EXSR NAUG
     C                     END
      *
     C           PYTP      IFEQ 'RP'
     C                     MOVE '1'       *IN51
     C                     ELSE
     C                     MOVE '0'       *IN51
     C                     END
      *
     C           ADDC      IFEQ 'A'
     C                     MOVE '1'       *IN54
     C                     ELSE
     C                     MOVE '0'       *IN54
     C                     END
      *
      ** If any exception occured, write to P3
      *
     C           *IN31     IFEQ '1'
     C           *IN32     OREQ '1'
     C           *IN33     OREQ '1'
      *
     C           *IN41     IFEQ '0'
     C                     OPEN FT0803P3
     C                     MOVELFILE3     SFILE
     C                     Z-ADDFNUM3     ZSNUM
     C                     EXSR ZSFL
     C                     MOVE '1'       *IN41
     C                     END
      *
     C                     WRITEHEADP3
     C                     WRITEDETP3
     C           CSW209    IFEQ 'Y'                                                           CSW209
     C                     EXSR WRCOV3                                                        CSW209
     C                     ENDIF                                                              CSW209
     C                     ADD  1         HNOEX
      *
      ** Else, to detail reports
      *
     C                     ELSE
      *
      ** If Transaction is Non-AutoGen, write to P2
      *
     C           *IN52     IFEQ '1'
      *
     C           *IN40     IFEQ '0'
     C                     OPEN FT0803P2
     C                     MOVELFILE2     SFILE
     C                     Z-ADDFNUM2     ZSNUM
     C                     EXSR ZSFL
     C                     MOVE '1'       *IN40
     C                     END
      *
     C                     WRITEHEADP2
     C                     WRITEDETP2
     C           CSW209    IFEQ 'Y'                                                           CSW209
     C                     EXSR WRCOV2                                                        CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CER030
      ** Write Transaction Type Incoming                                                      CER030
      *                                                                                       CER030
     C           CER030    IFEQ 'Y'                                                           CER030
     C           CGL013    OREQ 'Y'                                                           CER030
      *                                                                                       CER030
     C                     MOVE '0'       *IN18                                               CER030
     C           PLINE2    IFGE 58                                                            CER030
     C                     MOVE '1'       *IN18                                               CER030
     C                     WRITEHEADP2                                                        CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     WRITEDETRN2                                                        CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      ** Write Extended Narrative (Credit) Incoming                                           CER030
      *                                                                                       CER030
     C           CER031    IFEQ 'Y'                                                           CER030
      *                                                                                       CER030
     C                     MOVE '0'       *IN18                                               CER030
     C           PLINE2    IFGE 52                                                            CER030
     C                     MOVE '1'       *IN18                                               CER030
     C                     WRITEHEADP2                                                        CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     WRITEDETEXN2                                                       CER030
     C                     ENDIF                                                              CER030
      *
     C                     END
      *
      ** If Autogen, Write to P1
      *
     C           *IN52     IFEQ '0'
      *
     C           *IN39     IFEQ '0'
     C                     OPEN FT0803P1
     C                     MOVELFILE1     SFILE
     C                     Z-ADDFNUM1     ZSNUM
     C                     EXSR ZSFL
     C                     MOVE '1'       *IN39
     C                     END
      *
     C           OVDT      IFNE SLDT
     C           OSMT      ORNE STMT
      *
     C           *IN12     IFEQ '1'
     C*
     C** Format TOTAL settle amount
     C*
     C                     Z-ADDSTOTL     ZFLD15
     C                     Z-ADD@SMDP     ZDECS
     C                     EXSR ZFRPED
     C                     MOVE ZOUT22    SHTOTL
     C*
     C                     WRITEFOOTP1
     C                     END
      *
     C                     WRITEHEADP1
     C                     WRITECOLHED
     C                     WRITEHEADI
     C                     Z-ADD0         STOTL
     C                     Z-ADD0         SNMBR
      *
     C                     END
      *
     C                     MOVE '1'       *IN12
     C                     WRITEDETP1I
      *                                                                                       CER030
      ** Write Transaction Type - Outgoing Payment                                            CER030
      *                                                                                       CER030
     C           CER030    IFEQ 'Y'                                                           CER030
     C           CGL013    OREQ 'Y'                                                           CER030
     C                     WRITEDETTRN                                                        CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      ** Write Extended Narratives - Incoming Payment                                         CER030
      *                                                                                       CER030
     C           CER031    IFEQ 'Y'                                                           CER030
     C                     MOVE '1'       *IN16                                               CER030
     C                     WRITEDETEXNC                                                       CER030
     C                     MOVE '0'       *IN16                                               CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ADD  SMAM      STOTL
     C                     ADD  1         SNMBR
     C                     Z-ADDSLDT      OVDT    50
     C                     Z-ADDSTMT      OSMT    20
      *
     C           *IN10     IFEQ '1'
     C                     WRITEHEADP1
     C                     WRITEHEADI
     C                     MOVE '0'       *IN10
     C                     END
      *
     C                     END
     C                     ADD  1         HNOTR
      *
     C                     END
      *
      ** If Authorise, update OTPAYDD
      *
     C           *IN30     IFEQ '0'
     C                     EXSR PAYA
     C                     END
      *
     C                     ELSE
      *
      ** De-marked Payment in the extension file (INPAYXL0 or OTPAYXL0).
      *
     C                     EXSR DMPYT
     C                     ADD  1         @NEXP
     C                     END
      *
     C                     ELSE
      *
      ** De-marked Payment in the extension file (INPAYXL0 or OTPAYXL0).
      *
     C                     EXSR DMPYT
     C                     ADD  1         @NEXP
     C                     END
      *
     C                     READ INPAYJ2                  62
      *
     C                     END                             -DOW not EOF
      *
     C           *IN12     IFEQ '1'
     C*
     C** Format TOTAL settle amount
     C*
     C                     Z-ADDSTOTL     ZFLD15
     C                     Z-ADD@SMDP     ZDECS
     C                     EXSR ZFRPED
     C                     MOVE ZOUT22    SHTOTL
     C*
     C                     WRITEFOOTP1
     C                     END
      *
     C                     END
      *
     C                     ENDSR
      *
     C/EJECT
     C*****************************************************************
     C*   ALLB     : All Branch processing                            *
     C*   Called by: DETL - Detail Processing                         *
     C*   Calls    : ZSFL - Setup printer file via RCF                *
     C*              ODTL - Get other details for reporting           *
     C*              EXCP - Process for Exceptional Condition         *
     C*              AUGN - AutoGen Procesing                         *
     C*              NAUG - Non-AutoGen Processing                    *
     C*              PAYA - Payments Authorisation                    *
     C*****************************************************************
     C           ALLB      BEGSR
      *
      ** OUTGOING PAYMENTS PROCESSING.
      *
     C           *IN29     IFEQ '0'
      *
      ** Set-on no outgoing payment indicator
      *
     C                     MOVE '1'       *IN34
      *
      ** Do while not End of file, OTPAYJ2
      *
     C           *IN61     DOWNE'1'
     C/COPY WNCPYSRC,FT0803C010
      *
      ** Determine if settlement thru BOJNET.
      *
     C                     MOVE STMT      STMTA
     C                     MOVE OPMSGR    @MSGR
     C                     EXSR INCR
      *
      ** Blank out parameter field for call to FT0805.
      *
     C                     MOVE *BLANKS   @ACNT
      *
      ** Select only records that matches entered Nostro code, if
      **  entered, (this is not done in open query file)
      *
     C           @NCDE     IFNE *BLANKS
     C                     MOVELDST1      @DEST   5
     C                     MOVELSNCO      @NST2   2
     C                     MOVE @NST2     @NST5   5
     C                     MOVELPCCY      @NST5   5
     C/COPY WNCPYSRC,FT0803C011
     C                     END
      *
     C           @NCDE     IFEQ @DEST
     C           @NCDE     OREQ @NST5
     C           @NCDE     OREQ *BLANKS
      *
      ** Set-off no outgoing payment indicator
      *
     C                     MOVE '0'       *IN34
      *
      ** Get other details and check for exceptional condition
      *
     C                     EXSR ODTL
     C                     EXSR EXCP
      *
      ** If there are no exceptional condtions, and Autogen
      *
     C           *IN31     IFEQ '0'
     C           *IN32     ANDEQ'0'
     C           *IN33     ANDEQ'0'
     C           *IN52     ANDEQ'0'
     C                     EXSR AUGN
     C                     ELSE
     C                     EXSR NAUG
     C                     END
      *
     C           PYTP      IFEQ 'RP'
     C                     MOVE '1'       *IN51
     C                     ELSE
     C                     MOVE '0'       *IN51
     C                     END
      *
     C           ADDC      IFEQ 'A'
     C                     MOVE '1'       *IN54
     C                     ELSE
     C                     MOVE '0'       *IN54
     C                     END
      *
      ** If any exception occured, write to P3
      *
     C           *IN31     IFEQ '1'
     C           *IN32     OREQ '1'
     C           *IN33     OREQ '1'
      *
     C           *IN41     IFEQ '0'
     C                     OPEN FT0803P3
     C                     MOVELFILE3     SFILE
     C                     Z-ADDFNUM3     ZSNUM
     C                     EXSR ZSFL
     C                     MOVE '1'       *IN41
     C                     END
      *
     C                     WRITEHEADP3
     C                     WRITEDETP3
     C           CSW209    IFEQ 'Y'                                                           CSW209
     C                     EXSR WRCOV3                                                        CSW209
     C                     ENDIF                                                              CSW209
     C                     ADD  1         HNOEX
      *
      ** Else, to detail reports
      *
     C                     ELSE
      *
      ** If Transaction is Non-AutoGen, write to P2
      *
     C           *IN52     IFEQ '1'
      *
     C           *IN40     IFEQ '0'
     C                     OPEN FT0803P2
     C                     MOVELFILE2     SFILE
     C                     Z-ADDFNUM2     ZSNUM
     C                     EXSR ZSFL
     C                     MOVE '1'       *IN40
     C                     END
      *
     C                     WRITEHEADP2
     C                     WRITEDETP2
     C           CSW209    IFEQ 'Y'                                                           CSW209
     C                     EXSR WRCOV2                                                        CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CER030
      ** Write Transaction Type Outgoing                                                      CER030
      *                                                                                       CER030
     C           CER030    IFEQ 'Y'                                                           CER030
     C           CGL013    OREQ 'Y'                                                           CER030
      *                                                                                       CER030
     C                     MOVE '0'       *IN18                                               CER030
     C           PLINE2    IFGE 58                                                            CER030
     C                     MOVE '1'       *IN18                                               CER030
     C                     WRITEHEADP2                                                        CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     WRITEDETRN2                                                        CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      ** Write Extended Narrative (Debit) Outgoing                                            CER030
      *                                                                                       CER030
     C           CER031    IFEQ 'Y'                                                           CER030
      *                                                                                       CER030
     C                     MOVE '0'       *IN18                                               CER030
     C           PLINE2    IFGE 52                                                            CER030
     C                     MOVE '1'       *IN18                                               CER030
     C                     WRITEHEADP2                                                        CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     WRITEDETEXN1                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      ** Write Extended Narrative (Credit) Outgoing                                           CER030
      *                                                                                       CER030
     C           CER031    IFEQ 'Y'                                                           CER030
     C           CFT003    ANDEQ'Y'                                                           CER030
      *                                                                                       CER030
     C                     MOVE '0'       *IN18                                               CER030
     C           PLINE2    IFGE 52                                                            CER030
     C                     MOVE '1'       *IN18                                               CER030
     C                     WRITEHEADP2                                                        CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     WRITEDETEXN2                                                       CER030
     C                     ENDIF                                                              CER030
      *
     C                     END
      *
      ** If Autogen, Write to P1
      *
     C           *IN52     IFEQ '0'
      *
     C           *IN39     IFEQ '0'
     C                     OPEN FT0803P1
     C                     MOVELFILE1     SFILE
     C                     Z-ADDFNUM1     ZSNUM
     C                     EXSR ZSFL
     C                     MOVE '1'       *IN39
     C                     END
      *
     C           OVDT      IFNE SLDT
     C           OSMT      ORNE STMT
      *
     C           *IN12     IFEQ '1'
     C*
     C** Format TOTAL settle amount
     C*
     C                     Z-ADDSTOTL     ZFLD15
     C                     Z-ADD@SMDP     ZDECS
     C                     EXSR ZFRPED
     C                     MOVE ZOUT22    SHTOTL
     C*
     C                     WRITEFOOTP1
     C                     END
      *
     C                     WRITEHEADP1
     C                     WRITECOLHED
     C                     WRITEHEADO
     C                     Z-ADD0         STOTL
     C                     Z-ADD0         SNMBR
      *
     C                     END
      *
     C                     MOVE '1'       *IN12
     C                     WRITEDETP1O
      *                                                                                       CER030
      ** Write Transaction Type - Outgoing Payment                                            CER030
      *                                                                                       CER030
     C           CER030    IFEQ 'Y'                                                           CER030
     C           CGL013    OREQ 'Y'                                                           CER030
     C                     WRITEDETTRN                                                        CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      ** Write Extended Narratives - Outgoing Payment                                         CER030
      *                                                                                       CER030
     C           CER031    IFEQ 'Y'                                                           CER030
     C                     WRITEDETEXND                                                       CER030
     C           CFT003    IFEQ 'Y'                                                           CER030
     C                     WRITEDETEXNC                                                       CER030
     C                     ENDIF                                                              CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ADD  SMAM      STOTL
     C                     ADD  1         SNMBR
     C                     Z-ADDSLDT      OVDT    50
     C                     Z-ADDSTMT      OSMT    20
      *
     C           *IN10     IFEQ '1'
     C                     WRITEHEADP1
     C                     WRITEHEADO
     C                     MOVE '0'       *IN10
     C                     END
      *
     C                     END
     C                     ADD  1         HNOTR
      *
     C                     END
      *
      ** If Authorise, update OTPAYDD
      *
     C           *IN30     IFEQ '0'
     C                     EXSR PAYA
     C                     END
      *
     C                     ELSE
      *
      ** De-marked Payment in the extension file (INPAYXL0 or OTPAYXL0).
      *
     C                     EXSR DMPYT
     C                     ADD  1         @NEXP
     C                     END
      *
      ** If Change of branch, separate spool files
      *
     C                     MOVE BRCA      W0BRC   3
      *
     C                     READ OTPAYJ2                  61
      *
     C           W0BRC     IFNE BRCA
      *
     C           *IN12     IFEQ '1'
     C*
     C** Format TOTAL settle amount
     C*
     C                     Z-ADDSTOTL     ZFLD15
     C                     Z-ADD@SMDP     ZDECS
     C                     EXSR ZFRPED
     C                     MOVE ZOUT22    SHTOTL
     C*
     C                     WRITEFOOTP1
     C                     END
      *
     C           *IN38     IFEQ '1'
     C                     CLOSEFT0803AU
     C                     MOVE '0'       *IN38
     C                     END
      *
     C           *IN39     IFEQ '1'
     C                     CLOSEFT0803P1
     C                     MOVE '0'       *IN39
     C                     END
      *
     C           *IN40     IFEQ '1'
     C                     CLOSEFT0803P2
     C                     MOVE '0'       *IN40
     C                     END
      *
     C           *IN41     IFEQ '1'
     C                     CLOSEFT0803P3
     C                     MOVE '0'       *IN41
     C                     END
     C                     END
      *
     C                     END                             -DOW not EOF
     C                     END
      *
      ** If incoming payment processing
      *
     C           *IN29     IFEQ '1'
      *
      ** Set-on no incoming payment indicator
      *
     C                     MOVE '1'       *IN35
      *
      ** Do while not End of file, INPAYJ2
      *
     C           *IN62     DOWNE'1'
      *
      ** If Level I or Level II is not yet completed do not process.
      *
     C***********INLVL1    IFNE 'Y'                                       166587
     C***********INLVL2    ORNE 'Y'                                       166587
     C           INLVL1    IFEQ 'Y'                                       166587
     C           INLVL2    ANDEQ'Y'                                       166587
     C/COPY WNCPYSRC,FT0803C012
      *
      ** Determine if settlement thru BOJNET.
      *
     C                     MOVE INSETM    STMTA
     C                     MOVE INMSGR    @MSGR
     C                     EXSR INCR
      *
      ** Blank out parameter field for call to FT0803.
      *
     C                     MOVE *BLANKS   @ACNT
      *
      ** Select only records that matches entered Nostro code, if
      **  entered, (this is not done in open query file)
      *
     C           @NCDE     IFNE *BLANKS
     C                     MOVELSND1      @SEND   5
     C***********          MOVELRCCO      @NST2   2                       CFT014
      *                                                                   CFT014
     C           INRCRT    IFEQ 'N'                                       CFT014
     C                     MOVELINRCO1    @NST2   2                       CFT014
     C                     MOVE @NST2     @NST5   5
     C***********          MOVELPCCY      @NST5   5                       CFT014
     C                     MOVELSMCY      @NST5                           CFT014
     C/COPY WNCPYSRC,FT0803C013
     C                     ELSE                                           CFT014
     C                     MOVELINRCO1    @NST5                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
     C                     MOVELINTRIB    WNST5A                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     END
      *
     C           @NCDE     IFEQ @SEND
     C           @NCDE     OREQ @NST5
     C           @NCDE     OREQ WNST5A                                    CFT014
     C           @NCDE     OREQ *BLANKS
      *
      ** Set-off no incoming payment indicator
      *
     C                     MOVE '0'       *IN35
      *
      ** Get other details and check for exceptional condition
      *
     C                     EXSR ODTL
     C                     EXSR EXCP
      *
      ** If there are no exceptional condtions, and Autogen
      *
     C           *IN31     IFEQ '0'
     C           *IN32     ANDEQ'0'
     C           *IN33     ANDEQ'0'
     C           *IN52     ANDEQ'0'
     C                     EXSR AUGN
     C                     ELSE
     C                     EXSR NAUG
     C                     END
      *
     C           PYTP      IFEQ 'RP'
     C                     MOVE '1'       *IN51
     C                     ELSE
     C                     MOVE '0'       *IN51
     C                     END
      *
     C           ADDC      IFEQ 'A'
     C                     MOVE '1'       *IN54
     C                     ELSE
     C                     MOVE '0'       *IN54
     C                     END
      *
      ** If any exception occured, write to P3
      *
     C           *IN31     IFEQ '1'
     C           *IN32     OREQ '1'
     C           *IN33     OREQ '1'
     C*
     C           *IN41     IFEQ '0'
     C                     OPEN FT0803P3
     C                     MOVELFILE3     SFILE
     C                     Z-ADDFNUM3     ZSNUM
     C                     EXSR ZSFL
     C                     MOVE '1'       *IN41
     C                     END
     C*
     C                     WRITEHEADP3
     C                     WRITEDETP3
     C           CSW209    IFEQ 'Y'                                                           CSW209
     C                     EXSR WRCOV3                                                        CSW209
     C                     ENDIF                                                              CSW209
     C                     ADD  1         HNOEX
     C*
     C** Else, to detail reports
     C*
     C                     ELSE
     C*
     C** If Transaction is Non-AutoGen, write to P2
     C*
     C           *IN52     IFEQ '1'
     C*
     C           *IN40     IFEQ '0'
     C                     OPEN FT0803P2
     C                     MOVELFILE2     SFILE
     C                     Z-ADDFNUM2     ZSNUM
     C                     EXSR ZSFL
     C                     MOVE '1'       *IN40
     C                     END
     C*
     C                     WRITEHEADP2
     C                     WRITEDETP2
     C           CSW209    IFEQ 'Y'                                                           CSW209
     C                     EXSR WRCOV2                                                        CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CER030
      ** Write Transaction Type Incoming                                                      CER030
      *                                                                                       CER030
     C           CER030    IFEQ 'Y'                                                           CER030
     C           CGL013    OREQ 'Y'                                                           CER030
      *                                                                                       CER030
     C                     MOVE '0'       *IN18                                               CER030
     C           PLINE2    IFGE 58                                                            CER030
     C                     MOVE '1'       *IN18                                               CER030
     C                     WRITEHEADP2                                                        CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     WRITEDETRN2                                                        CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      ** Write Extended Narrative (Credit) Incoming                                           CER030
      *                                                                                       CER030
     C           CER031    IFEQ 'Y'                                                           CER030
      *                                                                                       CER030
     C                     MOVE '0'       *IN18                                               CER030
     C           PLINE2    IFGE 52                                                            CER030
     C                     MOVE '1'       *IN18                                               CER030
     C                     WRITEHEADP2                                                        CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     WRITEDETEXN2                                                       CER030
     C                     ENDIF                                                              CER030
     C*
     C                     END
     C*
     C** If Autogen, Write to P1
     C*
     C           *IN52     IFEQ '0'
     C*
     C           *IN39     IFEQ '0'
     C                     OPEN FT0803P1
     C                     MOVELFILE1     SFILE
     C                     Z-ADDFNUM1     ZSNUM
     C                     EXSR ZSFL
     C                     MOVE '1'       *IN39
     C                     END
     C*
     C           OVDT      IFNE SLDT
     C           OSMT      ORNE STMT
     C*
     C           *IN12     IFEQ '1'
     C*
     C** Format TOTAL settle amount
     C*
     C                     Z-ADDSTOTL     ZFLD15
     C                     Z-ADD@SMDP     ZDECS
     C                     EXSR ZFRPED
     C                     MOVE ZOUT22    SHTOTL
     C*
     C                     WRITEFOOTP1
     C                     END
     C*
     C                     WRITEHEADP1
     C                     WRITECOLHED
     C                     WRITEHEADI
     C                     Z-ADD0         STOTL
     C                     Z-ADD0         SNMBR
     C*
     C                     END
     C*
     C                     MOVE '1'       *IN12
     C                     WRITEDETP1I
      *                                                                                       CER030
      ** Write Transaction Type - Incoming Payment                                            CER030
      *                                                                                       CER030
     C           CER030    IFEQ 'Y'                                                           CER030
     C           CGL013    OREQ 'Y'                                                           CER030
     C                     WRITEDETTRN                                                        CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      ** Write Extended Narratives - Incoming Payment                                         CER030
      *                                                                                       CER030
     C           CER031    IFEQ 'Y'                                                           CER030
     C                     MOVE '1'       *IN16                                               CER030
     C                     WRITEDETEXNC                                                       CER030
     C                     MOVE '0'       *IN16                                               CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ADD  SMAM      STOTL
     C                     ADD  1         SNMBR
     C                     Z-ADDSLDT      OVDT    50
     C                     Z-ADDSTMT      OSMT    20
     C*
     C           *IN10     IFEQ '1'
     C                     WRITEHEADP1
     C                     WRITEHEADI
     C                     MOVE '0'       *IN10
     C                     END
     C*
     C                     END
     C                     ADD  1         HNOTR
     C*
     C                     END
     C*
     C** If Authorise, update OTPAYDD
     C*
     C           *IN30     IFEQ '0'
     C                     EXSR PAYA
     C                     END
     C*
     C                     ELSE
      *
      ** De-marked Payment in the extension file (INPAYXL0 or OTPAYXL0).
      *
     C                     EXSR DMPYT
     C                     ADD  1         @NEXP
     C                     END
     C*
     C                     ELSE
      *
      ** De-marked Payment in the extension file (INPAYXL0 or OTPAYXL0).
      *
     C                     EXSR DMPYT
     C                     ADD  1         @NEXP
     C                     END
     C*
     C** If Change of branch, separate spool files
     C*
     C                     MOVE BRCA      W0BRC   3
     C*
     C                     READ INPAYJ2                  62
     C*
     C           W0BRC     IFNE BRCA
     C*
     C           *IN12     IFEQ '1'
     C*
     C** Format TOTAL settle amount
     C*
     C                     Z-ADDSTOTL     ZFLD15
     C                     Z-ADD@SMDP     ZDECS
     C                     EXSR ZFRPED
     C                     MOVE ZOUT22    SHTOTL
     C*
     C                     WRITEFOOTP1
     C                     END
     C*
     C           *IN38     IFEQ '1'
     C                     CLOSEFT0803AU
     C                     MOVE '0'       *IN38
     C                     END
     C*
     C           *IN39     IFEQ '1'
     C                     CLOSEFT0803P1
     C                     MOVE '0'       *IN39
     C                     END
     C*
     C           *IN40     IFEQ '1'
     C                     CLOSEFT0803P2
     C                     MOVE '0'       *IN40
     C                     END
     C*
     C           *IN41     IFEQ '1'
     C                     CLOSEFT0803P3
     C                     MOVE '0'       *IN41
     C                     END
     C                     END
     C*
     C                     END                             -DOW not EOF
     C                     END
     C*
     C                     ENDSR
     C*
     C/EJECT                                                              CFT006
     C*****************************************************************   CFT006
     C*   RFTDTL   : RFT processing                                   *   CFT006
     C*   Called by: DETL                                             *   CFT006
     C*****************************************************************   CFT006
     C           RFTDTL    BEGSR                                          CFT006
      *                                                                   CFT006
     C                     Z-ADD0         SNMBR                           CFT006
     C                     Z-ADD0         STOTL                           CFT006
      *                                                                   CFT006
     C           *IN56     DOWNE*ON                                       CFT006
      *                                                                   CFT006
     C           RFTID     CHAINFT101HL3             60                   CFT006
      *                                                                   CFT006
     C           *IN60     IFEQ *ON                                       CFT006
     C           *LOCK     IN   LDA                                       CFT006
     C                     Z-ADD85        DBASE            ***************CFT006
     C                     MOVEL'FT101HL3'DBFILE           * DBERR 085   *CFT006
     C                     MOVELRFTID     DBKEY            ***************CFT006
     C                     OUT  LDA                                       CFT006
     C                     EXSR *PSSR                                     CFT006
     C                     ENDIF                                          CFT006
      *                                                                                       CSD015
      ** When CSD015 enhancement is installed and watch list checking is applied,             CSD015
      ** check if payment exists on Compliance Watch Hit List file                            CSD015
      *                                                                                       CSD015
     C           CSD015    IFEQ 'Y'                                                           CSD015
     C           CSC011    ANDEQ'N'                                                           CSD015
     C           CSC011    OREQ 'Y'                                                           CSD015
     C           LIBR      ANDEQS1MAIN                                                        CSD015
      *                                                                                       CSD015
     C           WELCR     IFEQ 'Y'                                                           CSD015
     C                     MOVEL'FT101DPD'KFUNT                                               CSD015
     C                     MOVELRFTID     KIDEN                                               CSD015
     C                     MOVELBRCA      KBRCH                                               CSD015
      *                                                                                       CSD015
     C           KCWHT     CHAINSDCWHTL1             50                                       CSD015
      *                                                                                       CSD015
      ** If record found and under investigation, activate *IN46 to display on                CSD015
      ** the report, 'Item under review by Compliance Officer'                                CSD015
      *                                                                                       CSD015
     C           *IN50     IFEQ *OFF                                                          CSD015
     C           W3TREL    ANDNE'Y'                                                           CSD015
     C                     MOVEL*ON       *IN46                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     ENDIF                                                              CSD015
      *                                                                   CFT006
      ** Blank out batch report user and batch number and authorise       CFT006
      ** record                                                           CFT006
      *                                                                   CFT006
     C           *IN30     IFEQ *OFF                                      CFT006
     C           CSD015    IFEQ 'Y'                                                           CSD015
     C           CSC011    ANDEQ'N'                                                           CSD015
     C           CSC011    OREQ 'Y'                                                           CSD015
     C           LIBR      ANDEQS1MAIN                                                        CSD015
      *                                                                                       CSD015
     C           WELCR     IFEQ 'Y'                                                           CSD015
     C           *IN46     ANDEQ*OFF                                                          CSD015
     C                     MOVE *BLANKS   BAUTH                           CFT006
     C                     MOVE *BLANKS   BATUSR                          CFT006
     C                     UPDATFT101H                                    CFT006
      *                                                                   CFT006
     C                     MOVE *BLANKS   P@RTCD                          CFT006
     C                     MOVE 'A'       P@RESP                          CFT006
     C                     MOVE 'X'       P@ACT                           CFT006
     C                     MOVELRFTID     P@RFT                           CFT006
     C                     MOVELSNDREF    P@SNDR                          CFT006
     C                     MOVELSTID      P@STID                          CFT006
      *                                                                   CFT006
     C                     CALL RFTUPD                                    CFT006
     C                     PARM           P@RTCD 10                       CFT006
     C                     PARM           P@RESP  1                       CFT006
     C                     PARM           P@ACT   1                       CFT006
     C                     PARM           P@RFT  15                       CFT006
     C                     PARM           P@SNDR 16                       CFT006
     C                     PARM           P@STID 12                       CFT006
     C                     ENDIF                                                              CSD015
     C                     ENDIF                                                              CSD015
     C                     ENDIF                                          CFT006
      *                                                                                       CSD015
      ** Printing of the autogen and non autogen should be conditioned to *IN46               CSD015
      *                                                                                       CSD015
     C           CSD015    IFEQ 'Y'                                                           CSD015
     C           CSC011    ANDEQ'N'                                                           CSD015
     C           CSC011    OREQ 'Y'                                                           CSD015
     C           LIBR      ANDEQS1MAIN                                                        CSD015
      *                                                                                       CSD015
     C           WELCR     IFEQ 'Y'                                                           CSD015
     C           *IN46     ANDEQ*OFF                                                          CSD015
      *                                                                   CFT006
      ** Autogen report                                                   CFT006
      *                                                                   CFT006
     C           *IN52     IFEQ *OFF                                      CFT006
     C                     EXSR RFTAUT                                    CFT006
      *                                                                   CFT006
      ** Non-autogen report                                               CFT006
      *                                                                   CFT006
     C                     ELSE                                           CFT006
     C                     EXSR RFTNAU                                    CFT006
     C                     ENDIF                                          CFT006
      *                                                                                       CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Otherwise, if *IN46 is not equal to *OFF, print payment exception report             CSD015
      *                                                                                       CSD015
     C           CSD015    IFEQ 'Y'                                                           CSD015
     C           CSC011    ANDEQ'N'                                                           CSD015
     C           CSC011    OREQ 'Y'                                                           CSD015
     C           LIBR      ANDEQS1MAIN                                                        CSD015
      *                                                                                       CSD015
     C           WELCR     IFEQ 'Y'                                                           CSD015
     C           *IN46     ANDEQ*ON                                                           CSD015
      *                                                                                       CSD015
     C           *IN41     IFEQ '0'                                                           CSD015
     C                     OPEN FT0803P3                                                      CSD015
     C                     MOVELFILE3     SFILE                                               CSD015
     C                     Z-ADDFNUM3     ZSNUM                                               CSD015
     C                     EXSR ZSFL                                                          CSD015
     C                     MOVE '1'       *IN41                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     WRITEHEADP3                                                        CSD015
     C                     WRITEDETP3                                                         CSD015
     C                     ADD  1         HNOEX                                               CSD015
      *                                                                                       CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     ENDIF                                                              CSD015
      *                                                                   CFT006
     C                     READ FT101X0                  56               CFT006
      *                                                                   CFT006
     C                     ENDDO                                          CFT006
      *                                                                   CFT006
      ** Write footer                                                     CFT006
      *                                                                   CFT006
     C           *IN52     IFEQ *OFF                                      CFT006
     C                     Z-ADDSTOTL     ZFLD15                          CFT006
     C                     Z-ADD@BCDP     ZDECS                           CFT006
     C                     EXSR ZFRPED                                    CFT006
     C                     MOVE ZOUT22    SHTOTL                          CFT006
     C                     WRITEFOOTP1                                    CFT006
     C                     ELSE                                           CFT006
     C                     WRITEENDP2                                     CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ENDSR                                          CFT006
     C/EJECT                                                              CFT006
     C*****************************************************************   CFT006
     C*   RFTAUT   : RFT processing - autogen report                  *   CFT006
     C*   Called by: RFTDTL                                           *   CFT006
     C*****************************************************************   CFT006
     C           RFTAUT    BEGSR                                          CFT006
      *                                                                   CFT006
     C           *IN39     IFEQ *OFF                                      CFT006
     C                     OPEN FT0803P1                                  CFT006
     C                     MOVELFILE1     SFILE                           CFT006
     C                     Z-ADDFNUM1     ZSNUM                           CFT006
     C                     EXSR ZSFL                                      CFT006
     C                     MOVE *ON       *IN39                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      ** Transfer type                                                    CFT006
      *                                                                   CFT006
     C                     MOVE PYTP      TTYPE                           CFT006
      *                                                                   CFT006
     C           PYTP      IFEQ 'RI'                                      CFT006
     C                     MOVE *ON       *IN71                           CFT006
     C                     ELSE                                           CFT006
     C                     MOVE *OFF      *IN71                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      ** Write header                                                     CFT006
      *                                                                   CFT006
     C                     WRITEHEADP1                                    CFT006
     C                     WRITECOLHD2                                    CFT006
     C                     WRITEHEADRC                                    CFT006
      *                                                                   CFT006
      ** Clear printer fields                                             CFT006
      *                                                                   CFT006
     C                     MOVE *BLANKS   PREFE                           CFT006
     C                     MOVE *BLANKS   PSEND                           CFT006
     C                     MOVE *BLANKS   PDDAT                           CFT006
     C                     MOVE *BLANKS   PCCY                            CFT006
     C                     MOVE *BLANKS   PCAMT                           CFT006
     C                     MOVE *BLANKS   PBENEF                          CFT006
      *                                                                   CFT006
      ** RFT ID                                                           CFT006
      *                                                                   CFT006
     C                     MOVE RFTID     PREFE                           CFT006
      *                                                                   CFT006
      ** Sender/destination                                               CFT006
      *                                                                   CFT006
     C           PYTP      IFEQ 'RI'                                      CFT006
     C                     MOVELSINST     PSEND                           CFT006
     C                     ELSE                                           CFT006
     C                     MOVELHACSV1    PSEND                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      ** Debit value date (RI only)                                       CFT006
      *                                                                   CFT006
     C           PYTP      IFEQ 'RI'                                      CFT006
     C                     Z-ADDDBTVDT    ZDAYNO                          CFT006
     C                     EXSR ZDATE2                                    CFT006
     C                     MOVE ZADATE    PDDAT                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C           KEYRFT    CHAINFT101HL6             43                   CFT006
      *                                                                   CFT006
     C           RFTID     CHAINFT101DL2             72                   CFT006
      *                                                                   CFT006
     C           *IN72     DOWEQ*OFF                                      CFT006
      *                                                                   CFT006
      ** Pay/Transfer currency                                            CFT006
      *                                                                   CFT006
     C           PYTP      IFEQ 'RI'                                      CFT006
     C                     MOVE PAYCCY    PCCY                            CFT006
     C                     ELSE                                           CFT006
     C                     MOVE TRNCCY    PCCY                            CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      ** Format pay/transfer amount                                       CFT006
      *                                                                   CFT006
     C           PCCY      IFNE *BLANKS                                   CFT006
     C                     CALL 'AOCURRR0'                                CFT006
     C                     PARM *BLANKS   @RTCD                           CFT006
     C                     PARM '*KEY   ' @OPTN                           CFT006
     C                     PARM PCCY      @CCY                            CFT006
     C           SDCURR    PARM SDCURR    DSSDY                           CFT006
      *                                                                   CFT006
     C           @RTCD     IFNE *BLANKS                                   CFT006
     C                     Z-ADD87        DBASE            ***************CFT006
     C                     MOVEL'SDCURRPD'DBFILE           * DBERR 087   *CFT006
     C                     MOVELPCCY      DBKEY            ***************CFT006
     C                     OUT  LDA                                       CFT006
     C                     EXSR *PSSR                                     CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     Z-ADDA6NBDP    PDEC    10                      CFT006
      *                                                                   CFT006
     C           PYTP      IFEQ 'RI'                                      CFT006
     C                     MOVE PAYAMT    ZFIELD                          CFT006
     C                     ADD  PAYAMT    STOTL                           CFT006
     C                     ELSE                                           CFT006
     C                     MOVE TRNAMT    ZFIELD                          CFT006
     C                     ADD  TRNAMT    STOTL                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     Z-ADDPDEC      ZADEC                           CFT006
     C                     EXSR ZEDIT                                     CFT006
     C                     MOVE ZFIELD    PCAMT                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      ** Beneficiary                                                      CFT006
      *                                                                   CFT006
     C                     MOVELTBNA35    PBENEF                          CFT006
      *                                                                   CFT006
      ** Write details                                                    CFT006
      *                                                                   CFT006
     C                     WRITEDTP1RC                                    CFT006
     C                     ADD  1         SNMBR                           CFT006
      *                                                                   CFT006
     C           @RAIN     IFNE 'R'                                       CFT006
     C           AUIN      IFEQ 'Y'                                       CFT006
     C                     ADD  1         HNOTR                           CFT006
     C                     ELSE                                           CFT006
     C                     ADD  1         HNOEX                           CFT006
     C                     ENDIF                                          CFT006
     C                     ELSE                                           CFT006
     C                     ADD  1         HNOTR                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C           *IN10     IFEQ *ON                                       CFT006
     C                     WRITEHEADP1                                    CFT006
     C                     WRITECOLHD2                                    CFT006
     C                     WRITEHEADRC                                    CFT006
     C                     MOVE *OFF      *IN10                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C           RFTID     READEFT101DL2                 72               CFT006
     C                     ENDDO                                          CFT006
      *                                                                   CFT006
     C                     ENDSR                                          CFT006
     C/EJECT                                                              CFT006
     C*****************************************************************   CFT006
     C*   RFTNAU   : RFT processing - non-autogen report              *   CFT006
     C*   Called by: RFTDTL                                           *   CFT006
     C*****************************************************************   CFT006
     C           RFTNAU    BEGSR                                          CFT006
      *                                                                   CFT006
     C           *IN40     IFEQ *OFF                                      CFT006
     C                     OPEN FT0803P2                                  CFT006
     C                     MOVELFILE2     SFILE                           CFT006
     C                     Z-ADDFNUM2     ZSNUM                           CFT006
     C                     EXSR ZSFL                                      CFT006
     C                     MOVE *ON       *IN40                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      ** Clear printer fields                                             CFT006
      *                                                                   CFT006
     C                     MOVE *BLANKS   PUSER                           CFT006
     C                     MOVE *BLANKS   TTYPE                           CFT006
     C                     MOVE *BLANKS   STYPE                           CFT006
     C                     MOVE *BLANKS   PRFT                            CFT006
     C                     MOVE *BLANKS   PTRAN                           CFT006
     C                     MOVE *BLANKS   PDDAT                           CFT006
     C                     MOVE *BLANKS   POVR                            CFT006
     C                     MOVE *BLANKS   PSWF                            CFT006
     C                     MOVE *BLANKS   PTAMT                           CFT006
     C                     Z-ADD*ZERO     PXRAT                           CFT006
     C                     MOVE *BLANKS   PPAMT                           CFT006
     C                     MOVE *BLANKS   PTCCY                           CFT006
     C                     MOVE *BLANKS   TPCCY                           CFT006
     C                     MOVE *BLANKS   PCHG                            CFT006
     C                     MOVE *BLANKS   PCHGAC                          CFT006
     C                     MOVE *BLANKS   PRVCHC                          CFT006
     C                     MOVE *BLANKS   PRVCHA                          CFT006
     C                     MOVE *BLANKS   PT20                            CFT006
     C                     MOVE *BLANKS   PT50H1                          CFT006
     C                     MOVE *BLANKS   PT50H2                          CFT006
     C                     MOVE *BLANKS   PT50H3                          CFT006
     C                     MOVE *BLANKS   PT50H4                          CFT006
     C                     MOVE *BLANKS   PT50H5                          CFT006
     C                     MOVE *BLANKS   PT50L                           CFT006
     C                     MOVE *BLANKS   PT51A                           CFT006
     C                     MOVE *BLANKS   PT52                            CFT006
     C                     MOVE *BLANKS   PT561                           CFT006
     C                     MOVE *BLANKS   PT562                           CFT006
     C                     MOVE *BLANKS   PT563                           CFT006
     C                     MOVE *BLANKS   PT564                           CFT006
     C                     MOVE *BLANKS   PT565                           CFT006
     C                     MOVE *BLANKS   PT571                           CFT006
     C                     MOVE *BLANKS   PT572                           CFT006
     C                     MOVE *BLANKS   PT573                           CFT006
     C                     MOVE *BLANKS   PT574                           CFT006
     C                     MOVE *BLANKS   PT575                           CFT006
     C                     MOVE *BLANKS   PT591                           CFT006
     C                     MOVE *BLANKS   PT592                           CFT006
     C                     MOVE *BLANKS   PT593                           CFT006
     C                     MOVE *BLANKS   PT594                           CFT006
     C                     MOVE *BLANKS   PT595                           CFT006
     C                     MOVE *BLANKS   PT701                           CFT006
     C                     MOVE *BLANKS   PT702                           CFT006
     C                     MOVE *BLANKS   PT703                           CFT006
     C                     MOVE *BLANKS   PT704                           CFT006
      *                                                                   CFT006
      ** Transfer type                                                    CFT006
      *                                                                   CFT006
     C                     MOVELPYTP      TTYPE                           CFT006
      *                                                                   CFT006
      ** Transfer sub-type                                                CFT006
      *                                                                   CFT006
     C                     MOVELPYST      STYPE                           CFT006
      *                                                                   CFT006
      ** RFT ID                                                           CFT006
      *                                                                   CFT006
     C                     MOVELRFTID     PRFT                            CFT006
      *                                                                   CFT006
      ** Swift priority                                                   CFT006
      *                                                                   CFT006
     C                     MOVELSWPRIO    PSWF                            CFT006
      *                                                                   CFT006
      ** Debit value date (RI only)                                       CFT006
      *                                                                   CFT006
     C           PYTP      IFEQ 'RI'                                      CFT006
     C                     Z-ADDDBTVDT    ZDAYNO                          CFT006
     C                     EXSR ZDATE2                                    CFT006
     C                     MOVE ZADATE    PDDAT                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      ** Senders reference                                                CFT006
      *                                                                   CFT006
     C                     MOVELSNDREF    PT20                            CFT006
      *                                                                   CFT006
      ** Ordering customer                                                CFT006
      *                                                                   CFT006
     C                     MOVELHOCUS1    PT50H1                          CFT006
     C                     MOVELHOCUS2    PT50H2                          CFT006
     C                     MOVELHOCUS3    PT50H3                          CFT006
     C                     MOVELHOCUS4    PT50H4                          CFT006
     C                     MOVELHOCUS5    PT50H5                          CFT006
      *                                                                   CFT006
      ** Instructing party                                                CFT006
      *                                                                   CFT006
     C                     MOVELHINPTY    PT50L                           CFT006
      *                                                                   CFT006
      ** Sending institution                                              CFT006
      *                                                                   CFT006
     C                     MOVELSINST     PT51A                           CFT006
      *                                                                   CFT006
      ** Account servicing institution                                    CFT006
      *                                                                   CFT006
     C                     MOVELHACSV1    PT52                            CFT006
      *                                                                   CFT006
     C           KEYRFT    CHAINFT101HL6             43                   CFT006
      *                                                                   CFT006
     C           RFTID     CHAINFT101DL2             72                   CFT006
      *                                                                   CFT006
     C           *IN72     DOWEQ*OFF                                      CFT006
      *                                                                   CFT006
      ** Input user                                                       CFT006
      *                                                                   CFT006
     C                     MOVELINUSER    PUSER                           CFT006
      *                                                                   CFT006
      ** Transaction reference                                            CFT006
      *                                                                   CFT006
     C                     MOVELTRNSID    PTRAN                           CFT006
      *                                                                   CFT006
      ** Exchange rate override                                           CFT006
      *                                                                   CFT006
     C                     MOVELXRATEO    POVR                            CFT006
      *                                                                   CFT006
      ** Transfer currency                                                CFT006
      *                                                                   CFT006
     C                     MOVELTRNCCY    PTCCY                           CFT006
      *                                                                   CFT006
      ** Format transfer amount                                           CFT006
      *                                                                   CFT006
     C           PTCCY     IFNE *BLANKS                                   CFT006
     C                     CALL 'AOCURRR0'                                CFT006
     C                     PARM *BLANKS   @RTCD                           CFT006
     C                     PARM '*KEY   ' @OPTN                           CFT006
     C                     PARM PTCCY     @CCY                            CFT006
     C           SDCURR    PARM SDCURR    DSSDY                           CFT006
      *                                                                   CFT006
     C           @RTCD     IFNE *BLANKS                                   CFT006
     C                     Z-ADD88        DBASE            ***************CFT006
     C                     MOVEL'SDCURRPD'DBFILE           * DBERR 088   *CFT006
     C                     MOVELPTCCY     DBKEY            ***************CFT006
     C                     OUT  LDA                                       CFT006
     C                     EXSR *PSSR                                     CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     Z-ADDA6NBDP    PDEC    10                      CFT006
     C                     MOVE TRNAMT    ZFIELD                          CFT006
     C                     Z-ADDPDEC      ZADEC                           CFT006
     C                     EXSR ZEDIT                                     CFT006
     C                     MOVE ZFIELD    PTAMT                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      ** Pay currency                                                     CFT006
      *                                                                   CFT006
     C                     MOVELPAYCCY    TPCCY                           CFT006
      *                                                                   CFT006
      ** Format pay amount                                                CFT006
      *                                                                   CFT006
     C           TPCCY     IFNE *BLANKS                                   CFT006
     C                     CALL 'AOCURRR0'                                CFT006
     C                     PARM *BLANKS   @RTCD                           CFT006
     C                     PARM '*KEY   ' @OPTN                           CFT006
     C                     PARM TPCCY     @CCY                            CFT006
     C           SDCURR    PARM SDCURR    DSSDY                           CFT006
      *                                                                   CFT006
     C           @RTCD     IFNE *BLANKS                                   CFT006
     C                     Z-ADD89        DBASE            ***************CFT006
     C                     MOVEL'SDCURRPD'DBFILE           * DBERR 089   *CFT006
     C                     MOVELTPCCY     DBKEY            ***************CFT006
     C                     OUT  LDA                                       CFT006
     C                     EXSR *PSSR                                     CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     Z-ADDA6NBDP    PDEC    10                      CFT006
     C                     MOVE PAYAMT    ZFIELD                          CFT006
     C                     Z-ADDPDEC      ZADEC                           CFT006
     C                     EXSR ZEDIT                                     CFT006
     C                     MOVE ZFIELD    PPAMT                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      ** Exchange rate                                                    CFT006
      *                                                                   CFT006
     C                     Z-ADDXRATE     PXRAT                           CFT006
      *                                                                   CFT006
      ** Charge detail                                                    CFT006
      *                                                                   CFT006
     C                     MOVELTDCHGS    PCHG                            CFT006
      *                                                                   CFT006
      ** Charge account                                                   CFT006
      *                                                                   CFT006
     C                     MOVELCHGACC    PCHGAC                          CFT006
      *                                                                   CFT006
      ** Receivers charge currency                                        CFT006
      *                                                                   CFT006
     C                     MOVELRCHCCY    PRVCHC                          CFT006
      *                                                                   CFT006
      ** Format receivers charge amount                                   CFT006
      *                                                                   CFT006
     C           PRVCHC    IFNE *BLANKS                                   CFT006
     C                     CALL 'AOCURRR0'                                CFT006
     C                     PARM *BLANKS   @RTCD                           CFT006
     C                     PARM '*KEY   ' @OPTN                           CFT006
     C                     PARM PRVCHC    @CCY                            CFT006
     C           SDCURR    PARM SDCURR    DSSDY                           CFT006
      *                                                                   CFT006
     C           @RTCD     IFNE *BLANKS                                   CFT006
     C                     Z-ADD90        DBASE            ***************CFT006
     C                     MOVEL'SDCURRPD'DBFILE           * DBERR 090   *CFT006
     C                     MOVELPRVCHC    DBKEY            ***************CFT006
     C                     OUT  LDA                                       CFT006
     C                     EXSR *PSSR                                     CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     Z-ADDA6NBDP    PDEC    10                      CFT006
     C                     MOVE RCVCHG    ZFIELD                          CFT006
     C                     Z-ADDPDEC      ZADEC                           CFT006
     C                     EXSR ZEDIT                                     CFT006
     C                     MOVE ZFIELD    PRVCHA                          CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      ** Ordering customer                                                CFT006
      *                                                                   CFT006
     C           PT50H1    IFEQ *BLANKS                                   CFT006
     C                     MOVELTOCUS1    PT50H1                          CFT006
     C                     MOVELTOCUS2    PT50H2                          CFT006
     C                     MOVELTOCUS3    PT50H3                          CFT006
     C                     MOVELTOCUS4    PT50H4                          CFT006
     C                     MOVELTOCUS5    PT50H5                          CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      ** Instructing party                                                CFT006
      *                                                                   CFT006
     C           PT50L     IFEQ *BLANKS                                   CFT006
     C                     MOVELTINPTY    PT50L                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      ** Account servicing institution                                    CFT006
      *                                                                   CFT006
     C           PT52      IFEQ *BLANKS                                   CFT006
     C                     MOVELTASI35    PT52                            CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      ** Intermediary                                                     CFT006
      *                                                                   CFT006
     C                     MOVELTINST1    PT561                           CFT006
     C                     MOVELTINST2    PT562                           CFT006
     C                     MOVELTINST3    PT563                           CFT006
     C                     MOVELTINST4    PT564                           CFT006
     C                     MOVELTINST5    PT565                           CFT006
      *                                                                   CFT006
      ** Account with institution                                         CFT006
      *                                                                   CFT006
     C                     MOVELTACA35    PT571                           CFT006
     C                     MOVELTACB35    PT572                           CFT006
     C                     MOVELTACC35    PT573                           CFT006
     C                     MOVELTACD35    PT574                           CFT006
     C                     MOVELTACE35    PT575                           CFT006
      *                                                                   CFT006
      ** Beneficiary                                                      CFT006
      *                                                                   CFT006
     C                     MOVELTBNA35    PT591                           CFT006
     C                     MOVELTBNB35    PT592                           CFT006
     C                     MOVELTBNC35    PT593                           CFT006
     C                     MOVELTBND35    PT594                           CFT006
     C                     MOVELTBNE35    PT595                           CFT006
      *                                                                   CFT006
      ** Remittance information                                           CFT006
      *                                                                   CFT006
     C                     MOVELTRMA35    PT701                           CFT006
     C                     MOVELTRMB35    PT702                           CFT006
     C                     MOVELTRMC35    PT703                           CFT006
     C                     MOVELTRMD35    PT704                           CFT006
      *                                                                   CFT006
      ** Write header                                                     CFT006
      *                                                                   CFT006
     C                     WRITEHEADP2                                    CFT006
      *                                                                   CFT006
      ** Write details                                                    CFT006
      *                                                                   CFT006
     C                     WRITEDETP2R                                    CFT006
      *                                                                   CFT006
     C           @RAIN     IFNE 'R'                                       CFT006
     C           AUIN      IFEQ 'Y'                                       CFT006
     C                     ADD  1         HNOTR                           CFT006
     C                     ELSE                                           CFT006
     C                     ADD  1         HNOEX                           CFT006
     C                     ENDIF                                          CFT006
     C                     ELSE                                           CFT006
     C                     ADD  1         HNOTR                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C           RFTID     READEFT101DL2                 72               CFT006
      *                                                                   CFT006
     C                     ENDDO                                          CFT006
      *                                                                   CFT006
     C                     ENDSR                                          CFT006
     C/EJECT                                                              CFT006
     C*****************************************************************   CFT006
     C*   CCTDTL   : CCT processing                                   *   CFT006
     C*   Called by: DETL                                             *   CFT006
     C*****************************************************************   CFT006
     C           CCTDTL    BEGSR                                          CFT006
      *                                                                   CFT006
     C                     Z-ADD0         SNMBR                           CFT006
     C                     Z-ADD0         STOTL                           CFT006
      *                                                                   CFT006
     C           *IN57     DOWNE*ON                                       CFT006
      *                                                                   CFT006
     C           CCTID     CHAINFT102HL3             68                   CFT006
      *                                                                   CFT006
     C           *IN68     IFEQ *ON                                       CFT006
     C           *LOCK     IN   LDA                                       CFT006
     C                     Z-ADD86        DBASE            ***************CFT006
     C                     MOVEL'FT102HL3'DBFILE           * DBERR 086   *CFT006
     C                     MOVELCCTID     DBKEY            ***************CFT006
     C                     OUT  LDA                                       CFT006
     C                     EXSR *PSSR                                     CFT006
     C                     ENDIF                                          CFT006
      *                                                                                       CSD015
      ** When CSD015 enhancement is installed and watch list checking is applied,             CSD015
      ** check if payment exists on Compliance Watch Hit List file                            CSD015
      *                                                                                       CSD015
     C           CSD015    IFEQ 'Y'                                                           CSD015
     C           CSC011    ANDEQ'N'                                                           CSD015
     C           CSC011    OREQ 'Y'                                                           CSD015
     C           LIBR      ANDEQS1MAIN                                                        CSD015
      *                                                                                       CSD015
     C           WELCC     IFEQ 'Y'                                                           CSD015
     C                     MOVEL'FT102DPD'KFUNT                                               CSD015
     C                     MOVELCCTID     KIDEN                                               CSD015
     C                     MOVELBRCA      KBRCH                                               CSD015
      *                                                                                       CSD015
     C           KCWHT     CHAINSDCWHTL1             50                                       CSD015
      *                                                                                       CSD015
      ** If record found and under investigation, activate *IN46 to display on                CSD015
      ** the report, 'Item under review by Compliance Officer'                                CSD015
      *                                                                                       CSD015
     C           *IN50     IFEQ *OFF                                                          CSD015
     C           W3TREL    ANDNE'Y'                                                           CSD015
     C                     MOVEL*ON       *IN46                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     ENDIF                                                              CSD015
      *                                                                   CFT006
      ** Blank out batch report user and batch number and authorise       CFT006
      ** record                                                           CFT006
      *                                                                   CFT006
     C           *IN30     IFEQ *OFF                                      CFT006
     C           CSD015    IFEQ 'Y'                                                           CSD015
     C           CSC011    ANDEQ'N'                                                           CSD015
     C           CSC011    OREQ 'Y'                                                           CSD015
     C           LIBR      ANDEQS1MAIN                                                        CSD015
      *                                                                                       CSD015
     C           WELCC     IFEQ 'Y'                                                           CSD015
     C           *IN46     ANDEQ*OFF                                                          CSD015
     C                     MOVE *BLANKS   BAUTH                           CFT006
     C                     MOVE *BLANKS   BATUSR                          CFT006
     C                     UPDATFT102H                                    CFT006
      *                                                                   CFT006
     C                     MOVE *BLANKS   P@RTCD                          CFT006
     C                     MOVE 'A'       P@RESP                          CFT006
     C                     MOVE 'X'       P@ACT                           CFT006
     C                     MOVELCCTID     P@CCT                           CFT006
     C                     MOVELFILREF    P@FILR                          CFT006
     C                     MOVELSTID      P@STID                          CFT006
      *                                                                   CFT006
     C                     CALL CCTUPD                                    CFT006
     C                     PARM           P@RTCD 10                       CFT006
     C                     PARM           P@RESP  1                       CFT006
     C                     PARM           P@ACT   1                       CFT006
     C                     PARM           P@CCT  15                       CFT006
     C                     PARM           P@FILR 16                       CFT006
     C                     PARM           P@STID 12                       CFT006
     C                     ENDIF                                                              CSD015
     C                     ENDIF                                                              CSD015
     C                     ENDIF                                          CFT006
      *                                                                                       CSD015
      ** Printing of the autogen and non autogen should be conditioned to *IN46               CSD015
      *                                                                                       CSD015
     C           CSD015    IFEQ 'Y'                                                           CSD015
     C           CSC011    ANDEQ'N'                                                           CSD015
     C           CSC011    OREQ 'Y'                                                           CSD015
     C           LIBR      ANDEQS1MAIN                                                        CSD015
      *                                                                                       CSD015
     C           WELCC     IFEQ 'Y'                                                           CSD015
     C           *IN46     ANDEQ*OFF                                                          CSD015
      *                                                                   CFT006
      ** Autogen report                                                   CFT006
      *                                                                   CFT006
     C           *IN52     IFEQ *OFF                                      CFT006
     C                     EXSR CCTAUT                                    CFT006
     C                     ELSE                                           CFT006
      *                                                                   CFT006
      ** Non-autogen report                                               CFT006
      *                                                                   CFT006
     C                     EXSR CCTNAU                                    CFT006
     C                     ENDIF                                          CFT006
      *                                                                                       CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Otherwise, if *IN46 is not equal to *OFF, print payment exception report             CSD015
      *                                                                                       CSD015
     C           CSD015    IFEQ 'Y'                                                           CSD015
     C           CSC011    ANDEQ'N'                                                           CSD015
     C           CSC011    OREQ 'Y'                                                           CSD015
     C           LIBR      ANDEQS1MAIN                                                        CSD015
      *                                                                                       CSD015
     C           WELCC     IFEQ 'Y'                                                           CSD015
     C           *IN46     ANDEQ*ON                                                           CSD015
      *                                                                                       CSD015
     C           *IN41     IFEQ '0'                                                           CSD015
     C                     OPEN FT0803P3                                                      CSD015
     C                     MOVELFILE3     SFILE                                               CSD015
     C                     Z-ADDFNUM3     ZSNUM                                               CSD015
     C                     EXSR ZSFL                                                          CSD015
     C                     MOVE '1'       *IN41                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     WRITEHEADP3                                                        CSD015
     C                     WRITEDETP3                                                         CSD015
     C                     ADD  1         HNOEX                                               CSD015
      *                                                                                       CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     ENDIF                                                              CSD015
      *                                                                   CFT006
     C                     READ FT102X0                  57               CFT006
      *                                                                   CFT006
     C                     ENDDO                                          CFT006
      *                                                                   CFT006
      ** Write footer                                                     CFT006
      *                                                                   CFT006
     C           *IN52     IFEQ *OFF                                      CFT006
     C                     Z-ADDSTOTL     ZFLD15                          CFT006
     C                     Z-ADD@BCDP     ZDECS                           CFT006
     C                     EXSR ZFRPED                                    CFT006
     C                     MOVE ZOUT22    SHTOTL                          CFT006
     C                     WRITEFOOTP1                                    CFT006
     C                     ELSE                                           CFT006
     C                     WRITEENDP2                                     CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ENDSR                                          CFT006
     C/EJECT                                                              CFT006
     C*****************************************************************   CFT006
     C*   CCTAUT   : CCT processing - autogen report                  *   CFT006
     C*   Called by: CCTDTL                                           *   CFT006
     C*****************************************************************   CFT006
     C           CCTAUT    BEGSR                                          CFT006
      *                                                                   CFT006
     C           *IN39     IFEQ *OFF                                      CFT006
     C                     OPEN FT0803P1                                  CFT006
     C                     MOVELFILE1     SFILE                           CFT006
     C                     Z-ADDFNUM1     ZSNUM                           CFT006
     C                     EXSR ZSFL                                      CFT006
     C                     MOVE *ON       *IN39                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      ** Transfer type                                                    CFT006
      *                                                                   CFT006
     C                     MOVE CCTTYP    TTYPE                           CFT006
      *                                                                   CFT006
     C           CCTTYP    IFEQ 'BI'                                      CFT006
     C                     MOVE *ON       *IN71                           CFT006
     C                     ELSE                                           CFT006
     C                     MOVE *OFF      *IN71                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      ** Write header                                                     CFT006
      *                                                                   CFT006
     C                     WRITEHEADP1                                    CFT006
     C                     WRITECOLHD2                                    CFT006
     C                     WRITEHEADRC                                    CFT006
      *                                                                   CFT006
      ** Clear printer fields                                             CFT006
      *                                                                   CFT006
     C                     MOVE *BLANKS   PREFE                           CFT006
     C                     MOVE *BLANKS   PSEND                           CFT006
     C                     MOVE *BLANKS   PDDAT                           CFT006
     C                     MOVE *BLANKS   PCCY                            CFT006
     C                     MOVE *BLANKS   PCAMT                           CFT006
     C                     MOVE *BLANKS   PBENEF                          CFT006
      *                                                                   CFT006
      ** CCT ID                                                           CFT006
      *                                                                   CFT006
     C                     MOVE CCTID     PREFE                           CFT006
      *                                                                   CFT006
      ** Sender/destination                                               CFT006
      *                                                                   CFT006
     C           CCTTYP    IFEQ 'BI'                                      CFT006
     C                     MOVELDSINST    PSEND                           CFT006
     C                     ELSE                                           CFT006
     C                     MOVELCCTDST    PSEND                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      ** Debit value date (BO only)                                       CFT006
      *                                                                   CFT006
     C           CCTTYP    IFEQ 'BO'                                      CFT006
     C                     Z-ADDDBTVDT    ZDAYNO                          CFT006
     C                     EXSR ZDATE2                                    CFT006
     C                     MOVE ZADATE    PDDAT                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      *                                                                   CFT006
     C           KEYCCT    CHAINFT102HL5             44                   CFT006
      *                                                                   CFT006
     C           CCTID     CHAINFT102DL1             73                   CFT006
      *                                                                   CFT006
     C           *IN73     DOWEQ*OFF                                      CFT006
      *                                                                   CFT006
      ** Pay/Transfer currency                                            CFT006
      *                                                                   CFT006
     C           CCTTYP    IFEQ 'BI'                                      CFT006
     C                     MOVE PAYCCY    PCCY                            CFT006
     C                     ELSE                                           CFT006
     C                     MOVE CCTCCY    PCCY                            CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      ** Format pay/transfer amount                                       CFT006
      *                                                                   CFT006
     C           PCCY      IFNE *BLANKS                                   CFT006
     C                     CALL 'AOCURRR0'                                CFT006
     C                     PARM *BLANKS   @RTCD                           CFT006
     C                     PARM '*KEY   ' @OPTN                           CFT006
     C                     PARM PCCY      @CCY                            CFT006
     C           SDCURR    PARM SDCURR    DSSDY                           CFT006
      *                                                                   CFT006
     C           @RTCD     IFNE *BLANKS                                   CFT006
     C                     Z-ADD91        DBASE            ***************CFT006
     C                     MOVEL'SDCURRPD'DBFILE           * DBERR 091   *CFT006
     C                     MOVELPCCY      DBKEY            ***************CFT006
     C                     OUT  LDA                                       CFT006
     C                     EXSR *PSSR                                     CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     Z-ADDA6NBDP    PDEC    10                      CFT006
      *                                                                   CFT006
     C           CCTTYP    IFEQ 'BI'                                      CFT006
     C                     MOVE PAYAMT    ZFIELD                          CFT006
     C                     ADD  PAYAMT    STOTL                           CFT006
     C                     ELSE                                           CFT006
     C                     MOVE CCTAMT    ZFIELD                          CFT006
     C                     ADD  CCTAMT    STOTL                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     Z-ADDPDEC      ZADEC                           CFT006
     C                     EXSR ZEDIT                                     CFT006
     C                     MOVE ZFIELD    PCAMT                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      ** Beneficiary                                                      CFT006
      *                                                                   CFT006
     C                     MOVELBENF1     PBENEF                          CFT006
      *                                                                   CFT006
      ** Write details                                                    CFT006
      *                                                                   CFT006
     C                     WRITEDTP1RC                                    CFT006
     C                     ADD  1         SNMBR                           CFT006
      *                                                                   CFT006
     C           @RAIN     IFNE 'R'                                       CFT006
     C           AUIN      IFEQ 'Y'                                       CFT006
     C                     ADD  1         HNOTR                           CFT006
     C                     ELSE                                           CFT006
     C                     ADD  1         HNOEX                           CFT006
     C                     ENDIF                                          CFT006
     C                     ELSE                                           CFT006
     C                     ADD  1         HNOTR                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C           *IN10     IFEQ *ON                                       CFT006
     C                     WRITEHEADP1                                    CFT006
     C                     WRITECOLHD2                                    CFT006
     C                     WRITEHEADRC                                    CFT006
     C                     MOVE *OFF      *IN10                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C           CCTID     READEFT102DL1                 73               CFT006
     C                     ENDDO                                          CFT006
      *                                                                   CFT006
     C                     ENDSR                                          CFT006
     C/EJECT                                                              CFT006
     C*****************************************************************   CFT006
     C*   CCTNAU   : CCT processing - non-autogen report              *   CFT006
     C*   Called by: CCTDTL                                           *   CFT006
     C*****************************************************************   CFT006
     C           CCTNAU    BEGSR                                          CFT006
      *                                                                   CFT006
     C           *IN40     IFEQ *OFF                                      CFT006
     C                     OPEN FT0803P2                                  CFT006
     C                     MOVELFILE2     SFILE                           CFT006
     C                     Z-ADDFNUM2     ZSNUM                           CFT006
     C                     EXSR ZSFL                                      CFT006
     C                     MOVE *ON       *IN40                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      ** Clear printer fields                                             CFT006
      *                                                                   CFT006
     C                     MOVE *BLANKS   PUSER                           CFT006
     C                     MOVE *BLANKS   TTYPE                           CFT006
     C                     MOVE *BLANKS   STYPE                           CFT006
     C                     MOVE *BLANKS   PRFT                            CFT006
     C                     MOVE *BLANKS   PTRAN                           CFT006
     C                     MOVE *BLANKS   PDDAT                           CFT006
     C                     MOVE *BLANKS   POVR                            CFT006
     C                     MOVE *BLANKS   PSWF                            CFT006
     C                     MOVE *BLANKS   PTAMT                           CFT006
     C                     Z-ADD*ZERO     PXRAT                           CFT006
     C                     MOVE *BLANKS   PPAMT                           CFT006
     C                     MOVE *BLANKS   PTCCY                           CFT006
     C                     MOVE *BLANKS   TPCCY                           CFT006
     C                     MOVE *BLANKS   PCHG                            CFT006
     C                     MOVE *BLANKS   PRVCHC                          CFT006
     C                     MOVE *BLANKS   PRVCHA                          CFT006
     C                     MOVE *BLANKS   PSDCHC                          CFT006
     C                     MOVE *BLANKS   PSDCHA                          CFT006
     C                     MOVE *BLANKS   PSDCH2                                              CSW201
     C                     MOVE *BLANKS   PSDCA2                                              CSW201
     C                     MOVE *BLANKS   PSDCH3                                              CSW201
     C                     MOVE *BLANKS   PSDCA3                                              CSW201
     C                     MOVE *BLANKS   PSDCH4                                              CSW201
     C                     MOVE *BLANKS   PSDCA4                                              CSW201
     C                     MOVE *BLANKS   PSDCH5                                              CSW201
     C                     MOVE *BLANKS   PSDCA5                                              CSW201
     C                     MOVE *BLANKS   PT20                            CFT006
     C                     MOVE *BLANKS   PT501                           CFT006
     C                     MOVE *BLANKS   PT502                           CFT006
     C                     MOVE *BLANKS   PT503                           CFT006
     C                     MOVE *BLANKS   PT504                           CFT006
     C                     MOVE *BLANKS   PT505                           CFT006
     C                     MOVE *BLANKS   PT51AC                          CFT006
     C                     MOVE *BLANKS   PT52                            CFT006
     C                     MOVE *BLANKS   PT53                            CFT006
     C                     MOVE *BLANKS   PT54                            CFT006
     C                     MOVE *BLANKS   PT57                            CFT006
     C                     MOVE *BLANKS   PT591                           CFT006
     C                     MOVE *BLANKS   PT592                           CFT006
     C                     MOVE *BLANKS   PT593                           CFT006
     C                     MOVE *BLANKS   PT594                           CFT006
     C                     MOVE *BLANKS   PT595                           CFT006
     C                     MOVE *BLANKS   PT701                           CFT006
     C                     MOVE *BLANKS   PT702                           CFT006
     C                     MOVE *BLANKS   PT703                           CFT006
     C                     MOVE *BLANKS   PT704                           CFT006
      *                                                                   CFT006
      ** Transfer type                                                    CFT006
      *                                                                   CFT006
     C                     MOVELCCTTYP    TTYPE                           CFT006
      *                                                                   CFT006
      ** Transfer sub-type                                                CFT006
      *                                                                   CFT006
     C                     MOVELCCTTST    STYPE                           CFT006
      *                                                                   CFT006
      ** CCT ID                                                           CFT006
      *                                                                   CFT006
     C                     MOVELCCTID     PRFT                            CFT006
      *                                                                   CFT006
      ** Swift priority                                                   CFT006
      *                                                                   CFT006
     C                     MOVELSWPRIO    PSWF                            CFT006
      *                                                                   CFT006
      ** Debit value date (BO only)                                       CFT006
      *                                                                   CFT006
     C           CCTTYP    IFEQ 'BO'                                      CFT006
     C                     Z-ADDDBTVDT    ZDAYNO                          CFT006
     C                     EXSR ZDATE2                                    CFT006
     C                     MOVE ZADATE    PDDAT                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      ** Exchange rate                                                    CFT006
      *                                                                   CFT006
     C                     Z-ADDCCTRTE    PXRAT                           CFT006
      *                                                                   CFT006
      ** File reference                                                   CFT006
      *                                                                   CFT006
     C                     MOVELFILREF    PT20                            CFT006
      *                                                                   CFT006
      ** Ordering customer                                                CFT006
      *                                                                   CFT006
     C                     MOVELTOCUS1    PT501                           CFT006
     C                     MOVELTOCUS2    PT502                           CFT006
     C                     MOVELTOCUS3    PT503                           CFT006
     C                     MOVELTOCUS4    PT504                           CFT006
     C                     MOVELTOCUS5    PT505                           CFT006
      *                                                                   CFT006
      ** Sending institution                                              CFT006
      *                                                                   CFT006
     C                     MOVELDSINST    PT51AC                          CFT006
      *                                                                   CFT006
      ** Ordering institution                                             CFT006
      *                                                                   CFT006
     C                     MOVELOINST3    PT52                            CFT006
      *                                                                   CFT006
      ** Senders correspondent                                            CFT006
      *                                                                   CFT006
     C                     MOVELSNDCOR    PT53                            CFT006
      *                                                                   CFT006
      ** Receivers correspondent                                          CFT006
      *                                                                   CFT006
     C                     MOVELRCVCOR    PT54                            CFT006
      *                                                                   CFT006
     C           KEYCCT    CHAINFT102HL5             44                   CFT006
      *                                                                   CFT006
     C           CCTID     CHAINFT102DL1             73                   CFT006
      *                                                                   CFT006
     C           *IN73     DOWEQ*OFF                                      CFT006
      *                                                                   CFT006
      ** Input user                                                       CFT006
      *                                                                   CFT006
     C                     MOVELINUSER    PUSER                           CFT006
      *                                                                   CFT006
      ** Transaction reference                                            CFT006
      *                                                                   CFT006
     C                     MOVELTRNSID    PTRAN                           CFT006
      *                                                                   CFT006
      ** Exchange rate override                                           CFT006
      *                                                                   CFT006
     C                     MOVELXRATEO    POVR                            CFT006
      *                                                                   CFT006
      ** Transfer currency                                                CFT006
      *                                                                   CFT006
     C                     MOVELCCTCCY    PTCCY                           CFT006
      *                                                                   CFT006
      ** Format transfer amount                                           CFT006
      *                                                                   CFT006
     C           PTCCY     IFNE *BLANKS                                   CFT006
     C                     CALL 'AOCURRR0'                                CFT006
     C                     PARM *BLANKS   @RTCD                           CFT006
     C                     PARM '*KEY   ' @OPTN                           CFT006
     C                     PARM PTCCY     @CCY                            CFT006
     C           SDCURR    PARM SDCURR    DSSDY                           CFT006
      *                                                                   CFT006
     C           @RTCD     IFNE *BLANKS                                   CFT006
     C                     Z-ADD92        DBASE            ***************CFT006
     C                     MOVEL'SDCURRPD'DBFILE           * DBERR 092   *CFT006
     C                     MOVELPTCCY     DBKEY            ***************CFT006
     C                     OUT  LDA                                       CFT006
     C                     EXSR *PSSR                                     CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     Z-ADDA6NBDP    PDEC    10                      CFT006
     C                     MOVE CCTAMT    ZFIELD                          CFT006
     C                     Z-ADDPDEC      ZADEC                           CFT006
     C                     EXSR ZEDIT                                     CFT006
     C                     MOVE ZFIELD    PTAMT                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      ** Pay currency                                                     CFT006
      *                                                                   CFT006
     C                     MOVELPAYCCY    TPCCY                           CFT006
      *                                                                   CFT006
      ** Format pay amount                                                CFT006
      *                                                                   CFT006
     C           TPCCY     IFNE *BLANKS                                   CFT006
     C                     CALL 'AOCURRR0'                                CFT006
     C                     PARM *BLANKS   @RTCD                           CFT006
     C                     PARM '*KEY   ' @OPTN                           CFT006
     C                     PARM TPCCY     @CCY                            CFT006
     C           SDCURR    PARM SDCURR    DSSDY                           CFT006
      *                                                                   CFT006
     C           @RTCD     IFNE *BLANKS                                   CFT006
     C                     Z-ADD93        DBASE            ***************CFT006
     C                     MOVEL'SDCURRPD'DBFILE           * DBERR 093   *CFT006
     C                     MOVELTPCCY     DBKEY            ***************CFT006
     C                     OUT  LDA                                       CFT006
     C                     EXSR *PSSR                                     CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     Z-ADDA6NBDP    PDEC    10                      CFT006
     C                     MOVE PAYAMT    ZFIELD                          CFT006
     C                     Z-ADDPDEC      ZADEC                           CFT006
     C                     EXSR ZEDIT                                     CFT006
     C                     MOVE ZFIELD    PPAMT                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      ** Charge detail                                                    CFT006
      *                                                                   CFT006
     C                     MOVELCCYCHG    PCHG                            CFT006
      *                                                                   CFT006
      ** Receivers charge currency                                        CFT006
      *                                                                   CFT006
     C                     MOVELRCVCCY    PRVCHC                          CFT006
      *                                                                   CFT006
      ** Format receivers charge amount                                   CFT006
      *                                                                   CFT006
     C           PRVCHC    IFNE *BLANKS                                   CFT006
     C                     CALL 'AOCURRR0'                                CFT006
     C                     PARM *BLANKS   @RTCD                           CFT006
     C                     PARM '*KEY   ' @OPTN                           CFT006
     C                     PARM PRVCHC    @CCY                            CFT006
     C           SDCURR    PARM SDCURR    DSSDY                           CFT006
      *                                                                   CFT006
     C           @RTCD     IFNE *BLANKS                                   CFT006
     C                     Z-ADD94        DBASE            ***************CFT006
     C                     MOVEL'SDCURRPD'DBFILE           * DBERR 094   *CFT006
     C                     MOVELPRVCHC    DBKEY            ***************CFT006
     C                     OUT  LDA                                       CFT006
     C                     EXSR *PSSR                                     CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     Z-ADDA6NBDP    PDEC    10                      CFT006
     C                     MOVE RCVCHG    ZFIELD                          CFT006
     C                     Z-ADDPDEC      ZADEC                           CFT006
     C                     EXSR ZEDIT                                     CFT006
     C                     MOVE ZFIELD    PRVCHA                          CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      ** Senders charge currency                                          CFT006
      *                                                                   CFT006
     C                     MOVELSNDCCY    PSDCHC                          CFT006
      *                                                                   CFT006
      ** Format senders charge amount                                     CFT006
      *                                                                   CFT006
     C           PSDCHC    IFNE *BLANKS                                   CFT006
     C                     CALL 'AOCURRR0'                                CFT006
     C                     PARM *BLANKS   @RTCD                           CFT006
     C                     PARM '*KEY   ' @OPTN                           CFT006
     C                     PARM PSDCHC    @CCY                            CFT006
     C           SDCURR    PARM SDCURR    DSSDY                           CFT006
      *                                                                   CFT006
     C           @RTCD     IFNE *BLANKS                                   CFT006
     C                     Z-ADD95        DBASE            ***************CFT006
     C                     MOVEL'SDCURRPD'DBFILE           * DBERR 095   *CFT006
     C                     MOVELPSDCHC    DBKEY            ***************CFT006
     C                     OUT  LDA                                       CFT006
     C                     EXSR *PSSR                                     CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     Z-ADDA6NBDP    PDEC    10                      CFT006
     C                     MOVE SNDCHG    ZFIELD                          CFT006
     C                     Z-ADDPDEC      ZADEC                           CFT006
     C                     EXSR ZEDIT                                     CFT006
     C                     MOVE ZFIELD    PSDCHA                          CFT006
     C                     ENDIF                                          CFT006
      *                                                                                       CSW201
      ** If CSW201 is installed                                                               CSW201
      *                                                                                       CSW201
     C           CSW201    IFEQ 'Y'                                                           CSW201
      *                                                                                       CSW201
      ** Senders Charges Currency 2                                                           CSW201
      *                                                                                       CSW201
     C                     MOVELSDCCY2    PSDCH2                                              CSW201
      *                                                                                       CSW201
      ** Format Senders Charge Amount                                                         CSW201
      *                                                                                       CSW201
     C           PSDCH2    IFNE *BLANKS                                                       CSW201
     C                     MOVE *ON       *IN20                                               CSW201
     C                     CALL 'AOCURRR0'                                                    CSW201
     C                     PARM *BLANKS   @RTCD                                               CSW201
     C                     PARM '*KEY   ' @OPTN                                               CSW201
     C                     PARM PSDCH2    @CCY                                                CSW201
     C           SDCURR    PARM SDCURR    DSSDY                                               CSW201
      *                                                                                       CSW201
     C           @RTCD     IFNE *BLANKS                                                       CSW201
     C           *LOCK     IN   LDA                                                           CSW201
     C                     Z-ADD30        DBASE            ************                       CSW201
     C                     MOVEL'SDCURRPD'DBFILE           * DBERR 30 *                       CSW201
     C                     MOVELPSDCH2    DBKEY            ************                       CSW201
     C                     OUT  LDA                                                           CSW201
     C                     EXSR *PSSR                                                         CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C                     Z-ADDA6NBDP    PDEC    10                                          CSW201
     C                     MOVE SDCHG2    ZFIELD                                              CSW201
     C                     Z-ADDPDEC      ZADEC                                               CSW201
     C                     EXSR ZEDIT                                                         CSW201
     C                     MOVE ZFIELD    PSDCA2                                              CSW201
     C                     ELSE                                                               CSW201
     C                     MOVE *OFF      *IN20                                               CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
      ** Senders Charges Currency 3                                                           CSW201
      *                                                                                       CSW201
     C                     MOVELSDCCY3    PSDCH3                                              CSW201
      *                                                                                       CSW201
      ** Format Senders Charge Amount                                                         CSW201
      *                                                                                       CSW201
     C           PSDCH3    IFNE *BLANKS                                                       CSW201
     C                     MOVE *ON       *IN21                                               CSW201
     C                     CALL 'AOCURRR0'                                                    CSW201
     C                     PARM *BLANKS   @RTCD                                               CSW201
     C                     PARM '*KEY   ' @OPTN                                               CSW201
     C                     PARM PSDCH3    @CCY                                                CSW201
     C           SDCURR    PARM SDCURR    DSSDY                                               CSW201
      *                                                                                       CSW201
     C           @RTCD     IFNE *BLANKS                                                       CSW201
     C           *LOCK     IN   LDA                                                           CSW201
     C                     Z-ADD31        DBASE            ************                       CSW201
     C                     MOVEL'SDCURRPD'DBFILE           * DBERR 31 *                       CSW201
     C                     MOVELPSDCH3    DBKEY            ************                       CSW201
     C                     OUT  LDA                                                           CSW201
     C                     EXSR *PSSR                                                         CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C                     Z-ADDA6NBDP    PDEC    10                                          CSW201
     C                     MOVE SDCHG3    ZFIELD                                              CSW201
     C                     Z-ADDPDEC      ZADEC                                               CSW201
     C                     EXSR ZEDIT                                                         CSW201
     C                     MOVE ZFIELD    PSDCA3                                              CSW201
     C                     ELSE                                                               CSW201
     C                     MOVE *OFF      *IN21                                               CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
      ** Senders Charges Currency 4                                                           CSW201
      *                                                                                       CSW201
     C                     MOVELSDCCY4    PSDCH4                                              CSW201
      *                                                                                       CSW201
      ** Format Senders Charge Amount                                                         CSW201
      *                                                                                       CSW201
     C           PSDCH4    IFNE *BLANKS                                                       CSW201
     C                     MOVE *ON       *IN22                                               CSW201
     C                     CALL 'AOCURRR0'                                                    CSW201
     C                     PARM *BLANKS   @RTCD                                               CSW201
     C                     PARM '*KEY   ' @OPTN                                               CSW201
     C                     PARM PSDCH4    @CCY                                                CSW201
     C           SDCURR    PARM SDCURR    DSSDY                                               CSW201
      *                                                                                       CSW201
     C           @RTCD     IFNE *BLANKS                                                       CSW201
     C           *LOCK     IN   LDA                                                           CSW201
     C                     Z-ADD32        DBASE            ************                       CSW201
     C                     MOVEL'SDCURRPD'DBFILE           * DBERR 32 *                       CSW201
     C                     MOVELPSDCH4    DBKEY            ************                       CSW201
     C                     OUT  LDA                                                           CSW201
     C                     EXSR *PSSR                                                         CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C                     Z-ADDA6NBDP    PDEC    10                                          CSW201
     C                     MOVE SDCHG4    ZFIELD                                              CSW201
     C                     Z-ADDPDEC      ZADEC                                               CSW201
     C                     EXSR ZEDIT                                                         CSW201
     C                     MOVE ZFIELD    PSDCA4                                              CSW201
     C                     ELSE                                                               CSW201
     C                     MOVE *OFF      *IN22                                               CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
      ** Senders Charges Currency 5                                                           CSW201
      *                                                                                       CSW201
     C                     MOVELSDCCY5    PSDCH5                                              CSW201
      *                                                                                       CSW201
      ** Format Sender's Charge Amount                                                        CSW201
      *                                                                                       CSW201
     C           PSDCH5    IFNE *BLANKS                                                       CSW201
     C                     MOVE *ON       *IN23                                               CSW201
     C                     CALL 'AOCURRR0'                                                    CSW201
     C                     PARM *BLANKS   @RTCD                                               CSW201
     C                     PARM '*KEY   ' @OPTN                                               CSW201
     C                     PARM PSDCH5    @CCY                                                CSW201
     C           SDCURR    PARM SDCURR    DSSDY                                               CSW201
      *                                                                                       CSW201
     C           @RTCD     IFNE *BLANKS                                                       CSW201
     C           *LOCK     IN   LDA                                                           CSW201
     C                     Z-ADD33        DBASE            ************                       CSW201
     C                     MOVEL'SDCURRPD'DBFILE           * DBERR 33 *                       CSW201
     C                     MOVELPSDCH5    DBKEY            ************                       CSW201
     C                     OUT  LDA                                                           CSW201
     C                     EXSR *PSSR                                                         CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C                     Z-ADDA6NBDP    PDEC    10                                          CSW201
     C                     MOVE SDCHG5    ZFIELD                                              CSW201
     C                     Z-ADDPDEC      ZADEC                                               CSW201
     C                     EXSR ZEDIT                                                         CSW201
     C                     MOVE ZFIELD    PSDCA5                                              CSW201
     C                     ELSE                                                               CSW201
     C                     MOVE *OFF      *IN23                                               CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CSW201
     C                     ENDIF                                                              CSW201
      *                                                                   CFT006
      ** Ordering customer                                                CFT006
      *                                                                   CFT006
     C           PT501     IFEQ *BLANKS                                   CFT006
     C                     MOVELORDCU1    PT501                           CFT006
     C                     MOVELORDCU2    PT502                           CFT006
     C                     MOVELORDCU3    PT503                           CFT006
     C                     MOVELORDCU4    PT504                           CFT006
     C           CSW207    IFEQ 'Y'                                                           CSW207
     C                     MOVELORDCU5    PT505                                               CSW207
     C                     ENDIF                                                              CSW207
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      ** Ordering institution                                             CFT006
      *                                                                   CFT006
     C           PT52      IFEQ *BLANKS                                   CFT006
     C                     MOVELORDI35    PT52                            CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      ** Account with institution                                         CFT006
      *                                                                   CFT006
     C                     MOVELACCI35    PT57                            CFT006
      *                                                                   CFT006
      ** Beneficiary                                                      CFT006
      *                                                                   CFT006
     C                     MOVELBENF1     PT591                           CFT006
     C                     MOVELBENF2     PT592                           CFT006
     C                     MOVELBENF3     PT593                           CFT006
     C                     MOVELBENF4     PT594                           CFT006
     C                     MOVELBENF5     PT595                           CFT006
      *                                                                   CFT006
      ** Remittance information                                           CFT006
      *                                                                   CFT006
     C                     MOVELREMI1     PT701                           CFT006
     C                     MOVELREMI2     PT702                           CFT006
     C                     MOVELREMI3     PT703                           CFT006
     C                     MOVELREMI4     PT704                           CFT006
      *                                                                   CFT006
      ** Write header                                                     CFT006
      *                                                                   CFT006
     C                     WRITEHEADP2                                    CFT006
      *                                                                   CFT006
      ** Write details                                                    CFT006
      *                                                                   CFT006
     C                     WRITEDETP2C                                    CFT006
      *                                                                   CFT006
     C           @RAIN     IFNE 'R'                                       CFT006
     C           AUIN      IFEQ 'Y'                                       CFT006
     C                     ADD  1         HNOTR                           CFT006
     C                     ELSE                                           CFT006
     C                     ADD  1         HNOEX                           CFT006
     C                     ENDIF                                          CFT006
     C                     ELSE                                           CFT006
     C                     ADD  1         HNOTR                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C           CCTID     READEFT102DL1                 73               CFT006
     C                     ENDDO                                          CFT006
      *                                                                   CFT006
     C                     ENDSR                                          CFT006
     C/EJECT
     C*****************************************************************
     C*   ODTL     : Get other details for reporting                  *
     C*   Called by: SYSL,ALLB,SINB                                   *
     C*   Calls    : None                                             *
     C*****************************************************************
     C           ODTL      BEGSR
     C*
     C** Other Details
     C*
     C           *IN29     IFEQ '0'
     C           PREF      CHAINOTPAY                65
     C                     ELSE
     C           PREF      CHAININPAY                66
     C                     MOVELINSETM    STMT
     C                     END
     C*
     C                     ENDSR
     C*
     C/EJECT
     C*****************************************************************
     C*   DMPYT    : De-marked Payment                                *
     C*   Called by: SYSL,ALLB,SINB                                   *
     C*   Calls    : None                                             *
     C*****************************************************************
     C           DMPYT     BEGSR
      *
      ** Get payment extension file details.
      *
     C           *IN29     IFEQ '0'
      *
     C           PREF      CHAINOTPAYXL0             63
      *
     C           *IN63     IFEQ '1'
     C                     Z-ADD70        DBASE            ***************
     C                     MOVEL'OTPAYXL0'DBFILE           * DBERR 070   *
     C                     MOVELPREF      DBKEY            ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
      *
      ** Blank out Authorising User, Workstation Id, and Batch No.
      ** fields in the extension file for the payment being processed.
      *
     C                     MOVE *BLANKS   OPRUSR
     C                     MOVE *BLANKS   OPWSID
     C                     MOVE *BLANKS   OPBANO
      *
     C                     UPDATOTPAYXDF
     C                     END
      *
     C           *IN29     IFEQ '1'
      *
     C           PREF      CHAININPAYXL0             64
      *
     C           *IN64     IFEQ '1'
     C                     Z-ADD71        DBASE            ***************
     C                     MOVEL'INPAYXL0'DBFILE           * DBERR 071   *
     C                     MOVELPREF      DBKEY            ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
      *
      ** Blank out Authorising User, Workstation Id, and Batch No.
      ** fields in the extension file for the payment being processed.
      *
     C                     MOVE *BLANKS   INRUSR
     C                     MOVE *BLANKS   INWSID
     C                     MOVE *BLANKS   INBANO
      *
     C                     UPDATINPAYXDF
     C                     END
     C*
     C                     ENDSR
     C*
     C/EJECT
     C*****************************************************************
     C*   EXCP     : Exception processing                             *
     C*   Called by: SYSL,SINB,ALLB                                   *
     C*   Calls    : FT0805 - Program to check for insufficient funds *
     C*****************************************************************
     C           EXCP      BEGSR
     C*
     C** Set off conditional payment indicators
     C*
     C                     MOVE '0'       *IN31
     C                     MOVE '0'       *IN32
     C                     MOVE '0'       *IN33
     C*
     C** Check if payment has sufficient fund
     C*
     C           *IN29     IFEQ '0'
     C*
     C** If Outgoing payment, if ord cust is addr move ord bank to acnt
     C*
     C***********ORCT      IFNE 'A'                                       166281
     C***********ORCT      ANDNE'C'                                       166281
     C***********          MOVELORC1      @ACNT  15                       166281
     C***********          ELSE                                           166281
     C***********ORBK      IFNE *ZEROS                                                 166281 CSD027
     C           ORBK      IFNE *BLANKS                                                       CSD027
     C*
     C           ORBT      IFEQ 'N'
     C                     MOVELORBK      W0FLD2  2
     C                     MOVELW0FLD2    @ACNT
     C                     END
     C           ORBT      IFEQ 'R'
     C                     MOVELORBK      W0FL10
     C                     MOVELW0FL10    @ACNT
     C                     END
     C           ORBT      IFEQ 'P'
     C                     MOVELORBK      @ACNT
     C           MBIN      IFEQ 'Y'
     C                     MOVE ORBB      @BRCA
     C                     ELSE
     C                     MOVE BJSBRC    @BRCA
     C                     END
     C                     END
     C/COPY WNCPYSRC,FT0803C014
     C*
     C                     ELSE                                           166281
     C           ORCT      IFNE 'A'                                       166281
     C           ORCT      ANDNE'C'                                       166281
     C**********           MOVELORC1      @ACNT  15                                    166281 CGL029
     C                     MOVELORC1      @ACNT  21                                           CGL029
     C                     MOVELORC1      @SLASH                                              CFT032
     C           ORCT      IFEQ 'I'                                                           CFT032
     C           @SLASH    IFEQ '/'                                                           CFT032
     C                     MOVE ORC1      @ORC1                                               CFT032
     C                     ELSE                                                               CFT032
     C                     MOVELORC1      @ORC1                                               CFT032
     C                     ENDIF                                                              CFT032
      *                                                                                       CFT032
      ** Call AOIBANR4 using P@IBN and store retrieved account details                        CFT032
      ** in DS/WACCN.                                                                         CFT032
      *                                                                                       CFT032
     C                     MOVE @ORC1     P@IBN                                               CFT032
     C                     MOVE *BLANKS   DSSDY                                               CFT032
     C                     CALL 'AOIBANR4'                                                    CFT032
     C                     PARM           @RTCD                                               CFT032
     C                     PARM '*KEY   ' @OPTN                                               CFT032
     C                     PARM           P@IBN                                               CFT032
     C           WACCN     PARM           DSSDY                                               CFT032
      *                                                                                       CFT032
     C           @RTCD     IFNE *BLANKS                                                       CFT032
     C           *LOCK     IN   LDA                                                           CFT032
     C                     Z-ADD104       DBASE                                               CFT032
     C                     MOVELP@IBN     DBKEY                                               CFT032
     C                     MOVEL'ACCNTL6' DBFILE                                              CFT032
     C                     OUT  LDA                                                           CFT032
     C                     EXSR *PSSR                                                         CFT032
     C                     ELSE                                                               CFT032
     C                     MOVE WWCNUM    FCNUM                                               CFT032
     C                     MOVE WWCCY     FCCY                                                CFT032
     C                     MOVE WWACOD    FACOD                                               CFT032
     C                     MOVE WWACSQ    FACSQ                                               CFT032
     C                     MOVELWACNT     @ACNT                                               CFT032
     C                     MOVELWWBRCA    @BRCA                                               CFT032
     C                     ENDIF                                                              CFT032
      *                                                                                       CFT032
     C                     ELSE                                                               CFT032
      *                                                                                       CFT032
     C           @SLASH    IFEQ '/'                                                           CFT032
     C           15        SUBSTORC1:2    @ACNT                                               CFT032
     C                     ELSE                                                               CFT032
     C                     MOVELORC1      @ACNT  21                                           CGL029
     C                     ENDIF                                                              CFT032
      *                                                                                       CFT032
     C                     ENDIF                                                              CFT032
      *                                                                                       CFT032
     C                     ENDIF                                          166281
     C                     END
      *                                                                                       CSD015
      ** When CSD015 enhancement is installed  and WELCO is equal to 'Y'                      CSD015
      *                                                                                       CSD015
     C           CSD015    IFEQ 'Y'                                                           CSD015
     C           CSC011    ANDEQ'N'                                                           CSD015
     C           CSC011    OREQ 'Y'                                                           CSD015
     C           LIBR      ANDEQS1MAIN                                                        CSD015
      *                                                                                       CSD015
     C           WELCO     IFEQ 'Y'                                                           CSD015
     C                     MOVEL'OTPAYDD' KFUNT                                               CSD015
     C                     MOVELPREF      KIDEN                                               CSD015
     C                     MOVELBRCA      KBRCH                                               CSD015
      *                                                                                       CSD015
     C           KCWHT     CHAINSDCWHTL1             50                                       CSD015
      *                                                                                       CSD015
      ** If record found and under investigation, activate *IN46 to display on                CSD015
      ** the report, 'Item under review by Compliance Officer'                                CSD015
      *                                                                                       CSD015
     C           *IN50     IFEQ *OFF                                                          CSD015
     C           W3TREL    ANDNE'Y'                                                           CSD015
     C                     MOVEL*ON       *IN46                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C*
     C** If Incoming payment, if snd type is addr/cust rcv corr to acnt
     C** Sender Type can be F, R, G, C, or A.
     C*
     C                     ELSE
     C*
     C***********SNTP      IFNE 'C'                                       166281
     C***********SNTP      ANDNE'A'                                       166281
     C***********          MOVELSND1      @ACNT                           166281
     C***********                                                         166281
     C***If*account*type*is*'G',*where*the*entry*is*18*long*account*******166281
     C***of*which*the*last*3*characters*is*the*branch,*extract*it*for*****166281
     C***insufficient*fund*checking.**************************************166281
     C***********                                                         166281
     C***********SNTP      IFEQ 'G'                                       166281
     C***********          MOVELSND1      @WRK18 18                       166281
     C***********          MOVE @WRK18    @BRCA                           166281
     C***********          END                                            166281
     C***********                                                         166281
     C***********          ELSE                                           166281
     C***********RCCO      IFNE *ZEROS                             166281 CFT014
     C***********                                                         CFT014
     C***********RCRT      IFEQ 'N'                                       CFT014
     C***********          MOVELRCCO      W0FLD2                          CFT014
     C***********          MOVELW0FLD2    @ACNT                           CFT014
     C***********          ELSE                                           CFT014
     C***********          MOVELRCCO      @ACNT                           CFT014
     C***********          END                                            CFT014
     C***********                                                         CFT014
      *                                                                   CFT014
      ** CFT014 is on and 3rd Reimbursement Institution is present.       CFT014
      *                                                                   CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
     C           INTRIT    ANDNE*BLANKS                                   CFT014
      *                                                                   CFT014
     C                     SELEC                                          CFT014
      *                                                                   CFT014
      ** 3rd Reimbursement Institution is IBAN.                           CFT014
      *                                                                   CFT014
     C           INTRIT    WHEQ 'I'                                       CFT014
     C           CFT004    ANDEQ'Y'                                       CFT014
     C                     MOVE INTRIB    P@IBN                           CFT014
      *                                                                   CFT014
      ** Call AOIBANR4 using PIBAN and store retrieved account details    CFT014
      ** in DS/WACCN.                                                     CFT014
      *                                                                   CFT014
     C                     MOVE *BLANKS   DSSDY                           CFT014
     C                     CALL 'AOIBANR4'                                CFT014
     C                     PARM           @RTCD                           CFT014
     C                     PARM '*KEY   ' @OPTN                           CFT014
     C                     PARM           P@IBN                           CFT014
     C           WACCN     PARM           DSSDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C           *LOCK     IN   LDA                                       CFT014
     C                     Z-ADD104       DBASE                           CFT014
     C                     MOVELP@IBN     DBKEY                           CFT014
     C                     MOVEL'ACCNTL6' DBFILE                          CFT014
     C                     OUT  LDA                                       CFT014
     C                     EXSR *PSSR                                     CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
     C                     MOVE WWCNUM    FCNUM                           CFT014
     C                     MOVE WWCCY     FCCY                            CFT014
     C                     MOVE WWACOD    FACOD                           CFT014
     C                     MOVE WWACSQ    FACSQ                           CFT014
     C                     MOVELWACNT     @ACNT                           CFT014
     C                     MOVELWWBRCA    @BRCA                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** 3rd Reimbursement Institution is a GL account.                   CFT014
      *                                                                   CFT014
     C           INTRIT    WHEQ 'G'                                       CFT014
      *                                                                   CFT014
      ** Move pos. 1-15 of INTRIB to @ACNT.                               CFT014
      *                                                                   CFT014
     C                     MOVELINTRIB    WINTRB                          CFT014
     C                     MOVELTPACNT    @ACNT                           CFT014
      *                                                                   CFT014
      ** Move pos. 16-18 of INTRIB to @BRCA.                              CFT014
      *                                                                   CFT014
     C                     MOVELTPBRCA    @BRCA                           CFT014
      *                                                                   CFT014
     C                     OTHER                                          CFT014
      *                                                                   CFT014
      ** 3rd Reimbursement Institution is a Nostro or                     CFT014
      ** a Retail account.                                                CFT014
      *                                                                   CFT014
     C                     MOVELINTRIB    @ACNT                           CFT014
      *                                                                   CFT014
     C                     ENDSL                                          CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
      ** Receiver's Correspondent is present.                             CFT014
      *                                                                   CFT014
     C           INRCRT    IFNE *BLANKS                                   CFT014
      *                                                                   CFT014
     C                     SELEC                                          CFT014
      *                                                                   CFT014
      ** Receiver's Correspondent is IBAN.                                CFT014
      *                                                                   CFT014
     C           INRCRT    WHEQ 'I'                                       CFT014
     C           CFT004    ANDEQ'Y'                                       CFT014
     C                     MOVE INRCO1    P@IBN                           CFT014
      *                                                                   CFT014
      ** Call AOIBANR4 using PIBAN and store retrieved account details    CFT014
      ** in DS/WACCN.                                                     CFT014
      *                                                                   CFT014
     C                     MOVE *BLANKS   DSSDY                           CFT014
     C                     CALL 'AOIBANR4'                                CFT014
     C                     PARM           @RTCD                           CFT014
     C                     PARM '*KEY   ' @OPTN                           CFT014
     C                     PARM           P@IBN                           CFT014
     C           WACCN     PARM           DSSDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C           *LOCK     IN   LDA                                       CFT014
     C                     Z-ADD105       DBASE                           CFT014
     C                     MOVELP@IBN     DBKEY                           CFT014
     C                     MOVEL'ACCNTL6' DBFILE                          CFT014
     C                     OUT  LDA                                       CFT014
     C                     EXSR *PSSR                                     CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
     C                     MOVE WWCNUM    FCNUM                           CFT014
     C                     MOVE WWCCY     FCCY                            CFT014
     C                     MOVE WWACOD    FACOD                           CFT014
     C                     MOVE WWACSQ    FACSQ                           CFT014
     C                     MOVELWACNT     @ACNT                           CFT014
     C                     MOVELWWBRCA    @BRCA                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Receiver's Correspondent is a GL account.                        CFT014
      *                                                                   CFT014
     C           INRCRT    WHEQ 'G'                                       CFT014
      *                                                                   CFT014
      ** Move pos. 1-15 of INRCO1 to @ACNT.                               CFT014
      *                                                                   CFT014
     C                     MOVELINRCO1    WINTRB                          CFT014
     C                     MOVELTPACNT    @ACNT                           CFT014
      *                                                                   CFT014
      ** Move pos. 16-18 of INRCO1 to @BRCA.                              CFT014
      *                                                                   CFT014
     C                     MOVELTPBRCA    @BRCA                           CFT014
      *                                                                   CFT014
     C                     OTHER                                          CFT014
      *                                                                   CFT014
      ** Receiver's Correspondent is a Nostro or a Retail account.        CFT014
      *                                                                   CFT014
     C                     MOVELINRCO1    @ACNT                           CFT014
      *                                                                   CFT014
     C                     ENDSL                                          CFT014
      *                                                                   CFT014
     C/COPY WNCPYSRC,FT0803C015
     C                     ELSE                                           166281
      *                                                                   CFT014
     C           SNTP      IFNE 'C'                                       166281
     C           SNTP      ANDNE'A'                                       166281
     C                     MOVELSND1      @ACNT                           166281
     C*                                                                   166281
     C** If account type is 'G', where the entry is 18 long account       166281
     C** of which the last 3 characters is the branch, extract it for     166281
     C** insufficient fund checking.                                      166281
     C*                                                                   166281
     C           SNTP      IFEQ 'G'                                       166281
     C**********           MOVELSND1      @WRK18 18                       166281            MD042279
     C                     MOVELSND1      @WRK18 24                                         MD042279
     C                     MOVE @WRK18    @BRCA                           166281
     C                     END                                            166281
     C                     ENDIF                                          166281
     C                     END
     C                     ENDIF                                          CFT014
     C*
     C                     END                             -*IN29
      *                                                                                       CSD015
      ** When CSD015 enhancement is installed  and WELCI is equal to 'Y'                      CSD015
      *                                                                                       CSD015
     C           CSD015    IFEQ 'Y'                                                           CSD015
     C           CSC011    ANDEQ'N'                                                           CSD015
     C           CSC011    OREQ 'Y'                                                           CSD015
     C           LIBR      ANDEQS1MAIN                                                        CSD015
      *                                                                                       CSD015
     C           WELCI     IFEQ 'Y'                                                           CSD015
     C                     MOVEL'INPAYDD' KFUNT                                               CSD015
     C                     MOVELPREF      KIDEN                                               CSD015
     C                     MOVELBRCA      KBRCH                                               CSD015
      *                                                                                       CSD015
     C           KCWHT     CHAINSDCWHTL1             50                                       CSD015
      *                                                                                       CSD015
      ** If record found and under investigation, activate *IN46 to display on                CSD015
      ** the report, 'Item under review by Compliance Officer'                                CSD015
      *                                                                                       CSD015
     C           *IN50     IFEQ *OFF                                                          CSD015
     C           W3TREL    ANDNE'Y'                                                           CSD015
     C                     MOVEL*ON       *IN46                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C/COPY WNCPYSRC,FT0803C020
     C*
     C** Call FT0805 to check for sufficient fund using the set-up parm
     C*
     C                     CALL 'FT0805'               42
     C**********           PARM           @ACNT  15                                           CGL029
     C                     PARM           @ACNT                                               CGL029
     C                     PARM SMCY      @CCY    3
     C                     PARM           @BRCA   3
     C                     PARM SMAM      @SMAM  130
     C                     PARM SLDT      @SLDT   50
     C                     PARM *BLANKS   @RCD    1
     C                     PARM *BLANKS   @ORETB  5                                           216511
     C/COPY WNCPYSRC,FT0803C025
     C*
     C                     MOVEL'FT0803'  DBPGM
     C*
     C** If error on call
     C*
     C           @RCD      IFEQ 'E'
     C           *IN42     OREQ '1'
     C                     Z-ADD4         DBASE            ***************
     C                     MOVEL'FT0805'  DBFILE           * DBERR 004   *
     C                     MOVEL*BLANKS   DBKEY            ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
     C*
     C** If insufficient fund, set-up insufficient fund indicator
     C*
     C           @RCD      IFEQ 'Y'
     C                     MOVE '1'       *IN32
     C                     ELSE
     C                     MOVE '0'       *IN32
     C                     END
     C*
     C** If Authorisation, Get Account Details
     C*
     C           *IN32     IFEQ '1'
     C           *IN30     ANDEQ'0'
     C                     MOVEL*BLANKS   @RETL  10
     C                     MOVEL@CNNM     @CNNM   6
     C                     MOVELHCCY      @CUCD   3
     C**********           MOVEL@ACOD     @ACCD   4                                           CGL029
     C                     MOVEL@ACOD     @ACCD                                               CGL029
     C                     MOVEL@ACSQ     @ACSQ   2
     C                     MOVEL@BRCA     @BRCD   3
     C*
     C                     CALL 'AOACCTR0'#AACCT
     C*
     C           @RTCD     IFNE *BLANKS
     C                     Z-ADD5         DBASE            ***************
     C                     MOVEL@DSAN     DBKEY            * DBERR 005   *
     C                     MOVEL'ACCNTAB' DBFILE           ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
     C*
     C** Format Account number
     C*
     C                     MOVEA'-'       WKA,7
     C                     MOVEA'-'       WKA,11
     C**********           MOVEA'-'       WKA,16                                              CGL029
     C**********           MOVEA'-'       WKA,19                                              CGL029
     C                     MOVEA'-'       WKA,22                                              CGL029
     C                     MOVEA'-'       WKA,25                                              CGL029
     C                     MOVEA@CNNM     WKA,1
     C                     MOVEA@CUCD     WKA,8
     C                     MOVEA@ACCD     WKA,12
     C**********           MOVEA@ACSQ     WKA,17                                              CGL029
     C**********           MOVEA@BRCA     WKA,20                                              CGL029
     C                     MOVEA@ACSQ     WKA,23                                              CGL029
     C                     MOVEA@BRCA     WKA,26                                              CGL029
     C                     MOVEAWKA       HACNT
     C*
     C** Format Expiry date
     C*
     C           ODED      IFNE *ZERO
     C                     Z-ADDODED      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    HEXDT
     C*
     C           ZDATE     IFEQ 0
     C                     Z-ADD6         DBASE            ***************
     C                     MOVEL*BLANK    DBKEY            * DBERR 006   *
     C                     MOVEL'ZDATE2'  DBFILE           ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
     C                     END
     C*
     C                     END
     C*
     C** Check if payment is back valued
     C*
     C           PVDT      IFLT RUND
     C                     MOVE '1'       *IN31
     C                     ELSE
     C                     MOVE '0'       *IN31
     C                     END
     C*
     C** Check if settlement amount exceed threshold limit
     C*
     C                     CALL 'AOCURRR0'
     C                     PARM *BLANKS   @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM SMCY      @CCY    3
     C           SDCURR    PARM SDCURR    DSSDY
     C*
     C           @RTCD     IFNE *BLANKS
     C                     Z-ADD7         DBASE            ***************
     C                     MOVEL'SDCURRPD'DBFILE           * DBERR 007   *
     C                     MOVELSMCY      DBKEY            ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
     C*
     C                     MOVE A6NBDP    @SMDP   20
     C*
     C** Convert threshold value to settlement equivalent
     C*
     C           MLDV      IFEQ 'M'
     C           AUDT      DIV  EXRT      @@AUDT 140
     C                     ELSE
     C           AUDT      MULT EXRT      @@AUDT
     C                     END
     C           SMAM      IFGT @@AUDT
     C                     MOVE '1'       *IN33
     C                     ELSE
     C                     MOVE '0'       *IN33
     C                     END
     C*
     C                     ENDSR
     C*
     C/EJECT
     C*****************************************************************
     C*   AUGN     : AutoGen processing                               *
     C*   Called by: SYSL,ALLB,SINB                                   *
     C*   Calls    : None                                             *
     C*****************************************************************
     C           AUGN      BEGSR
     C*
     C** Initialize fields
     C*
     C                     MOVE *BLANKS   SSNDR
     C                     MOVE *BLANKS   SDEST
     C                     MOVE *BLANKS   SBENE
     C                     MOVE *BLANKS   SBKTB
     C                     MOVE *BLANKS   HSMAM
     C                     MOVE *BLANKS   HPYAM
     C*
     C** Format settle amount
     C*
     C                     Z-ADDSMAM      ZFLD15
     C                     Z-ADD@SMDP     ZDECS
     C                     EXSR ZFRPED
     C                     MOVE ZOUT22    HSMAM
     C*
     C** Format pay amount
     C*
     C                     CALL 'AOCURRR0'
     C                     PARM *BLANKS   @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM PCCY      @CCY    3
     C           SDCURR    PARM SDCURR    DSSDY
     C*
     C           @RTCD     IFNE *BLANKS
     C                     Z-ADD571       DBASE            ***************
     C                     MOVEL'SDCURRPD'DBFILE           * DBERR 571   *
     C                     MOVELPCCY      DBKEY            ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
     C*
     C                     MOVE A6NBDP    @PYDP   20
     C                     Z-ADDPYAM      ZFLD15
     C                     Z-ADD@PYDP     ZDECS
     C                     EXSR ZFRPED
     C                     MOVE ZOUT22    HPYAM
     C*
     C** Format settle Value date
     C*
     C                     Z-ADDSLDT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    SVAL
     C*
     C           ZDATE     IFEQ 0
     C                     Z-ADD520       DBASE            ***************
     C                     MOVEL*BLANK    DBKEY            * DBERR 520   *
     C                     MOVEL'ZDATE2'  DBFILE           ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
     C*
     C** Format pay Value date
     C*
     C                     Z-ADDPVDT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    PVAL
     C*
     C           ZDATE     IFEQ 0
     C                     Z-ADD521       DBASE            ***************
     C                     MOVEL*BLANK    DBKEY            * DBERR 521   *
     C                     MOVEL'ZDATE2'  DBFILE           ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
     C*
     C*
     C**          Outgoing payments processing
     C** Get Destination from Intermediary or A/C with Bank
     C*
     C           *IN29     IFEQ '0'
     C*
     C           *IN55     IFEQ '1'
     C*
     C           INBT      IFEQ 'S'
     C                     MOVELINB1      @SLASH
     C           @SLASH    IFEQ '/'
     C                     MOVELINB2      @IBSW
     C                     END
     C           @IBSW     CHAINSDCUSTL7             67
     C           *IN67     IFEQ '1'
     C                     Z-ADD8         DBASE            ***************
     C                     MOVEL'SDCUSTL7'DBFILE           * DBERR 008   *
     C                     MOVEL@IBSW     DBKEY            ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
     C                     MOVELBBCUST    W0CNUM  6
     C                     END
     C*
     C           INBT      IFEQ 'C'
     C                     MOVELINB1      @KEY1
     C                     CALL 'AOCUSTR0'#ACUST
     C           @RTCD     IFNE *BLANKS
     C           *LOCK     IN   LDA
     C                     Z-ADD9         DBASE            ***************
     C                     MOVEL@KEY1     DBKEY            *  DBERR 009  *
     C                     MOVEL'SDCUSTPD'DBFILE           ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
     C                     MOVELBBCUST    W0CNUM
     C                     END
     C*
     C           INBT      IFNE 'S'
     C           INBT      ANDNE'C'
     C*
     C           ACBT      IFEQ 'S'
     C                     MOVELACB1      @SLASH  1
     C           @SLASH    IFEQ '/'
     C                     MOVELACB2      @ACSW
     C                     END
     C           @ACSW     CHAINSDCUSTL7             67
     C           *IN67     IFEQ '1'
     C                     Z-ADD10        DBASE            ***************
     C                     MOVEL'SDCUSTL7'DBFILE           * DBERR 010   *
     C                     MOVEL@IBSW     DBKEY            ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
     C                     MOVELBBCUST    W0CNUM
     C                     END
     C*
     C           ACBT      IFEQ 'C'
     C                     MOVELACB1      @SLASH  1
     C           @SLASH    IFEQ '/'
     C                     MOVELACB2      @KEY1
     C                     ELSE
     C                     MOVELACB1      @KEY1
     C                     END
     C                     CALL 'AOCUSTR0'#ACUST
     C           @RTCD     IFNE *BLANKS
     C           *LOCK     IN   LDA
     C                     Z-ADD11        DBASE            ***************
     C                     MOVEL@KEY1     DBKEY            *  DBERR 011  *
     C                     MOVEL'SDCUSTPD'DBFILE           ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
     C                     MOVELBBCUST    W0CNUM
     C                     END
     C                     END
     C*
     C                     ELSE
     C                     MOVELDST1      SDEST
     C                     END
     C*
     C** Get Sender
     C*
     C***********ORBK      IFNE *ZERO                                                         CSD027
     C           ORBK      IFNE *BLANKS                                                       CSD027
     C*
     C           ORBT      IFEQ 'R'
     C                     MOVELORBK      W0FL10
     C                     MOVELW0FL10    SSNDR
     C                     END
     C*
     C           ORBT      IFEQ 'N'
     C                     MOVELORBK      W0FLD2
     C                     MOVELSMCY      W0FLD5
     C                     MOVE W0FLD2    W0FLD5
     C                     MOVELW0FLD5    SSNDR
     C                     END
     C*
     C           ORBT      IFEQ 'P'
     C                     MOVELORBK      SSNDR
     C                     END
     C/COPY WNCPYSRC,FT0803C016
     C*
     C                     ELSE
     C*
     C                     MOVELORC1      SSNDR
     C                     END
     C/COPY WNCPYSRC,FT0803C021
     C*
      *                                                                                       CER030
      ** Write Outgoing Extended Narrative                                                    CER030
      *                                                                                       CER030
     C           CER031    IFEQ 'Y'                                                           CER030
     C                     EXSR POPONR                                                        CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     END
     C*
     C** Incoming payments processing
     C*
     C           *IN29     IFEQ '1'
     C*
     C** Get Sender
     C*
     C           SNTP      IFNE *BLANKS
     C           SNTP      IFEQ 'F'
     C                     MOVEL@SNNC     @KEYB
     C                     MOVEL@SNNN     @KEYE
     C                     CALL 'AONOSTR0'#ANOST
     C           @RTCD     IFNE *BLANKS
     C           *LOCK     IN   LDA
     C                     Z-ADD13        DBASE            ***************
     C                     MOVEL@SNNS     DBKEY            *  DBERR 013  *
     C                     MOVEL'SDNOSTPD'DBFILE           ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
     C                     MOVELA7CUST    W0CNUM
     C                     END
     C*
     C           SNTP      IFEQ 'R'
     C                     MOVEL@SNRT     @RETL
     C                     MOVE *BLANKS   @CNNM   6
     C                     MOVE *BLANKS   @CUCD   3
     C**********           MOVE *BLANKS   @ACCD   4                                           CGL029
     C                     MOVE *BLANKS   @ACCD                                               CGL029
     C                     MOVE *BLANKS   @ACSQ   2
     C                     MOVEL*BLANKS   @BRCD   3
     C                     CALL 'AOACCTR0'#AACCT
     C           @RTCD     IFNE *BLANKS
     C           *LOCK     IN   LDA
     C                     Z-ADD14        DBASE            ***************
     C                     MOVEL@SNRT     DBKEY            *  DBERR 014  *
     C                     MOVEL'ACCNTAB' DBFILE           ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
     C                     MOVELCNUM      W0CNUM
     C                     END
     C*
     C           SNTP      IFEQ 'G'
     C                     MOVE *BLANKS   @RETL
     C                     MOVE @SNCN     @CNNM   6
     C                     MOVE @SNCY     @CUCD   3
     C**********           MOVE @SNAC     @ACCD   4                                           CGL029
     C                     MOVE @SNAC     @ACCD                                               CGL029
     C                     MOVE @SNAS     @ACSQ   2
     C                     MOVE @SNBR     @BRCD   3
     C                     CALL 'AOACCTR0'#AACCT
     C           @RTCD     IFNE *BLANKS
     C           *LOCK     IN   LDA
     C                     Z-ADD15        DBASE            ***************
     C                     MOVEL@SNAN     DBKEY            *  DBERR 015  *
     C                     MOVEL'ACCNTAB' DBFILE           ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
     C                     MOVELCNUM      W0CNUM
     C                     END
     C*
     C           SNTP      IFEQ 'C'
     C                     MOVELSND1      @KEY1
     C                     CALL 'AOCUSTR0'#ACUST
     C           @RTCD     IFNE *BLANKS
     C           *LOCK     IN   LDA
     C                     Z-ADD16        DBASE            ***************
     C                     MOVEL@KEY1     DBKEY            *  DBERR 016  *
     C                     MOVEL'SDCUSTPD'DBFILE           ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
     C                     MOVELBBCUST    W0CNUM
     C                     END
     C*
     C** If settled through BOJNET, get BOJ Bank Code & Name
     C*
     C           *IN55     IFEQ '1'
     C*
     C** Else, get SWIFT Address
     C*
     C                     ELSE
      ** Do not call AOCUSTR0 the second time if already called
     C           SNTP      IFNE 'C'
     C           W0CNUM    IFNE *BLANK                                                        CFT003
     C                     MOVEL*BLANK    @KEY1                                               CFT003
     C                     MOVELW0CNUM    @KEY1
     C                     CALL 'AOCUSTR0'#ACUST
     C           @RTCD     IFNE *BLANKS
     C           *LOCK     IN   LDA
     C                     Z-ADD81        DBASE            ***************
     C                     MOVEL@KEY1     DBKEY            *  DBERR 081  *
     C                     MOVEL'SDCUSTPD'DBFILE           ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
     C                     MOVELBBCSID    SSNDR                                               CFT003
     C                     ELSE                                                               CFT003
     C           SNTP      IFEQ 'A'                                                           CFT003
     C           SNTP      OREQ 'S'                                                           CFT003
     C                     MOVELSND1      SSNDR                                               CFT003
     C                     END                                                                CFT003
     C                     END                                                                CFT003
     C                     END
      *
     C*********************MOVELBBCSID    SSNDR                                               CFT003
     C                     END
     C*
     C                     END
     C*
     C** Get Bank to Bank Information
     C*
     C                     MOVELBBI1      SBKTB
      *                                                                                       CER030
      ** Write Incoming Extended Narrative                                                    CER030
      *                                                                                       CER030
     C           CER031    IFEQ 'Y'                                                           CER030
     C                     EXSR POPINR                                                        CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C*
     C                     END
     C*
     C** Get Beneficiary  (Common to incoming/outgoing)
     C*
     C                     MOVELBNC1      W0TAG   1
     C           W0TAG     IFEQ '/'
     C                     MOVELBNC2      W0BEN  35
     C                     ELSE
     C                     MOVELBNC1      W0BEN  35
     C                     END
     C*
     C           BNCT      IFEQ 'A'
     C                     MOVELW0BEN     SBENE
     C                     END
     C*
     C           BNCT      IFEQ 'S'
     C                     MOVELBNC1      BNC9
     C                     MOVELBNC1      @SLASH  1
     C           @SLASH    IFEQ '/'
     C                     MOVELBNC2      BNC9
     C                     END
     C           @BNSW     CHAINSDCUSTL7             67
     C*
     C           *IN67     IFEQ '1'
     C                     MOVELBNC1      SBENE
     C                     ELSE
     C                     MOVELBBCNA1    SBENE
     C                     END
      *
     C                     END
     C*
     C           BNCT      IFEQ 'C'
     C*
     C                     MOVELBNC1      @SLASH  1
     C           @SLASH    IFEQ '/'
     C                     MOVELBNC2      @KEY1
     C*********************END                                                                CFT003
     C                     ELSE                                                               CFT003
     C                     MOVELBNC1      @KEY1
     C                     END                                                                CFT003
     C                     CALL 'AOCUSTR0'#ACUST
     C*
     C** Customer record not found - Error
     C*
     C           @RTCD     IFNE *BLANKS
     C           *LOCK     IN   LDA
     C                     Z-ADD19        DBASE            ***************
     C                     MOVEL@KEY1     DBKEY            *  DBERR 019  *
     C                     MOVEL'SDCUSTPD'DBFILE           ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
     C                     MOVELBBCNA1    SBENE
     C                     END
     C*
     C           BNCT      IFEQ 'R'
     C           BNCT      OREQ 'P'
     C           BNCT      OREQ 'G'
     C                     MOVELBNC1      SBENE
     C                     END
      *                                                                   CFT004
     C           CFT004    IFEQ 'Y'                                       CFT004
     C           BNCT      IFEQ 'I'                                       CFT004
     C           34        SUBSTBNC1:2    P@IBN  34                       CFT004
     C                     MOVE *BLANKS   DSSDY                           CFT004
     C                     CALL 'AOIBANR4'                                CFT004
     C                     PARM           @RTCD                           CFT004
     C                     PARM '*KEY   ' @OPTN   7                       CFT004
     C                     PARM           P@IBN                           CFT004
     C           SDACCT    PARM           DSSDY                           CFT004
     C           @RTCD     IFNE *BLANKS                                   CFT004
     C           *LOCK     IN   LDA                                       CFT004
     C                     MOVE *BLANKS   DBKEY                           CFT004
     C                     Z-ADD73        DBASE            ***************CFT004
     C                     MOVEL'ACCNTL6' DBFILE           * DB ERROR 73 *CFT004
     C                     MOVELP@IBN     DBKEY            ***************CFT004
     C                     OUT  LDA                                       CFT004
     C                     EXSR *PSSR                                     CFT004
     C                     ENDIF                                          CFT004
     C                     MOVE *BLANKS   @KEY1                           CFT004
     C                     MOVELCNUM      @KEY1                           CFT004
     C                     CALL 'AOCUSTR0'#ACUST                          CFT004
     C           @RTCD     IFNE *BLANKS                                   CFT004
     C           *LOCK     IN   LDA                                       CFT004
     C                     Z-ADD74        DBASE            ***************CFT004
     C                     MOVEL@KEY1     DBKEY            *  DBERR 074  *CFT004
     C                     MOVEL'SDCUSTPD'DBFILE           ***************CFT004
     C                     OUT  LDA                                       CFT004
     C                     EXSR *PSSR                                     CFT004
     C                     END                                            CFT004
     C                     MOVELBBCNA1    SBENE                           CFT004
     C                     ENDIF                                          CFT004
     C                     ENDIF                                          CFT004
      *                                                                   CFT004
     C*
     C** Format O.S.N. (If Non-autogen get from CB Ref else from MIR)
     C*
     C           *IN52     IFEQ '1'
     C*
     C           DNBC      IFNE 0
     C                     MOVELDNBC      SOSN
     C                     END
     C*
     C** Else, Autogen
     C*
     C                     ELSE
      *
     C                     MOVELCRMIR     W0FL15 15
     C*
     C                     MOVE CRMIR     SOSN
     C                     END
     C*
      *                                                                                       CER030
      ** Write Transaction type                                                               CER030
      *                                                                                       CER030
     C           CER030    IFEQ 'Y'                                                           CER030
     C           CGL013    OREQ 'Y'                                                           CER030
     C                     EXSR POPRTY                                                        CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDSR
     C*
     C/EJECT
     C*****************************************************************
     C*   NAUG     : Non-AutoGen processing                           *
     C*   Called by: SYSL,ALLB,SINB                                   *
     C*   Calls    : None                                             *
     C*****************************************************************
     C           NAUG      BEGSR
     C*
     C** Initialize fields
     C*
     C                     MOVE *BLANKS   HCDRO
     C                     MOVE *BLANKS   HDDST
     C                     MOVE *BLANKS   HNDS1
     C                     MOVE *BLANKS   HNDS2
     C                     MOVE *BLANKS   HDORC
     C                     MOVE *BLANKS   HNOC1
     C                     MOVE *BLANKS   HCORC
     C                     MOVE *BLANKS   HFORC
     C                     MOVE *BLANKS   HNOC2
     C                     MOVE *BLANKS   HDMTC
     C                     MOVE *BLANKS   HNMT1
     C                     MOVE *BLANKS   HNMT2
     C                     MOVE *BLANKS   HDORB
     C                     MOVE *BLANKS   HNOB1
     C                     MOVE *BLANKS   HNOB2
     C                     MOVE *BLANKS   HDSNC
     C                     MOVE *BLANKS   HNSC1
     C                     MOVE *BLANKS   HNSC2
     C                     MOVE *BLANKS   HDRCO
     C                     MOVE *BLANKS   HNRC1
     C                     MOVE *BLANKS   HCRCO
     C                     MOVE *BLANKS   HFRCO
     C                     MOVE *BLANKS   HNRC2
     C                     MOVE *BLANKS   HDINB
     C                     MOVE *BLANKS   HNIB1
     C                     MOVE *BLANKS   HCINB
     C                     MOVE *BLANKS   HFINB
     C                     MOVE *BLANKS   HNIB2
     C                     MOVE *BLANKS   HNIB3
     C                     MOVE *BLANKS   HNIB4
     C                     MOVE *BLANKS   HNIB5
     C                     MOVE *BLANKS   HDACB
     C                     MOVE *BLANKS   HNAB1
     C                     MOVE *BLANKS   HCACB
     C                     MOVE *BLANKS   HFACB
     C                     MOVE *BLANKS   HNAB2
     C                     MOVE *BLANKS   HNAB3
     C                     MOVE *BLANKS   HNAB4
     C                     MOVE *BLANKS   HNAB5
     C                     MOVE *BLANKS   HDBNC
     C                     MOVE *BLANKS   HNBC1
     C                     MOVE *BLANKS   HCBNC
     C                     MOVE *BLANKS   HFBNC
     C                     MOVE *BLANKS   HNBC2
     C                     MOVE *BLANKS   HNBC3
     C                     MOVE *BLANKS   HNBC4
     C                     MOVE *BLANKS   HNBC5
     C                     MOVE *BLANKS   HSMAM
     C                     MOVE *BLANKS   HPYAM
     C                     MOVE *BLANKS   HOSN
     C                     MOVE *BLANKS   SWPTY
     C                     Z-ADD*ZERO     POEXR                           CFT014
     C                     MOVEL'0'       *IN84                           CFT014
     C                     MOVEL*BLANKS   PIAMT                           CFT014
     C                     MOVEL*BLANKS   PICCY                           CFT014
     C                     MOVEL*BLANKS   PBOCD                           CFT014
     C                     MOVEL*BLANKS   PTTCD                           CFT014
     C                     MOVEL*BLANKS   PICD1                           CFT014
     C                     MOVEL*BLANKS   PICD2                           CFT014
     C                     MOVEL*BLANKS   PICD3                           CFT014
     C                     MOVEL*BLANKS   PICD4                           CFT014
     C                     MOVEL*BLANKS   PICD5                           CFT014
     C                     MOVEL*BLANKS   PRRP1                           CFT014
     C                     MOVEL*BLANKS   PRRP2                           CFT014
     C                     MOVEL*BLANKS   PRRP3                           CFT014
     C                     MOVEL*BLANKS   PRCRM                           CFT014
     C                     MOVEL*BLANKS   PRCCY                           CFT014
     C                     MOVEL*BLANKS   PSCH1                           CFT014
     C                     MOVEL*BLANKS   PSCH2                           CFT014
     C                     MOVEL*BLANKS   PSCH3                           CFT014
     C                     MOVEL*BLANKS   PSCH4                           CFT014
     C                     MOVEL*BLANKS   PSCH5                           CFT014
     C                     MOVEL*BLANKS   PSCC1                           CFT014
     C                     MOVEL*BLANKS   PSCC2                           CFT014
     C                     MOVEL*BLANKS   PSCC3                           CFT014
     C                     MOVEL*BLANKS   PSCC4                           CFT014
     C                     MOVEL*BLANKS   PSCC5                           CFT014
     C                     MOVEL*BLANKS   HCTRM                           CFT014
     C                     MOVEL*BLANKS   HDTRM                           CFT014
     C                     MOVEL*BLANKS   HNTR1                           CFT014
     C                     MOVEL*BLANKS   HNTR2                           CFT014
     C                     MOVEL*BLANKS   HFTRM                           CFT014
     C*
     C** Format SWIFT priority code
     C*
     C           SWPC      IFEQ 1
     C                     MOVE 'U'       SWPTY
     C                     ELSE
     C           SWPC      IFEQ 2
     C                     MOVE 'N'       SWPTY
     C                     END
     C                     END
     C*
     C** Format settle amount
     C*
     C                     Z-ADDSMAM      ZFLD15
     C                     Z-ADD@SMDP     ZDECS
     C                     EXSR ZFRPED
     C                     MOVE ZOUT22    HSMAM
     C*
     C** Format pay amount
     C*
     C                     CALL 'AOCURRR0'
     C                     PARM *BLANKS   @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM PCCY      @CCY    3
     C           SDCURR    PARM SDCURR    DSSDY
     C*
     C           @RTCD     IFNE *BLANKS
     C                     Z-ADD71        DBASE            ***************
     C                     MOVEL'SDCURRPD'DBFILE           * DBERR 071   *
     C                     MOVELPCCY      DBKEY            ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
     C*
     C                     MOVE A6NBDP    @PYDP   20
     C                     Z-ADDPYAM      ZFLD15
     C                     Z-ADD@PYDP     ZDECS
     C                     EXSR ZFRPED
     C                     MOVE ZOUT22    HPYAM
     C*
     C** Format settle Value date
     C*
     C                     Z-ADDSLDT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    SVAL
     C*
     C           ZDATE     IFEQ 0
     C                     Z-ADD20        DBASE            ***************
     C                     MOVEL*BLANK    DBKEY            * DBERR 020   *
     C                     MOVEL'ZDATE2'  DBFILE           ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
     C*
     C** Format pay Value date
     C*
     C                     Z-ADDPVDT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    PVAL
     C*
     C           ZDATE     IFEQ 0
     C                     Z-ADD21        DBASE            ***************
     C                     MOVEL*BLANK    DBKEY            * DBERR 021   *
     C                     MOVEL'ZDATE2'  DBFILE           ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
     C*
     C** Format Charges to debit of A/C
     C*
     C           CDRT      IFEQ 'N'
     C                     MOVELCDRO      W0FLD2
     C                     MOVELW0FLD2    HCDRO
     C                     END
     C*
     C           CDRT      IFEQ 'R'
     C                     MOVELCDRO      W0FL10
     C                     MOVELW0FL10    HCDRO
     C                     END
     C*
     C           CDRT      IFEQ 'P'
     C                     MOVELCDRO      HCDRO
     C                     END
     C*
     C** Format 'Charge to DB of Branch'
     C*
     C***********CDRO      IFNE *ZERO                                                         CSD027
     C           CDRO      IFNE *BLANKS                                                       CSD027
     C                     MOVELCDBR      HCHCY
     C                     ELSE
     C                     MOVE *BLANKS   HCHCY
     C                     END
     C*
     C** Format Charges Currency
     C*
     C                     SELEC
     C           BTCHCY    WHEQ 'B'
     C***********CDRO      ORNE *ZERO                                                         CSD027
     C           CDRO      ORNE *BLANKS                                                       CSD027
     C                     MOVELBJCYCD    HCCCY
     C                     MOVELBJCYCD    HCCCY2                          CFT009
     C*
     C           BTCHCY    WHEQ 'L'
     C                     MOVELBJLCCY    HCCCY
     C                     MOVELBJLCCY    HCCCY2                          CFT009
     C*
     C           BTCHCY    WHEQ 'C'
     C           ADDC      ANDEQ'A'
     C                     MOVELSMCY      HCCCY
     C                     MOVELSMCY      HCCCY2                          CFT009
     C*                                                                   CFT009
     C           BTCHCY    WHEQ 'F'                                       CFT009
     C                     MOVELFCHCCY    HCCCY                           CFT009
     C                     MOVELFCHCCY    HCCCY2                          CFT009
     C*
     C                     OTHER
     C                     MOVELPCCY      HCCCY
     C                     MOVELPCCY      HCCCY2                          CFT009
     C                     ENDSL
     C*
     C                     CALL 'AOCURRR0'
     C                     PARM *BLANKS   @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM HCCCY     @CCY    3
     C           SDCURR    PARM SDCURR    DSSDY
     C*
     C           @RTCD     IFNE *BLANKS
     C                     Z-ADD72        DBASE            ***************
     C                     MOVEL'SDCURRPD'DBFILE           * DBERR 072   *
     C                     MOVELHCCCY     DBKEY            ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
     C*
     C** Format Charges Amount   (Original amount entered)
     C*
     C*
     C** Format Costs abroad charge (outgoing) / Advice charge (incoming)
     C*
     C                     MOVE DUMA4     ZFIELD 16
     C                     Z-ADDA6NBDP    ZADEC
     C                     EXSR ZEDIT
     C  N29                MOVE ZFIELD    HCSTA
     C   29                MOVE ZFIELD    HADCH
     C*
     C** Format Swift priority charge (outgoing) / phone charge (incoming)
     C*
     C                     MOVE DUMA5     ZFIELD 16
     C                     Z-ADDA6NBDP    ZADEC
     C                     EXSR ZEDIT
     C  N29                MOVE ZFIELD    HSPCH
     C   29                MOVE ZFIELD    HTLCH
     C*
     C** Format Transfer commission charge
     C*
     C                     MOVE DUMA1     ZFIELD 16
     C                     Z-ADDA6NBDP    ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    HTRCM
     C*
     C** Format Cheque Charge
     C*
     C                     MOVE DUMA3     ZFIELD 16
     C                     Z-ADDA6NBDP    ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    HCQCH
     C*
     C** Format Telex charge
     C*
     C                     MOVE DUMA2     ZFIELD 16
     C                     Z-ADDA6NBDP    ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    HTXCH
     C*
     C** Format Miscellaneous charge
     C*
     C                     MOVE DUMA6     ZFIELD 16
     C                     Z-ADDA6NBDP    ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    HMSCH
      *                                                                   CFT009
      ** Format FX change commission charge                               CFT009
      *                                                                   CFT009
     C           *IN29     IFEQ *OFF                                      CFT009
      * OUTGOING                                                          CFT009
     C                     MOVE OPDUM7    ZFIELD 16                       CFT009
     C                     ELSE                                           CFT009
      * INCOMING                                                          CFT009
     C                     MOVE INDUM7    ZFIELD 16                       CFT009
     C                     ENDIF                                          CFT009
     C                     Z-ADDA6NBDP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    HFXCHG                          CFT009
      *                                                                   CFT009
      * New charges for CFT009                                            CFT009
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
      *                                                                   CFT009
      ** Format Miscellaneous charge 1                                    CFT009
      *                                                                   CFT009
     C           *IN29     IFEQ *OFF                                      CFT009
      * OUTGOING                                                          CFT009
     C                     MOVE MISCC1    ZFIELD 16                       CFT009
     C                     ELSE                                           CFT009
      * INCOMING                                                          CFT009
     C                     MOVE CMSC01    ZFIELD 16                       CFT009
     C                     ENDIF                                          CFT009
     C                     Z-ADDA6NBDP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    HMSCH1                          CFT009
      *                                                                   CFT009
      ** Format Miscellaneous charge 2                                    CFT009
      *                                                                   CFT009
     C           *IN29     IFEQ *OFF                                      CFT009
      * OUTGOING                                                          CFT009
     C                     MOVE MISCC2    ZFIELD 16                       CFT009
     C                     ELSE                                           CFT009
      * INCOMING                                                          CFT009
     C                     MOVE CMSC02    ZFIELD 16                       CFT009
     C                     ENDIF                                          CFT009
     C                     Z-ADDA6NBDP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    HMSCH2                          CFT009
      *                                                                   CFT009
      ** Format Miscellaneous charge 3                                    CFT009
      *                                                                   CFT009
     C           *IN29     IFEQ *OFF                                      CFT009
      * OUTGOING                                                          CFT009
     C                     MOVE MISCC3    ZFIELD 16                       CFT009
     C                     ELSE                                           CFT009
      * INCOMING                                                          CFT009
     C                     MOVE CMSC03    ZFIELD 16                       CFT009
     C                     ENDIF                                          CFT009
     C                     Z-ADDA6NBDP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    HMSCH3                          CFT009
      *                                                                   CFT009
      ** Format Miscellaneous charge 4                                    CFT009
      *                                                                   CFT009
     C           *IN29     IFEQ *OFF                                      CFT009
      * OUTGOING                                                          CFT009
     C                     MOVE MISCC4    ZFIELD 16                       CFT009
     C                     ELSE                                           CFT009
      * INCOMING                                                          CFT009
     C                     MOVE CMSC04    ZFIELD 16                       CFT009
     C                     ENDIF                                          CFT009
     C                     Z-ADDA6NBDP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    HMSCH4                          CFT009
      *                                                                   CFT009
      ** Format Miscellaneous charge 5                                    CFT009
      *                                                                   CFT009
     C           *IN29     IFEQ *OFF                                      CFT009
      * OUTGOING                                                          CFT009
     C                     MOVE MISCC5    ZFIELD 16                       CFT009
     C                     ELSE                                           CFT009
      * INCOMING                                                          CFT009
     C                     MOVE CMSC05    ZFIELD 16                       CFT009
     C                     ENDIF                                          CFT009
     C                     Z-ADDA6NBDP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    HMSCH5                          CFT009
      *                                                                   CFT009
      ** Format SWIFT standard charge                                     CFT009
      *                                                                   CFT009
     C           *IN29     IFEQ *OFF                                      CFT009
      * OUTGOING ONLY                                                     CFT009
     C                     MOVE SWSCCC    ZFIELD 16                       CFT009
     C                     Z-ADDA6NBDP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    HSSCH                           CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      * New charges for CFT009                                            CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
     C*
     C** Calculate Total Charges (in input ccy - base, local, charge)
     C** Note: for the moment, UBS set the Charge Currency in FT-ICD
     C** to 'C' which means charges input in either Sett or Pay ccy.
     C**
     C*
     C                     Z-ADDDUMA1     @CHTI  120
     C                     ADD  DUMA2     @CHTI
     C                     ADD  DUMA3     @CHTI
     C                     ADD  DUMA4     @CHTI
     C                     ADD  DUMA5     @CHTI
     C                     ADD  DUMA6     @CHTI
     C                     Z-ADD@CHTI     ZFLD15
     C                     Z-ADDA6NBDP    ZDECS
     C                     EXSR ZFRPED
     C                     MOVE ZOUT22    HCHTI  16
     C*
     C                     SELEC
     C*
     C** Determine the converted-to ccy
     C*
     C***********CDRO      WHNE *ZERO                                                         CSD027
     C           CDRO      WHNE *BLANKS                                                       CSD027
     C                     MOVELBJCYCD    HDCCY
     C                     MOVELBJCYCD    HDCCY2                          CFT009
     C*
     C           ADDC      WHEQ 'A'
     C                     MOVELSMCY      HDCCY
     C                     MOVELSMCY      HDCCY2                          CFT009
     C*
     C                     OTHER
     C                     MOVELPCCY      HDCCY
     C                     MOVELPCCY      HDCCY2                          CFT009
     C                     ENDSL
     c*
     C** Set up other ccy fields on report
     c*
     C                     MOVELHDCCY     HCHCT
     C*
     C                     CALL 'AOCURRR0'
     C                     PARM *BLANKS   @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM HDCCY     @CCY    3
     C           SDCURR    PARM SDCURR    DSSDY
     C*
     C           @RTCD     IFNE *BLANKS
     C                     Z-ADD22        DBASE            ***************
     C                     MOVEL'SDCURRPD'DBFILE           * DBERR 022   *
     C                     MOVELHDCCY     DBKEY            ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
     C*
     C**** Format Each Charges Amount  (Converted Amount)
     C*
     C**** Charges specfic for Outgoing Payment only
     C*
     C           *IN29     IFEQ '0'
     C*
     C** Format Costs abroad charge (outgoing only)
     C*
     C                     MOVE CSTA      ZFIELD 16
     C                     Z-ADDA6NBDP    ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    HDCST
     C*
     C** Format Swift priority charge (outgoing only)
     C*
     C                     MOVE SPCH      ZFIELD 16
     C                     Z-ADDA6NBDP    ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    HDSPC
      *                                                                   CFT009
      ** New charges for CFT009                                           CFT009
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
      *                                                                   CFT009
      ** Format Swift standard charge (outgoing only)                     CFT009
      *                                                                   CFT009
     C                     MOVE SWSCHG    ZFIELD 16                       CFT009
     C                     Z-ADDA6NBDP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    HDSSC                           CFT009
      *                                                                   CFT009
      ** New charges for CFT009                                           CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
     C*
     C                     ELSE
     C*
     C**** Charges specific for Incoming Payment only
     C*
     C** Format Advice charge (incoming only)
     C*
     C                     MOVE ADCH      ZFIELD 16
     C                     Z-ADDA6NBDP    ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    HDADC
     C*
     C** Format Telephone charge (incoming only)
     C*
     C                     MOVE TLCH      ZFIELD 16
     C                     Z-ADDA6NBDP    ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    HDTLC
     C*
     C                     END
     C*
     C** Format Transfer commission charge
     C*
     C                     MOVE TRCM      ZFIELD 16
     C                     Z-ADDA6NBDP    ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    HDTRC
     C*
     C** Format Cheque Charge
     C*
     C                     MOVE CQCH      ZFIELD 16
     C                     Z-ADDA6NBDP    ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    HDCQC
     C*
     C** Format Telex charge
     C*
     C                     MOVE TXCH      ZFIELD 16
     C                     Z-ADDA6NBDP    ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    HDTXC
     C*
     C** Format Miscellaneous charge
     C*
     C                     MOVE MSCH      ZFIELD 16
     C                     Z-ADDA6NBDP    ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    HDMSC
      *                                                                   CFT009
      ** Format FX/Change commission                                      CFT009
      *                                                                   CFT009
     C           *IN29     IFEQ *OFF                                      CFT009
      * OUTGOING                                                          CFT009
     C                     MOVE OPCHCM    ZFIELD 16                       CFT009
     C                     ELSE                                           CFT009
      * INCOMING                                                          CFT009
     C                     MOVE INCHCM    ZFIELD 16                       CFT009
     C                     ENDIF                                          CFT009
     C                     Z-ADDA6NBDP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    HDFXCH                          CFT009
      *                                                                   CFT009
      ** New charges for CFT009                                           CFT009
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
      *                                                                   CFT009
      ** Format Miscellaneous charge 1                                    CFT009
      *                                                                   CFT009
     C           *IN29     IFEQ *OFF                                      CFT009
      * OUTGOING                                                          CFT009
     C                     MOVE MISC01    ZFIELD 16                       CFT009
     C                     ELSE                                           CFT009
      * INCOMING                                                          CFT009
     C                     MOVE MSC01     ZFIELD 16                       CFT009
     C                     ENDIF                                          CFT009
     C                     Z-ADDA6NBDP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    HDMSC1                          CFT009
      *                                                                   CFT009
      ** Format Miscellaneous charge 2                                    CFT009
      *                                                                   CFT009
     C           *IN29     IFEQ *OFF                                      CFT009
      * OUTGOING                                                          CFT009
     C                     MOVE MISC02    ZFIELD 16                       CFT009
     C                     ELSE                                           CFT009
      * INCOMING                                                          CFT009
     C                     MOVE MSC02     ZFIELD 16                       CFT009
     C                     ENDIF                                          CFT009
     C                     Z-ADDA6NBDP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    HDMSC2                          CFT009
      *                                                                   CFT009
      ** Format Miscellaneous charge 3                                    CFT009
      *                                                                   CFT009
     C           *IN29     IFEQ *OFF                                      CFT009
      * OUTGOING                                                          CFT009
     C                     MOVE MISC03    ZFIELD 16                       CFT009
     C                     ELSE                                           CFT009
      * INCOMING                                                          CFT009
     C                     MOVE MSC03     ZFIELD 16                       CFT009
     C                     ENDIF                                          CFT009
     C                     Z-ADDA6NBDP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    HDMSC3                          CFT009
      *                                                                   CFT009
      ** Format Miscellaneous charge 4                                    CFT009
      *                                                                   CFT009
     C           *IN29     IFEQ *OFF                                      CFT009
      * OUTGOING                                                          CFT009
     C                     MOVE MISC04    ZFIELD 16                       CFT009
     C                     ELSE                                           CFT009
      * INCOMING                                                          CFT009
     C                     MOVE MSC04     ZFIELD 16                       CFT009
     C                     ENDIF                                          CFT009
     C                     Z-ADDA6NBDP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    HDMSC4                          CFT009
      *                                                                   CFT009
      ** Format Miscellaneous charge 5                                    CFT009
      *                                                                   CFT009
     C           *IN29     IFEQ *OFF                                      CFT009
      * OUTGOING                                                          CFT009
     C                     MOVE MISC05    ZFIELD 16                       CFT009
     C                     ELSE                                           CFT009
      * INCOMING                                                          CFT009
     C                     MOVE MSC05     ZFIELD 16                       CFT009
     C                     ENDIF                                          CFT009
     C                     Z-ADDA6NBDP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    HDMSC5                          CFT009
      *                                                                   CFT009
      ** New charges for CFT009                                           CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
     C*
     C** Calculate Total Charges (in converted ccy)
     C*
     C                     Z-ADDTRCM      @CHTL  120
     C                     ADD  TXCH      @CHTL
     C                     ADD  CQCH      @CHTL
     C                     ADD  MSCH      @CHTL
     C  N29                ADD  CSTA      @CHTL
     C  N29                ADD  SPCH      @CHTL
     C   29                ADD  ADCH      @CHTL
     C   29                ADD  TLCH      @CHTL
     C   29                ADD  INCHCM    @CHTL                           CFT009
     C  N29                ADD  OPCHCM    @CHTL                           CFT009
      *                                                                   CFT009
      ** New charges for CFT009                                           CFT009
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
      *                                                                   CFT009
     C                     SELEC                                          CFT009
     C           *IN29     WHEQ *ON                                       CFT009
      * INCOMING                                                          CFT009
     C                     ADD  MSC01     @CHTL                           CFT009
      *                                                                   CFT009
     C                     ADD  MSC02     @CHTL                           CFT009
      *                                                                   CFT009
     C                     ADD  MSC03     @CHTL                           CFT009
      *                                                                   CFT009
     C                     ADD  MSC04     @CHTL                           CFT009
      *                                                                   CFT009
     C                     ADD  MSC05     @CHTL                           CFT009
      *                                                                   CFT009
      *                                                                   CFT009
     C           *IN29     WHEQ *OFF                                      CFT009
      * OUTGOING                                                          CFT009
     C                     ADD  MISC01    @CHTL                           CFT009
      *                                                                   CFT009
     C                     ADD  MISC02    @CHTL                           CFT009
      *                                                                   CFT009
     C                     ADD  MISC03    @CHTL                           CFT009
      *                                                                   CFT009
     C                     ADD  MISC04    @CHTL                           CFT009
      *                                                                   CFT009
     C                     ADD  MISC05    @CHTL                           CFT009
      *                                                                   CFT009
      *                                                                   CFT009
     C                     ADD  SWSCHG    @CHTL                           CFT009
      *                                                                   CFT009
     C                     ENDSL                                          CFT009
      *                                                                   CFT009
     C*                                                                   CFT009
     C** New charges for CFT009                                           CFT009
     C*                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     Z-ADD@CHTL     ZFLD15
     C                     Z-ADDA6NBDP    ZDECS
     C                     EXSR ZFRPED
     C                     MOVE ZOUT22    HCHTL
     C*
     C** Skip the calculation of TOTAL DR AMT or NET AMT if non-charge
     C** ccy.
     C** Convert the amount in base or local ccy to charge amount will
     C** be implemented later.
     C           BTCHCY    IFEQ 'B'
     C***********CDRO      ORNE *ZEROS                                                        CSD027
     C           CDRO      ORNE *BLANKS                                                       CSD027
     C           BTCHCY    OREQ 'L'
     C           ADDC      IFEQ 'A'
     C                     MOVE SMCY      HDRC1
     C                     MOVE HSMAM     HDRT1
     C                     ELSE
     C                     MOVE PCCY      HDRC2
     C                     MOVE HPYAM     HDRT2
     C                     END
     C                     GOTO SKIP1
     C                     END
     C*
     C** Format TOTAL DR AMT if Add to Sett amount
     C           ADDC      IFEQ 'A'
     C           SMAM      ADD  @CHTL     @DRT1  130
     C*
     C                     Z-ADD@DRT1     ZFLD15
     C                     Z-ADD@SMDP     ZDECS
     C                     EXSR ZFRPED
     C                     MOVE ZOUT22    HDRT1
     C                     MOVE SMCY      HDRC1
     C*
     C** Format NET AMT if Deduct from Pay amount
     C                     ELSE
     C           ADDC      IFEQ 'D'
     C           PYAM      SUB  @CHTL     @DRT2  130
     C*
     C                     Z-ADD@DRT2     ZFLD15
     C                     Z-ADD@PYDP     ZDECS
     C                     EXSR ZFRPED
     C                     MOVE ZOUT22    HDRT2
     C                     MOVE PCCY      HDRC2
     C                     END
     C                     END
     C*
     C*
     C           SKIP1     TAG
     C*
     C** Format Destination
     C*
     C           *IN29     IFEQ '0'                        -Outgoing
     C*
     C                     MOVE *BLANKS   @KEY1
     C*
     C           DSTT      IFNE *BLANKS
     C*
     C** Get Customer name and address
     C*
     C           DSTT      IFEQ 'A'
     C                     MOVELDST1      HNDS1
     C                     MOVELDST2      HNDS2
     C                     ELSE
     C*
     C** Get Customer BOJ code/Address
     C*
     C                     MOVE *BLANKS   XNAMDS
     C                     MOVELDSTT      W8TYPE
     C                     MOVE *BLANKS   W8LINS
     C                     MOVELDST1      W8LINS
     C                     MOVELPCCY      W8CCY
     C*
     C                     EXSR #HGETA
     C*
     C                     MOVELXADD2     HNDS1
     C                     MOVELXADD3     HNDS2
     C*
     C**  Destination is a Customer Number
     C*
     C           DSTT      IFEQ 'C'
     C                     MOVEL@DSCS     @KEY1
     C                     CALL 'AOCUSTR0'#ACUST
     C           @RTCD     IFNE *BLANKS
     C           *LOCK     IN   LDA
     C                     Z-ADD25        DBASE            ***************
     C                     MOVEL@KEY1     DBKEY            *  DBERR 025  *
     C                     MOVEL'SDCUSTPD'DBFILE           ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     ELSE
     C                     MOVELBBCSID    HDDST
     C                     END
     C                     END
     C*
     C** Destination is a Full Nostro
     C*
     C           DSTT      IFEQ 'F'
     C                     MOVEL@DSNS     HDDST
     C                     END
     C*
     C** Destination is a Retail Account
     C*
     C           DSTT      IFEQ 'R'
     C                     MOVEL@DSRT     HDDST
     C                     END
     C*
     C** Destination is a full Midas account
     C*
     C           DSTT      IFEQ 'G'
     C                     MOVEL@DSAN     HDDST
     C                     END
     C*
     C** Destination is a SWIFT address
     C*
     C           DSTT      IFEQ 'S'
     C                     MOVEL@DSSA     HDDST
     C                     END
     C*
     C                     END
     C                     END
     C                     END
     C*
     C           *IN29     IFEQ '1'                        -Incoming
     C*
     C                     MOVE *BLANKS   @KEY1
     C*
     C           SNTP      IFNE *BLANKS
     C*
     C           SNTP      IFEQ 'C'
     C                     MOVEL@SNCS     @KEY1
     C                     CALL 'AOCUSTR0'#ACUST
     C           @RTCD     IFNE *BLANKS
     C           *LOCK     IN   LDA
     C                     Z-ADD25        DBASE            ***************
     C                     MOVEL@KEY1     DBKEY            *  DBERR 025  *
     C                     MOVEL'SDCUSTPD'DBFILE           ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     ELSE
     C                     MOVELBBCSID    HDDST
     C                     END
     C                     END
     C*
     C           SNTP      IFEQ 'F'
     C                     MOVEL@SNNS     HDDST
     C                     END
     C*
     C           SNTP      IFEQ 'R'
     C                     MOVEL@SNRT     HDDST
     C                     END
     C*
     C           SNTP      IFEQ 'G'
     C                     MOVEL@SNAN     HDDST
     C                     END
     C*
     C           SNTP      IFEQ 'S'
     C                     MOVEL@SNSA     HDDST
     C                     END
     C*
     C** Get Customer name and address
     C*
     C           SNTP      IFEQ 'A'
     C                     MOVELSND1      HNDS1
     C                     MOVELSND2      HNDS2
     C                     ELSE
     C*
     C** Get Customer BOJ code/Address
     C*
     C                     MOVE *BLANKS   XNAMDS
     C                     MOVELSNTP      W8TYPE
     C                     MOVE *BLANKS   W8LINS
     C                     MOVELSND1      W8LINS
     C                     MOVELSMCY      W8CCY
     C*
     C                     EXSR #HGETA
     C*
     C                     MOVELXADD2     HNDS1
     C                     MOVELXADD3     HNDS2
     C*
     C                     END
     C                     END
     C                     END
     C*
     C** Format Ordering Customer
     C*
     C           ORCT      IFNE *BLANKS
      *                                                                                       CFT032
     C                     MOVELORC1      @SLASH                                              CFT032
     C           ORCT      IFNE 'I'                                                           CFT032
     C           ORCT      ANDNE'C'                                                           CFT032
     C           ORCT      ANDNE'A'                                                           CFT032
     C           @SLASH    IFEQ '/'                                                           CFT032
     C                     MOVE ORC1      @ORC1                                               CFT032
     C                     ELSE                                                               CFT032
     C                     MOVELORC1      @ORC1                                               CFT032
     C                     ENDIF                                                              CFT032
     C                     ENDIF                                                              CFT032
      *                                                                                       CFT032
     C           ORCT      IFEQ 'R'
     C                     MOVEL@OCRT     HDORC
     C                     END
     C*
     C           ORCT      IFEQ 'P'
     C           ORCT      OREQ 'C'
     C                     MOVELSMCY      W8CCY
     C**********           MOVELORC1      HDORC                                               CFT032
      *                                                                                       CFT032
     C           ORCT      IFEQ 'C'                                                           CFT032
     C           @SLASH    IFEQ '/'                                                           CFT032
     C                     MOVELORC2      HDORC                                               CFT032
     C                     ELSE                                                               CFT032
     C                     MOVEL@ORC1     HDORC                                               CFT032
     C                     ENDIF                                                              CFT032
     C                     ENDIF                                                              CFT032
      *                                                                                       CFT032
     C           ORCT      IFEQ 'P'                                                           CFT032
     C                     MOVEL@ORC1     HDORC                                               CFT032
     C                     ENDIF                                                              CFT032
      *                                                                                       CFT032
     C                     END
     C*
     C           ORCT      IFEQ 'S'
     C**********           MOVELORC1      HDORC                                               CFT032
      *                                                                                       CFT032
     C           @SLASH    IFEQ '/'                                                           CFT032
     C                     MOVELORC2      HDORC                                               CFT032
     C                     ELSE                                                               CFT032
     C                     MOVEL@ORC1     HDORC                                               CFT032
     C                     ENDIF                                                              CFT032
      *                                                                                       CFT032
     C                     END
     C*
     C           ORCT      IFEQ 'A'
     C           @OCCN     IFEQ 'MT202 '
     C                     MOVEL@OCCN     HNOC1
     C                     MOVELOPORB1    HNOC2
     C                     ELSE
     C                     MOVELORC1      HNOC1
     C                     MOVELORC2      HNOC2
     C                     END
     C                     MOVE 'F'       HFORC
     C                     ELSE
     C*
     C** Get Customer BOJ code/Address
     C*
     C                     MOVE *BLANKS   XNAMDS
     C                     MOVELORCT      W8TYPE
     C                     MOVE *BLANKS   W8LINS
     C                     MOVELORC1      W8LINS
     C                     MOVELSMCY      W8CCY
     C*
     C                     EXSR #HGETA
     C*
     C           ORCT      IFEQ 'S'
     C           W8RTN     ANDNE*BLANKS
     C                     MOVEAHKA,1     HNOC1
     C                     ELSE
     C*
     C                     MOVELXADD2     HNOC1
     C                     MOVELXADD3     HNOC2
     C*
     C                     END
     C                     END
     C                     END
     C*
     C** Format MT100 Customer
     C*
     C                     MOVE *BLANKS   @KEY1
     C*
     C           ODMT      IFNE *BLANKS
      *                                                                                       CFT032
      ** Destination type is a full nostro 'F'                                                CFT032
      *                                                                                       CFT032
     C           ODMTT     IFEQ 'F'                                                           CFT032
     C           3         SUBSTODMT:1    @KEYB                                               CFT032
     C           2         SUBSTODMT:4    @KEYE                                               CFT032
     C                     CALL 'AONOSTR0'#ANOST                                              CFT032
      *                                                                                       CFT032
     C           @RTCD     IFNE *BLANKS                                                       CFT032
     C           *LOCK     IN   LDA                                                           CFT032
     C                     Z-ADD26        DBASE                                               CFT032
     C                     MOVEL@SNNS     DBKEY                                               CFT032
     C                     MOVEL'SDNOSTPD'DBFILE                                              CFT032
     C                     OUT  LDA                                                           CFT032
     C                     EXSR *PSSR                                                         CFT032
     C                     ENDIF                                                              CFT032
     C                     MOVELA7CUST    W1CNUM  6                                           CFT032
     C                     ENDIF                                                              CFT032
      *                                                                                       CFT032
      ** Destination type is a 'I'                                                            CFT032
      *                                                                                       CFT032
     C           ODMTT     IFEQ 'I'                                                           CFT032
     C                     MOVELODMT      P@IBN                                               CFT032
     C                     MOVE *BLANKS   DSSDY                                               CFT032
     C                     CALL 'AOIBANR4'                                                    CFT032
     C                     PARM           @RTCD                                               CFT032
     C                     PARM '*KEY   ' @OPTN                                               CFT032
     C                     PARM           P@IBN                                               CFT032
     C           WACCN     PARM           DSSDY                                               CFT032
      *                                                                                       CFT032
     C           @RTCD     IFNE *BLANKS                                                       CFT032
     C           *LOCK     IN   LDA                                                           CFT032
     C                     Z-ADD27        DBASE                                               CFT032
     C                     MOVELP@IBN     DBKEY                                               CFT032
     C                     MOVEL'ACCNTL6' DBFILE                                              CFT032
     C                     OUT  LDA                                                           CFT032
     C                     EXSR *PSSR                                                         CFT032
     C                     ENDIF                                                              CFT032
     C                     MOVE WWCNUM    W1CNUM                                              CFT032
     C                     ENDIF                                                              CFT032
      *                                                                                       CFT032
      ** Destination type is a GL Account 'G'                                                 CFT032
      *                                                                                       CFT032
     C           ODMTT     IFEQ 'G'                                                           CFT032
     C           24        SUBSTODMT:1    WCDET                                               CFT032
     C                     MOVEL*BLANKS   @RETL  10                                           CFT032
     C                     MOVELWDCNUM    @CNNM   6                                           CFT032
     C                     MOVELWDCCY     @CUCD   3                                           CFT032
     C                     MOVELWDACOD    @ACCD                                               CFT032
     C                     MOVELWDACSQ    @ACSQ   2                                           CFT032
     C           MBIN      IFEQ 'Y'                                                           CFT032
     C                     MOVE WDBRCA    @BRCD   3                                           CFT032
     C                     ELSE                                                               CFT032
     C                     MOVE BJSBRC    @BRCD                                               CFT032
     C                     ENDIF                                                              CFT032
     C                     CALL 'AOACCTR0'#AACCT                                              CFT032
      *                                                                                       CFT032
     C           @RTCD     IFNE *BLANKS                                                       CFT032
     C           *LOCK     IN   LDA                                                           CFT032
     C                     Z-ADD29        DBASE                                               CFT032
     C                     MOVEL@DSAN     DBKEY                                               CFT032
     C                     MOVEL'ACCNTAB' DBFILE                                              CFT032
     C                     OUT  LDA                                                           CFT032
     C                     EXSR *PSSR                                                         CFT032
     C                     ENDIF                                                              CFT032
     C                     MOVE CNUM      W1CNUM                                              CFT032
     C                     ENDIF                                                              CFT032
      *                                                                                       CFT032
      ** Destination type is a 'S'                                                            CFT032
      *                                                                                       CFT032
     C           ODMTT     IFEQ 'S'                                                           CFT032
     C           8         SUBSTODMT:1    W9BICC  8                                           CFT032
     C           3         SUBSTODMT:9    W9BICB  3                                           CFT032
      *                                                                                       CFT032
     C                     CALL 'ME1400'               9090                                   CFT032
     C                     PARM *BLANKS   W9RTN   7                                           CFT032
     C                     PARM           W9BICC                                              CFT032
     C                     PARM           W9BICB                                              CFT032
     C                     PARM           SDCUST                                              CFT032
     C                     PARM           SDCNST                                              CFT032
     C                     PARM           MEBICD                                              CFT032
     C                     PARM *BLANKS   W9CUST  1                                           CFT032
     C                     PARM *BLANKS   W9CNST  1                                           CFT032
     C                     PARM *BLANKS   W9BICD  1                                           CFT032
      *                                                                                       CFT032
     C           W9CUST    IFNE 'Y'                                                           CFT032
     C           W9BICD    ANDNE'Y'                                                           CFT032
     C           *LOCK     IN   LDA                                                           CFT032
     C                     Z-ADD34        DBASE                                               CFT032
     C                     MOVEL'*CALL   'DBKEY                                               CFT032
     C                     MOVEL'ME1400 ' DBFILE                                              CFT032
     C                     OUT  LDA                                                           CFT032
     C                     EXSR *PSSR                                                         CFT032
     C                     ELSE                                                               CFT032
     C                     MOVE BBCUST    W1CNUM                                              CFT032
     C                     MOVELODMT      HDMTC                                               CFT032
     C                     MOVELBDINS1    HNMT1                                               CFT032
     C                     MOVELBDAPH1    HNMT2                                               CFT032
     C                     ENDIF                                                              CFT032
     C                     ENDIF                                                              CFT032
      *                                                                                       CSW207
      ** Destination type is a 'O'                                                            CSW207
      *                                                                                       CSW207
     C           ODMTT     IFEQ 'O'                                                           CSW207
     C                     CALL 'AONAHOR0'                                                    CSW207
     C                     PARM *BLANKS   @RTCD   7                                           CSW207
     C                     PARM '*KEY   ' @OPTN   7                                           CSW207
     C                     PARM ODMT      @NAHO  10                                           CSW207
     C********** SDNAHO    PARM SDNAHO    DSSDY                                      CSW207 BUG24029
     C           SDNAHO    PARM SDNAHO    DSLDY                                             BUG24029
     C           @RTCD     IFNE *BLANKS                                                       CSW207
     C           *LOCK     IN   LDA                                                           CSW207
     C                     Z-ADD77        DBASE            ***************                    CSW207
     C                     MOVELODMT      DBKEY            *  DBERR 077  *                    CSW207
     C                     MOVEL'SDNAHOPD'DBFILE           ***************                    CSW207
     C                     OUT  LDA                                                           CSW207
     C                     EXSR *PSSR                                                         CSW207
     C                     ENDIF                                                              CSW207
     C                     ENDIF                                                              CSW207
     C*                                                                                       CSW207
      *                                                                                       CFT032
      ** Destination type is a Customer Number 'C'                                            CFT032
      *                                                                                       CFT032
     C           ODMTT     IFEQ 'C'                                                           CFT032
     C                     MOVELODMT      W1CNUM                                              CFT032
     C                     ENDIF                                                              CFT032
      *                                                                                       CFT032
     C**********           MOVELODMT      @KEY1                                               CFT032
     C                     MOVELW1CNUM    @KEY1                                               CFT032
     C           W1CNUM    IFNE *BLANKS                                                       CSW207
     C                     CALL 'AOCUSTR0'#ACUST
     C           @RTCD     IFNE *BLANKS
     C           *LOCK     IN   LDA
     C                     Z-ADD28        DBASE            ***************
     C                     MOVEL@KEY1     DBKEY            *  DBERR 028  *
     C                     MOVEL'SDCUSTPD'DBFILE           ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
     C                     MOVELODMT      HDMTC
     C                     MOVELBBCNA1    HNMT1
     C                     MOVELBBCNA2    HNMT2
     C                     ENDIF                                                              CSW207
     C           CSW207    IFEQ 'Y'                                                           CSW207
     C           ODMTT     ANDEQ'O'                                                           CSW207
     C                     MOVELODMT      HDMTC                                               CSW207
     C                     MOVELNHCNA1    HNMT1                                               CSW207
     C                     MOVELNHCNA2    HNMT2                                               CSW207
     C                     ENDIF                                                              CSW207
     C                     END
     C*
     C** Format Ordering Bank
     C*
     C                     MOVE *BLANKS   @KEY1
     C*
     C           ORBT      IFNE *BLANKS
     C           ORBT      IFEQ 'R'
     C                     MOVEL@OBRT     HDORB
     C                     END
     C*
     C           ORBT      IFEQ 'P'
     C** Set up the subfield for branch only if type is 'P' for partial
     C           MBIN      IFEQ 'Y'
     C                     MOVE ORBB      @OBBR
     C                     ELSE
     C                     MOVE BJSBRC    @OBBR
     C                     END
     C                     MOVEL@ORBK     HDORB
     C                     END
     C*
     C           ORBT      IFEQ 'N'
     C                     MOVELSMCY      W8CCY
     C                     MOVEL@OBNN     HDORB
     C                     END
     C*
     C           ORBT      IFEQ 'S'
     C                     MOVEL@OBSW     HDORB
     C                     END
     C*
     C** Get Customer name and address
     C*
     C           ORBT      IFEQ 'A'
     C                     MOVELORB1      HNOB1
     C                     MOVELORB2      HNOB2
     C                     ELSE
     C*
     C** Get Customer BOJ code/Address
     C*
     C                     CLEARW8FT
     C                     MOVEL*BLANKS   W8STMT
     C                     MOVELSMCY      W8CCY
     C                     MOVEL##PGM     W8CPGM
     C                     MOVEL'*PRINT'  W8ACT
     C                     Z-ADD3         W8NLIN
     C*
     C                     MOVE *BLANKS   XNAMDS
     C                     MOVELORBT      W8TYPE
     C                     MOVE *BLANKS   W8LINS
     C                     MOVELORB1      W8LINS
     C*
     C                     EXSR #HGETA
     C*
     C           ORBT      IFEQ 'S'
     C           W8RTN     ANDNE*BLANKS
     C                     MOVEAHKA,1     HNOB1
     C                     ELSE
     C*
     C                     MOVELXADD2     HNOB1
     C                     MOVELXADD3     HNOB2
     C                     END
     C*
     C                     END
     C*
     C** For outgoing payments use OPORB1 and OPORB2 for field 52.
     C*
     C           ORBT      IFEQ 'R'
     C           ORBT      OREQ 'N'
     C           ORBT      OREQ 'P'
     C           OPMSGR    IFNE 0
     C           OPORBT    ANDNE' '
     C                     MOVELOPORB1    HNOB1
     C                     MOVELOPORB2    HNOB2
     C/COPY WNCPYSRC,FT0803C017
     C                     END
     C                     END
     C*
     C                     END
     C*
     C** Format Sender's Correspondent
     C*
     C                     MOVE *BLANKS   @KEY1
     C                     MOVELSNC1      @SLASH
     C*
     C/COPY WNCPYSRC,FT0803C018
     C           SNCT      IFNE *BLANKS
     C           SNCT      IFEQ 'R'
     C                     MOVEL@SCRT     HDSNC
     C                     END
     C*
     C           SNCT      IFEQ 'N'
     C                     MOVELPCCY      W8CCY
     C                     MOVEL@SCNN     HDSNC
     C                     END
     C*
     C           SNCT      IFEQ 'S'
     C           @SLASH    IFEQ '/'
     C                     MOVELSNC2      HDSNC
     C                     ELSE
     C                     MOVEL@SCSW     HDSNC
     C                     END
     C                     END
     C*
     C** Get Customer name and address
     C*
     C           SNCT      IFEQ 'A'
     C                     MOVELSNC1      HNSC1
     C                     MOVELSNC2      HNSC2
     C                     ELSE
     C*
     C** Get Customer BOJ code/Address
     C*
     C                     MOVE *BLANKS   XNAMDS
     C                     MOVELSNCT      W8TYPE
     C                     MOVE *BLANKS   W8LINS
     C           @SLASH    IFEQ '/'
     C                     MOVELSNC2      W8LINS
     C                     ELSE
     C                     MOVELSNC1      W8LINS
     C                     END
     C                     MOVELPCCY      W8CCY
     C*
     C                     EXSR #HGETA
     C*
     C           SNCT      IFEQ 'S'
     C           W8RTN     ANDNE*BLANKS
     C                     MOVEAHKA,1     HNSC1
     C                     ELSE
     C*
     C           @SLASH    IFEQ '/'
     C                     MOVELSNC1      HNSC1
     C                     MOVELXADD2     HNSC2
     C                     ELSE
     C                     MOVELXADD2     HNSC1
     C                     MOVELXADD3     HNSC2
     C                     END
     C                     END
     C*
     C                     END
     C                     END
     C/COPY WNCPYSRC,FT0803C019
     C*
     C** Format Receiver's Correspondent
     C*
     C           *IN29     IFEQ *OFF                                      CFT014
      *                                                                   CFT014
     C                     MOVE *BLANKS   @KEY1
     C                     MOVELRCO1      @SLASH
     C*
     C           RCRT      IFNE *BLANKS
     C           RCRT      IFEQ 'C'
     C                     MOVEL@RCCS     @KEY1
     C                     MOVEL@RCCS     HCRCO
     C                     CALL 'AOCUSTR0'#ACUST
     C           @RTCD     IFNE *BLANKS
     C           *LOCK     IN   LDA
     C                     Z-ADD37        DBASE            ***************
     C                     MOVEL@KEY1     DBKEY            *  DBERR 037  *
     C                     MOVEL'SDCUSTPD'DBFILE           ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
     C                     MOVELBBCSID    HDRCO
     C                     END
     C*
     C           RCRT      IFEQ 'S'
     C           @SLASH    IFEQ '/'
     C                     MOVELRCO2      HDRCO
     C                     ELSE
     C                     MOVEL@RCSW     HDRCO
     C                     END
     C                     END
     C*
     C           RCRT      IFEQ 'N'
     C                     MOVELSMCY      W8CCY
     C                     MOVEL@RCNN     HDRCO
     C                     END
     C*
     C           RCRT      IFEQ 'R'
     C                     MOVEL@RCRT     HDRCO
     C                     END
     C*
     C** Get Customer name and address
     C*
     C           RCRT      IFEQ 'A'
     C                     MOVELRCO1      HNRC1
     C                     MOVELRCO2      HNRC2
     C                     MOVE 'F'       HFRCO
     C                     ELSE
     C*
     C** Get Customer BOJ code/Address
     C*
     C                     MOVE *BLANKS   XNAMDS
     C                     MOVELRCRT      W8TYPE
     C                     MOVE *BLANKS   W8LINS
     C           @SLASH    IFEQ '/'
     C                     MOVELRCO2      W8LINS
     C                     ELSE
     C                     MOVELRCO1      W8LINS
     C                     END
     C                     MOVELSMCY      W8CCY
     C*
     C                     EXSR #HGETA
     C*
     C           RCRT      IFEQ 'S'
     C           W8RTN     ANDNE*BLANKS
     C                     MOVEAHKA,1     HNRC1
     C                     ELSE
     C*
     C           @SLASH    IFEQ '/'
     C                     MOVELRCO1      HNRC1
     C                     MOVELXADD2     HNRC2
     C                     ELSE
     C                     MOVELXADD2     HNRC1
     C                     MOVELXADD3     HNRC2
     C                     END
     C                     END
     C*
     C                     END
     C                     END
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           *IN29     IFEQ *ON                                       CFT014
      *                                                                   CFT014
     C                     MOVE *BLANKS   @KEY1                           CFT014
     C                     MOVELINRCO1    @SLASH                          CFT014
      *                                                                   CFT014
     C           INRCRT    IFNE *BLANKS                                   CFT014
      *                                                                   CFT014
     C           INRCRT    IFEQ 'C'                                       CFT014
     C                     MOVEL@RCCS     @KEY1                           CFT014
     C                     MOVEL@RCCS     HCRCO                           CFT014
     C                     CALL 'AOCUSTR0'#ACUST                          CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C           *LOCK     IN   LDA                                       CFT014
     C                     Z-ADD106       DBASE                           CFT014
     C                     MOVEL@KEY1     DBKEY                           CFT014
     C                     MOVEL'SDCUSTPD'DBFILE                          CFT014
     C                     OUT  LDA                                       CFT014
     C                     EXSR *PSSR                                     CFT014
     C                     ENDIF                                          CFT014
     C                     MOVELBBCSID    HDRCO                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           INRCRT    IFEQ 'S'                                       CFT014
     C                     MOVEL@RCSW     HDRCO                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           INRCRT    IFEQ 'N'                                       CFT014
     C                     MOVELSMCY      W8CCY                           CFT014
     C                     MOVEL@RCNN     HDRCO                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           INRCRT    IFEQ 'F'                                       CFT014
     C                     MOVEL@RCCN     HDRCO                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           INRCRT    IFEQ 'R'                                       CFT014
     C                     MOVEL@RCRT     HDRCO                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           CFT004    IFEQ 'Y'                                       CFT014
     C           INRCRT    ANDEQ'I'                                       CFT014
     C           34        SUBSTINRCO1:2  P@IBN                           CFT014
     C                     MOVE *BLANKS   DSSDY                           CFT014
     C                     CALL 'AOIBANR4'                                CFT014
     C                     PARM           @RTCD                           CFT014
     C                     PARM '*KEY   ' @OPTN                           CFT014
     C                     PARM           P@IBN                           CFT014
     C           WACCN     PARM           DSSDY                           CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C           *LOCK     IN   LDA                                       CFT014
     C                     Z-ADD107       DBASE                           CFT014
     C                     MOVELP@IBN     DBKEY                           CFT014
     C                     MOVEL'ACCNTL6' DBFILE                          CFT014
     C                     OUT  LDA                                       CFT014
     C                     EXSR *PSSR                                     CFT014
     C                     ENDIF                                          CFT014
     C                     MOVE *BLANKS   @KEY1                           CFT014
     C                     MOVELWWCNUM    @KEY1                           CFT014
     C                     CALL 'AOCUSTR0'#ACUST                          CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C           *LOCK     IN   LDA                                       CFT014
     C                     Z-ADD108       DBASE                           CFT014
     C                     MOVEL@KEY1     DBKEY                           CFT014
     C                     MOVEL'SDCUSTPD'DBFILE                          CFT014
     C                     OUT  LDA                                       CFT014
     C                     EXSR *PSSR                                     CFT014
     C                     ENDIF                                          CFT014
     C                     MOVELBBCSID    HDRCO                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Get Customer name and address.                                   CFT014
      *                                                                   CFT014
     C           INRCRT    IFEQ 'A'                                       CFT014
     C                     MOVELINRCO1    HNRC1                           CFT014
     C                     MOVELINRCO2    HNRC2                           CFT014
     C                     MOVE 'F'       HFRCO                           CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
      ** Get Customer BOJ code/Address.                                   CFT014
      *                                                                   CFT014
     C                     MOVE *BLANKS   XNAMDS                          CFT014
     C                     MOVELINRCRT    W8TYPE                          CFT014
     C                     MOVE *BLANKS   W8LINS                          CFT014
     C                     MOVELINRCO1    W8LINS                          CFT014
     C                     MOVELSMCY      W8CCY                           CFT014
      *                                                                   CFT014
     C                     EXSR #HGETA                                    CFT014
      *                                                                   CFT014
     C           INRCRT    IFEQ 'S'                                       CFT014
     C           W8RTN     ANDNE*BLANKS                                   CFT014
     C                     MOVEAHKA,1     HNRC1                           CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C           @SLASH    IFEQ '/'                                       CFT014
     C                     MOVELINRCO1    HNRC1                           CFT014
     C                     MOVELXADD2     HNRC2                           CFT014
     C                     ELSE                                           CFT014
     C                     MOVELXADD2     HNRC1                           CFT014
     C                     MOVELXADD3     HNRC2                           CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
     C*
     C** Format Intermediary Bank
     C*
     C                     MOVE *BLANKS   @KEY1
     C                     MOVELINB1      INB9
     C*
     C           INBT      IFNE *BLANKS
     C           INBT      IFEQ 'C'
     C           INBT      OREQ 'S'
     C                     MOVELINB1      @SLASH
     C           @SLASH    IFEQ '/'
     C                     MOVELINB2      INB9
     C                     END
     C                     END
     C           INBT      IFEQ 'C'
     C                     MOVEL@IBCS     @KEY1
     C                     MOVEL@IBCS     HCINB
     C                     CALL 'AOCUSTR0'#ACUST
     C           @RTCD     IFNE *BLANKS
     C           *LOCK     IN   LDA
     C                     Z-ADD38        DBASE            ***************
     C                     MOVEL@KEY1     DBKEY            *  DBERR 038  *
     C                     MOVEL'SDCUSTPD'DBFILE           ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
     C                     MOVELBBCSID    HDINB
     C                     END
     C*
     C           INBT      IFEQ 'S'
     C                     MOVEL@IBSW     HDINB
     C                     END
     C*
     C** Get Customer name and address
     C*
     C           INBT      IFEQ 'A'
     C                     MOVELINB1      HNIB1
     C                     MOVELINB2      HNIB2
     C                     MOVELINB3      HNIB3
     C                     MOVELINB4      HNIB4
     C                     MOVELINB5      HNIB5
     C                     MOVE 'F'       HFINB
     C                     ELSE
     C*
     C** Get Customer BOJ code/Address
     C*
     C                     MOVE *BLANKS   XNAMDS
     C                     MOVELINBT      W8TYPE
     C                     MOVE *BLANKS   W8LINS
     C                     MOVELINB9      W8LINS
     C*
     C                     EXSR #HGETA
     C*
     C           INBT      IFEQ 'S'
     C           W8RTN     ANDNE*BLANKS
     C                     MOVEAHKA,1     HNIB1
     C                     ELSE
     C*
     C           @SLASH    IFEQ '/'
     C                     MOVELINB1      HNIB1
     C                     MOVELXADD2     HNIB2
     C                     MOVELXADD3     HNIB3
     C                     MOVELXADD4     HNIB4
     C                     MOVELXADD5     HNIB5
     C                     ELSE
     C                     MOVELXADD2     HNIB1
     C                     MOVELXADD3     HNIB2
     C                     MOVELXADD4     HNIB3
     C                     MOVELXADD5     HNIB4
     C                     MOVEL*BLANKS   HNIB5
     C                     END
     C                     END
     C*
     C                     END
     C                     END
     C*
     C** Format Account with Bank
     C*
     C                     MOVE *BLANKS   @KEY1
     C** Set up field ACB9 only if outgoing payment.
     C           *IN29     IFEQ '0'
     C                     MOVELACB1      ACB9
     C                     END
     C*
     C           ACBT      IFNE *BLANKS
     C           ACBT      IFEQ 'C'
     C           ACBT      OREQ 'S'
     C                     MOVEL@ACCS     @SLASH
     C           @SLASH    IFEQ '/'
     C                     MOVELACB2      ACB9
     C                     END
     C                     END
     C           ACBT      IFEQ 'C'
     C                     MOVEL@ACCS     @KEY1
     C                     MOVEL@ACCS     HCACB
     C                     CALL 'AOCUSTR0'#ACUST
     C           @RTCD     IFNE *BLANKS
     C           *LOCK     IN   LDA
     C                     Z-ADD41        DBASE            ***************
     C                     MOVEL@KEY1     DBKEY            *  DBERR 041  *
     C                     MOVEL'SDCUSTPD'DBFILE           ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
     C                     MOVELBBCSID    HDACB
     C                     END
     C*
     C           ACBT      IFEQ 'S'
     C                     MOVEL@ACSW     HDACB
     C                     END
     C*
     C           ACBT      IFEQ 'R'
     C                     END
     C*
     C           ACBT      IFEQ 'N'
     C                     MOVELPCCY      W8CCY
     C                     MOVEL@ACNN     HDACB
     C                     END
     C*
     C           ACBT      IFEQ 'P'
     C** Set up the subfield for branch only if type is 'P' for partial
     C** A/c and not multibranching.
     C           MBIN      IFNE 'Y'
     C                     MOVE BJSBRC    @ACBB
     C                     ELSE
     C                     MOVE ACBB      @ACBB
     C                     END
     C                     MOVE @ACBB     HDACB
     C                     MOVELACBK      HDACB
     C                     END
     C*
     C** Get Customer name and address
     C*
     C           ACBT      IFEQ 'A'
     C                     MOVELACB1      HNAB1
     C                     MOVELACB2      HNAB2
     C                     MOVELACB3      HNAB3
     C                     MOVELACB4      HNAB4
     C                     MOVELACB5      HNAB5
     C                     MOVE 'Y'       HFACB
     C                     ELSE
     C*
     C           ACBT      IFNE 'P'
     C*
     C** Get Customer BOJ code/Address
     C*
     C                     MOVE *BLANKS   XNAMDS
     C                     MOVELACBT      W8TYPE
     C                     MOVE *BLANKS   W8LINS
     C                     MOVELACB9      W8LINS
     C                     MOVELPCCY      W8CCY
     C*
     C                     EXSR #HGETA
     C*
     C           ACBT      IFEQ 'S'
     C           W8RTN     ANDNE*BLANKS
     C                     MOVEAHKA,1     HNAB1
     C                     ELSE
     C*
     C           @SLASH    IFEQ '/'
     C                     MOVELACB1      HNAB1
     C                     MOVELXADD2     HNAB2
     C                     MOVELXADD3     HNAB3
     C                     MOVELXADD4     HNAB4
     C                     MOVELXADD5     HNAB5
     C                     ELSE
     C                     MOVELXADD2     HNAB1
     C                     MOVELXADD3     HNAB2
     C                     MOVELXADD4     HNAB3
     C                     MOVELXADD5     HNAB4
     C                     MOVEL*BLANKS   HNAB5
     C                     END
     C                     END
     C*
     C                     END
     C                     END
     C                     END
     C*
     C** Format Beneficiary Customer
     C*
     C                     MOVE *BLANKS   @KEY1
     C*
     C                     MOVELBNC1      BNC9
     C           BNCT      IFNE *BLANKS
     C           BNCT      IFEQ 'C'
     C           BNCT      OREQ 'S'
     C                     MOVELBNC1      @SLASH
     C           @SLASH    IFEQ '/'
     C                     MOVELBNC2      BNC9
     C                     ELSE
     C                     MOVELBNC1      BNC9
     C                     END
     C                     END
     C           BNCT      IFEQ 'C'
     C                     MOVEL@BNCS     @KEY1
     C                     MOVEL@BNCS     HCBNC
     C                     CALL 'AOCUSTR0'#ACUST
     C           @RTCD     IFNE *BLANKS
     C           *LOCK     IN   LDA
     C                     Z-ADD43        DBASE            ***************
     C                     MOVEL@KEY1     DBKEY            *  DBERR 043  *
     C                     MOVEL'SDCUSTPD'DBFILE           ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
     C                     MOVELBBCSID    HDBNC
     C                     END
     C*
     C           BNCT      IFEQ 'S'
     C                     MOVEL@BNSW     HDBNC
     C                     END
     C*
     C           BNCT      IFEQ 'R'
     C                     MOVEL@BNRT     HDBNC
     C                     END
     C*
     C           BNCT      IFEQ 'P'
     C** Set up the subfield for branch only if type is 'P' for partial
     C** A/c and not multibranching.
     C           MBIN      IFNE 'Y'
     C                     MOVE BJSBRC    @BNBR
     C                     END
     C**********           MOVEL@BNSW     HDBNC                                               CGL029
     C                     MOVEL@BNSW2    HDBNC                                               CGL029
     C                     MOVE @BNBR     HDBNC
     C                     END
     C*
     C           CFT004    IFEQ 'Y'                                       CFT004
     C           BNCT      IFEQ 'I'                                       CFT004
     C           34        SUBSTBNC9:2    P@IBN  34                       CFT004
     C                     MOVE *BLANKS   DSSDY                           CFT004
     C                     CALL 'AOIBANR4'                                CFT004
     C                     PARM           @RTCD                           CFT004
     C                     PARM '*KEY   ' @OPTN   7                       CFT004
     C                     PARM           P@IBN                           CFT004
     C           SDACCT    PARM           DSSDY                           CFT004
     C           @RTCD     IFNE *BLANKS                                   CFT004
     C           *LOCK     IN   LDA                                       CFT004
     C                     MOVE *BLANKS   DBKEY                           CFT004
     C                     Z-ADD73        DBASE            ***************CFT004
     C                     MOVEL'ACCNTL6' DBFILE           * DB ERROR 73 *CFT004
     C                     MOVELP@IBN     DBKEY            ***************CFT004
     C                     OUT  LDA                                       CFT004
     C                     EXSR *PSSR                                     CFT004
     C                     ENDIF                                          CFT004
     C                     MOVE *BLANKS   @KEY1                           CFT004
     C                     MOVELCNUM      @KEY1                           CFT004
     C                     CALL 'AOCUSTR0'#ACUST                          CFT004
     C           @RTCD     IFNE *BLANKS                                   CFT004
     C           *LOCK     IN   LDA                                       CFT004
     C                     Z-ADD74        DBASE            ***************CFT004
     C                     MOVEL@KEY1     DBKEY            *  DBERR 074  *CFT004
     C                     MOVEL'SDCUSTPD'DBFILE           ***************CFT004
     C                     OUT  LDA                                       CFT004
     C                     EXSR *PSSR                                     CFT004
     C                     END                                            CFT004
     C                     MOVELBBCSID    HDBNC                           CFT004
     C                     ENDIF                                          CFT004
     C                     ENDIF                                          CFT004
      *                                                                   CFT004
     C** Get Customer name and address
     C*
     C           BNCT      IFEQ 'A'
     C                     MOVELBNC1      HNBC1
     C                     MOVELBNC2      HNBC2
     C                     MOVELBNC3      HNBC3
     C                     MOVELBNC4      HNBC4
     C                     MOVELBNC5      HNBC5
     C                     MOVE 'F'       HFBNC
     C                     ELSE
     C*
     C** Get Customer BOJ code/Address
     C*
     C                     CLEARW8FT
     C                     MOVEL*BLANKS   W8STMT
     C                     MOVELPCCY      W8CCY
     C                     MOVEL##PGM     W8CPGM
     C                     MOVEL'*PRINT'  W8ACT
     C                     Z-ADD1         W8NLIN
     C*
     C                     MOVE *BLANKS   XNAMDS
     C                     MOVELBNCT      W8TYPE
     C                     MOVE *BLANKS   W8LINS
     C                     MOVELBNC9      W8LINS
     C*
     C                     EXSR #HGETA
     C*
     C           BNCT      IFEQ 'S'
     C           W8RTN     ANDNE*BLANKS
     C                     MOVEAHKA,1     HNBC1
     C                     ELSE
     C*
     C           @SLASH    IFEQ '/'
     C                     MOVELBNC1      HNBC1
     C                     MOVELXADD2     HNBC2
     C                     MOVELXADD3     HNBC3
     C                     MOVELXADD4     HNBC4
     C                     MOVELXADD5     HNBC5
     C                     ELSE
     C                     MOVELXADD2     HNBC1
     C                     MOVELXADD3     HNBC2
     C                     MOVELXADD4     HNBC3
     C                     MOVELXADD5     HNBC4
     C                     MOVEL*BLANKS   HNBC5
     C***                  END
     C                     END
     C                     END
     C*
     C                     END
     C                     END
     C*
     C** Format O.S.N. (If Non-autogen get from CB Ref else from MIR)
     C*
     C           *IN52     IFEQ '1'
     C*
     C           DNBC      IFNE 0
     C                     MOVELDNBC      HOSN
     C                     END
     C*
     C** Else, Autogen
     C*
     C                     ELSE
     C                     MOVE CRMIR     W0FLD6  6
     C                     MOVELW0FLD6    HOSN
     C                     END
      *                                                                   CFT014
     C           CEU006    IFEQ 'Y'                                       CFT014
     C           CFT014    OREQ 'Y'                                       CFT014
      *                                                                   CFT014
      ** Format Instructed Amount.                                        CFT014
      *                                                                   CFT014
     C           *IN29     IFEQ *OFF                                      CFT014
      *                                                                   CFT014
     C           PDCY      IFEQ *BLANKS                                   CFT014
     C                     MOVE *BLANKS   PIAMT                           CFT014
     C                     MOVE *BLANKS   PICCY                           CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C                     MOVELPDCY      @CCY                            CFT014
     C                     EXSR SRCURR                                    CFT014
     C                     Z-ADDPDAM      ZFLD15                          CFT014
     C                     Z-ADDA6NBDP    ZDECS                           CFT014
     C                     EXSR ZFRPED                                    CFT014
     C                     MOVE ZOUT22    PIAMT                           CFT014
     C                     MOVE PDCY      PICCY                           CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           *IN29     IFEQ *ON                                       CFT014
      *                                                                   CFT014
     C           NDCY      IFEQ *BLANKS                                   CFT014
     C                     MOVE *BLANKS   PIAMT                           CFT014
     C                     MOVE *BLANKS   PICCY                           CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C                     MOVELNDCY      @CCY                            CFT014
     C                     EXSR SRCURR                                    CFT014
     C                     Z-ADDNDAM      ZFLD15                          CFT014
     C                     Z-ADDA6NBDP    ZDECS                           CFT014
     C                     EXSR ZFRPED                                    CFT014
     C                     MOVE ZOUT22    PIAMT                           CFT014
     C                     MOVE NDCY      PICCY                           CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
      *                                                                   CFT014
     C           *IN29     IFEQ *OFF                                      CFT014
      *                                                                   CFT014
      ** Original Exchange Rate                                           CFT014
      *                                                                   CFT014
     C           OPOEXR    IFEQ *ZERO                                     CFT014
     C                     MOVE *OFF      *IN84                           CFT014
     C                     ELSE                                           CFT014
     C                     Z-ADDOPOEXR    POEXR                           CFT014
     C                     MOVE *ON       *IN84                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Bank Operation Code                                              CFT014
      *                                                                   CFT014
     C                     MOVE OPBOCD    PBOCD                           CFT014
      *                                                                   CFT014
      ** Transaction Type Code                                            CFT014
      *                                                                   CFT014
     C                     MOVE OPTTCD    PTTCD                           CFT014
      *                                                                   CFT014
      ** Instruction Code                                                 CFT014
      *                                                                   CFT014
     C                     MOVE OPICD1    PICD1                           CFT014
     C                     MOVE OPICD2    PICD2                           CFT014
     C                     MOVE OPICD3    PICD3                           CFT014
     C                     MOVE OPICD4    PICD4                           CFT014
     C                     MOVE OPICD5    PICD5                           CFT014
      *                                                                   CFT014
      ** Regulatory Reporting                                             CFT014
      *                                                                   CFT014
     C                     MOVE OPRRP1    PRRP1                           CFT014
     C                     MOVE OPRRP2    PRRP2                           CFT014
     C                     MOVE OPRRP3    PRRP3                           CFT014
      *                                                                   CFT014
      ** Receiver's Charges                                               CFT014
      *                                                                   CFT014
     C           OPRCRM    IFEQ *ZERO                                     CFT014
     C                     MOVE *BLANKS   PRCRM                           CFT014
     C                     MOVE *BLANKS   PRCCY                           CFT014
     C                     ELSE                                           CFT014
     C                     MOVELPCCY      @CCY                            CFT014
     C                     EXSR SRCURR                                    CFT014
     C                     Z-ADDA6NBDP    ZADEC                           CFT014
     C                     MOVE *BLANKS   ZFIELD                          CFT014
     C                     MOVE OPRCRM    ZFIELD                          CFT014
     C                     EXSR ZEDIT                                     CFT014
     C                     MOVE ZFIELD    PRCRM                           CFT014
     C                     MOVELPCCY      PRCCY                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Sender's Charges                                                 CFT014
      *                                                                   CFT014
     C           OPSCC1    IFEQ *BLANK                                    CFT014
     C                     MOVE *BLANKS   PSCH1                           CFT014
     C                     MOVE *BLANKS   PSCC1                           CFT014
     C                     ELSE                                           CFT014
     C                     MOVELOPSCC1    @CCY                            CFT014
     C                     EXSR SRCURR                                    CFT014
     C                     Z-ADDA6NBDP    ZADEC                           CFT014
     C                     MOVE *BLANKS   ZFIELD                          CFT014
     C                     MOVE OPSCH1    ZFIELD                          CFT014
     C                     EXSR ZEDIT                                     CFT014
     C                     MOVE ZFIELD    PSCH1                           CFT014
     C                     MOVELOPSCC1    PSCC1                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           OPSCC2    IFEQ *BLANK                                    CFT014
     C                     MOVE *BLANKS   PSCH2                           CFT014
     C                     MOVE *BLANKS   PSCC2                           CFT014
     C                     ELSE                                           CFT014
     C                     MOVELOPSCC2    @CCY                            CFT014
     C                     EXSR SRCURR                                    CFT014
     C                     Z-ADDA6NBDP    ZADEC                           CFT014
     C                     MOVE *BLANKS   ZFIELD                          CFT014
     C                     MOVE OPSCH2    ZFIELD                          CFT014
     C                     EXSR ZEDIT                                     CFT014
     C                     MOVE ZFIELD    PSCH2                           CFT014
     C                     MOVELOPSCC2    PSCC2                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           OPSCC3    IFEQ *BLANK                                    CFT014
     C                     MOVE *BLANKS   PSCH3                           CFT014
     C                     MOVE *BLANKS   PSCC3                           CFT014
     C                     ELSE                                           CFT014
     C                     MOVELOPSCC3    @CCY                            CFT014
     C                     EXSR SRCURR                                    CFT014
     C                     Z-ADDA6NBDP    ZADEC                           CFT014
     C                     MOVE *BLANKS   ZFIELD                          CFT014
     C                     MOVE OPSCH3    ZFIELD                          CFT014
     C                     EXSR ZEDIT                                     CFT014
     C                     MOVE ZFIELD    PSCH3                           CFT014
     C                     MOVELOPSCC3    PSCC3                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           OPSCC4    IFEQ *BLANK                                    CFT014
     C                     MOVE *BLANKS   PSCH4                           CFT014
     C                     MOVE *BLANKS   PSCC4                           CFT014
     C                     ELSE                                           CFT014
     C                     MOVELOPSCC4    @CCY                            CFT014
     C                     EXSR SRCURR                                    CFT014
     C                     Z-ADDA6NBDP    ZADEC                           CFT014
     C                     MOVE *BLANKS   ZFIELD                          CFT014
     C                     MOVE OPSCH4    ZFIELD                          CFT014
     C                     EXSR ZEDIT                                     CFT014
     C                     MOVE ZFIELD    PSCH4                           CFT014
     C                     MOVELOPSCC4    PSCC4                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           OPSCC5    IFEQ *BLANK                                    CFT014
     C                     MOVE *BLANKS   PSCH5                           CFT014
     C                     MOVE *BLANKS   PSCC5                           CFT014
     C                     ELSE                                           CFT014
     C                     MOVELOPSCC5    @CCY                            CFT014
     C                     EXSR SRCURR                                    CFT014
     C                     Z-ADDA6NBDP    ZADEC                           CFT014
     C                     MOVE *BLANKS   ZFIELD                          CFT014
     C                     MOVE OPSCH5    ZFIELD                          CFT014
     C                     EXSR ZEDIT                                     CFT014
     C                     MOVE ZFIELD    PSCH5                           CFT014
     C                     MOVELOPSCC5    PSCC5                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Third Reimbursement Institution                                  CFT014
      *                                                                   CFT014
     C                     MOVE *BLANKS   @KEY1                           CFT014
     C                     MOVELOPTRI1    @SLASH                          CFT014
      *                                                                   CFT014
     C           OPTRIT    IFNE *BLANKS                                   CFT014
      *                                                                   CFT014
     C           OPTRIT    IFEQ 'C'                                       CFT014
     C                     MOVELWTRCUS    @KEY1                           CFT014
     C                     MOVELWTRCUS    HCTRM                           CFT014
     C                     CALL 'AOCUSTR0'#ACUST                          CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C           *LOCK     IN   LDA                                       CFT014
     C                     Z-ADD112       DBASE                           CFT014
     C                     MOVEL@KEY1     DBKEY                           CFT014
     C                     MOVEL'SDCUSTPD'DBFILE                          CFT014
     C                     OUT  LDA                                       CFT014
     C                     EXSR *PSSR                                     CFT014
     C                     ENDIF                                          CFT014
     C                     MOVELBBCSID    HDTRM                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           OPTRIT    IFEQ 'S'                                       CFT014
     C                     MOVELWTRSID    HDTRM                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           CFT004    IFEQ 'Y'                                       CFT014
     C           OPTRIT    ANDEQ'I'                                       CFT014
     C           34        SUBSTOPTRI1:2  P@IBN                           CFT014
     C                     MOVE *BLANKS   DSSDY                           CFT014
     C                     CALL 'AOIBANR4'                                CFT014
     C                     PARM           @RTCD                           CFT014
     C                     PARM '*KEY   ' @OPTN                           CFT014
     C                     PARM           P@IBN                           CFT014
     C           WACCN     PARM           DSSDY                           CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C           *LOCK     IN   LDA                                       CFT014
     C                     Z-ADD113       DBASE                           CFT014
     C                     MOVELP@IBN     DBKEY                           CFT014
     C                     MOVEL'ACCNTL6' DBFILE                          CFT014
     C                     OUT  LDA                                       CFT014
     C                     EXSR *PSSR                                     CFT014
     C                     ENDIF                                          CFT014
     C                     MOVE *BLANKS   @KEY1                           CFT014
     C                     MOVELWWCNUM    @KEY1                           CFT014
     C                     CALL 'AOCUSTR0'#ACUST                          CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C           *LOCK     IN   LDA                                       CFT014
     C                     Z-ADD114       DBASE                           CFT014
     C                     MOVEL@KEY1     DBKEY                           CFT014
     C                     MOVEL'SDCUSTPD'DBFILE                          CFT014
     C                     OUT  LDA                                       CFT014
     C                     EXSR *PSSR                                     CFT014
     C                     ENDIF                                          CFT014
     C                     MOVELBBCSID    HDTRM                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Get Customer name and address.                                   CFT014
      *                                                                   CFT014
     C           OPTRIT    IFEQ 'A'                                       CFT014
     C                     MOVELOPTRI1    HNTR1                           CFT014
     C                     MOVELOPTRI2    HNTR2                           CFT014
     C                     MOVE 'F'       HFTRM                           CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
      ** Get Customer BOJ code/Address.                                   CFT014
      *                                                                   CFT014
     C                     MOVE *BLANKS   XNAMDS                          CFT014
     C                     MOVELOPTRIT    W8TYPE                          CFT014
     C                     MOVE *BLANKS   W8LINS                          CFT014
     C                     MOVELOPTRI1    W8LINS                          CFT014
     C                     MOVELSMCY      W8CCY                           CFT014
      *                                                                   CFT014
     C                     EXSR #HGETA                                    CFT014
      *                                                                   CFT014
     C           OPTRIT    IFEQ 'S'                                       CFT014
     C           W8RTN     ANDNE*BLANKS                                   CFT014
     C                     MOVEAHKA,1     HNTR1                           CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C           @SLASH    IFEQ '/'                                       CFT014
     C                     MOVELOPTRI1    HNTR1                           CFT014
     C                     MOVELXADD2     HNTR2                           CFT014
     C                     ELSE                                           CFT014
     C                     MOVELXADD2     HNTR1                           CFT014
     C                     MOVELXADD3     HNTR2                           CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           *IN29     IFEQ *ON                                       CFT014
      *                                                                   CFT014
      ** Original Exchange Rate                                           CFT014
      *                                                                   CFT014
     C           INOEXR    IFEQ *ZERO                                     CFT014
     C                     MOVE *OFF      *IN84                           CFT014
     C                     ELSE                                           CFT014
     C                     Z-ADDINOEXR    POEXR                           CFT014
     C                     MOVE *ON       *IN84                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Bank Operation Code                                              CFT014
      *                                                                   CFT014
     C                     MOVE INBOCD    PBOCD                           CFT014
      *                                                                   CFT014
      ** Transaction Type Code                                            CFT014
      *                                                                   CFT014
     C                     MOVE INTTCD    PTTCD                           CFT014
      *                                                                   CFT014
      ** Instruction Code                                                 CFT014
      *                                                                   CFT014
     C                     MOVE INICD1    PICD1                           CFT014
     C                     MOVE INICD2    PICD2                           CFT014
     C                     MOVE INICD3    PICD3                           CFT014
     C                     MOVE INICD4    PICD4                           CFT014
     C                     MOVE INICD5    PICD5                           CFT014
      *                                                                   CFT014
      ** Regulatory Reporting                                             CFT014
      *                                                                   CFT014
     C                     MOVE INRRP1    PRRP1                           CFT014
     C                     MOVE INRRP2    PRRP2                           CFT014
     C                     MOVE INRRP3    PRRP3                           CFT014
      *                                                                   CFT014
      ** Receiver's Charges                                               CFT014
      *                                                                   CFT014
     C           INRCRM    IFEQ *ZERO                                     CFT014
     C                     MOVE *BLANKS   PRCRM                           CFT014
     C                     MOVE *BLANKS   PRCCY                           CFT014
     C                     ELSE                                           CFT014
     C                     MOVELSMCY      @CCY                            CFT014
     C                     EXSR SRCURR                                    CFT014
     C                     Z-ADDA6NBDP    ZADEC                           CFT014
     C                     MOVE *BLANKS   ZFIELD                          CFT014
     C                     MOVE INRCRM    ZFIELD                          CFT014
     C                     EXSR ZEDIT                                     CFT014
     C                     MOVE ZFIELD    PRCRM                           CFT014
     C                     MOVELSMCY      PRCCY                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Sender's Charges                                                 CFT014
      *                                                                   CFT014
     C           INSCY1    IFEQ *BLANK                                    CFT014
     C                     MOVE *BLANKS   PSCH1                           CFT014
     C                     MOVE *BLANKS   PSCC1                           CFT014
     C                     ELSE                                           CFT014
     C                     MOVE INSCY1    @CCY                            CFT014
     C                     EXSR SRCURR                                    CFT014
     C                     Z-ADDA6NBDP    ZADEC                           CFT014
     C                     MOVE *BLANKS   ZFIELD                          CFT014
     C                     MOVE INSCH1    ZFIELD                          CFT014
     C                     EXSR ZEDIT                                     CFT014
     C                     MOVE ZFIELD    PSCH1                           CFT014
     C                     MOVE INSCY1    PSCC1                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           INSCY2    IFEQ *BLANK                                    CFT014
     C                     MOVE *BLANKS   PSCH2                           CFT014
     C                     MOVE *BLANKS   PSCC2                           CFT014
     C                     ELSE                                           CFT014
     C                     MOVE INSCY2    @CCY                            CFT014
     C                     EXSR SRCURR                                    CFT014
     C                     Z-ADDA6NBDP    ZADEC                           CFT014
     C                     MOVE *BLANKS   ZFIELD                          CFT014
     C                     MOVE INSCH2    ZFIELD                          CFT014
     C                     EXSR ZEDIT                                     CFT014
     C                     MOVE ZFIELD    PSCH2                           CFT014
     C                     MOVE INSCY2    PSCC2                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           INSCY3    IFEQ *BLANK                                    CFT014
     C                     MOVE *BLANKS   PSCH3                           CFT014
     C                     MOVE *BLANKS   PSCC3                           CFT014
     C                     ELSE                                           CFT014
     C                     MOVE INSCY3    @CCY                            CFT014
     C                     EXSR SRCURR                                    CFT014
     C                     Z-ADDA6NBDP    ZADEC                           CFT014
     C                     MOVE *BLANKS   ZFIELD                          CFT014
     C                     MOVE INSCH3    ZFIELD                          CFT014
     C                     EXSR ZEDIT                                     CFT014
     C                     MOVE ZFIELD    PSCH3                           CFT014
     C                     MOVE INSCY3    PSCC3                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           INSCY4    IFEQ *BLANK                                    CFT014
     C                     MOVE *BLANKS   PSCH4                           CFT014
     C                     MOVE *BLANKS   PSCC4                           CFT014
     C                     ELSE                                           CFT014
     C                     MOVE INSCY4    @CCY                            CFT014
     C                     EXSR SRCURR                                    CFT014
     C                     Z-ADDA6NBDP    ZADEC                           CFT014
     C                     MOVE *BLANKS   ZFIELD                          CFT014
     C                     MOVE INSCH4    ZFIELD                          CFT014
     C                     EXSR ZEDIT                                     CFT014
     C                     MOVE ZFIELD    PSCH4                           CFT014
     C                     MOVE INSCY4    PSCC4                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           INSCY5    IFEQ *BLANK                                    CFT014
     C                     MOVE *BLANKS   PSCH5                           CFT014
     C                     MOVE *BLANKS   PSCC5                           CFT014
     C                     ELSE                                           CFT014
     C                     MOVE INSCY5    @CCY                            CFT014
     C                     EXSR SRCURR                                    CFT014
     C                     Z-ADDA6NBDP    ZADEC                           CFT014
     C                     MOVE *BLANKS   ZFIELD                          CFT014
     C                     MOVE INSCH5    ZFIELD                          CFT014
     C                     EXSR ZEDIT                                     CFT014
     C                     MOVE ZFIELD    PSCH5                           CFT014
     C                     MOVE INSCY5    PSCC5                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Third Reimbursement Institution                                  CFT014
      *                                                                   CFT014
     C                     MOVE INTRIB    HNTR1                           CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
     C/COPY WNCPYSRC,FT0803C022
     C*
     C           CSW209    IFEQ 'Y'                                                           CSW209
     C                     MOVELPREF      DHPREF 15                                           CSW209
     C                     EXSR SRSWF9                                                        CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CER030
     C           CER031    IFEQ 'Y'                                                           CER030
      *                                                                                       CER030
     C           *IN29     IFEQ *OFF                                                          CER030
      *                                                                                       CER030
      ** Write Outgoing Payment                                                               CER030
      *                                                                                       CER030
     C                     EXSR POPONR                                                        CER030
      *                                                                                       CER030
     C                     ELSE                                                               CER030
      *                                                                                       CER030
      ** Write Incoming Payment                                                               CER030
      *                                                                                       CER030
     C                     EXSR POPINR                                                        CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      ** Write Transaction Type                                                               CER030
      *                                                                                       CER030
     C           CER030    IFEQ 'Y'                                                           CER030
     C           CGL013    OREQ 'Y'                                                           CER030
     C                     EXSR POPRTY                                                        CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDSR
     C*
     C/EJECT
     C*****************************************************************
     C*   PAYA     : Payments Authorisation                           *
     C*   Called by: SYSL,INB,ALLB                                    *
     C*   Calls    : GENO - Generate outgoing payments                *
     C*****************************************************************
     C           PAYA      BEGSR
     C*
     C           *IN31     IFEQ '0'                        ** IF01
     C           *IN32     ANDEQ'0'
     C           *IN33     ANDEQ'0'
     C*
     C** If outgoing payment - update OTPAY , incomimg - update INPAY
     C*
     C           *IN29     IFEQ '0'                        ** IF02
     C*
     C           PREF      CHAINOTPAY                63
     C*
     C           *IN63     IFEQ '1'                        ** IF03
     C                     Z-ADD44        DBASE            ***************
     C                     MOVEL'OTPAY'   DBFILE           * DBERR 044   *
     C                     MOVELPREF      DBKEY            ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END                             ** END03
     C*
     C                     MOVELWSUSR     AUP1
     C                     MOVE 'Y'       AUIN
     C                     Z-ADDRUND      LCD
     C                     TIME           LCHT
     C/COPY WNCPYSRC,FT0803C023
     C                     EXCPTOTPAYF
     C*
     C           *IN65     IFEQ '1'                        ** IF03
     C                     Z-ADD45        DBASE            ***************
     C                     MOVEL'OTPAY'   DBFILE           * DBERR 045   *
     C                     MOVEL'WRITEERR'DBKEY            ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END                             ** END03
     C*
     C           PREF      CHAINOTPAYXL0             63
     C*
     C           *IN63     IFEQ '1'                        ** IF03
     C                     Z-ADD46        DBASE            ***************
     C                     MOVEL'OTPAYXL0'DBFILE           * DBERR 046   *
     C                     MOVELPREF      DBKEY            ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END                             ** END03
     C*
     C                     MOVE *BLANKS   OPBANO
     C                     MOVE *BLANKS   OPRUSR
     C                     MOVE *BLANKS   OPWSID
     C                     MOVELRUNA      OPRDAT
     C                     UPDATOTPAYXDF               65
     C*
     C           *IN65     IFEQ '1'                        ** IF03
     C                     Z-ADD47        DBASE            ***************
     C                     MOVEL'OTPAYXL0'DBFILE           * DBERR 047   *
     C                     MOVEL'WRITEERR'DBKEY            ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END                             ** END03
      *
      * Update Incoming Message FT Transaction Status File record
      * if payment created from Incoming Electronic Message
      *
     C           OPMSGR    IFNE 0                          ** IF03
      *
     C                     MOVEL'OP'      ##OPIN
      *
     C                     MOVEL'MIN0032' W0FLAG
     C                     MOVEL'MIN0194' W0LMSG
      *
     C                     EXSR SRINFT
      *
     C                     END                             ** END03
     C*
     C                     END                             ** END02
     C*
     C           *IN29     IFEQ '1'                        ** IF02
     C*
     C           PREF      CHAININPAY                64
     C*
     C           *IN64     IFEQ '1'                        ** IF03
     C                     Z-ADD48        DBASE            ***************
     C                     MOVEL'INPAY'   DBFILE           * DBERR 048   *
     C                     MOVELPREF      DBKEY            ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END                             ** END03
     C*
     C                     MOVELWSUSR     AUP1
     C                     MOVE 'Y'       AUIN
     C                     Z-ADDRUND      LCD
     C                     TIME           LCHT
     C/COPY WNCPYSRC,FT0803C024
     C                     EXCPTINPAYF
     C*
     C           *IN66     IFEQ '1'                        ** IF03
     C                     Z-ADD49        DBASE            ***************
     C                     MOVEL'INPAY'   DBFILE           * DBERR 049   *
     C                     MOVEL'WRITEERR'DBKEY            ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END                             ** END03
     C*
     C           PREF      CHAININPAYXL0             64
     C*
     C           *IN64     IFEQ '1'                        ** IF03
     C                     Z-ADD50        DBASE            ***************
     C                     MOVEL'INPAYXL0'DBFILE           * DBERR 050   *
     C                     MOVELPREF      DBKEY            ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END                             ** END03
     C*
     C                     MOVE *BLANKS   INBANO
     C                     MOVE *BLANKS   INRUSR
     C                     MOVE *BLANKS   INWSID
     C                     MOVELRUNA      INRDAT
     C                     UPDATINPAYXDF               66
     C*
     C           *IN66     IFEQ '1'                        ** IF03
     C                     Z-ADD51        DBASE            ***************
     C                     MOVEL'INPAYXL0'DBFILE           * DBERR 051   *
     C                     MOVEL'WRITEERR'DBKEY            ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END                             ** END03
      *
      * Update Incoming Message FT Transaction Status File record
      * if payment created from Incoming Electronic Message
      *
     C           INMSGR    IFNE 0                          ** IF03
      *
     C                     MOVEL'IN'      ##OPIN  2
      *
     C                     MOVEL'MIN0032' W0FLAG  7
     C                     MOVEL'MIN0054' W0LMSG  7
      *
     C                     EXSR SRINFT
      *
     C                     END                             ** END03
      *
      * Generate Outgoing Payment if Generate Outgoing Payment
      * indicator is equal to 'Y'.
      *
     C           OPIN      IFEQ 'Y'                        ** IF03
      *
      ** Save branch code for the generation of OP from IN payment.
      *
     C                     MOVE BRCA      IBRC    3
      *
     C           ACBT      IFNE *BLANKS                    ** IF04
      *
     C           ACBT      IFEQ 'N'                        ** IF05
     C                     MOVELACBK      WSKY1   2
     C*
     C** Call to access pgm for nostro details
     C*
     C                     CALL 'AONOSTR0'
     C                     PARM '*DBERR ' @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM *BLANKS   @CUST   6
     C                     PARM PCCY      @CCY    3
     C**********           PARM *BLANKS   @ACCD   4                                           CGL029
     C                     PARM *BLANKS   @ACCD                                               CGL029
     C                     PARM *BLANKS   @ACSN   2
     C                     PARM WSKY1     @NONB   2
     C                     PARM *BLANKS   @BRCD   3
     C                     PARM *BLANKS   @CSSN  10
     C                     PARM *BLANKS   @PNOI   1
     C           SDNOST    PARM SDNOST    DSFDY
     C*
     C           @RTCD     IFNE *BLANKS                    ** IF06
     C                     Z-ADD52        DBASE            ***************
     C                     MOVEL'SDNOSTPD'DBFILE           * DBERR 052   *
     C                     MOVELWSKY1     DBKEY            ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END                             ** END06
     C*
     C                     MOVEL*BLANK    @KEY1                                               CFT003
     C                     MOVELA7CUST    @KEY1
     C                     MOVE A7CUST    CNUM
     C                     MOVE A7ACCD    ACOD
     C                     MOVE A7ACSN    ACSQ
     C                     MOVE A7BRCD    BRCA
     C                     END                             ** END05
      *
     C           ACBT      IFEQ 'R'                        ** IF05
     C                     MOVELACBK      @ACNO  10
      *
     C                     CALL 'AOACCTR0'
     C                     PARM '*BLANKS' @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM @ACNO     @RETL  10
     C                     PARM *BLANKS   @CNNM   6
     C                     PARM *BLANKS   @CUCD   3
     C**********           PARM *BLANKS   @ACCD   4                                           CGL029
     C                     PARM *BLANKS   @ACCD                                               CGL029
     C                     PARM *BLANKS   @ACSQ   2
     C                     PARM *BLANKS   @BRHC   3
     C           SDACCT    PARM SDACCT    DSSDY
     C*
     C           @RTCD     IFNE *BLANKS                    ** IF06
     C                     Z-ADD53        DBASE            ***************
     C                     MOVEL'ACCNT'   DBFILE           * DBERR 053   *
     C                     MOVEL@ACNO     DBKEY            ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END                             ** END06
      *
     C                     MOVEL*BLANK    @KEY1                                               CFT003
     C                     MOVELCNUM      @KEY1
     C                     END                             ** END05
      *
     C           ACBT      IFEQ 'P'                        ** IF05
     C           ACBT      OREQ 'P'
     C                     MOVELACBK      @WRK6   6
     C                     MOVEL*BLANK    @KEY1                                               CFT003
     C                     MOVEL@WRK6     @KEY1
     C                     END                             ** END05
      *
     C           ACBT      IFNE 'S'                        ** IF05
     C*
     C** Call to access pgm for Customer details
     C*
     C                     CALL 'AOCUSTR0'#ACUST
      *
     C           @RTCD     IFNE *BLANKS                    ** IF06
     C                     Z-ADD54        DBASE            ***************
     C                     MOVEL'SDCUSTPD'DBFILE           * DBERR 054   *
     C                     MOVEL@KEY1     DBKEY            ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END                             ** END06
      *
      ** Save SWIFT Id to be used GENO/SR.
      *
     C                     MOVE BBCSID    OTCSID 12
      *
     C                     END                             ** END05
      *
     C                     END                             ** END04
      *
     C                     EXSR GENO
      *
     C                     END                             ** END03
     C*
     C                     END                             ** END02
     C*
     C                     ELSE                            ** X01
     C*
     C           *IN29     IFEQ '0'                        ** IF02
     C*
     C           PREF      CHAINOTPAYXL0             63
     C*
     C           *IN63     IFEQ '1'                        ** IF03
     C                     Z-ADD55        DBASE            ***************
     C                     MOVEL'OTPAYXL0'DBFILE           * DBERR 055   *
     C                     MOVELPREF      DBKEY            ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END                             ** END03
     C*
     C                     MOVE *BLANKS   OPBANO
     C                     MOVE *BLANKS   OPRUSR
     C                     MOVE *BLANKS   OPWSID
     C                     UPDATOTPAYXDF               65
     C*
     C           *IN65     IFEQ '1'                        ** IF03
     C                     Z-ADD56        DBASE            ***************
     C                     MOVEL'OTPAYXL0'DBFILE           * DBERR 056   *
     C                     MOVEL'WRITEERR'DBKEY            ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END                             ** END03
      *
      * Update Incoming Message FT Transaction Status File record
      * if payment created from Incoming Electronic Message
      *
     C           OPMSGR    IFNE 0                          ** IF03
      *
     C                     MOVEL'OP'      ##OPIN
      *
     C                     MOVEL'MIN0030' W0FLAG
     C                     MOVEL'MIN0195' W0LMSG
      *
     C                     EXSR SRINFT
      *
     C                     END                             ** END03
     C*
     C                     END                             ** END02
     C*
     C           *IN29     IFEQ '1'                        ** IF02
     C*
     C           PREF      CHAININPAYXL0             64
     C*
     C           *IN64     IFEQ '1'                        ** IF03
     C                     Z-ADD57        DBASE            ***************
     C                     MOVEL'INPAYXL0'DBFILE           * DBERR 057   *
     C                     MOVELPREF      DBKEY            ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END                             ** END03
     C*
     C                     MOVE *BLANKS   INBANO
     C                     MOVE *BLANKS   INRUSR
     C                     MOVE *BLANKS   INWSID
     C                     UPDATINPAYXDF               66
     C*
     C           *IN66     IFEQ '1'                        ** IF03
     C                     Z-ADD58        DBASE            ***************
     C                     MOVEL'INPAYXL0'DBFILE           * DBERR 058   *
     C                     MOVEL'WRITEERR'DBKEY            ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END                             ** END03
      *
      * Update Incoming Message FT Transaction Status File record
      * if payment created from Incoming Electronic Message
      *
     C           INMSGR    IFNE 0                          ** IF03
      *
     C                     MOVEL'IN'      ##OPIN  2
      *
     C                     MOVEL'MIN0030' W0FLAG
     C                     MOVEL'MIN0055' W0LMSG
      *
     C                     EXSR SRINFT
      *
     C                     END                             ** END03
     C*
     C                     END                             ** END02
     C*
     C                     END                             ** END01
      *                                                                                       CRE020
      ** If CRE020 is installed, call Settlement Advice Subroutine                            CRE020
      *                                                                                       CRE020
     C           CRE020    IFEQ 'Y'                                                           CRE020
     C           PSVAL1    ANDEQ'Y'                                                           CRE020
     C           *IN29     ANDEQ*OFF                                                          CRE020
     C           CRE020    OREQ 'Y'                                                           CRE020
     C           PSVAL2    ANDEQ'Y'                                                           CRE020
     C           *IN29     ANDEQ*ON                                                           CRE020
      *                                                                                       CRE020
     C                     EXSR SRADVC                                                        CRE020
      *                                                                                       CRE020
     C                     ENDIF                                                              CRE020
     C*
     C                     ENDSR
     C*
     C/EJECT
     C*****************************************************************
     C*   GENO     : Generate Outgoing Payments from Incoming         *
     C*              note : this subroutine is based on FT0060        *
     C*                     Subroutine WOTPAY                         *
     C*   Called by: PAYA - Payments Authorisation                    *
     C*   Calls    : None                                             *
     C*****************************************************************
     C           GENO      BEGSR
     C*
     C                     MOVE PREF      OXPREF
     C                     MOVE 'D'       RECI
     C                     MOVE 'P'       @PAYM
     C*
     C                     MOVE RUND      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZYEAR     @YY
     C                     MOVE ZMTH      @MM
     C                     MOVE ZDAY      @DD
     C*
     C/COPY WNCPYSRC,FTH00088
     C           CFT151    IFEQ 'N'                                                           CFT151
     C           *LOCK     IN   OTPAYD
     C*****                Z-ADDOSQNM     @PSEQ                                               CFT151
     C*****                ADD  1         OSQNM                                               CFT151
     C                     MOVELWOTSQ     @PSEQ                                               CFT151
     C                     ADD  1         WOTSQ                                               CFT151
     C                     OUT  OTPAYD
     C                     ELSE                                                               CFT151
     C                     CALL 'FT000328'                                                    CFT151
     C                     PARM           PRTCD                                               CFT151
     C                     PARM 'OT'      W@OTIN  2                                           CFT151
     C                     PARM 'A'       WCALC   1                                           CFT151
     C                     PARM 'Y'       WUPD    1                                           CFT151
     C                     PARM           @PSEQ                                               CFT151
     C                     PARM           WNEWSQ  4                                           CFT151
     C                     ENDIF                                                              CFT151
     C/COPY WNCPYSRC,FTH00089
     C*
     C                     MOVE 'OP'      @PYTP
     C                     MOVE 'OP'      PYTP
     C                     Z-ADD0         @STMT
     C/COPY WNCPYSRC,FTH00090
     C                     MOVE @PREF     PREF
     C/COPY WNCPYSRC,FTH00091
     C                     MOVE *BLANKS   PYST
     C*
     C                     MOVE *BLANKS   DST1
     C                     MOVE *BLANKS   DST2
     C                     MOVE *BLANKS   DST3
     C                     MOVE *BLANKS   DST4
     C*
     C                     MOVE *BLANKS   ACB1
     C                     MOVE *BLANKS   ACB2
     C                     MOVE *BLANKS   ACB3
     C                     MOVE *BLANKS   ACB4
     C                     MOVE *BLANKS   ACB5
     C*
     C* DESTINATION
     C*
     C* Destination: if Intermediary Bank is blank, use 'A/c with
     C* Institution' details, otherwise use intermediary bank details
     C*
     C           INBT      IFEQ *BLANK                     ** IFA
     C*
     C* If Account with Institution on screen is a Nostro or Retail
     C* account then use the screen fields to fill the Destination.
     C* Thus, the field 57 (Account With Institution) that was obtained
     C* from the Incoming Swift msg is not used for the Outgoing pay't.
     C*
     C* If 'Account with Institution' is nostro convert to full nostro
     C*
     C           ACBT      IFEQ 'N'
     C                     MOVELACBK      W0FLD2  2
     C                     MOVELPCCY      W0FLD5  5
     C                     MOVE W0FLD2    W0FLD5
     C                     MOVELW0FLD5    DST1
     C                     MOVE 'F'       DSTT
     C                     GOTO ACB01
     C                     END
     C*
     C* If Retail, then move in first 10 characters
     C*
     C           ACBT      IFEQ 'R'
     C                     MOVE 'R'       DSTT
     C                     MOVELACBK      W0FL10 10
     C                     MOVELW0FL10    DST1
     C                     GOTO ACB01
     C                     END
      *
      * If Account with Institution on screen is NOT a Nostro or Retail
      * AND field 57 is held on the Incoming Payment, use it for the
      * Destination
      *
     C           INACBT    IFNE *BLANKS
      *
     C           INACBT    IFEQ 'S'
     C                     MOVEL'S'       DSTT
     C                     ELSE
     C                     MOVEL'A'       DSTT
     C                     END
      *
     C                     MOVELINACB1    DST1
     C                     MOVELINACB2    DST2
     C                     MOVELINACB3    DST3
     C                     MOVELINACB4    DST4
     C                     GOTO ACB01
      *
     C                     END
      *
      * If field 57 is NOT held on the Incoming Payment then use the
      * Account With Institution screen field to determine Destination
      *
     C*
     C* If Partial Account convert to A/C identifier
     C*
     C           ACBT      IFEQ 'P'
     C                     MOVE @ACCN     @DSCN
     C                     MOVE PCCY      @DSCY
     C                     MOVE @ACAC     @DSAC
     C                     MOVE @ACAS     @DSAS
     C                     MOVE ACBB      @DSBR
     C                     MOVE 'G'       DSTT
     C                     GOTO ACB01
     C                     END
     C*
     C           ACBT      IFEQ 'C'
     C                     MOVE 'C'       DSTT
     C                     MOVELACBK      W0FLD6  6
     C                     MOVELW0FLD6    DST1
     C                     GOTO ACB01
     C                     END
     C*
     C           ACBT      IFEQ 'S'
     C                     MOVE 'S'       DSTT
     C                     MOVELACBK      W0FL12 12
     C                     MOVELW0FL12    DST1
     C                     GOTO ACB01
     C                     END
     C*
     C           ACB01     TAG
     C*
     C** Blankout ACBT to avoid writing to OTPAYDD
     C*
     C                     MOVE *BLANKS   ACBT
      *
     C                     ELSE
     C*
     C* Intermediary Bank Entered
     C*
     C           INBT      IFEQ 'S'
     C                     MOVELINB1      DST1
     C                     MOVE 'S'       DSTT
     C                     ELSE
     C                     MOVE INBT      DSTT
     C                     MOVE INB1      DST1
     C                     MOVE INB2      DST2
     C                     MOVE INB3      DST3
     C                     MOVE INB4      DST4
     C                     END
     C*
     C**  ACCOUNT WITH BANK (only filled if Intermediary Bank exists)
     C*
     C**  If 'Account with bank' is a nostro, retail or partial account
     C**  convert to a SWIFT Id, or a full name and address. This is
     C**  because outgoing payments maintenance only allows a/c with
     C**  bank to be a SWIFT Id or full name and address.
     C*
     C**  Only do this for a partial account if the Incoming Payment
     C**  does not have a field 57 'Account with Institution' address
     C**  from the Swift message.
     C*
      *   N.B If Intermediary Bank is blank then ACBT was also set to
      *       blank when the Destination field was filled.
      *
     C           ACBT      IFEQ 'N'                        ** IF01
     C           ACBT      OREQ 'R'
     C           ACBT      OREQ 'P'
     C           INACBT    ANDEQ*BLANKS
      *
      ** If SWIFT Id for nostro then put it in, else put in full name
      ** and address.
      *
     C           OTCSID    IFNE *BLANKS                    ** IF02
     C                     MOVELOTCSID    ACB1
     C                     MOVE 'S'       ACBT
     C                     ELSE                            ** X002
     C*
     C                     CALL 'AOCUSTR0'#ACUST
      *
     C           @RTCD     IFNE *BLANKS
     C                     Z-ADD59        DBASE            ***************
     C                     MOVEL'SDCUSTPD'DBFILE           * DBERR 059   *
     C                     MOVEL@KEY1     DBKEY            ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
     C*
     C                     MOVELBBCNA1    ACB1
     C                     MOVE BBCNA2    ACB2
     C                     MOVE BBCNA3    ACB3
     C                     MOVE BBCNA4    ACB4
     C                     MOVE 'A'       ACBT
     C                     END                             ** END02
     C*
     C                     ELSE                            ** X01
      *
      * If Account with Institution on screen is NOT a Nostro or
      * Retail or it is a partial account but field 57 exists then
      * fill the Account With Bank using field 57 details
      *
     C           INACBT    IFNE *BLANKS                    ** IF002
      *
     C           INACBT    IFEQ 'S'                        ** IF003
     C                     MOVEL'S'       ACBT
     C                     ELSE                            ** X003
     C                     MOVEL'A'       ACBT
     C                     END                             ** E003
      *
     C                     MOVELINACB1    ACB1
     C                     MOVELINACB2    ACB2
     C                     MOVELINACB3    ACB3
     C                     MOVELINACB4    ACB4
     C                     MOVELINACB5    ACB5
     C*
     C                     END                             ** E002
     C*
     C                     END                             ** E001
     C*
     C                     END                             ** ENDA
     C*
     C**           ************************************
     C*
     C                     MOVE *BLANK    SNCT
     C***********          Z-ADD0         SNCO                                                CSD027
     C                     MOVE *BLANKS   SNCO                                                CSD027
     C                     Z-ADD1         RATE
     C                     Z-ADD1         RATED
     C                     MOVE 'N'       OVRD
     C                     Z-ADDPYAM      SMAM
     C*
     C**  Deduct charges from pay amount so that generated outgoing
     C**   payment will match incoming payment posted amount
     C*
     C***********CDRO      IFEQ 0                                                             CSD027
     C           CDRO      IFEQ *BLANKS                                                       CSD027
     C           ADDC      ANDEQ'D'
     C                     SUB  TRCM      SMAM
     C                     SUB  TXCH      SMAM
     C                     SUB  CQCH      SMAM
     C                     SUB  ADCH      SMAM
     C                     SUB  TLCH      SMAM
     C                     SUB  MSCH      SMAM
     C                     SUB  INCHCM    SMAM                            CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
      *                                                                   CFT009
      * INCOMING                                                          CFT009
     C                     SUB  MSC01     SMAM                            CFT009
     C                     SUB  MSC02     SMAM                            CFT009
     C                     SUB  MSC03     SMAM                            CFT009
     C                     SUB  MSC04     SMAM                            CFT009
     C                     SUB  MSC05     SMAM                            CFT009
     C                     ENDIF                                          CFT009
     C                     END
      *                                                                   CFT014
      ** Sum up the following Incoming Payment Charges.                   CFT014
      *                                                                   CFT014
     C                     Z-ADDTRCM      WCHGS  130                      CFT014
     C           S01494    IFEQ 'Y'                                       CFT014
     C                     ADD  INCHCM    WCHGS                           CFT014
     C                     ENDIF                                          CFT014
     C                     ADD  TXCH      WCHGS                           CFT014
     C                     ADD  CQCH      WCHGS                           CFT014
     C                     ADD  ADCH      WCHGS                           CFT014
     C                     ADD  TLCH      WCHGS                           CFT014
     C                     ADD  MSCH      WCHGS                           CFT014
     C                     ADD  INCHCM    WCHGS                           CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
      *                                                                   CFT009
      * INCOMING                                                          CFT009
     C                     ADD  MSC01     SMAM                            CFT009
     C                     ADD  MSC02     SMAM                            CFT009
     C                     ADD  MSC03     SMAM                            CFT009
     C                     ADD  MSC04     SMAM                            CFT009
     C                     ADD  MSC05     SMAM                            CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           S01499    IFEQ 'Y'                                       CFT014
     C                     ADD  INVATT    WCHGS                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Determine Charges Currency.                                      CFT014
      *                                                                   CFT014
     C                     SELEC                                          CFT014
      *                                                                   CFT014
     C***********CDRO      WHNE *ZERO                                                  CFT014 CSD027
     C           CDRO      WHNE *BLANKS                                                       CSD027
     C                     MOVELBJCYCD    WCCCY   3                       CFT014
      *                                                                   CFT014
     C           ADDC      WHEQ 'A'                                       CFT014
     C                     MOVELSMCY      WCCCY                           CFT014
      *                                                                   CFT014
     C           SND1      IFEQ 'CASHIER'                                 CFT014
     C           PCCY      ANDEQBJCYCD                                    CFT014
     C                     MOVELPCCY      WCCCY                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     OTHER                                          CFT014
     C                     MOVELPCCY      WCCCY                           CFT014
      *                                                                   CFT014
     C                     ENDSL                                          CFT014
     C*
     C                     MOVE SMCY      WSMCYX  3                       CFT014
     C                     MOVE PCCY      SMCY
     C                     Z-ADDPVDT      SLDT
     C                     Z-ADDPVDTD1    SLDTD1
     C                     Z-ADDPVDTD2    SLDTD2
     C                     Z-ADDPVDTD3    SLDTD3
     C*
     C** Setup DAF pay amount, depending on number of decimal places in
     C**  receive currency on incoming payment
     C*
     C                     CALL 'AOCURRR0'
     C                     PARM *BLANKS   @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM BJCYCD    @CCY
     C           SDCURR    PARM SDCURR    DSSDY
     C*
     C           @RTCD     IFNE *BLANKS
     C                     Z-ADD60        DBASE            ***************
     C                     MOVEL'SDCURRPD'DBFILE           * DBERR 060   *
     C                     MOVELSMCY      DBKEY            ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
     C*
     C                     Z-ADDA6NBDP    BCDP    10
     C*
     C                     CALL 'AOCURRR0'
     C                     PARM *BLANKS   @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM SMCY      @CCY    3
     C           SDCURR    PARM SDCURR    DSSDY
     C*
     C           @RTCD     IFNE *BLANKS
     C                     Z-ADD61        DBASE            ***************
     C                     MOVEL'SDCURRPD'DBFILE           * DBERR 061   *
     C                     MOVELSMCY      DBKEY            ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
     C*
     C           A6NBDP    ADD  4         N       10
     C           SMAM      DIV  POWER,N   SMAMD
     C*
     C** CALCULATE BASE CURRENCY EQUIV
     C*
     C           A6NBDP    SUB  BCDP      N       10
     C                     ADD  4         N
     C*
     C           MLDV      IFNE 'M'                        B001
     C           EXRT      MULT POWER,N   WK159     H
     C           SMAM      DIV  WK159     SBCQ      H
     C                     ELSE                            X001
     C           EXRT      DIV  POWER,N   WK159  159H
     C           SMAM      MULT WK159     SBCQ      H
     C                     END                             E001
     C*
     C                     Z-ADD0         PYAM
     C                     Z-ADD0         PYAMD
     C                     Z-ADD0         PBCQ
     C                     MOVE 'D'       ADDC
     C                     MOVE 'N'       RPAY
     C                     MOVE *BLANK    PAYF
     C                     Z-ADD0         DYIM
     C                     Z-ADD0         FDAT
     C                     Z-ADD0         FDATD1
     C                     Z-ADD0         FDATD2
     C                     Z-ADD0         FDATD3
     C*
     C           ACB1      IFEQ *BLANKS
     C                     MOVE *BLANKS   ACBT
     C                     END
     C*
     C                     MOVE *BLANKS   SNMT
     C                     Z-ADD0         STMT
     C                     MOVE *BLANKS   RCRT
     C                     MOVE *BLANKS   RCO1
     C                     MOVE *BLANKS   RCO2
     C                     MOVE *BLANKS   RCO3
     C                     MOVE *BLANKS   RCO4
     C                     MOVE *BLANKS   RCO5
     C                     MOVE *BLANKS   BBI1
     C                     MOVE *BLANKS   ORBB
      *
      ** ORDERING BANK
      *
      *  Initialise Ordering Bank mapping fields
      *
     C                     MOVEL*BLANKS   OPORBT
     C                     MOVEL*BLANKS   OPORB1
     C                     MOVEL*BLANKS   OPORB2
     C                     MOVEL*BLANKS   OPORB3
     C                     MOVEL*BLANKS   OPORB4
     C                     MOVEL*BLANKS   OPORB5
      *
      *  Access FT suspense account in case it is needed later on
      *
      *  Obtain branch internal customer number for branch
      *
     C**********           CALL 'AOBRCHR0'                                                    CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM *BLANKS   @RTCD   7
     C                     PARM '*KEY   ' @OPTN   7
     C                     PARM BRCA      @BRKEY  3
     C********** SDBRCH    PARM SDBRCH    DSFDY                                               CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
      *
     C           @RTCD     IFNE *BLANKS
     C           *LOCK     IN   LDA                        ***********
     C                     Z-ADD62        DBASE            *DB ERR 62*
     C                     MOVEL'SDBRCHPD'DBFILE           ***********
     C                     MOVELBRCA      DBKEY
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
      *
      *  Move Suspense account to default account data structure
      *
     C                     MOVE A8BICN    OBCNUM
     C                     MOVE BTIOSA    OBACOD
     C                     Z-ADD1         OBACSQ
     C*
     C** If Ordering Bank is blank, fill fields with Sender details
     C*
     C           ORBT      IFEQ *BLANK
     C*
     C* If Sender is a Midas Account then check that currency is
     C* correct, if not do not use. Also start with no-valid info.
     C*
     C***********          Z-ADD0         ORBK                                                CSD027
     C                     MOVE *BLANKS   ORBK                                                CSD027
     C                     MOVEL*BLANKS   ORBT
     C*
     C** Full Nostro details entered
     C*
     C           SNTP      IFEQ 'F'
     C                     MOVELSND1      FLD5    5
     C                     MOVE FLD5      FLD2    2
     C*
     C** Check Currency
     C*
     C                     MOVELSND1      @CCY    3
     C           @CCY      IFEQ PCCY
     C                     MOVELFLD2      ORBK
     C                     MOVE 'N'       ORBT
     C                     MOVEL@DFT,1    OPORB1
     C                     END
     C*
     C                     ELSE
     C*
      *
      ** Full General Ledger Account
      *
     C           SNTP      IFEQ 'G'
     C                     MOVELSND1      FGLNO
      *
      ** Check Currency if Ok format partial account information
      *
     C           CCY       IFEQ PCCY
     C**********           Z-ADD@@CNUM    ORNUM                                               CSD027
     C                     MOVE @@CNUM    ORNUM                                               CSD027
     C                     Z-ADD@@ACOD    ORCOD
     C                     Z-ADD@@ACSQ    ORSEQ
     C                     MOVELORBKS     ORBK
     C                     MOVEL@@BRCA    ORBB
     C                     MOVE 'P'       ORBT
     C                     MOVEL@DFT,1    OPORB1
     C                     END
     C*
     C                     ELSE
      *
      ** Retail Account
      *
     C           SNTP      IFEQ 'R'
     C                     MOVELSND1      @ACNO
      *
     C                     CALL 'AOACCTR0'
     C                     PARM '*BLANKS' @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM @ACNO     @RETL  10
     C                     PARM *BLANKS   @CNNM   6
     C                     PARM *BLANKS   @CUCD   3
     C**********           PARM *BLANKS   @ACCD   4                                           CGL029
     C                     PARM *BLANKS   @ACCD                                               CGL029
     C                     PARM *BLANKS   @ACSQ   2
     C                     PARM *BLANKS   @BRHC   3
     C           SDACCT    PARM SDACCT    DSSDY
      *
     C           @RTCD     IFNE *BLANKS
     C           *LOCK     IN   LDA                        ***********
     C                     Z-ADD63        DBASE            *DB ERR 63*
     C                     MOVEL'ACCNT'   DBFILE           ***********
     C                     MOVELACNO      DBKEY
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
      *
      ** Check Currency if Ok format partial account information
      *
     C           CCY       IFEQ PCCY
     C                     MOVE 'R'       ORBT
     C                     MOVELSND1      ORBK
     C                     MOVEL@DFT,1    OPORB1
     C                     END
      *
     C                     END
      *
     C                     END
      *
     C                     END
      *
     C                     ELSE
      *
      * If Ordering bank is entered then move Ordering fields to
      * lines 1 - 5 of the outgoing payment mapping Ordering Bnk fields
      * and fill Ordering Bank with default suspense a/c
      *
     C                     MOVELORBT      OPORBT
     C                     MOVELORB1      OPORB1
     C                     MOVELORB2      OPORB2
     C                     MOVELORB3      OPORB3
     C                     MOVELORB4      OPORB4
     C                     MOVELORB5      OPORB5
      *
     C***********          Z-ADD0         ORBK                                                CSD027
     C***********          Z-ADDOBFTAC    ORBK                                                CSD027
     C                     MOVE *BLANKS   ORBK                                                CSD027
     C                     MOVE OBFTAC    ORBK                                                CSD027
     C                     MOVEL'P'       ORBT
     C                     MOVELBRCA      ORBB
     C                     END
      *
      ** MAP SWIFT MESSAGE FIELDS
      *
      ** Test to see if ORBT has been set. If not, move Sender
      ** information into extension fields converting if necessary
      ** and use the FT branch internal customers suspense account
      *
      ** N.B. ORBT will still be blank if the Ordering Bank was not
      **      entered and the Senders Correspondent was either a C, A
      **      or S  OR  F, G or R and pay ccy is not equal to settle.
      *
     C           ORBT      IFEQ *BLANKS
      *
     C***********          Z-ADDOBFTAC    ORBK                                                CSD027
     C                     MOVE OBFTAC    ORBK                                                CSD027
     C                     MOVEL'P'       ORBT
     C                     MOVELBRCA      ORBB
      *
      ** If Sender is an account then extract S.W.I.F.T. address
      ** or if not present the address.
      *
     C           SNTP      IFEQ 'G'
     C           SNTP      OREQ 'F'
     C           SNTP      OREQ 'R'
     C           SNTP      OREQ 'C'
      *
      ** Find Customer information for S.W.I.F.T./Address
      *
     C           SNTP      IFEQ 'G'
     C           SNTP      OREQ 'C'
     C                     MOVELSND1      @WRK6
     C                     MOVEL*BLANK    @KEY1                                               CFT003
     C                     MOVEL@WRK6     @KEY1
     C                     END
      *
     C           SNTP      IFEQ 'R'
     C                     MOVELSND1      @ACNO
      *
     C                     CALL 'AOACCTR0'
     C                     PARM '*BLANKS' @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM @ACNO     @RETL  10
     C                     PARM *BLANKS   @CNNM   6
     C                     PARM *BLANKS   @CUCD   3
     C**********           PARM *BLANKS   @ACCD   4                                           CGL029
     C                     PARM *BLANKS   @ACCD                                               CGL029
     C                     PARM *BLANKS   @ACSQ   2
     C                     PARM *BLANKS   @BRHC   3
     C           SDACCT    PARM SDACCT    DSSDY
      *
     C           @RTCD     IFNE *BLANKS
     C           *LOCK     IN   LDA                        ***********
     C                     Z-ADD64        DBASE            *DB ERR 64*
     C                     MOVE 'ACCNT'   DBFILE           ***********
     C                     MOVE ACNO      DBKEY
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
      *
     C                     MOVEL*BLANK    @KEY1                                               CFT003
     C                     MOVELCNUM      @KEY1
      *
     C                     END
      *
      ** If sender is Nostro, call to access pgm for nostro details
      *
     C           SNTP      IFEQ 'F'
      *
     C           3         SUBSTSND1:1    WSKY0   3
     C           2         SUBSTSND1:4    WSKY1
     C           5         SUBSTSND1:1    WSKEY   5
      *
     C                     CALL 'AONOSTR0'
     C                     PARM *BLANKS   @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM *BLANKS   @CUST   6
     C                     PARM WSKY0     @CCY    3
     C**********           PARM *BLANKS   @ACCD   4                                           CGL029
     C                     PARM *BLANKS   @ACCD                                               CGL029
     C                     PARM *BLANKS   @ACSN   2
     C                     PARM WSKY1     @NONB   2
     C                     PARM *BLANKS   @BRCD   3
     C                     PARM *BLANKS   @CSSN  10
     C                     PARM *BLANKS   @PNOI   1
     C           SDNOST    PARM SDNOST    DSFDY
      *
     C           @RTCD     IFNE *BLANKS
     C           *LOCK     IN   LDA                        ***********
     C                     Z-ADD65        DBASE            *DB ERR 65*
     C                     MOVEL'SDNOSTPD'DBFILE           ***********
     C                     MOVELWSKEY     DBKEY
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
      *
     C                     MOVEL*BLANK    @KEY1                                               CFT003
     C                     MOVELA7CUST    @KEY1
      *
     C                     END
      *
      ** Call to access pgm for Customer details
      *
     C                     CALL 'AOCUSTR0'#ACUST
      *
     C           @RTCD     IFNE *BLANKS
     C           *LOCK     IN   LDA                        ***********
     C                     Z-ADD66        DBASE            *DB ERR 66*
     C                     MOVEL'SDCUSTPD'DBFILE           ***********
     C                     MOVELA7CUST    DBKEY
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
      *
      ** If S.W.I.F.T. use SWIFT ID, else look up address
      *
     C           BBCSID    IFEQ *BLANKS
     C                     MOVE 'A'       OPORBT
     C                     MOVELBBCNA1    OPORB1
     C                     MOVELBBCNA2    OPORB2
     C                     MOVELBBCNA3    OPORB3
     C                     MOVELBBCNA4    OPORB4
     C                     MOVEL*BLANKS   OPORB5
     C                     ELSE
     C                     MOVEL'S'       OPORBT
     C                     MOVELBBCSID    OPORB1
     C                     END
      *
     C                     ELSE
      *
      ** If a S.W.I.F.T. address or normal address map this
      *
     C           SNTP      IFEQ 'A'
     C           SNTP      OREQ 'S'
     C                     MOVELSNTP      OPORBT
     C                     MOVELSND1      OPORB1
     C                     MOVELSND2      OPORB2
     C                     MOVELSND3      OPORB3
     C                     MOVELSND4      OPORB4
     C                     MOVEL*BLANKS   OPORB5
     C                     END
      *
     C                     END
      *
     C                     END
      *
      ** Initialise Bank To bank Information fields
      *
     C                     MOVE *BLANKS   BBI1
     C                     MOVE *BLANKS   BBI2
     C                     MOVE *BLANKS   BBI3
     C                     MOVE *BLANKS   BBI4
     C                     MOVE *BLANKS   BBI5
     C                     MOVE *BLANKS   BBI6
      *
      ** If MT200, MT201, MT202, MT203 or MT205 type of message move
      ** 'MT202' key word into Ordering Customer field 1 and blank out
      * fields 2/3/4.
      *
     C           INMTPY    IFEQ '200'
     C           INMTPY    OREQ '201'
     C           INMTPY    OREQ '202'
     C           INMTPY    OREQ '203'
     C           INMTPY    OREQ '205'
     C           ORCT      IFEQ *BLANKS
     C                     MOVEL*BLANKS   ORC1
     C                     MOVEL*BLANKS   ORC2
     C                     MOVEL*BLANKS   ORC3
     C                     MOVEL*BLANKS   ORC4
     C                     MOVEL*BLANKS   ORC5                                                CFT032
     C                     MOVEL'MT202'   ORC1
     C                     END
     C                     END
      *
      ** Beneficiary: if type R or P, convert to cust. no.
      **              otherwise, transfer straight across.
      *
     C           BNCT      IFEQ 'R'
     C                     MOVELBNC1      @ACNO
      *
     C                     CALL 'AOACCTR0'
     C                     PARM '*BLANKS' @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM @ACNO     @RETL  10
     C                     PARM *BLANKS   @CNNM   6
     C                     PARM *BLANKS   @CUCD   3
     C**********           PARM *BLANKS   @ACCD   4                                           CGL029
     C                     PARM *BLANKS   @ACCD                                               CGL029
     C                     PARM *BLANKS   @ACSQ   2
     C                     PARM *BLANKS   @BRHC   3
     C           SDACCT    PARM SDACCT    DSSDY
      *
     C           @RTCD     IFNE *BLANKS
     C           *LOCK     IN   LDA                        ***********
     C                     Z-ADD67        DBASE            *DB ERR 67*
     C                     MOVE 'ACCNT'   DBFILE           ***********
     C                     MOVELACNO      DBKEY
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
      *
     C                     MOVELCNUM      @WRK6
     C                     END
      *
     C           BNCT      IFEQ 'P'
     C                     MOVELBNC1      @WRK6
     C                     END
      *
     C           BNCT      IFEQ 'R'
     C           BNCT      OREQ 'P'
     C                     MOVE *BLANKS   BNC1
     C                     MOVEL@WRK6     BNC1
     C                     MOVE 'C'       BNCT
     C                     END
      *
     C                     Z-ADD0         DNBC
     C                     MOVE *BLANK    TRCT
     C                     Z-ADD0         TRCM
     C                     Z-ADD0         TRCMD
     C                     Z-ADD0         TXCH
     C                     Z-ADD0         TXCHD
     C                     Z-ADD0         CQCH
     C                     Z-ADD0         CQCHD
     C                     Z-ADD0         CSTA
     C                     Z-ADD0         CSTAD
     C                     Z-ADD0         SPCH
     C                     Z-ADD0         SPCHD
     C                     Z-ADD0         MSCH
     C                     Z-ADD0         MSCHD
     C                     MOVE *BLANK    CDRT
     C***********          Z-ADD0         CDRO                                                CSD027
     C                     MOVE *BLANKS   CDRO                                                CSD027
     C                     MOVE *BLANKS   CDBR
     C                     TIME           LCHT
     C                     Z-ADDRUND      LCD
     C                     MOVE 'I'       CHTP
     C                     MOVE *BLANKS   AUP1
     C                     MOVE *BLANKS   AUP2
     C                     MOVE *BLANKS   AUIN
     C                     MOVE *BLANKS   IACG
     C                     MOVE *BLANKS   SACG
     C                     MOVE *BLANKS   PACG
     C                     MOVE *BLANKS   SMSG
     C                     MOVE *BLANKS   PMSG
     C                     Z-ADDRUND      OEDT
     C                     MOVE RUND      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZDATE     OEDTD1
     C                     Z-ADD0         NPDT
     C                     Z-ADD0         NPDTD1
     C                     Z-ADD0         NPDTD2
     C                     Z-ADD0         NPDTD3
     C                     Z-ADD0         PRBD
     C                     Z-ADD0         DUMA1
     C                     Z-ADD0         DUMA2
     C                     Z-ADD0         DUMA3
     C                     Z-ADD0         DUMA4
     C                     Z-ADD0         DUMA5
     C                     Z-ADD0         DUMA6
     C                     MOVE *BLANKS   FAIN
     C                     MOVE *BLANKS   ADIN
     C                     MOVE *BLANKS   CQIN
     C                     MOVE *BLANK    PRIN
     C                     MOVE *BLANKS   MT100
     C                     MOVE *BLANKS   MT202
     C                     MOVE *BLANKS   TXIN
     C                     MOVE *BLANKS   BAIN
     C                     MOVE *BLANKS   ISIN
     C                     MOVE *BLANKS   MPYI
     C                     MOVE *BLANKS   INBT
     C                     MOVE *BLANKS   INB1
     C                     MOVE *BLANKS   INB2
     C                     MOVE *BLANKS   INB3
     C                     MOVE *BLANKS   INB4
     C                     MOVE *BLANKS   INB5
     C                     Z-ADD0         CHAP
     C                     MOVE 'N'       LVL1
     C                     MOVE 'N'       LVL2
      *
     C** Reset Booking Branch field from INPAY
     C*
     C                     MOVE IBRC      BRCA
      *
      * Transfer msg unique reference & part number
      *
     C           INMSGR    IFNE 0
     C                     Z-ADDINMSGR    OPMSGR
     C                     Z-ADDINKPRT    OPKPRT
     C                     END
      *                                                                   CFT014
      ** Save Instructed Ccy and Amnt of Incoming Payment.                CFT014
      *                                                                   CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
     C                     MOVE NDCY      WNDCY   3                       CFT014
     C                     Z-ADDNDAM      WNDAM  130                      CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Initialise Instructed Ccy to blanks and Amnt to zero.            CFT014
      *                                                                   CFT014
     C           CEU006    IFEQ 'Y'                                       CFT014
     C                     MOVE *BLANKS   NDCY                            CFT014
     C                     Z-ADD*ZEROS    NDAM                            CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           CEU006    IFEQ 'Y'                                       CFT014
     C           CFT014    OREQ 'Y'                                       CFT014
     C                     MOVE *BLANKS   PDCY                            CFT014
     C                     Z-ADD*ZEROS    PDAM                            CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
      *                                                                   CFT014
     C                     Z-ADD*ZEROS    OPOEXR                          CFT014
     C                     MOVE *BLANKS   OPTRIT                          CFT014
     C                     MOVE *BLANKS   OPTRI1                          CFT014
     C                     MOVE *BLANKS   OPTRI2                          CFT014
     C                     MOVE *BLANKS   OPTRI3                          CFT014
     C                     MOVE *BLANKS   OPTRI4                          CFT014
     C                     MOVE *BLANKS   OPTRI5                          CFT014
     C                     Z-ADD*ZEROS    OPRCNW                          CFT014
     C                     MOVE *BLANKS   OPRCCN                          CFT014
     C                     MOVE *BLANKS   OPRCUS                          CFT014
     C                     Z-ADD0         OPSCLE                          CFT014
      *                                                                   CFT014
      ** Perform mapping of Incoming Payment fields to Outgoing           CFT014
      ** Payment fields.                                                  CFT014
      *                                                                   CFT014
     C           INMTPY    IFEQ '103'                                     CFT014
      *                                                                   CFT014
      ** Map Instructed Ccy and Instructed Amt if source of Incoming      CFT014
      ** Payment is an MT103.                                             CFT014
      *                                                                   CFT014
     C                     MOVE WNDCY     PDCY                            CFT014
     C                     Z-ADDWNDAM     PDAM                            CFT014
      *                                                                   CFT014
      ** Map Original Rate if source of Incoming Payment is an MT103.     CFT014
      *                                                                   CFT014
     C                     Z-ADDINOEXR    OPOEXR                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Bank Operation Code                                              CFT014
      *                                                                   CFT014
     C                     MOVE INBOCD    OPBOCD                          CFT014
      *                                                                   CFT014
      ** Transaction Type Code                                            CFT014
      *                                                                   CFT014
     C                     MOVE INTTCD    OPTTCD                          CFT014
      *                                                                   CFT014
      ** Instruction Code                                                 CFT014
      *                                                                   CFT014
     C                     MOVE INICD1    OPICD1                          CFT014
     C                     MOVE INICD2    OPICD2                          CFT014
     C                     MOVE INICD3    OPICD3                          CFT014
     C                     MOVE INICD4    OPICD4                          CFT014
     C                     MOVE INICD5    OPICD5                          CFT014
      *                                                                   CFT014
      ** Regulatory Reporting                                             CFT014
      *                                                                   CFT014
     C                     MOVE INRRP1    OPRRP1                          CFT014
     C                     MOVE INRRP2    OPRRP2                          CFT014
     C                     MOVE INRRP3    OPRRP3                          CFT014
      *                                                                   CFT014
      ** Receiver's Charges Remitted                                      CFT014
      *                                                                   CFT014
     C           WCCCY     IFNE WSMCYX                                    CFT014
      *                                                                   CFT014
     C                     CLEARP#0010                                    CFT014
     C                     MOVELWCCCY     P#FRCY                          CFT014
     C                     Z-ADDWCHGS     P#FRAM                          CFT014
     C                     MOVELWSMCYX    P#TOCY                          CFT014
     C                     Z-ADD*ZEROS    P#TOAM                          CFT014
     C                     CALL 'FT0010'                                  CFT014
     C                     PARM           P#0010                          CFT014
      *                                                                   CFT014
     C           P#RTCD    IFEQ '*ERROR*'                                 CFT014
     C           *LOCK     IN   LDA                                       CFT014
     C                     Z-ADD117       DBASE                           CFT014
     C                     MOVEL'*CALL   'DBKEY                           CFT014
     C                     MOVEL'FT0010  'DBFILE                          CFT014
     C                     OUT  LDA                                       CFT014
     C                     EXSR *PSSR                                     CFT014
     C                     ELSE                                           CFT014
     C           INRCRM    SUB  P#TOAM    WRCRM  110                      CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
     C           INRCRM    SUB  WCHGS     WRCRM                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           WRCRM     IFLT *ZEROS                                    CFT014
     C                     Z-ADD*ZEROS    WRCRM                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     Z-ADD*ZERO     OPRCRM                          CFT014
     C                     Z-ADD*ZERO     OPRBCQ                          CFT014
     C                     Z-ADD*ZERO     OPRCSC                          CFT014
     C                     Z-ADD*ZERO     OPRCSQ                          CFT014
      *                                                                   CFT014
     C           WRCRM     IFGT *ZEROS                                    CFT014
      *                                                                   CFT014
     C           WSMCYX    IFNE PCCY                                      CFT014
      *                                                                   CFT014
     C                     CLEARP#0010                                    CFT014
     C                     MOVELWSMCYX    P#FRCY                          CFT014
     C                     Z-ADDWRCRM     P#FRAM                          CFT014
     C                     MOVELPCCY      P#TOCY                          CFT014
     C                     Z-ADD*ZEROS    P#TOAM                          CFT014
     C                     CALL 'FT0010'                                  CFT014
     C                     PARM           P#0010                          CFT014
      *                                                                   CFT014
     C           P#RTCD    IFEQ '*ERROR*'                                 CFT014
     C           *LOCK     IN   LDA                                       CFT014
     C                     Z-ADD118       DBASE                           CFT014
     C                     MOVEL'*CALL   'DBKEY                           CFT014
     C                     MOVEL'FT0010  'DBFILE                          CFT014
     C                     OUT  LDA                                       CFT014
     C                     EXSR *PSSR                                     CFT014
     C                     ELSE                                           CFT014
     C                     Z-ADDP#TOAM    OPRCRM                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
     C                     Z-ADDWRCRM     OPRCRM                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Calculate Receiver's Charges Base Currency Equivalent.           CFT014
      *                                                                   CFT014
     C                     CLEARP#0010                                    CFT014
     C                     MOVELPCCY      P#FRCY                          CFT014
     C                     Z-ADDOPRCRM    P#FRAM                          CFT014
     C                     MOVELBJCYCD    P#TOCY                          CFT014
     C                     Z-ADD0         P#TOAM                          CFT014
     C                     CALL 'FT0010'                                  CFT014
     C                     PARM           P#0010                          CFT014
      *                                                                   CFT014
     C           P#RTCD    IFEQ '*ERROR*'                                 CFT014
     C           *LOCK     IN   LDA                                       CFT014
     C                     Z-ADD119       DBASE                           CFT014
     C                     MOVEL'*CALL  ' DBKEY                           CFT014
     C                     MOVEL'FT0010  'DBFILE                          CFT014
     C                     OUT  LDA                                       CFT014
     C                     EXSR *PSSR                                     CFT014
     C                     ELSE                                           CFT014
     C                     Z-ADDP#TOAM    OPRBCQ                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Receiver's Charges Remitted in Settlement Ccy                    CFT014
      *                                                                   CFT014
     C                     Z-ADDOPRCRM    OPRCSC                          CFT014
      *                                                                   CFT014
      ** Base Currency Equivalent of Receiver's Charges Remitted in       CFT014
      ** Settlement Currency                                              CFT014
      *                                                                   CFT014
     C                     Z-ADDOPRBCQ    OPRCSQ                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Sender's Charges Deducted                                        CFT014
      *                                                                   CFT014
     C                     MOVE INSCY1    OPSCC1                          CFT014
     C                     MOVE INSCY2    OPSCC2                          CFT014
     C                     MOVE INSCY3    OPSCC3                          CFT014
     C                     MOVE INSCY4    OPSCC4                          CFT014
     C                     MOVE INSCY5    OPSCC5                          CFT014
     C                     MOVE INSCH1    OPSCH1                          CFT014
     C                     MOVE INSCH2    OPSCH2                          CFT014
     C                     MOVE INSCH3    OPSCH3                          CFT014
     C                     MOVE INSCH4    OPSCH4                          CFT014
     C                     MOVE INSCH5    OPSCH5                          CFT014
      *                                                                   CFT014
     C                     Z-ADD*ZEROS    WSCHG  110                      CFT014
     C           DTCH      IFEQ 'BEN'                                     CFT014
      *                                                                   CFT014
     C           TXCH      ADD  CQCH      WCHGS                           CFT014
     C                     ADD  CSTA      WCHGS                           CFT014
     C                     ADD  SPCH      WCHGS                           CFT014
     C                     ADD  MSCH      WCHGS                           CFT014
     C                     ADD  TRCM      WCHGS                           CFT014
     C           S01494    IFEQ 'Y'                                       CFT014
     C                     ADD  OPCHCM    WCHGS                           CFT014
     C                     ENDIF                                          CFT014
     C           S01499    IFEQ 'Y'                                       CFT014
     C                     ADD  OPVATT    WCHGS                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           WCHGS     IFNE *ZEROS                                    CFT014
      *                                                                   CFT014
     C                     SELEC                                          CFT014
     C           CDRT      WHNE *BLANKS                                   CFT014
     C                     MOVELBJCYCD    WCCCY                           CFT014
     C           ADDC      WHEQ 'A'                                       CFT014
     C                     MOVELSMCY      WCCCY                           CFT014
     C                     OTHER                                          CFT014
     C                     MOVELPCCY      WCCCY                           CFT014
     C                     ENDSL                                          CFT014
      *                                                                   CFT014
     C           WCCCY     IFNE PCCY                                      CFT014
      *                                                                   CFT014
     C                     CLEARP#0010                                    CFT014
     C                     MOVELWCCCY     P#FRCY                          CFT014
     C                     Z-ADDWCHGS     P#FRAM                          CFT014
     C                     MOVELPCCY      P#TOCY                          CFT014
     C                     Z-ADD*ZEROS    P#TOAM                          CFT014
     C                     CALL 'FT0010'                                  CFT014
     C                     PARM           P#0010                          CFT014
      *                                                                   CFT014
     C           P#RTCD    IFEQ '*ERROR*'                                 CFT014
     C           *LOCK     IN   LDA                                       CFT014
     C                     Z-ADD120       DBASE                           CFT014
     C                     MOVEL'*CALL  ' DBKEY                           CFT014
     C                     MOVEL'FT0010  'DBFILE                          CFT014
     C                     OUT  LDA                                       CFT014
     C                     EXSR *PSSR                                     CFT014
     C                     ELSE                                           CFT014
     C                     Z-ADDP#TOAM    WSCHG                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
     C                     Z-ADDWCHGS     WSCHG                           CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     SELEC                                          CFT014
      *                                                                   CFT014
     C           OPSCC1    WHEQ *BLANKS                                   CFT014
     C                     MOVE PCCY      OPSCC1                          CFT014
     C                     Z-ADDWSCHG     OPSCH1                          CFT014
     C                     Z-ADD1         OPSCLE                          CFT014
      *                                                                   CFT014
     C           OPSCC2    WHEQ *BLANKS                                   CFT014
     C                     MOVE PCCY      OPSCC2                          CFT014
     C                     Z-ADDWSCHG     OPSCH2                          CFT014
     C                     Z-ADD2         OPSCLE                          CFT014
      *                                                                   CFT014
     C           OPSCC3    WHEQ *BLANKS                                   CFT014
     C                     MOVE PCCY      OPSCC3                          CFT014
     C                     Z-ADDWSCHG     OPSCH3                          CFT014
     C                     Z-ADD3         OPSCLE                          CFT014
      *                                                                   CFT014
     C           OPSCC4    WHEQ *BLANKS                                   CFT014
     C                     MOVE PCCY      OPSCC4                          CFT014
     C                     Z-ADDWSCHG     OPSCH4                          CFT014
     C                     Z-ADD4         OPSCLE                          CFT014
      *                                                                   CFT014
     C                     OTHER                                          CFT014
     C                     MOVE PCCY      OPSCC5                          CFT014
     C                     Z-ADDWSCHG     OPSCH5                          CFT014
     C                     Z-ADD5         OPSCLE                          CFT014
      *                                                                   CFT014
     C                     ENDSL                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           PREF      CHAINOTPAYXL0             80                   CFT014
      *                                                                   CFT014
     C           *IN80     IFEQ *OFF                                      CFT014
     C           *LOCK     IN   LDA                                       CFT014
     C                     Z-ADD116       DBASE                           CFT014
     C                     MOVELPREF      DBKEY                           CFT014
     C                     MOVEL'OTPAYXL0'DBFILE                          CFT014
     C                     OUT  LDA                                       CFT014
     C                     EXSR *PSSR                                     CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
     C*
     C                     Z-ADDRUND      LCD
     C                     WRITEOTPAYDDF               80
      *
      * Update Incoming Message FT Transaction Status File record
      * if incoming payment created from Incoming Electronic Message
      *
     C           OPMSGR    IFNE 0
      *
     C                     MOVEL'OP'      ##OPIN
      *
     C                     MOVEL'MIN0030' W0FLAG
     C                     MOVEL'MIN0189' W0LMSG
      *
     C                     EXSR SRINFT
      *
     C                     END
     C*
     C** Update trailer file
     C*
     C           *IN80     IFEQ '0'
     C           1         CHAINOTPAYZZF             80
      *
     C           *IN80     IFEQ '0'
     C                     Z-ADDHRWN      ZZTOTI
     C                     Z-ADDHRDC      ZZTOTD
     C                     ADD  1         NORE1
     C           SMAM      DIV  1000      ZZAMT
     C                     EXSR GLZADD
     C                     Z-ADDZZTOTI    HRWN
     C                     Z-ADDZZTOTD    HRDC
     C                     Z-ADDRUND      LCD
      *
     C                     EXCPTOTPAYZ
      *
     C                     END
      *
     C                     END
      *
      ** Write the corresponding record to the Outgoing Payment
      ** Extension File.
      *
     C           *IN80     IFEQ '0'
      *                                                                   CFT014
     C                     MOVEL'D'       OPRECI                          CFT014
     C                     MOVELPREF      OPPREF
     C                     MOVE *BLANK    OPBJPR
     C                     MOVE *BLANK    OPAUTO
     C                     MOVE *BLANK    OPSTPI
     C                     MOVE *BLANKS   OPBANO
     C                     MOVE *BLANKS   OPRUSR
     C                     MOVE *BLANKS   OPWSID
     C                     MOVE *BLANKS   OPRDAT
     C                     WRITEOTPAYXDF               80
     C                     END
      *
     C                     ENDSR
     C*
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRINFT   : Update Incoming Message FT Transaction Status     *
      *             File record                                       *
      *  CALLS    : SRERR   - report error and close down program     *
      *                                                               *
      *                                                               *
      *  CALLED BY: ADOTPY  - update Inpaydd                          *
      *             FILEUP  - update Otpaydd                          *
      *                                                               *
      *                                                               *
      *****************************************************************
     CSR         SRINFT    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         S       30
     C                     MOVEL'SRINFT'  @STK,S
      *
      *  Fill record format data structure with available data
      *
     C                     CLEARINFT
      *
      * If ##OPIN equal 'OP' Outgoing payment processed, if equal 'IN'
      * than Incoming payment
      *
     C           ##OPIN    IFEQ 'OP'
     C                     Z-ADDOPMSGR    FTMSGR           Unique Ref.
     C                     Z-ADDOPKPRT    FTKPRT           Part No.
     C                     MOVELW0FLAG    FTOTFG           Outgoing Flag
     C                     MOVELPREF      FTOPRF           Outg. Pay. Ref
     C                     MOVEL'*FT OUT 'W2ACT
     C                     ELSE
     C           ##OPIN    IFEQ 'IN'
     C                     Z-ADDINMSGR    FTMSGR           Unique Ref.
     C                     Z-ADDINKPRT    FTKPRT           Part No.
     C                     MOVELW0FLAG    FTINFG           Incoming Flag
     C                     MOVELPREF      FTIPRF           Incom. Pay. Ref
     C                     MOVEL'*FT INC 'W2ACT
     C                     END
     C                     END
      *
     C                     MOVELBRCA      FTBRCA           Branch Code
     C                     MOVEL*BLANKS   FTFRGL           Funds From
     C                     MOVEL*BLANKS   FTTOGL           Funds To
      *
     C                     MOVELW0LMSG    W2LMSG           Log file Msg ID
     C                     MOVEL*BLANKS   W2NWRK           Network
      *
      *  N.B. Audit Stamp details are determined in called program
      *
      *
      *  Set up data to be passed using the rcd format data structure
      *
     C                     CALL 'ME1050'               90
     C                     PARM           W2ACT   8
     C                     PARM ##PGM     W2CPGM 10
     C                     PARM           W2NWRK  6
     C                     PARM           W2LMSG  7
     C                     PARM           INFT
     C                     PARM *BLANKS   W2RTN   7
      *
      *  If return with an error (LR seton in called program) then
      *  process for database error.
      *
     C           *IN90     IFEQ '1'
     C           W2RTN     OREQ '*ERROR*'
     C                     MOVEL'ME1050  'W0FILE           ***************
     C                     MOVEL'*CALL'   W0KEY            * DB ERROR 69 *
     C                     Z-ADD69        W0ERNB           ***************
     C                     EXSR SRERR
     C                     END
      *
      *  Unwind subroutine stack name
      *
     C           EXLOG     TAG
     C                     MOVEA*BLANKS   @STK,S
     C                     SUB  1         S
      *
     CSR                   ENDSR
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRERR    : Report error and close down program               *
      *                                                               *
      *  CALLED BY: SRINFT- Update Incoming Message FT Transaction    *
      *                     Status File record                        *
      *                                                               *
      *  CALLS    : *NONE                                             *
      *                                                               *
      *****************************************************************
     CSR         SRERR     BEGSR
      *
      *  Define work variables
      *
     C           *LIKE     DEFN @BKEY     W0KEY
     C           *LIKE     DEFN @BERNB    W0ERNB
     C           *LIKE     DEFN @BFILE    W0FILE
     C           *LIKE     DEFN @BNARR    W0NARR
      *
      *  Dump program
      *
     C                     DUMP
     C                     ROLBK
      *
      *  Send message to MOPERQ
      *
     C                     MOVEL*BLANKS   DBDTA
     C                     MOVEL'FT0060  '@BPGM
     C           S         IFGT 1
     C           S         ANDLT21
     C                     MOVEL@STK,S    @BSTK
     C                     ELSE
     C                     MOVEL'*Nostkin'@BSTK
     C                     END
     C                     MOVELW0KEY     @BKEY
     C                     Z-ADDW0ERNB    @BERNB
     C                     MOVELW0FILE    @BFILE
     C                     MOVELPREF      @BPREF
     C           W0NARR    IFEQ *BLANKS
     C                     MOVELERR@,1    @BNARR
     C                     ELSE
     C                     MOVELW0NARR    @BNARR
     C                     END
      *
     C                     CALL 'AOCREPT'              9090
     C                     PARM 'MEM5000' #MSGID  7
     C                     PARM 'MIDAS  ' #MSGF  10
     C                     PARM *BLANKS   #MSGFL 10
     C                     PARM DBDTA     #MSGDT256
     C                     PARM '*PRV'    #MSGR   5
     C                     PARM '*'       #PRGM  10
     C                     PARM 'MOPERQ ' #MSGQ  10
     C                     PARM '*INFO  ' #MSGT   7
      *
      *  Close down program
      *
     C           *LOCK     IN   LDA
     C***********          MOVE 'FT0060  'DBPGM                           CFT014
     C                     MOVEL'FT0803'  DBPGM                           CFT014
     C                     MOVELW0FILE    DBFILE
     C                     Z-ADDW0ERNB    DBASE
     C                     MOVELW0KEY     DBKEY
     C                     OUT  LDA
     C                     SETON                     U7U8LR
      *
     C                     RETRN
      *
     CSR         EXERR     ENDSR
     C/EJECT
     C*****************************************************************
     C*   TERM     : Termination Processing                           *
     C*   Called by: Main Process                                     *
     C*****************************************************************
     C           TERM      BEGSR
     C*
     C** If no outgoing and incoming records, write no details
     C*
     C           *IN38     IFEQ '0'
     C                     OPEN FT0803AU
     C                     MOVELFILEA     SFILE
     C                     Z-ADDFNUMA     ZSNUM
     C                     EXSR ZSFL
     C                     MOVE '1'       *IN38
     C                     END                             -*IN38
     C*
     C           *IN36     IFEQ '1'
     C           *IN37     ANDEQ'1'
     C           *IN58     ANDEQ*ON                                       CFT006
     C           *IN59     ANDEQ*ON                                       CFT006
     C           *IN34     OREQ '1'
     C           *IN35     ANDEQ'1'
     C           *IN58     ANDEQ*ON                                       CFT006
     C           *IN59     ANDEQ*ON                                       CFT006
     C*
     C                     WRITEHEADAU
     C                     WRITENODETAU
     C*
     C** Else, write Audit details
     C*
     C                     ELSE
     C*
     C           HNOEX     ADD  HNOTR     HTOTN
     C                     WRITEHEADAU
     C                     WRITEDETLAU
     C*
     C** Update Control record file
     C*
     C           WSUSR     CHAINFTCONTL0             69
     C*
     C********** *IN69     IFEQ '1'
     C********** *LOCK     IN   LDA
     C**********           Z-ADD68        DBASE            ***************
     C**********           MOVEL'FTCONTL0'DBFILE           * DBERR 068   *
     C**********           MOVELWSUSR     DBKEY            ***************
     C**********           OUT  LDA
     C**********           EXSR *PSSR
     C**********           END
     C*
     C           *IN69     IFEQ '0'                                                         MD045438
      *                                                                                     MD045438
     C           *IN30     IFEQ '0'
     C                     MOVE *BLANKS   COBATN
     C                     MOVE *BLANKS   COTMID
     C                     MOVE *BLANKS   CONREC
     C                     ELSE
     C*
     C** If no. of payments with lvl 1 & 2 not completed yet (@NEXP) is
     C** not 0, subtract no. of records for authorisation field
     C** in FTCONTPD by the contents of this fields.
     C*
     C           @NEXP     IFNE 0
     C                     SUB  @NEXP     CONREC
     C                     END
     C*
     C                     END
     C*
     C           @RAIN     IFEQ 'X'                                                         MD045438
     C           @RAIN     OREQ 'R'                                                         MD045438
     C           CONREC    ANDGT0                                                           MD045438
     C                     MOVEL@RAIN     COSTAT
     C                     UPDAT@CONTPD                70
     C                     ENDIF                                                            MD045438
     C*
     C           *IN70     IFEQ '1'
     C           *LOCK     IN   LDA
     C                     Z-ADD69        DBASE            ***************
     C                     MOVEL'FTCONTL0'DBFILE           * DBERR 069   *
     C                     MOVEL'WRITEERR'DBKEY            ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
     C*
     C                     END                                                              MD045438
      *                                                                                     MD045438
     C                     END
     C*
     C** Close any open printer files
     C*
     C           *IN38     IFEQ '1'
     C                     CLOSEFT0803AU
     C                     MOVE '0'       *IN38
     C                     END
     C*
     C           *IN39     IFEQ '1'
     C                     CLOSEFT0803P1
     C                     MOVE '0'       *IN39
     C                     END
     C*
     C           *IN40     IFEQ '1'
     C                     CLOSEFT0803P2
     C                     MOVE '0'       *IN40
     C                     END
     C*
     C           *IN41     IFEQ '1'
     C                     CLOSEFT0803P3
     C                     MOVE '0'       *IN41
     C                     END
     C*
     C** Normal end of program
     C*
     C                     MOVE '1'       *INLR
     C                     RETRN
     C                     ENDSR
     C*
     C/EJECT
     C*****************************************************************
     C*   ZSFL     : Processing to call ZSFILE                        *
     C*   Called by: SYSL,SINB,ALLB,TERM,                             *
     C*   Calls    : ZSFILE - Record printer file in RCF              *
     C*****************************************************************
     C           ZSFL      BEGSR
     C*
     C** If branch is 'ALL' call ZSFILE w/ blank (@BRCH)
     C*
     C           @@BCH     IFEQ 'ALL'
     C                     MOVE *BLANKS   @BRCH
     C                     ELSE
     C                     MOVE @@BCH     @BRCH
     C                     END
     C*
     C                     MOVE @@RSEQ    @RSEQ
     C*
     C                     CALL 'ZSFILE'
     C                     PARM           @RSEQ   5
     C                     PARM           @BRCH   3
     C                     PARM           SFILE  10
     C                     PARM           ZSNUM   60
     C                     PARM *BLANKS   ZSERR   1
     C*
     C** Error During ZSFILE Processing, Return to Calling Program
     C*
     C           ZSERR     IFEQ 'Y'
     C           *LOCK     IN   LDA
     C                     Z-ADD70        DBASE            ***************
     C                     MOVEL'ZSFILE'  DBFILE           * DBERR 070   *
     C                     MOVEL*BLANKS   DBKEY            ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
     C                     ENDSR
     C*
     C/EJECT
     C*****************************************************************
     C*   #HGETA- Get customer name and address.                      *
     C*   Called by - NAUG                                            *
     C*****************************************************************
     C*
     C           #HGETA    BEGSR
      *
     C                     CALL 'FT0315'               8989
     C                     PARM           W8RTN   7
     C                     PARM           W8FT
     C                     PARM           W8LINS256
     C                     PARM           W8RPT 256
     C                     PARM           W8MSG 256
     C                     PARM           W8SCR 256
      *
      ** Check if database error occurred
      *
     C           *IN89     IFEQ '1'
     C           W8RTN     ORNE *BLANKS
     C           W8TYPE    ANDNE'S'
     C           *LOCK     IN   LDA
     C                     MOVEL'FT0315'  DBFILE           * * * * * * * *
     C                     MOVEL'*CALL'   DBKEY            *  DBERR 024  *
     C                     MOVEL'024'     DBASE            * * * * * * * *
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
      *
     C                     MOVELW8RPT     XNAMDS
      *
     C                     ENDSR
     C*
     C/EJECT
     C*****************************************************************
     C*   *PSSR - error handling                                      *
     C*   Called by - anywhere within the program                     *
     C*****************************************************************
     C*
     C           *PSSR     BEGSR
     C*
     C           *IN38     IFEQ '0'
     C                     OPEN FT0803AU
     C                     MOVELFILEA     SFILE
     C                     Z-ADDFNUMA     ZSNUM
     C                     EXSR ZSFL
     C                     MOVE '1'       *IN38
     C                     END
     C*
     C                     MOVE '1'       *IN28
     C*
     C                     WRITEHEADAU
     C                     WRITEERRORAU
     C                     MOVE '1'       *INU7
     C                     MOVE '1'       *INU8
     C                     MOVE '1'       *INLR
     C*
     C** Close any open printer files
     C*
     C           *IN38     IFEQ '1'
     C                     CLOSEFT0803AU
     C                     MOVE '0'       *IN38
     C                     END
     C*
     C           *IN39     IFEQ '1'
     C                     CLOSEFT0803P1
     C                     MOVE '0'       *IN39
     C                     END
     C*
     C           *IN40     IFEQ '1'
     C                     CLOSEFT0803P2
     C                     MOVE '0'       *IN40
     C                     END
     C*
     C           *IN41     IFEQ '1'
     C                     CLOSEFT0803P3
     C                     MOVE '0'       *IN41
     C                     END
     C*
     C                     DUMP
     C                     RETRN
     C                     ENDSR
     C*
     C/EJECT
     C********************************************************************
     C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
     C*   IND '99' IS SET BY AN OVERFLOW ERROR
     C*
     C           GLZADD    BEGSR                           *** GLZADD ****
     C*
     C                     Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
     C   91                GOTO ZZAEND                     AMT = 0.BYPASS
     C*
     C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
     C                     Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
     C                     MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
     C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
     C*
     C                     EXSR GLZSUM
     C           ZZAEND    ENDSR                           ** ZZAEND TAG *
     C*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
     C*                        GLZADD, GLZSUB, GLZCMP.
     C*          PARAMETERS PASSED -
     C*                     I/P ZZAMTI ZZAMTD
     C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
     C*
     C           GLZSUM    BEGSR                           *** GLZSUM ****
     C*
     C                     Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
     C                     Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
     C                     SETOF                     919293
     C                     SETOF                     949599
     C*
     C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
     C           ZZAMTI    COMP 0                      9293
     C   93      ZZAMTD    COMP 0                      9293
     C   93                GOTO ZZSEND                     ZERO BYPASS
     C*
     C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
     C           ZZTOTI    COMP 0                      9193
     C   93      ZZTOTD    COMP 0                      9193
     C*
     C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
     C   93                Z-ADDZZAMTI    ZZTOTI
     C   93                Z-ADDZZAMTD    ZZTOTD
     C   93                GOTO ZZSEND                     ZERO BYPASS
     C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
     C   91N92
     CORN91 92             GOTO ZZOFPS
     C*
     C           ZZAMTD    ADD  ZZTOTD    ZZWK2   40
     C           ZZWK2     COMP 999                  93    '93' = CARRY
     C  N93      ZZWK2     COMP -999                   93    INTO INTEGER.
     C*
     C   93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
     C      93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
     C   93      ZZTOTI    ADD  ZZWK3     ZZWK3
     C  N93      ZZTOTI    ADD  ZZAMTI    ZZWK3
     C*
     C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
     C  N92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
     C   92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
     C  N99                Z-ADDZZWK2     ZZTOTD
     C  N99                Z-ADDZZWK3     ZZTOTI
     C*
     C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
     C   99                Z-ADD0         ZZAMT  153
     C                     GOTO ZZSEND
     C*
     C* THE 'SIGNS' ARE DIFFERENT
     C           ZZOFPS    TAG                             ** ZZOFPS TAG**
     C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
     C*
     C   92                Z-SUBZZAMTI    ZZAMTI 150
     C   92                Z-SUBZZAMTD    ZZAMTD  30
     C*
     C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
     C*
     C   91                Z-SUBZZTOTI    ZZTOTI
     C   91                Z-SUBZZTOTD    ZZTOTD
     C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
     C*
     C           ZZTOTI    COMP ZZAMTI               93  95
     C   95      ZZTOTD    COMP ZZAMTD               93  95
     C*
     C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
     C   95                Z-ADD0         ZZTOTI
     C   95                Z-ADD0         ZZTOTD
     C   95                GOTO ZZSEND
     C*
     C* IF ZZTOT GT. ZZAMT.
     C   93      ZZAMTD    COMP ZZTOTD               94
     C   93 94   ZZTOTI    SUB  1         ZZTOTI
     C   93 94   ZZTOTD    ADD  1000      ZZWK2
     C   93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
     C   93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
     C   93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
     C*
     C*
     C* IF ZZAMT GT. ZZTOT.
     C  N93      ZZTOTD    COMP ZZAMTD               94
     C  N93 94   ZZAMTI    SUB  1         ZZWK3  150
     C  N93 94   ZZAMTD    ADD  1000      ZZWK2
     C  N93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
     C  N93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
     C  N93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
     C  N93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
     C*
     C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
     C                     SETOF                     94
     C   93 91
     CORN93 92             SETON                     94
     C   94                Z-SUBZZTOTI    ZZTOTI
     C   94                Z-SUBZZTOTD    ZZTOTD
     C**
     C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
     C   92                Z-SUBZZAMTI    ZZAMTI
     C   92                Z-SUBZZAMTD    ZZAMTD
     C           ZZSEND    TAG                             ** ZZSEND TAG *
     C**
     C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
     C                     SETOF                     96
     C           ZZTOTD    COMP 0                        91
     C   91      ZZTOTI    COMP 0                      96
     C   96                MOVE '.000-'   ZZNEGD  5
     C                     ENDSR                             ** ENDSR **
     C*****************************************************************
     C*   SR/INCR   : Chain to MEINCRL1 to check the source network   *
     C*               for autogen payments. For non-autogen payments  *
     C*               use sett method to look up array of ext sett    *
     C*               methods.                                        *
     C*   Called by : SYSL,SINB,ALLB                                  *
     C*   Calls     : *PSSR                                           *
     C*****************************************************************
     C           INCR      BEGSR
      *
     C           *LIKE     DEFN CRMSGR    @MSGR
     C           *LIKE     DEFN INSETM    STMTA
     C                     Z-ADD1         HX
     C                     MOVE '0'       *IN55
      *
     C           @MSGR     IFEQ *ZEROS
      *
     C           STMTA     IFNE *BLANKS
     C           STMTA     ANDNE*ZEROS
     C           STMTA     LOKUP@SM,HX                   55
     C                     END
     C*
     C                     ELSE
     C           @MSGR     CHAIN@INCRL1              75
     C           *IN75     IFEQ '1'
     C                     Z-ADD80        DBASE            ***************
     C                     MOVEL'MEINCRL1'DBFILE           * DBERR 080   *
     C                     MOVEL@MSGR     DBKEY            ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
      *
     C           CRMTPY    IFEQ 'B10'
     C           CRMTPY    OREQ 'B22'
     C                     MOVE '1'       *IN55
     C                     END
      *
     C                     END
      *
     C                     ENDSR
     C*****************************************************************
     C/EJECT                                                              CFT014
      *****************************************************************   CFT014
      *                                                               *   CFT014
      *  SRCURR - Access Currency details                             *   CFT014
      *                                                               *   CFT014
      *  Called By: NAUG                                              *   CFT014
      *  Calls    : AOCURRR0, *PSSR                                   *   CFT014
      *                                                               *   CFT014
      *****************************************************************   CFT014
     C           SRCURR    BEGSR                                          CFT014
      *                                                                   CFT014
     C                     CALL 'AOCURRR0'                                CFT014
     C                     PARM *BLANKS   @RTCD                           CFT014
     C                     PARM '*KEY   ' @OPTN                           CFT014
     C                     PARM           @CCY                            CFT014
     C           SDCURR    PARM SDCURR    DSSDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C           *LOCK     IN   LDA                                       CFT014
     C                     Z-ADD111       DBASE                           CFT014
     C                     MOVEL@CCY      DBKEY                           CFT014
     C                     MOVEL'SDCURRPD'DBFILE                          CFT014
     C                     OUT  LDA                                       CFT014
     C                     EXSR *PSSR                                     CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDSR                                          CFT014
     C*******************************************************************
     C/EJECT                                                                                  CSW209
     *********************************************************************                    CSW209
      *                                                                  *                    CSW209
      *   SRSWF9 - Move cover message fields to details as part of       *                    CSW209
      *            SWIFT 2009 changes                                    *                    CSW209
      *                                                                  *                    CSW209
      *   Called by: NAUG                                                *                    CSW209
      *                                                                  *                    CSW209
      ********************************************************************                    CSW209
     C           SRSWF9    BEGSR                                                              CSW209
     C           *IN29     IFEQ '0'                                                           CSW209
      *                                                                                       CSW209
      ** Outgoing                                                                             CSW209
      ** Clear all fields                                                                     CSW209
     C                     EXSR CLSWF9                                                        CSW209
      *                                                                                       CSW209
     C           DHPREF    CHAINOTPAYXL0             63                                       CSW209
     C           *IN63     IFEQ '1'                                                           CSW209
     C                     Z-ADD70        DBASE            ***************                    CSW209
     C                     MOVEL'OTPAYXL0'DBFILE           * DBERR 070   *                    CSW209
     C                     MOVELDHPREF    DBKEY            ***************                    CSW209
     C                     OUT  LDA                                                           CSW209
     C                     EXSR *PSSR                                                         CSW209
     C                     END                                                                CSW209
      *                                                                                       CSW209
     C                     MOVELINUSR2    PTUSER                                              CSW209
     C                     MOVELPYTP      PTTYPE                                              CSW209
     C                     MOVELPYST      PTSUBT                                              CSW209
     C                     MOVELPREF      PTPREF                                              CSW209
      *                                                                                       CSW209
     C                     MOVELOPNWRK    P1NWRK                                              CSW209
     C                     MOVELOPMTPY    P1MTPY                                              CSW209
     C                     MOVELOPVALF    P1VALF                                              CSW209
     C                     MOVELOPOMVF    P1OMVF                                              CSW209
     C                     MOVELOPOCVF    P1OCVF                                              CSW209
      ** Sender to Reciever Info (Cover A)                                                    CSW209
     C                     MOVELOPOCB1    PSOCB1                                              CSW209
     C                     MOVELOPOCB2    PSOCB2                                              CSW209
     C                     MOVELOPOCB3    PSOCB3                                              CSW209
     C                     MOVELOPOCB4    PSOCB4                                              CSW209
     C                     MOVELOPOCB5    PSOCB5                                              CSW209
     C                     MOVELOPOCB6    PSOCB6                                              CSW209
      *                                                                                       CSW209
      ** If outgoing validation flag = 'COV'                                                  CSW209
      *                                                                                       CSW209
     C           OPOMVF    IFEQ 'COV'                                                         CSW209
      ** Check if there are details for cover message                                         CSW209
      *                                                                                       CSW209
     C           DOOCVF    IFNE *BLANKS                                                       CSW209
     C           DOCOC1    ORNE *BLANKS                                                       CSW209
     C           DOCOB1    ORNE *BLANKS                                                       CSW209
     C           DOCIB1    ORNE *BLANKS                                                       CSW209
     C           DOCAB1    ORNE *BLANKS                                                       CSW209
     C           DOCBC1    ORNE *BLANKS                                                       CSW209
     C           DOCDP1    ORNE *BLANKS                                                       CSW209
     C           DOCBB1    ORNE *BLANKS                                                       CSW209
     C           DOCICY    ORNE *BLANKS                                                       CSW209
     C           DOCIAM    ORNE *ZEROS                                                        CSW209
      *                                                                                       CSW209
      ** There are details on Cover Message                                                   CSW209
     C                     MOVEL'Y'       MYLMN   1                                           CSW209
      ** Ordering Customer (Cover)                                                            CSW209
     C                     MOVELOPCOC1    PSCOC1                                              CSW209
     C                     MOVELOPCOC2    PSCOC2                                              CSW209
     C                     MOVELOPCOC3    PSCOC3                                              CSW209
     C                     MOVELOPCOC4    PSCOC4                                              CSW209
     C                     MOVELOPCOC5    PSCOC5                                              CSW209
      ** Ordering Institution (Cover)                                                         CSW209
     C                     MOVELOPCOB1    PSCOB1                                              CSW209
     C                     MOVELOPCOB2    PSCOB2                                              CSW209
     C                     MOVELOPCOB3    PSCOB3                                              CSW209
     C                     MOVELOPCOB4    PSCOB4                                              CSW209
     C                     MOVELOPCOB5    PSCOB5                                              CSW209
      ** Intermediary Institution (Cover)                                                     CSW209
     C                     MOVELOPCIB1    PSCIB1                                              CSW209
     C                     MOVELOPCIB2    PSCIB2                                              CSW209
     C                     MOVELOPCIB3    PSCIB3                                              CSW209
     C                     MOVELOPCIB4    PSCIB4                                              CSW209
     C                     MOVELOPCIB5    PSCIB5                                              CSW209
      ** Account with Institution (Cover)                                                     CSW209
     C                     MOVELOPCAB1    PSCAB1                                              CSW209
     C                     MOVELOPCAB2    PSCAB2                                              CSW209
     C                     MOVELOPCAB3    PSCAB3                                              CSW209
     C                     MOVELOPCAB4    PSCAB4                                              CSW209
     C                     MOVELOPCAB5    PSCAB5                                              CSW209
      ** Beneficiary Customer (Cover)                                                         CSW209
     C                     MOVELOPCBC1    PSCBC1                                              CSW209
     C                     MOVELOPCBC2    PSCBC2                                              CSW209
     C                     MOVELOPCBC3    PSCBC3                                              CSW209
     C                     MOVELOPCBC4    PSCBC4                                              CSW209
     C                     MOVELOPCBC5    PSCBC5                                              CSW209
      ** Remittance Informatin (Cover)                                                        CSW209
     C                     MOVELOPCDP1    PSCDP1                                              CSW209
     C                     MOVELOPCDP2    PSCDP2                                              CSW209
     C                     MOVELOPCDP3    PSCDP3                                              CSW209
     C                     MOVELOPCDP4    PSCDP4                                              CSW209
      ** Sender to Receiver Information (Cover B)                                             CSW209
     C                     MOVELOPCBB1    PSCBB1                                              CSW209
     C                     MOVELOPCBB2    PSCBB2                                              CSW209
     C                     MOVELOPCBB3    PSCBB3                                              CSW209
     C                     MOVELOPCBB4    PSCBB4                                              CSW209
     C                     MOVELOPCBB5    PSCBB5                                              CSW209
     C                     MOVELOPCBB6    PSCBB6                                              CSW209
      ** Instructed Currency (Cover)                                                          CSW209
     C                     MOVELOPCICY    PSCICY                                              CSW209
      *                                                                                       CSW209
     C           OPCICY    IFNE *BLANKS                                                       CSW209
     C                     CALL 'AOCURRR0'                                                    CSW209
     C                     PARM *BLANKS   @RTCD                                               CSW209
     C                     PARM '*KEY   ' @OPTN                                               CSW209
     C                     PARM           OPCICY                                              CSW209
     C           SDCURR    PARM SDCURR    DSSDY                                               CSW209
      *                                                                                       CSW209
     C           @RTCD     IFNE *BLANKS                                                       CSW209
     C                     Z-ADD76        DBASE            ***************                    CSW209
     C                     MOVEL'SDCURRPD'DBFILE           * DBERR 076   *                    CSW209
     C                     MOVELOPCICY    DBKEY            ***************                    CSW209
     C                     OUT  LDA                                                           CSW209
     C                     EXSR *PSSR                                                         CSW209
     C                     ENDIF                                                              CSW209
     C                     MOVE A6NBDP    DDEC    10                                          CSW209
      ** Format amount                                                                        CSW209
     C                     MOVE OPCIAM    ZFIELD                                              CSW209
     C                     Z-ADDDDEC      ZADEC                                               CSW209
     C                     EXSR ZEDIT                                                         CSW209
      ** Instructed Amount (Cover)                                                            CSW209
     C                     MOVE ZFIELD    PSCIAM                                              CSW209
     C                     ENDIF                                                              CSW209
     C                     ENDIF                                                              CSW209
     C                     ENDIF                                                              CSW209
     C                     ELSE                                                               CSW209
      *                                                                                       CSW209
      ** Incoming                                                                             CSW209
      *                                                                                       CSW209
      ** Clear all fields                                                                     CSW209
     C                     EXSR CLSWF9                                                        CSW209
      *                                                                                       CSW209
     C           DHPREF    CHAININPAYXL0             63                                       CSW209
     C           *IN63     IFEQ '1'                                                           CSW209
     C                     Z-ADD71        DBASE            ***************                    CSW209
     C                     MOVEL'INPAYXL0'DBFILE           * DBERR 071   *                    CSW209
     C                     MOVELDHPREF    DBKEY            ***************                    CSW209
     C                     OUT  LDA                                                           CSW209
     C                     EXSR *PSSR                                                         CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     MOVELINUSR2    PTUSER                                              CSW209
     C                     MOVELPYTP      PTTYPE                                              CSW209
     C                     MOVELPYST      PTSUBT                                              CSW209
     C                     MOVELPREF      PTPREF                                              CSW209
      *                                                                                       CSW209
     C                     MOVELINVALF    P2VALF                                              CSW209
     C                     MOVELINNWRK    P2NWRK                                              CSW209
     C                     MOVELINMTPY    P2MTPY                                              CSW209
      *                                                                                       CSW209
      ** If incoming validation flag is 'COV'                                                 CSW209
      *                                                                                       CSW209
     C           INVALF    IFEQ 'COV'                                                         CSW209
      ** Check if there are details for cover message                                         CSW209
      *                                                                                       CSW209
     C           DICOC1    IFNE *BLANKS                                                       CSW209
     C           DICOB1    ORNE *BLANKS                                                       CSW209
     C           DICIB1    ORNE *BLANKS                                                       CSW209
     C           DICAB1    ORNE *BLANKS                                                       CSW209
     C           DICBC1    ORNE *BLANKS                                                       CSW209
     C           DICDP1    ORNE *BLANKS                                                       CSW209
     C           DICBB1    ORNE *BLANKS                                                       CSW209
     C           DICICY    ORNE *BLANKS                                                       CSW209
     C           DICIAM    ORNE *ZEROS                                                        CSW209
      ** There are details on Cover Message                                                   CSW209
     C                     MOVEL'Y'       MYLMN   1                                           CSW209
      ** Ordering Customer (Cover)                                                            CSW209
     C                     MOVELINCOC1    PSCOC1                                              CSW209
     C                     MOVELINCOC2    PSCOC2                                              CSW209
     C                     MOVELINCOC3    PSCOC3                                              CSW209
     C                     MOVELINCOC4    PSCOC4                                              CSW209
     C                     MOVELINCOC5    PSCOC5                                              CSW209
      ** Ordering Institution (Cover)                                                         CSW209
     C                     MOVELINCOB1    PSCOB1                                              CSW209
     C                     MOVELINCOB2    PSCOB2                                              CSW209
     C                     MOVELINCOB3    PSCOB3                                              CSW209
     C                     MOVELINCOB4    PSCOB4                                              CSW209
     C                     MOVELINCOB5    PSCOB5                                              CSW209
      ** Intermediary Institution (Cover)                                                     CSW209
     C                     MOVELINCIB1    PSCIB1                                              CSW209
     C                     MOVELINCIB2    PSCIB2                                              CSW209
     C                     MOVELINCIB3    PSCIB3                                              CSW209
     C                     MOVELINCIB4    PSCIB4                                              CSW209
     C                     MOVELINCIB5    PSCIB5                                              CSW209
      ** Account with Institution (Cover)                                                     CSW209
     C                     MOVELINCAB1    PSCAB1                                              CSW209
     C                     MOVELINCAB2    PSCAB2                                              CSW209
     C                     MOVELINCAB3    PSCAB3                                              CSW209
     C                     MOVELINCAB4    PSCAB4                                              CSW209
     C                     MOVELINCAB5    PSCAB5                                              CSW209
      ** Beneficiary Customer (Cover)                                                         CSW209
     C                     MOVELINCBC1    PSCBC1                                              CSW209
     C                     MOVELINCBC2    PSCBC2                                              CSW209
     C                     MOVELINCBC3    PSCBC3                                              CSW209
     C                     MOVELINCBC4    PSCBC4                                              CSW209
     C                     MOVELINCBC5    PSCBC5                                              CSW209
      ** Remittance Information (Cover)                                                       CSW209
     C                     MOVELINCDP1    PSCDP1                                              CSW209
     C                     MOVELINCDP2    PSCDP2                                              CSW209
     C                     MOVELINCDP3    PSCDP3                                              CSW209
     C                     MOVELINCDP4    PSCDP4                                              CSW209
      ** Sender to Receiver Information (Cover)                                               CSW209
     C                     MOVELINCBB1    PSCBB1                                              CSW209
     C                     MOVELINCBB2    PSCBB2                                              CSW209
     C                     MOVELINCBB3    PSCBB3                                              CSW209
     C                     MOVELINCBB4    PSCBB4                                              CSW209
     C                     MOVELINCBB5    PSCBB5                                              CSW209
     C                     MOVELINCBB6    PSCBB6                                              CSW209
      ** Instructed Currency (Cover)                                                          CSW209
     C                     MOVELINCICY    PSCICY                                              CSW209
      *                                                                                       CSW209
     C           INCICY    IFNE *BLANKS                                                       CSW209
     C                     CALL 'AOCURRR0'                                                    CSW209
     C                     PARM *BLANKS   @RTCD                                               CSW209
     C                     PARM '*KEY   ' @OPTN                                               CSW209
     C                     PARM           INCICY                                              CSW209
     C           SDCURR    PARM SDCURR    DSSDY                                               CSW209
      *                                                                                       CSW209
     C           @RTCD     IFNE *BLANKS                                                       CSW209
     C                     Z-ADD72        DBASE            ***************                    CSW209
     C                     MOVEL'SDCURRPD'DBFILE           * DBERR 072   *                    CSW209
     C                     MOVELINCICY    DBKEY            ***************                    CSW209
     C                     OUT  LDA                                                           CSW209
     C                     EXSR *PSSR                                                         CSW209
     C                     ENDIF                                                              CSW209
     C                     MOVE A6NBDP    DDEC                                                CSW209
      ** Format amount                                                                        CSW209
     C                     MOVE INCIAM    ZFIELD                                              CSW209
     C                     Z-ADDDDEC      ZADEC                                               CSW209
     C                     EXSR ZEDIT                                                         CSW209
      ** Instructed Currency                                                                  CSW209
     C                     MOVE ZFIELD    PSCIAM                                              CSW209
     C                     ENDIF                                                              CSW209
     C                     ENDIF                                                              CSW209
     C                     ENDIF                                                              CSW209
     C                     ENDIF                                                              CSW209
     C                     ENDSR                                                              CSW209
     C********************************************************************                    CSW209
     C/EJECT                                                                                  CSW209
     *********************************************************************                    CSW209
      *                                                                  *                    CSW209
      *   CLSWF9 - Clear all the fields of the cover message.            *                    CSW209
      *                                                                  *                    CSW209
      *                                                                  *                    CSW209
      *   Called by: NAUG                                                *                    CSW209
      *                                                                  *                    CSW209
      ********************************************************************                    CSW209
     C           CLSWF9    BEGSR                                                              CSW209
     C                     MOVEL'N'       MYLMN   1                                           CSW209
     C                     MOVEL*BLANKS   PTUSER                                              CSW209
     C                     MOVEL*BLANKS   PTTYPE                                              CSW209
     C                     MOVEL*BLANKS   PTSUBT                                              CSW209
     C                     MOVEL*BLANKS   PTPREF                                              CSW209
      ** Outgoing Payments                                                                    CSW209
     C                     MOVEL*BLANKS   P1NWRK                                              CSW209
     C                     MOVEL*BLANKS   P1MTPY                                              CSW209
     C                     MOVEL*BLANKS   P1VALF                                              CSW209
     C                     MOVEL*BLANKS   P1OMVF                                              CSW209
     C                     MOVEL*BLANKS   P1OCVF                                              CSW209
      ** Incoming Payments                                                                    CSW209
     C                     MOVEL*BLANKS   P2VALF                                              CSW209
     C                     MOVEL*BLANKS   P2NWRK                                              CSW209
     C                     MOVEL*BLANKS   P2MTPY                                              CSW209
      ** Ordering Customer (Cover)                                                            CSW209
     C                     MOVEL*BLANKS   PSCOC1                                              CSW209
     C                     MOVEL*BLANKS   PSCOC2                                              CSW209
     C                     MOVEL*BLANKS   PSCOC3                                              CSW209
     C                     MOVEL*BLANKS   PSCOC4                                              CSW209
     C                     MOVEL*BLANKS   PSCOC5                                              CSW209
      ** Ordering Institution (Cover)                                                         CSW209
     C                     MOVEL*BLANKS   PSCOB1                                              CSW209
     C                     MOVEL*BLANKS   PSCOB2                                              CSW209
     C                     MOVEL*BLANKS   PSCOB3                                              CSW209
     C                     MOVEL*BLANKS   PSCOB4                                              CSW209
     C                     MOVEL*BLANKS   PSCOB5                                              CSW209
      ** Intermediary Institution (Cover)                                                     CSW209
     C                     MOVEL*BLANKS   PSCIB1                                              CSW209
     C                     MOVEL*BLANKS   PSCIB2                                              CSW209
     C                     MOVEL*BLANKS   PSCIB3                                              CSW209
     C                     MOVEL*BLANKS   PSCIB4                                              CSW209
     C                     MOVEL*BLANKS   PSCIB5                                              CSW209
      ** Account with Institution (Cover)                                                     CSW209
     C                     MOVEL*BLANKS   PSCAB1                                              CSW209
     C                     MOVEL*BLANKS   PSCAB2                                              CSW209
     C                     MOVEL*BLANKS   PSCAB3                                              CSW209
     C                     MOVEL*BLANKS   PSCAB4                                              CSW209
     C                     MOVEL*BLANKS   PSCAB5                                              CSW209
      ** Beneficiary Customer (Cover)                                                         CSW209
     C                     MOVEL*BLANKS   PSCBC1                                              CSW209
     C                     MOVEL*BLANKS   PSCBC2                                              CSW209
     C                     MOVEL*BLANKS   PSCBC3                                              CSW209
     C                     MOVEL*BLANKS   PSCBC4                                              CSW209
     C                     MOVEL*BLANKS   PSCBC5                                              CSW209
      ** Remittance Information (Cover)                                                       CSW209
     C                     MOVEL*BLANKS   PSCDP1                                              CSW209
     C                     MOVEL*BLANKS   PSCDP2                                              CSW209
     C                     MOVEL*BLANKS   PSCDP3                                              CSW209
     C                     MOVEL*BLANKS   PSCDP4                                              CSW209
      ** Sender to Receiver Information (Cover A)                                             CSW209
     C                     MOVEL*BLANKS   PSCBB1                                              CSW209
     C                     MOVEL*BLANKS   PSCBB2                                              CSW209
     C                     MOVEL*BLANKS   PSCBB3                                              CSW209
     C                     MOVEL*BLANKS   PSCBB4                                              CSW209
     C                     MOVEL*BLANKS   PSCBB5                                              CSW209
     C                     MOVEL*BLANKS   PSCBB6                                              CSW209
      ** Sender to Receiver Information (Cover B)                                             CSW209
     C                     MOVEL*BLANKS   PSOCB1                                              CSW209
     C                     MOVEL*BLANKS   PSOCB2                                              CSW209
     C                     MOVEL*BLANKS   PSOCB3                                              CSW209
     C                     MOVEL*BLANKS   PSOCB4                                              CSW209
     C                     MOVEL*BLANKS   PSOCB5                                              CSW209
     C                     MOVEL*BLANKS   PSOCB6                                              CSW209
      ** Instructed Currency                                                                  CSW209
     C                     MOVEL*BLANKS   PSCICY                                              CSW209
      ** Instructed Amount                                                                    CSW209
     C                     MOVEL*BLANKS   PSCIAM                                              CSW209
     C                     ENDSR                                                              CSW209
     *********************************************************************                    CSW209
     C/EJECT                                                                                  CSW209
     *********************************************************************                    CSW209
      *                                                                  *                    CSW209
      *   WRCOV3 - Write cover message information details to FT0803P3   *                    CSW209
      *                                                                  *                    CSW209
      *                                                                  *                    CSW209
      *   Called by: SYSL, SINB, ALLB                                    *                    CSW209
      *                                                                  *                    CSW209
      ********************************************************************                    CSW209
     C           WRCOV3    BEGSR                                                              CSW209
     C           *IN52     IFEQ '1'                                                           CSW209
     C           MYLMN     ANDNE'N'                                                           CSW209
     C           INVALF    IFEQ 'COV'                                                         CSW209
     C           OPOMVF    OREQ 'COV'                                                         CSW209
     C                     WRITEPKCOVM                                                        CSW209
     C                     ENDIF                                                              CSW209
     C                     ENDIF                                                              CSW209
     C                     ENDSR                                                              CSW209
      ********************************************************************                    CSW209
     C/EJECT                                                                                  CSW209
     *********************************************************************                    CSW209
      *                                                                  *                    CSW209
      *   WRCOV2 - Write all details to fields.                          *                    CSW209
      *                                                                  *                    CSW209
      *                                                                  *                    CSW209
      *   Called by: SYSL, SINB, ALLB                                    *                    CSW209
      *                                                                  *                    CSW209
      ********************************************************************                    CSW209
     C           WRCOV2    BEGSR                                                              CSW209
     C           *IN52     IFEQ '1'                                                           CSW209
     C                     WRITEPTNTWK                                                        CSW209
     C           MYLMN     IFNE 'N'                                                           CSW209
     C           OPOMVF    IFEQ 'COV'                                                         CSW209
     C           INVALF    OREQ 'COV'                                                         CSW209
     C                     WRITEPTCOVM                                                        CSW209
     C                     ENDIF                                                              CSW209
     C                     ENDIF                                                              CSW209
     C                     ENDIF                                                              CSW209
     C                     ENDSR                                                              CSW209
     *********************************************************************                    CSW209
     C/EJECT
      *****************************************************************                       CRE020
      *                                                               *                       CRE020
      *  SRADVC - Update Retail Advice Index File                     *                       CRE020
      *                                                               *                       CRE020
      *****************************************************************                       CRE020
      *                                                                                       CRE020
     C           SRADVC    BEGSR                                                              CRE020
      *                                                                                       CRE020
     C                     OPEN READVCL1                                                      CRE020
     C           *HIVAL    SETLLREADVCL1                                                      CRE020
      *                                                                                       CRE020
     C                     MOVE *BLANKS   RREFNO                                              CRE020
     C                     MOVE *BLANKS   RSEQNO                                              CRE020
     C                     MOVELPREF      RREFNO                                              CRE020
     C                     MOVE 'N'       RSAPIN                                              CRE020
     C                     MOVELPYTP      RTRTYP                                              CRE020
     C                     MOVE 'I'       RCHTYP                                              CRE020
     C                     MOVE 'Y'       RAUTHI                                              CRE020
      *                                                                                       CRE020
      ** Write three records - Debit, Credit and Charges                                      CRE020
      *                                                                                       CRE020
     C                     DO   3         WIDX    10                                          CRE020
     C                     MOVE DCC,WIDX  RSEQNO                                              CRE020
     C                     WRITEREADVCD0                                                      CRE020
     C                     ENDDO                                                              CRE020
      *                                                                                       CRE020
     C                     CLOSEREADVCL1                                                      CRE020
      *                                                                                       CRE020
     C                     ENDSR                                                              CRE020
      *****************************************************************                       CRE020
     C/EJECT                                                                                  CRE020
      *****************************************************************                       CER030
      *                                                               *                       CER030
      *  POPINR - Populate Incoming Extended Narrative                *                       CER030
      *                                                               *                       CER030
      *  Called by : AUGN,NAUG                                        *                       CER030
      *                                                               *                       CER030
      *  Calls : None                                                 *                       CER030
      *                                                               *                       CER030
      *****************************************************************                       CER030
      *                                                                                       CER030
     C           POPINR    BEGSR                                                              CER030
      *                                                                                       CER030
      ** Populate Extended Narratives(Credit) - FT0803P1                                      CER030
      *                                                                                       CER030
     C           *IN52     IFEQ *OFF                                                          CER030
     C                     MOVE IEXT1     P1EXC1                                              CER030
     C                     MOVE IEXT2     P1EXC2                                              CER030
     C                     MOVE IEXT3     P1EXC3                                              CER030
     C                     MOVE IEXT4     P1EXC4                                              CER030
     C                     MOVE IEXT5     P1EXC5                                              CER030
     C                     MOVE IEXT6     P1EXC6                                              CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      ** Populate Extended Narratives(Credit) - FT0803P2                                      CER030
      *                                                                                       CER030
     C           *IN52     IFEQ *ON                                                           CER030
     C                     MOVE IEXT1     P2EXC1                                              CER030
     C                     MOVE IEXT2     P2EXC2                                              CER030
     C                     MOVE IEXT3     P2EXC3                                              CER030
     C                     MOVE IEXT4     P2EXC4                                              CER030
     C                     MOVE IEXT5     P2EXC5                                              CER030
     C                     MOVE IEXT6     P2EXC6                                              CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      ** Populate Extended Narratives(Credit) - FT0803P3                                      CER030
      *                                                                                       CER030
     C           *IN31     IFEQ *ON                                                           CER030
     C           *IN32     OREQ *ON                                                           CER030
     C           *IN33     OREQ *ON                                                           CER030
     C                     MOVE IEXT1     P3EXC1                                              CER030
     C                     MOVE IEXT2     P3EXC2                                              CER030
     C                     MOVE IEXT3     P3EXC3                                              CER030
     C                     MOVE IEXT4     P3EXC4                                              CER030
     C                     MOVE IEXT5     P3EXC5                                              CER030
     C                     MOVE IEXT6     P3EXC6                                              CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDSR                                                              CER030
      *                                                                                       CER030
      *****************************************************************                       CER030
      /EJECT                                                                                  CER030
      *****************************************************************                       CER030
      *                                                               *                       CER030
      *  POPONR - Populate Outgoing Extended Narrative                *                       CER030
      *                                                               *                       CER030
      *  Called by : AUGN,NAUG                                        *                       CER030
      *                                                               *                       CER030
      *  Calls : None                                                 *                       CER030
      *                                                               *                       CER030
      *****************************************************************                       CER030
      *                                                                                       CER030
     C           POPONR    BEGSR                                                              CER030
      *                                                                                       CER030
      ** Populate Extended Narratives(Debit) - FT0803P1                                       CER030
      *                                                                                       CER030
     C           *IN52     IFEQ *OFF                                                          CER030
     C                     MOVE OPEXT1    P1EXD1                                              CER030
     C                     MOVE OPEXT2    P1EXD2                                              CER030
     C                     MOVE OPEXT3    P1EXD3                                              CER030
     C                     MOVE OPEXT4    P1EXD4                                              CER030
     C                     MOVE OPEXT5    P1EXD5                                              CER030
     C                     MOVE OPEXT6    P1EXD6                                              CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      ** Populate Extended Narratives(Debit) - FT0803P2                                       CER030
      *                                                                                       CER030
     C           *IN52     IFEQ *ON                                                           CER030
     C                     MOVE OPEXT1    P2EXD1                                              CER030
     C                     MOVE OPEXT2    P2EXD2                                              CER030
     C                     MOVE OPEXT3    P2EXD3                                              CER030
     C                     MOVE OPEXT4    P2EXD4                                              CER030
     C                     MOVE OPEXT5    P2EXD5                                              CER030
     C                     MOVE OPEXT6    P2EXD6                                              CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      ** Populate Extended Narratives(Debit) - FT0803P3                                       CER030
      *                                                                                       CER030
     C           *IN31     IFEQ *ON                                                           CER030
     C           *IN32     OREQ *ON                                                           CER030
     C           *IN33     OREQ *ON                                                           CER030
     C                     MOVE OPEXT1    P3EXD1                                              CER030
     C                     MOVE OPEXT2    P3EXD2                                              CER030
     C                     MOVE OPEXT3    P3EXD3                                              CER030
     C                     MOVE OPEXT4    P3EXD4                                              CER030
     C                     MOVE OPEXT5    P3EXD5                                              CER030
     C                     MOVE OPEXT6    P3EXD6                                              CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           CFT003    IFEQ 'Y'                                                           CER030
      *                                                                                       CER030
      ** Populate Extended Narratives(Credit) - FT0803P1                                      CER030
      *                                                                                       CER030
     C           *IN52     IFEQ *OFF                                                          CER030
     C                     MOVE OPEXC1    P1EXC1                                              CER030
     C                     MOVE OPEXC2    P1EXC2                                              CER030
     C                     MOVE OPEXC3    P1EXC3                                              CER030
     C                     MOVE OPEXC4    P1EXC4                                              CER030
     C                     MOVE OPEXC5    P1EXC5                                              CER030
     C                     MOVE OPEXC6    P1EXC6                                              CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      ** Populate Extended Narratives(Credit) - FT0803P2                                      CER030
      *                                                                                       CER030
     C           *IN52     IFEQ *ON                                                           CER030
     C                     MOVE OPEXC1    P2EXC1                                              CER030
     C                     MOVE OPEXC2    P2EXC2                                              CER030
     C                     MOVE OPEXC3    P2EXC3                                              CER030
     C                     MOVE OPEXC4    P2EXC4                                              CER030
     C                     MOVE OPEXC5    P2EXC5                                              CER030
     C                     MOVE OPEXC6    P2EXC6                                              CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      ** Populate Extended Narratives(Credit) - FT0803P3                                      CER030
      *                                                                                       CER030
     C           *IN31     IFEQ *ON                                                           CER030
     C           *IN32     OREQ *ON                                                           CER030
     C           *IN33     OREQ *ON                                                           CER030
     C                     MOVE OPEXC1    P3EXC1                                              CER030
     C                     MOVE OPEXC2    P3EXC2                                              CER030
     C                     MOVE OPEXC3    P3EXC3                                              CER030
     C                     MOVE OPEXC4    P3EXC4                                              CER030
     C                     MOVE OPEXC5    P3EXC5                                              CER030
     C                     MOVE OPEXC6    P3EXC6                                              CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDSR                                                              CER030
      *                                                                                       CER030
      *****************************************************************                       CER030
      /EJECT                                                                                  CER030
      *****************************************************************                       CER030
      *                                                               *                       CER030
      *  POPRTY - Populate Transaction Type                           *                       CER030
      *                                                               *                       CER030
      *  Called by : AUGN,NAUG                                        *                       CER030
      *                                                               *                       CER030
      *  Calls : None                                                 *                       CER030
      *                                                               *                       CER030
      *****************************************************************                       CER030
      *                                                                                       CER030
     C           POPRTY    BEGSR                                                              CER030
      *                                                                                       CER030
      ** Outgoing Payment                                                                     CER030
      *                                                                                       CER030
     C           *IN29     IFEQ *OFF                                                          CER030
      *                                                                                       CER030
      ** Populate Transaction Type - FT0803P1                                                 CER030
      *                                                                                       CER030
     C           *IN52     IFEQ *OFF                                                          CER030
     C                     MOVE OPRTTY    P1RTTY                                              CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      ** Populate Transaction Type - FT0803P2                                                 CER030
      *                                                                                       CER030
     C           *IN52     IFEQ *ON                                                           CER030
     C                     MOVE OPRTTY    P2RTTY                                              CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      ** Populate Transaction Type - FT0803P3                                                 CER030
      *                                                                                       CER030
     C           *IN31     IFEQ *ON                                                           CER030
     C           *IN32     OREQ *ON                                                           CER030
     C           *IN33     OREQ *ON                                                           CER030
     C                     MOVE OPRTTY    P3RTTY                                              CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      ** Incoming Payment                                                                     CER030
      *                                                                                       CER030
     C                     ELSE                                                               CER030
      *                                                                                       CER030
      ** Populate Transaction Type - FT0803P1                                                 CER030
      *                                                                                       CER030
     C           *IN52     IFEQ *OFF                                                          CER030
     C                     MOVE IRTTY     P1RTTY                                              CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      ** Populate Transaction Type - FT0803P2                                                 CER030
      *                                                                                       CER030
     C           *IN52     IFEQ *ON                                                           CER030
     C                     MOVE IRTTY     P2RTTY                                              CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      ** Populate Transaction Type - FT0803P3                                                 CER030
      *                                                                                       CER030
     C           *IN31     IFEQ *ON                                                           CER030
     C           *IN32     OREQ *ON                                                           CER030
     C           *IN33     OREQ *ON                                                           CER030
     C                     MOVE IRTTY     P3RTTY                                              CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDSR                                                              CER030
      *                                                                                       CER030
      *****************************************************************                       CER030
      /EJECT                                                                                  CER030
      *****************************************************************                       CER030
     C/COPY ZSRSRC,ZDATE2Z2
     C/COPY ZSRSRC,ZFRPEDZ3
     C/COPY ZSRSRC,ZEDITZ2
     C**************************************************************************
     C*
     O/EJECT
      *
     OOTPAYDDFE                OTPAYF
     O                         LCHT
     O                         LCD
     O                         AUP1
     O                         AUIN
      *
     OINPAYDDFE                INPAYF
     O                         LCHT
     O                         LCD
     O                         AUP1
     O                         AUIN
      *
     OOTPAYZZFE                OTPAYZ
     O                         NORE1
     O                         HRWN
     O                         HRDC
     C/EJECT
     C/COPY ZSRSRC,ZDATE2Z3
** CPY@   **      Object copyright
(c) Finastra International Limited 2001
** HKA    **      Array to hold Remarks for printer file
<< Swift Address not on File >>
**   POWER - ARRAY OF POWERS OF 10 FOR CURRENCY CONVERSIONS
0000001
0000010
0000100
0001000
0010000
0100000
1000000
**   @DFT - Default Text
**** FUNDS FROM ****
**  Error text
Error occurred on call to program - see dumps for further details
** DCC - Debit/Credit/Charges Text                                                            CRE020
001                                                                                           CRE020
002                                                                                           CRE020
003                                                                                           CRE020
