     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas FT Check if outstanding batch exist')
      *****************************************************************
      *                                                               *
      *  Midas - Funds Transfer Module                                *
      *                                                               *
      *  FT0809 - Check if Outstanding Batch Exists                   *
      *                                                               *
      *  Function:  To re-open input cycle if outstanding batch exists*
      *                                                               *
      *  Called by: SCC0400 - System control                          *
      *                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
      *                                                               *
      *  Last Amend No. MD045438           Date 02May17               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *  Prev Amend No. CFT003  *CREATE    Date 30APR98               *
      *                                                               *
      *---------------------------------------------------------------*
      *                                                               *
      *  MD045438 - Unable to start COB due to Outstanding Payments   *
      *             issue.                                            *
      *  CFT003 - FT Batch Authorisation                              *
      *           Based on FTH009 original reference HUB01B           *
      *                                                               *
      *****************************************************************
      *
     FFTCONTPDIF  E                    DISK
      *
     F/EJECT
      *****************************************************************
      *                                                               *
      * ID F  C  H  L    FUNCTION OF INDICATORS                       *
      *                                                               *
      *       10         EOF FTCONTPD                                 *
      *                                                               *
      *****************************************************************
     E/EJECT
      *
     E                    CPY@    1   1 80               Copyright array
      *
     C/EJECT
      *================================================================
      *  P R O G R A M   S T A R T                                    *
      *================================================================
      *
      ** Copyright insertion
      *
     C                     MOVEACPY@      BIS@   80
      *
     C           *ENTRY    PLIST
     C                     PARM           @HCONT  1
      *
     C                     SETOF                     10
      *
      ** Read FTCONTPD until EOF reached or until no outstanding batch
      ** is found.
      *
     C                     MOVE 'N'       @HCONT                                            MD045438
      *                                                                                     MD045438
     C                     READ FTCONTPD                 10
     C           *IN10     DOWNE'1'
     C********** COSTAT    ANDNE'R'                                                         MD045438
     C**********           READ FTCONTPD                 10                                 MD045438
     C**********           END                                                              MD045438
      *
      ***If*EOF*is*reached*then*no*Outstanding*batch.
      *
     C********** *IN10     IFEQ '1'                                                         MD045438
     C**********           MOVE 'N'       @HCONT                                            MD045438
     C**********           END                                                              MD045438
      *
      ** If a record with COSTAT = R is found, there is an outstanding
      ** batch.
      *
     C           COSTAT    IFEQ 'R'
     C           CONREC    ANDNE0                                                           MD045438
     C           COBATN    ANDNE' '                                                         MD045438
     C           COTMID    ANDNE' '                                                         MD045438
     C           COUSER    ANDNE' '                                                         MD045438
     C                     MOVE 'Y'       @HCONT
     C                     LEAVE                                                            MD045438
     C                     END
      *
     C                     READ FTCONTPD                 10                                 MD045438
      *
     C                     ENDDO                                                            MD045438
      *                                                                                     MD045438
     C                     SETON                         LR
      *
      *****************************************************************
** CPY@   **      Object copyright
(c) Misys International Banking Systems Ltd. 2001
