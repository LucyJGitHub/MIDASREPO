     H        1
     F*****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas FT Daily reorganisation')                        *
     F*****************************************************************
     F*                                                               *
     F*  Midas - Funds Transfer Module                                *
     F*                                                               *
     F*  FT1000 - Daily Reorganisation                                *
     F*                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. CSD103             Date 10Aug20               *
      *  Prev Amend No. MD046248           Date 27Oct17               *
      *                 CAP212             Date 15Sep14               *
      *                 CFT157             Date 29Aug14               *
      *                 CFT120             Date 28Sep12               *
      *                 AR655670           Date 29Nov10               *
      *                 CRE075             Date 06Dec10               *
      *                 CER059             Date 19Jul10               *
      *                 BUG24029           Date 20May09               *
      *                 CER054             Date 07Apr09               *
      *                 BUG22580           Date 02Feb09               *
      *                 CER048             Date 19May08               *
      *                 CER047             Date 19May08               *
      *                 CER030             Date 09Jul08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 CSW209             Date 01Apr09               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 CSW207             Date 08Jun07               *
      *                 CRE026             Date 24May06               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CFT032             Date 11Sep06               *
      *                 CDL049             Date 07Jul06               *
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 BUG433             Date 05Dec05               *
      *                 BUG7985            Date 07Jul05               *
      *                 BUG4776            Date 15Nov04               *
      *                 TDA035             Date 02Apr04               *
      *                 CGL029             Date 01Sep03               *
      *                 CSW203             Date 26May03               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.05 -----------------------------------------------*
      *                 192300             Date 18Apr01               *
      *                 CFT009             Date 06Jul00               *
      * Midas DBA 3.04 -----------------------------------------------*
      *                 CFT014             Date 25May00               *
      * Midas DBA 3.03 -----------------------------------------------*
      *                 CAP136             Date 15Nov99               *
      *                 175479             Date 07Feb00               *
      * Midas DBA 3.02 -----------------------------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
     F*                 CFT003             Date 16Nov98               *
     F*                 CEU013             Date 29May98               *
     F*                 CEU006             DATE 29MAY98               *
     F*                 111825             DATE 17SEP97               *
     F*                 103513             DATE 22APR94               *
     F*                 S01408             DATE 22JAN96               *
     F*                 S01408             DATE 10NOV95               *
     F*                 S01499             DATE 06JUN94               *
     F*                 S01494             DATE 25MAY94               *
     F*                 S01435             DATE 08SEP93               *
     F*                 S01414             DATE 29MAR93               *
     F*                 E32894             DATE 07JUN91               *   E32894
     F*                 E32873             DATE 01MAY91               *   E32873
     F*                 E32839             DATE 25APR91               *   E32839
     F*                 S01117             DATE 26NOV90               *   S01117
     F*                 S01194             DATE 26NOV90               *   S01194
     F*                                                               *
     F*---------------------------------------------------------------*
      *                                                               *
      *  CSD103 - LIBOR Deregulation - Common Layer/Standing Data     *
      *  MD046248 - Finastra Rebranding                               *
      *  CAP212 - FT Nostro Transfer API (Recompile)                  *
      *  CFT157 - Stop FT Transaction after Authorisation.            *
      *  CFT120 - FT IN/OP - Charges to DR of Account Currency        *
      *  AR655670 - FTC1000 00001 component failed due to printer     *
      *           overflow. Ensure that no printer overflow will be   *
      *           encountered in FT1000 reports. Applied fix 263244.  *
      *           (Child: AR655671)                                   *
      *  CRE075 - Effective Date for Retail Accounts (Recompile)      *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  BUG24029 - COB Error RE3662 Database Error                   *
      *  CER054 - German Features - Church Tax (Recompile)            *
      *  BUG22580 - Fields incorrectly labeled and lengths            *
      *           (Recompile)                                         *
      *  CER048 - German Features - Taxes (Recompile)                 *
      *  CER047 - German Features LF037-00 Reporting §24c KWG         *
      *           (Recompile)                                         *
      *  CER030 - Multicash German Feature                            *
      *  CSW209 - SWIFT 2009 Changes                                  *
      *  CSW207 - SWIFT 2007 Changes                                  *
      *  CRE026 - Consumer Banking (Recompile)                        *
      *  CFT032 - Account Line in Field 50X in MT103                  *
      *  CDL049 - Addition of a Reference Rate field (recompile)      *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  BUG433 - Recompiled due to change in FTPCHGPD                *
      *  BUG7985- Several components failed due to accessing TABLETR  *
      *  BUG4776- Correct skipping of transaction reference.          *
      *  TDA035 - RTS Signon changes for MidasPlus. (Recompile)       *
      *  CGL029 - Increase Account Code to 10 digits (Recompile)      *
      *  CSW203 - SWIFT 2003 Standards Update                         *
      *  192300 - If CFT003 and CFT014 are both off, file OTPAYXL0    *
      *           is not opened but there is a CHAIN to the file      *
      *           which is unconditioned so CoB fails I/O error.      *
      *           Also allow chain to INPAYXL0 and OTPAYXL0 if CFT009 *
      *           is turned on.                                       *
      *  CFT009 - FT Fees and Charge Development                      *
      *  CFT014 - Straight-through Processing Phase 2 MT103 Messages  *
      *           Generation for FT                                   *
      *  CAP136 - Conversion of FT Incoming Payment inputs into       *
      *           modular structure to use as APIs.                   *
      *  175479 - Incorporate Fontis : dealer's reference             *
     F*   CFT003 - FT Batch Authorisation                             *   CFT003
     F*   CEU013 - EMU Account Posting Narrative. Recompile.          *
     F*   CEU006 - FT EMU Payments and Settlements(Recompilation)     *
     F*   111825 - OEDT CORRUPTED ON FT TRANSACTION FILES             *   E32873
     F*   103513 - Correct formatting of Entered currency             *
     F*   S01408 - Core hook FT1000CCP2 added                         *
     F*            Core hook FT1000FFP2 added                         *
     F*   S01408 - Core hook FT1000CCP1 added                         *
     F*            Core hook FT1000FFP1 added                         *
     F*            Core hook FT1000IIP1 added                         *
     F*   S01499 - BLI V.A.T. Processing                              *
     F*   S01494 - BLI Funds Transfer Enhancements                    *
     F*   S01435 - Incoming Message Management.                       *
     F*   S01414 - Book Code and Profit Centre Incorporation.         *
     F*   E32894 - PROGRAM CHANGED TO UPDATE IN PLACE SO THAT THE     *   E32894
     F*            COMPONANT IS RESTARTABLE                           *   E32894
     F*   E32873 - LCD, AND CHTP ALSO CORRUPTED ON FT TRANSACTION     *   E32873
     F*            FILES.                                             *   E32873
     F*   E32839 - RECI is corrupted on FT transaction files due to   *   E32839
     F*            careless processing of other files containing      *   E32839
     F*            field RECI                                         *   E32839
     F*   S01117 - CHANGES FOR MULTIBRANCHING, RCF PROCESSING         *   S01117
     F*   S01194 - STANDING DATA CHANGES                              *   S01194
     F*                                                               *
     F*****************************************************************
     F*INPAYDD*IP**E***********K        DISK                              E32894
     F*INPAYZZ*IS**E***********K        DISK                              E32894
     F*OTPAYDD*IS**E***********K        DISK                              E32894
     F*OTPAYZZ*IS**E***********K        DISK                              E32894
     F*CQCODDD*IS**E***********K        DISK                              E32894
     F*CQCODZZ*IS**E***********K        DISK                              E32894
     F*CQCOCDD*IS**E***********K        DISK                              E32894
     F*CQCOCZZ*IS**E***********K        DISK                              E32894
     F*CQPACDD*IS**E***********K        DISK                              E32894
     F*CQPACZZ*IS**E***********K        DISK                              E32894
     F*CQPADDD*IS**E***********K        DISK                              E32894
     F*CQPADZZ*IS**E***********K        DISK                              E32894
     F*NTRANDD*IS**E***********K        DISK                              E32894
     F*NTRANZZ*IS**E***********K        DISK                              E32894
     FINPAYDD UP  E           K        DISK                               E32894
     FINPAYZZ US  E           K        DISK                               E32894
     FOTPAYDD US  E           K        DISK                               E32894
     FOTPAYZZ US  E           K        DISK                               E32894
     FCQCODDD US  E           K        DISK                               E32894
     FCQCODZZ US  E           K        DISK                               E32894
     FCQCOCDD US  E           K        DISK                               E32894
     FCQCOCZZ US  E           K        DISK                               E32894
     FCQPACDD US  E           K        DISK                               E32894
     FCQPACZZ US  E           K        DISK                               E32894
     FCQPADDD US  E           K        DISK                               E32894
     FCQPADZZ US  E           K        DISK                               E32894
     FNTRANDD US  E           K        DISK                               E32894
     FNTRANZZ US  E           K        DISK                               E32894
     FCLINT   IF  E           K        DISK
     F            CLINTCAF                          KIGNORE
     F            CLINTCBF                          KIGNORE
     FTABFP   IF  E           K        DISK
     F            TABTB20F                          KIGNORE
     F            TABTG20F                          KIGNORE
     F************TABLETJF                          KIGNORE               S01117
     F            TABLETPF                          KIGNORE
     F            TABLET5F                          KIGNORE
     F************TABLETRF                          KIGNORE               S01117
     F            TABLETLF                          KIGNORE
     F            TABLETHF                          KIGNORE
     F            TABTE10F                          KIGNORE
     F*INPAYDDXO***E***********K        DISK                      A       E32894
     F************INPAYDDF*****                     KRENAMEXNPAYDDF       E32894
     F*INPAYZZXO***E***********K        DISK                      A       E32894
     F************INPAYZZF*****                     KRENAMEXNPAYZZF       E32894
     F*OTPAYDDXO***E***********K        DISK                      A       E32894
     F************OTPAYDDF*****                     KRENAMEXTPAYDDF       E32894
     F*OTPAYZZXO***E***********K        DISK                      A       E32894
     F************OTPAYZZF*****                     KRENAMEXTPAYZZF       E32894
     F*CQCODDDXO***E***********K        DISK                      A       E32894
     F************CQCODDDF*****                     KRENAMEXQCODDDF       E32894
     F*CQCODZZXO***E***********K        DISK                      A       E32894
     F************CQCODZZF*****                     KRENAMEXQCODZZF       E32894
     F*CQCOCDDXO***E***********K        DISK                      A       E32894
     F************CQCOCDDF*****                     KRENAMEXQCOCDDF       E32894
     F*CQCOCZZXO***E***********K        DISK                      A       E32894
     F************CQCOCZZF*****                     KRENAMEXQCOCZZF       E32894
     F*CQPACDDXO***E***********K        DISK                      A       E32894
     F************CQPACDDF*****                     KRENAMEXQPACDDF       E32894
     F*CQPACZZXO***E***********K        DISK                      A       E32894
     F************CQPACZZF*****                     KRENAMEXQPACZZF       E32894
     F*CQPADDDXO***E***********K        DISK                      A       E32894
     F************CQPADDDF*****                     KRENAMEXQPADDDF       E32894
     F*CQPADZZXO***E***********K        DISK                      A       E32894
     F************CQPADZZF*****                     KRENAMEXQPADZZF       E32894
     F*NTRANDDXO***E***********K        DISK                      A       E32894
     F************NTRANDDF*****                     KRENAMEXTRANDDF       E32894
     F*NTRANZZXO***E***********K        DISK                      A       E32894
     F************NTRANZZF*****                     KRENAMEXTRANZZF       E32894
     F*FT1000P1O***E********************PRINTER                           S01117
     F*FT1000P2O***E********************PRINTER                           S01117
     F*FT1000P3O***E********************PRINTER                           S01117
     F*FT1000P4O***E********************PRINTER                           S01117
     F*FT1000P5O***E********************PRINTER                           S01117
     F*FT1000P6O***E********************PRINTER                           S01117
     F*                                                                   S01408
     F/COPY WNCPYSRC,FT1000FFP1                                           S01408
     F*                                                                   S01408
     FFT1000AUO   E                    PRINTER      KINFDS SPOOLU         S01117
     FFT1000P2O   E                    PRINTER      KINFDS SPOOL2         S01117
     FFT1000P3O   E                    PRINTER      KINFDS SPOOL3         S01117
     FFT1000P4O   E                    PRINTER      KINFDS SPOOL4         S01117
     FFT1000P5O   E                    PRINTER      KINFDS SPOOL5         S01117
     FFT1000P6O   E                    PRINTER      KINFDS SPOOL6         S01117
     F*                                                                   S01408
     F/COPY WNCPYSRC,FT1000FFP2                                           S01408
     F*                                                                   S01408
     FMUSER   IF  E           K        DISK
     FOTPAYXL0UF  E           K        DISK                           UC  CFT003
      * Extension file to OTPAYDD                                         CFT003
     FINPAYXL0UF  E           K        DISK                           UC  CFT003
      * Extension file to INPAYDD                                         CFT003
     FFTPCHGL0IF  E           K        DISK                               CFT009
      * Payment charge defs.                                              CFT009
     FFTPREFL1UF  E           K        DISK                                                  BUG4776
      * Payment reference control file                                                       BUG4776
      *                                                                   CFT003
     F********************************************************************
     F* ID F  C  H  L    FUNCTION OF INDICATORS                          *
     F*                                                                  *
     F* 01            'INPAYDD' RECORD
     F* 02            'OTPAYDD' RECORD
     F* 03            'CQCODDD' RECORD
     F* 04            'CQCOCDD' RECORD
     F* 05            'CQPACDD' RECORD
     F* 06            'CQPADDD' RECORD
     F* 07            'NTRANDD' RECORD
     F*
     F* 21   61       'INPAYZZ' TRAILER RECORD / ERROR
     F* 22   62       'OTPAYZZ' TRAILER RECORD / ERROR
     F* 23   63       'CQCODZZ' TRAILER RECORD / ERROR
     F* 24   64       'CQCOCZZ' TRAILER RECORD / ERROR
     F* 25   65       'CQPACZZ' TRAILER RECORD / ERROR
     F* 26   66       'CQPADZZ' TRAILER RECORD / ERROR
     F* 27   67       'NTRANZZ' TRAILER RECORD / ERROR
     F*      28       CORE FEATURE S01494 IS SWITCHED ON                  S01494
     F*      29       CORE FEATURE S01499 IS SWITCHED ON                  S01499
     F*
     F*      30       MULTIBRANCHING INDICATOR                            S01117
     F*      35       ORIGINATING BRANCH USED INDICATOR                   S01117
     F*      70       Profit Centres In Use Flag                          S01414
     F*                                                                   S01117
     F*      80       FIRST CYCLE
     F*
     F*      82       'NO RECORDS DROPPED' FOR PRTF FT1000P2
     F*      83       'NO RECORDS DROPPED' FOR PRTF FT1000P3
     F*      84       'NO RECORDS DROPPED' FOR PRTF FT1000P4
     F*      85       'NO RECORDS DROPPED' FOR PRTF FT1000P5
     F*      86       'NO RECORDS DROPPED' FOR PRTF FT1000P6
     F*
     F*      88       CHAIN FAIL
     F*      89       CHAIN FAIL
     F*
     E/EJECT
     E                    CPY@    1   1 80
     E                    WA1        15  1               UGFRMT SR.ARRY
     E                    WA2        20  1               UGFRMT SR.ARRY
     E                    ZYDY    4   4  4 0             ZDATE1 YEAR
     E                    ZMDY   13  13  3 0             ZDATE1 MONTH
     E                    ZMNM   12  12  3               ZDATE2 SR. ARRAY
     E                    CCYA      150  3               * CURRENCY CODES
     E                    CDPA      150  1 0             * CCY DEC. PLACES
     E                    CTI#       14 15 0             INTEGER HASH TOTAL
     E                    CTD#       14  3 0             DECIMAL HASH TOTAL
     E                    CTN#       14  5 0             RECORDS HASH TOTAL
     E                    DESC    1   5 30               CHG CODE NARS    CFT009
      *                                                                   CFT009
     E/COPY ZSRSRC,ZEDITZ1                                                CFT009
      *                                                                   CFT009
     I/EJECT
     I***
     I***   DETAIL RECORDS
     I***
     IINPAYDDF    01
     I              RECI                            @R01                  E32839
     I              LCD                             @L01                  E32873
     I              CHTP                            @C01                  E32873
     I              OEDT                            @O01                  111825
     IOTPAYDDF    02
     I              RECI                            @R03                  E32839
     I              LCD                             @L03                  E32873
     I              CHTP                            @C03                  E32873
     I              OEDT                            @O03                  111825
     ICQCODDDF    03
     I              RECI                            @R05                  E32839
     I              LCD                             @L05                  E32873
     I              CHTP                            @C05                  E32873
     I              OEDT                            @O05                  111825
     ICQCOCDDF    04
     I              RECI                            @R07                  E32839
     I              LCD                             @L07                  E32873
     I              CHTP                            @C07                  E32873
     I              OEDT                            @O07                  111825
     ICQPACDDF    05
     I              RECI                            @R09                  E32839
     I              LCD                             @L09                  E32873
     I              CHTP                            @C09                  E32873
     I              OEDT                            @O09                  111825
     ICQPADDDF    06
     I              RECI                            @R11                  E32839
     I              LCD                             @L11                  E32873
     I              CHTP                            @C11                  E32873
     I              OEDT                            @O11                  111825
     INTRANDDF    07
     I              RECI                            @R13                  E32839
     I              LCD                             @L13                  E32873
     I              CHTP                            @C13                  E32873
     I              OEDT                            @O13                  111825
     I/COPY WNCPYSRC,FT1000I001
     I***
     I***   TRAILER RECORDS
     I***
     IINPAYZZF    21
     I              RECI                            @R02                  E32839
     IOTPAYZZF    22
     I              RECI                            @R04                  E32839
     ICQCODZZF    23
     I              RECI                            @R06                  E32839
     ICQCOCZZF    24
     I              RECI                            @R08                  E32839
     ICQPACZZF    25
     I              RECI                            @R10                  E32839
     ICQPADZZF    26
     I              RECI                            @R12                  E32839
     INTRANZZF    27
     I              RECI                            @R14                  E32839
     I/EJECT
     ITABTB10F
     I***
     I***   STANDING DATA FILE DETAIL  - PF/TABTB10  ICD 1
     I***
     I              RECI                            RECITB
     ICLINTCCF
     I***
     I***   RECORD FROM CLINT WITH NAME + ADDRESS
     I***
     I              RECI                            RECICL
     I***
     I/EJECT
     IDLDA        DS                            256
     I***
     I***   LOCAL DATA AREA  -  DATABASE ERRORS
     I***
     I**************************************134 138 DBFILE                S01194
     I**************************************139 167 DBKEY                 S01194
     I**************************************168 175 DBPGM                 S01194
     I**************************************176 1770DBASE                 S01194
     I                                      134 141 DBFILE                S01194
     I                                      142 170 DBKEY                 S01194
     I                                      171 180 DBPGM                 S01194
     I                                      181 1830DBASE                 S01194
     I*                                                                   S01117
     ISPOOLU      DS                                                      S01117
     I* FILE INFORMATION DATA STRUCTURE                                   S01117
     I                                       83  92 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
     ISPOOL2      DS                                                      S01117
     I* FILE INFORMATION DATA STRUCTURE                                   S01117
     I                                       83  92 SFILE2                S01117
     I                                    B 123 1240SFNUM2                S01117
     ISPOOL3      DS                                                      S01117
     I* FILE INFORMATION DATA STRUCTURE                                   S01117
     I                                       83  92 SFILE3                S01117
     I                                    B 123 1240SFNUM3                S01117
     ISPOOL4      DS                                                      S01117
     I* FILE INFORMATION DATA STRUCTURE                                   S01117
     I                                       83  92 SFILE4                S01117
     I                                    B 123 1240SFNUM4                S01117
     I                                    B 188 1890OFLOW4                                    CER030
     I                                    B 367 3680PLINE4                                    CER030
     ISPOOL5      DS                                                      S01117
     I* FILE INFORMATION DATA STRUCTURE                                   S01117
     I                                       83  92 SFILE5                S01117
     I                                    B 123 1240SFNUM5                S01117
     I                                    B 188 1890OFLOW5                                    CER030
     I                                    B 367 3680PLINE5                                    CER030
     ISPOOL6      DS                                                      S01117
     I* FILE INFORMATION DATA STRUCTURE                                   S01117
     I                                       83  92 SFILE6                S01117
     I                                    B 123 1240SFNUM6                S01117
     I*                                                                   S01117
     IDSFDY     E DSDSFDY                                                 S01117
     I* DATA STRUCTURE FOR ACCESS PROGRAM                                 S01117
     I*                                                                   S01117
     IDSSDY     E DSDSSDY                                                 CFT014
      ** Second Data structure for access programs                        CFT014
     I*                                                                                     BUG24029
     IDSLDY     E DSDSLDY                                                                   BUG24029
      ** Third Data structure for access programs                                           BUG24029
      *                                                                   CFT014
     ISDCURR    E DSSDCURRPD                                              CFT014
      ** Data structure for currencies table                              CFT014
      *                                                                   CFT014
     ISDGELR    E DSSDGELRPD                                              S01117
     I* EXTERNAL DS FOR SDGELRPD DETAILS                                  S01117
     I*                                                                   S01117
     ISDFTFR    E DSSDFTFRPD                                              S01435
      *                                                                   S01435
      * Funds Transfer Details *                                          S01435
      *                                                                   S01435
      *                                                                   S01435
      ** Program data structure                                           S01435
     IDSPGM     ESDSY2PGDSP
      *                                                                   S01435
     ISCSARD    E DSSCSARDPD                                              S01494
     I** External data structure for SAR file details                     S01494
     I*                                                                   S01494
     ISDBRCH    E DSSDBRCHPD                                                                 BUG7985
     I              A8BRNM                          BRNM                                     BUG7985
      ** Midas SD Branch Codes                                                               BUG7985
      *                                                                                      BUG7985
     ISDBANK    E DSSDBANKPD                                                                  CFT032
      *                                                                                       CFT032
      ** External data structure for Bank details                                             CFT032
      *                                                                                       CFT032
     ISDCUST    E DSSDCUSTPD                                                                  CFT032
     I              QQDFAC                          DFAQ                                      CFT032
      *                                                                                       CFT032
      **  Data structure for customer file                                                    CFT032
      *                                                                                       CFT032
     ISDACCT    E DSACCNTAB                                                                   CFT032
     I              LCD                             ALCD                                      CFT032
      *                                                                                       CFT032
      *  Data structure for account Details                                                   CFT032
      *                                                                                       CFT032
     ISDNOST    E DSSDNOSTPD                                                                  CFT032
     I              QQACCD                          ACCD                                      CFT032
      *                                                                                       CFT032
      ** Data Structure for Nostro Details                                                    CFT032
      *                                                                                       CFT032
     ISDCNST    E DSSDCNSTPD                                                                  CFT032
      *                                                                                       CFT032
      ** Calling parameter data structure for ME1400                                          CFT032
      *                                                                                       CFT032
     IMEBICD    E DSMEBICDPD                                                                  CFT032
      *                                                                                       CFT032
      ** Calling parameter data structure for ME1400                                          CFT032
      *                                                                                       CFT032
      **  Data Structure for Additional Cust Details Access Program                           CSW207
     ISDNAHO    E DSSDNAHOPD                                                                  CSW207
      *                                                                                       CSW207
     I/COPY WNCPYSRC,FT1000I002
      *****************************************************************   S01435
      *  Data Structures for addresses.                                   S01435
      *                                                                   S01435
      ** OUT data structures (printout)                                   S01435
      *                                                                   S01435
      ** Receivers correspondent                                          S01435
     IP5RCDS      DS                                                      S01435
     I                                        1  35 P5RCO1                S01435
     I                                       36  70 P5RCO2                S01435
     I                                       71 105 P5RCO3                S01435
     I                                      106 140 P5RCO4                S01435
     I                                      141 175 P5RCO5                S01435
      *                                                                   S01435
      ** Ordering Customer                                                S01435
     IP5ORDS      DS                                                      S01435
     I                                        1  35 P5ORC1                S01435
     I                                       36  70 P5ORC2                S01435
     I                                       71 105 P5ORC3                S01435
     I                                      106 140 P5ORC4                S01435
     I                                      141 175 P5ORC5                S01435
      *                                                                   S01435
      ** Receiving Bank                                                   S01435
     IP5DSDS      DS                                                      S01435
     I                                        1  35 P5DST1                S01435
     I                                       36  70 P5DST2                S01435
     I                                       71 105 P5DST3                S01435
     I                                      106 140 P5DST4                S01435
     I                                      141 175 P5DST5                S01435
      *                                                                   S01435
      ** Account with Bank                                                S01435
     IP5ACDS      DS                                                      S01435
     I                                        1  35 P5ACB1                S01435
     I                                       36  70 P5ACB2                S01435
     I                                       71 105 P5ACB3                S01435
     I                                      106 140 P5ACB4                S01435
     I                                      141 175 P5ACB5                S01435
      *                                                                   S01435
      ** Beneficiary Customer                                             S01435
     IP5BNDS      DS                                                      S01435
     I                                        1  35 P5BNC1                S01435
     I                                       36  70 P5BNC2                S01435
     I                                       71 105 P5BNC3                S01435
     I                                      106 140 P5BNC4                S01435
     I                                      141 175 P5BNC5                S01435
      *                                                                   S01435
      ** Senders correspondent                                            S01435
     IP5SNDS      DS                                                      S01435
     I                                        1  35 P5SNC1                S01435
     I                                       36  70 P5SNC2                S01435
     I                                       71 105 P5SNC3                S01435
     I                                      106 140 P5SNC4                S01435
     I                                      141 175 P5SNC5                S01435
      *                                                                   S01435
      ** Ordering Bank                                                    S01435
     IP5OBDS      DS                                                      S01435
     I                                        1  35 P5ORB1                S01435
     I                                       36  70 P5ORB2                S01435
     I                                       71 105 P5ORB3                S01435
     I                                      106 140 P5ORB4                S01435
     I                                      141 175 P5ORB5                S01435
      *                                                                   S01435
      ** Intermediary Bank                                                S01435
     IP5INDS      DS                                                      S01435
     I                                        1  35 P5INB1                S01435
     I                                       36  70 P5INB2                S01435
     I                                       71 105 P5INB3                S01435
     I                                      106 140 P5INB4                S01435
     I                                      141 175 P5INB5                S01435
      *                                                                   CFT014
      ** Third Reimbursement Institution                                  CFT014
     IP5TRDS      DS                                                      CFT014
     I                                        1  35 P5TRI1                CFT014
     I                                       36  70 P5TRI2                CFT014
     I                                       71 105 P5TRI3                CFT014
     I                                      106 140 P5TRI4                CFT014
     I                                      141 175 P5TRI5                CFT014
      *                                                                   S01435
      ** Senders .                                                        S01435
     IP4SDDS      DS                                                      S01435
     I                                        1  35 P4SND1                S01435
     I                                       36  70 P4SND2                S01435
     I                                       71 105 P4SND3                S01435
     I                                      106 140 P4SND4                S01435
     I                                      141 175 P4SND5                S01435
      *                                                                   S01435
      ** Senders correspondent                                            S01435
     IP4SNDS      DS                                                      S01435
     I                                        1  35 P4SNC1                S01435
     I                                       36  70 P4SNC2                S01435
     I                                       71 105 P4SNC3                S01435
     I                                      106 140 P4SNC4                S01435
     I                                      141 175 P4SNC5                S01435
      *                                                                   S01435
      ** Ordering Customer                                                S01435
     IORCDS       DS                                                      S01435
     I                                        1  35 P4ORC1                S01435
     I                                       36  70 P4ORC2                S01435
     I                                       71 105 P4ORC3                S01435
     I                                      106 140 P4ORC4                S01435
     I                                      141 175 P4ORC5                S01435
      *                                                                   S01435
      ** Intermediary Bank                                                S01435
     IP4INDS      DS                                                      S01435
     I                                        1  35 P4INB1                S01435
     I                                       36  70 P4INB2                S01435
     I                                       71 105 P4INB3                S01435
     I                                      106 140 P4INB4                S01435
     I                                      141 175 P4INB5                S01435
      *                                                                   S01435
      ** Ordering Bank                                                    S01435
     IORBDS       DS                                                      S01435
     I                                        1  35 P4ORB1                S01435
     I                                       36  70 P4ORB2                S01435
     I                                       71 105 P4ORB3                S01435
     I                                      106 140 P4ORB4                S01435
     I                                      141 175 P4ORB5                S01435
      *                                                                   S01435
      ** Beneficiary Customer                                             S01435
     IP4BNDS      DS                                                      S01435
     I                                        1  35 P4BNC1                S01435
     I                                       36  70 P4BNC2                S01435
     I                                       71 105 P4BNC3                S01435
     I                                      106 140 P4BNC4                S01435
     I                                      141 175 P4BNC5                S01435
      *                                                                   S01435
      ** Account with Bank                                                S01435
     IP4ACDS      DS                                                      S01435
     I                                        1  35 P4ACB1                S01435
     I                                       36  70 P4ACB2                S01435
     I                                       71 105 P4ACB3                S01435
     I                                      106 140 P4ACB4                S01435
     I                                      141 175 P4ACB5                S01435
      *                                                                   S01435
      ** Receiver's Correspondent                                         S01435
     IP4RCDS      DS                                                      S01435
     I                                        1  35 P4RCO1                S01435
     I                                       36  70 P4RCO2                S01435
     I                                       71 105 P4RCO3                S01435
     I                                      106 140 P4RCO4                S01435
     I                                      141 175 P4RCO5                S01435
      *                                                                   S01494
      ** Destination                                                      S01494
     IP6DEST      DS                                                      S01494
     I                                        1  35 RDST1                 S01494
     I                                       36  70 RDST2                 S01494
     I                                       71 105 RDST3                 S01494
     I                                      106 140 RDST4                 S01494
     I                                      141 175 RDST5                 S01494
      *                                                                   S01494
      ** Account with Bank                                                S01494
     IP6AWBK      DS                                                      S01494
     I                                        1  35 RAWB1                 S01494
     I                                       36  70 RAWB2                 S01494
     I                                       71 105 RAWB3                 S01494
     I                                      106 140 RAWB4                 S01494
     I                                      141 175 RAWB5                 S01494
      *                                                                   S01494
      ** Intermediary Bank                                                S01494
     IP6INBT      DS                                                      S01494
     I                                        1  35 RINB1                 S01494
     I                                       36  70 RINB2                 S01494
     I                                       71 105 RINB3                 S01494
     I                                      106 140 RINB4                 S01494
     I                                      141 175 RINB5                 S01494
      *                                                                   S01435
      *                                                                   S01435
      ** IN data structures (file)                                        S01435
      ** Senders .                                                        S01435
     ISDINDS      DS                                                      S01435
     I                                        1  35 SND1                  S01435
     I                                       36  70 SND2                  S01435
     I                                       71 105 SND3                  S01435
     I                                      106 140 SND4                  S01435
     I                                      141 175 SND5                  S01435
      *                                                                   S01435
      ** Senders correspondent                                            S01435
     ISNINDS      DS                                                      S01435
     I                                        1  35 SNC1                  S01435
     I                                       36  70 SNC2                  S01435
     I                                       71 105 SNC3                  S01435
     I                                      106 140 SNC4                  S01435
     I                                      141 175 SNC5                  S01435
      *                                                                   S01435
      ** Ordering Bank                                                    S01435
     IORBDSI      DS                                                      S01435
     I                                        1  35 ORB1                  S01435
     I                                       36  70 ORB2                  S01435
     I                                       71 105 ORB3                  S01435
     I                                      106 140 ORB4                  S01435
     I                                      141 175 ORB5                  S01435
      *                                                                   S01435
      ** Receivers correspondent                                          S01435
     IRCINDS      DS                                                      S01435
     I                                        1  35 RCO1                  S01435
     I                                       36  70 RCO2                  S01435
     I                                       71 105 RCO3                  S01435
     I                                      106 140 RCO4                  S01435
     I                                      141 175 RCO5                  S01435
      *                                                                   S01435
      ** Ordering Customer                                                S01435
     IORINDS      DS                            175                       S01435
     I                                        1  35 ORC1                  S01435
     I                                       36  70 ORC2                  S01435
     I                                       71 105 ORC3                  S01435
     I                                      106 140 ORC4                  S01435
     I                                      141 175 ORC5                                      CFT032
      *                                                                   S01435
      ** Receiving Bank                                                   S01435
     IDSINDS      DS                            175                       S01435
     I                                        1  35 DST1                  S01435
     I                                       36  70 DST2                  S01435
     I                                       71 105 DST3                  S01435
     I                                      106 140 DST4                  S01435
      *                                                                   S01435
      ** Account with Bank                                                S01435
     IACINDS      DS                                                      S01435
     I                                        1  35 ACB1                  S01435
     I                                       36  70 ACB2                  S01435
     I                                       71 105 ACB3                  S01435
     I                                      106 140 ACB4                  S01435
     I                                      141 175 ACB5                  S01435
      *                                                                   S01435
      ** Beneficiary Customer                                             S01435
     IBNINDS      DS                                                      S01435
     I                                        1  35 BNC1                  S01435
     I                                       36  70 BNC2                  S01435
     I                                       71 105 BNC3                  S01435
     I                                      106 140 BNC4                  S01435
     I                                      141 175 BNC5                  S01435
      *                                                                   S01435
      ** Intermediary Bank                                                S01435
     IININDS      DS                                                      S01435
     I                                        1  35 INB1                  S01435
     I                                       36  70 INB2                  S01435
     I                                       71 105 INB3                  S01435
     I                                      106 140 INB4                  S01435
     I                                      141 175 INB5                  S01435
      *                                                                   S01494
      ** Intermediary Bank (for Nostro Transfers)                         S01494
     IININBT      DS                                                      S01494
     I                                        1  35 NTINB1                S01494
     I                                       36  70 NTINB2                S01494
     I                                       71 105 NTINB3                S01494
     I                                      106 140 NTINB4                S01494
     I                                      141 175 NTINB5                S01494
      *                                                                   S01435
      ** Split name into components.                                      S01435
     IXNAMDS      DS                            175                       S01435
     I**********                              1  12 XACCT                              S01435 CGL029
     I**********                             13  15 XBRCA                              S01435 CGL029
     I                                        1  18 XACCT                                     CGL029
     I                                       19  21 XBRCA                                     CGL029
      *                                                                   S01435
      **            address lines 2 - 5.                                  S01435
     I                                       36 175 XADDS                 S01435
      *                                                                                       CSW209
      ** Incoming Paymnets Cover Details Data Structures                                      CSW209
      ** Ordering Customer Cover                                                              CSW209
      *                                                                                       CSW209
     IP4CORC      DS                                                                          CSW209
     I                                        1  35 P4COC1                                    CSW209
     I                                       36  70 P4COC2                                    CSW209
     I                                       71 105 P4COC3                                    CSW209
     I                                      106 140 P4COC4                                    CSW209
     I                                      141 175 P4COC5                                    CSW209
      *                                                                                       CSW209
      ** Ordering Institution Cover                                                           CSW209
      *                                                                                       CSW209
     IP4COBC      DS                                                                          CSW209
     I                                        1  35 P4COB1                                    CSW209
     I                                       36  70 P4COB2                                    CSW209
     I                                       71 105 P4COB3                                    CSW209
     I                                      106 140 P4COB4                                    CSW209
     I                                      141 175 P4COB5                                    CSW209
      *                                                                                       CSW209
      ** Intermediary Institution Cover                                                       CSW209
      *                                                                                       CSW209
     IP4CIBC      DS                                                                          CSW209
     I                                        1  35 P4CIB1                                    CSW209
     I                                       36  70 P4CIB2                                    CSW209
     I                                       71 105 P4CIB3                                    CSW209
     I                                      106 140 P4CIB4                                    CSW209
     I                                      141 175 P4CIB5                                    CSW209
      *                                                                                       CSW209
      ** Account with Institution Cover                                                       CSW209
      *                                                                                       CSW209
     IP4CABC      DS                                                                          CSW209
     I                                        1  35 P4CAB1                                    CSW209
     I                                       36  70 P4CAB2                                    CSW209
     I                                       71 105 P4CAB3                                    CSW209
     I                                      106 140 P4CAB4                                    CSW209
     I                                      141 175 P4CAB5                                    CSW209
      *                                                                                       CSW209
      ** Beneficiary Customer Cover                                                           CSW209
      *                                                                                       CSW209
     IP4CBCC      DS                                                                          CSW209
     I                                        1  35 P4CBC1                                    CSW209
     I                                       36  70 P4CBC2                                    CSW209
     I                                       71 105 P4CBC3                                    CSW209
     I                                      106 140 P4CBC4                                    CSW209
     I                                      141 175 P4CBC5                                    CSW209
      *                                                                                       CSW209
      ** Sender to Receiver Information Cover                                                 CSW209
      *                                                                                       CSW209
     IP4CBBC      DS                                                                          CSW209
     I                                        1  35 P4CBB1                                    CSW209
     I                                       36  70 P4CBB2                                    CSW209
     I                                       71 105 P4CBB3                                    CSW209
     I                                      106 140 P4CBB4                                    CSW209
     I                                      141 175 P4CBB5                                    CSW209
     I                                      176 210 P4CBB6                                    CSW209
      *                                                                                       CSW209
      ** Remittance Information Cover                                                         CSW209
      *                                                                                       CSW209
     IP4CDPC      DS                                                                          CSW209
     I                                        1  35 P4CDP1                                    CSW209
     I                                       36  70 P4CDP2                                    CSW209
     I                                       71 105 P4CDP3                                    CSW209
     I                                      106 140 P4CDP4                                    CSW209
      *                                                                                       CSW209
      ** Outgoing Payments Cover Details Data Structures                                      CSW209
      ** Ordering Customer Cover                                                              CSW209
      *                                                                                       CSW209
     IP5CORC      DS                                                                          CSW209
     I                                        1  35 P5COC1                                    CSW209
     I                                       36  70 P5COC2                                    CSW209
     I                                       71 105 P5COC3                                    CSW209
     I                                      106 140 P5COC4                                    CSW209
     I                                      141 175 P5COC5                                    CSW209
      *                                                                                       CSW209
      ** Ordering Institution Cover                                                           CSW209
      *                                                                                       CSW209
     IP5COBC      DS                                                                          CSW209
     I                                        1  35 P5COB1                                    CSW209
     I                                       36  70 P5COB2                                    CSW209
     I                                       71 105 P5COB3                                    CSW209
     I                                      106 140 P5COB4                                    CSW209
     I                                      141 175 P5COB5                                    CSW209
      *                                                                                       CSW209
      ** Intermediary Institution Cover                                                       CSW209
      *                                                                                       CSW209
     IP5CIBC      DS                                                                          CSW209
     I                                        1  35 P5CIB1                                    CSW209
     I                                       36  70 P5CIB2                                    CSW209
     I                                       71 105 P5CIB3                                    CSW209
     I                                      106 140 P5CIB4                                    CSW209
     I                                      141 175 P5CIB5                                    CSW209
      *                                                                                       CSW209
      ** Account with Institution Cover                                                       CSW209
      *                                                                                       CSW209
     IP5CABC      DS                                                                          CSW209
     I                                        1  35 P5CAB1                                    CSW209
     I                                       36  70 P5CAB2                                    CSW209
     I                                       71 105 P5CAB3                                    CSW209
     I                                      106 140 P5CAB4                                    CSW209
     I                                      141 175 P5CAB5                                    CSW209
      *                                                                                       CSW209
      ** Beneficiary Customer Cover                                                           CSW209
      *                                                                                       CSW209
     IP5CBCC      DS                                                                          CSW209
     I                                        1  35 P5CBC1                                    CSW209
     I                                       36  70 P5CBC2                                    CSW209
     I                                       71 105 P5CBC3                                    CSW209
     I                                      106 140 P5CBC4                                    CSW209
     I                                      141 175 P5CBC5                                    CSW209
      *                                                                                       CSW209
      ** Sender to Receiver Information Cover A                                               CSW209
      *                                                                                       CSW209
     IP5OCBC      DS                                                                          CSW209
     I                                        1  35 P5OCB1                                    CSW209
     I                                       36  70 P5OCB2                                    CSW209
     I                                       71 105 P5OCB3                                    CSW209
     I                                      106 140 P5OCB4                                    CSW209
     I                                      141 175 P5OCB5                                    CSW209
     I                                      176 210 P5OCB6                                    CSW209
      *                                                                                       CSW209
      ** Sender to Receiver Information Cover B                                               CSW209
      *                                                                                       CSW209
     IP5CBBC      DS                                                                          CSW209
     I                                        1  35 P5CBB1                                    CSW209
     I                                       36  70 P5CBB2                                    CSW209
     I                                       71 105 P5CBB3                                    CSW209
     I                                      106 140 P5CBB4                                    CSW209
     I                                      141 175 P5CBB5                                    CSW209
     I                                      176 210 P5CBB6                                    CSW209
      *                                                                                       CSW209
      ** Remittance Information Cover                                                         CSW209
      *                                                                                       CSW209
     IP5CDPC      DS                                                                          CSW209
     I                                        1  35 P5CDP1                                    CSW209
     I                                       36  70 P5CDP2                                    CSW209
     I                                       71 105 P5CDP3                                    CSW209
     I                                      106 140 P5CDP4                                    CSW209
      *                                                                   S01435
      ** to define XTYPE.                                                 S01435
     IXTYPE       DS                              1                       S01435
      *                                                                   S01435
      /EJECT                                                              S01435
     IW8FT        DS                            128                       S01435
      *                                                                   S01435
      * Address data structure                                            S01435
      *                                                                   S01435
      * Currency                                                          S01435
     I                                        1   3 W8CCY                 S01435
      * Settlement Type                                                   S01435
     I                                        4   5 W8STMT                S01435
      * Mandatory Text - convert BIC identifiers                          S01435
     I                                        6   6 W8MTXT                S01435
      * Message Tag                                                       S01435
     I                                        7  11 W8MTAG                S01435
      * Construct of data in field                                        S01435
     I                                       12  12 W8TYPE                S01435
      * Number of Lines available                                         S01435
     I                                       13  140W8NLIN                S01435
      * Network and Message Type                                          S01435
     I                                       15  20 W8NWRK                S01435
     I                                       21  23 W8MTPY                S01435
      * Calling Program                                                   S01435
     I                                       24  33 W8CPGM                S01435
      * Action *PRINT/*ENQ/*MSG GEN                                       S01435
     I                                       34  41 W8ACT                 S01435
      * Critical reporting - Database error if 'Y'                        S01435
      * If no BIC directory and BIC entered no error                      S01435
     I                                       42  42 W8CRIT                S01435
      * Force Midas Address - where possible                              S01435
     I                                       43  43 W8MADD                S01435
      * If Retail get first address from account                          S01435
     I                                       44  44 W8RTAD                S01435
      * Alternative Address                                               S01435
     I                                       45  45 W8ALTN                S01435
      * Address type selected in W0MSG                                    S01435
     I                                       46  46 W8ADTP                S01435
      *                                                                   S01435
     IDSMTR       DS                                                      S01435
      *                                                                   S01435
      *  Define fields for message transalation                           S01435
      *                                                                   S01435
     I                                        1 132 #MSDTA                S01435
     I                                       15  30 #MPREF                S01435
     I                                    P   1   20#MPART                S01435
     I                                      133 264 #MSTX1                S01435
     I#MSTX2      DS                                                      S01435
     I                                        1 256 #MSTXA                S01435
     I                                      257 512 #MSTXB                S01435
      *****************************************************************   S01435
     I*  DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
     ICPYR@#      DS
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
     I*                                                                   S01408
     I/COPY WNCPYSRC,FT1000IIP1                                           S01408
     I*                                                                   S01408
     IWACCN       DS                            573                                           CFT032
     I                                        2   7 WWCNUM                                    CFT032
     I                                        8  10 WWCCY                                     CFT032
     I                                       11  140W1ACOD                                    CFT032
     I                                       15  160WWACSQ                                    CFT032
     I                                       23  25 WWBRCA                                    CFT032
     I                                      554 5630W2ACOD                                    CFT032
      *                                                                                       CFT032
     IWCDET       DS                             24                                           CFT032
     I                                        1   6 WDCNUM                                    CFT032
     I                                        7   9 WDCCY                                     CFT032
     I                                       10  190WDACOD                                    CFT032
     I                                       20  210WDACSQ                                    CFT032
     I                                       22  24 WDBRCA                                    CFT032
      *                                                                                       CFT032
     C                     MOVEACPY@      BIS@   80
     C/EJECT
     C********************************************************************
     C***
     C***    F I R S T   C Y C L E    C A L C ' S
     C***
     C********************************************************************
     C           *IN80     IFEQ '0'                        ### B001
     C/COPY WNCPYSRC,FT1000C014
     C                     SETON                     80
     C                     SETOF                     51
     C                     SETOF                     52
     C                     SETOF                     53
     C                     SETOF                     54
     C                     SETOF                     55
     C*
     C** INITIALISE PAGE COUNTS FOR NEW REPORTS
     C*
     C                     Z-ADD0         P2PAGE
     C                     Z-ADD0         P3PAGE
     C                     Z-ADD0         P4PAGE
     C                     Z-ADD0         P5PAGE
     C                     Z-ADD0         P6PAGE
     C*
     C* CALL ZSFILE TO LOG SPOOL FILE DETAILS FOR AUDIT REPORT            S01117
     C*                                                                   S01117
     C                     Z-ADDSFNUMU    ZSNUM                           S01117
     C                     MOVELSFILEU    ZSNAM                           S01117
     C                     EXSR SUBZSF                                    S01117
     C*                                                                   S01117
     C* IF ERROR PERFORM DATABASE ERROR HANDLING AND EXIT PROGRAM         S01117
     C*                                                                   S01117
     C           ZERR      IFEQ 'Y'                                       S01117
     C                     SETON                     U7U8LR               S01117
     C           *LOCK     IN   DLDA                                      S01117
     C                     MOVEL'FT1000'  DBPGM            ***************S01117
     C                     MOVEL'FT1000AU'DBKEY            ** DBERR  38 **S01117
     C                     MOVEL'ZSFILE'  DBFILE           ***************S01117
     C                     Z-ADD38        DBASE                           S01117
     C                     OUT  DLDA                                      S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C* CALL ZSFILE TO LOG SPOOL FILE DETAILS FOR FT1000P2 REPORT         S01117
     C*                                                                   S01117
     C                     Z-ADDSFNUM2    ZSNUM                           S01117
     C                     MOVELSFILE2    ZSNAM                           S01117
     C                     EXSR SUBZSF                                    S01117
     C*                                                                   S01117
     C* IF ERROR PERFORM DATABASE ERROR HANDLING AND EXIT PROGRAM         S01117
     C*                                                                   S01117
     C           ZERR      IFEQ 'Y'                                       S01117
     C                     SETON                     U7U8LR               S01117
     C           *LOCK     IN   DLDA                                      S01117
     C                     MOVEL'FT1000'  DBPGM            ***************S01117
     C                     MOVEL'FT1000P2'DBKEY            ** DBERR  39 **S01117
     C                     MOVEL'ZSFILE'  DBFILE           ***************S01117
     C                     Z-ADD39        DBASE                           S01117
     C                     OUT  DLDA                                      S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C* CALL ZSFILE TO LOG SPOOL FILE DETAILS FOR FT1000P3 REPORT         S01117
     C*                                                                   S01117
     C                     Z-ADDSFNUM3    ZSNUM                           S01117
     C                     MOVELSFILE3    ZSNAM                           S01117
     C                     EXSR SUBZSF                                    S01117
     C*                                                                   S01117
     C* IF ERROR PERFORM DATABASE ERROR HANDLING AND EXIT PROGRAM         S01117
     C*                                                                   S01117
     C           ZERR      IFEQ 'Y'                                       S01117
     C                     SETON                     U7U8LR               S01117
     C           *LOCK     IN   DLDA                                      S01117
     C                     MOVEL'FT1000'  DBPGM            ***************S01117
     C                     MOVEL'FT1000P3'DBKEY            ** DBERR  40 **S01117
     C                     MOVEL'ZSFILE'  DBFILE           ***************S01117
     C                     Z-ADD40        DBASE                           S01117
     C                     OUT  DLDA                                      S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C* CALL ZSFILE TO LOG SPOOL FILE DETAILS FOR FT1000P4 REPORT         S01117
     C*                                                                   S01117
     C                     Z-ADDSFNUM4    ZSNUM                           S01117
     C                     MOVELSFILE4    ZSNAM                           S01117
     C                     EXSR SUBZSF                                    S01117
     C*                                                                   S01117
     C* IF ERROR PERFORM DATABASE ERROR HANDLING AND EXIT PROGRAM         S01117
     C*                                                                   S01117
     C           ZERR      IFEQ 'Y'                                       S01117
     C                     SETON                     U7U8LR               S01117
     C           *LOCK     IN   DLDA                                      S01117
     C                     MOVEL'FT1000'  DBPGM            ***************S01117
     C                     MOVEL'FT1000P4'DBKEY            ** DBERR  41 **S01117
     C                     MOVEL'ZSFILE'  DBFILE           ***************S01117
     C                     Z-ADD41        DBASE                           S01117
     C                     OUT  DLDA                                      S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C* CALL ZSFILE TO LOG SPOOL FILE DETAILS FOR FT1000P5 REPORT         S01117
     C*                                                                   S01117
     C                     Z-ADDSFNUM5    ZSNUM                           S01117
     C                     MOVELSFILE5    ZSNAM                           S01117
     C                     EXSR SUBZSF                                    S01117
     C*                                                                   S01117
     C* IF ERROR PERFORM DATABASE ERROR HANDLING AND EXIT PROGRAM         S01117
     C*                                                                   S01117
     C           ZERR      IFEQ 'Y'                                       S01117
     C                     SETON                     U7U8LR               S01117
     C           *LOCK     IN   DLDA                                      S01117
     C                     MOVEL'FT1000'  DBPGM            ***************S01117
     C                     MOVEL'FT1000P5'DBKEY            ** DBERR  42 **S01117
     C                     MOVEL'ZSFILE'  DBFILE           ***************S01117
     C                     Z-ADD42        DBASE                           S01117
     C                     OUT  DLDA                                      S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C* CALL ZSFILE TO LOG SPOOL FILE DETAILS FOR FT1000P6 REPORT         S01117
     C*                                                                   S01117
     C                     Z-ADDSFNUM6    ZSNUM                           S01117
     C                     MOVELSFILE6    ZSNAM                           S01117
     C                     EXSR SUBZSF                                    S01117
     C*                                                                   S01117
     C* IF ERROR PERFORM DATABASE ERROR HANDLING AND EXIT PROGRAM         S01117
     C*                                                                   S01117
     C           ZERR      IFEQ 'Y'                                       S01117
     C                     SETON                     U7U8LR               S01117
     C           *LOCK     IN   DLDA                                      S01117
     C                     MOVEL'FT1000'  DBPGM            ***************S01117
     C                     MOVEL'FT1000P6'DBKEY            ** DBERR  43 **S01117
     C                     MOVEL'ZSFILE'  DBFILE           ***************S01117
     C                     Z-ADD43        DBASE                           S01117
     C                     OUT  DLDA                                      S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
      ** Access to bank Details                                                               CFT032
      *                                                                                       CFT032
     C                     CALL 'AOBANKR0'                                                    CFT032
     C                     PARM *BLANKS   PRTCD   7                                           CFT032
     C                     PARM '*FIRST ' POPTN   7                                           CFT032
     C           SDBANK    PARM SDBANK    DSFDY                                               CFT032
      *                                                                                       CFT032
     C           PRTCD     IFNE *BLANKS                                                       CFT032
     C                     Z-ADD46        WBASE                                               CFT032
     C                     MOVEL'SDBANKPD'WBFILE                                              CFT032
     C                     MOVEL'*FIRST'  WBKEY     P                                         CFT032
     C                     EXSR ABORT                                                         CFT032
     C                     ENDIF                                                              CFT032
      *                                                                                       CFT032
      ** Check if 'CER031' is switched 'ON'                                                   CER030
      *                                                                                       CER030
     C                     MOVE 'N'       CER031  1                                           CER030
     C                     CALL 'AOSARDR0'                                                    CER030
     C                     PARM *BLANKS   PRTCD                                               CER030
     C                     PARM '*VERIFY' POPTN                                               CER030
     C                     PARM 'CER031'  PSARD   6                                           CER030
     C           SCSARD    PARM SCSARD    DSFDY                                               CER030
      *                                                                                       CER030
     C           PRTCD     IFEQ *BLANKS                                                       CER030
     C                     MOVE 'Y'       CER031                                              CER030
     C                     ELSE                                                               CER030
      *                                                                                       CER030
      ** Else, database error (return code other than *NRF)                                   CER030
      *                                                                                       CER030
     C           PRTCD     IFNE '*NRF'                                                        CER030
     C                     MOVE 'SCSARDPD'WBFILE                                              CER030
     C                     MOVEL'*VERIFY' WBKEY                                               CER030
     C                     Z-ADD31        WBASE                                               CER030
     C                     EXSR ABORT                                                         CER030
     C                     ENDIF                                                              CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      ** Check if 'CER030' is switched 'ON'                                                   CER030
      *                                                                                       CER030
     C                     MOVE 'N'       CER030  1                                           CER030
     C                     CALL 'AOSARDR0'                                                    CER030
     C                     PARM *BLANKS   PRTCD                                               CER030
     C                     PARM '*VERIFY' POPTN                                               CER030
     C                     PARM 'CER030'  PSARD                                               CER030
     C           SCSARD    PARM SCSARD    DSFDY                                               CER030
      *                                                                                       CER030
     C           PRTCD     IFEQ *BLANKS                                                       CER030
     C                     MOVE 'Y'       CER030                                              CER030
     C                     ELSE                                                               CER030
      *                                                                                       CER030
      ** Else, database error (return code other than *NRF)                                   CER030
      *                                                                                       CER030
     C           PRTCD     IFNE '*NRF'                                                        CER030
     C                     MOVE 'SCSARDPD'WBFILE                                              CER030
     C                     MOVEL'*VERIFY' WBKEY                                               CER030
     C                     Z-ADD32        WBASE                                               CER030
     C                     EXSR ABORT                                                         CER030
     C                     ENDIF                                                              CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      ** Check if 'CGL013' is switched 'ON'                                                   CER030
      *                                                                                       CER030
     C                     MOVE 'N'       CGL013  1                                           CER030
     C                     CALL 'AOSARDR0'                                                    CER030
     C                     PARM *BLANKS   PRTCD                                               CER030
     C                     PARM '*VERIFY' POPTN                                               CER030
     C                     PARM 'CGL013'  PSARD                                               CER030
     C           SCSARD    PARM SCSARD    DSFDY                                               CER030
      *                                                                                       CER030
     C           PRTCD     IFEQ *BLANKS                                                       CER030
     C                     MOVE 'Y'       CGL013                                              CER030
     C                     ELSE                                                               CER030
      *                                                                                       CER030
      ** Else, database error (return code other than *NRF)                                   CER030
      *                                                                                       CER030
     C           PRTCD     IFNE '*NRF '                                                       CER030
     C                     MOVE 'SCSARDPD'WBFILE                                              CER030
     C                     MOVEL'*VERIFY' WBKEY                                               CER030
     C                     Z-ADD33        WBASE                                               CER030
     C                     EXSR ABORT                                                         CER030
     C                     ENDIF                                                              CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     MOVEL'01    '  ZTABKY 12
     C                     MOVE '    10'  ZTABKY
     C                     Z-ADD*ZEROS    ZERO15 150
     C                     MOVE *BLANKS   BLNK35 35
     C                     MOVE '70'      SEVNTY  2
     C                     MOVE *BLANKS   BLNK5   5
     C                     MOVE *BLANKS   BLNK35 35
     C                     MOVE 'B'       B       1
     C                     MOVE 'YES'     YES     3
     C                     MOVE 'NO '     NO      3
     C**
     C           ZTABKY    CHAINTABFP                99    ON NOT THERE
     C*
     C           *IN99     IFEQ '1'                        ### B002
     C           RECITB    ORNE 'D'
     C                     MOVE 'TABLE'   WBFILE  5        ***************
     C                     MOVELZTABKY    WBKEY  28        ** DBERR  01 **
     C                     Z-ADD01        WBASE   20       ***************
     C                     EXSR ABORT
     C                     END                             ### E002
     C*
     C                     MOVE '11'      ZTABKY
     C           ZTABKY    CHAINTABFP                99    ON NOT THERE
     C*
     C           *IN99     IFEQ '1'                        ### B002
     C           RECITB    ORNE 'D'
     C                     MOVE 'TABLE'   WBFILE           ***************
     C                     MOVELZTABKY    WBKEY            ** DBERR  16 **
     C                     Z-ADD16        WBASE            ***************
     C                     EXSR ABORT
     C                     END                             ### E002
     C*                                                                   S01117
     C* SETON MULTIBRANCHING INDICATOR                                    S01117
     C*                                                                   S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C                     SETON                     30                   S01117
     C                     END                                            S01117
     C*                                                                   S01494
     C** Access SAR details file to determine if S01494 is switched ON    S01494
     C*                                                                   S01494
     C                     MOVE '0'       *IN28                           S01494
     C                     CALL 'AOSARDR0'                                S01494
     C                     PARM *BLANKS   @RTCD   7                       S01494
     C                     PARM '*VERIFY' @OPTN   7                       S01494
     C                     PARM 'S01494'  @SARD   6                       S01494
     C           SCSARD    PARM SCSARD    DSFDY                           S01494
     C*                                                                   S01494
     C** If core feature is switched ON, set a variable field to          S01494
     C** condition the rest of the processing                             S01494
     C*                                                                   S01494
     C           @RTCD     IFEQ *BLANKS                                   S01494
     C                     MOVE '1'       *IN28                           S01494
     C                     ELSE                                           S01494
     C*                                                                   S01494
     C** else, database error (return code other than *NRF)               S01494
     C*                                                                   S01494
     C           @RTCD     IFNE '*NRF   '                                 S01494
     C                     MOVE 'SCSARDPD'WBFILE           ***************S01494
     C                     MOVEL'*VERIFY' WBKEY            ** DBERR  17 **S01494
     C                     Z-ADD17        WBASE            ***************S01494
     C                     EXSR ABORT                      *ABORT PGM*    S01494
     C                     END                                            S01494
     C                     END                                            S01494
      *                                                                   CFT003
      *  Access SAR details file to see if CFT003 is installed.           CFT003
      *                                                                   CFT003
     C                     CALL 'AOSARDR0'                                CFT003
     C                     PARM *BLANKS   P@RTCD  7                       CFT003
     C                     PARM '*VERIFY' P@OPTN  7                       CFT003
     C                     PARM 'CFT003'  @SARD   6                       CFT003
     C           SCSARD    PARM *BLANKS   DSFDY                           CFT003
      *                                                                   CFT003
      *  Allow Batch Authorisation processing                             CFT003
      *                                                                   CFT003
     C           P@RTCD    IFEQ *BLANKS                                   CFT003
     C           CFT003    ANDEQ*BLANKS                                   CFT003
     C                     MOVEL'CFT003'  CFT003  6                       CFT003
     C                     OPEN INPAYXL0                                  CFT003
     C                     OPEN OTPAYXL0                                  CFT003
     C                     ENDIF                                          CFT003
     C*                                                                   S01499
     C** Access SAR details file to determine if S01499 is switched ON    S01499
     C*                                                                   S01499
     C                     MOVE '0'       *IN29                           S01499
     C                     CALL 'AOSARDR0'                                S01499
     C                     PARM *BLANKS   @RTCD   7                       S01499
     C                     PARM '*VERIFY' @OPTN   7                       S01499
     C                     PARM 'S01499'  @SARD   6                       S01499
     C           SCSARD    PARM SCSARD    DSFDY                           S01499
     C*                                                                   S01499
     C** If core feature is switched ON, set a variable field to          S01499
     C** condition the rest of the processing                             S01499
     C*                                                                   S01499
     C           @RTCD     IFEQ *BLANKS                                   S01499
     C                     MOVE '1'       *IN29                           S01499
     C                     ELSE                                           S01499
     C*                                                                   S01499
     C** else, database error (return code other than *NRF)               S01499
     C*                                                                   S01499
     C           @RTCD     IFNE '*NRF   '                                 S01499
     C                     MOVE 'SCSARDPD'WBFILE           ***************S01499
     C                     MOVEL'*VERIFY' WBKEY            ** DBERR  18 **S01499
     C                     Z-ADD18        WBASE            ***************S01499
     C                     EXSR ABORT                      *ABORT PGM*    S01499
     C                     END                                            S01499
     C                     END                                            S01499
      *                                                                   CFT014
     C                     MOVE 'N'       CFT014  1                       CFT014
     C                     MOVE *OFF      *IN59                           CFT014
     C                     CALL 'AOSARDR0'                                CFT014
     C                     PARM *BLANKS   WRTCD   7                       CFT014
     C                     PARM '*VERIFY' WOPTN   7                       CFT014
     C                     PARM 'CFT014'  WSARD   6                       CFT014
     C           SCSARD    PARM SCSARD    DSFDY                           CFT014
     C           WRTCD     IFEQ *BLANKS                                   CFT014
     C                     MOVE 'Y'       CFT014                          CFT014
     C                     MOVE *ON       *IN59                           CFT014
     C           CFT003    IFNE 'CFT003'                                  CFT014
     C                     OPEN INPAYXL0                                  CFT014
     C                     OPEN OTPAYXL0                                  CFT014
     C                     ENDIF                                          CFT014
     C                     ELSE                                           CFT014
     C           WRTCD     IFNE '*NRF   '                                 CFT014
     C                     MOVEL'SCSARDPD'WBFILE           ************   CFT014
     C                     MOVEL'CFT014  'WBKEY            * DBERR019 *   CFT014
     C                     Z-ADD19        WBASE            ************   CFT014
     C                     EXSR ABORT                                     CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVE 'N'       CEU006  1                       CFT014
     C                     CALL 'AOSARDR0'                                CFT014
     C                     PARM *BLANKS   WRTCD   7                       CFT014
     C                     PARM '*VERIFY' WOPTN   7                       CFT014
     C                     PARM 'CEU006'  WSARD   6                       CFT014
     C           SCSARD    PARM SCSARD    DSFDY                           CFT014
     C           WRTCD     IFEQ *BLANKS                                   CFT014
     C                     MOVE 'Y'       CEU006                          CFT014
     C                     ELSE                                           CFT014
     C           WRTCD     IFNE '*NRF   '                                 CFT014
     C                     MOVEL'SCSARDPD'WBFILE           ************   CFT014
     C                     MOVEL'CEU006  'WBKEY            * DBERR020 *   CFT014
     C                     Z-ADD20        WBASE            ************   CFT014
     C                     EXSR ABORT                                     CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT009
      ** Access SAR details file to determine if CFT009 is switched ON    CFT009
      *                                                                   CFT009
     C                     MOVE '0'       *IN74                           CFT009
     C                     MOVE ' '       CFT009  1                       CFT009
     C                     CALL 'AOSARDR0'                                CFT009
     C                     PARM *BLANKS   @RTCD   7                       CFT009
     C                     PARM '*VERIFY' @OPTN   7                       CFT009
     C                     PARM 'CFT009'  @SARD   6                       CFT009
     C           SCSARD    PARM SCSARD    DSFDY                           CFT009
      *                                                                   CFT009
      ** If core feature is switched ON, set a variable field to          CFT009
      ** condition the rest of the processing                             CFT009
      *                                                                   CFT009
     C           @RTCD     IFEQ *BLANKS                                   CFT009
     C                     MOVE '1'       *IN74                           CFT009
     C                     MOVE 'Y'       CFT009                          CFT009
      *                                                                   CFT009
      ** Ensure UC files are opened, if not already open.                 CFT009
      *                                                                   CFT009
     C           CFT003    IFNE 'CFT003'                                  CFT009
     C           CFT014    ANDNE'Y'                                       CFT009
     C                     OPEN INPAYXL0                                  CFT009
     C                     OPEN OTPAYXL0                                  CFT009
     C                     ENDIF                                          CFT009
     C                     ELSE                                           CFT009
      *                                                                   CFT009
      ** else, database error (return code other than *NRF)               CFT009
      *                                                                   CFT009
     C           @RTCD     IFNE '*NRF   '                                 CFT009
     C                     MOVE 'SCSARDPD'WBFILE           ***************CFT009
     C                     MOVEL'*VERIFY' WBKEY            ** DBERR  02 **CFT009
     C                     Z-ADD02        WBASE            ***************CFT009
     C                     EXSR ABORT                      *ABORT PGM*    CFT009
     C                     ELSE                                           CFT009
     C                     MOVE '0'       *IN74                           CFT009
     C                     MOVE 'N'       CFT009                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Access SAR details file to determine if CFT010 is switched ON    CFT009
      *                                                                   CFT009
     C                     MOVE '0'       *IN75                           CFT009
     C                     MOVE ' '       CFT010  1                       CFT009
     C                     CALL 'AOSARDR0'                                CFT009
     C                     PARM *BLANKS   @RTCD   7                       CFT009
     C                     PARM '*VERIFY' @OPTN   7                       CFT009
     C                     PARM 'CFT010'  @SARD   6                       CFT009
     C           SCSARD    PARM SCSARD    DSFDY                           CFT009
      *                                                                   CFT009
      ** If core feature is switched ON, set a variable field to          CFT009
      ** condition the rest of the processing                             CFT009
      *                                                                   CFT009
     C           @RTCD     IFEQ *BLANKS                                   CFT009
     C                     MOVE '1'       *IN75                           CFT009
     C                     MOVE 'Y'       CFT010                          CFT009
     C                     ELSE                                           CFT009
      *                                                                   CFT009
      ** else, database error (return code other than *NRF)               CFT009
      *                                                                   CFT009
     C           @RTCD     IFNE '*NRF   '                                 CFT009
     C                     MOVE 'SCSARDPD'WBFILE           ***************CFT009
     C                     MOVEL'*VERIFY' WBKEY            ** DBERR  03 **CFT009
     C                     Z-ADD03        WBASE            ***************CFT009
     C                     EXSR ABORT                      *ABORT PGM*    CFT009
     C                     ELSE                                           CFT009
     C                     MOVE '0'       *IN75                           CFT009
     C                     MOVE 'N'       CFT010                          CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Access SAR details file to determine if CFT120 is switched ON                        CFT120
      *                                                                                       CFT120
     C                     MOVE '0'       *IN58                                               CFT120
     C                     MOVE ' '       CFT120  1                                           CFT120
     C                     CALL 'AOSARDR0'                                                    CFT120
     C                     PARM *BLANKS   @RTCD   7                                           CFT120
     C                     PARM '*VERIFY' @OPTN   7                                           CFT120
     C                     PARM 'CFT120'  @SARD   6                                           CFT120
     C           SCSARD    PARM SCSARD    DSFDY                                               CFT120
      *                                                                                       CFT120
      ** If core feature is switched ON, set a variable field to                              CFT120
      ** condition the rest of the processing                                                 CFT120
      *                                                                                       CFT120
     C           @RTCD     IFEQ *BLANKS                                                       CFT120
     C                     MOVE '1'       *IN58                                               CFT120
     C                     MOVE 'Y'       CFT120                                              CFT120
     C                     ELSE                                                               CFT120
      *                                                                                       CFT120
      ** else, database error (return code other than *NRF)                                   CFT120
      *                                                                                       CFT120
     C           @RTCD     IFNE '*NRF   '                                                     CFT120
     C                     MOVE 'SCSARDPD'WBFILE                                              CFT120
     C                     MOVEL'*VERIFY' WBKEY                                               CFT120
     C                     Z-ADD04        WBASE                                               CFT120
     C                     EXSR ABORT                                                         CFT120
     C                     ELSE                                                               CFT120
     C                     MOVE '0'       *IN58                                               CFT120
     C                     MOVE 'N'       CFT120                                              CFT120
     C                     ENDIF                                                              CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
      ** Check if SWIFT Changes 2003 (CSW203) is installed                                    CSW203
      *                                                                                       CSW203
     C                     CALL 'SWIF2003'                                                    CSW203
     C                     PARM *BLANKS   PRTCD   7                                           CSW203
      *                                                                                       CSW203
     C           PRTCD     IFEQ 'CSW2003'                                                     CSW203
     C                     MOVE 'Y'       CSW203  1                                           CSW203
     C                     MOVE *ON       *IN69                                               CSW203
     C                     ELSE                                                               CSW203
     C                     MOVE 'N'       CSW203                                              CSW203
     C                     MOVE *OFF      *IN69                                               CSW203
     C                     ENDIF                                                              CSW203
      *                                                                                       CSW207
      ** Check if SWIFT Changes 2007 (CSW207) is installed                                    CSW207
      *                                                                                       CSW207
     C                     CALL 'SWIF2007'                                                    CSW207
     C                     PARM *BLANKS   PRTCD   7                                           CSW207
      *                                                                                       CSW207
     C           PRTCD     IFEQ 'CSW2007'                                                     CSW207
     C                     MOVE 'Y'       CSW207  1                                           CSW207
     C                     ELSE                                                               CSW207
     C                     MOVE 'N'       CSW207                                              CSW207
     C                     ENDIF                                                              CSW207
      *                                                                                       CSW207
      *                                                                   CFT014
      ** Check if SWIFT Changes 2009 (CSW209) is installed                                    CSW209
      *                                                                                       CSW209
     C                     CALL 'SWIF2009'                                                    CSW209
     C                     PARM *BLANKS   PRTCD                                               CSW209
      *                                                                                       CSW209
     C           PRTCD     IFEQ 'CSW2009'                                                     CSW209
     C                     MOVE 'Y'       CSW209  1                                           CSW209
     C                     ELSE                                                               CSW209
     C                     MOVE 'N'       CSW209                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C/COPY WNCPYSRC,FT1000C012
      *                                                                                       CFT157
     C                     MOVE 'N'       CFT157  1                                           CFT157
     C                     CALL 'AOSARDR0'                                                    CFT157
     C                     PARM *BLANKS   @RTCD                                               CFT157
     C                     PARM '*VERIFY' @OPTN                                               CFT157
     C                     PARM 'CFT157'  @SARD                                               CFT157
     C           SCSARD    PARM SCSARD    DSFDY                                               CFT157
     C*                                                                                       CFT157
     C** If feature is switched ON, set a variable field to                                   CFT157
     C** condition the rest of the processing                                                 CFT157
     C*                                                                                       CFT157
     C           @RTCD     IFEQ *BLANKS                                                       CFT157
     C                     MOVE 'Y'       CFT157                                              CFT157
     C                     ELSE                                                               CFT157
     C*                                                                                       CFT157
     C** else, database error (return code other than *NRF)                                   CFT157
     C*                                                                                       CFT157
     C           @RTCD     IFNE '*NRF   '                                                     CFT157
     C                     MOVE 'SCSARDPD'WBFILE           ***************                    CFT157
     C                     MOVEL'*VERIFY' WBKEY            ** DBERR  17 **                    CFT157
     C                     Z-ADD17        WBASE            ***************                    CFT157
     C                     EXSR ABORT                      *ABORT PGM*                        CFT157
     C                     END                                                                CFT157
     C                     END                                                                CFT157
     C*                                                                   S01414
     C* Move the conditional IF so that AOGELRR0 is always called.        S01414
     C*
     C**IF*MULTIBRANCHING*INDICATOR*IS*SETON*THEN*ACCESS*SDGELRPD*VIS01194S01414
     C******AOGELR0*PROGRAM*FOR*ORIGINATING*BRANCH*USED*FLAG********S01194S01414
     C**********                                                    S01194S01414
     C********** *IN30*****IFEQ '1'                                       S01194
     C*                                                                   S01194
     C**********           CALL 'AOGELRR0'                                S01194              CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM '*MSG  '  @RTCD   7                       S01194
     C                     PARM '*FIRST'  @OPTN   7                       S01194
     C********** SDGELR    PARM SDGELR    DSFDY                           S01194              CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     MOVE 'SDGELRPD'WBFILE           ***************S01194
     C                     MOVEL'*FIRST'  WBKEY            ** DBERR  44 **S01194
     C                     Z-ADD44        WBASE            ***************S01194
     C                     EXSR ABORT                                     S01194
     C                     END                                            S01194
     C*                                                             S01117S01414
     C**  If multi branching indicator on                           S01117S01414
     C*                                                             S01117S01414
     C           *IN30     IFEQ '1'                                 S01117S01414
     C*                                                                   S01194
     C* IF ORIGINATING BRANCH USED FLAG IS ON, SET ON INDICATOR 35        S01117
     C*                                                                   S01117
     C           BKOBRU    IFEQ 'Y'                                       S01117
     C                     SETON                     35                   S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     END                                            S01117
     C*                                                                   S01117
      *                                                                   S01414
      *  Check if Profit Centres are used and set screen attributes       S01414
      *                                                                   S01414
     C           BKPRCU    IFEQ 'Y'                                       S01414
     C                     MOVE '1'       *IN70                           S01414
     C                     END                                            S01414
      *                                                                   S01414
      *                                                                   S01435
      ** Read SDFTFRPD                                                    S01435
      *                                                                   S01435
     C                     CALL 'AOFTFRR0'             90                 S01435
     C                     PARM *BLANKS   P@RTCD  7        B:Return code  S01435
     C                     PARM '*FIRST ' P@OPTN  7        I:Option       S01435
     C           SDFTFR    PARM SDFTFR    DSFDY                           S01435
      *                                                                   S01435
      *  If return with an error (LR seton in called program) then        S01435
      *  process for database error.                                      S01435
      *                                                                   S01435
     C           *IN90     IFEQ '1'                                       S01435
     C           P@RTCD    OREQ '*ERROR*'                                 S01435
     C                     MOVEL'SDFTFRPD'WBFILE           ***************S01435
     C                     MOVELP@OPTN    WBKEY            * DB ERROR 16 *S01435
     C                     MOVEL'50'      WBASE            ***************S01435
     C                     EXSR ABORT                                     S01435
     C                     END                                            S01435
      *                                                                   S01435
      * Get message text for Account with Bank field                      S01435
      *                                                                   S01435
     C                     CALL 'MEC1150'              9090               S01435
     C                     PARM 'FTM2350 '#MSGID  7                       S01435
     C                     PARM 'FTUSRMSG'#MSGF  10                       S01435
     C                     PARM           #MSDTA                          S01435
     C                     PARM *BLANKS   #MSTX1                          S01435
     C                     PARM *BLANKS   #MSTX2                          S01435
      *                                                                   S01435
     C                     MOVEL#MSTX1    #IMSG  35                       S01435
     C*                                                                   S01194
     C** CALL UATBCN TO ACCESS CURRENCY RECORD FOR BASE CURRENCY          S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   ZTABKY                          S01435
     C                     MOVEL'20'      ZTABKY                          S01435
     C                     MOVELBCCY      WA4     4                       S01435
     C                     MOVE '1'       WA4                             S01435
     C                     MOVE WA4       ZTABKY                          S01435
     C                     EXSR UATBCN                                    S01435
     C*                                                                   S01435
     C** CHECK IF DATABASE ERROR OCCURRED                                 S01435
     C*                                                                   S01435
     C           *IN89     IFEQ '1'                                       S01435
     C                     MOVEL'TABLE'   WBFILE                          S01435
     C                     MOVELZTABKY    WBKEY                           S01435
     C                     MOVEL'53'      WBASE                           S01435
     C                     EXSR ABORT                      *ABORT PGM*    S01435
     C                     END                                            S01435
     C*                                                                   S01435
     C** STORE NUMBER OF DECIMAL PLACES FOR BASE CURRENCY                 S01435
     C*                                                                   S01435
     C                     Z-ADDCDP       SVBCDP  10
      *                                                                   S01435
      ** Call UATBCN to Access local currency record                      S01435
      *                                                                   S01435
     C                     MOVEL*BLANKS   ZTABKY                          S01435
     C                     MOVEL'20'      ZTABKY                          S01435
     C                     MOVELLOCY      WA4                             S01435
     C                     MOVE '1'       WA4                             S01435
     C                     MOVE WA4       ZTABKY                          S01435
     C                     EXSR UATBCN                                    S01435
      *                                                                   S01435
      ** Check if database error occurred                                 S01435
      *                                                                   S01435
     C           *IN89     IFEQ '1'                                       S01435
     C                     MOVEL'TABLE'   WBFILE                          S01435
     C                     MOVELZTABKY    WBKEY                           S01435
     C                     MOVEL'51'      WBASE                           S01435
     C                     EXSR ABORT                      *ABORT PGM*    S01435
     C                     END                                            S01435
      *                                                                   S01435
      ** Store number of decimal places for base currency                 S01435
      *                                                                   S01435
     C                     Z-ADDCDP       SVLCDP  10                      S01435
     C*
     C*  USED IN SUBROUTINE 'CHOPF'
     C**********           MOVE *BLANKS   BLNK10 10                                           CGL029
     C                     MOVE *BLANKS   BLNK10 16                                           CGL029
     C**********           MOVE *BLANKS   BLNK2   2                                           CGL029
     C                     MOVE *BLANKS   BLNK2   8                                           CGL029
     C*
     C                     MOVEL'*** DIFF'DIFFXX 16
     C                     MOVE 'ERENCE *'DIFFXX
     C                     MOVEL'WRITE '  WRTERR 11
     C                     MOVE 'ERROR'   WRTERR
     C/COPY WNCPYSRC,FT1000C002
     C*
     C                     END                             ### E001
     C********************************************************************
     C/EJECT
     C********************************************************************
     C***
     C***   D E T A I L    P R O C E S S I N G
     C***
     C********************************************************************
     C*
     C      01             EXSR INPAYS
     C      02             EXSR OTPAYS
     C      03             EXSR CQCODS
     C      04             EXSR CQCOCS
     C      05             EXSR CQPACS
     C      06             EXSR CQPADS
     C      07             EXSR NTRANS
     C*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C***
     C***   T R A I L E R    P R O C E S S I N G
     C***
     C********************************************************************
     C*
     C   21                EXSR INPAYT
     C   22                EXSR OTPAYT
     C   23                EXSR CQCODT
     C   24                EXSR CQCOCT
     C   25                EXSR CQPACT
     C   26                EXSR CQPADT
     C   27                EXSR NTRANT
     C********************************************************************
     C/EJECT
     C********************************************************************
     C***
     C***   F I N A L     P R O C E S S I N G
     C***
     C********************************************************************
     C*
     CLR         *IN61     IFEQ '1'                        ANY FILE
     CLR         *IN62     OREQ '1'                         ERROR ?
     CLR         *IN63     OREQ '1'
     CLR         *IN64     OREQ '1'
     CLR         *IN65     OREQ '1'
     CLR         *IN66     OREQ '1'
     CLR         *IN67     OREQ '1'
     CLR                   SETON                     U8
     CLR                   END
     C*                                                                   S01117
     C* CALL ZSFILE TO LOG SPOOL FILE DETAILS FOR AUDIT REPORT IF NO      S01117
     C* INPUT RECORDS AND PROGRAM GOES STRAIGHT TO LR PROCESSING          S01117
     C*                                                                   S01117
     CLR         *IN80     IFEQ '0'                                       S01117
     CLR                   Z-ADDSFNUMU    ZSNUM                           S01117
     CLR                   MOVELSFILEU    ZSNAM                           S01117
     CLR                   EXSR SUBZSF                                    S01117
     CLR                   END                                            S01117
     C*
     C*LR*******************WRITEP1CONT                      REPORT       S01117
     CLR                   WRITEAUCONT                      REPORT        S01117
     C*
     C** OUTPUT END-OF-REPORT MESSAGE TO DETAIL REPORT
     C*
     CLR         *IN82     IFEQ '0'
     CLR                   Z-ADD1         P2PAGE
     CLR                   WRITEP2HEDT                 60
     CLR                   END
     CLR                   WRITEP2EOR                  60
     CLR         *IN83     IFEQ '0'
     CLR                   Z-ADD1         P3PAGE
     CLR                   WRITEP3HEDT                 60
     CLR                   END
     CLR                   WRITEP3EOR                  60
     CLR         *IN84     IFEQ '0'                        NO DETAIL
     CLR                   Z-ADD1         P4PAGE
     CLR                   MOVELRUNA      P4DATE
     CLR                   MOVELTITL      P4TITL
     CLR                   WRITEP4HD                       ON THE
     CLR                   END
     CLR                   WRITEP4EOR                  60
     CLR         *IN85     IFEQ '0'                        NO DETAIL
     CLR                   Z-ADD1         P5PAGE
     CLR                   MOVELRUNA      P5DATE
     CLR                   MOVELTITL      P5TITL
     CLR                   WRITEP5HD                       ON THE
     CLR                   END
     CLR                   WRITEP5EOR                  60
     CLR         *IN86     IFEQ '0'
     CLR                   Z-ADD1         P6PAGE
     CLR                   MOVELRUNA      P6DATE
     CLR                   MOVELTITL      P6TITL
     CLR                   WRITEP6HEDT                 60
     CLR                   END
     CLR                   WRITEP6EOR                  60
     C*
     C*
     C/EJECT
     C********************************************************************
     C**
     C**   THE PROCESSING FOR A RECORD FROM 'INPAYDD'
     C**
     C           INPAYS    BEGSR                           ** INPAYS **
     C                     Z-ADD1         H       20
     C                     Z-ADDSMAM      PRMAMT 130
     C                     EXSR HASH
     C*-
     C                     MOVEL@R01      RECI                            E32839
     C                     MOVEL@L01      LCD                             E32873
     C                     MOVEL@C01      CHTP                            E32873
      *                                                                   E32839
     C           RECI      IFNE 'C'                        ## B001
     C                     ADD  7         H
     C                     EXSR HASH
     C*********************WRITEXNPAYDDF               88                 E32894
     C*********************                                               E32894
     C************IN88*****IFEQ '1'                        ## B002        E32894
     C*********************MOVE 'INPAY'   WBFILE           ***************E32894
     C*********************MOVELWRTERR    WBKEY            ** DBERR  02 **E32894
     C*********************Z-ADD02        WBASE            ***************E32894
     C*********************EXSR ABORT                                     E32894
     C*********************                                               E32894
     C*********************END                             ## E002        E32894
     C                     UPDATINPAYDDF                                  E32894
     C                     ELSE
     C/COPY WNCPYSRC,FT1000C013
      *                                                                                       CFT157
      ** Check if the transaction is stopped                                                  CFT157
     C           CFT157    IFEQ 'Y'                                                           CFT157
     C           @C01      ANDEQ'S'                                                           CFT157
     C                     SETON                     56                                       CFT157
     C                     MOVELSUSR      SSUSR                                               CFT157
     C                     MOVELSAUS      SSAUS                                               CFT157
     C                     ELSE                                                               CFT157
     C                     SETOF                     56                                       CFT157
     C                     END                                                                CFT157
      *                                                                                       CFT157
     C                     EXSR INPREP
     C                     MOVE *BLANKS   WPREF  13                                          BUG4776
     C                     MOVELPREF      WPREF                                              BUG4776
     C/COPY WNCPYSRC,FT1000C001
     C                     DELETINPAYDDF                                  E32894
     C           WPREF     CHAINFTPREFL1             42                                      BUG4776
     C           *IN42     IFEQ '0'                                                          BUG4776
     C                     DELETFTPREFDF                                                     BUG4776
     C                     ENDIF                                                             BUG4776
     C/COPY WNCPYSRC,FT1000C005
     C                     END                             ## E001
     C                     ENDSR
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C**   THE PROCESSING FOR A RECORD FROM 'OTPAYDD'
     C**                                                               63)
     C           OTPAYS    BEGSR                           ** OTPAYS **
     C                     Z-ADD2         H
     C                     Z-ADDSMAM      PRMAMT
     C                     EXSR HASH
     C*-
     C                     MOVEL@R03      RECI                            E32839
     C                     MOVEL@L03      LCD                             E32873
     C                     MOVEL@C03      CHTP                            E32873
      *                                                                   E32839
     C           RECI      IFNE 'C'                        ## B001
     C                     ADD  7         H
     C                     EXSR HASH
     C*********************WRITEXTPAYDDF               88                 E32894
     C*********************                                               E32894
     C************IN88*****IFEQ '1'                        ## B002        E32894
     C*********************MOVE 'OTPAY'   WBFILE           ***************E32894
     C*********************MOVELWRTERR    WBKEY            ** DBERR  03 **E32894
     C*********************Z-ADD03        WBASE            ***************E32894
     C*********************EXSR ABORT                                     E32894
     C*********************                                               E32894
     C*********************END                             ## E002        E32894
     C                     UPDATOTPAYDDF                                  E32894
     C                     ELSE
     C/COPY WNCPYSRC,FT1000C035
      *                                                                                       CFT157
      ** Check if the transaction is stopped                                                  CFT157
     C           CFT157    IFEQ 'Y'                                                           CFT157
     C           @C03      ANDEQ'S'                                                           CFT157
     C                     SETON                     56                                       CFT157
     C                     MOVELSUSR      SSUSR                                               CFT157
     C                     MOVELSAUS      SSAUS                                               CFT157
     C                     ELSE                                                               CFT157
     C                     SETOF                     56                                       CFT157
     C                     END                                                                CFT157
      *                                                                                       CFT157
     C                     EXSR OTPREP
     C                     MOVE *BLANKS   WPREF                                              BUG4776
     C                     MOVELPREF      WPREF                                              BUG4776
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT1000CCP2                                           S01408
     C*                                                                   S01408
      ***If*Batch*Authorsation*update/add*record********************CFT003CFT014
      **************************************************************CFT003CFT014
     C***********CFT003    IFEQ 'CFT003'                            CFT003CFT014
      **************************************************************CFT003CFT014
     C***********PREF      CHAINOTPAYXL0             79             CFT003CFT014
      **************************************************************CFT003CFT014
      ***If*found,*delete*OTPAYXL0**********************************CFT003CFT014
      **************************************************************CFT003CFT014
     C************IN79     IFEQ '0'                                 CFT003CFT014
     C***********          DELETOTPAYXDF                            CFT003CFT014
     C***********          ENDIF                           -*IN79   CFT003CFT014
      **************************************************************CFT003CFT014
     C***********          ENDIF                                    CFT003CFT014
     C/COPY WNCPYSRC,FT1000C042
      *                                                                   CFT003
     C                     DELETOTPAYDDF                                  E32894
     C           WPREF     CHAINFTPREFL1             42                                      BUG4776
     C           *IN42     IFEQ '0'                                                          BUG4776
     C                     DELETFTPREFDF                                                     BUG4776
     C                     ENDIF                                                             BUG4776
     C/COPY WNCPYSRC,FT1000C003
     C                     END                             ## E001
     C                     ENDSR
     C********************************************************************
     C/COPY WNCPYSRC,FT1000C004
     C/EJECT
     C********************************************************************
     C**
     C**   THE PROCESSING FOR A RECORD FROM 'CQCODDD'
     C**
     C           CQCODS    BEGSR                           ** CQCODS **
     C                     Z-ADD3         H
     C                     Z-ADDTOCL      PRMAMT
     C                     EXSR HASH
     C*-
     C                     MOVEL@R05      RECI                            E32839
     C                     MOVEL@L05      LCD                             E32873
     C                     MOVEL@C05      CHTP                            E32873
     C                     Z-ADD@O05      OEDT    50                      111825
      *                                                                   E32839
     C           RECI      IFNE 'C'                        ## B001
     C                     ADD  7         H
     C                     EXSR HASH
     C*********************WRITEXQCODDDF               88                 E32894
     C*********************                                               E32894
     C************IN88*****IFEQ '1'                        ## B002        E32894
     C*********************MOVE 'CQCOD'   WBFILE           ***************E32894
     C*********************MOVELWRTERR    WBKEY            ** DBERR  04 **E32894
     C*********************Z-ADD04        WBASE            ***************E32894
     C*********************EXSR ABORT                                     E32894
     C*********************                                               E32894
     C*********************ELSE                                           E32894
     C                     UPDATCQCODDDF                                  E32894
     C                     MOVE 'CHEQUES' P#TITL  7
     C*********************END                             ## E002        E32894
     C                     ELSE
     C/COPY WNCPYSRC,FT1000C036
     C                     MOVE 'D'       P#CRDB  1
     C                     EXSR CQCREP
     C                     DELETCQCODDDF                                  E32894
     C/COPY WNCPYSRC,FT1000C017
     C                     END                             ## E001
     C                     ENDSR
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C**   THE PROCESSING FOR A RECORD FROM 'CQCOCDD'
     C**
     C           CQCOCS    BEGSR                           ** CQCOCS **
     C                     Z-ADD4         H
     C                     Z-ADDCQAM      PRMAMT
     C                     EXSR HASH
     C*-
     C                     MOVEL@R07      RECI                            E32839
     C                     MOVEL@L07      LCD                             E32873
     C                     MOVEL@C07      CHTP                            E32873
     C                     Z-ADD@O07      OEDT                            111825
      *                                                                   E32839
     C           RECI      IFNE 'C'                        ## B001
     C                     ADD  7         H
     C                     EXSR HASH
     C*********************WRITEXQCOCDDF               88                 E32894
     C*********************                                               E32894
     C************IN88*****IFEQ '1'                        ## B002        E32894
     C*********************MOVE 'CQCOC'   WBFILE           ***************E32894
     C*********************MOVELWRTERR    WBKEY            ** DBERR  05 **E32894
     C*********************Z-ADD05        WBASE            ***************E32894
     C*********************EXSR ABORT                                     E32894
     C*********************                                               E32894
     C*********************ELSE                                           E32894
     C                     UPDATCQCOCDDF                                  E32894
     C                     MOVE 'CHEQUES' P#TITL
     C*********************END                             ## E002        E32894
     C                     ELSE
     C/COPY WNCPYSRC,FT1000C040
     C                     MOVE 'C'       P#CRDB
     C                     EXSR CQCREP
     C                     DELETCQCOCDDF                                  E32894
     C/COPY WNCPYSRC,FT1000C015
     C                     END                             ## E001
     C                     ENDSR
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C**   THE PROCESSING FOR A RECORD FROM 'CQPACDD'
     C**
     C           CQPACS    BEGSR                           ** CQPACS **
     C                     Z-ADD5         H
     C                     Z-ADDPRRM      PRMAMT
     C                     EXSR HASH
     C*-
     C                     MOVEL@R09      RECI                            E32839
     C                     MOVEL@L09      LCD                             E32873
     C                     MOVEL@C09      CHTP                            E32873
     C                     Z-ADD@O09      OEDT                            111825
      *                                                                   E32839
     C           RECI      IFNE 'C'                        ## B001
     C                     ADD  7         H
     C                     EXSR HASH
     C*********************WRITEXQPACDDF               88                 E32894
     C*********************                                               E32894
     C************IN88*****IFEQ '1'                        ## B002        E32894
     C*********************MOVE 'CQPAC'   WBFILE           ***************E32894
     C*********************MOVELWRTERR    WBKEY            ** DBERR  06 **E32894
     C*********************Z-ADD06        WBASE            ***************E32894
     C*********************EXSR ABORT                                     E32894
     C*********************                                               E32894
     C*********************END                             ## E002        E32894
     C                     UPDATCQPACDDF                                  E32894
     C                     ELSE
     C                     MOVE 'C'       Q#CRDB
     C                     EXSR CQPREP
     C                     DELETCQPACDDF               88                 E32894
     C/COPY WNCPYSRC,FT1000C016
     C                     END                             ## E001
     C                     ENDSR
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C**   THE PROCESSING FOR A RECORD FROM 'CQPADDD'
     C**
     C           CQPADS    BEGSR                           ** CQPADS **
     C                     Z-ADD6         H
     C                     Z-ADDCQAM      PRMAMT
     C                     EXSR HASH
     C*-
     C                     MOVEL@R11      RECI                            E32839
     C                     MOVEL@L11      LCD                             E32873
     C                     MOVEL@C11      CHTP                            E32873
     C                     Z-ADD@O11      OEDT                            111825
      *                                                                   E32839
     C           RECI      IFNE 'C'                        ## B001
     C                     ADD  7         H
     C                     EXSR HASH
     C*********************WRITEXQPADDDF               88                 E32894
     C*********************                                               E32894
     C************IN88*****IFEQ '1'                        ## B002        E32894
     C*********************MOVE 'CQPAD'   WBFILE           ***************E32894
     C*********************MOVELWRTERR    WBKEY            ** DBERR  07 **E32894
     C*********************Z-ADD07        WBASE            ***************E32894
     C*********************EXSR ABORT                                     E32894
     C*********************                                               E32894
     C*********************END                             ## E002        E32894
     C                     UPDATCQPADDDF                                  E32894
     C                     ELSE
     C/COPY WNCPYSRC,FT1000C037
     C                     MOVE 'D'       Q#CRDB  1
     C                     EXSR CQPREP
     C                     DELETCQPADDDF               88                 E32894
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT1000CCP1                                           S01408
     C*                                                                   S01408
     C                     END                             ## E001
     C                     ENDSR
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C**   THE PROCESSING FOR A RECORD FROM 'NTRANDD'
     C**
     C           NTRANS    BEGSR                           ** NTRANS **
     C*
     C                     Z-ADD7         H
     C                     Z-ADDAMNT      PRMAMT
     C                     EXSR HASH
     C*-
     C                     MOVEL@R13      RECI                            E32839
     C                     MOVEL@L13      LCD                             E32873
     C                     MOVEL@C13      CHTP                            E32873
     C                     Z-ADD@O13      OEDT                            111825
      *                                                                   E32839
     C           RECI      IFNE 'C'                        ## B001
     C                     ADD  7         H
     C                     EXSR HASH
     C*********************WRITEXTRANDDF               88                 E32894
     C*********************                                               E32894
     C************IN88*****IFEQ '1'                        ## B002        E32894
     C*********************MOVE 'NTRAN'   WBFILE           ***************E32894
     C*********************MOVELWRTERR    WBKEY            ** DBERR  08 **E32894
     C*********************Z-ADD08        WBASE            ***************E32894
     C*********************EXSR ABORT                                     E32894
     C*********************                                               E32894
     C*********************END                             ## E002        E32894
     C                     UPDATNTRANDDF                                  E32894
     C                     ELSE
     C                     EXSR NTRREP
     C                     DELETNTRANDDF               88                 E32894
     C/COPY WNCPYSRC,FT1000C041
     C                     END                             ## E001
     C                     ENDSR
     C********************************************************************
     C/EJECT                                                              S01117
     C********************************************************************S01117
     C* SUBZSF SR.                                                        S01117
     C* ZSFILE  HANDLING                                                  S01117
     C*                                                                   S01117
     C           SUBZSF    BEGSR                                          S01117
     C*                                                                   S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           ZSEQ    5                       S01117
     C                     PARM *BLANKS   ZENT    3                       S01117
     C                     PARM           ZSNAM  10                       S01117
     C                     PARM           ZSNUM   60                      S01117
     C                     PARM *BLANKS   ZERR    1                       S01117
     C*                                                                   S01117
     C                     ENDSR                                          S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C/EJECT
     C********************************************************************
     C**
     C**   CREATE A SEPERATE SET OF HASH TOTALS FOR EACH RECORD.
     C**
     C           HASH      BEGSR                           ** HASH   **
     C*
     C                     MOVE ZERO15    ZZAMT
     C                     MOVE ZERO15    ZZTOTI
     C                     MOVE ZERO15    ZZTOTD
     C*
     C                     ADD  1         CTN#,H
     C                     MOVE PRMAMT    ZZAMT
     C                     MOVE CTI#,H    ZZTOTI
     C                     MOVE CTD#,H    ZZTOTD
     C                     EXSR GLZADD
     C                     MOVE ZZTOTI    CTI#,H
     C                     MOVE ZZTOTD    CTD#,H
     C                     ENDSR
     C*
     C********************************************************************
     C/EJECT
0760 C********************************************************************
0761 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
0762 C*   IND '99' IS SET BY AN OVERFLOW ERROR
0763 C*
0764 C           GLZADD    BEGSR                           *** GLZADD ****
0765 C*
0766 C                     Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
0767 C   91                GOTO ZZAEND                     AMT = 0.BYPASS
0768 C*
0769 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
0770 C                     Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
0771 C                     MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
0772 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
0773 C*
0774 C                     EXSR GLZSUM
0775 C           ZZAEND    ENDSR                           ** ZZAEND TAG *
     C/EJECT
0776 C*
0777 C********************************************************************
0778 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
0779 C*                        GLZADD, GLZSUB, GLZCMP.
0780 C*          PARAMETERS PASSED -
0781 C*                     I/P ZZAMTI ZZAMTD
0782 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
0783 C*
0784 C           GLZSUM    BEGSR                           *** GLZSUM ****
0785 C*
0786 C                     Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
0787 C                     Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
0788 C                     SETOF                     919293
0789 C                     SETOF                     949599
0790 C*
0791 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
0792 C           ZZAMTI    COMP 0                      9293
0793 C   93      ZZAMTD    COMP 0                      9293
0794 C   93                GOTO ZZSEND                     ZERO BYPASS
0795 C*
0796 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
0797 C           ZZTOTI    COMP 0                      9193
0798 C   93      ZZTOTD    COMP 0                      9193
0799 C*
0800 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
0801 C   93                Z-ADDZZAMTI    ZZTOTI
0802 C   93                Z-ADDZZAMTD    ZZTOTD
0803 C   93                GOTO ZZSEND                     ZERO BYPASS
0804 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
0805 C   91N92
0806 CORN91 92             GOTO ZZOFPS
0807 C*
0808 C           ZZAMTD    ADD  ZZTOTD    ZZWK2   40
0809 C           ZZWK2     COMP 999                  93    '93' = CARRY
0810 C  N93      ZZWK2     COMP -999                   93    INTO INTEGER.
0811 C*
0812 C   93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
0813 C      93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
0814 C   93      ZZTOTI    ADD  ZZWK3     ZZWK3
0815 C  N93      ZZTOTI    ADD  ZZAMTI    ZZWK3
0816 C*
0817 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
0818 C  N92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
0819 C   92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
0820 C  N99                Z-ADDZZWK2     ZZTOTD
0821 C  N99                Z-ADDZZWK3     ZZTOTI
0822 C*
0823 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
0824 C   99                Z-ADD0         ZZAMT  153
0825 C                     GOTO ZZSEND
0826 C*
0727 C* THE 'SIGNS' ARE DIFFERENT
0828 C           ZZOFPS    TAG                             ** ZZOFPS TAG**
0829 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
0830 C*
0831 C   92                Z-SUBZZAMTI    ZZAMTI 150
0832 C   92                Z-SUBZZAMTD    ZZAMTD  30
0833 C*
0834 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
0835 C*
0836 C   91                Z-SUBZZTOTI    ZZTOTI
0837 C   91                Z-SUBZZTOTD    ZZTOTD
0838 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
0839 C*
0840 C           ZZTOTI    COMP ZZAMTI               93  95
0841 C   95      ZZTOTD    COMP ZZAMTD               93  95
0842 C*
0843 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
0844 C   95                Z-ADD0         ZZTOTI
0845 C   95                Z-ADD0         ZZTOTD
0846 C   95                GOTO ZZSEND
0847 C*
0848 C* IF ZZTOT GT. ZZAMT.
0849 C   93      ZZAMTD    COMP ZZTOTD               94
0850 C   93 94   ZZTOTI    SUB  1         ZZTOTI
0851 C   93 94   ZZTOTD    ADD  1000      ZZWK2
0852 C   93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
0853 C   93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
0854 C   93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
0855 C*
0856 C*
0857 C* IF ZZAMT GT. ZZTOT.
0858 C  N93      ZZTOTD    COMP ZZAMTD               94
0859 C  N93 94   ZZAMTI    SUB  1         ZZWK3  150
0860 C  N93 94   ZZAMTD    ADD  1000      ZZWK2
0861 C  N93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
0862 C  N93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
0863 C  N93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
0864 C  N93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
0865 C*
0866 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
0867 C                     SETOF                     94
0868 C   93 91
0869 CORN93 92             SETON                     94
0870 C   94                Z-SUBZZTOTI    ZZTOTI
0871 C   94                Z-SUBZZTOTD    ZZTOTD
0872 C**
0873 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
0874 C   92                Z-SUBZZAMTI    ZZAMTI
0875 C   92                Z-SUBZZAMTD    ZZAMTD
0876 C           ZZSEND    TAG                             ** ZZSEND TAG *
0877 C**
0878 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
0879 C                     SETOF                     96
0880 C           ZZTOTD    COMP 0                        91
0881 C   91      ZZTOTI    COMP 0                      96
0882 C   96                MOVE '.000-'   ZZNEGD  5
0883 C                     ENDSR                             ** ENDSR **
     C********************************************************************
     C/EJECT
     C********************************************************************
     C*                                                               *
     C*  INPREP - SUBROUTINE TO PRODUCE REPORT FT1000P4 FOR INCOMING  *
     C*           PAYMENTS                                            *
     C*                                                               *
     C*****************************************************************
     C*
     C*
     C           INPREP    BEGSR
     C*
     C                     MOVELTITL      P4TITL
     C                     MOVELRUNA      P4DATE
     C*                                                                   S01117
     C* IF MULTIBRANCHING INDICATOR ACTIVE, MOVE BOOKING BRANCH AND       S01117
     C* APPROPRIATE BRANCH NAME TO THE RELATIVE FIELDS SET UP WITHIN      S01117
     C* THE PRINTER FILE                                                  S01117
     C*                                                                   S01117
     C           *IN30     IFEQ '1'                                       S01117
     C                     MOVE BRCA      P4BRCA                          S01117
     C                     MOVE BRCA      WRKFLD  3                       S01117
     C                     EXSR SUBBRN                                    S01117
     C                     MOVELBRNM      P4BRNM                          S01117
     C*                                                                   S01117
     C* IF ORIGINATING BRANCH USED INDICATOR ACTIVE,MOVE ORBR AND         S01117
     C* APPROPRIATE BRANCH NAME TO THE RELATIVE FIELDS SET UP WITHIN      S01117
     C* THE PRINTER FILE                                                  S01117
     C*                                                                   S01117
     C           *IN35     IFEQ '1'                                       S01117
     C                     MOVE ORBR      P4ORBR                          S01117
     C                     MOVE ORBR      WRKFLD                          S01117
     C                     EXSR SUBBRN                                    S01117
     C                     MOVELBRNM      P4ORNM                          S01117
     C                     END                                            S01117
     C                     END                                            S01117
      *************                                                       S01435
     C*************                                                       S01435
     C***SETUP*ADDRESS FIELDS,ACESSING CLINT AS APPROPRIATE               S01435
     C*************                                                       S01435
     C***SENDER****                                                       S01435
     C*************                                                       S01435
     C***********SNTP      IFNE 'C'                                       S01435
     C*************        MOVELSND1      P4SND1                          S01435
     C*************                                                       S01117
     C**IF*MULTIBRANCHING INDICATOR SETOF AND FULL ACCOUNT ENTRY,SINGLE   S01117
     C**BRANCH*NEED TO BE FORMATTED BY CUTTING OFF THE BRANCH CODE FROM   S01117
     C**THE*END*USING A WORK FIELD BEFORE OUTPUTING TO THE PRINTER FILE   S01117
     C*************                                                       S01117
     C************IN30     IFEQ '0'                                       S01117
     C***********SNTP      ANDEQ'G'                                       S01117
     C*************        MOVELSND1      FLD15                           S01117
     C*************        MOVE *BLANKS   P4SND1                          S01117
     C*************        MOVELFLD15     P4SND1                          S01117
     C*************        END                                            S01117
     C*************        MOVELSND2      P4SND2                          S01435
     C*************        MOVELSND3      P4SND3                          S01435
     C*************        MOVELSND4      P4SND4                          S01435
     C*************        MOVEL*BLANKS   P4SND5                          S01435
     C*************        ELSE                                           S01435
     C*************        MOVELSND1      WCLNUM                          S01435
     C*************        MOVEL'B'       WCLRCT                          S01435
     C*************        EXSR UCCLCN                                    S01435
     C*************                                                       S01435
     C************IN89     IFEQ '1'                                       S01435
     C*************        MOVEL'CLINT'   WBFILE                          S01435
     C*************        MOVELWCLNUM    WA7     7                       S01435
     C*************        MOVE WCLRCT    WA7              **********     S01435
     C*************        MOVELWA7       WBKEY            * DBERR 09     S01435
     C*************        Z-ADD09        WBASE            **********     S01435
     C*************        EXSR ABORT                      *ABORT PGM*    S01435
     C*************        END                                            S01435
     C*************                                                       S01435
     C*************        MOVELSND1      P4SND1                          S01435
     C*************        MOVELCNA1      P4SND2                          S01435
     C*************        MOVELCNA2      P4SND3                          S01435
     C*************        MOVELCNA3      P4SND4                          S01435
     C*************        MOVELCNA4      P4SND5                          S01435
     C*************        END                                            S01435
     C*************                                                       S01435
     C***INTERMEDIARY BANK                                                S01435
     C*************                                                       S01435
     C***********INBT      IFNE 'C'                                       S01435
     C*************        MOVELINB1      P4INB1                          S01435
     C*************        MOVELINB2      P4INB2                          S01435
     C*************        MOVELINB3      P4INB3                          S01435
     C*************        MOVELINB4      P4INB4                          S01435
     C*************        MOVELINB5      P4INB5                          S01435
     C*************        ELSE                                           S01435
     C*************        MOVELINB1      WCLNUM                          S01435
     C*************        MOVEL'B'       WCLRCT                          S01435
     C*************        EXSR UCCLCN                                    S01435
     C*************                                                       S01435
     C************IN89     IFEQ '1'                                       S01435
     C*************        MOVEL'CLINT'   WBFILE                          S01435
     C*************        MOVELWCLNUM    WA7                             S01435
     C*************        MOVE WCLRCT    WA7              **********     S01435
     C*************        MOVELWA7       WBKEY            * DBERR 10     S01435
     C*************        Z-ADD10        WBASE            **********     S01435
     C*************        EXSR ABORT                      *ABORT PGM*    S01435
     C*************        END                                            S01435
     C*************                                                       S01435
     C*************        MOVELINB1      P4INB1                          S01435
     C*************        MOVELCNA1      P4INB2                          S01435
     C*************        MOVELCNA2      P4INB3                          S01435
     C*************        MOVELCNA3      P4INB4                          S01435
     C*************        MOVELCNA4      P4INB5                          S01435
     C*************        END                                            S01435
     C*************                                                       S01435
     C***SENDER'S*CORRESPONDENT                                           S01435
     C*************                                                       S01435
     C***********SNCT      IFNE 'C'                                       S01435
     C*************        MOVELSNC1      P4SNC1                          S01435
     C*************        MOVELSNC2      P4SNC2                          S01435
     C*************        MOVELSNC3      P4SNC3                          S01435
     C*************        MOVELSNC4      P4SNC4                          S01435
     C*************        MOVELSNC5      P4SNC5                          S01435
     C*************        ELSE                                           S01435
     C*************        MOVELSNC1      WCLNUM                          S01435
     C*************        MOVEL'B'       WCLRCT                          S01435
     C*************        EXSR UCCLCN                                    S01435
     C*************                                                       S01435
     C************IN89     IFEQ '1'                                       S01435
     C*************        MOVEL'CLINT'   WBFILE                          S01435
     C*************        MOVELWCLNUM    WA7                             S01435
     C*************        MOVE WCLRCT    WA7              **********     S01435
     C*************        MOVELWA7       WBKEY            * DBERR 11     S01435
     C*************        Z-ADD11        WBASE            **********     S01435
     C*************        EXSR ABORT                      *ABORT PGM*    S01435
     C*************        END                                            S01435
     C*************                                                       S01435
     C*************        MOVELSNC1      P4SNC1                          S01435
     C*************        MOVELCNA1      P4SNC2                          S01435
     C*************        MOVELCNA2      P4SNC3                          S01435
     C*************        MOVELCNA3      P4SNC4                          S01435
     C*************        MOVELCNA4      P4SNC5                          S01435
     C*************        END                                            S01435
     C*************                                                       S01435
     C***ORDERING*BANK                                                    S01435
     C*************                                                       S01435
     C***********ORBT      IFNE 'C'                                       S01435
     C*************        MOVELORB1      P4ORB1                          S01435
     C*************        MOVELORB2      P4ORB2                          S01435
     C*************        MOVELORB3      P4ORB3                          S01435
     C*************        MOVELORB4      P4ORB4                          S01435
     C*************        MOVEL*BLANKS   P4ORB5                          S01435
     C*************        ELSE                                           S01435
     C*************        MOVELORB1      WCLNUM                          S01435
     C*************        MOVEL'B'       WCLRCT                          S01435
     C*************        EXSR UCCLCN                                    S01435
     C*************                                                       S01435
     C************IN89     IFEQ '1'                                       S01435
     C*************        MOVEL'CLINT'   WBFILE                          S01435
     C*************        MOVELWCLNUM    WA7                             S01435
     C*************        MOVE WCLRCT    WA7              **********     S01435
     C*************        MOVELWA7       WBKEY            * DBERR 12     S01435
     C*************        Z-ADD12        WBASE            **********     S01435
     C*************        EXSR ABORT                      *ABORT PGM*    S01435
     C*************        END                                            S01435
     C*************                                                       S01435
     C*************        MOVELORB1      P4ORB1                          S01435
     C*************        MOVELCNA1      P4ORB2                          S01435
     C*************        MOVELCNA2      P4ORB3                          S01435
     C*************        MOVELCNA3      P4ORB4                          S01435
     C*************        MOVELCNA4      P4ORB5                          S01435
     C*************        END                                            S01435
     C*************                                                       S01435
     C***BENEFICIARY CUSTOMER                                             S01435
     C*************                                                       S01435
     C***********BNCT      IFNE 'C'                                       S01435
     C*************        MOVELBNC1      P4BNC1                          S01435
     C*************                                                       S01117
     C**IF*MULTIBRANCHING INDICATOR SETOF AND PARTIAL ACCOUNT ENTRY,      S01117
     C**SINGLE*BRANCH NEED TO BE FORMATTED BY CUTTING OFF THE BRANCH CODE S01117
     C**FROM*THE*END USING WORK FIELD BEFORE OUTPUTING TO THE PRINTER     S01117
     C**FILE*******                                                       S01117
     C************IN30     IFEQ '0'                                       S01117
     C***********BNCT      ANDEQ'P'                                       S01117
     C*************        MOVELBNC1      FLD12                           S01117
     C*************        MOVE *BLANKS   P4BNC1                          S01117
     C*************        MOVELFLD12     P4BNC1                          S01117
     C*************        END                                            S01117
     C*************        MOVELBNC2      P4BNC2                          S01435
     C*************        MOVELBNC3      P4BNC3                          S01435
     C*************        MOVELBNC4      P4BNC4                          S01435
     C*************        MOVELBNC5      P4BNC5                          S01435
     C*************        ELSE                                           S01435
     C*************        MOVELBNC1      WCLNUM                          S01435
     C*************        MOVEL'B'       WCLRCT                          S01435
     C*************        EXSR UCCLCN                                    S01435
     C*************                                                       S01435
     C************IN89     IFEQ '1'                                       S01435
     C*************        MOVEL'CLINT'   WBFILE                          S01435
     C*************        MOVELWCLNUM    WA7                             S01435
     C*************        MOVE WCLRCT    WA7              **********     S01435
     C*************        MOVELWA7       WBKEY            * DBERR 13     S01435
     C*************        Z-ADD13        WBASE            **********     S01435
     C*************        EXSR ABORT                      *ABORT PGM*    S01435
     C*************        END                                            S01435
     C*************                                                       S01435
     C*************        MOVELBNC1      P4BNC1                          S01435
     C*************        MOVELCNA1      P4BNC2                          S01435
     C*************        MOVELCNA2      P4BNC3                          S01435
     C*************        MOVELCNA3      P4BNC4                          S01435
     C*************        MOVELCNA4      P4BNC5                          S01435
     C*************        END                                            S01435
     C*************                                                       S01435
     C***ORDERING*CUSTOMER                                                S01435
     C*************                                                       S01435
     C***********ORCT      IFNE 'C'                                       S01435
     C*************        MOVELORC1      P4ORC1                          S01435
     C*************        MOVELORC2      P4ORC2                          S01435
     C*************        MOVELORC3      P4ORC3                          S01435
     C*************        MOVELORC4      P4ORC4                          S01435
     C*************        MOVEL*BLANKS   P4ORC5                          S01435
     C*************        ELSE                                           S01435
     C*************        MOVELORC1      WCLNUM                          S01435
     C*************        MOVEL'B'       WCLRCT                          S01435
     C*************        EXSR UCCLCN                                    S01435
     C*************                                                       S01435
     C************IN89     IFEQ '1'                                       S01435
     C*************        MOVEL'CLINT'   WBFILE                          S01435
     C*************        MOVELWCLNUM    WA7                             S01435
     C*************        MOVE WCLRCT    WA7              **********     S01435
     C*************        MOVELWA7       WBKEY            * DBERR 14     S01435
     C*************        Z-ADD14        WBASE            **********     S01435
     C*************        EXSR ABORT                      *ABORT PGM*    S01435
     C*************        END                                            S01435
     C*************                                                       S01435
     C*************        MOVELORC1      P4ORC1                          S01435
     C*************        MOVELCNA1      P4ORC2                          S01435
     C*************        MOVELCNA2      P4ORC3                          S01435
     C*************        MOVELCNA3      P4ORC4                          S01435
     C*************        MOVELCNA4      P4ORC5                          S01435
     C*************        END                                            S01435
     C*************                                                       S01435
     C***FORMAT*PAY & SETTLE AMOUNTS                                      S01435
     C*************                                                       S01435
     C***CALL*UATBCN TO ACCESS CURRENCY RECORD FOR SETTLE CURRENCY        S01435
     C*************                                                       S01435
     C*************        MOVEL*BLANKS   ZTABKY                          S01435
     C*************        MOVEL'20'      ZTABKY                          S01435
     C*************        MOVELSMCY      WA4     4                       S01435
     C*************        MOVE '1'       WA4                             S01435
     C*************        MOVE WA4       ZTABKY                          S01435
     C*************        EXSR UATBCN                                    S01435
     C*************                                                       S01435
     C***CHECK*IF*DATABASE ERROR OCCURRED                                 S01435
     C*************                                                       S01435
     C************IN89     IFEQ '1'                                       S01435
     C*************        MOVEL'TABLE'   WBFILE           **********     S01435
     C*************        MOVELZTABKY    WBKEY            * DBERR 15     S01435
     C*************        Z-ADD15        WBASE            **********     S01435
     C*************        EXSR ABORT                      *ABORT PGM*    S01435
     C*************        END                                            S01435
     C*************                                                       S01435
     C***STORE*NUMBER OF DECIMAL PLACES FOR SETTLE CURRENCY               S01435
     C*************                                                       S01435
     C*************        Z-ADDCDP       SVSCDP  10                      S01435
     C*************                                                       S01435
     C***FORMAT*SETTLE AMOUNT                                             S01435
     C*************                                                       S01435
     C*************        MOVEL*BLANKS   WFDIN  15                       S01435
     C*************        MOVE SMAM      WFDIN                           S01435
     C*************        Z-ADDSVSCDP    WDEC    10                      S01435
     C***********13        SUB  SVSCDP    WDIG    20                      S01435
     C*************        EXSR UGFRMT                                    S01435
     C*************        MOVE WFDOUT    P4SMAM                          S01435
     C*************                                                       S01435
     C***CALL*UATBCN TO ACCESS CURRENCY RECORD FOR PAY CURRENCY           S01435
     C*************                                                       S01435
     C*************        MOVEL*BLANKS   ZTABKY                          S01435
     C*************        MOVEL'20'      ZTABKY                          S01435
     C*************        MOVELPCCY      WA4                             S01435
     C*************        MOVE '1'       WA4                             S01435
     C*************        MOVE WA4       ZTABKY                          S01435
     C*************        EXSR UATBCN                                    S01435
     C*************                                                       S01435
     C***CHECK*IF*DATABASE ERROR OCCURRED                                 S01435
     C*************                                                       S01435
     C************IN89     IFEQ '1'                                       S01435
     C*************        MOVEL'TABLE'   WBFILE           **********     S01435
     C*************        MOVELZTABKY    WBKEY            * DBERR 17     S01435
     C*************        Z-ADD17        WBASE            **********     S01435
     C*************        EXSR ABORT                      *ABORT PGM*    S01435
     C*************        END                                            S01435
     C*************                                                       S01435
     C***STORE*NUMBER OF DECIMAL PLACES FOR PAY CURRENCY                  S01435
     C*************                                                       S01435
     C*************        Z-ADDCDP       SVPCDP  10                      S01435
     C*************                                                       S01435
     C***FORMAT*PAY AMOUNT                                                S01435
     C*************                                                       S01435
     C*************        MOVEL*BLANKS   WFDIN                           S01435
     C*************        MOVE PYAM      WFDIN                           S01435
     C*************        Z-ADDSVPCDP    WDEC                            S01435
     C***********13        SUB  SVPCDP    WDIG                            S01435
     C*************        EXSR UGFRMT                                    S01435
     C*************        MOVE WFDOUT    P4PYAM                          S01435
     C*************                                                       S01435
     C***FORMAT*OTHER AMOUNTS & CURRENCIES                                S01435
     C***IF*CHARGES TO DEBIT A/C FIELD IS NON-ZERO USE BASE CURRENCY;     S01435
     C***OTHERWISE*IF PAY PLUS CHARGES INDICATOR IS 'Y' USE SETTLE CCY;   S01435
     C***OTHERWISE*USE PAY CURRENCY                                       S01435
     C*************                                                       S01435
     C***********CDRO      IFNE *ZERO                                     S01435
     C*************        MOVELBCCY      WCCY    3                       S01435
     C*************        Z-ADDSVBCDP    WDEC                            S01435
     C*************        ELSE                                           S01435
     C***********ADDC      IFEQ 'Y'                                       S01435
     C*************        MOVELSMCY      WCCY                            S01435
     C*************        Z-ADDSVSCDP    WDEC                            S01435
     C*************        ELSE                                           S01435
     C*************        MOVELPCCY      WCCY                            S01435
     C*************        Z-ADDSVPCDP    WDEC                            S01435
     C*************        END                                            S01435
     C*************        END                                            S01435
     C*************                                                       S01435
     C***********11        SUB  WDEC      WDIG                            S01435
     C*************                                                       S01435
     C***SETUP*CURRENCY NAMES                                             S01435
     C*************                                                       S01435
     C*************        MOVELWCCY      P4TRCY                          S01435
     C*************        MOVELWCCY      P4TXCY                          S01435
     C*************        MOVELWCCY      P4CQCY                          S01435
     C*************        MOVELWCCY      P4TLCY                          S01435
     C*************        MOVELWCCY      P4ADCY                          S01435
     C*************        MOVELWCCY      P4MSCY                          S01435
     C*************                                                       S01435
     C***FORMAT*TRANSFER COMMISSION AMOUNT                                S01435
     C*************                                                       S01435
     C*************        MOVEL*BLANKS   WFDIN                           S01435
     C*************        MOVE TRCM      WFDIN                           S01435
     C*************        EXSR UGFRMT                                    S01435
     C*************        MOVE WFDOUT    P4TRCM                          S01435
     C*************                                                       S01435
     C***FORMAT*TELEX CHARGE AMOUNT                                       S01435
     C*************                                                       S01435
     C*************        MOVEL*BLANKS   WFDIN                           S01435
     C*************        MOVE TXCH      WFDIN                           S01435
     C*************        EXSR UGFRMT                                    S01435
     C*************        MOVE WFDOUT    P4TXCH                          S01435
     C*************                                                       S01435
     C***FORMAT*CHEQUE CHARGE AMOUNT                                      S01435
     C*************                                                       S01435
     C*************        MOVEL*BLANKS   WFDIN                           S01435
     C*************        MOVE CQCH      WFDIN                           S01435
     C*************        EXSR UGFRMT                                    S01435
     C*************        MOVE WFDOUT    P4CQCH                          S01435
     C*************                                                       S01435
     C***FORMAT*TELEPHONE CHARGE AMOUNT                                   S01435
     C*************                                                       S01435
     C*************        MOVEL*BLANKS   WFDIN                           S01435
     C*************        MOVE TLCH      WFDIN                           S01435
     C*************        EXSR UGFRMT                                    S01435
     C*************        MOVE WFDOUT    P4TLCH                          S01435
     C*************                                                       S01435
     C***FORMAT*ADVICE CHARGE AMOUNT                                      S01435
     C*************                                                       S01435
     C*************        MOVEL*BLANKS   WFDIN                           S01435
     C*************        MOVE ADCH      WFDIN                           S01435
     C*************        EXSR UGFRMT                                    S01435
     C*************        MOVE WFDOUT    P4ADCH                          S01435
     C*************                                                       S01435
     C***FORMAT*MISCELLANEOUS CHARGE AMOUNT                               S01435
     C*************                                                       S01435
     C*************        MOVEL*BLANKS   WFDIN                           S01435
     C*************        MOVE MSCH      WFDIN                           S01435
     C*************        EXSR UGFRMT                                    S01435
     C*************        MOVE WFDOUT    P4MSCH                          S01435
     C*************                                                       S01435
     C***FORMAT*DATE FIELDS USING SYSTEM ROUTINE ZDATE2                   S01435
     C*************                                                       S01435
     C***SETTLE*VALUE DATE                                                S01435
     C*************                                                       S01435
     C*************        Z-ADDSLDT      ZDAYNO                          S01435
     C*************        EXSR ZDATE2                                    S01435
     C*************        MOVELZADATE    P4SLDT                          S01435
     C*************                                                       S01435
     C***PAY*VALUE*DATE                                                   S01435
     C*************                                                       S01435
     C*************        Z-ADDPVDT      ZDAYNO                          S01435
     C*************        EXSR ZDATE2                                    S01435
     C*************        MOVELZADATE    P4PYDT                          S01435
     C*************                                                       S01435
     C***SETUP*REMAINING REPORT FIELDS                                    S01435
     C*************                                                       S01435
     C*************        MOVELPREF      P4PREF                          S01435
     C*************        MOVELRLPR      P4RLPR                          S01435
     C*************        MOVELPYTP      P4PYTP                          S01435
     C*************        MOVELPYST      P4PYST                          S01435
     C*************        MOVELSMCY      P4SMCY                          S01435
     C*************        Z-ADDRATE      P4RATE                          S01435
     C*************        MOVELPCCY      P4PCCY                          S01435
     C*************        MOVELBBI1      P4BBI1                          S01435
     C*************        MOVELBBI2      P4BBI2                          S01435
     C*************        MOVELBBI3      P4BBI3                          S01435
     C*************        MOVELBBI4      P4BBI4                          S01435
     C*************        MOVELBBI5      P4BBI5                          S01435
     C*************        MOVELBBI6      P4BBI6                          S01435
     C*************        MOVELDTP1      P4DTP1                          S01435
     C*************        MOVELDTP2      P4DTP2                          S01435
     C*************        MOVELDTP3      P4DTP3                          S01435
     C*************        MOVELDTP4      P4DTP4                          S01435
     C***********DNBC      IFEQ *ZERO                                     S01435
     C*************        MOVE *BLANKS   P4DNBC                          S01435
     C*************        ELSE                                           S01435
     C*************        MOVELDNBC      P4DNBC                          S01435
     C*************        END                                            S01435
     C*************        MOVELADDC      P4ADDC                          S01435
     C*************        MOVELDTCH      P4DTCH                          S01435
     C*************        MOVELTRCT      P4TRCT                          S01435
     C*********************MOVELSWPC      P4SWPC                          S01117
     C***FORMAT*SWIFT PRIORITY CODE                                       S01117
     C*************                                                       S01117
     C***********SWPC      IFEQ 1                                         S01117
     C*************        MOVE 'U'       P4SWPC                          S01117
     C*************        ELSE                                           S01117
     C***********SWPC      IFEQ 2                                         S01117
     C*************        MOVE 'N'       P4SWPC                          S01117
     C*************        END                                            S01117
     C*************        END                                            S01117
     C*************                                                       S01435
     C***EDIT**RCCO, ACBK AND CDRO  FOR OUTPUT                            S01435
     C*************                                                       S01435
     C*************        MOVE RCRT      PRMTYP  1        ( RCCO )       S01435
     C*************        MOVE *ZEROS    PRMFLD 12                       S01435
     C*************        MOVELRCCO      PRMFLD                          S01435
     C*************        EXSR CHOPF                                     S01435
     C*************        MOVELPRMFLD    P4RCCO                          S01435
     C*************                                                       S01435
     C*************        MOVELACBK      P4ACBK           ( ACBK )       S01435
     C*************        MOVE ACBB      P4ACBB                          S01117
     C*************                                                       S01435
     C*************        MOVE CDRT      PRMTYP           ( CDRO )       S01435
     C*************        MOVE *ZEROS    PRMFLD                          S01435
     C*************        MOVELCDRO      PRMFLD                          S01435
     C*************        EXSR CHOPF                                     S01435
     C*************        MOVELPRMFLD    P4CDRO                          S01435
     C*************        MOVE CDBR      P4CDBR                          S01117
      *                                                                   055293
      * Clear Receiver's Correspondent and Account with bank prt flds     055293
      *                                                                   055293
     C                     MOVEL*BLANKS   P4ACBK                          055293
     C                     MOVEL*BLANKS   P4ACDS                          055293
     C                     MOVEL*BLANKS   P4RCDS                          055293
     C***********          MOVEL*BLANKS   P4RCCO                   055293 CFT014
      *                                                                   055293
      * Set up Account with Institution Details                           055293
      *                                                                   055293
     C           INACB1    IFNE *BLANKS                                   S01435
      *                                                                   S01435
      * If SWIFT type A translate else leave as on message                S01435
      *                                                                   S01435
     C                     MOVEL#IMSG     P4ACBK                          S01435
     C           INACBT    IFNE 'S'                                       S01435
     C                     MOVELINACB1    P4ACB1                          055293
     C                     MOVELINACB2    P4ACB2                          055293
     C                     MOVELINACB3    P4ACB3                          055293
     C                     MOVELINACB4    P4ACB4                          055293
     C                     MOVELINACB5    P4ACB5                          055293
     C                     ELSE                                           S01435
     C                     MOVEL'ACBT'    XCALL                           S01435
     C                     MOVELINACBT    XTYPE                           S01435
     C                     MOVEL*BLANKS   XNAMDS                          S01435
     C                     MOVELINACB1    ##001   1                       S01435
     C           ##001     IFEQ '/'                                       S01435
     C                     MOVELINACB2    XNAMDS                          S01435
     C                     ELSE                                           S01435
     C                     MOVELINACB1    XNAMDS                          S01435
     C                     END                                            S01435
     C                     EXSR GETADD                                    S01435
     C                     MOVELXNAMDS    P4ACDS                          S01435
     C                     END                                            S01435
     C                     END                                            S01435
      *                                                                   055293
      * Translate input account with bank                                 055293
      *                                                                   055293
     C           ACBT      IFNE *BLANKS                                   S01435
     C                     MOVEL'ACBT'    XCALL                           S01435
     C                     MOVELACBT      XTYPE                           S01435
     C                     MOVELPCCY      XCCY                            S01435
     C                     MOVEL*BLANKS   XNAMDS                          S01435
     C                     MOVELACBK      XNAMDS                          S01435
     C                     MOVE ACBB      XBRCA                           S01435
     C                     EXSR GETADD                                    S01435
     C           INACB1    IFEQ *BLANKS                                   S01435
     C                     MOVELXADDS     P4ACDS                          S01435
     C                     END                                            S01435
     C                     MOVELXNAMDS    P4ACBK                          S01435
     C                     END                                            S01435
      *                                                                   055293
      **Set*up*Receivers*Correspondant*Details**********************055293CFT014
      **************************************************************055293CFT014
     C***********INRCO1    IFNE *BLANKS                             S01435CFT014
      **************************************************************S01435CFT014
      **If*SWIFT*type*A*translate*else*leave*as*on*message**********S01435CFT014
      **************************************************************S01435CFT014
     C***********          MOVEL#IMSG     P4RCCO                    S01435CFT014
     C***********INRCRT    IFNE 'S'                                 S01435CFT014
     C***********          MOVELINRCO1    P4RCO1                    055293CFT014
     C***********          MOVELINRCO2    P4RCO2                    055293CFT014
     C***********          MOVELINRCO3    P4RCO3                    055293CFT014
     C***********          MOVELINRCO4    P4RCO4                    055293CFT014
     C***********          MOVELINRCO5    P4RCO5                    055293CFT014
     C***********          ELSE                                     S01435CFT014
     C***********          MOVEL'RCRT'    XCALL                     S01435CFT014
     C***********          MOVELINRCRT    XTYPE                     S01435CFT014
     C***********          MOVEL*BLANKS   XNAMDS                    S01435CFT014
     C***********          MOVELINRCO1    ##001   1                 S01435CFT014
     C***********##001     IFEQ '/'                                 S01435CFT014
     C***********          MOVELINRCO2    XNAMDS                    S01435CFT014
     C***********          ELSE                                     S01435CFT014
     C***********          MOVELINRCO1    XNAMDS                    S01435CFT014
     C***********          END                                      S01435CFT014
     C***********          EXSR GETADD                              S01435CFT014
     C***********          MOVELXNAMDS    P4RCDS                    S01435CFT014
     C***********          END                                      S01435CFT014
     C***********          END                                      S01435CFT014
      **************************************************************055293CFT014
      **Translate*as*no*message*info********************************055293CFT014
      **************************************************************055293CFT014
     C***********RCRT      IFNE *BLANKS                             S01435CFT014
     C***********          MOVEL'RCRT'    XCALL                     S01435CFT014
     C***********          MOVELRCRT      XTYPE                     S01435CFT014
     C***********          MOVELSMCY      XCCY                      S01435CFT014
     C***********          MOVEL*BLANKS   XNAMDS                    S01435CFT014
     C***********          MOVELRCCO      XNAMDS                    S01435CFT014
     C***********          EXSR GETADD                              S01435CFT014
     C***********INRCO1    IFEQ *BLANKS                             S01435CFT014
     C***********          MOVELXADDS     P4RCDS                    S01435CFT014
     C***********          END                                      S01435CFT014
     C***********          MOVELXNAMDS    P4RCCO                    S01435CFT014
     C***********          END                                      S01435CFT014
     C*                                                                   S01435
     C** SENDER                                                           S01435
     C*                                                                   S01435
     C                     MOVEL'SNTP'    XCALL   4                       S01435
     C                     MOVELSNTP      XTYPE                           S01435
     C                     MOVELSDINDS    XNAMDS                          S01435
     C                     EXSR GETADD                                    S01435
     C                     MOVELXNAMDS    P4SDDS                          S01435
      *                                                                   CFT014
      ** Receiver's Correspondent                                         CFT014
      *                                                                   CFT014
     C                     MOVEL'RCRT'    XCALL                           CFT014
     C                     MOVELINRCRT    XTYPE                           CFT014
     C                     MOVE *BLANKS   P4RCDS                          CFT014
      *                                                                   CFT014
     C           INRCO1    IFNE *BLANKS                                   CFT014
     C           INRCO2    ORNE *BLANKS                                   CFT014
     C           INRCO3    ORNE *BLANKS                                   CFT014
     C           INRCO4    ORNE *BLANKS                                   CFT014
     C           INRCO5    ORNE *BLANKS                                   CFT014
     C                     MOVELINRCO1    P4RCO1                          CFT014
     C                     MOVELINRCO2    P4RCO2                          CFT014
     C                     MOVELINRCO3    P4RCO3                          CFT014
     C                     MOVELINRCO4    P4RCO4                          CFT014
     C                     MOVELINRCO5    P4RCO5                          CFT014
     C                     MOVELP4RCDS    XNAMDS                          CFT014
     C                     EXSR GETADD                                    CFT014
     C                     MOVELXNAMDS    P4RCDS                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   S01435
     C*                                                                   S01435
     C** INTERMEDIARY BANK                                                S01435
     C*                                                                   S01435
     C                     MOVEL'INBT'    XCALL   4                       S01435
     C                     MOVELINBT      XTYPE                           S01435
     C                     MOVELININDS    XNAMDS                          S01435
     C                     EXSR GETADD                                    S01435
     C                     MOVELXNAMDS    P4INDS                          S01435
      *                                                                   S01435
     C*                                                                   S01435
     C*                                                                   S01435
     C** SENDER'S CORRESPONDENT                                           S01435
     C*                                                                   S01435
     C                     MOVEL'SNCT'    XCALL   4                       S01435
     C                     MOVELSNCT      XTYPE                           S01435
     C                     MOVELSNINDS    XNAMDS                          S01435
     C                     EXSR GETADD                                    S01435
     C                     MOVELXNAMDS    P4SNDS                          S01435
      *                                                                   S01435
     C*                                                                   S01435
     C** ORDERING BANK                                                    S01435
     C*                                                                   S01435
     C                     MOVEL'ORBT'    XCALL   4                       S01435
     C                     MOVELORBT      XTYPE                           S01435
     C                     MOVELORBDSI    XNAMDS                          S01435
     C                     EXSR GETADD                                    S01435
     C                     MOVELXNAMDS    ORBDS                           S01435
      *                                                                   S01435
     C*                                                                   S01435
     C** BENEFICIARY CUSTOMER                                             S01435
     C*                                                                   S01435
     C                     MOVEL'BNCT'    XCALL   4                       S01435
     C                     MOVELBNCT      XTYPE                           S01435
     C                     MOVELPCCY      XCCY                            S01435
     C                     MOVELBNINDS    XNAMDS                          S01435
     C                     EXSR GETADD                                    S01435
     C                     MOVELXNAMDS    P4BNDS                          S01435
      *                                                                   S01435
     C*                                                                   S01435
     C** ORDERING CUSTOMER                                                S01435
     C*                                                                   S01435
     C                     MOVEL'ORCT'    XCALL   4                       S01435
     C                     MOVELORCT      XTYPE                           S01435
     C                     MOVELORINDS    XNAMDS                          S01435
     C                     EXSR GETADD                                    S01435
     C                     MOVELXNAMDS    ORCDS                           S01435
      *                                                                   S01435
     C                     MOVE *BLANKS   XCALL   4                       S01435
      *                                                                   S01435
     C*                                                                   S01435
     C** FORMAT PAY & SETTLE AMOUNTS                                      S01435
     C*                                                                   S01435
     C** CALL UATBCN TO ACCESS CURRENCY RECORD FOR SETTLE CURRENCY        S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   ZTABKY                          S01435
     C                     MOVEL'20'      ZTABKY                          S01435
     C                     MOVELSMCY      WA4                             S01435
     C                     MOVE '1'       WA4                             S01435
     C                     MOVE WA4       ZTABKY                          S01435
     C                     EXSR UATBCN                                    S01435
     C*                                                                   S01435
     C** CHECK IF DATABASE ERROR OCCURRED                                 S01435
     C*                                                                   S01435
     C           *IN89     IFEQ '1'                                       S01435
     C                     MOVEL'TABLE'   WBFILE                          S01435
     C                     MOVELZTABKY    WBKEY                           S01435
     C                     MOVEL'58'      WBASE                           S01435
     C                     EXSR ABORT                      *ABORT PGM*    S01435
     C                     END                                            S01435
     C*                                                                   S01435
     C** STORE NUMBER OF DECIMAL PLACES FOR SETTLE CURRENCY               S01435
     C*                                                                   S01435
     C                     Z-ADDCDP       SVSCDP  10                      S01435
     C*                                                                   S01435
     C** FORMAT SETTLE AMOUNT                                             S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN  15                       S01435
     C                     MOVE SMAM      WFDIN                           S01435
     C                     Z-ADDSVSCDP    WDEC    10                      S01435
     C           13        SUB  SVSCDP    WDIG    20                      S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P4SMAM                          S01435
     C*                                                                   S01435
     C** CALL UATBCN TO ACCESS CURRENCY RECORD FOR PAY CURRENCY           S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   ZTABKY                          S01435
     C                     MOVEL'20'      ZTABKY                          S01435
     C                     MOVELPCCY      WA4                             S01435
     C                     MOVE '1'       WA4                             S01435
     C                     MOVE WA4       ZTABKY                          S01435
     C                     EXSR UATBCN                                    S01435
     C*                                                                   S01435
     C** CHECK IF DATABASE ERROR OCCURRED                                 S01435
     C*                                                                   S01435
     C           *IN89     IFEQ '1'                                       S01435
     C                     MOVEL'TABLE'   WBFILE                          S01435
     C                     MOVELZTABKY    WBKEY                           S01435
     C                     MOVEL'58'      WBASE                           S01435
     C                     EXSR ABORT                      *ABORT PGM*    S01435
     C                     END                                            S01435
     C*                                                                   S01435
     C** STORE NUMBER OF DECIMAL PLACES FOR PAY CURRENCY                  S01435
     C*                                                                   S01435
     C                     Z-ADDCDP       SVPCDP  10                      S01435
     C*                                                                   S01435
     C** FORMAT PAY AMOUNT                                                S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE PYAM      WFDIN                           S01435
     C                     Z-ADDSVPCDP    WDEC                            S01435
     C           13        SUB  SVPCDP    WDIG                            S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P4PYAM                          S01435
      *                                                                   CFT014
      ** Format Instructed amount considering the Instructed currency.    CFT014
      *                                                                   CFT014
     C                     MOVE *OFF      *IN40                           CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
     C           CEU006    OREQ 'Y'                                       CFT014
      *                                                                   CFT014
     C                     MOVE *BLANKS   P4PDCY                          CFT014
     C                     MOVE *BLANKS   P4PDAM                          CFT014
     C           NDAM      IFNE 0                                         CFT014
     C                     MOVE *ON       *IN40                           CFT014
     C                     CALL 'AOCURRR0'                                CFT014
     C                     PARM *BLANKS   WRTCD                           CFT014
     C                     PARM '*KEY   ' WOPTN                           CFT014
     C                     PARM NDCY      WCCY    3                       CFT014
     C           SDCURR    PARM SDCURR    DSSDY                           CFT014
     C           WRTCD     IFNE *BLANKS                                   CFT014
     C                     Z-ADD21        WBASE            ************   CFT014
     C                     MOVELNDCY      WBKEY            * DBERR021 *   CFT014
     C                     MOVEL'SDCURRPD'WBFILE           ************   CFT014
     C                     EXSR ABORT                                     CFT014
     C                     ENDIF                                          CFT014
     C                     Z-ADDA6NBDP    WPDNDP  20                      CFT014
      *                                                                   CFT014
     C                     MOVEL*BLANKS   WFDIN                           CFT014
     C                     MOVE NDAM      WFDIN                           CFT014
     C                     Z-ADDA6NBDP    WDEC                            CFT014
     C           13        SUB  A6NBDP    WDIG                            CFT014
     C                     EXSR UGFRMT                                    CFT014
     C                     MOVE NDCY      P4PDCY                          CFT014
     C                     MOVE WFDOUT    P4PDAM                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                                       CFT120
      ** Retrieve currency details                                                            CFT120
      *                                                                                       CFT120
     C           CFT120    IFEQ 'Y'                                                           CFT120
     C                     Z-ADD0         SVICDP  10                                          CFT120
      *                                                                                       CFT120
     C           INCDRC    IFNE *BLANKS                                                       CFT120
     C                     CALL 'AOCURRR0'                                                    CFT120
     C                     PARM *BLANKS   @RTCD                                               CFT120
     C                     PARM '*KEY   ' @OPTN                                               CFT120
     C                     PARM INCDRC    @CURR                                               CFT120
     C           SDCURR    PARM SDCURR    DSSDY                                               CFT120
      *                                                                                       CFT120
     C           @RTCD     IFNE *BLANKS                                                       CFT120
     C                     MOVE 'SDCURRPD'WBFILE                                              CFT120
     C                     MOVELINCDRC    WBKEY                                               CFT120
     C                     Z-ADD63        WBASE                                               CFT120
     C                     EXSR ABORT                                                         CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
     C                     Z-ADDA6NBDP    SVICDP  10                                          CFT120
     C                     ENDIF                                                              CFT120
     C                     ENDIF                                                              CFT120
     C*                                                                   S01435
     C** FORMAT OTHER AMOUNTS & CURRENCIES                                S01435
     C** IF CHARGES TO DEBIT A/C FIELD IS NON-ZERO USE BASE CURRENCY;     S01435
     C** OTHERWISE IF PAY PLUS CHARGES INDICATOR IS 'Y' USE SETTLE CCY;   S01435
     C** OTHERWISE USE PAY CURRENCY                                       S01435
     C*                                                                   S01435
     C***********CDRO      IFNE *ZERO                                                  S01435 CSD027
     C           CDRO      IFNE *BLANKS                                                       CSD027
      *                                                                                       CFT120
     C                     MOVELBCCY      WCCY    3                       S01435
     C           INCDRC    IFNE *BLANKS                                                       CFT120
     C           CFT120    ANDEQ'Y'                                                           CFT120
     C                     MOVE INCDRC    WCCY                                                CFT120
     C                     Z-ADDSVICDP    WDEC                                                CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
     C                     Z-ADDSVBCDP    WDEC                            S01435
     C/COPY WNCPYSRC,FT1000C006
     C                     ELSE                                           S01435
     C           ADDC      IFEQ 'A'                                       S01435
     C                     MOVELSMCY      WCCY                            S01435
     C                     Z-ADDSVSCDP    WDEC                            S01435
     C                     ELSE                                           S01435
     C                     MOVELPCCY      WCCY                            S01435
     C                     Z-ADDSVPCDP    WDEC                            S01435
     C                     END                                            S01435
     C                     END                                            S01435
     C*                                                                   S01435
     C           11        SUB  WDEC      WDIG                            S01435
      *                                                                   CFT009
      ** Only process these charges if core switchable feature is off     CFT009
      *                                                                   CFT009
     C           CFT009    IFNE 'Y'                                       CFT009
      *                                                                   CFT009
     C*                                                                   S01435
     C** SETUP CURRENCY NAMES                                             S01435
     C*                                                                   S01435
     C                     MOVELWCCY      P4TRCY                          S01435
     C                     MOVELWCCY      P4TXCY                          S01435
     C                     MOVELWCCY      P4CQCY                          S01435
     C                     MOVELWCCY      P4TLCY                          S01435
     C                     MOVELWCCY      P4ADCY                          S01435
     C                     MOVELWCCY      P4MSCY                          S01435
     C*                                                                   S01494
     C** Check if SAR S01494 is set on                                    S01494
     C*                                                                   S01494
     C           *IN28     IFEQ '1'                                       S01494
     C                     MOVELWCCY      P4CHCY                          S01494
     C                     END                                            S01494
     C*                                                                   S01499
     C** Check if SAR S01499 is set on                                    S01499
     C*                                                                   S01499
     C           *IN29     IFEQ '1'                                       S01499
     C*                                                                   S01499
     C                     MOVELWCCY      P4VTCY                          S01499
     C*                                                                   S01499
     C** Set up VAT flags for report                                      S01499
     C*                                                                   S01499
     C                     MOVE INVAT1    P4TRVF                          S01499
     C                     MOVE INVAT2    P4TXVF                          S01499
     C                     MOVE INVAT3    P4CQVF                          S01499
     C                     MOVE INVAT4    P4ADVF                          S01499
     C                     MOVE INVAT5    P4TLVF                          S01499
     C                     MOVE INVAT6    P4MSVF                          S01499
     C           *IN28     IFEQ '1'                                       S01499
     C                     MOVE INVAT7    P4CHVF                          S01499
     C                     END                                            S01499
     C*                                                                   S01499
     C                     END                                            S01499
     C*                                                                   S01435
     C** FORMAT TRANSFER COMMISSION AMOUNT                                S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE TRCM      WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P4TRCM                          S01435
     C*                                                                   S01435
     C** FORMAT TELEX CHARGE AMOUNT                                       S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE TXCH      WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P4TXCH                          S01435
     C*                                                                   S01435
     C** FORMAT CHEQUE CHARGE AMOUNT                                      S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE CQCH      WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P4CQCH                          S01435
     C*                                                                   S01435
     C** FORMAT TELEPHONE CHARGE AMOUNT                                   S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE TLCH      WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P4TLCH                          S01435
     C*                                                                   S01435
     C** FORMAT ADVICE CHARGE AMOUNT                                      S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE ADCH      WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P4ADCH                          S01435
     C*                                                                   S01435
     C** FORMAT MISCELLANEOUS CHARGE AMOUNT                               S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE MSCH      WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P4MSCH                          S01435
     C*                                                                   S01494
     C** Check if SAR S01494 is set on                                    S01494
     C*                                                                   S01494
     C           *IN28     IFEQ '1'                                       S01494
     C*                                                                   S01494
     C** Format FX/Change Commission                                      S01494
     C*                                                                   S01494
     C                     MOVEL*BLANKS   WFDIN                           S01494
     C                     MOVE INCHCM    WFDIN                           S01494
     C                     EXSR UGFRMT                                    S01494
     C                     MOVE WFDOUT    P4CHCM                          S01494
     C*                                                                   S01494
     C                     END                                            S01494
     C*                                                                   S01499
     C** Check if SAR S01499 is set on                                    S01499
     C*                                                                   S01499
     C           *IN29     IFEQ '1'                                       S01499
     C*                                                                   S01499
     C** Format V.A.T. Charge                                             S01499
     C*                                                                   S01499
     C                     MOVEL*BLANKS   WFDIN                           S01499
     C                     MOVE INVATT    WFDIN                           S01499
     C                     EXSR UGFRMT                                    S01499
     C                     MOVE WFDOUT    P4VATT                          S01499
     C                     END                                            S01499
      *                                                                   CFT009
      ** Calculate and format new and existing charges                    CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     EXSR CALCG4                                    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C*                                                                   S01435
     C** FORMAT DATE FIELDS USING SYSTEM ROUTINE ZDATE2                   S01435
     C*                                                                   S01435
     C** SETTLE VALUE DATE                                                S01435
     C*                                                                   S01435
     C                     Z-ADDSLDT      ZDAYNO                          S01435
     C                     EXSR ZDATE2                                    S01435
     C                     MOVELZADATE    P4SLDT                          S01435
     C*                                                                   S01435
     C** PAY VALUE DATE                                                   S01435
     C*                                                                   S01435
     C                     Z-ADDPVDT      ZDAYNO                          S01435
     C                     EXSR ZDATE2                                    S01435
     C                     MOVELZADATE    P4PYDT                          S01435
     C*                                                                   S01435
     C** SET UP USER FIELDS FROM MUSERDD,IF AUDIT REPORT                  S01435
     C*                                                                   S01435
     C                     SETOF                     50                   S01435
     C*                                                                   S01435
     C           INUSR1    IFNE *BLANKS                                   S01435
     C                     MOVE INUSR1    USRP                            S01435
     C                     EXSR UCMUSE                                    S01435
     C                     MOVE USER1     SIUSR1 25                       S01435
     C*                                                                   S01435
     C                     ELSE                                           S01435
     C*                                                                   S01435
     C** CLEAR OUTPUT FIELD                                               S01435
     C                     MOVE *BLANKS   SIUSR1                          S01435
     C*                                                                   S01435
     C                     END                                            S01435
      *                                                                   S01435
     C           INUSR2    IFNE *BLANKS                                   S01435
     C                     MOVE INUSR2    USRP                            S01435
     C                     EXSR UCMUSE                                    S01435
     C                     MOVE USER1     SIUSR2 25                       S01435
     C*                                                                   S01435
     C                     ELSE                                           S01435
     C*                                                                   S01435
     C** CLEAR OUTPUT FIELD                                               S01435
     C                     MOVE *BLANKS   SIUSR2                          S01435
     C*                                                                   S01435
     C                     END                                            S01435
      *                                                                   S01435
     C           AUP1      IFNE *BLANKS                                   S01435
     C                     MOVE AUP1      USRP                            S01435
     C                     EXSR UCMUSE                                    S01435
     C                     MOVE USER1     SAUP1  25                       S01435
     C*                                                                   S01435
     C                     ELSE                                           S01435
     C*                                                                   S01435
     C** CLEAR OUTPUT FIELD                                               S01435
     C                     MOVE *BLANKS   SAUP1                           S01435
     C*                                                                   S01435
     C                     END                                            S01435
      *                                                                   S01435
     C           AUP2      IFNE *BLANKS                                   S01435
     C                     MOVE AUP2      USRP                            S01435
     C                     EXSR UCMUSE                                    S01435
     C                     MOVE USER1     SAUP2  25                       S01435
     C*                                                                   S01435
     C                     ELSE                                           S01435
     C*                                                                   S01435
     C** CLEAR OUTPUT FIELD                                               S01435
     C                     MOVE *BLANKS   SAUP2                           S01435
     C*                                                                   S01435
     C                     END                                            S01435
     C*                                                                   S01435
     C** SETUP REMAINING REPORT FIELDS                                    S01435
     C*                                                                   S01435
      *                                                                   CFT009
      ** Chain to payment charge defintion file to get miscellaneous      CFT009
      ** charge code narratives.                                          CFT009
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
     C           MSCH1     CHAINFTPCHGL0             90                   CFT009
     C           *IN90     IFEQ '0'                                       CFT009
     C                     MOVELCHDESC    P4M1DC    P                     CFT009
     C                     ELSE                                           CFT009
     C                     MOVELDESC,1    P4M1DC    P                     CFT009
     C                     ENDIF                                          CFT009
     C           MSCH2     CHAINFTPCHGL0             90                   CFT009
     C           *IN90     IFEQ '0'                                       CFT009
     C                     MOVELCHDESC    P4M2DC    P                     CFT009
     C                     ELSE                                           CFT009
     C                     MOVELDESC,2    P4M2DC    P                     CFT009
     C                     ENDIF                                          CFT009
     C           MSCH3     CHAINFTPCHGL0             90                   CFT009
     C           *IN90     IFEQ '0'                                       CFT009
     C                     MOVELCHDESC    P4M3DC    P                     CFT009
     C                     ELSE                                           CFT009
     C                     MOVELDESC,3    P4M3DC    P                     CFT009
     C                     ENDIF                                          CFT009
     C           MSCH4     CHAINFTPCHGL0             90                   CFT009
     C           *IN90     IFEQ '0'                                       CFT009
     C                     MOVELCHDESC    P4M4DC    P                     CFT009
     C                     ELSE                                           CFT009
     C                     MOVELDESC,4    P4M4DC    P                     CFT009
     C                     ENDIF                                          CFT009
     C           MSCH5     CHAINFTPCHGL0             90                   CFT009
     C           *IN90     IFEQ '0'                                       CFT009
     C                     MOVELCHDESC    P4M5DC    P                     CFT009
     C                     ELSE                                           CFT009
     C                     MOVELDESC,5    P4M5DC    P                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVELPREF      P4PREF                          S01435
     C                     MOVELRLPR      P4RLPR                          S01435
     C                     MOVELPYTP      P4PYTP                          S01435
     C                     MOVELPYST      P4PYST                          S01435
     C                     MOVELSMCY      P4SMCY                          S01435
     C                     Z-ADDRATE      P4RATE                          S01435
     C                     MOVELPCCY      P4PCCY                          S01435
     C                     MOVELBBI1      P4BBI1                          S01435
     C                     MOVELBBI2      P4BBI2                          S01435
     C                     MOVELBBI3      P4BBI3                          S01435
     C                     MOVELBBI4      P4BBI4                          S01435
     C                     MOVELBBI5      P4BBI5                          S01435
     C                     MOVELBBI6      P4BBI6                          S01435
     C                     MOVELDTP1      P4DTP1                          S01435
     C                     MOVELDTP2      P4DTP2                          S01435
     C                     MOVELDTP3      P4DTP3                          S01435
     C                     MOVELDTP4      P4DTP4                          S01435
     C/COPY WNCPYSRC,FT1000C019
     C           DNBC      IFEQ *ZERO                                     S01435
     C/COPY WNCPYSRC,FT1000C020
     C                     MOVE *BLANKS   P4DNBC                          S01435
     C                     ELSE                                           S01435
     C                     MOVELDNBC      P4DNBC                          S01435
     C                     END                                            S01435
     C                     MOVELADDC      P4ADDC                          S01435
     C                     MOVELDTCH      P4DTCH                          S01435
     C                     MOVELTRCT      P4TRCT                          S01435
     C           SWPC      IFEQ 1                          B001           S01435
     C                     MOVE 'U'       P4SWPC                          S01435
     C                     ELSE                            X001           S01435
     C           SWPC      IFEQ 2                          B002           S01435
     C                     MOVE 'N'       P4SWPC                          S01435
     C                     END                             E002           S01435
     C                     END                             E001           S01435
      *                                                                   S01435
      * Format Override indicator                                         S01435
      *                                                                   S01435
     C                     MOVE *BLANKS   P4OVRD                          S01435
     C           OVRD      IFEQ 'Y'                                       S01435
     C                     MOVE 'YES'     P4OVRD                          S01435
     C                     ELSE                                           S01435
     C                     MOVE 'NO '     P4OVRD                          S01435
     C                     END                                            S01435
      *                                                                   S01435
      * Format Entered Currency                                           S01435
      *                                                                   S01435
     C                     SELEC                                          S01435
      *                                                                   S01435
     C***********CDRO      WHNE *ZERO                                                  S01435 CSD027
     C           CDRO      WHNE *BLANKS                                                       CSD027
     C           BTCHCY    OREQ 'B'                                       103513
     C           CFT120    ANDNE'Y'                                                           CFT120
      *                                                                                       CFT120
     C                     MOVELBCCY      WCCY                            S01435
     C                     Z-ADDSVBCDP    WDEC                            S01435
     C           INCDRC    IFNE *BLANKS                                                       CFT120
     C           CFT120    ANDEQ'Y'                                                           CFT120
     C                     MOVELINCDRC    WCCY                                                CFT120
     C                     Z-ADDSVICDP    WDEC                                                CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
     C/COPY WNCPYSRC,FT1000C007
      *                                                                   S01435
      *                                                                   S01435
      *  If Batch Authorsation update/add record                          CFT003
      *                                                                   CFT003
     C                     Z-ADD0         P4OEXR                          CFT014
     C                     MOVE *BLANKS   P4TRIB                          CFT014
     C                     MOVE *BLANKS   P4BOCD                          CFT014
     C                     MOVE *BLANKS   P4TTCD                          CFT014
     C                     MOVE *BLANKS   P4ICD1                          CFT014
     C                     MOVE *BLANKS   P4ICD2                          CFT014
     C                     MOVE *BLANKS   P4ICD3                          CFT014
     C                     MOVE *BLANKS   P4ICD4                          CFT014
     C                     MOVE *BLANKS   P4ICD5                          CFT014
     C                     MOVE *BLANKS   P4RRP1                          CFT014
     C                     MOVE *BLANKS   P4RRP2                          CFT014
     C                     MOVE *BLANKS   P4RRP3                          CFT014
     C                     MOVE *BLANKS   P4RCRM                          CFT014
     C                     MOVE *BLANKS   P4SCH1                          CFT014
     C                     MOVE *BLANKS   P4SCH2                          CFT014
     C                     MOVE *BLANKS   P4SCH3                          CFT014
     C                     MOVE *BLANKS   P4SCH4                          CFT014
     C                     MOVE *BLANKS   P4SCH5                          CFT014
      *                                                                   CFT014
     C           CFT003    IFEQ 'CFT003'                                  CFT003
     C           CFT014    OREQ 'Y'                                       CFT014
     C           CFT009    OREQ 'Y'                                       192300
      *                                                                   CFT003
     C           PREF      CHAININPAYXL0             79                   CFT003
      *                                                                   CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
      *                                                                   CFT014
     C           *IN79     IFEQ *ON                                       CFT014
     C                     Z-ADD22        WBASE            ************   CFT014
     C                     MOVELPREF      WBKEY            * DBERR022 *   CFT014
     C                     MOVEL'INPAYXL0'WBFILE           ************   CFT014
     C                     EXSR ABORT                                     CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     CALL 'AOCURRR0'                                CFT014
     C                     PARM *BLANKS   WRTCD                           CFT014
     C                     PARM '*KEY   ' WOPTN                           CFT014
     C                     PARM PCCY      WCCY                            CFT014
     C           SDCURR    PARM SDCURR    DSSDY                           CFT014
     C           WRTCD     IFNE *BLANKS                                   CFT014
     C                     Z-ADD23        WBASE            ************   CFT014
     C                     MOVELPCCY      WBKEY            * DBERR023 *   CFT014
     C                     MOVEL'SDCURRPD'WBFILE           ************   CFT014
     C                     EXSR ABORT                                     CFT014
     C                     ENDIF                                          CFT014
     C                     Z-ADDA6NBDP    WPYNDP  20                      CFT014
      *                                                                   CFT014
     C                     Z-ADDINOEXR    P4OEXR                          CFT014
     C                     MOVELINTRIB    P4TRIB                          CFT014
     C                     MOVELINBOCD    P4BOCD                          CFT014
     C                     MOVELINTTCD    P4TTCD                          CFT014
      ** Instruction code                                                 CFT014
     C                     MOVELINICD1    P4ICD1                          CFT014
     C                     MOVELINICD2    P4ICD2                          CFT014
     C                     MOVELINICD3    P4ICD3                          CFT014
     C                     MOVELINICD4    P4ICD4                          CFT014
     C                     MOVELINICD5    P4ICD5                          CFT014
      ** Regulatory reporting                                             CFT014
     C                     MOVELINRRP1    P4RRP1                          CFT014
     C                     MOVELINRRP2    P4RRP2                          CFT014
     C                     MOVELINRRP3    P4RRP3                          CFT014
      ** Receiver's charges                                               CFT014
     C           INRCRM    IFNE 0                                         CFT014
      *                                                                   CFT014
     C                     CALL 'AOCURRR0'                                CFT014
     C                     PARM '*DBERR ' @RTCD   7                       CFT014
     C                     PARM '*KEY   ' @OPTN   7                       CFT014
     C                     PARM SMCY      @CCY    3                       CFT014
     C           SDCURR    PARM SDCURR    DSSDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C                     MOVEL'SDCURRPD'WBFILE                          CFT014
     C                     MOVEL'*VERIFY' WBKEY                           CFT014
     C                     Z-ADD70        WBASE                           CFT014
     C                     EXSR ABORT                                     CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C                     MOVE A6NBDP    WSNBDP  10                      CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     Z-ADDWSNBDP    WDEC    10                      CFT014
     C           11        SUB  WDEC      WDIG    20                      CFT014
     C                     MOVEL*BLANKS   WFDIN                           CFT014
     C                     MOVE INRCRM    WFDIN                           CFT014
     C                     EXSR UGFRMT                                    CFT014
     C                     MOVE *BLANKS   WCHR15 15                       CFT014
     C                     MOVE WFDOUT    WCHR15                          CFT014
     C                     MOVELWCHR15    P4RCRM                          CFT014
     C                     MOVE SMCY      P4RCRM                          CFT014
     C                     ENDIF                                          CFT014
      ** Sender's charges                                                 CFT014
     C           INSCY1    IFNE *BLANKS                                   CFT014
      *                                                                   CFT014
     C                     CALL 'AOCURRR0'                                CFT014
     C                     PARM '*DBERR ' @RTCD   7                       CFT014
     C                     PARM '*KEY   ' @OPTN   7                       CFT014
     C                     PARM INSCY1    @CCY    3                       CFT014
     C           SDCURR    PARM SDCURR    DSSDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C                     MOVEL'SDCURRPD'WBFILE                          CFT014
     C                     MOVEL'*VERIFY' WBKEY                           CFT014
     C                     Z-ADD72        WBASE                           CFT014
     C                     EXSR ABORT                                     CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C                     MOVE A6NBDP    WNBDP1  10                      CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     Z-ADDWNBDP1    WDEC                            CFT014
     C           11        SUB  WDEC      WDIG                            CFT014
     C                     MOVEL*BLANKS   WFDIN                           CFT014
     C                     MOVE INSCH1    WFDIN                           CFT014
     C                     EXSR UGFRMT                                    CFT014
     C                     MOVE *BLANKS   WCHR15                          CFT014
     C                     MOVE WFDOUT    WCHR15                          CFT014
     C                     MOVELWCHR15    P4SCH1                          CFT014
     C                     MOVE INSCY1    P4SCH1                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           INSCY2    IFNE *BLANKS                                   CFT014
      *                                                                   CFT014
     C                     CALL 'AOCURRR0'                                CFT014
     C                     PARM '*DBERR ' @RTCD   7                       CFT014
     C                     PARM '*KEY   ' @OPTN   7                       CFT014
     C                     PARM INSCY2    @CCY    3                       CFT014
     C           SDCURR    PARM SDCURR    DSSDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C                     MOVEL'SDCURRPD'WBFILE                          CFT014
     C                     MOVEL'*VERIFY' WBKEY                           CFT014
     C                     Z-ADD73        WBASE                           CFT014
     C                     EXSR ABORT                                     CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C                     MOVE A6NBDP    WNBDP2  10                      CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     Z-ADDWNBDP2    WDEC                            CFT014
     C           11        SUB  WDEC      WDIG                            CFT014
     C                     MOVEL*BLANKS   WFDIN                           CFT014
     C                     MOVE INSCH2    WFDIN                           CFT014
     C                     EXSR UGFRMT                                    CFT014
     C                     MOVE *BLANKS   WCHR15                          CFT014
     C                     MOVE WFDOUT    WCHR15                          CFT014
     C                     MOVELWCHR15    P4SCH2                          CFT014
     C                     MOVE INSCY2    P4SCH2                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           INSCY3    IFNE *BLANKS                                   CFT014
      *                                                                   CFT014
     C                     CALL 'AOCURRR0'                                CFT014
     C                     PARM '*DBERR ' @RTCD   7                       CFT014
     C                     PARM '*KEY   ' @OPTN   7                       CFT014
     C                     PARM INSCY3    @CCY    3                       CFT014
     C           SDCURR    PARM SDCURR    DSSDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C                     MOVEL'SDCURRPD'WBFILE                          CFT014
     C                     MOVEL'*VERIFY' WBKEY                           CFT014
     C                     MOVEL'74'      WBASE                           CFT014
     C                     EXSR ABORT                                     CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C                     MOVE A6NBDP    WNBDP3  10                      CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     Z-ADDWNBDP3    WDEC                            CFT014
     C           11        SUB  WDEC      WDIG                            CFT014
     C                     MOVEL*BLANKS   WFDIN                           CFT014
     C                     MOVE INSCH3    WFDIN                           CFT014
     C                     EXSR UGFRMT                                    CFT014
     C                     MOVE *BLANKS   WCHR15                          CFT014
     C                     MOVE WFDOUT    WCHR15                          CFT014
     C                     MOVELWCHR15    P4SCH3                          CFT014
     C                     MOVE INSCY3    P4SCH3                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           INSCY4    IFNE *BLANKS                                   CFT014
      *                                                                   CFT014
     C                     CALL 'AOCURRR0'                                CFT014
     C                     PARM '*DBERR ' @RTCD   7                       CFT014
     C                     PARM '*KEY   ' @OPTN   7                       CFT014
     C                     PARM INSCY4    @CCY    3                       CFT014
     C           SDCURR    PARM SDCURR    DSSDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C                     MOVEL'SDCURRPD'WBFILE                          CFT014
     C                     MOVEL'*VERIFY' WBKEY                           CFT014
     C                     Z-ADD75        WBASE                           CFT014
     C                     EXSR ABORT                                     CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C                     MOVE A6NBDP    WNBDP4  10                      CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     Z-ADDWNBDP4    WDEC                            CFT014
     C           11        SUB  WDEC      WDIG                            CFT014
     C                     MOVEL*BLANKS   WFDIN                           CFT014
     C                     MOVE INSCH4    WFDIN                           CFT014
     C                     EXSR UGFRMT                                    CFT014
     C                     MOVE *BLANKS   WCHR15                          CFT014
     C                     MOVE WFDOUT    WCHR15                          CFT014
     C                     MOVELWCHR15    P4SCH4                          CFT014
     C                     MOVE INSCY4    P4SCH4                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           INSCY5    IFNE *BLANKS                                   CFT014
      *                                                                   CFT014
     C                     CALL 'AOCURRR0'                                CFT014
     C                     PARM '*DBERR ' @RTCD   7                       CFT014
     C                     PARM '*KEY   ' @OPTN   7                       CFT014
     C                     PARM INSCY5    @CCY    3                       CFT014
     C           SDCURR    PARM SDCURR    DSSDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C                     MOVEL'SDCURRPD'WBFILE                          CFT014
     C                     MOVEL'*VERIFY' WBKEY                           CFT014
     C                     Z-ADD75        WBASE                           CFT014
     C                     EXSR ABORT                                     CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C                     MOVE A6NBDP    WNBDP5  10                      CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     Z-ADDWNBDP5    WDEC                            CFT014
     C           11        SUB  WDEC      WDIG                            CFT014
     C                     MOVEL*BLANKS   WFDIN                           CFT014
     C                     MOVE INSCH5    WFDIN                           CFT014
     C                     EXSR UGFRMT                                    CFT014
     C                     MOVE *BLANKS   WCHR15                          CFT014
     C                     MOVE WFDOUT    WCHR15                          CFT014
     C                     MOVELWCHR15    P4SCH5                          CFT014
     C                     MOVE INSCY5    P4SCH5                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT003
      ** If found, delete INPAYXL0                                        CFT003
      *                                                                   CFT003
     C           *IN79     IFEQ '0'                                       CFT003
     C                     DELETINPAYXDF                                  CFT003
     C                     ENDIF                           -*IN79         CFT003
      *                                                                   CFT003
     C                     ENDIF                                          CFT003
      *                                                                                       CFT120
     C           BTCHCY    WHEQ 'B'                                                           CFT120
     C           CFT120    ANDEQ'Y'                                                           CFT120
     C                     MOVELBCCY      WCCY                                                CFT120
     C                     Z-ADDSVBCDP    WDEC                                                CFT120
     C                     EXSR SRBASP                                                        CFT120
      *                                                                                       CFT120
     C           BTCHCY    WHEQ 'L'                                       S01435
     C                     MOVELLOCY      WCCY                            S01435
     C                     Z-ADDSVLCDP    WDEC                            S01435
      *                                                                   S01435
     C           BTCHCY    WHEQ 'C'                                       S01435
     C           ADDC      ANDEQ'A'                                       S01435
     C                     MOVELSMCY      WCCY                            S01435
     C                     Z-ADDSVSCDP    WDEC                            S01435
      *                                                                   S01435
     C                     OTHER                                          S01435
     C                     MOVELPCCY      WCCY                            S01435
     C                     Z-ADDSVPCDP    WDEC                            S01435
     C                     ENDSL                                          S01435
      *                                                                   S01435
      ** Only calculate entered charges if switchable feature CFT009      CFT009
      ** is off                                                           CFT009
      *                                                                   CFT009
     C           CFT009    IFNE 'Y'                                       CFT009
     C                     MOVELWCCY      P4TREC                          S01435
     C                     MOVELWCCY      P4TXEC                          S01435
     C                     MOVELWCCY      P4CQEC                          S01435
     C                     MOVELWCCY      P4TLEC                          S01435
     C                     MOVELWCCY      P4ADEC                          S01435
     C                     MOVELWCCY      P4MSEC                          S01435
     C*                                                                   S01494
     C** Check if SAR S01494 is set on                                    S01494
     C*                                                                   S01494
     C           *IN28     IFEQ '1'                                       S01494
     C                     MOVELWCCY      P4CHEC                          S01494
     C                     END                                            S01494
     C*                                                                   S01499
     C** Check if SAR S01499 is set on                                    S01499
     C*                                                                   S01499
     C           *IN29     IFEQ '1'                                       S01499
     C                     MOVELWCCY      P4VTEC                          S01499
     C                     END                                            S01499
      *                                                                   S01435
      *  Format Entered Amounts                                           S01435
      *                                                                   S01435
     C           11        SUB  WDEC      WDIG                            S01435
      *                                                                   S01435
      ** Format Transfer Commission Amount                                S01435
      *                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE DUMA1     WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P4TREA                          S01435
      *                                                                   S01435
      ** Format Telex Charge Amount                                       S01435
      *                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE DUMA2     WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P4TXEA                          S01435
      *                                                                   S01435
      ** Format Cheque Charge Amount                                      S01435
      *                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE DUMA3     WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P4CQEA                          S01435
     C*                                                                   S01435
     C** Format Telephone Charge Amount                                   S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE DUMA4     WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P4TLEA                          S01435
     C*                                                                   S01435
     C** Format Advice Charge Amount                                      S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE DUMA5     WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P4ADEA                          S01435
     C*                                                                   S01435
     C** Format Miscellaneous Charge Amount                               S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE DUMA6     WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P4MSEA                          S01435
     C*                                                                   S01494
     C** Check if SAR S01494 is set on                                    S01494
     C*                                                                   S01494
     C           *IN28     IFEQ '1'                                       S01494
     C*                                                                   S01494
     C** Format FX/Change Commission                                      S01494
     C*                                                                   S01494
     C                     MOVEL*BLANKS   WFDIN                           S01494
     C                     MOVE INDUM7    WFDIN                           S01494
     C                     EXSR UGFRMT                                    S01494
     C                     MOVE WFDOUT    P4CHEA                          S01494
     C*                                                                   S01494
     C                     END                                            S01494
     C*                                                                   S01499
     C** Check if SAR S01499 is set on                                    S01499
     C*                                                                   S01499
     C           *IN29     IFEQ '1'                                       S01499
     C*                                                                   S01499
     C** Format V.A.T. Charge                                             S01499
     C*                                                                   S01499
     C                     MOVEL*BLANKS   WFDIN                           S01499
     C                     MOVE INDUM8    WFDIN                           S01499
     C                     EXSR UGFRMT                                    S01499
     C                     MOVE WFDOUT    P4VAEA                          S01499
     C*                                                                   S01499
     C                     END                                            S01499
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
     C*                                                                   S01435
     C** OUPUT OUTGOING PAYMENT TO BE GENERATED IF 'Y'                    S01435
     C*                                                                   S01435
     C                     MOVE *BLANKS   P4OPIN                          S01435
     C           OPIN      IFEQ 'Y'                                       S01435
     C                     MOVEL'YES'     P4OPIN                          S01435
     C                     ELSE                                           S01435
     C                     MOVEL'NO '     P4OPIN                          S01435
     C                     END                                            S01435
     C*                                                                   S01435
     C** EDIT  CDRO  FOR OUTPUT                                           S01435
     C*                                                                   S01435
     C                     MOVE CDRT      PRMTYP  1        ( CDRO )       S01435
     C**********           MOVE *ZEROS    PRMFLD 12                                    S01435 CGL029
     C                     MOVE *ZEROS    PRMFLD 18                                           CGL029
     C                     MOVELCDRO      PRMFLD                          S01435
     C                     EXSR CHOPF                                     S01435
     C                     MOVELPRMFLD    P4CDRO                          S01435
     C                     MOVELCDBR      P4CDBR                          S01435
     C           CFT120    IFEQ 'Y'                                                           CFT120
     C                     MOVELINCDRC    P4CDRC                                              CFT120
     C                     ENDIF                                                              CFT120
     C/COPY WNCPYSRC,FT1000C008
      *                                                                                       CSW209
      **  Cover Message Information for Incoming Payments                                     CSW209
      *                                                                                       CSW209
     C           CSW209    IFEQ 'Y'                                                           CSW209
      *                                                                                       CSW209
     C                     MOVELINNWRK    P4NWRK                                              CSW209
     C                     MOVELINMTPY    P4MTPY                                              CSW209
     C                     MOVELINVALF    P4VALF                                              CSW209
     C                     MOVELINCOC1    P4COC1                                              CSW209
     C                     MOVELINCOC2    P4COC2                                              CSW209
     C                     MOVELINCOC3    P4COC3                                              CSW209
     C                     MOVELINCOC4    P4COC4                                              CSW209
     C                     MOVELINCOC5    P4COC5                                              CSW209
     C                     MOVELINCOB1    P4COB1                                              CSW209
     C                     MOVELINCOB2    P4COB2                                              CSW209
     C                     MOVELINCOB3    P4COB3                                              CSW209
     C                     MOVELINCOB4    P4COB4                                              CSW209
     C                     MOVELINCOB5    P4COB5                                              CSW209
     C                     MOVELINCIB1    P4CIB1                                              CSW209
     C                     MOVELINCIB2    P4CIB2                                              CSW209
     C                     MOVELINCIB3    P4CIB3                                              CSW209
     C                     MOVELINCIB4    P4CIB4                                              CSW209
     C                     MOVELINCIB5    P4CIB5                                              CSW209
     C                     MOVELINCAB1    P4CAB1                                              CSW209
     C                     MOVELINCAB2    P4CAB2                                              CSW209
     C                     MOVELINCAB3    P4CAB3                                              CSW209
     C                     MOVELINCAB4    P4CAB4                                              CSW209
     C                     MOVELINCAB5    P4CAB5                                              CSW209
     C                     MOVELINCBC1    P4CBC1                                              CSW209
     C                     MOVELINCBC2    P4CBC2                                              CSW209
     C                     MOVELINCBC3    P4CBC3                                              CSW209
     C                     MOVELINCBC4    P4CBC4                                              CSW209
     C                     MOVELINCBC5    P4CBC5                                              CSW209
     C                     MOVELINCICY    P4CICY                                              CSW209
     C                     MOVEL*BLANKS   P4CIAM                                              CSW209
      *                                                                                       CSW209
      ** Access AOCURR0 to get the currency's decimal places                                  CSW209
      *                                                                                       CSW209
     C           INCICY    IFNE *BLANKS                                                       CSW209
      *                                                                                       CSW209
     C                     CALL 'AOCURRR0'                                                    CSW209
     C                     PARM *BLANKS   WRTCD                                               CSW209
     C                     PARM '*KEY   ' WOPTN                                               CSW209
     C                     PARM           INCICY                                              CSW209
     C           SDCURR    PARM SDCURR    DSSDY                                               CSW209
     C           WRTCD     IFNE *BLANKS                                                       CSW209
     C                     Z-ADD31        WBASE                                               CSW209
     C                     MOVELINCICY    WBKEY                                               CSW209
     C                     MOVEL'SDCURRPD'WBFILE                                              CSW209
     C                     EXSR ABORT                                                         CSW209
     C                     ENDIF                                                              CSW209
     C                     Z-ADDA6NBDP    W4CIAM  10                                          CSW209
      *                                                                                       CSW209
      ** Format Instructed Currency Amount                                                    CSW209
      *                                                                                       CSW209
     C                     MOVEL*BLANKS   WFDIN                                               CSW209
     C                     MOVE INCIAM    WFDIN                                               CSW209
     C                     Z-ADDW4CIAM    WDEC                                                CSW209
     C           13        SUB  W4CIAM    WDIG                                                CSW209
     C                     EXSR UGFRMT                                                        CSW209
     C                     MOVE WFDOUT    P4CIAM                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     MOVELINCBB1    P4CBB1                                              CSW209
     C                     MOVELINCBB2    P4CBB2                                              CSW209
     C                     MOVELINCBB3    P4CBB3                                              CSW209
     C                     MOVELINCBB4    P4CBB4                                              CSW209
     C                     MOVELINCBB5    P4CBB5                                              CSW209
     C                     MOVELINCBB6    P4CBB6                                              CSW209
     C                     MOVELINCDP1    P4CDP1                                              CSW209
     C                     MOVELINCDP2    P4CDP2                                              CSW209
     C                     MOVELINCDP3    P4CDP3                                              CSW209
     C                     MOVELINCDP4    P4CDP4                                              CSW209
     C                     ENDIF                                                              CSW209
     C*
     C** OUTPUT PAGE TO REPORT
     C*
     C                     ADD  1         P4PAGE
     C                     WRITEP4HD
     C                     WRITEP4DETL
      *                                                                   CFT009
      ** Write new record format, for charges if core switchable featur   CFT009
      ** is on.                                                           CFT009
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
     C                     ADD  1         P4PAGE                          CFT009
     C                     WRITEP4CHGS                                    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           CSW209    IFEQ 'Y'                                                           CSW209
     C           CFT009    IFEQ 'Y'                                                         AR655670
     C                     MOVE '1'       *IN78                                             AR655670
     C                     ELSE                                                             AR655670
     C                     MOVE '0'       *IN78                                             AR655670
     C                     ADD  1         P4PAGE                                            AR655670
     C                     ENDIF                                                            AR655670
     C                     WRITEP4NTWK                                                        CSW209
     C           INVALF    IFEQ 'COV'                                                         CSW209
     C           P4CORC    IFNE *BLANKS                                                       CSW209
     C           P4COBC    ORNE *BLANKS                                                       CSW209
     C           P4CIBC    ORNE *BLANKS                                                       CSW209
     C           P4CABC    ORNE *BLANKS                                                       CSW209
     C           P4CBCC    ORNE *BLANKS                                                       CSW209
     C           P4CBBC    ORNE *BLANKS                                                       CSW209
     C           P4CDPC    ORNE *BLANKS                                                       CSW209
     C           P4CICY    ORNE *BLANKS                                                       CSW209
     C           P4CIAM    ORNE *BLANKS                                                       CSW209
     C                     ADD  1         P4PAGE                                              CSW209
     C                     WRITEP4COVM                                                        CSW209
     C                     ENDIF                                                              CSW209
     C                     ENDIF                                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
      *                                                                                       CER030
      ** Write Transaction Type                                                               CER030
      *                                                                                       CER030
     C           CFT009    IFNE 'Y'                                                           CER030
      *                                                                                       CER030
     C           OFLOW4    SUB  PLINE4    WREM1   20                                          CER030
      *                                                                                       CER030
     C           CER031    IFNE 'Y'                                                           CER030
      *                                                                                       CER030
     C           WREM1     IFLE 2                                                             CER030
     C                     MOVE *ON       *IN16                                               CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ELSE                                                               CER030
      *                                                                                       CER030
     C           WREM1     IFLE 8                                                             CER030
     C                     MOVE *ON       *IN16                                               CER030
     C                     ENDIF                                                              CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           CER030    IFEQ 'Y'                                                           CER030
     C           CGL013    OREQ 'Y'                                                           CER030
     C                     MOVE *ON       *IN31                                               CER030
     C                     MOVE IRTTY     P4RTTY                                              CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      ** Write Extended Narrative Credit                                                      CER030
      *                                                                                       CER030
     C           CER031    IFEQ 'Y'                                                           CER030
     C                     MOVE *ON       *IN32                                               CER030
      *                                                                                       CER030
     C                     MOVE IEXT1     P4EXN1                                              CER030
     C                     MOVE IEXT2     P4EXN2                                              CER030
     C                     MOVE IEXT3     P4EXN3                                              CER030
     C                     MOVE IEXT4     P4EXN4                                              CER030
     C                     MOVE IEXT5     P4EXN5                                              CER030
     C                     MOVE IEXT6     P4EXN6                                              CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           CGL013    IFEQ 'Y'                                                           CER030
     C           CER030    OREQ 'Y'                                                           CER030
     C           CER031    OREQ 'Y'                                                           CER030
     C                     WRITEP4TRTN                                                        CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           CER031    IFEQ 'Y'                                                           CER030
     C                     WRITEP4EXNC                                                        CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     MOVE '0'       *IN16                                               CER030
      *                                                                                       CER030
     C                     SETON                     84
     C*
     C                     ENDSR
     C*
      *****************************************************************                       CFT120
     C/EJECT                                                                                  CFT120
      *****************************************************************                       CFT120
      *                                                               *                       CFT120
      * SRBASP - SUBROUTINE for Base Currency processing              *                       CFT120
      *          for charges  (chunk of code copied from original     *                       CFT120
      *          select statement for CDRO ne blanks or charge ccy B) *                       CFT120
      *                                                               *                       CFT120
      *****************************************************************                       CFT120
      *                                                                                       CFT120
     C           SRBASP    BEGSR                                                              CFT120
      *                                                                                       CFT120
      ** If Batch Authorsation update/add record                                              CFT120
      *                                                                                       CFT120
     C                     Z-ADD0         P4OEXR                                              CFT120
     C                     MOVE *BLANKS   P4TRIB                                              CFT120
     C                     MOVE *BLANKS   P4BOCD                                              CFT120
     C                     MOVE *BLANKS   P4TTCD                                              CFT120
     C                     MOVE *BLANKS   P4ICD1                                              CFT120
     C                     MOVE *BLANKS   P4ICD2                                              CFT120
     C                     MOVE *BLANKS   P4ICD3                                              CFT120
     C                     MOVE *BLANKS   P4ICD4                                              CFT120
     C                     MOVE *BLANKS   P4ICD5                                              CFT120
     C                     MOVE *BLANKS   P4RRP1                                              CFT120
     C                     MOVE *BLANKS   P4RRP2                                              CFT120
     C                     MOVE *BLANKS   P4RRP3                                              CFT120
     C                     MOVE *BLANKS   P4RCRM                                              CFT120
     C                     MOVE *BLANKS   P4SCH1                                              CFT120
     C                     MOVE *BLANKS   P4SCH2                                              CFT120
     C                     MOVE *BLANKS   P4SCH3                                              CFT120
     C                     MOVE *BLANKS   P4SCH4                                              CFT120
     C                     MOVE *BLANKS   P4SCH5                                              CFT120
      *                                                                                       CFT120
     C           CFT003    IFEQ 'CFT003'                                                      CFT120
     C           CFT014    OREQ 'Y'                                                           CFT120
     C           CFT009    OREQ 'Y'                                                           CFT120
      *                                                                                       CFT120
     C           PREF      CHAININPAYXL0             79                                       CFT120
      *                                                                                       CFT120
     C           CFT014    IFEQ 'Y'                                                           CFT120
      *                                                                                       CFT120
     C           *IN79     IFEQ *ON                                                           CFT120
     C                     Z-ADD22        WBASE                                               CFT120
     C                     MOVELPREF      WBKEY                                               CFT120
     C                     MOVEL'INPAYXL0'WBFILE                                              CFT120
     C                     EXSR ABORT                                                         CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
     C                     CALL 'AOCURRR0'                                                    CFT120
     C                     PARM *BLANKS   WRTCD                                               CFT120
     C                     PARM '*KEY   ' WOPTN                                               CFT120
     C                     PARM PCCY      WCCY                                                CFT120
     C           SDCURR    PARM SDCURR    DSSDY                                               CFT120
     C           WRTCD     IFNE *BLANKS                                                       CFT120
     C                     Z-ADD23        WBASE                                               CFT120
     C                     MOVELPCCY      WBKEY                                               CFT120
     C                     MOVEL'SDCURRPD'WBFILE                                              CFT120
     C                     EXSR ABORT                                                         CFT120
     C                     ENDIF                                                              CFT120
     C                     Z-ADDA6NBDP    WPYNDP  20                                          CFT120
      *                                                                                       CFT120
     C                     Z-ADDINOEXR    P4OEXR                                              CFT120
     C                     MOVELINTRIB    P4TRIB                                              CFT120
     C                     MOVELINBOCD    P4BOCD                                              CFT120
     C                     MOVELINTTCD    P4TTCD                                              CFT120
      *                                                                                       CFT120
      ** Instruction code                                                                     CFT120
     C                     MOVELINICD1    P4ICD1                                              CFT120
     C                     MOVELINICD2    P4ICD2                                              CFT120
     C                     MOVELINICD3    P4ICD3                                              CFT120
     C                     MOVELINICD4    P4ICD4                                              CFT120
     C                     MOVELINICD5    P4ICD5                                              CFT120
      *                                                                                       CFT120
      ** Regulatory reporting                                                                 CFT120
      *                                                                                       CFT120
     C                     MOVELINRRP1    P4RRP1                                              CFT120
     C                     MOVELINRRP2    P4RRP2                                              CFT120
     C                     MOVELINRRP3    P4RRP3                                              CFT120
      *                                                                                       CFT120
      ** Receiver's charges                                                                   CFT120
      *                                                                                       CFT120
     C           INRCRM    IFNE 0                                                             CFT120
      *                                                                                       CFT120
     C                     CALL 'AOCURRR0'                                                    CFT120
     C                     PARM '*DBERR ' @RTCD   7                                           CFT120
     C                     PARM '*KEY   ' @OPTN   7                                           CFT120
     C                     PARM SMCY      @CCY    3                                           CFT120
     C           SDCURR    PARM SDCURR    DSSDY                                               CFT120
      *                                                                                       CFT120
     C           @RTCD     IFNE *BLANKS                                                       CFT120
     C                     MOVEL'SDCURRPD'WBFILE                                              CFT120
     C                     MOVEL'*VERIFY' WBKEY                                               CFT120
     C                     Z-ADD70        WBASE                                               CFT120
     C                     EXSR ABORT                                                         CFT120
      *                                                                                       CFT120
     C                     ELSE                                                               CFT120
      *                                                                                       CFT120
     C                     MOVE A6NBDP    WSNBDP  10                                          CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
     C                     Z-ADDWSNBDP    WDEC    10                                          CFT120
     C           11        SUB  WDEC      WDIG    20                                          CFT120
     C                     MOVEL*BLANKS   WFDIN                                               CFT120
     C                     MOVE INRCRM    WFDIN                                               CFT120
     C                     EXSR UGFRMT                                                        CFT120
     C                     MOVE *BLANKS   WCHR15 15                                           CFT120
     C                     MOVE WFDOUT    WCHR15                                              CFT120
     C                     MOVELWCHR15    P4RCRM                                              CFT120
     C                     MOVE SMCY      P4RCRM                                              CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
      ** Sender's charges                                                                     CFT120
      *                                                                                       CFT120
     C           INSCY1    IFNE *BLANKS                                                       CFT120
      *                                                                                       CFT120
     C                     CALL 'AOCURRR0'                                                    CFT120
     C                     PARM '*DBERR ' @RTCD   7                                           CFT120
     C                     PARM '*KEY   ' @OPTN   7                                           CFT120
     C                     PARM INSCY1    @CCY    3                                           CFT120
     C           SDCURR    PARM SDCURR    DSSDY                                               CFT120
      *                                                                                       CFT120
     C           @RTCD     IFNE *BLANKS                                                       CFT120
     C                     MOVEL'SDCURRPD'WBFILE                                              CFT120
     C                     MOVEL'*VERIFY' WBKEY                                               CFT120
     C                     Z-ADD72        WBASE                                               CFT120
     C                     EXSR ABORT                                                         CFT120
      *                                                                                       CFT120
     C                     ELSE                                                               CFT120
      *                                                                                       CFT120
     C                     MOVE A6NBDP    WNBDP1  10                                          CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
     C                     Z-ADDWNBDP1    WDEC                                                CFT120
     C           11        SUB  WDEC      WDIG                                                CFT120
     C                     MOVEL*BLANKS   WFDIN                                               CFT120
     C                     MOVE INSCH1    WFDIN                                               CFT120
     C                     EXSR UGFRMT                                                        CFT120
     C                     MOVE *BLANKS   WCHR15                                              CFT120
     C                     MOVE WFDOUT    WCHR15                                              CFT120
     C                     MOVELWCHR15    P4SCH1                                              CFT120
     C                     MOVE INSCY1    P4SCH1                                              CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
     C           INSCY2    IFNE *BLANKS                                                       CFT120
      *                                                                                       CFT120
     C                     CALL 'AOCURRR0'                                                    CFT120
     C                     PARM '*DBERR ' @RTCD   7                                           CFT120
     C                     PARM '*KEY   ' @OPTN   7                                           CFT120
     C                     PARM INSCY2    @CCY    3                                           CFT120
     C           SDCURR    PARM SDCURR    DSSDY                                               CFT120
      *                                                                                       CFT120
     C           @RTCD     IFNE *BLANKS                                                       CFT120
     C                     MOVEL'SDCURRPD'WBFILE                                              CFT120
     C                     MOVEL'*VERIFY' WBKEY                                               CFT120
     C                     Z-ADD73        WBASE                                               CFT120
     C                     EXSR ABORT                                                         CFT120
      *                                                                                       CFT120
     C                     ELSE                                                               CFT120
      *                                                                                       CFT120
     C                     MOVE A6NBDP    WNBDP2  10                                          CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
     C                     Z-ADDWNBDP2    WDEC                                                CFT120
     C           11        SUB  WDEC      WDIG                                                CFT120
     C                     MOVEL*BLANKS   WFDIN                                               CFT120
     C                     MOVE INSCH2    WFDIN                                               CFT120
     C                     EXSR UGFRMT                                                        CFT120
     C                     MOVE *BLANKS   WCHR15                                              CFT120
     C                     MOVE WFDOUT    WCHR15                                              CFT120
     C                     MOVELWCHR15    P4SCH2                                              CFT120
     C                     MOVE INSCY2    P4SCH2                                              CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
     C           INSCY3    IFNE *BLANKS                                                       CFT120
      *                                                                                       CFT120
     C                     CALL 'AOCURRR0'                                                    CFT120
     C                     PARM '*DBERR ' @RTCD   7                                           CFT120
     C                     PARM '*KEY   ' @OPTN   7                                           CFT120
     C                     PARM INSCY3    @CCY    3                                           CFT120
     C           SDCURR    PARM SDCURR    DSSDY                                               CFT120
      *                                                                                       CFT120
     C           @RTCD     IFNE *BLANKS                                                       CFT120
     C                     MOVEL'SDCURRPD'WBFILE                                              CFT120
     C                     MOVEL'*VERIFY' WBKEY                                               CFT120
     C                     MOVEL'74'      WBASE                                               CFT120
     C                     EXSR ABORT                                                         CFT120
      *                                                                                       CFT120
     C                     ELSE                                                               CFT120
      *                                                                                       CFT120
     C                     MOVE A6NBDP    WNBDP3  10                                          CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
     C                     Z-ADDWNBDP3    WDEC                                                CFT120
     C           11        SUB  WDEC      WDIG                                                CFT120
     C                     MOVEL*BLANKS   WFDIN                                               CFT120
     C                     MOVE INSCH3    WFDIN                                               CFT120
     C                     EXSR UGFRMT                                                        CFT120
     C                     MOVE *BLANKS   WCHR15                                              CFT120
     C                     MOVE WFDOUT    WCHR15                                              CFT120
     C                     MOVELWCHR15    P4SCH3                                              CFT120
     C                     MOVE INSCY3    P4SCH3                                              CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
     C           INSCY4    IFNE *BLANKS                                                       CFT120
      *                                                                                       CFT120
     C                     CALL 'AOCURRR0'                                                    CFT120
     C                     PARM '*DBERR ' @RTCD   7                                           CFT120
     C                     PARM '*KEY   ' @OPTN   7                                           CFT120
     C                     PARM INSCY4    @CCY    3                                           CFT120
     C           SDCURR    PARM SDCURR    DSSDY                                               CFT120
      *                                                                                       CFT120
     C           @RTCD     IFNE *BLANKS                                                       CFT120
     C                     MOVEL'SDCURRPD'WBFILE                                              CFT120
     C                     MOVEL'*VERIFY' WBKEY                                               CFT120
     C                     Z-ADD75        WBASE                                               CFT120
     C                     EXSR ABORT                                                         CFT120
      *                                                                                       CFT120
     C                     ELSE                                                               CFT120
      *                                                                                       CFT120
     C                     MOVE A6NBDP    WNBDP4  10                                          CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
     C                     Z-ADDWNBDP4    WDEC                                                CFT120
     C           11        SUB  WDEC      WDIG                                                CFT120
     C                     MOVEL*BLANKS   WFDIN                                               CFT120
     C                     MOVE INSCH4    WFDIN                                               CFT120
     C                     EXSR UGFRMT                                                        CFT120
     C                     MOVE *BLANKS   WCHR15                                              CFT120
     C                     MOVE WFDOUT    WCHR15                                              CFT120
     C                     MOVELWCHR15    P4SCH4                                              CFT120
     C                     MOVE INSCY4    P4SCH4                                              CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
     C           INSCY5    IFNE *BLANKS                                                       CFT120
      *                                                                                       CFT120
     C                     CALL 'AOCURRR0'                                                    CFT120
     C                     PARM '*DBERR ' @RTCD   7                                           CFT120
     C                     PARM '*KEY   ' @OPTN   7                                           CFT120
     C                     PARM INSCY5    @CCY    3                                           CFT120
     C           SDCURR    PARM SDCURR    DSSDY                                               CFT120
      *                                                                                       CFT120
     C           @RTCD     IFNE *BLANKS                                                       CFT120
     C                     MOVEL'SDCURRPD'WBFILE                                              CFT120
     C                     MOVEL'*VERIFY' WBKEY                                               CFT120
     C                     Z-ADD75        WBASE                                               CFT120
     C                     EXSR ABORT                                                         CFT120
      *                                                                                       CFT120
     C                     ELSE                                                               CFT120
      *                                                                                       CFT120
     C                     MOVE A6NBDP    WNBDP5  10                                          CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
     C                     Z-ADDWNBDP5    WDEC                                                CFT120
     C           11        SUB  WDEC      WDIG                                                CFT120
     C                     MOVEL*BLANKS   WFDIN                                               CFT120
     C                     MOVE INSCH5    WFDIN                                               CFT120
     C                     EXSR UGFRMT                                                        CFT120
     C                     MOVE *BLANKS   WCHR15                                              CFT120
     C                     MOVE WFDOUT    WCHR15                                              CFT120
     C                     MOVELWCHR15    P4SCH5                                              CFT120
     C                     MOVE INSCY5    P4SCH5                                              CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
      ** If found, delete INPAYXL0                                                            CFT120
      *                                                                                       CFT120
     C           *IN79     IFEQ '0'                                                           CFT120
     C                     DELETINPAYXDF                                                      CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
     C                     ENDIF                                                              CFT120
     C                     ENDSR                                                              CFT120
      *                                                                                       CFT120
      ********************************************************************CFT009
     C/EJECT                                                              CFT009
      ********************************************************************CFT009
      *                                                               *   CFT009
      * CALCG4 - SUBROUTINE TO CALCULATE CHARGES FOR CORE SWITCHABLE  *   CFT009
      *          FEATURE CFT009 (plus VAT component CFT010)           *   CFT009
      *                                                               *   CFT009
      ********************************************************************CFT009
      *                                                                ***CFT009
     C           CALCG4    BEGSR                                          CFT009
      *                                                                ***CFT009
     C           PREF      CHAININPAYXL0             79                   CFT009
      *                                                                   CFT009
      ** Set up levied currency                                           CFT009
      *                                                                   CFT009
     C                     SELEC                                          CFT009
     C***********CDRO      WHNE 0                                                      CFT009 CSD027
     C           CDRO      WHNE *BLANKS                                                       CSD027
      *                                                                                       CFT120
     C                     MOVELBCCY      WCCY                            CFT009
     C           INCDRC    IFNE *BLANKS                                                       CFT120
     C           CFT120    ANDEQ'Y'                                                           CFT120
     C                     MOVELINCDRC    WCCY                                                CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
     C           ADDC      WHEQ 'A'                                       CFT009
     C                     MOVELSMCY      WCCY                            CFT009
     C                     OTHER                                          CFT009
     C                     MOVELPCCY      WCCY                            CFT009
     C                     ENDSL                                          CFT009
      *                                                                   CFT009
      ** Retrieve currency details                                        CFT009
      *                                                                   CFT009
     C                     CALL 'AOCURRR0'                                CFT009
     C                     PARM *BLANKS   @RTCD                           CFT009
     C                     PARM '*KEY   ' @OPTN                           CFT009
     C                     PARM WCCY      @CURR   3                       CFT009
     C           SDCURR    PARM SDCURR    DSSDY                           CFT009
      *                                                                   CFT009
     C           @RTCD     IFNE *BLANKS                                   CFT009
     C                     MOVE 'SDCURRPD'WBFILE           ***************CFT009
     C                     MOVELWCCY      WBKEY            ** DBERR  04 **CFT009
     C                     Z-ADD04        WBASE            ***************CFT009
     C                     EXSR ABORT                      *ABORT PGM*    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     Z-ADDA6NBDP    WNDP    10                      CFT009
     C                     Z-ADDA6NBDP    LEVDPS                          CFT009
     C                     Z-ADDWNDP      ZADEC                           CFT009
      *                                                                   CFT009
      ** SETUP CURRENCY NAMES                                             CFT009
      *                                                                   CFT009
     C                     MOVELWCCY      P4TXCY                          CFT009
     C                     MOVELWCCY      P4CQCY                          CFT009
     C                     MOVELWCCY      P4MSCY                          CFT009
     C                     MOVELWCCY      P4M1CY                          CFT009
     C                     MOVELWCCY      P4M2CY                          CFT009
     C                     MOVELWCCY      P4M3CY                          CFT009
     C                     MOVELWCCY      P4M4CY                          CFT009
     C                     MOVELWCCY      P4M5CY                          CFT009
     C                     MOVELWCCY      P4TRCY                          CFT009
     C                     MOVELWCCY      P4FXCY                          CFT009
     C                     MOVELWCCY      P4ADCY                          CFT009
     C                     MOVELWCCY      P4TLCY                          CFT009
      *                                                                   CFT009
      ** Set up charge ccy field                                          CFT009
      *                                                                   CFT009
     C                     MOVELINCHGC    P4CG01                          CFT009
     C                     MOVELINCHGC    P4CG02                          CFT009
     C                     MOVELINCHGC    P4CG03                          CFT009
     C                     MOVELINCHGC    P4CG04                          CFT009
     C                     MOVELINCHGC    P4CG05                          CFT009
     C                     MOVELINCHGC    P4CG06                          CFT009
     C                     MOVELINCHGC    P4CG07                          CFT009
     C                     MOVELINCHGC    P4CG08                          CFT009
     C                     MOVELINCHGC    P4CG09                          CFT009
     C                     MOVELINCHGC    P4CG10                          CFT009
     C                     MOVELINCHGC    P4CG11                          CFT009
     C                     MOVELINCHGC    P4CG12                          CFT009
     C                     MOVELINCHGC    P4CG13                          CFT009
      *                                                                   CFT009
      ** Move spread set code in                                          CFT009
      *                                                                   CFT009
     C                     MOVE FXSPSC    P4FXSP                          CFT009
      *                                                                   CFT009
      ** MOVE CHARGE CODES IN                                             CFT009
      *                                                                   CFT009
     C                     MOVE TLCODE    P4TXCD                          CFT009
     C                     MOVE CHCHCD    P4CQCD                          CFT009
     C                     MOVE MISCH     P4MSCD                          CFT009
     C                     MOVE MSCH1     P4M1CD                          CFT009
     C                     MOVE MSCH2     P4M2CD                          CFT009
     C                     MOVE MSCH3     P4M3CD                          CFT009
     C                     MOVE MSCH4     P4M4CD                          CFT009
     C                     MOVE MSCH5     P4M5CD                          CFT009
     C                     MOVE TFCCCO    P4TRCD                          CFT009
     C                     MOVE FXCHEC    P4FXCD                          CFT009
     C                     MOVE ADCHCD    P4ADCD                          CFT009
     C                     MOVE TLCHCD    P4TLCD                          CFT009
      *                                                                   CFT009
      ** Set up misc charge amounts in levied currency.                   CFT009
      *                                                                   CFT009
     C                     Z-ADDMSC01     ZMSC01 150H                     CFT009
     C                     Z-ADDMSC02     ZMSC02 150H                     CFT009
     C                     Z-ADDMSC03     ZMSC03 150H                     CFT009
     C                     Z-ADDMSC04     ZMSC04 150H                     CFT009
     C                     Z-ADDMSC05     ZMSC05 150H                     CFT009
      *                                                                   CFT009
      ** FORMAT TELEX CHARGE AMOUNT                                       CFT009
      *                                                                   CFT009
      ** FORMAT TELEX CHARGE AMOUNT                                       CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE TXCH      ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P4TXCH                          CFT009
      *                                                                   CFT009
      ** FORMAT CHEQUE CHARGE AMOUNT                                      CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE CQCH      ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P4CQCH                          CFT009
      *                                                                   CFT009
      ** FORMAT MISCELLANEOUS CHARGE AMOUNT                               CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE MSCH      ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P4MSCH                          CFT009
      *                                                                   CFT009
      ** FORMAT MISCELLANEOUS CHARGE AMOUNT 1                             CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE ZMSC01    ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P4M1CH                          CFT009
      *                                                                   CFT009
      ** FORMAT MISCELLANEOUS CHARGE AMOUNT 2                             CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE ZMSC02    ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P4M2CH                          CFT009
      *                                                                   CFT009
      ** FORMAT MISCELLANEOUS CHARGE AMOUNT 3                             CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE ZMSC03    ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P4M3CH                          CFT009
      *                                                                   CFT009
      ** FORMAT MISCELLANEOUS CHARGE AMOUNT 4                             CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE ZMSC04    ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P4M4CH                          CFT009
      *                                                                   CFT009
      ** FORMAT MISCELLANEOUS CHARGE AMOUNT 5                             CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE ZMSC05    ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P4M5CH                          CFT009
      *                                                                   CFT009
      **  FORMAT TRANSFER COMMISSION AMOUNT                               CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE TRCM      ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P4TRCH                          CFT009
      *                                                                   CFT009
      ** Format the FX/Change Commission amount                           CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE INCHCM    ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P4FXCH                          CFT009
      *                                                                   CFT009
      ** FORMAT ADVICE CHARGE AMOUNT                                      CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE ADCH      ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P4ADCH                          CFT009
      *                                                                   CFT009
      ** FORMAT TELEPHONE CHARGE AMOUNT                                   CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE TLCH      ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P4TLCH                          CFT009
      *                                                                   CFT009
      ** Convert amounts from file to charges currency.                   CFT009
      *                                                                   CFT009
     C                     Z-ADDDUMA2     ZTXCH  150H                     CFT009
     C                     Z-ADDDUMA3     ZCQCH  150H                     CFT009
     C                     Z-ADDDUMA6     ZMSCH  150H                     CFT009
     C                     Z-ADDDUMA1     ZTRCM  150H                     CFT009
     C                     Z-ADDINDUM7    ZINCHC 150H                     CFT009
     C                     Z-ADDDUMA4     ZADCH  150H                     CFT009
     C                     Z-ADDDUMA5     ZTLCH  150H                     CFT009
      *                                                                   CFT009
      ** Now format converted amounts for the printer file.               CFT009
      ** Retrieve charges currency details                                CFT009
      *                                                                   CFT009
     C                     CALL 'AOCURRR0'                                CFT009
     C                     PARM *BLANKS   @RTCD                           CFT009
     C                     PARM '*KEY   ' @OPTN                           CFT009
     C                     PARM INCHGC    @CURR   3                       CFT009
     C           SDCURR    PARM SDCURR    DSSDY                           CFT009
      *                                                                   CFT009
     C           @RTCD     IFNE *BLANKS                                   CFT009
     C                     MOVE 'SDCURRPD'WBFILE           ***************CFT009
     C                     MOVELINCHGC    WBKEY            ** DBERR  05 **CFT009
     C                     Z-ADD05        WBASE            ***************CFT009
     C                     EXSR ABORT                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     Z-ADDA6NBDP    WNDP    10                      CFT009
     C                     Z-ADDA6NBDP    CHGDPS                          CFT009
     C                     Z-ADDWNDP      ZADEC                           CFT009
      *                                                                   CFT009
      ** Format TELEX charge amount                                       CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE ZTXCH     ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P4TXCG                          CFT009
      *                                                                   CFT009
      ** Format CHEQUE charge amount                                      CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE ZCQCH     ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P4CQCG                          CFT009
      *                                                                   CFT009
      ** Format MISCELLANEOUS charge amount                               CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE ZMSCH     ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P4MSCG                          CFT009
      *                                                                   CFT009
      ** Format MISCELLANEOUS charge amount 1                             CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE CMSC01    ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P4M1CG                          CFT009
      *                                                                   CFT009
      ** Format MISCELLANEOUS charge amount 2                             CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE CMSC02    ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P4M2CG                          CFT009
      *                                                                   CFT009
      ** Format MISCELLANEOUS charge amount 3                             CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE CMSC03    ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P4M3CG                          CFT009
      *                                                                   CFT009
      ** Format MISCELLANEOUS charge amount 4                             CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE CMSC04    ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P4M4CG                          CFT009
      *                                                                   CFT009
      ** Format MISCELLANEOUS charge amount 5                             CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE CMSC05    ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P4M5CG                          CFT009
      *                                                                   CFT009
      ** Format TRANSFER COMMISSION amount                                CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE ZTRCM     ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P4TTCG                          CFT009
      *                                                                   CFT009
      ** Format the FX/Change Commission amount                           CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE ZINCHC    ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P4FXCG                          CFT009
      *                                                                   CFT009
      ** Format ADVICE charge amount                                      CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE ZADCH     ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P4ADCG                          CFT009
      *                                                                   CFT009
      ** Format TELEPHONE charge amount                                   CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE ZTLCH     ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P4TCCG                          CFT009
      *                                                                   CFT009
      ** Check if CFT010 is set on                                        CFT009
      *                                                                   CFT009
     C           CFT010    IFEQ 'Y'                                       CFT009
      *                                                                   CFT009
      ** Set up VAT flags for report                                      CFT009
      *                                                                   CFT009
     C                     MOVE INVAT2    P4INV2                          CFT009
     C                     MOVE INVAT3    P4INV3                          CFT009
     C                     MOVE INVAT6    P4INV6                          CFT009
     C                     MOVE VTMIC1    P4IVM1                          CFT009
     C                     MOVE VTMIC2    P4IVM2                          CFT009
     C                     MOVE VTMIC3    P4IVM3                          CFT009
     C                     MOVE VTMIC4    P4IVM4                          CFT009
     C                     MOVE VTMIC5    P4IVM5                          CFT009
     C                     MOVE INVAT1    P4INV1                          CFT009
     C                     MOVE INVAT7    P4INV7                          CFT009
     C                     MOVE INVAT4    P4INV4                          CFT009
     C                     MOVE INVAT5    P4INV5                          CFT009
      *                                                                   CFT009
      ** Perform V.A.T. processing if CFT010 is active                    CFT009
      *                                                                   CFT009
     C                     Z-ADD0         VATTOT 150                      CFT009
      *                                                                   CFT009
      ** Fill in V.A.T. total from the file value.                        CFT009
      *                                                                   CFT009
     C                     Z-ADDINVATT    VATTOT 150H                     CFT009
      *                                                                   CFT009
      ** Fill in V.A.T. total in charges currency from the file value.    CFT009
      *                                                                   CFT009
     C                     Z-ADDINDUM8    VATCHG 150H                     CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** CALCULATE TOTAL CHARGES AND FORMAT                               CFT009
      *                                                                   CFT009
     C           TXCH      ADD  WVAT2     WTTXC  110                      CFT009
      *                                                                   CFT009
      ** FORMAT TOTAL TELEX CHARGE AMOUNT                                 CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE WTTXC     ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
      *                                                                   CFT009
     C           CQCH      ADD  WVAT3     WTCQC  110                      CFT009
      *                                                                   CFT009
      ** FORMAT TOTAL CHEQUE CHARGE AMOUNT                                CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE WTCQC     ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
      *                                                                   CFT009
     C           TRCM      ADD  WVAT1     WTTRC  110                      CFT009
      *                                                                   CFT009
      **  FORMAT TOTAL TRANSFER COMMISSION AMOUNT                         CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE WTTRC     ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
      *                                                                   CFT009
     C           ADCH      ADD  WVAT4     WTADC  110                      CFT009
      *                                                                   CFT009
      ** FORMAT TOTAL ADVICE CHARGE AMOUNT                                CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE WTADC     ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
      *                                                                   CFT009
     C           TLCH      ADD  WVAT5     WTTLC  110                      CFT009
      *                                                                   CFT009
      ** FORMAT TOTAL TELEPHONE CHARGE AMOUNT                             CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE WTTLC     ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
      *                                                                   CFT009
      ** CALCULATE GRAND TOTALS CHARGES AND FORMAT                        CFT009
      ** Total charges for LHS.                                           CFT009
      *                                                                   CFT009
     C           TXCH      ADD  CQCH      WTLAM  140                      CFT009
     C                     ADD  MSCH      WTLAM                           CFT009
     C                     ADD  ZMSC01    WTLAM                           CFT009
     C                     ADD  ZMSC02    WTLAM                           CFT009
     C                     ADD  ZMSC03    WTLAM                           CFT009
     C                     ADD  ZMSC04    WTLAM                           CFT009
     C                     ADD  ZMSC05    WTLAM                           CFT009
     C                     ADD  TRCM      WTLAM                           CFT009
     C                     ADD  INCHCM    WTLAM                           CFT009
     C                     ADD  ADCH      WTLAM                           CFT009
     C                     ADD  TLCH      WTLAM                           CFT009
      ** Add on V.A.T. if CFT010 is on.                                   CFT009
     C           CFT010    IFEQ 'Y'                                       CFT009
     C                     ADD  VATTOT    WTLAM                           CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Total charges for RHS.                                           CFT009
      *                                                                   CFT009
     C           ZTXCH     ADD  ZCQCH     WTLAC  140                      CFT009
     C                     ADD  ZMSCH     WTLAC                           CFT009
     C                     ADD  CMSC01    WTLAC                           CFT009
     C                     ADD  CMSC02    WTLAC                           CFT009
     C                     ADD  CMSC03    WTLAC                           CFT009
     C                     ADD  CMSC04    WTLAC                           CFT009
     C                     ADD  CMSC05    WTLAC                           CFT009
     C                     ADD  ZTRCM     WTLAC                           CFT009
     C                     ADD  ZINCHC    WTLAC                           CFT009
     C                     ADD  ZADCH     WTLAC                           CFT009
     C                     ADD  ZTLCH     WTLAC                           CFT009
      ** Add on V.A.T. if CFT010 is on.                                   CFT009
     C           CFT010    IFEQ 'Y'                                       CFT009
     C                     ADD  VATCHG    WTLAC                           CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Format grand total amount for LHS                                CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE WTLAM     ZFIELD                          CFT009
     C                     Z-ADDLEVDPS    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P4TLAM                          CFT009
      *                                                                   CFT009
      ** Format grand total amount for RHS                                CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE WTLAC     ZFIELD                          CFT009
     C                     Z-ADDCHGDPS    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P4TLCG                          CFT009
      *                                                                   CFT009
      ** Set up the V.A.T. total for formatting, if CFT010 is on.         CFT009
      *                                                                   CFT009
     C           CFT010    IFEQ 'Y'                                       CFT009
      *                                                                   CFT009
     C                     Z-ADDVATTOT    WTLVT                           CFT009
      *                                                                   CFT009
      ** FORMAT GRAND TOTAL VAT                                           CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE WTLVT     ZFIELD                          CFT009
     C                     Z-ADDLEVDPS    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P4TLVT                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** FORMAT GRAND TOTAL CHARGE                                        CFT009
      *                                                                   CFT009
      *                                                                   CFT009
      ** Check to see if CFT010 is on.                                    CFT009
      *                                                                   CFT009
     C           CFT010    IFEQ 'Y'                                       CFT009
      *                                                                   CFT009
      ** Format V.A.T. total in charges currency.                         CFT009
      ** Retrieve charges currency details                                CFT009
      *                                                                   CFT009
     C                     CALL 'AOCURRR0'                                CFT009
     C                     PARM *BLANKS   @RTCD                           CFT009
     C                     PARM '*KEY   ' @OPTN                           CFT009
     C                     PARM INCHGC    @CURR   3                       CFT009
     C           SDCURR    PARM SDCURR    DSSDY                           CFT009
      *                                                                   CFT009
     C           @RTCD     IFNE *BLANKS                                   CFT009
     C                     MOVE 'SDCURRPD'WBFILE           ***************CFT009
     C                     MOVELINCHGC    WBKEY            ** DBERR  06 **CFT009
     C                     Z-ADD06        WBASE            ***************CFT009
     C                     EXSR ABORT                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Format V.A.T. total in charges currency.                         CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE VATCHG    ZFIELD                          CFT009
     C                     Z-ADDCHGDPS    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P4VTCC                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDSR                                          CFT009
      *                                                                   CFT009
     C********************************************************************
     C/EJECT
     C********************************************************************
     C*                                                               *
     C*  OTPREP - SUBROUTINE TO PRODUCE REPORT FT1000P5 FOR OUTGOING  *
     C*           PAYMENTS                                            *
     C*                                                               *
     C*****************************************************************
     C*
     C*
     C           OTPREP    BEGSR
     C*
     C                     MOVELTITL      P5TITL
     C                     MOVELRUNA      P5DATE
     C*                                                                   S01117
     C* IF MULTIBRANCHING INDICATOR ACTIVE, MOVE BOOKING BRANCH AND       S01117
     C* APPROPRIATE BRANCH NAME TO THE RELATIVE FIELDS SET UP WITHIN      S01117
     C* THE PRINTER FILE                                                  S01117
     C*                                                                   S01117
     C           *IN30     IFEQ '1'                                       S01117
     C                     MOVE BRCA      P5BRCA                          S01117
     C                     MOVE BRCA      WRKFLD                          S01117
     C                     EXSR SUBBRN                                    S01117
     C                     MOVELBRNM      P5BRNM                          S01117
     C*                                                                   S01117
     C* IF ORIGINATING BRANCH USED INDICATOR ACTIVE,MOVE ORBR AND         S01117
     C* APPROPRIATE BRANCH NAME TO THE RELATIVE FIELDS SET UP WITHIN      S01117
     C* THE PRINTER FILE                                                  S01117
     C*                                                                   S01117
     C           *IN35     IFEQ '1'                                       S01117
     C                     MOVE ORBR      P5ORBR                          S01117
     C                     MOVE ORBR      WRKFLD                          S01117
     C                     EXSR SUBBRN                                    S01117
     C                     MOVELBRNM      P5ORNM                          S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C************                                                        S01435
     C************                                                        S01435
     C***SETUP*ADDRESS FIELDS,ACESSING CLINT AS APPROPRIATE               S01435
     C************                                                        S01435
     C***RECEIVER'S CORRESPONDENT                                         S01435
     C************                                                        S01435
     C***********RCRT      IFNE 'C'                                       S01435
     C************         MOVELRCO1      P5RCO1                          S01435
     C************         MOVELRCO2      P5RCO2                          S01435
     C************         MOVELRCO3      P5RCO3                          S01435
     C************         MOVELRCO4      P5RCO4                          S01435
     C************         MOVELRCO5      P5RCO5                          S01435
     C************         ELSE                                           S01435
     C************         MOVELRCO1      WCLNUM                          S01435
     C************         MOVEL'B'       WCLRCT                          S01435
     C************         EXSR UCCLCN                                    S01435
     C************                                                        S01435
     C************IN89     IFEQ '1'                                       S01435
     C************         MOVEL'CLINT'   WBFILE                          S01435
     C************         MOVELWCLNUM    WA7     7                       S01435
     C************         MOVE WCLRCT    WA7              **********     S01435
     C************         MOVELWA7       WBKEY            * DBERR 18     S01435
     C************         Z-ADD18        WBASE            **********     S01435
     C************         EXSR ABORT                      *ABORT PGM*    S01435
     C************         END                                            S01435
     C************                                                        S01435
     C************         MOVELRCO1      P5RCO1                          S01435
     C************         MOVELCNA1      P5RCO2                          S01435
     C************         MOVELCNA2      P5RCO3                          S01435
     C************         MOVELCNA3      P5RCO4                          S01435
     C************         MOVELCNA4      P5RCO5                          S01435
     C************         END                                            S01435
     C************                                                        S01435
     C***ORDERING*CUSTOMER                                                S01435
     C************                                                        S01435
     C***********ORCT      IFNE 'C'                                       S01435
     C************         MOVELORC1      P5ORC1                          S01435
     C************                                                        S01117
     C**IF*MULTIBRANCHING INDICATOR SETOF AND PARTIAL ACCOUNT ENTRY,      S01117
     C**SINGLE*BRANCH NEED TO BE FORMATTED BY CUTTING OFF THE BRANCH CODE S01117
     C**FROM*THE*END USING WORK FIELD BEFORE OUTPUTING TO THE PRINTER     S01117
     C**FILE******                                                        S01117
     C************IN30     IFEQ '0'                                       S01117
     C***********ORCT      ANDEQ'P'                                       S01117
     C************         MOVELORC1      FLD12  12                       S01117
     C************         MOVE *BLANKS   P5ORC1                          S01117
     C************         MOVELFLD12     P5ORC1                          S01117
     C************         END                                            S01117
     C************         MOVELORC2      P5ORC2                          S01435
     C************         MOVELORC3      P5ORC3                          S01435
     C************         MOVELORC4      P5ORC4                          S01435
     C************         MOVEL*BLANKS   P5ORC5                          S01435
     C************         ELSE                                           S01435
     C************         MOVELORC1      WCLNUM                          S01435
     C************         MOVEL'B'       WCLRCT                          S01435
     C************         EXSR UCCLCN                                    S01435
     C************                                                        S01435
     C************IN89     IFEQ '1'                                       S01435
     C************         MOVEL'CLINT'   WBFILE                          S01435
     C************         MOVELWCLNUM    WA7                             S01435
     C************         MOVE WCLRCT    WA7              **********     S01435
     C************         MOVELWA7       WBKEY            * DBERR 19     S01435
     C************         Z-ADD19        WBASE            **********     S01435
     C************         EXSR ABORT                      *ABORT PGM*    S01435
     C************         END                                            S01435
     C************                                                        S01435
     C************         MOVELORC1      P5ORC1                          S01435
     C************         MOVELCNA1      P5ORC2                          S01435
     C************         MOVELCNA2      P5ORC3                          S01435
     C************         MOVELCNA3      P5ORC4                          S01435
     C************         MOVELCNA4      P5ORC5                          S01435
     C************         END                                            S01435
     C************                                                        S01435
     C***RECEIVING BANK                                                   S01435
     C************                                                        S01435
     C***********DSTT      IFNE 'C'                                       S01435
     C************         MOVELDST1      P5DST1                          S01435
     C************                                                        S01117
     C**IF*MULTIBRANCHING INDICATOR SETOF AND FULL ACCOUNT ENTRY,SINGLE   S01117
     C**BRANCH*NEED TO BE FORMATTED BY CUTTING OFF THE BRANCH CODE FROM   S01117
     C**THE*END*USING A WORK FIELD BEFORE OUTPUTING TO THE PRINTER FILE   S01117
     C************                                                        S01117
     C************IN30     IFEQ '0'                                       S01117
     C***********DSTT      ANDEQ'G'                                       S01117
     C************         MOVELDST1      FLD15  15                       S01117
     C************         MOVE *BLANKS   P5DST1                          S01117
     C************         MOVELFLD15     P5DST1                          S01117
     C************         END                                            S01117
     C************         MOVELDST2      P5DST2                          S01435
     C************         MOVELDST3      P5DST3                          S01435
     C************         MOVELDST4      P5DST4                          S01435
     C************         MOVEL*BLANKS   P5DST5                          S01435
     C************         ELSE                                           S01435
     C************         MOVELDST1      WCLNUM                          S01435
     C************         MOVEL'B'       WCLRCT                          S01435
     C************         EXSR UCCLCN                                    S01435
     C************                                                        S01435
     C************IN89     IFEQ '1'                                       S01435
     C************         MOVEL'CLINT'   WBFILE           **********     S01435
     C************         MOVELWCLNUM    WA7              * DBERR 40     S01435
     C************         MOVE WCLRCT    WA7              **********     S01435
     C************         MOVELWA7       WBKEY                           S01435
     C************         Z-ADD40        WBASE                           S01435
     C************         EXSR ABORT                      *ABORT PGM*    S01435
     C************         END                                            S01435
     C************                                                        S01435
     C************         MOVELDST1      P5DST1                          S01435
     C************         MOVELCNA1      P5DST2                          S01435
     C************         MOVELCNA2      P5DST3                          S01435
     C************         MOVELCNA3      P5DST4                          S01435
     C************         MOVELCNA4      P5DST5                          S01435
     C************         END                                            S01435
     C************                                                        S01435
     C***ACCOUNT*WITH BANK                                                S01435
     C************                                                        S01435
     C***********ACBT      IFNE 'C'                                       S01435
     C************         MOVELACB1      P5ACB1                          S01435
     C************         MOVELACB2      P5ACB2                          S01435
     C************         MOVELACB3      P5ACB3                          S01435
     C************         MOVELACB4      P5ACB4                          S01435
     C************         MOVELACB5      P5ACB5                          S01435
     C************         ELSE                                           S01435
     C************         MOVELACB1      WCLNUM                          S01435
     C************         MOVEL'B'       WCLRCT                          S01435
     C************         EXSR UCCLCN                                    S01435
     C************                                                        S01435
     C************IN89     IFEQ '1'                                       S01435
     C************         MOVEL'CLINT'   WBFILE                          S01435
     C************         MOVELWCLNUM    WA7                             S01435
     C************         MOVE WCLRCT    WA7              **********     S01435
     C************         MOVELWA7       WBKEY            * DBERR 20     S01435
     C************         Z-ADD20        WBASE            **********     S01435
     C************         EXSR ABORT                      *ABORT PGM*    S01435
     C************         END                                            S01435
     C************                                                        S01435
     C************         MOVELACB1      P5ACB1                          S01435
     C************         MOVELCNA1      P5ACB2                          S01435
     C************         MOVELCNA2      P5ACB3                          S01435
     C************         MOVELCNA3      P5ACB4                          S01435
     C************         MOVELCNA4      P5ACB5                          S01435
     C************         END                                            S01435
     C************                                                        S01435
     C***BENEFICIARY CUSTOMER                                             S01435
     C************                                                        S01435
     C***********BNCT      IFNE 'C'                                       S01435
     C************         MOVELBNC1      P5BNC1                          S01435
     C************         MOVELBNC2      P5BNC2                          S01435
     C************         MOVELBNC3      P5BNC3                          S01435
     C************         MOVELBNC4      P5BNC4                          S01435
     C************         MOVELBNC5      P5BNC5                          S01435
     C************         ELSE                                           S01435
     C************         MOVELBNC1      WCLNUM                          S01435
     C************         MOVEL'B'       WCLRCT                          S01435
     C************         EXSR UCCLCN                                    S01435
     C************                                                        S01435
     C************IN89     IFEQ '1'                                       S01435
     C************         MOVEL'CLINT'   WBFILE                          S01435
     C************         MOVELWCLNUM    WA7                             S01435
     C************         MOVE WCLRCT    WA7              **********     S01435
     C************         MOVELWA7       WBKEY            * DBERR 21     S01435
     C************         Z-ADD21        WBASE            **********     S01435
     C************         EXSR ABORT                      *ABORT PGM*    S01435
     C************         END                                            S01435
     C************                                                        S01435
     C************         MOVELBNC1      P5BNC1                          S01435
     C************         MOVELCNA1      P5BNC2                          S01435
     C************         MOVELCNA2      P5BNC3                          S01435
     C************         MOVELCNA3      P5BNC4                          S01435
     C************         MOVELCNA4      P5BNC5                          S01435
     C************         END                                            S01435
     C************                                                        S01435
     C***FORMAT*PAY & SETTLE AMOUNTS                                      S01435
     C************                                                        S01435
     C***CALL*UATBCN TO ACCESS CURRENCY RECORD FOR SETTLE CURRENCY        S01435
     C************                                                        S01435
     C************         MOVEL*BLANKS   ZTABKY                          S01435
     C************         MOVEL'20'      ZTABKY                          S01435
     C************         MOVELSMCY      WA4                             S01435
     C************         MOVE '1'       WA4                             S01435
     C************         MOVE WA4       ZTABKY                          S01435
     C************         EXSR UATBCN                                    S01435
     C************                                                        S01435
     C***CHECK*IF*DATABASE ERROR OCCURRED                                 S01435
     C************                                                        S01435
     C************IN89     IFEQ '1'                                       S01435
     C************         MOVEL'TABLE'   WBFILE           **********     S01435
     C************         MOVELZTABKY    WBKEY            * DBERR 22     S01435
     C************         Z-ADD22        WBASE            **********     S01435
     C************         EXSR ABORT                      *ABORT PGM*    S01435
     C************         END                                            S01435
     C************                                                        S01435
     C***STORE*NUMBER OF DECIMAL PLACES FOR SETTLE CURRENCY               S01435
     C************                                                        S01435
     C************         Z-ADDCDP       SVSCDP  10                      S01435
     C************                                                        S01435
     C***FORMAT*SETTLE AMOUNT                                             S01435
     C************                                                        S01435
     C************         MOVEL*BLANKS   WFDIN  15                       S01435
     C************         MOVE SMAM      WFDIN                           S01435
     C************         Z-ADDSVSCDP    WDEC    10                      S01435
     C***********13        SUB  SVSCDP    WDIG    20                      S01435
     C************         EXSR UGFRMT                                    S01435
     C************         MOVE WFDOUT    P5SMAM                          S01435
     C************                                                        S01435
     C***CALL*UATBCN TO ACCESS CURRENCY RECORD FOR PAY CURRENCY           S01435
     C************                                                        S01435
     C************         MOVEL*BLANKS   ZTABKY                          S01435
     C************         MOVEL'20'      ZTABKY                          S01435
     C************         MOVELPCCY      WA4                             S01435
     C************         MOVE '1'       WA4                             S01435
     C************         MOVE WA4       ZTABKY                          S01435
     C************         EXSR UATBCN                                    S01435
     C************                                                        S01435
     C***CHECK*IF*DATABASE ERROR OCCURRED                                 S01435
     C************                                                        S01435
     C************IN89     IFEQ '1'                                       S01435
     C************         MOVEL'TABLE'   WBFILE           **********     S01435
     C************         MOVELZTABKY    WBKEY            * DBERR 23     S01435
     C************         Z-ADD23        WBASE            **********     S01435
     C************         EXSR ABORT                      *ABORT PGM*    S01435
     C************         END                                            S01435
     C************                                                        S01435
     C***STORE*NUMBER OF DECIMAL PLACES FOR PAY CURRENCY                  S01435
     C************                                                        S01435
     C************         Z-ADDCDP       SVPCDP  10                      S01435
     C************                                                        S01435
     C***FORMAT*PAY AMOUNT                                                S01435
     C************                                                        S01435
     C************         MOVEL*BLANKS   WFDIN                           S01435
     C************         MOVE PYAM      WFDIN                           S01435
     C************         Z-ADDSVPCDP    WDEC                            S01435
     C***********13        SUB  SVPCDP    WDIG                            S01435
     C************         EXSR UGFRMT                                    S01435
     C************         MOVE WFDOUT    P5PYAM                          S01435
     C************                                                        S01435
     C***FORMAT*OTHER AMOUNTS & CURRENCIES                                S01435
     C***IF*CHARGES TO DEBIT A/C FIELD IS NON-ZERO USE BASE CURRENCY;     S01435
     C***OTHERWISE IF PAY PLUS CHARGES INDICATOR IS 'Y' USE SETTLE CCY;   S01435
     C***OTHERWISE USE PAY CURRENCY                                       S01435
     C************                                                        S01435
     C***********CDRO      IFNE *ZERO                                     S01435
     C************         MOVELBCCY      WCCY    3                       S01435
     C************         Z-ADDSVBCDP    WDEC                            S01435
     C************         ELSE                                           S01435
     C***********ADDC      IFEQ 'Y'                                       S01435
     C************         MOVELSMCY      WCCY                            S01435
     C************         Z-ADDSVSCDP    WDEC                            S01435
     C************         ELSE                                           S01435
     C************         MOVELPCCY      WCCY                            S01435
     C************         Z-ADDSVPCDP    WDEC                            S01435
     C************         END                                            S01435
     C************         END                                            S01435
     C************                                                        S01435
     C***********11        SUB  WDEC      WDIG                            S01435
     C************                                                        S01435
     C***SETUP*CURRENCY NAMES                                             S01435
     C************                                                        S01435
     C************         MOVELWCCY      P5TRCY                          S01435
     C************         MOVELWCCY      P5TXCY                          S01435
     C************         MOVELWCCY      P5CQCY                          S01435
     C************         MOVELWCCY      P5SPCY                          S01435
     C************         MOVELWCCY      P5CSCY                          S01435
     C************         MOVELWCCY      P5MSCY                          S01435
     C************                                                        S01435
     C***FORMAT*TRANSFER COMMISSION AMOUNT                                S01435
     C************                                                        S01435
     C************         MOVEL*BLANKS   WFDIN                           S01435
     C************         MOVE TRCM      WFDIN                           S01435
     C************         EXSR UGFRMT                                    S01435
     C************         MOVE WFDOUT    P5TRCM                          S01435
     C************                                                        S01435
     C***FORMAT*TELEX CHARGE AMOUNT                                       S01435
     C************                                                        S01435
     C************         MOVEL*BLANKS   WFDIN                           S01435
     C************         MOVE TXCH      WFDIN                           S01435
     C************         EXSR UGFRMT                                    S01435
     C************         MOVE WFDOUT    P5TXCH                          S01435
     C************                                                        S01435
     C***FORMAT*CHEQUE CHARGE AMOUNT                                      S01435
     C************                                                        S01435
     C************         MOVEL*BLANKS   WFDIN                           S01435
     C************         MOVE CQCH      WFDIN                           S01435
     C************         EXSR UGFRMT                                    S01435
     C************         MOVE WFDOUT    P5CQCH                          S01435
     C************                                                        S01435
     C***FORMAT*SWIFT PR CHARGE AMOUNT                                    S01435
     C************                                                        S01435
     C************         MOVEL*BLANKS   WFDIN                           S01435
     C************         MOVE SPCH      WFDIN                           S01435
     C************         EXSR UGFRMT                                    S01435
     C************         MOVE WFDOUT    P5SPCH                          S01435
     C************                                                        S01435
     C***FORMAT*COSTS ABROAD CHARGE AMOUNT                                S01435
     C************                                                        S01435
     C************         MOVEL*BLANKS   WFDIN                           S01435
     C************         MOVE CSTA      WFDIN                           S01435
     C************         EXSR UGFRMT                                    S01435
     C************         MOVE WFDOUT    P5CSTA                          S01435
     C************                                                        S01435
     C***FORMAT*MISCELLANEOUS CHARGE AMOUNT                               S01435
     C************                                                        S01435
     C************         MOVEL*BLANKS   WFDIN                           S01435
     C************         MOVE MSCH      WFDIN                           S01435
     C************         EXSR UGFRMT                                    S01435
     C************         MOVE WFDOUT    P5MSCH                          S01435
     C************                                                        S01435
     C***FORMAT*DATE FIELDS USING SYSTEM ROUTINE ZDATE2                   S01435
     C************                                                        S01435
     C***SETTLE*VALUE DATE                                                S01435
     C************                                                        S01435
     C************         Z-ADDSLDT      ZDAYNO                          S01435
     C************         EXSR ZDATE2                                    S01435
     C************         MOVELZADATE    P5SLDT                          S01435
     C************                                                        S01435
     C***PAY*VALUE DATE                                                   S01435
     C************                                                        S01435
     C************         Z-ADDPVDT      ZDAYNO                          S01435
     C************         EXSR ZDATE2                                    S01435
     C************         MOVELZADATE    P5PYDT                          S01435
     C************                                                        S01435
     C***FINAL*DATE                                                       S01435
     C************                                                        S01435
     C************         Z-ADDFDAT      ZDAYNO                          S01435
     C************         EXSR ZDATE2                                    S01435
     C************         MOVELZADATE    P5FDAT                          S01435
     C************                                                        S01435
     C************         Z-ADDNPDT      ZDAYNO                          S01435
     C************         EXSR ZDATE2                                    S01435
     C************         MOVELZADATE    P5NPDT                          S01435
     C************                                                        S01435
     C***SETUP*REMAINING REPORT FIELDS                                    S01435
     C************                                                        S01435
     C************         MOVELPREF      P5PREF                          S01435
     C************         MOVELPYTP      P5PYTP                          S01435
     C************         MOVELPYST      P5PYST                          S01435
     C************         MOVELSMCY      P5SMCY                          S01435
     C************         Z-ADDRATE      P5RATE                          S01435
     C************         MOVELPCCY      P5PCCY                          S01435
     C************         MOVELBBI1      P5BBI1                          S01435
     C************         MOVELBBI2      P5BBI2                          S01435
     C************         MOVELBBI3      P5BBI3                          S01435
     C************         MOVELBBI4      P5BBI4                          S01435
     C************         MOVELBBI5      P5BBI5                          S01435
     C************         MOVELBBI6      P5BBI6                          S01435
     C************         MOVELDTP1      P5DTP1                          S01435
     C************         MOVELDTP2      P5DTP2                          S01435
     C************         MOVELDTP3      P5DTP3                          S01435
     C************         MOVELDTP4      P5DTP4                          S01435
     C************         MOVELSTMT      P5STTP                          S01435
     C***********DNBC      IFEQ *ZERO                                     S01435
     C************         MOVE *BLANKS   P5DNBC                          S01435
     C************         ELSE                                           S01435
     C************         MOVELDNBC      P5DNBC                          S01435
     C************         END                                            S01435
     C************         MOVELSNMT      P5SNMT                          S01435
     C************         MOVELADDC      P5ADDC                          S01435
     C************         MOVELRPAY      P5RPAY                          S01435
     C************         MOVELPAYF      P5PAYF                          S01435
     C************         MOVELDYIM      P5DYIM                          S01435
     C************         MOVELDTCH      P5DTCH                          S01435
     C************         MOVELTRCT      P5TRCT                          S01435
     C*********************MOVELSWPC      P5SWPC                          S01117
     C***FORMAT*SWIFT PRIORITY CODE                                       S01117
     C************                                                        S01117
     C***********SWPC      IFEQ 1                                         S01117
     C************         MOVE 'U'       P5SWPC                          S01117
     C************         ELSE                                           S01117
     C***********SWPC      IFEQ 2                                         S01117
     C************         MOVE 'N'       P5SWPC                          S01117
     C************         END                                            S01117
     C************         END                                            S01117
     C************                                                        S01435
     C***TRANSFER*DATA TO PRINTER                                         S01435
     C************                                                        S01435
     C************         MOVE RLPR      P5RLPR                          S01435
     C***********CHAP      IFEQ *ZERO                                     S01435
     C************         MOVE *BLANKS   P5CHAP                          S01435
     C************         ELSE                                           S01435
     C************         Z-ADDCHAP      P#CHAP  60                      S01435
     C************         MOVELP#CHAP    P5CHAP                          S01435
     C************         END                                            S01435
     C************         MOVELINB1      P5INB1                          S01435
     C************         MOVELINB2      P5INB2                          S01435
     C************         MOVELINB3      P5INB3                          S01435
     C************         MOVELINB4      P5INB4                          S01435
     C************         MOVELINB5      P5INB5                          S01435
     C************                                                        S01435
     C************                                                        S01435
     C***EDIT**SNCO, ORBK AND CDRO  FOR OUTPUT                            S01435
     C************                                                        S01435
     C************         MOVE SNCT      PRMTYP  1        ( SNCO )       S01435
     C************         MOVE *ZEROS    PRMFLD 12                       S01435
     C************         MOVELSNCO      PRMFLD                          S01435
     C************         EXSR CHOPF                                     S01435
     C************         MOVELPRMFLD    P5SNCO                          S01435
     C************                                                        S01435
     C************         MOVE ORBT      PRMTYP           ( ORBK )       S01435
     C************         MOVE *ZEROS    PRMFLD                          S01435
     C************         MOVELORBK      PRMFLD                          S01435
     C************         EXSR CHOPF                                     S01435
     C************         MOVELPRMFLD    P5ORBK                          S01435
     C************         MOVE ORBB      P5ORBB                          S01117
     C************                                                        S01435
     C************         MOVE CDRT      PRMTYP           ( CDRO )       S01435
     C************         MOVE *ZEROS    PRMFLD                          S01435
     C************         MOVELCDRO      PRMFLD                          S01435
     C************         EXSR CHOPF                                     S01435
     C************         MOVELPRMFLD    P5CDRO                          S01435
     C************         MOVE CDBR      P5CDBR                          S01117
      *                                                                   S01435
      * Set Up Ordering Institution Details                               S01435
      *                                                                   S01435
     C                     MOVEL*BLANKS   P5OBDS                          S01435
     C                     MOVEL*BLANKS   P5ORBK                          S01435
     C           OPORB1    IFNE *BLANKS                                   S01435
      *                                                                   S01435
      * If SWIFT type A translate else leave as on message                S01435
      *                                                                   S01435
     C                     MOVEL#IMSG     P5ORBK                          S01435
     C           OPORBT    IFNE 'S'                                       S01435
     C                     MOVELOPORB1    P5ORB1                          S01435
     C                     MOVELOPORB2    P5ORB2                          S01435
     C                     MOVELOPORB3    P5ORB3                          S01435
     C                     MOVELOPORB4    P5ORB4                          S01435
     C                     MOVELOPORB5    P5ORB5                          S01435
     C                     ELSE                                           S01435
     C                     MOVEL'ORBT'    XCALL                           S01435
     C                     MOVELOPORBT    XTYPE                           S01435
     C                     MOVEL*BLANKS   XNAMDS                          S01435
     C                     MOVELOPORB1    ##001   1                       S01435
     C           ##001     IFEQ '/'                                       S01435
     C                     MOVELOPORB2    XNAMDS                          S01435
     C                     ELSE                                           S01435
     C                     MOVELOPORB1    XNAMDS                          S01435
     C                     END                                            S01435
     C                     EXSR GETADD                                    S01435
     C                     MOVELXNAMDS    P5OBDS                          S01435
     C                     END                                            S01435
     C                     END                                            S01435
      *                                                                   S01435
      * Translate input account with bank                                 S01435
      *                                                                   S01435
     C           ORBT      IFNE *BLANKS                                   S01435
     C                     MOVEL'ORBT'    XCALL                           S01435
     C                     MOVELORBT      XTYPE                           S01435
     C                     MOVELSMCY      XCCY                            S01435
     C                     MOVEL*BLANKS   XNAMDS                          S01435
     C                     MOVELORBK      XNAMDS                          S01435
     C                     MOVE ORBB      XBRCA                           S01435
     C/COPY WNCPYSRC,FT1000C043
     C                     EXSR GETADD                                    S01435
     C           OPORB1    IFEQ *BLANKS                                   S01435
     C                     MOVELXADDS     P5OBDS                          S01435
     C                     END                                            S01435
     C                     MOVELXNAMDS    P5ORBK                          S01435
     C                     END                                            S01435
      *                                                                   S01435
      ** INTERMEDIARY BANK                                                S01435
      *                                                                   S01435
     C                     MOVEL'INBT'    XCALL   4                       S01435
     C                     MOVELINBT      XTYPE                           S01435
     C                     MOVELININDS    XNAMDS                          S01435
     C                     EXSR GETADD                                    S01435
     C                     MOVELXNAMDS    P5INDS                          S01435
      *                                                                   S01435
      ** RECEIVER'S CORRESPONDENT                                         S01435
      *                                                                   S01435
     C                     MOVE 'RCRT'    XCALL   4                       S01435
     C                     MOVELRCRT      XTYPE                           S01435
     C                     MOVELRCINDS    XNAMDS                          S01435
     C                     EXSR GETADD                                    S01435
     C                     MOVELXNAMDS    P5RCDS                          S01435
      *                                                                   S01435
      ** ORDERING CUSTOMER                                                S01435
      *                                                                   S01435
     C                     MOVE 'ORCT'    XCALL   4                       S01435
     C                     MOVELSMCY      XCCY                            S01435
     C                     MOVELORCT      XTYPE                           S01435
     C                     MOVELORINDS    XNAMDS                          S01435
     C                     EXSR GETADD                                    S01435
     C                     MOVELXNAMDS    P5ORDS                          S01435
      *                                                                   S01435
      ** Destination                                                      S01435
      *                                                                   S01435
     C                     MOVE 'DSTT'    XCALL   4                       S01435
     C                     MOVELDSTT      XTYPE                           S01435
     C                     MOVELDSINDS    XNAMDS                          S01435
     C                     EXSR GETADD                                    S01435
     C                     MOVELXNAMDS    P5DSDS                          S01435
      *                                                                   S01435
      ** ACCOUNT WITH BANK                                                S01435
      *                                                                   S01435
     C                     MOVE 'ACBT'    XCALL   4                       S01435
     C                     MOVELACBT      XTYPE                           S01435
     C                     MOVELACINDS    XNAMDS                          S01435
     C                     EXSR GETADD                                    S01435
     C                     MOVELXNAMDS    P5ACDS                          S01435
      *                                                                   S01435
      ** BENEFICIARY CUSTOMER                                             S01435
      *                                                                   S01435
     C                     MOVE 'BNCT'    XCALL   4                       S01435
     C                     MOVELBNCT      XTYPE                           S01435
     C                     MOVELBNINDS    XNAMDS                          S01435
     C                     EXSR GETADD                                    S01435
     C                     MOVELXNAMDS    P5BNDS                          S01435
      *                                                                   S01435
     C                     MOVE *BLANKS   XCALL   4                       S01435
     C*                                                                   S01435
     C** FORMAT SETTLE & PAY AMOUNTS                                      S01435
     C*                                                                   S01435
     C** CALL UATBCN TO ACCESS CURRENCY RECORD FOR SETTLE CURRENCY        S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   ZTABKY                          S01435
     C                     MOVEL'20'      ZTABKY                          S01435
     C                     MOVELSMCY      WA4                             S01435
     C                     MOVE '1'       WA4                             S01435
     C                     MOVE WA4       ZTABKY                          S01435
     C                     EXSR UATBCN                                    S01435
     C*                                                                   S01435
     C** CHECK IF DATABASE ERROR OCCURRED                                 S01435
     C*                                                                   S01435
     C           *IN89     IFEQ '1'                                       S01435
     C                     MOVEL'TABLE'   WBFILE                          S01435
     C                     MOVELZTABKY    WBKEY                           S01435
     C                     MOVEL'54'      WBASE                           S01435
     C                     EXSR ABORT                      *ABORT PGM*    S01435
     C                     END                                            S01435
     C*                                                                   S01435
     C** STORE NUMBER OF DECIMAL PLACES FOR SETTLE CURRENCY               S01435
     C*                                                                   S01435
     C                     Z-ADDCDP       SVSCDP  10                      S01435
     C*                                                                   S01435
     C** FORMAT SETTLE AMOUNT                                             S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN  15                       S01435
     C                     MOVE SMAM      WFDIN                           S01435
     C                     Z-ADDSVSCDP    WDEC    10                      S01435
     C           13        SUB  SVSCDP    WDIG    20                      S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P5SMAM                          S01435
     C*                                                                   S01435
     C** CALL UATBCN TO ACCESS CURRENCY RECORD FOR PAY CURRENCY           S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   ZTABKY                          S01435
     C                     MOVEL'20'      ZTABKY                          S01435
     C                     MOVELPCCY      WA4                             S01435
     C                     MOVE '1'       WA4                             S01435
     C                     MOVE WA4       ZTABKY                          S01435
     C                     EXSR UATBCN                                    S01435
     C*                                                                   S01435
     C** CHECK IF DATABASE ERROR OCCURRED                                 S01435
     C*                                                                   S01435
     C           *IN89     IFEQ '1'                                       S01435
     C                     MOVEL'TABLE'   WBFILE                          S01435
     C                     MOVELZTABKY    WBKEY                           S01435
     C                     MOVEL'55'      WBASE                           S01435
     C                     EXSR ABORT                      *ABORT PGM*    S01435
     C                     END                                            S01435
     C*                                                                   S01435
     C** STORE NUMBER OF DECIMAL PLACES FOR PAY CURRENCY                  S01435
     C*                                                                   S01435
     C                     Z-ADDCDP       SVPCDP  10                      S01435
     C*                                                                   S01435
     C** FORMAT PAY AMOUNT                                                S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE PYAM      WFDIN                           S01435
     C                     Z-ADDSVPCDP    WDEC                            S01435
     C           13        SUB  SVPCDP    WDIG                            S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P5PYAM                          S01435
      *                                                                   CFT014
      ** Format Instructed amount considering the Instructed currency.    CFT014
      *                                                                   CFT014
     C                     MOVE *OFF      *IN40                           CFT014
     C           CEU006    IFEQ 'Y'                                       CFT014
     C           CFT014    OREQ 'Y'                                       CFT014
      *                                                                   CFT014
     C                     MOVE *BLANKS   P5PDAM                          CFT014
     C                     MOVE *BLANKS   P5PDCY                          CFT014
     C           PDAM      IFNE 0                                         CFT014
     C                     MOVE *ON       *IN40                           CFT014
     C                     CALL 'AOCURRR0'                                CFT014
     C                     PARM *BLANKS   WRTCD                           CFT014
     C                     PARM '*KEY   ' WOPTN                           CFT014
     C                     PARM PDCY      WCCY                            CFT014
     C           SDCURR    PARM SDCURR    DSSDY                           CFT014
     C           WRTCD     IFNE *BLANKS                                   CFT014
     C                     Z-ADD15        WBASE            ************   CFT014
     C                     MOVELPDCY      WBKEY            * DBERR015 *   CFT014
     C                     MOVEL'SDCURRPD'WBFILE           ************   CFT014
     C                     EXSR ABORT                                     CFT014
     C                     ENDIF                                          CFT014
     C                     Z-ADDA6NBDP    WPDNDP                          CFT014
      *                                                                   CFT014
     C                     MOVEL*BLANKS   WFDIN                           CFT014
     C                     MOVE PDAM      WFDIN                           CFT014
     C                     Z-ADDA6NBDP    WDEC                            CFT014
     C           13        SUB  A6NBDP    WDIG                            CFT014
     C                     EXSR UGFRMT                                    CFT014
     C                     MOVE PDCY      P5PDCY                          CFT014
     C                     MOVE WFDOUT    P5PDAM                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                                       CFT120
      ** Retrieve currency details                                                            CFT120
      *                                                                                       CFT120
     C           CFT120    IFEQ 'Y'                                                           CFT120
     C                     Z-ADD0         SVOCDP  10                                          CFT120
      *                                                                                       CFT120
     C           OPCDRC    IFNE *BLANKS                                                       CFT120
     C                     CALL 'AOCURRR0'                                                    CFT120
     C                     PARM *BLANKS   @RTCD                                               CFT120
     C                     PARM '*KEY   ' @OPTN                                               CFT120
     C                     PARM OPCDRC    @CURR                                               CFT120
     C           SDCURR    PARM SDCURR    DSSDY                                               CFT120
      *                                                                                       CFT120
     C           @RTCD     IFNE *BLANKS                                                       CFT120
     C                     MOVE 'SDCURRPD'WBFILE                                              CFT120
     C                     MOVELOPCDRC    WBKEY                                               CFT120
     C                     Z-ADD64        WBASE                                               CFT120
     C                     EXSR ABORT                                                         CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
     C                     Z-ADDA6NBDP    SVOCDP  10                                          CFT120
     C                     ENDIF                                                              CFT120
     C                     ENDIF                                                              CFT120
     C*                                                                   S01435
     C** FORMAT OTHER AMOUNTS & CURRENCIES                                S01435
     C** IF CHARGES TO DEBIT A/C FIELD IS NON-ZERO USE BASE CURRENCY;     S01435
     C** OTHERWISE IF PAY PLUS CHARGES INDICATOR IS 'Y' USE SETTLE CCY;   S01435
     C** OTHERWISE USE PAY CURRENCY                                       S01435
     C*                                                                   S01435
     C***********CDRO      IFNE *ZERO                                                  S01435 CSD027
     C           CDRO      IFNE *BLANKS                                                       CSD027
      *                                                                                       CFT120
     C                     MOVELBCCY      WCCY    3                       S01435
     C                     Z-ADDSVBCDP    WDEC                            S01435
     C           OPCDRC    IFNE *BLANKS                                                       CFT120
     C           CFT120    ANDEQ'Y'                                                           CFT120
     C                     MOVE OPCDRC    WCCY                                                CFT120
     C                     Z-ADDSVOCDP    WDEC                                                CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
     C/COPY WNCPYSRC,FT1000C009
     C                     ELSE                                           S01435
     C           ADDC      IFEQ 'A'                                       S01435
     C                     MOVELSMCY      WCCY                            S01435
     C                     Z-ADDSVSCDP    WDEC                            S01435
     C                     ELSE                                           S01435
     C                     MOVELPCCY      WCCY                            S01435
     C                     Z-ADDSVPCDP    WDEC                            S01435
     C                     END                                            S01435
     C                     END                                            S01435
      *                                                                   CFT014
     C           CFT003    IFEQ 'CFT003'                                  192300
     C           CFT014    OREQ 'Y'                                       192300
     C           CFT009    OREQ 'Y'                                       192300
      *                                                                   192300
     C           PREF      CHAINOTPAYXL0             79                   CFT014
      *                                                                   CFT014
     C                     Z-ADD0         P5OEXR                          CFT014
     C                     MOVE *BLANKS   P5BOCD                          CFT014
     C                     MOVE *BLANKS   P5TTCD                          CFT014
     C                     MOVE *BLANKS   P5TRDS                          CFT014
     C                     MOVE *BLANKS   P5ICD1                          CFT014
     C                     MOVE *BLANKS   P5ICD2                          CFT014
     C                     MOVE *BLANKS   P5ICD3                          CFT014
     C                     MOVE *BLANKS   P5ICD4                          CFT014
     C                     MOVE *BLANKS   P5ICD5                          CFT014
     C                     MOVE *BLANKS   P5RRP1                          CFT014
     C                     MOVE *BLANKS   P5RRP2                          CFT014
     C                     MOVE *BLANKS   P5RRP3                          CFT014
     C                     MOVE *BLANKS   P5RCRM                          CFT014
     C                     MOVE *BLANKS   P5SCH1                          CFT014
     C                     MOVE *BLANKS   P5SCH2                          CFT014
     C                     MOVE *BLANKS   P5SCH3                          CFT014
     C                     MOVE *BLANKS   P5SCH4                          CFT014
     C                     MOVE *BLANKS   P5SCH5                          CFT014
      *                                                                   CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
      *                                                                   CFT014
     C           *IN79     IFEQ *ON                                       CFT014
     C                     Z-ADD14        WBASE            ************   CFT014
     C                     MOVELPREF      WBKEY            * DBERR014 *   CFT014
     C                     MOVEL'OTPAYXL0'WBFILE           ************   CFT014
     C                     EXSR ABORT                                     CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     CALL 'AOCURRR0'                                CFT014
     C                     PARM *BLANKS   WRTCD                           CFT014
     C                     PARM '*KEY   ' WOPTN                           CFT014
     C                     PARM PCCY      WCCY                            CFT014
     C           SDCURR    PARM SDCURR    DSSDY                           CFT014
     C           WRTCD     IFNE *BLANKS                                   CFT014
     C                     Z-ADD13        WBASE            ************   CFT014
     C                     MOVELPCCY      WBKEY            * DBERR013 *   CFT014
     C                     MOVEL'SDCURRPD'WBFILE           ************   CFT014
     C                     EXSR ABORT                                     CFT014
     C                     ENDIF                                          CFT014
     C                     Z-ADDA6NBDP    WPYNDP                          CFT014
      *                                                                   CFT014
     C                     Z-ADDOPOEXR    P5OEXR                          CFT014
     C                     MOVELOPBOCD    P5BOCD                          CFT014
     C                     MOVELOPTTCD    P5TTCD                          CFT014
      ** Third Reimbursement Institution                                  CFT014
     C           OPTRI1    IFNE *BLANKS                                   CFT014
     C           OPTRI2    ORNE *BLANKS                                   CFT014
     C           OPTRI3    ORNE *BLANKS                                   CFT014
     C           OPTRI4    ORNE *BLANKS                                   CFT014
     C           OPTRI5    ORNE *BLANKS                                   CFT014
     C                     MOVEL'RCRT'    XCALL                           CFT014
     C                     MOVELOPTRIT    XTYPE                           CFT014
     C                     MOVELSMCY      XCCY                            CFT014
     C                     MOVELOPTRI1    P5TRI1                          CFT014
     C                     MOVELOPTRI2    P5TRI2                          CFT014
     C                     MOVELOPTRI3    P5TRI3                          CFT014
     C                     MOVELOPTRI4    P5TRI4                          CFT014
     C                     MOVELOPTRI5    P5TRI5                          CFT014
     C                     MOVELP5TRDS    XNAMDS                          CFT014
     C                     EXSR GETADD                                    CFT014
     C                     MOVELXNAMDS    P5TRDS                          CFT014
     C                     ENDIF                                          CFT014
      ** Instruction code                                                 CFT014
     C                     MOVELOPICD1    P5ICD1                          CFT014
     C                     MOVELOPICD2    P5ICD2                          CFT014
     C                     MOVELOPICD3    P5ICD3                          CFT014
     C                     MOVELOPICD4    P5ICD4                          CFT014
     C                     MOVELOPICD5    P5ICD5                          CFT014
      ** Regulatory reporting                                             CFT014
     C                     MOVELOPRRP1    P5RRP1                          CFT014
     C                     MOVELOPRRP2    P5RRP2                          CFT014
     C                     MOVELOPRRP3    P5RRP3                          CFT014
      ** Receiver's charges                                               CFT014
     C                     Z-ADDWPYNDP    WDEC                            CFT014
     C           11        SUB  WPYNDP    WDIG                            CFT014
     C           OPRCRM    IFNE 0                                         CFT014
     C                     MOVEL*BLANKS   WFDIN                           CFT014
     C                     MOVE OPRCRM    WFDIN                           CFT014
     C                     EXSR UGFRMT                                    CFT014
     C                     MOVE *BLANKS   WCHR15                          CFT014
     C                     MOVE WFDOUT    WCHR15                          CFT014
     C                     MOVELWCHR15    P5RCRM                          CFT014
     C                     MOVE PCCY      P5RCRM                          CFT014
     C                     ENDIF                                          CFT014
      ** Sender's charges                                                 CFT014
     C           OPSCH1    IFNE 0                                         CFT014
     C                     MOVEL*BLANKS   WFDIN                           CFT014
     C                     MOVE OPSCH1    WFDIN                           CFT014
     C                     EXSR UGFRMT                                    CFT014
     C                     MOVE *BLANKS   WCHR15                          CFT014
     C                     MOVE WFDOUT    WCHR15                          CFT014
     C                     MOVELWCHR15    P5SCH1                          CFT014
     C                     MOVE PCCY      P5SCH1                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           OPSCH2    IFNE 0                                         CFT014
     C                     MOVEL*BLANKS   WFDIN                           CFT014
     C                     MOVE OPSCH2    WFDIN                           CFT014
     C                     EXSR UGFRMT                                    CFT014
     C                     MOVE *BLANKS   WCHR15                          CFT014
     C                     MOVE WFDOUT    WCHR15                          CFT014
     C                     MOVELWCHR15    P5SCH2                          CFT014
     C                     MOVE PCCY      P5SCH2                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           OPSCH3    IFNE 0                                         CFT014
     C                     MOVEL*BLANKS   WFDIN                           CFT014
     C                     MOVE OPSCH3    WFDIN                           CFT014
     C                     EXSR UGFRMT                                    CFT014
     C                     MOVE *BLANKS   WCHR15                          CFT014
     C                     MOVE WFDOUT    WCHR15                          CFT014
     C                     MOVELWCHR15    P5SCH3                          CFT014
     C                     MOVE PCCY      P5SCH3                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           OPSCH4    IFNE 0                                         CFT014
     C                     MOVEL*BLANKS   WFDIN                           CFT014
     C                     MOVE OPSCH4    WFDIN                           CFT014
     C                     EXSR UGFRMT                                    CFT014
     C                     MOVE *BLANKS   WCHR15                          CFT014
     C                     MOVE WFDOUT    WCHR15                          CFT014
     C                     MOVELWCHR15    P5SCH4                          CFT014
     C                     MOVE PCCY      P5SCH4                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           OPSCH5    IFNE 0                                         CFT014
     C                     MOVEL*BLANKS   WFDIN                           CFT014
     C                     MOVE OPSCH5    WFDIN                           CFT014
     C                     EXSR UGFRMT                                    CFT014
     C                     MOVE *BLANKS   WCHR15                          CFT014
     C                     MOVE WFDOUT    WCHR15                          CFT014
     C                     MOVELWCHR15    P5SCH5                          CFT014
     C                     MOVE PCCY      P5SCH5                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           OPSCH1    IFEQ 0                                         CFT014
     C           OPSCH2    ANDEQ0                                         CFT014
     C           OPSCH3    ANDEQ0                                         CFT014
     C           OPSCH4    ANDEQ0                                         CFT014
     C           OPSCH5    ANDEQ0                                         CFT014
     C           DTCH      ANDEQ'BEN'                                     CFT014
     C                     MOVEL*BLANKS   WFDIN                           CFT014
     C                     MOVE *ZERO     WFDIN                           CFT014
     C                     EXSR UGFRMT                                    CFT014
     C                     MOVE *BLANKS   WCHR15                          CFT014
     C                     MOVE WFDOUT    WCHR15                          CFT014
     C                     MOVELWCHR15    P5SCH1                          CFT014
     C                     MOVE PCCY      P5SCH1                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           *IN79     IFEQ *OFF                                      CFT014
     C                     DELETOTPAYXDF                                  CFT014
     C                     ENDIF                                          CFT014
     C*                                                                   S01435
     C                     ENDIF                                          192300
      *                                                                   192300
     C           11        SUB  WDEC      WDIG                            S01435
      *                                                                   CFT009
      ** Only set up charges if switchable feature CFT009                 CFT009
      ** is switched on.                                                  CFT009
      *                                                                   CFT009
     C           CFT009    IFNE 'Y'                                       CFT009
     C*                                                                   S01435
     C** SETUP CURRENCY NAMES                                             S01435
     C*                                                                   S01435
     C                     MOVELWCCY      P5TRCY                          S01435
     C                     MOVELWCCY      P5TXCY                          S01435
     C                     MOVELWCCY      P5CQCY                          S01435
     C                     MOVELWCCY      P5SPCY                          S01435
     C                     MOVELWCCY      P5CSCY                          S01435
     C                     MOVELWCCY      P5MSCY                          S01435
     C*                                                                   S01494
     C** Check if SAR S01494 is set on                                    S01494
     C*                                                                   S01494
     C           *IN28     IFEQ '1'                                       S01494
     C                     MOVELWCCY      P5CHCY                          S01494
     C                     END                                            S01494
     C*                                                                   S01499
     C** Check if SAR S01499 is set on                                    S01499
     C*                                                                   S01499
     C           *IN29     IFEQ '1'                                       S01499
     C*                                                                   S01499
     C                     MOVELWCCY      P5VTCY                          S01499
     C*                                                                   S01499
     C** Set up VAT flags for report                                      S01499
     C*                                                                   S01499
     C                     MOVE OPVAT1    P5TRVF                          S01499
     C                     MOVE OPVAT2    P5TXVF                          S01499
     C                     MOVE OPVAT3    P5CQVF                          S01499
     C                     MOVE OPVAT4    P5CSVF                          S01499
     C                     MOVE OPVAT5    P5SPVF                          S01499
     C                     MOVE OPVAT6    P5MSVF                          S01499
     C           *IN28     IFEQ '1'                                       S01499
     C                     MOVE OPVAT7    P5CHVF                          S01499
     C                     END                                            S01499
     C*                                                                   S01499
     C                     END                                            S01499
     C*                                                                   S01435
     C** FORMAT TRANSFER COMMISSION AMOUNT                                S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE TRCM      WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P5TRCM                          S01435
     C*                                                                   S01435
     C** FORMAT TELEX CHARGE AMOUNT                                       S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE TXCH      WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P5TXCH                          S01435
     C*                                                                   S01435
     C** FORMAT CHEQUE CHARGE AMOUNT                                      S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE CQCH      WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P5CQCH                          S01435
     C*                                                                   S01435
     C** FORMAT SWIFT PR CHARGE AMOUNT                                    S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE SPCH      WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P5SPCH                          S01435
     C*                                                                   S01435
     C** FORMAT COSTS ABROAD CHARGE AMOUNT                                S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE CSTA      WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P5CSTA                          S01435
     C*                                                                   S01435
     C** FORMAT MISCELLANEOUS CHARGE AMOUNT                               S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE MSCH      WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P5MSCH                          S01435
     C*                                                                   S01494
     C** Check if SAR S01494 is set on                                    S01494
     C*                                                                   S01494
     C           *IN28     IFEQ '1'                                       S01494
     C*                                                                   S01494
     C** Format FX/Change Commission                                      S01494
     C*                                                                   S01494
     C                     MOVEL*BLANKS   WFDIN                           S01494
     C                     MOVE OPCHCM    WFDIN                           S01494
     C                     EXSR UGFRMT                                    S01494
     C                     MOVE WFDOUT    P5CHCM                          S01494
     C*                                                                   S01494
     C                     END                                            S01494
     C*                                                                   S01499
     C** Check if SAR S01499 is set on                                    S01499
     C*                                                                   S01499
     C           *IN29     IFEQ '1'                                       S01499
     C*                                                                   S01499
     C** Format V.A.T. Charge                                             S01499
     C*                                                                   S01499
     C                     MOVEL*BLANKS   WFDIN                           S01499
     C                     MOVE OPVATT    WFDIN                           S01499
     C                     EXSR UGFRMT                                    S01499
     C                     MOVE WFDOUT    P5VATT                          S01499
     C*                                                                   S01499
     C                     END                                            S01499
      *                                                                   CFT009
     C                     ELSE                                           CFT009
      *                                                                   CFT009
      ** Calculate and format new and existing charges                    CFT009
      *                                                                   CFT009
     C                     EXSR CALCG5                                    CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C*                                                                   S01435
     C** FORMAT DATE FIELDS USING SYSTEM ROUTINE ZDATE2                   S01435
     C*                                                                   S01435
     C** SETTLE VALUE DATE                                                S01435
     C*                                                                   S01435
     C                     Z-ADDSLDT      ZDAYNO                          S01435
     C                     EXSR ZDATE2                                    S01435
     C                     MOVELZADATE    P5SLDT                          S01435
     C*                                                                   S01435
     C** PAY VALUE DATE                                                   S01435
     C*                                                                   S01435
     C                     Z-ADDPVDT      ZDAYNO                          S01435
     C                     EXSR ZDATE2                                    S01435
     C                     MOVELZADATE    P5PYDT                          S01435
     C*                                                                   S01435
     C** FINAL DATE                                                       S01435
     C*                                                                   S01435
     C                     Z-ADDFDAT      ZDAYNO                          S01435
     C                     EXSR ZDATE2                                    S01435
     C                     MOVELZADATE    P5FDAT                          S01435
     C*                                                                   S01435
     C                     Z-ADDNPDT      ZDAYNO                          S01435
     C                     EXSR ZDATE2                                    S01435
     C                     MOVELZADATE    P5NPDT                          S01435
     C*                                                                   S01435
     C** SET UP USER FIELDS FROM MUSERDD,IF AUDIT                         S01435
     C*                                                                   S01435
     C                     SETOF                     50                   S01435
     C*                                                                   S01435
     C           INUSR1    IFNE *BLANKS                                   S01435
     C                     MOVE INUSR1    USRP                            S01435
     C                     EXSR UCMUSE                                    S01435
     C                     MOVE USER1     SIUSR1 25                       S01435
     C                     ELSE                                           S01435
     C                     MOVE *BLANKS   SIUSR1                          S01435
     C                     END                                            S01435
      *                                                                   S01435
     C           INUSR2    IFNE *BLANKS                                   S01435
     C                     MOVE INUSR2    USRP                            S01435
     C                     EXSR UCMUSE                                    S01435
     C                     MOVE USER1     SIUSR2 25                       S01435
     C                     ELSE                                           S01435
     C                     MOVE *BLANKS   SIUSR2                          S01435
     C                     END                                            S01435
      *                                                                   S01435
     C           AUP1      IFNE *BLANKS                                   S01435
     C                     MOVE AUP1      USRP                            S01435
     C                     EXSR UCMUSE                                    S01435
     C                     MOVE USER1     SAUP1  25                       S01435
     C                     ELSE                                           S01435
     C                     MOVE *BLANKS   SAUP1                           S01435
     C                     END                                            S01435
      *                                                                   S01435
     C           AUP2      IFNE *BLANKS                                   S01435
     C                     MOVE AUP2      USRP                            S01435
     C                     EXSR UCMUSE                                    S01435
     C                     MOVE USER1     SAUP2  25                       S01435
     C                     ELSE                                           S01435
     C                     MOVE *BLANKS   SAUP2                           S01435
     C                     END                                            S01435
      *                                                                   S01435
     C** SETUP REMAINING REPORT FIELDS                                    S01435
     C*                                                                   S01435
      *                                                                   CFT009
      ** Chain to payment charge defintion file to get miscellaneous      CFT009
      ** charge code narratives.                                          CFT009
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
     C           MSCHC1    CHAINFTPCHGL0             90                   CFT009
     C           *IN90     IFEQ '0'                                       CFT009
     C                     MOVELCHDESC    P5M1DC    P                     CFT009
     C                     ELSE                                           CFT009
     C                     MOVELDESC,1    P5M1DC    P                     CFT009
     C                     ENDIF                                          CFT009
     C           MSCHC2    CHAINFTPCHGL0             90                   CFT009
     C           *IN90     IFEQ '0'                                       CFT009
     C                     MOVELCHDESC    P5M2DC    P                     CFT009
     C                     ELSE                                           CFT009
     C                     MOVELDESC,2    P5M2DC    P                     CFT009
     C                     ENDIF                                          CFT009
     C           MSCHC3    CHAINFTPCHGL0             90                   CFT009
     C           *IN90     IFEQ '0'                                       CFT009
     C                     MOVELCHDESC    P5M3DC    P                     CFT009
     C                     ELSE                                           CFT009
     C                     MOVELDESC,3    P5M3DC    P                     CFT009
     C                     ENDIF                                          CFT009
     C           MSCHC4    CHAINFTPCHGL0             90                   CFT009
     C           *IN90     IFEQ '0'                                       CFT009
     C                     MOVELCHDESC    P5M4DC    P                     CFT009
     C                     ELSE                                           CFT009
     C                     MOVELDESC,4    P5M4DC    P                     CFT009
     C                     ENDIF                                          CFT009
     C           MSCHC5    CHAINFTPCHGL0             90                   CFT009
     C           *IN90     IFEQ '0'                                       CFT009
     C                     MOVELCHDESC    P5M5DC    P                     CFT009
     C                     ELSE                                           CFT009
     C                     MOVELDESC,5    P5M5DC    P                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVELPREF      P5PREF                          S01435
     C                     MOVELPYTP      P5PYTP                          S01435
     C                     MOVELPYST      P5PYST                          S01435
     C                     MOVELSMCY      P5SMCY                          S01435
     C                     Z-ADDRATE      P5RATE                          S01435
     C                     MOVELPCCY      P5PCCY                          S01435
     C                     MOVELBBI1      P5BBI1                          S01435
     C                     MOVELBBI2      P5BBI2                          S01435
     C                     MOVELBBI3      P5BBI3                          S01435
     C                     MOVELBBI4      P5BBI4                          S01435
     C                     MOVELBBI5      P5BBI5                          S01435
     C                     MOVELBBI6      P5BBI6                          S01435
     C                     MOVELDTP1      P5DTP1                          S01435
     C                     MOVELDTP2      P5DTP2                          S01435
     C                     MOVELDTP3      P5DTP3                          S01435
     C                     MOVELDTP4      P5DTP4                          S01435
     C                     MOVELSTMT      P5STTP                          S01435
     C/COPY WNCPYSRC,FT1000C021
     C           DNBC      IFEQ *ZERO                                     S01435
     C/COPY WNCPYSRC,FT1000C022
     C                     MOVE *BLANKS   P5DNBC                          S01435
     C                     ELSE                                           S01435
     C                     MOVELDNBC      P5DNBC                          S01435
     C                     END                                            S01435
     C                     MOVELSNMT      P5SNMT                          S01435
     C                     MOVELADDC      P5ADDC                          S01435
     C                     MOVELRPAY      P5RPAY                          S01435
     C                     MOVELPAYF      P5PAYF                          S01435
     C                     MOVELDYIM      P5DYIM                          S01435
     C                     MOVELDTCH      P5DTCH                          S01435
     C                     MOVELTRCT      P5TRCT                          S01435
     C           SWPC      IFEQ 1                          B001           S01435
     C                     MOVE 'U'       P5SWPC                          S01435
     C                     ELSE                            X001           S01435
     C           SWPC      IFEQ 2                          B002           S01435
     C                     MOVE 'N'       P5SWPC                          S01435
     C                     END                             E002           S01435
     C                     END                             E001           S01435
     C*                                                                   S01435
     C** OUPUT OVERRIDE IF 'Y'                                            S01435
     C*                                                                   S01435
     C                     MOVE *BLANKS   P5OVRD                          S01435
     C           OVRD      IFEQ 'Y'                                       S01435
     C                     MOVE 'YES'     P5OVRD                          S01435
     C                     ELSE                                           S01435
     C                     MOVE 'NO '     P5OVRD                          S01435
     C                     END                                            S01435
      *                                                                   S01435
     C           OXPREF    IFNE *BLANKS                                   S01435
     C                     SETON                     51                   S01435
     C                     ELSE                                           S01435
     C                     SETOF                     51                   S01435
     C                     END                                            S01435
      *                                                                   S01435
     ****The following lines were added to transfer data to printer****   S01435
     C                     MOVE RLPR      P5RLPR                          S01435
     C           CHAP      IFEQ *ZERO                                     S01435
     C                     MOVE *BLANKS   P5CHAP                          S01435
     C                     ELSE                                           S01435
     C                     MOVELCHAP      P5CHAP                          S01435
     C                     END                                            S01435
     C*                                                                   S01435
     C** MT100 customer                                                   S01435
     C*                                                                   S01435
     C           ODMT      IFEQ *BLANK                     B001           S01435
     C           ODMT      OREQ *ZERO                                     S01435
     C                     MOVE *BLANK    P5ODMT                          S01435
     C                     MOVE *BLANK    P5ODMC                          S01435
     C                     ELSE                            X001           S01435
      *                                                                                       CFT032
      ** Destination type is a full nostro 'F'                                                CFT032
      *                                                                                       CFT032
     C           ODMTT     IFEQ 'F'                                                           CFT032
     C           3         SUBSTODMT:1    PKEYB                                               CFT032
     C           2         SUBSTODMT:4    PKEYE                                               CFT032
      *                                                                                       CFT032
     C                     CALL 'AONOSTR0'                                                    CFT032
     C                     PARM *BLANK    PRTCD   7                                           CFT032
     C                     PARM '*KEY   ' POPTN   7                                           CFT032
     C                     PARM *BLANK    PKEYA   6                                           CFT032
     C                     PARM           PKEYB   3                                           CFT032
     C                     PARM *BLANK    PKEYC  10                                           CFT032
     C                     PARM *BLANK    PKEYD   2                                           CFT032
     C                     PARM           PKEYE   2                                           CFT032
     C                     PARM *BLANKS   PKEYG   3                                           CFT032
     C                     PARM *BLANKS   PKEYH  10                                           CFT032
     C                     PARM *BLANKS   PKEYI   1                                           CFT032
     C           SDNOST    PARM SDNOST    DSFDY                                               CFT032
      *                                                                                       CFT032
     C           PRTCD     IFNE *BLANKS                                                       CFT032
     C                     MOVEL'SDNOSTPD'WBFILE                                              CFT032
     C                     MOVELPKEYA     WBKEY                                               CFT032
     C                     Z-ADD47        WBASE                                               CFT032
     C                     EXSR ABORT                                                         CFT032
     C                     ENDIF                                                              CFT032
     C                     MOVELA7CUST    W0CNUM  6                                           CFT032
     C                     ENDIF                                                              CFT032
      *                                                                                       CFT032
      ** Destination type is a 'I'                                                            CFT032
      *                                                                                       CFT032
     C           ODMTT     IFEQ 'I'                                                           CFT032
     C                     MOVELODMT      P@IBN                                               CFT032
     C                     MOVE *BLANKS   DSSDY                                               CFT032
      *                                                                                       CFT032
     C                     CALL 'AOIBANR4'                                                    CFT032
     C                     PARM           PRTCD                                               CFT032
     C                     PARM '*KEY   ' POPTN                                               CFT032
     C                     PARM           P@IBN  34                                           CFT032
     C           WACCN     PARM           DSSDY                                               CFT032
      *                                                                                       CFT032
     C           @RTCD     IFNE *BLANKS                                                       CFT032
     C                     MOVEL'ACCNTL6' WBFILE                                              CFT032
     C                     MOVELP@IBN     WBKEY                                               CFT032
     C                     Z-ADD48        WBASE                                               CFT032
     C                     EXSR ABORT                                                         CFT032
     C                     ENDIF                                                              CFT032
     C                     MOVE WWCNUM    W0CNUM                                              CFT032
     C                     ENDIF                                                              CFT032
      *                                                                                       CFT032
      ** Destination type is a GL Account 'G'                                                 CFT032
      *                                                                                       CFT032
     C           ODMTT     IFEQ 'G'                                                           CFT032
     C           24        SUBSTODMT:1    WCDET                                               CFT032
     C                     MOVEL*BLANKS   PRETL  10                                           CFT032
     C                     MOVELWDCNUM    PCNNM   6                                           CFT032
     C                     MOVELWDCCY     PCUCD   3                                           CFT032
     C                     MOVELWDACOD    PACCD                                               CFT032
     C                     MOVELWDACSQ    PACSQ   2                                           CFT032
     C           MBIN      IFEQ 'Y'                                                           CFT032
     C                     MOVE WDBRCA    PBRCD   3                                           CFT032
     C                     ELSE                                                               CFT032
     C                     MOVE BJSBRC    PBRCD                                               CFT032
     C                     ENDIF                                                              CFT032
      *                                                                                       CFT032
     C                     CALL 'AOACCTR0'                                                    CFT032
     C                     PARM *BLANKS   PRTCD   7                                           CFT032
     C                     PARM '*KEY'    POPTN   7                                           CFT032
     C                     PARM           PRETL  10                                           CFT032
     C                     PARM           PCNNM   6                                           CFT032
     C                     PARM           PCUCD   3                                           CFT032
     C                     PARM           PACCD  10                                           CFT032
     C                     PARM           PACSQ   2                                           CFT032
     C                     PARM           PBRCD   3                                           CFT032
     C           SDACCT    PARM SDACCT    DSSDY                                               CFT032
      *                                                                                       CFT032
     C           PRTCD     IFNE *BLANKS                                                       CFT032
     C                     MOVEL'ACCNTAB' WBFILE                                              CFT032
     C                     MOVELPCNNM     WBKEY                                               CFT032
     C                     Z-ADD49        WBASE                                               CFT032
     C                     EXSR ABORT                                                         CFT032
     C                     ENDIF                                                              CFT032
     C                     MOVE CNUM      W0CNUM                                              CFT032
     C                     ENDIF                                                              CFT032
      *                                                                                       CFT032
      ** Destination type is a 'S'                                                            CFT032
      *                                                                                       CFT032
     C           ODMTT     IFEQ 'S'                                                           CFT032
     C           8         SUBSTODMT:1    W9BICC  8                                           CFT032
     C           3         SUBSTODMT:9    W9BICB  3                                           CFT032
      *                                                                                       CFT032
     C                     CALL 'ME1400'               9090                                   CFT032
     C                     PARM *BLANKS   W9RTN   7                                           CFT032
     C                     PARM           W9BICC                                              CFT032
     C                     PARM           W9BICB                                              CFT032
     C                     PARM           SDCUST                                              CFT032
     C                     PARM           SDCNST                                              CFT032
     C                     PARM           MEBICD                                              CFT032
     C                     PARM *BLANKS   W9CUST  1                                           CFT032
     C                     PARM *BLANKS   W9CNST  1                                           CFT032
     C                     PARM *BLANKS   W9BICD  1                                           CFT032
      *                                                                                       CFT032
     C           W9CUST    IFNE 'Y'                                                           CFT032
     C           W9BICD    ANDNE'Y'                                                           CFT032
     C                     MOVEL'ME1400 ' WBFILE                                              CFT032
     C                     MOVEL'*CALL   'WBKEY                                               CFT032
     C                     Z-ADD50        WBASE                                               CFT032
     C                     EXSR ABORT                                                         CFT032
     C                     ELSE                                                               CFT032
     C                     MOVE BBCUST    W0CNUM                                              CFT032
     C                     MOVELODMT      P5ODMT                                              CFT032
     C                     MOVELBDINS1    P5ODMC                                              CFT032
     C                     ENDIF                                                              CFT032
     C                     ENDIF                                                              CFT032
      *                                                                                       CFT032
      ** Destination type is a Customer Number 'C'                                            CFT032
      *                                                                                       CFT032
     C           ODMTT     IFEQ 'C'                                                           CFT032
     C                     MOVELODMT      W0CNUM                                              CFT032
     C                     ENDIF                                                              CFT032
      *                                                                                       CSW207
      ** Non Account Holder Reference                                                         CSW207
      *                                                                                       CSW207
     C           ODMTT     IFEQ 'O'                                                           CSW207
     C           CSW207    ANDEQ'Y'                                                           CSW207
     C                     CALL 'AONAHOR0'                                                    CSW207
     C                     PARM *BLANKS   @RTCD   7                                           CSW207
     C                     PARM '*KEY   ' @OPTN   7                                           CSW207
     C                     PARM ODMT      @NAHO  10                                           CSW207
     C********** SDNAHO    PARM SDNAHO    DSSDY                                      CSW207 BUG24029
     C           SDNAHO    PARM SDNAHO    DSLDY                                             BUG24029
     C           @RTCD     IFNE *BLANKS                                                       CSW207
     C                     Z-ADD35        WBASE                                               CSW207
     C                     MOVELODMT      WBKEY                                               CSW207
     C                     MOVEL'SDNAHOPD'WBFILE                                              CSW207
     C                     EXSR ABORT                                                         CSW207
     C                     ENDIF                                                              CSW207
     C                     ENDIF                                                              CSW207
      *                                                                                       CSW207
      *                                                                                       CFT032
     C**********           MOVELODMT      WCLNUM                                       S01435 CFT032
     C           ODMTT     IFNE 'O'                                                           CSW207
     C                     MOVELW0CNUM    WCLNUM                                              CFT032
     C                     MOVEL'B'       WCLRCT                          S01435
     C                     EXSR UCCLCN                                    S01435
     C*                                                                   S01435
     C           *IN89     IFEQ '1'                        B002           S01435
     C                     MOVEL'CLINT'   WBFILE                          S01435
     C                     MOVELWCLNUM    WA7              *************  S01435
     C                     MOVE WCLRCT    WA7              * DATA BASE *  S01435
     C                     MOVELWA7       WBKEY            * ERROR 19  *  S01435
     C                     MOVEL'61'      WBASE            *************  S01435
     C                     EXSR ABORT                      *ABORT PGM*    S01435
     C                     END                             E002           S01435
     C*                                                                   S01435
     C                     MOVELWA7       WA7     7                       S01435
     C                     MOVELODMT      P5ODMT                          S01435
     C                     MOVELCNA1      P5ODMC                          S01435
     C                     ELSE                                                               CSW207
     C                     MOVELODMT      P5ODMT                                              CSW207
     C                     MOVELNHCNA1    P5ODMC                                              CSW207
     C                     ENDIF                                                              CSW207
     C                     END                             E001           S01435
     C*                                                                   S01435
      *                                                                   S01435
      * Format Entered Currency                                           S01435
      *                                                                   S01435
     C                     SELEC                                          S01435
      *                                                                   S01435
     C***********CDRO      WHNE *ZERO                                                  S01435 CSD027
     C           CDRO      WHNE *BLANKS                                                       CSD027
     C           BTCHCY    OREQ 'B'                                       103513
     C           CFT120    ANDNE'Y'                                                           CFT120
      *                                                                                       CFT120
     C                     MOVELBCCY      WCCY                            S01435
     C                     Z-ADDSVBCDP    WDEC                            S01435
     C           OPCDRC    IFNE *BLANKS                                                       CFT120
     C           CFT120    ANDEQ'Y'                                                           CFT120
     C                     MOVELOPCDRC    WCCY                                                CFT120
     C                     Z-ADDSVOCDP    WDEC                                                CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
     C           BTCHCY    WHEQ 'B'                                                           CFT120
     C           CFT120    ANDEQ'Y'                                                           CFT120
     C                     MOVELBCCY      WCCY                                                CFT120
     C                     Z-ADDSVBCDP    WDEC                                                CFT120
      *                                                                                       CFT120
     C/COPY WNCPYSRC,FT1000C010
      *                                                                   S01435
     C           BTCHCY    WHEQ 'L'                                       S01435
     C                     MOVELLOCY      WCCY                            S01435
     C                     Z-ADDSVLCDP    WDEC                            S01435
      *                                                                   S01435
     C           BTCHCY    WHEQ 'C'                                       S01435
     C           ADDC      ANDEQ'A'                                       S01435
     C                     MOVELSMCY      WCCY                            S01435
     C                     Z-ADDSVSCDP    WDEC                            S01435
      *                                                                   S01435
     C                     OTHER                                          S01435
     C                     MOVELPCCY      WCCY                            S01435
     C                     Z-ADDSVPCDP    WDEC                            S01435
     C                     ENDSL                                          S01435
      *                                                                   CFT009
      ** Only calculate entered charges if switchable feature CFT009      CFT009
      ** is off                                                           CFT009
      *                                                                   CFT009
     C           CFT009    IFNE 'Y'                                       CFT009
      *                                                                   CFT009
      *                                                                   S01435
     C                     MOVELWCCY      P5TREC                          S01435
     C                     MOVELWCCY      P5TXEC                          S01435
     C                     MOVELWCCY      P5CQEC                          S01435
     C                     MOVELWCCY      P5CSEC                          S01435
     C                     MOVELWCCY      P5SPEC                          S01435
     C                     MOVELWCCY      P5MSEC                          S01435
     C*                                                                   S01494
     C** Check if SAR S01494 is set on                                    S01494
     C*                                                                   S01494
     C           *IN28     IFEQ '1'                                       S01494
     C                     MOVELWCCY      P5CHEC                          S01494
     C                     END                                            S01494
     C*                                                                   S01499
     C** Check if SAR S01499 is set on                                    S01499
     C*                                                                   S01499
     C           *IN29     IFEQ '1'                                       S01499
     C                     MOVELWCCY      P5VTEC                          S01499
     C                     END                                            S01499
      *                                                                   S01435
      *  Format Entered Amounts                                           S01435
      *                                                                   S01435
     C           11        SUB  WDEC      WDIG                            S01435
      *                                                                   S01435
      ** Format Transfer Commission Amount                                S01435
      *                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE DUMA1     WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P5TREA                          S01435
      *                                                                   S01435
      ** Format Telex Charge Amount                                       S01435
      *                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE DUMA2     WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P5TXEA                          S01435
      *                                                                   S01435
      ** Format Cheque Charge Amount                                      S01435
      *                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE DUMA3     WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P5CQEA                          S01435
     C*                                                                   S01435
     C** Format Telephone Charge Amount                                   S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE DUMA4     WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P5CSEA                          S01435
     C*                                                                   S01435
     C** Format Advice Charge Amount                                      S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE DUMA5     WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P5SPEA                          S01435
     C*                                                                   S01435
     C** Format Miscellaneous Charge Amount                               S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE DUMA6     WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P5MSEA                          S01435
     C*                                                                   S01494
     C** Check if SAR S01494 is set on                                    S01494
     C*                                                                   S01494
     C           *IN28     IFEQ '1'                                       S01494
     C*                                                                   S01494
     C** Format FX/Change Commission                                      S01494
     C*                                                                   S01494
     C                     MOVEL*BLANKS   WFDIN                           S01494
     C                     MOVE OPDUM7    WFDIN                           S01494
     C                     EXSR UGFRMT                                    S01494
     C                     MOVE WFDOUT    P5CHEA                          S01494
     C*                                                                   S01494
     C                     END                                            S01494
     C*                                                                   S01499
     C** Check if SAR S01499 is set on                                    S01499
     C*                                                                   S01499
     C           *IN29     IFEQ '1'                                       S01499
     C*                                                                   S01499
     C** Format V.A.T. Charge                                             S01499
     C*                                                                   S01499
     C                     MOVEL*BLANKS   WFDIN                           S01499
     C                     MOVE OPDUM8    WFDIN                           S01499
     C                     EXSR UGFRMT                                    S01499
     C                     MOVE WFDOUT    P5VAEA                          S01499
     C*                                                                   S01499
     C                     END                                            S01499
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   S01435
      * Translate input Sender's Correspondent                            S01435
      *                                                                   S01435
     C                     MOVEL'SNCT'    XCALL                           S01435
     C                     MOVELSNCT      XTYPE                           S01435
     C                     MOVELPCCY      XCCY                            S01435
     C                     MOVEL*BLANKS   XNAMDS                          S01435
     C                     MOVELSNCO      XNAMDS                          S01435
     C                     EXSR GETADD                                    S01435
     C                     MOVELXNAMDS    P5SNCO                          S01435
     C                     MOVELXADDS     P5SNDS                          S01435
     C*                                                                   S01435
     C                     MOVE CDRT      PRMTYP           ( CDRO )       S01435
     C                     MOVE *ZEROS    PRMFLD                          S01435
     C                     MOVELCDRO      PRMFLD                          S01435
     C           MBIN      IFEQ 'Y'                                       S01435
     C           CDRT      IFEQ 'P'                                       S01435
     C                     MOVELCDBR      P5CDBR                          S01435
     C                     ELSE                                           S01435
     C                     MOVE *BLANKS   P5CDBR                          S01435
     C                     END                                            S01435
     C                     END                                            S01435
     C                     EXSR CHOPF                                     S01435
     C                     MOVELPRMFLD    P5CDRO                          S01435
     C           CFT120    IFEQ 'Y'                                                           CFT120
     C                     MOVELOPCDRC    P5CDRC                                              CFT120
     C                     ENDIF                                                              CFT120
     C/COPY WNCPYSRC,FT1000C011
      *                                                                                       CSW209
      **  Cover Message Information for Outgoing Payments                                     CSW209
      *                                                                                       CSW209
     C           CSW209    IFEQ 'Y'                                                           CSW209
     C                     MOVELOPNWRK    P5NWRK                                              CSW209
     C                     MOVELOPMTPY    P5MTPY                                              CSW209
     C                     MOVELOPVALF    P5VALF                                              CSW209
     C                     MOVELOPOMVF    P5OMVF                                              CSW209
     C                     MOVELOPOCVF    P5OCVF                                              CSW209
     C                     MOVELOPCOC1    P5COC1                                              CSW209
     C                     MOVELOPCOC2    P5COC2                                              CSW209
     C                     MOVELOPCOC3    P5COC3                                              CSW209
     C                     MOVELOPCOC4    P5COC4                                              CSW209
     C                     MOVELOPCOC5    P5COC5                                              CSW209
     C                     MOVELOPCOB1    P5COB1                                              CSW209
     C                     MOVELOPCOB2    P5COB2                                              CSW209
     C                     MOVELOPCOB3    P5COB3                                              CSW209
     C                     MOVELOPCOB4    P5COB4                                              CSW209
     C                     MOVELOPCOB5    P5COB5                                              CSW209
     C                     MOVELOPCIB1    P5CIB1                                              CSW209
     C                     MOVELOPCIB2    P5CIB2                                              CSW209
     C                     MOVELOPCIB3    P5CIB3                                              CSW209
     C                     MOVELOPCIB4    P5CIB4                                              CSW209
     C                     MOVELOPCIB5    P5CIB5                                              CSW209
     C                     MOVELOPCAB1    P5CAB1                                              CSW209
     C                     MOVELOPCAB2    P5CAB2                                              CSW209
     C                     MOVELOPCAB3    P5CAB3                                              CSW209
     C                     MOVELOPCAB4    P5CAB4                                              CSW209
     C                     MOVELOPCAB5    P5CAB5                                              CSW209
     C                     MOVELOPCBC1    P5CBC1                                              CSW209
     C                     MOVELOPCBC2    P5CBC2                                              CSW209
     C                     MOVELOPCBC3    P5CBC3                                              CSW209
     C                     MOVELOPCBC4    P5CBC4                                              CSW209
     C                     MOVELOPCBC5    P5CBC5                                              CSW209
     C                     MOVELOPCICY    P5CICY                                              CSW209
     C                     MOVEL*BLANKS   P5CIAM                                              CSW209
      *                                                                                       CSW209
      ** Access AOCURRR0 to get the currency's decimal places                                 CSW209
      *                                                                                       CSW209
     C           OPCICY    IFNE *BLANKS                                                       CSW209
      *                                                                                       CSW209
     C                     CALL 'AOCURRR0'                                                    CSW209
     C                     PARM *BLANKS   WRTCD                                               CSW209
     C                     PARM '*KEY   ' WOPTN                                               CSW209
     C                     PARM           OPCICY                                              CSW209
     C           SDCURR    PARM SDCURR    DSSDY                                               CSW209
     C           WRTCD     IFNE *BLANKS                                                       CSW209
     C                     Z-ADD32        WBASE                                               CSW209
     C                     MOVELOPCICY    WBKEY                                               CSW209
     C                     MOVEL'SDCURRPD'WBFILE                                              CSW209
     C                     EXSR ABORT                                                         CSW209
     C                     ENDIF                                                              CSW209
     C                     Z-ADDA6NBDP    W5CIAM  10                                          CSW209
      *                                                                                       CSW209
      ** Format Instructed Currency Amount                                                    CSW209
      *                                                                                       CSW209
     C                     MOVEL*BLANKS   WFDIN                                               CSW209
     C                     MOVE OPCIAM    WFDIN                                               CSW209
     C                     Z-ADDW5CIAM    WDEC                                                CSW209
     C           13        SUB  W5CIAM    WDIG                                                CSW209
     C                     EXSR UGFRMT                                                        CSW209
     C                     MOVE WFDOUT    P5CIAM                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     MOVELOPOCB1    P5OCB1                                              CSW209
     C                     MOVELOPOCB2    P5OCB2                                              CSW209
     C                     MOVELOPOCB3    P5OCB3                                              CSW209
     C                     MOVELOPOCB4    P5OCB4                                              CSW209
     C                     MOVELOPOCB5    P5OCB5                                              CSW209
     C                     MOVELOPOCB6    P5OCB6                                              CSW209
     C                     MOVELOPCBB1    P5CBB1                                              CSW209
     C                     MOVELOPCBB2    P5CBB2                                              CSW209
     C                     MOVELOPCBB3    P5CBB3                                              CSW209
     C                     MOVELOPCBB4    P5CBB4                                              CSW209
     C                     MOVELOPCBB5    P5CBB5                                              CSW209
     C                     MOVELOPCBB6    P5CBB6                                              CSW209
     C                     MOVELOPCDP1    P5CDP1                                              CSW209
     C                     MOVELOPCDP2    P5CDP2                                              CSW209
     C                     MOVELOPCDP3    P5CDP3                                              CSW209
     C                     MOVELOPCDP4    P5CDP4                                              CSW209
     C                     ENDIF                                                              CSW209
      *********                                                           S01435
     C*
     C** OUTPUT PAGE TO REPORT
     C*
     C                     ADD  1         P5PAGE
      *                                                                                       CER030
     C           CER030    IFEQ 'Y'                                                           CER030
     C           CGL013    OREQ 'Y'                                                           CER030
     C                     MOVE *ON       *IN33                                               CER030
     C                     MOVE OPRTTY    P5RTTY                                              CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           CER031    IFEQ 'Y'                                                           CER030
     C                     MOVE *ON       *IN34                                               CER030
     C                     MOVE OPEXT1    P5EXN1                                              CER030
     C                     MOVE OPEXT2    P5EXN2                                              CER030
     C                     MOVE OPEXT3    P5EXN3                                              CER030
     C                     MOVE OPEXT4    P5EXN4                                              CER030
     C                     MOVE OPEXT5    P5EXN5                                              CER030
     C                     MOVE OPEXT6    P5EXN6                                              CER030
      *                                                                                       CER030
     C           CFT003    IFEQ 'CFT003'                                                      CER030
     C                     MOVE *ON       *IN35                                               CER030
     C                     MOVE OPEXC1    P5EXC1                                              CER030
     C                     MOVE OPEXC2    P5EXC2                                              CER030
     C                     MOVE OPEXC3    P5EXC3                                              CER030
     C                     MOVE OPEXC4    P5EXC4                                              CER030
     C                     MOVE OPEXC5    P5EXC5                                              CER030
     C                     MOVE OPEXC6    P5EXC6                                              CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     WRITEP5HD
     C                     WRITEP5DETL
      *                                                                   CFT009
      ** Write new record format, for charges if core switchable featur   CFT009
      ** is on.                                                           CFT009
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
     C                     ADD  1         P5PAGE                          CFT009
     C                     WRITEP5CHGS                                    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           CSW209    IFEQ 'Y'                                                           CSW209
     C           CFT009    IFEQ 'Y'                                                         AR655670
     C                     MOVE '1'       *IN78                                             AR655670
     C                     ELSE                                                             AR655670
     C                     MOVE '0'       *IN78                                             AR655670
     C                     ADD  1         P5PAGE                                            AR655670
     C                     ENDIF                                                            AR655670
     C                     WRITEP5NTWK                                                        CSW209
     C           OPOMVF    IFEQ 'COV'                                                         CSW209
     C           P5CORC    IFNE *BLANKS                                                       CSW209
     C           P5COBC    ORNE *BLANKS                                                       CSW209
     C           P5CIBC    ORNE *BLANKS                                                       CSW209
     C           P5CABC    ORNE *BLANKS                                                       CSW209
     C           P5CBCC    ORNE *BLANKS                                                       CSW209
     C           P5OCBC    ORNE *BLANKS                                                       CSW209
     C           P5CBBC    ORNE *BLANKS                                                       CSW209
     C           P5CDPC    ORNE *BLANKS                                                       CSW209
     C           P5CICY    ORNE *BLANKS                                                       CSW209
     C           P5CIAM    ORNE *BLANKS                                                       CSW209
     C                     ADD  1         P5PAGE                                              CSW209
     C                     WRITEP5COVM                                                        CSW209
     C                     ENDIF                                                              CSW209
     C                     ENDIF                                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
      *                                                                                       CER030
     C           CFT009    IFNE 'Y'                                                           CER030
      *                                                                                       CER030
     C           OFLOW5    SUB  PLINE5    WREM2   20                                          CER030
      *                                                                                       CER030
     C           CER031    IFEQ 'N'                                                           CER030
      *                                                                                       CER030
     C           WREM2     IFLE 2                                                             CER030
     C                     MOVE *ON       *IN17                                               CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ELSE                                                               CER030
     C           CFT003    IFEQ 'CFT003'                                                      CER030
      *                                                                                       CER030
     C           WREM2     IFLE 15                                                            CER030
     C                     MOVE *ON       *IN17                                               CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ELSE                                                               CER030
      *                                                                                       CER030
     C           WREM2     IFLE 8                                                             CER030
     C                     MOVE *ON       *IN17                                               CER030
     C                     ENDIF                                                              CER030
     C                     ENDIF                                                              CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      ** Write Transaction Type                                                               CER030
      *                                                                                       CER030
     C           CGL013    IFEQ 'Y'                                                           CER030
     C           CER030    OREQ 'Y'                                                           CER030
     C           CER031    OREQ 'Y'                                                           CER030
     C                     WRITEP5TRTN                                                        CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      ** Write Extended Narrative                                                             CER030
      *                                                                                       CER030
     C           CER031    IFEQ 'Y'                                                           CER030
     C                     WRITEP5EXND                                                        CER030
     C           CFT003    IFEQ 'CFT003'                                                      CER030
     C                     WRITEP5EXNC                                                        CER030
     C                     ENDIF                                                              CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     MOVE '0'       *IN17                                               CER030
      *                                                                                       CER030
     C                     MOVE '1'       *IN85            'OUTPUT, YES
     C*
     C                     ENDSR
     C*
      ********************************************************************CFT009
     C/EJECT                                                              CFT009
      ********************************************************************CFT009
      *                                                               *   CFT009
      * CALCG5 - SUBROUTINE TO CALCULATE CHARGES FOR CORE SWITCHABLE  *   CFT009
      *          FEATURE CFT009 (plus VAT component CFT010)           *   CFT009
      *                                                               *   CFT009
      ********************************************************************CFT009
      *                                                                ***CFT009
     C           CALCG5    BEGSR                                          CFT009
      *                                                                ***CFT009
     C           PREF      CHAINOTPAYXL0             79                   CFT009
      *                                                                   CFT009
      ** Set up levied currency                                           CFT009
      *                                                                   CFT009
     C                     SELEC                                          CFT009
     C***********CDRO      WHNE 0                                                      CFT009 CSD027
     C           CDRO      WHNE *BLANKS                                                       CSD027
      *                                                                                       CFT120
     C                     MOVELBCCY      WCCY                            CFT009
     C           OPCDRC    IFNE *BLANKS                                                       CFT120
     C           CFT120    ANDEQ'Y'                                                           CFT120
     C                     MOVELOPCDRC    WCCY                                                CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
     C           ADDC      WHEQ 'A'                                       CFT009
     C                     MOVELSMCY      WCCY                            CFT009
     C                     OTHER                                          CFT009
     C                     MOVELPCCY      WCCY                            CFT009
     C                     ENDSL                                          CFT009
      *                                                                   CFT009
      ** Retrieve currency details                                        CFT009
      *                                                                   CFT009
     C                     CALL 'AOCURRR0'                                CFT009
     C                     PARM *BLANKS   @RTCD                           CFT009
     C                     PARM '*KEY   ' @OPTN                           CFT009
     C                     PARM WCCY      @CURR   3                       CFT009
     C           SDCURR    PARM SDCURR    DSSDY                           CFT009
      *                                                                   CFT009
     C           @RTCD     IFNE *BLANKS                                   CFT009
     C                     MOVE 'SDCURRPD'WBFILE           ***************CFT009
     C                     MOVELWCCY      WBKEY            ** DBERR  07 **CFT009
     C                     Z-ADD07        WBASE            ***************CFT009
     C                     EXSR ABORT                      *ABORT PGM*    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     Z-ADDA6NBDP    WNDP    10                      CFT009
     C                     Z-ADDA6NBDP    LEVDPS  10                      CFT009
     C                     Z-ADDWNDP      ZADEC                           CFT009
      *                                                                   CFT009
      ** SETUP CURRENCY NAMES                                             CFT009
      *                                                                   CFT009
     C                     MOVELWCCY      P5TRCY                          CFT009
     C                     MOVELWCCY      P5TXCY                          CFT009
     C                     MOVELWCCY      P5CQCY                          CFT009
     C                     MOVELWCCY      P5SWCY                          CFT009
     C                     MOVELWCCY      P5STCY                          CFT009
     C                     MOVELWCCY      P5CSCY                          CFT009
     C                     MOVELWCCY      P5MSCY                          CFT009
     C                     MOVELWCCY      P5M1CY                          CFT009
     C                     MOVELWCCY      P5M2CY                          CFT009
     C                     MOVELWCCY      P5M3CY                          CFT009
     C                     MOVELWCCY      P5M4CY                          CFT009
     C                     MOVELWCCY      P5M5CY                          CFT009
     C                     MOVELWCCY      P5FXCY                          CFT009
      *                                                                   CFT009
      ** Set up charge ccy field                                          CFT009
      *                                                                   CFT009
     C                     MOVELOPCHGC    P5CG01                          CFT009
     C                     MOVELOPCHGC    P5CG02                          CFT009
     C                     MOVELOPCHGC    P5CG03                          CFT009
     C                     MOVELOPCHGC    P5CG04                          CFT009
     C                     MOVELOPCHGC    P5CG05                          CFT009
     C                     MOVELOPCHGC    P5CG06                          CFT009
     C                     MOVELOPCHGC    P5CG07                          CFT009
     C                     MOVELOPCHGC    P5CG08                          CFT009
     C                     MOVELOPCHGC    P5CG09                          CFT009
     C                     MOVELOPCHGC    P5CG10                          CFT009
     C                     MOVELOPCHGC    P5CG11                          CFT009
     C                     MOVELOPCHGC    P5CG12                          CFT009
     C                     MOVELOPCHGC    P5CG13                          CFT009
     C                     MOVELOPCHGC    P5CG14                          CFT009
      *                                                                   CFT009
      ** Move spread set code in                                          CFT009
      *                                                                   CFT009
     C                     MOVE FXSRSC    P5FXSR                          CFT009
      *                                                                   CFT009
      ** MOVE CHARGE CODES IN                                             CFT009
      *                                                                   CFT009
     C                     MOVE TLXCDE    P5TXCD                          CFT009
     C                     MOVE CHQCHC    P5CQCD                          CFT009
     C                     MOVE CACHCD    P5CSCD                          CFT009
     C                     MOVE SSTCCD    P5STCD                          CFT009
     C                     MOVE SPRCCD    P5SWCD                          CFT009
     C                     MOVE MSCHC     P5MSCD                          CFT009
     C                     MOVE MSCHC1    P5M1CD                          CFT009
     C                     MOVE MSCHC2    P5M2CD                          CFT009
     C                     MOVE MSCHC3    P5M3CD                          CFT009
     C                     MOVE MSCHC4    P5M4CD                          CFT009
     C                     MOVE MSCHC5    P5M5CD                          CFT009
     C                     MOVE TFCCCD    P5TRCD                          CFT009
     C                     MOVE FXCACC    P5FXCD                          CFT009
      *                                                                   CFT009
      ** Set up misc charge amounts in charges currency.                  CFT009
      *                                                                   CFT009
     C                     Z-ADDMISCC1    ZMISC1 150H                     CFT009
     C                     Z-ADDMISCC2    ZMISC2 150H                     CFT009
     C                     Z-ADDMISCC3    ZMISC3 150H                     CFT009
     C                     Z-ADDMISCC4    ZMISC4 150H                     CFT009
     C                     Z-ADDMISCC5    ZMISC5 150H                     CFT009
      *                                                                   CFT009
      ** FORMAT TELEX CHARGE AMOUNT                                       CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE TXCH      ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P5TXCH                          CFT009
      *                                                                   CFT009
      ** FORMAT CHEQUE CHARGE AMOUNT                                      CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE CQCH      ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P5CQCH                          CFT009
      *                                                                   CFT009
      ** FORMAT COSTS ABROAD AMOUNT                                       CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE CSTA      ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P5CSTA                          CFT009
      *                                                                   CFT009
      ** FORMAT SWIFT STANDARD CHARGE AMOUNT                              CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE SWSCHG    ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P5STSC                          CFT009
      *                                                                   CFT009
      ** FORMAT SWIFT PRIORITY CHARGE AMOUNT                              CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE SPCH      ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P5SWSC                          CFT009
      *                                                                   CFT009
      ** FORMAT MISCELLANEOUS CHARGE AMOUNT                               CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE MSCH      ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P5MSCH                          CFT009
      *                                                                   CFT009
      ** FORMAT MISCELLANEOUS CHARGE AMOUNT 1                             CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE MISC01    ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P5M1CH                          CFT009
      *                                                                   CFT009
      ** FORMAT MISCELLANEOUS CHARGE AMOUNT 2                             CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE MISC02    ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P5M2CH                          CFT009
      *                                                                   CFT009
      ** FORMAT MISCELLANEOUS CHARGE AMOUNT 3                             CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE MISC03    ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P5M3CH                          CFT009
      *                                                                   CFT009
      ** FORMAT MISCELLANEOUS CHARGE AMOUNT 4                             CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE MISC04    ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P5M4CH                          CFT009
      *                                                                   CFT009
      ** FORMAT MISCELLANEOUS CHARGE AMOUNT 5                             CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE MISC05    ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P5M5CH                          CFT009
      *                                                                   CFT009
      **  FORMAT TRANSFER COMMISSION AMOUNT                               CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE TRCM      ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P5TRCH                          CFT009
      *                                                                   CFT009
      ** Format the FX/Change Commission amount                           CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE OPCHCM    ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P5FXCH                          CFT009
      *                                                                   CFT009
      ** Set up amounts from file in charges currency.                    CFT009
      *                                                                   CFT009
     C                     Z-ADDDUMA2     ZTXCH  150H                     CFT009
     C                     Z-ADDDUMA3     ZCQCH  150H                     CFT009
     C                     Z-ADDDUMA4     ZCSTA  150H                     CFT009
     C                     Z-ADDSWSCCC    ZSWSCH 150H                     CFT009
     C                     Z-ADDDUMA5     ZSPCH  150H                     CFT009
     C                     Z-ADDDUMA6     ZMSCH  150H                     CFT009
     C                     Z-ADDDUMA1     ZTRCM  150H                     CFT009
     C                     Z-ADDOPDUM7    ZOPCHC 150H                     CFT009
      *                                                                   CFT009
      ** Retrieve charge currency details                                 CFT009
      *                                                                   CFT009
     C                     CALL 'AOCURRR0'                                CFT009
     C                     PARM *BLANKS   @RTCD                           CFT009
     C                     PARM '*KEY   ' @OPTN                           CFT009
     C                     PARM OPCHGC    @CURR   3                       CFT009
     C           SDCURR    PARM SDCURR    DSSDY                           CFT009
      *                                                                   CFT009
     C           @RTCD     IFNE *BLANKS                                   CFT009
     C                     MOVE 'SDCURRPD'WBFILE           ***************CFT009
     C                     MOVELWCCY      WBKEY            ** DBERR  08 **CFT009
     C                     Z-ADD08        WBASE            ***************CFT009
     C                     EXSR ABORT                      *ABORT PGM*    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     Z-ADDA6NBDP    WNDP    10                      CFT009
     C                     Z-ADDA6NBDP    CHGDPS  10                      CFT009
     C                     Z-ADDWNDP      ZADEC                           CFT009
      *                                                                   CFT009
      *                                                                   CFT009
      ** Format TELEX charge amount                                       CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE ZTXCH     ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P5TXCG                          CFT009
      *                                                                   CFT009
      ** Format CHEQUE charge amount                                      CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE ZCQCH     ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P5CQCG                          CFT009
      *                                                                   CFT009
      ** Format COSTS ABROAD amount                                       CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE ZCSTA     ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P5CSCG                          CFT009
      *                                                                   CFT009
      ** Format SWIFT STANDARD charge amount                              CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE ZSWSCH    ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P5STCG                          CFT009
      *                                                                   CFT009
      ** Format SWIFT PRIORITY charge amount                              CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE ZSPCH     ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P5SWCG                          CFT009
      *                                                                   CFT009
      ** Format MISCELLANEOUS charge amount                               CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE ZMSCH     ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P5MSCG                          CFT009
      *                                                                   CFT009
      ** Format MISCELLANEOUS charge amount 1                             CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE MISCC1    ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P5M1CG                          CFT009
      *                                                                   CFT009
      ** Format MISCELLANEOUS charge amount 2                             CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE MISCC2    ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P5M2CG                          CFT009
      *                                                                   CFT009
      ** Format MISCELLANEOUS charge amount 3                             CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE MISCC3    ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P5M3CG                          CFT009
      *                                                                   CFT009
      ** Format MISCELLANEOUS charge amount 4                             CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE MISCC4    ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P5M4CG                          CFT009
      *                                                                   CFT009
      ** Format MISCELLANEOUS charge amount 5                             CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE MISCC5    ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P5M5CG                          CFT009
      *                                                                   CFT009
      ** Format TRANSFER COMMISSION amount                                CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE ZTRCM     ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P5TRCG                          CFT009
      *                                                                   CFT009
      ** Format the FX/Change Commission amount                           CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE ZOPCHC    ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P5FXCG                          CFT009
      *                                                                   CFT009
      *                                                                   CFT009
      ** Check if CFT010 is set on                                        CFT009
      *                                                                   CFT009
     C           CFT010    IFEQ 'Y'                                       CFT009
      *                                                                   CFT009
      ** Set up VAT flags for report                                      CFT009
      *                                                                   CFT009
     C                     MOVE OPVAT1    P5INV1                          CFT009
     C                     MOVE OPVAT2    P5INV2                          CFT009
     C                     MOVE OPVAT3    P5INV3                          CFT009
     C                     MOVE OPVAT4    P5INV4                          CFT009
     C                     MOVE OPVAT5    P5SWVI                          CFT009
     C                     MOVE OPVAT6    P5INV6                          CFT009
     C                     MOVE OPVAT7    P5INV7                          CFT009
     C                     MOVE VTSWSC    P5STVI                          CFT009
     C                     MOVE VMIC1     P5IVM1                          CFT009
     C                     MOVE VMIC2     P5IVM2                          CFT009
     C                     MOVE VMIC3     P5IVM3                          CFT009
     C                     MOVE VMIC4     P5IVM4                          CFT009
     C                     MOVE VMIC5     P5IVM5                          CFT009
      *                                                                   CFT009
      ** Perform V.A.T. processing if CFT010 is active                    CFT009
      *                                                                   CFT009
      ** Fill in V.A.T. total from the file value.                        CFT009
      *                                                                   CFT009
     C                     Z-ADDOPVATT    VATTOT    H                     CFT009
      *                                                                   CFT009
      ** Fill in V.A.T. total in charges currency from the file value.    CFT009
      *                                                                   CFT009
     C                     Z-ADDOPDUM8    VATCHG                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** CALCULATE TOTAL CHARGES AND FORMAT                               CFT009
      *                                                                   CFT009
     C           TXCH      ADD  WVAT2     WTTXC  110                      CFT009
      *                                                                   CFT009
      ** FORMAT TOTAL TELEX CHARGE AMOUNT                                 CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE WTTXC     ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
      *                                                                   CFT009
     C           CQCH      ADD  WVAT3     WTCQC  110                      CFT009
      *                                                                   CFT009
      ** FORMAT TOTAL CHEQUE CHARGE AMOUNT                                CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE WTCQC     ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
      *                                                                   CFT009
     C           CSTA      ADD  WVAT4     WTCSC  110                      CFT009
      *                                                                   CFT009
      ** FORMAT TOTAL COSTS ABROAD AMOUNT                                 CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE WTCSC     ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
      *                                                                   CFT009
     C           TRCM      ADD  WVAT1     WTTRC  110                      CFT009
      *                                                                   CFT009
      **  FORMAT TOTAL TRANSFER COMMISSION AMOUNT                         CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE WTTRC     ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
      *                                                                   CFT009
      *                                                                   CFT009
      ** CALCULATE GRAND TOTALS CHARGES AND FORMAT                        CFT009
      ** Total charges for LHS.                                           CFT009
      *                                                                   CFT009
     C           TXCH      ADD  CQCH      WTLAM  140                      CFT009
     C                     ADD  CSTA      WTLAM                           CFT009
     C                     ADD  SWSCHG    WTLAM                           CFT009
     C                     ADD  SPCH      WTLAM                           CFT009
     C                     ADD  MSCH      WTLAM                           CFT009
     C                     ADD  MISC01    WTLAM                           CFT009
     C                     ADD  MISC02    WTLAM                           CFT009
     C                     ADD  MISC03    WTLAM                           CFT009
     C                     ADD  MISC04    WTLAM                           CFT009
     C                     ADD  MISC05    WTLAM                           CFT009
     C                     ADD  TRCM      WTLAM                           CFT009
     C                     ADD  OPCHCM    WTLAM                           CFT009
      ** Add on V.A.T. if CFT010 is on.                                   CFT009
     C           CFT010    IFEQ 'Y'                                       CFT009
     C                     ADD  VATTOT    WTLAM                           CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Total charges for RHS.                                           CFT009
      *                                                                   CFT009
     C           ZTXCH     ADD  ZCQCH     WTLAC  140                      CFT009
     C                     ADD  ZCSTA     WTLAC                           CFT009
     C                     ADD  ZSWSCH    WTLAC                           CFT009
     C                     ADD  ZSPCH     WTLAC                           CFT009
     C                     ADD  ZMSCH     WTLAC                           CFT009
     C                     ADD  ZMISC1    WTLAC                           CFT009
     C                     ADD  ZMISC2    WTLAC                           CFT009
     C                     ADD  ZMISC3    WTLAC                           CFT009
     C                     ADD  ZMISC4    WTLAC                           CFT009
     C                     ADD  ZMISC5    WTLAC                           CFT009
     C                     ADD  ZTRCM     WTLAC                           CFT009
     C                     ADD  ZOPCHC    WTLAC                           CFT009
      ** Add on V.A.T. if CFT010 is on.                                   CFT009
     C           CFT010    IFEQ 'Y'                                       CFT009
     C                     ADD  VATCHG    WTLAC                           CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Format grand total amount for LHS                                CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE WTLAM     ZFIELD                          CFT009
     C                     Z-ADDLEVDPS    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P5TLAM                          CFT009
      *                                                                   CFT009
      ** Format grand total amount for RHS                                CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE WTLAC     ZFIELD                          CFT009
     C                     Z-ADDCHGDPS    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P5TLCG                          CFT009
      *                                                                   CFT009
      ** FORMAT GRAND TOTAL VAT                                           CFT009
      *                                                                   CFT009
     C           CFT010    IFEQ 'Y'                                       CFT009
      *                                                                   CFT009
     C                     Z-ADDVATTOT    WTLVT                           CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE WTLVT     ZFIELD                          CFT009
     C                     Z-ADDLEVDPS    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P5TLVT                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Check to see if CFT010 is on.                                    CFT009
      *                                                                   CFT009
     C           CFT010    IFEQ 'Y'                                       CFT009
      *                                                                   CFT009
      ** Format V.A.T. total in charges currency.                         CFT009
      ** Retrieve charges currency details                                CFT009
      *                                                                   CFT009
     C                     CALL 'AOCURRR0'                                CFT009
     C                     PARM *BLANKS   @RTCD                           CFT009
     C                     PARM '*KEY   ' @OPTN                           CFT009
     C                     PARM OPCHGC    @CURR   3                       CFT009
     C           SDCURR    PARM SDCURR    DSSDY                           CFT009
      *                                                                   CFT009
     C           @RTCD     IFNE *BLANKS                                   CFT009
     C                     MOVE 'SDCURRPD'WBFILE           ***************CFT009
     C                     MOVELOPCHGC    WBKEY            ** DBERR  09 **CFT009
     C                     Z-ADD09        WBASE            ***************CFT009
     C                     EXSR ABORT                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Format V.A.T. total in charges currency.                         CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE VATCHG    ZFIELD                          CFT009
     C                     Z-ADDCHGDPS    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P5VTCC                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDSR                                          CFT009
      *                                                                   CFT009
      *                                                                   CFT009
     C********************************************************************
     C/EJECT
     C********************************************************************
     C*                                                               *
     C* NTRREP - SUBROUTINE TO PRODUCE REPORT FT1000P6 FOR NOSTRO     *
     C*          TRANSFERS                                            *
     C*                                                               *
     C********************************************************************
     C*                                                                ***
     C           NTRREP    BEGSR
     C*                                                                ***
     C                     MOVELTITL      P6TITL
     C                     MOVELRUNA      P6DATE
     C*                                                                   S01117
     C* IF MULTIBRANCHING INDICATOR ACTIVE,MOVE BOOKING BRANCH AND        S01117
     C* APPROPRIATE BRANCH NAME TO THE RELATIVE FIELDS SET UP WITHIN      S01117
     C* THE PRINTER FILE                                                  S01117
     C*                                                                   S01117
     C           *IN30     IFEQ '1'                                       S01117
     C                     MOVE BRCA      P6BRCA                          S01117
     C                     MOVE BRCA      WRKFLD                          S01117
     C                     EXSR SUBBRN                                    S01117
     C                     MOVELBRNM      P6BRNM                          S01117
     C*                                                                   S01117
     C* IF ORIGINATING BRANCH USED INDICATOR ACTIVE,MOVE ORBR AND         S01117
     C* APPROPRIATE BRANCH NAME TO THE RELATIVE FIELDS SET UP WITHIN      S01117
     C* THE PRINTER FILE                                                  S01117
     C*                                                                   S01117
     C           *IN35     IFEQ '1'                                       S01117
     C                     MOVE ORBR      P6ORBR                          S01117
     C                     MOVE ORBR      WRKFLD                          S01117
     C                     EXSR SUBBRN                                    S01117
     C                     MOVELBRNM      P6ORNM                          S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C*
     C           *IN55     IFEQ '0'
     C                     ADD  1         P6PAGE
     C                     WRITEP6HEDT                     HEADINGS
     C                     SETON                     55
     C                     END
     C*
     C                     ADD  1         NT#CT   20
     C*
     C***********NT#CT     IFGE 10                                        S01494
     C           NT#CT     IFGE 3                                         S01494
     C                     SETOF                     55
     C                     Z-ADD0         NT#CT
     C                     END
     C*
     C                     Z-ADDVDAT      ZDAYNO           'FORMAT DATE
     C                     EXSR ZDATE2                     'TO DDMMMYY
     C                     MOVE ZADATE    VDATO   7
     C*
     C** CALL UATBCN TO ACCESS CURRENCY RECORD FOR PAY CURRENCY
     C*
     C                     MOVEL*BLANKS   ZTABKY
     C                     MOVEL'20'      ZTABKY
     C                     MOVELCCY       WA4
     C                     MOVE '1'       WA4
     C                     MOVE WA4       ZTABKY
     C                     EXSR UATBCN
     C*
     C** CHECK IF DATABASE ERROR OCCURRED
     C*
     C           *IN89     IFEQ '1'
     C                     MOVEL'TABLE'   WBFILE           **********
     C                     MOVELZTABKY    WBKEY            * DBERR 24
     C                     Z-ADD24        WBASE            **********
     C                     EXSR ABORT                      *ABORT PGM*
     C                     END
     C*
     C** STORE NUMBER OF DECIMAL PLACES FOR PAY CURRENCY
     C*
     C                     Z-ADDCDP       SVPCDP  10
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE AMNT      WFDIN
     C                     Z-ADDSVPCDP    WDEC
     C           13        SUB  SVPCDP    WDIG
     C                     EXSR UGFRMT
     C                     MOVE WFDOUT    P6AMNT
     C*                                                                   S01494
     C** Format the name and address of the DESTINATION                   S01494
     C*                                                                   S01494
     C                     MOVELCCY       XCCY                            S01494
     C                     MOVEL'N'       XTYPE                           S01494
     C                     MOVEL*BLANKS   XNAMDS                          S01494
     C                     MOVELDEST      XNAMDS                          S01494
     C                     EXSR GETADD                                    S01494
     C                     MOVELXNAMDS    P6DEST                          S01494
     C*                                                                   S01494
     C** Format the name and address of the ACCOUNT WITH BANK             S01494
     C*                                                                   S01494
     C                     MOVELCCY       XCCY                            S01494
     C                     MOVEL'N'       XTYPE                           S01494
     C                     MOVEL*BLANKS   XNAMDS                          S01494
     C                     MOVELACBN      XNAMDS                          S01494
     C                     EXSR GETADD                                    S01494
     C                     MOVELXNAMDS    P6AWBK                          S01494
     C*                                                                   S01494
     C** Format the name and address of the INTERMEDIARY BANK             S01494
     C*                                                                   S01494
     C                     MOVELNTINBT    XTYPE                           S01494
     C                     MOVE *BLANKS   XNAMDS                          S01494
     C                     MOVELININBT    XNAMDS                          S01494
     C                     EXSR GETADD                                    S01494
     C                     MOVELXNAMDS    P6INBT                          S01494
     C*
     C                     WRITEP6DETL                 60
     C                     MOVE '1'       *IN86
     C*
     C                     ENDSR
     C*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C*                                                               *
     C*  CQCREP - SUBROUTINE TO PRODUCE REPORT FT1000P2 FOR CHEQUES   *
     C*                                                               *
     C*  INPUT  - P#CRDB (Credit/Debit Indicator)                     *
     C*                                                               *
     C*  CALLS  - DEBIT AND CREDIT SUBROUTINES                        *
     C*                                                               *
     C*****************************************************************
     C*
     C*
     C           CQCREP    BEGSR
     C*
     C           P#CRDB    IFEQ 'C'
     C                     EXSR CQCCRD
     C                     ELSE
     C                     EXSR CQCDBT
     C                     END
     C*
     C                     ENDSR
     C*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C*                                                               *
     C*  CQPREP - SUBROUTINE TO PRODUCE REPORT FT1000P3 FOR CHEQUES   *
     C*                                                               *
     C*  INPUT  - Q#CRDB (Credit/Debit Indicator)                     *
     C*                                                               *
     C*  CALLS  - DEBIT AND CREDIT SUBROUTINES                        *
     C*                                                               *
     C*****************************************************************
     C*
     C*
     C           CQPREP    BEGSR
     C*
     C           Q#CRDB    IFEQ 'C'
     C                     EXSR CQPCRD
     C                     ELSE
     C                     EXSR CQPDBT
     C                     END
     C*
     C                     ENDSR
     C*
     C********************************************************************
      /EJECT                                                              S01435
      *****************************************************************   S01435
      **                                                                  S01435
      **    Get name for Type.                                            S01435
      **                                                                  S01435
      **    CALLED FROM:  anywhere                                        S01435
      **    CALLS:                                                        S01435
      **                                                                  S01435
      **                                                                  S01435
     C           GETADD    BEGSR                                          S01435
      *                                                                   S01435
      *                                                                   S01435
      *  Set up general parameters                                        S01435
      *                                                                   S01435
     C           *LIKE     DEFN BCCY      XCCY                            S01435
      *                                                                   S01435
     C                     CLEARW8FT                                      S01435
     C                     MOVEL*BLANKS   W8STMT                          S01435
     C                     MOVELXCCY      W8CCY                           S01435
     C                     MOVEL##PGM     W8CPGM                          S01435
     C                     MOVEL'*PRINT'  W8ACT                           S01435
     C                     Z-ADD5         W8NLIN                          S01435
      *                                                                   S01435
      *  Receivers Correspomdent                                          S01435
      *                                                                   S01435
     C                     MOVELXTYPE     W8TYPE                          S01435
     C                     MOVEL*BLANKS   W8LINS                          S01435
     C                     MOVELXNAMDS    W8LINS                          S01435
      *                                                                   S01435
      * Call expansion program                                            S01435
      *                                                                   S01435
     C                     CALL 'FT0315'               8989               S01435
     C                     PARM           W8RTN   7                       S01435
     C                     PARM           W8FT                            S01435
     C                     PARM           W8LINS256                       S01435
     C                     PARM           W8RPT 256                       S01435
     C                     PARM           W8MSG 256                       S01435
     C                     PARM           W8SCR 256                       S01435
      *                                                                   S01435
      ** Check if database error occurred                                 S01435
      *                                                                   S01435
     C           *IN89     IFEQ '1'                                       S01435
     C           W8RTN     ORNE *BLANKS                                   S01435
     C                     MOVEL'FT0315'  WBFILE                          S01435
     C                     MOVEL'*CALL'   WBKEY                           S01435
     C                     MOVEL'52'      WBASE                           S01435
     C                     EXSR ABORT                      *ABORT PGM*    S01435
     C                     END                                            S01435
      *                                                                   S01435
     C                     MOVELW8RPT     XNAMDS                          S01435
      *                                                                   S01435
     C                     ENDSR                                          S01435
      /EJECT                                                              S01435
     C           UCMUSE    BEGSR                                          S01435
     C*          ******    *****                                          S01435
     C*                                                                   S01435
     C*****************************************************************   S01435
     C*                 UC-CHAIN-USER-FILE                            *   S01435
     C*                                                               *   S01435
     C*  FUNCTION : TO ATTEMPT TO ACCESS THE RECORD FROM THE USER     *   S01435
     C*             FILE.                                             *   S01435
     C*                                                               *   S01435
     C*  CALLS :    NONE                                              *   S01435
     C*                                                               *   S01435
     C*  CALLED BY: CCDETL                                            *   S01435
     C*                                                               *   S01435
     C*****************************************************************   S01435
     C*                                                                   S01435
     C           USRP      CHAINMUSERDDF             89                   S01435
     C*                                                                   S01435
     C  N89      RECI      COMP 'D'                  8989                 S01435
      *                                                                   S01435
     C           *IN89     IFEQ '1'                                       S01435
     C                     MOVELUSRP      USER1                           S01435
     C                     END                                            S01435
     C*                                                                   S01435
     C*                    *****                                          S01435
     C                     ENDSR                                          S01435
     C*                    *****                                          S01435
     C/EJECT
     C*****************************************************************
     C*                 UC-CHAIN-PAYMENT-CHARGES-FILE                 *
     C*                                                               *
     C*  FUNCTION : TO ATTEMPT TO ACCESS THE RECORD FROM THE PAYMENT  *
     C*             CHARGES FILE.                                     *
     C*                                                               *
     C*  CALLS :    NONE                                              *
     C*                                                               *
     C*  CALLED BY: INPREP                                            *
     C*                                                               *
     C*****************************************************************
     C*
     C           UCCLCN    BEGSR
     C*
     C           WCLKEY    KLIST
     C**********           KFLD           WCLNUM  60                                          CSD027
     C                     KFLD           WCLNUM  6                                           CSD027
     C                     KFLD           WCLRCT  1
     C*
     C           WCLKEY    CHAINCLINT                89
     C*
     C  N89      RECICL    COMP 'D'                  8989
     C*
     C           UCEND     ENDSR
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*             UG-FORMAT-FIELD-FOR-OUTPUT-TO-REPORT              *
     C*                                                               *
     C*  FUNCTION : TO FORMAT A NUMERIC FIELD FROM THE PAYMENT        *
     C*             CHARGES FILE FOR OUTPUT TO THE DETAIL SCREEN.     *
     C*             IT REMOVES LEADING ZEROES & INSERTS A DECIMAL     *
     C*             POINT IN THE APPROPRIATE POSITION.                *
     C*                                                               *
     C*  CALLS :    NONE                                              *
     C*                                                               *
     C*  CALLED BY: CADETL                                            *
     C*                                                               *
     C*****************************************************************
     C*
     C           UGFRMT    BEGSR
     C*
     C                     MOVEAWFDIN     WA1,1
     C*
     C** REPLACE LEADING ZEROES (IF LEFT OF DECIMAL POINT) WITH SPACES
     C*
     C                     SETOF                     89
     C           15        SUB  WDIG      I       30        -START
     C                     SUB  WDEC      I                  POS.
     C*
     C           14        SUB  WDEC      I1      30
     C*
     C           *IN89     DOUEQ'1'
     C                     ADD  1         I
     C           I         IFGT 15                          -CHECK FOR
     C                     SETON                     89      ARRAY END
     C                     ELSE
     C           WA1,I     IFNE '0'                         -CHECK FOR
     C                     SETON                     89      NON-ZERO
     C                     ELSE                              DIGIT.
     C           I         IFLE I1
     C                     MOVEL' '       WA1,I
     C                     END
     C                     END
     C                     END
     C                     END
     C*
     C** MOVE DIGITS TO RIGHT OF DECIMAL POINT(IF ANY) TO OUTPUT ARRAY
     C** & INSERT A DECIMAL POINT
     C*
     C                     MOVEL*BLANKS   WA2
     C*
     C           16        SUB  WDEC      I
     C           21        SUB  WDEC      I1
     C*
     C           I         IFLE 15
     C                     MOVEAWA1,I     WA2,I1
     C                     SUB  1         I1
     C                     MOVEL'.'       WA2,I1
     C                     END
     C*
     C** INSERT A COMMA AFTER EVERY 3 DIGITS TO LEFT OF DECIMAL POINT
     C*
     C                     SUB  1         I
     C                     SUB  1         I1
     C                     Z-ADD*ZERO     I2      30
     C*
     C           WA1,I     DOUEQ' '
     C           I         OREQ *ZERO
     C*
     C           I2        IFEQ 3
     C                     MOVEL','       WA2,I1
     C                     SUB  1         I1
     C                     Z-ADD*ZERO     I2
     C                     END
     C*
     C                     MOVE WA1,I     WA2,I1
     C                     SUB  1         I
     C                     SUB  1         I1
     C                     ADD  1         I2
     C                     END
     C*
     C                     MOVEAWA2,1     WFDOUT 20
     C*
     C           UGEND     ENDSR
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*                 UA-CHAIN-TABLE-FILE                           *
     C*                                                               *
     C*  FUNCTION : TO ATTEMPT TO ACCESS A REQUESTED RECORD FROM THE  *
     C*             TABLE FILE.                                       *
     C*                                                               *
     C*  CALLS :    NONE                                              *
     C*                                                               *
     C*  CALLED BY: AAMAIN                                            *
     C*             ECINST                                            *
     C*                                                               *
     C*****************************************************************
     C*
     C           UATBCN    BEGSR
     C*
     C           ZTABKY    CHAINTABFP                89
     C*
     C  N89      RECI      COMP 'D'                  8989
     C*
     C           UAEND     ENDSR
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*                 CHOP FIELD PROCESSING                         *
     C*                                                               *
     C*  FUNCTION : TO EDIT  SNCO, ORBK, CDRO  FOR OUTPUT.            *
     C*             IF PRMFLD IS ZERO THEN OUTPUT BLANKS.             *
     C*             IF PRMTYP IS 'N',OUTPUT FIRST TWO CHARS.          *
     C*             IF PRMTYP ID 'R',OUTPUT FIRST TEN CHARS.          *
     C*                                                               *
     C*  CALLS :    NONE                                              *
     C*                                                               *
     C*  CALLED BY: DEBIT + CREDIT CQC\CPC SUBROUTINES                *
     C*                                                               *
     C*****************************************************************
     C*
     C           CHOPF     BEGSR
     C*
     C           PRMFLD    IFEQ *ZEROS
     C                     MOVE *BLANKS   PRMFLD
     C                     ELSE
     C*
     C           PRMTYP    IFEQ 'N'
     C                     MOVE BLNK10    PRMFLD
     C                     ELSE
     C*
     C           PRMTYP    IFEQ 'R'
     C                     MOVE BLNK2     PRMFLD
     C*
     C                     END
     C                     END
     C                     END
     C*
     C                     ENDSR
     C*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C**   CQC DEBIT PROCESSING
     C**
     C           CQCDBT    BEGSR                           ** DEBIT  **
     C*
     C           *IN51     IFEQ '0'
     C                     ADD  1         P2PAGE
     C                     WRITEP2HEDT                 60
     C                     SETON                     51
     C                     END
     C*
     C                     ADD  1         DB#CT   10
     C*
     C           DB#CT     IFGE 3
     C                     SETOF                     51
     C                     Z-ADD0         DB#CT
     C                     END
     C*
     C* IF MULTIBRANCHING INDICATOR ACTIVE, MOVE BOOKING BRANCH AND       S01117
     C* APPROPRIATE BRANCH NAME TO THE RELATIVE FIELDS SET UP WITHIN      S01117
     C* THE PRINTER FILE                                                  S01117
     C*                                                                   S01117
     C           *IN30     IFEQ '1'                                       S01117
     C                     MOVE BRCA      P2BRCA                          S01117
     C                     MOVE BRCA      WRKFLD                          S01117
     C                     EXSR SUBBRN                                    S01117
     C                     MOVELBRNM      P2BRNM                          S01117
     C*                                                                   S01117
     C* IF ORIGINATING BRANCH USED INDICATOR ACTIVE,MOVE ORBR AND         S01117
     C* APPROPRIATE BRANCH NAME TO THE RELATIVE FIELDS SET UP WITHIN      S01117
     C* THE PRINTER FILE                                                  S01117
     C*                                                                   S01117
     C           *IN35     IFEQ '1'                                       S01117
     C                     MOVE ORBR      P2ORBR                          S01117
     C                     MOVE ORBR      WRKFLD                          S01117
     C                     EXSR SUBBRN                                    S01117
     C                     MOVELBRNM      P2ORNM                          S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C           COBT      IFNE 'C'                        ### B001
     C                     MOVE COB1      CBANK1
     C*                                                                   S01117
     C* IF MULTIBRANCHING INDICATOR SETOF AND FULL ACCOUNT ENTRY,SINGLE   S01117
     C* BRANCH NEED TO BE FORMATTED BY CUTTING OFF THE BRANCH CODE FROM   S01117
     C* THE END USING A WORK FIELD BEFORE OUTPUTING TO THE PRINTER FILE   S01117
     C*                                                                   S01117
     C           *IN30     IFEQ '0'                                       S01117
     C           COBT      ANDEQ'G'                                       S01117
     C***********          MOVELCOB1      FLD15                     S01117S01435
     C                     MOVELCOB1      FLD15  15                 S01117S01435
     C                     MOVE *BLANKS   CBANK1                          S01117
     C                     MOVELFLD15     CBANK1                          S01117
     C                     END                                            S01117
     C                     MOVE COB2      CBANK2
     C                     MOVE COB3      CBANK3
     C                     MOVE COB4      CBANK4
     C*
     C                     ELSE
     C                     MOVELCOB1      WCLNUM
     C                     MOVEL'B'       WCLRCT
     C                     EXSR UCCLCN
     C*
     C           *IN89     IFEQ '1'                        ### B002
     C                     MOVE 'CLINT'   WBFILE           ***************
     C                     MOVELWCLNUM    WA7              ** DBERR  25 **
     C                     MOVE WCLRCT    WA7              ************
     C                     MOVELWA7       WBKEY
     C                     Z-ADD25        WBASE                        ***
     C                     EXSR ABORT
     C                     END                             ### E002
     C*
     C                     MOVE CNA1      CBANK1
     C                     MOVE CNA2      CBANK2
     C                     MOVE CNA3      CBANK3
     C                     MOVE CNA4      CBANK4
     C*
     C                     END                             ### E001
     C*
     C                     Z-ADDSLDT      ZDAYNO           'FORMAT DATE
     C                     EXSR ZDATE2                     'TO DDMMMYY
     C                     MOVE ZADATE    VDATO   7
     C*
     C                     Z-ADDOEDT      ZDAYNO           'FORMAT OEDT
     C                     EXSR ZDATE2                     'TO DDMMMYY
     C                     MOVE ZADATE    FTOEDT  7
     C*
     C** CALL UATBCN TO ACCESS CURRENCY RECORD FOR CURRENCY
     C*
     C                     MOVEL*BLANKS   ZTABKY
     C                     MOVEL'20'      ZTABKY
     C                     MOVELSMCY      WA4
     C                     MOVE '1'       WA4
     C                     MOVE WA4       ZTABKY
     C                     EXSR UATBCN
     C*
     C** CHECK IF DATABASE ERROR OCCURRED
     C*
     C           *IN89     IFEQ '1'
     C                     MOVEL'TABLE'   WBFILE           **********
     C                     MOVELZTABKY    WBKEY            * DBERR 26
     C                     Z-ADD26        WBASE            **********
     C                     EXSR ABORT                      *ABORT PGM*
     C                     END
     C*
     C** STORE NUMBER OF DECIMAL PLACES FOR PAY CURRENCY
     C*
     C                     Z-ADDCDP       SVPCDP  10
     C*
     C                     MOVELSMCY      OCCY
     C*
     C*  FORMAT TOTAL COLLECT AND TOTAL CHARGES FOR OUTPUT
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE TOCL      WFDIN
     C                     Z-ADDSVPCDP    WDEC
     C           13        SUB  SVPCDP    WDIG
     C                     EXSR UGFRMT
     C                     MOVE WFDOUT    P2TOCL
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE TOTC      WFDIN
     C                     Z-ADDSVPCDP    WDEC
     C           13        SUB  SVPCDP    WDIG
     C                     EXSR UGFRMT
     C                     MOVE WFDOUT    P2TOTC
     C*
     C*  FORMAT 'RCCO' FOR OUTPUT
     C*
     C                     MOVE RCRT      PRMTYP  1        ( RCCO )
     C**********           MOVE *ZEROS    PRMFLD 12                                           CGL029
     C                     MOVE *ZEROS    PRMFLD                                              CGL029
     C                     MOVELRCCO      PRMFLD
     C                     EXSR CHOPF
     C                     MOVELPRMFLD    FTRCCO
     C*
     C                     WRITEP2DEBT                 60
     C                     MOVE '1'       *IN82
     C*
     C                     ENDSR
     C*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C**    CREDIT PROCESSING
     C**
     C           CQCCRD    BEGSR                           ** CREDIT **
     C*
     C           *IN52     IFEQ '0'
     C                     ADD  1         P2PAGE
     C                     WRITEP2HEDT                 60
     C                     SETON                     52
     C                     END
     C*
     C                     ADD  1         CR#CT   10
     C*
     C           CFT009    IFEQ 'Y'                                       CFT009
     C           CR#CT     IFGE 1                                         CFT009
     C                     SETOF                     52                   CFT009
     C                     Z-ADD0         CR#CT                           CFT009
     C                     ENDIF                                          CFT009
     C                     ELSE                                           CFT009
     C           CR#CT     IFGE 2
     C                     SETOF                     52
     C                     Z-ADD0         CR#CT
     C                     END
     C                     ENDIF                                          CFT009
     C*
     C* IF MULTIBRANCHING INDICATOR ACTIVE, MOVE BOOKING BRANCH AND       S01117
     C* APPPROPRIATE BRANCH NAME TO THE RELATIVE FIELDS SET UP WITHIN     S01117
     C* THE PRINTER FILE                                                  S01117
     C*                                                                   S01117
     C           *IN30     IFEQ '1'                                       S01117
     C                     MOVE BRCA      P2BRCA                          S01117
     C                     MOVE BRCA      WRKFLD                          S01117
     C                     EXSR SUBBRN                                    S01117
     C                     MOVELBRNM      P2BRNM                          S01117
     C*                                                                   S01117
     C* IF ORIGINATING BRANCH USED INDICATOR ACTIVE,MOVE ORBR AND         S01117
     C* APPROPRIATE BRANCH NAME TO THE RELATIVE FIELDS SET UP WITHIN      S01117
     C* THE PRINTER FILE                                                  S01117
     C*                                                                   S01117
     C           *IN35     IFEQ '1'                                       S01117
     C                     MOVE ORBR      P2ORBR                          S01117
     C                     MOVE ORBR      WRKFLD                          S01117
     C                     EXSR SUBBRN                                    S01117
     C                     MOVELBRNM      P2ORNM                          S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     Z-ADDCRVD      ZDAYNO           'FORMAT DATE
     C                     EXSR ZDATE2                     'TO DDMMMYY
     C                     MOVE ZADATE    VDATO
     C*
     C                     Z-ADDOEDT      ZDAYNO           'FORMAT OEDT
     C                     EXSR ZDATE2                     'TO DDMMMYY
     C                     MOVE ZADATE    FTOEDT
     C*
     C** CALL UATBCN TO ACCESS CURRENCY RECORD FOR CURRENCY
     C*
     C                     MOVEL*BLANKS   ZTABKY
     C                     MOVEL'20'      ZTABKY
     C                     MOVELSMCY      WA4
     C                     MOVE '1'       WA4
     C                     MOVE WA4       ZTABKY
     C                     EXSR UATBCN
     C*
     C** CHECK IF DATABASE ERROR OCCURRED
     C*
     C           *IN89     IFEQ '1'
     C                     MOVEL'TABLE'   WBFILE           **********
     C                     MOVELZTABKY    WBKEY            * DBERR 27
     C                     Z-ADD27        WBASE            **********
     C                     EXSR ABORT                      *ABORT PGM*
     C                     END
     C*
     C** STORE NUMBER OF DECIMAL PLACES FOR CURRENCY
     C*
     C                     Z-ADDCDP       SVCCDP  10
     C*
     C*
     C** FORMAT OTHER AMOUNTS & CURRENCIES
     C** IF CHARGES TO DEBIT A/C FIELD IS NON-ZERO USE BASE CURRENCY;
     C** OTHERWISE USE PCCY
     C*
     C***********CDRO      IFNE *ZERO                                                         CSD027
     C           CDRO      IFNE *BLANKS                                                       CSD027
     C                     MOVELBCCY      WCCY    3
     C                     MOVELBCCY      OCCY
     C                     MOVELBCCY      OCCY1
     C                     MOVELBCCY      CRNCY
     C                     MOVELBCCY      OCCY1A                          CFT009
     C*                                                                   S01494
     C** Check if SAR S01494 is set on                                    S01494
     C*                                                                   S01494
     C           *IN28     IFEQ '1'                                       S01494
     C                     MOVELBCCY      P2CHCY                          S01494
     C                     END                                            S01494
     C*                                                                   S01499
     C** Check if SAR S01499 is set on                                    S01499
     C*                                                                   S01499
     C           *IN29     IFEQ '1'                                       S01499
     C                     MOVELBCCY      P2VTCY                          S01499
     C                     END                                            S01499
     C*                                                                   S01499
     C                     Z-ADDSVBCDP    WDEC
     C                     ELSE
     C                     MOVELCRCY      WCCY
     C                     MOVELCRCY      OCCY
     C                     MOVELCRCY      OCCY1
     C                     MOVELCRCY      CRNCY
     C                     MOVELCRCY      OCCY1A                          CFT009
     C                     MOVELCRCY      WCCY                            CFT009
     C*                                                                   S01494
     C** Check if SAR S01494 is set on                                    S01494
     C*                                                                   S01494
     C           *IN28     IFEQ '1'                                       S01494
     C                     MOVELCRCY      P2CHCY                          S01494
     C                     END                                            S01494
     C*                                                                   S01499
     C** Check if SAR S01499 is set on                                    S01499
     C*                                                                   S01499
     C           *IN29     IFEQ '1'                                       S01499
     C*                                                                   S01499
     C                     MOVELCRCY      P2VTCY                          S01499
     C*                                                                   S01499
     C** Set up VAT flags for report                                      S01499
     C*                                                                   S01499
     C                     MOVE CCVAT1    P2TRVF                          S01499
     C                     MOVE CCVAT2    P2COVF                          S01499
     C                     MOVE CCVAT3    P2CSVF                          S01499
     C                     MOVE CCVAT4    P2TXVF                          S01499
     C           *IN28     IFEQ '1'                                       S01499
     C                     MOVE CCVAT5    P2CHVF                          S01499
     C                     END                                            S01499
     C*                                                                   S01499
     C                     END                                            S01499
     C*                                                                   S01499
     C                     Z-ADDSVCCDP    WDEC
     C                     END
     C*
     C           11        SUB  WDEC      WDIG
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CQAM      WFDIN
     C                     EXSR UGFRMT
     C                     MOVE WFDOUT    P2CQAM
      *                                                                   CFT009
      ** Only process these charges if core switchable feature is off     CFT009
      *                                                                   CFT009
     C           CFT009    IFNE 'Y'                                       CFT009
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE TRCM      WFDIN
     C                     EXSR UGFRMT
     C                     MOVE WFDOUT    P2TRCM
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE COLL      WFDIN
     C                     EXSR UGFRMT
     C                     MOVE WFDOUT    P2COLL
     C*                                                                   S01494
     C** Check if SAR S01494 is set on                                    S01494
     C*                                                                   S01494
     C           *IN28     IFEQ '1'                                       S01494
     C*                                                                   S01494
     C** Format FX/Change Commission                                      S01494
     C*                                                                   S01494
     C                     MOVEL*BLANKS   WFDIN                           S01494
     C                     MOVE CCCHCM    WFDIN                           S01494
     C                     EXSR UGFRMT                                    S01494
     C                     MOVE WFDOUT    P2CHCM                          S01494
     C*                                                                   S01494
     C                     END                                            S01494
     C*                                                                   S01499
     C** Check if SAR S01499 is set on                                    S01499
     C*                                                                   S01499
     C           *IN29     IFEQ '1'                                       S01499
     C*                                                                   S01499
     C** Format V.A.T. Charge                                             S01499
     C*                                                                   S01499
     C                     MOVEL*BLANKS   WFDIN                           S01499
     C                     MOVE CCVATT    WFDIN                           S01499
     C                     EXSR UGFRMT                                    S01499
     C                     MOVE WFDOUT    P2VATT                          S01499
     C*                                                                   S01499
     C                     END                                            S01499
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
     C*
     C** FORMAT CENTRAL BANK REFERENCE FOR OUTPUT
     C/COPY WNCPYSRC,FT1000C023
     C*
     C           DNBC1     IFEQ *ZERO
     C/COPY WNCPYSRC,FT1000C024
     C                     MOVE *BLANKS   FDNBC1
     C                     ELSE
     C                     MOVELDNBC1     FDNBC1
     C                     END
     C/COPY WNCPYSRC,FT1000C025
     C*
     C           DNBC2     IFEQ *ZERO
     C/COPY WNCPYSRC,FT1000C026
     C                     MOVE *BLANKS   FDNBC2
     C                     ELSE
     C                     MOVELDNBC2     FDNBC2
     C                     END
     C/COPY WNCPYSRC,FT1000C027
     C*
     C           DNBC3     IFEQ *ZERO
     C/COPY WNCPYSRC,FT1000C028
     C                     MOVE *BLANKS   FDNBC3
     C                     ELSE
     C                     MOVELDNBC3     FDNBC3
     C                     END
     C/COPY WNCPYSRC,FT1000C029
     C*
     C           DNBC4     IFEQ *ZERO
     C/COPY WNCPYSRC,FT1000C030
     C                     MOVE *BLANKS   FDNBC4
     C                     ELSE
     C                     MOVELDNBC4     FDNBC4
     C                     END
     C*
     C           DNBC5     IFEQ *ZERO
     C/COPY WNCPYSRC,FT1000C031
     C                     MOVE *BLANKS   FDNBC5
     C/COPY WNCPYSRC,FT1000C032
     C                     ELSE
     C                     MOVELDNBC5     FDNBC5
     C                     END
     C/COPY WNCPYSRC,FT1000C038
     C*
     C** FORMAT 'CRPY' + 'CDRO' FOR OUTPUT
     C*
     C                     MOVE CRPT      PRMTYP  1        ( CRPY )
     C**********           MOVE *ZEROS    PRMFLD 12                                           CGL029
     C                     MOVE *ZEROS    PRMFLD                                              CGL029
     C                     MOVELCRPY      PRMFLD
     C                     EXSR CHOPF
     C                     MOVELPRMFLD    FTCRPY
     C                     MOVE CRBR      P2CRBR                          S01117
     C*
     C                     WRITEP2CRAA                 60
     C*
      *                                                                   CFT009
      ** Only process these charges if core switchable feature is off     CFT009
      *                                                                   CFT009
     C           CFT009    IFNE 'Y'                                       CFT009
      *                                                                   CFT009
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CSTA      WFDIN
     C                     EXSR UGFRMT
     C                     MOVE WFDOUT    P2CSTA
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE TXCH      WFDIN
     C                     EXSR UGFRMT
     C                     MOVE WFDOUT    P2TXCH
     C*
     C                     WRITEP2CRBB                 60
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
     C*
     C                     MOVE CDRT      PRMTYP  1        ( CDRO )
     C**********           MOVE *ZEROS    PRMFLD 12                                           CGL029
     C                     MOVE *ZEROS    PRMFLD                                              CGL029
     C                     MOVELCDRO      PRMFLD
     C                     EXSR CHOPF
     C                     MOVELPRMFLD    FTCDRO
     C                     MOVE CDBR      P2CDBR                          S01117
     C*
     C                     WRITEP2CRCC                 60
      *                                                                   CFT009
      ** Only process these charges if core switchable feature is oN      CFT009
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
     C                     EXSR CALCG2                                    CFT009
     C                     WRITEP2CHGS                                    CFT009
     C                     ENDIF                                          CFT009
     C*
     C                     MOVE '1'       *IN82
     C*
     C                     ENDSR
      ********************************************************************CFT009
     C/EJECT                                                              CFT009
      ********************************************************************CFT009
      *                                                               *   CFT009
      * CALCG2 - SUBROUTINE TO CALCULATE CHARGES FOR CORE SWITCHABLE  *   CFT009
      *          FEATURE CFT009 (plus VAT component CFT010)           *   CFT009
      *                                                               *   CFT009
      ********************************************************************CFT009
      *                                                                ***CFT009
     C           CALCG2    BEGSR                                          CFT009
      *                                                                   CFT009
      ** Retrieve currency details                                        CFT009
      *                                                                   CFT009
     C                     CALL 'AOCURRR0'                                CFT009
     C                     PARM *BLANKS   @RTCD                           CFT009
     C                     PARM '*KEY   ' @OPTN                           CFT009
     C                     PARM WCCY      @CURR   3                       CFT009
     C           SDCURR    PARM SDCURR    DSSDY                           CFT009
      *                                                                   CFT009
     C           @RTCD     IFNE *BLANKS                                   CFT009
     C                     MOVE 'SDCURRPD'WBFILE           ***************CFT009
     C                     MOVELWCCY      WBKEY            ** DBERR  10 **CFT009
     C                     Z-ADD10        WBASE            ***************CFT009
     C                     EXSR ABORT                      *ABORT PGM*    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     Z-ADDA6NBDP    WNDP    10                      CFT009
     C                     Z-ADDWNDP      ZADEC                           CFT009
      *                                                                   CFT009
      ** Move spread set code in                                          CFT009
      *                                                                   CFT009
     C                     MOVE FXSPDS    P2FXSP                          CFT009
      *                                                                   CFT009
      ** MOVE CHARGE CODES IN                                             CFT009
      *                                                                   CFT009
     C                     MOVE TRCMCC    P2TRCD                          CFT009
     C                     MOVE COCHCD    P2COCD                          CFT009
     C                     MOVE CABCCD    P2CACD                          CFT009
     C                     MOVE TLXCHD    P2TXCD                          CFT009
     C                     MOVE FXCCCC    P2FXCD                          CFT009
      *                                                                   CFT009
      ** FORMAT TRANSFER COMMISSION CHARGE AMOUNT                         CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE TRCM      ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2TRCM                          CFT009
      *                                                                   CFT009
      ** FORMAT COLLECTION CHARGE AMOUNT                                  CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE COLL      ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2COLL                          CFT009
      *                                                                   CFT009
      ** Format FX/Change Commission                                      CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE CCCHCM    ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2CHCM                          CFT009
      *                                                                   CFT009
      ** Format COSTS ABROAD                                              CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE CSTA      ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2CSTA                          CFT009
      *                                                                   CFT009
      ** Format TELEX CHARGE                                              CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE TXCH      ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    P2TXCH                          CFT009
      *                                                                   CFT009
      ** Check if CFT010 is set on                                        CFT009
      *                                                                   CFT009
     C           CFT010    IFEQ 'Y'                                       CFT009
      *                                                                   CFT009
      ** Set up VAT flags for report                                      CFT009
      *                                                                   CFT009
     C                     MOVE CCVAT1    P2TRVF                          CFT009
     C                     MOVE CCVAT2    P2COVF                          CFT009
     C                     MOVE CCVAT3    P2CSVF                          CFT009
     C                     MOVE CCVAT4    P2TXVF                          CFT009
     C                     MOVE CCVAT5    P2CHVF                          CFT009
      *                                                                   CFT009
      ** Format the V.A.T. amount if CFT010 is active                     CFT009
      *                                                                   CFT009
     C           CCVAT4    IFEQ 'Y'                                       CFT009
     C           TXCH      MULT CCVATR    WVAT4  110H                     CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE WVAT4     ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    AVAT4                           CFT009
     C                     ELSE                                           CFT009
     C                     MOVE *BLANKS   AVAT4                           CFT009
     C                     MOVE *BLANKS   WVAT4                           CFT009
     C                     ENDIF                                          CFT009
     C           CCVAT3    IFEQ 'Y'                                       CFT009
     C           CSTA      MULT CCVATR    WVAT3  110H                     CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE WVAT3     ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    AVAT3                           CFT009
     C                     ELSE                                           CFT009
     C                     MOVE *BLANKS   AVAT3                           CFT009
     C                     MOVE *BLANKS   WVAT3                           CFT009
     C                     ENDIF                                          CFT009
     C           CCVAT1    IFEQ 'Y'                                       CFT009
     C           TRCM      MULT CCVATR    WVAT1  110H                     CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE WVAT1     ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    AVAT1                           CFT009
     C                     ELSE                                           CFT009
     C                     MOVE *BLANKS   AVAT1                           CFT009
     C                     MOVE *BLANKS   WVAT1                           CFT009
     C                     ENDIF                                          CFT009
     C           CCVAT2    IFEQ 'Y'                                       CFT009
     C           COLL      MULT CCVATR    WVAT2  110H                     CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE WVAT2     ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    AVAT2                           CFT009
     C                     ELSE                                           CFT009
     C                     MOVE *BLANKS   AVAT2                           CFT009
     C                     MOVE *BLANKS   WVAT2                           CFT009
     C                     ENDIF                                          CFT009
     C           CCVAT5    IFEQ 'Y'                                       CFT009
     C           CCCHCM    MULT CCVATR    WVAT5  110H                     CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE WVAT5     ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    AVAT5                           CFT009
     C                     ELSE                                           CFT009
     C                     MOVE *BLANKS   AVAT5                           CFT009
     C                     MOVE *BLANKS   WVAT5                           CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** CALCULATE TOTAL CHARGES AND FORMAT                               CFT009
      *                                                                   CFT009
      *                                                                   CFT009
      ** FORMAT TOTAL TELEX CHARGE AMOUNT                                 CFT009
      *                                                                   CFT009
     C           TXCH      ADD  WVAT4     WTTXC  110                      CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE WTTXC     ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    TCHG4                           CFT009
      *                                                                   CFT009
      ** FORMAT TOTAL TRANSFER COMMISSION                                 CFT009
      *                                                                   CFT009
     C           TRCM      ADD  WVAT1     WTTRC  110                      CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE WTTRC     ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    TCHG1                           CFT009
      *                                                                   CFT009
      ** FORMAT TOTAL COLLECTION CHARGE AMOUNT                            CFT009
      *                                                                   CFT009
     C           COLL      ADD  WVAT2     WTCOC  110                      CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE WTCOC     ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    TCHG2                           CFT009
      *                                                                   CFT009
      ** FORMAT TOTAL COSTS ABROAD CHARGE AMOUNT                          CFT009
      *                                                                   CFT009
     C           CSTA      ADD  WVAT3     WTCAC  140                      CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE WTCAC     ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    TCHG3                           CFT009
      *                                                                   CFT009
      ** FORMAT TOTAL FX COMMISSION CHARGE                                CFT009
      *                                                                   CFT009
     C           CCCHCM    ADD  WVAT5     WTFXC  110                      CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE WTFXC     ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    TCHG5                           CFT009
      *                                                                   CFT009
      ** CALCULATE GRAND TOTALS CHARGES AND FORMAT                        CFT009
      *                                                                   CFT009
     C                     Z-ADD0         WTLAM  140                      CFT009
     C           TXCH      ADD  TRCM      WTLAM                           CFT009
     C                     ADD  COLL      WTLAM                           CFT009
     C                     ADD  CCCHCM    WTLAM                           CFT009
     C                     ADD  CSTA      WTLAM                           CFT009
      *                                                                   CFT009
      ** FORMAT GRAND TOTAL AMOUNT                                        CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE WTLAM     ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    TAMT                            CFT009
      *                                                                   CFT009
      ** CALCULATE GRAND TOTAL VAT                                        CFT009
      *                                                                   CFT009
     C                     Z-ADD0         WTLVT                           CFT009
     C           CFT010    IFEQ 'Y'                                       CFT009
     C           WVAT1     ADD  WVAT2     WTLVT  130                      CFT009
     C                     ADD  WVAT3     WTLVT                           CFT009
     C                     ADD  WVAT4     WTLVT                           CFT009
     C                     ADD  WVAT5     WTLVT                           CFT009
      *                                                                   CFT009
      ** FORMAT GRAND TOTAL VAT                                           CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE WTLVT     ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    TVAT                            CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** CALCULATE GRAND TOTAL CHARGE                                     CFT009
      *                                                                   CFT009
     C                     Z-ADD0         WTLCG  150                      CFT009
     C           WTTXC     ADD  WTCAC     WTLCG                           CFT009
     C                     ADD  WTTRC     WTLCG                           CFT009
     C                     ADD  WTCOC     WTLCG                           CFT009
     C                     ADD  WTFXC     WTLCG                           CFT009
      *                                                                   CFT009
      ** FORMAT GRAND TOTAL CHARGE                                        CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE WTLCG     ZFIELD                          CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    TCHAM                           CFT009
      *                                                                   CFT009
     C                     ENDSR                                          CFT009
      *                                                                   CFT009
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C**    DEBIT  PROCESSING FOR CQPADDD
     C**
     C           CQPDBT    BEGSR                           ** DEBIT  **
     C*
     C           *IN53     IFEQ '0'
     C                     ADD  1         P3PAGE
     C                     WRITEP3HEDT                 60
     C                     SETON                     53
     C                     END
     C*
     C                     ADD  1         DBQPCT  10
     C*
     C           CFT009    IFEQ 'Y'                                       CFT009
     C           DBQPCT    IFGE 1                                         CFT009
     C                     SETOF                     53                   CFT009
     C                     Z-ADD0         DBQPCT                          CFT009
     C                     ENDIF                                          CFT009
     C                     ELSE                                           CFT009
     C           DBQPCT    IFGE 2
     C                     SETOF                     53
     C                     Z-ADD0         DBQPCT
     C                     END
     C                     ENDIF                                          CFT009
     C*                                                                   S01117
     C* IF MULTIBRANCHING INDICATOR ACTIVE, MOVE BOOKING BRANCH AND       S01117
     C* APPROPRIATE BRANCH NAME TO THE RELATIVE FIELDS SET UP WITHIN      S01117
     C* THE PRINTER FILE                                                  S01117
     C*                                                                   S01117
     C           *IN30     IFEQ '1'                                       S01117
     C                     MOVE BRCA      P3BRCA                          S01117
     C                     MOVE BRCA      WRKFLD                          S01117
     C                     EXSR SUBBRN                                    S01117
     C                     MOVELBRNM      P3BRNM                          S01117
     C*                                                                   S01117
     C* IF ORIGINATING BRANCH USED INDICATOR ACTIVE,MOVE ORBR AND         S01117
     C* APPROPRIATE BRANCH NAME TO THE RELATIVE FIELDS SET UP WITHIN      S01117
     C* THE PRINTER FILE                                                  S01117
     C*                                                                   S01117
     C           *IN35     IFEQ '1'                                       S01117
     C                     MOVE ORBR      P3ORBR                          S01117
     C                     MOVE ORBR      WRKFLD                          S01117
     C                     EXSR SUBBRN                                    S01117
     C                     MOVELBRNM      P3ORNM                          S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C*
     C** CALL UATBCN TO ACCESS CURRENCY RECORD FOR PAY CURRENCY
     C*
     C                     MOVEL*BLANKS   ZTABKY
     C                     MOVEL'20'      ZTABKY
     C                     MOVELPCCY      WA4
     C                     MOVE '1'       WA4
     C                     MOVE WA4       ZTABKY
     C                     EXSR UATBCN
     C*
     C** CHECK IF DATABASE ERROR OCCURRED
     C*
     C           *IN89     IFEQ '1'
     C                     MOVEL'TABLE'   WBFILE           **********
     C                     MOVELZTABKY    WBKEY            * DBERR 28
     C                     Z-ADD28        WBASE            **********
     C                     EXSR ABORT                      *ABORT PGM*
     C                     END
     C*
     C** STORE NUMBER OF DECIMAL PLACES FOR DEBIT CURRENCY
     C*
     C                     Z-ADDCDP       SVDCDP  10
     C*
     C** FORMAT OTHER AMOUNTS & CURRENCIES
     C** IF CHARGES TO DEBIT A/C FIELD IS NON-ZERO USE BASE CURRENCY;
     C** OTHERWISE USE PCCY
     C*
     C***********CDRO      IFNE *ZERO                                                         CSD027
     C           CDRO      IFNE *BLANKS                                                       CSD027
     C                     MOVELBCCY      WCCY    3
     C                     MOVELBCCY      OCCY1
     C                     MOVELBCCY      CRNCY
     C                     MOVELBCCY      OCCY2
     C*                                                                   S01494
     C** Check if SAR S01494 is set on                                    S01494
     C*                                                                   S01494
     C           *IN28     IFEQ '1'                                       S01494
     C                     MOVELBCCY      P3CHCY                          S01494
     C                     END                                            S01494
     C*                                                                   S01499
     C** Check if SAR S01499 is set on                                    S01499
     C*                                                                   S01499
     C           *IN29     IFEQ '1'                                       S01499
     C                     MOVELBCCY      P3VTCY                          S01499
     C                     END                                            S01499
     C*                                                                   S01499
     C                     Z-ADDSVBCDP    WDEC
     C                     ELSE
     C                     MOVELDRCY      WCCY
     C                     MOVELDRCY      OCCY1
     C                     MOVELDRCY      CRNCY
     C                     MOVELDRCY      OCCY2
     C*                                                                   S01494
     C** Check if SAR S01494 is set on                                    S01494
     C*                                                                   S01494
     C           *IN28     IFEQ '1'                                       S01494
     C                     MOVELDRCY      P3CHCY                          S01494
     C                     END                                            S01494
     C*                                                                   S01499
     C** Check if SAR S01499 is set on                                    S01499
     C*                                                                   S01499
     C           *IN29     IFEQ '1'                                       S01499
     C*                                                                   S01499
     C                     MOVELDRCY      P3VTCY                          S01499
     C*                                                                   S01499
     C** Set up VAT flags for report                                      S01499
     C*                                                                   S01499
     C                     MOVE PDVAT1    P3TRVF                          S01499
     C                     MOVE PDVAT2    P3COVF                          S01499
     C                     MOVE PDVAT3    P3CSVF                          S01499
     C           *IN28     IFEQ '1'                                       S01499
     C                     MOVE PDVAT4    P3CHVF                          S01499
     C                     END                                            S01499
     C*                                                                   S01499
     C                     END                                            S01499
     C*                                                                   S01499
     C                     Z-ADDSVDCDP    WDEC
     C                     END
     C*
     C           11        SUB  WDEC      WDIG
     C*
     C                     Z-ADDDRVD      ZDAYNO           'FORMAT DATE
     C                     EXSR ZDATE2                     'TO DDMMMYY
     C                     MOVE ZADATE    VDATO   7
     C*
     C                     Z-ADDOEDT      ZDAYNO           'FORMAT OEDT
     C                     EXSR ZDATE2                     'TO DDMMMYY
     C                     MOVE ZADATE    FTOEDT  7
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CQAM      WFDIN
     C                     EXSR UGFRMT
     C                     MOVE WFDOUT    P3CQAM
      *                                                                   CFT009
      ** If core switchable feature is on then do not process charges     CFT009
      *                                                                   CFT009
     C           CFT009    IFNE 'Y'                                       CFT009
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE TRCM      WFDIN
     C                     EXSR UGFRMT
     C                     MOVE WFDOUT    P3TRCM
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE COLL      WFDIN
     C                     EXSR UGFRMT
     C                     MOVE WFDOUT    P3COLL
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CSTA      WFDIN
     C                     EXSR UGFRMT
     C                     MOVE WFDOUT    P3CSTA
     C*                                                                   S01494
     C** Check if SAR S01494 is set on                                    S01494
     C*                                                                   S01494
     C           *IN28     IFEQ '1'                                       S01494
     C*                                                                   S01494
     C** Format FX/Change Commission                                      S01494
     C*                                                                   S01494
     C                     MOVEL*BLANKS   WFDIN                           S01494
     C                     MOVE PDCHCM    WFDIN                           S01494
     C                     EXSR UGFRMT                                    S01494
     C                     MOVE WFDOUT    P3CHCM                          S01494
     C*                                                                   S01494
     C                     END                                            S01494
     C*                                                                   S01499
     C** Check if SAR S01499 is set on                                    S01499
     C*                                                                   S01499
     C           *IN29     IFEQ '1'                                       S01499
     C*                                                                   S01499
     C** Format V.A.T. Charge                                             S01499
     C*                                                                   S01499
     C                     MOVEL*BLANKS   WFDIN                           S01499
     C                     MOVE PDVATT    WFDIN                           S01499
     C                     EXSR UGFRMT                                    S01499
     C                     MOVE WFDOUT    P3VATT                          S01499
     C*                                                                   S01499
     C                     END                                            S01499
      *                                                                   CFT009
     C                     ELSE                                           CFT009
     C                     EXSR CLCG3B                                    CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C*
     C** FORMAT 'DRPY' + 'CDRO' FOR OUTPUT
     C*
     C                     MOVE DRPT      PRMTYP           ( DRPY )
     C                     MOVE *ZEROS    PRMFLD
     C                     MOVELDRPY      PRMFLD
     C                     EXSR CHOPF
     C                     MOVELPRMFLD    P3DRPY
     C                     MOVE DRBR      P3DRBR                          S01117
     C*
     C                     MOVE CDRT      PRMTYP           ( CDRO )
     C                     MOVE *ZEROS    PRMFLD
     C                     MOVELCDRO      PRMFLD
     C                     EXSR CHOPF
     C                     MOVELPRMFLD    P3CDRO
     C                     MOVE CDBR      P3CDBR                          S01117
     C*
     C** FORMAT THE CENTRAL BANK REFERENCE
     C/COPY WNCPYSRC,FT1000C033
     C*
     C           DNBC      IFEQ *ZERO
     C/COPY WNCPYSRC,FT1000C034
     C                     MOVE *BLANKS   P3DNBC
     C                     ELSE
     C                     MOVELDNBC      P3DNBC
     C                     END
     C/COPY WNCPYSRC,FT1000C039
     C*
     C                     WRITEP3DEBT                 60
      *                                                                   CFT009
      ** If core switchable feature is on then then write new format      CFT009
      ** for charges                                                      CFT009
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
     C                     WRITEP3CHGB                                    CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     SETON                     83
     C*
     C                     ENDSR
      *                                                                   CFT009
      ********************************************************************CFT009
     C/EJECT                                                              CFT009
      ********************************************************************CFT009
      *                                                               *   CFT009
      * CLCG3B - SUBROUTINE TO CALCULATE CHARGES FOR CORE SWITCHABLE  *   CFT009
      *          FEATURE CFT009 (plus VAT component CFT010)           *   CFT009
      *                                                               *   CFT009
      ********************************************************************CFT009
      *                                                                ***CFT009
     C           CLCG3B    BEGSR                                          CFT009
      *                                                                   CFT009
      ** Currency                                                         CFT009
      *                                                                   CFT009
     C                     MOVE DRCY      TCCCY                           CFT009
     C                     MOVE DRCY      FXCCY                           CFT009
     C                     MOVE DRCY      CACCY                           CFT009
     C                     MOVE DRCY      CLCCY                           CFT009
      *                                                                   CFT009
      ** Charge code                                                      CFT009
      *                                                                   CFT009
     C                     MOVE TFCMCC    TCCDE                           CFT009
     C                     MOVE FCHCCC    FXCDE                           CFT009
     C                     MOVE CSTACD    CACDE                           CFT009
     C                     MOVE COLCGC    CLCDE                           CFT009
      *                                                                   CFT009
      ** Retrieve currency details                                        CFT009
      *                                                                   CFT009
     C                     CALL 'AOCURRR0'                                CFT009
     C                     PARM *BLANKS   @RTCD                           CFT009
     C                     PARM '*KEY   ' @OPTN                           CFT009
     C                     PARM DRCY      @CURR                           CFT009
     C           SDCURR    PARM SDCURR    DSSDY                           CFT009
      *                                                                   CFT009
     C           @RTCD     IFNE *BLANKS                                   CFT009
     C                     MOVE 'SDCURRPD'WBFILE           ***************CFT009
     C                     MOVELDRCY      WBKEY            ** DBERR  11 **CFT009
     C                     Z-ADD11        WBASE            ***************CFT009
     C                     EXSR ABORT                      *ABORT PGM*    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Debit currency                                                   CFT009
      *                                                                   CFT009
     C                     Z-ADDA6NBDP    WDRCY   10                      CFT009
      *                                                                   CFT009
      ** Amount                                                           CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE TRCM      ZFIELD                          CFT009
     C                     Z-ADDWDRCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    TCAMT                           CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE PDCHCM    ZFIELD                          CFT009
     C                     Z-ADDWDRCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    FXAMT                           CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE CSTA      ZFIELD                          CFT009
     C                     Z-ADDWDRCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    CAAMT                           CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE COLL      ZFIELD                          CFT009
     C                     Z-ADDWDRCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    CLAMT                           CFT009
      *                                                                   CFT009
      ** Totals                                                           CFT009
      *                                                                   CFT009
     C           TRCM      ADD  PDCHCM    SUMAMT 150                      CFT009
     C                     ADD  CSTA      SUMAMT                          CFT009
     C                     ADD  COLL      SUMAMT                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE SUMAMT    ZFIELD                          CFT009
     C                     Z-ADDWDRCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    TOTAMT                          CFT009
      *                                                                   CFT009
     C           CFT010    IFEQ 'Y'                                       CFT009
      *                                                                   CFT009
      ** VAT flags                                                        CFT009
      *                                                                   CFT009
     C                     MOVE PDVAT1    TCVAT                           CFT009
     C                     MOVE PDVAT4    FXVAT                           CFT009
     C                     MOVE PDVAT3    CAVAT                           CFT009
     C                     MOVE PDVAT2    CLVAT                           CFT009
      *                                                                   CFT009
      ** VAT amount and total charge                                      CFT009
      *                                                                   CFT009
     C           PDVAT1    IFEQ 'Y'                                       CFT009
     C           PDVATR    MULT TRCM      VAT    150H                     CFT009
     C                     Z-ADDVAT       SUMVAT 150                      CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     Z-ADD0         SUMVAT                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE VAT       ZFIELD                          CFT009
     C                     Z-ADDWDRCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    TCVATA                          CFT009
      *                                                                   CFT009
     C           VAT       ADD  TRCM      CHG    150                      CFT009
     C                     Z-ADDCHG       SUMCHG 150                      CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE CHG       ZFIELD                          CFT009
     C                     Z-ADDWDRCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    TCTOT                           CFT009
      *                                                                   CFT009
     C           PDVAT4    IFEQ 'Y'                                       CFT009
     C           PDVATR    MULT PDCHCM    VAT                             CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE VAT       ZFIELD                          CFT009
     C                     Z-ADDWDRCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    FXVATA                          CFT009
      *                                                                   CFT009
     C           VAT       ADD  PDCHCM    CHG                             CFT009
     C                     ADD  CHG       SUMCHG                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE CHG       ZFIELD                          CFT009
     C                     Z-ADDWDRCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    FXTOT                           CFT009
      *                                                                   CFT009
     C           PDVAT3    IFEQ 'Y'                                       CFT009
     C           PDVATR    MULT CSTA      VAT                             CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE VAT       ZFIELD                          CFT009
     C                     Z-ADDWDRCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    CAVATA                          CFT009
      *                                                                   CFT009
     C           VAT       ADD  CSTA      CHG                             CFT009
     C                     ADD  CHG       SUMCHG                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE CHG       ZFIELD                          CFT009
     C                     Z-ADDWDRCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    CATOT                           CFT009
      *                                                                   CFT009
     C           PDVAT2    IFEQ 'Y'                                       CFT009
     C           PDVATR    MULT COLL      VAT                             CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE VAT       ZFIELD                          CFT009
     C                     Z-ADDWDRCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    CLVATA                          CFT009
      *                                                                   CFT009
     C           VAT       ADD  COLL      CHG                             CFT009
     C                     ADD  CHG       SUMCHG                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE CHG       ZFIELD                          CFT009
     C                     Z-ADDWDRCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    CLTOT                           CFT009
      *                                                                   CFT009
      ** Totals                                                           CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE SUMVAT    ZFIELD                          CFT009
     C                     Z-ADDWDRCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    TOTVAT                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE SUMCHG    ZFIELD                          CFT009
     C                     Z-ADDWDRCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    TOTCHG                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                ***CFT009
     C                     ENDSR                                          CFT009
      *                                                                ***CFT009
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C**   CREDIT PROCESSING FOR CQPACDD
     C**
     C           CQPCRD    BEGSR                           ** CREDIT **
     C*
     C           *IN54     IFEQ '0'
     C                     ADD  1         P3PAGE
     C                     WRITEP3HEDT                 60
     C                     SETON                     54
     C                     END
     C*
     C                     ADD  1         CRQPCT  10
     C*
     C           CRQPCT    IFGE 1
     C                     SETOF                     54
     C                     Z-ADD0         CRQPCT
     C                     END
     C*
     C* IF MULTIBRANCHING INDICATOR ACTIVE, MOVE BOOKING BRANCH AND       S01117
     C* APPROPRIATE BRANCH NAME TO THE RELATIVE FIELDS SET UP WITHIN      S01117
     C* THE PRINTER FILE                                                  S01117
     C*                                                                   S01117
     C           *IN30     IFEQ '1'                                       S01117
     C                     MOVE BRCA      P3BRCA                          S01117
     C                     MOVE BRCA      WRKFLD                          S01117
     C                     EXSR SUBBRN                                    S01117
     C                     MOVELBRNM      P3BRNM                          S01117
     C*                                                                   S01117
     C* IF ORIGINATING BRANCH USED INDICATOR ACTIVE,MOVE ORBR AND         S01117
     C* APPROPRIATE BRANCH NAME TO THE RELATIVE FIELDS SET UP WITHIN      S01117
     C* THE PRINTER FILE                                                  S01117
     C*                                                                   S01117
     C           *IN35     IFEQ '1'                                       S01117
     C                     MOVE ORBR      P3ORBR                          S01117
     C                     MOVE ORBR      WRKFLD                          S01117
     C                     EXSR SUBBRN                                    S01117
     C                     MOVELBRNM      P3ORNM                          S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C           RBKT      IFNE 'C'
     C*
     C                     MOVE RBK1      CBANK1
     C*                                                                   S01117
     C* IF MULTIBRANCHING INDICATOR SETOF AND FULL ACCOUNT ENTRY,SINGLE   S01117
     C* BRANCH NEED TO BE FORMATTED BY CUTTING OFF THE BRANCH CODE FROM   S01117
     C* THE END USING A WORK FIELD BEFORE OUTPUTING TO THE PRINTER FILE   S01117
     C*                                                                   S01117
     C           *IN30     IFEQ '0'                                       S01117
     C           RBKT      ANDEQ'G'                                       S01117
     C                     MOVELRBK1      FLD15                           S01117
     C                     MOVE *BLANKS   CBANK1                          S01117
     C                     MOVELFLD15     CBANK1                          S01117
     C                     END                                            S01117
     C                     MOVE RBK2      CBANK2
     C                     MOVE RBK3      CBANK3
     C                     MOVE RBK4      CBANK4
     C*
     C                     ELSE                            ### B001
     C                     MOVELRBK1      WCLNUM
     C                     MOVEL'B'       WCLRCT
     C                     EXSR UCCLCN
     C*
     C           *IN89     IFEQ '1'                        ### B002
     C                     MOVE 'CLINT'   WBFILE           ***************
     C                     MOVELWCLNUM    WA7              ** DBERR  29 **
     C                     MOVE WCLRCT    WA7              ************
     C                     MOVELWA7       WBKEY
     C                     Z-ADD29        WBASE                        ***
     C                     EXSR ABORT
     C                     END                             ### E002
     C*
     C                     MOVE CNA1      CBANK1
     C                     MOVE CNA2      CBANK2
     C                     MOVE CNA3      CBANK3
     C                     MOVE CNA4      CBANK4
     C*
     C                     END                             ### E001
     C*                                                                   S01117
     C                     MOVE DRW1      P3DRW1                          S01117
     C*
     C* IF MULTIBRANCHING INDICATOR SETOF AND FULL ACCOUNT ENTRY,SINGLE   S01117
     C* BRANCH NEED TO BE FORMATTED BY CUTTING OFF THE BRANCH CODE FROM   S01117
     C* THE END USING A WORK FIELD BEFORE OUTPUTING TO THE PRINTER FILE   S01117
     C*                                                                   S01117
     C           *IN30     IFEQ '0'                                       S01117
     C           DRWT      ANDEQ'G'                                       S01117
     C                     MOVELDRW1      FLD15                           S01117
     C                     MOVE *BLANKS   P3DRW1                          S01117
     C                     MOVELFLD15     P3DRW1                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     Z-ADDPVDT      ZDAYNO           'FORMAT DATE
     C                     EXSR ZDATE2                     'TO DDMMMYY
     C                     MOVE ZADATE    VDATO   7
     C*
     C                     Z-ADDOEDT      ZDAYNO           'FORMAT OEDT
     C                     EXSR ZDATE2                     'TO DDMMMYY
     C                     MOVE ZADATE    FTOEDT  7
     C*
     C** CALL UATBCN TO ACCESS CURRENCY RECORD FOR PAY CURRENCY
     C*
     C                     MOVEL*BLANKS   ZTABKY
     C                     MOVEL'20'      ZTABKY
     C                     MOVELPCCY      WA4
     C                     MOVE '1'       WA4
     C                     MOVE WA4       ZTABKY
     C                     EXSR UATBCN
     C*
     C** CHECK IF DATABASE ERROR OCCURRED
     C*
     C           *IN89     IFEQ '1'
     C                     MOVEL'TABLE'   WBFILE           **********
     C                     MOVELZTABKY    WBKEY            * DBERR 30
     C                     Z-ADD30        WBASE            **********
     C                     EXSR ABORT                      *ABORT PGM*
     C                     END
     C*
     C** STORE NUMBER OF DECIMAL PLACES FOR PAY CURRENCY
     C*
     C                     Z-ADDCDP       SVPCDP  10
     C*
     C                     ADD  COCH      TOTD
     C                     SUB  DEDS      TOTD
     C*
     C                     MOVE PCCY      CRNCY
     C                     MOVE PCCY      OCCY
     C                     MOVE PCCY      OCCY1
      *                                                                   CFT009
      ** If core switchable feature is on then do not do this charge      CFT009
      ** processing                                                       CFT009
      *                                                                   CFT009
     C           CFT009    IFNE 'Y'                                       CFT009
     C*                                                                   S01499
     C** Check if SAR S01499 is set on                                    S01499
     C*                                                                   S01499
     C           *IN29     IFEQ '1'                                       S01499
     C                     MOVELPCCY      P3VOCY                          S01499
     C                     MOVELPCCY      P3VDCY                          S01499
     C                     END                                            S01499
     C*
     C                     Z-ADDSVPCDP    WDEC
     C           11        SUB  WDEC      WDIG
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE TOTD      WFDIN
     C                     EXSR UGFRMT
     C                     MOVE WFDOUT    P3TOTD
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE TOTR      WFDIN
     C                     EXSR UGFRMT
     C                     MOVE WFDOUT    P3TOTR
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE COCH      WFDIN
     C                     EXSR UGFRMT
     C                     MOVE WFDOUT    P3COCH
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE DEDS      WFDIN
     C                     EXSR UGFRMT
     C                     MOVE WFDOUT    P3DEDS
     C*                                                                   S01499
     C** Check if SAR S01499 is set on                                    S01499
     C*                                                                   S01499
     C           *IN29     IFEQ '1'                                       S01499
     C*                                                                   S01499
     C** Format Correspondent V.A.T.                                      S01499
     C*                                                                   S01499
     C                     MOVEL*BLANKS   WFDIN                           S01499
     C                     MOVE PCVATC    WFDIN                           S01499
     C                     MOVE PCVAT1    P3CRVF                          S01499
     C                     EXSR UGFRMT                                    S01499
     C                     MOVE WFDOUT    P3VACO                          S01499
     C*                                                                   S01499
     C** Format Deduction V.A.T.                                          S01499
     C*                                                                   S01499
     C                     MOVEL*BLANKS   WFDIN                           S01499
     C                     MOVE PCVATD    WFDIN                           S01499
     C                     MOVE PCVAT2    P3DEVF                          S01499
     C                     EXSR UGFRMT                                    S01499
     C                     MOVE WFDOUT    P3VADE                          S01499
     C*                                                                   S01499
     C                     END                                            S01499
      *                                                                   CFT009
     C                     ELSE                                           CFT009
      *                                                                   CFT009
     C                     EXSR CLCG3A                                    CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
     C*
     C*  FORMAT 'SNCO' FOR OUTPUT
     C                     MOVE SNCT      PRMTYP  1        ( SNCO )
     C**********           MOVE *ZEROS    PRMFLD 12                                           CGL029
     C                     MOVE *ZEROS    PRMFLD                                              CGL029
     C                     MOVELSNCO      PRMFLD
     C                     EXSR CHOPF
     C                     MOVELPRMFLD    P3SNCO
     C*                                                                   S01117
     C*  FORMAT SWIFT PRIORITY CODE                                       S01117
     C           SWPC      IFEQ 1                                         S01117
     C                     MOVE 'U'       P3SWPC                          S01117
     C                     ELSE                                           S01117
     C           SWPC      IFEQ 2                                         S01117
     C                     MOVE 'N'       P3SWPC                          S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C*
     C                     WRITEP3CRED                 60
      *                                                                   CFT009
      ** Write new record format, for charges if core switchable featur   CFT009
      ** is on.                                                           CFT009
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
     C                     WRITEP3CHGA                                    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     SETON                     83
     C*
     C                     ENDSR
     C*
      ********************************************************************CFT009
     C/EJECT                                                              CFT009
      ********************************************************************CFT009
      *                                                               *   CFT009
      * CLCG3A - SUBROUTINE TO CALCULATE CHARGES FOR CORE SWITCHABLE  *   CFT009
      *          FEATURE CFT009 (plus VAT component CFT010)           *   CFT009
      *                                                               *   CFT009
      ********************************************************************CFT009
      *                                                                ***CFT009
     C           CLCG3A    BEGSR                                          CFT009
      *                                                                   CFT009
      ** FX spread set                                                    CFT009
      *                                                                   CFT009
     C                     MOVE FXSSET    FXSPST                          CFT009
      *                                                                   CFT009
      ** Currency                                                         CFT009
      *                                                                   CFT009
     C                     MOVE PCCY      COCCY                           CFT009
     C                     MOVE PCCY      DECCY                           CFT009
      *                                                                   CFT009
      ** Charge code                                                      CFT009
      *                                                                   CFT009
     C                     MOVE CRCHCD    COCDE                           CFT009
     C                     MOVE DECHCD    DECDE                           CFT009
      *                                                                   CFT009
      ** Retrieve currency details                                        CFT009
      *                                                                   CFT009
     C                     CALL 'AOCURRR0'                                CFT009
     C                     PARM *BLANKS   @RTCD                           CFT009
     C                     PARM '*KEY   ' @OPTN                           CFT009
     C                     PARM PCCY      @CURR   3                       CFT009
     C           SDCURR    PARM SDCURR    DSSDY                           CFT009
      *                                                                   CFT009
     C           @RTCD     IFNE *BLANKS                                   CFT009
     C                     MOVE 'SDCURRPD'WBFILE           ***************CFT009
     C                     MOVELPCCY      WBKEY            ** DBERR  12 **CFT009
     C                     Z-ADD12        WBASE            ***************CFT009
     C                     EXSR ABORT                      *ABORT PGM*    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Prime currency                                                   CFT009
      *                                                                   CFT009
     C                     Z-ADDA6NBDP    WPCCY   10                      CFT009
      *                                                                   CFT009
      ** Amount                                                           CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE COCH      ZFIELD                          CFT009
     C                     Z-ADDWPCCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    COAMT                           CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE DEDS      ZFIELD                          CFT009
     C                     Z-ADDWPCCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    DEAMT                           CFT009
      *                                                                   CFT009
      ** Totals                                                           CFT009
      *                                                                   CFT009
     C           COCH      ADD  DEDS      SUMAMT 150                      CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE SUMAMT    ZFIELD                          CFT009
     C                     Z-ADDWPCCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    TOTAMT                          CFT009
      *                                                                   CFT009
     C           CFT010    IFEQ 'Y'                                       CFT009
      *                                                                   CFT009
      ** VAT flags                                                        CFT009
      *                                                                   CFT009
     C                     MOVE PCVAT1    COVAT                           CFT009
     C                     MOVE PCVAT2    DEVAT                           CFT009
      *                                                                   CFT009
      ** VAT amount and total charge                                      CFT009
      *                                                                   CFT009
     C           PCVAT1    IFEQ 'Y'                                       CFT009
     C                     Z-ADDPCVATC    VAT                             CFT009
     C                     Z-ADDVAT       SUMVAT                          CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     Z-ADD0         SUMVAT                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE VAT       ZFIELD                          CFT009
     C                     Z-ADDWPCCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    COVATA                          CFT009
      *                                                                   CFT009
     C           VAT       ADD  COCH      CHG                             CFT009
      *                                                                   CFT009
     C                     Z-ADDCHG       SUMCHG                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE CHG       ZFIELD                          CFT009
     C                     Z-ADDWPCCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    COTOT                           CFT009
      *                                                                   CFT009
     C           PCVAT2    IFEQ 'Y'                                       CFT009
     C                     ADD  PCVATD    VAT                             CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE VAT       ZFIELD                          CFT009
     C                     Z-ADDWPCCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    DEVATA                          CFT009
      *                                                                   CFT009
     C           VAT       ADD  DEDS      CHG                             CFT009
     C                     ADD  CHG       SUMCHG                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE CHG       ZFIELD                          CFT009
     C                     Z-ADDWPCCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    DETOT                           CFT009
      *                                                                   CFT009
      ** Totals                                                           CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE SUMVAT    ZFIELD                          CFT009
     C                     Z-ADDWPCCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    TOTVAT                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE SUMCHG    ZFIELD                          CFT009
     C                     Z-ADDWPCCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    TOTCHG                          CFT009
      *                                                                ***CFT009
     C                     ENDIF                                          CFT009
      *                                                                ***CFT009
     C                     ENDSR                                          CFT009
      *                                                                ***CFT009
     C********************************************************************
     C/EJECT                                                              S01117
     C********************************************************************S01117
     C**                                                                  S01117
     C** SUBROUTINE TO ACCESS BRANCH NAME(BRNM) FROM TABLETR              S01117
     C**                                                                  S01117
     C**                                                                  S01117
     C           SUBBRN    BEGSR                                          S01117
     C*                                                                   S01117
     C* SET UP KEY TO ACCESS BRANCH NAME                                  S01117
     C*                                                                   S01117
     C**********           MOVE *BLANKS   ZTABKY                          S01117             BUG7985
     C**********           MOVEL'10    '  ZTABKY                          S01117             BUG7985
     C**********           MOVE WRKFLD    ZTABKY                          S01117             BUG7985
     C*                                                                   S01117
     C********** ZTABKY    CHAINTABFP                99                   S01117             BUG7985
      *                                                                                      BUG7985
     C                     CALL 'AOBRCHR1'                                                   BUG7985
     C                     PARM *BLANKS   PRTCD   7                                          BUG7985
     C                     PARM '*KEY   ' POPTN   7                                          BUG7985
     C                     PARM WRKFLD    PBRCH   3                                          BUG7985
     C           SDBRCH    PARM SDBRCH    DSSDY                                              BUG7985
     C*                                                                   S01117
     C* DATABASE ERROR IF NO RECORD FOUND                                 S01117
     C*                                                                   S01117
     C           PRTCD     IFNE *BLANKS                                                      BUG7985
     C********** *IN99     IFEQ '1'                                       S01117             BUG7985
     C********** RECI      ORNE 'D'                                       S01117             BUG7985
     C**********           MOVE 'TABLE'   WBFILE           ***************S01117             BUG7985
     C**********           MOVELZTABKY    WBKEY            ** DBERR  45 **S01117
     C                     MOVE 'SDBRCHPD'WBFILE                                             BUG7985
     C                     MOVELWRKFLD    WBKEY                                              BUG7985
     C                     Z-ADD45        WBASE            ***************S01117
     C                     EXSR ABORT                                     S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     ENDSR                                          S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C/EJECT
     C********************************************************************
     C**
     C**   ZDATE2 SR. TO CONVERT A DAY NUMBER TO DATE FORMATS.
     C**
     C**   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.
     C**
     C           ZDATE2    BEGSR                           *** ZDATE2 ***
     C**
     C**   CLEAR DATE FIELDS.
     C                     Z-ADD0         ZDATE   60
     C                     MOVEL'       ' ZADATE  7
     C**
     C**   CALCULATION TO DEFINE INPUT DAY NUMBER.
     C                     Z-ADDZDAYNO    ZDAYNO  50
     C**
     C**   DETERMINE YEAR NUMBER.
     C**
     C**   ADJUST DAY NUMBER IN CASE LAST DAY OF YEAR.
     C           ZDAYNO    SUB  1         ZDAYN1  50   99
     C   99                GOTO ZDEND2
     C**
     C**   CALCULATE NUMBER OF 4 YEAR SPANS SINCE 31/12/1971.
     C           ZDAYN1    DIV  1461      ZLYR    20
     C                     MVR            ZDAYN1           SAVE REMAINING
     C**                                                   DAYS
     C**   CALCULATE NUMBER OF REMAINING YEARS.
     C                     Z-ADD1         ZWRK2   20
     C           ZDTAG1    TAG                             ** ZDTAG1 TAG *
     C           ZDAYN1    COMP ZYDY,ZWRK2             90
     C  N90      ZWRK2     ADD  1         ZWRK2
     C  N90                GOTO ZDTAG1
     C           ZWRK2     SUB  1         ZWRK2          91LEAP YR, 91 ON
     C**
     C**   DECREMENT DAY NO. BY DAYS IN REMAINING YEARS.
     C  N91      ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1
     C**
     C**   CALCULATE ACTUAL YEAR NUMBER.
     C           ZLYR      MULT 4         ZWRK3   30
     C           ZWRK3     ADD  72        ZWRK3            BASE IS 1972
     C                     Z-ADDZWRK3     ZYEAR   20
     C           ZYEAR     ADD  ZWRK2     ZYEAR            YEAR
     C**
     C**   DETERMINE MONTH NUMBER.
     C**
     C**   ADJUST DAY NO. IN CASE LAST DAY OF LEAP YEAR FEBRUARY.
     C                     SETOF                     9293
     C   91      ZDAYN1    COMP 59                     9293
     C   91N92   ZDAYN1    SUB  1         ZDAYN1
     C**
     C**   CALCULATE MONTH NUMBER.
     C                     Z-ADD2         ZWRK2
     C           ZDTAG2    TAG                             ** ZDTAG2 TAG *
     C           ZDAYN1    COMP ZMDY,ZWRK2             94
     C  N94      ZWRK2     ADD  1         ZWRK2
     C  N94                GOTO ZDTAG2
     C           ZWRK2     SUB  1         ZWRK2
     C**
     C                     Z-ADDZWRK2     ZMTH    20       MONTH
     C**
     C**   DETERMINE DAY OF MONTH.
     C**
     C**   ADD BACK LAST DAY OF YEAR ADJUSTMENT.
     C           ZDAYN1    ADD  1         ZDAYN1
     C**
     C**   CALCULATE DAY OF MONTH.
     C           ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY
     C**
     C**   ADD BACK LEAP YEAR 29TH FEBUARY ADJUSTMENT, IF REQUIRED.
     C   93      ZDAY      ADD  1         ZDAY
     C**
     C**   FORMAT DATE, DDMMYY OR MMDDYY.
     C  N98                MOVELZDAY      ZWRK4   40
     C   98                MOVE ZDAY      ZWRK4
     C  N98                MOVE ZMTH      ZWRK4
     C   98                MOVELZMTH      ZWRK4
     C                     MOVELZWRK4     ZDATE
     C                     MOVE ZYEAR     ZDATE
     C**
     C**   FORMAT ALPHA DATE, DDMMMYY.
     C           ZDAY      COMP 10                     95
     C                     MOVELZDAY      ZWRK5   5
     C   95                MOVEL' '       ZWRK5
     C                     MOVE ZMNM,ZMTH ZWRK5
     C                     MOVELZWRK5     ZADATE
     C                     MOVE ZYEAR     ZADATE
     C**
     C           ZDEND2    ENDSR                           * ZDEND2 ENDSR*
     C**
     C********************************************************************
     C/EJECT
     C********************************************************************
     C*
     C*  FUNCTION : TO ABORT THE PROGRAM IN THE EVENT OF A DATABASE
     C*             ERROR.
     C*
     C           ABORT     BEGSR
     C*
     C** SETON INDICATORS TO INDICATE DATABASE ERRORS
     C*
     C                     SETON                     U7U8LR
     C*
     C           *NAMVAR   DEFN LDA       DLDA
     C           *LOCK     IN   DLDA
     C                     MOVEL'FT1000'  DBPGM
     C                     MOVELWBKEY     DBKEY
     C                     MOVELWBFILE    DBFILE
     C*********************MOVELWBASE     DBASE                           S01117
     C                     Z-ADDWBASE     DBASE                           S01117
     C                     OUT  DLDA
     C*
     C** REPORT DATABASE ERROR
     C*
     C                     EXSR INPAYT
     C                     EXSR OTPAYT
     C                     EXSR CQCODT
     C                     EXSR CQCOCT
     C                     EXSR CQPACT
     C                     EXSR CQPADT
     C                     EXSR NTRANT
     C**********           EXSR NTRANT                                                        KIDD01
     C*
     C*********************MOVELDBASE     P2DBAS                          S01117
     C*********************MOVELDBFILE    P2DBFL                          S01117
     C*********************MOVELDBKEY     P2DBKY                          S01117
     C*********************WRITEP1CONT                                    S01117
     C*********************WRITEP1DBER                                    S01117
     C                     MOVELDBASE     AUDBAS                          S01117
     C                     MOVELDBFILE    AUDBFL                          S01117
     C                     MOVELDBKEY     AUDBKY                          S01117
     C                     WRITEAUCONT                                    S01117
     C                     WRITEAUDBER                                    S01117
     C*
     C** PRODUCE PROGRAM DUMP
     C*
     C                     DUMP
     C*
     C** END PROGRAM
     C*
     C                     RETRN
     C*
     C           UEEND     ENDSR
     C*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C**   COMPARE THE TOTALS ON EACH TRAILER AND SETON THE
     C**   APPROPRIATE ERROR INDICATOR
     C**
     C           TRAILR    BEGSR                           ** TRAILR **
     C*
     C           H         ADD  60        W       20
     C           NORE1     IFNE CTN#,H
     C           HRWN      ORNE CTI#,H
     C           HRDC      ORNE CTD#,H
     C                     MOVE '1'       *IN,W
     C                     END
     C                     ENDSR
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**   .. INPAYT ..
     C**   THIS SUBR. IS USED TO SET-UP FIELDS FOR THE 'CONTROL REPORT'
     C**
     C           INPAYT    BEGSR                           ** INPAYT **
     C*
     C                     Z-ADD1         H
     C                     EXSR TRAILR
     C*
     C           *IN61     IFEQ '1'
     C                     MOVE DIFFXX    DIFF01
     C                     END
     C*
     C                     Z-ADDNORE1     ITN#01
     C                     Z-ADDHRWN      ITI#01
     C                     Z-ADDHRDC      ITD#01
     C                     Z-ADDCTN#,H    CTN#01
     C                     Z-ADDCTI#,H    CTI#01
     C                     Z-ADDCTD#,H    CTD#01
     C*
     C                     ADD  7         H
     C                     Z-ADDCTN#,H    NORE1
     C                     Z-ADDCTI#,H    HRWN
     C                     Z-ADDCTD#,H    HRDC
     C                     Z-ADDCTN#,H    CTN#08
     C                     Z-ADDCTI#,H    CTI#08
     C                     Z-ADDCTD#,H    CTD#08
     C                     MOVEL@R02      RECI                            E32839
     C                     UPDATINPAYZZF                                  E32894
     C*********************WRITEXNPAYZZF               88                 E32894
     C*********************                                               E32894
     C************IN88*****IFEQ '1'                                       E32894
     C*********************MOVE 'INPAY'   WBFILE           ***************E32894
     C*********************MOVELWRTERR    WBKEY            ** DBERR  31 **E32894
     C*********************Z-ADD31        WBASE            ***************E32894
     C*********************EXSR ABORT                                     E32894
     C*********************END                                            E32894
     C                     ENDSR
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**   .. OTPAYT ..
     C**   THIS SUBR. IS USED TO SET-UP FIELDS FOR THE 'CONTROL REPORT'
     C**
     C           OTPAYT    BEGSR                           ** OTPAYT **
     C*
     C                     Z-ADD2         H
     C                     EXSR TRAILR
     C*
     C           *IN62     IFEQ '1'
     C                     MOVE DIFFXX    DIFF02
     C                     END
     C*
     C                     Z-ADDNORE1     ITN#02
     C                     Z-ADDHRWN      ITI#02
     C                     Z-ADDHRDC      ITD#02
     C                     Z-ADDCTN#,H    CTN#02
     C                     Z-ADDCTI#,H    CTI#02
     C                     Z-ADDCTD#,H    CTD#02
     C*
     C                     ADD  7         H
     C                     Z-ADDCTN#,H    NORE1
     C                     Z-ADDCTI#,H    HRWN
     C                     Z-ADDCTD#,H    HRDC
     C                     Z-ADDCTN#,H    CTN#09
     C                     Z-ADDCTI#,H    CTI#09
     C                     Z-ADDCTD#,H    CTD#09
     C                     MOVEL@R04      RECI                            E32839
     C                     UPDATOTPAYZZF                                  E32894
     C*********************WRITEXTPAYZZF               88                 E32894
     C*********************                                               E32894
     C************IN88*****IFEQ '1'                                       E32894
     C*********************MOVE 'OTPAY'   WBFILE           ***************E32894
     C*********************MOVELWRTERR    WBKEY            ** DBERR  32 **E32894
     C*********************Z-ADD32        WBASE            ***************E32894
     C*********************EXSR ABORT                                     E32894
     C*********************END                                            E32894
     C                     ENDSR
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**   .. CQCODT ..
     C**   THIS SUBR. IS USED TO SET-UP FIELDS FOR THE 'CONTROL REPORT'
     C**
     C           CQCODT    BEGSR                           ** CQCODT **
     C*
     C                     Z-ADD3         H
     C                     EXSR TRAILR
     C*
     C           *IN63     IFEQ '1'
     C                     MOVE DIFFXX    DIFF03
     C                     END
     C*
     C                     Z-ADDNORE1     ITN#03
     C                     Z-ADDHRWN      ITI#03
     C                     Z-ADDHRDC      ITD#03
     C                     Z-ADDCTN#,H    CTN#03
     C                     Z-ADDCTI#,H    CTI#03
     C                     Z-ADDCTD#,H    CTD#03
     C*
     C                     ADD  7         H
     C                     Z-ADDCTN#,H    NORE1
     C                     Z-ADDCTI#,H    HRWN
     C                     Z-ADDCTD#,H    HRDC
     C                     Z-ADDCTN#,H    CTN#10
     C                     Z-ADDCTI#,H    CTI#10
     C                     Z-ADDCTD#,H    CTD#10
     C*
     C                     MOVEL@R06      RECI                            E32839
     C                     UPDATCQCODZZF                                  E32894
     C*********************WRITEXQCODZZF               88                 E32894
     C*********************                                               E32894
     C************IN88*****IFEQ '1'                                       E32894
     C*********************MOVE 'CQCOD'   WBFILE           ***************E32894
     C*********************MOVELWRTERR    WBKEY            ** DBERR  33 **E32894
     C*********************Z-ADD33        WBASE            ***************E32894
     C*********************EXSR ABORT                                     E32894
     C*********************END                                            E32894
     C                     ENDSR
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**   .. CQCOCT ..
     C**   THIS SUBR. IS USED TO SET-UP FIELDS FOR THE 'CONTROL REPORT'
     C**
     C           CQCOCT    BEGSR                           ** CQCOCT **
     C*
     C                     Z-ADD4         H
     C                     EXSR TRAILR
     C*
     C           *IN64     IFEQ '1'
     C                     MOVE DIFFXX    DIFF04
     C                     END
     C*
     C                     Z-ADDNORE1     ITN#04
     C                     Z-ADDHRWN      ITI#04
     C                     Z-ADDHRDC      ITD#04
     C                     Z-ADDCTN#,H    CTN#04
     C                     Z-ADDCTI#,H    CTI#04
     C                     Z-ADDCTD#,H    CTD#04
     C*
     C                     ADD  7         H
     C                     Z-ADDCTN#,H    NORE1
     C                     Z-ADDCTI#,H    HRWN
     C                     Z-ADDCTD#,H    HRDC
     C                     Z-ADDCTN#,H    CTN#11
     C                     Z-ADDCTI#,H    CTI#11
     C                     Z-ADDCTD#,H    CTD#11
     C*
     C                     MOVEL@R08      RECI                            E32839
     C                     UPDATCQCOCZZF                                  E32894
     C*********************WRITEXQCOCZZF               88                 E32894
     C*********************                                               E32894
     C************IN88*****IFEQ '1'                                       E32894
     C*********************MOVE 'CQCOC'   WBFILE           ***************E32894
     C*********************MOVELWRTERR    WBKEY            ** DBERR  34 **E32894
     C*********************Z-ADD34        WBASE            ***************E32894
     C*********************EXSR ABORT                                     E32894
     C*********************END                                            E32894
     C                     ENDSR                           ## E001
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**   .. CQPACT ..
     C**   THIS SUBR. IS USED TO SET-UP FIELDS FOR THE 'CONTROL REPORT'
     C**
     C           CQPACT    BEGSR                           ** CQPACT **
     C*
     C                     Z-ADD5         H
     C                     EXSR TRAILR
     C*
     C           *IN65     IFEQ '1'
     C                     MOVE DIFFXX    DIFF05
     C                     END
     C*
     C                     Z-ADDNORE1     ITN#05
     C                     Z-ADDHRWN      ITI#05
     C                     Z-ADDHRDC      ITD#05
     C                     Z-ADDCTN#,H    CTN#05
     C                     Z-ADDCTI#,H    CTI#05
     C                     Z-ADDCTD#,H    CTD#05
     C*
     C                     ADD  7         H
     C                     Z-ADDCTN#,H    NORE1
     C                     Z-ADDCTI#,H    HRWN
     C                     Z-ADDCTD#,H    HRDC
     C                     Z-ADDCTN#,H    CTN#12
     C                     Z-ADDCTI#,H    CTI#12
     C                     Z-ADDCTD#,H    CTD#12
     C                     MOVEL@R10      RECI                            E32839
     C                     UPDATCQPACZZF                                  E32894
     C*********************WRITEXQPACZZF               88                 E32894
     C*********************                                               E32894
     C************IN88*****IFEQ '1'                                       E32894
     C*********************MOVE 'CQPAC'   WBFILE           ***************E32894
     C*********************MOVELWRTERR    WBKEY            ** DBERR  35 **E32894
     C*********************Z-ADD35        WBASE            ***************E32894
     C*********************EXSR ABORT                                     E32894
     C*********************END                                            E32894
     C                     ENDSR
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**   .. CQPADT ..
     C**   THIS SUBR. IS USED TO SET-UP FIELDS FOR THE 'CONTROL REPORT'
     C**
     C           CQPADT    BEGSR                           ** CQPADT **
     C*
     C                     Z-ADD6         H
     C                     EXSR TRAILR
     C*
     C           *IN66     IFEQ '1'
     C                     MOVE DIFFXX    DIFF06
     C                     END
     C*
     C                     Z-ADDNORE1     ITN#06
     C                     Z-ADDHRWN      ITI#06
     C                     Z-ADDHRDC      ITD#06
     C                     Z-ADDCTN#,H    CTN#06
     C                     Z-ADDCTI#,H    CTI#06
     C                     Z-ADDCTD#,H    CTD#06
     C*
     C                     ADD  7         H
     C                     Z-ADDCTN#,H    NORE1
     C                     Z-ADDCTI#,H    HRWN
     C                     Z-ADDCTD#,H    HRDC
     C                     Z-ADDCTN#,H    CTN#13
     C                     Z-ADDCTI#,H    CTI#13
     C                     Z-ADDCTD#,H    CTD#13
     C                     MOVEL@R12      RECI                            E32839
     C                     UPDATCQPADZZF                                  E32894
     C*********************WRITEXQPADZZF               88                 E32894
     C*********************                                               E32894
     C************IN88*****IFEQ '1'                                       E32894
     C*********************MOVE 'CQPAD'   WBFILE           ***************E32894
     C*********************MOVELWRTERR    WBKEY            ** DBERR  36 **E32894
     C*********************Z-ADD36        WBASE            ***************E32894
     C*********************EXSR ABORT                                     E32894
     C*********************END                                            E32894
     C                     ENDSR
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**   .. NTRANT ..
     C**   THIS SUBR. IS USED TO SET-UP FIELDS FOR THE 'CONTROL REPORT'
     C**
     C           NTRANT    BEGSR                           ** NTRANT **
     C*
     C                     Z-ADD7         H
     C                     EXSR TRAILR
     C*
     C           *IN67     IFEQ '1'
     C                     MOVE DIFFXX    DIFF07
     C                     END
     C*
     C                     Z-ADDNORE1     ITN#07
     C                     Z-ADDHRWN      ITI#07
     C                     Z-ADDHRDC      ITD#07
     C                     Z-ADDCTN#,H    CTN#07
     C                     Z-ADDCTI#,H    CTI#07
     C                     Z-ADDCTD#,H    CTD#07
     C*
     C                     ADD  7         H
     C                     Z-ADDCTN#,H    NORE1
     C                     Z-ADDCTI#,H    HRWN
     C                     Z-ADDCTD#,H    HRDC
     C                     Z-ADDCTN#,H    CTN#14
     C                     Z-ADDCTI#,H    CTI#14
     C                     Z-ADDCTD#,H    CTD#14
     C                     MOVEL@R14      RECI                            E32839
     C                     UPDATNTRANZZF                                  E32894
     C*********************WRITEXTRANZZF               88                 E32894
     C*********************                                               E32894
     C************IN88*****IFEQ '1'                                       E32894
     C*********************MOVE 'NTRAN'   WBFILE           ***************E32894
     C*********************MOVELWRTERR    WBKEY            ** DBERR  37 **E32894
     C*********************Z-ADD37        WBASE            ***************E32894
     C*********************EXSR ABORT                                     E32894
     C*********************END                                            E32894
     C                     ENDSR
     C********************************************************************
     C/COPY WNCPYSRC,FT1000C018
      *                                                                   CFT009
     C/COPY ZSRSRC,ZEDITZ2                                                CFT009
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
**  DESC
Miscellaneous Charge 1                                                    CFT009
Miscellaneous Charge 2                                                    CFT009
Miscellaneous Charge 3                                                    CFT009
Miscellaneous Charge 4                                                    CFT009
Miscellaneous Charge 5                                                    CFT009
