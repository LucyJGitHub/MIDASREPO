     H        1
     F*****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas FT Accrual date reorganisation')                 *
     F*****************************************************************
     F*                                                               *
     F*  Midas - Funds Transfer Module                                *
     F*                                                               *
     F***FT1010**-**ACCRUAL*REORGANISATION*                           *
     F*  FT1010  -  FT Transaction Purge                              *
     F*                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. CFT166             Date 02Nov22               *
      *  Prev Amend No. CSD103             Date 10Aug20               *
      *                 AR1001970          Date 07Dec20               *
      *                 MD056935           Date 27Oct20               *
      *                 MD046248           Date 27Oct17               *
      *                 CAP212             Date 15Sep14               *
      *                 CFT120             Date 28Sep12               *
      *                 CLE134             Date 01Aug12               *
      *                 AR655670           Date 29Nov10               *
      *                 AR785953           Date 16Jun11               *
      *                 CER059             Date 19Jul10               *
      *                 BUG22580           Date 02Feb09               *
      *                 CER048             Date 19May08               *
      *                 CER047             Date 19May08               *
      *                 CER030             Date 09Jul08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 CSW209             Date 01Apr09               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 BUG15145           Date 26Oct07
      *                 CSW207             Date 08Jun07               *
      *                 CRE026             Date 24May06               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CFT032             Date 11Sep06               *
      *                 BUG433             Date 05Dec05               *
      *                 CDL049             Date 07Jul06               *
      *                 CSD027             Date 09Dec05               *
      *                 BUG4776            Date 15Nov04               *
      *                 221761             Date 02Apr04               *
      *                 TDA035             Date 02Apr04               *
      *                 CGL029             Date 01Sep03               *
      *                 CSW203             Date 26May03               *
      * Midas Release 4.01.02 ----------------------------------------*
      *                 209391             Date 08Nov02               *
      * Midas Release 4.01 -------------------------------------------*
      *                 195945             Date 19Sep01               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 171266             Date 13Jun01               *
      * Midas DBA 3.05 -----------------------------------------------*
      *                 192300             Date 18Apr01               *
      *                 CFT009             Date 09Jun00               *
      * Midas DBA 3.04 -----------------------------------------------*
      *                 185107             Date 17Oct00               *
      *                 184060             Date 22Sep00               *
      *                 CFT014             Date 25May00               *
      * Midas DBA 3.03 -----------------------------------------------*
      *                 CAP136             Date 15Nov99               *
      *                 175479             Date 07Feb00               *
      *                 CFT006             Date 20Sep99               *
      * Midas DBA 3.02 -----------------------------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
     F*                 CPK009             Date 01Aug99               *
     F*                 CFT003             Date 18Nov98               *
     F*                 CEU013             Date 29May98               *
     F*                 CEU006             DATE 29MAY98               *
     F*                 111825             DATE 17SEP97               *
     F*                 103513             DATE  22APR94              *
     F*                 S01408             DATE 22JAN96               *
     F*                 S01408             DATE 10NOV95               *
     F*                 082291             DATE 27JAN95               *
     F*                 S01499             DATE 06JUN94               *
     F*                 S01494             DATE 25MAY94               *
     F*                 S01435             DATE 08SEP93               *
     F*                 047171             DATE 22APR93               *
     F*                 S01414             DATE 29MAR93               *
     F*                 038584             DATE 29APR92               *
     F*                 033943             DATE 06JAN92               *
     F*                 E32894             DATE 10JUN91               *
     F*                 E32873             DATE 01MAY91               *
     F*                 E32839             DATE 25APR91               *
     F*                 S01117             DATE 07DEC90               *
     F*                 S01194             DATE 07DEC90               *
     F*                                                               *
     F*---------------------------------------------------------------*
      *                                                               *
      *  CFT166 - Amendment to FT A/C Balance Check on Authorisation  *
      *  CSD103 - LIBOR Deregulation - Common Layer/Standing Data     *
      *           (Recompile)                                         *
      *  AR1001970 - DBASE Error 901 on SDCURRPD when OPCHGC is blank.*
      *             In SR/OTPREP, if OPCHGC is blank, do not call     *
      *             AOCURRR0 to get the charges currency decimal      *
      *             places. (Child: AR1002969)                        *
      *  MD056935 - Added purging process for MEIRFTPD FT Message     *
      *             Management 101 & 102 file.                        *
      *  MD046248 - Finastra Rebranding                               *
      *  CAP212 - FT Nostro Transfer API (Recompile)                  *
      *  CFT120 - FT IN/OP - Charges to DR of Account Currency        *
      *  CLE134 - Past Due Call Loan Processing (Recompile)           *
      *  AR655670 - FTC1000 00001 component failed due to printer     *
      *           overflow. Ensure that no printer overflow will be   *
      *           encountered in FT1010 reports. Applied fix 263244.  *
      *           (Child: AR655671)                                   *
      *  AR785953 - Component FTC1010 fails due to a Database error   *
      *           when the Destination entered is a Retail account.   *
      *           (Child: AR785955)                                   *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  BUG22580 - Fields incorrectly labeled and lengths            *
      *           (Recompile)                                         *
      *  CER048 - German Features - Taxes (Recompile)                 *
      *  CER047 - German Features LF037-00 Reporting §24c KWG         *
      *           (Recompile)                                         *
      *  CER030 - Multicash German Feature                            *
      *  CSW209 - SWIFT 2009 Changes                                  *
      *  BUG15145 - FTC1010 has failed due to printer overflow in     *
      *             FT1010P6 (Recompile)                              *
      *  CSW207 - SWIFT 2007 Changes                                  *
      *  CRE026 - Consumer Banking (Recompile)                        *
      *  CFT032 - Account Line in Field 50X in MT103                  *
      *  BUG433 - Recompiled due to change in FTPCHGPD                *
      *  CDL049 - Addition of a Reference Rate field (recompile)      *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  BUG4776- Correct skipping of transaction reference.          *
      *  221761 - Recompiled due to change made in PF/FT101HPD.       *
      *  TDA035 - RTS Signon changes for MidasPlus. (Recompile)       *
      *  CGL029 - Increase Account Code to 10 digits (Recompile)      *
      *  CSW203 - SWIFT 2003 Standards Update                         *
      *  209391 - I/O Operation was applied to closed INPAYXL0.       *
      *           I/O operation to INPAYXL0 should only be done if    *
      *           CFT003, CFT014, or CFT009 is 'on'.  Complete fix    *
      *           192300.  Error was caused by application of 195945. *
      *  195945 - Records in INPAYXPD not deleted even though record  *
      *           in INPAYDD is already been deleted.                 *
      *  171266 - In SR ABORT do not update trailer files.            *
      *  192300 - If CFT003 and CFT014 are both off, file OTPAYXL0    *
      *           is not opened but there is a CHAIN to the file      *
      *           which is unconditioned so CoB fails I/O error.      *
      *           Also allow chain to INPAYXL0 and OTPAYXL0 if CFT009 *
      *           is turned on.                                       *
      *  CFT009 - FT Fees and Charges                                 *
      *  185107 - Mapping of details from swift message - Recompile   *
      *  184060 - No transaction type code in detail screen -Recompile*
      *  CFT014 - Straight-through Processing Phase 2 MT103 Messages  *
      *           Generation for FT                                   *
      *  CAP136 - Conversion of FT Incoming Payment inputs into       *
      *           modular structure to use as APIs.                   *
      *  175479 - Incorporate Fontis : dealer's reference             *
      *  CFT006 - Funds Transfer/Swift Messages MT101/MT102           *
     F*  CPK009 - Comment out the DUMP statement (used for debugging) *
     F*  CFT003 - FT Batch Authorisation                              *
     F*  CEU013 - EMU Account Posting Narrative. Recompile.           *
     F*  CEU006 - FT EMU Payments and Settlements(Recompilation)      *
     F*  111825 - OEDT CORRUPTED ON FT TRANSACTION FILES              *
     F*  103513 - Correct formatting of Entered currency              *
     F*  S01408 - Core hook FT1010CCP2  added                         *
     F*           Core hook FT1010FFP2  added                         *
     F*  S01408 - Core hook FT1010CCP1  added                         *
     F*           Core hook FT1010FFP1  added                         *
     F*           Core hook FT1010IIP1  added                         *
     F*   082291 - FT1010P5 printer file gives an overflow error;     *
     F*            overflow indicator added.                          *
     F*   S01499 - BLI V.A.T. Processing                              *
     F*   S01494 - BLI Funds Transfer Enhancements                    *
     F*   S01435 - Incoming Message Management.                       *
     F*   047171 - Payments were dropped as settlement date were back *
     F*            valued by 4 months. APPLIED GEMS FIX 045670.       *
     F*   S01414 - Book Code and Profit Centre Incorporation.         *
     F*   038584 - Suppress database error on CLINT if customer is    *
     F*            deleted as details needed for printing             *
     F*   033943 - Cheques register details are not dropped even      *
     F*            though trailer is updated                          *
     F*   E32894 - PROGRAM CHANGED TO UPDATE IN PLACE SO THAT THE     *
     F*            COMPONANT IS RESTARTABLE                           *
     F*   E32873 - LCD, AND CHTP ALSO CORRUPTED ON FT TRANSACTION     *
     F*            FILES.                                             *
     F*   E32839 - RECI is corrupted on FT transaction files due to   *
     F*            careless processing of other files containing      *
     F*            field RECI                                         *
     F*   S01117 - CHANGES FOR MULTIBRANCHING, RCF PROCESSING         *
     F*   S01194 - STANDING DATA CHANGES                              *
     F*                                                               *
     F*****************************************************************
     F*INPAYDD*IP**E***********K        DISK                              E32894
     F*INPAYZZ*IS**E***********K        DISK                              E32894
     F*OTPAYDD*IS**E***********K        DISK                              E32894
     F*OTPAYZZ*IS**E***********K        DISK                              E32894
     F*CQCODDD*IS**E***********K        DISK                              E32894
     F*CQCODZZ*IS**E***********K        DISK                              E32894
     F*CQCOCDD*IS**E***********K        DISK                              E32894
     F*CQCOCZZ*IS**E***********K        DISK                              E32894
     F*CQPACDD*IS**E***********K        DISK                              E32894
     F*CQPACZZ*IS**E***********K        DISK                              E32894
     F*CQPADDD*IS**E***********K        DISK                              E32894
     F*CQPADZZ*IS**E***********K        DISK                              E32894
     F*NTRANDD*IS**E***********K        DISK                              E32894
     F*NTRANZZ*IS**E***********K        DISK                              E32894
     F*CQREGDD*IS**E***********K        DISK                              E32894
     F*CQREGZZ*IS**E***********K        DISK                              E32894
     FINPAYDD UP  E           K        DISK                               E32894
     FINPAYZZ US  E           K        DISK                               E32894
     FOTPAYDD US  E           K        DISK                               E32894
     FOTPAYZZ US  E           K        DISK                               E32894
     FCQCODDD US  E           K        DISK                               E32894
     FCQCODZZ US  E           K        DISK                               E32894
     FCQCOCDD US  E           K        DISK                               E32894
     FCQCOCZZ US  E           K        DISK                               E32894
     FCQPACDD US  E           K        DISK                               E32894
     FCQPACZZ US  E           K        DISK                               E32894
     FCQPADDD US  E           K        DISK                               E32894
     FCQPADZZ US  E           K        DISK                               E32894
     FNTRANDD US  E           K        DISK                               E32894
     FNTRANZZ US  E           K        DISK                               E32894
     FCQREGDD US  E           K        DISK                               E32894
     FCQREGZZ US  E           K        DISK                               E32894
     FFT101HPDUS  E           K        DISK                               CFT006
     FFT102HPDUS  E           K        DISK                               CFT006
     F/COPY WNCPYSRC,FT1010F001
     FCLINT   IF  E           K        DISK
     F            CLINTCAF                          KIGNORE
     F            CLINTCBF                          KIGNORE
     FTABFP   IF  E           K        DISK
     F            TABTB20F                          KIGNORE
     F            TABTG20F                          KIGNORE
     F************TABLETJF                          KIGNORE               S01117
     F            TABLETPF                          KIGNORE
     F            TABLET5F                          KIGNORE
     F************TABLETRF                          KIGNORE               S01117
     F            TABLETLF                          KIGNORE
     F            TABLETHF                          KIGNORE
     F            TABTE10F                          KIGNORE
     F*INPAYDDXO***E***********K        DISK                      A       E32894
     F************INPAYDDF*****                     KRENAMEXNPAYDDF       E32894
     F*INPAYZZXO***E***********K        DISK                      A       E32894
     F************INPAYZZF*****                     KRENAMEXNPAYZZF       E32894
     F*OTPAYDDXO***E***********K        DISK                      A       E32894
     F************OTPAYDDF*****                     KRENAMEXTPAYDDF       E32894
     F*OTPAYZZXO***E***********K        DISK                      A       E32894
     F************OTPAYZZF*****                     KRENAMEXTPAYZZF       E32894
     F*CQCODDDXO***E***********K        DISK                      A       E32894
     F************CQCODDDF*****                     KRENAMEXQCODDDF       E32894
     F*CQCODZZXO***E***********K        DISK                      A       E32894
     F************CQCODZZF*****                     KRENAMEXQCODZZF       E32894
     F*CQCOCDDXO***E***********K        DISK                      A       E32894
     F************CQCOCDDF*****                     KRENAMEXQCOCDDF       E32894
     F*CQCOCZZXO***E***********K        DISK                      A       E32894
     F************CQCOCZZF*****                     KRENAMEXQCOCZZF       E32894
     F*CQPACDDXO***E***********K        DISK                      A       E32894
     F************CQPACDDF*****                     KRENAMEXQPACDDF       E32894
     F*CQPACZZXO***E***********K        DISK                      A       E32894
     F************CQPACZZF*****                     KRENAMEXQPACZZF       E32894
     F*CQPADDDXO***E***********K        DISK                      A       E32894
     F************CQPADDDF*****                     KRENAMEXQPADDDF       E32894
     F*CQPADZZXO***E***********K        DISK                      A       E32894
     F************CQPADZZF*****                     KRENAMEXQPADZZF       E32894
     F*NTRANDDXO***E***********K        DISK                      A       E32894
     F************NTRANDDF*****                     KRENAMEXTRANDDF       E32894
     F*NTRANZZXO***E***********K        DISK                      A       E32894
     F************NTRANZZF*****                     KRENAMEXTRANZZF       E32894
     F*CQREGDDXO***E***********K        DISK                      A       E32894
     F************CQREGDDF*****                     KRENAMEXQREGDDF       E32894
     F*CQREGZZXO***E***********K        DISK                      A       E32894
     F************CQREGZZF*****                     KRENAMEXQREGZZF       E32894
     FLIVEC   IF  E           K        DISK
     F            CQCODDDF                          KRENAMELQCODDDF
     F            CQCOCDDF                          KRENAMELQCOCDDF
     F            CQPACDDF                          KRENAMELQPACDDF
     F            CQPADDDF                          KRENAMELQPADDDF
     FMATUC   IF  E           K        DISK
     F            CQCODDDF                          KRENAMEMQCODDDF
     F            CQCOCDDF                          KRENAMEMQCOCDDF
     F            CQPACDDF                          KRENAMEMQPACDDF
     F            CQPADDDF                          KRENAMEMQPADDDF
     F*PYCHGDD*IF**E********************DISK                              S01194
     F*FT1010P1O***E********************PRINTER                           S01117
     F*FT1010P2O***E********************PRINTER                           S01117
     F*FT1010P3O***E********************PRINTER                           S01117
     F*FT1010P4O***E********************PRINTER                           S01117
     F*FT1010P5O***E********************PRINTER                           S01117
     F*FT1010P6O***E********************PRINTER                           S01117
     F*FT1010P7O***E********************PRINTER                           S01117
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT1010FFP1                                           S01408
     C*                                                                   S01408
     FOTPAYXL0UF  E           K        DISK                           UC  CFT003
      * Extension file to OTPAYDD                                         CFT003
     FINPAYXL0UF  E           K        DISK                           UC  CFT003
      * Extension file to INPAYDD                                         CFT003
      *                                                                   CFT003
     FFT101DL0UF  E           K        DISK                               CFT006
     FFT102DL0UF  E           K        DISK                               CFT006
     FMEIRFTL2UF  E           K        DISK                                                 MD056935
     FFTABOVL0UF  E           K        DISK                                                   CFT166
      ** FT Account Balance Override                                                          CFT166
     FFT1010AUO   E                    PRINTER      KINFDS SPOOLU         S01117
     FFT1010P2O   E                    PRINTER      KINFDS SPOOL2         S01117
     FFT1010P3O   E                    PRINTER      KINFDS SPOOL3         S01117
     FFT1010P4O   E                    PRINTER      KINFDS SPOOL4         S01117
     F*FT1010P5O**E                    PRINTER      KINFDS SPOOL5   S01117082291
     FFT1010P5O   E             40     PRINTER      KINFDS SPOOL5         082291
     F***FT1010P6OE                    PRINTER      KINFDS SPOOL6         S01117              CSW209
     FFT1010P6O   E             42     PRINTER      KINFDS SPOOL6         S01117              CSW209
     FFT1010P7O   E                    PRINTER      KINFDS SPOOL7         S01117
     F*                                                                   S01408
     F/COPY WNCPYSRC,FT1010FFP2                                           S01408
     F*                                                                   S01408
     FMUSER   IF  E           K        DISK
     FFTPCHGL0IF  E           K        DISK                               CFT009
      * Payment charge defs.                                              CFT009
     FFTPREFL1UF  E           K        DISK                                                  BUG4776
      * Payment reference control file                                                       BUG4776
     F********************************************************************
     F* ID F  C  H  L    FUNCTION OF INDICATORS                          *
     F*                                                                  *
     F* 01            'INPAYDD' RECORD
     F* 02            'OTPAYDD' RECORD
     F* 03            'CQCODDD' RECORD
     F* 04            'CQCOCDD' RECORD
     F* 05            'CQPACDD' RECORD
     F* 06            'CQPADDD' RECORD
     F* 07            'NTRANDD' RECORD
     F* 08            'CQREGDD' RECORD
     F*
     F* 21   61       'INPAYZZ' TRAILER RECORD / ERROR
     F* 22   62       'OTPAYZZ' TRAILER RECORD / ERROR
     F* 23   63       'CQCODZZ' TRAILER RECORD / ERROR
     F* 24   64       'CQCOCZZ' TRAILER RECORD / ERROR
     F* 25   65       'CQPACZZ' TRAILER RECORD / ERROR
     F* 26   66       'CQPADZZ' TRAILER RECORD / ERROR
     F* 27   67       'NTRANZZ' TRAILER RECORD / ERROR
     F* 28   68       'CQREGZZ' TRAILER RECORD / ERROR
     F*      29       Core Feature S01494 is switched ON                  S01494
     F*
     F*      30       MULTIBRANCHING INDICATOR                            S01117
     F*      35       ORIGINATING BRANCH USED INDICATOR                   S01117
     F*                                                                   S01117
     F*      39       Core Feature S01499 is switched ON                  S01499
     F*      42       Overflow Indicator for FT1010P6                                         CSW209
     F*      44       CHAIN to FTABOVL0 File                                                  CFT166
     F*      51       COUNT INDICATOR FOR HEADINGS
     F*      52         "       "      "     "
     F*      53         "       "      "     "
     F*      54         "       "      "     "
     F*      55         "       "      "     "
     F*      56         "       "      "     "
     F*
     F*      70       Profit Centres In Use Flag                          S01414
     F*      80       FIRST CYCLE
     F*
     F*      82       'NO RECORDS DROPPED' FOR PRTF FT1000P2
     F*      83       'NO RECORDS DROPPED' FOR PRTF FT1000P3
     F*      84       'NO RECORDS DROPPED' FOR PRTF FT1000P4
     F*      85       'NO RECORDS DROPPED' FOR PRTF FT1000P5
     F*      86       'NO RECORDS DROPPED' FOR PRTF FT1000P6
     F*      87       'NO RECORDS DROPPED' FOR PRTF FT1000P7
     F*
     F*      88       CHAIN FAIL
     F*      89       CHAIN FAIL
     F*
     E                    CPY@    1   1 80
     E/EJECT
     E                    CTI#       16 15 0             INTEGER HASH TOTAL
     E                    CTD#       16  3 0             DECIMAL HASH TOTAL
     E                    CTN#       16  5 0             RECORDS HASH TOTAL
     E                    WA1        15  1               UGFRMT SR.ARRY
     E                    WA2        20  1               UGFRMT SR.ARRY
     E                    ZYDY    4   4  4 0             ZDATE1/2 SR.ARRAY
     E                    ZMDY   13  13  3 0             ZDATE1/2 SR.ARRAY
     E                    ZMNM   12  12  3               ZDATE2 SR. ARRAY
     E                    CCYA      150  3               * CURRENCY CODES
     E                    CDPA      150  1 0             * CCY DEC. PLACES
     E                    DESC    1   5 30               CHG CODE NARS    CFT009
     E/COPY ZSRSRC,ZEDITZ1                                                CFT009
     I/EJECT
     I***
     I***   DETAIL RECORDS
     I***
     IINPAYDDF    01
     I              RECI                            @R01                  E32839
     I              LCD                             @L01                  E32873
     I              CHTP                            @C01                  E32873
     I              OEDT                            @O01                  111825
     IOTPAYDDF    02
     I              RECI                            @R03                  E32839
     I              LCD                             @L03                  E32873
     I              CHTP                            @C03                  E32873
     I              OEDT                            @O03                  111825
     ICQCODDDF    03
     I              RECI                            @R05                  E32839
     I              LCD                             @L05                  E32873
     I              CHTP                            @C05                  E32873
     I              OEDT                            @O05                  111825
     ICQCOCDDF    04
     I              RECI                            @R07                  E32839
     I              LCD                             @L07                  E32873
     I              CHTP                            @C07                  E32873
     I              OEDT                            @O07                  111825
     ICQPACDDF    05
     I              RECI                            @R09                  E32839
     I              LCD                             @L09                  E32873
     I              CHTP                            @C09                  E32873
     I              OEDT                            @O09                  111825
     ICQPADDDF    06
     I              RECI                            @R11                  E32839
     I              LCD                             @L11                  E32873
     I              CHTP                            @C11                  E32873
     I              OEDT                            @O11                  111825
     INTRANDDF    07
     I              RECI                            @R13                  E32839
     I              LCD                             @L13                  E32873
     I              CHTP                            @C13                  E32873
     I              OEDT                            @O13                  111825
     ICQREGDDF    08
     I              RECI                            @R15                  E32839
     I              LCD                             @L15                  E32873
     I              CHTP                            @C15                  E32873
     IFT101HD0    09                                                      CFT006
     I              SINST                           RSINST                CFT006
     IFT102HD0    10                                                      CFT006
     I              CCTAMT                          @CCTAM                CFT006
     I              CCTTYP                          @CCTYP                CFT006
     I/COPY WNCPYSRC,FT1010I001
     I***
     I***   TRAILER RECORDS
     I***
     IINPAYZZF    21
     I              RECI                            @R02                  E32839
     IOTPAYZZF    22
     I              RECI                            @R04                  E32839
     ICQCODZZF    23
     I              RECI                            @R06                  E32839
     ICQCOCZZF    24
     I              RECI                            @R08                  E32839
     ICQPACZZF    25
     I              RECI                            @R10                  E32839
     ICQPADZZF    26
     I              RECI                            @R12                  E32839
     INTRANZZF    27
     I              RECI                            @R14                  E32839
     ICQREGZZF    28
     I              RECI                            @R16                  E32873
     I/EJECT
     ILQCODDDF
     I              PREF                            LPREF
     I              RECI                            ANY001
     ILQCOCDDF
     I              PREF                            LPREF
     I              RECI                            ANY001
     ILQPACDDF
     I              PREF                            LPREF
     I              RECI                            ANY001
     ILQPADDDF
     I              PREF                            LPREF
     I              RECI                            ANY001
     IMQCODDDF
     I              PREF                            MPREF
     I              SLDT                            DATEIN
     I              RECI                            ANY001
     IMQCOCDDF
     I              PREF                            MPREF
     I              CRVD                            DATEIN
     I              RECI                            ANY001
     IMQPACDDF
     I              PREF                            MPREF
     I              PVDT                            DATEIN
     I              RECI                            ANY001
     IMQPADDDF
     I              PREF                            MPREF
     I              DRVD                            DATEIN
     I              RECI                            ANY001
     IFT101DD0                                                            CFT006
     I              TRNSID                          @TRNID                CFT006
     I              RCVCHG                          RRCVCG                CFT006
     I***
     I/EJECT
     ITABTB10F
     I***
     I***   STANDING DATA FILE DETAIL  - PF/TABTB10  ICD 1
     I***
     I              RECI                            RECITB
     I/EJECT
     I*PYCHGDDF*****                                                      S01194
     I**************                                                      S01194
     I******STANDING*DATA*FILE*DETAIL**-*PF/PYCHGDD**ICD*1*               S01194
     I**************                                                      S01194
     I**************RECI                            RECIPY                S01194
     ICLINTCCF
     I***
     I***   RECORD FROM CLINT WITH NAME + ADDRESS
     I***
     I              RECI                            RECICL
     I***
     I/EJECT
     IDLDA        DS                            256
     I***
     I***   LOCAL DATA AREA  -  DATABASE ERRORS
     I***
     I**************************************134 138 DBFILE                S01194
     I**************************************139 167 DBKEY                 S01194
     I**************************************168 175 DBPGM                 S01194
     I**************************************176 1770DBASE                 S01194
     I                                      134 141 DBFILE                S01194
     I                                      142 170 DBKEY                 S01194
     I                                      171 180 DBPGM                 S01194
     I                                      181 1830DBASE                 S01194
     I*                                                                   S01117
     ISPOOLU      DS                                                      S01117
     I* FILE INFORMATION DATA STRUCTURE                                   S01117
     I                                       83  92 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
     ISPOOL2      DS                                                      S01117
     I* FILE INFORMATION DATA STRUCTURE                                   S01117
     I                                       83  92 SFILE2                S01117
     I                                    B 123 1240SFNUM2                S01117
     ISPOOL3      DS                                                      S01117
     I* FILE INFORMATION DATA STRUCTURE                                   S01117
     I                                       83  92 SFILE3                S01117
     I                                    B 123 1240SFNUM3                S01117
     ISPOOL4      DS                                                      S01117
     I* FILE INFORMATION DATA STRUCTURE                                   S01117
     I                                       83  92 SFILE4                S01117
     I                                    B 123 1240SFNUM4                S01117
     ISPOOL5      DS                                                      S01117
     I* FILE INFORMATION DATA STRUCTURE                                   S01117
     I                                       83  92 SFILE5                S01117
     I                                    B 123 1240SFNUM5                S01117
     I                                    B 188 1890OFLLN5                                    CER030
     I                                    B 367 3680PRTLN5                                    CER030
     ISPOOL6      DS                                                      S01117
     I* FILE INFORMATION DATA STRUCTURE                                   S01117
     I                                       83  92 SFILE6                S01117
     I                                    B 123 1240SFNUM6                S01117
     I                                    B 188 1890OFLLN6                                    CER030
     I                                    B 367 3680PRTLN6                                    CER030
     ISPOOL7      DS                                                      S01117
     I* FILE INFORMATION DATA STRUCTURE                                   S01117
     I                                       83  92 SFILE7                S01117
     I                                    B 123 1240SFNUM7                S01117
     I*                                                                   S01117
     IDSFDY     E DSDSFDY                                                 S01117
     I* DATA STRUCTURE FOR ACCESS PROGRAMS                                S01117
     I*                                                                   S01117
     ISDGELR    E DSSDGELRPD                                              S01117
     I* EXTERNAL DS FOR SDGELRPD DETAILS                                  S01117
     I*                                                                   S01117
     ISDFTFR    E DSSDFTFRPD                                              S01117
     I* EXTERNAL DS FOR SDFTFRPD DETAILS                                  S01117
     I*                                                                   S01117
     ISCSARD    E DSSCSARDPD                                              S01494
     I** External data structure for SAR file details                     S01494
     I*                                                                   S01494
      *                                                                   CFT014
     IDSSDY     E DSDSSDY                                                 CFT014
      ** Second Data structure for access programs                        CFT014
      *                                                                   CFT014
     I/COPY WNCPYSRC,FT1010I002
     ISDCURR    E DSSDCURRPD                                              CFT014
      ** Data structure for currencies table                              CFT014
      *                                                                                       CFT032
     ISDBANK    E DSSDBANKPD                                                                  CFT032
      *                                                                                       CFT032
      ** External data structure for Bank details                                             CFT032
      *                                                                                       CFT032
     ISDCUST    E DSSDCUSTPD                                                                  CFT032
      *                                                                                       CFT032
      **  Data structure for customer file                                                    CFT032
      *                                                                                       CFT032
     ISDACCT    E DSACCNTAB                                                                   CFT032
     I              LCD                             ALCD                                      CFT032
      *                                                                                       CFT032
      *  Data structure for account Details                                                   CFT032
      *                                                                                       CFT032
     ISDNOST    E DSSDNOSTPD                                                                  CFT032
     I              QQACCD                          ACCD                                      CFT032
      *                                                                                       CFT032
      ** Data Structure for Nostro Details                                                    CFT032
      *                                                                                       CFT032
     ISDCNST    E DSSDCNSTPD                                                                  CFT032
      *                                                                                       CFT032
      ** Calling parameter data structure for ME1400                                          CFT032
      *                                                                                       CFT032
     IMEBICD    E DSMEBICDPD                                                                  CFT032
      *                                                                                       CFT032
      ** Calling parameter data structure for ME1400                                          CFT032
      *                                                                                       CFT032
      ** Data Structure for Additional Cust Details Access Program                            CSW207
     ISDNAHO    E DSSDNAHOPD                                                                  CSW207
      *                                                                                       CSW207
     I***
     I***   TO SPLIT UP RUN DATE INTO DD/MM/YY
     I***
     I            DS                              6
     I                                        1   60ZDATE
     I                                        1   20DD
     I                                        3   40MM
     I                                        5   60YY
      *                                                                   S01435
      ** Program data structure                                           S01435
     IDSPGM     ESDSY2PGDSP
      *                                                                   S01435
      *****************************************************************   S01435
      *  Data Structures for addresses.                                   S01435
      *                                                                   S01435
      ** OUT data structures (printout)                                   S01435
      *                                                                   S01435
      ** Receivers correspondent                                          S01435
     IP6RCDS      DS                                                      S01435
     I                                        1  35 P6RCO1                S01435
     I                                       36  70 P6RCO2                S01435
     I                                       71 105 P6RCO3                S01435
     I                                      106 140 P6RCO4                S01435
     I                                      141 175 P6RCO5                S01435
      *                                                                   S01435
      ** Ordering Customer                                                S01435
     IP6ORDS      DS                                                      S01435
     I                                        1  35 P6ORC1                S01435
     I                                       36  70 P6ORC2                S01435
     I                                       71 105 P6ORC3                S01435
     I                                      106 140 P6ORC4                S01435
     I                                      141 175 P6ORC5                S01435
      *                                                                   S01435
      ** Receiving Bank                                                   S01435
     IP6DSDS      DS                                                      S01435
     I                                        1  35 P6DST1                S01435
     I                                       36  70 P6DST2                S01435
     I                                       71 105 P6DST3                S01435
     I                                      106 140 P6DST4                S01435
     I                                      141 175 P6DST5                S01435
      *                                                                   S01435
      ** Account with Bank                                                S01435
     IP6ACDS      DS                                                      S01435
     I                                        1  35 P6ACB1                S01435
     I                                       36  70 P6ACB2                S01435
     I                                       71 105 P6ACB3                S01435
     I                                      106 140 P6ACB4                S01435
     I                                      141 175 P6ACB5                S01435
      *                                                                   S01435
      ** Beneficiary Customer                                             S01435
     IP6BNDS      DS                                                      S01435
     I                                        1  35 P6BNC1                S01435
     I                                       36  70 P6BNC2                S01435
     I                                       71 105 P6BNC3                S01435
     I                                      106 140 P6BNC4                S01435
     I                                      141 175 P6BNC5                S01435
      *                                                                   S01435
      ** Senders correspondent                                            S01435
     IP6SNDS      DS                                                      S01435
     I                                        1  35 P6SNC1                S01435
     I                                       36  70 P6SNC2                S01435
     I                                       71 105 P6SNC3                S01435
     I                                      106 140 P6SNC4                S01435
     I                                      141 175 P6SNC5                S01435
      *                                                                   S01435
      ** Ordering Bank                                                    S01435
     IP6OBDS      DS                                                      S01435
     I                                        1  35 P6ORB1                S01435
     I                                       36  70 P6ORB2                S01435
     I                                       71 105 P6ORB3                S01435
     I                                      106 140 P6ORB4                S01435
     I                                      141 175 P6ORB5                S01435
      *                                                                   S01435
      ** Intermediary Bank                                                S01435
     IP6INDS      DS                                                      S01435
     I                                        1  35 P6INB1                S01435
     I                                       36  70 P6INB2                S01435
     I                                       71 105 P6INB3                S01435
     I                                      106 140 P6INB4                S01435
     I                                      141 175 P6INB5                S01435
      *                                                                   CFT014
      ** Third Reimbursement Institution                                  CFT014
     IP6TRDS      DS                                                      CFT014
     I                                        1  35 P6TRI1                CFT014
     I                                       36  70 P6TRI2                CFT014
     I                                       71 105 P6TRI3                CFT014
     I                                      106 140 P6TRI4                CFT014
     I                                      141 175 P6TRI5                CFT014
      *                                                                   S01435
      ** Senders .                                                        S01435
     IP5SDDS      DS                                                      S01435
     I                                        1  35 P5SND1                S01435
     I                                       36  70 P5SND2                S01435
     I                                       71 105 P5SND3                S01435
     I                                      106 140 P5SND4                S01435
     I                                      141 175 P5SND5                S01435
      *                                                                   S01435
      ** Senders correspondent                                            S01435
     IP5SNDS      DS                                                      S01435
     I                                        1  35 P5SNC1                S01435
     I                                       36  70 P5SNC2                S01435
     I                                       71 105 P5SNC3                S01435
     I                                      106 140 P5SNC4                S01435
     I                                      141 175 P5SNC5                S01435
      *                                                                   S01435
      ** Ordering Customer                                                S01435
     IORCDS       DS                                                      S01435
     I                                        1  35 P5ORC1                S01435
     I                                       36  70 P5ORC2                S01435
     I                                       71 105 P5ORC3                S01435
     I                                      106 140 P5ORC4                S01435
     I                                      141 175 P5ORC5                S01435
      *                                                                   S01435
      ** Intermediary Bank                                                S01435
     IP5INDS      DS                                                      S01435
     I                                        1  35 P5INB1                S01435
     I                                       36  70 P5INB2                S01435
     I                                       71 105 P5INB3                S01435
     I                                      106 140 P5INB4                S01435
     I                                      141 175 P5INB5                S01435
      *                                                                   S01435
      ** Ordering Bank                                                    S01435
     IORBDS       DS                                                      S01435
     I                                        1  35 P5ORB1                S01435
     I                                       36  70 P5ORB2                S01435
     I                                       71 105 P5ORB3                S01435
     I                                      106 140 P5ORB4                S01435
     I                                      141 175 P5ORB5                S01435
      *                                                                   S01435
      ** Beneficiary Customer                                             S01435
     IP5BNDS      DS                                                      S01435
     I                                        1  35 P5BNC1                S01435
     I                                       36  70 P5BNC2                S01435
     I                                       71 105 P5BNC3                S01435
     I                                      106 140 P5BNC4                S01435
     I                                      141 175 P5BNC5                S01435
      *                                                                   S01435
      ** Account with Bank                                                S01435
     IP5ACDS      DS                                                      S01435
     I                                        1  35 P5ACB1                S01435
     I                                       36  70 P5ACB2                S01435
     I                                       71 105 P5ACB3                S01435
     I                                      106 140 P5ACB4                S01435
     I                                      141 175 P5ACB5                S01435
      *                                                                   S01435
      ** Receiver's Correspondent                                         S01435
     IP5RCDS      DS                                                      S01435
     I                                        1  35 P5RCO1                S01435
     I                                       36  70 P5RCO2                S01435
     I                                       71 105 P5RCO3                S01435
     I                                      106 140 P5RCO4                S01435
     I                                      141 175 P5RCO5                S01435
      *                                                                   S01494
      ** Destination                                                      S01494
     IP7DEST      DS                                                      S01494
     I                                        1  35 RDST1                 S01494
     I                                       36  70 RDST2                 S01494
     I                                       71 105 RDST3                 S01494
     I                                      106 140 RDST4                 S01494
     I                                      141 175 RDST5                 S01494
      *                                                                   S01494
      ** Account with Bank                                                S01494
     IP7AWBK      DS                                                      S01494
     I                                        1  35 RAWB1                 S01494
     I                                       36  70 RAWB2                 S01494
     I                                       71 105 RAWB3                 S01494
     I                                      106 140 RAWB4                 S01494
     I                                      141 175 RAWB5                 S01494
      *                                                                   S01494
      ** Intermediary Bank                                                S01494
     IP7INBT      DS                                                      S01494
     I                                        1  35 RINB1                 S01494
     I                                       36  70 RINB2                 S01494
     I                                       71 105 RINB3                 S01494
     I                                      106 140 RINB4                 S01494
     I                                      141 175 RINB5                 S01494
      *                                                                   S01435
      *                                                                   S01435
      ** IN data structures (file)                                        S01435
      ** Senders .                                                        S01435
     ISDINDS      DS                                                      S01435
     I                                        1  35 SND1                  S01435
     I                                       36  70 SND2                  S01435
     I                                       71 105 SND3                  S01435
     I                                      106 140 SND4                  S01435
     I                                      141 175 SND5                  S01435
      *                                                                   S01435
      ** Senders correspondent                                            S01435
     ISNINDS      DS                                                      S01435
     I                                        1  35 SNC1                  S01435
     I                                       36  70 SNC2                  S01435
     I                                       71 105 SNC3                  S01435
     I                                      106 140 SNC4                  S01435
     I                                      141 175 SNC5                  S01435
      *                                                                   S01435
      ** Ordering Bank                                                    S01435
     IORBDSI      DS                                                      S01435
     I                                        1  35 ORB1                  S01435
     I                                       36  70 ORB2                  S01435
     I                                       71 105 ORB3                  S01435
     I                                      106 140 ORB4                  S01435
     I                                      141 175 ORB5                  S01435
      *                                                                   S01435
      ** Receivers correspondent                                          S01435
     IRCINDS      DS                                                      S01435
     I                                        1  35 RCO1                  S01435
     I                                       36  70 RCO2                  S01435
     I                                       71 105 RCO3                  S01435
     I                                      106 140 RCO4                  S01435
     I                                      141 175 RCO5                  S01435
      *                                                                   S01435
      ** Ordering Customer                                                S01435
     IORINDS      DS                            175                       S01435
     I                                        1  35 ORC1                  S01435
     I                                       36  70 ORC2                  S01435
     I                                       71 105 ORC3                  S01435
     I                                      106 140 ORC4                  S01435
     I                                      141 175 ORC5                                      CFT032
      *                                                                   S01435
      ** Receiving Bank                                                   S01435
     IDSINDS      DS                            175                       S01435
     I                                        1  35 DST1                  S01435
     I                                       36  70 DST2                  S01435
     I                                       71 105 DST3                  S01435
     I                                      106 140 DST4                  S01435
      *                                                                   S01435
      ** Account with Bank                                                S01435
     IACINDS      DS                                                      S01435
     I                                        1  35 ACB1                  S01435
     I                                       36  70 ACB2                  S01435
     I                                       71 105 ACB3                  S01435
     I                                      106 140 ACB4                  S01435
     I                                      141 175 ACB5                  S01435
      *                                                                   S01435
      ** Beneficiary Customer                                             S01435
     IBNINDS      DS                                                      S01435
     I                                        1  35 BNC1                  S01435
     I                                       36  70 BNC2                  S01435
     I                                       71 105 BNC3                  S01435
     I                                      106 140 BNC4                  S01435
     I                                      141 175 BNC5                  S01435
      *                                                                   S01435
      ** Intermediary Bank                                                S01435
     IININDS      DS                                                      S01435
     I                                        1  35 INB1                  S01435
     I                                       36  70 INB2                  S01435
     I                                       71 105 INB3                  S01435
     I                                      106 140 INB4                  S01435
     I                                      141 175 INB5                  S01435
      *                                                                   S01494
      ** Intermediary Bank (for Nostro Transfers)                         S01494
     IININBT      DS                                                      S01494
     I                                        1  35 NTINB1                S01494
     I                                       36  70 NTINB2                S01494
     I                                       71 105 NTINB3                S01494
     I                                      106 140 NTINB4                S01494
     I                                      141 175 NTINB5                S01494
      *                                                                   S01435
      ** Split name into components.                                      S01435
     IXNAMDS      DS                            175                       S01435
     I**********                              1  12 XACCT                              S01435 CGL029
     I**********                             13  15 XBRCA                              S01435 CGL029
     I                                        1  18 XACCT                                     CGL029
     I                                       19  21 XBRCA                                     CGL029
      *                                                                   S01435
      **            address lines 2 - 5.                                  S01435
     I                                       36 175 XADDS                 S01435
      *                                                                                       CSW209
      ** Incoming Payments Cover Details Data Structures                                      CSW209
      ** Ordering Customer Cover                                                              CSW209
      *                                                                                       CSW209
     IP5COCC      DS                                                                          CSW209
     I                                        1  35 P5COC1                                    CSW209
     I                                       36  70 P5COC2                                    CSW209
     I                                       71 105 P5COC3                                    CSW209
     I                                      106 140 P5COC4                                    CSW209
     I                                      141 175 P5COC5                                    CSW209
      *                                                                                       CSW209
      ** Ordering Institution Cover                                                           CSW209
      *                                                                                       CSW209
     IP5COBC      DS                                                                          CSW209
     I                                        1  35 P5COB1                                    CSW209
     I                                       36  70 P5COB2                                    CSW209
     I                                       71 105 P5COB3                                    CSW209
     I                                      106 140 P5COB4                                    CSW209
     I                                      141 175 P5COB5                                    CSW209
      *                                                                                       CSW209
      ** Intermediary Institution Cover                                                       CSW209
      *                                                                                       CSW209
     IP5CIBC      DS                                                                          CSW209
     I                                        1  35 P5CIB1                                    CSW209
     I                                       36  70 P5CIB2                                    CSW209
     I                                       71 105 P5CIB3                                    CSW209
     I                                      106 140 P5CIB4                                    CSW209
     I                                      141 175 P5CIB5                                    CSW209
      *                                                                                       CSW209
      ** Account with Institution Cover                                                       CSW209
      *                                                                                       CSW209
     IP5CABC      DS                                                                          CSW209
     I                                        1  35 P5CAB1                                    CSW209
     I                                       36  70 P5CAB2                                    CSW209
     I                                       71 105 P5CAB3                                    CSW209
     I                                      106 140 P5CAB4                                    CSW209
     I                                      141 175 P5CAB5                                    CSW209
      *                                                                                       CSW209
      ** Beneficiary Customer Cover                                                           CSW209
      *                                                                                       CSW209
     IP5CBCC      DS                                                                          CSW209
     I                                        1  35 P5CBC1                                    CSW209
     I                                       36  70 P5CBC2                                    CSW209
     I                                       71 105 P5CBC3                                    CSW209
     I                                      106 140 P5CBC4                                    CSW209
     I                                      141 175 P5CBC5                                    CSW209
      *                                                                                       CSW209
      ** Sender to Receiver Information Cover                                                 CSW209
      *                                                                                       CSW209
     IP5CBBC      DS                                                                          CSW209
     I                                        1  35 P5CBB1                                    CSW209
     I                                       36  70 P5CBB2                                    CSW209
     I                                       71 105 P5CBB3                                    CSW209
     I                                      106 140 P5CBB4                                    CSW209
     I                                      141 175 P5CBB5                                    CSW209
     I                                      176 210 P5CBB6                                    CSW209
      *                                                                                       CSW209
      ** Remittance Information Cover                                                         CSW209
      *                                                                                       CSW209
     IP5CDPC      DS                                                                          CSW209
     I                                        1  35 P5CDP1                                    CSW209
     I                                       36  70 P5CDP2                                    CSW209
     I                                       71 105 P5CDP3                                    CSW209
     I                                      106 140 P5CDP4                                    CSW209
      *                                                                                       CSW209
      ** Outgoing Payments Cover Details Data Structures                                      CSW209
      ** Ordering Customer Cover                                                              CSW209
      *                                                                                       CSW209
     IP6COCC      DS                                                                          CSW209
     I                                        1  35 P6COC1                                    CSW209
     I                                       36  70 P6COC2                                    CSW209
     I                                       71 105 P6COC3                                    CSW209
     I                                      106 140 P6COC4                                    CSW209
     I                                      141 175 P6COC5                                    CSW209
      *                                                                                       CSW209
      ** Ordering Institution Cover                                                           CSW209
      *                                                                                       CSW209
     IP6COBC      DS                                                                          CSW209
     I                                        1  35 P6COB1                                    CSW209
     I                                       36  70 P6COB2                                    CSW209
     I                                       71 105 P6COB3                                    CSW209
     I                                      106 140 P6COB4                                    CSW209
     I                                      141 175 P6COB5                                    CSW209
      *                                                                                       CSW209
      ** Intermediary Institution Cover                                                       CSW209
      *                                                                                       CSW209
     IP6CIBC      DS                                                                          CSW209
     I                                        1  35 P6CIB1                                    CSW209
     I                                       36  70 P6CIB2                                    CSW209
     I                                       71 105 P6CIB3                                    CSW209
     I                                      106 140 P6CIB4                                    CSW209
     I                                      141 175 P6CIB5                                    CSW209
      *                                                                                       CSW209
      ** Account with Institution Cover                                                       CSW209
      *                                                                                       CSW209
     IP6CABC      DS                                                                          CSW209
     I                                        1  35 P6CAB1                                    CSW209
     I                                       36  70 P6CAB2                                    CSW209
     I                                       71 105 P6CAB3                                    CSW209
     I                                      106 140 P6CAB4                                    CSW209
     I                                      141 175 P6CAB5                                    CSW209
      *                                                                                       CSW209
      ** Beneficiary Customer Cover                                                           CSW209
      *                                                                                       CSW209
     IP6CBCC      DS                                                                          CSW209
     I                                        1  35 P6CBC1                                    CSW209
     I                                       36  70 P6CBC2                                    CSW209
     I                                       71 105 P6CBC3                                    CSW209
     I                                      106 140 P6CBC4                                    CSW209
     I                                      141 175 P6CBC5                                    CSW209
      *                                                                                       CSW209
      ** Sender to Receiver Information Cover A                                               CSW209
      *                                                                                       CSW209
     IP6OCBC      DS                                                                          CSW209
     I                                        1  35 P6OCB1                                    CSW209
     I                                       36  70 P6OCB2                                    CSW209
     I                                       71 105 P6OCB3                                    CSW209
     I                                      106 140 P6OCB4                                    CSW209
     I                                      141 175 P6OCB5                                    CSW209
     I                                      176 210 P6OCB6                                    CSW209
      *                                                                                       CSW209
      ** Sender to Receiver Information Cover B                                               CSW209
      *                                                                                       CSW209
     IP6CBBC      DS                                                                          CSW209
     I                                        1  35 P6CBB1                                    CSW209
     I                                       36  70 P6CBB2                                    CSW209
     I                                       71 105 P6CBB3                                    CSW209
     I                                      106 140 P6CBB4                                    CSW209
     I                                      141 175 P6CBB5                                    CSW209
     I                                      176 210 P6CBB6                                    CSW209
      *                                                                                       CSW209
      ** Remittance Information Cover                                                         CSW209
      *                                                                                       CSW209
     IP6CDPC      DS                                                                          CSW209
     I                                        1  35 P6CDP1                                    CSW209
     I                                       36  70 P6CDP2                                    CSW209
     I                                       71 105 P6CDP3                                    CSW209
     I                                      106 140 P6CDP4                                    CSW209
      *                                                                   S01435
      ** to define XTYPE.                                                 S01435
     IXTYPE       DS                              1                       S01435
      *                                                                   S01435
      /EJECT                                                              S01435
     IW8FT        DS                            128                       S01435
      *                                                                   S01435
      * Address data structure                                            S01435
      *                                                                   S01435
      * Currency                                                          S01435
     I                                        1   3 W8CCY                 S01435
      * Settlement Type                                                   S01435
     I                                        4   5 W8STMT                S01435
      * Mandatory Text - convert BIC identifiers                          S01435
     I                                        6   6 W8MTXT                S01435
      * Message Tag                                                       S01435
     I                                        7  11 W8MTAG                S01435
      * Construct of data in field                                        S01435
     I                                       12  12 W8TYPE                S01435
      * Number of Lines available                                         S01435
     I                                       13  140W8NLIN                S01435
      * Network and Message Type                                          S01435
     I                                       15  20 W8NWRK                S01435
     I                                       21  23 W8MTPY                S01435
      * Calling Program                                                   S01435
     I                                       24  33 W8CPGM                S01435
      * Action *PRINT/*ENQ/*MSG GEN                                       S01435
     I                                       34  41 W8ACT                 S01435
      * Critical reporting - Database error if 'Y'                        S01435
      * If no BIC directory and BIC entered no error                      S01435
     I                                       42  42 W8CRIT                S01435
      * Force Midas Address - where possible                              S01435
     I                                       43  43 W8MADD                S01435
      * If Retail get first address from account                          S01435
     I                                       44  44 W8RTAD                S01435
      * Alternative Address                                               S01435
     I                                       45  45 W8ALTN                S01435
      * Address type selected in W0MSG                                    S01435
     I                                       46  46 W8ADTP                S01435
      *                                                                   S01435
      *                                                                                       CFT032
     IWACCN       DS                            573                                           CFT032
     I                                        2   7 WWCNUM                                    CFT032
     I                                        8  10 WWCCY                                     CFT032
     I                                       11  140W1ACOD                                    CFT032
     I                                       15  160WWACSQ                                    CFT032
     I                                       23  25 WWBRCA                                    CFT032
     I                                      554 5630W2ACOD                                    CFT032
      *                                                                                       CFT032
     IWCDET       DS                             24                                           CFT032
     I                                        1   6 WDCNUM                                    CFT032
     I                                        7   9 WDCCY                                     CFT032
     I                                       10  190WDACOD                                    CFT032
     I                                       20  210WDACSQ                                    CFT032
     I                                       22  24 WDBRCA                                    CFT032
      *                                                                                       CFT032
     IDSMTR       DS                                                      S01435
      *                                                                   S01435
      *  Define fields for message transalation                           S01435
      *                                                                   S01435
     I                                        1 132 #MSDTA                S01435
     I                                       15  30 #MPREF                S01435
     I                                    P   1   20#MPART                S01435
     I                                      133 264 #MSTX1                S01435
     I#MSTX2      DS                                                      S01435
     I                                        1 256 #MSTXA                S01435
     I                                      257 512 #MSTXB                S01435
      *****************************************************************   S01435
     I*  DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
     ICPYR@#      DS
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT1010IIP1                                           S01408
     C*                                                                   S01408
     C                     MOVEACPY@      BIS@   80
     C/EJECT
     C********************************************************************
     C***
     C***    F I R S T   C Y C L E    C A L C ' S
     C***
     C********************************************************************
     C           *IN80     IFEQ '0'                        ### B001
     C/COPY WNCPYSRC,FT1010C017
     C                     SETON                     80
     C                     SETOF                     51
     C                     SETOF                     52
     C                     SETOF                     53
     C                     SETOF                     54
     C                     SETOF                     55
     C                     SETOF                     56
     C*
     C** INITIALISE PAGE COUNTS FOR NEW REPORTS
     C*
     C                     Z-ADD0         P2PAGE
     C                     Z-ADD0         P3PAGE
     C                     Z-ADD0         P4PAGE
     C                     Z-ADD0         P5PAGE
     C                     Z-ADD0         P6PAGE
     C                     Z-ADD0         P7PAGE
     C*
     C** DECLARE SIMILAR FIELDS
     C*
     C           *LIKE     DEFN CDP       WBCDP
     C           *LIKE     DEFN CDP       WSCDP
     C           *LIKE     DEFN CDP       WPCDP
     C           *LIKE     DEFN BCCY      WSMCY
     C           *LIKE     DEFN BCCY      WRCCY
     C*                                                                   S01117
     C* CALL ZSFILE TO LOG SPOOL FILE DETAILS FOR AUDIT REPORT            S01117
     C*                                                                   S01117
     C                     Z-ADDSFNUMU    ZSNUM                           S01117
     C                     MOVELSFILEU    ZSNAM                           S01117
     C                     EXSR SUBZSF                                    S01117
     C*                                                                   S01117
     C* IF ERROR PERFORM DATABASE ERROR HANDLING AND EXIT PROGRAM         S01117
     C*                                                                   S01117
     C           ZERR      IFEQ 'Y'                                       S01117
     C                     SETON                     U7U8LR               S01117
     C           *LOCK     IN   DLDA                                      S01117
     C                     MOVEL'FT1010'  DBPGM            ***************S01117
     C                     MOVEL'FT1010AU'DBKEY            ** DBERR  22 **S01117
     C                     MOVEL'ZSFILE'  DBFILE           ***************S01117
     C                     Z-ADD22        DBASE                           S01117
     C                     OUT  DLDA                                      S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C* CALL ZSFILE TO LOG SPOOL FILE DETAILS FOR FT1000P2 REPORT         S01117
     C*                                                                   S01117
     C                     Z-ADDSFNUM2    ZSNUM                           S01117
     C                     MOVELSFILE2    ZSNAM                           S01117
     C                     EXSR SUBZSF                                    S01117
     C*                                                                   S01117
     C* IF ERROR PERFORM DATABASE ERROR HANDLING AND EXIT PROGRAM         S01117
     C*                                                                   S01117
     C           ZERR      IFEQ 'Y'                                       S01117
     C                     SETON                     U7U8LR               S01117
     C           *LOCK     IN   DLDA                                      S01117
     C                     MOVEL'FT1010'  DBPGM            ***************S01117
     C                     MOVEL'FT1010P2'DBKEY            ** DBERR  23 **S01117
     C                     MOVEL'ZSFILE'  DBFILE           ***************S01117
     C                     Z-ADD23        DBASE                           S01117
     C                     OUT  DLDA                                      S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C* CALL ZSFILE TO LOG SPOOL FILE DETAILS FOR FT1000P3 REPORT         S01117
     C*                                                                   S01117
     C                     Z-ADDSFNUM3    ZSNUM                           S01117
     C                     MOVELSFILE3    ZSNAM                           S01117
     C                     EXSR SUBZSF                                    S01117
     C*                                                                   S01117
     C* IF ERROR PERFORM DATABASE ERROR HANDLING AND EXIT PROGRAM         S01117
     C*                                                                   S01117
     C           ZERR      IFEQ 'Y'                                       S01117
     C                     SETON                     U7U8LR               S01117
     C           *LOCK     IN   DLDA                                      S01117
     C                     MOVEL'FT1010'  DBPGM            ***************S01117
     C                     MOVEL'FT1010P3'DBKEY            ** DBERR  24 **S01117
     C                     MOVEL'ZSFILE'  DBFILE           ***************S01117
     C                     Z-ADD24        DBASE                           S01117
     C                     OUT  DLDA                                      S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C* CALL ZSFILE TO LOG SPOOL FILE DETAILS FOR FT1000P4 REPORT         S01117
     C*                                                                   S01117
     C                     Z-ADDSFNUM4    ZSNUM                           S01117
     C                     MOVELSFILE4    ZSNAM                           S01117
     C                     EXSR SUBZSF                                    S01117
     C*                                                                   S01117
     C* IF ERROR PERFORM DATABASE ERROR HANDLING AND EXIT PROGRAM         S01117
     C*                                                                   S01117
     C           ZERR      IFEQ 'Y'                                       S01117
     C                     SETON                     U7U8LR               S01117
     C           *LOCK     IN   DLDA                                      S01117
     C                     MOVEL'FT1010'  DBPGM            ***************S01117
     C                     MOVEL'FT1010P4'DBKEY            ** DBERR  25 **S01117
     C                     MOVEL'ZSFILE'  DBFILE           ***************S01117
     C                     Z-ADD25        DBASE                           S01117
     C                     OUT  DLDA                                      S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C* CALL ZSFILE TO LOG SPOOL FILE DETAILS FOR FT1000P5 REPORT         S01117
     C*                                                                   S01117
     C                     Z-ADDSFNUM5    ZSNUM                           S01117
     C                     MOVELSFILE5    ZSNAM                           S01117
     C                     EXSR SUBZSF                                    S01117
     C*                                                                   S01117
     C* IF ERROR PERFORM DATABASE ERROR HANDLING AND EXIT PROGRAM         S01117
     C*                                                                   S01117
     C           ZERR      IFEQ 'Y'                                       S01117
     C                     SETON                     U7U8LR               S01117
     C           *LOCK     IN   DLDA                                      S01117
     C                     MOVEL'FT1010'  DBPGM            ***************S01117
     C                     MOVEL'FT1010P5'DBKEY            ** DBERR  26 **S01117
     C                     MOVEL'ZSFILE'  DBFILE           ***************S01117
     C                     Z-ADD26        DBASE                           S01117
     C                     OUT  DLDA                                      S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C* CALL ZSFILE TO LOG SPOOL FILE DETAILS FOR FT1000P6 REPORT         S01117
     C*                                                                   S01117
     C                     Z-ADDSFNUM6    ZSNUM                           S01117
     C                     MOVELSFILE6    ZSNAM                           S01117
     C                     EXSR SUBZSF                                    S01117
     C*                                                                   S01117
     C* IF ERROR PERFORM DATABASE ERROR HANDLING AND EXIT PROGRAM         S01117
     C*                                                                   S01117
     C           ZERR      IFEQ 'Y'                                       S01117
     C                     SETON                     U7U8LR               S01117
     C           *LOCK     IN   DLDA                                      S01117
     C                     MOVEL'FT1010'  DBPGM            ***************S01117
     C                     MOVEL'FT1010P6'DBKEY            ** DBERR  27 **S01117
     C                     MOVEL'ZSFILE'  DBFILE           ***************S01117
     C                     Z-ADD27        DBASE                           S01117
     C                     OUT  DLDA                                      S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C* CALL ZSFILE TO LOG SPOOL FILE DETAILS FOR FT1000P7 REPORT         S01117
     C*                                                                   S01117
     C                     Z-ADDSFNUM7    ZSNUM                           S01117
     C                     MOVELSFILE7    ZSNAM                           S01117
     C                     EXSR SUBZSF                                    S01117
     C*                                                                   S01117
     C* IF ERROR PERFORM DATABASE ERROR HANDLING AND EXIT PROGRAM         S01117
     C*                                                                   S01117
     C           ZERR      IFEQ 'Y'                                       S01117
     C                     SETON                     U7U8LR               S01117
     C           *LOCK     IN   DLDA                                      S01117
     C                     MOVEL'FT1010'  DBPGM            ***************S01117
     C                     MOVEL'FT1010P7'DBKEY            ** DBERR  28 **S01117
     C                     MOVEL'ZSFILE'  DBFILE           ***************S01117
     C                     Z-ADD28        DBASE                           S01117
     C                     OUT  DLDA                                      S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*
      ** Access to bank Details                                                               CFT032
      *                                                                                       CFT032
     C                     CALL 'AOBANKR0'                                                    CFT032
     C                     PARM *BLANKS   PRTCD   7                                           CFT032
     C                     PARM '*FIRST ' POPTN   7                                           CFT032
     C           SDBANK    PARM SDBANK    DSFDY                                               CFT032
      *                                                                                       CFT032
     C           PRTCD     IFNE *BLANKS                                                       CFT032
     C                     Z-ADD46        WBASE                                               CFT032
     C                     MOVEL'SDBANKPD'WBFILE                                              CFT032
     C                     MOVEL'*FIRST'  WBKEY     P                                         CFT032
     C                     EXSR ABORT                                                         CFT032
     C                     ENDIF                                                              CFT032
      *                                                                                       CFT032
     C                     MOVEL'01    '  ZTABKY 12
     C                     MOVE '    10'  ZTABKY
     C                     Z-ADD*ZEROS    ZERO15 150
     C                     MOVE *BLANKS   BLNK35 35
     C                     MOVE '70'      SEVNTY  2
     C                     MOVE *BLANKS   BLNK5   5
     C                     MOVE *BLANKS   BLNK35 35
     C                     MOVE 'B'       B       1
     C                     MOVE 'YES'     YES     3
     C                     MOVE 'NO '     NO      3
     C**
     C           ZTABKY    CHAINTABFP                99    ON NOT THERE
     C*
     C           *IN99     IFEQ '1'                        ### B002
     C           RECITB    ORNE 'D'
     C                     MOVE 'TABLE'   WBFILE  5        ***************
     C                     MOVELZTABKY    WBKEY  28        ** DBERR  01 **
     C                     Z-ADD01        WBASE   20       ***************
     C                     EXSR ABORT
     C                     END                             ### E002
     C**
     C**   RUN  DATE  TO  DD/MM/YY  FORMAT
     C**
     C***********1*********CHAINPYCHGDDF             98                   S01194
     C*********************                                               S01194
     C************IN98*****IFEQ '1'                        ### B002       S01194
     C***********RECIPY****ORNE 'D'                                       S01194
     C*********************MOVE 'PYCHG'   WBFILE  5        ***************S01194
     C*********************MOVEL'1'       WBKEY  28        ** DBERR  02 **S01194
     C*********************Z-ADD02        WBASE   20       ***************S01194
     C*********************EXSR ABORT                                     S01194
     C*********************END                             ### E002       S01194
     C* CALL TO FUNDS TRANSFER ACCESS PGM                                 S01194
     C* READ SDFTFRPD FILE                                                S01194
     C*                                                                   S01194
     C                     CALL 'AOFTFRR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDFTFR    PARM SDFTFR    DSFDY                           S01194
     C*                                                                   S01194
     C* IF NO RECORD FOUND ON SDFTFRPD,DATABASE ERROR PROCESSING          S01194
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     MOVE 'SDFTFRPD'WBFILE           ***************S01194
     C                     MOVEL@OPTN     WBKEY            ** DBERR  02 **S01194
     C                     Z-ADD02        WBASE            ***************S01194
     C                     EXSR ABORT                                     S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C**N98******RUND******SUB  MATHPE    ZDAYNO                          S01194
     C           RUND      SUB  BTMAHP    ZDAYNO                          S01194
     C                     Z-ADDZDAYNO    STRMTH  50
     C*********************DUMP                                           CPK009
      *                                                                   S01435
      * Get message text for Account with Bank field                      S01435
      *                                                                   S01435
     C                     CALL 'MEC1150'              9090               S01435
     C                     PARM 'FTM2350 '#MSGID  7                       S01435
     C                     PARM 'FTUSRMSG'#MSGF  10                       S01435
     C                     PARM           #MSDTA                          S01435
     C                     PARM *BLANKS   #MSTX1                          S01435
     C                     PARM *BLANKS   #MSTX2                          S01435
      *                                                                   S01435
     C                     MOVEL#MSTX1    #IMSG  35                       S01435
     C*
     C                     MOVE '11'      ZTABKY
     C           ZTABKY    CHAINTABFP                99    ON NOT THERE
     C*
     C           *IN99     IFEQ '1'                        ### B002
     C           RECITB    ORNE 'D'
     C                     MOVE 'TABLE'   WBFILE           ***************
     C                     MOVELZTABKY    WBKEY            ** DBERR  03 **
     C                     Z-ADD03        WBASE            ***************
     C                     EXSR ABORT
     C                     END                             ### E002
     C*                                                                   S01117
     C* SETON MULTIBRANCHING INDICATOR                                    S01117
     C*                                                                   S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C                     SETON                     30                   S01117
     C                     END                                            S01117
     C*                                                                   S01494
     C** Access SAR details file to determine if S01494 is switched ON    S01494
     C*                                                                   S01494
     C                     MOVE '0'       *IN29                           S01494
     C                     CALL 'AOSARDR0'                                S01494
     C                     PARM *BLANKS   @RTCD   7                       S01494
     C                     PARM '*VERIFY' @OPTN   7                       S01494
     C                     PARM 'S01494'  @SARD   6                       S01494
     C           SCSARD    PARM SCSARD    DSFDY                           S01494
     C*                                                                   S01494
     C** If core feature is switched ON, set a variable field to          S01494
     C** condition the rest of the processing                             S01494
     C*                                                                   S01494
     C           @RTCD     IFEQ *BLANKS                                   S01494
     C                     MOVE '1'       *IN29                           S01494
     C                     ELSE                                           S01494
     C*                                                                   S01494
     C** else, database error (return code other than *NRF)               S01494
     C*                                                                   S01494
     C           @RTCD     IFNE '*NRF   '                                 S01494
     C                     MOVE 'SCSARDPD'WBFILE           ***************S01494
     C                     MOVEL'*VERIFY' WBKEY            ** DBERR  42 **S01494
     C                     Z-ADD42        WBASE            ***************S01494
     C                     EXSR ABORT                      *ABORT PGM*    S01494
     C                     END                                            S01494
     C                     END                                            S01494
      *                                                                   CFT003
      *  Access SAR details file to see if CFT003 is installed.           CFT003
      *                                                                   CFT003
     C                     CALL 'AOSARDR0'                                CFT003
     C                     PARM *BLANKS   P@RTCD  7                       CFT003
     C                     PARM '*VERIFY' P@OPTN  7                       CFT003
     C                     PARM 'CFT003'  @SARD   6                       CFT003
     C           SCSARD    PARM *BLANKS   DSFDY                           CFT003
      *                                                                   CFT003
      *  Allow Batch Authorisation processing                             CFT003
      *                                                                   CFT003
     C           P@RTCD    IFEQ *BLANKS                                   CFT003
     C           CFT003    ANDEQ*BLANKS                                   CFT003
     C                     MOVEL'CFT003'  CFT003  6                       CFT003
     C                     OPEN INPAYXL0                                  CFT003
     C                     OPEN OTPAYXL0                                  CFT003
     C                     ENDIF                                          CFT003
      *                                                                   CFT014
     C                     MOVE 'N'       CFT014  1                       CFT014
     C                     MOVE *OFF      *IN59                           CFT014
     C                     CALL 'AOSARDR0'                                CFT014
     C                     PARM *BLANKS   WRTCD   7                       CFT014
     C                     PARM '*VERIFY' WOPTN   7                       CFT014
     C                     PARM 'CFT014'  WSARD   6                       CFT014
     C           SCSARD    PARM SCSARD    DSFDY                           CFT014
     C           WRTCD     IFEQ *BLANKS                                   CFT014
     C                     MOVE 'Y'       CFT014                          CFT014
     C                     MOVE *ON       *IN59                           CFT014
     C           CFT003    IFNE 'CFT003'                                  CFT014
     C                     OPEN INPAYXL0                                  CFT014
     C                     OPEN OTPAYXL0                                  CFT014
     C                     ENDIF                                          CFT014
     C                     ELSE                                           CFT014
     C           WRTCD     IFNE '*NRF   '                                 CFT014
     C                     MOVEL'SCSARDPD'WBFILE           ************   CFT014
     C                     MOVEL'CFT014  'WBKEY            * DBERR019 *   CFT014
     C                     Z-ADD19        WBASE            ************   CFT014
     C                     EXSR ABORT                                     CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     MOVE 'N'       CEU006  1                       CFT014
     C                     CALL 'AOSARDR0'                                CFT014
     C                     PARM *BLANKS   WRTCD   7                       CFT014
     C                     PARM '*VERIFY' WOPTN   7                       CFT014
     C                     PARM 'CEU006'  WSARD   6                       CFT014
     C           SCSARD    PARM SCSARD    DSFDY                           CFT014
     C           WRTCD     IFEQ *BLANKS                                   CFT014
     C                     MOVE 'Y'       CEU006                          CFT014
     C                     ELSE                                           CFT014
     C           WRTCD     IFNE '*NRF   '                                 CFT014
     C                     MOVEL'SCSARDPD'WBFILE           ************   CFT014
     C                     MOVEL'CEU006  'WBKEY            * DBERR020 *   CFT014
     C                     Z-ADD20        WBASE            ************   CFT014
     C                     EXSR ABORT                                     CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C*                                                                   S01499
     C** Access SAR details file to determine if S01499 is switched ON    S01499
     C*                                                                   S01499
     C                     MOVE '0'       *IN39                           S01499
     C                     CALL 'AOSARDR0'                                S01499
     C                     PARM *BLANKS   @RTCD   7                       S01499
     C                     PARM '*VERIFY' @OPTN   7                       S01499
     C                     PARM 'S01499'  @SARD   6                       S01499
     C           SCSARD    PARM SCSARD    DSFDY                           S01499
     C*                                                                   S01499
     C** If core feature is switched ON, set a variable field to          S01499
     C** condition the rest of the processing                             S01499
     C*                                                                   S01499
     C           @RTCD     IFEQ *BLANKS                                   S01499
     C                     MOVE '1'       *IN39                           S01499
     C                     ELSE                                           S01499
     C*                                                                   S01499
     C** else, database error (return code other than *NRF)               S01499
     C*                                                                   S01499
     C           @RTCD     IFNE '*NRF   '                                 S01499
     C                     MOVE 'SCSARDPD'WBFILE           ***************S01499
     C                     MOVEL'*VERIFY' WBKEY            ** DBERR  43 **S01499
     C                     Z-ADD43        WBASE            ***************S01499
     C                     EXSR ABORT                      *ABORT PGM*    S01499
     C                     END                                            S01499
     C                     END                                            S01499
      *                                                                   CFT006
      ** Access SAR details file to see if CFT006 is installed.           CFT006
      *                                                                   CFT006
     C                     MOVE 'N'       CFT006                          CFT006
     C                     CALL 'AOSARDR0'                                CFT006
     C                     PARM *BLANKS   P@RTCD                          CFT006
     C                     PARM '*VERIFY' P@OPTN                          CFT006
     C                     PARM 'CFT006'  @SARD                           CFT006
     C           SCSARD    PARM *BLANKS   DSFDY                           CFT006
      *                                                                   CFT006
      *  Allow Batch Authorisation processing                             CFT006
      *                                                                   CFT006
     C           P@RTCD    IFEQ *BLANKS                                   CFT006
     C                     MOVE 'Y'       CFT006  1                       CFT006
     C                     ELSE                                           CFT006
      *                                                                   CFT006
     C           P@RTCD    IFNE '*NRF   '                                 CFT006
     C                     MOVE 'SCSARDPD'WBFILE           ************   CFT006
     C                     MOVEL'CFT006 ' WBKEY            * DBERR 44 *   CFT006
     C                     Z-ADD44        WBASE            ************   CFT006
     C                     EXSR ABORT                                     CFT006
     C                     ENDIF                                          CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      ** Access SAR details file to see if CFT008 is installed.           CFT006
      *                                                                   CFT006
     C                     MOVE 'N'       CFT008                          CFT006
     C                     CALL 'AOSARDR0'                                CFT006
     C                     PARM *BLANKS   P@RTCD                          CFT006
     C                     PARM '*VERIFY' P@OPTN                          CFT006
     C                     PARM 'CFT008'  @SARD                           CFT006
     C           SCSARD    PARM *BLANKS   DSFDY                           CFT006
      *                                                                   CFT006
      *  Allow Batch Authorisation processing                             CFT006
      *                                                                   CFT006
     C           P@RTCD    IFEQ *BLANKS                                   CFT006
     C                     MOVE 'Y'       CFT008  1                       CFT006
     C                     ELSE                                           CFT006
      *                                                                   CFT006
     C           P@RTCD    IFNE '*NRF   '                                 CFT006
     C                     MOVE 'SCSARDPD'WBFILE           ************   CFT006
     C                     MOVEL'CFT008 ' WBKEY            * DBERR 45 *   CFT006
     C                     Z-ADD45        WBASE            ************   CFT006
     C                     EXSR ABORT                                     CFT006
     C                     ENDIF                                          CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
      *                                                                   CFT009
      ** Access SAR details file to see if CFT009 is installed.           CFT009
      *                                                                   CFT009
     C                     CALL 'AOSARDR0'                                CFT009
     C                     PARM *BLANKS   P@RTCD                          CFT009
     C                     PARM '*VERIFY' P@OPTN                          CFT009
     C                     PARM 'CFT009'  @SARD                           CFT009
     C           SCSARD    PARM *BLANKS   DSFDY                           CFT009
      *                                                                   CFT009
     C           P@RTCD    IFEQ *BLANKS                                   CFT009
     C                     MOVE 'Y'       CFT009  1                       CFT009
     C                     MOVE *ON       *IN11                           CFT009
      *                                                                   CFT009
      ** Ensure UC files are opened, if not already open.                 CFT009
      *                                                                   CFT009
     C           CFT003    IFNE 'CFT003'                                  CFT009
     C           CFT014    ANDNE'Y'                                       CFT009
     C                     OPEN INPAYXL0                                  CFT009
     C                     OPEN OTPAYXL0                                  CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
      *                                                                   CFT009
     C                     MOVE *OFF      *IN11                           CFT009
     C                     MOVE 'N'       CFT009                          CFT009
      *                                                                   CFT009
     C           P@RTCD    IFNE '*NRF   '                                 CFT009
     C                     MOVE 'SCSARDPD'WBFILE           ************   CFT009
     C                     MOVEL'CFT009 ' WBKEY            * DBERR 62 *   CFT009
     C                     Z-ADD62        WBASE            ************   CFT009
     C                     EXSR ABORT                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Access SAR details file to see if CFT010 is installed.           CFT009
      *                                                                   CFT009
     C                     CALL 'AOSARDR0'                                CFT009
     C                     PARM *BLANKS   P@RTCD                          CFT009
     C                     PARM '*VERIFY' P@OPTN                          CFT009
     C                     PARM 'CFT010'  @SARD                           CFT009
     C           SCSARD    PARM *BLANKS   DSFDY                           CFT009
      *                                                                   CFT009
     C           P@RTCD    IFEQ *BLANKS                                   CFT009
     C                     MOVE 'Y'       CFT010  1                       CFT009
     C                     MOVE *ON       *IN13                           CFT009
     C                     ELSE                                           CFT009
      *                                                                   CFT009
     C                     MOVE *OFF      *IN13                           CFT009
     C                     MOVE 'N'       CFT010                          CFT009
      *                                                                   CFT009
     C           P@RTCD    IFNE '*NRF   '                                 CFT009
     C                     MOVE 'SCSARDPD'WBFILE           ************   CFT009
     C                     MOVEL'CFT010 ' WBKEY            * DBERR 63 *   CFT009
     C                     Z-ADD63        WBASE            ************   CFT009
     C                     EXSR ABORT                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                                       CSW203
      ** Check if SWIFT Changes 2003 (CSW203) is installed                                    CSW203
      *                                                                                       CSW203
     C                     CALL 'SWIF2003'                                                    CSW203
     C                     PARM *BLANKS   PRTCD   7                                           CSW203
      *                                                                                       CSW203
     C           PRTCD     IFEQ 'CSW2003'                                                     CSW203
     C                     MOVE 'Y'       CSW203  1                                           CSW203
     C                     MOVE *ON       *IN69                                               CSW203
     C                     ELSE                                                               CSW203
     C                     MOVE 'N'       CSW203                                              CSW203
     C                     MOVE *OFF      *IN69                                               CSW203
     C                     ENDIF                                                              CSW203
      *                                                                                       CSW207
      ** Check if SWIFT Changes 2007 (CSW207) is installed                                    CSW207
      *                                                                                       CSW207
     C                     CALL 'SWIF2007'                                                    CSW207
     C                     PARM *BLANKS   PRTCD   7                                           CSW207
      *                                                                                       CSW207
     C           PRTCD     IFEQ 'CSW2007'                                                     CSW207
     C                     MOVE 'Y'       CSW207  1                                           CSW207
     C                     ELSE                                                               CSW207
     C                     MOVE 'N'       CSW207                                              CSW207
     C                     ENDIF                                                              CSW207
      *                                                                                       CSW207
      ** Check if SWIFT Changes 2009 (CSW209) is installed                                    CSW209
      *                                                                                       CSW209
     C                     CALL 'SWIF2009'                                                    CSW209
     C                     PARM *BLANKS   PRTCD                                               CSW209
      *                                                                                       CSW209
     C           PRTCD     IFEQ 'CSW2009'                                                     CSW209
     C                     MOVE 'Y'       CSW209  1                                           CSW209
     C                     ELSE                                                               CSW209
     C                     MOVE 'N'       CSW209                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
      ** Check If CER031 is On                                                                CER030
      *                                                                                       CER030
     C                     MOVE 'N'       CER031  1                                           CER030
      *                                                                                       CER030
     C                     CALL 'AOSARDR0'                                                    CER030
     C                     PARM *BLANKS   PRTCD                                               CER030
     C                     PARM '*VERIFY' POPTN                                               CER030
     C                     PARM 'CER031'  PSARD   6                                           CER030
     C           SCSARD    PARM *BLANKS   DSFDY                                               CER030
      *                                                                                       CER030
     C           PRTCD     IFEQ *BLANKS                                                       CER030
     C                     MOVE 'Y'       CER031                                              CER030
     C                     ELSE                                                               CER030
      *                                                                                       CER030
      ** else, database error (return code other than *NRF)                                   CER030
      *                                                                                       CER030
     C           PRTCD     IFNE '*NRF   '                                                     CER030
     C                     MOVE 'SCSARDPD'WBFILE                                              CER030
     C                     MOVELPSARD     WBKEY                                               CER030
     C                     Z-ADD902       WBASE                                               CER030
     C                     EXSR ABORT                                                         CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      ** Check If CER030 is On                                                                CER030
      *                                                                                       CER030
     C                     MOVE 'N'       CER030  1                                           CER030
      *                                                                                       CER030
     C                     CALL 'AOSARDR0'                                                    CER030
     C                     PARM *BLANKS   PRTCD                                               CER030
     C                     PARM '*VERIFY' POPTN                                               CER030
     C                     PARM 'CER030'  PSARD                                               CER030
     C           SCSARD    PARM *BLANKS   DSFDY                                               CER030
      *                                                                                       CER030
     C           PRTCD     IFEQ *BLANKS                                                       CER030
     C                     MOVE 'Y'       CER030                                              CER030
     C                     ELSE                                                               CER030
      *                                                                                       CER030
      ** else, database error (return code other than *NRF)                                   CER030
      *                                                                                       CER030
     C           PRTCD     IFNE '*NRF   '                                                     CER030
     C                     MOVE 'SCSARDPD'WBFILE                                              CER030
     C                     MOVELPSARD     WBKEY                                               CER030
     C                     Z-ADD903       WBASE                                               CER030
     C                     EXSR ABORT                                                         CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      ** Check If CGL013 is On                                                                CER030
      *                                                                                       CER030
     C                     MOVE 'N'       CGL013  1                                           CER030
      *                                                                                       CER030
     C                     CALL 'AOSARDR0'                                                    CER030
     C                     PARM *BLANKS   PRTCD                                               CER030
     C                     PARM '*VERIFY' POPTN                                               CER030
     C                     PARM 'CGL013'  PSARD                                               CER030
     C           SCSARD    PARM *BLANKS   DSFDY                                               CER030
      *                                                                                       CER030
     C           PRTCD     IFEQ *BLANKS                                                       CER030
     C                     MOVE 'Y'       CGL013                                              CER030
     C                     ELSE                                                               CER030
      *                                                                                       CER030
      ** else, database error (return code other than *NRF)                                   CER030
      *                                                                                       CER030
     C           PRTCD     IFNE '*NRF   '                                                     CER030
     C                     MOVE 'SCSARDPD'WBFILE                                              CER030
     C                     MOVELPSARD     WBKEY                                               CER030
     C                     Z-ADD904       WBASE                                               CER030
     C                     EXSR ABORT                                                         CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      *                                                                                       CFT120
      ** Check If CFT120 is On                                                                CFT120
      *                                                                                       CFT120
     C                     MOVE 'N'       CFT120  1                                           CFT120
      *                                                                                       CFT120
     C                     CALL 'AOSARDR0'                                                    CFT120
     C                     PARM *BLANKS   PRTCD                                               CFT120
     C                     PARM '*VERIFY' POPTN                                               CFT120
     C                     PARM 'CFT120'  PSARD                                               CFT120
     C           SCSARD    PARM *BLANKS   DSFDY                                               CFT120
      *                                                                                       CFT120
     C           PRTCD     IFEQ *BLANKS                                                       CFT120
     C                     MOVE 'Y'       CFT120                                              CFT120
     C                     MOVE '1'       *IN58                                               CFT120
     C                     ELSE                                                               CFT120
      *                                                                                       CFT120
      ** else, database error (return code other than *NRF)                                   CFT120
      *                                                                                       CFT120
     C           PRTCD     IFNE '*NRF   '                                                     CFT120
     C                     MOVE 'SCSARDPD'WBFILE                                              CFT120
     C                     MOVELPSARD     WBKEY                                               CFT120
     C                     Z-ADD905       WBASE                                               CFT120
     C                     EXSR ABORT                                                         CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT166
      ** Check If CFT166 is ON                                                                CFT166
      *                                                                                       CFT166
     C                     MOVE 'N'       CFT166  1                                           CFT166
      *                                                                                       CFT166
     C                     CALL 'AOSARDR0'                                                    CFT166
     C                     PARM *BLANKS   PRTCD                                               CFT166
     C                     PARM '*VERIFY' POPTN                                               CFT166
     C                     PARM 'CFT166'  PSARD                                               CFT166
     C           SCSARD    PARM *BLANKS   DSFDY                                               CFT166
      *                                                                                       CFT166
     C           PRTCD     IFEQ *BLANKS                                                       CFT166
     C                     MOVE 'Y'       CFT166                                              CFT166
     C                     ELSE                                                               CFT166
      *                                                                                       CFT166
      ** else, database error                                                                 CFT166
      *                                                                                       CFT166
     C           PRTCD     IFNE '*NRF   '                                                     CFT166
     C                     MOVE 'SCSARDPD'WBFILE                                              CFT166
     C                     MOVELPSARD     WBKEY                                               CFT166
     C                     Z-ADD906       WBASE                                               CFT166
     C                     EXSR ABORT                                                         CFT166
     C                     ENDIF                                                              CFT166
      *                                                                                       CFT166
     C                     ENDIF                                                              CFT166
     C/COPY WNCPYSRC,FT1010C013
     C*                                                                   S01414
     C* Move the conditional IF so that AOGELRR0 is always called.        S01414
     C*                                                             S01194S01414
     C**IF*MULTIBRANCHING*INDICATOR*IS*SETON*THEN*ACCESS*SDGELRPD*VIS01194S01414
     C******AOGELR0*PROGRAM*FOR*ORIGINATING*BRANCH*USED*FLAG*       S01194S01414
     C***********                                                   S01194S01414
     C************IN30*****IFEQ '1'                                 S01194S01414
      *                                                                   S01414
      *  Access SDGELRPD for originating branch used flag                 S01414
      *                  and Profit Centres In Use Flag                   S01414
      *                                                                   S01194
     C**********           CALL 'AOGELRR0'                                S01194              CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM '*MSG  '  @RTCD   7                       S01194
     C                     PARM '*FIRST'  @OPTN   7                       S01194
     C********** SDGELR    PARM SDGELR    DSFDY                           S01194              CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     MOVE 'SDGELRPD'WBFILE           ***************S01194
     C                     MOVEL'*FIRST'  WBKEY            ** DBERR  29 **S01194
     C                     Z-ADD29        WBASE            ***************S01194
     C                     EXSR ABORT                                     S01194
     C                     END                                            S01194
      *                                                             S01117S01414
      *  If multi branching indicator on                            S01117S01414
      *                                                             S01117S01414
     C           *IN30     IFEQ '1'                                 S01117S01414
     C*                                                                   S01194
     C* IF ORIGINATING BRANCH USED FLAG IS ON, SET ON INDICATOR 35        S01117
     C*                                                                   S01117
     C           BKOBRU    IFEQ 'Y'                                       S01117
     C                     SETON                     35                   S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     END                                            S01117
      *                                                                   S01414
      *  Check if Profit Centres are used and set screen attributes       S01414
      *                                                                   S01414
     C           BKPRCU    IFEQ 'Y'                                       S01414
     C                     MOVE '1'       *IN70                           S01414
     C                     END                                            S01414
     C*
     C** DECIMAL POSITIONS FOR 'BASE' CURRENCY
     C*
     C** CALL UATBCN TO ACCESS CURRENCY RECORD FOR BASE CURRENCY          S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   ZTABKY                          S01435
     C                     MOVEL'20'      ZTABKY                          S01435
     C                     MOVELBCCY      WA4     4                       S01435
     C                     MOVE '1'       WA4                             S01435
     C                     MOVE WA4       ZTABKY                          S01435
     C                     EXSR UATBCN                                    S01435
     C*                                                                   S01435
     C** CHECK IF DATABASE ERROR OCCURRED                                 S01435
     C*                                                                   S01435
     C           *IN89     IFEQ '1'                                       S01435
     C                     MOVEL'TABLE'   WBFILE                          S01435
     C                     MOVELZTABKY    WBKEY                           S01435
     C                     MOVEL'53'      WBASE                           S01435
     C                     EXSR ABORT                      *ABORT PGM*    S01435
     C                     END                                            S01435
     C*                                                                   S01435
     C** STORE NUMBER OF DECIMAL PLACES FOR BASE CURRENCY                 S01435
     C*                                                                   S01435
     C                     Z-ADDCDP       SVBCDP  10
      *                                                                   S01435
      ** Call UATBCN to Access local currency record                      S01435
      *                                                                   S01435
     C                     MOVEL*BLANKS   ZTABKY                          S01435
     C                     MOVEL'20'      ZTABKY                          S01435
     C                     MOVELLOCY      WA4                             S01435
     C                     MOVE '1'       WA4                             S01435
     C                     MOVE WA4       ZTABKY                          S01435
     C                     EXSR UATBCN                                    S01435
      *                                                                   S01435
      ** Check if database error occurred                                 S01435
      *                                                                   S01435
     C           *IN89     IFEQ '1'                                       S01435
     C                     MOVEL'TABLE'   WBFILE                          S01435
     C                     MOVELZTABKY    WBKEY                           S01435
     C                     MOVEL'51'      WBASE                           S01435
     C                     EXSR ABORT                      *ABORT PGM*    S01435
     C                     END                                            S01435
      *                                                                   S01435
      ** Store number of decimal places for base currency                 S01435
      *                                                                   S01435
     C                     Z-ADDCDP       SVLCDP  10                      S01435
     C**
     C*  USED IN SUBROUTINE 'CHOPF'
     C**********           MOVE *BLANKS   BLNK10 10                                           CGL029
     C**********           MOVE *BLANKS   BLNK2   2                                           CGL029
     C                     MOVE *BLANKS   BLNK10 16                                           CGL029
     C                     MOVE *BLANKS   BLNK2   8                                           CGL029
     C*
     C**   SET  UP  FIELDS
     C**
     C                     MOVEL'*** DIFF'DIFFXX 16
     C                     MOVE 'ERENCE *'DIFFXX
     C                     MOVEL'WRITE '  WRTERR 11
     C                     MOVE 'ERROR'   WRTERR
     C                     MOVE 'WRITE'   WRITE   5
     C                     MOVE *BLANKS   BLNK5   5
     C/COPY WNCPYSRC,FT1010C002
     C*
     C                     END                             ### E001
     C********************************************************************
     C/EJECT
     C********************************************************************
     C***
     C***   D E T A I L    P R O C E S S I N G
     C***
     C********************************************************************
     C*
     C      01             EXSR INPAYS
     C      02             EXSR OTPAYS
     C      03             EXSR CQCODS
     C      04             EXSR CQCOCS
     C      05             EXSR CQPACS
     C      06             EXSR CQPADS
     C      07             EXSR NTRANS
     C      08             EXSR CQREGS
      *                                                                   CFT006
     C           CFT006    IFEQ 'Y'                                       CFT006
     C           *IN09     IFEQ *ON                                       CFT006
     C                     EXSR SRRFT                                     CFT006
     C                     ENDIF                                          CFT006
     C                     ENDIF                                          CFT006
     C           CFT008    IFEQ 'Y'                                       CFT006
     C           *IN10     IFEQ *ON                                       CFT006
     C                     EXSR SRCCT                                     CFT006
     C                     ENDIF                                          CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C/COPY WNCPYSRC,FT1010C003
     C*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C***
     C***   T R A I L E R    P R O C E S S I N G
     C***
     C********************************************************************
     C*
     C   21                EXSR INPAYT
     C   22                EXSR OTPAYT
     C   23                EXSR CQCODT
     C   24                EXSR CQCOCT
     C   25                EXSR CQPACT
     C   26                EXSR CQPADT
     C   27                EXSR NTRANT
     C   28                EXSR CQREGT
     C********************************************************************
     C/EJECT
     C********************************************************************
     C***
     C***   F I N A L     P R O C E S S I N G
     C***
     C********************************************************************
     C*
     CLR         *IN61     IFEQ '1'                        ANY FILE
     CLR         *IN62     OREQ '1'                         ERROR ?
     CLR         *IN63     OREQ '1'
     CLR         *IN64     OREQ '1'
     CLR         *IN65     OREQ '1'
     CLR         *IN66     OREQ '1'
     CLR         *IN67     OREQ '1'
     CLR         *IN68     OREQ '1'
     CLR                   SETON                     U8
     CLR                   END
     C*                                                                   S01117
     C* CALL ZSFILE TO LOG SPOOL FILE DETAILS FOR AUDIT REPORT IF NO      S01117
     C* INPUT RECORDS AND PROGRAM GOES STRAIGHT TO LR PROCESSING          S01117
     C*                                                                   S01117
     CLR         *IN80     IFEQ '0'                                       S01117
     CLR                   Z-ADDSFNUMU    ZSNUM                           S01117
     CLR                   MOVELSFILEU    ZSNAM                           S01117
     CLR                   EXSR SUBZSF                                    S01117
     CLR                   END                                            S01117
     C*
     C*LR*******************WRITEP1CONT                      REPORT       S01117
     CLR                   WRITEAUCONT                      REPORT        S01117
     C*
     C** OUTPUT END-OF-REPORT MESSAGE TO DETAIL REPORT
     C*
     CLR         *IN82     IFEQ '0'
     CLR                   Z-ADD1         P2PAGE
     CLR                   WRITEP2HEDT                 60
     CLR                   END
     CLR                   WRITEP2EOR                  60
     CLR         *IN83     IFEQ '0'
     CLR                   Z-ADD1         P3PAGE
     CLR                   WRITEP3HEDT                 60
     CLR                   END
     CLR                   WRITEP3EOR                  60
     CLR         *IN84     IFEQ '0'                        NO DETAIL
     CLR                   Z-ADD1         P4PAGE
     CLR                   WRITEP4HD                       ON THE
     CLR                   END
     CLR                   WRITEP4EOR                  60
     CLR         *IN85     IFEQ '0'                        NO DETAIL
     CLR                   Z-ADD1         P5PAGE
     CLR                   MOVELTITL      P5TITL
     CLR                   MOVELRUNA      P5DATE
     CLR                   WRITEP5HD                       ON THE
     CLR                   END
     CLR                   WRITEP5EOR                  60
     CLR         *IN86     IFEQ '0'
     CLR                   Z-ADD1         P6PAGE
     CLR                   MOVELTITL      P6TITL
     CLR                   MOVELRUNA      P6DATE
     CLR                   WRITEP6HD                   60
     CLR                   END
     CLR                   WRITEP6EOR                  60
     CLR         *IN87     IFEQ '0'
     CLR                   Z-ADD1         P7PAGE
     CLR                   MOVELTITL      P7TITL
     CLR                   MOVELRUNA      P7DATE
     CLR                   WRITEP7HEDT                 60
     CLR                   END
     CLR                   WRITEP7EOR                  60
     C*
     C*
     C/EJECT                                                              S01117
     C********************************************************************S01117
     C* SUBZSF SR.                                                        S01117
     C* ZSFILE  HANDLING                                                  S01117
     C*                                                                   S01117
     C           SUBZSF    BEGSR                                          S01117
     C*                                                                   S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           ZSEQ    5                       S01117
     C                     PARM *BLANKS   ZENT    3                       S01117
     C                     PARM           ZSNAM  10                       S01117
     C                     PARM           ZSNUM   60                      S01117
     C                     PARM *BLANKS   ZERR    1                       S01117
     C*                                                                   S01117
     C                     ENDSR                                          S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C/EJECT
     C********************************************************************
     C**
     C**   TEST IF A RECORD IS LIVE OR MATURING AT A LATER DATE
     C**                                                               63)
     C           TSMORL    BEGSR                           ** TSMORL **
     C*
     C                     MOVE BLNK5     DECIS   5
     C           RECI      IFNE 'M'                        ## B001
     C                     MOVE WRITE     DECIS
     C                     ELSE                            ## X001
     C*
     C                     SETOF                     89
     C           PREF      CHAINLIVEC                89
     C           *IN89     IFEQ '0'                        ## B002
     C                     MOVE WRITE     DECIS
     C                     ELSE                            ## X002
     C*
     C                     SETOF                     89
     C           PREF      SETLLMATUC
     C                     READ MATUC                    89
     C*
     C           *IN89     IFEQ '0'                        ## B003
     C           PREF      ANDEQMPREF
     C***********DATEIN    ANDGESTRMTH                                    047171
     C*                                                                   047171
     C           DATEIN    IFGE MOEDT                                     047171
     C                     Z-ADDDATEIN    WDAT                            047171
     C                     ELSE                                           047171
     C                     Z-ADDMOEDT     WDAT                            047171
     C                     END                                            047171
     C*                                                                   047171
     C           WDAT      IFGE STRMTH                                    047171
     C                     MOVE WRITE     DECIS
     C                     END                                            047171
     C*                                                                   047171
     C                     END                             ## E003
     C*
     C                     END                             ## E002
     C                     END                             ## E001
     C*---
     C           DECIS     IFEQ WRITE                      ## B001
     C                     ADD  8         H
     C                     EXSR HASH
      *                                                                   E32873
      *  Even though all the subroutines which call TSMORL set RECI, LCD &E32873
      *  CHTP reset them here again as accesses to MATUC or LIVEC will    E32873
      *  have overwritten these fields.                                   E32873
     C           *IN03     IFEQ '1'                                       E32873
     C                     MOVEL@R05      RECI                            E32873
     C                     MOVEL@L05      LCD                             E32873
     C                     MOVEL@C05      CHTP                            E32873
     C                     Z-ADD@O05      OEDT    50                      111825
     C*********************WRITEXQCODDDF               88           E32873E32894
     C                     UPDATCQCODDDF               88                 E32894
     C                     END                                            E32873
      *                                                                   E32873
      *                                                                   E32873
     C           *IN04     IFEQ '1'                                       E32873
     C                     MOVEL@R07      RECI                            E32873
     C                     MOVEL@L07      LCD                             E32873
     C                     MOVEL@C07      CHTP                            E32873
     C                     Z-ADD@O07      OEDT                            111825
     C*********************WRITEXQCOCDDF               88           E32873E32894
     C                     UPDATCQCOCDDF               88                 E32894
     C                     END                                            E32873
      *                                                                   E32873
      *                                                                   E32873
     C           *IN05     IFEQ '1'                                       E32873
     C                     MOVEL@R09      RECI                            E32873
     C                     MOVEL@L09      LCD                             E32873
     C                     MOVEL@C09      CHTP                            E32873
     C                     Z-ADD@O09      OEDT                            111825
     C*********************WRITEXQPACDDF               88           E32873E32894
     C                     UPDATCQPACDDF               88                 E32894
     C                     END                                            E32873
      *                                                                   E32873
      *                                                                   E32873
     C           *IN06     IFEQ '1'                                       E32873
     C                     MOVEL@R11      RECI                            E32873
     C                     MOVEL@L11      LCD                             E32873
     C                     MOVEL@C11      CHTP                            E32873
     C                     Z-ADD@O11      OEDT                            111825
     C*********************WRITEXQPADDDF               88           E32873E32894
     C                     UPDATCQPADDDF               88                 E32894
     C                     END                                            E32873
      *                                                                   E32873
     C******03*************WRITEXQCODDDF               88                 E32873
     C******04*************WRITEXQCOCDDF               88                 E32873
     C******05*************WRITEXQPACDDF               88                 E32873
     C******06*************WRITEXQPADDDF               88                 E32873
     C                     END                             ## E001
     C*
     C                     ENDSR
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C**   THE PROCESSING FOR A RECORD FROM 'INPAYDD'
     C**
     C           INPAYS    BEGSR                           ** INPAYS **
     C                     Z-ADD1         H       20
     C                     Z-ADDSMAM      PRMAMT 130
     C                     EXSR HASH
     C                     ADD  8         H
     C*-
     C                     MOVEL@R01      RECI                            E32839
     C                     MOVEL@L01      LCD                             E32873
     C                     MOVEL@C01      CHTP                            E32873
     C                     Z-ADD@O01      OEDT                            111825
      *                                                                   E32839
     C           RECI      IFNE 'M'                        ## B001
     C                     EXSR HASH
     C*********************WRITEXNPAYDDF               88                 E32894
     C                     UPDATINPAYDDF               88                 E32894
     C*
     C                     ELSE                            ## X001
     C*                                                                   047171
     C           SLDT      IFGE OEDT                                      047171
     C                     Z-ADDSLDT      WDAT                            047171
     C                     ELSE                                           047171
     C                     Z-ADDOEDT      WDAT    50                      047171
     C                     END                                            047171
     C*                                                                   047171
     C           PVDT      IFGE WDAT                                      047171
     C                     Z-ADDPVDT      WDAT                            047171
     C                     END                                            047171
     C*                                                                   047171
     C*
     C***********SLDT      IFGE STRMTH                     ## B002        047171
     C           WDAT      IFGE STRMTH                                    047171
     C                     EXSR HASH
     C*********************WRITEXNPAYDDF               88                 E32894
     C                     UPDATINPAYDDF               88                 E32894
     C*********************END                                            E32894
     C                     ELSE                            ## X002        E32894
     C/COPY WNCPYSRC,FT1010C014
     C                     EXSR INPREP
     C                     MOVE *BLANKS   WPREF  13                                          BUG4776
     C                     MOVELPREF      WPREF                                              BUG4776
     C                     MOVELPREF      OVREF  15                                           CFT166
     C/COPY WNCPYSRC,FT1010C001
     C                     DELETINPAYDDF                                  E32894
     C           WPREF     CHAINFTPREFL1             42                                      BUG4776
     C           *IN42     IFEQ '0'                                                          BUG4776
     C                     DELETFTPREFDF                                                     BUG4776
     C                     ENDIF                                                             BUG4776
      *                                                                                       CFT166
      ** Purge from FT Account Balance Override file                                          CFT166
      *                                                                                       CFT166
     C           CFT166    IFEQ 'Y'                                                           CFT166
     C           OVREF     CHAINFTABOVL0             44                                       CFT166
     C           *IN44     IFEQ '0'                                                           CFT166
     C                     DELETFTABOVD0                                                      CFT166
     C                     ENDIF                                                              CFT166
     C                     ENDIF                                                              CFT166
     C/COPY WNCPYSRC,FT1010C006
     C                     END                             ## E002        E32894
     C                     END                             ## E001
     C*
     C           *IN88     IFEQ '1'                        ## B001
     C                     MOVE 'INPAY'   WBFILE           ***************
     C                     MOVELWRTERR    WBKEY            ** DBERR  04 **
     C                     Z-ADD04        WBASE            ***************
     C                     EXSR ABORT
     C                     END                             ## E001
     C*
     C                     ENDSR
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C**   THE PROCESSING FOR A RECORD FROM 'OTPAYDD'
     C**                                                               63)
     C           OTPAYS    BEGSR                           ** OTPAYS **
     C                     Z-ADD2         H
     C                     Z-ADDSMAM      PRMAMT
     C                     EXSR HASH
     C                     ADD  8         H
     C*-
     C                     MOVEL@R03      RECI                            E32839
     C                     MOVEL@L03      LCD                             E32873
     C                     MOVEL@C03      CHTP                            E32873
     C                     Z-ADD@O03      OEDT                            111825
      *                                                                   E32839
     C           RECI      IFNE 'M'                        ## B001
     C                     EXSR HASH
     C*********************WRITEXTPAYDDF               88                 E32894
     C                     UPDATOTPAYDDF               88                 E32894
     C*
     C                     ELSE                            ## X001
     C*                                                                   047171
     C           SLDT      IFGE OEDT                                      047171
     C                     Z-ADDSLDT      WDAT                            047171
     C                     ELSE                                           047171
     C                     Z-ADDOEDT      WDAT                            047171
     C                     END                                            047171
     C*                                                                   047171
     C           PVDT      IFGE WDAT                                      047171
     C                     Z-ADDPVDT      WDAT                            047171
     C                     END                                            047171
     C*
     C***********SLDT      IFGE STRMTH                     ## B002        047171
     C           WDAT      IFGE STRMTH                                    047171
     C                     EXSR HASH
     C*********************WRITEXTPAYDDF               88                 E32894
     C                     UPDATOTPAYDDF               88                 E32894
     C*********************END                                            E32894
     C                     ELSE                            ## X002        E32894
     C/COPY WNCPYSRC,FT1010C039
     C                     EXSR OTPREP
     C                     MOVE *BLANKS   WPREF                                              BUG4776
     C                     MOVELPREF      WPREF                                              BUG4776
     C                     MOVELPREF      OVREF                                               CFT166
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT1010CCP2                                           S01408
     C*                                                                   S01408
      ***If*Batch*Authorsation*update/add*record********************CFT003CFT014
      **************************************************************CFT003CFT014
     C***********CFT003    IFEQ 'CFT003'                            CFT003CFT014
      **************************************************************CFT003CFT014
     C***********PREF      CHAINOTPAYXL0             79             CFT003CFT014
      **************************************************************CFT003CFT014
      ***If*found,*delete*OTPAYXL0**********************************CFT003CFT014
      **************************************************************CFT003CFT014
     C************IN79     IFEQ '0'                                 CFT003CFT014
     C***********          DELETOTPAYXDF                            CFT003CFT014
     C***********          ENDIF                           -*IN79   CFT003CFT014
      **************************************************************CFT003CFT014
     C***********          ENDIF                                    CFT003CFT014
      *                                                                   CFT003
     C/COPY WNCPYSRC,FT1010C045
     C                     DELETOTPAYDDF                                  E32894
     C           WPREF     CHAINFTPREFL1             42                                      BUG4776
     C           *IN42     IFEQ '0'                                                          BUG4776
     C                     DELETFTPREFDF                                                     BUG4776
     C                     ENDIF                                                             BUG4776
      *                                                                                       CFT166
      ** Purge from FT Account Balance Override file                                          CFT166
      *                                                                                       CFT166
     C           CFT166    IFEQ 'Y'                                                           CFT166
     C           OVREF     CHAINFTABOVL0             44                                       CFT166
     C           *IN44     IFEQ '0'                                                           CFT166
     C                     DELETFTABOVD0                                                      CFT166
     C                     ENDIF                                                              CFT166
     C                     ENDIF                                                              CFT166
     C/COPY WNCPYSRC,FT1010C004
     C                     END                             ## E002        E32894
     C                     END                             ## E001
     C*
     C           *IN88     IFEQ '1'                        ## B001
     C                     MOVE 'OTPAY'   WBFILE           ***************
     C                     MOVELWRTERR    WBKEY            ** DBERR  05 **
     C                     Z-ADD05        WBASE            ***************
     C                     EXSR ABORT
     C                     END                             ## E001
     C*
     C                     ENDSR
     C********************************************************************
     C/COPY WNCPYSRC,FT1010C005
     C/EJECT
     C********************************************************************
     C**
     C**   THE PROCESSING FOR A RECORD FROM 'CQCOCDD'
     C**
     C           CQCOCS    BEGSR                           ** CQCOCS **
     C                     Z-ADD4         H
     C                     Z-ADDCQAM      PRMAMT
     C                     EXSR HASH
     C*-
     C                     MOVEL@R07      RECI                            E32973
     C                     MOVEL@L07      LCD                             E32873
     C                     MOVEL@C07      CHTP                            E32873
     C                     Z-ADD@O07      OEDT                            111825
     C*                                                                   E32873
     C                     EXSR TSMORL
     C*
     C           DECIS     IFNE 'WRITE'
     C/COPY WNCPYSRC,FT1010C040
     C                     MOVE 'C'       P#CRDB
     C                     EXSR CQCREP
     C                     DELETCQCOCDDF                                  E32894
     C/COPY WNCPYSRC,FT1010C018
     C                     END
     C*
     C           *IN88     IFEQ '1'                        ## B001
     C                     MOVE 'CQCOC'   WBFILE           ***************
     C                     MOVELWRTERR    WBKEY            ** DBERR  06 **
     C                     Z-ADD06        WBASE            ***************
     C                     EXSR ABORT
     C                     END                             ## E001
     C*
     C                     ENDSR
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C**   THE PROCESSING FOR A RECORD FROM 'CQCODDD'
     C**
     C           CQCODS    BEGSR                           ** CQCODS **
     C                     Z-ADD3         H
     C                     Z-ADDTOCL      PRMAMT
     C                     EXSR HASH
     C*
     C                     MOVEL@R05      RECI                            E32873
     C                     MOVEL@L05      LCD                             E32873
     C                     MOVEL@C05      CHTP                            E32873
     C                     Z-ADD@O05      OEDT                            111825
     C*                                                                   E32873
     C                     EXSR TSMORL
     C*
     C           DECIS     IFNE 'WRITE'
     C                     MOVE 'D'       P#CRDB  1
     C                     EXSR CQCREP
     C                     DELETCQCODDDF                                  E32894
     C/COPY WNCPYSRC,FT1010C019
     C                     END
     C*
     C           *IN88     IFEQ '1'                        ## B001
     C                     MOVE 'CQCOD'   WBFILE           ***************
     C                     MOVELWRTERR    WBKEY            ** DBERR  07 **
     C                     Z-ADD07        WBASE            ***************
     C                     EXSR ABORT
     C*
     C                     END                             ## E001
     C*
     C                     ENDSR
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C**   THE PROCESSING FOR A RECORD FROM 'CQPACDD'
     C**
     C           CQPACS    BEGSR                           ** CQPACS **
     C                     Z-ADD5         H
     C                     Z-ADDPRRM      PRMAMT
     C                     EXSR HASH
     C*-
     C                     MOVEL@R09      RECI                            E32873
     C                     MOVEL@L09      LCD                             E32873
     C                     MOVEL@C09      CHTP                            E32873
     C                     Z-ADD@O09      OEDT                            111825
     C*                                                                   E32873
     C                     EXSR TSMORL
     C*
     C           DECIS     IFNE 'WRITE'
     C                     MOVE 'C'       Q#CRDB
     C                     EXSR CQPREP
     C                     DELETCQPACDDF                                  E32894
     C/COPY WNCPYSRC,FT1010C020
     C                     END
     C*
     C           *IN88     IFEQ '1'                        ## B001
     C                     MOVE 'CQPAC'   WBFILE           ***************
     C                     MOVELWRTERR    WBKEY            ** DBERR  08 **
     C                     Z-ADD08        WBASE            ***************
     C                     EXSR ABORT
     C                     END                             ## E001
     C*
     C                     ENDSR
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C**   THE PROCESSING FOR A RECORD FROM 'CQPADDD'
     C**
     C           CQPADS    BEGSR                           ** CQPADS **
     C                     Z-ADD6         H
     C                     Z-ADDCQAM      PRMAMT
     C                     EXSR HASH
     C*-
     C                     MOVEL@R11      RECI                            E32873
     C                     MOVEL@L11      LCD                             E32873
     C                     MOVEL@C11      CHTP                            E32873
     C                     Z-ADD@O11      OEDT                            111825
     C*                                                                   E32873
     C                     EXSR TSMORL
     C*
     C           DECIS     IFNE 'WRITE'
     C/COPY WNCPYSRC,FT1010C041
     C                     MOVE 'D'       Q#CRDB  1
     C                     EXSR CQPREP
     C                     DELETCQPADDDF                                  E32894
     C/COPY WNCPYSRC,FT1010C021
     C                     END
     C*
     C           *IN88     IFEQ '1'                        ## B001
     C                     MOVE 'CQPAD'   WBFILE           ***************
     C                     MOVELWRTERR    WBKEY            ** DBERR  09 **
     C                     Z-ADD09        WBASE            ***************
     C                     EXSR ABORT
     C                     END                             ## E001
     C*                                                                   S01408
     C/COPY WNCPYSRC,FT1010CCP1                                           S01408
     C*                                                                   S01408
     C*
     C                     ENDSR
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C**   THE PROCESSING FOR A RECORD FROM 'NTRANDD'
     C**
     C           NTRANS    BEGSR                           ** NTRANS **
     C*
     C                     Z-ADD7         H
     C                     Z-ADDAMNT      PRMAMT
     C                     EXSR HASH
     C                     ADD  8         H
     C*-
     C                     MOVEL@R13      RECI                            E32839
     C                     MOVEL@L13      LCD                             E32873
     C                     MOVEL@C13      CHTP                            E32873
     C                     Z-ADD@O13      OEDT                            111825
      *                                                                   E32839
     C           RECI      IFNE 'M'                        ## B001
     C                     EXSR HASH
     C*********************WRITEXTRANDDF               88                 E32894
     C                     UPDATNTRANDDF               88                 E32894
     C*
     C                     ELSE                            ## X001
     C*                                                                   047171
     C           VDAT      IFGE OEDT                                      047171
     C                     Z-ADDVDAT      WDAT                            047171
     C                     ELSE                                           047171
     C                     Z-ADDOEDT      WDAT                            047171
     C                     END                                            047171
     C*
     C***********VDAT      IFGE STRMTH                     ## B002        047171
     C           WDAT      IFGE STRMTH                                    047171
     C                     EXSR HASH
     C*********************WRITEXTRANDDF               88                 E32894
     C                     UPDATNTRANDDF               88                 E32894
     C*********************END                                            E32894
     C                     ELSE                            ## X002        E32894
     C                     EXSR NTRREP
     C                     DELETNTRANDDF                                  E32894
     C/COPY WNCPYSRC,FT1010C044
     C                     END                             ## E002        E32894
     C                     END                             ## E001
     C*
     C           *IN88     IFEQ '1'                        ## B001
     C                     MOVE 'NTRAN'   WBFILE           ***************
     C                     MOVELWRTERR    WBKEY            ** DBERR  10 **
     C                     Z-ADD10        WBASE            ***************
     C                     EXSR ABORT
     C                     END                             ## E001
     C*
     C                     ENDSR
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C**   THE PROCESSING FOR A RECORD FROM 'CQREGDD'
     C**
     C           CQREGS    BEGSR                           ** CQREGS **
     C*
     C                     Z-ADD8         H
     C                     Z-ADDCQAM      PRMAMT
     C                     EXSR HASH
     C                     ADD  8         H
     C*-
     C                     MOVEL@R15      RECI                            E32873
     C                     MOVEL@L15      LCD                             E32873
     C                     MOVEL@C15      CHTP                            E32873
      *                                                                   E32873
     C/COPY WNCPYSRC,FT1010C015
     C           CLER      IFNE 'Y'                        ## B001
     C                     EXSR HASH
     C*********************WRITEXQREGDDF               88                 E32894
     C                     UPDATCQREGDDF               88                 E32894
     C*
     C                     ELSE                            ## X001
     C*
     C           PDTE      IFGE STRMTH                     ## B002
     C                     EXSR HASH
     C*********************WRITEXQREGDDF               88                 E32894
     C                     UPDATCQREGDDF               88                 E32894
     C*********************END                                            E32894
     C                     ELSE                            ## X002        E32894
     C                     EXSR CQRREP
     C*********************UPDATCQREGDDF                            E32894033943
     C                     DELETCQREGDDF                                  033943
     C                     END                             ## E002        E32894
     C                     END                             ## E001
     C/COPY WNCPYSRC,FT1010C016
     C*
     C           *IN88     IFEQ '1'                        ## B001
     C                     MOVE 'CQREG'   WBFILE           ***************
     C                     MOVELWRTERR    WBKEY            ** DBERR  11 **
     C                     Z-ADD11        WBASE            ***************
     C                     EXSR ABORT
     C                     END                             ## E001
     C*
     C                     ENDSR
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C**   CREATE A SEPARATE SET OF HASH TOTALS FOR EACH RECORD.
     C**
     C           HASH      BEGSR                           ** HASH   **
     C*
     C                     MOVE ZERO15    ZZAMT
     C                     MOVE ZERO15    ZZTOTI
     C                     MOVE ZERO15    ZZTOTD
     C*
     C                     ADD  1         CTN#,H
     C                     MOVE PRMAMT    ZZAMT
     C                     MOVE CTI#,H    ZZTOTI
     C                     MOVE CTD#,H    ZZTOTD
     C                     EXSR GLZADD
     C                     MOVE ZZTOTI    CTI#,H
     C                     MOVE ZZTOTD    CTD#,H
     C                     ENDSR
     C*
     C********************************************************************
     C/EJECT
0760 C********************************************************************
0761 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
0762 C*   IND '99' IS SET BY AN OVERFLOW ERROR
0763 C*
0764 C           GLZADD    BEGSR                           *** GLZADD ****
0765 C*
0766 C                     Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
0767 C   91                GOTO ZZAEND                     AMT = 0.BYPASS
0768 C*
0769 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
0770 C                     Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
0771 C                     MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
0772 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
0773 C*
0774 C                     EXSR GLZSUM
0775 C           ZZAEND    ENDSR                           ** ZZAEND TAG *
     C/EJECT
0776 C*
0777 C********************************************************************
0778 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
0779 C*                        GLZADD, GLZSUB, GLZCMP.
0780 C*          PARAMETERS PASSED -
0781 C*                     I/P ZZAMTI ZZAMTD
0782 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
0783 C*
0784 C           GLZSUM    BEGSR                           *** GLZSUM ****
0785 C*
0786 C                     Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
0787 C                     Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
0788 C                     SETOF                     919293
0789 C                     SETOF                     949599
0790 C*
0791 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
0792 C           ZZAMTI    COMP 0                      9293
0793 C   93      ZZAMTD    COMP 0                      9293
0794 C   93                GOTO ZZSEND                     ZERO BYPASS
0795 C*
0796 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
0797 C           ZZTOTI    COMP 0                      9193
0798 C   93      ZZTOTD    COMP 0                      9193
0799 C*
0800 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
0801 C   93                Z-ADDZZAMTI    ZZTOTI
0802 C   93                Z-ADDZZAMTD    ZZTOTD
0803 C   93                GOTO ZZSEND                     ZERO BYPASS
0804 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
0805 C   91N92
0806 CORN91 92             GOTO ZZOFPS
0807 C*
0808 C           ZZAMTD    ADD  ZZTOTD    ZZWK2   40
0809 C           ZZWK2     COMP 999                  93    '93' = CARRY
0810 C  N93      ZZWK2     COMP -999                   93    INTO INTEGER.
0811 C*
0812 C   93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
0813 C      93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
0814 C   93      ZZTOTI    ADD  ZZWK3     ZZWK3
0815 C  N93      ZZTOTI    ADD  ZZAMTI    ZZWK3
0816 C*
0817 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
0818 C  N92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
0819 C   92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
0820 C  N99                Z-ADDZZWK2     ZZTOTD
0821 C  N99                Z-ADDZZWK3     ZZTOTI
0822 C*
0823 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
0824 C   99                Z-ADD0         ZZAMT  153
0825 C                     GOTO ZZSEND
0826 C*
0827 C* THE 'SIGNS' ARE DIFFERENT
0828 C           ZZOFPS    TAG                             ** ZZOFPS TAG**
0829 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
0830 C*
0831 C   92                Z-SUBZZAMTI    ZZAMTI 150
0832 C   92                Z-SUBZZAMTD    ZZAMTD  30
0833 C*
0834 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
0835 C*
0836 C   91                Z-SUBZZTOTI    ZZTOTI
0837 C   91                Z-SUBZZTOTD    ZZTOTD
0838 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
0839 C*
0840 C           ZZTOTI    COMP ZZAMTI               93  95
0841 C   95      ZZTOTD    COMP ZZAMTD               93  95
0842 C*
0843 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
0844 C   95                Z-ADD0         ZZTOTI
0845 C   95                Z-ADD0         ZZTOTD
0846 C   95                GOTO ZZSEND
0847 C*
0848 C* IF ZZTOT GT. ZZAMT.
0849 C   93      ZZAMTD    COMP ZZTOTD               94
0850 C   93 94   ZZTOTI    SUB  1         ZZTOTI
0851 C   93 94   ZZTOTD    ADD  1000      ZZWK2
0852 C   93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
0853 C   93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
0854 C   93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
0855 C*
0856 C*
0857 C* IF ZZAMT GT. ZZTOT.
0858 C  N93      ZZTOTD    COMP ZZAMTD               94
0859 C  N93 94   ZZAMTI    SUB  1         ZZWK3  150
0860 C  N93 94   ZZAMTD    ADD  1000      ZZWK2
0861 C  N93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
0862 C  N93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
0863 C  N93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
0864 C  N93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
0865 C*
0866 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
0867 C                     SETOF                     94
0868 C   93 91
0869 CORN93 92             SETON                     94
0870 C   94                Z-SUBZZTOTI    ZZTOTI
0871 C   94                Z-SUBZZTOTD    ZZTOTD
0872 C**
0873 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
0874 C   92                Z-SUBZZAMTI    ZZAMTI
0875 C   92                Z-SUBZZAMTD    ZZAMTD
0876 C           ZZSEND    TAG                             ** ZZSEND TAG *
0877 C**
0878 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
0879 C                     SETOF                     96
0880 C           ZZTOTD    COMP 0                        91
0881 C   91      ZZTOTI    COMP 0                      96
0882 C   96                MOVE '.000-'   ZZNEGD  5
0883 C                     ENDSR                             ** ENDSR **
3806 C********************************************************************
     C/EJECT
     C********************************************************************
     C*
     C** CQRREP - SR. TO OUTPUT REPORT FT1010P4 (CHEQUE REGISTER       P1
     C**          DETAILS)
     C*
     C           CQRREP    BEGSR
     C*
     C           *IN56     IFEQ '0'
     C                     ADD  1         P4PAGE
     C                     WRITEP4HD                       HEADINGS
     C                     SETON                     56
     C                     END
     C*
     C                     ADD  1         CQR#CT  20
     C*
     C           CQR#CT    IFGE 3
     C                     SETOF                     56
     C                     Z-ADD0         CQR#CT
     C                     END
     C*
     C** FORMAT SETTLE AMOUNT
     C*
     C                     MOVEL*BLANKS   WFDIN  15
     C                     MOVE CQAM      WFDIN
     C                     Z-ADDWSCDP     WDEC    10
     C           13        SUB  WSCDP     WDIG    20
     C                     EXSR UGFRMT
     C                     MOVE WFDOUT    P4SMAM
     C*
     C** FORMAT CHEQUE DATE FIELD  USING SYSTEM ROUTINE ZDATE2
     C*
     C                     Z-ADDCQDT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVELZADATE    P4SLDT
     C*
     C** WRITE A DETAIL RECORD TO THE PRINTER FILE
     C*
     C                     WRITEP4DETL
     C*
     C                     SETON                     84
     C*
     C                     ENDSR
     C*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C*                                                               *
     C*  INPREP - SUBROUTINE TO PRODUCE REPORT FT1010P5 FOR INCOMING  *
     C*           PAYMENTS                                            *
     C*                                                               *
     C*****************************************************************
     C*
     C           INPREP    BEGSR
     C*
     C                     MOVELTITL      P5TITL
     C                     MOVELRUNA      P5DATE
     C*                                                                   S01117
     C* IF MULTIBRANCHING INDICATOR ACTIVE, MOVE BOOKING BRANCH AND       S01117
     C* APPROPRIATE BRANCH NAME TO THE RELATIVE FIELDS SET UP WITHIN      S01117
     C* THE PRINTER FILE                                                  S01117
     C*                                                                   S01117
     C           *IN30     IFEQ '1'                                       S01117
     C                     MOVE BRCA      P5BRCA                          S01117
     C                     MOVE BRCA      WRKFLD  3                       S01117
     C                     EXSR SUBBRN                                    S01117
     C                     MOVELBRNM      P5BRNM                          S01117
     C*                                                                   S01117
     C* IF ORIGINATING BRANCH USED INDICATOR ACTIVE,MOVE ORBR AND         S01117
     C* APPROPRIATE BRANCH NAME TO THE RELATIVE FIELDS SET UP WITHIN      S01117
     C* THE PRINTER FILE                                                  S01117
     C*                                                                   S01117
     C           *IN35     IFEQ '1'                                       S01117
     C                     MOVE ORBR      P5ORBR                          S01117
     C                     MOVE ORBR      WRKFLD                          S01117
     C                     EXSR SUBBRN                                    S01117
     C                     MOVELBRNM      P5ORNM                          S01117
     C                     END                                            S01117
     C                     END                                            S01117
      *************                                                       S01435
     C*************                                                       S01435
     C***SETUP*ADDRESS FIELDS, ACCESSING CLINT AS APPROPRIATE             S01435
     C*************                                                       S01435
     C***SENDER****                                                       S01435
     C*************                                                       S01435
     C***********SNTP      IFNE 'C'                                       S01435
     C*************        MOVELSND1      P5SND1                          S01435
     C*************                                                       S01117
     C**IF*MULTIBRANCHING INDICATOR SETOF AND FULL ACCOUNT ENTRY,SINGLE   S01117
     C**BRANCH*NEED TO BE FORMATTED BY CUTTING OFF THE BRANCH CODE FROM   S01117
     C**THE*END*USING A WORK FIELD BEFORE OUTPUTING TO THE PRINTER FILE   S01117
     C*************                                                       S01117
     C************IN30     IFEQ '0'                                       S01117
     C***********SNTP      ANDEQ'G'                                       S01117
     C*************        MOVELSND1      FLD15                           S01117
     C*************        MOVE *BLANKS   P5SND1                          S01117
     C*************        MOVELFLD15     P5SND1                          S01117
     C*************        END                                            S01117
     C*************        MOVELSND2      P5SND2                          S01435
     C*************        MOVELSND3      P5SND3                          S01435
     C*************        MOVELSND4      P5SND4                          S01435
     C*************        MOVEL*BLANKS   P5SND5                          S01435
     C*************        ELSE                                           S01435
     C*************        MOVELSND1      WCLNUM                          S01435
     C*************        MOVEL'B'       WCLRCT                          S01435
     C*************        EXSR UCCLCN                                    S01435
     C*************                                                       S01435
     C************IN89     IFEQ '1'                                       S01435
     C*************        MOVEL'CLINT'   WBFILE           ***********    S01435
     C*************        MOVELWCLNUM    WA7     7        * DBERR 22     S01435
     C*************        MOVE WCLRCT    WA7              ***********    S01435
     C*************        MOVELWA7       WBKEY                           S01435
     C*************        Z-ADD22        WBASE                           S01435
     C*************        EXSR ABORT                      *ABORT PGM*    S01435
     C*************        END                                            S01435
     C*************                                                       S01435
     C*************        MOVELSND1      P5SND1                          S01435
     C*************        MOVELCNA1      P5SND2                          S01435
     C*************        MOVELCNA2      P5SND3                          S01435
     C*************        MOVELCNA3      P5SND4                          S01435
     C*************        MOVELCNA4      P5SND5                          S01435
     C*************        END                                            S01435
     C*************                                                       S01435
     C***INTERMEDIARY BANK                                                S01435
     C*************                                                       S01435
     C***********INBT      IFNE 'C'                                       S01435
     C*************        MOVELINB1      P5INB1                          S01435
     C*************        MOVELINB2      P5INB2                          S01435
     C*************        MOVELINB3      P5INB3                          S01435
     C*************        MOVELINB4      P5INB4                          S01435
     C*************        MOVELINB5      P5INB5                          S01435
     C*************        ELSE                                           S01435
     C*************        MOVELINB1      WCLNUM                          S01435
     C*************        MOVEL'B'       WCLRCT                          S01435
     C*************        EXSR UCCLCN                                    S01435
     C*************                                                       S01435
     C************IN89     IFEQ '1'                                       S01435
     C*************        MOVEL'CLINT'   WBFILE           **********     S01435
     C*************        MOVELWCLNUM    WA7              * DBERR 23     S01435
     C*************        MOVE WCLRCT    WA7              **********     S01435
     C*************        MOVELWA7       WBKEY                           S01435
     C*************        Z-ADD23        WBASE                           S01435
     C*************        EXSR ABORT                      *ABORT PGM*    S01435
     C*************        END                                            S01435
     C*************                                                       S01435
     C*************        MOVELINB1      P5INB1                          S01435
     C*************        MOVELCNA1      P5INB2                          S01435
     C*************        MOVELCNA2      P5INB3                          S01435
     C*************        MOVELCNA3      P5INB4                          S01435
     C*************        MOVELCNA4      P5INB5                          S01435
     C*************        END                                            S01435
     C*************                                                       S01435
     C***SENDER'S*CORRESPONDENT                                           S01435
     C*************                                                       S01435
     C***********SNCT      IFNE 'C'                                       S01435
     C*************        MOVELSNC1      P5SNC1                          S01435
     C*************        MOVELSNC2      P5SNC2                          S01435
     C*************        MOVELSNC3      P5SNC3                          S01435
     C*************        MOVELSNC4      P5SNC4                          S01435
     C*************        MOVELSNC5      P5SNC5                          S01435
     C*************        ELSE                                           S01435
     C*************        MOVELSNC1      WCLNUM                          S01435
     C*************        MOVEL'B'       WCLRCT                          S01435
     C*************        EXSR UCCLCN                                    S01435
     C*************                                                       S01435
     C************IN89     IFEQ '1'                                       S01435
     C*************        MOVEL'CLINT'   WBFILE           **********     S01435
     C*************        MOVELWCLNUM    WA7              * DBERR 24     S01435
     C*************        MOVE WCLRCT    WA7              **********     S01435
     C*************        MOVELWA7       WBKEY                           S01435
     C*************        Z-ADD24        WBASE                           S01435
     C*************        EXSR ABORT                      *ABORT PGM*    S01435
     C*************        END                                            S01435
     C*************                                                       S01435
     C*************        MOVELSNC1      P5SNC1                          S01435
     C*************        MOVELCNA1      P5SNC2                          S01435
     C*************        MOVELCNA2      P5SNC3                          S01435
     C*************        MOVELCNA3      P5SNC4                          S01435
     C*************        MOVELCNA4      P5SNC5                          S01435
     C*************        END                                            S01435
     C*************                                                       S01435
     C***ORDERING*BANK                                                    S01435
     C*************                                                       S01435
     C***********ORBT      IFNE 'C'                                       S01435
     C*************        MOVELORB1      P5ORB1                          S01435
     C*************        MOVELORB2      P5ORB2                          S01435
     C*************        MOVELORB3      P5ORB3                          S01435
     C*************        MOVELORB4      P5ORB4                          S01435
     C*************        MOVEL*BLANKS   P5ORB5                          S01435
     C*************        ELSE                                           S01435
     C*************        MOVELORB1      WCLNUM                          S01435
     C*************        MOVEL'B'       WCLRCT                          S01435
     C*************        EXSR UCCLCN                                    S01435
     C*************                                                       S01435
     C************IN89     IFEQ '1'                                       S01435
     C*************        MOVEL'CLINT'   WBFILE           **********     S01435
     C*************        MOVELWCLNUM    WA7              * DBERR 25     S01435
     C*************        MOVE WCLRCT    WA7              **********     S01435
     C*************        MOVELWA7       WBKEY                           S01435
     C*************        Z-ADD25        WBASE                           S01435
     C*************        EXSR ABORT                      *ABORT PGM*    S01435
     C*************        END                                            S01435
     C*************                                                       S01435
     C*************        MOVELORB1      P5ORB1                          S01435
     C*************        MOVELCNA1      P5ORB2                          S01435
     C*************        MOVELCNA2      P5ORB3                          S01435
     C*************        MOVELCNA3      P5ORB4                          S01435
     C*************        MOVELCNA4      P5ORB5                          S01435
     C*************        END                                            S01435
     C*************                                                       S01435
     C***BENEFICIARY CUSTOMER                                             S01435
     C*************                                                       S01435
     C***********BNCT      IFNE 'C'                                       S01435
     C*************        MOVELBNC1      P5BNC1                          S01435
     C*************                                                       S01117
     C**IF*MULTIBRANCHING INDICATOR SETOF AND PARTIAL ACCOUNT ENTRY,      S01117
     C**SINGLE*BRANCH NEED TO BE FORMATTED BY CUTTING OFF THE BRANCH CODE S01117
     C**FROM*THE*END USING WORK FIELD BEFORE OUTPUTING TO THE PRINTER     S01117
     C**FILE*******                                                       S01117
     C************IN30     IFEQ '0'                                       S01117
     C***********BNCT      ANDEQ'P'                                       S01117
     C*************        MOVELBNC1      FLD12                           S01117
     C*************        MOVE *BLANKS   P5BNC1                          S01117
     C*************        MOVELFLD12     P5BNC1                          S01117
     C*************        END                                            S01117
     C*************        MOVELBNC2      P5BNC2                          S01435
     C*************        MOVELBNC3      P5BNC3                          S01435
     C*************        MOVELBNC4      P5BNC4                          S01435
     C*************        MOVELBNC5      P5BNC5                          S01435
     C*************        ELSE                                           S01435
     C*************        MOVELBNC1      WCLNUM                          S01435
     C*************        MOVEL'B'       WCLRCT                          S01435
     C*************        EXSR UCCLCN                                    S01435
     C*************                                                       S01435
     C************IN89     IFEQ '1'                                       S01435
     C*************        MOVEL'CLINT'   WBFILE           **********     S01435
     C*************        MOVELWCLNUM    WA7              * DBERR 26     S01435
     C*************        MOVE WCLRCT    WA7              **********     S01435
     C*************        MOVELWA7       WBKEY                           S01435
     C*************        Z-ADD26        WBASE                           S01435
     C*************        EXSR ABORT                      *ABORT PGM*    S01435
     C*************        END                                            S01435
     C*************                                                       S01435
     C*************        MOVELBNC1      P5BNC1                          S01435
     C*************        MOVELCNA1      P5BNC2                          S01435
     C*************        MOVELCNA2      P5BNC3                          S01435
     C*************        MOVELCNA3      P5BNC4                          S01435
     C*************        MOVELCNA4      P5BNC5                          S01435
     C*************        END                                            S01435
     C*************                                                       S01435
     C***ORDERING*CUSTOMER                                                S01435
     C*************                                                       S01435
     C***********ORCT      IFNE 'C'                                       S01435
     C*************        MOVELORC1      P5ORC1                          S01435
     C*************        MOVELORC2      P5ORC2                          S01435
     C*************        MOVELORC3      P5ORC3                          S01435
     C*************        MOVELORC4      P5ORC4                          S01435
     C*************        MOVEL*BLANKS   P5ORC5                          S01435
     C*************        ELSE                                           S01435
     C*************        MOVELORC1      WCLNUM                          S01435
     C*************        MOVEL'B'       WCLRCT                          S01435
     C*************        EXSR UCCLCN                                    S01435
     C*************                                                       S01435
     C************IN89     IFEQ '1'                                       S01435
     C*************        MOVEL'CLINT'   WBFILE           **********     S01435
     C*************        MOVELWCLNUM    WA7              * DBERR 27     S01435
     C*************        MOVE WCLRCT    WA7              **********     S01435
     C*************        MOVELWA7       WBKEY                           S01435
     C*************        Z-ADD27        WBASE                           S01435
     C*************        EXSR ABORT                      *ABORT PGM*    S01435
     C*************        END                                            S01435
     C*************                                                       S01435
     C*************        MOVELORC1      P5ORC1                          S01435
     C*************        MOVELCNA1      P5ORC2                          S01435
     C*************        MOVELCNA2      P5ORC3                          S01435
     C*************        MOVELCNA3      P5ORC4                          S01435
     C*************        MOVELCNA4      P5ORC5                          S01435
     C*************        END                                            S01435
     C*************                                                       S01435
     C***FORMAT*PAY & SETTLE AMOUNTS                                      S01435
     C*************                                                       S01435
     C***CALL*UATBCN TO ACCESS CURRENCY RECORD FOR SETTLE CURRENCY        S01435
     C*************                                                       S01435
     C*************        MOVEL*BLANKS   ZTABKY                          S01435
     C*************        MOVEL'20'      ZTABKY                          S01435
     C*************        MOVELSMCY      WA4     4                       S01435
     C*************        MOVE '1'       WA4                             S01435
     C*************        MOVE WA4       ZTABKY                          S01435
     C*************        EXSR UATBCN                                    S01435
     C*************                                                       S01435
     C***CHECK*IF*DATABASE ERROR OCCURRED                                 S01435
     C*************                                                       S01435
     C************IN89     IFEQ '1'                                       S01435
     C*************        MOVEL'TABLE'   WBFILE           **********     S01435
     C*************        MOVELZTABKY    WBKEY            * DBERR 28     S01435
     C*************        Z-ADD28        WBASE            **********     S01435
     C*************        EXSR ABORT                      *ABORT PGM*    S01435
     C*************        END                                            S01435
     C*************                                                       S01435
     C***STORE*NUMBER OF DECIMAL PLACES FOR SETTLE CURRENCY               S01435
     C*************                                                       S01435
     C*************        Z-ADDCDP       SVPCDP  10                      S01435
     C*************                                                       S01435
     C***FORMAT*SETTLE AMOUNT                                             S01435
     C*************                                                       S01435
     C*************        MOVEL*BLANKS   WFDIN  15                       S01435
     C*************        MOVE SMAM      WFDIN                           S01435
     C*************        Z-ADDSVPCDP    WDEC    10                      S01435
     C***********13        SUB  SVPCDP    WDIG    20                      S01435
     C*************        EXSR UGFRMT                                    S01435
     C*************        MOVE WFDOUT    P5SMAM                          S01435
     C*************                                                       S01435
     C***CALL*UATBCN TO ACCESS CURRENCY RECORD FOR PAY CURRENCY           S01435
     C*************                                                       S01435
     C*************        MOVEL*BLANKS   ZTABKY                          S01435
     C*************        MOVEL'20'      ZTABKY                          S01435
     C*************        MOVELPCCY      WA4                             S01435
     C*************        MOVE '1'       WA4                             S01435
     C*************        MOVE WA4       ZTABKY                          S01435
     C*************        EXSR UATBCN                                    S01435
     C*************                                                       S01435
     C***CHECK*IF*DATABASE ERROR OCCURRED                                 S01435
     C*************                                                       S01435
     C************IN89     IFEQ '1'                                       S01435
     C*************        MOVEL'TABLE'   WBFILE           **********     S01435
     C*************        MOVELZTABKY    WBKEY            * DBERR 29     S01435
     C*************        Z-ADD29        WBASE            **********     S01435
     C*************        EXSR ABORT                      *ABORT PGM*    S01435
     C*************        END                                            S01435
     C*************                                                       S01435
     C***STORE*NUMBER OF DECIMAL PLACES FOR PAY CURRENCY                  S01435
     C*************                                                       S01435
     C*************        Z-ADDCDP       SVRCDP  10                      S01435
     C*************                                                       S01435
     C***FORMAT*PAY AMOUNT                                                S01435
     C*************                                                       S01435
     C*************        MOVEL*BLANKS   WFDIN                           S01435
     C*************        MOVE PYAM      WFDIN                           S01435
     C*************        Z-ADDSVRCDP    WDEC                            S01435
     C***********13        SUB  SVRCDP    WDIG                            S01435
     C*************        EXSR UGFRMT                                    S01435
     C*************        MOVE WFDOUT    P5PYAM                          S01435
     C*************                                                       S01435
     C***FORMAT*OTHER AMOUNTS & CURRENCIES                                S01435
     C***IF*CHARGES TO DEBIT A/C FIELD IS NON-ZERO USE BASE CURRENCY;     S01435
     C***OTHERWISE*IF PAY PLUS CHARGES INDICATOR IS 'Y' USE SETTLE CCY;   S01435
     C***OTHERWISE*USE PAY CURRENCY                                       S01435
     C*************                                                       S01435
     C***********CDRO      IFNE *ZERO                                     S01435
     C*************        MOVELBCCY      WCCY    3                       S01435
     C*************        Z-ADDSVBCDP    WDEC                            S01435
     C*************        ELSE                                           S01435
     C***********ADDC      IFEQ 'Y'                                       S01435
     C*************        MOVELSMCY      WCCY                            S01435
     C*************        Z-ADDSVPCDP    WDEC                            S01435
     C*************        ELSE                                           S01435
     C*************        MOVELPCCY      WCCY                            S01435
     C*************        Z-ADDSVRCDP    WDEC                            S01435
     C*************        END                                            S01435
     C*************        END                                            S01435
     C*************                                                       S01435
     C***********11        SUB  WDEC      WDIG                            S01435
     C*************                                                       S01435
     C***SETUP*CURRENCY NAMES                                             S01435
     C*************                                                       S01435
     C*************        MOVELWCCY      P5TRCY                          S01435
     C*************        MOVELWCCY      P5TXCY                          S01435
     C*************        MOVELWCCY      P5CQCY                          S01435
     C*************        MOVELWCCY      P5TLCY                          S01435
     C*************        MOVELWCCY      P5ADCY                          S01435
     C*************        MOVELWCCY      P5MSCY                          S01435
     C*************                                                       S01435
     C***FORMAT*TRANSFER COMMISSION AMOUNT                                S01435
     C*************                                                       S01435
     C*************        MOVEL*BLANKS   WFDIN                           S01435
     C*************        MOVE TRCM      WFDIN                           S01435
     C*************        EXSR UGFRMT                                    S01435
     C*************        MOVE WFDOUT    P5TRCM                          S01435
     C*************                                                       S01435
     C***FORMAT*TELEX CHARGE AMOUNT                                       S01435
     C*************                                                       S01435
     C*************        MOVEL*BLANKS   WFDIN                           S01435
     C*************        MOVE TXCH      WFDIN                           S01435
     C*************        EXSR UGFRMT                                    S01435
     C*************        MOVE WFDOUT    P5TXCH                          S01435
     C*************                                                       S01435
     C***FORMAT*CHEQUE CHARGE AMOUNT                                      S01435
     C*************                                                       S01435
     C*************        MOVEL*BLANKS   WFDIN                           S01435
     C*************        MOVE CQCH      WFDIN                           S01435
     C*************        EXSR UGFRMT                                    S01435
     C*************        MOVE WFDOUT    P5CQCH                          S01435
     C*************                                                       S01435
     C***FORMAT*TELEPHONE CHARGE AMOUNT                                   S01435
     C*************                                                       S01435
     C*************        MOVEL*BLANKS   WFDIN                           S01435
     C*************        MOVE TLCH      WFDIN                           S01435
     C*************        EXSR UGFRMT                                    S01435
     C*************        MOVE WFDOUT    P5TLCH                          S01435
     C*************                                                       S01435
     C***FORMAT*ADVICE CHARGE AMOUNT                                      S01435
     C*************                                                       S01435
     C*************        MOVEL*BLANKS   WFDIN                           S01435
     C*************        MOVE ADCH      WFDIN                           S01435
     C*************        EXSR UGFRMT                                    S01435
     C*************        MOVE WFDOUT    P5ADCH                          S01435
     C*************                                                       S01435
     C***FORMAT*MISCELLANEOUS CHARGE AMOUNT                               S01435
     C*************                                                       S01435
     C*************        MOVEL*BLANKS   WFDIN                           S01435
     C*************        MOVE MSCH      WFDIN                           S01435
     C*************        EXSR UGFRMT                                    S01435
     C*************        MOVE WFDOUT    P5MSCH                          S01435
     C*************                                                       S01435
     C***FORMAT*DATE FIELDS USING SYSTEM ROUTINE ZDATE2                   S01435
     C*************                                                       S01435
     C***SETTLE*VALUE DATE                                                S01435
     C*************                                                       S01435
     C*************        Z-ADDSLDT      ZDAYNO                          S01435
     C*************        EXSR ZDATE2                                    S01435
     C*************        MOVELZADATE    P5SLDT                          S01435
     C*************                                                       S01435
     C***PAY*VALUE*DATE                                                   S01435
     C*************                                                       S01435
     C*************        Z-ADDPVDT      ZDAYNO                          S01435
     C*************        EXSR ZDATE2                                    S01435
     C*************        MOVELZADATE    P5PYDT                          S01435
     C*************                                                       S01435
     C***SETUP*REMAINING REPORT FIELDS                                    S01435
     C*************                                                       S01435
     C*************        MOVELPREF      P5PREF                          S01435
     C*************        MOVELRLPR      P5RLPR                          S01435
     C*************        MOVELPYTP      P5PYTP                          S01435
     C*************        MOVELPYST      P5PYST                          S01435
     C*************        MOVELSMCY      P5SMCY                          S01435
     C*************        Z-ADDRATE      P5RATE                          S01435
     C*************        MOVELPCCY      P5PCCY                          S01435
     C*************        MOVELBBI1      P5BBI1                          S01435
     C*************        MOVELBBI2      P5BBI2                          S01435
     C*************        MOVELBBI3      P5BBI3                          S01435
     C*************        MOVELBBI4      P5BBI4                          S01435
     C*************        MOVELBBI5      P5BBI5                          S01435
     C*************        MOVELBBI6      P5BBI6                          S01435
     C*************        MOVELDTP1      P5DTP1                          S01435
     C*************        MOVELDTP2      P5DTP2                          S01435
     C*************        MOVELDTP3      P5DTP3                          S01435
     C*************        MOVELDTP4      P5DTP4                          S01435
     C***********DNBC      IFEQ *ZERO                                     S01435
     C*************        MOVE *BLANKS   P5DNBC                          S01435
     C*************        ELSE                                           S01435
     C*************        MOVELDNBC      P5DNBC                          S01435
     C*************        END                                            S01435
     C*************        MOVELADDC      P5ADDC                          S01435
     C*************        MOVELDTCH      P5DTCH                          S01435
     C*************        MOVELTRCT      P5TRCT                          S01435
     C*********************MOVELSWPC      P5SWPC                          S01117
     C***FORMAT*SWIFT PRIORITY CODE                                       S01117
     C*************                                                       S01117
     C***********SWPC      IFEQ 1                                         S01117
     C*************        MOVE 'U'       P5SWPC                          S01117
     C*************        ELSE                                           S01117
     C***********SWPC      IFEQ 2                                         S01117
     C*************        MOVE 'N'       P5SWPC                          S01117
     C*************        END                                            S01117
     C*************        END                                            S01117
     C*************                                                       S01435
     C***EDIT**RCCO, ACBK AND CDRO  FOR OUTPUT                            S01435
     C*************                                                       S01435
     C*************        MOVE RCRT      PRMTYP  1        ( RCCO )       S01435
     C*************        MOVE *ZEROS    PRMFLD 12                       S01435
     C*************        MOVELRCCO      PRMFLD                          S01435
     C*************        EXSR CHOPF                                     S01435
     C*************        MOVELPRMFLD    P5RCCO                          S01435
     C*************                                                       S01435
     C*************        MOVELACBK      P5ACBK           ( ACBK )       S01435
     C*************        MOVE ACBB      P5ACBB                          S01117
     C*************                                                       S01435
     C*************        MOVE CDRT      PRMTYP           ( CDRO )       S01435
     C*************        MOVE *ZEROS    PRMFLD                          S01435
     C*************        MOVELCDRO      PRMFLD                          S01435
     C*************        EXSR CHOPF                                     S01435
     C*************        MOVELPRMFLD    P5CDRO                          S01435
     C*************        MOVE CDBR      P5CDBR                          S01117
      *                                                                   055293
      * Clear Receiver's Correspondent and Account with bank prt flds     055293
      *                                                                   055293
     C                     MOVEL*BLANKS   P5ACBK                          055293
     C                     MOVEL*BLANKS   P5ACDS                          055293
     C                     MOVEL*BLANKS   P5RCDS                          055293
     C***********          MOVEL*BLANKS   P5RCCO                    055293CFT014
      *                                                                   055293
      * Set up Account with Institution Details                           055293
      *                                                                   055293
     C           INACB1    IFNE *BLANKS                                   S01435
      *                                                                   S01435
      * If SWIFT type A translate else leave as on message                S01435
      *                                                                   S01435
     C                     MOVEL#IMSG     P5ACBK                          S01435
     C           INACBT    IFNE 'S'                                       S01435
     C                     MOVELINACB1    P5ACB1                          055293
     C                     MOVELINACB2    P5ACB2                          055293
     C                     MOVELINACB3    P5ACB3                          055293
     C                     MOVELINACB4    P5ACB4                          055293
     C                     MOVELINACB5    P5ACB5                          055293
     C                     ELSE                                           S01435
     C                     MOVEL'ACBT'    XCALL                           S01435
     C                     MOVELINACBT    XTYPE                           S01435
     C                     MOVEL*BLANKS   XNAMDS                          S01435
     C                     MOVELINACB1    ##001   1                       S01435
     C           ##001     IFEQ '/'                                       S01435
     C                     MOVELINACB2    XNAMDS                          S01435
     C                     ELSE                                           S01435
     C                     MOVELINACB1    XNAMDS                          S01435
     C                     END                                            S01435
     C                     EXSR GETADD                                    S01435
     C                     MOVELXNAMDS    P5ACDS                          S01435
     C                     END                                            S01435
     C                     END                                            S01435
      *                                                                   055293
      * Translate input account with bank                                 055293
      *                                                                   055293
     C           ACBT      IFNE *BLANKS                                   S01435
     C                     MOVEL'ACBT'    XCALL                           S01435
     C                     MOVELACBT      XTYPE                           S01435
     C                     MOVELPCCY      XCCY                            S01435
     C                     MOVEL*BLANKS   XNAMDS                          S01435
     C                     MOVELACBK      XNAMDS                          S01435
     C                     MOVE ACBB      XBRCA                           S01435
     C                     EXSR GETADD                                    S01435
     C           INACB1    IFEQ *BLANKS                                   S01435
     C                     MOVELXADDS     P5ACDS                          S01435
     C                     END                                            S01435
     C                     MOVELXNAMDS    P5ACBK                          S01435
     C                     END                                            S01435
      *                                                                   055293
      **Set*up*Receivers*Correspondant*Details**********************055293CFT014
      **************************************************************055293CFT014
     C***********INRCO1    IFNE *BLANKS                             S01435CFT014
      **************************************************************S01435CFT014
      **If*SWIFT*type*A*translate*else*leave*as*on*message**********S01435CFT014
      **************************************************************S01435CFT014
     C***********          MOVEL#IMSG     P5RCCO                    S01435CFT014
     C***********INRCRT    IFNE 'S'                                 S01435CFT014
     C***********          MOVELINRCO1    P5RCO1                    055293CFT014
     C***********          MOVELINRCO2    P5RCO2                    055293CFT014
     C***********          MOVELINRCO3    P5RCO3                    055293CFT014
     C***********          MOVELINRCO4    P5RCO4                    055293CFT014
     C***********          MOVELINRCO5    P5RCO5                    055293CFT014
     C***********          ELSE                                     S01435CFT014
     C***********          MOVEL'RCRT'    XCALL                     S01435CFT014
     C***********          MOVELINRCRT    XTYPE                     S01435CFT014
     C***********          MOVEL*BLANKS   XNAMDS                    S01435CFT014
     C***********          MOVELINRCO1    ##001   1                 S01435CFT014
     C***********##001     IFEQ '/'                                 S01435CFT014
     C***********          MOVELINRCO2    XNAMDS                    S01435CFT014
     C***********          ELSE                                     S01435CFT014
     C***********          MOVELINRCO1    XNAMDS                    S01435CFT014
     C***********          END                                      S01435CFT014
     C***********          EXSR GETADD                              S01435CFT014
     C***********          MOVELXNAMDS    P5RCDS                    S01435CFT014
     C***********          END                                      S01435CFT014
     C***********          END                                      S01435CFT014
      **************************************************************055293CFT014
      **Translate*as*no*message*info********************************055293CFT014
      **************************************************************055293CFT014
     C***********RCRT      IFNE *BLANKS                             S01435CFT014
     C***********          MOVEL'RCRT'    XCALL                     S01435CFT014
     C***********          MOVELRCRT      XTYPE                     S01435CFT014
     C***********          MOVELSMCY      XCCY                      S01435CFT014
     C***********          MOVEL*BLANKS   XNAMDS                    S01435CFT014
     C***********          MOVELRCCO      XNAMDS                    S01435CFT014
     C***********          EXSR GETADD                              S01435CFT014
     C***********INRCO1    IFEQ *BLANKS                             S01435CFT014
     C***********          MOVELXADDS     P5RCDS                    S01435CFT014
     C***********          END                                      S01435CFT014
     C***********          MOVELXNAMDS    P5RCCO                    S01435CFT014
     C***********          END                                      S01435CFT014
     C*                                                                   S01435
     C** SENDER                                                           S01435
     C*                                                                   S01435
     C                     MOVEL'SNTP'    XCALL   4                       S01435
     C                     MOVELSNTP      XTYPE                           S01435
     C                     MOVELSMCY      XCCY                            CFT014
     C                     MOVELSDINDS    XNAMDS                          S01435
     C                     EXSR GETADD                                    S01435
     C                     MOVELXNAMDS    P5SDDS                          S01435
      *                                                                   CFT014
      ** Receiver's Correspondent                                         CFT014
      *                                                                   CFT014
     C                     MOVEL'RCRT'    XCALL                           CFT014
     C                     MOVELINRCRT    XTYPE                           CFT014
     C                     MOVE *BLANKS   P5RCDS                          CFT014
      *                                                                   CFT014
     C           INRCO1    IFNE *BLANKS                                   CFT014
     C           INRCO2    ORNE *BLANKS                                   CFT014
     C           INRCO3    ORNE *BLANKS                                   CFT014
     C           INRCO4    ORNE *BLANKS                                   CFT014
     C           INRCO5    ORNE *BLANKS                                   CFT014
     C                     MOVELINRCO1    P5RCO1                          CFT014
     C                     MOVELINRCO2    P5RCO2                          CFT014
     C                     MOVELINRCO3    P5RCO3                          CFT014
     C                     MOVELINRCO4    P5RCO4                          CFT014
     C                     MOVELINRCO5    P5RCO5                          CFT014
     C                     MOVELP5RCDS    XNAMDS                          CFT014
     C                     EXSR GETADD                                    CFT014
     C                     MOVELXNAMDS    P5RCDS                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   S01435
     C*                                                                   S01435
     C** INTERMEDIARY BANK                                                S01435
     C*                                                                   S01435
     C                     MOVEL'INBT'    XCALL   4                       S01435
     C                     MOVELINBT      XTYPE                           S01435
     C                     MOVELININDS    XNAMDS                          S01435
     C                     EXSR GETADD                                    S01435
     C                     MOVELXNAMDS    P5INDS                          S01435
      *                                                                   S01435
     C*                                                                   S01435
     C*                                                                   S01435
     C** SENDER'S CORRESPONDENT                                           S01435
     C*                                                                   S01435
     C                     MOVEL'SNCT'    XCALL   4                       S01435
     C                     MOVELSNCT      XTYPE                           S01435
     C                     MOVELSNINDS    XNAMDS                          S01435
     C                     EXSR GETADD                                    S01435
     C                     MOVELXNAMDS    P5SNDS                          S01435
      *                                                                   S01435
     C*                                                                   S01435
     C** ORDERING BANK                                                    S01435
     C*                                                                   S01435
     C                     MOVEL'ORBT'    XCALL   4                       S01435
     C                     MOVELORBT      XTYPE                           S01435
     C                     MOVELORBDSI    XNAMDS                          S01435
     C                     EXSR GETADD                                    S01435
     C                     MOVELXNAMDS    ORBDS                           S01435
      *                                                                   S01435
     C*                                                                   S01435
     C** BENEFICIARY CUSTOMER                                             S01435
     C*                                                                   S01435
     C                     MOVEL'BNCT'    XCALL   4                       S01435
     C                     MOVELBNCT      XTYPE                           S01435
     C                     MOVELPCCY      XCCY                            S01435
     C                     MOVELBNINDS    XNAMDS                          S01435
     C                     EXSR GETADD                                    S01435
     C                     MOVELXNAMDS    P5BNDS                          S01435
     C*                                                                   S01435
     C** ORDERING CUSTOMER                                                S01435
     C*                                                                   S01435
     C                     MOVEL'ORCT'    XCALL   4                       S01435
     C                     MOVELORCT      XTYPE                           S01435
     C                     MOVELORINDS    XNAMDS                          S01435
     C                     EXSR GETADD                                    S01435
     C                     MOVELXNAMDS    ORCDS                           S01435
      *                                                                   S01435
     C                     MOVE *BLANKS   XCALL   4                       S01435
      *                                                                   S01435
     C*                                                                   S01435
     C** FORMAT PAY & SETTLE AMOUNTS                                      S01435
     C*                                                                   S01435
     C** CALL UATBCN TO ACCESS CURRENCY RECORD FOR SETTLE CURRENCY        S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   ZTABKY                          S01435
     C                     MOVEL'20'      ZTABKY                          S01435
     C                     MOVELSMCY      WA4                             S01435
     C                     MOVE '1'       WA4                             S01435
     C                     MOVE WA4       ZTABKY                          S01435
     C                     EXSR UATBCN                                    S01435
     C*                                                                   S01435
     C** CHECK IF DATABASE ERROR OCCURRED                                 S01435
     C*                                                                   S01435
     C           *IN89     IFEQ '1'                                       S01435
     C                     MOVEL'TABLE'   WBFILE                          S01435
     C                     MOVELZTABKY    WBKEY                           S01435
     C                     MOVEL'58'      WBASE                           S01435
     C                     EXSR ABORT                      *ABORT PGM*    S01435
     C                     END                                            S01435
     C*                                                                   S01435
     C** STORE NUMBER OF DECIMAL PLACES FOR SETTLE CURRENCY               S01435
     C*                                                                   S01435
     C                     Z-ADDCDP       SVSCDP  10                      S01435
     C*                                                                   S01435
     C** FORMAT SETTLE AMOUNT                                             S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN  15                       S01435
     C                     MOVE SMAM      WFDIN                           S01435
     C                     Z-ADDSVSCDP    WDEC    10                      S01435
     C           13        SUB  SVSCDP    WDIG    20                      S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P5SMAM                          S01435
     C*                                                                   S01435
     C** CALL UATBCN TO ACCESS CURRENCY RECORD FOR PAY CURRENCY           S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   ZTABKY                          S01435
     C                     MOVEL'20'      ZTABKY                          S01435
     C                     MOVELPCCY      WA4                             S01435
     C                     MOVE '1'       WA4                             S01435
     C                     MOVE WA4       ZTABKY                          S01435
     C                     EXSR UATBCN                                    S01435
     C*                                                                   S01435
     C** CHECK IF DATABASE ERROR OCCURRED                                 S01435
     C*                                                                   S01435
     C           *IN89     IFEQ '1'                                       S01435
     C                     MOVEL'TABLE'   WBFILE                          S01435
     C                     MOVELZTABKY    WBKEY                           S01435
     C                     MOVEL'58'      WBASE                           S01435
     C                     EXSR ABORT                      *ABORT PGM*    S01435
     C                     END                                            S01435
     C*                                                                   S01435
     C** STORE NUMBER OF DECIMAL PLACES FOR PAY CURRENCY                  S01435
     C*                                                                   S01435
     C                     Z-ADDCDP       SVPCDP  10                      S01435
     C*                                                                   S01435
     C** FORMAT PAY AMOUNT                                                S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE PYAM      WFDIN                           S01435
     C                     Z-ADDSVPCDP    WDEC                            S01435
     C           13        SUB  SVPCDP    WDIG                            S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P5PYAM                          S01435
      *                                                                   CFT014
      ** Format Instructed amount considering the Instructed currency.    CFT014
      *                                                                   CFT014
     C                     MOVE *OFF      *IN41                           CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
     C           CEU006    OREQ 'Y'                                       CFT014
      *                                                                   CFT014
     C                     MOVE *BLANKS   P5PDCY                          CFT014
     C                     MOVE *BLANKS   P5PDAM                          CFT014
     C           NDAM      IFNE 0                                         CFT014
     C                     MOVE *ON       *IN41                           CFT014
     C                     CALL 'AOCURRR0'                                CFT014
     C                     PARM *BLANKS   WRTCD                           CFT014
     C                     PARM '*KEY   ' WOPTN                           CFT014
     C                     PARM NDCY      WCCY    3                       CFT014
     C           SDCURR    PARM SDCURR    DSSDY                           CFT014
     C           WRTCD     IFNE *BLANKS                                   CFT014
     C                     Z-ADD21        WBASE            ************   CFT014
     C                     MOVELNDCY      WBKEY            * DBERR021 *   CFT014
     C                     MOVEL'SDCURRPD'WBFILE           ************   CFT014
     C                     EXSR ABORT                                     CFT014
     C                     ENDIF                                          CFT014
     C                     Z-ADDA6NBDP    WPDNDP  20                      CFT014
      *                                                                   CFT014
     C                     MOVEL*BLANKS   WFDIN                           CFT014
     C                     MOVE NDAM      WFDIN                           CFT014
     C                     Z-ADDA6NBDP    WDEC                            CFT014
     C           13        SUB  A6NBDP    WDIG                            CFT014
     C                     EXSR UGFRMT                                    CFT014
     C                     MOVE NDCY      P5PDCY                          CFT014
     C                     MOVE WFDOUT    P5PDAM                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                                       195945
      ** Look for extension file record                                                       195945
      *                                                                                       195945
     C           CFT003    IFEQ 'CFT003'                                                      209391
     C           CFT014    OREQ 'Y'                                                           209391
     C           CFT009    OREQ 'Y'                                                           209391
      *                                                                                       209391
     C           PREF      CHAININPAYXL0             79                                       195945
      *                                                                                       209391
     C                     ENDIF                                                              209391
      *                                                                                       209391
      *                                                                                       CFT120
      ** Retrieve currency details                                                            CFT120
      *                                                                                       CFT120
     C           CFT120    IFEQ 'Y'                                                           CFT120
     C                     Z-ADD0         SVICDP  10                                          CFT120
      *                                                                                       CFT120
     C           INCDRC    IFNE *BLANKS                                                       CFT120
     C                     CALL 'AOCURRR0'                                                    CFT120
     C                     PARM *BLANKS   @RTCD                                               CFT120
     C                     PARM '*KEY   ' @OPTN                                               CFT120
     C                     PARM INCDRC    @CURR                                               CFT120
     C           SDCURR    PARM SDCURR    DSSDY                                               CFT120
      *                                                                                       CFT120
     C           @RTCD     IFNE *BLANKS                                                       CFT120
     C                     MOVE 'SDCURRPD'WBFILE                                              CFT120
     C                     MOVELINCDRC    WBKEY                                               CFT120
     C                     Z-ADD63        WBASE                                               CFT120
     C                     EXSR ABORT                                                         CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
     C                     Z-ADDA6NBDP    SVICDP  10                                          CFT120
     C                     ENDIF                                                              CFT120
     C                     ENDIF                                                              CFT120
     C*                                                                   S01435
     C** FORMAT OTHER AMOUNTS & CURRENCIES                                S01435
     C** IF CHARGES TO DEBIT A/C FIELD IS NON-ZERO USE BASE CURRENCY;     S01435
     C** OTHERWISE IF PAY PLUS CHARGES INDICATOR IS 'Y' USE SETTLE CCY;   S01435
     C** OTHERWISE USE PAY CURRENCY                                       S01435
     C*                                                                   S01435
     C***********CDRO      IFNE *ZERO                                                  S01435 CSD027
     C           CDRO      IFNE *BLANKS                                                       CSD027
      *                                                                                       CFT120
     C                     MOVELBCCY      WCCY    3                       S01435
     C                     Z-ADDSVBCDP    WDEC                            S01435
     C           INCDRC    IFNE *BLANKS                                                       CFT120
     C           CFT120    ANDEQ'Y'                                                           CFT120
     C                     MOVE INCDRC    WCCY                                                CFT120
     C                     Z-ADDSVICDP    WDEC                                                CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
     C/COPY WNCPYSRC,FT1010C007
      *                                                                   CFT003
      *  If Batch Authorsation update/add record                          CFT003
      *                                                                   CFT003
     C                     Z-ADD0         P5OEXR                          CFT014
     C                     MOVE *BLANKS   P5TRIB                          CFT014
     C                     MOVE *BLANKS   P5BOCD                          CFT014
     C                     MOVE *BLANKS   P5TTCD                          CFT014
     C                     MOVE *BLANKS   P5ICD1                          CFT014
     C                     MOVE *BLANKS   P5ICD2                          CFT014
     C                     MOVE *BLANKS   P5ICD3                          CFT014
     C                     MOVE *BLANKS   P5ICD4                          CFT014
     C                     MOVE *BLANKS   P5ICD5                          CFT014
     C                     MOVE *BLANKS   P5RRP1                          CFT014
     C                     MOVE *BLANKS   P5RRP2                          CFT014
     C                     MOVE *BLANKS   P5RRP3                          CFT014
     C                     MOVE *BLANKS   P5RCRM                          CFT014
     C                     MOVE *BLANKS   P5SCH1                          CFT014
     C                     MOVE *BLANKS   P5SCH2                          CFT014
     C                     MOVE *BLANKS   P5SCH3                          CFT014
     C                     MOVE *BLANKS   P5SCH4                          CFT014
     C                     MOVE *BLANKS   P5SCH5                          CFT014
      *                                                                   CFT014
     C********** CFT003    IFEQ 'CFT003'                                               CFT003 209391
     C********** CFT014    OREQ 'Y'                                                    CFT014 209391
     C********** CFT009    OREQ 'Y'                                                    192300 209391
      *                                                                   CFT003
     C********** PREF      CHAININPAYXL0             79                   CFT003 195945
      *                                                                   CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
      *                                                                   CFT014
     C           *IN79     IFEQ *ON                                       CFT014
     C                     Z-ADD22        WBASE            ************   CFT014
     C                     MOVELPREF      WBKEY            * DBERR022 *   CFT014
     C                     MOVEL'INPAYXL0'WBFILE           ************   CFT014
     C                     EXSR ABORT                                     CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     CALL 'AOCURRR0'                                CFT014
     C                     PARM *BLANKS   WRTCD                           CFT014
     C                     PARM '*KEY   ' WOPTN                           CFT014
     C                     PARM PCCY      WCCY                            CFT014
     C           SDCURR    PARM SDCURR    DSSDY                           CFT014
     C           WRTCD     IFNE *BLANKS                                   CFT014
     C                     Z-ADD23        WBASE            ************   CFT014
     C                     MOVELPCCY      WBKEY            * DBERR023 *   CFT014
     C                     MOVEL'SDCURRPD'WBFILE           ************   CFT014
     C                     EXSR ABORT                                     CFT014
     C                     ENDIF                                          CFT014
     C                     Z-ADDA6NBDP    WPYNDP  20                      CFT014
      *                                                                   CFT014
     C                     Z-ADDINOEXR    P5OEXR                          CFT014
     C                     MOVELINTRIB    P5TRIB                          CFT014
     C                     MOVELINBOCD    P5BOCD                          CFT014
     C                     MOVELINTTCD    P5TTCD                          CFT014
      ** Instruction code                                                 CFT014
     C                     MOVELINICD1    P5ICD1                          CFT014
     C                     MOVELINICD2    P5ICD2                          CFT014
     C                     MOVELINICD3    P5ICD3                          CFT014
     C                     MOVELINICD4    P5ICD4                          CFT014
     C                     MOVELINICD5    P5ICD5                          CFT014
      ** Regulatory reporting                                             CFT014
     C                     MOVELINRRP1    P5RRP1                          CFT014
     C                     MOVELINRRP2    P5RRP2                          CFT014
     C                     MOVELINRRP3    P5RRP3                          CFT014
      ** Receiver's charges                                               CFT014
     C           INRCRM    IFNE 0                                         CFT014
      *                                                                   CFT014
     C                     CALL 'AOCURRR0'                                CFT014
     C                     PARM '*DBERR ' @RTCD   7                       CFT014
     C                     PARM '*KEY   ' @OPTN   7                       CFT014
     C                     PARM SMCY      @CCY    3                       CFT014
     C           SDCURR    PARM SDCURR    DSSDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C                     MOVEL'SDCURRPD'WBFILE                          CFT014
     C                     MOVEL'*VERIFY' WBKEY                           CFT014
     C                     Z-ADD70        WBASE                           CFT014
     C                     EXSR ABORT                                     CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C                     MOVE A6NBDP    WSNBDP  10                      CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     Z-ADDWSNBDP    WDEC                            CFT014
     C           11        SUB  WDEC      WDIG                            CFT014
     C                     MOVEL*BLANKS   WFDIN                           CFT014
     C                     MOVE INRCRM    WFDIN                           CFT014
     C                     EXSR UGFRMT                                    CFT014
     C                     MOVE *BLANKS   WCHR15 15                       CFT014
     C                     MOVE WFDOUT    WCHR15                          CFT014
     C                     MOVELWCHR15    P5RCRM                          CFT014
     C                     MOVE SMCY      P5RCRM                          CFT014
     C                     ENDIF                                          CFT014
      ** Sender's charges                                                 CFT014
     C           INSCY1    IFNE *BLANKS                                   CFT014
      *                                                                   CFT014
     C                     CALL 'AOCURRR0'                                CFT014
     C                     PARM '*DBERR ' @RTCD   7                       CFT014
     C                     PARM '*KEY   ' @OPTN   7                       CFT014
     C                     PARM INSCY1    @CCY    3                       CFT014
     C           SDCURR    PARM SDCURR    DSSDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C                     MOVEL'SDCURRPD'WBFILE                          CFT014
     C                     MOVEL'*VERIFY' WBKEY                           CFT014
     C                     Z-ADD72        WBASE                           CFT014
     C                     EXSR ABORT                                     CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C                     MOVE A6NBDP    WNBDP1  10                      CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     Z-ADDWNBDP1    WDEC                            CFT014
     C           11        SUB  WDEC      WDIG                            CFT014
     C                     MOVEL*BLANKS   WFDIN                           CFT014
     C                     MOVE INSCH1    WFDIN                           CFT014
     C                     EXSR UGFRMT                                    CFT014
     C                     MOVE *BLANKS   WCHR15                          CFT014
     C                     MOVE WFDOUT    WCHR15                          CFT014
     C                     MOVELWCHR15    P5SCH1                          CFT014
     C                     MOVE INSCY1    P5SCH1                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           INSCY2    IFNE *BLANKS                                   CFT014
      *                                                                   CFT014
     C                     CALL 'AOCURRR0'                                CFT014
     C                     PARM '*DBERR ' @RTCD   7                       CFT014
     C                     PARM '*KEY   ' @OPTN   7                       CFT014
     C                     PARM INSCY2    @CCY    3                       CFT014
     C           SDCURR    PARM SDCURR    DSSDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C                     MOVEL'SDCURRPD'WBFILE                          CFT014
     C                     MOVEL'*VERIFY' WBKEY                           CFT014
     C                     Z-ADD73        WBASE                           CFT014
     C                     EXSR ABORT                                     CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C                     MOVE A6NBDP    WNBDP2  10                      CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     Z-ADDWNBDP2    WDEC                            CFT014
     C           11        SUB  WDEC      WDIG                            CFT014
     C                     MOVEL*BLANKS   WFDIN                           CFT014
     C                     MOVE INSCH2    WFDIN                           CFT014
     C                     EXSR UGFRMT                                    CFT014
     C                     MOVE *BLANKS   WCHR15                          CFT014
     C                     MOVE WFDOUT    WCHR15                          CFT014
     C                     MOVELWCHR15    P5SCH2                          CFT014
     C                     MOVE INSCY2    P5SCH2                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           INSCY3    IFNE *BLANKS                                   CFT014
      *                                                                   CFT014
     C                     CALL 'AOCURRR0'                                CFT014
     C                     PARM '*DBERR ' @RTCD   7                       CFT014
     C                     PARM '*KEY   ' @OPTN   7                       CFT014
     C                     PARM INSCY3    @CCY    3                       CFT014
     C           SDCURR    PARM SDCURR    DSSDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C                     MOVEL'SDCURRPD'WBFILE                          CFT014
     C                     MOVEL'*VERIFY' WBKEY                           CFT014
     C                     MOVEL'74'      WBASE                           CFT014
     C                     EXSR ABORT                                     CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C                     MOVE A6NBDP    WNBDP3  10                      CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     Z-ADDWNBDP3    WDEC                            CFT014
     C           11        SUB  WDEC      WDIG                            CFT014
     C                     MOVEL*BLANKS   WFDIN                           CFT014
     C                     MOVE INSCH3    WFDIN                           CFT014
     C                     EXSR UGFRMT                                    CFT014
     C                     MOVE *BLANKS   WCHR15                          CFT014
     C                     MOVE WFDOUT    WCHR15                          CFT014
     C                     MOVELWCHR15    P5SCH3                          CFT014
     C                     MOVE INSCY3    P5SCH3                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           INSCY4    IFNE *BLANKS                                   CFT014
      *                                                                   CFT014
     C                     CALL 'AOCURRR0'                                CFT014
     C                     PARM '*DBERR ' @RTCD   7                       CFT014
     C                     PARM '*KEY   ' @OPTN   7                       CFT014
     C                     PARM INSCY4    @CCY    3                       CFT014
     C           SDCURR    PARM SDCURR    DSSDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C                     MOVEL'SDCURRPD'WBFILE                          CFT014
     C                     MOVEL'*VERIFY' WBKEY                           CFT014
     C                     Z-ADD75        WBASE                           CFT014
     C                     EXSR ABORT                                     CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C                     MOVE A6NBDP    WNBDP4  10                      CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     Z-ADDWNBDP4    WDEC                            CFT014
     C           11        SUB  WDEC      WDIG                            CFT014
     C                     MOVEL*BLANKS   WFDIN                           CFT014
     C                     MOVE INSCH4    WFDIN                           CFT014
     C                     EXSR UGFRMT                                    CFT014
     C                     MOVE *BLANKS   WCHR15                          CFT014
     C                     MOVE WFDOUT    WCHR15                          CFT014
     C                     MOVELWCHR15    P5SCH4                          CFT014
     C                     MOVE INSCY4    P5SCH4                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           INSCY5    IFNE *BLANKS                                   CFT014
      *                                                                   CFT014
     C                     CALL 'AOCURRR0'                                CFT014
     C                     PARM '*DBERR ' @RTCD   7                       CFT014
     C                     PARM '*KEY   ' @OPTN   7                       CFT014
     C                     PARM INSCY5    @CCY    3                       CFT014
     C           SDCURR    PARM SDCURR    DSSDY                           CFT014
      *                                                                   CFT014
     C           @RTCD     IFNE *BLANKS                                   CFT014
     C                     MOVEL'SDCURRPD'WBFILE                          CFT014
     C                     MOVEL'*VERIFY' WBKEY                           CFT014
     C                     Z-ADD75        WBASE                           CFT014
     C                     EXSR ABORT                                     CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      *                                                                   CFT014
     C                     MOVE A6NBDP    WNBDP5  10                      CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     Z-ADDWNBDP5    WDEC                            CFT014
     C           11        SUB  WDEC      WDIG                            CFT014
     C                     MOVEL*BLANKS   WFDIN                           CFT014
     C                     MOVE INSCH5    WFDIN                           CFT014
     C                     EXSR UGFRMT                                    CFT014
     C                     MOVE *BLANKS   WCHR15                          CFT014
     C                     MOVE WFDOUT    WCHR15                          CFT014
     C                     MOVELWCHR15    P5SCH5                          CFT014
     C                     MOVE INSCY5    P5SCH5                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT003
      ***If*found, delete INPAYXL0                                        CFT003 195945
      **********                                                          CFT003 195945
     C********** *IN79     IFEQ '0'                                       CFT003 195945
     C**********           DELETINPAYXDF                                  CFT003 195945
     C**********           ENDIF                           -*IN79         CFT003 195945
      *                                                                   CFT003
     C**********           ENDIF                                                       CFT003 209391
      *                                                                   CFT003
     C                     ELSE                                           S01435
     C           ADDC      IFEQ 'A'                                       S01435
     C                     MOVELSMCY      WCCY                            S01435
     C                     Z-ADDSVSCDP    WDEC                            S01435
     C                     ELSE                                           S01435
     C                     MOVELPCCY      WCCY                            S01435
     C                     Z-ADDSVPCDP    WDEC                            S01435
     C                     END                                            S01435
     C                     END                                            S01435
     C*                                                                   S01435
      ** If found, delete INPAYXL0                                                            195945
      *                                                                                       195945
     C           CFT003    IFEQ 'CFT003'                                                      209391
     C           CFT014    OREQ 'Y'                                                           209391
     C           CFT009    OREQ 'Y'                                                           209391
      *                                                                                       209391
     C           *IN79     IFEQ '0'                                                           195945
     C                     DELETINPAYXDF                                                      195945
     C                     ENDIF                           -*IN79                             195945
      *                                                                                       209391
     C                     ENDIF                                                              209391
     C*                                                                                       195945
     C           11        SUB  WDEC      WDIG                            S01435
     C*                                                                   S01435
     C** SETUP CURRENCY NAMES                                             S01435
     C*                                                                   S01435
     C                     MOVELWCCY      P5TRCY                          S01435
     C                     MOVELWCCY      P5TXCY                          S01435
     C                     MOVELWCCY      P5CQCY                          S01435
     C                     MOVELWCCY      P5TLCY                          S01435
     C                     MOVELWCCY      P5ADCY                          S01435
     C                     MOVELWCCY      P5MSCY                          S01435
     C*                                                                   S01494
     C** Check if SAR S01494 is set on                                    S01494
     C*                                                                   S01494
     C           *IN29     IFEQ '1'                                       S01494
     C                     MOVELWCCY      P5CHCY                          S01494
     C                     END                                            S01494
     C*                                                                   S01499
     C** Check if SAR S01499 is set on                                    S01499
     C*                                                                   S01499
     C           *IN39     IFEQ '1'                                       S01499
     C*                                                                   S01499
     C                     MOVELWCCY      P5VTCY                          S01499
     C*                                                                   S01499
     C** Set up VAT flags for report                                      S01499
     C*                                                                   S01499
     C                     MOVE INVAT1    P5TRVF                          S01499
     C                     MOVE INVAT2    P5TXVF                          S01499
     C                     MOVE INVAT3    P5CQVF                          S01499
     C                     MOVE INVAT4    P5ADVF                          S01499
     C                     MOVE INVAT5    P5TLVF                          S01499
     C                     MOVE INVAT6    P5MSVF                          S01499
     C           *IN29     IFEQ '1'                                       S01499
     C                     MOVE INVAT7    P5CHVF                          S01499
     C                     END                                            S01499
     C*                                                                   S01499
     C                     END                                            S01499
     C*                                                                   S01435
     C** FORMAT TRANSFER COMMISSION AMOUNT                                S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE TRCM      WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P5TRCM                          S01435
     C*                                                                   S01435
     C** FORMAT TELEX CHARGE AMOUNT                                       S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE TXCH      WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P5TXCH                          S01435
     C*                                                                   S01435
     C** FORMAT CHEQUE CHARGE AMOUNT                                      S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE CQCH      WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P5CQCH                          S01435
     C*                                                                   S01435
     C** FORMAT TELEPHONE CHARGE AMOUNT                                   S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE TLCH      WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P5TLCH                          S01435
     C*                                                                   S01435
     C** FORMAT ADVICE CHARGE AMOUNT                                      S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE ADCH      WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P5ADCH                          S01435
     C*                                                                   S01435
     C** FORMAT MISCELLANEOUS CHARGE AMOUNT                               S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE MSCH      WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P5MSCH                          S01435
     C*                                                                   S01494
     C** Check if SAR S01494 is set on                                    S01494
     C*                                                                   S01494
     C           *IN29     IFEQ '1'                                       S01494
     C*                                                                   S01494
     C** Format FX/Change Commission                                      S01494
     C*                                                                   S01494
     C                     MOVEL*BLANKS   WFDIN                           S01494
     C                     MOVE INCHCM    WFDIN                           S01494
     C                     EXSR UGFRMT                                    S01494
     C                     MOVE WFDOUT    P5CHCM                          S01494
     C*                                                                   S01494
     C                     END                                            S01494
     C*                                                                   S01499
     C** Check if SAR S01499 is set on                                    S01499
     C*                                                                   S01499
     C           *IN39     IFEQ '1'                                       S01499
     C*                                                                   S01499
     C** Format V.A.T. Charge                                             S01499
     C*                                                                   S01499
     C                     MOVEL*BLANKS   WFDIN                           S01499
     C                     MOVE INVATT    WFDIN                           S01499
     C                     EXSR UGFRMT                                    S01499
     C                     MOVE WFDOUT    P5VATT                          S01499
     C*                                                                   S01499
     C                     END                                            S01499
     C*                                                                   S01435
     C** FORMAT DATE FIELDS USING SYSTEM ROUTINE ZDATE2                   S01435
     C*                                                                   S01435
     C** SETTLE VALUE DATE                                                S01435
     C*                                                                   S01435
     C                     Z-ADDSLDT      ZDAYNO                          S01435
     C                     EXSR ZDATE2                                    S01435
     C                     MOVELZADATE    P5SLDT                          S01435
     C*                                                                   S01435
     C** PAY VALUE DATE                                                   S01435
     C*                                                                   S01435
     C                     Z-ADDPVDT      ZDAYNO                          S01435
     C                     EXSR ZDATE2                                    S01435
     C                     MOVELZADATE    P5PYDT                          S01435
     C*                                                                   S01435
     C** SET UP USER FIELDS FROM MUSERDD,IF AUDIT REPORT                  S01435
     C*                                                                   S01435
     C                     SETOF                     50                   S01435
     C*                                                                   S01435
     C           INUSR1    IFNE *BLANKS                                   S01435
     C                     MOVE INUSR1    USRP                            S01435
     C                     EXSR UCMUSE                                    S01435
     C                     MOVE USER1     SIUSR1 25                       S01435
     C*                                                                   S01435
     C                     ELSE                                           S01435
     C*                                                                   S01435
     C** CLEAR OUTPUT FIELD                                               S01435
     C                     MOVE *BLANKS   SIUSR1                          S01435
     C*                                                                   S01435
     C                     END                                            S01435
      *                                                                   S01435
     C           INUSR2    IFNE *BLANKS                                   S01435
     C                     MOVE INUSR2    USRP                            S01435
     C                     EXSR UCMUSE                                    S01435
     C                     MOVE USER1     SIUSR2 25                       S01435
     C*                                                                   S01435
     C                     ELSE                                           S01435
     C*                                                                   S01435
     C** CLEAR OUTPUT FIELD                                               S01435
     C                     MOVE *BLANKS   SIUSR2                          S01435
     C*                                                                   S01435
     C                     END                                            S01435
      *                                                                   S01435
     C           AUP1      IFNE *BLANKS                                   S01435
     C                     MOVE AUP1      USRP                            S01435
     C                     EXSR UCMUSE                                    S01435
     C                     MOVE USER1     SAUP1  25                       S01435
     C*                                                                   S01435
     C                     ELSE                                           S01435
     C*                                                                   S01435
     C** CLEAR OUTPUT FIELD                                               S01435
     C                     MOVE *BLANKS   SAUP1                           S01435
     C*                                                                   S01435
     C                     END                                            S01435
      *                                                                   S01435
     C           AUP2      IFNE *BLANKS                                   S01435
     C                     MOVE AUP2      USRP                            S01435
     C                     EXSR UCMUSE                                    S01435
     C                     MOVE USER1     SAUP2  25                       S01435
     C*                                                                   S01435
     C                     ELSE                                           S01435
     C*                                                                   S01435
     C** CLEAR OUTPUT FIELD                                               S01435
     C                     MOVE *BLANKS   SAUP2                           S01435
     C*                                                                   S01435
     C                     END                                            S01435
     C*                                                                   S01435
     C** SETUP REMAINING REPORT FIELDS                                    S01435
     C*                                                                   S01435
     C                     MOVELPREF      P5PREF                          S01435
     C                     MOVELRLPR      P5RLPR                          S01435
     C                     MOVELPYTP      P5PYTP                          S01435
     C                     MOVELPYST      P5PYST                          S01435
     C                     MOVELSMCY      P5SMCY                          S01435
     C                     Z-ADDRATE      P5RATE                          S01435
     C                     MOVELPCCY      P5PCCY                          S01435
     C                     MOVELBBI1      P5BBI1                          S01435
     C                     MOVELBBI2      P5BBI2                          S01435
     C                     MOVELBBI3      P5BBI3                          S01435
     C                     MOVELBBI4      P5BBI4                          S01435
     C                     MOVELBBI5      P5BBI5                          S01435
     C                     MOVELBBI6      P5BBI6                          S01435
     C                     MOVELDTP1      P5DTP1                          S01435
     C                     MOVELDTP2      P5DTP2                          S01435
     C                     MOVELDTP3      P5DTP3                          S01435
     C                     MOVELDTP4      P5DTP4                          S01435
     C/COPY WNCPYSRC,FT1010C023
     C           DNBC      IFEQ *ZERO                                     S01435
     C/COPY WNCPYSRC,FT1010C024
     C                     MOVE *BLANKS   P5DNBC                          S01435
     C                     ELSE                                           S01435
     C                     MOVELDNBC      P5DNBC                          S01435
     C                     END                                            S01435
     C                     MOVELADDC      P5ADDC                          S01435
     C                     MOVELDTCH      P5DTCH                          S01435
     C                     MOVELTRCT      P5TRCT                          S01435
     C           SWPC      IFEQ 1                          B001           S01435
     C                     MOVE 'U'       P5SWPC                          S01435
     C                     ELSE                            X001           S01435
     C           SWPC      IFEQ 2                          B002           S01435
     C                     MOVE 'N'       P5SWPC                          S01435
     C                     END                             E002           S01435
     C                     END                             E001           S01435
      *                                                                   S01435
      * Format Override indicator                                         S01435
      *                                                                   S01435
     C                     MOVE *BLANKS   P5OVRD                          S01435
     C           OVRD      IFEQ 'Y'                                       S01435
     C                     MOVE 'YES'     P5OVRD                          S01435
     C                     ELSE                                           S01435
     C                     MOVE 'NO '     P5OVRD                          S01435
     C                     END                                            S01435
      *                                                                   S01435
      * Format Entered Currency                                           S01435
      *                                                                   S01435
     C                     SELEC                                          S01435
      *                                                                   S01435
     C***********CDRO      WHNE *ZERO                                                  S01435 CSD027
     C           CDRO      WHNE *BLANKS                                                       CSD027
     C           BTCHCY    OREQ 'B'                                       103513
     C           CFT120    ANDNE'Y'                                                           CFT120
      *                                                                                       CFT120
     C                     MOVELBCCY      WCCY                            S01435
     C                     Z-ADDSVBCDP    WDEC                            S01435
     C           INCDRC    IFNE *BLANKS                                                       CFT120
     C           CFT120    ANDEQ'Y'                                                           CFT120
     C                     MOVELINCDRC    WCCY                                                CFT120
     C                     Z-ADDSVICDP    WDEC                                                CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
     C           BTCHCY    WHEQ 'B'                                                           CFT120
     C           CFT120    ANDEQ'Y'                                                           CFT120
     C                     MOVELBCCY      WCCY                                                CFT120
     C                     Z-ADDSVBCDP    WDEC                                                CFT120
      *                                                                                       CFT120
     C/COPY WNCPYSRC,FT1010C008
      *                                                                   S01435
     C           BTCHCY    WHEQ 'L'                                       S01435
     C                     MOVELLOCY      WCCY                            S01435
     C                     Z-ADDSVLCDP    WDEC                            S01435
      *                                                                   S01435
     C           BTCHCY    WHEQ 'C'                                       S01435
     C           ADDC      ANDEQ'A'                                       S01435
     C                     MOVELSMCY      WCCY                            S01435
     C                     Z-ADDSVSCDP    WDEC                            S01435
      *                                                                   S01435
     C                     OTHER                                          S01435
     C                     MOVELPCCY      WCCY                            S01435
     C                     Z-ADDSVPCDP    WDEC                            S01435
     C                     ENDSL                                          S01435
      *                                                                   S01435
     C                     MOVELWCCY      P5TREC                          S01435
     C                     MOVELWCCY      P5TXEC                          S01435
     C                     MOVELWCCY      P5CQEC                          S01435
     C                     MOVELWCCY      P5TLEC                          S01435
     C                     MOVELWCCY      P5ADEC                          S01435
     C                     MOVELWCCY      P5MSEC                          S01435
     C*                                                                   S01494
     C** Check if SAR S01494 is set on                                    S01494
     C*                                                                   S01494
     C           *IN29     IFEQ '1'                                       S01494
     C                     MOVELWCCY      P5CHEC                          S01494
     C                     END                                            S01494
     C*                                                                   S01499
     C** Check if SAR S01499 is set on                                    S01499
     C*                                                                   S01499
     C           *IN39     IFEQ '1'                                       S01499
     C                     MOVELWCCY      P5VTEC                          S01499
     C                     END                                            S01499
      *                                                                   S01435
      *  Format Entered Amounts                                           S01435
      *                                                                   S01435
     C           11        SUB  WDEC      WDIG                            S01435
      *                                                                   S01435
      ** Format Transfer Commission Amount                                S01435
      *                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE DUMA1     WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P5TREA                          S01435
      *                                                                   S01435
      ** Format Telex Charge Amount                                       S01435
      *                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE DUMA2     WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P5TXEA                          S01435
      *                                                                   S01435
      ** Format Cheque Charge Amount                                      S01435
      *                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE DUMA3     WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P5CQEA                          S01435
     C*                                                                   S01435
     C** Format Telephone Charge Amount                                   S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE DUMA4     WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P5TLEA                          S01435
     C*                                                                   S01435
     C** Format Advice Charge Amount                                      S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE DUMA5     WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P5ADEA                          S01435
     C*                                                                   S01435
     C** Format Miscellaneous Charge Amount                               S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE DUMA6     WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P5MSEA                          S01435
     C*                                                                   S01494
     C** Check if SAR S01494 is set on                                    S01494
     C*                                                                   S01494
     C           *IN29     IFEQ '1'                                       S01494
     C*                                                                   S01494
     C** Format FX/Change Commission                                      S01494
     C*                                                                   S01494
     C                     MOVEL*BLANKS   WFDIN                           S01494
     C                     MOVE INDUM7    WFDIN                           S01494
     C                     EXSR UGFRMT                                    S01494
     C                     MOVE WFDOUT    P5CHEA                          S01494
     C*                                                                   S01494
     C                     END                                            S01494
     C*                                                                   S01499
     C** Check if SAR S01499 is set on                                    S01499
     C*                                                                   S01499
     C           *IN39     IFEQ '1'                                       S01499
     C*                                                                   S01499
     C** Format V.A.T. Charge                                             S01499
     C*                                                                   S01499
     C                     MOVEL*BLANKS   WFDIN                           S01499
     C                     MOVE INDUM8    WFDIN                           S01499
     C                     EXSR UGFRMT                                    S01499
     C                     MOVE WFDOUT    P5VAEA                          S01499
     C*                                                                   S01499
     C                     END                                            S01499
     C*                                                                   S01435
     C** OUPUT OUTGOING PAYMENT TO BE GENERATED IF 'Y'                    S01435
     C*                                                                   S01435
     C                     MOVE *BLANKS   P5OPIN                          S01435
     C           OPIN      IFEQ 'Y'                                       S01435
     C                     MOVEL'YES'     P5OPIN                          S01435
     C                     ELSE                                           S01435
     C                     MOVEL'NO '     P5OPIN                          S01435
     C                     END                                            S01435
     C*                                                                   S01435
     C** EDIT  CDRO  FOR OUTPUT                                           S01435
     C*                                                                   S01435
     C                     MOVE CDRT      PRMTYP  1        ( CDRO )       S01435
     C**********           MOVE *ZEROS    PRMFLD 12                                    S01435 CGL029
     C                     MOVE *ZEROS    PRMFLD 18                                           CGL029
     C                     MOVELCDRO      PRMFLD                          S01435
     C                     EXSR CHOPF                                     S01435
     C                     MOVELPRMFLD    P5CDRO                          S01435
     C                     MOVELCDBR      P5CDBR                          S01435
     C           CFT120    IFEQ 'Y'                                                           CFT120
     C                     MOVELINCDRC    P5CDRC                                              CFT120
     C                     ENDIF                                                              CFT120
     C/COPY WNCPYSRC,FT1010C009
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
      *                                                                   CFT009
      ** Chain to file to get extra payment info.                         CFT009
      *                                                                   CFT009
     C           PREF      CHAININPAYXL0             79                   CFT003
      *                                                                   CFT009
      ** FX spread set                                                    CFT009
      *                                                                   CFT009
     C                     MOVE FXSPSC    FXSPST                          CFT009
      *                                                                   CFT009
      ** Currency                                                         CFT009
      ** Levied currency depends on file settings.                        CFT009
      *                                                                   CFT009
     C                     SELEC                                          CFT009
     C***********CDRO      WHNE 0                                                      CFT009 CSD027
     C           CDRO      WHNE *BLANKS                                                       CSD027
      *                                                                                       CFT120
     C                     MOVELBCCY      WCCY                            CFT009
     C           INCDRC    IFNE *BLANKS                                                       CFT120
     C           CFT120    ANDEQ'Y'                                                           CFT120
     C                     MOVELINCDRC    WCCY                                                CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
     C           ADDC      WHEQ 'A'                                       CFT009
     C                     MOVELSMCY      WCCY                            CFT009
     C                     OTHER                                          CFT009
     C                     MOVELPCCY      WCCY                            CFT009
     C                     ENDSL                                          CFT009
      *                                                                   CFT009
     C                     MOVE WCCY      TCCCY                           CFT009
     C                     MOVE WCCY      FXCCY                           CFT009
     C                     MOVE WCCY      CQCCY                           CFT009
     C                     MOVE WCCY      ADCCY                           CFT009
     C                     MOVE WCCY      TXCCY                           CFT009
     C                     MOVE WCCY      TPCCY                           CFT009
     C                     MOVE WCCY      M0CCY                           CFT009
     C                     MOVE WCCY      M1CCY                           CFT009
     C                     MOVE WCCY      M2CCY                           CFT009
     C                     MOVE WCCY      M3CCY                           CFT009
     C                     MOVE WCCY      M4CCY                           CFT009
     C                     MOVE WCCY      M5CCY                           CFT009
     C                     MOVE WCCY      VTCCY                           CFT009
      *                                                                   CFT009
      ** Charge code                                                      CFT009
      *                                                                   CFT009
     C                     MOVE TFCCCO    TCCDE                           CFT009
     C                     MOVE FXCHEC    FXCDE                           CFT009
     C                     MOVE CHCHCD    CQCDE                           CFT009
     C                     MOVE ADCHCD    ADCDE                           CFT009
     C                     MOVE TLCODE    TXCDE                           CFT009
     C                     MOVE TLCHCD    TPCDE                           CFT009
     C                     MOVE MISCH     M0CDE                           CFT009
     C                     MOVE MSCH1     M1CDE                           CFT009
     C                     MOVE MSCH2     M2CDE                           CFT009
     C                     MOVE MSCH3     M3CDE                           CFT009
     C                     MOVE MSCH4     M4CDE                           CFT009
     C                     MOVE MSCH5     M5CDE                           CFT009
      *                                                                   CFT009
      ** Chain to payment charge defintion file to get miscellaneous      CFT009
      ** charge code narratives.                                          CFT009
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
     C           MSCH1     CHAINFTPCHGL0             90                   CFT009
     C           *IN90     IFEQ '0'                                       CFT009
     C                     MOVELCHDESC    P5MS1N    P                     CFT009
     C                     ELSE                                           CFT009
     C                     MOVELDESC,1    P5MS1N    P                     CFT009
     C                     ENDIF                                          CFT009
     C           MSCH2     CHAINFTPCHGL0             90                   CFT009
     C           *IN90     IFEQ '0'                                       CFT009
     C                     MOVELCHDESC    P5MS2N    P                     CFT009
     C                     ELSE                                           CFT009
     C                     MOVELDESC,2    P5MS2N    P                     CFT009
     C                     ENDIF                                          CFT009
     C           MSCH3     CHAINFTPCHGL0             90                   CFT009
     C           *IN90     IFEQ '0'                                       CFT009
     C                     MOVELCHDESC    P5MS3N    P                     CFT009
     C                     ELSE                                           CFT009
     C                     MOVELDESC,3    P5MS3N    P                     CFT009
     C                     ENDIF                                          CFT009
     C           MSCH4     CHAINFTPCHGL0             90                   CFT009
     C           *IN90     IFEQ '0'                                       CFT009
     C                     MOVELCHDESC    P5MS4N    P                     CFT009
     C                     ELSE                                           CFT009
     C                     MOVELDESC,4    P5MS4N    P                     CFT009
     C                     ENDIF                                          CFT009
     C           MSCH5     CHAINFTPCHGL0             90                   CFT009
     C           *IN90     IFEQ '0'                                       CFT009
     C                     MOVELCHDESC    P5MS5N    P                     CFT009
     C                     ELSE                                           CFT009
     C                     MOVELDESC,5    P5MS5N    P                     CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Retrieve currency details                                        CFT009
      *                                                                   CFT009
     C                     CALL 'AOCURRR0'                                CFT009
     C                     PARM *BLANKS   @RTCD                           CFT009
     C                     PARM '*KEY   ' @OPTN                           CFT009
     C                     PARM WCCY      @CURR                           CFT009
     C           SDCURR    PARM SDCURR    DSSDY                           CFT009
      *                                                                   CFT009
     C           @RTCD     IFNE *BLANKS                                   CFT009
     C                     MOVE 'SDCURRPD'WBFILE           ************   CFT009
     C                     MOVELPCCY      WBKEY            * DBERR 67 *   CFT009
     C                     Z-ADD67        WBASE            ************   CFT009
     C                     EXSR ABORT                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Prime currency                                                   CFT009
      *                                                                   CFT009
     C                     Z-ADDA6NBDP    WPCCY   10                      CFT009
      *                                                                   CFT009
      ** Set up charge amounts in levied currency                         CFT009
      *                                                                   CFT009
     C                     Z-ADDMSC01     ZMSC01 150H                     CFT009
     C                     Z-ADDMSC02     ZMSC02 150H                     CFT009
     C                     Z-ADDMSC03     ZMSC03 150H                     CFT009
     C                     Z-ADDMSC04     ZMSC04 150H                     CFT009
     C                     Z-ADDMSC05     ZMSC05 150H                     CFT009
      *                                                                   CFT009
      ** Charges currency                                                 CFT009
      *                                                                   CFT009
     C                     MOVE INCHGC    TCCHGC                          CFT009
     C                     MOVE INCHGC    FXCGCY                          CFT009
     C                     MOVE INCHGC    CQCHGC                          CFT009
     C                     MOVE INCHGC    ADCHGC                          CFT009
     C                     MOVE INCHGC    CACHGC                          CFT009
     C                     MOVE INCHGC    TPCHGC                          CFT009
     C                     MOVE INCHGC    TXCHGC                          CFT009
     C                     MOVE INCHGC    SPCHGC                          CFT009
     C                     MOVE INCHGC    SSCHGC                          CFT009
     C                     MOVE INCHGC    M0CHGC                          CFT009
     C                     MOVE INCHGC    M1CHGC                          CFT009
     C                     MOVE INCHGC    M2CHGC                          CFT009
     C                     MOVE INCHGC    M3CHGC                          CFT009
     C                     MOVE INCHGC    M4CHGC                          CFT009
     C                     MOVE INCHGC    M5CHGC                          CFT009
     C                     MOVE INCHGC    VTCHGC                          CFT009
      *                                                                   CFT009
      ** Set up amounts in charges currency from file.                    CFT009
      *                                                                   CFT009
     C                     Z-ADDTXCH      ZTXCH  150H                     CFT009
     C                     Z-ADDCQCH      ZCQCH  150H                     CFT009
     C                     Z-ADDMSCH      ZMSCH  150H                     CFT009
     C                     Z-ADDTRCM      ZTRCM  150H                     CFT009
     C                     Z-ADDINCHCM    ZINCHC 150H                     CFT009
     C                     Z-ADDADCH      ZADCH  150H                     CFT009
     C                     Z-ADDTLCH      ZTLCH  150H                     CFT009
      *                                                                   CFT009
      ** Amount                                                           CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE TRCM      ZFIELD                          CFT009
     C                     Z-ADDWPCCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    TCAMT                           CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE INCHCM    ZFIELD                          CFT009
     C                     Z-ADDWPCCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    FXAMT                           CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE CQCH      ZFIELD                          CFT009
     C                     Z-ADDWPCCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    CQAMT                           CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE ADCH      ZFIELD                          CFT009
     C                     Z-ADDWPCCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    ADAMT                           CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE TXCH      ZFIELD                          CFT009
     C                     Z-ADDWPCCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    TXAMT                           CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE TLCH      ZFIELD                          CFT009
     C                     Z-ADDWPCCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    TPAMT                           CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE MSCH      ZFIELD                          CFT009
     C                     Z-ADDWPCCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    M0AMT                           CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE ZMSC01    ZFIELD                          CFT009
     C                     Z-ADDWPCCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    M1AMT                           CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE ZMSC02    ZFIELD                          CFT009
     C                     Z-ADDWPCCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    M2AMT                           CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE ZMSC03    ZFIELD                          CFT009
     C                     Z-ADDWPCCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    M3AMT                           CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE ZMSC04    ZFIELD                          CFT009
     C                     Z-ADDWPCCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    M4AMT                           CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE ZMSC05    ZFIELD                          CFT009
     C                     Z-ADDWPCCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    M5AMT                           CFT009
      *                                                                   CFT009
      ** Amounts in charges currency                                      CFT009
      *                                                                   CFT009
      ** Get charges currency decimal places.                             CFT009
      *                                                                   CFT009
     C                     CALL 'AOCURRR0'                                CFT009
     C                     PARM *BLANKS   WRTCD                           CFT009
     C                     PARM '*KEY   ' WOPTN                           CFT009
     C                     PARM INCHGC    WCCY    3                       CFT009
     C           SDCURR    PARM SDCURR    DSSDY                           CFT009
      *                                                                   CFT009
     C           WRTCD     IFNE *BLANKS                                   CFT009
     C                     Z-ADD900       WBASE            ************   CFT009
     C                     MOVELNDCY      WBKEY            * DBERR 900*   CFT009
     C                     MOVEL'SDCURRPD'WBFILE           ************   CFT009
     C                     EXSR ABORT                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     Z-ADDA6NBDP    WCHGDP  20                      CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE DUMA1     ZFIELD                          CFT009
     C                     Z-ADDWCHGDP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    TCCHGA                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE INDUM7    ZFIELD                          CFT009
     C                     Z-ADDWCHGDP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    FXCHGA                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE DUMA3     ZFIELD                          CFT009
     C                     Z-ADDWCHGDP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    CQCHGA                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE DUMA4     ZFIELD                          CFT009
     C                     Z-ADDWCHGDP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    ADCHGA                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE DUMA2     ZFIELD                          CFT009
     C                     Z-ADDWCHGDP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    TXCHGA                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE DUMA5     ZFIELD                          CFT009
     C                     Z-ADDWCHGDP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    TPCHGA                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE DUMA6     ZFIELD                          CFT009
     C                     Z-ADDWCHGDP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    M0CHGA                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE CMSC01    ZFIELD                          CFT009
     C                     Z-ADDWCHGDP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    M1CHGA                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE CMSC02    ZFIELD                          CFT009
     C                     Z-ADDWCHGDP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    M2CHGA                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE CMSC03    ZFIELD                          CFT009
     C                     Z-ADDWCHGDP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    M3CHGA                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE CMSC04    ZFIELD                          CFT009
     C                     Z-ADDWCHGDP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    M4CHGA                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE CMSC05    ZFIELD                          CFT009
     C                     Z-ADDWCHGDP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    M5CHGA                          CFT009
      *                                                                   CFT009
      ** Totals                                                           CFT009
      *                                                                   CFT009
     C           TRCM      ADD  INCHCM    SUMAMT 150                      CFT009
     C                     ADD  CQCH      SUMAMT                          CFT009
     C                     ADD  ADCH      SUMAMT                          CFT009
     C                     ADD  TXCH      SUMAMT                          CFT009
     C                     ADD  TLCH      SUMAMT                          CFT009
     C                     ADD  MSCH      SUMAMT                          CFT009
     C                     ADD  ZMSC01    SUMAMT                          CFT009
     C                     ADD  ZMSC02    SUMAMT                          CFT009
     C                     ADD  ZMSC03    SUMAMT                          CFT009
     C                     ADD  ZMSC04    SUMAMT                          CFT009
     C                     ADD  ZMSC05    SUMAMT                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE SUMAMT    ZFIELD                          CFT009
     C                     Z-ADDWPCCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    TOTAMT                          CFT009
      *                                                                   CFT009
      ** Totals in charge currency                                        CFT009
      *                                                                   CFT009
     C           DUMA1     ADD  INDUM7    SUMCHG 150                      CFT009
     C                     ADD  DUMA3     SUMCHG                          CFT009
     C                     ADD  DUMA4     SUMCHG                          CFT009
     C                     ADD  DUMA2     SUMCHG                          CFT009
     C                     ADD  DUMA5     SUMCHG                          CFT009
     C                     ADD  DUMA6     SUMCHG                          CFT009
     C                     ADD  CMSC01    SUMCHG                          CFT009
     C                     ADD  CMSC02    SUMCHG                          CFT009
     C                     ADD  CMSC03    SUMCHG                          CFT009
     C                     ADD  CMSC04    SUMCHG                          CFT009
     C                     ADD  CMSC05    SUMCHG                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           CFT010    IFEQ 'Y'                                       CFT009
      *                                                                   CFT009
      ** VAT flags                                                        CFT009
      *                                                                   CFT009
     C                     MOVE INVAT1    TCVAT                           CFT009
     C                     MOVE INVAT7    FXVAT                           CFT009
     C                     MOVE INVAT3    CQVAT                           CFT009
     C                     MOVE INVAT4    ADVAT                           CFT009
     C                     MOVE INVAT2    TXVAT                           CFT009
     C                     MOVE INVAT5    TPVAT                           CFT009
     C                     MOVE INVAT6    M0VAT                           CFT009
     C                     MOVE VTMIC1    M1VAT                           CFT009
     C                     MOVE VTMIC2    M2VAT                           CFT009
     C                     MOVE VTMIC3    M3VAT                           CFT009
     C                     MOVE VTMIC4    M4VAT                           CFT009
     C                     MOVE VTMIC5    M5VAT                           CFT009
      *                                                                   CFT009
      ** VAT amount and total charge                                      CFT009
      *                                                                   CFT009
      ** VAT processing calculates VAT on total amount, rather than       CFT009
      ** individual charges.                                              CFT009
      *                                                                   CFT009
     C                     Z-ADD0         VAT    150                      CFT009
      *                                                                   CFT009
      ** Use VAT amounts from file.                                       CFT009
      *                                                                   CFT009
     C                     Z-ADDINVATT    SUMVAT 150H                     CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE SUMVAT    ZFIELD                          CFT009
     C                     Z-ADDWPCCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    VTAMT                           CFT009
      *                                                                   CFT009
      ** V.A.T. amount in charges currency.                               CFT009
      *                                                                   CFT009
     C                     Z-ADDINDUM8    VATCHG 150H                     CFT009
      *                                                                   CFT009
      ** Format V.A.T. amount in charges currency.                        CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE VATCHG    ZFIELD                          CFT009
     C                     Z-ADDWCHGDP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    VTCHGA                          CFT009
      *                                                                   CFT009
      ** Totals                                                           CFT009
      *                                                                   CFT009
      ** Levied currency                                                  CFT009
      *                                                                   CFT009
     C           SUMAMT    ADD  SUMVAT    LEVCHG 160                      CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE LEVCHG    ZFIELD                          CFT009
     C                     Z-ADDWPCCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    TOTAMT    P                     CFT009
      *                                                                   CFT009
      ** Charges currency                                                 CFT009
      *                                                                   CFT009
     C           SUMCHG    ADD  VATCHG    CHGCHG 160                      CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE CHGCHG    ZFIELD                          CFT009
     C                     Z-ADDWCHGDP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    TOTCHG    P                     CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
      *                                                                   CFT009
      ** Totals without VAT.                                              CFT009
      *                                                                   CFT009
      ** Levied currency                                                  CFT009
      *                                                                   CFT009
     C                     Z-ADDSUMAMT    LEVCHG 160                      CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE LEVCHG    ZFIELD                          CFT009
     C                     Z-ADDWPCCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    TOTAMT    P                     CFT009
      *                                                                   CFT009
      ** Charges currency                                                 CFT009
      *                                                                   CFT009
     C                     Z-ADDSUMCHG    CHGCHG 160                      CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE CHGCHG    ZFIELD                          CFT009
     C                     Z-ADDWCHGDP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    TOTCHG    P                     CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                                       CSW209
     C           CSW209    IFEQ 'Y'                                                           CSW209
      *                                                                                       CSW209
     C                     MOVELINNWRK    P5NWRK                                              CSW209
     C                     MOVELINMTPY    P5MTPY                                              CSW209
     C                     MOVELINVALF    P5VALF                                              CSW209
      *                                                                                       CSW209
      **  Cover Message Information for Incoming Payments                                     CSW209
      *                                                                                       CSW209
      **  Ordering Customer (Cover)                                                           CSW209
      *                                                                                       CSW209
     C                     MOVELINCOC1    P5COC1                                              CSW209
     C                     MOVELINCOC2    P5COC2                                              CSW209
     C                     MOVELINCOC3    P5COC3                                              CSW209
     C                     MOVELINCOC4    P5COC4                                              CSW209
     C                     MOVELINCOC5    P5COC5                                              CSW209
      *                                                                                       CSW209
      **  Ordering Institution (Cover)                                                        CSW209
      *                                                                                       CSW209
     C                     MOVELINCOB1    P5COB1                                              CSW209
     C                     MOVELINCOB2    P5COB2                                              CSW209
     C                     MOVELINCOB3    P5COB3                                              CSW209
     C                     MOVELINCOB4    P5COB4                                              CSW209
     C                     MOVELINCOB5    P5COB5                                              CSW209
      *                                                                                       CSW209
      **  Intermediary Institution (Cover)                                                    CSW209
      *                                                                                       CSW209
     C                     MOVELINCIB1    P5CIB1                                              CSW209
     C                     MOVELINCIB2    P5CIB2                                              CSW209
     C                     MOVELINCIB3    P5CIB3                                              CSW209
     C                     MOVELINCIB4    P5CIB4                                              CSW209
     C                     MOVELINCIB5    P5CIB5                                              CSW209
      *                                                                                       CSW209
      **  Account with Institution (Cover)                                                    CSW209
      *                                                                                       CSW209
     C                     MOVELINCAB1    P5CAB1                                              CSW209
     C                     MOVELINCAB2    P5CAB2                                              CSW209
     C                     MOVELINCAB3    P5CAB3                                              CSW209
     C                     MOVELINCAB4    P5CAB4                                              CSW209
     C                     MOVELINCAB5    P5CAB5                                              CSW209
      *                                                                                       CSW209
      **  Beneficiary Customer (Cover)                                                        CSW209
      *                                                                                       CSW209
     C                     MOVELINCBC1    P5CBC1                                              CSW209
     C                     MOVELINCBC2    P5CBC2                                              CSW209
     C                     MOVELINCBC3    P5CBC3                                              CSW209
     C                     MOVELINCBC4    P5CBC4                                              CSW209
     C                     MOVELINCBC5    P5CBC5                                              CSW209
      *                                                                                       CSW209
      **  Remittance Information (Cover)                                                      CSW209
      *                                                                                       CSW209
     C                     MOVELINCDP1    P5CDP1                                              CSW209
     C                     MOVELINCDP2    P5CDP2                                              CSW209
     C                     MOVELINCDP3    P5CDP3                                              CSW209
     C                     MOVELINCDP4    P5CDP4                                              CSW209
      *                                                                                       CSW209
      **  Sender to Receiver Information (Cover)                                              CSW209
      *                                                                                       CSW209
     C                     MOVELINCBB1    P5CBB1                                              CSW209
     C                     MOVELINCBB2    P5CBB2                                              CSW209
     C                     MOVELINCBB3    P5CBB3                                              CSW209
     C                     MOVELINCBB4    P5CBB4                                              CSW209
     C                     MOVELINCBB5    P5CBB5                                              CSW209
     C                     MOVELINCBB6    P5CBB6                                              CSW209
      *                                                                                       CSW209
      **  Instructed Currency (Cover)                                                         CSW209
      *                                                                                       CSW209
     C                     MOVELINCICY    P5CICY                                              CSW209
      *                                                                                       CSW209
      **  Instructed Amount (Cover)                                                           CSW209
      *                                                                                       CSW209
     C                     MOVEL*BLANKS   P5CIAM                                              CSW209
      *                                                                                       CSW209
      ** Access AOCURR0 to get the currency's decimal places                                  CSW209
      *                                                                                       CSW209
     C           INCICY    IFNE *BLANKS                                                       CSW209
      *                                                                                       CSW209
     C                     CALL 'AOCURRR0'                                                    CSW209
     C                     PARM *BLANKS   WRTCD                                               CSW209
     C                     PARM '*KEY   ' WOPTN                                               CSW209
     C                     PARM           INCICY                                              CSW209
     C           SDCURR    PARM SDCURR    DSSDY                                               CSW209
     C           WRTCD     IFNE *BLANKS                                                       CSW209
     C                     Z-ADD31        WBASE                                               CSW209
     C                     MOVELINCICY    WBKEY                                               CSW209
     C                     MOVEL'SDCURRPD'WBFILE                                              CSW209
     C                     EXSR ABORT                                                         CSW209
     C                     ENDIF                                                              CSW209
     C                     Z-ADDA6NBDP    W5CIAM  10                                          CSW209
      *                                                                                       CSW209
      ** Format Instructed Currency Amount                                                    CSW209
      *                                                                                       CSW209
     C                     MOVEL*BLANKS   WFDIN                                               CSW209
     C                     MOVE INCIAM    WFDIN                                               CSW209
     C                     Z-ADDW5CIAM    WDEC                                                CSW209
     C           13        SUB  W5CIAM    WDIG                                                CSW209
     C                     EXSR UGFRMT                                                        CSW209
     C                     MOVE WFDOUT    P5CIAM                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CER030
     C           CGL013    IFEQ 'Y'                                                           CER030
     C           CER030    OREQ 'Y'                                                           CER030
     C                     MOVE *ON       *IN33                                               CER030
     C                     MOVELIRTTY     P5RTTY                                              CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           CER031    IFEQ 'Y'                                                           CER030
     C                     MOVE *ON       *IN34                                               CER030
     C                     MOVELIEXT1     P5EXN1                                              CER030
     C                     MOVELIEXT2     P5EXN2                                              CER030
     C                     MOVELIEXT3     P5EXN3                                              CER030
     C                     MOVELIEXT4     P5EXN4                                              CER030
     C                     MOVELIEXT5     P5EXN5                                              CER030
     C                     MOVELIEXT6     P5EXN6                                              CER030
     C                     ENDIF                                                              CER030
     C*
     C** OUTPUT PAGE TO REPORT
     C*
     C                     ADD  1         P5PAGE
     C                     WRITEP5HD
     C                     WRITEP5DETL
      *                                                                                       CER030
     C           CFT009    IFNE 'Y'                                                           CER030
      *                                                                                       CER030
     C           CGL013    IFEQ 'Y'                                                           CER030
     C           CER030    OREQ 'Y'                                                           CER030
     C           CER030    OREQ 'Y'                                                           CER030
      *                                                                                       CER030
     C           OFLLN5    SUB  PRTLN5    WREM    20                                          CER030
      *                                                                                       CER030
     C           WREM      IFLE 8                                                             CER030
     C                     ADD  1         P5PAGE                                              CER030
     C                     WRITEP5HDX                                                         CER030
     C                     ENDIF                                                              CER030
     C                     WRITEP5TRNR                                                        CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     SETON                     85
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
     C                     ADD  1         P5PAGE                          CFT009
     C                     WRITEP5CHG                                     CFT009
     C                     WRITEP5TRNR                                                        CER030
     C                     ENDIF                                          CFT009
      *                                                                                       CSW209
     C           CSW209    IFEQ 'Y'                                                           CSW209
      *                                                                                       CSW209
     C           CFT009    IFEQ 'Y'                                                         AR655670
     C                     MOVE '1'       *IN78                                             AR655670
     C                     ELSE                                                             AR655670
     C                     MOVE '0'       *IN78                                             AR655670
     C                     ADD  1         P5PAGE                                            AR655670
     C                     ENDIF                                                            AR655670
      *                                                                                     AR655670
     C                     WRITEP5NTWK                                                        CSW209
     C           INVALF    IFEQ 'COV'                                                         CSW209
     C           P5COCC    IFNE *BLANKS                                                       CSW209
     C           P5COBC    ORNE *BLANKS                                                       CSW209
     C           P5CIBC    ORNE *BLANKS                                                       CSW209
     C           P5CABC    ORNE *BLANKS                                                       CSW209
     C           P5CBCC    ORNE *BLANKS                                                       CSW209
     C           P5CBBC    ORNE *BLANKS                                                       CSW209
     C           P5CDPC    ORNE *BLANKS                                                       CSW209
     C           P5CICY    ORNE *BLANKS                                                       CSW209
     C           P5CIAM    ORNE *BLANKS                                                       CSW209
     C                     ADD  1         P5PAGE                                              CSW209
     C                     WRITEP5COVM                                                        CSW209
      *                                                                                       CSW209
     C                     ENDIF                                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     ENDIF                                                              CSW209
     C*
     C                     ENDSR
     C*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C*                                                               *
     C*  OTPREP - SUBROUTINE TO PRODUCE REPORT FT1010P6 FOR OUTGOING  *
     C*           PAYMENTS                                            *
     C*                                                               *
     C*****************************************************************
     C*
     C*
     C           OTPREP    BEGSR
     C*
     C                     MOVELTITL      P6TITL
     C                     MOVELRUNA      P6DATE
     C*                                                                   S01117
     C* IF MULTIBRANCHING INDICATOR ACTIVE, MOVE BOOKING BRANCH AND       S01117
     C* APPROPRIATE BRANCH NAME TO THE RELATIVE FIELDS SET UP WITHIN      S01117
     C* THE PRINTER FILE                                                  S01117
     C*                                                                   S01117
     C           *IN30     IFEQ '1'                                       S01117
     C                     MOVE BRCA      P6BRCA                          S01117
     C                     MOVE BRCA      WRKFLD                          S01117
     C                     EXSR SUBBRN                                    S01117
     C                     MOVELBRNM      P6BRNM                          S01117
     C*                                                                   S01117
     C* IF ORIGINATING BRANCH USED INDICATOR ACTIVE,MOVE ORBR AND         S01117
     C* APPROPRIATE BRANCH NAME TO THE RELATIVE FIELDS SET UP WITHIN      S01117
     C* THE PRINTER FILE                                                  S01117
     C*                                                                   S01117
     C           *IN35     IFEQ '1'                                       S01117
     C                     MOVE ORBR      P6ORBR                          S01117
     C                     MOVE ORBR      WRKFLD                          S01117
     C                     EXSR SUBBRN                                    S01117
     C                     MOVELBRNM      P6ORNM                          S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C************                                                        S01435
     C************                                                        S01435
     C***SETUP*ADDRESS FIELDS,ACESSING CLINT AS APPROPRIATE               S01435
     C************                                                        S01435
     C***RECEIVER'S CORRESPONDENT                                         S01435
     C************                                                        S01435
     C***********RCRT      IFNE 'C'                                       S01435
     C************         MOVELRCO1      P6RCO1                          S01435
     C************         MOVELRCO2      P6RCO2                          S01435
     C************         MOVELRCO3      P6RCO3                          S01435
     C************         MOVELRCO4      P6RCO4                          S01435
     C************         MOVELRCO5      P6RCO5                          S01435
     C************         ELSE                                           S01435
     C************         MOVELRCO1      WCLNUM                          S01435
     C************         MOVEL'B'       WCLRCT                          S01435
     C************         EXSR UCCLCN                                    S01435
     C************                                                        S01435
     C************IN89     IFEQ '1'                                       S01435
     C************         MOVEL'CLINT'   WBFILE           **********     S01435
     C************         MOVELWCLNUM    WA7     7        * DBERR 30     S01435
     C************         MOVE WCLRCT    WA7              **********     S01435
     C************         MOVELWA7       WBKEY                           S01435
     C************         Z-ADD30        WBASE                           S01435
     C************         EXSR ABORT                      *ABORT PGM*    S01435
     C************         END                                            S01435
     C************                                                        S01435
     C************         MOVELRCO1      P6RCO1                          S01435
     C************         MOVELCNA1      P6RCO2                          S01435
     C************         MOVELCNA2      P6RCO3                          S01435
     C************         MOVELCNA3      P6RCO4                          S01435
     C************         MOVELCNA4      P6RCO5                          S01435
     C************         END                                            S01435
     C************                                                        S01435
     C***ORDERING*CUSTOMER                                                S01435
     C************                                                        S01435
     C***********ORCT      IFNE 'C'                                       S01435
     C************         MOVELORC1      P6ORC1                          S01435
     C************                                                        S01117
     C**IF*MULTIBRANCHING INDICATOR SETOF AND PARTIAL ACCOUNT ENTRY,      S01117
     C**SINGLE*BRANCH NEED TO BE FORMATTED BY CUTTING OFF THE BRANCH CODE S01117
     C**FROM*THE*END USING WORK FIELD BEFORE OUTPUTING TO THE PRINTER     S01117
     C**FILE******                                                        S01117
     C************IN30     IFEQ '0'                                       S01117
     C***********ORCT      ANDEQ'P'                                       S01117
     C************         MOVELORC1      FLD12  12                       S01117
     C************         MOVE *BLANKS   P6ORC1                          S01117
     C************         MOVELFLD12     P6ORC1                          S01117
     C************         END                                            S01117
     C************         MOVELORC2      P6ORC2                          S01435
     C************         MOVELORC3      P6ORC3                          S01435
     C************         MOVELORC4      P6ORC4                          S01435
     C************         MOVEL*BLANKS   P6ORC5                          S01435
     C************         ELSE                                           S01435
     C************         MOVELORC1      WCLNUM                          S01435
     C************         MOVEL'B'       WCLRCT                          S01435
     C************         EXSR UCCLCN                                    S01435
     C************                                                        S01435
     C************IN89     IFEQ '1'                                       S01435
     C************         MOVEL'CLINT'   WBFILE           **********     S01435
     C************         MOVELWCLNUM    WA7              * DBERR 31     S01435
     C************         MOVE WCLRCT    WA7              **********     S01435
     C************         MOVELWA7       WBKEY                           S01435
     C************         Z-ADD31        WBASE                           S01435
     C************         EXSR ABORT                      *ABORT PGM*    S01435
     C************         END                                            S01435
     C************                                                        S01435
     C************         MOVELORC1      P6ORC1                          S01435
     C************         MOVELCNA1      P6ORC2                          S01435
     C************         MOVELCNA2      P6ORC3                          S01435
     C************         MOVELCNA3      P6ORC4                          S01435
     C************         MOVELCNA4      P6ORC5                          S01435
     C************         END                                            S01435
     C************                                                        S01435
     C***RECEIVING BANK                                                   S01435
     C************                                                        S01435
     C***********DSTT      IFNE 'C'                                       S01435
     C************         MOVELDST1      P6DST1                          S01435
     C************                                                        S01117
     C**IF*MULTIBRANCHING INDICATOR SETOF AND FULL ACCOUNT ENTRY,SINGLE   S01117
     C**BRANCH*NEED TO BE FORMATTED BY CUTTING OFF THE BRANCH CODE FROM   S01117
     C**THE*END*USING A WORK FIELD BEFORE OUTPUTING TO THE PRINTER FILE   S01117
     C************                                                        S01117
     C************IN30     IFEQ '0'                                       S01117
     C***********DSTT      ANDEQ'G'                                       S01117
     C************         MOVELDST1      FLD15  15                       S01117
     C************         MOVE *BLANKS   P6DST1                          S01117
     C************         MOVELFLD15     P6DST1                          S01117
     C************         END                                            S01117
     C************         MOVELDST2      P6DST2                          S01435
     C************         MOVELDST3      P6DST3                          S01435
     C************         MOVELDST4      P6DST4                          S01435
     C************         MOVEL*BLANKS   P6DST5                          S01435
     C************         ELSE                                           S01435
     C************         MOVELDST1      WCLNUM                          S01435
     C************         MOVEL'B'       WCLRCT                          S01435
     C************         EXSR UCCLCN                                    S01435
     C************                                                        S01435
     C************IN89     IFEQ '1'                                       S01435
     C************         MOVEL'CLINT'   WBFILE           **********     S01435
     C************         MOVELWCLNUM    WA7              * DBERR 32     S01435
     C************         MOVE WCLRCT    WA7              **********     S01435
     C************         MOVELWA7       WBKEY                           S01435
     C************         Z-ADD32        WBASE                           S01435
     C************         EXSR ABORT                      *ABORT PGM*    S01435
     C************         END                                            S01435
     C************                                                        S01435
     C************         MOVELDST1      P6DST1                          S01435
     C************         MOVELCNA1      P6DST2                          S01435
     C************         MOVELCNA2      P6DST3                          S01435
     C************         MOVELCNA3      P6DST4                          S01435
     C************         MOVELCNA4      P6DST5                          S01435
     C************         END                                            S01435
     C************                                                        S01435
     C***ACCOUNT*WITH BANK                                                S01435
     C************                                                        S01435
     C***********ACBT      IFNE 'C'                                       S01435
     C************         MOVELACB1      P6ACB1                          S01435
     C************         MOVELACB2      P6ACB2                          S01435
     C************         MOVELACB3      P6ACB3                          S01435
     C************         MOVELACB4      P6ACB4                          S01435
     C************         MOVELACB5      P6ACB5                          S01435
     C************         ELSE                                           S01435
     C************         MOVELACB1      WCLNUM                          S01435
     C************         MOVEL'B'       WCLRCT                          S01435
     C************         EXSR UCCLCN                                    S01435
     C************                                                        S01435
     C************IN89     IFEQ '1'                                       S01435
     C************         MOVEL'CLINT'   WBFILE           **********     S01435
     C************         MOVELWCLNUM    WA7              * DBERR 33     S01435
     C************         MOVE WCLRCT    WA7              **********     S01435
     C************         MOVELWA7       WBKEY                           S01435
     C************         Z-ADD33        WBASE                           S01435
     C************         EXSR ABORT                      *ABORT PGM*    S01435
     C************         END                                            S01435
     C************                                                        S01435
     C************         MOVELACB1      P6ACB1                          S01435
     C************         MOVELCNA1      P6ACB2                          S01435
     C************         MOVELCNA2      P6ACB3                          S01435
     C************         MOVELCNA3      P6ACB4                          S01435
     C************         MOVELCNA4      P6ACB5                          S01435
     C************         END                                            S01435
     C************                                                        S01435
     C***BENEFICIARY CUSTOMER                                             S01435
     C************                                                        S01435
     C***********BNCT      IFNE 'C'                                       S01435
     C************         MOVELBNC1      P6BNC1                          S01435
     C************         MOVELBNC2      P6BNC2                          S01435
     C************         MOVELBNC3      P6BNC3                          S01435
     C************         MOVELBNC4      P6BNC4                          S01435
     C************         MOVELBNC5      P6BNC5                          S01435
     C************         ELSE                                           S01435
     C************         MOVELBNC1      WCLNUM                          S01435
     C************         MOVEL'B'       WCLRCT                          S01435
     C************         EXSR UCCLCN                                    S01435
     C************                                                        S01435
     C************IN89     IFEQ '1'                                       S01435
     C************         MOVEL'CLINT'   WBFILE           **********     S01435
     C************         MOVELWCLNUM    WA7              * DBERR 34     S01435
     C************         MOVE WCLRCT    WA7              **********     S01435
     C************         MOVELWA7       WBKEY                           S01435
     C************         Z-ADD34        WBASE                           S01435
     C************         EXSR ABORT                      *ABORT PGM*    S01435
     C************         END                                            S01435
     C************                                                        S01435
     C************         MOVELBNC1      P6BNC1                          S01435
     C************         MOVELCNA1      P6BNC2                          S01435
     C************         MOVELCNA2      P6BNC3                          S01435
     C************         MOVELCNA3      P6BNC4                          S01435
     C************         MOVELCNA4      P6BNC5                          S01435
     C************         END                                            S01435
     C************                                                        S01435
     C***FORMAT*PAY & SETTLE AMOUNTS                                      S01435
     C************                                                        S01435
     C***CALL*UATBCN TO ACCESS CURRENCY RECORD FOR SETTLE CURRENCY        S01435
     C************                                                        S01435
     C************         MOVEL*BLANKS   ZTABKY                          S01435
     C************         MOVEL'20'      ZTABKY                          S01435
     C************         MOVELSMCY      WA4                             S01435
     C************         MOVE '1'       WA4                             S01435
     C************         MOVE WA4       ZTABKY                          S01435
     C************         EXSR UATBCN                                    S01435
     C************                                                        S01435
     C***CHECK*IF*DATABASE ERROR OCCURRED                                 S01435
     C************                                                        S01435
     C************IN89     IFEQ '1'                                       S01435
     C************         MOVEL'TABLE'   WBFILE           **********     S01435
     C************         MOVELZTABKY    WBKEY            * DBERR 35     S01435
     C************         Z-ADD35        WBASE            **********     S01435
     C************         EXSR ABORT                      *ABORT PGM*    S01435
     C************         END                                            S01435
     C************                                                        S01435
     C***STORE*NUMBER OF DECIMAL PLACES FOR SETTLE CURRENCY               S01435
     C************                                                        S01435
     C************         Z-ADDCDP       SVPCDP  10                      S01435
     C************                                                        S01435
     C***FORMAT*SETTLE AMOUNT                                             S01435
     C************                                                        S01435
     C************         MOVEL*BLANKS   WFDIN  15                       S01435
     C************         MOVE SMAM      WFDIN                           S01435
     C************         Z-ADDSVPCDP    WDEC    10                      S01435
     C***********13        SUB  SVPCDP    WDIG    20                      S01435
     C************         EXSR UGFRMT                                    S01435
     C************         MOVE WFDOUT    P6SMAM                          S01435
     C************                                                        S01435
     C***CALL*UATBCN TO ACCESS CURRENCY RECORD FOR PAY CURRENCY           S01435
     C************                                                        S01435
     C************         MOVEL*BLANKS   ZTABKY                          S01435
     C************         MOVEL'20'      ZTABKY                          S01435
     C************         MOVELPCCY      WA4                             S01435
     C************         MOVE '1'       WA4                             S01435
     C************         MOVE WA4       ZTABKY                          S01435
     C************         EXSR UATBCN                                    S01435
     C************                                                        S01435
     C***CHECK*IF*DATABASE ERROR OCCURRED                                 S01435
     C************                                                        S01435
     C************IN89     IFEQ '1'                                       S01435
     C************         MOVEL'TABLE'   WBFILE            **********    S01435
     C************         MOVELZTABKY    WBKEY             * DBERR 36    S01435
     C************         Z-ADD36        WBASE             **********    S01435
     C************         EXSR ABORT                      *ABORT PGM*    S01435
     C************         END                                            S01435
     C************                                                        S01435
     C***STORE*NUMBER OF DECIMAL PLACES FOR PAY CURRENCY                  S01435
     C************                                                        S01435
     C************         Z-ADDCDP       SVRCDP  10                      S01435
     C************                                                        S01435
     C***FORMAT*PAY AMOUNT                                                S01435
     C************                                                        S01435
     C************         MOVEL*BLANKS   WFDIN                           S01435
     C************         MOVE PYAM      WFDIN                           S01435
     C************         Z-ADDSVRCDP    WDEC                            S01435
     C***********13        SUB  SVRCDP    WDIG                            S01435
     C************         EXSR UGFRMT                                    S01435
     C************         MOVE WFDOUT    P6PYAM                          S01435
     C************                                                        S01435
     C***FORMAT*OTHER AMOUNTS & CURRENCIES                                S01435
     C***IF*CHARGES TO DEBIT A/C FIELD IS NON-ZERO USE BASE CURRENCY;     S01435
     C***OTHERWISE IF PAY PLUS CHARGES INDICATOR IS 'Y' USE SETTLE CCY;   S01435
     C***OTHERWISE USE PAY CURRENCY                                       S01435
     C************                                                        S01435
     C***********CDRO      IFNE *ZERO                                     S01435
     C************         MOVELBCCY      WCCY    3                       S01435
     C************         Z-ADDSVBCDP    WDEC                            S01435
     C************         ELSE                                           S01435
     C***********ADDC      IFEQ 'Y'                                       S01435
     C************         MOVELSMCY      WCCY                            S01435
     C************         Z-ADDSVPCDP    WDEC                            S01435
     C************         ELSE                                           S01435
     C************         MOVELPCCY      WCCY                            S01435
     C************         Z-ADDSVRCDP    WDEC                            S01435
     C************         END                                            S01435
     C************         END                                            S01435
     C************                                                        S01435
     C***********11        SUB  WDEC      WDIG                            S01435
     C************                                                        S01435
     C***SETUP*CURRENCY NAMES                                             S01435
     C************                                                        S01435
     C************         MOVELWCCY      P6TRCY                          S01435
     C************         MOVELWCCY      P6TXCY                          S01435
     C************         MOVELWCCY      P6CQCY                          S01435
     C************         MOVELWCCY      P6SPCY                          S01435
     C************         MOVELWCCY      P6CSCY                          S01435
     C************         MOVELWCCY      P6MSCY                          S01435
     C************                                                        S01435
     C***FORMAT*TRANSFER COMMISSION AMOUNT                                S01435
     C************                                                        S01435
     C************         MOVEL*BLANKS   WFDIN                           S01435
     C************         MOVE TRCM      WFDIN                           S01435
     C************         EXSR UGFRMT                                    S01435
     C************         MOVE WFDOUT    P6TRCM                          S01435
     C************                                                        S01435
     C***FORMAT*TELEX CHARGE AMOUNT                                       S01435
     C************                                                        S01435
     C************         MOVEL*BLANKS   WFDIN                           S01435
     C************         MOVE TXCH      WFDIN                           S01435
     C************         EXSR UGFRMT                                    S01435
     C************         MOVE WFDOUT    P6TXCH                          S01435
     C************                                                        S01435
     C***FORMAT*CHEQUE CHARGE AMOUNT                                      S01435
     C************                                                        S01435
     C************         MOVEL*BLANKS   WFDIN                           S01435
     C************         MOVE CQCH      WFDIN                           S01435
     C************         EXSR UGFRMT                                    S01435
     C************         MOVE WFDOUT    P6CQCH                          S01435
     C************                                                        S01435
     C***FORMAT*SWIFT PR CHARGE AMOUNT                                    S01435
     C************                                                        S01435
     C************         MOVEL*BLANKS   WFDIN                           S01435
     C************         MOVE SPCH      WFDIN                           S01435
     C************         EXSR UGFRMT                                    S01435
     C************         MOVE WFDOUT    P6SPCH                          S01435
     C************                                                        S01435
     C***FORMAT*COSTS ABROAD CHARGE AMOUNT                                S01435
     C************                                                        S01435
     C************         MOVEL*BLANKS   WFDIN                           S01435
     C************         MOVE CSTA      WFDIN                           S01435
     C************         EXSR UGFRMT                                    S01435
     C************         MOVE WFDOUT    P6CSTA                          S01435
     C************                                                        S01435
     C***FORMAT*MISCELLANEOUS CHARGE AMOUNT                               S01435
     C************                                                        S01435
     C************         MOVEL*BLANKS   WFDIN                           S01435
     C************         MOVE MSCH      WFDIN                           S01435
     C************         EXSR UGFRMT                                    S01435
     C************         MOVE WFDOUT    P6MSCH                          S01435
     C************                                                        S01435
     C***FORMAT*DATE FIELDS USING SYSTEM ROUTINE ZDATE2                   S01435
     C************                                                        S01435
     C***SETTLE*VALUE DATE                                                S01435
     C************                                                        S01435
     C************         Z-ADDSLDT      ZDAYNO                          S01435
     C************         EXSR ZDATE2                                    S01435
     C************         MOVELZADATE    P6SLDT                          S01435
     C************                                                        S01435
     C***PAY*VALUE DATE                                                   S01435
     C************                                                        S01435
     C************         Z-ADDPVDT      ZDAYNO                          S01435
     C************         EXSR ZDATE2                                    S01435
     C************         MOVELZADATE    P6PYDT                          S01435
     C************                                                        S01435
     C***FINAL*DATE                                                       S01435
     C************                                                        S01435
     C************         Z-ADDFDAT      ZDAYNO                          S01435
     C************         EXSR ZDATE2                                    S01435
     C************         MOVELZADATE    P6FDAT                          S01435
     C************                                                        S01435
     C************         Z-ADDNPDT      ZDAYNO                          S01435
     C************         EXSR ZDATE2                                    S01435
     C************         MOVELZADATE    P6NPDT                          S01435
     C************                                                        S01435
     C***SETUP*REMAINING REPORT FIELDS                                    S01435
     C************                                                        S01435
     C************         MOVELPREF      P6PREF                          S01435
     C************         MOVELPYTP      P6PYTP                          S01435
     C************         MOVELPYST      P6PYST                          S01435
     C************         MOVELSMCY      P6SMCY                          S01435
     C************         Z-ADDRATE      P6RATE                          S01435
     C************         MOVELPCCY      P6PCCY                          S01435
     C************         MOVELBBI1      P6BBI1                          S01435
     C************         MOVELBBI2      P6BBI2                          S01435
     C************         MOVELBBI3      P6BBI3                          S01435
     C************         MOVELBBI4      P6BBI4                          S01435
     C************         MOVELBBI5      P6BBI5                          S01435
     C************         MOVELBBI6      P6BBI6                          S01435
     C************         MOVELDTP1      P6DTP1                          S01435
     C************         MOVELDTP2      P6DTP2                          S01435
     C************         MOVELDTP3      P6DTP3                          S01435
     C************         MOVELDTP4      P6DTP4                          S01435
     C************         MOVELSTMT      P6STTP                          S01435
     C***********DNBC      IFEQ *ZERO                                     S01435
     C************         MOVE *BLANKS   P6DNBC                          S01435
     C************         ELSE                                           S01435
     C************         MOVELDNBC      P6DNBC                          S01435
     C************         END                                            S01435
     C************         MOVELSNMT      P6SNMT                          S01435
     C************         MOVELADDC      P6ADDC                          S01435
     C************         MOVELRPAY      P6RPAY                          S01435
     C************         MOVELPAYF      P6PAYF                          S01435
     C************         MOVELDYIM      P6DYIM                          S01435
     C************         MOVELDTCH      P6DTCH                          S01435
     C************         MOVELTRCT      P6TRCT                          S01435
     C*********************MOVELSWPC      P6SWPC                          S01117
     C***FORMAT*SWIFT PRIORITY CODE                                       S01117
     C************                                                        S01117
     C***********SWPC      IFEQ 1                                         S01117
     C************         MOVE 'U'       P6SWPC                          S01117
     C************         ELSE                                           S01117
     C***********SWPC      IFEQ 2                                         S01117
     C************         MOVE 'N'       P6SWPC                          S01117
     C************         END                                            S01117
     C************         END                                            S01117
     C************                                                        S01435
     C***TRANSFER*DATA TO PRINTER                                         S01435
     C************                                                        S01435
     C************         MOVE RLPR      P6RLPR                          S01435
     C***********CHAP      IFEQ *ZERO                                     S01435
     C************         MOVE *BLANKS   P6CHAP                          S01435
     C************         ELSE                                           S01435
     C************         Z-ADDCHAP      P#CHAP  60                      S01435
     C************         MOVELP#CHAP    P6CHAP                          S01435
     C************         END                                            S01435
     C************         MOVELINB1      P6INB1                          S01435
     C************         MOVELINB2      P6INB2                          S01435
     C************         MOVELINB3      P6INB3                          S01435
     C************         MOVELINB4      P6INB4                          S01435
     C************         MOVELINB5      P6INB5                          S01435
     ******************************************************************   S01435
     C************                                                        S01435
     C***EDIT**SNCO, ORBK AND CDRO  FOR OUTPUT                            S01435
     C************                                                        S01435
     C************         MOVE SNCT      PRMTYP  1        ( SNCO )       S01435
     C************         MOVE *ZEROS    PRMFLD 12                       S01435
     C************         MOVELSNCO      PRMFLD                          S01435
     C************         EXSR CHOPF                                     S01435
     C************         MOVELPRMFLD    P6SNCO                          S01435
     C************                                                        S01435
     C************         MOVE ORBT      PRMTYP           ( ORBK )       S01435
     C************         MOVE *ZEROS    PRMFLD                          S01435
     C************         MOVELORBK      PRMFLD                          S01435
     C************         EXSR CHOPF                                     S01435
     C************         MOVELPRMFLD    P6ORBK                          S01435
     C************         MOVE ORBB      P6ORBB                          S01117
     C************                                                        S01435
     C************         MOVE CDRT      PRMTYP           ( CDRO )       S01435
     C************         MOVE *ZEROS    PRMFLD                          S01435
     C************         MOVELCDRO      PRMFLD                          S01435
     C************         EXSR CHOPF                                     S01435
     C************         MOVELPRMFLD    P6CDRO                          S01435
     C************         MOVE CDBR      P6CDBR                          S01117
      *                                                                   S01435
      * Set Up Ordering Institution Details                               S01435
      *                                                                   S01435
     C                     MOVEL*BLANKS   P6OBDS                          S01435
     C                     MOVEL*BLANKS   P6ORBK                          S01435
     C           OPORB1    IFNE *BLANKS                                   S01435
      *                                                                   S01435
      * If SWIFT type A translate else leave as on message                S01435
      *                                                                   S01435
     C                     MOVEL#IMSG     P6ORBK                          S01435
     C           OPORBT    IFNE 'S'                                       S01435
     C                     MOVELOPORB1    P6ORB1                          S01435
     C                     MOVELOPORB2    P6ORB2                          S01435
     C                     MOVELOPORB3    P6ORB3                          S01435
     C                     MOVELOPORB4    P6ORB4                          S01435
     C                     MOVELOPORB5    P6ORB5                          S01435
     C                     ELSE                                           S01435
     C                     MOVEL'ORBT'    XCALL                           S01435
     C                     MOVELOPORBT    XTYPE                           S01435
     C                     MOVEL*BLANKS   XNAMDS                          S01435
     C                     MOVELOPORB1    ##001   1                       S01435
     C           ##001     IFEQ '/'                                       S01435
     C                     MOVELOPORB2    XNAMDS                          S01435
     C                     ELSE                                           S01435
     C                     MOVELOPORB1    XNAMDS                          S01435
     C                     END                                            S01435
     C                     EXSR GETADD                                    S01435
     C                     MOVELXNAMDS    P6OBDS                          S01435
     C                     END                                            S01435
     C                     END                                            S01435
      *                                                                   S01435
      * Translate input account with bank                                 S01435
      *                                                                   S01435
     C           ORBT      IFNE *BLANKS                                   S01435
     C                     MOVEL'ORBT'    XCALL                           S01435
     C                     MOVELORBT      XTYPE                           S01435
     C                     MOVELSMCY      XCCY                            S01435
     C                     MOVEL*BLANKS   XNAMDS                          S01435
     C                     MOVELORBK      P6ORBK                          S01435
     C                     MOVE ORBB      P6ORBK                          S01435
     C                     MOVELP6ORBK    XNAMDS                          S01435
     C/COPY WNCPYSRC,FT1010C046
     C                     EXSR GETADD                                    S01435
     C           OPORB1    IFEQ *BLANKS                                   S01435
     C                     MOVELXADDS     P6OBDS                          S01435
     C                     END                                            S01435
     C                     MOVELXNAMDS    P6ORBK                          S01435
     C                     END                                            S01435
      *                                                                   S01435
      ** INTERMEDIARY BANK                                                S01435
      *                                                                   S01435
     C                     MOVEL'INBT'    XCALL   4                       S01435
     C                     MOVELINBT      XTYPE                           S01435
     C                     MOVELININDS    XNAMDS                          S01435
     C                     EXSR GETADD                                    S01435
     C                     MOVELXNAMDS    P6INDS                          S01435
      *                                                                   S01435
      ** RECEIVER'S CORRESPONDENT                                         S01435
      *                                                                   S01435
     C                     MOVE 'RCRT'    XCALL   4                       S01435
     C                     MOVELRCRT      XTYPE                           S01435
     C                     MOVELRCINDS    XNAMDS                          S01435
     C                     EXSR GETADD                                    S01435
     C                     MOVELXNAMDS    P6RCDS                          S01435
      *                                                                   S01435
      ** ORDERING CUSTOMER                                                S01435
      *                                                                   S01435
     C                     MOVE 'ORCT'    XCALL   4                       S01435
     C                     MOVELSMCY      XCCY                            S01435
     C                     MOVELORCT      XTYPE                           S01435
     C                     MOVELORINDS    XNAMDS                          S01435
     C                     EXSR GETADD                                    S01435
     C                     MOVELXNAMDS    P6ORDS                          S01435
      *                                                                   S01435
      ** RECEIVING BANK                                                   S01435
      *                                                                   S01435
     C                     MOVE 'DSTT'    XCALL   4                       S01435
     C                     MOVELDSTT      XTYPE                           S01435
     C                     MOVELDSINDS    XNAMDS                          S01435
     C                     EXSR GETADD                                    S01435
     C                     MOVELXNAMDS    P6DSDS                          S01435
      *                                                                   S01435
      ** ACCOUNT WITH BANK                                                S01435
      *                                                                   S01435
     C                     MOVE 'ACBT'    XCALL   4                       S01435
     C                     MOVELACBT      XTYPE                           S01435
     C                     MOVELACINDS    XNAMDS                          S01435
     C                     EXSR GETADD                                    S01435
     C                     MOVELXNAMDS    P6ACDS                          S01435
      *                                                                   S01435
      ** BENEFICIARY CUSTOMER                                             S01435
      *                                                                   S01435
     C                     MOVE 'BNCT'    XCALL   4                       S01435
     C                     MOVELBNCT      XTYPE                           S01435
     C                     MOVELBNINDS    XNAMDS                          S01435
     C                     EXSR GETADD                                    S01435
     C                     MOVELXNAMDS    P6BNDS                          S01435
      *                                                                   S01435
     C                     MOVE *BLANKS   XCALL   4                       S01435
     C*                                                                   S01435
     C** FORMAT SETTLE & PAY AMOUNTS                                      S01435
     C*                                                                   S01435
     C** CALL UATBCN TO ACCESS CURRENCY RECORD FOR SETTLE CURRENCY        S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   ZTABKY                          S01435
     C                     MOVEL'20'      ZTABKY                          S01435
     C                     MOVELSMCY      WA4                             S01435
     C                     MOVE '1'       WA4                             S01435
     C                     MOVE WA4       ZTABKY                          S01435
     C                     EXSR UATBCN                                    S01435
     C*                                                                   S01435
     C** CHECK IF DATABASE ERROR OCCURRED                                 S01435
     C*                                                                   S01435
     C           *IN89     IFEQ '1'                                       S01435
     C                     MOVEL'TABLE'   WBFILE                          S01435
     C                     MOVELZTABKY    WBKEY                           S01435
     C                     MOVEL'54'      WBASE                           S01435
     C                     EXSR ABORT                      *ABORT PGM*    S01435
     C                     END                                            S01435
     C*                                                                   S01435
     C** STORE NUMBER OF DECIMAL PLACES FOR SETTLE CURRENCY               S01435
     C*                                                                   S01435
     C                     Z-ADDCDP       SVSCDP  10                      S01435
     C*                                                                   S01435
     C** FORMAT SETTLE AMOUNT                                             S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN  15                       S01435
     C                     MOVE SMAM      WFDIN                           S01435
     C                     Z-ADDSVSCDP    WDEC    10                      S01435
     C           13        SUB  SVSCDP    WDIG    20                      S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P6SMAM                          S01435
     C*                                                                   S01435
     C** CALL UATBCN TO ACCESS CURRENCY RECORD FOR PAY CURRENCY           S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   ZTABKY                          S01435
     C                     MOVEL'20'      ZTABKY                          S01435
     C                     MOVELPCCY      WA4                             S01435
     C                     MOVE '1'       WA4                             S01435
     C                     MOVE WA4       ZTABKY                          S01435
     C                     EXSR UATBCN                                    S01435
     C*                                                                   S01435
     C** CHECK IF DATABASE ERROR OCCURRED                                 S01435
     C*                                                                   S01435
     C           *IN89     IFEQ '1'                                       S01435
     C                     MOVEL'TABLE'   WBFILE                          S01435
     C                     MOVELZTABKY    WBKEY                           S01435
     C                     MOVEL'55'      WBASE                           S01435
     C                     EXSR ABORT                      *ABORT PGM*    S01435
     C                     END                                            S01435
     C*                                                                   S01435
     C** STORE NUMBER OF DECIMAL PLACES FOR PAY CURRENCY                  S01435
     C*                                                                   S01435
     C                     Z-ADDCDP       SVPCDP  10                      S01435
     C*                                                                   S01435
     C** FORMAT PAY AMOUNT                                                S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE PYAM      WFDIN                           S01435
     C                     Z-ADDSVPCDP    WDEC                            S01435
     C           13        SUB  SVPCDP    WDIG                            S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P6PYAM                          S01435
      *                                                                   CFT014
      ** Format Instructed amount considering the Instructed currency.    CFT014
      *                                                                   CFT014
     C                     MOVE *OFF      *IN41                           CFT014
     C           CEU006    IFEQ 'Y'                                       CFT014
     C           CFT014    OREQ 'Y'                                       CFT014
      *                                                                   CFT014
     C                     MOVE *BLANKS   P6PDAM                          CFT014
     C                     MOVE *BLANKS   P6PDCY                          CFT014
     C           PDAM      IFNE 0                                         CFT014
     C                     MOVE *ON       *IN41                           CFT014
     C                     CALL 'AOCURRR0'                                CFT014
     C                     PARM *BLANKS   WRTCD                           CFT014
     C                     PARM '*KEY   ' WOPTN                           CFT014
     C                     PARM PDCY      WCCY                            CFT014
     C           SDCURR    PARM SDCURR    DSSDY                           CFT014
     C           WRTCD     IFNE *BLANKS                                   CFT014
     C                     Z-ADD15        WBASE            ************   CFT014
     C                     MOVELPDCY      WBKEY            * DBERR015 *   CFT014
     C                     MOVEL'SDCURRPD'WBFILE           ************   CFT014
     C                     EXSR ABORT                                     CFT014
     C                     ENDIF                                          CFT014
     C                     Z-ADDA6NBDP    WPDNDP                          CFT014
      *                                                                   CFT014
     C                     MOVEL*BLANKS   WFDIN                           CFT014
     C                     MOVE PDAM      WFDIN                           CFT014
     C                     Z-ADDA6NBDP    WDEC                            CFT014
     C           13        SUB  A6NBDP    WDIG                            CFT014
     C                     EXSR UGFRMT                                    CFT014
     C                     MOVE PDCY      P6PDCY                          CFT014
     C                     MOVE WFDOUT    P6PDAM                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                                       CFT120
      ** Retrieve currency details                                                            CFT120
      *                                                                                       CFT120
     C           CFT120    IFEQ 'Y'                                                           CFT120
     C                     Z-ADD0         SVOCDP  10                                          CFT120
      *                                                                                       CFT120
     C           OPCDRC    IFNE *BLANKS                                                       CFT120
     C                     CALL 'AOCURRR0'                                                    CFT120
     C                     PARM *BLANKS   @RTCD                                               CFT120
     C                     PARM '*KEY   ' @OPTN                                               CFT120
     C                     PARM OPCDRC    @CURR                                               CFT120
     C           SDCURR    PARM SDCURR    DSSDY                                               CFT120
      *                                                                                       CFT120
     C           @RTCD     IFNE *BLANKS                                                       CFT120
     C                     MOVE 'SDCURRPD'WBFILE                                              CFT120
     C                     MOVELOPCDRC    WBKEY                                               CFT120
     C                     Z-ADD64        WBASE                                               CFT120
     C                     EXSR ABORT                                                         CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
     C                     Z-ADDA6NBDP    SVOCDP  10                                          CFT120
     C                     ENDIF                                                              CFT120
     C                     ENDIF                                                              CFT120
     C*                                                                   S01435
     C** FORMAT OTHER AMOUNTS & CURRENCIES                                S01435
     C** IF CHARGES TO DEBIT A/C FIELD IS NON-ZERO USE BASE CURRENCY;     S01435
     C** OTHERWISE IF PAY PLUS CHARGES INDICATOR IS 'Y' USE SETTLE CCY;   S01435
     C** OTHERWISE USE PAY CURRENCY                                       S01435
     C*                                                                   S01435
     C***********CDRO      IFNE *ZERO                                                  S01435 CSD027
     C           CDRO      IFNE *BLANKS                                                       CSD027
      *                                                                                       CFT120
     C                     MOVELBCCY      WCCY    3                       S01435
     C                     Z-ADDSVBCDP    WDEC                            S01435
     C           OPCDRC    IFNE *BLANKS                                                       CFT120
     C           CFT120    ANDEQ'Y'                                                           CFT120
     C                     MOVE OPCDRC    WCCY                                                CFT120
     C                     Z-ADDSVOCDP    WDEC                                                CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
     C/COPY WNCPYSRC,FT1010C010
     C                     ELSE                                           S01435
     C           ADDC      IFEQ 'A'                                       S01435
     C                     MOVELSMCY      WCCY                            S01435
     C                     Z-ADDSVSCDP    WDEC                            S01435
     C                     ELSE                                           S01435
     C                     MOVELPCCY      WCCY                            S01435
     C                     Z-ADDSVPCDP    WDEC                            S01435
     C                     END                                            S01435
     C                     END                                            S01435
      *                                                                   CFT014
     C           CFT003    IFEQ 'CFT003'                                  192300
     C           CFT014    OREQ 'Y'                                       192300
     C           CFT009    OREQ 'Y'                                       192300
      *                                                                   192300
     C           PREF      CHAINOTPAYXL0             79                   CFT014
      *                                                                   CFT014
     C                     Z-ADD0         P6OEXR                          CFT014
     C                     MOVE *BLANKS   P6BOCD                          CFT014
     C                     MOVE *BLANKS   P6TTCD                          CFT014
     C                     MOVE *BLANKS   P6TRDS                          CFT014
     C                     MOVE *BLANKS   P6ICD1                          CFT014
     C                     MOVE *BLANKS   P6ICD2                          CFT014
     C                     MOVE *BLANKS   P6ICD3                          CFT014
     C                     MOVE *BLANKS   P6ICD4                          CFT014
     C                     MOVE *BLANKS   P6ICD5                          CFT014
     C                     MOVE *BLANKS   P6RRP1                          CFT014
     C                     MOVE *BLANKS   P6RRP2                          CFT014
     C                     MOVE *BLANKS   P6RRP3                          CFT014
     C                     MOVE *BLANKS   P6RCRM                          CFT014
     C                     MOVE *BLANKS   P6SCH1                          CFT014
     C                     MOVE *BLANKS   P6SCH2                          CFT014
     C                     MOVE *BLANKS   P6SCH3                          CFT014
     C                     MOVE *BLANKS   P6SCH4                          CFT014
     C                     MOVE *BLANKS   P6SCH5                          CFT014
      *                                                                   CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
      *                                                                   CFT014
     C           *IN79     IFEQ *ON                                       CFT014
     C                     Z-ADD14        WBASE            ************   CFT014
     C                     MOVELPREF      WBKEY            * DBERR014 *   CFT014
     C                     MOVEL'OTPAYXL0'WBFILE           ************   CFT014
     C                     EXSR ABORT                                     CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     CALL 'AOCURRR0'                                CFT014
     C                     PARM *BLANKS   WRTCD                           CFT014
     C                     PARM '*KEY   ' WOPTN                           CFT014
     C                     PARM PCCY      WCCY                            CFT014
     C           SDCURR    PARM SDCURR    DSSDY                           CFT014
     C           WRTCD     IFNE *BLANKS                                   CFT014
     C                     Z-ADD13        WBASE            ************   CFT014
     C                     MOVELPCCY      WBKEY            * DBERR013 *   CFT014
     C                     MOVEL'SDCURRPD'WBFILE           ************   CFT014
     C                     EXSR ABORT                                     CFT014
     C                     ENDIF                                          CFT014
     C                     Z-ADDA6NBDP    WPYNDP                          CFT014
      *                                                                   CFT014
     C                     Z-ADDOPOEXR    P6OEXR                          CFT014
     C                     MOVELOPBOCD    P6BOCD                          CFT014
     C                     MOVELOPTTCD    P6TTCD                          CFT014
      ** Third Reimbursement Institution                                  CFT014
     C           OPTRI1    IFNE *BLANKS                                   CFT014
     C           OPTRI2    ORNE *BLANKS                                   CFT014
     C           OPTRI3    ORNE *BLANKS                                   CFT014
     C           OPTRI4    ORNE *BLANKS                                   CFT014
     C           OPTRI5    ORNE *BLANKS                                   CFT014
     C                     MOVEL'RCRT'    XCALL                           CFT014
     C                     MOVELOPTRIT    XTYPE                           CFT014
     C                     MOVELSMCY      XCCY                            CFT014
     C                     MOVELOPTRI1    P6TRI1                          CFT014
     C                     MOVELOPTRI2    P6TRI2                          CFT014
     C                     MOVELOPTRI3    P6TRI3                          CFT014
     C                     MOVELOPTRI4    P6TRI4                          CFT014
     C                     MOVELOPTRI5    P6TRI5                          CFT014
     C                     MOVELP6TRDS    XNAMDS                          CFT014
     C                     EXSR GETADD                                    CFT014
     C                     MOVELXNAMDS    P6TRDS                          CFT014
     C                     ENDIF                                          CFT014
      ** Instruction code                                                 CFT014
     C                     MOVELOPICD1    P6ICD1                          CFT014
     C                     MOVELOPICD2    P6ICD2                          CFT014
     C                     MOVELOPICD3    P6ICD3                          CFT014
     C                     MOVELOPICD4    P6ICD4                          CFT014
     C                     MOVELOPICD5    P6ICD5                          CFT014
      ** Regulatory reporting                                             CFT014
     C                     MOVELOPRRP1    P6RRP1                          CFT014
     C                     MOVELOPRRP2    P6RRP2                          CFT014
     C                     MOVELOPRRP3    P6RRP3                          CFT014
      ** Receiver's charges                                               CFT014
     C                     Z-ADDWPYNDP    WDEC                            CFT014
     C           11        SUB  WPYNDP    WDIG                            CFT014
     C           OPRCRM    IFNE 0                                         CFT014
     C                     MOVEL*BLANKS   WFDIN                           CFT014
     C                     MOVE OPRCRM    WFDIN                           CFT014
     C                     EXSR UGFRMT                                    CFT014
     C                     MOVE *BLANKS   WCHR15                          CFT014
     C                     MOVE WFDOUT    WCHR15                          CFT014
     C                     MOVELWCHR15    P6RCRM                          CFT014
     C                     MOVE PCCY      P6RCRM                          CFT014
     C                     ENDIF                                          CFT014
      ** Sender's charges                                                 CFT014
     C           OPSCH1    IFNE 0                                         CFT014
     C                     MOVEL*BLANKS   WFDIN                           CFT014
     C                     MOVE OPSCH1    WFDIN                           CFT014
     C                     EXSR UGFRMT                                    CFT014
     C                     MOVE *BLANKS   WCHR15                          CFT014
     C                     MOVE WFDOUT    WCHR15                          CFT014
     C                     MOVELWCHR15    P6SCH1                          CFT014
     C                     MOVE PCCY      P6SCH1                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           OPSCH2    IFNE 0                                         CFT014
     C                     MOVEL*BLANKS   WFDIN                           CFT014
     C                     MOVE OPSCH2    WFDIN                           CFT014
     C                     EXSR UGFRMT                                    CFT014
     C                     MOVE *BLANKS   WCHR15                          CFT014
     C                     MOVE WFDOUT    WCHR15                          CFT014
     C                     MOVELWCHR15    P6SCH2                          CFT014
     C                     MOVE PCCY      P6SCH2                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           OPSCH3    IFNE 0                                         CFT014
     C                     MOVEL*BLANKS   WFDIN                           CFT014
     C                     MOVE OPSCH3    WFDIN                           CFT014
     C                     EXSR UGFRMT                                    CFT014
     C                     MOVE *BLANKS   WCHR15                          CFT014
     C                     MOVE WFDOUT    WCHR15                          CFT014
     C                     MOVELWCHR15    P6SCH3                          CFT014
     C                     MOVE PCCY      P6SCH3                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           OPSCH4    IFNE 0                                         CFT014
     C                     MOVEL*BLANKS   WFDIN                           CFT014
     C                     MOVE OPSCH4    WFDIN                           CFT014
     C                     EXSR UGFRMT                                    CFT014
     C                     MOVE *BLANKS   WCHR15                          CFT014
     C                     MOVE WFDOUT    WCHR15                          CFT014
     C                     MOVELWCHR15    P6SCH4                          CFT014
     C                     MOVE PCCY      P6SCH4                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           OPSCH5    IFNE 0                                         CFT014
     C                     MOVEL*BLANKS   WFDIN                           CFT014
     C                     MOVE OPSCH5    WFDIN                           CFT014
     C                     EXSR UGFRMT                                    CFT014
     C                     MOVE *BLANKS   WCHR15                          CFT014
     C                     MOVE WFDOUT    WCHR15                          CFT014
     C                     MOVELWCHR15    P6SCH5                          CFT014
     C                     MOVE PCCY      P6SCH5                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           OPSCH1    IFEQ 0                                         CFT014
     C           OPSCH2    ANDEQ0                                         CFT014
     C           OPSCH3    ANDEQ0                                         CFT014
     C           OPSCH4    ANDEQ0                                         CFT014
     C           OPSCH5    ANDEQ0                                         CFT014
     C           DTCH      ANDEQ'BEN'                                     CFT014
     C                     MOVEL*BLANKS   WFDIN                           CFT014
     C                     MOVE *ZERO     WFDIN                           CFT014
     C                     EXSR UGFRMT                                    CFT014
     C                     MOVE *BLANKS   WCHR15                          CFT014
     C                     MOVE WFDOUT    WCHR15                          CFT014
     C                     MOVELWCHR15    P6SCH1                          CFT014
     C                     MOVE PCCY      P6SCH1                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           *IN79     IFEQ *OFF                                      CFT014
     C                     DELETOTPAYXDF                                  CFT014
     C                     ENDIF                                          CFT014
     C*                                                                   S01435
     C                     ENDIF                                          192300
      *                                                                   192300
     C           11        SUB  WDEC      WDIG                            S01435
     C*                                                                   S01435
     C** SETUP CURRENCY NAMES                                             S01435
     C*                                                                   S01435
     C                     MOVELWCCY      P6TRCY                          S01435
     C                     MOVELWCCY      P6TXCY                          S01435
     C                     MOVELWCCY      P6CQCY                          S01435
     C                     MOVELWCCY      P6SPCY                          S01435
     C                     MOVELWCCY      P6CSCY                          S01435
     C                     MOVELWCCY      P6MSCY                          S01435
      *                                                                   CFT009
      ** Charges currency                                                 CFT009
      *                                                                   CFT009
     C                     MOVE OPCHGC    TCCHGC                          CFT009
     C                     MOVE OPCHGC    FXCGCY                          CFT009
     C                     MOVE OPCHGC    CQCHGC                          CFT009
     C                     MOVE OPCHGC    CACHGC                          CFT009
     C                     MOVE OPCHGC    TXCHGC                          CFT009
     C                     MOVE OPCHGC    SPCHGC                          CFT009
     C                     MOVE OPCHGC    SSCHGC                          CFT009
     C                     MOVE OPCHGC    M0CHGC                          CFT009
     C                     MOVE OPCHGC    M1CHGC                          CFT009
     C                     MOVE OPCHGC    M2CHGC                          CFT009
     C                     MOVE OPCHGC    M3CHGC                          CFT009
     C                     MOVE OPCHGC    M4CHGC                          CFT009
     C                     MOVE OPCHGC    M5CHGC                          CFT009
     C                     MOVE OPCHGC    VTCHGC                          CFT009
     C*                                                                   S01494
     C** Check if SAR S01494 is set on                                    S01494
     C*                                                                   S01494
     C           *IN29     IFEQ '1'                                       S01494
     C                     MOVELWCCY      P6CHCY                          S01494
     C                     END                                            S01494
     C*                                                                   S01499
     C** Check if SAR S01499 is set on                                    S01499
     C*                                                                   S01499
     C           *IN39     IFEQ '1'                                       S01499
     C*                                                                   S01499
     C                     MOVELWCCY      P6VTCY                          S01499
     C*                                                                   S01499
     C** Set up VAT flags for report                                      S01499
     C*                                                                   S01499
     C                     MOVE OPVAT1    P6TRVF                          S01499
     C                     MOVE OPVAT2    P6TXVF                          S01499
     C                     MOVE OPVAT3    P6CQVF                          S01499
     C                     MOVE OPVAT4    P6CSVF                          S01499
     C                     MOVE OPVAT5    P6SPVF                          S01499
     C                     MOVE OPVAT6    P6MSVF                          S01499
     C           *IN29     IFEQ '1'                                       S01499
     C                     MOVE OPVAT7    P6CHVF                          S01499
     C                     END                                            S01499
     C*                                                                   S01499
     C                     END                                            S01499
     C*                                                                   S01435
     C** FORMAT TRANSFER COMMISSION AMOUNT                                S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE TRCM      WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P6TRCM                          S01435
     C*                                                                   S01435
     C** FORMAT TELEX CHARGE AMOUNT                                       S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE TXCH      WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P6TXCH                          S01435
     C*                                                                   S01435
     C** FORMAT CHEQUE CHARGE AMOUNT                                      S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE CQCH      WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P6CQCH                          S01435
     C*                                                                   S01435
     C** FORMAT SWIFT PR CHARGE AMOUNT                                    S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE SPCH      WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P6SPCH                          S01435
     C*                                                                   S01435
     C** FORMAT COSTS ABROAD CHARGE AMOUNT                                S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE CSTA      WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P6CSTA                          S01435
     C*                                                                   S01435
     C** FORMAT MISCELLANEOUS CHARGE AMOUNT                               S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C                     MOVE MSCH      WFDIN                           S01435
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P6MSCH                          S01435
     C*                                                                   S01494
     C** Check if SAR S01494 is set on                                    S01494
     C*                                                                   S01494
     C           *IN29     IFEQ '1'                                       S01494
     C*                                                                   S01494
     C** Format FX/Change Commission                                      S01494
     C*                                                                   S01494
     C                     MOVEL*BLANKS   WFDIN                           S01494
     C                     MOVE OPCHCM    WFDIN                           S01494
     C                     EXSR UGFRMT                                    S01494
     C                     MOVE WFDOUT    P6CHCM                          S01494
     C*                                                                   S01494
     C                     END                                            S01494
     C*                                                                   S01499
     C** Check if SAR S01499 is set on                                    S01499
     C*                                                                   S01499
     C           *IN39     IFEQ '1'                                       S01499
     C*                                                                   S01499
     C** Format V.A.T. Charge                                             S01499
     C*                                                                   S01499
     C                     MOVEL*BLANKS   WFDIN                           S01499
     C                     MOVE OPVATT    WFDIN                           S01499
     C                     EXSR UGFRMT                                    S01499
     C                     MOVE WFDOUT    P6VATT                          S01499
     C*                                                                   S01499
     C                     END                                            S01499
     C*                                                                   S01435
     C** FORMAT DATE FIELDS USING SYSTEM ROUTINE ZDATE2                   S01435
     C*                                                                   S01435
     C** SETTLE VALUE DATE                                                S01435
     C*                                                                   S01435
     C                     Z-ADDSLDT      ZDAYNO                          S01435
     C                     EXSR ZDATE2                                    S01435
     C                     MOVELZADATE    P6SLDT                          S01435
     C*                                                                   S01435
     C** PAY VALUE DATE                                                   S01435
     C*                                                                   S01435
     C                     Z-ADDPVDT      ZDAYNO                          S01435
     C                     EXSR ZDATE2                                    S01435
     C                     MOVELZADATE    P6PYDT                          S01435
     C*                                                                   S01435
     C** FINAL DATE                                                       S01435
     C*                                                                   S01435
     C                     Z-ADDFDAT      ZDAYNO                          S01435
     C                     EXSR ZDATE2                                    S01435
     C                     MOVELZADATE    P6FDAT                          S01435
     C*                                                                   S01435
     C                     Z-ADDNPDT      ZDAYNO                          S01435
     C                     EXSR ZDATE2                                    S01435
     C                     MOVELZADATE    P6NPDT                          S01435
     C*                                                                   S01435
     C** SET UP USER FIELDS FROM MUSERDD,IF AUDIT                         S01435
     C*                                                                   S01435
     C                     SETOF                     50                   S01435
     C*                                                                   S01435
     C           INUSR1    IFNE *BLANKS                                   S01435
     C                     MOVE INUSR1    USRP                            S01435
     C                     EXSR UCMUSE                                    S01435
     C                     MOVE USER1     SIUSR1 25                       S01435
     C                     ELSE                                           S01435
     C                     MOVE *BLANKS   SIUSR1                          S01435
     C                     END                                            S01435
      *                                                                   S01435
     C           INUSR2    IFNE *BLANKS                                   S01435
     C                     MOVE INUSR2    USRP                            S01435
     C                     EXSR UCMUSE                                    S01435
     C                     MOVE USER1     SIUSR2 25                       S01435
     C                     ELSE                                           S01435
     C                     MOVE *BLANKS   SIUSR2                          S01435
     C                     END                                            S01435
      *                                                                   S01435
     C           AUP1      IFNE *BLANKS                                   S01435
     C                     MOVE AUP1      USRP                            S01435
     C                     EXSR UCMUSE                                    S01435
     C                     MOVE USER1     SAUP1  25                       S01435
     C                     ELSE                                           S01435
     C                     MOVE *BLANKS   SAUP1                           S01435
     C                     END                                            S01435
      *                                                                   S01435
     C           AUP2      IFNE *BLANKS                                   S01435
     C                     MOVE AUP2      USRP                            S01435
     C                     EXSR UCMUSE                                    S01435
     C                     MOVE USER1     SAUP2  25                       S01435
     C                     ELSE                                           S01435
     C                     MOVE *BLANKS   SAUP2                           S01435
     C                     END                                            S01435
      *                                                                   S01435
     C** SETUP REMAINING REPORT FIELDS                                    S01435
     C*                                                                   S01435
     C                     MOVELPREF      P6PREF                          S01435
     C                     MOVELPYTP      P6PYTP                          S01435
     C                     MOVELPYST      P6PYST                          S01435
     C                     MOVELSMCY      P6SMCY                          S01435
     C                     Z-ADDRATE      P6RATE                          S01435
     C                     MOVELPCCY      P6PCCY                          S01435
     C                     MOVELBBI1      P6BBI1                          S01435
     C                     MOVELBBI2      P6BBI2                          S01435
     C                     MOVELBBI3      P6BBI3                          S01435
     C                     MOVELBBI4      P6BBI4                          S01435
     C                     MOVELBBI5      P6BBI5                          S01435
     C                     MOVELBBI6      P6BBI6                          S01435
     C                     MOVELDTP1      P6DTP1                          S01435
     C                     MOVELDTP2      P6DTP2                          S01435
     C                     MOVELDTP3      P6DTP3                          S01435
     C                     MOVELDTP4      P6DTP4                          S01435
     C                     MOVELSTMT      P6STTP                          S01435
     C/COPY WNCPYSRC,FT1010C025
     C           DNBC      IFEQ *ZERO                                     S01435
     C/COPY WNCPYSRC,FT1010C026
     C                     MOVE *BLANKS   P6DNBC                          S01435
     C                     ELSE                                           S01435
     C                     MOVELDNBC      P6DNBC                          S01435
     C                     END                                            S01435
     C                     MOVELSNMT      P6SNMT                          S01435
     C                     MOVELADDC      P6ADDC                          S01435
     C                     MOVELRPAY      P6RPAY                          S01435
     C                     MOVELPAYF      P6PAYF                          S01435
     C                     MOVELDYIM      P6DYIM                          S01435
     C                     MOVELDTCH      P6DTCH                          S01435
     C                     MOVELTRCT      P6TRCT                          S01435
     C           SWPC      IFEQ 1                          B001           S01435
     C                     MOVE 'U'       P6SWPC                          S01435
     C                     ELSE                            X001           S01435
     C           SWPC      IFEQ 2                          B002           S01435
     C                     MOVE 'N'       P6SWPC                          S01435
     C                     END                             E002           S01435
     C                     END                             E001           S01435
     C*                                                                   S01435
     C** OUPUT OVERRIDE IF 'Y'                                            S01435
     C*                                                                   S01435
     C                     MOVE *BLANKS   P6OVRD                          S01435
     C           OVRD      IFEQ 'Y'                                       S01435
     C                     MOVE 'YES'     P6OVRD                          S01435
     C                     ELSE                                           S01435
     C                     MOVE 'NO '     P6OVRD                          S01435
     C                     END                                            S01435
      *                                                                   S01435
     C           OXPREF    IFNE *BLANKS                                   S01435
     C                     SETON                     51                   S01435
     C                     ELSE                                           S01435
     C                     SETOF                     51                   S01435
     C                     END                                            S01435
      *                                                                   S01435
     ****The following lines were added to transfer data to printer****   S01435
     C                     MOVE RLPR      P6RLPR                          S01435
     C           CHAP      IFEQ *ZERO                                     S01435
     C                     MOVE *BLANKS   P6CHAP                          S01435
     C                     ELSE                                           S01435
     C                     MOVELCHAP      P6CHAP                          S01435
     C                     END                                            S01435
     C*                                                                   S01435
     C** MT100 customer                                                   S01435
     C*                                                                   S01435
     C           ODMT      IFEQ *BLANK                     B001           S01435
     C           ODMT      OREQ *ZERO                                     S01435
     C                     MOVE *BLANK    P6ODMT                          S01435
     C                     MOVE *BLANK    P6ODMC                          S01435
     C                     ELSE                            X001           S01435
      *                                                                                       CFT032
      ** Destination type is a full nostro 'F'                                                CFT032
      *                                                                                       CFT032
     C           ODMTT     IFEQ 'F'                                                           CFT032
     C           3         SUBSTODMT:1    PKEYB                                               CFT032
     C           2         SUBSTODMT:4    PKEYE                                               CFT032
      *                                                                                       CFT032
     C                     CALL 'AONOSTR0'                                                    CFT032
     C                     PARM *BLANK    PRTCD   7                                           CFT032
     C                     PARM '*KEY   ' POPTN   7                                           CFT032
     C                     PARM *BLANK    PKEYA   6                                           CFT032
     C                     PARM           PKEYB   3                                           CFT032
     C                     PARM *BLANK    PKEYC  10                                           CFT032
     C                     PARM *BLANK    PKEYD   2                                           CFT032
     C                     PARM           PKEYE   2                                           CFT032
     C                     PARM *BLANKS   PKEYG   3                                           CFT032
     C                     PARM *BLANKS   PKEYH  10                                           CFT032
     C                     PARM *BLANKS   PKEYI   1                                           CFT032
     C           SDNOST    PARM SDNOST    DSFDY                                               CFT032
      *                                                                                       CFT032
     C           PRTCD     IFNE *BLANKS                                                       CFT032
     C                     MOVEL'SDNOSTPD'WBFILE                                              CFT032
     C                     MOVELPKEYA     WBKEY                                               CFT032
     C                     Z-ADD47        WBASE                                               CFT032
     C                     EXSR ABORT                                                         CFT032
     C                     ENDIF                                                              CFT032
     C                     MOVELA7CUST    W0CNUM  6                                           CFT032
     C                     ENDIF                                                              CFT032
      *                                                                                       CFT032
      ** Destination type is a 'I'                                                            CFT032
      *                                                                                       CFT032
     C           ODMTT     IFEQ 'I'                                                           CFT032
     C                     MOVELODMT      P@IBN                                               CFT032
     C                     MOVE *BLANKS   DSSDY                                               CFT032
      *                                                                                       CFT032
     C                     CALL 'AOIBANR4'                                                    CFT032
     C                     PARM           PRTCD                                               CFT032
     C                     PARM '*KEY   ' POPTN                                               CFT032
     C                     PARM           P@IBN  34                                           CFT032
     C           WACCN     PARM           DSSDY                                               CFT032
      *                                                                                       CFT032
     C           @RTCD     IFNE *BLANKS                                                       CFT032
     C                     MOVEL'ACCNTL6' WBFILE                                              CFT032
     C                     MOVELP@IBN     WBKEY                                               CFT032
     C                     Z-ADD48        WBASE                                               CFT032
     C                     EXSR ABORT                                                         CFT032
     C                     ENDIF                                                              CFT032
     C                     MOVE WWCNUM    W0CNUM                                              CFT032
     C                     ENDIF                                                              CFT032
      *                                                                                       CFT032
      ** Destination type is a GL Account 'G'                                                 CFT032
      *                                                                                       CFT032
     C           ODMTT     IFEQ 'G'                                                           CFT032
     C           24        SUBSTODMT:1    WCDET                                               CFT032
     C                     MOVEL*BLANKS   PRETL  10                                           CFT032
     C                     MOVELWDCNUM    PCNNM   6                                           CFT032
     C                     MOVELWDCCY     PCUCD   3                                           CFT032
     C                     MOVELWDACOD    PACCD                                               CFT032
     C                     MOVELWDACSQ    PACSQ   2                                           CFT032
     C           MBIN      IFEQ 'Y'                                                           CFT032
     C                     MOVE WDBRCA    PBRCD   3                                           CFT032
     C                     ELSE                                                               CFT032
     C                     MOVE BJSBRC    PBRCD                                               CFT032
     C                     ENDIF                                                              CFT032
      *                                                                                       CFT032
     C                     CALL 'AOACCTR0'                                                    CFT032
     C                     PARM *BLANKS   PRTCD   7                                           CFT032
     C                     PARM '*KEY'    POPTN   7                                           CFT032
     C                     PARM           PRETL  10                                           CFT032
     C                     PARM           PCNNM   6                                           CFT032
     C                     PARM           PCUCD   3                                           CFT032
     C                     PARM           PACCD  10                                           CFT032
     C                     PARM           PACSQ   2                                           CFT032
     C                     PARM           PBRCD   3                                           CFT032
     C           SDACCT    PARM SDACCT    DSSDY                                               CFT032
      *                                                                                       CFT032
     C           PRTCD     IFNE *BLANKS                                                       CFT032
     C                     MOVEL'ACCNTAB' WBFILE                                              CFT032
     C                     MOVELPCNNM     WBKEY                                               CFT032
     C                     Z-ADD49        WBASE                                               CFT032
     C                     EXSR ABORT                                                         CFT032
     C                     ENDIF                                                              CFT032
     C                     MOVE CNUM      W0CNUM                                              CFT032
     C                     ENDIF                                                              CFT032
      *                                                                                     AR785953
      ** Destination type is a RE Account 'R'                                               AR785953
      *                                                                                     AR785953
     C           ODMTT     IFEQ 'R'                                                         AR785953
     C           18        SUBSTODMT:1    WCDET                                             AR785953
     C                     MOVELWCDET     PRETL                                             AR785953
      *                                                                                     AR785953
     C                     CALL 'AOACCTR0'                                                  AR785953
     C                     PARM *BLANKS   PRTCD                                             AR785953
     C                     PARM '*KEY'    POPTN                                             AR785953
     C                     PARM           PRETL                                             AR785953
     C                     PARM *BLANKS   PCNNM                                             AR785953
     C                     PARM *BLANKS   PCUCD                                             AR785953
     C                     PARM *BLANKS   PACCD                                             AR785953
     C                     PARM *BLANKS   PACSQ                                             AR785953
     C                     PARM *BLANKS   PBRCD                                             AR785953
     C           SDACCT    PARM SDACCT    DSSDY                                             AR785953
      *                                                                                     AR785953
     C           PRTCD     IFNE *BLANKS                                                     AR785953
     C                     MOVEL'ACCNTAB' WBFILE                                            AR785953
     C                     MOVELPRETL     WBKEY                                             AR785953
     C                     Z-ADD499       WBASE                                             AR785953
     C                     EXSR ABORT                                                       AR785953
     C                     ENDIF                                                            AR785953
     C                     MOVE CNUM      W0CNUM                                            AR785953
     C                     ENDIF                                                            AR785953
      *                                                                                       CFT032
      ** Destination type is a 'S'                                                            CFT032
      *                                                                                       CFT032
     C           ODMTT     IFEQ 'S'                                                           CFT032
     C           8         SUBSTODMT:1    W9BICC  8                                           CFT032
     C           3         SUBSTODMT:9    W9BICB  3                                           CFT032
      *                                                                                       CFT032
     C                     CALL 'ME1400'                                                      CFT032
     C                     PARM *BLANKS   W9RTN   7                                           CFT032
     C                     PARM           W9BICC                                              CFT032
     C                     PARM           W9BICB                                              CFT032
     C                     PARM           SDCUST                                              CFT032
     C                     PARM           SDCNST                                              CFT032
     C                     PARM           MEBICD                                              CFT032
     C                     PARM *BLANKS   W9CUST  1                                           CFT032
     C                     PARM *BLANKS   W9CNST  1                                           CFT032
     C                     PARM *BLANKS   W9BICD  1                                           CFT032
      *                                                                                       CFT032
     C           W9CUST    IFNE 'Y'                                                           CFT032
     C           W9BICD    ANDNE'Y'                                                           CFT032
     C                     MOVEL'ME1400 ' WBFILE                                              CFT032
     C                     MOVEL'*CALL   'WBKEY                                               CFT032
     C                     Z-ADD50        WBASE                                               CFT032
     C                     EXSR ABORT                                                         CFT032
     C                     ELSE                                                               CFT032
     C                     MOVE BBCUST    W0CNUM                                              CFT032
     C                     MOVELODMT      P6ODMT                                              CFT032
     C                     MOVELBDINS1    P6ODMC                                              CFT032
     C                     ENDIF                                                              CFT032
     C                     ENDIF                                                              CFT032
      *                                                                                       CFT032
      ** Destination type is a Customer Number 'C'                                            CFT032
      *                                                                                       CFT032
     C           ODMTT     IFEQ 'C'                                                           CFT032
     C                     MOVELODMT      W0CNUM                                              CFT032
     C                     ENDIF                                                              CFT032
      *                                                                                       CSW207
      ** Non Account Holder Reference                                                         CSW207
      *                                                                                       CSW207
     C           ODMTT     IFEQ 'O'                                                           CSW207
     C           CSW207    ANDEQ'Y'                                                           CSW207
     C                     CALL 'AONAHOR0'                                                    CSW207
     C                     PARM *BLANKS   @RTCD   7                                           CSW207
     C                     PARM '*KEY   ' @OPTN   7                                           CSW207
     C                     PARM ODMT      @NAHO  10                                           CSW207
     C           SDNAHO    PARM SDNAHO    DSSDY                                               CSW207
     C           @RTCD     IFNE *BLANKS                                                       CSW207
     C                     Z-ADD35        WBASE                                               CSW207
     C                     MOVELODMT      WBKEY                                               CSW207
     C                     MOVEL'SDNAHOPD'WBFILE                                              CSW207
     C                     EXSR ABORT                                                         CSW207
     C                     ENDIF                                                              CSW207
     C                     ENDIF                                                              CSW207
      *                                                                                       CFT032
     C**********           MOVELODMT      WCLNUM                                       S01435 CFT032
     C           ODMTT     IFNE 'O'                                                           CSW207
     C                     MOVELW0CNUM    WCLNUM                                              CFT032
     C                     MOVEL'B'       WCLRCT                          S01435
     C                     EXSR UCCLCN                                    S01435
     C*                                                                   S01435
     C           *IN89     IFEQ '1'                        B002           S01435
     C                     MOVEL'CLINT'   WBFILE                          S01435
     C                     MOVELWCLNUM    WA7              *************  S01435
     C                     MOVE WCLRCT    WA7              * DATA BASE *  S01435
     C                     MOVELWA7       WBKEY            * ERROR 19  *  S01435
     C                     MOVEL'61'      WBASE            *************  S01435
     C                     EXSR ABORT                      *ABORT PGM*    S01435
     C                     END                             E002           S01435
     C*                                                                   S01435
     C                     MOVELWA7       WA7     7                       S01435
     C                     MOVELODMT      P6ODMT                          S01435
     C                     MOVELCNA1      P6ODMC                          S01435
     C                     ELSE                                                               CSW207
     C                     MOVELODMT      P6ODMT                                              CSW207
     C                     MOVELNHCNA1    P6ODMC                                              CSW207
     C                     ENDIF                                                              CSW207
     C                     END                             E001           S01435
     C*                                                                   S01435
      *                                                                   S01435
      * Format Entered Currency                                           S01435
      *                                                                   S01435
     C                     SELEC                                          S01435
      *                                                                   S01435
     C***********CDRO      WHNE *ZERO                                                  S01435 CSD027
     C           CDRO      WHNE *BLANKS                                                       CSD027
     C           BTCHCY    OREQ 'B'                                       103513
     C           CFT120    ANDNE'Y'                                                           CFT120
      *                                                                                       CFT120
     C                     MOVELBCCY      WCCY                            S01435
     C                     Z-ADDSVBCDP    WDEC                            S01435
     C           OPCDRC    IFNE *BLANKS                                                       CFT120
     C           CFT120    ANDEQ'Y'                                                           CFT120
     C                     MOVELOPCDRC    WCCY                                                CFT120
     C                     Z-ADDSVOCDP    WDEC                                                CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
     C           BTCHCY    WHEQ 'B'                                                           CFT120
     C           CFT120    ANDEQ'Y'                                                           CFT120
     C                     MOVELBCCY      WCCY                                                CFT120
     C                     Z-ADDSVBCDP    WDEC                                                CFT120
      *                                                                                       CFT120
     C/COPY WNCPYSRC,FT1010C011
      *                                                                   S01435
     C           BTCHCY    WHEQ 'L'                                       S01435
     C                     MOVELLOCY      WCCY                            S01435
     C                     Z-ADDSVLCDP    WDEC                            S01435
      *                                                                   S01435
     C           BTCHCY    WHEQ 'C'                                       S01435
     C           ADDC      ANDEQ'A'                                       S01435
     C                     MOVELSMCY      WCCY                            S01435
     C                     Z-ADDSVSCDP    WDEC                            S01435
      *                                                                   S01435
     C                     OTHER                                          S01435
     C                     MOVELPCCY      WCCY                            S01435
     C                     Z-ADDSVPCDP    WDEC                            S01435
     C                     ENDSL                                          S01435
      *                                                                   S01435
     C                     MOVELWCCY      P6TREC                          S01435
     C                     MOVELWCCY      P6TXEC                          S01435
     C                     MOVELWCCY      P6CQEC                          S01435
     C                     MOVELWCCY      P6CSEC                          S01435
     C                     MOVELWCCY      P6SPEC                          S01435
     C                     MOVELWCCY      P6MSEC                          S01435
     C*                                                                   S01494
     C** Check if SAR S01494 is set on                                    S01494
     C*                                                                   S01494
     C           *IN29     IFEQ '1'                                       S01494
     C                     MOVELWCCY      P6CHEC                          S01494
     C                     END                                            S01494
     C*                                                                   S01499
     C** Check if SAR S01499 is set on                                    S01499
     C*                                                                   S01499
     C           *IN39     IFEQ '1'                                       S01499
     C                     MOVELWCCY      P6VTEC                          S01499
     C                     END                                            S01499
      *                                                                   S01435
      *  Format Entered Amounts                                           S01435
      *                                                                   S01435
     C           11        SUB  WDEC      WDIG                            S01435
      *                                                                   S01435
      ** Format Transfer Commission Amount                                S01435
      *                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C           CFT009    IFEQ 'Y'                                       CFT009
     C                     MOVE TRCM      WFDIN                           CFT009
     C                     ELSE                                           CFT009
     C                     MOVE DUMA1     WFDIN                           S01435
     C                     ENDIF                                          CFT009
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P6TREA                          S01435
      *                                                                   S01435
      ** Format Telex Charge Amount                                       S01435
      *                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C           CFT009    IFEQ 'Y'                                       CFT009
     C                     MOVE TXCH      WFDIN                           CFT009
     C                     ELSE                                           CFT009
     C                     MOVE DUMA2     WFDIN                           S01435
     C                     ENDIF                                          CFT009
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P6TXEA                          S01435
      *                                                                   S01435
      ** Format Cheque Charge Amount                                      S01435
      *                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C           CFT009    IFEQ 'Y'                                       CFT009
     C                     MOVE CQCH      WFDIN                           CFT009
     C                     ELSE                                           CFT009
     C                     MOVE DUMA3     WFDIN                           S01435
     C                     ENDIF                                          CFT009
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P6CQEA                          S01435
     C*                                                                   S01435
     C** Format Telephone Charge Amount                                   S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C           CFT009    IFEQ 'Y'                                       CFT009
     C                     MOVE CSTA      WFDIN                           CFT009
     C                     ELSE                                           CFT009
     C                     MOVE DUMA4     WFDIN                           S01435
     C                     ENDIF                                          CFT009
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P6CSEA                          S01435
     C*                                                                   S01435
     C** Format Advice Charge Amount                                      S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C           CFT009    IFEQ 'Y'                                       CFT009
     C                     MOVE SPCH      WFDIN                           CFT009
     C                     ELSE                                           CFT009
     C                     MOVE DUMA5     WFDIN                           S01435
     C                     ENDIF                                          CFT009
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P6SPEA                          S01435
     C*                                                                   S01435
     C** Format Miscellaneous Charge Amount                               S01435
     C*                                                                   S01435
     C                     MOVEL*BLANKS   WFDIN                           S01435
     C           CFT009    IFEQ 'Y'                                       CFT009
     C                     MOVE MSCH      WFDIN                           CFT009
     C                     ELSE                                           CFT009
     C                     MOVE DUMA6     WFDIN                           S01435
     C                     ENDIF                                          CFT009
     C                     EXSR UGFRMT                                    S01435
     C                     MOVE WFDOUT    P6MSEA                          S01435
     C*                                                                   S01494
     C** Check if SAR S01494 is set on                                    S01494
     C*                                                                   S01494
     C           *IN29     IFEQ '1'                                       S01494
     C*                                                                   S01494
     C** Format FX/Change Commission                                      S01494
     C*                                                                   S01494
     C                     MOVEL*BLANKS   WFDIN                           S01494
     C           CFT009    IFEQ 'Y'                                       CFT009
     C                     MOVE OPCHCM    WFDIN                           CFT009
     C                     ELSE                                           CFT009
     C                     MOVE OPDUM7    WFDIN                           S01494
     C                     ENDIF                                          CFT009
     C                     EXSR UGFRMT                                    S01494
     C                     MOVE WFDOUT    P6CHEA                          S01494
     C*                                                                   S01494
     C                     END                                            S01494
     C*                                                                   S01499
     C** Check if SAR S01499 is set on                                    S01499
     C*                                                                   S01499
     C           *IN39     IFEQ '1'                                       S01499
     C*                                                                   S01499
     C** Format V.A.T. Charge                                             S01499
     C*                                                                   S01499
     C                     MOVEL*BLANKS   WFDIN                           S01499
     C                     MOVE OPDUM8    WFDIN                           S01499
     C                     EXSR UGFRMT                                    S01499
     C                     MOVE WFDOUT    P6VAEA                          S01499
     C*                                                                   S01499
     C                     END                                            S01499
      *                                                                   S01435
      * Translate input Sender's Correspondent                            S01435
      *                                                                   S01435
     C                     MOVEL'SNCT'    XCALL                           S01435
     C                     MOVELSNCT      XTYPE                           S01435
     C                     MOVELPCCY      XCCY                            S01435
     C                     MOVEL*BLANKS   XNAMDS                          S01435
     C                     MOVELSNCO      XNAMDS                          S01435
     C                     EXSR GETADD                                    S01435
     C                     MOVELXNAMDS    P6SNCO                          S01435
     C                     MOVELXADDS     P6SNDS                          S01435
     C*                                                                   S01435
     C                     MOVE CDRT      PRMTYP           ( CDRO )       S01435
     C                     MOVE *ZEROS    PRMFLD                          S01435
     C                     MOVELCDRO      PRMFLD                          S01435
     C           MBIN      IFEQ 'Y'                                       S01435
     C           CDRT      IFEQ 'P'                                       S01435
     C                     MOVELCDBR      P6CDBR                          S01435
     C                     ELSE                                           S01435
     C                     MOVE *BLANKS   P6CDBR                          S01435
     C                     END                                            S01435
     C                     END                                            S01435
     C                     EXSR CHOPF                                     S01435
     C                     MOVELPRMFLD    P6CDRO                          S01435
     C           CFT120    IFEQ 'Y'                                                           CFT120
     C                     MOVELOPCDRC    P6CDRC                                              CFT120
     C                     ENDIF                                                              CFT120
     C/COPY WNCPYSRC,FT1010C012
      *********                                                           S01435
      *                                                                   CFT009
      *  If Batch Authorsation update/add record                          CFT009
      *                                                                   CFT009
     C           CFT003    IFEQ 'CFT003'                                  CFT009
      *                                                                   CFT009
     C           PREF      CHAINOTPAYXL0             79                   CFT009
      *                                                                   CFT009
      ** If found, delete OTPAYXL0                                        CFT009
      *                                                                   CFT009
     C           *IN79     IFEQ '0'                                       CFT009
     C                     DELETOTPAYXDF                                  CFT009
     C                     ENDIF                           -*IN79         CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
      *                                                                   CFT009
      ** FX spread set                                                    CFT009
      *                                                                   CFT009
     C                     MOVE FXSRSC    FXSPST                          CFT009
      *                                                                   CFT009
      ** Levied currency depends on file settings.                        CFT009
      *                                                                   CFT009
     C                     SELEC                                          CFT009
     C***********CDRO      WHNE 0                                                      CFT009 CSD027
     C           CDRO      WHNE *BLANKS                                                       CSD027
      *                                                                                       CFT120
     C                     MOVELBCCY      WCCY                            CFT009
     C           OPCDRC    IFNE *BLANKS                                                       CFT120
     C           CFT120    ANDEQ'Y'                                                           CFT120
     C                     MOVELOPCDRC    WCCY                                                CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
     C           ADDC      WHEQ 'A'                                       CFT009
     C                     MOVELSMCY      WCCY                            CFT009
     C                     OTHER                                          CFT009
     C                     MOVELPCCY      WCCY                            CFT009
     C                     ENDSL                                          CFT009
      *                                                                   CFT009
     C                     MOVE WCCY      TCCCY                           CFT009
     C                     MOVE WCCY      FXCCY                           CFT009
     C                     MOVE WCCY      CQCCY                           CFT009
     C                     MOVE WCCY      CACCY                           CFT009
     C                     MOVE WCCY      TXCCY                           CFT009
     C                     MOVE WCCY      SPCCY                           CFT009
     C                     MOVE WCCY      SSCCY                           CFT009
     C                     MOVE WCCY      M0CCY                           CFT009
     C                     MOVE WCCY      M1CCY                           CFT009
     C                     MOVE WCCY      M2CCY                           CFT009
     C                     MOVE WCCY      M3CCY                           CFT009
     C                     MOVE WCCY      M4CCY                           CFT009
     C                     MOVE WCCY      M5CCY                           CFT009
     C                     MOVE WCCY      VTCCY                           CFT009
      *                                                                   CFT009
      ** Charge code                                                      CFT009
      *                                                                   CFT009
     C                     MOVE TFCCCD    TCCDE                           CFT009
     C                     MOVE FXCACC    FXCDE                           CFT009
     C                     MOVE CHQCHC    CQCDE                           CFT009
     C                     MOVE CACHCD    CACDE                           CFT009
     C                     MOVE TLXCDE    TXCDE                           CFT009
     C                     MOVE SPRCCD    SPCDE                           CFT009
     C                     MOVE SSTCCD    SSCDE                           CFT009
     C                     MOVE MSCHC     M0CDE                           CFT009
     C                     MOVE MSCHC1    M1CDE                           CFT009
     C                     MOVE MSCHC2    M2CDE                           CFT009
     C                     MOVE MSCHC3    M3CDE                           CFT009
     C                     MOVE MSCHC4    M4CDE                           CFT009
     C                     MOVE MSCHC5    M5CDE                           CFT009
      *                                                                   CFT009
      ** Chain to payment charge defintion file to get miscellaneous      CFT009
      ** charge code narratives.                                          CFT009
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
     C           MSCHC1    CHAINFTPCHGL0             90                   CFT009
     C           *IN90     IFEQ '0'                                       CFT009
     C                     MOVELCHDESC    P6MS1N    P                     CFT009
     C                     ELSE                                           CFT009
     C                     MOVELDESC,1    P6MS1N    P                     CFT009
     C                     ENDIF                                          CFT009
     C           MSCHC2    CHAINFTPCHGL0             90                   CFT009
     C           *IN90     IFEQ '0'                                       CFT009
     C                     MOVELCHDESC    P6MS2N    P                     CFT009
     C                     ELSE                                           CFT009
     C                     MOVELDESC,2    P6MS2N    P                     CFT009
     C                     ENDIF                                          CFT009
     C           MSCHC3    CHAINFTPCHGL0             90                   CFT009
     C           *IN90     IFEQ '0'                                       CFT009
     C                     MOVELCHDESC    P6MS3N    P                     CFT009
     C                     ELSE                                           CFT009
     C                     MOVELDESC,3    P6MS3N    P                     CFT009
     C                     ENDIF                                          CFT009
     C           MSCHC4    CHAINFTPCHGL0             90                   CFT009
     C           *IN90     IFEQ '0'                                       CFT009
     C                     MOVELCHDESC    P6MS4N    P                     CFT009
     C                     ELSE                                           CFT009
     C                     MOVELDESC,4    P6MS4N    P                     CFT009
     C                     ENDIF                                          CFT009
     C           MSCHC5    CHAINFTPCHGL0             90                   CFT009
     C           *IN90     IFEQ '0'                                       CFT009
     C                     MOVELCHDESC    P6MS5N    P                     CFT009
     C                     ELSE                                           CFT009
     C                     MOVELDESC,5    P6MS5N    P                     CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Retrieve currency details                                        CFT009
      *                                                                   CFT009
     C                     CALL 'AOCURRR0'                                CFT009
     C                     PARM *BLANKS   @RTCD                           CFT009
     C                     PARM '*KEY   ' @OPTN                           CFT009
     C                     PARM WCCY      @CURR                           CFT009
     C           SDCURR    PARM SDCURR    DSSDY                           CFT009
      *                                                                   CFT009
     C           @RTCD     IFNE *BLANKS                                   CFT009
     C                     MOVE 'SDCURRPD'WBFILE           ************   CFT009
     C                     MOVELPCCY      WBKEY            * DBERR 68 *   CFT009
     C                     Z-ADD68        WBASE            ************   CFT009
     C                     EXSR ABORT                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Prime currency                                                   CFT009
      *                                                                   CFT009
     C                     Z-ADDA6NBDP    WPCCY   10                      CFT009
      *                                                                   CFT009
      ** Set up misc charge amounts from file - levied currency           CFT009
      *                                                                   CFT009
     C                     Z-ADDMISC01    ZMISC1 150H                     CFT009
     C                     Z-ADDMISC02    ZMISC2 150H                     CFT009
     C                     Z-ADDMISC03    ZMISC3 150H                     CFT009
     C                     Z-ADDMISC04    ZMISC4 150H                     CFT009
     C                     Z-ADDMISC05    ZMISC5 150H                     CFT009
      *                                                                   CFT009
      ** Set up charge amounts from file charges currency amounts         CFT009
      *                                                                   CFT009
     C                     Z-ADDDUMA2     ZTXCH  150H                     CFT009
     C                     Z-ADDDUMA3     ZCQCH  150H                     CFT009
     C                     Z-ADDDUMA4     ZCSTA  150H                     CFT009
     C                     Z-ADDSWSCCC    ZSWSCH 150H                     CFT009
     C                     Z-ADDDUMA5     ZSPCH  150H                     CFT009
     C                     Z-ADDDUMA6     ZMSCH  150H                     CFT009
     C                     Z-ADDDUMA1     ZTRCM  150H                     CFT009
     C                     Z-ADDOPDUM7    ZOPCHC 150H                     CFT009
      *                                                                   CFT009
      ** Amount                                                           CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE TRCM      ZFIELD                          CFT009
     C                     Z-ADDWPCCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    TCAMT                           CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE OPCHCM    ZFIELD                          CFT009
     C                     Z-ADDWPCCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    FXAMT                           CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE CQCH      ZFIELD                          CFT009
     C                     Z-ADDWPCCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    CQAMT                           CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE CSTA      ZFIELD                          CFT009
     C                     Z-ADDWPCCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    CAAMT                           CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE TXCH      ZFIELD                          CFT009
     C                     Z-ADDWPCCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    TXAMT                           CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE SPCH      ZFIELD                          CFT009
     C                     Z-ADDWPCCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    SPAMT                           CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE SWSCHG    ZFIELD                          CFT009
     C                     Z-ADDWPCCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    SSAMT                           CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE MSCH      ZFIELD                          CFT009
     C                     Z-ADDWPCCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    M0AMT                           CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE ZMISC1    ZFIELD                          CFT009
     C                     Z-ADDWPCCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    M1AMT                           CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE ZMISC2    ZFIELD                          CFT009
     C                     Z-ADDWPCCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    M2AMT                           CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE ZMISC3    ZFIELD                          CFT009
     C                     Z-ADDWPCCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    M3AMT                           CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE ZMISC4    ZFIELD                          CFT009
     C                     Z-ADDWPCCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    M4AMT                           CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE ZMISC5    ZFIELD                          CFT009
     C                     Z-ADDWPCCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    M5AMT                           CFT009
      *                                                                   CFT009
      ** Amounts in charges currency                                      CFT009
      *                                                                   CFT009
      ** Get charges currency decimal places.                             CFT009
      *                                                                   CFT009
     C           OPCHGC    IFNE *BLANKS                                                    AR1001970
     C                     CALL 'AOCURRR0'                                CFT009
     C                     PARM *BLANKS   WRTCD                           CFT009
     C                     PARM '*KEY   ' WOPTN                           CFT009
     C                     PARM OPCHGC    WCCY    3                       CFT009
     C           SDCURR    PARM SDCURR    DSSDY                           CFT009
      *                                                                   CFT009
     C           WRTCD     IFNE *BLANKS                                   CFT009
     C                     Z-ADD901       WBASE            ************   CFT009
     C                     MOVELNDCY      WBKEY            * DBERR 901*   CFT009
     C                     MOVEL'SDCURRPD'WBFILE           ************   CFT009
     C                     EXSR ABORT                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     Z-ADDA6NBDP    WCHGDP  20                      CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE ZTRCM     ZFIELD                          CFT009
     C                     Z-ADDWCHGDP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    TCCHGA                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE ZOPCHC    ZFIELD                          CFT009
     C                     Z-ADDWCHGDP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    FXCHGA                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE ZCQCH     ZFIELD                          CFT009
     C                     Z-ADDWCHGDP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    CQCHGA                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE ZCSTA     ZFIELD                          CFT009
     C                     Z-ADDWCHGDP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    CACHGA                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE ZTXCH     ZFIELD                          CFT009
     C                     Z-ADDWCHGDP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    TXCHGA                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE ZSPCH     ZFIELD                          CFT009
     C                     Z-ADDWCHGDP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    SPCHGA                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE ZSWSCH    ZFIELD                          CFT009
     C                     Z-ADDWCHGDP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    SSCHGA                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE ZMSCH     ZFIELD                          CFT009
     C                     Z-ADDWCHGDP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    M0CHGA                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE MISCC1    ZFIELD                          CFT009
     C                     Z-ADDWCHGDP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    M1CHGA                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE MISCC2    ZFIELD                          CFT009
     C                     Z-ADDWCHGDP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    M2CHGA                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE MISCC3    ZFIELD                          CFT009
     C                     Z-ADDWCHGDP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    M3CHGA                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE MISCC4    ZFIELD                          CFT009
     C                     Z-ADDWCHGDP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    M4CHGA                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE MISCC5    ZFIELD                          CFT009
     C                     Z-ADDWCHGDP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    M5CHGA                          CFT009
     C                     ENDIF                                                           AR1001970
      *                                                                   CFT009
      ** Totals                                                           CFT009
      *                                                                   CFT009
     C           TRCM      ADD  OPCHCM    SUMAMT 150                      CFT009
     C                     ADD  CQCH      SUMAMT                          CFT009
     C                     ADD  CSTA      SUMAMT                          CFT009
     C                     ADD  TXCH      SUMAMT                          CFT009
     C                     ADD  SPCH      SUMAMT                          CFT009
     C                     ADD  SWSCHG    SUMAMT                          CFT009
     C                     ADD  MSCH      SUMAMT                          CFT009
     C                     ADD  ZMISC1    SUMAMT                          CFT009
     C                     ADD  ZMISC2    SUMAMT                          CFT009
     C                     ADD  ZMISC3    SUMAMT                          CFT009
     C                     ADD  ZMISC4    SUMAMT                          CFT009
     C                     ADD  ZMISC5    SUMAMT                          CFT009
      *                                                                   CFT009
      ** Total in charge currency                                         CFT009
      *                                                                   CFT009
     C           ZTRCM     ADD  ZOPCHC    SUMCHG 150                      CFT009
     C                     ADD  ZCQCH     SUMCHG                          CFT009
     C                     ADD  ZCSTA     SUMCHG                          CFT009
     C                     ADD  ZTXCH     SUMCHG                          CFT009
     C                     ADD  ZSPCH     SUMCHG                          CFT009
     C                     ADD  ZSWSCH    SUMCHG                          CFT009
     C                     ADD  ZMSCH     SUMCHG                          CFT009
     C                     ADD  MISCC1    SUMCHG                          CFT009
     C                     ADD  MISCC2    SUMCHG                          CFT009
     C                     ADD  MISCC3    SUMCHG                          CFT009
     C                     ADD  MISCC4    SUMCHG                          CFT009
     C                     ADD  MISCC5    SUMCHG                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE SUMAMT    ZFIELD                          CFT009
     C                     Z-ADDWPCCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    TOTAMT                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           CFT010    IFEQ 'Y'                                       CFT009
      *                                                                   CFT009
      ** VAT flags                                                        CFT009
      *                                                                   CFT009
     C                     MOVE OPVAT1    TCVAT                           CFT009
     C                     MOVE OPVAT7    FXVAT                           CFT009
     C                     MOVE OPVAT3    CQVAT                           CFT009
     C                     MOVE OPVAT4    CAVAT                           CFT009
     C                     MOVE OPVAT2    TXVAT                           CFT009
     C                     MOVE OPVAT5    SPVAT                           CFT009
     C                     MOVE VTSWSC    SSVAT                           CFT009
     C                     MOVE OPVAT6    M0VAT                           CFT009
     C                     MOVE VMIC1     M1VAT                           CFT009
     C                     MOVE VMIC2     M2VAT                           CFT009
     C                     MOVE VMIC3     M3VAT                           CFT009
     C                     MOVE VMIC4     M4VAT                           CFT009
     C                     MOVE VMIC5     M5VAT                           CFT009
      *                                                                   CFT009
      ** Use VAT amounts from file.                                       CFT009
      *                                                                   CFT009
     C                     Z-ADDOPVATT    SUMVAT                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE SUMVAT    ZFIELD                          CFT009
     C                     Z-ADDWPCCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    VTAMT                           CFT009
      *                                                                   CFT009
      ** V.A.T. amount in charges currency.                               CFT009
      *                                                                   CFT009
     C                     Z-ADDOPDUM8    VATCHG                          CFT009
      *                                                                   CFT009
      ** Format V.A.T. amount in charges currency.                        CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE VATCHG    ZFIELD                          CFT009
     C                     Z-ADDWCHGDP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    VTCHGA                          CFT009
      *                                                                   CFT009
      ** Totals                                                           CFT009
      *                                                                   CFT009
      ** Levied currency                                                  CFT009
      *                                                                   CFT009
     C           SUMAMT    ADD  SUMVAT    LEVCHG 160                      CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE LEVCHG    ZFIELD                          CFT009
     C                     Z-ADDWPCCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    TOTAMT    P                     CFT009
      *                                                                   CFT009
      ** Charges currency                                                 CFT009
      *                                                                   CFT009
     C           SUMCHG    ADD  VATCHG    CHGCHG 160                      CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE CHGCHG    ZFIELD                          CFT009
     C                     Z-ADDWCHGDP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    TOTCHG    P                     CFT009
      *                                                                   CFT009
     C                     ELSE                                           CFT009
      *                                                                   CFT009
      ** Totals without VAT.                                              CFT009
      *                                                                   CFT009
      ** Levied currency                                                  CFT009
      *                                                                   CFT009
     C                     Z-ADDSUMAMT    LEVCHG 160                      CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE LEVCHG    ZFIELD                          CFT009
     C                     Z-ADDWPCCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    TOTAMT    P                     CFT009
      *                                                                   CFT009
      ** Charges currency                                                 CFT009
      *                                                                   CFT009
     C                     Z-ADDSUMCHG    CHGCHG 160                      CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE CHGCHG    ZFIELD                          CFT009
     C                     Z-ADDWCHGDP    ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    TOTCHG    P                     CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                                       CSW209
     C           CSW209    IFEQ 'Y'                                                           CSW209
      *                                                                                       CSW209
     C                     MOVELOPNWRK    P6NWRK                                              CSW209
     C                     MOVELOPMTPY    P6MTPY                                              CSW209
     C                     MOVELOPVALF    P6VALF                                              CSW209
     C                     MOVELOPOMVF    P6OMVF                                              CSW209
     C                     MOVELOPOCVF    P6OCVF                                              CSW209
      *                                                                                       CSW209
      **  Cover Message Information for Outgoing Payments                                     CSW209
      *                                                                                       CSW209
      **  Sender to Receiver Information (Cover A)                                            CSW209
      *                                                                                       CSW209
     C                     MOVELOPOCB1    P6OCB1                                              CSW209
     C                     MOVELOPOCB2    P6OCB2                                              CSW209
     C                     MOVELOPOCB3    P6OCB3                                              CSW209
     C                     MOVELOPOCB4    P6OCB4                                              CSW209
     C                     MOVELOPOCB5    P6OCB5                                              CSW209
     C                     MOVELOPOCB6    P6OCB6                                              CSW209
      *                                                                                       CSW209
      **  Ordering Customer (Cover)                                                           CSW209
      *                                                                                       CSW209
     C                     MOVELOPCOC1    P6COC1                                              CSW209
     C                     MOVELOPCOC2    P6COC2                                              CSW209
     C                     MOVELOPCOC3    P6COC3                                              CSW209
     C                     MOVELOPCOC4    P6COC4                                              CSW209
     C                     MOVELOPCOC5    P6COC5                                              CSW209
      *                                                                                       CSW209
      **  Ordering Institution (Cover)                                                        CSW209
      *                                                                                       CSW209
     C                     MOVELOPCOB1    P6COB1                                              CSW209
     C                     MOVELOPCOB2    P6COB2                                              CSW209
     C                     MOVELOPCOB3    P6COB3                                              CSW209
     C                     MOVELOPCOB4    P6COB4                                              CSW209
     C                     MOVELOPCOB5    P6COB5                                              CSW209
      *                                                                                       CSW209
      **  Intermediary Institution (Cover)                                                    CSW209
      *                                                                                       CSW209
     C                     MOVELOPCIB1    P6CIB1                                              CSW209
     C                     MOVELOPCIB2    P6CIB2                                              CSW209
     C                     MOVELOPCIB3    P6CIB3                                              CSW209
     C                     MOVELOPCIB4    P6CIB4                                              CSW209
     C                     MOVELOPCIB5    P6CIB5                                              CSW209
      *                                                                                       CSW209
      **  Account with Institution (Cover)                                                    CSW209
      *                                                                                       CSW209
     C                     MOVELOPCAB1    P6CAB1                                              CSW209
     C                     MOVELOPCAB2    P6CAB2                                              CSW209
     C                     MOVELOPCAB3    P6CAB3                                              CSW209
     C                     MOVELOPCAB4    P6CAB4                                              CSW209
     C                     MOVELOPCAB5    P6CAB5                                              CSW209
      *                                                                                       CSW209
      **  Beneficiary Customer (Cover)                                                        CSW209
      *                                                                                       CSW209
     C                     MOVELOPCBC1    P6CBC1                                              CSW209
     C                     MOVELOPCBC2    P6CBC2                                              CSW209
     C                     MOVELOPCBC3    P6CBC3                                              CSW209
     C                     MOVELOPCBC4    P6CBC4                                              CSW209
     C                     MOVELOPCBC5    P6CBC5                                              CSW209
      *                                                                                       CSW209
      **  Remittance Information (Cover)                                                      CSW209
      *                                                                                       CSW209
     C                     MOVELOPCDP1    P6CDP1                                              CSW209
     C                     MOVELOPCDP2    P6CDP2                                              CSW209
     C                     MOVELOPCDP3    P6CDP3                                              CSW209
     C                     MOVELOPCDP4    P6CDP4                                              CSW209
      *                                                                                       CSW209
      **  Sender to Receiver Information (Cover B)                                            CSW209
      *                                                                                       CSW209
     C                     MOVELOPCBB1    P6CBB1                                              CSW209
     C                     MOVELOPCBB2    P6CBB2                                              CSW209
     C                     MOVELOPCBB3    P6CBB3                                              CSW209
     C                     MOVELOPCBB4    P6CBB4                                              CSW209
     C                     MOVELOPCBB5    P6CBB5                                              CSW209
     C                     MOVELOPCBB6    P6CBB6                                              CSW209
      *                                                                                       CSW209
      **  Instructed Currency (Cover)                                                         CSW209
      *                                                                                       CSW209
     C                     MOVELOPCICY    P6CICY                                              CSW209
      *                                                                                       CSW209
      **  Instructed Amount (Cover)                                                           CSW209
      *                                                                                       CSW209
     C                     MOVEL*BLANKS   P6CIAM                                              CSW209
      *                                                                                       CSW209
      ** Access AOCURRR0 to get the currency's decimal places                                 CSW209
      *                                                                                       CSW209
     C           OPCICY    IFNE *BLANKS                                                       CSW209
      *                                                                                       CSW209
     C                     CALL 'AOCURRR0'                                                    CSW209
     C                     PARM *BLANKS   WRTCD                                               CSW209
     C                     PARM '*KEY   ' WOPTN                                               CSW209
     C                     PARM           OPCICY                                              CSW209
     C           SDCURR    PARM SDCURR    DSSDY                                               CSW209
     C           WRTCD     IFNE *BLANKS                                                       CSW209
     C                     Z-ADD32        WBASE                                               CSW209
     C                     MOVELOPCICY    WBKEY                                               CSW209
     C                     MOVEL'SDCURRPD'WBFILE                                              CSW209
     C                     EXSR ABORT                                                         CSW209
     C                     ENDIF                                                              CSW209
     C                     Z-ADDA6NBDP    W6CIAM  10                                          CSW209
      *                                                                                       CSW209
      ** Format Instructed Currency Amount                                                    CSW209
      *                                                                                       CSW209
     C                     MOVEL*BLANKS   WFDIN                                               CSW209
     C                     MOVE OPCIAM    WFDIN                                               CSW209
     C                     Z-ADDW6CIAM    WDEC                                                CSW209
     C           13        SUB  W6CIAM    WDIG                                                CSW209
     C                     EXSR UGFRMT                                                        CSW209
     C                     MOVE WFDOUT    P6CIAM                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CER030
     C           CGL013    IFEQ 'Y'                                                           CER030
     C           CER030    OREQ 'Y'                                                           CER030
     C                     MOVE *ON       *IN36                                               CER030
     C                     MOVELOPRTTY    P6RTTY                                              CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           CER031    IFEQ 'Y'                                                           CER030
     C                     MOVE *ON       *IN37                                               CER030
     C                     MOVELOPEXT1    P6EXN1                                              CER030
     C                     MOVELOPEXT2    P6EXN2                                              CER030
     C                     MOVELOPEXT3    P6EXN3                                              CER030
     C                     MOVELOPEXT4    P6EXN4                                              CER030
     C                     MOVELOPEXT5    P6EXN5                                              CER030
     C                     MOVELOPEXT6    P6EXN6                                              CER030
      *                                                                                       CER030
     C           CFT003    IFEQ 'CFT003'                                                      CER030
     C                     MOVE *ON       *IN38                                               CER030
     C                     MOVELOPEXC1    P6EXC1                                              CER030
     C                     MOVELOPEXC2    P6EXC2                                              CER030
     C                     MOVELOPEXC3    P6EXC3                                              CER030
     C                     MOVELOPEXC4    P6EXC4                                              CER030
     C                     MOVELOPEXC5    P6EXC5                                              CER030
     C                     MOVELOPEXC6    P6EXC6                                              CER030
     C                     ENDIF                                                              CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C*
     C** OUTPUT PAGE TO REPORT
     C*
     C                     ADD  1         P6PAGE
     C                     WRITEP6HD
     C                     WRITEP6DETL
      *                                                                                       CER030
     C           CFT009    IFNE 'Y'                                                           CER030
      *                                                                                       CER030
     C           CGL013    IFEQ 'Y'                                                           CER030
     C           CER030    OREQ 'Y'                                                           CER030
     C           CER031    OREQ 'Y'                                                           CER030
      *                                                                                       CER030
     C           OFLLN6    SUB  PRTLN6    WREM1   20                                          CER030
     C           WREM1     IFLE 15                                                            CER030
     C                     ADD  1         P6PAGE                                              CER030
     C                     WRITEP6HDX                                                         CER030
     C                     ENDIF                                                              CER030
     C                     WRITEP6TRNR                                                        CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     MOVE '1'       *IN86            'OUTPUT, YES
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
     C                     ADD  1         P6PAGE                          CFT009
     C                     WRITEP6CHG                                     CFT009
     C                     WRITEP6TRNR                                                        CER030
     C                     ENDIF                                          CFT009
     C*
     C           CSW209    IFEQ 'Y'                                                           CSW209
      *                                                                                       CSW209
     C           CFT009    IFEQ 'Y'                                                         AR655670
     C                     MOVE '1'       *IN78                                             AR655670
     C                     ELSE                                                             AR655670
     C                     MOVE '0'       *IN78                                             AR655670
     C                     ADD  1         P6PAGE                                            AR655670
     C                     ENDIF                                                            AR655670
      *                                                                                     AR655670
     C                     WRITEP6NTWK                                                        CSW209
     C           OPOMVF    IFEQ 'COV'                                                         CSW209
     C           OPOCVF    OREQ 'COV'                                                         CSW209
     C           P6COCC    IFNE *BLANKS                                                       CSW209
     C           P6COBC    ORNE *BLANKS                                                       CSW209
     C           P6CIBC    ORNE *BLANKS                                                       CSW209
     C           P6CABC    ORNE *BLANKS                                                       CSW209
     C           P6CBCC    ORNE *BLANKS                                                       CSW209
     C           P6OCBC    ORNE *BLANKS                                                       CSW209
     C           P6CBBC    ORNE *BLANKS                                                       CSW209
     C           P6CDPC    ORNE *BLANKS                                                       CSW209
     C           P6CICY    ORNE *BLANKS                                                       CSW209
     C           P6CIAM    ORNE *BLANKS                                                       CSW209
     C                     ADD  1         P6PAGE                                              CSW209
     C                     WRITEP6COVM                                                        CSW209
      *                                                                                       CSW209
     C                     ENDIF                                                              CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
     C                     ENDIF                                                              CSW209
      *                                                                                       CSW209
      ** Key list for MEIRFTL2                                                              MD056935
      *                                                                                     MD056935
     C           MEIRFT    KLIST                                                            MD056935
     C                     KFLD           KMEREF 16                                         MD056935
     C                     KFLD           KMETYP  3                                         MD056935
      *                                                                                     MD056935
     C                     ENDSR
     C*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C*                                                               *
     C* NTRREP - SUBROUTINE TO PRODUCE REPORT FT1010P7 FOR NOSTRO     *
     C*          TRANSFERS                                            *
     C*                                                               *
     C********************************************************************
     C*                                                                ***
     C           NTRREP    BEGSR
     C*                                                                ***
     C                     MOVELTITL      P7TITL
     C                     MOVELRUNA      P7DATE
     C*
     C           *IN55     IFEQ '0'
     C                     ADD  1         P7PAGE
     C                     WRITEP7HEDT                     HEADINGS
     C                     SETON                     55
     C                     END
     C*
     C                     ADD  1         NT#CT   20
     C*
     C***********NT#CT     IFGE 10                                        S01494
     C           NT#CT     IFGE 3                                         S01494
     C                     SETOF                     55
     C                     Z-ADD0         NT#CT
     C                     END
     C*
     C                     Z-ADDVDAT      ZDAYNO           'FORMAT DATE
     C                     EXSR ZDATE2                     'TO DDMMMYY
     C                     MOVE ZADATE    VDATO   7
     C*                                                                   S01117
     C* IF MULTIBRANCHING INDICATOR ACTIVE,MOVE BOOKING BRANCH AND        S01117
     C* APPROPRIATE BRANCH NAME TO THE RELATIVE FIELDS SET UP WITHIN      S01117
     C* THE PRINTER FILE                                                  S01117
     C*                                                                   S01117
     C           *IN30     IFEQ '1'                                       S01117
     C                     MOVE BRCA      P7BRCA                          S01117
     C                     MOVE BRCA      WRKFLD                          S01117
     C                     EXSR SUBBRN                                    S01117
     C                     MOVELBRNM      P7BRNM                          S01117
     C*                                                                   S01117
     C* IF ORIGINATING BRANCH USED INDICATOR ACTIVE,MOVE ORBR AND         S01117
     C* APPROPRIATE BRANCH NAME TO THE RELATIVE FIELDS SET UP WITHIN      S01117
     C* THE PRINTER FILE                                                  S01117
     C*                                                                   S01117
     C           *IN35     IFEQ '1'                                       S01117
     C                     MOVE ORBR      P7ORBR                          S01117
     C                     MOVE ORBR      WRKFLD                          S01117
     C                     EXSR SUBBRN                                    S01117
     C                     MOVELBRNM      P7ORNM                          S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C*
     C** CALL UATBCN TO ACCESS CURRENCY RECORD FOR PAY CURRENCY
     C*
     C                     MOVEL*BLANKS   ZTABKY
     C                     MOVEL'20'      ZTABKY
     C                     MOVELCCY       WA4
     C                     MOVE '1'       WA4
     C                     MOVE WA4       ZTABKY
     C                     EXSR UATBCN
     C*
     C** CHECK IF DATABASE ERROR OCCURRED
     C*
     C           *IN89     IFEQ '1'
     C                     MOVEL'TABLE'   WBFILE           **********
     C                     MOVELZTABKY    WBKEY            * DBERR 37
     C                     Z-ADD37        WBASE            **********
     C                     EXSR ABORT                      *ABORT PGM*
     C                     END
     C*
     C** STORE NUMBER OF DECIMAL PLACES FOR PAY CURRENCY
     C*
     C                     Z-ADDCDP       SVRCDP  10
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE AMNT      WFDIN
     C                     Z-ADDSVRCDP    WDEC
     C           13        SUB  SVRCDP    WDIG
     C                     EXSR UGFRMT
     C                     MOVE WFDOUT    P7AMNT
     C*                                                                   S01494
     C** Format the name and address of the DESTINATION                   S01494
     C*                                                                   S01494
     C                     MOVELCCY       XCCY                            S01494
     C                     MOVEL'N'       XTYPE                           S01494
     C                     MOVEL*BLANKS   XNAMDS                          S01494
     C                     MOVELDEST      XNAMDS                          S01494
     C                     EXSR GETADD                                    S01494
     C                     MOVELXNAMDS    P7DEST                          S01494
     C*                                                                   S01494
     C** Format the name and address of the ACCOUNT WITH BANK             S01494
     C*                                                                   S01494
     C                     MOVELCCY       XCCY                            S01494
     C                     MOVEL'N'       XTYPE                           S01494
     C                     MOVEL*BLANKS   XNAMDS                          S01494
     C                     MOVELACBN      XNAMDS                          S01494
     C                     EXSR GETADD                                    S01494
     C                     MOVELXNAMDS    P7AWBK                          S01494
     C*                                                                   S01494
     C** Format the name and address of the INTERMEDIARY BANK             S01494
     C*                                                                   S01494
     C                     MOVELNTINBT    XTYPE                           S01494
     C                     MOVE *BLANKS   XNAMDS                          S01494
     C                     MOVELININBT    XNAMDS                          S01494
     C                     EXSR GETADD                                    S01494
     C                     MOVELXNAMDS    P7INBT                          S01494
     C*
     C                     WRITEP7DETL                 60
     C                     MOVE '1'       *IN87
     C*
     C                     ENDSR
     C*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C*                                                               *
     C*  CQCREP - SUBROUTINE TO PRODUCE REPORT FT1010P2 FOR CHEQUES   *
     C*                                                               *
     C*  INPUT  - P#CRDB (Credit/Debit Indicator)                     *
     C*                                                               *
     C*  CALLS  - DEBIT AND CREDIT SUBROUTINES                        *
     C*                                                               *
     C*****************************************************************
     C*
     C*
     C           CQCREP    BEGSR
     C*
     C           P#CRDB    IFEQ 'C'
     C                     EXSR CQCCRD
     C                     ELSE
     C                     EXSR CQCDBT
     C                     END
     C*
     C                     ENDSR
     C*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C*                                                               *
     C*  CQPREP - SUBROUTINE TO PRODUCE REPORT FT1010P3 FOR CHEQUES   *
     C*                                                               *
     C*  INPUT  - Q#CRDB (Credit/Debit Indicator)                     *
     C*                                                               *
     C*  CALLS  - DEBIT AND CREDIT SUBROUTINES                        *
     C*                                                               *
     C*****************************************************************
     C*
     C*
     C           CQPREP    BEGSR
     C*
     C           Q#CRDB    IFEQ 'C'
     C                     EXSR CQPCRD
     C                     ELSE
     C                     EXSR CQPDBT
     C                     END
     C*
     C                     ENDSR
     C*
     C********************************************************************
     C/EJECT
     C*****************************************************************
     C*                 UC-CHAIN-PAYMENT-CHARGES-FILE                 *
     C*                                                               *
     C*  FUNCTION : TO ATTEMPT TO ACCESS THE RECORD FROM THE PAYMENT  *
     C*             CHARGES FILE.                                     *
     C*                                                               *
     C*  CALLS :    NONE                                              *
     C*                                                               *
     C*  CALLED BY: INPREP                                            *
     C*             OTPREP                                            *
     C*             NTRREP                                            *
     C*                                                               *
     C*****************************************************************
     C*
     C           UCCLCN    BEGSR
     C*
     C           WCLKEY    KLIST
     C**********           KFLD           WCLNUM  60                                          CSD027
     C                     KFLD           WCLNUM  6                                           CSD027
     C                     KFLD           WCLRCT  1
     C*
     C           WCLKEY    CHAINCLINT                89
     C*
     C**N89******RECICL    COMP 'D'                  8989                 038584
     C*
     C*
     C           UCEND     ENDSR
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*             UG-FORMAT-FIELD-FOR-OUTPUT-TO-REPORT              *
     C*                                                               *
     C*  FUNCTION : TO FORMAT A NUMERIC FIELD FROM THE PAYMENT        *
     C*             CHARGES FILE FOR OUTPUT TO THE DETAIL SCREEN.     *
     C*             IT REMOVES LEADING ZEROES & INSERTS A DECIMAL     *
     C*             POINT IN THE APPROPRIATE POSITION.                *
     C*                                                               *
     C*  CALLS :    NONE                                              *
     C*                                                               *
     C*  CALLED BY: CADETL                                            *
     C*                                                               *
     C*****************************************************************
     C*
     C           UGFRMT    BEGSR
     C*
     C                     MOVEAWFDIN     WA1,1
     C*
     C** REPLACE LEADING ZEROES (IF LEFT OF DECIMAL POINT) WITH SPACES
     C*
     C                     SETOF                     89
     C           15        SUB  WDIG      I       30        -START
     C                     SUB  WDEC      I                  POS.
     C*
     C           14        SUB  WDEC      I1      30
     C*
     C           *IN89     DOUEQ'1'
     C                     ADD  1         I
     C           I         IFGT 15                          -CHECK FOR
     C                     SETON                     89      ARRAY END
     C                     ELSE
     C           WA1,I     IFNE '0'                         -CHECK FOR
     C                     SETON                     89      NON-ZERO
     C                     ELSE                              DIGIT.
     C           I         IFLE I1
     C                     MOVEL' '       WA1,I
     C                     END
     C                     END
     C                     END
     C                     END
     C*
     C** MOVE DIGITS TO RIGHT OF DECIMAL POINT(IF ANY) TO OUTPUT ARRAY
     C** & INSERT A DECIMAL POINT
     C*
     C                     MOVEL*BLANKS   WA2
     C*
     C           16        SUB  WDEC      I
     C           21        SUB  WDEC      I1
     C*
     C           I         IFLE 15
     C                     MOVEAWA1,I     WA2,I1
     C                     SUB  1         I1
     C                     MOVEL'.'       WA2,I1
     C                     END
     C*
     C** INSERT A COMMA AFTER EVERY 3 DIGITS TO LEFT OF DECIMAL POINT
     C*
     C                     SUB  1         I
     C                     SUB  1         I1
     C                     Z-ADD*ZERO     I2      30
     C*
     C           WA1,I     DOUEQ' '
     C           I         OREQ *ZERO
     C*
     C           I2        IFEQ 3
     C                     MOVEL','       WA2,I1
     C                     SUB  1         I1
     C                     Z-ADD*ZERO     I2
     C                     END
     C*
     C                     MOVE WA1,I     WA2,I1
     C                     SUB  1         I
     C                     SUB  1         I1
     C                     ADD  1         I2
     C                     END
     C*
     C                     MOVEAWA2,1     WFDOUT 20
     C*
     C*
     C           UGEND     ENDSR
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*                 UA-CHAIN-TABLE-FILE                           *
     C*                                                               *
     C*  FUNCTION : TO ATTEMPT TO ACCESS A REQUESTED RECORD FROM THE  *
     C*             TABLE FILE.                                       *
     C*                                                               *
     C*  CALLS :    NONE                                              *
     C*                                                               *
     C*  CALLED BY: AAMAIN                                            *
     C*             ECINST                                            *
     C*                                                               *
     C*****************************************************************
     C*
     C           UATBCN    BEGSR
     C*
     C           ZTABKY    CHAINTABFP                89
     C*
     C  N89      RECI      COMP 'D'                  8989
     C*
     C           UAEND     ENDSR
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*                 CHOP FIELD PROCESSING                         *
     C*                                                               *
     C*  FUNCTION : TO EDIT  SNCO, ORBK, CDRO  FOR OUTPUT.            *
     C*             IF PRMFLD IS ZERO THEN OUTPUT BLANKS.             *
     C*             IF PRMTYP IS 'N',OUTPUT FIRST TWO CHARS.          *
     C*             IF PRMTYP ID 'R',OUTPUT FIRST TEN CHARS.          *
     C*                                                               *
     C*  CALLS :    NONE                                              *
     C*                                                               *
     C*  CALLED BY: DEBIT + CREDIT CQC\CPC SUBROUTINES                *
     C*                                                               *
     C*****************************************************************
     C*
     C*
     C           CHOPF     BEGSR
     C*
     C           PRMFLD    IFEQ *ZEROS
     C                     MOVE *BLANKS   PRMFLD
     C                     ELSE
     C*
     C           PRMTYP    IFEQ 'N'
     C                     MOVE BLNK10    PRMFLD
     C                     ELSE
     C*
     C           PRMTYP    IFEQ 'R'
     C                     MOVE BLNK2     PRMFLD
     C*
     C                     END
     C                     END
     C                     END
     C*
     C                     ENDSR
     C*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C**   CQC DEBIT PROCESSING
     C**
     C           CQCDBT    BEGSR                           ** DEBIT  **
     C*
     C*
     C           *IN51     IFEQ '0'
     C                     ADD  1         P2PAGE
     C                     WRITEP2HEDT                 60
     C                     SETON                     51
     C                     END
     C*
     C                     ADD  1         DB#CT   10
     C*
     C           DB#CT     IFGE 3
     C                     SETOF                     51
     C                     Z-ADD0         DB#CT
     C                     END
     C*                                                                   S01117
     C* IF MULTIBRANCHING INDICATOR ACTIVE, MOVE BOOKING BRANCH AND       S01117
     C* APPROPRIATE BRANCH NAME TO THE RELATIVE FIELDS SET UP WITHIN      S01117
     C* THE PRINTER FILE                                                  S01117
     C*                                                                   S01117
     C           *IN30     IFEQ '1'                                       S01117
     C                     MOVE BRCA      P2BRCA                          S01117
     C                     MOVE BRCA      WRKFLD                          S01117
     C                     EXSR SUBBRN                                    S01117
     C                     MOVELBRNM      P2BRNM                          S01117
     C*                                                                   S01117
     C* IF ORIGINATING BRANCH USED INDICATOR ACTIVE,MOVE ORBR AND         S01117
     C* APPROPRIATE BRANCH NAME TO THE RELATIVE FIELDS SET UP WITHIN      S01117
     C* THE PRINTER FILE                                                  S01117
     C*                                                                   S01117
     C           *IN35     IFEQ '1'                                       S01117
     C                     MOVE ORBR      P2ORBR                          S01117
     C                     MOVE ORBR      WRKFLD                          S01117
     C                     EXSR SUBBRN                                    S01117
     C                     MOVELBRNM      P2ORNM                          S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C*
     C           COBT      IFNE 'C'
     C                     MOVE COB1      CBANK1
     C*                                                                   S01117
     C* IF MULTIBRANCHING INDICATOR SETOF AND FULL ACCOUNT ENTRY,SINGLE   S01117
     C* BRANCH NEED TO BE FORMATTED BY CUTTING OFF THE BRANCH CODE FROM   S01117
     C* THE END USING A WORK FIELD BEFORE OUTPUTING TO THE PRINTER FILE   S01117
     C*                                                                   S01117
     C           *IN30     IFEQ '0'                                       S01117
     C           COBT      ANDEQ'G'                                       S01117
     C***********          MOVELCOB1      FLD15                     S01117S01435
     C                     MOVELCOB1      FLD15  15                       S01435
     C                     MOVE *BLANKS   CBANK1                          S01117
     C                     MOVELFLD15     CBANK1                          S01117
     C                     END                                            S01117
     C                     MOVE COB2      CBANK2
     C                     MOVE COB3      CBANK3
     C                     MOVE COB4      CBANK4
     C*
     C                     ELSE
     C                     MOVELCOB1      WCLNUM
     C                     MOVEL'B'       WCLRCT
     C                     EXSR UCCLCN
     C*
     C           *IN89     IFEQ '1'                        ### B002
     C                     MOVE 'CLINT'   WBFILE           ***************
     C                     MOVELWCLNUM    WA7              ** DBERR  12 **
     C                     MOVE WCLRCT    WA7              ************
     C                     MOVELWA7       WBKEY
     C                     Z-ADD12        WBASE                        ***
     C                     EXSR ABORT
     C                     END                             ### E002
     C*
     C                     MOVE CNA1      CBANK1
     C                     MOVE CNA2      CBANK2
     C                     MOVE CNA3      CBANK3
     C                     MOVE CNA4      CBANK4
     C*
     C                     END                             ### E001
     C*
     C                     Z-ADDSLDT      ZDAYNO           'FORMAT DATE
     C                     EXSR ZDATE2                     'TO DDMMMYY
     C                     MOVE ZADATE    VDATO   7
     C*
     C                     Z-ADDOEDT      ZDAYNO           'FORMAT OEDT
     C                     EXSR ZDATE2                     'TO DDMMMYY
     C                     MOVE ZADATE    FTOEDT  7
     C*
     C** CALL UATBCN TO ACCESS CURRENCY RECORD FOR CURRENCY
     C*
     C                     MOVEL*BLANKS   ZTABKY
     C                     MOVEL'20'      ZTABKY
     C                     MOVELSMCY      WA4
     C                     MOVE '1'       WA4
     C                     MOVE WA4       ZTABKY
     C                     EXSR UATBCN
     C*
     C** CHECK IF DATABASE ERROR OCCURRED
     C*
     C           *IN89     IFEQ '1'
     C                     MOVEL'TABLE'   WBFILE           **********
     C                     MOVELZTABKY    WBKEY            * DBERR 38
     C                     Z-ADD38        WBASE            **********
     C                     EXSR ABORT                      *ABORT PGM*
     C                     END
     C*
     C** STORE NUMBER OF DECIMAL PLACES FOR PAY CURRENCY
     C*
     C                     Z-ADDCDP       SVRCDP  10
     C*
     C                     MOVELSMCY      OCCY
     C*
     C*  FORMAT TOTAL COLLECT AND TOTAL CHARGES FOR OUTPUT
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE TOCL      WFDIN
     C                     Z-ADDSVRCDP    WDEC
     C           13        SUB  SVRCDP    WDIG
     C                     EXSR UGFRMT
     C                     MOVE WFDOUT    P2TOCL
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE TOTC      WFDIN
     C                     Z-ADDSVRCDP    WDEC
     C           13        SUB  SVRCDP    WDIG
     C                     EXSR UGFRMT
     C                     MOVE WFDOUT    P2TOTC
     C*
     C*  FORMAT 'RCCO' FOR OUTPUT
     C*
     C                     MOVE RCRT      PRMTYP  1        ( RCCO )
     C**********           MOVE *ZEROS    PRMFLD 12                                           CGL029
     C                     MOVE *ZEROS    PRMFLD                                              CGL029
     C                     MOVELRCCO      PRMFLD
     C                     EXSR CHOPF
     C                     MOVELPRMFLD    FTRCCO
     C*
     C                     WRITEP2DEBT                 60
     C                     MOVE '1'       *IN82
     C*
     C                     ENDSR
     C*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C**    CREDIT PROCESSING
     C**
     C           CQCCRD    BEGSR                           ** CREDIT **
     C*
     C           *IN52     IFEQ '0'
     C                     ADD  1         P2PAGE
     C                     WRITEP2HEDT                 60
     C                     SETON                     52
     C                     END
     C*
     C                     ADD  1         CR#CT   10
     C*
     C           CR#CT     IFGE 2
     C                     SETOF                     52
     C                     Z-ADD0         CR#CT
     C                     END
     C*
     C                     Z-ADDCRVD      ZDAYNO           'FORMAT DATE
     C                     EXSR ZDATE2                     'TO DDMMMYY
     C                     MOVE ZADATE    VDATO
     C*
     C                     Z-ADDOEDT      ZDAYNO           'FORMAT OEDT
     C                     EXSR ZDATE2                     'TO DDMMMYY
     C                     MOVE ZADATE    FTOEDT
     C*                                                                   S01117
     C* IF MULTIBRANCHING INDICATOR ACTIVE, MOVE BOOKING BRANCH AND       S01117
     C* APPPROPRIATE BRANCH NAME TO THE RELATIVE FIELDS SET UP WITHIN     S01117
     C* THE PRINTER FILE                                                  S01117
     C*                                                                   S01117
     C           *IN30     IFEQ '1'                                       S01117
     C                     MOVE BRCA      P2BRCA                          S01117
     C                     MOVE BRCA      WRKFLD                          S01117
     C                     EXSR SUBBRN                                    S01117
     C                     MOVELBRNM      P2BRNM                          S01117
     C*                                                                   S01117
     C* IF ORIGINATING BRANCH USED INDICATOR ACTIVE,MOVE ORBR AND         S01117
     C* APPROPRIATE BRANCH NAME TO THE RELATIVE FIELDS SET UP WITHIN      S01117
     C* THE PRINTER FILE                                                  S01117
     C*                                                                   S01117
     C           *IN35     IFEQ '1'                                       S01117
     C                     MOVE ORBR      P2ORBR                          S01117
     C                     MOVE ORBR      WRKFLD                          S01117
     C                     EXSR SUBBRN                                    S01117
     C                     MOVELBRNM      P2ORNM                          S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C*
     C** CALL UATBCN TO ACCESS CURRENCY RECORD FOR CURRENCY
     C*
     C                     MOVEL*BLANKS   ZTABKY
     C                     MOVEL'20'      ZTABKY
     C                     MOVELSMCY      WA4
     C                     MOVE '1'       WA4
     C                     MOVE WA4       ZTABKY
     C                     EXSR UATBCN
     C*
     C** CHECK IF DATABASE ERROR OCCURRED
     C*
     C           *IN89     IFEQ '1'
     C                     MOVEL'TABLE'   WBFILE           **********
     C                     MOVELZTABKY    WBKEY            * DBERR 39
     C                     Z-ADD39        WBASE            **********
     C                     EXSR ABORT                      *ABORT PGM*
     C                     END
     C*
     C** STORE NUMBER OF DECIMAL PLACES FOR CURRENCY
     C*
     C                     Z-ADDCDP       SVCCDP  10
     C*
     C** FORMAT OTHER AMOUNTS & CURRENCIES
     C** IF CHARGES TO DEBIT A/C FIELD IS NON-ZERO USE BASE CURRENCY;
     C** OTHERWISE USE PCCY
     C*
     C***********CDRO      IFNE *ZERO                                                         CSD027
     C           CDRO      IFNE *BLANKS                                                       CSD027
     C                     MOVELBCCY      WCCY    3
     C                     MOVELBCCY      OCCY
     C                     MOVELBCCY      OCCY1
     C                     MOVELBCCY      CRNCY
     C*                                                                   S01494
     C** Check if SAR S01494 is set on                                    S01494
     C*                                                                   S01494
     C           *IN29     IFEQ '1'                                       S01494
     C                     MOVELBCCY      P2CHCY                          S01494
     C                     END                                            S01494
     C*                                                                   S01499
     C** Check if SAR S01499 is set on                                    S01499
     C*                                                                   S01499
     C           *IN39     IFEQ '1'                                       S01499
     C                     MOVELBCCY      P2VTCY                          S01499
     C                     END                                            S01499
     C*                                                                   S01499
     C                     Z-ADDSVBCDP    WDEC
     C                     ELSE
     C                     MOVELCRCY      WCCY
     C                     MOVELCRCY      OCCY
     C                     MOVELCRCY      OCCY1
     C                     MOVELCRCY      CRNCY
     C*                                                                   S01494
     C** Check if SAR S01494 is set on                                    S01494
     C*                                                                   S01494
     C           *IN29     IFEQ '1'                                       S01494
     C                     MOVELCRCY      P2CHCY                          S01494
     C                     END                                            S01494
     C*                                                                   S01499
     C** Check if SAR S01499 is set on                                    S01499
     C*                                                                   S01499
     C           *IN39     IFEQ '1'                                       S01499
     C*                                                                   S01499
     C                     MOVELCRCY      P2VTCY                          S01499
     C*                                                                   S01499
     C** Set up VAT flags for report                                      S01499
     C*                                                                   S01499
     C                     MOVE CCVAT1    P2TRVF                          S01499
     C                     MOVE CCVAT2    P2COVF                          S01499
     C                     MOVE CCVAT3    P2CSVF                          S01499
     C                     MOVE CCVAT4    P2TXVF                          S01499
     C           *IN29     IFEQ '1'                                       S01499
     C                     MOVE CCVAT5    P2CHVF                          S01499
     C                     END                                            S01499
     C*                                                                   S01499
     C                     END                                            S01499
     C*                                                                   S01499
     C                     Z-ADDSVCCDP    WDEC
     C                     END
     C*
     C           11        SUB  WDEC      WDIG
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CQAM      WFDIN
     C                     EXSR UGFRMT
     C                     MOVE WFDOUT    P2CQAM
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE TRCM      WFDIN
     C                     EXSR UGFRMT
     C                     MOVE WFDOUT    P2TRCM
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE COLL      WFDIN
     C                     EXSR UGFRMT
     C                     MOVE WFDOUT    P2COLL
     C*                                                                   S01494
     C** Check if SAR S01494 is set on                                    S01494
     C*                                                                   S01494
     C           *IN29     IFEQ '1'                                       S01494
     C*                                                                   S01494
     C** Format FX/Change Commission                                      S01494
     C*                                                                   S01494
     C                     MOVEL*BLANKS   WFDIN                           S01494
     C                     MOVE CCCHCM    WFDIN                           S01494
     C                     EXSR UGFRMT                                    S01494
     C                     MOVE WFDOUT    P2CHCM                          S01494
     C*                                                                   S01494
     C                     END                                            S01494
     C*                                                                   S01499
     C** Check if SAR S01499 is set on                                    S01499
     C*                                                                   S01499
     C           *IN39     IFEQ '1'                                       S01499
     C*                                                                   S01499
     C** Format V.A.T. Charge                                             S01499
     C*                                                                   S01499
     C                     MOVEL*BLANKS   WFDIN                           S01499
     C                     MOVE CCVATT    WFDIN                           S01499
     C                     EXSR UGFRMT                                    S01499
     C                     MOVE WFDOUT    P2VATT                          S01499
     C*                                                                   S01499
     C                     END                                            S01499
     C*
     C** FORMAT CENTRAL BANK REFERENCE FOR OUTPUT
     C/COPY WNCPYSRC,FT1010C027
     C*
     C           DNBC1     IFEQ *ZERO
     C/COPY WNCPYSRC,FT1010C028
     C                     MOVE *BLANKS   FDNBC1
     C                     ELSE
     C                     MOVELDNBC1     FDNBC1
     C                     END
     C/COPY WNCPYSRC,FT1010C029
     C*
     C           DNBC2     IFEQ *ZERO
     C/COPY WNCPYSRC,FT1010C030
     C                     MOVE *BLANKS   FDNBC2
     C                     ELSE
     C                     MOVELDNBC2     FDNBC2
     C                     END
     C/COPY WNCPYSRC,FT1010C031
     C*
     C           DNBC3     IFEQ *ZERO
     C/COPY WNCPYSRC,FT1010C032
     C                     MOVE *BLANKS   FDNBC3
     C                     ELSE
     C                     MOVELDNBC3     FDNBC3
     C                     END
     C/COPY WNCPYSRC,FT1010C033
     C*
     C           DNBC4     IFEQ *ZERO
     C/COPY WNCPYSRC,FT1010C034
     C                     MOVE *BLANKS   FDNBC4
     C                     ELSE
     C                     MOVELDNBC4     FDNBC4
     C                     END
     C/COPY WNCPYSRC,FT1010C035
     C*
     C           DNBC5     IFEQ *ZERO
     C/COPY WNCPYSRC,FT1010C036
     C                     MOVE *BLANKS   FDNBC5
     C                     ELSE
     C                     MOVELDNBC5     FDNBC5
     C                     END
     C/COPY WNCPYSRC,FT1010C042
     C*
     C** FORMAT 'CRPY' + 'CDRO' FOR OUTPUT
     C*
     C                     MOVE CRPT      PRMTYP  1        ( CRPY )
     C**********           MOVE *ZEROS    PRMFLD 12                                           CGL029
     C                     MOVE *ZEROS    PRMFLD                                              CGL029
     C                     MOVELCRPY      PRMFLD
     C                     EXSR CHOPF
     C                     MOVELPRMFLD    FTCRPY
     C                     MOVE CRBR      P2CRBR                          S01117
     C*
     C                     WRITEP2CRAA                 60
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CSTA      WFDIN
     C                     EXSR UGFRMT
     C                     MOVE WFDOUT    P2CSTA
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE TXCH      WFDIN
     C                     EXSR UGFRMT
     C                     MOVE WFDOUT    P2TXCH
     C*
     C                     WRITEP2CRBB                 60
     C*
     C                     MOVE CDRT      PRMTYP  1        ( CDRO )
     C**********           MOVE *ZEROS    PRMFLD 12                                           CGL029
     C                     MOVE *ZEROS    PRMFLD                                              CGL029
     C                     MOVELCDRO      PRMFLD
     C                     EXSR CHOPF
     C                     MOVELPRMFLD    FTCDRO
     C                     MOVE CDBR      P2CDBR                          S01117
     C*
     C                     WRITEP2CRCC                 60
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
      *                                                                   CFT009
      ** FX spread set                                                    CFT009
      *                                                                   CFT009
     C                     MOVE FXSPDS    FXSPST                          CFT009
      *                                                                   CFT009
      ** Currency                                                         CFT009
      *                                                                   CFT009
     C                     MOVE CRCY      TCCCY                           CFT009
     C                     MOVE CRCY      FXCCY                           CFT009
     C                     MOVE CRCY      CACCY                           CFT009
     C                     MOVE CRCY      CLCCY                           CFT009
     C                     MOVE CRCY      TXCCY                           CFT009
      *                                                                   CFT009
      ** Charge code                                                      CFT009
      *                                                                   CFT009
     C                     MOVE TRCMCC    TCCDE                           CFT009
     C                     MOVE FXCCCC    FXCDE                           CFT009
     C                     MOVE CABCCD    CACDE                           CFT009
     C                     MOVE COCHCD    CLCDE                           CFT009
     C                     MOVE TLXCHD    TXCDE                           CFT009
      *                                                                   CFT009
      ** Retrieve currency details                                        CFT009
      *                                                                   CFT009
     C                     CALL 'AOCURRR0'                                CFT009
     C                     PARM *BLANKS   @RTCD                           CFT009
     C                     PARM '*KEY   ' @OPTN                           CFT009
     C                     PARM CRCY      @CURR                           CFT009
     C           SDCURR    PARM SDCURR    DSSDY                           CFT009
      *                                                                   CFT009
     C           @RTCD     IFNE *BLANKS                                   CFT009
     C                     MOVE 'SDCURRPD'WBFILE           ************   CFT009
     C                     MOVELCRCY      WBKEY            * DBERR 66 *   CFT009
     C                     Z-ADD66        WBASE            ************   CFT009
     C                     EXSR ABORT                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Credit currency                                                  CFT009
      *                                                                   CFT009
     C                     Z-ADDA6NBDP    WCRCY   10                      CFT009
      *                                                                   CFT009
      ** Amount                                                           CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE TRCM      ZFIELD                          CFT009
     C                     Z-ADDWCRCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    TCAMT                           CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE CCCHCM    ZFIELD                          CFT009
     C                     Z-ADDWCRCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    FXAMT                           CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE CSTA      ZFIELD                          CFT009
     C                     Z-ADDWCRCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    CAAMT                           CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE COLL      ZFIELD                          CFT009
     C                     Z-ADDWCRCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    CLAMT                           CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE TXCH      ZFIELD                          CFT009
     C                     Z-ADDWCRCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    TXAMT                           CFT009
      *                                                                   CFT009
      ** Totals                                                           CFT009
      *                                                                   CFT009
     C           TRCM      ADD  CCCHCM    SUMAMT 150                      CFT009
     C                     ADD  CSTA      SUMAMT                          CFT009
     C                     ADD  COLL      SUMAMT                          CFT009
     C                     ADD  TXCH      SUMAMT                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE SUMAMT    ZFIELD                          CFT009
     C                     Z-ADDWCRCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    TOTAMT                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           CFT010    IFEQ 'Y'                                       CFT009
      *                                                                   CFT009
      ** VAT flags                                                        CFT009
      *                                                                   CFT009
     C                     MOVE CCVAT1    TCVAT                           CFT009
     C                     MOVE CCVAT5    FXVAT                           CFT009
     C                     MOVE CCVAT3    CAVAT                           CFT009
     C                     MOVE CCVAT2    CLVAT                           CFT009
     C                     MOVE CCVAT4    TXVAT                           CFT009
      *                                                                   CFT009
      ** VAT amount and total charge                                      CFT009
      *                                                                   CFT009
     C           CCVAT1    IFEQ 'Y'                                       CFT009
     C           CCVATR    MULT TRCM      VAT    150H                     CFT009
     C                     Z-ADDVAT       SUMVAT 150                      CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     Z-ADD0         SUMVAT                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE VAT       ZFIELD                          CFT009
     C                     Z-ADDWCRCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    TCVATA                          CFT009
      *                                                                   CFT009
     C           VAT       ADD  TRCM      CHG    150                      CFT009
     C                     Z-ADDCHG       SUMCHG 150                      CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE CHG       ZFIELD                          CFT009
     C                     Z-ADDWCRCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    TCTOT                           CFT009
      *                                                                   CFT009
     C           CCVAT5    IFEQ 'Y'                                       CFT009
     C           CCVATR    MULT CCCHCM    VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE VAT       ZFIELD                          CFT009
     C                     Z-ADDWCRCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    FXVATA                          CFT009
      *                                                                   CFT009
     C           VAT       ADD  CCCHCM    CHG                             CFT009
     C                     ADD  CHG       SUMCHG                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE CHG       ZFIELD                          CFT009
     C                     Z-ADDWCRCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    FXTOT                           CFT009
      *                                                                   CFT009
     C           CCVAT3    IFEQ 'Y'                                       CFT009
     C           CCVATR    MULT CSTA      VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE VAT       ZFIELD                          CFT009
     C                     Z-ADDWCRCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    CAVATA                          CFT009
      *                                                                   CFT009
     C           VAT       ADD  CSTA      CHG                             CFT009
     C                     ADD  CHG       SUMCHG                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE CHG       ZFIELD                          CFT009
     C                     Z-ADDWCRCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    CATOT                           CFT009
      *                                                                   CFT009
     C           CCVAT2    IFEQ 'Y'                                       CFT009
     C           CCVATR    MULT COLL      VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE VAT       ZFIELD                          CFT009
     C                     Z-ADDWCRCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    CLVATA                          CFT009
      *                                                                   CFT009
     C           VAT       ADD  COLL      CHG                             CFT009
     C                     ADD  CHG       SUMCHG                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE CHG       ZFIELD                          CFT009
     C                     Z-ADDWCRCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    CLTOT                           CFT009
      *                                                                   CFT009
     C           CCVAT4    IFEQ 'Y'                                       CFT009
     C           CCVATR    MULT TXCH      VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE VAT       ZFIELD                          CFT009
     C                     Z-ADDWCRCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    TXVATA                          CFT009
      *                                                                   CFT009
     C           VAT       ADD  TXCH      CHG                             CFT009
     C                     ADD  CHG       SUMCHG                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE CHG       ZFIELD                          CFT009
     C                     Z-ADDWCRCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    TXTOT                           CFT009
      *                                                                   CFT009
      ** Totals                                                           CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE SUMVAT    ZFIELD                          CFT009
     C                     Z-ADDWCRCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    TOTVAT                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE SUMCHG    ZFIELD                          CFT009
     C                     Z-ADDWCRCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    TOTCHG                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
     C                     WRITEP2CRDD                                    CFT009
     C                     ENDIF                                          CFT009
     C*
     C                     MOVE '1'       *IN82
     C*
     C                     ENDSR
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C**    DEBIT  PROCESSING FOR CQPADDD
     C**
     C           CQPDBT    BEGSR                           ** DEBIT  **
     C*
     C           CFT009    IFEQ 'N'                                       CFT009
      *                                                                   CFT009
     C           *IN53     IFEQ '0'
     C                     ADD  1         P3PAGE
     C                     WRITEP3HEDT                 60
     C                     SETON                     53
     C                     END
     C*
     C                     ADD  1         DBQPCT  10
     C*
     C           DBQPCT    IFGE 2
     C                     SETOF                     53
     C                     Z-ADD0         DBQPCT
     C                     END
      *                                                                   CFT009
     C                     ELSE                                           CFT009
      *                                                                   CFT009
     C                     ADD  1         P3PAGE                          CFT009
     C                     WRITEP3HEDT                 60                 CFT009
     C                     END                                            CFT009
     C*                                                                   S01117
     C* IF MULTIBRANCHING INDICATOR ACTIVE, MOVE BOOKING BRANCH AND       S01117
     C* APPROPRIATE BRANCH NAME TO THE RELATIVE FIELDS SET UP WITHIN      S01117
     C* THE PRINTER FILE                                                  S01117
     C*                                                                   S01117
     C           *IN30     IFEQ '1'                                       S01117
     C                     MOVE BRCA      P3BRCA                          S01117
     C                     MOVE BRCA      WRKFLD                          S01117
     C                     EXSR SUBBRN                                    S01117
     C                     MOVELBRNM      P3BRNM                          S01117
     C*                                                                   S01117
     C* IF ORIGINATING BRANCH USED INDICATOR ACTIVE,MOVE ORBR AND         S01117
     C* APPROPRIATE BRANCH NAME TO THE RELATIVE FIELDS SET UP WITHIN      S01117
     C* THE PRINTER FILE                                                  S01117
     C*                                                                   S01117
     C           *IN35     IFEQ '1'                                       S01117
     C                     MOVE ORBR      P3ORBR                          S01117
     C                     MOVE ORBR      WRKFLD                          S01117
     C                     EXSR SUBBRN                                    S01117
     C                     MOVELBRNM      P3ORNM                          S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C*
     C** CALL UATBCN TO ACCESS CURRENCY RECORD FOR PAY CURRENCY
     C*
     C                     MOVEL*BLANKS   ZTABKY
     C                     MOVEL'20'      ZTABKY
     C                     MOVELPCCY      WA4
     C                     MOVE '1'       WA4
     C                     MOVE WA4       ZTABKY
     C                     EXSR UATBCN
     C*
     C** CHECK IF DATABASE ERROR OCCURRED
     C*
     C           *IN89     IFEQ '1'
     C                     MOVEL'TABLE'   WBFILE           **********
     C                     MOVELZTABKY    WBKEY            * DBERR 40
     C                     Z-ADD40        WBASE            **********
     C                     EXSR ABORT                      *ABORT PGM*
     C                     END
     C*
     C** STORE NUMBER OF DECIMAL PLACES FOR DEBIT CURRENCY
     C*
     C                     Z-ADDCDP       SVDCDP  10
     C*
     C** FORMAT OTHER AMOUNTS & CURRENCIES
     C** IF CHARGES TO DEBIT A/C FIELD IS NON-ZERO USE BASE CURRENCY;
     C** OTHERWISE USE PCCY
     C*
     C***********CDRO      IFNE *ZERO                                                         CSD027
     C           CDRO      IFNE *BLANKS                                                       CSD027
     C                     MOVELBCCY      WCCY    3
     C                     MOVELBCCY      OCCY1
     C                     MOVELBCCY      CRNCY
     C                     MOVELBCCY      OCCY2
     C*                                                                   S01494
     C** Check if SAR S01494 is set on                                    S01494
     C*                                                                   S01494
     C           *IN29     IFEQ '1'                                       S01494
     C                     MOVELBCCY      P3CHCY                          S01494
     C                     END                                            S01494
     C*                                                                   S01499
     C** Check if SAR S01499 is set on                                    S01499
     C*                                                                   S01499
     C           *IN39     IFEQ '1'                                       S01499
     C                     MOVELBCCY      P3VTCY                          S01499
     C                     END                                            S01499
     C*                                                                   S01499
     C                     Z-ADDSVBCDP    WDEC
     C                     ELSE
     C                     MOVELDRCY      WCCY
     C                     MOVELDRCY      OCCY1
     C                     MOVELDRCY      CRNCY
     C                     MOVELDRCY      OCCY2
     C*                                                                   S01494
     C** Check if SAR S01494 is set on                                    S01494
     C*                                                                   S01494
     C           *IN29     IFEQ '1'                                       S01494
     C                     MOVELDRCY      P3CHCY                          S01494
     C                     END                                            S01494
     C*                                                                   S01499
     C** Check if SAR S01499 is set on                                    S01499
     C*                                                                   S01499
     C           *IN39     IFEQ '1'                                       S01499
     C*                                                                   S01499
     C                     MOVELDRCY      P3VTCY                          S01499
     C*                                                                   S01499
     C** Set up VAT flags for report                                      S01499
     C*                                                                   S01499
     C                     MOVE PDVAT1    P3TRVF                          S01499
     C                     MOVE PDVAT2    P3COVF                          S01499
     C                     MOVE PDVAT3    P3CSVF                          S01499
     C           *IN29     IFEQ '1'                                       S01499
     C                     MOVE PDVAT4    P3CHVF                          S01499
     C                     END                                            S01499
     C*                                                                   S01499
     C                     END                                            S01499
     C*                                                                   S01499
     C                     Z-ADDSVDCDP    WDEC
     C                     END
     C*
     C           11        SUB  WDEC      WDIG
     C*
     C                     Z-ADDDRVD      ZDAYNO           'FORMAT DATE
     C                     EXSR ZDATE2                     'TO DDMMMYY
     C                     MOVE ZADATE    VDATO   7
     C*
     C                     Z-ADDOEDT      ZDAYNO           'FORMAT OEDT
     C                     EXSR ZDATE2                     'TO DDMMMYY
     C                     MOVE ZADATE    FTOEDT  7
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CQAM      WFDIN
     C                     EXSR UGFRMT
     C                     MOVE WFDOUT    P3CQAM
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE TRCM      WFDIN
     C                     EXSR UGFRMT
     C                     MOVE WFDOUT    P3TRCM
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE COLL      WFDIN
     C                     EXSR UGFRMT
     C                     MOVE WFDOUT    P3COLL
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE CSTA      WFDIN
     C                     EXSR UGFRMT
     C                     MOVE WFDOUT    P3CSTA
     C*                                                                   S01494
     C** Check if SAR S01494 is set on                                    S01494
     C*                                                                   S01494
     C           *IN29     IFEQ '1'                                       S01494
     C*                                                                   S01494
     C** Format FX/Change Commission                                      S01494
     C*                                                                   S01494
     C                     MOVEL*BLANKS   WFDIN                           S01494
     C                     MOVE PDCHCM    WFDIN                           S01494
     C                     EXSR UGFRMT                                    S01494
     C                     MOVE WFDOUT    P3CHCM                          S01494
     C*                                                                   S01494
     C                     END                                            S01494
     C*                                                                   S01499
     C** Check if SAR S01499 is set on                                    S01499
     C*                                                                   S01499
     C           *IN39     IFEQ '1'                                       S01499
     C*                                                                   S01499
     C** Format V.A.T. Charge                                             S01499
     C*                                                                   S01499
     C                     MOVEL*BLANKS   WFDIN                           S01499
     C                     MOVE PDVATT    WFDIN                           S01499
     C                     EXSR UGFRMT                                    S01499
     C                     MOVE WFDOUT    P3VATT                          S01499
     C*                                                                   S01499
     C                     END                                            S01499
     C*
     C** FORMAT 'DRPY' + 'CDRO' FOR OUTPUT
     C*
     C                     MOVE DRPT      PRMTYP           ( DRPY )
     C                     MOVE *ZEROS    PRMFLD
     C                     MOVELDRPY      PRMFLD
     C                     EXSR CHOPF
     C                     MOVELPRMFLD    P3DRPY
     C                     MOVE DRBR      P3DRBR                          S01117
     C*
     C                     MOVE CDRT      PRMTYP           ( CDRO )
     C                     MOVE *ZEROS    PRMFLD
     C                     MOVELCDRO      PRMFLD
     C                     EXSR CHOPF
     C                     MOVELPRMFLD    P3CDRO
     C                     MOVE CDBR      P3CDBR                          S01117
     C*
     C** FORMAT THE CENTRAL BANK REFERENCE
     C/COPY WNCPYSRC,FT1010C037
     C*
     C           DNBC      IFEQ *ZERO
     C/COPY WNCPYSRC,FT1010C038
     C                     MOVE *BLANKS   P3DNBC
     C                     ELSE
     C                     MOVELDNBC      P3DNBC
     C                     END
     C/COPY WNCPYSRC,FT1010C043
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
      *                                                                   CFT009
      ** Currency                                                         CFT009
      *                                                                   CFT009
     C                     MOVE DRCY      TCCCY                           CFT009
     C                     MOVE DRCY      FXCCY                           CFT009
     C                     MOVE DRCY      CACCY                           CFT009
     C                     MOVE DRCY      CLCCY                           CFT009
      *                                                                   CFT009
      ** Charge code                                                      CFT009
      *                                                                   CFT009
     C                     MOVE TFCMCC    TCCDE                           CFT009
     C                     MOVE FCHCCC    FXCDE                           CFT009
     C                     MOVE CSTACD    CACDE                           CFT009
     C                     MOVE COLCGC    CLCDE                           CFT009
      *                                                                   CFT009
      ** Retrieve currency details                                        CFT009
      *                                                                   CFT009
     C                     CALL 'AOCURRR0'                                CFT009
     C                     PARM *BLANKS   @RTCD                           CFT009
     C                     PARM '*KEY   ' @OPTN                           CFT009
     C                     PARM DRCY      @CURR                           CFT009
     C           SDCURR    PARM SDCURR    DSSDY                           CFT009
      *                                                                   CFT009
     C           @RTCD     IFNE *BLANKS                                   CFT009
     C                     MOVE 'SDCURRPD'WBFILE           ************   CFT009
     C                     MOVELDRCY      WBKEY            * DBERR 65 *   CFT009
     C                     Z-ADD65        WBASE            ************   CFT009
     C                     EXSR ABORT                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Debit currency                                                   CFT009
      *                                                                   CFT009
     C                     Z-ADDA6NBDP    WDRCY   10                      CFT009
      *                                                                   CFT009
      ** Amount                                                           CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE TRCM      ZFIELD                          CFT009
     C                     Z-ADDWDRCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    TCAMT                           CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE PDCHCM    ZFIELD                          CFT009
     C                     Z-ADDWDRCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    FXAMT                           CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE CSTA      ZFIELD                          CFT009
     C                     Z-ADDWDRCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    CAAMT                           CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE COLL      ZFIELD                          CFT009
     C                     Z-ADDWDRCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    CLAMT                           CFT009
      *                                                                   CFT009
      ** Totals                                                           CFT009
      *                                                                   CFT009
     C           TRCM      ADD  PDCHCM    SUMAMT 150                      CFT009
     C                     ADD  CSTA      SUMAMT                          CFT009
     C                     ADD  COLL      SUMAMT                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE SUMAMT    ZFIELD                          CFT009
     C                     Z-ADDWDRCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    TOTAMT                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           CFT010    IFEQ 'Y'                                       CFT009
      *                                                                   CFT009
      ** VAT flags                                                        CFT009
      *                                                                   CFT009
     C                     MOVE PDVAT1    TCVAT                           CFT009
     C                     MOVE PDVAT4    FXVAT                           CFT009
     C                     MOVE PDVAT3    CAVAT                           CFT009
     C                     MOVE PDVAT2    CLVAT                           CFT009
      *                                                                   CFT009
      ** VAT amount and total charge                                      CFT009
      *                                                                   CFT009
     C           PDVAT1    IFEQ 'Y'                                       CFT009
     C           PDVATR    MULT TRCM      VAT    150H                     CFT009
     C                     Z-ADDVAT       SUMVAT 150                      CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     Z-ADD0         SUMVAT                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE VAT       ZFIELD                          CFT009
     C                     Z-ADDWDRCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    TCVATA                          CFT009
      *                                                                   CFT009
     C           VAT       ADD  TRCM      CHG    150                      CFT009
     C                     Z-ADDCHG       SUMCHG 150                      CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE CHG       ZFIELD                          CFT009
     C                     Z-ADDWDRCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    TCTOT                           CFT009
      *                                                                   CFT009
     C           PDVAT4    IFEQ 'Y'                                       CFT009
     C           PDVATR    MULT PDCHCM    VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE VAT       ZFIELD                          CFT009
     C                     Z-ADDWDRCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    FXVATA                          CFT009
      *                                                                   CFT009
     C           VAT       ADD  PDCHCM    CHG                             CFT009
     C                     ADD  CHG       SUMCHG                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE CHG       ZFIELD                          CFT009
     C                     Z-ADDWDRCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    FXTOT                           CFT009
      *                                                                   CFT009
     C           PDVAT3    IFEQ 'Y'                                       CFT009
     C           PDVATR    MULT CSTA      VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE VAT       ZFIELD                          CFT009
     C                     Z-ADDWDRCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    CAVATA                          CFT009
      *                                                                   CFT009
     C           VAT       ADD  CSTA      CHG                             CFT009
     C                     ADD  CHG       SUMCHG                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE CHG       ZFIELD                          CFT009
     C                     Z-ADDWDRCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    CATOT                           CFT009
      *                                                                   CFT009
     C           PDVAT2    IFEQ 'Y'                                       CFT009
     C           PDVATR    MULT COLL      VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE VAT       ZFIELD                          CFT009
     C                     Z-ADDWDRCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    CLVATA                          CFT009
      *                                                                   CFT009
     C           VAT       ADD  COLL      CHG                             CFT009
     C                     ADD  CHG       SUMCHG                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE CHG       ZFIELD                          CFT009
     C                     Z-ADDWDRCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    CLTOT                           CFT009
      *                                                                   CFT009
      ** Totals                                                           CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE SUMVAT    ZFIELD                          CFT009
     C                     Z-ADDWDRCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    TOTVAT                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE SUMCHG    ZFIELD                          CFT009
     C                     Z-ADDWDRCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    TOTCHG                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
     C*
     C                     WRITEP3DEBT                 60
     C                     SETON                     83
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
     C                     WRITEP3DBCH                                    CFT009
     C                     ENDIF                                          CFT009
     C*
     C                     ENDSR
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C**   CREDIT PROCESSING FOR CQPACDD
     C**
     C           CQPCRD    BEGSR                           ** CREDIT **
     C*
     C           *IN54     IFEQ '0'
     C                     ADD  1         P3PAGE
     C                     WRITEP3HEDT                 60
     C                     SETON                     54
     C                     END
     C*
     C                     ADD  1         CRQPCT  10
     C*
     C           CRQPCT    IFGE 1
     C                     SETOF                     54
     C                     Z-ADD0         CRQPCT
     C                     END
     C*                                                                   S01117
     C* IF MULTIBRANCHING INDICATOR ACTIVE, MOVE BOOKING BRANCH AND       S01117
     C* APPROPRIATE BRANCH NAME TO THE RELATIVE FIELDS SET UP WITHIN      S01117
     C* THE PRINTER FILE                                                  S01117
     C*                                                                   S01117
     C           *IN30     IFEQ '1'                                       S01117
     C                     MOVE BRCA      P3BRCA                          S01117
     C                     MOVE BRCA      WRKFLD                          S01117
     C                     EXSR SUBBRN                                    S01117
     C                     MOVELBRNM      P3BRNM                          S01117
     C*                                                                   S01117
     C* IF ORIGINATING BRANCH USED INDICATOR ACTIVE,MOVE ORBR AND         S01117
     C* APPROPRIATE BRANCH NAME TO THE RELATIVE FIELDS SET UP WITHIN      S01117
     C* THE PRINTER FILE                                                  S01117
     C*                                                                   S01117
     C           *IN35     IFEQ '1'                                       S01117
     C                     MOVE ORBR      P3ORBR                          S01117
     C                     MOVE ORBR      WRKFLD                          S01117
     C                     EXSR SUBBRN                                    S01117
     C                     MOVELBRNM      P3ORNM                          S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C*
     C           RBKT      IFNE 'C'
     C*
     C                     MOVE RBK1      CBANK1
     C*                                                                   S01117
     C* IF MULTIBRANCHING INDICATOR SETOF AND FULL ACCOUNT ENTRY,SINGLE   S01117
     C* BRANCH NEED TO BE FORMATTED BY CUTTING OFF THE BRANCH CODE FROM   S01117
     C* THE END USING A WORK FIELD BEFORE OUTPUTING TO THE PRINTER FILE   S01117
     C*                                                                   S01117
     C           *IN30     IFEQ '0'                                       S01117
     C           RBKT      ANDEQ'G'                                       S01117
     C                     MOVELRBK1      FLD15                           S01117
     C                     MOVE *BLANKS   CBANK1                          S01117
     C                     MOVELFLD15     CBANK1                          S01117
     C                     END                                            S01117
     C                     MOVE RBK2      CBANK2
     C                     MOVE RBK3      CBANK3
     C                     MOVE RBK4      CBANK4
     C*
     C                     ELSE                            ### B001
     C                     MOVELRBK1      WCLNUM
     C                     MOVEL'B'       WCLRCT
     C                     EXSR UCCLCN
     C*
     C           *IN89     IFEQ '1'                        ### B002
     C                     MOVE 'CLINT'   WBFILE           ***************
     C                     MOVELWCLNUM    WA7              ** DBERR  13 **
     C                     MOVE WCLRCT    WA7              ************
     C                     MOVELWA7       WBKEY
     C                     Z-ADD13        WBASE                        ***
     C                     EXSR ABORT
     C                     END                             ### E002
     C*
     C                     MOVE CNA1      CBANK1
     C                     MOVE CNA2      CBANK2
     C                     MOVE CNA3      CBANK3
     C                     MOVE CNA4      CBANK4
     C*
     C                     END                             ### E001
     C*
     C*                                                                   S01117
     C                     MOVE DRW1      P3DRW1                          S01117
     C*                                                                   S01117
     C* IF MULTIBRANCHING INDICATOR SETOF AND FULL ACCOUNT ENTRY,SINGLE   S01117
     C* BRANCH NEED TO BE FORMATTED BY CUTTING OFF THE BRANCH CODE FROM   S01117
     C* THE END USING A WORK FIELD BEFORE OUTPUTING TO THE PRINTER FILE   S01117
     C*                                                                   S01117
     C           *IN30     IFEQ '0'                                       S01117
     C           DRWT      ANDEQ'G'                                       S01117
     C                     MOVELDRW1      FLD15                           S01117
     C                     MOVE *BLANKS   P3DRW1                          S01117
     C                     MOVELFLD15     P3DRW1                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     Z-ADDPVDT      ZDAYNO           'FORMAT DATE
     C                     EXSR ZDATE2                     'TO DDMMMYY
     C                     MOVE ZADATE    VDATO   7
     C*
     C                     Z-ADDOEDT      ZDAYNO           'FORMAT OEDT
     C                     EXSR ZDATE2                     'TO DDMMMYY
     C                     MOVE ZADATE    FTOEDT  7
     C*
     C** CALL UATBCN TO ACCESS CURRENCY RECORD FOR PAY CURRENCY
     C*
     C                     MOVEL*BLANKS   ZTABKY
     C                     MOVEL'20'      ZTABKY
     C                     MOVELPCCY      WA4
     C                     MOVE '1'       WA4
     C                     MOVE WA4       ZTABKY
     C                     EXSR UATBCN
     C*
     C** CHECK IF DATABASE ERROR OCCURRED
     C*
     C           *IN89     IFEQ '1'
     C                     MOVEL'TABLE'   WBFILE           **********
     C                     MOVELZTABKY    WBKEY            * DBERR 41
     C                     Z-ADD41        WBASE            **********
     C                     EXSR ABORT                      *ABORT PGM*
     C                     END
     C*
     C** STORE NUMBER OF DECIMAL PLACES FOR PAY CURRENCY
     C*
     C                     Z-ADDCDP       SVRCDP  10
     C*
     C                     ADD  COCH      TOTD                    E489
     C                     SUB  DEDS      TOTD                    E489
     C*
     C                     MOVE PCCY      CRNCY
     C                     MOVE PCCY      OCCY
     C                     MOVE PCCY      OCCY1
     C*                                                                   S01499
     C** Check if SAR S01499 is set on                                    S01499
     C*                                                                   S01499
     C           *IN39     IFEQ '1'                                       S01499
     C                     MOVE PCCY      P3VOCY                          S01499
     C                     MOVE PCCY      P3VDCY                          S01499
     C                     END                                            S01499
     C*
     C                     Z-ADDSVRCDP    WDEC
     C           11        SUB  WDEC      WDIG
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE TOTD      WFDIN
     C                     EXSR UGFRMT
     C                     MOVE WFDOUT    P3TOTD
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE TOTR      WFDIN
     C                     EXSR UGFRMT
     C                     MOVE WFDOUT    P3TOTR
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE COCH      WFDIN
     C                     EXSR UGFRMT
     C                     MOVE WFDOUT    P3COCH
     C*
     C                     MOVEL*BLANKS   WFDIN
     C                     MOVE DEDS      WFDIN
     C                     EXSR UGFRMT
     C                     MOVE WFDOUT    P3DEDS
     C*                                                                   S01499
     C** Check if SAR S01499 is set on                                    S01499
     C*                                                                   S01499
     C           *IN39     IFEQ '1'                                       S01499
     C*                                                                   S01499
     C** Format V.A.T. Correspondent                                      S01499
     C*                                                                   S01499
     C                     MOVEL*BLANKS   WFDIN                           S01499
     C                     MOVE PCVATC    WFDIN                           S01499
     C                     EXSR UGFRMT                                    S01499
     C                     MOVE WFDOUT    P3VACO                          S01499
     C                     MOVE PCVAT1    P3CRVF                          S01499
     C*                                                                   S01499
     C** Format V.A.T. Deduction                                          S01499
     C*                                                                   S01499
     C                     MOVEL*BLANKS   WFDIN                           S01499
     C                     MOVE PCVATD    WFDIN                           S01499
     C                     EXSR UGFRMT                                    S01499
     C                     MOVE WFDOUT    P3VADE                          S01499
     C                     MOVE PCVAT2    P3DEVF                          S01499
     C*                                                                   S01499
     C                     END                                            S01499
     C*
     C*  FORMAT 'SNCO' FOR OUTPUT
     C                     MOVE SNCT      PRMTYP  1        ( SNCO )
     C**********           MOVE *ZEROS    PRMFLD 12                                           CGL029
     C                     MOVE *ZEROS    PRMFLD                                              CGL029
     C                     MOVELSNCO      PRMFLD
     C                     EXSR CHOPF
     C                     MOVELPRMFLD    P3SNCO
     C*                                                                   S01117
     C*  FORMAT SWIFT PRIORITY CODE                                       S01117
     C           SWPC      IFEQ 1                                         S01117
     C                     MOVE 'U'       P3SWPC                          S01117
     C                     ELSE                                           S01117
     C           SWPC      IFEQ 2                                         S01117
     C                     MOVE 'N'       P3SWPC                          S01117
     C                     END                                            S01117
     C                     END                                            S01117
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
      *                                                                   CFT009
      ** FX spread set                                                    CFT009
      *                                                                   CFT009
     C                     MOVE FXSSET    FXSPST                          CFT009
      *                                                                   CFT009
      ** Currency                                                         CFT009
      *                                                                   CFT009
     C                     MOVE PCCY      COCCY                           CFT009
     C                     MOVE PCCY      DECCY                           CFT009
      *                                                                   CFT009
      ** Charge code                                                      CFT009
      *                                                                   CFT009
     C                     MOVE CRCHCD    COCDE                           CFT009
     C                     MOVE DECHCD    DECDE                           CFT009
      *                                                                   CFT009
      ** Retrieve currency details                                        CFT009
      *                                                                   CFT009
     C                     CALL 'AOCURRR0'                                CFT009
     C                     PARM *BLANKS   @RTCD                           CFT009
     C                     PARM '*KEY   ' @OPTN                           CFT009
     C                     PARM PCCY      @CURR   3                       CFT009
     C           SDCURR    PARM SDCURR    DSSDY                           CFT009
      *                                                                   CFT009
     C           @RTCD     IFNE *BLANKS                                   CFT009
     C                     MOVE 'SDCURRPD'WBFILE           ************   CFT009
     C                     MOVELPCCY      WBKEY            * DBERR 64 *   CFT009
     C                     Z-ADD64        WBASE            ************   CFT009
     C                     EXSR ABORT                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Prime currency                                                   CFT009
      *                                                                   CFT009
     C                     Z-ADDA6NBDP    WPCCY   10                      CFT009
      *                                                                   CFT009
      ** Amount                                                           CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE COCH      ZFIELD                          CFT009
     C                     Z-ADDWPCCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    COAMT                           CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE DEDS      ZFIELD                          CFT009
     C                     Z-ADDWPCCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    DEAMT                           CFT009
      *                                                                   CFT009
      ** Totals                                                           CFT009
      *                                                                   CFT009
     C           COCH      ADD  DEDS      SUMAMT 150                      CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE SUMAMT    ZFIELD                          CFT009
     C                     Z-ADDWPCCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    TOTAMT                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           CFT010    IFEQ 'Y'                                       CFT009
      *                                                                   CFT009
      ** VAT flags                                                        CFT009
      *                                                                   CFT009
     C                     MOVE PCVAT1    COVAT                           CFT009
     C                     MOVE PCVAT2    DEVAT                           CFT009
      *                                                                   CFT009
      ** VAT amount and total charge                                      CFT009
      *                                                                   CFT009
     C           PCVAT1    IFEQ 'Y'                                       CFT009
     C                     Z-ADDPCVATC    VAT                             CFT009
     C                     Z-ADDVAT       SUMVAT                          CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     Z-ADD0         SUMVAT                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE VAT       ZFIELD                          CFT009
     C                     Z-ADDWPCCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    COVATA                          CFT009
      *                                                                   CFT009
     C           VAT       ADD  COCH      CHG    150                      CFT009
     C                     Z-ADDCHG       SUMCHG 150                      CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE CHG       ZFIELD                          CFT009
     C                     Z-ADDWPCCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    COTOT                           CFT009
      *                                                                   CFT009
     C           PCVAT2    IFEQ 'Y'                                       CFT009
     C                     ADD  PCVATD    VAT                             CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE VAT       ZFIELD                          CFT009
     C                     Z-ADDWPCCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    DEVATA                          CFT009
      *                                                                   CFT009
     C           VAT       ADD  DEDS      CHG                             CFT009
     C                     ADD  CHG       SUMCHG                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE CHG       ZFIELD                          CFT009
     C                     Z-ADDWPCCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    DETOT                           CFT009
      *                                                                   CFT009
      ** Totals                                                           CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE SUMVAT    ZFIELD                          CFT009
     C                     Z-ADDWPCCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    TOTVAT                          CFT009
      *                                                                   CFT009
     C                     MOVE *BLANKS   ZFIELD                          CFT009
     C                     MOVE SUMCHG    ZFIELD                          CFT009
     C                     Z-ADDWPCCY     ZADEC                           CFT009
     C                     EXSR ZEDIT                                     CFT009
     C                     MOVE ZFIELD    TOTCHG                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
     C*
     C                     WRITEP3CRED                 60
     C                     SETON                     83
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
     C                     WRITEP3CRCH                                    CFT009
     C                     ENDIF                                          CFT009
     C*
     C                     ENDSR
     C*
     C********************************************************************
      /EJECT                                                              S01435
      *****************************************************************   S01435
      **                                                                  S01435
      **    Get name for Type.                                            S01435
      **                                                                  S01435
      **    CALLED FROM:  anywhere                                        S01435
      **    CALLS:                                                        S01435
      **                                                                  S01435
      **                                                                  S01435
     C           GETADD    BEGSR                                          S01435
      *                                                                   S01435
      *                                                                   S01435
      *  Set up general parameters                                        S01435
      *                                                                   S01435
     C           *LIKE     DEFN BCCY      XCCY                            S01435
      *                                                                   S01435
     C                     CLEARW8FT                                      S01435
     C                     MOVEL*BLANKS   W8STMT                          S01435
     C                     MOVELXCCY      W8CCY                           S01435
     C                     MOVEL##PGM     W8CPGM                          S01435
     C                     MOVEL'*PRINT'  W8ACT                           S01435
     C                     Z-ADD5         W8NLIN                          S01435
      *                                                                   S01435
      *  Receivers Correspomdent                                          S01435
      *                                                                   S01435
     C                     MOVELXTYPE     W8TYPE                          S01435
     C                     MOVEL*BLANKS   W8LINS                          S01435
     C                     MOVELXNAMDS    W8LINS                          S01435
      *                                                                   S01435
      * Call expansion program                                            S01435
      *                                                                   S01435
     C                     CALL 'FT0315'               8989               S01435
     C                     PARM           W8RTN   7                       S01435
     C                     PARM           W8FT                            S01435
     C                     PARM           W8LINS256                       S01435
     C                     PARM           W8RPT 256                       S01435
     C                     PARM           W8MSG 256                       S01435
     C                     PARM           W8SCR 256                       S01435
      *                                                                   S01435
      ** Check if database error occurred                                 S01435
      *                                                                   S01435
     C           *IN89     IFEQ '1'                                       S01435
     C           W8RTN     ORNE *BLANKS                                   S01435
     C                     MOVEL'FT0315'  WBFILE                          S01435
     C                     MOVEL'*CALL'   WBKEY                           S01435
     C                     MOVEL'52'      WBASE                           S01435
     C                     EXSR ABORT                      *ABORT PGM*    S01435
     C                     END                                            S01435
      *                                                                   S01435
     C                     MOVELW8RPT     XNAMDS                          S01435
      *                                                                   S01435
     C                     ENDSR                                          S01435
      /EJECT                                                              S01435
     C           UCMUSE    BEGSR                                          S01435
     C*          ******    *****                                          S01435
     C*                                                                   S01435
     C*****************************************************************   S01435
     C*                 UC-CHAIN-USER-FILE                            *   S01435
     C*                                                               *   S01435
     C*  FUNCTION : TO ATTEMPT TO ACCESS THE RECORD FROM THE USER     *   S01435
     C*             FILE.                                             *   S01435
     C*                                                               *   S01435
     C*  CALLS :    NONE                                              *   S01435
     C*                                                               *   S01435
     C*  CALLED BY: CCDETL                                            *   S01435
     C*                                                               *   S01435
     C*****************************************************************   S01435
     C*                                                                   S01435
     C           USRP      CHAINMUSERDDF             89                   S01435
     C*                                                                   S01435
     C  N89      RECI      COMP 'D'                  8989                 S01435
      *                                                                   S01435
     C           *IN89     IFEQ '1'                                       S01435
     C                     MOVELUSRP      USER1                           S01435
     C                     END                                            S01435
     C*                                                                   S01435
     C*                    *****                                          S01435
     C                     ENDSR                                          S01435
     C*                    *****                                          S01435
     C/EJECT                                                              S01117
     C********************************************************************S01117
     C**                                                                  S01117
     C** SUBROUTINE TO ACCESS BRANCH NAME(BRNM) FROM TABLETR              S01117
     C**                                                                  S01117
     C**                                                                  S01117
     C           SUBBRN    BEGSR                                          S01117
     C*                                                                   S01117
     C* SET UP KEY TO ACCESS BRANCH NAME                                  S01117
     C*                                                                   S01117
     C                     MOVE *BLANKS   ZTABKY                          S01117
     C                     MOVEL'10    '  ZTABKY                          S01117
     C                     MOVE WRKFLD    ZTABKY                          S01117
     C*                                                                   S01117
     C           ZTABKY    CHAINTABFP                99                   S01117
     C*                                                                   S01117
     C* DATABASE ERROR IF NO RECORD FOUND                                 S01117
     C*                                                                   S01117
     C           *IN99     IFEQ '1'                                       S01117
     C           RECI      ORNE 'D'                                       S01117
     C                     MOVE 'TABLE'   WBFILE           ***************S01117
     C                     MOVELZTABKY    WBKEY            ** DBERR  30 **S01117
     C                     Z-ADD30        WBASE            ***************S01117
     C                     EXSR ABORT                                     S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     ENDSR                                          S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C/EJECT
     C********************************************************************
     C*
     C*  FUNCTION : TO ABORT THE PROGRAM IN THE EVENT OF A DATABASE
     C*             ERROR.
     C*
     C           ABORT     BEGSR
     C*
     C** SETON INDICATORS TO INDICATE DATABASE ERRORS
     C*
     C                     SETON                     U7U8LR
     C*
     C           *NAMVAR   DEFN LDA       DLDA
     C           *LOCK     IN   DLDA
     C                     MOVEL'FT1010'  DBPGM
     C                     MOVELWBKEY     DBKEY
     C                     MOVELWBFILE    DBFILE
     C*********************MOVELWBASE     DBASE                           S01117
     C                     Z-ADDWBASE     DBASE                           S01117
     C                     OUT  DLDA
     C*
     C** REPORT DATABASE ERROR
     C*
     C** Do not perform trailer update                                    171266
     C**********           EXSR INPAYT                                    171266
     C**********           EXSR OTPAYT                                    171266
     C**********           EXSR CQCODT                                    171266
     C**********           EXSR CQCOCT                                    171266
     C**********           EXSR CQPACT                                    171266
     C**********           EXSR CQPADT                                    171266
     C**********           EXSR NTRANT                                    171266
     C**********           EXSR CQREGT                                    171266
     C*
     C*********************MOVELDBASE     P2DBAS                          S01117
     C*********************MOVELDBFILE    P2DBFL                          S01117
     C*********************MOVELDBKEY     P2DBKY                          S01117
     C*********************WRITEP1CONT                                    S01117
     C*********************WRITEP1DBER                                    S01117
     C                     MOVELDBASE     AUDBAS                          S01117
     C                     MOVELDBFILE    AUDBFL                          S01117
     C                     MOVELDBKEY     AUDBKY                          S01117
     C                     WRITEAUCONT                                    S01117
     C                     WRITEAUDBER                                    S01117
     C*
     C** PRODUCE PROGRAM DUMP
     C*
     C                     DUMP
     C*
     C** END PROGRAM
     C*
     C                     RETRN
     C*
     C           UEEND     ENDSR
     C*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C**   COMPARE THE TOTALS ON EACH TRAILER AND SETON THE
     C**   APPROPRIATE ERROR INDICATOR
     C**
     C           TRAILR    BEGSR                           ** TRAILR **
     C*
     C           H         ADD  60        W       20
     C           NORE1     IFNE CTN#,H
     C           HRWN      ORNE CTI#,H
     C           HRDC      ORNE CTD#,H
     C                     MOVE '1'       *IN,W
     C                     END
     C                     ENDSR
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**   .. INPAYT ..
     C**   THIS SUBR. IS USED TO SET-UP FIELDS FOR THE 'CONTROL REPORT'
     C**
     C           INPAYT    BEGSR                           ** INPAYT **
     C*
     C                     Z-ADD1         H
     C                     EXSR TRAILR
     C*
     C           *IN61     IFEQ '1'
     C                     MOVE DIFFXX    DIFF01
     C                     END
     C*
     C                     Z-ADDNORE1     ITN#01
     C                     Z-ADDHRWN      ITI#01
     C                     Z-ADDHRDC      ITD#01
     C                     Z-ADDCTN#,H    CTN#01
     C                     Z-ADDCTI#,H    CTI#01
     C                     Z-ADDCTD#,H    CTD#01
     C*
     C                     ADD  8         H
     C                     Z-ADDCTN#,H    NORE1
     C                     Z-ADDCTI#,H    HRWN
     C                     Z-ADDCTD#,H    HRDC
     C                     Z-ADDCTN#,H    CTN#09
     C                     Z-ADDCTI#,H    CTI#09
     C                     Z-ADDCTD#,H    CTD#09
     C                     MOVEL@R02      RECI                            E32839
     C*********************WRITEXNPAYZZF               88                 E32894
     C                     UPDATINPAYZZF               88                 E32894
     C*
     C           *IN88     IFEQ '1'
     C                     MOVE 'INPAY'   WBFILE           ***************
     C                     MOVELWRTERR    WBKEY            ** DBERR  14 **
     C                     Z-ADD14        WBASE            ***************
     C                     EXSR ABORT
     C                     END
     C                     ENDSR
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**   .. OTPAYT ..
     C**   THIS SUBR. IS USED TO SET-UP FIELDS FOR THE 'CONTROL REPORT'
     C**
     C           OTPAYT    BEGSR                           ** OTPAYT **
     C*
     C                     Z-ADD2         H
     C                     EXSR TRAILR
     C*
     C           *IN62     IFEQ '1'
     C                     MOVE DIFFXX    DIFF02
     C                     END
     C*
     C                     Z-ADDNORE1     ITN#02
     C                     Z-ADDHRWN      ITI#02
     C                     Z-ADDHRDC      ITD#02
     C                     Z-ADDCTN#,H    CTN#02
     C                     Z-ADDCTI#,H    CTI#02
     C                     Z-ADDCTD#,H    CTD#02
     C*
     C                     ADD  8         H
     C                     Z-ADDCTN#,H    NORE1
     C                     Z-ADDCTI#,H    HRWN
     C                     Z-ADDCTD#,H    HRDC
     C                     Z-ADDCTN#,H    CTN#10
     C                     Z-ADDCTI#,H    CTI#10
     C                     Z-ADDCTD#,H    CTD#10
     C                     MOVEL@R04      RECI                            E32839
     C*********************WRITEXTPAYZZF               88                 E32894
     C                     UPDATOTPAYZZF               88                 E32894
     C*
     C           *IN88     IFEQ '1'
     C                     MOVE 'OTPAY'   WBFILE           ***************
     C                     MOVELWRTERR    WBKEY            ** DBERR  15 **
     C                     Z-ADD15        WBASE            ***************
     C                     EXSR ABORT
     C                     END
     C                     ENDSR
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**   .. CQCODT ..
     C**   THIS SUBR. IS USED TO SET-UP FIELDS FOR THE 'CONTROL REPORT'
     C**
     C           CQCODT    BEGSR                           ** CQCODT **
     C*
     C                     Z-ADD3         H
     C                     EXSR TRAILR
     C*
     C           *IN63     IFEQ '1'
     C                     MOVE DIFFXX    DIFF03
     C                     END
     C*
     C                     Z-ADDNORE1     ITN#03
     C                     Z-ADDHRWN      ITI#03
     C                     Z-ADDHRDC      ITD#03
     C                     Z-ADDCTN#,H    CTN#03
     C                     Z-ADDCTI#,H    CTI#03
     C                     Z-ADDCTD#,H    CTD#03
     C*
     C                     ADD  8         H
     C                     Z-ADDCTN#,H    NORE1
     C                     Z-ADDCTI#,H    HRWN
     C                     Z-ADDCTD#,H    HRDC
     C                     Z-ADDCTN#,H    CTN#11
     C                     Z-ADDCTI#,H    CTI#11
     C                     Z-ADDCTD#,H    CTD#11
     C                     MOVEL@R06      RECI                            E32839
     C*********************WRITEXQCODZZF               88                 E32894
     C                     UPDATCQCODZZF               88                 E32894
     C*
     C           *IN88     IFEQ '1'
     C                     MOVE 'CQCOD'   WBFILE           ***************
     C                     MOVELWRTERR    WBKEY            ** DBERR  16 **
     C                     Z-ADD16        WBASE            ***************
     C                     EXSR ABORT
     C                     END
     C                     ENDSR
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**   .. CQCOCT ..
     C**   THIS SUBR. IS USED TO SET-UP FIELDS FOR THE 'CONTROL REPORT'
     C**
     C           CQCOCT    BEGSR                           ** CQCOCT **
     C*
     C                     Z-ADD4         H
     C                     EXSR TRAILR
     C*
     C           *IN64     IFEQ '1'
     C                     MOVE DIFFXX    DIFF04
     C                     END
     C*
     C                     Z-ADDNORE1     ITN#04
     C                     Z-ADDHRWN      ITI#04
     C                     Z-ADDHRDC      ITD#04
     C                     Z-ADDCTN#,H    CTN#04
     C                     Z-ADDCTI#,H    CTI#04
     C                     Z-ADDCTD#,H    CTD#04
     C*
     C                     ADD  8         H
     C                     Z-ADDCTN#,H    NORE1
     C                     Z-ADDCTI#,H    HRWN
     C                     Z-ADDCTD#,H    HRDC
     C                     Z-ADDCTN#,H    CTN#12
     C                     Z-ADDCTI#,H    CTI#12
     C                     Z-ADDCTD#,H    CTD#12
     C                     MOVEL@R08      RECI                            E32839
     C*********************WRITEXQCOCZZF               88                 E32894
     C                     UPDATCQCOCZZF               88                 E32894
     C*
     C           *IN88     IFEQ '1'
     C                     MOVE 'CQCOC'   WBFILE           ***************
     C                     MOVELWRTERR    WBKEY            ** DBERR  17 **
     C                     Z-ADD17        WBASE            ***************
     C                     EXSR ABORT
     C                     END
     C                     ENDSR                           ## E001
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**   .. CQPACT ..
     C**   THIS SUBR. IS USED TO SET-UP FIELDS FOR THE 'CONTROL REPORT'
     C**
     C           CQPACT    BEGSR                           ** CQPACT **
     C*
     C                     Z-ADD5         H
     C                     EXSR TRAILR
     C*
     C           *IN65     IFEQ '1'
     C                     MOVE DIFFXX    DIFF05
     C                     END
     C*
     C                     Z-ADDNORE1     ITN#05
     C                     Z-ADDHRWN      ITI#05
     C                     Z-ADDHRDC      ITD#05
     C                     Z-ADDCTN#,H    CTN#05
     C                     Z-ADDCTI#,H    CTI#05
     C                     Z-ADDCTD#,H    CTD#05
     C*
     C                     ADD  8         H
     C                     Z-ADDCTN#,H    NORE1
     C                     Z-ADDCTI#,H    HRWN
     C                     Z-ADDCTD#,H    HRDC
     C                     Z-ADDCTN#,H    CTN#13
     C                     Z-ADDCTI#,H    CTI#13
     C                     Z-ADDCTD#,H    CTD#13
     C                     MOVEL@R10      RECI                            E32839
     C*********************WRITEXQPACZZF               88                 E32894
     C                     UPDATCQPACZZF               88                 E32894
     C*
     C           *IN88     IFEQ '1'
     C                     MOVE 'CQPAC'   WBFILE           ***************
     C                     MOVELWRTERR    WBKEY            ** DBERR  18 **
     C                     Z-ADD18        WBASE            ***************
     C                     EXSR ABORT
     C                     END
     C                     ENDSR
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**   .. CQPADT ..
     C**   THIS SUBR. IS USED TO SET-UP FIELDS FOR THE 'CONTROL REPORT'
     C**
     C           CQPADT    BEGSR                           ** CQPADT **
     C*
     C                     Z-ADD6         H
     C                     EXSR TRAILR
     C*
     C           *IN66     IFEQ '1'
     C                     MOVE DIFFXX    DIFF06
     C                     END
     C*
     C                     Z-ADDNORE1     ITN#06
     C                     Z-ADDHRWN      ITI#06
     C                     Z-ADDHRDC      ITD#06
     C                     Z-ADDCTN#,H    CTN#06
     C                     Z-ADDCTI#,H    CTI#06
     C                     Z-ADDCTD#,H    CTD#06
     C*
     C                     ADD  8         H
     C                     Z-ADDCTN#,H    NORE1
     C                     Z-ADDCTI#,H    HRWN
     C                     Z-ADDCTD#,H    HRDC
     C                     Z-ADDCTN#,H    CTN#14
     C                     Z-ADDCTI#,H    CTI#14
     C                     Z-ADDCTD#,H    CTD#14
     C                     MOVEL@R12      RECI                            E32839
     C*********************WRITEXQPADZZF               88                 E32894
     C                     UPDATCQPADZZF               88                 E32894
     C*
     C           *IN88     IFEQ '1'
     C                     MOVE 'CQPAD'   WBFILE           ***************
     C                     MOVELWRTERR    WBKEY            ** DBERR  19 **
     C                     Z-ADD19        WBASE            ***************
     C                     EXSR ABORT
     C                     END
     C                     ENDSR
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**   .. NTRANT ..
     C**   THIS SUBR. IS USED TO SET-UP FIELDS FOR THE 'CONTROL REPORT'
     C**
     C           NTRANT    BEGSR                           ** NTRANT **
     C*
     C                     Z-ADD7         H
     C                     EXSR TRAILR
     C*
     C           *IN67     IFEQ '1'
     C                     MOVE DIFFXX    DIFF07
     C                     END
     C*
     C                     Z-ADDNORE1     ITN#07
     C                     Z-ADDHRWN      ITI#07
     C                     Z-ADDHRDC      ITD#07
     C                     Z-ADDCTN#,H    CTN#07
     C                     Z-ADDCTI#,H    CTI#07
     C                     Z-ADDCTD#,H    CTD#07
     C*
     C                     ADD  8         H
     C                     Z-ADDCTN#,H    NORE1
     C                     Z-ADDCTI#,H    HRWN
     C                     Z-ADDCTD#,H    HRDC
     C                     Z-ADDCTN#,H    CTN#15
     C                     Z-ADDCTI#,H    CTI#15
     C                     Z-ADDCTD#,H    CTD#15
     C                     MOVEL@R14      RECI                            E32839
     C*********************WRITEXTRANZZF               88                 E32894
     C                     UPDATNTRANZZF               88                 E32894
     C*
     C           *IN88     IFEQ '1'
     C                     MOVE 'NTRAN'   WBFILE           ***************
     C                     MOVELWRTERR    WBKEY            ** DBERR  20 **
     C                     Z-ADD20        WBASE            ***************
     C                     EXSR ABORT
     C                     END
     C                     ENDSR
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**   .. CQREGT ..
     C**   THIS SUBR. IS USED TO SET-UP FIELDS FOR THE 'CONTROL REPORT'
     C**
     C           CQREGT    BEGSR                           ** CQREGT **
     C*
     C                     Z-ADD8         H
     C                     EXSR TRAILR
     C*
     C           *IN68     IFEQ '1'
     C                     MOVE DIFFXX    DIFF08
     C                     END
     C*
     C                     Z-ADDNORE1     ITN#08
     C                     Z-ADDHRWN      ITI#08
     C                     Z-ADDHRDC      ITD#08
     C                     Z-ADDCTN#,H    CTN#08
     C                     Z-ADDCTI#,H    CTI#08
     C                     Z-ADDCTD#,H    CTD#08
     C*
     C                     ADD  8         H
     C                     Z-ADDCTN#,H    NORE1
     C                     Z-ADDCTI#,H    HRWN
     C                     Z-ADDCTD#,H    HRDC
     C                     Z-ADDCTN#,H    CTN#16
     C                     Z-ADDCTI#,H    CTI#16
     C                     Z-ADDCTD#,H    CTD#16
     C                     MOVEL@R16      RECI                            E32873
     C*********************WRITEXQREGZZF               88                 E32894
     C                     UPDATCQREGZZF               88                 E32894
     C*
     C           *IN88     IFEQ '1'
     C                     MOVE 'CQREG'   WBFILE           ***************
     C                     MOVELWRTERR    WBKEY            ** DBERR  21 **
     C                     Z-ADD21        WBASE            ***************
     C                     EXSR ABORT
     C                     END
     C                     ENDSR
     C********************************************************************
     C/EJECT
      *****************************************************************   CFT006
      * SRRFT   -  This subroutine will purge the general transactions*   CFT006
      *            files for Request for Transfer                     *   CFT006
      * Called by:                                                    *   CFT006
      * Calls    :                                                    *   CFT006
      *****************************************************************   CFT006
     C           SRRFT     BEGSR                                          CFT006
      *                                                                   CFT006
     C           RUND      SUB  BTMAHP    WCALC   50                      CFT006
      *                                                                   CFT006
     C           INDATE    IFLT WCALC                                     CFT006
     C           RFTID     SETLLFT101DL0                                  CFT006
     C           RFTID     READEFT101DL0                 90               CFT006
      *                                                                   CFT006
     C           *IN90     DOWEQ*OFF                                      CFT006
     C                     DELETFT101DL0                                  CFT006
     C           RFTID     READEFT101DL0                 90               CFT006
     C                     ENDDO                                          CFT006
      *                                                                   CFT006
     C                     DELETFT101HPD                                  CFT006
      *                                                                                     MD056935
      ** Drop Message Management 101 record                                                 MD056935
      *                                                                                     MD056935
     C                     MOVELSNDREF    KMEREF                                            MD056935
     C                     MOVEL'101'     KMETYP                                            MD056935
      *                                                                                     MD056935
     C           MEIRFT    CHAINMEIRFTL2             43                                     MD056935
     C           *IN43     IFEQ '0'                                                         MD056935
     C                     DELETMEIRFTD0                                                    MD056935
     C                     ENDIF                                                            MD056935
      *                                                                                     MD056935
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ENDSR                                          CFT006
      /EJECT                                                              CFT006
      *****************************************************************   CFT006
      * SRCCT   -  This subroutine will purge the general transactions*   CFT006
      *            files for Request for Transfer                     *   CFT006
      * Called by:                                                    *   CFT006
      * Calls    :                                                    *   CFT006
      *****************************************************************   CFT006
     C           SRCCT     BEGSR                                          CFT006
      *                                                                   CFT006
     C           RUND      SUB  BTMAHP    WCALC   50                      CFT006
      *                                                                   CFT006
     C           INDATE    IFLT WCALC                                     CFT006
     C           CCTID     SETLLFT102DL0                                  CFT006
     C           CCTID     READEFT102DL0                 90               CFT006
      *                                                                   CFT006
     C           *IN90     DOWEQ*OFF                                      CFT006
     C                     DELETFT102DL0                                  CFT006
     C           CCTID     READEFT102DL0                 90               CFT006
     C                     ENDDO                                          CFT006
      *                                                                   CFT006
     C                     DELETFT102HPD                                  CFT006
      *                                                                                     MD056935
      ** Drop Message Management 102 record                                                 MD056935
      *                                                                                     MD056935
     C                     MOVELFILREF    KMEREF                                            MD056935
     C                     MOVEL'102'     KMETYP                                            MD056935
      *                                                                                     MD056935
     C           MEIRFT    CHAINMEIRFTL2             43                                     MD056935
     C           *IN43     IFEQ '0'                                                         MD056935
     C                     DELETMEIRFTD0                                                    MD056935
     C                     ENDIF                                                            MD056935
      *                                                                                     MD056935
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ENDSR                                          CFT006
      /EJECT                                                              CFT006
4631 C********************************************************************
4632 C**
4633 C**   ZDATE1 SR. TO VALIDATE DATES SUBMITTED AND
4634 C**              CONVERT TO A NUMBER OF DAYS.
4635 C**
4636 C**   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.
4637 C**
4638 C           ZDATE1    BEGSR                           *** ZDATE1 ***
4639 C**
4640 C**   CLEAR DAY NUMBER.
4641 C                     Z-ADD0         ZDAYNO  50
4642 C**
4643 C**   CALCULATION TO DEFINE INPUT DATE FIELD.
4644 C                     Z-ADDZDATE     ZDATE   60
4645 C**
4646 C**   GET INDIVIDUAL DAY, MONTH AND YEAR FIELDS.
4647 C                     MOVE ZDATE     ZYEAR   20
4648 C  N98                MOVELZDATE     ZDAY    20
4649 C   98                MOVELZDATE     ZMTH    20
4650 C                     MOVE ZDATE     ZWRK4   40
4651 C  N98                MOVELZWRK4     ZMTH
4652 C   98                MOVELZWRK4     ZDAY
4653 C**
4654 C**   ENSURE MONTH IS VALID.
4655 C           ZMTH      COMP 0                      9999
4656 C  N99      ZMTH      COMP 12                   99
4657 C   99                GOTO ZDEND1                     BYPASS IF ERROR
4658 C**
4659 C**   CHECK FOR 30 DAY MONTHS.
4660 C           ZMTH      COMP 4                        90IF 90 ON, 30
4661 C  N90      ZMTH      COMP 6                        90DAY MONTH.
4662 C  N90      ZMTH      COMP 9                        90
4663 C  N90      ZMTH      COMP 11                       90
4664 C**
4665 C**   ENSURE DAY IS VALID.
4666 C           ZDAY      COMP 0                      9999
4667 C   90N99   ZDAY      COMP 30                   99
4668 C  N90N99   ZDAY      COMP 31                   99
4669 C   99                GOTO ZDEND1                     BYPASS IF ERROR
4670 C**
4671 C**   CHECK FOR LEAP YEAR AND FEBRUARY.
4672 C           ZYEAR     ADD  28        ZYEAR
4673 C           ZYEAR     DIV  4         ZLYR    20
4674 C                     MVR            ZLY     10     91LEAP YR, 91 ON
4675 C           ZMTH      COMP 2                    93  92FEB., 92 ON
4676 C**                                                   PAST FEB, 93 ON
4677 C**   IF FEBUARY FURTHER VALIDATE DAY.
4678 C  N91 92   ZDAY      COMP 28                   99
4679 C   91 92   ZDAY      COMP 29                   99
4680 C   99                GOTO ZDEND1                     BYPASS IF ERROR
4681 C**
4682 C**   DETERMINE NUMBER OF DAYS FROM 31/12/1971.     NO.OF 4 YR. SPANS
4683 C           ZLYR      MULT 1461      ZDAYNO           X DAYS IN SPAN.
4684 C  N91      ZDAYNO    ADD  ZYDY,ZLY  ZDAYNO           SINCE LAST L.YR
4685 C   91 93   ZDAYNO    ADD  1         ZDAYNO           L.YR.,PAST FEB.
4686 C           ZDAYNO    ADD  ZMDY,ZMTH ZDAYNO           DAYS THIS YEAR
4687 C           ZDAYNO    ADD  ZDAY      ZDAYNO           DAYS THIS MONTH
4688 C**
4689 C           ZDEND1    ENDSR                           * ZDEND1 ENDSR*
4690 C**
4691 C**
4692 C********************************************************************
0669 C/EJECT
0670 C**
0671 C********************************************************************
0672 C**
0673 C**   ZDATE2 SR. TO CONVERT A DAY NUMBER TO DATE FORMATS.
0674 C**
0675 C**   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.
0676 C**
0677 C           ZDATE2    BEGSR                           *** ZDATE2 ***
0678 C**
0679 C**   CLEAR DATE FIELDS.
0680 C                     Z-ADD0         ZDATE   60
0681 C                     MOVEL'       ' ZADATE  7
0682 C**
0683 C**   CALCULATION TO DEFINE INPUT DAY NUMBER.
0684 C                     Z-ADDZDAYNO    ZDAYNO  50
0685 C**
0686 C**   DETERMINE YEAR NUMBER.
0687 C**
0688 C**   ADJUST DAY NUMBER IN CASE LAST DAY OF YEAR.
0689 C           ZDAYNO    SUB  1         ZDAYN1  50   99
0690 C   99                GOTO ZDEND2
0691 C**
0692 C**   CALCULATE NUMBER OF 4 YEAR SPANS SINCE 31/12/1971.
0693 C           ZDAYN1    DIV  1461      ZLYR    20
0694 C                     MVR            ZDAYN1           SAVE REMAINING
0695 C**                                                   DAYS
0696 C**   CALCULATE NUMBER OF REMAINING YEARS.
0697 C                     Z-ADD1         ZWRK2   20
0698 C           ZDTAG1    TAG                             ** ZDTAG1 TAG *
0699 C           ZDAYN1    COMP ZYDY,ZWRK2             90
0700 C  N90      ZWRK2     ADD  1         ZWRK2
0701 C  N90                GOTO ZDTAG1
0702 C           ZWRK2     SUB  1         ZWRK2          91LEAP YR, 91 ON
0703 C**
0704 C**   DECREMENT DAY NO. BY DAYS IN REMAINING YEARS.
0705 C  N91      ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1
0706 C**
0707 C**   CALCULATE ACTUAL YEAR NUMBER.
0708 C           ZLYR      MULT 4         ZWRK3   30
0709 C           ZWRK3     ADD  72        ZWRK3            BASE IS 1972
0710 C                     Z-ADDZWRK3     ZYEAR   20
0711 C           ZYEAR     ADD  ZWRK2     ZYEAR            YEAR
0712 C**
0713 C**   DETERMINE MONTH NUMBER.
0714 C**
0715 C**   ADJUST DAY NO. IN CASE LAST DAY OF LEAP YEAR FEBRUARY.
0716 C                     SETOF                     9293
0717 C   91      ZDAYN1    COMP 59                     9293
0718 C   91N92   ZDAYN1    SUB  1         ZDAYN1
0719 C**
0720 C**   CALCULATE MONTH NUMBER.
0721 C                     Z-ADD2         ZWRK2
0722 C           ZDTAG2    TAG                             ** ZDTAG2 TAG *
0723 C           ZDAYN1    COMP ZMDY,ZWRK2             94
0724 C  N94      ZWRK2     ADD  1         ZWRK2
0725 C  N94                GOTO ZDTAG2
0726 C           ZWRK2     SUB  1         ZWRK2
0727 C**
0728 C                     Z-ADDZWRK2     ZMTH    20       MONTH
0729 C**
0730 C**   DETERMINE DAY OF MONTH.
0731 C**
0732 C**   ADD BACK LAST DAY OF YEAR ADJUSTMENT.
0733 C           ZDAYN1    ADD  1         ZDAYN1
0734 C**
0735 C**   CALCULATE DAY OF MONTH.
0736 C           ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY
0737 C**
0738 C**   ADD BACK LEAP YEAR 29TH FEBUARY ADJUSTMENT, IF REQUIRED.
0739 C   93      ZDAY      ADD  1         ZDAY
0740 C**
0741 C**   FORMAT DATE, DDMMYY OR MMDDYY.
0742 C  N98                MOVELZDAY      ZWRK4   40
0743 C   98                MOVE ZDAY      ZWRK4
0744 C  N98                MOVE ZMTH      ZWRK4
0745 C   98                MOVELZMTH      ZWRK4
0746 C                     MOVELZWRK4     ZDATE
0747 C                     MOVE ZYEAR     ZDATE
0748 C**
0749 C**   FORMAT ALPHA DATE, DDMMMYY.
0750 C           ZDAY      COMP 10                     95
0751 C                     MOVELZDAY      ZWRK5   5
0752 C   95                MOVEL' '       ZWRK5
0753 C                     MOVE ZMNM,ZMTH ZWRK5
0754 C                     MOVELZWRK5     ZADATE
0755 C                     MOVE ZYEAR     ZADATE
0756 C**
0757 C           ZDEND2    ENDSR                           * ZDEND2 ENDSR*
2159 C**
2160 C********************************************************************
     C/COPY WNCPYSRC,FT1010C022
     C/COPY ZSRSRC,ZEDITZ2                                                CFT009
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
**  DESC
Miscellaneous Charge 1                                                    CFT009
Miscellaneous Charge 2                                                    CFT009
Miscellaneous Charge 3                                                    CFT009
Miscellaneous Charge 4                                                    CFT009
Miscellaneous Charge 5                                                    CFT009
