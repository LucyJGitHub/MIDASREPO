      *****************************************************************
/*STD *  PGMBASE                                                      *
/*EXI *  MODULE(GLAMADVU) ACTGRP(*CALLER)                             *
/*EXI *  TEXT('Midas GL Account maintenance validate and update')     *
      *****************************************************************
      *                                                               *
      *  Midas - General Ledger Module                                *
      *                                                               *
      *  GLAMADVU - Transaction validate and update program           *
      *                                                               *
      *  Function:  This program validates and updates transactions   *
      *             received from the front end                       *
      *                                                               *
      *  (c) Finastra International Limited 2003                      *
      *                                                               *
      *  Last Amend No. 250822             Date 22May20               *
      *  Prev Amend No. MD054028           Date 05Sep19               *
      *                 MD041837           Date 16Jun19               *
      *                 CER050             Date 23Mar16               *
      *                 CSD101             Date 07Dec18               *
      *                 CSD102             Date 08Jan19               *
      *                 MD051247           Date 17Jul18               *
      *                 MD044880           Date 15Jan18               *
      *                 MD046248           Date 27Oct17               *
      *                 MD044546           Date 20Mar17               *
      *                 MD043890           Date 06Feb17               *
      *                 MD042713           Date 05Dec16               *
      *                 222427             Date 05Dec16               *
      *                 MD040328           Date 16Aug16               *
      *                 MD040146           Date 11Aug16               *
      *                 LLN022A            Date 03Jun15               *
      *                 LLN022             Date 03Jun15               *
      *                 CRE101             Date 27Aug14               *
      *                 CGL165             Date 17Feb15               *
      *                 MD028970           Date 25Nov14               *
      *                 MD026979           Date 09Jun14               *
      *                 MD024398           Date 11May14               *
      *                 AR801992           Date 27Jul12               *
      *                 AR971184A          Date 22Jun12               *
      *                 AR971184           Date 28May12               *
      *                 AR946674           Date 03Apr12               *
      *                 AR947093           Date 26Apr12               *
      *                 AR847249           Date 28Jan12               *
      *                 CSF011A            Date 28Nov11               *
      *                 CSF011             Date 12Sep11               *
      *                 AR812501           Date 07Sep11               *
      *                 AR820577           Date 31Aug11               *
      *                 CER049             Date 06Dec10               *
      *                 CRE073             Date 06Dec10               *
      *                 CER055             Date 06Dec10               *
      *                 AR802610           Date 15Jul11               *
      *                 CRE075             Date 06Dec10               *
      *                 CER059             Date 19Jul10               *
      *                 262070             Date 26Oct09               *
      *                 BUG24157           Date 04Jun09               *
      *                 BUG22742           Date 07Feb09               *
      *                 CER047             Date 19May08               *
      *                 BUG22973           Date 27May10               *
      *                 BUG23484           Date 27May10               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 CRE015             Date 18Dec09               *
      *                 CRE030             Date 10Jul06               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 256564             Date 17Sep08               *
      *                 BUG17361A          Date 11Apr08               *
      *                 245029A            Date 12Mar07               *
      *                 249966             Date 30Aug07               *
      *                 249660             Date 14Aug07               *
      *                 BUG13639           Date 27Mar07               *
      *                 245648             Date 15Feb07               *
      *                 243436             Date 22Dec06               *
      *                 243129             Date 27Oct06               *
      *                 BUG130120A         Date 24Jan07               *
      *                 BUG130120          Date 24Jan07               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 242488             Date 27Sep06               *
      *                 240916             Date 12Sep06               *
      *                 BUG11670           Date 30Jun06               *
      *                 240037A (Reopen)   Date 15Jun06               *
      *                 240037R (Reopen)   Date 14Jun06               *
      *                 240205             Date 06Jun06               *
      *                 239316             Date 01Jun06               *
      *                 240366             Date 19Jun06               *
      *                 237646             Date 13Jun06               *
      *                 240312             Date 06Jun06               *
      *                 237341             Date 29Apr06               *
      *                 238839 (Reopen)    Date 12Apr06               *
      *                 238625             Date 06Apr06               *
      *                 238839             Date 29Mar06               *
      *                 CSD031             Date 10Apr06               *
      *                 237401             Date 10Feb06               *
      *                 CSD027             Date 09Dec05               *
      *                 BUG10280           Date 02Feb06               *
      *                 CER001             Date 25Apr05               *
      *                 CAP086             Date 08Jun05               *
      *                 BUG9141            Date 02Dec05               *
      *                 BUG8210            Date 02Sep05               *
      *                 BUG8104            Date 19Aug05               *
      *                 CSW037A            Date 02May05               *
      *                 BUG4615            Date 26Oct04               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 BUG4686            Date 05Nov04               *
      *                 BUG4400            Date 30Sep04               *
      *                 CRE010             Date 10Sep04               *
      *                 BUG4252            Date 17Sep04               *
      *                 BUG4196            Date 09Sep04               *
      *                 BUG3068            Date 07Jun04               *
      *                 CLE025             Date 20Oct03               *
      *                 BUG2733            Date 17May04               *
      *                 BG2557             Date 13May04               *
      *                 BG2651             Date 12May04               *
      *                 TDA084             Date 10Apr04               *
      *                 BUG553             Date 14Apr04               *
      *                 CSC022             Date 24Feb04               *
      *                 CAP084  *CREATE    Date 17Jul03               *
      *                                                               *
      *---------------------------------------------------------------*
      *                                                               *
      *  250822 - Recompiled over changes in GLAMADVU.                *
      *  MD054028 - Encountered issues in MQ Testing due to XML not   *
      *             being updated (Recompile)                         *
      *  MD041837 - Tax indicator is not defaulted anymore with       *
      *             CER050.                                           *
      *  CER050 - Annualised Percentage Rate  (Recompile)             *
      *  CSD101 - Password Encryption (Recompile)                     *
      *  CSD102 - Password Length Extension (Recompile)               *
      *  MD051247 - SP15_CUSD API issue (Recompile)                   *
      *  MD044880 - BOE Switched On Testing and Fixing (Recompile)    *
      *  MD046248 - Finastra Rebranding                               *
      *  MD044546 - Enable the ABC flag when CAP205 is on. (Recompile)*
      *  MD043890 - Cannot insert term and notice (Recompile)         *
      *  MD042713 - Display Default Statement commission. (Recompile) *
      *  222427 - AMAN - 'Extra Daily Statement Commission' default   *
      *           value is 0.00.  Data structure which includes       *
      *           DDSTFQ should be included in the parameter list on  *
      *           call to module GLAMAD4DT.                           *
      *           Partially Applied for MD042713. (Recompile)         *
      *  MD040328 - Unable to update Include Account Balance check    *
      *             field via SOAP in AMAD (Recompile)                *
      *  MD040146 - Account maintenance - Account name different from *
      *             Customer report name (Recompile)                  *
      *  LLN022A - BOE Upgrade to MidasPlus (Recompile)               *
      *  LLN022  - BOE Upgrade to MidasPlus (Recompile)               *
      *  CRE101 - Interim Interest Statement on a Frequency           *
      *           (Recompile)                                         *
      *  CGL165 - Dual Withholding Tax (Recompile)                    *
      *  MD028970 - Added checking for feature CRE010 when processing *
      *             Account Balance Check (Recompile).                *
      *  MD026979 - Added field for Retail account and IBAN           *
      *             validation against WIP entries (Recompile)        *
      *  MD024398 - API Performance Optimisation (Recompile)          *
      *  AR801992 - Recompile due to change in GLAMADVU.              *
      *             (Child: AR801993)                                 *
      *  AR971184A- During Amend Front Ofc Id must be updated with the*
      *             new one (Recompile)                               *
      *  AR971184 - For some JMS APIs (CUSD, AMAD, DPMV, OPAY), Front *
      *             Office Id is no more updated in master database   *
      *             files which provokes some big problems in third   *
      *             party product such as TOF.(Child:AR971185)        *
      *             (Recompile)                                       *
      *  AR946674 - Serious midas error has occured                   *
      *             (Child: AR946675) (Recompile)                     *
      *  AR947093 - Base Rate amendment resulted to 0 interest rate   *
                    (Recompile)                                       *
      *  AR847249 - Negative interest is shown in the main list and   *
      *             Loan Details enquiry screen (Recompile)           *
      *  CSF011A - CCR015: Display Order in Confirmation Pages        *
      *            (Recompile)                                        *
      *  CSF011 - Customer Name on Inputs (Recompile)                 *
      *  AR812501 - Acct name is mandatory in MQ/SOAP testing of AMAD *
      *             (Recompile)                                       *
      *  AR820577 - Previous Overdraft fields not displayed in        *
      *             Confirmation pages for Close action (Recompile)   *
      *  CER049 - Stamp Tax (Recompile)                               *
      *  CRE073 - Interest Rate Rounding (Recompile)                  *
      *  CER055 - Penalty Interest on Exceeding Overdraft Limit       *
      *           (Recompile)                                         *
      *  AR802610 - Add Interest Scale flag in API definition.        *
      *             (Recompile)                                       *
      *  CRE075 - Effective Date for Retail Accounts (Recompile)      *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  262070 - Problem with flag for par24C in Account details.    *
      *           Recompile due to changes in GLAMADVU Module.        *
      *  BUG24157 - AMAD KWG field does not default to CUAP KWG       *
      *           field when field is set to Y (Recompile)            *
      *  BUG22742 - Rectify the invalid defaulting when customer is   *
      *             flagged as Taxable (Recompile)                    *
      *  CER047 - German Features LF037-00 Reporting §24c KWG         *
      *           (Recompile)                                         *
      *  BUG22973 - No TimeStamp in Transaction Confirmation during   *
      *             Completion and Authorisation (Recompile)          *
      *  BUG23484 - Amend and AutoAuthorise existing record via SOAP  *
      *             fails, gets error message MMM1067 (Recompile)     *
      *  CRE015 - Retail Term and Notice Accounts (Recompile)         *
      *  CRE030 - Default RE Accounts by Currency (Recompile)         *
      *  256564 - Recompile due to PF changes done by fix 256330      *
      *  BUG17361A- Incorrect IBAN number written on account          *
      *             maintenance(Recompile)                            *
      *  245029A - Recompiled due to change in GLAMADVU module.       *
      *  249966 - Recompiled due to changes in MOD/GLAMADVU           *
      *  249660 - Recompiled due to changes in MOD/GLAMADVU           *
      *  BUG13639 - Serious midas error in AMAD (Recompile)           *
      *  245648 - Recompiled due to change in GLAMADVU module.        *
      *  243436 - Recompile due to change in GLAMADVU                 *
      *  243129 - Recompiled over changes in GLAMADVU.                *
      *  BUG13120A - Reverse Fix for BUG13120                         *
      *  BUG13120 - Missing Field - Passbook used on savings account  *
      *  242488  - Recompiled due to change in GLAMADVU module.       *
      *  240916  - Allowed execution of subroutine DFT@O when DDACTN  *
      *            is equal to 'I'.  Recompile due to change in       *
      *            module/GLAMADVU.                                   *
      *  BUG11670 - System should not default the transaction customer*
      *           on the facility details tab (Recompile)             *
      *  240037A (Reopen) - Serious Midas error - incomplete facility *
      *                     customer during input of accounts         *
      *                     (Recompile)                               *
      *  240037R (Reopen) - Serious Midas error - incomplete facility *
      *                     customer during input of accounts         *
      *                     (Recompile)                               *
      *  240205 - Recompiled due to change in GLAMADVU module         *
      *  239316 - Applied core fix TMPFX01.                           *
      *  240366 - Recompiled due to change in MOD/GLAMADVU.           *
      *  237646 - Recompiled due to change in GLAMADVU.               *
      *  240312 - WPROCDATE is not initialised properly               *
      *         - Wrong parameters on call to GLAMADCVT               *
      *         - Allow defaulting only if called from initial screen *
      *  237341 - Recompiled due to change in GLAMADVU.               *
      *  238839 (Reopen) - IBAN field disappears when message RE72026 *
      *           is displayed because DDIBA1 is blank.  Execute      *
      *           GLVALID within INVALID tag, do not execute DFT@O    *
      *           if there are errors.                                *
      *  238625 - DDICNST is incorrect, initialise field properly     *
      *  238839 - Pass parameter DDIBAN to GLAMADRTV.                 *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  237401 - Recompiled due to change in GLAMADVU                *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  BUG10280- Could not Amend record on AMAD                     *
      *  CER001 - LUX Upgrade to MidasPlus (Recompile only)           *
      *  CAP086 - Introduce Auto Authorisation to the API's           *
      *           without it. (Recompile)                             *
      *  BUG9141 - Only call ValdAcMast if delete (recompile)         *
      *  BUG8210 - GLC3571 failed due to DBERR in ACCNTBXC (empty)    *
      *            Need to change condition to read/write on ACCNTBXC *
      *            simply for all retail accounts. (Recompile)        *
      *  BUG8104- Reinstate call to AOACODR0 to populate A5ACTY       *
      *           needed by condition to display. BUG8104 shows an    *
      *           error message 'Portfolio Reference not valid'.      *
      *           This occurs when DDPTFR is validated as blank but   *
      *           not displayed. To prevent TMPFX01 from reoccuring,  *
      *           do not add message to array as this is also done in *
      *           GLAMAD1VL in validation GLVPFPO (recompile).        *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  BUG4615 - Show warning message upon deletion of account      *
      *            with cheque book details still existing            *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  BUG4686- Recompiled due to change in GLAMADVU                *
      *  BUG4400 - DB error due to invalid timestamp (Recompile)      *
      *  CRE010 - Retail Account Balance Check (Recompile)            *
      *  BUG4252 - Make sure files are mapped correctly (RECOMD/      *
      *            GLVAMCOPD and REAPWDPD/GLVAMPWPD)                  *
      *  BUG4196- Stopping changes being overwritten by other user    *
      *           when try to amend the record at the same time.      *
      *  BUG3068- Recompiled due to change in GLAMADVU module        *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  BUG2733 - Recompile over changes to GLAMADVU *module.        *
      *  BG2557 - Recompiled due to changes in module for CSD012,     *
      *           Standing Data Authorisation.                        *
      *  BG2651 - DB error occurs if currency is blank on insert      *
      *  TDA084 - Recompiled due to changes in module                 *
      *  BUG553 - Ensure SRDEFT defaulting is for blank fields.       *
      *         - Set defaults from default RE account if applicable. *
      *         - Remove changes for BUG545 after fix BUG1271.        *
      *         - Remove CPY@ array from footer of source.            *
      *  CSC022 - Commitment Control Changes for MidasPlus            *
      *           (Recompile)                                         *
      *  CAP084 - Creation of wrappers for use with front end.        *
      *                                                               *
      *****************************************************************
