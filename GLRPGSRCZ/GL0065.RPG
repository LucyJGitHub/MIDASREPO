     H        1
      *****************************************************************
/*XBI1*  OVRDBF FILE(APOST)    TOFILE(GLWKPSPD )                      *                      BUG4844
/*X*I****OVRDBF*FILE(GLAPSGL0)*TOFILE(GLAPSGAL0)***********************                      BUG4844
/*XBI2*  OVRDBF FILE(GLAPSGL0) TOFILE(GLAPSGAL0)                      *                      BUG4844
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas GL Balance statements')                          *
      *****************************************************************
      *                                                               *
      *  Midas GENERAL LEDGER MODULE                                  *
      *                                                               *
      *  GL0065 - BALANCE STATEMENTS (A/C FORMATS)                    *
      *                                                               *
      *  NOTE: This program is a duplicate of GL0420.                 *
      *                                                               *
      *  (c) Finastra International Limited 2003                      *
      *                                                               *
      *  Last Amend No. MD055733           Date 03Jul20               *
      *  Prev Amend No. MD050139           Date 23Mar18               *
      *                 MD046248           Date 27Oct17               *
      *                 CGL184             Date 07Dec16               *
      *                 CLE064             Date 06Dec10               *
      *                 AR676213           Date 19Nov10               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 239641             Date 03Aug06               *
      *                 CRE026             Date 24May06               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 BUG4844            Date 20Oct03               *
      *                 CLE025             Date 20Oct03               *
      *                 CGL025  *CREATE    Date 19Aug03               *
      *                                                               *
      *---------------------------------------------------------------*
      *                                                               *
      *  MD055733 - COB: Multiple UTCHOBJEX calls in LEC06A           *
      *             components.                                       *
      *           - Redeliver of MD050139.                            *
      *  MD050139- AOSARDR0 called every time causing performance     *
      *            issue. Recompile due to changes in /COPY           *
      *            ZFREQ/ZFRQ*.                                       *
      *  MD046248 - Finastra Rebranding                               *
      *  CGL184 - New Frequencies for Account Statements (Recompile)  *
      *  CLE064 - Enhancement of Lending Frequencies (Recompile)      *
      *  AR676213 - Incorrect definition of CLGLAI field (Recompile)  *
      *             (Child: AR676229)                                 *
      *  239641 - As requested by the client, remove the '03' skip to *
      *           save 1 page of stationary every time 'END OF REPORT'*
      *           is printed.                                         *
      *  CRE026 - Consumer Banking (Recompile)                        *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  BUG4844- Errors in on-line statements                        *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CGL025 - Statement of Account for a Specific Period.         *
      *                                                               *
      *****************************************************************
     FTABTG30 IT  F      40           EDISK
      *
     F/COPY WNCPYSRC,GL0065FFP2
      *
     FSTMTS   IP AF      67 20AI     1 DISK
      *
     F/COPY WNCPYSRC,GL0065FFP3
      *
     FACCNT   IF  F     573 24AI     2 DISK
     FREIAC   IF  F     218 24AI     2 DISK
     F/COPY WNCPYSRC,GL0065F005
     FGL0420AUO   F     132     OV     PRINTER      KINFDS SPOOLU
     FGL0420P6O   F     132     OF     PRINTER      KINFDS SPOOL6     UC
     F/COPY WNCPYSRC,GL0065F006
     FGL0420P5O   F     132     OA     PRINTER      KINFDS SPOOL5     UC
     F/COPY WNCPYSRC,GL0065F003
     FGL0420P4O   F     132     OB     PRINTER      KINFDS SPOOL4     UC
     F/COPY WNCPYSRC,GL0065F001
     FGL0420P3O   F     132     OC     PRINTER      KINFDS SPOOL3     UC
     F/COPY WNCPYSRC,GL0065F002
     FGL0420P2O   F     132     OD     PRINTER      KINFDS SPOOL2     UC
      *
     F/COPY WNCPYSRC,GL0065FFP4
      *
     FGL0420P1O   F     132     OE     PRINTER      KINFDS SPOOL1     UC
     F*
     F/COPY WNCPYSRC,GL0065FFP1
     F*
     FAPOST   IF  F     620 24AI     2 DISK
     F/COPY WNCPYSRC,GL0065F004
     F*
     FGLAPSTPDIF  E           K        DISK
     FGLAPSGL0IF  E           K        DISK
     FSDCMANL0IF  E           K        DISK
     FREGAHLJ2IF  E           K        DISK
     F** Core hook for externalisation.
     F/COPY WNCPYSRC,GL0065FFPG
     F*
     F*       01      STMTS - STATEMENTS EXTRACT RECORD
     F*       02      AT LEAST ONE POSTING FOR STATEMENT
     F*       03      ACCNT - ACCOUNT MASTER DETAIL RECORD
     F*       04      APOST - RATE CHANGE POSTINGS
     F*       06      APOST - POSTINGS RECORD
     F*       07      LAST ADDRESS
     F*       08      WORK INDICATOR
     F*       09      CHAIN FAILED TO REIAC FILE
     F*       10      PRINT BALANCES IN EUROS
     F*       11      CATCHALL
     F*       12      PRINT RATE CHANGE INDICATOR IS 'N'
     F*       13      STATEMENTS TRAILER
     F*       14      POSTING TRAILER
     F*       15      NO MORE POSTINGS FOR ACCOUNT
     F*       16      DATABASE ERROR-NO TRAILER ON STMTS FILE
     F*       17      CARRIED FORWARD CLEARED BALANCE IS DEBIT.
     F*       18      PRINT HEADINGS IN TOTAL TIME FOR FORMAT 5.
     F*       19      PRINT LINE FOR CLEARINGS AFTER LAST POST.
     F*       20      RETAIL INDICATOR - '0'
     F*       21                       - '1'
     F*       22      A POSTING AMOUNT IS POSITIVE
     F*       23      A POSTING AMOUNT IS NEGATIVE
     F*       24      CHAIN GLAPSTPD
     F*       25      CHEQUE NO. ZERO
     F*       26      LEDGER BALANCE ZERO
     F*       27       BLANK RETAIL NO.
     F*       28      CLEARED BALANCE BROUGHT FORWARD IS DEBIT.
     F*       29      WORK INDICATOR
     F*       30      FIRST CYCLE INDICATOR
     F*       31      LOKUP FOR EQUAL ENTRY
     F*       32      CLEARED BALANCE AFTER CLEARING ENTRY IS DEBIT.
     F*       33      NO STATEMENT RECORD
     F*       34      MANAGEMENT STATEMENT                     DATE
     F*       35      DEMAND STATEMENT
     F*       36      PRINT ADDRESS
     F*       37      CLEARED BALANCE IS DEBIT.
     F*       38      RETAIL ACCOUNT
     F*       39      ALREADY APPEARED ON STATEMENT
     F*       40      PRINT FORMAT - '5'
     F*       41      PRINT FORMAT - '1'
     F*       42                   - '2'
     F*       43                   - '3'
     F*       44                   - '4'
     F*       45      LAST  LINE OF NEW PAGE OF STATEMENT
     F*       46      FIRST PAGE OF STATEMENT
     F*       47      THE PRESENT POSTING BALANCE IS POSITIVE
     F*       48      FIRST PAGE INDICATOR
     F*       49      INDICATES MOVEMENT ON THIS POSTING DATE
     F*       50      PRINT INITIAL DETAILS
     F*       51      PRINT DETAIL RECORDS
     F*       52      PRINT FINAL DETAILS
     F*       53      WRITE POSTING TO POSTO FILE
     F*       54      EXCEPTION TO UPDATE ACCOUNT
     F*       55      STATEMENT FREQUENCY IS 'A'
     F*       56      POSTING DATE GREATER THAN NEXT STATEMENT DATE
     F*       57      POSTING DATE GREATER THAN RUN DATE
     F*       59      NEXT STATMT DATE LESS THAN NEXT WORKING DAY
     F*               OR ELSE THIS IS A DEMAND STATMT
     F*               OR STFQ = 'A' AND NOT A MANAGEMENT STATEMENT
     F*       60      INITIAL PRINTING FORMAT - 1
     F*       61      DETAIL PRINTING FORMAT - 1
     F*       62      INITIAL PRINTING FORMAT - 2
     F*       63      DETAIL PRINTING FORMAT - 2
     F*       64      INITIAL PRINTING FORMAT - 3
     F*       65      DETAIL PRINTING FORMAT - 3
     F*       66      INITIAL PRINTING FORMAT - 4
     F*       67      DETAIL PRINTING FORMAT - 4
     F*       68      UPDATE THE NEXT STATMNT DATE
     F*       69      POSTING DATE NE VALUE DATE
     F*       70      CURRENCY DECIMAL - 0
     F*       71                       - 1
     F*       72                       - 2
     F*       73                       - 3
     F*       73                       - 3
     F*       74      ITEMS HAVE BEEN CLEARED SINCE LAST STATEMENT.
     F*       75      PRINT ITEMS HAVE BEEN CLEARED SINCE LAST STATEMENT.
     F*       76      ERROR IN OBTAINING STANDING DATA DETAILS
     F*       77      CHAIN FAILED TO - ACCOUNT FILE
     F*       78      PRINT ORIGINAL CURRENCY AND AMOUNT
     F*       80      MANAGEMENT STATEMENT  - INITIAL 1
     F*       81                            - DETAIL 1
     F*       82      DATABASE ERROR-NO TRAILER ON APOST FILE
     F*       84      PRTF GL0420Pn OPEN FOR OUTPUT
     F*       87      INITIAL PRINTING FORMAT - 5.
     F*       88      WORK INDICATOR FOR FORMAT 5 PROCESSING.
     F*       89      DETAIL PRINTING FORMAT - 5.
     F*       U7      DATABASE ERROR
     F*       U8      FILES OUT OF BALANCE
     F*
     F*       L1      LEVEL BREAK ON ACCOUNT TYPE
     F*       L4      LEVEL BREAK ON BRANCH CODE
     F*       KA      EURO CURRENCY DECIMAL - 0
     F*       KB                            - 1
     F*       KC                            - 2
     F*       KD                            - 3
     F*       KE      ORIGINAL CURRENCY DECIMAL - 0
     F*       KF                                - 1
     F*       KG                                - 2
     F*       KH                                - 3
     F*
      *
     E/COPY WNCPYSRC,GL0065EEP1
      *
     E                    CPY@    1   1 80
     E                    TYPE    5   5  1               STATEMENT TYPES
     E                    FORM        5  1               STATEMENT FORMATS
     E                    ZFMD   12  12  2               ZFREQ SR.ARRAY
     E                    ZYDY    4   4  4 0             ZDATE1/2 SR.ARRAY
     E                    ZMDY   13  13  3 0             ZDATE1/2 SR.ARRAY
     E                    ZMNM   12  12  3               ZDATE2 SR. ARRAY
     E/COPY WNCPYSRC,GL0065E002
     E                    VCAR       60 15 0             CLBAL CR. ARRAY
     E                    VDAR       60 15 0             CLBAL DR. ARRAY
     E                    ARAD       10  1               ADDRESS REFERENCE
     E    TABTG30         CY      1 200  3   CYD    37   CCY/CCY DETAILS
     E/COPY WNCPYSRC,GL0065E001
     E/COPY ZSRSRC,ZHOLE
      *
     E/COPY WNCPYSRC,GL0065EEP2
      *
     I*
     I**
     I*    ACCOUNT I.D.S EXTRACT DETAIL RECORD
     I**
     I*
     I/COPY WNCPYSRC,GL0065IIP5
     I*
     ISTMTS   NS  01   1 CD
     I*
     I/COPY WNCPYSRC,GL0065IIP6
     I*
     I                                        1   1 RECI
     I                                        2   2 ATYP
     I                                        3   5 BRCA  L4
     I**********                              6  110CNUM  L3                                  CSD027
     I                                        6  11 CNUM  L3                                  CSD027
     I                                       12  14 CCY   L2
     I                                       15  180ACODQQ
     I                                       19  200ACSQ
     I                                        3  14 MTCH
     I                                        6  14 MTCHS
     I                                       22  260ENDD
     I/COPY WNCPYSRC,GL0065I020
     I                                       30  32 DUMMY L1              S01117
     I                                    P  33  350LSTD                  S01161
     I                                    P  36  380NSTD                  S01161
     I                                    P  39  400LSTP                  S01161
     I**                                  P  41  480CFSB                  S01161
     I                                    P  41  480CFSB            26    E18546
     I                                    P  49  560YTDB                  S01161
     I                                       57  57 GLBT                  S01161
     I                                       58  670ACOD
     I*                                                                   S01408
     I/COPY WNCPYSRC,GL0065IIP4                                           S01408
     I*                                                                   S01408
     I        NS  13   1 CT
     I                                        2   60STMSIZ
     I*
     I**
     I*    CATCHALL FOR DELETED RECORDS
     I**
     I        NS  11
     I******
     I**
     IREIAC   NS
     I                                       17  18 DICT
     I                                       41  42 CICT
     I**
     I*    ACCOUNT POSTING
     I**
     I*                                       2  16 MATCH   M1
     I*                                   P  33  350PSTD  L1
     I*                                     103 1050BRCD    M2
     I*                                     124 124 ATYP    M3
      *
     I/COPY WNCPYSRC,GL0065IP10
      *
     IAPOST   NS  06   1 CP
      *
     I/COPY WNCPYSRC,GL0065IP11
      *
     I                                        1   1 RECI
     I/COPY WNCPYSRC,GL0065I005
     I                                        2  16 APKEY
     I**********                              2   70CNUM                                      CSD027
     I                                        2   7 CNUM                                      CSD027
     I                                        8  10 CCY
     I                                       11  140ACODQQ
     I                                       15  160ACSQ
     I                                    P  33  350PSTD
     I                                    P  36  380VALD
     I/COPY WNCPYSRC,GL0065I010
     I                                       39  43 TRAT
     I/COPY WNCPYSRC,GL0065I011
     I                                       44  73 PNAR
     I                                    P  74  800PSTA
     I                                       81  810DRCR        222223
     I**********                             82  870ASOC                                      CSD027
     I                                       82  87 ASOC                                      CSD027
     I/COPY WNCPYSRC,GL0065I014
     I                                       88  950CHQN            25
     I/COPY WNCPYSRC,GL0065I016
     I                                       96 102 SPOS
     I/COPY WNCPYSRC,GL0065I015
     I                                      103 105 BRCA
     I/COPY WNCPYSRC,GL0065I001
     I                                      106 1060RIND        212120
     I/COPY WNCPYSRC,GL0065I002
     I**                                    124 124 ATYP
     I                                      124 124 ATYPA
     I                                      128 128 CUOR
     I/COPY WNCPYSRC,GL0065I003
     I                                        1 170 LOTP
     I*
     I/COPY WNCPYSRC,GL0065IIP2
     I                                      317 319 XRFI
     I                                      320 3290XRFN
     I                                      590 5990ACOD
     I*
     I** RATE CHANGE POSTING
     I*
     I        NS  04   1 CR
     I/COPY WNCPYSRC,GL0065I006
     I                                        1   1 RECI
     I/COPY WNCPYSRC,GL0065I007
     I                                        2  16 APKEY
     I**********                              2   70CNUM                                      CSD027
     I                                        2   7 CNUM                                      CSD027
     I                                        8  10 CCY
     I                                       11  140ACODQQ
     I                                       15  160ACSQ
     I/COPY WNCPYSRC,GL0065I008
     I                                    P  33  350PSTD
     I                                    P  36  380VALD
     I/COPY WNCPYSRC,GL0065I012
     I                                       39  43 TRAT
     I/COPY WNCPYSRC,GL0065I013
     I                                       44  73 PNAR
     I                                       81  810DRCR        222223
     I                                       96 102 SPOS
     I                                      103 105 BRCA
     I/COPY WNCPYSRC,GL0065IABN
     I                                      124 124 ATYPA
     I                                      128 128 CUOR
     I                                    P 147 1527INTR
     I                                      153 1540BRT
     I                                    P 155 1607RTSP
     I                                      161 1700ACOD
     I/COPY WNCPYSRC,GL0065I004
     I                                        1 170 LOTP
     I*
     I/COPY WNCPYSRC,GL0065IIP9
     I*
     I** CATCHALL FOR DELETED RECORDS
     I*
     I        NS  11
     I                                        2  16 APKEY
     I*
     I** ACCOUNT MASTER DETAIL RECORD
     I*
     IACCNT   NS  03   1 CD
     I       OR   03   1 CC
     I                                        1   1 RECI
     I                                        2  16 ACMDKY
     I                                        2  16 FICHEK
     I**********                              2   70CNUM                                      CSD027
     I                                        2   7 CNUM                                      CSD027
     I                                        8  10 CCY
     I                                       11  140ACODQQ
     I                                       15  160ACSQ
     I                                       23  25 BRCDAM
     I                                       26  26 ATYP
     I                                       28  28 MFFQ
     I                                       29  29 ACST
     I                                    P  30  320DACO
     I                                    P  33  350DACC
     I                                       36  55 ANAM
     I                                    P  56  630LDBL
     I                                    P  64  710CLBL
     I                                       72  72 STFQ
     I                                       73  740STDY
     I                                    P  75  770LSTDP
     I                                    P  78  800NSTDP
     I                                    P  81  820LSTPP
     I                                    P  83  900CFSBP
     I                                    P  91  930LMVD
     I                                    P  94 1010EPLB
     I                                    P 102 1090EPCB
     I                                    P 110 1170CFCB
     I                                      118 118 GLBTB
     I                                      119 126 ADF1
     I                                      174 175 ADF2
     I                                      190 1990ACNO            27
     I*
     I/COPY WNCPYSRC,GL0065IIP7
     I*
     I                                      397 397 CHTP
     I                                    P 398 4000TNLU
     I*
     I/COPY WNCPYSRC,GL0065IIP3
     I*
     I                                      448 448 EUSB
     I                                      449 482 IBAN
     I                                      554 5630ACOD
     I/COPY WNCPYSRC,GL0065I019
     I*
     I** CATCHALL FOR DELETED RECORDS
     I*
     I        NS  11
     I/COPY WNCPYSRC,GL0065I009
     I** DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
     ICPYR@#      DS
     I                                        1  80 CPY@
     I*
     I** LOCAL DATA AREA
     ILDA        UDS                            256
     I                                      134 141 DBFILE
     I                                      142 170 DBKEY
     I                                      171 180 DBPGM
     I                                      181 1830DBASE
     I** MICROFICHE FREQ & SORT FIELD
     I            DS
     I                                        1  16 FICHE
     I                                        1   1 MFFQ
     I                                        2  16 FICHEK
     I**   GLAPSTGA fields
     I            DS
     I                                        1  24 SRCGL
     I                                        1   3 AGSBRC
     I**********                              4   90AGSCUS                                    CSD027
     I                                        4   9 AGSCUS                                    CSD027
     I                                       10  12 AGSCCY
     I                                       13  220AGSACD
     I                                       23  240AGSASN
     I                                       25  340AGSRNO
     I                                       25  34 SRCRET
     I            DS
     I                                        1 200 CMTXTG
     I                                        1  65 WCMTX1
     I                                       66 130 WCMTX2
     I                                      131 195 WCMTX3
     I                                      196 260 WCMTX4
     I*
     ICYDDS       DS                             37
     I                                        1   10CDP
     I                                       18  31 CCNM
     ISAVKEY      DS
     I                                        1   3 BRCA
     I**********                              4   90CNUM                                      CSD027
     I                                        4   9 CNUM                                      CSD027
     I                                       10  12 CCY
     I                                       13  220ACOD
     I                                       23  240ACSQ
     I/COPY WNCPYSRC,GL0065I017
     I*
     I** FILE INFORMATION DATA STRUCTURE
     I*
     ISPOOL1      DS
     I                                       83  90 SFILE1
     I                                    B 123 1240SFNUM1
     I                                    B 243 2460SWRIT1
     I*
     ISPOOL2      DS
     I                                       83  90 SFILE2
     I                                    B 123 1240SFNUM2
     I                                    B 243 2460SWRIT2
     I*
     ISPOOL3      DS
     I                                       83  90 SFILE3
     I                                    B 123 1240SFNUM3
     I                                    B 243 2460SWRIT3
     I*
     ISPOOL4      DS
     I                                       83  90 SFILE4
     I                                    B 123 1240SFNUM4
     I                                    B 243 2460SWRIT4
     I*
     ISPOOL5      DS
     I                                       83  90 SFILE5
     I                                    B 123 1240SFNUM5
     I                                    B 243 2460SWRIT5
     I*
     ISPOOL6      DS
     I                                       83  90 SFILE6
     I                                    B 123 1240SFNUM6
     I                                    B 243 2460SWRIT6
     I*
     I** Core hook for externalisation.
     I/COPY WNCPYSRC,GL0065IIPG
     I*
     ISPOOLU      DS
     I                                       83  90 SFILEU
     I                                    B 123 1240SFNUMU
     I*
     IWKEYDS      DS
     I                                        1   3 WBRCA
     I                                        4   9 WCNUM
     I                                       10  12 WCCY
     I                                       13  22 WACOD
     I                                       23  24 WACSQ
     I                                       25  29 WRUND
     I*
     I** DEFINE BLANK FIELDS FOR USE WITH SWRIT1 - SWRIT5
     I*
     I@BIN1       DS
     I                                    B   1   40@BBIN1
     I*
     I@BIN2       DS
     I                                    B   1   40@BBIN2
     I*
     I@BIN3       DS
     I                                    B   1   40@BBIN3
     I*
     I@BIN4       DS
     I                                    B   1   40@BBIN4
     I*
     I@BIN5       DS
     I                                    B   1   40@BBIN5
     I*
     I@BIN6       DS
     I                                    B   1   40@BBIN6
     I*
     I              'ORIGINATING ACCOUNT:'C         W#ORAC
     I*
     I** Core hook for externalisation.
     I/COPY WNCPYSRC,GL0065IIP1
     I*
     IDSFDY     E DSDSFDY
     I** ACCESS PGM PARAMETER DS
     I*
     I/COPY WNCPYSRC,GL0065IP12
      *
     I/COPY ZSRSRC,ZHOLDS
      *
     I/COPY WNCPYSRC,GL0065IP13
      *
     ISDALTN    E DSSDALTNPD
     I*
     I** ALTERNATIVE NAMES AND ADDRESSES
     I*
     ISDBANK    E DSSDBANKPD
     I**   BANK DETAILS
     I              BJSLCD                          BJE2TX
     I*
     ISDBRCH    E DSSDBRCHPD
     I*
     I** BRANCH CODE
     I*
     ISDGELR    E DSSDGELRPD
     I*
     I** GENERAL LEDGER
     I*
     ISDRETL    E DSSDRETLPD
     I              QQACCD                          QQACD1
     I*
     I** SARS INSTALLED FILE
     I*
     ISCSARD    E DSSCSARDPD
     I*
     I** RETAIL DETAILS
     I*
     ISDTRAD    E DSSDTRADPD
     I              QQACCD                          QQACD2
     I*
     I** TRADING DATA
     I*
     ISDCUST    E DSSDCUSTPD
     I** CUSTOMER DETAILS
     I              QQDFAC                          DFACQQ
     I*
     ISDCURR    E DSSDCURRPD
     I** CUSTOMER DETAILS
     I*
     IGLSTAT      DS                            256
     I*
     I** External DTAARA for Zero Balance/No Movement Indicator
     I*
     I                                       69  69 MOVI
     IRUNDT       DS
     I*
     I** External DTAARA for run-date
     I*
     I                                        1   7 RUNA
     I/COPY WNCPYSRC,GL0065I018
     I                                    P   8  100RUND
     I                                       11  11 SSF
     I                                       12  12 DATF
     I                                       13  13 MBIN
     I*
     I/COPY ZSRSRC,ZHOLI
     I*
     I/COPY WNCPYSRC,GL0065IIP8
     I*
     C/EJECT
     C                     MOVEACPY@      BIS@   80
     C           *NAMVAR   DEFN RUNDAT    RUNDT
     C           *NAMVAR   DEFN           LDA
     C           *NAMVAR   DEFN           GLSTAT
     C           *LIKE     DEFN PSTBAL    EUPBAL
     C           *LIKE     DEFN PSTBF     EUPBF
     C*
     C** FIRST CYCLE CALCULATIONS
     C/COPY WNCPYSRC,GL0065C005
     C   30                GOTO CYCLE1
     C/COPY WNCPYSRC,GL0065C017
     C                     SETON                     30L1
     C/COPY WNCPYSRC,GL0065C006
     C*
     C** RETRIEVE GLSTAT DATA AREA TO EXTRACT ZERO BALANCE/NO
     C** MOVEMENT INDICATOR
     C*
     C                     IN   GLSTAT
     C*
     C** KEYLIST FOR GLAPSTPD
     C*
     C           EXTKEY    KLIST
     C                     KFLD           XRFI
     C                     KFLD           XRFN
     C           KREGAH    KLIST
     C                     KFLD           CNUM
     C                     KFLD           CCY
     C                     KFLD           ACOD
     C                     KFLD           ACSQ
     C                     KFLD           BRCA
     C*
     C** SETUP NARRATIVE FIELDS.
     C*
     C                     MOVE *BLANKS   DBPGM
     C                     MOVE 'GL0065'  DBPGM
     C                     MOVEL'ADDRESS 'TEMP16 16
     C                     MOVE 'NOT FOUN'TEMP16
     C                     MOVE 'D'       NFOUND 17
     C                     MOVELTEMP16    NFOUND
     C                     MOVE ' '       BLANK  35
     C                     MOVEL'NOT FOUN'NFOUNZ  9
     C                     MOVE 'D'       NFOUNZ
     C/COPY WNCPYSRC,GL0065CX32
     C*
     C** ZEROISE RECORD COUNTS
     C                     Z-ADD0         TNPR    50
     C                     Z-ADD0         TNAR    50
     C                     Z-ADD0         TNPO    50
     C                     Z-ADD0         HPTI   150
     C                     Z-ADD0         HPTD    30
     C                     Z-ADD0         HPOI   150
     C                     Z-ADD0         HPOD    30
     C                     Z-ADD0         ZZTOTI 150
     C                     Z-ADD0         ZZTOTD  30
     C                     Z-ADD0         ZZAMT  153
     C                     Z-ADD0         ZERO5   50
     C                     Z-ADD0         TTPR    50
     C                     Z-ADD0         HTTI   150
     C                     Z-ADD0         HTTD    50
     C                     Z-ADD0         NODEL   90
     C/COPY WNCPYSRC,GL0065CX29
     C*
     C** IN DATA AREA RUNDAT
     C** FOR DATE FORMAT AND RUN DATE.
     C                     IN   RUNDT
     C/COPY WNCPYSRC,GL0065C054
     C*
     C** CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.
     C           DATF      COMP 'M'                      98MMDDYY, 98 ON
     C*
     C/COPY WNCPYSRC,GL0065CP48
     C*
     C** CHECK IF THE MULTIBRANCHING INDICATOR IS ON OR NOT
     C*
     C           MBIN      IFEQ 'Y'
     C                     SETON                     58
     C                     END
     C*
     C** OBTAIN THE BANK DETAILS
     C*
     C                     CALL 'AOBANKR0'
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*FIRST ' @OPTN   7
     C           SDBANK    PARM SDBANK    DSFDY
     C           @RTCD     IFNE *BLANKS
     C                     SETON                     99
     C                     Z-ADD21        DBASE            *************
     C                     MOVEL*BLANKS   DBKEY            DATABASE ERROR
     C                     MOVEL@OPTN     DBKEY                21
     C                     MOVE 'SDBANKPD'DBFILE           *************
     C                     MOVEL@OPTN     DBOPTN  7
     C                     EXSR *PSSR
     C                     END
     C   99                GOTO ERROR
     C/COPY WNCPYSRC,GL0065C057
     C*
     C** CALL ACCESS OBJECT 'SDGELRR0'
     C** FOR ACCRUALS PROFIT DATE
     C*
     C                     CALL 'AOGELRR1'
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*FIRST ' @OPTN   7
     C           SDGELR    PARM SDGELR    DSSDY
     C           @RTCD     IFNE *BLANKS
     C                     SETON                     76
     C                     Z-ADD22        DBASE            *************
     C                     MOVEL*BLANKS   DBKEY            DATABASE ERROR
     C                     MOVEL@OPTN     DBKEY                22
     C                     MOVE 'SDGELRPD'DBFILE           *************
     C                     MOVEL@OPTN     DBOPTN  7
     C                     EXSR *PSSR
     C                     END
     C   76                GOTO ERROR
     C/COPY WNCPYSRC,GL0065C111
     C*
     C** Switchable SAR: Ignore check for zero account balance and
     C** type of account (S01377).
     C** Check to see if SAR is installed.
     C                     CALL 'AOSARDR0'
     C                     PARM '       ' @RTCD
     C                     PARM '*VERIFY' @OPTN
     C                     PARM 'S01377'  @SARD   6
     C           SCSARD    PARM SCSARD    DSFDY
     C*
     C** If SAR S01377 is installed set up the indicating field
     C           @RTCD     IFEQ *BLANKS
     C                     MOVE 'S01377'  @SAR    6
     C                     END
     C*
     C/COPY WNCPYSRC,GL0065CP35
     C*
     C** Check if Account Statements Changes switchable feature is
     C** switched ON
     C*
     C                     CALL 'AOSARDR0'
     C                     PARM *BLANKS   @RTCD
     C                     PARM '*VERIFY' @OPTN
     C                     PARM 'S01520'  @SARD
     C           SCSARD    PARM SCSARD    DSFDY
     C*
     C                     MOVE 'N'       S01520  1
     C           @RTCD     IFEQ *BLANKS
     C                     MOVE 'Y'       S01520
     C                     ELSE
     C           @RTCD     IFNE '*NRF   '
     C                     SETON                     76
     C                     MOVEL'SCSARDPD'DBFILE           ************
     C                     MOVEL'*VERIFY' DBKEY            * DBERR 05 *
     C                     Z-ADD05        DBASE            ************
     C                     EXSR *PSSR
     C                     END
     C                     END
     C*
     C** Check if EMU Account Postings Narrative switchable feature is
     C** switched ON
     C*
     C                     CALL 'AOSARDR0'
     C                     PARM *BLANKS   @RTCD
     C                     PARM '*VERIFY' @OPTN
     C                     PARM 'CEU013'  @SARD
     C           SCSARD    PARM SCSARD    DSFDY
     C*
     C                     MOVE 'N'       CEU013  1
     C           @RTCD     IFEQ *BLANKS
     C                     MOVE 'Y'       CEU013
     C                     ELSE
     C           @RTCD     IFNE '*NRF   '
     C                     SETON                     76
     C                     MOVEL'SCSARDPD'DBFILE           ************
     C                     MOVEL'*VERIFY' DBKEY            * DBERR 07 *
     C                     Z-ADD07        DBASE            ************
     C                     EXSR *PSSR
     C                     END
     C                     END
      *
      **  Access SAR details file to see if CFT004 is installed.
      *
     C                     CALL 'AOSARDR0'
     C                     PARM *BLANKS   PRTCD   7
     C                     PARM '*VERIFY' POPTN   7
     C                     PARM 'CFT004'  PSARD   6
     C           SCSARD    PARM SCSARD    DSSDY
      *
     C                     MOVE 'N'       CFT004
     C           PRTCD     IFEQ *BLANKS
     C                     MOVE 'Y'       CFT004  1
     C                     ELSE
     C           PRTCD     IFNE '*NRF   '
     C                     SETON                     76
     C                     MOVEL'SCSARDPD'DBFILE           ************
     C                     MOVEL'*VERIFY' DBKEY            * DBERR 15 *
     C                     Z-ADD15        DBASE            ************
     C                     EXSR *PSSR
     C                     ENDIF
     C                     ENDIF
      *
      **  Access SAR details file to see if CRE008 is installed.
      *
     C                     CALL 'AOSARDR0'
     C                     PARM *BLANKS   PRTCD   7
     C                     PARM '*VERIFY' POPTN   7
     C                     PARM 'CRE008'  PSARD   6
     C           SCSARD    PARM SCSARD    DSSDY
      *
     C                     MOVE 'N'       CRE008
     C           PRTCD     IFEQ *BLANKS
     C                     MOVE 'Y'       CRE008  1
     C           *LOVAL    SETLLSDCMANL0
     C                     READ SDCMANL0                 53
     C           *IN53     IFEQ *ON
     C                     SETON                     76
     C                     MOVEL'SDCMANPD'DBFILE           ************
     C                     MOVEL'*VERIFY' DBKEY            * DBERR 30 *
     C                     Z-ADD30        DBASE            ************
     C                     EXSR *PSSR
     C                     ENDIF
     C                     ELSE
     C           PRTCD     IFNE '*NRF   '
     C                     SETON                     76
     C                     MOVEL'SCSARDPD'DBFILE           ************
     C                     MOVEL'*VERIFY' DBKEY            * DBERR 31 *
     C                     Z-ADD31        DBASE            ************
     C                     EXSR *PSSR
     C                     ENDIF
     C                     ENDIF
      *
     C   76                GOTO ERROR
     C*
     C** CALL ACCESS OBJECT 'SDTRADR0'
     C** FOR FORMS TYPE.
     C                     CALL 'AOTRADR0'
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*FIRST ' @OPTN
     C           SDTRAD    PARM SDTRAD    DSFDY
     C           @RTCD     IFNE *BLANKS
     C                     SETON                     76
     C                     Z-ADD23        DBASE            *************
     C                     MOVEL*BLANKS   DBKEY            DATABASE ERROR
     C                     MOVEL@OPTN     DBKEY                23
     C                     MOVE 'SDTRADPD'DBFILE           *************
     C                     MOVEL@OPTN     DBOPTN  7
     C                     EXSR *PSSR
     C                     END
     C/COPY WNCPYSRC,GL0065C007
     C  N76                GOTO OKAY
     C           ERROR     TAG                             **ERROR TAG**
     C   76
     COR 99                SETON                     U7U8
     C                     GOTO FINISH
     C           OKAY      TAG                             ***OKAY TAG***
      *
     C/COPY WNCPYSRC,GL0065CP38
      *
     C** BUILD FORMAT ARRAY FROM TABLES DATA.
     C*
     C                     MOVE BLGLSI    FORM,1           * G/L *
     C*
     C                     MOVE BLRSST    FORM,2           * RETAIL *
     C*
     C                     MOVE BLDLSS    FORM,3           * DEALING *
     C*
     C                     MOVE BLNSS     FORM,4           * NOSTRO *
     C*
     C                     MOVE BLCSS     FORM,5           * CONTINGENT *
     C*
     C  NU1                GOTO CYCLE1
     C                     CALL 'AORETLR0'
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*FIRST ' @OPTN   7
     C           SDRETL    PARM SDRETL    DSFDY
     C           @RTCD     IFNE *BLANKS
     C                     SETON                     76
     C                     Z-ADD24        DBASE            *************
     C                     MOVEL*BLANKS   DBKEY            DATABASE ERROR
     C                     MOVEL@OPTN     DBKEY                24
     C                     MOVE 'SDRETLPD'DBFILE           *************
     C                     MOVEL@OPTN     DBOPTN  7
     C                     EXSR *PSSR
     C                     END
     C           *IN76     IFEQ '1'
     C   76
     COR 99                SETON                     U7U8
     C                     GOTO FINISH
     C                     END
     C           BMRCPI    IFEQ 'N'
     C                     SETON                     12
     C                     END
     C*
     C/COPY WNCPYSRC,GL0065CP18
     C*
     C/EJECT
     C           CYCLE1    TAG                             ** CYCLE1 TAG *
     C/COPY WNCPYSRC,GL0065C080
      *
      ** Set up MATCH fields
      *
     C                     MOVELACOD      WASQN
     C                     MOVE ACSQ      WASQN  12
     C                     MOVELMTCH      MATCH  24
     C                     MOVE WASQN     MATCH
      *
      ** Set up MATCHS field
      *
     C                     MOVELMTCHS     MATCHS 21
     C                     MOVE WASQN     MATCHS
      *
     C           *INL4     IFEQ '1'
     C           MBIN      IFEQ 'Y'
     C                     EXSR ENDRPT
     C                     CLOSEGL0420P1
     C/COPY WNCPYSRC,GL0065C008
     C                     CLOSEGL0420P2
     C*
     C** Core hook for externalisation.
     C/COPY WNCPYSRC,GL0065CCP1
     C*
     C                     CLOSEGL0420P3
     C*
     C** Core hook for externalisation.
     C/COPY WNCPYSRC,GL0065CCP2
     C*
     C                     CLOSEGL0420P4
     C                     CLOSEGL0420P5
     C                     CLOSEGL0420P6
     C                     MOVE '0'       *IN84
     C                     END
      *
     C                     MOVE BRCA      BRCASV  3
     C           MBIN      IFEQ 'Y'
     C           *IN84     OREQ '0'
     C                     SETON                     84
      *
     C                     OPEN GL0420P1
      *
      **  ENSURE REPORT SPOOL FILE RECORDED BY RCF
     C                     Z-ADDSFNUM1    SFNO1   60
     C                     OUT  LDA
     C/COPY WNCPYSRC,GL0065CABB
     C                     CALL 'ZSFILE'
     C                     PARM           SEQ     5
     C                     PARM BRCA      SENTY   3
     C                     PARM           SFILE1
     C                     PARM           SFNO1
     C                     PARM           ZSERR   1
     C/COPY WNCPYSRC,GL0065CABM
      *
     C           *LOCK     IN   LDA
     C           ZSERR     IFEQ 'Y'
      *
      * ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAMME
      *
     C                     SETON                     U7U8LR
     C                     RETRN
     C                     END
      *
     C/COPY WNCPYSRC,GL0065C009
     C                     OPEN GL0420P2
     C*
     C**  ENSURE REPORT SPOOL FILE RECORDED BY RCF
     C                     Z-ADDSFNUM2    SFNO2   60
     C                     OUT  LDA
     C/COPY WNCPYSRC,GL0065C062
     C                     CALL 'ZSFILE'
     C                     PARM           SEQ
     C                     PARM BRCA      SENTY   3
     C                     PARM           SFILE2
     C                     PARM           SFNO2
     C                     PARM           ZSERR   1
     C/COPY WNCPYSRC,GL0065C063
     C*
     C           *LOCK     IN   LDA
     C           ZSERR     IFEQ 'Y'
     C*
     C* ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAMME
     C*
     C                     SETON                     U7U8LR
     C                     RETRN
     C                     END
     C*
     C** Core hook for externalisation.
     C/COPY WNCPYSRC,GL0065CCP3
     C*
     C                     OPEN GL0420P3
     C*
     C**  ENSURE REPORT SPOOL FILE RECORDED BY RCF
     C                     Z-ADDSFNUM3    SFNO3   60
     C                     OUT  LDA
     C/COPY WNCPYSRC,GL0065C064
     C                     CALL 'ZSFILE'
     C                     PARM           SEQ
     C                     PARM BRCA      SENTY   3
     C                     PARM           SFILE3
     C                     PARM           SFNO3
     C                     PARM           ZSERR   1
     C/COPY WNCPYSRC,GL0065C065
     C*
     C           *LOCK     IN   LDA
     C           ZSERR     IFEQ 'Y'
     C*
     C** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAMME
     C*
     C                     SETON                     U7U8LR
     C                     RETRN
     C                     END
     C*
     C** Core hook for externalisation.
     C/COPY WNCPYSRC,GL0065CCP4
     C*
     C*
     C                     OPEN GL0420P4
     C*
     C** ENSURE REPORT SPOOL FILE RECORDED BY RCF
     C                     Z-ADDSFNUM4    SFNO4   60
     C                     OUT  LDA
     C/COPY WNCPYSRC,GL0065C066
     C                     CALL 'ZSFILE'
     C                     PARM           SEQ
     C                     PARM BRCA      SENTY   3
     C                     PARM           SFILE4
     C                     PARM           SFNO4
     C                     PARM           ZSERR   1
     C/COPY WNCPYSRC,GL0065C067
     C*
     C           *LOCK     IN   LDA
     C           ZSERR     IFEQ 'Y'
     C*
     C** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAMME
     C*
     C                     SETON                     U7U8LR
     C                     RETRN
     C                     END
     C*
     C                     OPEN GL0420P5
     C*
     C** ENSURE REPORT SPOOL FILE RECORDED BY RCF
     C                     Z-ADDSFNUM5    SFNO5   60
     C                     OUT  LDA
     C/COPY WNCPYSRC,GL0065C068
     C                     CALL 'ZSFILE'
     C                     PARM           SEQ
     C                     PARM BRCA      SENTY   3
     C                     PARM           SFILE5
     C                     PARM           SFNO5
     C                     PARM           ZSERR   1
     C/COPY WNCPYSRC,GL0065C069
     C*
     C           *LOCK     IN   LDA
     C           ZSERR     IFEQ 'Y'
     C*
     C** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAMME
     C*
     C                     SETON                     U7U8LR
     C                     RETRN
     C                     END
     C*
     C                     OPEN GL0420P6
     C*
     C**  ENSURE REPORT SPOOL FILE RECORDED BY RCF
     C                     Z-ADDSFNUM6    SFNO6   60
     C                     OUT  LDA
     C                     CALL 'ZSFILE'
     C                     PARM           SEQ
     C                     PARM BRCA      SENTY   3
     C                     PARM           SFILE6
     C                     PARM           SFNO6
     C                     PARM           ZSERR   1
     C*
     C           *LOCK     IN   LDA
     C           ZSERR     IFEQ 'Y'
     C*
     C** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAMME
     C*
     C                     SETON                     U7U8LR
     C                     RETRN
     C                     END
      *
     C                     Z-ADD0         PAGE
     C                     Z-ADD0         PAGE2
     C                     Z-ADD0         PAGE3
     C                     Z-ADD0         PAGE4
     C                     Z-ADD0         PAGE5
     C                     Z-ADD0         PAGE6
      ** OPEN FILES - END
     C                     END
      ** BRANCH CHG - END
     C                     END
      *
     C** SETOF CONDITIONAL INDICATORS.
     C                     SETOF                     49
     C                     SETOF                     181987
     C                     SETOF                     89
     C                     SETOF                     465051
     C/COPY WNCPYSRC,GL0065C027
     C                     SETOF                     525354
     C/COPY WNCPYSRC,GL0065C028
     C                     SETOF                     606162
     C                     SETOF                     636465
     C                     SETOF                     666768
     C                     SETOF                     8081
     C** TO ALLOW DR INDICATOR TO OPERATE ON BFWD BALANCES
     C                     SETOF                     33
     C   01                SETOF                     29
     C                     SETOF                     45
     C*
     C/COPY WNCPYSRC,GL0065CP28
     C*
     C   01                SETON                     16
     C/COPY WNCPYSRC,GL0065C018
     C*
     C** IF A NEW STATEMENT HAS NOT BEEN READ GO TO POSTING PROCESSING
     C   13                GOTO STRAIL
     C  N01                GOTO FINISH
     C*
     C** OBTAIN BRANCH NAME BY USING THE ACCESS OBJECT 'AOBRCHR0'
     C*
     C           *INL4     IFEQ '1'
     C                     CALL 'AOBRCHR1'
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*KEY   ' @OPTN   7
     C                     PARM BRCA      @DSNB   3
     C           SDBRCH    PARM SDBRCH    DSSDY
     C           @RTCD     IFNE *BLANKS
     C                     SETON                     76
     C                     SETON                     U7U8LR
     C                     Z-ADD25        DBASE            *************
     C                     MOVEL*BLANKS   DBKEY            DATABASE ERROR
     C                     MOVEL@DSNB     DBKEY                25
     C                     MOVE 'SDBRCHPD'DBFILE           *************
     C                     MOVEL@OPTN     DBOPTN  7
     C                     EXSR *PSSR
     C                     GOTO FINISH
     C                     END
     C/COPY WNCPYSRC,GL0065C038
     C                     END
     C/COPY WNCPYSRC,GL0065C039
     C** CURRENCY DETAILS FOR SDCURRPD
     C*
     C** GET CCY DETAILS
     C           *INL2     IFEQ '1'                        ** IF  001
     C                     Z-ADD1         K       30
     C           CCY       LOKUPCY,K                     14
     C           *IN14     IFEQ '1'                        ** IF  002
     C                     MOVE CYD,K     CYDDS
     C/COPY WNCPYSRC,GL0065C023
     C           CDP       COMP 1                      7071
     C           CDP       COMP 2                    73  72
     C                     ELSE                            ** ELS 002
     C** ERROR IF NOT FOUND
     C                     MOVE '1'       *INU7
     C                     MOVE '1'       *INU8
     C                     MOVE '1'       *INLR
     C                     MOVE BLANK     CCNM
     C                     MOVE NFOUNZ    CCNM
     C                     Z-ADD13        DBASE            **************
     C                     MOVE BLANK     DBKEY            DATABASE ERROR
     C                     MOVELCCY       DBKEY                   13
     C*                                                    **************
     C                     MOVEL'TABTG30' DBFILE
     C                     SETON                     U7U8LR
     C                     EXSR *PSSR
     C                     GOTO FINISH
     C                     END                             ** END 002
     C                     END                             ** END 001
     C/COPY WNCPYSRC,GL0065C040
     C*
     C** CHAIN TO ACCOUNTS FILE TO TEST STATUS
     C*
     C                     SETOF                     03
     C                     MOVELMATCHS    ACKEY  24
     C                     MOVE BRCA      ACKEY
     C           ACKEY     CHAINACCNT                77
      *
     C           *IN03     IFNE '1'
     C                     Z-ADD14        DBASE            ***************
     C                     MOVE BLANK     DBKEY            DATABASE ERROR
     C                     MOVELACKEY     DBKEY                14
     C                     MOVEL'ACCNT'   DBFILE           ***************
     C                     SETON                     U7U8LR
     C                     EXSR *PSSR
     C                     GOTO FINISH
     C                     END
      *
     C/COPY WNCPYSRC,GL0065C029
     C   03      RECI      COMP 'C'                      79
     C*
     C** Check if part of group account hierarchy
     C                     SETOF                       82
     C           CRE008    IFEQ 'Y'
     C           KREGAH    CHAINREGAHLJ2             77
     C           *IN77     IFEQ '0'
     C                     MOVE '1'       *IN82
     C                     ENDIF
     C                     ENDIF
     C*
     C/COPY WNCPYSRC,GL0065CP32
     C*
     C** INCREASE COUNT OF A/C READ
     C           TNAR      ADD  1         TNAR
     C** SETUP MICROFICHE FREQ/SORT FIELD
     C           MFFQ      IFEQ *BLANK
     C                     MOVEL*BLANKS   FICHE
     C                     END
     C*
     C** DETERMINE IF NEXT STMT DATE IS BEFORE NEXT WORKING DAY
     C           NSTD      COMP BJDNWD                 59
     C                     SETOF                     3435
      *
      ** Check if Demand or Management is requested whether or not
      ** the statement is due today
      *
     C/COPY WNCPYSRC,GL0065C112
     C                     TESTB'1'       GLBT           35 DEMAND
     C  N35                TESTB'0'       GLBT           34 MANAGEMENT
     C/COPY WNCPYSRC,GL0065C113
     C                     TESTB'2'       GLBT           36 PRINT ADDRESS
      *
     C           STFQ      IFEQ 'A'
     C           *IN34     ANDEQ'0'
     C                     MOVE '1'       *IN59
     C                     END
     C** SET INDEX FOR FORMAT TYPE
     C                     Z-ADD1         X       10
     C** MANAGEMENT STATEMENT FORMAT
     C   34                SETON                     41
     C   34                SETOF                     40
     C   34                SETOF                     424344
     C/COPY WNCPYSRC,GL0065C030
     C** NON-MANAGEMENT STATEMENT FORMATS
     C  N34      ATYP      LOKUPTYPE,X                   31
     C  N34      FORM,X    COMP '2'                    4142
     C  N34      FORM,X    COMP '3'                      43
     C  N34      FORM,X    COMP '4'                  40  44
     C/COPY WNCPYSRC,GL0065C010
     C*
     C** IF NO POSTINGS,A/C BALANCE ZERO,NOT
     C** MANAGEMENT OR DEMAND STATEMENT,& NOT RETAIL A/C,
     C** AND ZERO BALANCE/NO MOVEMENT IND.IS 'N'
     C** THEN STATEMENT NOT REQUIRED
     C*
     C** REINSTATE THE ABOVE CODE IN NEW FORM
     C                     SETOF                     15
     C*
     C** CHECK FOR POSTINGS THAT HAVE APPEARED SINCE LAST STATEMENT.
     C*
     C/COPY WNCPYSRC,GL0065CP36
     C*
     C** READ LAST RECORD, OF ACCOUNT, ON APOST.
     C*
     C/COPY WNCPYSRC,GL0065CP57
     C*
     C           MATCH     SETGTAPOST
     C**********           READPAPOST                  1515                                  BUG4844
     C           MATCH     REDPEAPOST                  1515                                  BUG4844
     C*
     C/COPY WNCPYSRC,GL0065CP56
     C*
     C           RECI      DOWEQ'R'
     C/COPY WNCPYSRC,GL0065CY33
     C           *IN15     ANDEQ'0'
     C********** MATCHS    ANDEQAPKEY                                                        BUG4844
     C**********           READPAPOST                  1515                                  BUG4844
     C           MATCH     REDPEAPOST                  1515                                  BUG4844
     C/COPY WNCPYSRC,GL0065C089
     C                     END
     C*
     C/COPY WNCPYSRC,GL0065C026
     C*
     C** IF RECORD IS NOT FOUND. EI. NO POSTINS FOR ACCOUNT.
     C*
     C           *IN15     IFEQ '1'                         UNSUCCESSFUL
     C                     GOTO NOSLCT                      READ.
     C                     END
     C*
     C** READ ACCESSES RECORD OUTSIDE IF KEY.
     C*
     C***********MATCHS    IFNE APKEY                       RECORD READ                      BUG4844
     C***********          SETON                     15     IS NO EQUAL                      BUG4844
     C***********          GOTO NOSLCT                      TO KEY.                          BUG4844
     C***********          END                                                               BUG4844
     C*
     C** SELECT ON POSTING AND LAST STATEMENT DATE TO PROCESS.
     C*
     C           PSTD      IFLE LSTD                        IF POST DATE
     C/COPY WNCPYSRC,GL0065C044
     C                     SETON                     15     <= LAST
     C                     END                              STATEMENT DAT.
     C*
     C** HOWEVER, ALLOW ACCOUNTS OPENED ON STATEMENT DATE.
     C*
     C           DACO      IFEQ LSTD                        DAT A/C OPEN.
     C           LSTP      ANDEQ0                           LST STMNT PAG.
     C           PSTD      ANDGELSTD                        LAST < PST DT.
     C                     SETOF                     15
     C                     END
     C*
     C           NOSLCT    TAG
     C*
     C**  Switchable SAR S01377: Ignore check for zero B/F balance
     C**  and type of account. @SAR set up in first cycle.
     C*
     C** If no more postings for this a/c (*IN15), ledger balance zero
     C** (*IN26), not a mgt or demand stmt (*IN34,35) and zero balance/
     C** no movement ind (GLSTAT - CoB parm) set to 'N', and SAR not
     C** installed then suppress statement (*IN33).
     C/COPY WNCPYSRC,GL0065C051
     C           *IN15     IFEQ '1'
     C           *IN26     ANDEQ'1'
     C           *IN34     ANDEQ'0'
     C           *IN35     ANDEQ'0'
     C           MOVI      ANDEQ'N'
     C           @SAR      ANDEQ*BLANKS
     C                     SETON                     33
     C*
     C** Ensure that retail accounts are not suppressed
     C   33      ATYP      COMP 'R'                  3333
     C           *IN33     IFEQ '1'
     C                     MOVE '1'       *IN07
     C                     END
     C/COPY WNCPYSRC,GL0065C056
     C   33                GOTO ENDPRT
     C                     END
     C/COPY WNCPYSRC,GL0065C052
     C*
     C** If no more postings for this a/c (*IN15),
     C** not a mgt or demand stmt (*IN34,35) and SAR
     C** installed then suppress statement (*IN33).
     C           *IN15     IFEQ '1'
     C           *IN34     ANDEQ'0'
     C           *IN35     ANDEQ'0'
     C           @SAR      ANDEQ'S01377'
     C/COPY WNCPYSRC,GL0065C002
     C                     SETON                     33
      *
     C           *IN33     IFEQ '1'
     C                     MOVE '1'       *IN07
     C                     END
     C   33                GOTO ENDPRT
     C                     END
      *
      ** If statement is due today and a management statement is
      ** requested: if the a/c has postings, produce normal statement
      ** (set off *IN33 and *IN34); otherwise, produce management
      ** statement and select only necessary fields to update
      ** in ACCNTAB (set on *IN33)
      *
     C           *IN34     IFEQ '1'
     C           *IN59     ANDEQ'1'
     C           *IN15     IFEQ '1'
     C                     MOVE '1'       *IN33
     C                     ELSE
     C                     MOVE '0'       *IN33
     C                     MOVE '0'       *IN34
     C                     END
     C                     END
      *
      ** If statement is due today and demand statement is requested,
      ** set off *IN33 to update fields in ACCNTAB. If the account
      ** has postings, produce normal statement. Otherwise, produce
      ** demand statement.
      *
     C           *IN35     IFEQ '1'
     C           *IN59     ANDEQ'1'
     C                     MOVE '0'       *IN33
     C           *IN15     IFEQ '0'
     C                     MOVE '0'       *IN35
     C                     END
     C                     END
      *
     C/COPY WNCPYSRC,GL0065CP37
     C*
     C** READ APOST. FURTHER PROCESSING IS ON 1ST REC. FOR A/C.
     C*
     C/COPY WNCPYSRC,GL0065CP55
     C*
     C           MATCH     SETLLAPOST                       READ REC 1
     C           MATCH     READEAPOST                  1515 FOR ACCOUNT.
     C*
     C/COPY WNCPYSRC,GL0065CP54
     C*
     C** IF READ FAILS, FIELDS ARE CORRUPTED BY SETGT/READP.
     C** CNUM, CCY, ACOD, ACSQ NEED RESTORING.
     C*
     C                     MOVELMATCH     SAVKEY
     C*
     C** IF DEMAND OR MANAGEMENT STMT PRINT ADDRESS
     C*
     C   34
     COR 35                SETON                     36    PRINT ADDRESS
     C*
     C   35                SETON                     59
     C*
     C** CONVERT LAST STATMNT DATE
     C/COPY WNCPYSRC,GL0065C060
     C                     Z-ADDLSTD      ZDAYNO  50
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    LSTDA   7
     C/COPY WNCPYSRC,GL0065C032
     C*
     C** NEXT STATMNT DATE DEFAULT
     C                     Z-ADDNSTD      NSTDA   50
      ** Format Requested Start Date
     C           LSTD      ADD  1         ZDAYNO  50
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    SDATE   7
      ** Format Requested End Date
     C                     Z-ADDENDD      ZDAYNO  50
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    EDATE   7
      *
      ** Print REQUESTED PERIOD in audit report
     C           SDATE     IFNE *BLANK
     C           EDATE     ORNE *BLANK
     C                     MOVE '1'       *IN31
     C                     ELSE
     C                     MOVE '0'       *IN31
     C                     ENDIF
     C*
     C** Core hook for externalisation.
     C/COPY WNCPYSRC,GL0065CCP7
     C*
     C** SET ADDRESS REF IN ARRAY
     C                     MOVELADF1      ADREF  10
     C                     MOVE ADF2      ADREF
     C** IF NO ADDRESS REFS USE DEFAULT OF ONE 'B' ADDRESS
     C           ADREF     IFEQ *BLANKS
     C                     MOVEL'B'       ADREF
     C                     END
     C*
     C** IF MANAGEMENT STATEMENT PRINT 1 STMT FOR 'B' ADDRESS
     C           *IN34     IFEQ '1'
     C                     MOVE *BLANKS   ADREF
     C                     MOVEL'B'       ADREF
     C                     END
     C*
     C                     Z-ADD1         C       20
     C                     MOVEAADREF     ARAD
     C                     MOVE ARAD,1    ADTYP   1
     C** PRINT STATEMENTS FOR ALL ADDRESSES
     C           *IN07     DOUEQ'1'
     C/COPY WNCPYSRC,GL0065C106
     C                     MOVE '0'       *IN49
     C/COPY WNCPYSRC,GL0065C107
     C                     MOVE ADTYP     W@ADRC  1
     C           1         ADD  C         C
     C           C         IFLE 10
     C                     MOVE ARAD,C    ADTYP
     C                     END
     C                     SETOF                     07
     C** ALLOW UPDATE OF FILES IF NEXT ADDRESS REF IS BLANK OR
     C** IF LAST ONE
     C           ADTYP     IFEQ ' '
     C           C         OREQ 11
     C/COPY WNCPYSRC,GL0065C104
     C                     SETON                     07
     C                     END
     C/COPY WNCPYSRC,GL0065C061
     C*
     C** DETERMINE ADDRESS OF STATEMENT :-
     C** IF THE ADDRESS CODE IS 'B' USE THE ADDRESS ON THE CUSTOMER
     C** DETAILS FILE ELSE USE THE ALTERNATIVE ADDRESS DEFINED FOR
     C** THE CUSTOMER AND ADDRESS CODE ON THE ALTERNATIVE ADDRESS
     C** FILE.
     C*
     C           W@ADRC    IFEQ 'B'
     C*
     C                     MOVE *BLANKS   @KEY1
     C                     MOVELCNUM      @KEY1
     C                     CALL 'AOCUSTR0'
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*KEY   ' @OPTN   7
     C                     PARM           @KEY1  10
     C                     PARM           @KYST   7
     C           SDCUST    PARM SDCUST    DSSDY
     C*
     C           @RTCD     IFNE *BLANKS
     C*
     C                     Z-ADD26        DBASE            *************
     C                     MOVEL*BLANKS   DBKEY            DATABASE ERROR
     C                     MOVELCNUM      DBKEY                26
     C                     MOVE 'SDCUSTPD'DBFILE           *************
     C                     EXSR *PSSR
     C                     GOTO FINISH
     C                     END
     C*
     C           *LIKE     DEFN BBCNA1    @WCNA1
     C           *LIKE     DEFN BBCNA2    @WCNA2
     C           *LIKE     DEFN BBCNA3    @WCNA3
     C           *LIKE     DEFN BBCNA4    @WCNA4
     C                     MOVE BBCNA1    @WCNA1
     C                     MOVE BBCNA2    @WCNA2
     C                     MOVE BBCNA3    @WCNA3
     C                     MOVE BBCNA4    @WCNA4
     C*
     C                     ELSE
     C*
     C** OBTAIN THE CUSTOMER ADDRESS VIA THE ACCESS OBJECT 'AOALTNR0'
     C*
     C                     MOVE CNUM      W@CNMA  6
     C                     CALL 'AOALTNR0'
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*KEY   ' @OPTN   7
     C                     PARM W@CNMA    @AENB   6
     C                     PARM W@ADRC    @AZCD   1
     C           SDALTN    PARM SDALTN    DSFDY
     C           @RTCD     IFNE *BLANKS
     C** ENSURE THAT A COPY STATEMENT IS NOT PRODUCED FOR
     C** A DELETED ALTERNATE NAME AND ADDRESS
     C                     GOTO ENDPS
     C                     END
     C*
     C                     MOVE BCCNA1    @WCNA1
     C                     MOVE BCCNA2    @WCNA2
     C                     MOVE BCCNA3    @WCNA3
     C                     MOVE BCCNA4    @WCNA4
     C*
     C                     END
     C*
     C/COPY WNCPYSRC,GL0065CP34
     C*
     C           CONT      TAG
     C*
     C** SETON INDICATORS FOR INITIAL PRINT
     C                     SETON                     5046
     C/COPY WNCPYSRC,GL0065C041
     C*
     C** SET INDICATORS FOR PRINT
     C                     EXSR SETONS
     C/COPY WNCPYSRC,GL0065C042
     C** SETUP FIELDS FOR TYPE 5
     C*
     C           CFSB      COMP 0                    17
     C/COPY WNCPYSRC,GL0065C082
     C   87N45             Z-ADDYTDB      CFBF   150
     C                     Z-ADDYTDB      CLBAL  150
     C                     Z-ADDYTDB      VDCBBF 150
     C                     Z-ADDYTDB      CLBF   150 28
     C/COPY WNCPYSRC,GL0065C084
     C                     Z-ADD0         VDCR   130
     C                     Z-ADD0         VDDR   130
     C                     Z-ADD0         PSCR   130
     C                     Z-ADD0         PSDR   130
     C                     Z-ADD0         NCR     30
     C                     Z-ADD0         NDR     30
     C                     Z-ADDLSTD      VDCD    50
     C                     Z-ADD0         I       20
     C                     Z-ADD0         VDAR
     C                     Z-ADD0         VCAR
     C                     Z-ADD0         VDOF   130
     C                     Z-ADD0         VCOF   130
     C*
     C/COPY WNCPYSRC,GL0065CP49
     C*
     C** SET PAGE COUNTER AND ADD CARRIED FORWARD BALANCE.
     C           LSTP      IFEQ 999
     C                     Z-ADD1         LSTPX
     C/COPY WNCPYSRC,GL0065CX30
     C                     ELSE
     C           LSTP      ADD  1         LSTPX   30
     C/COPY WNCPYSRC,GL0065CX31
     C                     END
     C/COPY WNCPYSRC,GL0065CY32
     C*
     C                     Z-ADDLSTPX     STPA    30
     C/COPY WNCPYSRC,GL0065CY34
     C*
     C                     Z-ADDCFSB      PSTBAL 150 47
     C                     Z-ADDCFSB      PSTBF  150 83
     C/COPY WNCPYSRC,GL0065C078
     C*
     C*    ZEROISE LINE COUNTER.
     C                     Z-ADD0         LINCNT  20
     C*
     C*    FORMAT OPENING BALANCE
     C           CEU013    IFEQ 'Y'
     C           EUSB      IFEQ 'Y'
     C           CCY       ANDNEBKEURO
     C                     SETON                     10
     C                     CALL 'EU0200'
     C                     PARM *BLANK    P@RTCD  7
     C/COPY WNCPYSRC,GL0065C090
     C                     PARM PSTBF     P@FRAM 183
     C/COPY WNCPYSRC,GL0065C091
     C                     PARM CCY       P@FRCY  3
     C                     PARM BKEURO    P@TOCY  3
     C           EUPBF     PARM           P@OUTA 150
     C                     PARM           P@INTA 183
     C                     PARM           P@EXRT 159
     C                     PARM           P@MDIN  1
     C*
     C** DETERMINE NO. OF DECIMAL PLACES
     C                     CALL 'AOCURRR0'
     C                     PARM *BLANKS   UUAPRC  7
     C                     PARM '*KEY'    UUAPOP  7
     C                     PARM BKEURO    UUCYCD  3
     C           SDCURR    PARM SDCURR    DSSDY
     C*
     C           UUAPRC    IFNE *BLANKS
     C                     MOVEL'SDCURRPD'DBFILE           ************
     C                     MOVELBKEURO    DBKEY            * DBERR 10 *
     C                     Z-ADD10        DBASE            ************
     C                     EXSR *PSSR
     C                     ELSE
     C           A6NBDP    IFEQ 0
     C                     MOVE '1'       *INKA
     C                     ENDIF
     C           A6NBDP    IFEQ 1
     C                     MOVE '1'       *INKB
     C                     ENDIF
     C           A6NBDP    IFEQ 2
     C                     MOVE '1'       *INKC
     C                     ENDIF
     C           A6NBDP    IFEQ 3
     C                     MOVE '1'       *INKD
     C                     ENDIF
     C                     ENDIF
     C*
     C                     ELSE
     C                     SETOF                     10
     C                     ENDIF
     C                     ENDIF
     C*
     C** Format International Bank Account Numbers
     C*
     C                     MOVE '0'       *IN05
     C                     MOVEL*BLANKS   RIBAN
     C           CFT004    IFEQ 'Y'
     C           IBAN      ANDNE*BLANKS
     C                     CALL 'AOIBANR3'
     C                     PARM *BLANKS   PRTCD   7
     C                     PARM IBAN      PIBAN  47
     C                     PARM *BLANKS   PIWITH 47
     C                     PARM *BLANKS   PINOBL 34
      *
     C           PRTCD     IFEQ *BLANKS
     C                     MOVE '1'       *IN05
     C                     MOVELPIWITH    RIBAN  47
     C                     ENDIF
      *
     C                     ENDIF
      *
     C** OUTPUT REPORT HEADERS
     C*
     C/COPY WNCPYSRC,GL0065CCP8
     C*
     C                     EXCPT
     C*
     C/COPY WNCPYSRC,GL0065CCP9
     C*
     C                     SETOF                     506061
     C                     SETOF                     626364
     C                     SETOF                     656667
     C                     SETOF                     808187
     C                     SETOF                     89
     C*
     C/SPACE 3
     C*
     C/COPY WNCPYSRC,GL0065C025
     C           STMTAG    TAG                             ** STMTAG TAG *
     C                     SETOF                     1502
     C/COPY WNCPYSRC,GL0065CX34
     C                     MOVE '0'       *IN52
     C*
     C/COPY WNCPYSRC,GL0065CP53
     C*
     C           MATCH     SETLLAPOST
     C*
     C/COPY WNCPYSRC,GL0065CP52
     C*
     C           *IN15     DOUEQ'1'
     C/COPY WNCPYSRC,GL0065C001
     C                     SETOF                     0406
     C*
     C/COPY WNCPYSRC,GL0065CP51
     C*
     C           MATCH     READEAPOST                  1515
      *
      ** Print Postings up to End Date only
     C           PSTD      IFGT ENDD
     C                     MOVE *ON       *IN15
     C                     ENDIF
     C*
     C/COPY WNCPYSRC,GL0065CP50
     C*
     C   15 02             GOTO SAR
     C                     SETON                     02
     C*
     C/COPY WNCPYSRC,GL0065CP59
     C*
     C** CHAIN TO REIAC - CHECK THE INTEREST TYPE OF THE RATE
     C** CHANGE POSTING IS ZERO.
     C*
     C           *IN04     IFEQ '1'
     C           ACKEY     CHAINREIAC                09
     C           *IN09     IFEQ '1'
     C                     Z-ADD17        DBASE            ***************
     C                     MOVE BLANK     DBKEY            DATABASE ERROR
     C                     MOVELMATCH     DBKEY                17
     C                     MOVEL'REIAC'   DBFILE           ***************
     C                     SETON                     U7U8LR
     C                     GOTO END
     C                     END
     C                     END
     C** BYPASS IF RATE CHANGE POSTING AND RATE CHANGE PRINTING
     C** NOT REQUIRED
     C   04 12             GOTO STM3
     C/COPY WNCPYSRC,GL0065CX35
     C*
     C** BYPASS IF RATE CHANGE POSTING AND INTEREST TYPE IS NOT
     C** ZERO.
     C*
     C           *IN04     IFEQ '1'
     C           *IN22     IFEQ '1'
     C           CICT      COMP '00'                 0808
     C   08                GOTO STM3
     C                     ELSE
     C           *IN23     IFEQ '1'
     C           DICT      COMP '00'                 0808
     C   08                GOTO STM3
     C                     END
     C                     END
     C                     END
     C** CHECK FOR FULL PAGE
     C*
     C/COPY WNCPYSRC,GL0065CP19
     C*
     C   41
     COR 43      LINCNT    COMP 43                   45  45
     C/COPY WNCPYSRC,GL0065C024
     C   40      LINCNT    COMP 31                   45  45
     C/COPY WNCPYSRC,GL0065C021
     C   42      LINCNT    COMP 33                   45  45
     C*
     C** Core hook for externalisation.
     C/COPY WNCPYSRC,GL0065CADL
     C*
     C   44      LINCNT    COMP 30                   45  45
     C*
     C** IF END OF PAGE INCREMENT LSTP AND ZEROISE LINE COUNTER
     C*
     C/COPY WNCPYSRC,GL0065CP20
     C*
     C   45      STPA      ADD  1         STPA
     C*
     C/COPY WNCPYSRC,GL0065CP21
     C*
     C   40                Z-ADDLINCNT    FFLCNT  20
     C   45                Z-ADD0         LINCNT
     C   45                MOVEL'CONTD. ' LSTDA
     C/COPY WNCPYSRC,GL0065C055
     C** SAVE BALANCE FOR NEW PAGE
     C** TO ENSURE DR INDICATOR INCLUDED ON BFWD FIGURES
     C   45                Z-ADDPSTBAL    PSTBF      83
     C/COPY WNCPYSRC,GL0065C092
     C   40 45             Z-ADDCLBAL     CFBF   150 28
     C/COPY WNCPYSRC,GL0065C093
     C                     SETOF                     88L1
     C           PSTD      COMP PSTDP                L1L188
     C*
     C** CONVERT CLOSING BALANCE INTO EUROS IF EMU SWITCHABLE FEATURE
     C** PRESENT.
     C           CEU013    IFEQ 'Y'
     C           EUSB      IFEQ 'Y'
     C           CCY       ANDNEBKEURO
     C                     SETON                     10
     C*
     C                     CALL 'EU0200'
     C                     PARM *BLANK    P@RTCD  7
     C/COPY WNCPYSRC,GL0065C094
     C                     PARM PSTBAL    P@FRAM 183
     C/COPY WNCPYSRC,GL0065C095
     C                     PARM CCY       P@FRCY  3
     C                     PARM BKEURO    P@TOCY  3
     C           EUPBAL    PARM           P@OUTA 150
     C                     PARM           P@INTA 183
     C                     PARM           P@EXRT 159
     C                     PARM           P@MDIN  1
     C*
     C** If end of page, move C/F Euro bal. to B/F Euro bal. of next page
     C           *IN45     IFEQ *ON
     C                     Z-ADDEUPBAL    EUPBF
     C                     ENDIF
     C*
     C                     CALL 'AOCURRR0'
     C                     PARM *BLANKS   UUAPRC  7
     C                     PARM '*KEY'    UUAPOP  7
     C                     PARM BKEURO    UUCYCD  3
     C           SDCURR    PARM SDCURR    DSSDY
     C*
     C           UUAPRC    IFNE *BLANKS
     C                     MOVEL'SDCURRPD'DBFILE           ************
     C                     MOVELBKEURO    DBKEY            * DBERR 08 *
     C                     Z-ADD08        DBASE            ************
     C                     EXSR *PSSR
     C                     ELSE
     C           A6NBDP    IFEQ 0
     C                     MOVE '1'       *INKA
     C                     ENDIF
     C           A6NBDP    IFEQ 1
     C                     MOVE '1'       *INKB
     C                     ENDIF
     C           A6NBDP    IFEQ 2
     C                     MOVE '1'       *INKC
     C                     ENDIF
     C           A6NBDP    IFEQ 3
     C                     MOVE '1'       *INKD
     C                     ENDIF
     C                     ENDIF
     C*
     C                     ELSE
     C                     SETOF                     10
     C                     ENDIF
     C                     ENDIF
     C*
     C/COPY WNCPYSRC,GL0065CP10
     C*
     C   45                EXCPTENDPG
     C*
     C/COPY WNCPYSRC,GL0065CP11
     C*
     C           SAR       TAG
     C/COPY WNCPYSRC,GL0065C037
     C   88N15
     CORN40
     COR 74N15             GOTO CLBP
     C*
     C** FOR FORM,X EQ. 5 :-
     C** ON LAST POSTING BEFORE POSTING DATE CHANGE,
     C** UPDATE CLEARED BALANCE AND CLEAR OUT ARRAY ELEMENTS
     C** WHICH HAVE BEEN USED TO DO THIS.
     C** ACCUMULATE ALL CLEARING ON PSTD.
     C*
     C** IF I EQ 0 NOW IT IS POSSIBLE THAT POSTINGS WHOSE V DATES FALL IN
     C** WITHIN THIS STATEMENT PERIOD BUT HAVE BEEN PRINTED IN PREVIOUS
     C** STATEMENTS HAVE ADDED AMTS INTO VDAR/VCAR-ROLL THRU I JUST IN CASE
     C           I         COMP 0                        88
     C   88                Z-ADD1         I
     C   88      LSTD      ADD  1         VDCD
     C           CLBAL     ADD  VDAR,I    CLBAL
     C           CLBAL     SUB  VCAR,I    CLBAL
     C/COPY WNCPYSRC,GL0065C096
     C** CLEAR OUT THESE ELEMENTS.
     C                     Z-ADD0         VDAR,I
     C                     Z-ADD0         VCAR,I
     C** INCREMENT INDEX AND CONTROL DATE.
     C           I         ADD  1         I
     C           VDCD      ADD  1         VDCD
     C** WRAP AROUND INDEX.
     C           I         COMP 60                   88
     C   88      I         SUB  60        I
     C           CLBAL     COMP 0                    37
     C           CLBP      TAG                             * CLBP TAG *
     C/COPY WNCPYSRC,GL0065C053
     C   15                GOTO NEX
     C/COPY WNCPYSRC,GL0065C011
     C*
     C** CONVERT CLOSING BALANCE INTO EUROS IF EMU SWITCHABLE FEATURE
     C** PRESENT.
     C           CEU013    IFEQ 'Y'
     C           EUSB      IFEQ 'Y'
     C           CCY       ANDNEBKEURO
     C                     SETON                     10
     C*
     C                     CALL 'EU0200'
     C                     PARM *BLANK    P@RTCD  7
     C/COPY WNCPYSRC,GL0065C097
     C                     PARM PSTBAL    P@FRAM 183
     C/COPY WNCPYSRC,GL0065C098
     C                     PARM CCY       P@FRCY  3
     C                     PARM BKEURO    P@TOCY  3
     C           EUPBAL    PARM           P@OUTA 150
     C                     PARM           P@INTA 183
     C                     PARM           P@EXRT 159
     C                     PARM           P@MDIN  1
     C*
     C                     CALL 'AOCURRR0'
     C                     PARM *BLANKS   UUAPRC  7
     C                     PARM '*KEY'    UUAPOP  7
     C                     PARM BKEURO    UUCYCD  3
     C           SDCURR    PARM SDCURR    DSSDY
     C*
     C           UUAPRC    IFNE *BLANKS
     C                     MOVEL'SDCURRPD'DBFILE           ************
     C                     MOVELBKEURO    DBKEY            * DBERR 08 *
     C                     Z-ADD08        DBASE            ************
     C                     EXSR *PSSR
     C                     ELSE
     C           A6NBDP    IFEQ 0
     C                     MOVE '1'       *INKA
     C                     ENDIF
     C           A6NBDP    IFEQ 1
     C                     MOVE '1'       *INKB
     C                     ENDIF
     C           A6NBDP    IFEQ 2
     C                     MOVE '1'       *INKC
     C                     ENDIF
     C           A6NBDP    IFEQ 3
     C                     MOVE '1'       *INKD
     C                     ENDIF
     C                     ENDIF
     C*
     C                     ELSE
     C                     SETOF                     10
     C                     ENDIF
     C                     ENDIF
     C*
     C/COPY WNCPYSRC,GL0065CBOY
     C   L1                EXCPTBAL
     C/COPY WNCPYSRC,GL0065C012
     C*
     C           PSTD      IFLE LSTD
     C/COPY WNCPYSRC,GL0065C045
     C                     SETON                     39
     C                     ELSE
     C                     SETOF                     39
     C                     END
     C*
     C** Extra lines test for a newly opened account (DACO=LSTD), it
     C** forces the posting on to the first statement (LSTP=0). Final
     C** check ensures that if an account is reopened, previous post-
     C** ings will not appear on statement.
     C*
     C           DACO      IFEQ LSTD
     C           LSTP      ANDEQ0
     C           PSTD      ANDGELSTD
     C                     SETOF                     39
     C                     END
     C*
     C** TEST STATEMENT FREQUENCY AND POSTING DATE
     C           STFQ      COMP 'A'                      55
     C   35      PSTD      COMP RUND                 56
     C  N35      PSTD      COMP BKAPDT               56
     C           PSTD      COMP RUND                 57
     C/COPY WNCPYSRC,GL0065C105
     C** ADDITIONAL PROCESSING FOR FORMAT 5.
     C** Do not test CUOR since it is no longer updated to APOST
     C** If VALD and PSTD are both less than or equaled to LSTD
     C** do not include posting.
     C*
     C           *IN39     IFEQ '1'
     C           *IN40     ANDEQ'1'
     C           VALD      ANDLELSTD
     C/COPY WNCPYSRC,GL0065C046
     C                     SETON                     88
     C                     ELSE
     C                     SETOF                     88
     C                     END
     C   39 40N88
     CANN04                EXSR FORM5
     C   39 40N88
     CANN04                SETON                     74
     C*
     C** IF POSTING ALREADY APPEARED STATEMENT BYPASS PRINT
     C   39                GOTO STM3
     C/COPY WNCPYSRC,GL0065C109
     C                     SETON                     5149
     C** AFTER FIRST POST, STOP INITIAL CLEARING PRINT.
     C   75                SETOF                     75
     C   74                Z-ADD0         I
     C   74                Z-ADDLSTD      VDCD
     C           VDS       TAG                             * VDS TAG *
     C   74      I         ADD  1         I
     C   74      VDCD      ADD  1         VDCD
     C   74      I         COMP 60                   88
     C   74 88   I         SUB  60        I
     C   74      VDCD      COMP PSTD                     88
     C   74 88             GOTO VDO
     C   74      VDDR      ADD  VDAR,I    VDDR
     C   74      VDCR      ADD  VCAR,I    VDCR
     C   74      VDCBBF    ADD  VDAR,I    VDCBBF
     C   74      VDCBBF    SUB  VCAR,I    VDCBBF
     C/COPY WNCPYSRC,GL0065C099
     C   74                Z-ADD0         VDAR,I
     C   74                Z-ADD0         VCAR,I
     C   74                GOTO VDS
     C           VDO       TAG                             * VDO TAG *
     C   74      VDDR      COMP 0                    75
     C   74N75   VDCR      COMP 0                    75
     C   74 75             Z-ADDVDCBBF    CLBAL
     C/COPY WNCPYSRC,GL0065C100
     C   74 75   VDCBBF    COMP 0                    32
     C*
     C/COPY WNCPYSRC,GL0065CP22
     C*
     C   74 75   LINCNT    ADD  1         LINCNT
     C*
     C/COPY WNCPYSRC,GL0065CP23
     C*
     C   74                SETOF                     74
     C** IF NO CLEARINGS FROM LAST STMT.
     C** SET VDCD EQ. PSTD, & I EQ. TO 1.
     C           I         COMP 0                        88
     C   88                Z-ADD1         I
     C   88                Z-ADDPSTD      VDCD
     C/COPY WNCPYSRC,GL0065C085
     C*
     C** ADD POSTING ENTRY TO BALANCE
     C   22N04   PSTBAL    SUB  PSTA      PSTBAL     47
     C   23N04   PSTA      ADD  PSTBAL    PSTBAL     47
     C/COPY WNCPYSRC,GL0065C086
     C                     SETON                     29
     C   40N04             EXSR FORM5
     C   40 22N04NCR       ADD  1         NCR
     C*
     C/COPY WNCPYSRC,GL0065CP44
     C*
     C   40 22N04PSCR      ADD  PSTA      PSCR
     C*
     C/COPY WNCPYSRC,GL00654C45
     C*
     C   40 23N04NDR       ADD  1         NDR
     C*
     C/COPY WNCPYSRC,GL0065CP46
     C*
     C   40 23N04PSDR      ADD  PSTA      PSDR
     C*
     C/COPY WNCPYSRC,GL0065CP47
     C*
     C** Core hook for externalisation.
     C/COPY WNCPYSRC,GL0065CCP5
     C*
     C** CONVERT VALUE DATE AND POSTING DATE.
     C                     Z-ADDVALD      ZDAYNO  50
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    VALDA   7
     C/COPY WNCPYSRC,GL0065CX25
     C*
     C                     Z-ADDPSTD      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    PSTDA   7
     C/COPY WNCPYSRC,GL0065C033
     C           PSTDA     COMP VALDA                6969
     C*
     C/COPY WNCPYSRC,GL0065CP24
     C*
     C** Determine if group account
     C                     MOVE '0'       *IN53
     C           CRE008    IFEQ 'Y'
     C           XRFI      IFNE *BLANKS
     C           XRFN      ANDNE*ZERO
     C           EXTKEY    CHAINGLAPSGL0             24
     C           *IN24     IFEQ '0'
     C           AGSRNO    IFGT 0
     C           W#ORAC    CAT  SRCRET:1  W#ORIG 40
     C                     ELSE
     C           W#ORAC    CAT  SRCGL:1   W#ORIG
     C                     ENDIF
     C                     MOVE '1'       *IN53
     C           LINCNT    ADD  1         LINCNT
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C*
     C** DETERMINE IF ORIGINAL AMOUNT AND CCY REQUIRED.
     C*
     C           CEU013    IFEQ 'Y'
     C           XRFI      IFNE *BLANKS
     C           XRFN      ANDNE*ZERO
     C/COPY WNCPYSRC,GL0065C073
     C           EXTKEY    CHAINGLAPSTPF             24
     C/COPY WNCPYSRC,GL0065C070
     C           *IN24     IFEQ '0'
     C/COPY WNCPYSRC,GL0065C071
     C                     MOVELOCCY      ROCCY   3
     C*
     C                     CALL 'AOCURRR0'
     C                     PARM *BLANKS   UUAPRC  7
     C                     PARM '*KEY'    UUAPOP  7
     C                     PARM OCCY      UUCYCD  3
     C           SDCURR    PARM SDCURR    DSSDY
     C*
     C           UUAPRC    IFNE *BLANKS
     C                     MOVEL'SDCURRPD'DBFILE           ************
     C                     MOVELBKEURO    DBKEY            * DBERR 09 *
     C                     Z-ADD09        DBASE            ************
     C                     EXSR *PSSR
     C                     ELSE
     C           A6NBDP    IFEQ 0
     C                     MOVE '1'       *INKE
     C                     ENDIF
     C           A6NBDP    IFEQ 1
     C                     MOVE '1'       *INKF
     C                     ENDIF
     C           A6NBDP    IFEQ 2
     C                     MOVE '1'       *INKG
     C                     ENDIF
     C           A6NBDP    IFEQ 3
     C                     MOVE '1'       *INKH
     C                     ENDIF
     C                     ENDIF
      *
     C                     Z-ADDOAMT      ROAMT  150
     C                     SETON                     78
     C/COPY WNCPYSRC,GL0065C072
     C                     ELSE
     C                     SETOF                     78
     C                     ENDIF
     C                     ELSE
     C                     SETOF                         78
     C                     ENDIF
     C*
     C                     ENDIF
     C/COPY WNCPYSRC,GL0065C079
     C*
     C** DETERMINE IF NEW PAGE NEEDED FOR STATEMENT
     C           STPA      COMP LSTPX                    48
     C/COPY WNCPYSRC,GL0065C074
     C           LINCNT    ADD  1         LINCNT
     C  N48      LINCNT    COMP 1                        50
     C  N48N50 53LINCNT    COMP 2                        50
     C*
     C** SET INDICATORS FOR PRINT
      *
     C/COPY WNCPYSRC,GL0065CP39
      *
     C                     EXSR SETONS
     C*
     C/COPY WNCPYSRC,GL0065CP12
     C*
     C   50                EXCPT
     C*
     C/COPY WNCPYSRC,GL0065CP13
     C*
     C                     SETOF                     506061
     C                     SETOF                     626364
     C                     SETOF                     656667
     C                     SETOF                     808187
     C                     SETOF                     89
     C*
     C/COPY WNCPYSRC,GL0065CP14
     C*
     C                     EXCPTDET
     C*
     C/COPY WNCPYSRC,GL0065CP15
     C*
     C           STM3      TAG                             ** STM3 TAG  **
     C           NEX       TAG
     C                     MOVE PSTD      PSTDP   50
     C                     END
     C/SPACE 3
     C*
     C           ENDPRT    TAG                             ** ENDPRT TAG *
     C*
     C/COPY WNCPYSRC,GL0065C019
     C  N02
     CORN40                GOTO OFBP
     C*
     C** FOR FORM,X EQ. 5 :-
     C** CHECK FOR ANY AMOUNTS CLEARING AFTER
     C** THE LAST POSTING HAS BEEN PRINTED ON
     C** THIS STATEMENT BUT BEFORE END OF
     C** PERIOD COVERED BY IT, INCLUDING ANY
     C** OVERFLOW AMOUNTS.
     C*
     C                     Z-ADDCLBAL     CLBF       28
     C                     Z-ADD1         I
     C           LSTD      ADD  1         VDCD
     C** ADD OVERFLOW VALUES.
     C                     Z-ADDVCOF      VDCR
     C                     Z-ADDVDOF      VDDR
     C           CLBF      ADD  VDOF      CLBF
     C           CLBF      SUB  VCOF      CLBF
     C           CLBEG     TAG                             *  CLBEG TAG *
     C** UPDATE TOTALS.
     C/COPY WNCPYSRC,GL0065C047
     C           CLBF      ADD  VDAR,I    CLBF
     C           CLBF      SUB  VCAR,I    CLBF
     C           VDDR      ADD  VDAR,I    VDDR
     C           VDCR      ADD  VCAR,I    VDCR
     C/COPY WNCPYSRC,GL0065C048
     C** INCREMENT INDEX & DATE.
     C           I         ADD  1         I
     C           VDCD      ADD  1         VDCD
     C** WRAP  AROUND
     C           I         COMP 60                   88
     C   88      I         SUB  60        I
     C** CHECK NEW DATE IS WITHIN PERIOD.
     C   55 35
     CORN55      VDCD      COMP RUND                 88
     C** IF ACCRUAL FREQ/NOT DEMAND INCLUDE UP TO CURRENT STATEMENT DATE
     C** NOT UP TO NEXT ACCRUAL DATE  (WILL HAVE BEEN UPDATED IN SD0640)
     C   55N35   VDCD      COMP NSTD                 88
     C  N88                GOTO CLBEG
     C** CHECK WHETHER ITEMS ARE CLEARED AFTER LAST POST.
     C           VDDR      COMP 0                    1919
     C  N19      VDCR      COMP 0                    1919
     C/COPY WNCPYSRC,GL0065C075
     C   19      FFLCNT    COMP 31                       18
     C/COPY WNCPYSRC,GL0065C076
     C** CONDITION DR/CR ON PAGE/STMT. TOTAL.
     C   18      CLBAL     COMP 0                    37
     C   18                Z-ADDSTPA      STPFF   40
     C*
     C/COPY WNCPYSRC,GL0065CP25
     C*
     C   18      STPA      ADD  1         STPA
     C*
     C/COPY WNCPYSRC,GL0065CP26
     C*
     C   19      CLBF      COMP 0                    28
     C           OFBP      TAG                             * OFBP TAG *
     C*
     C** UPDATE NEXT STMT DATE IF NEEDED
      *
      ** If demand statement is requested and next statement date is
      ** equal to rundate, and the account has postings, set off *IN35
      ** and set on *IN52 to update ACCNTAB.
      *
     C           *IN35     IFEQ '1'
     C           *IN15     ANDEQ'1'
     C           NSTD      ANDEQRUND
     C                     MOVE '0'       *IN35
     C                     MOVE '1'       *IN52
     C                     END
      *
     C   59N35             SETON                     68
     C  N68                GOTO FREND
     C** UPDATE NEXT STATEMENT DATE
     C                     Z-ADDNSTD      NSTDA
     C/COPY WNCPYSRC,GL0065C036
     C                     Z-ADDSTDY      ZMDAY
     C*
     C** CHECK FOR STFQ 'A'.IF APDA NEEDS RECALCULATING
     C** APDA MAY HAVE ALREADY BEEN UPDATED IN E.O.D.PHASE FIVE-SDP0640
     C           STFQ      COMP 'A'                      68
     C   68                Z-ADDBKAPDT    NSTDA
     C   68                GOTO FRCHK
     C** RECALCULATION ROUTINE
     C           FRTOP     TAG                             ** FRTOP TAG **
     C*
     C** IF STMT FREQ 'Z' ZEROIZE  NEXT STMT DATE
     C           STFQ      COMP 'Z'                      68
     C   68                Z-ADD0         NSTDA
     C   68                GOTO FRCHK
     C           STFQ      COMP 'D'                      68
     C/COPY WNCPYSRC,GL0065CX33
     C   68                Z-ADDBJDNWD    NSTDA
     C   68                GOTO FRCHK
      *
     C/COPY WNCPYSRC,GL0065CP43
      *
     C           STFQ      COMP 'A'                      68
     C   68                MOVE BKAPFQ    ZFREQ
     C   68                Z-ADDBKAPFD    ZMDAY
     C  N68                MOVE STFQ      ZFREQ
     C  N68                Z-ADDSTDY      ZMDAY
     C*
     C** IF THE STATEMENT FREQUENCY IS M,E,T,Q,X OR Y, SUBR ZFREQ
     C** RELIES ON ZMDAY (STDY) BEING DEFINED - ENSURE THAT
     C** THIS IS THE CASE.
     C*
     C  N68      STFQ      COMP 'M'                      85
     C  N68N85   STFQ      COMP 'T'                      85
     C  N68N85   STFQ      COMP 'Q'                      85
     C  N68N85   STFQ      COMP 'X'                      85
     C  N68N85   STFQ      COMP 'Y'                      85
     C  N68 85             Z-ADDSTDY      ZMDAY          85
     C  N68 85             MOVELNSTDA     ZDAYNO
     C  N68 85             EXSR ZDATE2
     C  N68 85             Z-ADDZDAY      ZMDAY
     C                     Z-ADDNSTDA     ZDAYNO
     C                     MOVE BJE2TX    ZLOC
     C                     MOVE BJLCCY    ZCCY
     C*
     C  N68      STFQ      IFEQ 'E'
     C                     MOVE 'L'       ZFREQ
     C/COPY WNCPYSRC,GL0065C003
     C                     ELSE
     C                     MOVE STFQ      ZFREQ
     C                     END
     C*
     C** Subtract 1 from month if month of NSTD = month of next
     C** business date so that after ZFREQS, month of NSTD will be the
     C** same
     C*
     C           ZFREQ     IFEQ 'L'
     C           ZFREQ     OREQ 'B'
     C           ZFREQ     OREQ 'E'
     C                     Z-ADDBJDNWD    ZDAYNO
     C                     EXSR ZDATE2
     C                     Z-ADDZMTH      NWDMTH  20       TEMP STORAGE
     C                     Z-ADDNSTDA     ZDAYNO
     C                     EXSR ZDATE2
     C*
     C           ZMTH      IFEQ NWDMTH
     C*
     C           ZMTH      IFEQ 1
     C                     Z-ADD12        ZMTH
     C           ZYEAR     IFEQ 0
     C                     Z-ADD99        ZYEAR
     C                     ELSE
     C           ZYEAR     SUB  1         ZYEAR
     C                     END
     C                     ELSE
     C           ZMTH      SUB  1         ZMTH
     C                     END
     C*
     C           *IN98     IFEQ '1'
     C                     MOVE ZDAY      @ZWRK   40
     C                     MOVELZMTH      @ZWRK
     C                     ELSE
     C                     MOVELZDAY      @ZWRK
     C                     MOVE ZMTH      @ZWRK
     C                     END
     C*
     C                     MOVEL@ZWRK     ZDATE
     C                     MOVE ZYEAR     ZDATE
     C                     EXSR ZDATE1
     C                     END
     C*
     C                     END
     C*
     C                     EXSR ZFREQB
     C           *INU8     IFEQ '1'
     C                     GOTO END
     C                     END
     C/COPY WNCPYSRC,GL0065C077
     C                     Z-ADDZDAYNO    NSTDA
     C*
     C** CHECK IF CALCULATED DATE IS IN FUTURE.IF NOT RECALCULATE
     C           FRCHK     TAG                             ** FRCHK TAG **
     C*
     C           NSTDA     COMP BJDNWD               68  68
     C  N68      STFQ      COMP 'Z'                      68
     C  N68                GOTO FRTOP
     C*
     C           FREND     TAG                             ** FREND TAG **
     C*
     C** Switchable SAR S01377: Ignore check for zero B/F balance
     C** and type of account. @SAR set up in first cycle.
     C           @SAR      IFEQ *BLANKS
     C*
     C** SET INDICATOR FOR LAST POSTING PRINT
     C           ATYP      COMP 'R'                      52
     C           *IN26     IFEQ '0'
     C                     SETON                     52
     C                     END
     C                     END
     C   29
     COR 52
     COR 34
     COR 35                SETON                     52
     C*
     C** CONVERT CLOSING BALANCE INTO EUROS IF EMU SWITCHABLE FEATURE
     C** PRESENT.
     C           CEU013    IFEQ 'Y'
     C           EUSB      IFEQ 'Y'
     C           CCY       ANDNEBKEURO
     C                     SETON                     10
     C*
     C                     CALL 'EU0200'
     C                     PARM *BLANK    P@RTCD  7
     C/COPY WNCPYSRC,GL0065C101
     C                     PARM PSTBAL    P@FRAM 183
     C/COPY WNCPYSRC,GL0065C102
     C                     PARM CCY       P@FRCY  3
     C                     PARM BKEURO    P@TOCY  3
     C           EUPBAL    PARM           P@OUTA 150
     C                     PARM           P@INTA 183
     C                     PARM           P@EXRT 159
     C                     PARM           P@MDIN  1
     C*
     C                     CALL 'AOCURRR0'
     C                     PARM *BLANKS   UUAPRC  7
     C                     PARM '*KEY'    UUAPOP  7
     C                     PARM BKEURO    UUCYCD  3
     C           SDCURR    PARM SDCURR    DSSDY
     C*
     C           UUAPRC    IFNE *BLANKS
     C                     MOVEL'SDCURRPD'DBFILE           ************
     C                     MOVELBKEURO    DBKEY            * DBERR 08 *
     C                     Z-ADD08        DBASE            ************
     C                     EXSR *PSSR
     C                     ELSE
     C           A6NBDP    IFEQ 0
     C                     MOVE '1'       *INKA
     C                     ENDIF
     C           A6NBDP    IFEQ 1
     C                     MOVE '1'       *INKB
     C                     ENDIF
     C           A6NBDP    IFEQ 2
     C                     MOVE '1'       *INKC
     C                     ENDIF
     C           A6NBDP    IFEQ 3
     C                     MOVE '1'       *INKD
     C                     ENDIF
     C                     ENDIF
     C*
     C                     ELSE
     C                     SETOF                     10
     C                     ENDIF
     C                     ENDIF
     C*
     C** ZEROISE LINE COUNT FOR NEW STATEMENT
     C                     Z-ADD0         LINCNT
     C*
     C** OUTPUT TOTAL OUTPUT
     C*
     C/COPY WNCPYSRC,GL0065CP16
     C*
     C                     EXCPTTOT
     C*
     C/COPY WNCPYSRC,GL0065CP17
     C*
     C           ENDPS     TAG
     C/COPY WNCPYSRC,GL0065C108
     C                     END
     C/COPY WNCPYSRC,GL0065C043
     C*
     C** CHAIN TO ACCOUNT FILE TO UPDATE
     C*
     C                     SETOF                     03
     C           ACKEY     CHAINACCNT                77
     C           *IN03     IFNE '1'
     C                     SETON                     U7U8LR
     C                     Z-ADD03        DBASE            ***************
     C                     MOVEL*BLANKS   DBKEY            DATABSE ERROR
     C                     MOVELACKEY     DBKEY                  03
     C                     MOVEL'ACCNT'   DBFILE           ***************
     C                     END
     C*
     C** CHANGE BIT SETTING FOR OUTPUT
     C                     BITOF'01'      GLBT
     C/COPY WNCPYSRC,GL0065C022
     C                     SETON                     54
     C                     MOVE '0'       *IN38
     C           ATYP      IFEQ 'R'
     C           *IN33     ANDEQ'0'
     C                     MOVE '1'       *IN38
     C                     END
     C/COPY WNCPYSRC,GL0065C031
     C*
     C** If Account Statements Changes switchable feature is switched
     C** ON, call GL0421
     C*
     C           S01520    IFEQ 'Y'
     C*
     C** Move fields
     C*
     C                     MOVELCNUM      WCNUM   6
     C                     MOVELACOD      WACOD  10
     C                     MOVELACSQ      WACSQ   2
     C*
     C                     CALL 'GL0421'
     C                     PARM           BRCA
     C                     PARM           WCNUM
     C                     PARM           CCY
     C                     PARM           WACOD
     C                     PARM           WACSQ
     C                     PARM           RUND
     C                     PARM           PSTBAL
     C                     PARM           BKAPRP
     C                     PARM *BLANKS   @ERROR  1
     C*
     C** If an error occured in the called program, do database error
     C** processing
     C*
     C           @ERROR    IFEQ 'S'
     C                     MOVE *BLANKS   DBPGM
     C                     MOVE *BLANKS   DBKEY
     C                     MOVEL'SDACODPD'DBFILE           ************
     C                     MOVEL'GL0421'  DBPGM            * DBERR 06 *
     C                     MOVELWACOD     DBKEY            ************
     C                     Z-ADD06        DBASE
     C                     EXSR *PSSR
     C                     ELSE
     C           @ERROR    IFEQ 'C'
     C                     MOVE *BLANKS   DBPGM
     C                     MOVE *BLANKS   DBKEY
     C                     MOVELBRCA      WBRCA
     C                     MOVELCCY       WCCY
     C                     MOVELRUND      WRUND
     C                     MOVEL'CPOSTDD 'DBFILE           ************
     C                     MOVEL'GL0421'  DBPGM            * DBERR 06 *
     C                     MOVELWKEYDS    DBKEY            ************
     C                     Z-ADD06        DBASE
     C                     EXSR *PSSR
     C                     END
     C                     END
     C*
     C                     END
      *
     C/COPY WNCPYSRC,GL0065CP40
      *
     C                     GOTO FINISH
     C/SPACE 3
     C********************************************************************
     C*
     C** FILE CONTROL CHECK
     C           STRAIL    TAG                             ** STRAIL TAG *
     C** SUBTRACT 2 FOR HEADER AND TRAILER.
     C           STMSIZ    SUB  2         STMSIZ
     C           TNAR      COMP STMSIZ               8686
     C   86                SETON                     U8
     C** IF PROCESSING REACHES THIS POINT DATABASE ERROR 04 HAS NOT OCCURED
     C                     SETOF                     16
     C/SPACE 3
     C********************************************************************
     C*
      /EJECT
      *
      ** NORMAL END OF CYCLE WILL GO TO FINISH
      *
     C           FINISH    TAG                             ** FINISH TAG *
     C   U7                SETON                     LR
      *
     C/COPY WNCPYSRC,GL0065CP33
      *
     CLRNU7                EXSR ENDRPT
     C*
     C**  Close down switchable SAR's file
     C*
     CLR                   CALL 'AOSARDR0'
     CLR                   PARM '       ' @RTCD
     CLR                   PARM '*FREE'   @OPTN
     CLR                   PARM *BLANK    @SARD
     CLR         SCSARD    PARM SCSARD    DSFDY
     C*
     C**  If an error has occurred
     C*
     CLR         @RTCD     IFNE *BLANKS
     CLR                   Z-ADD27        DBASE            *************
     CLR                   MOVEL*BLANKS   DBKEY            DATABASE ERROR
     CLR                   MOVEL@OPTN     DBKEY                27
     CLR                   MOVE 'SCSARDPD'DBFILE           *************
     CLR                   MOVEL@OPTN     DBOPTN  7
     CLR                   EXSR *PSSR
     CLR                   END
      *
      ** ENSURE TOTALS SPOOL FILE RECORDED BY RCF
     CLR                   Z-ADDSFNUMU    SFNM    60
     CLR                   OUT  LDA
     CLR                   CALL 'ZSFILE'
     CLR                   PARM           SEQ
     CLR                   PARM *BLANKS   SENTY   3
     CLR                   PARM           SFILEU
     CLR                   PARM           SFNM
     CLR                   PARM           ZSERR   1
      *
     CLR         *LOCK     IN   LDA
     CLR         ZSERR     IFEQ 'Y'
      *
      ** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAMME
      *
     CLR                   SETON                     U7U8
     CLR                   RETRN
     CLR                   END
      ** IF 16 IS STILL ON AT LAST RECORD DATABASE ERROR HAS OCCURED
     CLR 16NU7             Z-ADD04        DBASE            **************
     CLR 16NU7             MOVEL'MISSING' DBMSG  15        DATABASE ERROR
     CLR 16NU7             MOVE 'TRAILER' DBMSG                04
     CLR 16NU7             MOVE BLANK     DBKEY            **************
     CLR 16NU7             MOVELDBMSG     DBKEY
      *
     C/COPY WNCPYSRC,GL0065CP30
      *
     CLR 16NU7             MOVE 'STMTS'   DBFILE
      *
     C/COPY WNCPYSRC,GL0065CP31
      *
     CLR 16NU7             SETON                     U7U8
     CLR 16 U7             EXSR *PSSR
     CLR         END       TAG
     C/EJECT
     C*   SUBROUTINES.
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*
     C*  ENDRPT  -  SUBROUTINE TO OUTPUT THE NARRATIVE 'END OF
     C*             REPORT FOR BRANCH XXX' AT THE END OF THE
     C*             SPOOL FILES WHICH ALREADY HVE STATEMENTS OUTPUT
     C*
     C*  CALLED BY - MAIN PROGRAM AND LAST CYCLE
     C*
     C*  CALLS - NOTHING
     C*
     ******************************************************************
     C*
     C           ENDRPT    BEGSR
     C*
     C           SWRIT1    IFNE 0
     C           SWRIT1    ANDNE@BBIN1
     C                     EXCPTERPT1
     C                     Z-ADD0         SWRIT1
     C                     END
     C*
     C/COPY WNCPYSRC,GL0065C013
     C           SWRIT2    IFNE 0
     C           SWRIT2    ANDNE@BBIN2
     C                     EXCPTERPT2
     C                     Z-ADD0         SWRIT2
     C                     END
     C*
     C/COPY WNCPYSRC,GL0065C058
     C           SWRIT3    IFNE 0
     C           SWRIT3    ANDNE@BBIN3
     C                     EXCPTERPT3
     C                     Z-ADD0         SWRIT3
     C                     END
     C/COPY WNCPYSRC,GL0065C014
     C*
     C           SWRIT4    IFNE 0
     C           SWRIT4    ANDNE@BBIN4
     C                     EXCPTERPT4
     C                     Z-ADD0         SWRIT4
     C                     END
     C*
     C           SWRIT5    IFNE 0
     C           SWRIT5    ANDNE@BBIN5
     C                     EXCPTERPT5
     C                     Z-ADD0         SWRIT5
     C                     END
     C*
     C           SWRIT6    IFNE 0
     C           SWRIT6    ANDNE@BBIN6
     C                     EXCPTERPT6
     C                     Z-ADD0         SWRIT6
     C                     END
     C*
     C*
     C** Core hook for externalisation.
     C/COPY WNCPYSRC,GL0065CCP6
     C*
     C                     ENDSR
     C*****************************************************************
     C/EJECT
     C**********************************************************
     C**
     C**   FORM5 SUBR.
     C**
     C**   THIS SUBROUTINE UPDATES THE CLEARED BALANCE FOR STATEMENT
     C**   FORMAT 5.
     C**
     C**********************************************************
     C           FORM5     BEGSR                           ** FORM5 **
     C*
     C** ON CHANGE OF PSTD, UPDATE CLBAL BETWEEN VDCD & PSTD
     C** EXCLUDING PSTD,
     C  NL1
     COR 39
     COR 75                GOTO FORMB
     C           FORMA     TAG                             * FORMA TAG *
     C*
     C** PROCEED TO PROCESSING OF CURRENT POSTING IF VDCD EQ. PSTD.
     C           VDCD      COMP PSTD                     88
     C   88                GOTO FORMB
     C*
     C** UPDATE CLEARED BALANCE.
     C           CLBAL     ADD  VDAR,I    CLBAL
     C           CLBAL     SUB  VCAR,I    CLBAL
     C/COPY WNCPYSRC,GL0065C103
     C** CLEAR OUT THESE ELEMENTS.
     C                     Z-ADD0         VDAR,I
     C                     Z-ADD0         VCAR,I
     C** INCREMENT INDEX AND CONTROL DATE.
     C           I         ADD  1         I
     C           VDCD      ADD  1         VDCD
     C** WRAP AROUND INDEX.
     C           I         COMP 60                   88
     C   88      I         SUB  60        I
     C                     GOTO FORMA
     C           FORMB     TAG                             * FORMB TAG *
     C*
     C** UPDATE ARRAY WITH CURRENT CLEARING,
     C** OR IF BEYOND 60 DAYS UPDATE OVERFLOW.
     C** CHECK VALUE DATE IS WITHIN PERIOD.
     C   55 35
     CORN55      VALD      COMP RUND                 88
     C** DO UP TO NSTD NOT TO ALREADY UPDATED ATDA (IN SD0640)
     C   55N35   VALD      COMP NSTD                 88
     C   88                GOTO FORMD
     C** IF VALD L. T. PSTD, SET VDIN EQ. TO PSTD - VDCD.
     C** DO NOT TEST IF CLEARING FROM LAST STATEMENT.
     C  N39      VALD      COMP PSTD                   88
     C   88      PSTD      SUB  VDCD      VDIN    20
     C** ELSE SET VDIN EQ. TO VALD - VDCD.
     C  N88      VALD      SUB  VDCD      VDIN
     C** CHECK FOR OVERFLOW.
     C           VDIN      COMP 60                   88  88
     C** IF OVERFLOW, UPDATE OVERFLOW TOTAL.
     C/COPY WNCPYSRC,GL0065C087
     C   88 22   VCOF      ADD  PSTA      VCOF
     C   88 23   VDOF      ADD  PSTA      VDOF
     C/COPY WNCPYSRC,GL0065C088
     C   88                GOTO FORMC
     C** ELSE UPDATE ARRAYS.
     C           I         ADD  VDIN      J       20
     C           J         COMP 60                   88
     C   88      J         SUB  60        J
     C/COPY WNCPYSRC,GL0065C049
     C   22      VCAR,J    ADD  PSTA      VCAR,J
     C   23      VDAR,J    ADD  PSTA      VDAR,J
     C/COPY WNCPYSRC,GL0065C050
     C** SET 'APPEARED IN CLEARED BALANCE IND.'
     C           FORMC     TAG                             * FORMC TAG *
     C                     BITON'5'       CUOR
     C           FORMD     ENDSR
     C********************************************************************
     C*
     C*    SETONS SR. SETS ON THE REQUIRED INDICATORS FOR PRINTING
     C*
     C           SETONS    BEGSR                           **** SETONS ***
     C*
     C*
     C  N50                GOTO SEND
     C*
     C/COPY WNCPYSRC,GL0065C110
     C   40                SETON                     87
     C   41N34             SETON                     60
     C/COPY WNCPYSRC,GL0065C034
     C   42                SETON                     62
     C   43                SETON                     64
     C   44                SETON                     66
     C/COPY WNCPYSRC,GL0065C035
     C   41 34             SETON                     80
     C*
     C  N36                GOTO SEND
     C*
     C   87                SETON                     89
     C   60                SETON                     61
     C   62                SETON                     63
     C   64                SETON                     65
     C   66                SETON                     67
     C   80                SETON                     81
     C*
     C/COPY WNCPYSRC,GL0065C015
     C           SEND      ENDSR
     C/COPY WNCPYSRC,GL0065C016
     C*
     C********************************************************************
     C*
     C*    ZDATE1 SR. TO VALIDATE DATES  AND
     C*          CONVERT TO A NUMBER OF DAYS.
     C*
     C           ZDATE1    BEGSR                           *** ZDATE1 ***
     C*
     C** CLEAR DAY NUMBER.
     C                     Z-ADD0         ZDAYNO  50
     C*
     C** CALCULATION TO DEFINE INPUT DATE FIELD.
     C                     Z-ADDZDATE     ZDATE   60
     C*
     C** GET INDIVIDUAL DAY, MONTH AND YEAR FIELDS.
     C                     MOVE ZDATE     ZYEAR   20
     C  N98                MOVELZDATE     ZDAY    20
     C   98                MOVELZDATE     ZMTH    20
     C                     MOVE ZDATE     ZWRK4   40
     C  N98                MOVELZWRK4     ZMTH
     C   98                MOVELZWRK4     ZDAY
     C*
     C** ENSURE MONTH IS VALID.
     C           ZMTH      COMP 0                      9999
     C  N99      ZMTH      COMP 12                   99
     C   99                GOTO ZDEND1                     BYPASS IF ERROR
     C*
     C** CHECK FOR 30 DAY MONTHS.
     C           ZMTH      COMP 4                        90IF 90 ON, 30
     C  N90      ZMTH      COMP 6                        90DAY MONTH.
     C  N90      ZMTH      COMP 9                        90
     C  N90      ZMTH      COMP 11                       90
     C*
     C** ENSURE DAY IS VALID.
     C           ZDAY      COMP 0                      9999
     C   90N99   ZDAY      COMP 30                   99
     C  N90N99   ZDAY      COMP 31                   99
     C   99                GOTO ZDEND1                     BYPASS IF ERROR
     C*
     C** CHECK FOR LEAP YEAR AND FEBRUARY.
     C           ZYEAR     ADD  28        ZYEAR
     C           ZYEAR     DIV  4         ZLYR    20
     C                     MVR            ZLY     10     91LEAP YR, 91 ON
     C           ZMTH      COMP 2                    93  92FEB., 92 ON
     C*                                                    PAST FEB, 93 ON
     C** IF FEBUARY FURTHER VALIDATE DAY.
     C  N91 92   ZDAY      COMP 28                   99
     C   91 92   ZDAY      COMP 29                   99
     C   99                GOTO ZDEND1                     BYPASS IF ERROR
     C*
     C** DETERMINE NUMBER OF DAYS FROM 31/12/1971.     NO.OF 4 YR. SPANS
     C           ZLYR      MULT 1461      ZDAYNO           X DAYS IN SPAN.
     C  N91      ZDAYNO    ADD  ZYDY,ZLY  ZDAYNO           SINCE LAST L.YR
     C   91 93   ZDAYNO    ADD  1         ZDAYNO           L.YR.,PAST FEB.
     C           ZDAYNO    ADD  ZMDY,ZMTH ZDAYNO           DAYS THIS YEAR
     C           ZDAYNO    ADD  ZDAY      ZDAYNO           DAYS THIS MONTH
     C*
     C           ZDEND1    ENDSR                           * ZDEND1 ENDSR*
     C*
     C********************************************************************
     C*
     C*
     C**   ZDATE2 SR. TO CONVERT A DAY NUMBER TO DATE FORMATS.
     C**
     C           ZDATE2    BEGSR                           *** ZDATE2 ***
     C*
     C** CLEAR DATE FIELDS.
     C                     Z-ADD0         ZDATE   60
     C                     MOVEL'       ' ZADATE  7
     C*
     C** CALCULATION TO DEFINE INPUT DAY NUMBER.
     C                     Z-ADDZDAYNO    ZDAYNO  50
     C*
     C** DETERMINE YEAR NUMBER.
     C*
     C** ADJUST DAY NUMBER IN CASE LAST DAY OF YEAR.
     C           ZDAYNO    SUB  1         ZDAYN1  50   99
     C   99                GOTO ZDEND2
     C*
     C** CALCULATE NUMBER OF 4 YEAR SPANS SINCE 31/12/1971.
     C           ZDAYN1    DIV  1461      ZLYR    20
     C                     MVR            ZDAYN1           SAVE REMAINING
     C*                                                    DAYS
     C** CALCULATE NUMBER OF REMAINING YEARS.
     C                     Z-ADD1         ZWRK2   20
     C           ZDTAG1    TAG                             ** ZDTAG1 TAG *
     C           ZDAYN1    COMP ZYDY,ZWRK2             90
     C  N90      ZWRK2     ADD  1         ZWRK2
     C  N90                GOTO ZDTAG1
     C           ZWRK2     SUB  1         ZWRK2          91LEAP YR, 91 ON
     C*
     C** DECREMENT DAY NO. BY DAYS IN REMAINING YEARS.
     C  N91      ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1
     C*
     C** CALCULATE ACTUAL YEAR NUMBER.
     C           ZLYR      MULT 4         ZWRK3   30
     C           ZWRK3     ADD  72        ZWRK3            BASE IS 1972
     C                     Z-ADDZWRK3     ZYEAR   20
     C           ZYEAR     ADD  ZWRK2     ZYEAR            YEAR
     C*
     C** DETERMINE MONTH NUMBER.
     C*
     C** ADJUST DAY NO. IN CASE LAST DAY OF LEAP YEAR FEBRUARY.
     C                     SETOF                     9293
     C   91      ZDAYN1    COMP 59                     9293
     C   91N92   ZDAYN1    SUB  1         ZDAYN1
     C*
     C** CALCULATE MONTH NUMBER.
     C                     Z-ADD2         ZWRK2
     C           ZDTAG2    TAG                             ** ZDTAG2 TAG *
     C           ZDAYN1    COMP ZMDY,ZWRK2             94
     C  N94      ZWRK2     ADD  1         ZWRK2
     C  N94                GOTO ZDTAG2
     C           ZWRK2     SUB  1         ZWRK2
     C*
     C                     Z-ADDZWRK2     ZMTH    20       MONTH
     C*
     C** DETERMINE DAY OF MONTH.
     C*
     C** ADD BACK LAST DAY OF YEAR ADJUSTMENT.
     C           ZDAYN1    ADD  1         ZDAYN1
     C*
     C** CALCULATE DAY OF MONTH.
     C           ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY
     C*
     C** ADD BACK LEAP YEAR 29TH FEBUARY ADJUSTMENT, IF REQUIRED.
     C   93      ZDAY      ADD  1         ZDAY
     C*
     C** FORMAT DATE, DDMMYY OR MMDDYY.
     C  N98                MOVELZDAY      ZWRK4   40
     C   98                MOVE ZDAY      ZWRK4
     C  N98                MOVE ZMTH      ZWRK4
     C   98                MOVELZMTH      ZWRK4
     C                     MOVELZWRK4     ZDATE
     C                     MOVE ZYEAR     ZDATE
     C*
     C** FORMAT ALPHA DATE, DDMMMYY.
     C           ZDAY      COMP 10                     95
     C                     MOVELZDAY      ZWRK5   5
     C   95                MOVEL' '       ZWRK5
     C                     MOVE ZMNM,ZMTH ZWRK5
     C                     MOVELZWRK5     ZADATE
     C                     MOVE ZYEAR     ZADATE
     C*
     C           ZDEND2    ENDSR                           * ZDEND2 ENDSR*
     C*
     C********************************************************************
     C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
     C*   IND '99' IS SET BY AN OVERFLOW ERROR
     C*
     C           GLZADD    BEGSR                           *** GLZADD ***
     C*
     C                     Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
     C   91                GOTO ZZAEND                     AMT = 0.BYPASS
     C*
     C** SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
     C                     Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
     C                     MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
     C** BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
     C*
     C                     EXSR GLZSUM
     C           ZZAEND    ENDSR                           ** ZZAEND TAG *
     C*
     C********************************************************************
     C* SUBROUTINE TO COMPARE AN AMOUNT TO THE TOTAL.
     C*      PARAMETERS. I/P - ZZINT - THE INTEGER PORTION OF THE NUMBER.
     C*                  I/P - ZZDEC - THE DECIMAL PORTION OF THE NUMBER.
     C*                  O/P - ZZDIFI - IS THE INTEGER DIFFERENCE.
     C*                  O/P - ZZDIFD - IS THE DECIMAL DIFFERENCE.
     C*                  O/P - ZZNEGD - FOR IMMEDIATE PRINTING ONLY.
     C*                  O/P - 96 IS SET IF DIFFERENCE IS NEGATIVE.
     C*
     C*    IF AN ERROR HAS OCCURED ZZDIFI AND ZZDIFD WILL BE ZERO.
     C*        '99' - OVERFLOW ERROR
     C*        '97' - THE 'SIGN' ZONES OF ZZINT AND ZZDEC ARE DIFFERENT
     C*
     C           GLZCMP    BEGSR                           *** GLZCMP ****
     C                     SETOF                     9799
     C                     Z-ADDZZDEC     ZZDEC   30 919293DEFINE ZZDEC
     C                     Z-ADDZZINT     ZZINT  150 949596DEFINE ZZINT
     C** IF SIGN ZONES DIFFER, SET 97, & RETURN ZERO.
     C   91 95
     COR 92 94             SETON                     97    ERROR -MIXED
     C*                                                           STATUS
     C   97                GOTO ZZQUIT                     BRANCH TO ADMIT
     C*
     C** SPECIAL CASES DEALT WITH FIRST
     C*      EITHER AMOUNTS EQ '0' OR BOTH AMOUNTS 'EQ'
     C                     SETOF                     9192
     C                     SETOF                     9495
     C   93 96             SETON                     91    * IF I/P FIELD
     C   91                Z-ADDZZTOTI    ZZDIFI 150       *    ZERO
     C   91                Z-ADDZZTOTD    ZZDIFD  30       *
     C   91                GOTO ZZSIGN
     C*
     C           ZZTOTI    COMP ZZINT                    91* IF FIELDS EQ
     C   91      ZZTOTD    COMP ZZDEC                    91*
     C   91                Z-ADD0         ZZDIFI           *
     C   91                Z-ADD0         ZZDIFD           *
     C   91                GOTO ZZCEND
     C*
     C           ZZTOTI    COMP 0                        91* IF TOTAL
     C   91      ZZTOTD    COMP 0                        91*    ZERO
     C   91                Z-SUBZZINT     ZZDIFI           *
     C   91                Z-SUBZZDEC     ZZDIFD           *
     C*
     C           ZZSIGN    TAG                             *** ZZSIGN ****
     C*
     C** IF ZZDIFD IS ZERO, AND ZZDIFI IS NEG. SET UP ZZNEGD.
     C                     SETOF                     96
     C   91      ZZDIFD    COMP 0                        94
     C   94      ZZDIFI    COMP 0                      96
     C   96                MOVE '.000-'   ZZNEGD  5
     C   91                GOTO ZZCEND
     C** END OF SPECIAL CASES
     C*
     C** IF ZZTOTALS EQ 'B' AND ZZINT,ZZDEC EQ 'A'   THEN -
     C** TO COMPARE 'A' WITH 'B'
     C**    1. STORE ORIGINAL VALUE OF 'B'.
     C**    2. NEGATE 'A'.
     C**    3. ADD 'A' TO 'B'.
     C**    4. 'B' IS NOW THE DIFFERENCE. STORE 'B' IN FIELD 'C'.
     C**    5. RESTORE 'B'.
     C**           N.B. 'A' EQ ZZINT AND ZZDEC
     C**                'B' EQ ZZTOTI AND ZZTOTD
     C**                'C' EQ ZZDIFI AND ZZDIFD
     C*
     C**   STEP #1
     C                     Z-ADDZZTOTI    ZZSTRI 150
     C                     Z-ADDZZTOTD    ZZSTRD  30
     C**   STEP #2
     C                     Z-SUBZZINT     ZZAMTI 150
     C                     Z-SUBZZDEC     ZZAMTD  30
     C**   STEP #3
     C                     EXSR GLZSUM
     C*
     C   99                GOTO ZZQUIT
     C*    STEP #4
     C                     Z-ADDZZTOTI    ZZDIFI
     C                     MOVE ZZTOTD    ZZDIFD
     C*    STEP #5
     C                     Z-ADDZZSTRI    ZZTOTI 150
     C                     Z-ADDZZSTRD    ZZTOTD  30
     C                     GOTO ZZCEND                     BYPASS ADMIT
     C           ZZQUIT    TAG                             ** ZZQUIT TAG**
     C                     Z-ADD0         ZZDIFI
     C                     Z-ADD0         ZZDIFD
     C           ZZCEND    ENDSR                           ** ZZCEND TAG**
     C*
     C********************************************************************
     C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
     C*                        GLZADD, GLZSUB, GLZCMP.
     C*          PARAMETERS PASSED -
     C*                     I/P ZZAMTI ZZAMTD
     C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
     C*
     C           GLZSUM    BEGSR                           *** GLZSUM ****
     C*
     C                     Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
     C                     Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
     C                     SETOF                     919293
     C                     SETOF                     949599
     C*
     C** DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
     C           ZZAMTI    COMP 0                      9293
     C   93      ZZAMTD    COMP 0                      9293
     C   93                GOTO ZZSEND                     ZERO BYPASS
     C*
     C** DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
     C           ZZTOTI    COMP 0                      9193
     C   93      ZZTOTD    COMP 0                      9193
     C*
     C** IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
     C   93                Z-ADDZZAMTI    ZZTOTI
     C   93                Z-ADDZZAMTD    ZZTOTD
     C   93                GOTO ZZSEND                     ZERO BYPASS
     C** IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
     C   91N92
     CORN91 92             GOTO ZZOFPS
     C*
     C           ZZAMTD    ADD  ZZTOTD    ZZWK2   40
     C           ZZWK2     COMP 999                  93    '93' = CARRY
     C  N93      ZZWK2     COMP -999                   93    INTO INTEGER.
     C*
     C   93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
     C      93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
     C   93      ZZTOTI    ADD  ZZWK3     ZZWK3
     C  N93      ZZTOTI    ADD  ZZAMTI    ZZWK3
     C*
     C** IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
     C  N92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
     C   92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
     C  N99                Z-ADDZZWK2     ZZTOTD
     C  N99                Z-ADDZZWK3     ZZTOTI
     C*
     C** IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
     C   99                Z-ADD0         ZZAMT  153
     C                     GOTO ZZSEND
     C*
     C** THE 'SIGNS' ARE DIFFERENT
     C           ZZOFPS    TAG                             ** ZZOFPS TAG**
     C** IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
     C*
     C   92                Z-SUBZZAMTI    ZZAMTI 150
     C   92                Z-SUBZZAMTD    ZZAMTD  30
     C*
     C** IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
     C*
     C   91                Z-SUBZZTOTI    ZZTOTI
     C   91                Z-SUBZZTOTD    ZZTOTD
     C** BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
     C*
     C           ZZTOTI    COMP ZZAMTI               93  95
     C   95      ZZTOTD    COMP ZZAMTD               93  95
     C*
     C** IF ZZTOT EQ. ZZAMT RETURN ZERO.
     C   95                Z-ADD0         ZZTOTI
     C   95                Z-ADD0         ZZTOTD
     C   95                GOTO ZZSEND
     C*
     C** IF ZZTOT GT. ZZAMT.
     C   93      ZZAMTD    COMP ZZTOTD               94
     C   93 94   ZZTOTI    SUB  1         ZZTOTI
     C   93 94   ZZTOTD    ADD  1000      ZZWK2
     C   93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
     C   93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
     C   93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
     C*
     C** IF ZZAMT GT. ZZTOT.
     C  N93      ZZTOTD    COMP ZZAMTD               94
     C  N93 94   ZZAMTI    SUB  1         ZZWK3  150
     C  N93 94   ZZAMTD    ADD  1000      ZZWK2
     C  N93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
     C  N93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
     C********************************************************************
     C  N93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
     C  N93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
     C*
     C** REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
     C                     SETOF                     94
     C   93 91
     CORN93 92             SETON                     94
     C   94                Z-SUBZZTOTI    ZZTOTI
     C   94                Z-SUBZZTOTD    ZZTOTD
     C*
     C** RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
     C   92                Z-SUBZZAMTI    ZZAMTI
     C   92                Z-SUBZZAMTD    ZZAMTD
     C           ZZSEND    TAG                             ** ZZSEND TAG *
     C*
     C** IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
     C                     SETOF                     96
     C           ZZTOTD    COMP 0                        91
     C   91      ZZTOTI    COMP 0                      96
     C   96                MOVE '.000-'   ZZNEGD  5
     C                     ENDSR                             ** ENDSR **
     C********************************************************************
     C********************************************************************
     C**
     C**   ZFREQB-SR. TO INCREMENT A DAY NUMBER DATE BY A
     C**             PERIOD VALUE DETERMINED BY A CODE.
     C**
     C********************************************************************
      *
     C/COPY WNCPYSRC,GL0065CP41
      *
     C/COPY ZSRSRC,ZFREQBZ2
      *
     C/COPY WNCPYSRC,GL0065CP42
      *
     C/EJECT
     C********************************************************************
     C/COPY ZSRSRC,ZCHKH
     C/EJECT
     C********************************************************************
     C********************************************************************
     C/EJECT
     C********************************************************************
     C*
     C* ZACCH  --- SUBROUTINE TO ACCESS A HOLIDAY RECORD FOR A
     C*            PARTICULAR CURRENCY AND (OPTIONAL) LOCATION.
     C*
     C* CALLED FROM: ZFWDT, ZBKDT
     C*
     C* CALLS: NOTHING
     C*
     C********************************************************************
     C/COPY ZSRSRC,ZACCH
     C/EJECT
     C********************************************************************
     C*
     C* ZFWDT  --- SUBROUTINE TO CALCULATE THE NTH WORKING DAY
     C*            FORWARD FROM A GIVEN START DATE FOR ANY
     C*            PARTICULAR CURRENCY AND (OPTIONAL) LOCATION.
     C*
     C* CALLED FROM: ZFREQS
     C*
     C* CALLS: ZACCH
     C*
     C********************************************************************
     C/COPY ZSRSRC,ZFWDT
     C/EJECT
     C********************************************************************
     C*
     C* ZBKDT  --- SUBROUTINE TO CALCULATE THE NTH WORKING DAY
     C*            BACKWARD FROM A GIVEN START DATE FOR ANY
     C*            PARTICULAR CURRENCY AND (OPTIONAL) LOCATION.
     C*
     C* CALLED FROM: ZFREQS
     C*
     C* CALLS: ZACCH
     C*
     C********************************************************************
     C/COPY ZSRSRC,ZBKDT
     C*
     C/COPY WNCPYSRC,GL0065CP58
     C*
     C/EJECT
     C********************************************************************
     C*
     C* *PSSR  --- SUBROUTINE TO HANDLE ABNORMAL ERROR CONDITIONS
     C*
     C* CALLED FROM: AFTER ABNORNAL OPERATION OCCURS
     C*
     C* CALLS: NOTHING
     C*
     C********************************************************************
     C*
     C           *PSSR     BEGSR                           ** *PSSR **
     C*
     C           @RUN      IFEQ *BLANKS
     C                     MOVE 'Y'       @RUN    1
     C                     SETON                     U7U8
     C                     DUMP
     C                     END
     C                     ENDSR
     C********************************************************************
     C*
     C/COPY WNCPYSRC,GL0065CP29
     C*
     C/EJECT
     C/COPY WNCPYSRC,GL0065C004
     OGL0420P2E   01   60 84
     O/COPY WNCPYSRC,GL0065O001
     O                         FICHE     16
     O*
     O/COPY WNCPYSRC,GL0065OP10
     O*
     OGL0420P2E   03   60 84
     O/COPY WNCPYSRC,GL0065O037
     O                    36   @WCNA1    35
     O                    35             71 'DEMAND STATEMENT'
     O        E   04   61 84
     O/COPY WNCPYSRC,GL0065O038
     O                       36@WCNA2    35
     O        E   05   61 84
     O/COPY WNCPYSRC,GL0065O039
     O                       36@WCNA3    35
     O        E   06   61 84
     O/COPY WNCPYSRC,GL0065O040
     O                       36@WCNA4    35
     O*
     O/COPY WNCPYSRC,GL0065OP11
     O*
     O*       H   07   60
     O        E   07   60 84
     O/COPY WNCPYSRC,GL0065O041
     O** ETC.
     O                                   45 'OUR REF'
     O                 58      BRCA      50
     O                 58                51 '-'
     O                                   73 '-   -    -'
     O                         CNUM      57
     O                         CCY       61
     O                         ACOD      72
     O                         ACSQ      75
     O                N27      ACNO      86
     O                    58             97 'BRANCH -'
     O                    58   A8BRNM   128
     O        E   08   60 84
     O/COPY WNCPYSRC,GL0065O042
     O                         PAGE2 3  128
     O*
     O/COPY WNCPYSRC,GL0065OP12
     O*
     O*       H   10   60
     O        E   10   60 84
     O/COPY WNCPYSRC,GL0065O043
     O                                   10 'ACCOUNT'
     O                         ANAM      33
     O                                   48 'CURRENCY'
     O                         CCNM      65
     O/COPY WNCPYSRC,GL0065O128
     O                                   77 'DATE'
     O                         RUNA      87
     O/COPY WNCPYSRC,GL0065O129
     O                                  102 'PAGE'
     O/COPY WNCPYSRC,GL0065OY63
     O                         STPA  3  108
     O        E   11   60 84 05
     O                         RIBAN     50
     O*
     O** Core hook for externalisation.
     O/COPY WNCPYSRC,GL0065OOP6
     O*
     O        E   13   60 84
     O/COPY WNCPYSRC,GL0065O044
     O                                    7 'POSTING'
     O                                   16 'VALUE'
     O                                   27 'CHEQUE'
     O                                   50 'NARRATIVE'
     O/COPY WNCPYSRC,GL0065O107
     O                                   76 'DEBITS'
     O                                   99 'CREDITS'
     O                                  121 'BALANCE'
     O/COPY WNCPYSRC,GL0065O070
     O        E   14   60 84
     O/COPY WNCPYSRC,GL0065O045
     O                                    6 'DATE'
     O                                   16 'DATE'
     O                                   25 'NO'
     O/COPY WNCPYSRC,GL0065O071
     O        E   16   60 84
     O/COPY WNCPYSRC,GL0065O046
     O                                   60 'B/F'
     O*
     O/COPY WNCPYSRC,GL0065OP19
     O*
     O                         LSTDA      8
     O/COPY WNCPYSRC,GL0065O155
     O                       70PSTBF    127 '   ,   ,   ,   , 0 CR'
     O                       71PSTBF    127 '  ,   ,   ,   , 0 . CR'
     O                       72PSTBF    127 ' ,   ,   ,   , 0 .  CR'
     O                       73PSTBF    127 '   ,   ,   , 0 .   CR'
     O                 83               127 'DR'
     O/COPY WNCPYSRC,GL0065O075
     O*
     O        E 1      60 84 10
     O                         BKEURO    65
     O                                  105 '('
     O                       KAEUPBF    128 '   ,   ,   ,   , 0 CR)'
     O                       KBEUPBF    128 '  ,   ,   ,   , 0 . CR)'
     O                       KCEUPBF    128 ' ,   ,   ,   , 0 .  CR)'
     O                       KDEUPBF    128 '   ,   ,   , 0 .   CR)'
     O                 83               128 'DR)'
     O*
     O/COPY WNCPYSRC,GL0065O130
     O        E 1      41 51N34DET
     O/COPY WNCPYSRC,GL0065O047
     O       AND       04N12 84
     O                         PSTDA      8
     O                       69VALDA     18
     O                                   32 'DR'
     O                       22          32 'CR'
     O                                   47 'RATE CHANGE TO'
     O                         INTR      61 '  0 .       -'
     O                                   62 '%'
     O/COPY WNCPYSRC,GL0065O078
     O        E 1      41 51N34DET
     O       AND      N04 84
     O/COPY WNCPYSRC,GL0065O048
     O                         PSTDA      8
     O                       69VALDA     18
     O*
     O** Core hook for externalisation.
     O/COPY WNCPYSRC,GL0065OOP2
     O*
     O                N25      CHQN      28
     O                         PNAR      60
     O/COPY WNCPYSRC,GL0065O146
     O                    23 70PSTA      81 ' ,   ,   ,   , 0 '
     O                    23 71PSTA      81 '   ,   ,   , 0 . '
     O                    23 72PSTA      81 '  ,   ,   , 0 .  '
     O                    23 73PSTA      81 ' ,   ,   , 0 .   '
     O                    22 70PSTA     103 ' ,   ,   ,   , 0 '
     O                    22 71PSTA     103 '   ,   ,   , 0 . '
     O                    22 72PSTA     103 '  ,   ,   , 0 .  '
     O                    22 73PSTA     103 ' ,   ,   , 0 .   '
     O/COPY WNCPYSRC,GL0065O079
     O*
     O        E 1      41 51N34DET
     O       AND      N04 84 78
     O                         ROCCY     33
     O                       KEROAMT     54 '   ,   ,   ,   , 0 '
     O                       KFROAMT     54 '  ,   ,   ,   , 0 . '
     O                       KGROAMT     54 ' ,   ,   ,   , 0 .  '
     O                       KHROAMT     54 '   ,   ,   , 0 .   '
     O        E 1      41 51N34DET
     O       AND      N04 84 53
     O                         W#ORIG    70
     O*
     O/COPY WNCPYSRC,GL0065OP13
     O*
     O** END OF POSTING DATE ONLY
     O*
     O        E 00     L1 41 49BAL
     O       AND      N52N34 84
     O/COPY WNCPYSRC,GL0065O049
     O                       70PSTBAL   127 '   ,   ,   ,   , 0 CR'
     O                       71PSTBAL   127 '  ,   ,   ,   , 0 . CR'
     O                       72PSTBAL   127 ' ,   ,   ,   , 0 .  CR'
     O                       73PSTBAL   127 '   ,   ,   , 0 .   CR'
     O/COPY WNCPYSRC,GL0065O156
     O                       47         127 'DR'
     O** END OF PAGE IND 45
     O*
     O        E 1         41 45ENDPG
     O       AND      N34 84
     O       AND      N33
     O/COPY WNCPYSRC,GL0065O050
     O                                   60 'C/F'
     O/COPY WNCPYSRC,GL0065O157
     O                       70PSTBAL   127 '   ,   ,   ,   , 0 CR'
     O                       71PSTBAL   127 '  ,   ,   ,   , 0 . CR'
     O                       72PSTBAL   127 ' ,   ,   ,   , 0 .  CR'
     O                       73PSTBAL   127 '   ,   ,   , 0 .   CR'
     O/COPY WNCPYSRC,GL0065O158
     O                       47         127 'DR'
     O*
     O        E 1         41 45ENDPG
     O       AND      N34 84
     O       AND      N33 10
     O                         BKEURO    65
     O                                  105 '('
     O                       KAEUPBAL   128 '   ,   ,   ,   , 0 CR)'
     O                       KBEUPBAL   128 '  ,   ,   ,   , 0 . CR)'
     O                       KCEUPBAL   128 ' ,   ,   ,   , 0 .  CR)'
     O                       KDEUPBAL   128 '   ,   ,   , 0 .   CR)'
     O                       47         128 'DR)'
     O*
     O        E 1         41 52TOT
     O       AND      N34 84
     O       AND      N33
     O/COPY WNCPYSRC,GL0065O051
     O                                   60 'C/F'
     O                       70PSTBAL   127 '   ,   ,   ,   , 0 CR'
     O                       71PSTBAL   127 '  ,   ,   ,   , 0 . CR'
     O                       72PSTBAL   127 ' ,   ,   ,   , 0 .  CR'
     O                       73PSTBAL   127 '   ,   ,   , 0 .   CR'
     O/COPY WNCPYSRC,GL0065O159
     O                       47         127 'DR'
     O*
     O        E 1         41 52TOT
     O       AND      N34 84
     O       AND      N33 10
     O                         BKEURO    65
     O                                  105 '('
     O                       KAEUPBAL   128 '   ,   ,   ,   , 0 CR)'
     O                       KBEUPBAL   128 '  ,   ,   ,   , 0 . CR)'
     O                       KCEUPBAL   128 ' ,   ,   ,   , 0 .  CR)'
     O                       KDEUPBAL   128 '   ,   ,   , 0 .   CR)'
     O                       47         128 'DR)'
     O*
     O        E 1         41 52TOT
     O       AND      N34 84
     O       AND      N33 82
     O                         WCMTX1    97
     O        E 1         41 52TOT
     O       AND      N34 84
     O       AND      N33 82
     O                         WCMTX2    97
     O        E 1         41 52TOT
     O       AND      N34 84
     O       AND      N33 82
     O                         WCMTX3    97
     O        E 1         41 52TOT
     O       AND      N34 84
     O       AND      N33 82
     O                         WCMTX4    97
     O*
     O/COPY WNCPYSRC,GL0065O036
     O** END OF PAGE ONLY
     O*
     O        E 11        41 45ENDPG
     O       AND      N34 84
     O/COPY WNCPYSRC,GL0065O052
     O                                  116 '- CONTD'
     O/COPY WNCPYSRC,GL0065OO12
     O********E*1 03           ERPT2                                                          239641
     O        E 1              ERPT2                                                          239641
     O       AND      N33
     O/COPY WNCPYSRC,GL0065O053
     O                                   66 '*** END OF REPORT '
     O                 58                77 'FOR BRANCH '
     O                 58      BRCASV    80
     O                 58                84 ' ***'
     O                N58                69 '***'
     O/EJECT
     O*
     O/COPY WNCPYSRC,GL0065OO13
     O*
     O** GL0420P3  BEGINS  H E R E
     O*                    -------
     OGL0420P3E   01   62 84
     O                         FICHE     16
     O        E   03   62 84
     O/COPY WNCPYSRC,GL0065O003
     O/COPY WNCPYSRC,GL0065O004
     O                    36   @WCNA1    35
     O                    35             71 'DEMAND STATEMENT'
     O        E   04   63 84
     O/COPY WNCPYSRC,GL0065O005
     O                       36@WCNA2    35
     O/COPY WNCPYSRC,GL0065O097
     O        E   05   63 84
     O/COPY WNCPYSRC,GL0065O007
     O                       36@WCNA3    35
     O        E   06   63 84
     O/COPY WNCPYSRC,GL0065O009
     O                       36@WCNA4    35
     O        E   07   62 84
     O/COPY WNCPYSRC,GL0065O011
     O                 58      BRCA      50
     O                 58                51 '-'
     O                                   73 '-   -    -'
     O/COPY WNCPYSRC,GL0065O012
     O                         CNUM      57
     O                         CCY       61
     O                         ACOD      72
     O                         ACSQ      75
     O                N27      ACNO      86
     O/COPY WNCPYSRC,GL0065O013
     O                    58             97 'BRANCH -'
     O/COPY WNCPYSRC,GL0065OY13
     O                    58   A8BRNM   128
     O/COPY WNCPYSRC,GL0065Y054
     O*       H   08   62
     O        E   08   62 84
     O/COPY WNCPYSRC,GL0065O015
     O                         PAGE3 3  128
     O/COPY WNCPYSRC,GL0065O054
     O        E   10   62 84
     O/COPY WNCPYSRC,GL0065O017
     O                         ANAM      33
     O                         CCNM      65
     O/COPY WNCPYSRC,GL0065O131
     O                         RUNA      87
     O/COPY WNCPYSRC,GL0065O055
     O                         STPA  3  108
     O*
     O** Core hook for externalisation.
     O/COPY WNCPYSRC,GL0065OOP7
     O*
     O*       H   16   62
     O        E   16   62 84
     O/COPY WNCPYSRC,GL0065O018
     O                                   60 'B/F'
     O/COPY WNCPYSRC,GL0065O019
     O                         LSTDA      8
     O/COPY WNCPYSRC,GL0065O056
     O                       70PSTBF    127 '   ,   ,   ,   , 0 CR'
     O/COPY WNCPYSRC,GL0065OY57
     O                       71PSTBF    127 '  ,   ,   ,   , 0 . CR'
     O                       72PSTBF    127 ' ,   ,   ,   , 0 .  CR'
     O                       73PSTBF    127 '   ,   ,   , 0 .   CR'
     O                 83               127 'DR'
     O/COPY WNCPYSRC,GL0065O080
     O*
     O        E   17   62 84 10
     O                         BKEURO    65
     O                                  105 '('
     O                       KAEUPBF    128 '   ,   ,   ,   , 0 CR)'
     O                       KBEUPBF    128 '  ,   ,   ,   , 0 . CR)'
     O                       KCEUPBF    128 ' ,   ,   ,   , 0 .  CR)'
     O                       KDEUPBF    128 '   ,   ,   , 0 .   CR)'
     O                 83               128 'DR)'
     O*
     O/COPY WNCPYSRC,GL0065O020
     O        E 1      51 42 04DET
     O/COPY WNCPYSRC,GL0065O021
     O       AND      N12 84
     O/COPY WNCPYSRC,GL0065O023
     O                         PSTDA      8
     O/COPY WNCPYSRC,GL0065O024
     O                       69VALDA     18
     O                                   32 'DR'
     O                       22          32 'CR'
     O                                   47 'RATE CHANGE TO'
     O                         INTR      61 '  0 .       -'
     O                                   62 '%'
     O/COPY WNCPYSRC,GL0065O081
     O        E 1      51 42N04DET
     O/COPY WNCPYSRC,GL0065O025
     O       AND       84
     O/COPY WNCPYSRC,GL0065O118
     O                         PSTDA      8
     O/COPY WNCPYSRC,GL0065O026
     O                       69VALDA     18
     O*
     O** Core hook for externalisation.
     O/COPY WNCPYSRC,GL0065OOP3
     O*
     O                N25      CHQN      28
     O/COPY WNCPYSRC,GL0065O057
     O                         PNAR      60
     O/COPY WNCPYSRC,GL0065O058
     O                    23 70PSTA      81 ' ,   ,   ,   , 0 '
     O                    23 71PSTA      81 '   ,   ,   , 0 . '
     O                    23 72PSTA      81 '  ,   ,   , 0 .  '
     O                    23 73PSTA      81 ' ,   ,   , 0 .   '
     O/COPY WNCPYSRC,GL0065O059
     O                    22 70PSTA     103 ' ,   ,   ,   , 0 '
     O                    22 71PSTA     103 '   ,   ,   , 0 . '
     O                    22 72PSTA     103 '  ,   ,   , 0 .  '
     O                    22 73PSTA     103 ' ,   ,   , 0 .   '
     O/COPY WNCPYSRC,GL0065O082
     O*
     O        E 1      51 42N04DET
     O       AND       84 78
     O                         ROCCY     33
     O                       KEROAMT     54 '   ,   ,   ,   , 0 '
     O                       KFROAMT     54 '  ,   ,   ,   , 0 . '
     O                       KGROAMT     54 ' ,   ,   ,   , 0 .  '
     O                       KHROAMT     54 '   ,   ,   , 0 .   '
     O*
     O        E 1      51 42N04DET
     O       AND       84 53
     O                         W#ORIG    70
     O*
     O** Core hook for externalisation.
     O/COPY WNCPYSRC,GL0065OP14
     O*
     O**   END OF POSTING DATE ONLY
     O*
     O        E 00     L1 42 49BAL
     O/COPY WNCPYSRC,GL0065OY25
     O       AND      N52 84
     O/COPY WNCPYSRC,GL0065O060
     O                       70PSTBAL   127 '   ,   ,   ,   , 0 CR'
     O                       71PSTBAL   127 '  ,   ,   ,   , 0 . CR'
     O                       72PSTBAL   127 ' ,   ,   ,   , 0 .  CR'
     O                       73PSTBAL   127 '   ,   ,   , 0 .   CR'
     O                       47         127 'DR'
     O/COPY WNCPYSRC,GL0065O027
     O        E 1      84 42 45ENDPG
     O/COPY WNCPYSRC,GL0065O028
     O       AND      N33
     O/COPY WNCPYSRC,GL0065OX61
     O                                   60 'C/F'
     O/COPY WNCPYSRC,GL0065O061
     O                       70PSTBAL   127 '   ,   ,   ,   , 0 CR'
     O                       71PSTBAL   127 '  ,   ,   ,   , 0 . CR'
     O                       72PSTBAL   127 ' ,   ,   ,   , 0 .  CR'
     O                       73PSTBAL   127 '   ,   ,   , 0 .   CR'
     O                       47         127 'DR'
     O/COPY WNCPYSRC,GL0065O119
     O*
     O        E 1      84 42 45ENDPG
     O       AND      N33 10
     O                         BKEURO    65
     O                                  105 '('
     O                       KAEUPBAL   128 '   ,   ,   ,   , 0 CR)'
     O                       KBEUPBAL   128 '  ,   ,   ,   , 0 . CR)'
     O                       KCEUPBAL   128 ' ,   ,   ,   , 0 .  CR)'
     O                       KDEUPBAL   128 '   ,   ,   , 0 .   CR)'
     O                       47         128 'DR)'
     O*
     O/COPY WNCPYSRC,GL0065O029
     O        E 1      84 42 52TOT
     O/COPY WNCPYSRC,GL0065O030
     O       AND      N33
     O/COPY WNCPYSRC,GL0065O120
     O                                   60 'C/F'
     O/COPY WNCPYSRC,GL0065O062
     O                       70PSTBAL   127 '   ,   ,   ,   , 0 CR'
     O                       71PSTBAL   127 '  ,   ,   ,   , 0 . CR'
     O                       72PSTBAL   127 ' ,   ,   ,   , 0 .  CR'
     O                       73PSTBAL   127 '   ,   ,   , 0 .   CR'
     O                       47         127 'DR'
     O/COPY WNCPYSRC,GL0065O121
     O*
     O        E 1      84 42 52TOT
     O       AND      N33 10
     O                         BKEURO    65
     O                                  105 '('
     O                       KAEUPBAL   128 '   ,   ,   ,   , 0 CR)'
     O                       KBEUPBAL   128 '  ,   ,   ,   , 0 . CR)'
     O                       KCEUPBAL   128 ' ,   ,   ,   , 0 .  CR)'
     O                       KDEUPBAL   128 '   ,   ,   , 0 .   CR)'
     O                       47         128 'DR)'
     O*
     O        E 1      84 42 52TOT
     O       AND      N33 82
     O                         WCMTX1    97
     O        E 1      84 42 52TOT
     O       AND      N33 82
     O                         WCMTX2    97
     O        E 1      84 42 52TOT
     O       AND      N33 82
     O                         WCMTX3    97
     O        E 1      84 42 52TOT
     O       AND      N33 82
     O                         WCMTX4    97
     O*
     O/COPY WNCPYSRC,GL0065O031
     O** END OF PAGE ONLY
     O*
     O        E 1      84 42 45ENDPG
     O/COPY WNCPYSRC,GL0065O032
     O                                  116 '- CONTD'
     O*
     O/COPY WNCPYSRC,GL0065OP20
     O*
     O********E*1 03           ERPT3                                                          239641
     O        E 1              ERPT3                                                          239641
     O       AND      N33
     O                                   66 '*** END OF REPORT '
     O                 58                77 'FOR BRANCH '
     O                 58      BRCASV    80
     O                 58                84 ' ***'
     O                N58                69 '***'
     O*
     O** Core hook for externalisation.
     O/COPY WNCPYSRC,GL0065OP3
     O*
     O/EJECT
     O/COPY WNCPYSRC,GL0065O063
     O** GL0420P4BEGINS    H E R E
     O**                   -------
     O*
     O/COPY WNCPYSRC,GL0065O035
     OGL0420P4E   01   64 84
     O                         FICHE     16
     O/COPY WNCPYSRC,GL0065O076
     O        E   03   64 84
     O                 58      BRCA      18
     O                 58                19 '-'
     O                                   41 '-   -    -'
     O                         CNUM      25
     O                         CCY       29
     O                         ACOD      40
     O                         ACSQ      43
     O                N27      ACNO      55
     O                    35             74 'DEMAND STATEMENT'
     O        E   04   65 84
     O                       36@WCNA1    50
     O        E   05   65 84
     O                       36@WCNA2    50
     O/COPY WNCPYSRC,GL0065O098
     O        E   06   65 84
     O                       36@WCNA3    50
     O        E   07   65 84
     O                       36@WCNA4    50
     O        E   08   64 36 84
     O       OR        64N36 84
     O                    58             68 'BRANCH -'
     O                    58   A8BRNM    99
     O        E   09   64 84
     O                         PAGE4 3   99
     O        E   10   64 84
     O                                   20 'ACCOUNT'
     O                         ANAM      43
     O/COPY WNCPYSRC,GL0065O132
     O                                   52 'CCY'
     O                         CCNM      68
     O                                   75 'DATE'
     O                         RUNA      85
     O/COPY WNCPYSRC,GL0065O133
     O                                   93 'PAGE'
     O/COPY WNCPYSRC,GL0065O064
     O                         STPA  3   98
     O** Core hook for externalisation.
     O/COPY WNCPYSRC,GL0065OOP8
     O*
     O        E   13   64 84
     O                                   21 'DATE'
     O                                   44 'NARRATIVE'
     O/COPY WNCPYSRC,GL0065O108
     O                                   71 'AMOUNT'
     O                                   93 'BALANCE'
     O/COPY WNCPYSRC,GL0065O123
     O        E   16   64 84
     O/COPY WNCPYSRC,GL0065O077
     O                                   55 'B/F'
     O                         LSTDA     23
     O/COPY WNCPYSRC,GL0065O160
     O                       70PSTBF    100 '   ,   ,   ,   , 0 CR'
     O                       71PSTBF    100 '  ,   ,   ,   , 0 . CR'
     O                       72PSTBF    100 ' ,   ,   ,   , 0 .  CR'
     O                       73PSTBF    100 '   ,   ,   , 0 .   CR'
     O                 83               100 'DR'
     O/COPY WNCPYSRC,GL0065O083
     O*
     O        E   17   64 84 10
     O                         BKEURO    60
     O                                   77 '('
     O                       KAEUPBF    100 '   ,   ,   ,   , 0 CR)'
     O                       KBEUPBF    100 '  ,   ,   ,   , 0 . CR)'
     O                       KCEUPBF    100 ' ,   ,   ,   , 0 .  CR)'
     O                       KDEUPBF    100 '   ,   ,   , 0 .   CR)'
     O                 83               100 'DR)'
     O*
     O/COPY WNCPYSRC,GL0065O134
     O        E 1      43 51 04DET
     O       AND      N12 84
     O                         PSTDA     23
     O                                   27 'DR'
     O                       22          27 'CR'
     O                                   42 'RATE CHANGE TO'
     O                         INTR      56 '  0 .       -'
     O                                   57 '%'
     O/COPY WNCPYSRC,GL0065O084
     O        E 1      43 51N04DET
     O       AND       84
     O                         PSTDA     23
     O                         PNAR      55
     O/COPY WNCPYSRC,GL0065O147
     O                       70PSTA      74 ' ,   ,   ,   , 0 '
     O                       71PSTA      74 '   ,   ,   , 0 . '
     O                       72PSTA      74 '  ,   ,   , 0 .  '
     O                       73PSTA      74 ' ,   ,   , 0 .   '
     O/COPY WNCPYSRC,GL0065O148
     O                                   76 'DR'
     O                       22          76 'CR'
     O/COPY WNCPYSRC,GL0065O085
     O*
     O        E 1      43 51N04DET
     O       AND       84 78
     O                         ROCCY     28
     O                       KEROAMT     49 '   ,   ,   ,   , 0 '
     O                       KFROAMT     49 '  ,   ,   ,   , 0 . '
     O                       KGROAMT     49 ' ,   ,   ,   , 0 .  '
     O                       KHROAMT     49 '   ,   ,   , 0 .   '
     O*
     O        E 1      43 51N04DET
     O       AND       84 53
     O                         W#ORIG    65
     O*
     O** Core hook for externalisation.
     O/COPY WNCPYSRC,GL0065OP15
     O*
     O** END OF POSTING DATE ONLY
     O*
     O        E 00     L1 43 49BAL
     O       AND      N52 84
     O/COPY WNCPYSRC,GL0065O161
     O                       70PSTBAL   100 '   ,   ,   ,   , 0 CR'
     O                       71PSTBAL   100 '  ,   ,   ,   , 0 . CR'
     O                       72PSTBAL   100 ' ,   ,   ,   , 0 .  CR'
     O                       73PSTBAL   100 '   ,   ,   , 0 .   CR'
     O/COPY WNCPYSRC,GL0065O162
     O                       47         100 'DR'
     O/COPY WNCPYSRC,GL0065O144
     O** END OF PAGE IND 45
     O*
     O        E 1         43 45ENDPG
     O       AND       84
     O       AND      N33
     O*       T 1         43 45
     O*      OR           43 52
     O                                   55 'C/F'
     O/COPY WNCPYSRC,GL0065O163
     O                       70PSTBAL   100 '   ,   ,   ,   , 0 CR'
     O                       71PSTBAL   100 '  ,   ,   ,   , 0 . CR'
     O                       72PSTBAL   100 ' ,   ,   ,   , 0 .  CR'
     O                       73PSTBAL   100 '   ,   ,   , 0 .   CR'
     O/COPY WNCPYSRC,GL0065O164
     O                       47         100 'DR'
     O*
     O        E 1         43 45ENDPG
     O       AND       84
     O       AND      N33 10
     O                         BKEURO    60
     O                                   77 '('
     O                       KAEUPBAL   100 '   ,   ,   ,   , 0 CR)'
     O                       KBEUPBAL   100 '  ,   ,   ,   , 0 . CR)'
     O                       KCEUPBAL   100 ' ,   ,   ,   , 0 .  CR)'
     O                       KDEUPBAL   100 '   ,   ,   , 0 .   CR)'
     O                 47               100 'DR)'
     O*
     O        E 1      84 43 52TOT
     O       AND      N33
     O                                   55 'C/F'
     O/COPY WNCPYSRC,GL0065O165
     O                       70PSTBAL   100 '   ,   ,   ,   , 0 CR'
     O                       71PSTBAL   100 '  ,   ,   ,   , 0 . CR'
     O                       72PSTBAL   100 ' ,   ,   ,   , 0 .  CR'
     O                       73PSTBAL   100 '   ,   ,   , 0 .   CR'
     O/COPY WNCPYSRC,GL0065O166
     O                       47         100 'DR'
     O*
     O        E 1      84 43 52TOT
     O       AND      N33 10
     O                         BKEURO    60
     O                                   77 '('
     O                       KAEUPBAL   100 '   ,   ,   ,   , 0 CR)'
     O                       KBEUPBAL   100 '  ,   ,   ,   , 0 . CR)'
     O                       KCEUPBAL   100 ' ,   ,   ,   , 0 .  CR)'
     O                       KDEUPBAL   100 '   ,   ,   , 0 .   CR)'
     O                 47               100 'DR)'
     O*
     O        E 1      84 43 52TOT
     O       AND      N33 82
     O                         WCMTX1    97
     O        E 1      84 43 52TOT
     O       AND      N33 82
     O                         WCMTX2    97
     O        E 1      84 43 52TOT
     O       AND      N33 82
     O                         WCMTX3    97
     O        E 1      84 43 52TOT
     O       AND      N33 82
     O                         WCMTX4    97
     O/COPY WNCPYSRC,GL0065O103
     O*
     O** END OF PAGE ONLY
     O*
     O        E 1      84 43 45ENDPG
     O                                   85 '- CONTD'
     O*
     O/COPY WNCPYSRC,GL0065OP21
     O*
     O********E*1 03           ERPT4                                                          239641
     O        E 1              ERPT4                                                          239641
     O       AND      N33
     O                                   66 '*** END OF REPORT '
     O                 58                77 'FOR BRANCH '
     O                 58      BRCASV    80
     O                 58                84 ' ***'
     O                N58                69 '***'
     O/COPY WNCPYSRC,GL0065O002
     O/EJECT
     O** GL0420P5BEGINS    H E R E
     O**                   -------
     O*
     O/COPY WNCPYSRC,GL0065O145
     OGL0420P5E   01   66 84
     O                         FICHE     16
     O        E   02   66 84
     O                 58      BRCA      18
     O                 58                19 '-'
     O                                   41 '-   -    -'
     O                         CNUM      25
     O                         CCY       29
     O                         ACOD      40
     O                         ACSQ      43
     O                N27      ACNO      55
     O                    35             74 'DEMAND STATEMENT'
     O        E   04   67 84
     O                       36@WCNA1    50
     O        E   05   67 84
     O                       36@WCNA2    50
     O/COPY WNCPYSRC,GL0065O099
     O        E   06   67 84
     O                       36@WCNA3    50
     O        E   07   67 84
     O                       36@WCNA4    50
     O        E   07   66 36 84
     O       OR        66N36 84
     O                    58             68 'BRANCH -'
     O                    58   A8BRNM    99
     O        E   08   66 84
     O                         PAGE5 3   99
     O        E   10   66 84
     O                         ANAM      43
     O/COPY WNCPYSRC,GL0065O135
     O                         CCNM      68
     O                         RUNA      85
     O/COPY WNCPYSRC,GL0065O065
     O                         STPA  3   98
     O** Core hook for externalisation.
     O/COPY WNCPYSRC,GL0065OOP9
     O*
     O        E   16   66 84
     O/COPY WNCPYSRC,GL0065O124
     O                                   55 'B/F'
     O                         LSTDA     23
     O/COPY WNCPYSRC,GL0065O167
     O                       70PSTBF    100 '   ,   ,   ,   , 0 CR'
     O                       71PSTBF    100 '  ,   ,   ,   , 0 . CR'
     O                       72PSTBF    100 ' ,   ,   ,   , 0 .  CR'
     O                       73PSTBF    100 '   ,   ,   , 0 .   CR'
     O                 83               100 'DR'
     O/COPY WNCPYSRC,GL0065O086
     O*
     O        E   17   66 84 10
     O                         BKEURO    60
     O                                   78 '('
     O                       KAEUPBF    101 '   ,   ,   ,   , 0 CR)'
     O                       KBEUPBF    101 '  ,   ,   ,   , 0 . CR)'
     O                       KCEUPBF    101 ' ,   ,   ,   , 0 .  CR)'
     O                       KDEUPBF    101 '   ,   ,   , 0 .   CR)'
     O                 83               101 'DR)'
     O*
     O/COPY WNCPYSRC,GL0065O136
     O        E 1      44 51 04DET
     O       AND      N12 84
     O                         PSTDA     23
     O                                   27 'DR'
     O                       22          27 'CR'
     O                                   42 'RATE CHANGE TO'
     O                         INTR      56 '  0 .       -'
     O                                   57 '%'
     O/COPY WNCPYSRC,GL0065O087
     O        E 1      44 51N04DET
     O       AND       84
     O                         PSTDA     23
     O                         PNAR      55
     O/COPY WNCPYSRC,GL0065O149
     O                       70PSTA      74 ' ,   ,   ,   , 0 '
     O                       71PSTA      74 '   ,   ,   , 0 . '
     O                       72PSTA      74 '  ,   ,   , 0 .  '
     O                       73PSTA      74 ' ,   ,   , 0 .   '
     O/COPY WNCPYSRC,GL0065O150
     O                                   76 'DR'
     O                       22          76 'CR'
     O/COPY WNCPYSRC,GL0065O088
     O*
     O        E 1      44 51N04DET
     O       AND       84 78
     O                         ROCCY     28
     O                       KEROAMT     49 '   ,   ,   ,   , 0 '
     O                       KFROAMT     49 '  ,   ,   ,   , 0 . '
     O                       KGROAMT     49 ' ,   ,   ,   , 0 .  '
     O                       KHROAMT     49 '   ,   ,   , 0 .   '
     O*
     O        E 1      44 51N04DET
     O       AND       84 53
     O                         W#ORIG    65
     O*
     O** Core hook for externalisation.
     O/COPY WNCPYSRC,GL0065OP16
     O*
     O** END OF POSTING DATE ONLY
     O*
     O        E 00     L1 44 49BAL
     O       AND      N52 84
     O/COPY WNCPYSRC,GL0065O168
     O                       70PSTBAL   100 '   ,   ,   ,   , 0 CR'
     O                       71PSTBAL   100 '  ,   ,   ,   , 0 . CR'
     O                       72PSTBAL   100 ' ,   ,   ,   , 0 .  CR'
     O                       73PSTBAL   100 '   ,   ,   , 0 .   CR'
     O/COPY WNCPYSRC,GL0065O169
     O                       47         100 'DR'
     O** END OF PAGE IND 45
     O*
     O        E 1      84 44 45ENDPG
     O       AND      N33
     O                                   55 'C/F'
     O/COPY WNCPYSRC,GL0065O170
     O                       70PSTBAL   100 '   ,   ,   ,   , 0 CR'
     O                       71PSTBAL   100 '  ,   ,   ,   , 0 . CR'
     O                       72PSTBAL   100 ' ,   ,   ,   , 0 .  CR'
     O                       73PSTBAL   100 '   ,   ,   , 0 .   CR'
     O/COPY WNCPYSRC,GL0065O171
     O                       47         100 'DR'
     O*
     O        E 1      84 44 45ENDPG
     O       AND      N33 10
     O                         BKEURO    60
     O                                   78 '('
     O                       KAEUPBAL   101 '   ,   ,   ,   , 0 CR)'
     O                       KBEUPBAL   101 '  ,   ,   ,   , 0 . CR)'
     O                       KCEUPBAL   101 ' ,   ,   ,   , 0 .  CR)'
     O                       KDEUPBAL   101 '   ,   ,   , 0 .   CR)'
     O                       47         101 'DR)'
     O*
     O        E 1      84 44 52TOT
     O       AND      N33
     O                                   55 'C/F'
     O/COPY WNCPYSRC,GL0065O172
     O                       70PSTBAL   100 '   ,   ,   ,   , 0 CR'
     O                       71PSTBAL   100 '  ,   ,   ,   , 0 . CR'
     O                       72PSTBAL   100 ' ,   ,   ,   , 0 .  CR'
     O                       73PSTBAL   100 '   ,   ,   , 0 .   CR'
     O/COPY WNCPYSRC,GL0065O173
     O                       47         100 'DR'
     O*
     O        E 1      84 44 52TOT
     O       AND      N33 10
     O                         BKEURO    60
     O                                   78 '('
     O                       KAEUPBAL   101 '   ,   ,   ,   , 0 CR)'
     O                       KBEUPBAL   101 '  ,   ,   ,   , 0 . CR)'
     O                       KCEUPBAL   101 ' ,   ,   ,   , 0 .  CR)'
     O                       KDEUPBAL   101 '   ,   ,   , 0 .   CR)'
     O                       47         101 'DR)'
     O*
     O        E 1      84 44 52TOT
     O       AND      N33 82
     O                         WCMTX1    97
     O        E 1      84 44 52TOT
     O       AND      N33 82
     O                         WCMTX2    97
     O        E 1      84 44 52TOT
     O       AND      N33 82
     O                         WCMTX3    97
     O        E 1      84 44 52TOT
     O       AND      N33 82
     O                         WCMTX4    97
     O/COPY WNCPYSRC,GL0065O104
     O*
     O** END OF PAGE ONLY
     O*
     O        E 1      84 44 45ENDPG
     O                                   85 '- CONTD'
     O*
     O/COPY WNCPYSRC,GL0065OP22
     O*
     O********E*2 03           ERPT5                                                          239641
     O        E 1              ERPT5                                                          239641
     O       AND      N33
     O                                   66 '*** END OF REPORT '
     O                 58                77 'FOR BRANCH '
     O                 58      BRCASV    80
     O                 58                84 ' ***'
     O                N58                69 '***'
     O/EJECT
      *
     O/COPY WNCPYSRC,GL0065OP25
      *
     O** GL0420P6BEGINS    H E R E
     O**                   -------
     O*
     OGL0420P6E   01   80 84
     O                         FICHE     16
     O        E   03   80 84
     O                         @WCNA1    35
     O                                   76 '*MANAGEMENT STATEMENT*'
     O        E   04   81 84
     O                         @WCNA2    35
     O/COPY WNCPYSRC,GL0065O100
     O        E   05   81 84
     O                         @WCNA3    35
     O        E   06   81 84
     O                         @WCNA4    35
     O/COPY WNCPYSRC,GL0065O072
     O*
     O        E   07   80 84
     O** ETC.
     O                                   45 'OUR REF'
     O/COPY WNCPYSRC,GL0065O073
     O                 58      BRCA      50
     O                 58                51 '-'
     O                                   73 '-   -    -'
     O                         CNUM      57
     O                         CCY       61
     O                         ACOD      72
     O                         ACSQ      75
     O                N27      ACNO      86
     O                    58             97 'BRANCH -'
     O                    58   A8BRNM   128
     O        E   08   80 84
     O/COPY WNCPYSRC,GL0065O074
     O                         PAGE6 3  128
     O        E   10   80 84
     O                                   10 'ACCOUNT'
     O                         ANAM      33
     O                                   48 'CURRENCY'
     O                         CCNM      65
     O/COPY WNCPYSRC,GL0065O137
     O                                   77 'DATE'
     O                         RUNA      87
     O/COPY WNCPYSRC,GL0065O138
     O                                  102 'PAGE'
     O/COPY WNCPYSRC,GL0065O066
     O                         STPA  3  108
     O** Core hook for externalisation.
     O/COPY WNCPYSRC,GL0065OO10
     O*
     O        E   13   80 84
     O                                    7 'POSTING'
     O                                   16 'VALUE'
     O                                   27 'CHEQUE'
     O                                   50 'NARRATIVE'
     O/COPY WNCPYSRC,GL0065O109
     O                                   76 'DEBITS'
     O                                   99 'CREDITS'
     O                                  121 'BALANCE'
     O        E   14   80 84
     O                                    6 'DATE'
     O                                   16 'DATE'
     O                                   25 'NO'
     O/COPY WNCPYSRC,GL0065O125
     O        E   16   80 84
     O/COPY WNCPYSRC,GL0065O126
     O                                   60 'B/F'
     O                         LSTDA      8
     O/COPY WNCPYSRC,GL0065O174
     O                       70PSTBF    127 '   ,   ,   ,   , 0 CR'
     O                       71PSTBF    127 '  ,   ,   ,   , 0 . CR'
     O                       72PSTBF    127 ' ,   ,   ,   , 0 .  CR'
     O                       73PSTBF    127 '   ,   ,   , 0 .   CR'
     O                    83            127 'DR'
     O/COPY WNCPYSRC,GL0065O089
     O*
     O        E   17   80 84 10
     O                         BKEURO    65
     O                                  105 '('
     O                       KAEUPBF    128 '   ,   ,   ,   , 0 CR)'
     O                       KBEUPBF    128 '  ,   ,   ,   , 0 . CR)'
     O                       KCEUPBF    128 ' ,   ,   ,   , 0 .  CR)'
     O                       KDEUPBF    128 '   ,   ,   , 0 .   CR)'
     O                    83            128 'DR)'
     O*
     O/COPY WNCPYSRC,GL0065O139
     O        E 1      41 51 34DET
     O       AND      N12 04 84
     O                         PSTDA      8
     O                       69VALDA     18
     O                                   32 'DR'
     O                       22          32 'CR'
     O                                   47 'RATE CHANGE TO'
     O                         INTR      61 '  0 .       -'
     O                                   62 '%'
     O/COPY WNCPYSRC,GL0065O090
     O        E 1      41 51 34DET
     O       AND      N04 84
     O                         PSTDA      8
     O                       69VALDA     18
     O*
     O** Core hook for externalisation.
     O/COPY WNCPYSRC,GL0065OOP4
     O*
     O                N25      CHQN      28
     O                         PNAR      60
     O/COPY WNCPYSRC,GL0065O151
     O                    23 70PSTA      81 ' ,   ,   ,   , 0 '
     O                    23 71PSTA      81 '   ,   ,   , 0 . '
     O                    23 72PSTA      81 '  ,   ,   , 0 .  '
     O                    23 73PSTA      81 ' ,   ,   , 0 .   '
     O                    22 70PSTA     103 ' ,   ,   ,   , 0 '
     O                    22 71PSTA     103 '   ,   ,   , 0 . '
     O                    22 72PSTA     103 '  ,   ,   , 0 .  '
     O                    22 73PSTA     103 ' ,   ,   , 0 .   '
     O/COPY WNCPYSRC,GL0065O091
     O*
     O        E 1      41 51 34DET
     O       AND      N04 84 78
     O                         ROCCY     33
     O                       KEROAMT     54 '   ,   ,   ,   , 0 '
     O                       KFROAMT     54 '  ,   ,   ,   , 0 . '
     O                       KGROAMT     54 ' ,   ,   ,   , 0 .  '
     O                       KHROAMT     54 '   ,   ,   , 0 .   '
     O*
     O        E 1      41 51 34DET
     O       AND      N04 84 53
     O                         W#ORIG    70
     O*
     O** Core hook for externalisation.
     O/COPY WNCPYSRC,GL0065OP17
     O*
     O**   END OF POSTING DATE ONLY
     O**
     O*       T 00     L1 41 49
     O        E 00     L1 41 49BAL
     O       AND      N52 34 84
     O/COPY WNCPYSRC,GL0065O175
     O                       70PSTBAL   127 '   ,   ,   ,   , 0 CR'
     O                       71PSTBAL   127 '  ,   ,   ,   , 0 . CR'
     O                       72PSTBAL   127 ' ,   ,   ,   , 0 .  CR'
     O                       73PSTBAL   127 '   ,   ,   , 0 .   CR'
     O/COPY WNCPYSRC,GL0065O176
     O                       47         127 'DR'
     O** END OF PAGE IND 45
     O*
     O        E 1         41 45ENDPG
     O       AND       34 84
     O       AND      N33
     O                                   60 'C/F'
     O/COPY WNCPYSRC,GL0065O177
     O                       70PSTBAL   127 '   ,   ,   ,   , 0 CR'
     O                       71PSTBAL   127 '  ,   ,   ,   , 0 . CR'
     O                       72PSTBAL   127 ' ,   ,   ,   , 0 .  CR'
     O                       73PSTBAL   127 '   ,   ,   , 0 .   CR'
     O/COPY WNCPYSRC,GL0065O178
     O                       47         127 'DR'
     O*
     O        E 1         41 45ENDPG
     O       AND       34 84
     O       AND      N33 10
     O                         BKEURO    65
     O                                  105 '('
     O                       KAEUPBAL   128 '   ,   ,   ,   , 0 CR)'
     O                       KBEUPBAL   128 '  ,   ,   ,   , 0 . CR)'
     O                       KCEUPBAL   128 ' ,   ,   ,   , 0 .  CR)'
     O                       KDEUPBAL   128 '   ,   ,   , 0 .   CR)'
     O                       47         128 'DR)'
     O*
     O        E 1         41 52TOT
     O       AND       34 84
     O       AND      N33
     O                                   60 'C/F'
     O/COPY WNCPYSRC,GL0065O179
     O                       70PSTBAL   127 '   ,   ,   ,   , 0 CR'
     O                       71PSTBAL   127 '  ,   ,   ,   , 0 . CR'
     O                       72PSTBAL   127 ' ,   ,   ,   , 0 .  CR'
     O                       73PSTBAL   127 '   ,   ,   , 0 .   CR'
     O/COPY WNCPYSRC,GL0065O180
     O                       47         127 'DR'
     O*
     O        E 1         41 52TOT
     O       AND       34 84
     O       AND      N33 10
     O                         BKEURO    65
     O                                  105 '('
     O                       KAEUPBAL   128 '   ,   ,   ,   , 0 CR)'
     O                       KBEUPBAL   128 '  ,   ,   ,   , 0 . CR)'
     O                       KCEUPBAL   128 ' ,   ,   ,   , 0 .  CR)'
     O                       KDEUPBAL   128 '   ,   ,   , 0 .   CR)'
     O                       47         128 'DR)'
     O*
     O        E 1         41 52TOT
     O       AND       34 84
     O       AND      N33 82
     O                         WCMTX1    97
     O        E 1         41 52TOT
     O       AND       34 84
     O       AND      N33 82
     O                         WCMTX2    97
     O        E 1         41 52TOT
     O       AND       34 84
     O       AND      N33 82
     O                         WCMTX3    97
     O        E 1         41 52TOT
     O       AND       34 84
     O       AND      N33 82
     O                         WCMTX4    97
     O/COPY WNCPYSRC,GL0065O105
     O*
     O** END OF PAGE ONLY
     O*
     O        E 1         41 45ENDPG
     O       AND       34 84
     O                                  116 '- CONTD'
     O*
     O/COPY WNCPYSRC,GL0065OP23
     O*
     O********E*1 03           ERPT6                                                          239641
     O        E 1              ERPT6                                                          239641
     O       AND      N33
     O                                   66 '*** END OF REPORT '
     O                 58                77 'FOR BRANCH '
     O                 58      BRCASV    80
     O                 58                84 ' ***'
     O                N58                69 '***'
     O/COPY WNCPYSRC,GL0065O122
     OGL0420AUT  202   LR
     O                                   24 'REFERENCE GL0420AU'
     O                         BJURPT    92
     O                                  104 'DATE'
     O                         RUNA     113
     O                                  122 'PAGE'
     O                         PAGE1    127
     O/COPY WNCPYSRC,GL0065O092
     O*
     O        T  1     LR
     O                                   70 'BALANCE STATEMENTS'
     O                                   85 'RUN CONTROLS'
     O        T  1     LR
     O                                   70 '------------------'
      *
     O        T   12   LR 31
     O                                   34 'PERIOD REQUESTED:'
     O                         SDATE     42
     O                                   45 'TO'
     O                         EDATE     53
     O        T   15   LR
     O                                   30 'FILE CONTROLS'
     O                                   58 'INPUT'
     O                                   81 'CALCULATED'
     O        T   17   LRNU7
     O                                   31 'NO. STATEMENTS'
     O                                   45 'RECORDS READ:'
     O                         STMSIZ3   58
     O                         TNAR  3   84
     O                    86            111 '*** OUT OF BALANCE ***'
     O        T 3      U7 U8 LR
     O                                   42 '***REFERENCE'
     O                         DBPGM     53
     O                                   71 'DATABASE ERROR AT'
     O                         DBASE     75
     O        T 22     U7 U8 LR
     O                                   37 'FILE NAME'
     O                         DBFILE    46
     O                                   51 'KEY'
     O                         DBKEY     81
     O*
     O/EJECT
     O*
     O/COPY WNCPYSRC,GL0065OO14
     O*
     OGL0420P1E   01   87 84
     O                         FICHE     16
     O        E   03   87 84
     O                    36   @WCNA1    35
     O                    35             71 'DEMAND STATEMENT'
     O        E   04   89 84
     O                       36@WCNA2    35
     O/COPY WNCPYSRC,GL0065O101
     O        E   05   89 84
     O                       36@WCNA3    35
     O        E   06   89 84
     O                       36@WCNA4    35
     O        E   07   87 84
     O** ETC.
     O/COPY WNCPYSRC,GL0065O110
     O                                   45 'OUR REF'
     O/COPY WNCPYSRC,GL0065O111
     O                 58      BRCA      50
     O                 58                51 '-'
     O                                   73 '-   -    -'
     O                         CNUM      57
     O                         CCY       61
     O                         ACOD      72
     O                         ACSQ      75
     O                N27      ACNO      86
     O/COPY WNCPYSRC,GL0065O112
     O                    58             97 'BRANCH -'
     O                    58   A8BRNM   128
     O        E   08   87 84
     O                         PAGE  3  128
     O/COPY WNCPYSRC,GL0065O113
     O        E   10   87 84
     O/COPY WNCPYSRC,GL0065O114
     O                         ANAM      33
     O                         CCNM      65
     O/COPY WNCPYSRC,GL0065O140
     O                         RUNA      87
     O/COPY WNCPYSRC,GL0065O067
     O                         STPA  3  107
     O** Core hook for externalisation.
     O/COPY WNCPYSRC,GL0065OO11
     O*
     O        E   16   87 84
     O/COPY WNCPYSRC,GL0065O127
     O*
     O** NARRATIVES OVERLAP WITH THE DEBITS BY ONE COLUMN.
     O*
     O                         LSTDA      7
     O                                   55 'B/F'
     O/COPY WNCPYSRC,GL0065O181
     O                       70PSTBF    110 '   ,   ,   ,   , 0 CR'
     O                       71PSTBF    110 '  ,   ,   ,   , 0 . CR'
     O                       72PSTBF    110 ' ,   ,   ,   , 0 .  CR'
     O                       73PSTBF    110 '   ,   ,   , 0 .   CR'
     O                       47         110 'DR'
     O** TO ENSURE ACCURATE CLEARED BALANCE BFWD IS SHOWN ON FIRST &
     O** SUBSEQUENT PAGES OF STATMENTS
     O                       70CFBF     132 '   ,   ,   ,   , 0 CR'
     O                       71CFBF     132 '  ,   ,   ,   , 0 . CR'
     O                       72CFBF     132 ' ,   ,   ,   , 0 .  CR'
     O                       73CFBF     132 '   ,   ,   , 0 .   CR'
     O                       28         132 'DR'
     O/COPY WNCPYSRC,GL0065O093
     O*
     O        E   17   87 84 10
     O                         BKEURO    60
     O                                   88 '('
     O                       KAEUPBF    111 '   ,   ,   ,   , 0 CR)'
     O                       KBEUPBF    111 '  ,   ,   ,   , 0 . CR)'
     O                       KCEUPBF    111 ' ,   ,   ,   , 0 .  CR)'
     O                       KDEUPBF    111 '   ,   ,   , 0 .   CR)'
     O                       47         111 'DR)'
     O*
     O/COPY WNCPYSRC,GL0065O141
     O        E 1      40 75 51DET
     O       AND       84
     O/COPY WNCPYSRC,GL0065O182
     O                       70VDDR      71 ' ,   ,   ,   , 0 '
     O                       71VDDR      71 '   ,   ,   , 0 . '
     O                       72VDDR      71 '  ,   ,   , 0 .  '
     O                       73VDDR      71 ' ,   ,   , 0 .   '
     O                                   40 '**AMOUNT CLEARED SINCE L'
     O                                   55 'AST STATEMENT**'
     O                       70VDCR      88 ' ,   ,   ,   , 0 '
     O                       71VDCR      88 '   ,   ,   , 0 . '
     O                       72VDCR      88 '  ,   ,   , 0 .  '
     O                       73VDCR      88 ' ,   ,   , 0 .   '
     O                       70VDCBBF   132 '   ,   ,   ,   , 0 CR'
     O                       71VDCBBF   132 '  ,   ,   ,   , 0 . CR'
     O                       72VDCBBF   132 ' ,   ,   ,   , 0 .  CR'
     O                       73VDCBBF   132 '   ,   ,   , 0 .   CR'
     O/COPY WNCPYSRC,GL0065O183
     O                       32         132 'DR'
     O        E 1      40 51 04DET
     O       AND      N12 84
     O                         PSTDA      7
     O                       69VALDA     15
     O                                   27 'DR'
     O                       22          27 'CR'
     O                                   42 'RATE CHANGE TO'
     O                         INTR      56 '  0 .       -'
     O                                   57 '%'
     O/COPY WNCPYSRC,GL0065O094
     O        E 1      40 51N04DET
     O       AND       84
     O                         PSTDA      7
     O                       69VALDA     15
     O*
     O** Core hook for externalisation.
     O/COPY WNCPYSRC,GL0065OOP5
     O*
     O                N25      CHQN      24
     O/COPY WNCPYSRC,GL0065O152
     O                    23 70PSTA      71 ' ,   ,   ,   , 0 '
     O                    23 71PSTA      71 '   ,   ,   , 0 . '
     O                    23 72PSTA      71 '  ,   ,   , 0 .  '
     O                    23 73PSTA      71 ' ,   ,   , 0 .   '
     O/COPY WNCPYSRC,GL0065O153
     O                         PNAR      55
     O/COPY WNCPYSRC,GL0065O154
     O                    22 70PSTA      88 ' ,   ,   ,   , 0 '
     O                    22 71PSTA      88 '   ,   ,   , 0 . '
     O                    22 72PSTA      88 '  ,   ,   , 0 .  '
     O                    22 73PSTA      88 ' ,   ,   , 0 .   '
     O/COPY WNCPYSRC,GL0065O095
     O        E 1      40 51N04DET
     O       AND       84 78
     O                         ROCCY     28
     O                       KEROAMT     49 '   ,   ,   ,   , 0 '
     O                       KFROAMT     49 '  ,   ,   ,   , 0 . '
     O                       KGROAMT     49 ' ,   ,   ,   , 0 .  '
     O                       KHROAMT     49 '   ,   ,   , 0 .   '
     O*
     O        E 1      40 51N04DET
     O       AND       84 53
     O                         W#ORIG    65
     O*
     O** Core hook for externalisation.
     O/COPY WNCPYSRC,GL0065OP18
     O*
     O** END OF POSTING DATE ONLY
     O*
     O        E 00     L1 40 49BAL
     O       AND      N52 51 84
     O/COPY WNCPYSRC,GL0065O184
     O                       70PSTBAL   110 '   ,   ,   ,   , 0 CR'
     O                       71PSTBAL   110 '  ,   ,   ,   , 0 . CR'
     O                       72PSTBAL   110 ' ,   ,   ,   , 0 .  CR'
     O                       73PSTBAL   110 '   ,   ,   , 0 .   CR'
     O                       47         110 'DR'
     O                       70CLBAL    132 '   ,   ,   ,   , 0 CR'
     O                       71CLBAL    132 '  ,   ,   ,   , 0 . CR'
     O                       72CLBAL    132 ' ,   ,   ,   , 0 .  CR'
     O                       73CLBAL    132 '   ,   ,   , 0 .   CR'
     O/COPY WNCPYSRC,GL0065O185
     O                       37         132 'DR'
2190 O** C/F BALANCE PRINTED WHEN ITEMS CLEARING AFTER LAST POST
2191 O*
     O        E 1      84 40 18TOT
     O       AND      N33
     O                                   55 'C/F'
     O/COPY WNCPYSRC,GL0065O186
     O                       70PSTBAL   110 '   ,   ,   ,   , 0 CR'
     O                       71PSTBAL   110 '  ,   ,   ,   , 0 . CR'
     O                       72PSTBAL   110 ' ,   ,   ,   , 0 .  CR'
     O                       73PSTBAL   110 '   ,   ,   , 0 .   CR'
     O                       47         110 'DR'
     O                       70CLBAL    132 '   ,   ,   ,   , 0 CR'
     O                       71CLBAL    132 '  ,   ,   ,   , 0 . CR'
     O                       72CLBAL    132 ' ,   ,   ,   , 0 .  CR'
     O                       73CLBAL    132 '   ,   ,   , 0 .   CR'
     O/COPY WNCPYSRC,GL0065O187
     O                       28         132 'DR'
     O*
     O        E 1      84 40 18TOT
     O       AND      N33 10
     O                         BKEURO    60
     O                                   88 '('
     O                       KAEUPBAL   111 '   ,   ,   ,   , 0 CR)'
     O                       KBEUPBAL   111 '  ,   ,   ,   , 0 . CR)'
     O                       KCEUPBAL   111 ' ,   ,   ,   , 0 .  CR)'
     O                       KDEUPBAL   111 '   ,   ,   , 0 .   CR)'
     O                       47         111 'DR)'
     O/COPY WNCPYSRC,GL0065O106
     O*
     O** END OF PAGE WHEN ITEMS TO BE CLEARED AFTER LAST POST
     O*
     O        E   50   84 40 18TOT
     O       AND      N33
     O                                  125 '- CONTD'
     O*
     O/COPY WNCPYSRC,GL0065OP24
     O*
     O** TOTAL TIME HEADINGS OUTPUT ONLY WHEN ITEMS CLEARED AFTER
     O*
     O        E   03   84 40 18TOT
     O       AND      N33
     O                    36   @WCNA1    35
     O                    35             71 'DEMAND STATEMENT'
     O                    58             85 'BRANCH    -'
     O                    58   BRCA      84
     O                    58   A8BRNM   115
     O        E   04   84 40 18TOT
     O       AND      N33
     O                       36@WCNA2    35
     O/COPY WNCPYSRC,GL0065O102
     O        E   05   84 40 18TOT
     O       AND      N33
     O                       36@WCNA3    35
     O        E   06   84 40 18TOT
     O       AND      N33
     O                       36@WCNA4    35
     O*
     O        E   07   84 40 18TOT
     O       AND      N33
     O** ETC.
     O                                   49 'OUR REF'
     O                                   73 '-   -    -'
     O                         CNUM      57
     O                         CCY       61
     O                         ACOD      72
     O                         ACSQ      75
     O                N27      ACNO      86
     O        E   08   84 40 18TOT
     O       AND      N33
     O                 58                12 'BRANCH'
     O                 58      BRCA      16
     O                 58      A8BRNM    48
     O        E   10   84 40 18TOT
     O       AND      N33
     O/COPY WNCPYSRC,GL0065O115
     O                         ANAM      33
     O                         CCNM      65
     O/COPY WNCPYSRC,GL0065O142
     O                         RUNA      87
     O/COPY WNCPYSRC,GL0065O068
     O                         STPFF 3  107
     O/COPY WNCPYSRC,GL0065O069
     O        E   16   84 40 18TOT
     O       AND      N33
     O                         LSTDA      7
     O/COPY WNCPYSRC,GL0065O143
     O                                   55 'B/F'
     O/COPY WNCPYSRC,GL0065O188
     O                       70PSTBF    110 '   ,   ,   ,   , 0 CR'
     O                       71PSTBF    110 '  ,   ,   ,   , 0 . CR'
     O                       72PSTBF    110 ' ,   ,   ,   , 0 .  CR'
     O                       73PSTBF    110 '   ,   ,   , 0 .   CR'
     O                       47         110 'DR'
     O                       70CLBAL    132 '   ,   ,   ,   , 0 CR'
     O                       71CLBAL    132 '  ,   ,   ,   , 0 . CR'
     O                       72CLBAL    132 ' ,   ,   ,   , 0 .  CR'
     O                       73CLBAL    132 '   ,   ,   , 0 .   CR'
     O                       37         132 'DR'
     O/COPY WNCPYSRC,GL0065O096
     O*
     O        E   17   84 40 18TOT
     O       AND      N33 10
     O                         BKEURO    60
     O                                   88 '('
     O                       KAEUPBF    111 '   ,   ,   ,   , 0 CR)'
     O                       KBEUPBF    111 '  ,   ,   ,   , 0 . CR)'
     O                       KCEUPBF    111 ' ,   ,   ,   , 0 .  CR)'
     O                       KDEUPBF    111 '   ,   ,   , 0 .   CR)'
     O                       47         111 'DR)'
     O*
     O** ITEMS CLEARED AFTER LAST POST.
     O*
     O        E 1      84 40 19TOT
     O       AND      N33
     O/COPY WNCPYSRC,GL0065O189
     O                       70VDDR      71 ' ,   ,   ,   , 0 '
     O                       71VDDR      71 '   ,   ,   , 0 . '
     O                       72VDDR      71 '  ,   ,   , 0 .  '
     O                       73VDDR      71 ' ,   ,   , 0 .   '
     O                                   40 '** AMOUNT CLEARED AFTER '
     O                                   55 'LAST POSTING **'
     O                       70VDCR      88 ' ,   ,   ,   , 0 '
     O                       71VDCR      88 '   ,   ,   , 0 . '
     O                       72VDCR      88 '  ,   ,   , 0 .  '
     O                       73VDCR      88 ' ,   ,   , 0 .   '
     O** TO ENSURE ACCURATE CLEARED BALANCE CFWD IS SHOWN ON FIRST &
     O** SUBSEQUENT PAGES OF STATMENTS
     O                    52 70CLBF     132 '   ,   ,   ,   , 0 CR'
     O                    52 71CLBF     132 '  ,   ,   ,   , 0 . CR'
     O                    52 72CLBF     132 ' ,   ,   ,   , 0 .  CR'
     O                    52 73CLBF     132 '   ,   ,   , 0 .   CR'
     O                    45 70CLBAL    132 '   ,   ,   ,   , 0 CR'
     O                    45 71CLBAL    132 '  ,   ,   ,   , 0 . CR'
     O                    45 72CLBAL    132 ' ,   ,   ,   , 0 .  CR'
     O                    45 73CLBAL    132 '   ,   ,   , 0 .   CR'
     O/COPY WNCPYSRC,GL0065O190
     O                       28         132 'DR'
     O** END OF PAGE IND 45
     O*
     O        E 1      84 40 45ENDPG
     O       AND      N33
     O                                   55 'C/F'
     O/COPY WNCPYSRC,GL0065O191
     O                       70PSTBAL   110 '   ,   ,   ,   , 0 CR'
     O                       71PSTBAL   110 '  ,   ,   ,   , 0 . CR'
     O                       72PSTBAL   110 ' ,   ,   ,   , 0 .  CR'
     O                       73PSTBAL   110 '   ,   ,   , 0 .   CR'
     O                       47         110 'DR'
     O                       70CLBAL    132 '   ,   ,   ,   , 0 CR'
     O                       71CLBAL    132 '  ,   ,   ,   , 0 . CR'
     O                       72CLBAL    132 ' ,   ,   ,   , 0 .  CR'
     O                       73CLBAL    132 '   ,   ,   , 0 .   CR'
     O/COPY WNCPYSRC,GL0065O192
     O                       28         132 'DR'
     O*
     O        E 1      84 40 45ENDPG
     O       AND      N33 10
     O                         BKEURO    60
     O                                   88 '('
     O                       KAEUPBAL   111 '   ,   ,   ,   , 0 CR)'
     O                       KBEUPBAL   111 '  ,   ,   ,   , 0 . CR)'
     O                       KCEUPBAL   111 ' ,   ,   ,   , 0 .  CR)'
     O                       KDEUPBAL   111 '   ,   ,   , 0 .   CR)'
     O                       47         111 'DR)'
     O*
     O        E 1      84 40 52TOT
     O       AND      N33
     O                                   55 'C/F'
     O/COPY WNCPYSRC,GL0065O193
     O                       70PSTBAL   110 '   ,   ,   ,   , 0 CR'
     O                       71PSTBAL   110 '  ,   ,   ,   , 0 . CR'
     O                       72PSTBAL   110 ' ,   ,   ,   , 0 .  CR'
     O                       73PSTBAL   110 '   ,   ,   , 0 .   CR'
     O                       47         110 'DR'
     O                       70CLBF     132 '   ,   ,   ,   , 0 CR'
     O                       71CLBF     132 '  ,   ,   ,   , 0 . CR'
     O                       72CLBF     132 ' ,   ,   ,   , 0 .  CR'
     O                       73CLBF     132 '   ,   ,   , 0 .   CR'
     O/COPY WNCPYSRC,GL0065O194
     O                       28         132 'DR'
     O*
     O        E 1      84 40 52TOT
     O       AND      N33 10
     O                         BKEURO    60
     O                                   88 '('
     O                       KAEUPBAL   111 '   ,   ,   ,   , 0 CR)'
     O                       KBEUPBAL   111 '  ,   ,   ,   , 0 . CR)'
     O                       KCEUPBAL   111 ' ,   ,   ,   , 0 .  CR)'
     O                       KDEUPBAL   111 '   ,   ,   , 0 .   CR)'
     O                       47         111 'DR)'
     O*
     O** SUMMARY OF THIS STATEMENT AT BOTTOM OF LAST PAGE.
     O*
     O/COPY WNCPYSRC,GL0065O116
     O        E   50   84 40 52TOT
     O       AND      N33
     O/COPY WNCPYSRC,GL0065O195
     O                       70CFSB      26 '   ,   ,   ,   , 0 CR'
     O                       71CFSB      26 '  ,   ,   ,   , 0 . CR'
     O                       72CFSB      26 ' ,   ,   ,   , 0 .  CR'
     O                       73CFSB      26 '   ,   ,   , 0 .   CR'
     O                       17          26 'DR'
      *
     O/COPY WNCPYSRC,GL0065OP26
      *
     O                         NDR   3   33
     O/COPY WNCPYSRC,GL0065O196
     O                       70PSDR      51 ' ,   ,   ,   , 0 '
     O                       71PSDR      51 '   ,   ,   , 0 . '
     O                       72PSDR      51 '  ,   ,   , 0 .  '
     O                       73PSDR      51 ' ,   ,   , 0 .   '
     O                         NCR   3   59
     O                       70PSCR      78 ' ,   ,   ,   , 0 '
     O                       71PSCR      78 '   ,   ,   , 0 . '
     O                       72PSCR      78 '  ,   ,   , 0 .  '
     O                       73PSCR      78 ' ,   ,   , 0 .   '
     O                       70PSTBAL   109 '   ,   ,   ,   , 0 CR'
     O                       71PSTBAL   109 '  ,   ,   ,   , 0 . CR'
     O                       72PSTBAL   109 ' ,   ,   ,   , 0 .  CR'
     O                       73PSTBAL   109 '   ,   ,   , 0 .   CR'
     O/COPY WNCPYSRC,GL0065O197
     O                       47         109 'DR'
     O*
     O        E 1      84 40 52TOT
     O       AND      N33 10
     O                         BKEURO    60
     O                                   87 '('
     O                       KAEUPBAL   110 '   ,   ,   ,   , 0 CR)'
     O                       KBEUPBAL   110 '  ,   ,   ,   , 0 . CR)'
     O                       KCEUPBAL   110 ' ,   ,   ,   , 0 .  CR)'
     O                       KDEUPBAL   110 '   ,   ,   , 0 .   CR)'
     O                       47         110 'DR)'
     O*
     O        E 1      84 40 52TOT
     O       AND      N33 82
     O                         WCMTX1    97
     O        E 1      84 40 52TOT
     O       AND      N33 82
     O                         WCMTX2    97
     O        E 1      84 40 52TOT
     O       AND      N33 82
     O                         WCMTX3    97
     O        E 1      84 40 52TOT
     O       AND      N33 82
     O                         WCMTX4    97
     O/COPY WNCPYSRC,GL0065O117
     O*
     O        E   50   84 40 45ENDPG
     O       AND      N33
     O                                  125 '- CONTD'
     O********E*1 03           ERPT1                                                          239641
     O        E 1              ERPT1                                                          239641
     O                                   66 '*** END OF REPORT '
     O                 58                77 'FOR BRANCH '
     O                 58      BRCASV    80
     O                 58                84 ' ***'
     O                N58                69 '***'
     O*
     O** Core hook for externalisation.
     O/COPY WNCPYSRC,GL0065OOP1
     O*
     O/EJECT
      *
     O/COPY WNCPYSRC,GL0065OP27
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2003
** - TYPE    -    STATEMENT TYPE
GRDNC
** - ZFMD  -  NUMBER OF DAYS IN MONTH
312831303130313130313031
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
