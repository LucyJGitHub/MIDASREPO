     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas GL Convert date (MMM to MM)  Usr pgm')
     F********************************************************************
     F*                                                                  *
     F*  Midas  GENERAL LEDGER MODULE
     F*                                                                  *
     F*     GL0105U  -  Convert date from MMM to MM.                     *
     F*                                                                  *
      *  (c) Finastra International Limited 2001                      *
     F*                                                                  *
      *  Last Amend No. MD046248           Date 27Oct17               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *  Prev Amend No. XXXXXX             Date DDMmmYY               *
      *                 XXXXXX             Date DDMmmYY               *
     F*                                                                  *
     F********************************************************************
     F*                                                                  *
      *  MD046248 - Finastra Rebranding                               *
     F*     XXXXXX - XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX                     *
     F*                                                                  *
     F********************************************************************
     F*  P R O G R A M     C R E A T I O N     P A R A M E T E R S    *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
     E*
     E                    TABA    1  12  3   TAB1    2   Month
     E*
     E                    CPY@    1   1 80               Copyright Statement
     I*
     ICPYR@#      DS
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
     I** Data Structure for compilation  - Copyright insertion
     I*
     IDTE1        DS
     I                                        1   2 DAY1
     I                                        3   5 MTH1
     I                                        6   7 YER1
     I** Data Structure for Date in DDMMMYY format.
     I*
     IDTE2        DS
     I                                        1   2 DAY2
     I                                        3   4 MTH2
     I                                        5   6 YER2
     I** Data Structure for Date in DDMMYY format (all numbers).
     I*
     C*
     C                     MOVEACPY@      BIS@   80
     C*
     C           *ENTRY    PLIST
     C                     PARM           P@BDTS  7
     C                     PARM           P@BDTN  6
     C                     PARM           P@ERCD  1
     C*
     C                     MOVE P@BDTS    DTE1
     C                     MOVE *BLANKS   P@BDTN
     C                     MOVE '0'       P@ERCD
     C*
     C** Check month is valid, if so retrieve equivalent month number.
     C*
     C           MTH1      LOKUPTABA      TAB1           30
     C           *IN30     IFEQ '1'
     C                     MOVE DAY1      DAY2
     C                     MOVE TAB1      MTH2
     C                     MOVE YER1      YER2
     C                     MOVE DTE2      P@BDTN
     C*
     C** If invalid pass 'Error' status out in return code.
     C*
     C                     ELSE
     C                     MOVE '1'       P@ERCD
     C                     END
     C*
     C                     RETRN
**  MTH (TABA and TAB1)
JAN01
FEB02
MAR03
APR04
MAY05
JUN06
JUL07
AUG08
SEP09
OCT10
NOV11
DEC12
**  CPY@
(c) Finastra International Limited 2001
